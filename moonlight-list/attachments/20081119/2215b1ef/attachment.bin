Index: calculator/Makefile.am
===================================================================
--- calculator/Makefile.am	(revision 118290)
+++ calculator/Makefile.am	(working copy)
@@ -21,4 +21,5 @@
 	AppManifest.xaml	\
 	calculator.xap		\
 	calculator.dll		\
-	calculator.dll.mdb
+	calculator.dll.mdb	\
+	calculator.html
Index: ruler/default.xaml
===================================================================
--- ruler/default.xaml	(revision 118290)
+++ ruler/default.xaml	(working copy)
@@ -1,6 +1,6 @@
 <Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-	x:Class="Desklets.Monitor;assembly=ruler.dll"
+	x:Class="Desklets.Ruler.Monitor;assembly=ruler.dll"
 	Loaded="PageLoaded" Width="532" Height="102">
 
 	<!-- Timer trigger -->
@@ -14,7 +14,7 @@
 		RadiusX="10" RadiusY="10">
 	</Rectangle>
 
-	<Polygon x:Name="desklet-close" Canvas.Left="10" Canvas.Top="55"
+	<Polygon x:Name="desklet_close" Canvas.Left="10" Canvas.Top="55"
 		Points="4 4 8 8 4 12 6 14 10 10 14 14 16 12 12 8 16 4 14 2 10 6 6 2 4 4"
 		Stroke="#FF111111" StrokeThickness="3" Fill="#FF111111" />
 
Index: ruler/Makefile.am
===================================================================
--- ruler/Makefile.am	(revision 118290)
+++ ruler/Makefile.am	(working copy)
@@ -1,19 +1,26 @@
-bin_SCRIPTS = example-ruler
-deskletdir = $(libdir)/desklets/example-ruler
+noinst_SCRIPTS = example-ruler
+#deskletdir = $(libdir)/desklets/example-ruler
+desklet = ruler.xap
+noinst_DATA = default.xaml ruler.xap
 
-desklet_DATA = default.xaml ruler.dll
-
 EXTRA_DIST = default.xaml ruler.cs
 
 example-ruler: Makefile
 	echo "#!/bin/sh" > example-ruler
-	echo "mopen -d $(deskletdir)" >> example-ruler
+	echo "mopen -d $(desklet)" >> example-ruler
 	chmod +x example-ruler
 
-ruler.dll: ruler.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
-	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll -r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/ruler.cs
 
+ruler.xap : 
+	mono ../../../tools/mxap/mxap.exe --desktop --entry-point-type=Desklets.Ruler.App
+
 CLEANFILES = 		\
 	example-ruler	\
 	ruler.dll	\
-	ruler.dll.mdb
+	ruler.dll.mdb	\
+	ruler.xap	\
+	ruler.html	\
+	ruler.g.resources \
+	App.xaml.g.cs	\
+	default.xaml.g.cs \
+	AppManifest.xaml 
Index: ruler/ruler.cs
===================================================================
--- ruler/ruler.cs	(revision 118290)
+++ ruler/ruler.cs	(working copy)
@@ -19,11 +19,14 @@
 using System.Windows.Shapes;
 using System.IO;
 
-namespace Desklets
+namespace Desklets.Ruler
 {
-	public class Monitor : Canvas 
+	public partial class Monitor : Canvas 
 	{
-		Storyboard storyboard;
+		public Monitor() {
+			InitializeComponent();
+		}
+//		Storyboard storyboard;
 
 		static readonly Brush LinesColor = new SolidColorBrush (Colors.Black);
 		static readonly Brush ActiveColor = new SolidColorBrush (Color.FromArgb (255, 30, 30, 30));
@@ -112,11 +115,11 @@
 			
 			DrawRuler ();
 
-			Shape close_button = FindName ("desklet-close") as Shape;
-			close_button.MouseLeftButtonDown += new MouseEventHandler (MouseDown);
-			close_button.MouseLeftButtonUp += new MouseEventHandler (MouseUp);
+			Shape close_button = FindName ("desklet_close") as Shape;
+			close_button.MouseLeftButtonDown += new MouseButtonEventHandler (MouseDown);
+			close_button.MouseLeftButtonUp += new MouseButtonEventHandler (MouseUp);
 			close_button.MouseEnter += new MouseEventHandler (MouseEnter);
-			close_button.MouseLeave += new EventHandler (MouseLeft);
+			close_button.MouseLeave += new MouseEventHandler (MouseLeft);
 		}
 	}
 }
Index: clock/default.xaml
===================================================================
--- clock/default.xaml	(revision 118290)
+++ clock/default.xaml	(working copy)
@@ -1,6 +1,6 @@
 <Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-        x:Class="Desklets.VideoPlayer;assembly=bin/videoplayer.dll"
+        x:Class="Desklet.VideoPlayer.VideoPlayer;assembly=bin/videoplayer.dll"
 	Loaded="PageLoaded" Width="400" Height="400">
 
 	<Rectangle Width="350" Height="30" Fill="Gray" RadiusX="15" RadiusY="15"/>
@@ -14,5 +14,6 @@
 
 	<Polygon Fill="Black" Points="220,5 220,25 240,15" x:Name="Play"/>
 
-	<MediaElement AutoPlay="False" x:Name="Video" Source="video.ogg" Opacity="1.0" Canvas.Top="30" Canvas.Left="15"/>
+	<MediaElement AutoPlay="True" x:Name="Video" Source="http://wmc1.den.liquidcompass.net/WBTZ?MSWMExt=.asf" Opacity="1.0" Canvas.Top="30" 
+Canvas.Left="15"/>
 </Canvas>
Index: clock/video.cs
===================================================================
--- clock/video.cs	(revision 118290)
+++ clock/video.cs	(working copy)
@@ -32,10 +32,14 @@
 using System.Windows.Media.Animation;
 using System.Windows.Shapes;
 
-namespace Desklets
+namespace Desklet.VideoPlayer
 {
-	public class VideoPlayer : Canvas 
+	public partial class VideoPlayer : Canvas 
 	{
+		public VideoPlayer()
+		{
+			InitializeComponent();
+		}
 		public void PageLoaded (object o, EventArgs e)
 		{
 			MediaElement media = FindName ("Video") as MediaElement;
Index: cpumonitor/default.xaml
===================================================================
--- cpumonitor/default.xaml	(revision 118290)
+++ cpumonitor/default.xaml	(working copy)
@@ -1,6 +1,6 @@
 <Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-        x:Class="Desklet.CpuMonitorPanel;assembly=monitor.dll"
+        x:Class="Desklets.CpuMonitorPanel.CpuMonitorPanel;assembly=cpumonitor.dll"
         Loaded="PageLoaded" Width="156" Height="156">
 
   <Canvas.Resources>
@@ -13,7 +13,7 @@
   </Canvas.Resources>
 
   <!-- close/drag elements -->
-  <Polygon x:Name="desklet-close" Canvas.Left="0" Canvas.Top="0"
+  <Polygon x:Name="desklet_close" Canvas.Left="0" Canvas.Top="0"
            Points="4 4 8 8 4 12 6 14 10 10 14 14 16 12 12 8 16 4 14 2 10 6 6 2 4 4"
            Stroke="#66FFFFFF" StrokeThickness="3" Fill="#66FFFFFF"/>
 
Index: cpumonitor/Makefile.am
===================================================================
--- cpumonitor/Makefile.am	(revision 118290)
+++ cpumonitor/Makefile.am	(working copy)
@@ -1,19 +1,26 @@
 bin_SCRIPTS = example-cpumonitor
+desklet=cpumonitor.xap
 deskletdir = $(libdir)/desklets/example-cpumonitor
 
-desklet_DATA = default.xaml monitor.dll
+desklet_DATA = default.xaml App.xaml cpumonitor.xap
 
 EXTRA_DIST = default.xaml monitor.cs
 
 example-cpumonitor: Makefile
 	echo "#!/bin/sh" > example-cpumonitor
-	echo "mopen -d $(deskletdir)" >> example-cpumonitor
+	echo "mopen -d $(desklet)" >> example-cpumonitor
 	chmod +x example-cpumonitor
 
-monitor.dll: monitor.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
-	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll -r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/monitor.cs
+cpumonitor.xap: monitor.cs default.xaml App.xaml
+	mono ../../../tools/mxap/mxap.exe --desktop --entry-point-type=Desklets.CpuMonitorPanel.App
 
 CLEANFILES =			\
 	example-cpumonitor	\
-	monitor.dll		\
-	monitor.dll.mdb
+        default.xaml.g.cs       \
+        App.xaml.g.cs           \
+        AppManifest.xaml        \
+	cpumonitor.g.resources	\
+	cpumonitor.xap		\
+	cpumonitor.dll		\
+	cpumonitor.dll.mdb	\
+	cpumonitor.html
Index: cpumonitor/monitor.cs
===================================================================
--- cpumonitor/monitor.cs	(revision 118290)
+++ cpumonitor/monitor.cs	(working copy)
@@ -9,7 +9,7 @@
 using System.Windows.Media.Animation;
 using System.Windows.Shapes;
 
-namespace Desklet
+namespace Desklets.CpuMonitorPanel
 {
 	public struct CpuCounter {
 		long user;
@@ -60,7 +60,7 @@
 		}
 	}
 
-	public class CpuMonitorPanel : Canvas 
+	public partial class CpuMonitorPanel : Canvas 
 	{
 		Shape circle;
 		TextBlock load;
@@ -145,5 +145,8 @@
 			sb.Begin ();
 			DrawLoad ();
 		}
+		public CpuMonitorPanel () {
+			InitializeComponent();
+		}
 	}
 }
Index: panel/gtk-gui/generated.cs
===================================================================
--- panel/gtk-gui/generated.cs	(revision 118290)
+++ panel/gtk-gui/generated.cs	(working copy)
@@ -1,7 +1,7 @@
 // ------------------------------------------------------------------------------
 //  <autogenerated>
 //      This code was generated by a tool.
-//      Mono Runtime Version: 2.0.50727.42
+//      Mono Runtime Version: 2.0.50727.1433
 // 
 //      Changes to this file may cause incorrect behavior and will be lost if 
 //      the code is regenerated.
@@ -15,7 +15,7 @@
         
         private static bool initialized;
         
-        internal static void Initialize() {
+        internal static void Initialize(Gtk.Widget iconRenderer) {
             if ((Stetic.Gui.initialized == false)) {
                 Stetic.Gui.initialized = true;
             }
@@ -24,26 +24,32 @@
     
     internal class IconLoader {
         
-        public static Gdk.Pixbuf LoadIcon(string name, int sz) {
-            try {
-                return Gtk.IconTheme.Default.LoadIcon(name, sz, 0);
+        public static Gdk.Pixbuf LoadIcon(Gtk.Widget widget, string name, Gtk.IconSize size, int sz) {
+            Gdk.Pixbuf res = widget.RenderIcon(name, size, null);
+            if ((res != null)) {
+                return res;
             }
-            catch (System.Exception ) {
-                if ((name != "gtk-missing-image")) {
-                    return Stetic.IconLoader.LoadIcon("gtk-missing-image", sz);
+            else {
+                try {
+                    return Gtk.IconTheme.Default.LoadIcon(name, sz, 0);
                 }
-                else {
-                    Gdk.Pixmap pmap = new Gdk.Pixmap(Gdk.Screen.Default.RootWindow, sz, sz);
-                    Gdk.GC gc = new Gdk.GC(pmap);
-                    gc.RgbFgColor = new Gdk.Color(255, 255, 255);
-                    pmap.DrawRectangle(gc, true, 0, 0, sz, sz);
-                    gc.RgbFgColor = new Gdk.Color(0, 0, 0);
-                    pmap.DrawRectangle(gc, false, 0, 0, (sz - 1), (sz - 1));
-                    gc.SetLineAttributes(3, Gdk.LineStyle.Solid, Gdk.CapStyle.Round, Gdk.JoinStyle.Round);
-                    gc.RgbFgColor = new Gdk.Color(255, 0, 0);
-                    pmap.DrawLine(gc, (sz / 4), (sz / 4), ((sz - 1) - (sz / 4)), ((sz - 1) - (sz / 4)));
-                    pmap.DrawLine(gc, ((sz - 1) - (sz / 4)), (sz / 4), (sz / 4), ((sz - 1) - (sz / 4)));
-                    return Gdk.Pixbuf.FromDrawable(pmap, pmap.Colormap, 0, 0, 0, 0, sz, sz);
+                catch (System.Exception ) {
+                    if ((name != "gtk-missing-image")) {
+                        return Stetic.IconLoader.LoadIcon(widget, "gtk-missing-image", size, sz);
+                    }
+                    else {
+                        Gdk.Pixmap pmap = new Gdk.Pixmap(Gdk.Screen.Default.RootWindow, sz, sz);
+                        Gdk.GC gc = new Gdk.GC(pmap);
+                        gc.RgbFgColor = new Gdk.Color(255, 255, 255);
+                        pmap.DrawRectangle(gc, true, 0, 0, sz, sz);
+                        gc.RgbFgColor = new Gdk.Color(0, 0, 0);
+                        pmap.DrawRectangle(gc, false, 0, 0, (sz - 1), (sz - 1));
+                        gc.SetLineAttributes(3, Gdk.LineStyle.Solid, Gdk.CapStyle.Round, Gdk.JoinStyle.Round);
+                        gc.RgbFgColor = new Gdk.Color(255, 0, 0);
+                        pmap.DrawLine(gc, (sz / 4), (sz / 4), ((sz - 1) - (sz / 4)), ((sz - 1) - (sz / 4)));
+                        pmap.DrawLine(gc, ((sz - 1) - (sz / 4)), (sz / 4), (sz / 4), ((sz - 1) - (sz / 4)));
+                        return Gdk.Pixbuf.FromDrawable(pmap, pmap.Colormap, 0, 0, 0, 0, sz, sz);
+                    }
                 }
             }
         }
Index: panel/gtk-gui/PanelWindow.cs
===================================================================
--- panel/gtk-gui/PanelWindow.cs	(revision 118290)
+++ panel/gtk-gui/PanelWindow.cs	(working copy)
@@ -1,7 +1,7 @@
 // ------------------------------------------------------------------------------
 //  <autogenerated>
 //      This code was generated by a tool.
-//      Mono Runtime Version: 2.0.50727.42
+//      Mono Runtime Version: 2.0.50727.1433
 // 
 //      Changes to this file may cause incorrect behavior and will be lost if 
 //      the code is regenerated.
@@ -39,7 +39,7 @@
     private Gtk.Button CloseButton;
     
     protected virtual void Build() {
-        Stetic.Gui.Initialize();
+        Stetic.Gui.Initialize(this);
         // Widget PanelWindow
         this.Name = "PanelWindow";
         this.Title = Mono.Unix.Catalog.GetString("Moonlight Desklets Panel");
@@ -79,8 +79,6 @@
         this.DeskletsScrolledWindow = new Gtk.ScrolledWindow();
         this.DeskletsScrolledWindow.CanFocus = true;
         this.DeskletsScrolledWindow.Name = "DeskletsScrolledWindow";
-        this.DeskletsScrolledWindow.VscrollbarPolicy = ((Gtk.PolicyType)(1));
-        this.DeskletsScrolledWindow.HscrollbarPolicy = ((Gtk.PolicyType)(1));
         this.DeskletsScrolledWindow.ShadowType = ((Gtk.ShadowType)(1));
         // Container child DeskletsScrolledWindow.Gtk.Container+ContainerChild
         this.DeskletsView = new Gtk.TreeView();
@@ -133,19 +131,15 @@
         this.DeskletsButton.UseUnderline = true;
         // Container child DeskletsButton.Gtk.Container+ContainerChild
         Gtk.Alignment w9 = new Gtk.Alignment(0.5F, 0.5F, 0F, 0F);
-        w9.Name = "GtkAlignment1";
-        // Container child GtkAlignment1.Gtk.Container+ContainerChild
+        // Container child GtkAlignment.Gtk.Container+ContainerChild
         Gtk.HBox w10 = new Gtk.HBox();
-        w10.Name = "GtkHBox2";
         w10.Spacing = 2;
-        // Container child GtkHBox2.Gtk.Container+ContainerChild
+        // Container child GtkHBox.Gtk.Container+ContainerChild
         Gtk.Image w11 = new Gtk.Image();
-        w11.Name = "image23";
-        w11.Pixbuf = Stetic.IconLoader.LoadIcon("gtk-find", 16);
+        w11.Pixbuf = Stetic.IconLoader.LoadIcon(this, "gtk-find", Gtk.IconSize.Menu, 16);
         w10.Add(w11);
-        // Container child GtkHBox2.Gtk.Container+ContainerChild
+        // Container child GtkHBox.Gtk.Container+ContainerChild
         Gtk.Label w13 = new Gtk.Label();
-        w13.Name = "GtkLabel2";
         w13.LabelProp = Mono.Unix.Catalog.GetString("Get desklets");
         w13.UseUnderline = true;
         w10.Add(w13);
Index: panel/gtk-gui/gui.stetic
===================================================================
--- panel/gtk-gui/gui.stetic	(revision 118290)
+++ panel/gtk-gui/gui.stetic	(working copy)
@@ -1,8 +1,13 @@
 ﻿<?xml version="1.0" encoding="utf-8"?>
 <stetic-interface>
   <configuration>
-    <images-root-path>../</images-root-path>
+    <images-root-path>..</images-root-path>
   </configuration>
+  <import>
+    <widget-library name="glade-sharp, Version=2.12.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f" />
+    <widget-library name="../desklets-panel.exe" internal="true" />
+    <widget-library name="gnome-sharp, Version=2.20.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f" />
+  </import>
   <widget class="Gtk.Window" id="PanelWindow" design-size="447 446">
     <property name="MemberName" />
     <property name="Title" translatable="yes">Moonlight Desklets Panel</property>
@@ -57,8 +62,6 @@
           <widget class="Gtk.ScrolledWindow" id="DeskletsScrolledWindow">
             <property name="MemberName" />
             <property name="CanFocus">True</property>
-            <property name="VscrollbarPolicy">Automatic</property>
-            <property name="HscrollbarPolicy">Automatic</property>
             <property name="ShadowType">In</property>
             <child>
               <widget class="Gtk.TreeView" id="DeskletsView">
@@ -114,7 +117,6 @@
                 <property name="UseStock">True</property>
                 <property name="Type">StockItem</property>
                 <property name="StockId">gtk-help</property>
-                <property name="IsDialogButton">False</property>
                 <signal name="Clicked" handler="OnHelpButtonClicked" />
                 <property name="label">gtk-help</property>
               </widget>
@@ -132,7 +134,6 @@
                 <property name="Icon">stock:gtk-find Menu</property>
                 <property name="Label" translatable="yes">Get desklets</property>
                 <property name="UseUnderline">True</property>
-                <property name="IsDialogButton">False</property>
                 <signal name="Clicked" handler="OnDeskletsButtonClicked" />
               </widget>
               <packing>
@@ -148,7 +149,6 @@
                 <property name="UseStock">True</property>
                 <property name="Type">StockItem</property>
                 <property name="StockId">gtk-close</property>
-                <property name="IsDialogButton">False</property>
                 <signal name="Clicked" handler="OnCloseButtonClicked" />
                 <property name="label">gtk-close</property>
               </widget>
@@ -169,82 +169,4 @@
       </widget>
     </child>
   </widget>
-  <widget class="Gtk.Dialog" id="AboutBox" design-size="370 280">
-    <property name="MemberName" />
-    <property name="Title" translatable="yes">About Mono Desklets</property>
-    <property name="Icon">stock:gtk-about Menu</property>
-    <property name="Modal">True</property>
-    <property name="Buttons">1</property>
-    <property name="HelpButton">False</property>
-    <property name="HasSeparator">False</property>
-    <child internal-child="VBox">
-      <widget class="Gtk.VBox" id="dialog1_VBox">
-        <property name="MemberName" />
-        <child>
-          <widget class="Gtk.VBox" id="vbox2">
-            <property name="MemberName" />
-            <property name="Spacing">6</property>
-            <child>
-              <widget class="Gtk.Label" id="label1">
-                <property name="MemberName" />
-                <property name="LabelProp" translatable="yes">Mono Desklets 0.1</property>
-              </widget>
-              <packing>
-                <property name="Position">0</property>
-                <property name="AutoSize">True</property>
-                <property name="Expand">False</property>
-                <property name="Fill">False</property>
-              </packing>
-            </child>
-            <child>
-              <widget class="Gtk.Label" id="label3">
-                <property name="MemberName" />
-                <property name="LabelProp" translatable="yes">Copyright (c) 2007
-Novell, Inc</property>
-                <property name="Justify">Center</property>
-              </widget>
-              <packing>
-                <property name="Position">1</property>
-                <property name="AutoSize">True</property>
-                <property name="Expand">False</property>
-                <property name="Fill">False</property>
-              </packing>
-            </child>
-            <child>
-              <placeholder />
-            </child>
-          </widget>
-          <packing>
-            <property name="Position">0</property>
-            <property name="AutoSize">True</property>
-          </packing>
-        </child>
-      </widget>
-    </child>
-    <child internal-child="ActionArea">
-      <widget class="Gtk.HButtonBox" id="dialog1_ActionArea">
-        <property name="MemberName" />
-        <property name="Spacing">6</property>
-        <property name="BorderWidth">5</property>
-        <property name="Size">1</property>
-        <property name="LayoutStyle">End</property>
-        <child>
-          <widget class="Gtk.Button" id="OKButton">
-            <property name="MemberName" />
-            <property name="CanDefault">True</property>
-            <property name="CanFocus">True</property>
-            <property name="Type">TextOnly</property>
-            <property name="Label" translatable="yes">_Ok</property>
-            <property name="UseUnderline">True</property>
-            <property name="IsDialogButton">True</property>
-            <property name="ResponseId">0</property>
-          </widget>
-          <packing>
-            <property name="Expand">False</property>
-            <property name="Fill">False</property>
-          </packing>
-        </child>
-      </widget>
-    </child>
-  </widget>
 </stetic-interface>
\ No newline at end of file
Index: panel/desklets-panel.mdp
===================================================================
--- panel/desklets-panel.mdp	(revision 118290)
+++ panel/desklets-panel.mdp	(working copy)
@@ -1,26 +1,28 @@
 <Project name="desklets-panel" fileversion="2.0" language="C#" clr-version="Net_1_1" ctype="DotNetProject">
   <Configurations active="Debug">
     <Configuration name="Debug" ctype="DotNetProjectConfiguration">
-      <Output directory="./" assembly="desklets-panel" />
+      <Output directory="." assembly="desklets-panel" />
       <Build debugmode="True" target="Exe" />
       <Execution runwithwarnings="True" consolepause="True" runtime="MsNet" clr-version="Net_1_1" />
+      <EnvironmentVariables />
       <CodeGeneration compiler="Mcs" warninglevel="4" optimize="True" unsafecodeallowed="False" generateoverflowchecks="True" generatexmldocumentation="False" ctype="CSharpCompilerParameters" />
     </Configuration>
     <Configuration name="Release" ctype="DotNetProjectConfiguration">
-      <Output directory="./" assembly="desklets-panel" />
+      <Output directory="." assembly="desklets-panel" />
       <Build debugmode="False" target="Exe" />
       <Execution runwithwarnings="True" consolepause="True" runtime="MsNet" clr-version="Net_1_1" />
       <CodeGeneration compiler="Mcs" warninglevel="4" optimize="True" unsafecodeallowed="False" generateoverflowchecks="True" generatexmldocumentation="False" ctype="CSharpCompilerParameters" />
     </Configuration>
   </Configurations>
   <Contents>
-    <File name="./gtk-gui/gui.stetic" subtype="Code" buildaction="EmbedAsResource" />
-    <File name="./gtk-gui/generated.cs" subtype="Code" buildaction="Compile" />
-    <File name="./PanelWindow.cs" subtype="Code" buildaction="Compile" />
-    <File name="./Panel.cs" subtype="Code" buildaction="Compile" />
-    <File name="./AssemblyInfo.cs" subtype="Code" buildaction="Compile" />
-    <File name="./app.desktop" subtype="Code" buildaction="FileCopy" DeployService.TargetDirectoryId="Linux.DesktopApplications" />
-    <File name="./gtk-gui/PanelWindow.cs" subtype="Code" buildaction="Compile" />
+    <File name="gtk-gui/gui.stetic" subtype="Code" buildaction="EmbedAsResource" />
+    <File name="gtk-gui/generated.cs" subtype="Code" buildaction="Compile" />
+    <File name="PanelWindow.cs" subtype="Code" buildaction="Compile" />
+    <File name="Panel.cs" subtype="Code" buildaction="Compile" />
+    <File name="AssemblyInfo.cs" subtype="Code" buildaction="Compile" />
+    <File name="app.desktop" subtype="Code" DeployService.TargetDirectoryId="Linux.DesktopApplications" buildaction="FileCopy" />
+    <File name="gtk-gui/PanelWindow.cs" subtype="Code" buildaction="Compile" />
+    <File name="graphics/mono_monkey_icon.png" subtype="Code" buildaction="EmbedAsResource" />
   </Contents>
   <References>
     <ProjectReference type="Gac" localcopy="True" refto="System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
@@ -30,6 +32,12 @@
     <ProjectReference type="Gac" localcopy="True" refto="glade-sharp, Version=2.4.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f" />
     <ProjectReference type="Gac" localcopy="True" refto="pango-sharp, Version=2.4.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f" />
     <ProjectReference type="Gac" localcopy="True" refto="Mono.Posix, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=0738eb9f132ed756" />
+    <ProjectReference type="Gac" localcopy="True" refto="gnome-sharp, Version=2.4.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f" />
+    <ProjectReference type="Gac" localcopy="True" refto="Mono.WebBrowser, Version=0.5.0.0, Culture=neutral, PublicKeyToken=0738eb9f132ed756" />
+    <ProjectReference type="Gac" localcopy="True" refto="gecko-sharp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=ccf7d78a55e9f021" />
+    <ProjectReference type="Gac" localcopy="True" refto="gecko-sharp-dependent, Version=2.0.0.0, Culture=neutral, PublicKeyToken=ccf7d78a55e9f021" />
+    <ProjectReference type="Gac" localcopy="True" refto="System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
+    <ProjectReference type="Gac" localcopy="True" refto="gnome-vfs-sharp, Version=2.4.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f" />
   </References>
-  <GtkDesignInfo partialTypes="True" />
+  <GtkDesignInfo />
 </Project>
\ No newline at end of file
Index: simpleclock/clock.cs
===================================================================
--- simpleclock/clock.cs	(revision 118290)
+++ simpleclock/clock.cs	(working copy)
@@ -6,14 +6,14 @@
 using System.Windows.Media.Animation;
 using System.Windows.Shapes;
 
-namespace Clock {
+namespace Desklets.Clock {
 	
-	public class Display : Canvas {
-		TextBlock hour, minute, ampm;
+	public partial class Display : Canvas {
+/*		TextBlock hour, minute, ampm;
 		Storyboard to_config, to_clock;
-		DateTime last = DateTime.MinValue;
+*/		DateTime last = DateTime.MinValue;
 		bool isAm, use24h;
-		
+		public Display() { InitializeComponent(); }		
 		void UpdateTime ()
 		{
 			DateTime dt = DateTime.Now;
Index: simpleclock/default.xaml
===================================================================
--- simpleclock/default.xaml	(revision 118290)
+++ simpleclock/default.xaml	(working copy)
@@ -1,6 +1,6 @@
 ﻿<Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-	x:Class="Clock.Display;assembly=clock.dll"
+	x:Class="Desklets.Clock.Display;assembly=simpleclock.dll"
 	Loaded="PageLoaded"
 	Width="310" Height="100">
 
Index: simpleclock/Makefile.am
===================================================================
--- simpleclock/Makefile.am	(revision 118290)
+++ simpleclock/Makefile.am	(working copy)
@@ -1,19 +1,32 @@
-bin_SCRIPTS = example-simpleclock
-deskletdir = $(libdir)/desklets/example-simpleclock
+noinst_SCRIPTS = example-simpleclock
+desklet=simpleclock.xap
 
-desklet_DATA = default.xaml clock.dll
+#deskletdir = $(libdir)/desklets/example-simpleclock
 
+noinst_DATA = default.xaml simpleclock.xap
+
 EXTRA_DIST = default.xaml clock.cs
 
 example-simpleclock: Makefile
 	echo "#!/bin/sh" > example-simpleclock
-	echo "mopen -d $(deskletdir)" >> example-simpleclock
+	echo "mopen -d $(desklet)" >> example-simpleclock
 	chmod +x example-simpleclock
 
-clock.dll: clock.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
-	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll -r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/clock.cs
+#clock.dll: clock.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
+#	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll 
+#-r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/clock.cs
 
+simpleclock.xap : 
+	mono ../../../tools/mxap/mxap.exe --desktop --entry-point-type=Desklets.Clock.App
+
 CLEANFILES =			\
 	example-simpleclock	\
-	clock.dll		\
-	clock.dll.mdb
+	simpleclock.dll		\
+	simpleclock.dll.mdb	\
+	simpleclock.g.resources \
+	simpleclock.html	\
+	simpleclock.xap		\
+	default.xaml.g.cs	\
+	App.xaml.g.cs		\
+	AppManifest.xaml
+	
Index: glassyslides/default.xaml
===================================================================
--- glassyslides/default.xaml	(revision 118290)
+++ glassyslides/default.xaml	(working copy)
@@ -1,12 +1,12 @@
 <Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-	x:Class="Desklets.SlideShow;assembly=slideshow.dll"
+	x:Class="Desklets.GlassySlides.SlideShow;assembly=glassyslides.dll"
 	Loaded="PageLoaded" Width="322" Height="252">
 
   
 
   <!-- border -->
-	<Rectangle cFill="#33FFFFFF" Stroke="#66FFFFFF" StrokeThickness="1"
+	<Rectangle Stroke="#66FFFFFF" StrokeThickness="1"
 		Canvas.Left="1" Canvas.Top="1" Width="320" Height="250"
 		RadiusX="10" RadiusY="10">
 		<Rectangle.Fill>
@@ -29,7 +29,7 @@
 	</Rectangle>
 
 	<!-- close/drag elements -->
-	<Polygon x:Name="desklet-close" Canvas.Left="300" Canvas.Top="230"
+	<Polygon x:Name="desklet_close" Canvas.Left="300" Canvas.Top="230"
 	   Points="4 4 8 8 4 12 6 14 10 10 14 14 16 12 12 8 16 4 14 2 10 6 6 2 4 4"
 	   Stroke="#66FFFFFF" StrokeThickness="3" Fill="#66FFFFFF" />
 
Index: glassyslides/slideshow.cs
===================================================================
--- glassyslides/slideshow.cs	(revision 118290)
+++ glassyslides/slideshow.cs	(working copy)
@@ -18,24 +18,28 @@
 using System.Windows.Shapes;
 using System.IO;
 
-namespace Desklets
+namespace Desklets.GlassySlides
 {
-	public class SlideShow : Canvas 
+	public partial class SlideShow : Canvas 
 	{
 		int image_index = 1;
 
-		Storyboard change;
+/*		Storyboard change;
 		Storyboard fadein;
 		Storyboard fadeout;
 		Storyboard replace;
 		Rectangle irect;
 		ImageBrush image;
-
+*/
 		Polygon closeButton;
 		
 		Brush buttonHilite = new SolidColorBrush (Color.FromArgb (0xAA, 0xFF, 0xFF, 0xFF));
 		Brush buttonNormal = new SolidColorBrush (Color.FromArgb (0x66, 0xFF, 0xFF, 0xFF));
 		
+		public SlideShow () {
+		
+		InitializeComponent();
+}
 		public void ChangePicture (object o, EventArgs e)
 		{
 			fadein.Begin ();
@@ -91,7 +95,7 @@
 
 			change.Begin ();
 
-			closeButton = FindName ("desklet-close") as Polygon;
+			closeButton = FindName ("desklet_close") as Polygon;
 
 			closeButton.MouseEnter += delegate {
 				HighlightButton (closeButton);
Index: glassyslides/Makefile.am
===================================================================
--- glassyslides/Makefile.am	(revision 118290)
+++ glassyslides/Makefile.am	(working copy)
@@ -1,19 +1,28 @@
-bin_SCRIPTS = example-glassyslides
-deskletdir = $(libdir)/desklets/example-glassyslides
+noinst_SCRIPTS = example-glassyslides
 
-desklet_DATA = default.xaml slideshow.dll
+desklet=glassyslides.xap
 
+noinst_DATA = default.xaml App.xaml glassyslides.xap
+
 EXTRA_DIST = default.xaml slideshow.cs
 
 example-glassyslides: Makefile
 	echo "#!/bin/sh" > example-glassyslides
-	echo "mopen -d $(deskletdir)" >> example-glassyslides
+	echo "mopen -d $(desklet)" >> example-glassyslides
 	chmod +x example-glassyslides
+	mono ../../../tools/mxap/mxap.exe --desktop --entry-point-type=Desklets.GlassySlides.App
 
-slideshow.dll: slideshow.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
-	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll -r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/slideshow.cs
+glassyslides.xap: slideshow.cs default.xaml App.xaml
+        mono ../../../tools/mxap/mxap.exe --desktop --entry-point-type=Desklets.GlassySlides.App
 
-CLEANFILES =	\
+
+CLEANFILES =			\
 	example-glassyslides	\
-	slideshow.dll		\
-	slideshow.dll.mdb
+	glassyslides.dll	\
+	glassyslides.dll.mdb	\
+	glassyslides.xap	\
+	glassyslides.html	\
+	glassyslides.g.resources\
+        default.xaml.g.cs       \
+        App.xaml.g.cs           \
+        AppManifest.xaml
Index: Makefile.am
===================================================================
--- Makefile.am	(revision 118290)
+++ Makefile.am	(working copy)
@@ -1 +1 @@
-SUBDIRS = calculator cpumonitor glassyclock glassymonitor glassyslides simpleclock
+SUBDIRS = calculator cpumonitor glassyclock glassymonitor glassyslides simpleclock ruler
Index: calendar/default.xaml
===================================================================
--- calendar/default.xaml	(revision 118290)
+++ calendar/default.xaml	(working copy)
@@ -1,6 +1,6 @@
 <Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-        x:Class="Desklet.CalendarPanel;assembly=calendar.dll"
+        x:Class="Desklet.CalendarPanel.CalendarPanel;assembly=calendar.dll"
 	Loaded="PageLoaded" Width="228" Height="188">
 	
 	<Canvas.Resources>
@@ -582,7 +582,7 @@
 		Canvas.Top="150"/>
 
     <!-- close/drag elements -->
-    <Polygon x:Name="desklet-close" Canvas.Left="207" Canvas.Top="163"
+    <Polygon x:Name="desklet_close" Canvas.Left="207" Canvas.Top="163"
 	     Points="4 4 8 8 4 12 6 14 10 10 14 14 16 12 12 8 16 4 14 2 10 6 6 2 4 4"
 	     Stroke="#66FFFFFF" StrokeThickness="3" Fill="#66FFFFFF" />
 </Canvas>
Index: calendar/calendar.cs
===================================================================
--- calendar/calendar.cs	(revision 118290)
+++ calendar/calendar.cs	(working copy)
@@ -31,6 +31,8 @@
 using System.Xml.XPath;
 using System.Collections.Generic; 
 
+using System.Runtime.CompilerServices;
+
 using System.Windows;
 using System.Windows.Input;
 using System.Windows.Controls;
@@ -38,7 +40,7 @@
 using System.Windows.Media.Animation;
 using System.Windows.Shapes;
 
-namespace Desklet
+namespace Desklet.CalendarPanel
 {
 	public class Entry : IComparable <Entry> {
 		private String title;
@@ -85,7 +87,7 @@
 		}
 	}
 
-	public class CalendarPanel : Canvas 
+	public partial class CalendarPanel : Canvas 
 	{
 		TextBlock monthText;
 		TextBlock detailText;
@@ -113,6 +115,10 @@
 		
 		Brush buttonHilite = new SolidColorBrush (Color.FromArgb (0xAA, 0xFF, 0xFF, 0xFF));
 		Brush buttonNormal = new SolidColorBrush (Color.FromArgb (0x66, 0xFF, 0xFF, 0xFF));
+
+		public CalendarPanel(){
+			InitializeComponent();
+		}
 		
 		void drawDay (int l, int c, int day, bool mainMonth, bool curDay) {
 			days[l, c].Text = day.ToString ();
@@ -213,6 +219,8 @@
 		public void UpdateCalendarData (DateTime start, DateTime end)
 		{
 			Console.WriteLine ("updating calendar "+start);
+
+			[DllImport(libmoon.so)]
 			Downloader downloader = new Downloader ();
 			downloader.Completed += delegate {
 				CalendarDownloadComplete (start.Date, downloader.GetResponseText (""));
Index: glassymonitor/default.xaml
===================================================================
--- glassymonitor/default.xaml	(revision 118290)
+++ glassymonitor/default.xaml	(working copy)
@@ -1,6 +1,6 @@
 <Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-	x:Class="Desklets.Monitor;assembly=monitor.dll"
+	x:Class="Desklets.GlassyMonitor.Monitor;assembly=glassymonitor.dll"
 	Loaded="PageLoaded" Width="222" Height="52">
 
 	<!-- Timer trigger -->
@@ -30,7 +30,7 @@
 		Canvas.Left="120" Canvas.Top="34" Text="0" />
 
 	<!-- border -->
-	<Rectangle cFill="#33FFFFFF" Stroke="#66FFFFFF" StrokeThickness="1"
+	<Rectangle Stroke="#66FFFFFF" StrokeThickness="1"
 		Canvas.Left="1" Canvas.Top="1" Width="220" Height="50"
 		RadiusX="10" RadiusY="10">
 		<Rectangle.Fill>
@@ -44,7 +44,7 @@
 	</Rectangle>
 
 	<!-- close/drag elements -->
-        <Polygon x:Name="desklet-close" Canvas.Left="200" Canvas.Top="4"
+        <Polygon x:Name="desklet_close" Canvas.Left="200" Canvas.Top="4"
              Points="4 4 8 8 4 12 6 14 10 10 14 14 16 12 12 8 16 4 14 2 10 6 6 2 4 4"
              Stroke="#66FFFFFF" StrokeThickness="3" Fill="#66FFFFFF" />
 </Canvas>
Index: glassymonitor/Makefile.am
===================================================================
--- glassymonitor/Makefile.am	(revision 118290)
+++ glassymonitor/Makefile.am	(working copy)
@@ -1,19 +1,29 @@
-bin_SCRIPTS = example-glassymonitor
-deskletdir = $(libdir)/desklets/example-glassymonitor
+noinst_SCRIPTS = example-glassymonitor
+#deskletdir = $(libdir)/desklets/example-glassymonitor
+desklet = glassymonitor.xap
+noinst_DATA = default.xaml glassymonitor.xap
 
-desklet_DATA = default.xaml monitor.dll
-
 EXTRA_DIST = default.xaml monitor.cs
 
 example-glassymonitor: Makefile
 	echo "#!/bin/sh" > example-glassymonitor
-	echo "mopen -d $(deskletdir)" >> example-glassymonitor
+	echo "mopen -d $(desklet)" >> example-glassymonitor
 	chmod +x example-glassymonitor
 
-monitor.dll: monitor.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
-	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll -r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/monitor.cs
+glassymonitor.xap: monitor.cs default.xaml App.xaml
+	 mono ../../../tools/mxap/mxap.exe --desktop --entry-point-type=Desklets.GlassyMonitor.App
+	
+#monitor.dll: monitor.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
+#	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll -r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/monitor.cs
 
-CLEANFILES =			\
-	example-glassymonitor	\
-	monitor.dll		\
-	monitor.dll.mdb
+CLEANFILES =				\
+	example-glassymonitor		\
+	glassymonitor.dll		\
+	glassymonitor.dll.mdb		\
+	glassymonitor.g.resources	\
+	default.xaml.g.cs       	\
+        App.xaml.g.cs           	\
+        AppManifest.xaml        	\
+	glassymonitor.xap 		\
+	glassymonitor.html
+	
Index: glassymonitor/monitor.cs
===================================================================
--- glassymonitor/monitor.cs	(revision 118290)
+++ glassymonitor/monitor.cs	(working copy)
@@ -18,14 +18,14 @@
 using System.Windows.Shapes;
 using System.IO;
 
-namespace Desklets
+namespace Desklets.GlassyMonitor
 {
-	public class Monitor : Canvas 
+	public partial class Monitor : Canvas 
 	{
 		// TODO: use eth0 for now, later we must have a place to select it.
-		string device = GetActiveInterface();
+//		string device = GetActiveInterface();
 
-		Storyboard storyboard;
+//		Storyboard storyboard;
 		TextBlock device_text;
 		TextBlock received_text;
 		TextBlock sent_text;
@@ -34,7 +34,7 @@
 		
 		Brush buttonHilite = new SolidColorBrush (Color.FromArgb (0xAA, 0xFF, 0xFF, 0xFF));
 		Brush buttonNormal = new SolidColorBrush (Color.FromArgb (0x66, 0xFF, 0xFF, 0xFF));
-
+public Monitor() { InitializeComponent();}
 	static string GetActiveInterface()
 	{
 		string iface="eth0";
@@ -68,11 +68,11 @@
 				while ((line = sr.ReadLine()) != null) {
 					String[] pieces = line.Split (new char[] {':'});
 
-					if ((pieces.Length > 1) && (pieces [0].Trim() == device)) {
+					if ((pieces.Length > 1) && (pieces [0].Trim() == device.Text)) {
 						String[] fields = pieces [1].Split (new char[] {' '}, 
 										    StringSplitOptions.RemoveEmptyEntries);
 
-						device_text.Text   = device;
+						device_text.Text   = device.Text;
 						received_text.Text = fields [1];
 						sent_text.Text     = fields [9];
 
Index: glassyclock/clock.cs
===================================================================
--- glassyclock/clock.cs	(revision 118290)
+++ glassyclock/clock.cs	(working copy)
@@ -17,19 +17,24 @@
 using System.Windows.Media.Animation;
 using System.Windows.Shapes;
 
-namespace Desklets
+namespace Desklets.Clock
 {
-	public class Clock : Canvas 
+	public partial class Clock : Canvas 
 	{
-		RotateTransform secondsHand;
+/*		RotateTransform secondsHand;
 		RotateTransform minuteHand;
 		RotateTransform hourHand;
-
+*/
 		Polygon closeButton;
 		
 		Brush buttonHilite = new SolidColorBrush (Color.FromArgb (0xAA, 0xFF, 0xFF, 0xFF));
 		Brush buttonNormal = new SolidColorBrush (Color.FromArgb (0x66, 0xFF, 0xFF, 0xFF));
 
+		public Clock()
+		{
+			InitializeComponent(); 
+		}
+
 		void HighlightButton (Polygon button)
 		{
 			button.Stroke = buttonHilite;
Index: glassyclock/default.xaml
===================================================================
--- glassyclock/default.xaml	(revision 118290)
+++ glassyclock/default.xaml	(working copy)
@@ -1,10 +1,10 @@
 <Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
-        x:Class="Desklets.Clock;assembly=clock.dll"
+        x:Class="Desklets.Clock.Clock;assembly=glassyclock.dll"
         Loaded="PageLoaded" Width="114" Height="114">
 
   <!-- close/drag elements -->
-  <Polygon x:Name="desklet-close" Canvas.Left="0" Canvas.Top="0"
+  <Polygon x:Name="desklet_close" Canvas.Left="0" Canvas.Top="0"
            Points="4 4 8 8 4 12 6 14 10 10 14 14 16 12 12 8 16 4 14 2 10 6 6 2 4 4"
            Stroke="#66FFFFFF" StrokeThickness="3" Fill="#66FFFFFF" />
 
Index: glassyclock/Makefile.am
===================================================================
--- glassyclock/Makefile.am	(revision 118290)
+++ glassyclock/Makefile.am	(working copy)
@@ -1,19 +1,27 @@
 bin_SCRIPTS = example-glassyclock
 deskletdir = $(libdir)/desklets/example-glassyclock
+desklet=glassyclock.xap
 
-desklet_DATA = default.xaml clock.dll
+noinst_DATA = default.xaml App.xaml glassyclock.xap
 
 EXTRA_DIST = default.xaml clock.cs
 
 example-glassyclock: Makefile
 	echo "#!/bin/sh" > example-glassyclock
-	echo "mopen -d $(deskletdir)" >> example-glassyclock
+	echo "mopen -d $(desklet)" >> example-glassyclock
 	chmod +x example-glassyclock
 
-clock.dll: clock.cs $(top_builddir)/gtk/gtksilver.dll $(top_builddir)/class/lib/3.0/System.Windows.dll $(top_builddir)/class/lib/3.0/Mono.Moonlight.dll
-	gmcs -debug -out:$@ -target:library -r:$(top_builddir)/gtk/gtksilver.dll -r:$(top_builddir)/class/lib/3.0/System.Windows.dll -r:$(top_builddir)/class/lib/3.0/Mono.Moonlight.dll $(srcdir)/clock.cs
+glassyclock.xap: clock.cs default.xaml App.xaml
+	mono ../../../tools/mxap/mxap.exe --desktop --entry-point-type=Desklets.Clock.App
 
 CLEANFILES =			\
 	example-glassyclock	\
-	clock.dll		\
-	clock.dll.mdb
+	glassyclock.dll		\
+	glassyclock.dll.mdb	\
+	glassyclock.g.resources \
+	default.xaml.g.cs       \
+        App.xaml.g.cs           \
+        AppManifest.xaml        \
+	glassyclock.xap		\
+	glassyclock.html
+