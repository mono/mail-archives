<tt>
&lt;html&gt;&lt;head&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--&nbsp;DIV&nbsp;{margin:0px;}&nbsp;--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:tahoma,new&nbsp;york,times,serif;font-size:12pt&quot;&gt;&lt;div&gt;Hi,&lt;br&gt;&lt;br&gt;The&nbsp;path&nbsp;is&nbsp;right.&nbsp;The&nbsp;image&nbsp;is&nbsp;rendering&nbsp;because&nbsp;is&nbsp;marked&nbsp;as&nbsp;resource.&lt;br&gt;&lt;br&gt;What<br>
I'm&nbsp;trying&nbsp;to&nbsp;do&nbsp;is&nbsp;change&nbsp;this&nbsp;image&nbsp;with&nbsp;WriteableBitmap.&nbsp;The&nbsp;SL&nbsp;3<br>
RTM&nbsp;have&nbsp;breaking&nbsp;changes,&nbsp;and&nbsp;Moonligth&nbsp;WriteableBitmap&nbsp;is&nbsp;compatible<br>
with&nbsp;SL&nbsp;Beta.&nbsp;In&nbsp;SL&nbsp;Beta&nbsp;version&nbsp;was&nbsp;not&nbsp;allowed&nbsp;to&nbsp;write&nbsp;in&nbsp;an&nbsp;image<br>
that&nbsp;was&nbsp;already&nbsp;rendered,&nbsp;but&nbsp;now&nbsp;is&nbsp;possible.&nbsp;The&nbsp;acess&nbsp;to&nbsp;pixels&nbsp;was<br>
changed&nbsp;from&nbsp;an&nbsp;indexer&nbsp;to&nbsp;a&nbsp;property&nbsp;that&nbsp;returns&nbsp;an&nbsp;array&nbsp;int[],&nbsp;and<br>
now&nbsp;it's&nbsp;not&nbsp;possible&nbsp;to&nbsp;acess&nbsp;the&nbsp;pixel&nbsp;through&nbsp;Marshal.ReadInt32<br>
since&nbsp;we&nbsp;don't&nbsp;know&nbsp;the&nbsp;offset.&nbsp;I&amp;nbsp;&nbsp;tried&nbsp;to&nbsp;using&nbsp;the&nbsp;Marshal.Copy&nbsp;but<br>
I&nbsp;get&nbsp;an&nbsp;Security&nbsp;Access&nbsp;error.&lt;br&gt;&lt;br&gt;I&nbsp;don't&nbsp;know&nbsp;how&nbsp;cast&nbsp;from&nbsp;IntPtr&nbsp;(buffer)&nbsp;directly&nbsp;to&nbsp;an&nbsp;int[].&lt;br&gt;&lt;br&gt;Another&nbsp;issue&nbsp;is&nbsp;that&nbsp;the&nbsp;BitmapSource&nbsp;return&nbsp;0&nbsp;from&nbsp;the&nbsp;PixelWidth&nbsp;and&nbsp;PixelHeight&nbsp;properties.&nbsp;I&nbsp;started<br>
&nbsp;digging&nbsp;the&nbsp;C++&nbsp;code&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;the&nbsp;things&nbsp;works.&lt;br&gt;&lt;br&gt;Tony&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;border-left:&nbsp;2px&nbsp;solid&nbsp;rgb(16,&nbsp;16,&nbsp;255);&nbsp;margin-left:&nbsp;5px;&nbsp;padding-left:&nbsp;5px;&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;tahoma,new&nbsp;york,times,serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;font&nbsp;face=&quot;Tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;De:&lt;/span&gt;&lt;/b&gt;&nbsp;Diego&nbsp;Frata&nbsp;&amp;lt;diego.frata@gmail.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Para:&lt;/span&gt;&lt;/b&gt;&nbsp;Tony&nbsp;Alexander&nbsp;Hild&nbsp;&amp;lt;tony_hild@yahoo.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Enviadas:&lt;/span&gt;&lt;/b&gt;&nbsp;Terça-feira,&nbsp;21&nbsp;de&nbsp;Julho&nbsp;de&nbsp;2009&nbsp;18:07:18&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Assunto:&lt;/span&gt;&lt;/b&gt;&nbsp;Re:&nbsp;[Moonlight-list]&nbsp;Help&nbsp;with&nbsp;WriteableBitmap&lt;br&gt;&lt;/font&gt;&lt;br&gt;Hello,&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;some&nbsp;experience&nbsp;with&nbsp;WriteableBitmap&nbsp;and&nbsp;BitmapSource&nbsp;on&nbsp;WPF&nbsp;(not&nbsp;on&nbsp;Mono).&nbsp;Maybe&nbsp;I&nbsp;could&nbsp;help&nbsp;you&nbsp;with&nbsp;this&nbsp;implementation.&lt;br&gt;&lt;br&gt;I&nbsp;was&nbsp;looking&nbsp;at&nbsp;your&nbsp;code&nbsp;and&nbsp;it<br>
&nbsp;raised&nbsp;me&nbsp;a&nbsp;question:&nbsp;Can&nbsp;you&nbsp;confirm&nbsp;your&nbsp;instance&nbsp;of&nbsp;BitmapSource&nbsp;points&nbsp;to&nbsp;a&nbsp;valid&nbsp;file?&nbsp;The&nbsp;path&nbsp;you&nbsp;entered&nbsp;doesn't&nbsp;sound&nbsp;right&nbsp;to&nbsp;me&nbsp;Source=&quot;/test;component/2.png&quot;.&lt;br&gt;<br>
&lt;br&gt;The&nbsp;image&nbsp;control&nbsp;is&nbsp;rendering&nbsp;the&nbsp;image&nbsp;correctly?&lt;br&gt;&lt;br&gt;Sorry&nbsp;if&nbsp;it's&nbsp;a&nbsp;dumb&nbsp;question,&nbsp;but&nbsp;I'll&nbsp;try&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;source&nbsp;code&nbsp;later&nbsp;(i'm&nbsp;at&nbsp;work&nbsp;right&nbsp;now).&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;Diego&nbsp;Frata&lt;br&gt;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;ymailto=&quot;mailto:diego.frata@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;mailto:diego.frata@gmail.com&quot;&gt;diego.frata@gmail.com&lt;/a&gt;&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jul&nbsp;21,&nbsp;2009&nbsp;at&nbsp;3:33&nbsp;PM,&nbsp;Tony&nbsp;Alexander&nbsp;Hild&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;ymailto=&quot;mailto:tony_hild@yahoo.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;mailto:tony_hild@yahoo.com&quot;&gt;tony_hild@yahoo.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;tahoma,new&nbsp;york,times,serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&quot;&gt;&lt;div&gt;Hi,&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;made&nbsp;a&nbsp;simple&nbsp;program&nbsp;to&nbsp;test&nbsp;the&nbsp;WriteableBitmap.&lt;br&gt;btnTest_Click&nbsp;calls&nbsp;the&nbsp;Invert&nbsp;function.&lt;br&gt;&lt;br&gt;<br>
<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;xmlns:x=&quot;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;&gt;http://schemas.microsoft.com/winfx/2006/xaml&lt;/a&gt;&quot;&nbsp;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Width=&quot;1000&quot;&nbsp;Height=&quot;650&quot;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;x:Class=&quot;HelloMoon.Page&quot;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;lt;Grid<br>
&nbsp;x:Name=&quot;LayoutRoot&quot;&nbsp;Background=&quot;Black&quot;&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;lt;TextBlock&nbsp;x:Name=&quot;tblText&quot;&nbsp;FontSize=&quot;30&quot;&nbsp;Foreground=&quot;White&quot;&amp;gt;Hello&nbsp;Moon!&amp;lt;/TextBlock&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;lt;Button&nbsp;x:Name=&quot;btnTest&quot;&nbsp;Width=&quot;200&quot;&nbsp;VerticalAlignment=&quot;Top&quot;&nbsp;Height=&quot;50&quot;&nbsp;Canvas.Top=&quot;0&quot;&nbsp;Canvas.Left=&quot;100&quot;&nbsp;Click=&quot;btnTest_Click&quot;&nbsp;Content=&quot;Click&nbsp;me!&quot;&amp;gt;&amp;lt;/Button&amp;gt;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;lt;Image&nbsp;x:Name=&quot;MyBitmap&quot;&nbsp;Source=&quot;/test;component/2.png&quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Width=&quot;512&quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Height=&quot;512&quot;&nbsp;/&amp;gt;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;lt;/Grid&amp;gt;&lt;br&gt;&amp;lt;/UserControl&amp;gt;&lt;br&gt;<br>
<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;void&nbsp;Invert&nbsp;()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;const&nbsp;int&nbsp;imageWidth&nbsp;=&nbsp;512;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;const&nbsp;int&nbsp;imageHeight&nbsp;=&nbsp;512;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;WriteableBitmap&nbsp;b&nbsp;=&nbsp;new&nbsp;WriteableBitmap&nbsp;((BitmapSource)MyBitmap.Source);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//WriteableBitmap&nbsp;b&nbsp;=&nbsp;new&nbsp;WriteableBitmap&nbsp;(imageWidth,&nbsp;imageHeight,&nbsp;PixelFormats.Bgr32);&lt;br&gt;<br>
<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;(int&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&amp;lt;&nbsp;imageWidth;&nbsp;x++)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;(int&nbsp;y&nbsp;=&nbsp;0;&nbsp;y&nbsp;&amp;lt;&nbsp;imageHeight;&nbsp;y++)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;color&nbsp;=&nbsp;b.Pixels[y&nbsp;*&nbsp;imageWidth&nbsp;+&nbsp;x];&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(color&nbsp;==&nbsp;0)&nbsp;{&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;generate&nbsp;a&nbsp;color&nbsp;in&nbsp;Pbgra32<br>
&nbsp;format&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;byte[]&nbsp;components&nbsp;=&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;255,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;255,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;255,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;0&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;};&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;pixelValue&nbsp;=<br>
&nbsp;BitConverter.ToInt32&nbsp;(components,&nbsp;0);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;b.Pixels[y&nbsp;*&nbsp;imageWidth&nbsp;+&nbsp;x]&nbsp;=&nbsp;pixelValue;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&nbsp;else&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;b.Pixels[y&nbsp;*&nbsp;imageWidth&nbsp;+&nbsp;x]&nbsp;=&nbsp;b.Pixels[y&nbsp;*&nbsp;imageWidth&nbsp;+&nbsp;x]&nbsp;=&nbsp;0;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;b.Invalidate&nbsp;();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;MyBitmap.Source&nbsp;=&nbsp;b;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;&lt;br&gt;I&nbsp;also<br>
&nbsp;modified&nbsp;the&nbsp;constructor&nbsp;of&nbsp;WriteableBitmap:&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;WriteableBitmap&nbsp;(BitmapSource&nbsp;source)&nbsp;:&nbsp;base(NativeMethods.writeable_bitmap_new&nbsp;(),&nbsp;true)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rendered&nbsp;=&nbsp;true;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;PixelWidth&nbsp;=&nbsp;source.PixelWidth;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;PixelHeight&nbsp;=&nbsp;source.PixelHeight;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;PixelFormat&nbsp;=&nbsp;PixelFormats.Pbgra32;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(source&nbsp;!=&nbsp;null)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;NativeMethods.writeable_bitmap_initialize_from_bitmap_source&nbsp;(native,&nbsp;source.native);&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;But&nbsp;source.PixelWidth/Height&nbsp;always&nbsp;is&nbsp;0,&nbsp;so&nbsp;i&nbsp;get&nbsp;this&nbsp;error:&lt;br&gt;&lt;br&gt;&lt;h2&gt;&lt;i&gt;Value<br>
&nbsp;must&nbsp;be&nbsp;greater&nbsp;than&nbsp;zero&lt;/i&gt;&lt;/h2&gt;&lt;b&gt;Exception&nbsp;Details:&nbsp;&lt;/b&gt;System.ArgumentException:&nbsp;Value&nbsp;must&nbsp;be&nbsp;greater&nbsp;than&nbsp;zero&lt;br&gt;&lt;br&gt;&lt;b&gt;Stack&nbsp;Trace:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;table&nbsp;width=&quot;100%&quot;&nbsp;bgcolor=&quot;#ffffcc&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;pre&gt;&nbsp;&nbsp;&nbsp;at&nbsp;Mono..NativeMethods.CreateManagedException&nbsp;(MoonError&nbsp;err)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;at&nbsp;Mono.NativeMethods..dependency_object_set_value&nbsp;(IntPtr&nbsp;instance,&nbsp;IntPtr&nbsp;property,&nbsp;Mono.Value&amp;amp;&nbsp;value)&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&nbsp;Mono.NativeDependencyObjectHelper.SetValue&nbsp;(INativeDependencyObjectWrapper&nbsp;wrapper,&nbsp;System.Windows.DependencyProperty&nbsp;dp,&nbsp;System.Object&nbsp;value)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;at&nbsp;System.Windows.DependencyObject.SetValueImpl&nbsp;(System.Windows.DependencyProperty&nbsp;dp,&nbsp;System.Object&nbsp;value)&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&nbsp;System.Windows.DependencyObject.SetValue&nbsp;(System.Windows.DependencyProperty&nbsp;dp,&nbsp;System.Object&nbsp;value)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;at&nbsp;System.Windows.Media.Imaging.BitmapSource.set_PixelWidth&nbsp;(Int32&nbsp;value)&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&lt;br&gt;&nbsp;System.Windows.Media.Imaging.WriteableBitmap..ctor&nbsp;(System.Windows.Media.Imaging.BitmapSource&nbsp;source)&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&nbsp;HelloMoon.Page.Invert&nbsp;()&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&nbsp;HelloMoon.Page.btnTest_Click&nbsp;(System.Object&nbsp;sender,&nbsp;System.Windows.RoutedEventArgs&nbsp;e)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;at&nbsp;System.Windows.Controls.Primitives.ButtonBase.OnClick&nbsp;()&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&nbsp;System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp&nbsp;(System.Windows.Input.MouseButtonEventArgs&nbsp;e)&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&nbsp;System.Windows..Controls.Control.InvokeMouseLeftButtonUp&nbsp;(System.Windows.Input.MouseButtonEventArgs&nbsp;e)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;at&nbsp;Mono.Events.mouse_left_button_up_callback&nbsp;(IntPtr&nbsp;target,&nbsp;IntPtr&nbsp;calldata,&nbsp;IntPtr&nbsp;closure)&nbsp;[0x00000]&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;at&nbsp;Mono.Events+&amp;lt;CreateSafeHandler&amp;gt;c__AnonStorey1.&amp;lt;&amp;gt;m__2&nbsp;(IntPtr&nbsp;a,&nbsp;IntPtr&nbsp;b,&nbsp;IntPtr&nbsp;c)&nbsp;[0x00000]&nbsp;&lt;/pre&gt;<br>
<br>
&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;But&nbsp;as&nbsp;the&nbsp;BitmapSource&nbsp;is&nbsp;already&nbsp;rendered,&nbsp;it&nbsp;should&nbsp;have&nbsp;the&nbsp;Height&nbsp;and&nbsp;Width&nbsp;properties&nbsp;set.&lt;br&gt;&lt;br&gt;What<br>
&nbsp;I'm&nbsp;doing&nbsp;wrong?&lt;br&gt;I'm&nbsp;using&nbsp;trunk&nbsp;version,&nbsp;from&nbsp;mono,&nbsp;mcs,&nbsp;libgdi&nbsp;and&nbsp;moon.&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;&lt;br&gt;Tony&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&nbsp;size=&quot;1&quot;&gt;Veja&nbsp;quais&nbsp;são&nbsp;os&nbsp;assuntos&nbsp;do&nbsp;momento&nbsp;no&nbsp;Yahoo!&nbsp;+&nbsp;Buscados:&nbsp;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://br.rd.yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/&quot;&gt;Top&nbsp;10&lt;/a&gt;&nbsp;-&nbsp;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://br.rd.yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/celebridades/&quot;&gt;Celebridades&lt;/a&gt;&nbsp;-&nbsp;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://br.rd..yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/m%C3%BAsica/&quot;&gt;Música&lt;/a&gt;&nbsp;-&nbsp;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://br.rd.yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/esportes/&quot;&gt;Esportes&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Moonlight-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;ymailto=&quot;mailto:Moonlight-list@lists.ximian.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;mailto:Moonlight-list@lists.ximian.com&quot;&gt;Moonlight-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/moonlight-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/moonlight-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&nbsp;size=1&gt;Veja&nbsp;quais&nbsp;são&nbsp;os&nbsp;assuntos&nbsp;do&nbsp;momento&nbsp;no&nbsp;Yahoo!&nbsp;+&nbsp;Buscados:&nbsp;&lt;a&nbsp;href=&quot;http://br.rd.yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/&quot;&gt;Top&nbsp;10&lt;/a&gt;&nbsp;-&nbsp;&lt;a&nbsp;href=&quot;http://br.rd.yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/celebridades/&quot;&gt;Celebridades&lt;/a&gt;&nbsp;-&nbsp;&lt;a&nbsp;href=&quot;http://br..rd.yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/m%C3%BAsica/&quot;&gt;Música&lt;/a&gt;&nbsp;-&nbsp;&lt;a&nbsp;href=&quot;http://br.rd.yahoo.com/mail/taglines/mail/*http://br.maisbuscados.yahoo.com/esportes/&quot;&gt;Esportes&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
