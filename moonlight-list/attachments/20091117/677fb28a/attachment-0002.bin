Index: src/xaml.cpp
===================================================================
--- src/xaml.cpp	(revision 146380)
+++ src/xaml.cpp	(working copy)
@@ -51,6 +51,7 @@
 #include "deployment.h"
 #include "grid.h"
 #include "deepzoomimagetilesource.h"
+#include "bitmapcache.h"
 
 
 class XamlElementInfo;
@@ -3351,6 +3352,20 @@
 }
 
 bool
+cache_mode_from_str (XamlParserInfo *p, const char *str, CacheMode **res)
+{
+	Type *t = Type::Find (p->deployment, str);
+	if (!t)
+		return false;
+
+	if (!t->IsSubclassOf (Type::CACHEMODE))
+		return false;
+
+	*res = (CacheMode *) t->CreateInstance ();
+	return true;
+}
+
+bool
 value_from_str (Type::Kind type, const char *prop_name, const char *str, Value **v)
 {
 	bool v_set = false;
@@ -3827,6 +3842,16 @@
 		*v_set = true;
 		break;
 	}
+	case Type::CACHEMODE: {
+		CacheMode *cm;
+
+		if (!cache_mode_from_str (p, s, &cm))
+			break;
+
+		*v = Value::CreateUnrefPtr (cm);
+		*v_set = true;
+		break;
+	}
 	default:
 		// we don't care about NULL or empty values
 		if (!IS_NULL_OR_EMPTY (s)) {
