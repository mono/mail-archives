<tt>
well&nbsp;if&nbsp;you&nbsp;try&nbsp;extracting&nbsp;stroke&nbsp;points&nbsp;from&nbsp;a&nbsp;stroke&nbsp;in&nbsp;a&nbsp;strokecollection&nbsp;for&nbsp;an&nbsp;inkpresenter&nbsp;then&nbsp;you&nbsp;will&nbsp;get&nbsp;the&nbsp;exception.&lt;br&gt;&lt;br&gt;But&nbsp;this&nbsp;is&nbsp;the&nbsp;code&nbsp;where&nbsp;its&nbsp;failing&nbsp;in&nbsp;my&nbsp;xaml.cs&nbsp;code&nbsp;-&nbsp;the&nbsp;calls&nbsp;in&nbsp;bold.&lt;br&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;StrokeCollection&nbsp;allstrokes&nbsp;=&nbsp;inkP.Strokes;&lt;br&gt;&lt;br&gt;           &nbsp;string&nbsp;strokesXAML&nbsp;=&nbsp;&amp;quot;&amp;lt;StrokeCollection&amp;gt;&amp;quot;;&lt;br&gt;<br>
&lt;br&gt;           &nbsp;if&nbsp;(allstrokes.Count&nbsp;&amp;gt;&nbsp;0)&lt;br&gt;           &nbsp;{&lt;br&gt;               &nbsp;foreach(Stroke&nbsp;stk&nbsp;in&nbsp;allstrokes)&lt;br&gt;               &nbsp;{&lt;br&gt;                   &nbsp;DrawingAttributes&nbsp;atts&nbsp;=&nbsp;stk.DrawingAttributes;&lt;br&gt;&lt;br&gt;                   &nbsp;strokesXAML&nbsp;=&nbsp;string.Concat(strokesXAML,&amp;quot;&amp;lt;Stroke&amp;gt;&amp;lt;Stroke.DrawingAttributes&amp;gt;&amp;lt;DrawingAttributes&nbsp;Color=\&amp;quot;&amp;quot;,&amp;quot;Black&amp;quot;,&amp;quot;\&amp;quot;&nbsp;&amp;quot;,&lt;br&gt;<br>
                       &nbsp;&amp;quot;OutlineColor=\&amp;quot;&amp;quot;,&amp;quot;White&amp;quot;,&amp;quot;\&amp;quot;&nbsp;&amp;quot;,&amp;quot;Width=\&amp;quot;&amp;quot;,atts.Width,&amp;quot;\&amp;quot;&nbsp;&amp;quot;,&nbsp;&amp;quot;Height=\&amp;quot;&amp;quot;,&nbsp;atts.Height,&nbsp;&amp;quot;\&amp;quot;&nbsp;&amp;quot;,&lt;br&gt;<br>
                       &nbsp;&amp;quot;/&amp;gt;&amp;lt;/Stroke.DrawingAttributes&amp;gt;&amp;lt;Stroke.StylusPoints&amp;gt;&amp;quot;);&lt;br&gt;&lt;br&gt;                   &nbsp;StylusPointCollection&nbsp;stylusPoints&nbsp;=&nbsp;stk.StylusPoints;&lt;br&gt;&lt;br&gt;                   &nbsp;foreach&nbsp;(StylusPoint&nbsp;point&nbsp;in&nbsp;stylusPoints)&lt;br&gt;<br>
                   &nbsp;{&lt;br&gt;                       &nbsp;strokesXAML&nbsp;=&nbsp;string.Concat(strokesXAML,&nbsp;&amp;quot;&amp;lt;StylusPoint&nbsp;X=\&amp;quot;&amp;quot;,&nbsp;&lt;b&gt;point.X&lt;/b&gt;,&nbsp;&amp;quot;\&amp;quot;&nbsp;&amp;quot;,&nbsp;&amp;quot;Y=\&amp;quot;&amp;quot;,&nbsp;&lt;b&gt;point.Y&lt;/b&gt;,&nbsp;&amp;quot;\&amp;quot;&nbsp;/&amp;gt;&amp;quot;);&lt;br&gt;<br>
                   &nbsp;}&lt;br&gt;&lt;br&gt;                   &nbsp;strokesXAML&nbsp;=&nbsp;string.Concat(strokesXAML,&nbsp;&amp;quot;&amp;lt;/Stroke.StylusPoints&amp;gt;&amp;lt;/Stroke&amp;gt;&amp;quot;);&lt;br&gt;               &nbsp;}&lt;br&gt;&lt;br&gt;               &nbsp;strokesXAML&nbsp;=&nbsp;string.Concat(strokesXAML,&nbsp;&amp;quot;&amp;lt;/StrokeCollection&amp;gt;&amp;quot;);&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;This&nbsp;code&nbsp;gets&nbsp;called&nbsp;when&nbsp;I&nbsp;click&nbsp;a&nbsp;button&nbsp;on&nbsp;my&nbsp;silverlight(moonlight)&nbsp;control.&nbsp;So&nbsp;as&nbsp;you&nbsp;can&nbsp;see&nbsp;basically&nbsp;its&nbsp;extracting&nbsp;the&nbsp;stroke&nbsp;data&nbsp;and&nbsp;serializing&nbsp;it&nbsp;ready&nbsp;to&nbsp;send&nbsp;to&nbsp;a&nbsp;server.&lt;br&gt;&lt;br&gt;Thanks&lt;br&gt;<br>
&lt;br&gt;Mike&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/5/12&nbsp;Geoff&nbsp;Norton&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:gnorton@novell.com&quot;&gt;gnorton@novell.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Please&nbsp;file&nbsp;a&nbsp;bug&nbsp;with&nbsp;a&nbsp;testcase.&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&lt;br&gt;<br>
&lt;br&gt;<br>
-g&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;12-May-09,&nbsp;at&nbsp;12:16&nbsp;PM,&nbsp;Mike&nbsp;Harding&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
Hi&nbsp;All,&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;I&nbsp;try&nbsp;and&nbsp;get&nbsp;x&nbsp;/&nbsp;y&nbsp;points&nbsp;from&nbsp;strokes&nbsp;in&nbsp;a&nbsp;strokesCollection&nbsp;(System.Windows.Ink)&nbsp;I&nbsp;see&nbsp;the&nbsp;following&nbsp;exception&nbsp;with&nbsp;the&nbsp;moonlight&nbsp;2&nbsp;preview&nbsp;running&nbsp;in&nbsp;firefox&nbsp;on&nbsp;jaunty:&lt;br&gt;<br>
&lt;br&gt;<br>
at&nbsp;Mono.NativeDependencyObjectHelper.lookup(kind&nbsp;k,&nbsp;IntPtr&nbsp;ptr)&lt;br&gt;<br>
at&nbsp;Mono.Value.ToObject&nbsp;(System.Type&nbsp;type,&nbsp;IntPtr&nbsp;value)&lt;br&gt;<br>
at&nbsp;System.Windows.PresentationFrameworkCollection&amp;#39;1+GenericCollectionIterator[System.Windows.Input.StylusPoint].GetCurrent&nbsp;()&lt;br&gt;<br>
at&nbsp;System.Windows.PresentationFrameworkCollection&amp;#39;1+GenericCollectionIterator[System.Windows.Input.StylusPoint].getCurrent&nbsp;()&lt;br&gt;<br>
&lt;br&gt;<br>
Any&nbsp;ideas&nbsp;how&nbsp;I&nbsp;could&nbsp;get&nbsp;around&nbsp;this&nbsp;without&nbsp;having&nbsp;to&nbsp;wait&nbsp;for&nbsp;the&nbsp;next&nbsp;update&nbsp;to&nbsp;the&nbsp;preview.&lt;br&gt;<br>
&lt;br&gt;<br>
(Works&nbsp;ok&nbsp;with&nbsp;the&nbsp;normal&nbsp;silverlight&nbsp;2&nbsp;on&nbsp;a&nbsp;windows&nbsp;box&nbsp;btw)&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&lt;br&gt;<br>
&lt;br&gt;<br>
Mike&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
_______________________________________________&lt;br&gt;<br>
Moonlight-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Moonlight-list@lists.ximian.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Moonlight-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/moonlight-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/moonlight-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
