<tt>
On&nbsp;Mon,&nbsp;Nov&nbsp;24,&nbsp;2008&nbsp;at&nbsp;3:23&nbsp;AM,&nbsp;Alan&nbsp;McGovern&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:alan.mcgovern@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;alan.mcgovern@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
Hey,&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;In&nbsp;the&nbsp;unmanaged&nbsp;code&nbsp;it&nbsp;also&nbsp;seems&nbsp;like&nbsp;we&amp;#39;re&nbsp;using&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;quot;Element&amp;quot;&nbsp;in&nbsp;a&nbsp;different&nbsp;way&nbsp;than&nbsp;the&nbsp;managed&nbsp;code&nbsp;-&nbsp;to&nbsp;mean&nbsp;&amp;quot;Source&amp;quot;,&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;we&amp;#39;re&nbsp;limiting&nbsp;source&nbsp;elements&nbsp;to&nbsp;FrameworkElements,&nbsp;when&nbsp;it&nbsp;should&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;DependencyObject,&nbsp;right?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;think&nbsp;the&nbsp;naming&nbsp;has&nbsp;confused&nbsp;people.&nbsp;The&nbsp;&amp;#39;source&amp;#39;&nbsp;object&nbsp;can&nbsp;be&lt;br&gt;<br>
anything&nbsp;at&nbsp;all.&nbsp;The&nbsp;only&nbsp;condition&nbsp;is&nbsp;that&nbsp;when&nbsp;you&amp;#39;re&nbsp;binding&nbsp;to&nbsp;a&lt;br&gt;<br>
regular&nbsp;CLR&nbsp;object,&nbsp;you&nbsp;must&nbsp;target&nbsp;one&nbsp;of&nbsp;it&amp;#39;s&nbsp;properties,&nbsp;you&nbsp;cannot&lt;br&gt;<br>
binding&nbsp;a&nbsp;public&nbsp;field.&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;the&nbsp;idea&nbsp;is&nbsp;that&nbsp;you&nbsp;bind&nbsp;a&nbsp;DependencyProperty&nbsp;on&nbsp;a&lt;br&gt;<br>
FrameworkElement&nbsp;to&nbsp;a&nbsp;property&nbsp;value&nbsp;on&nbsp;an&nbsp;object.&lt;br&gt;<br>
&lt;br&gt;<br>
Source&nbsp;=&nbsp;object&lt;br&gt;<br>
Target&nbsp;=&nbsp;FrameworkElement&lt;br&gt;<br>
&lt;div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;In&nbsp;the&nbsp;general&nbsp;case,&nbsp;yes.&amp;nbsp;&nbsp;I&nbsp;was&nbsp;talking&nbsp;specifically&nbsp;about&nbsp;the&nbsp;unmanaged&nbsp;case&nbsp;there,&nbsp;which&nbsp;can&nbsp;only&nbsp;directly&nbsp;handle&nbsp;the&nbsp;the&nbsp;source&nbsp;object&nbsp;being&nbsp;a&nbsp;DependencyObject&nbsp;subclass&nbsp;(and&nbsp;the&nbsp;the&nbsp;path&nbsp;referring&nbsp;to&nbsp;a&nbsp;DependencyProperty).&amp;nbsp;&nbsp;Right&nbsp;now&nbsp;the&nbsp;unmanaged&nbsp;code&nbsp;lists&nbsp;both&nbsp;source&nbsp;and&nbsp;target&nbsp;as&nbsp;FrameworkElements.&amp;nbsp;&nbsp;Clearly&nbsp;this&nbsp;is&nbsp;wrong,&nbsp;and&nbsp;since&nbsp;the&nbsp;unmanaged&nbsp;hookups&nbsp;rely&nbsp;on&nbsp;DependencyObject::OnPropertyChanged...&lt;br&gt;<br>
&lt;br&gt;But&nbsp;I&nbsp;take&nbsp;it&nbsp;you&nbsp;agreed&nbsp;with&nbsp;my&nbsp;assessment:&nbsp;The&nbsp;naming&nbsp;in&nbsp;both&nbsp;managed&nbsp;and&nbsp;unmanaged&nbsp;code&nbsp;(and&nbsp;typing&nbsp;in&nbsp;unmanaged&nbsp;code)&nbsp;needs&nbsp;to&nbsp;change?&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;ve&nbsp;been&nbsp;thinking&nbsp;about&nbsp;the&nbsp;ReadLocalValue&nbsp;implementation&nbsp;we&nbsp;have&nbsp;now.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;We&nbsp;have&nbsp;one?&nbsp;Last&nbsp;time&nbsp;i&nbsp;looked&nbsp;we&nbsp;didn&amp;#39;t&nbsp;;)&nbsp;I&nbsp;don&amp;#39;t&nbsp;think&nbsp;there&amp;#39;s&nbsp;a&lt;br&gt;<br>
native&nbsp;equivalent&nbsp;of&nbsp;this&nbsp;method&nbsp;yet,&nbsp;and&nbsp;we&nbsp;do&nbsp;need&nbsp;one.&lt;br&gt;<br>
&lt;div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;see&nbsp;my&nbsp;response&nbsp;to&nbsp;myself...&nbsp;:)&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Right&nbsp;now&nbsp;in&nbsp;FrameworkElement::SetValueImplWithError,&nbsp;we&nbsp;check&nbsp;to&nbsp;see&nbsp;if&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;value&nbsp;we&amp;#39;re&nbsp;setting&nbsp;is&nbsp;BindingExpression/Style,&nbsp;and&nbsp;use&nbsp;that&nbsp;value&nbsp;as&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;current_value&nbsp;for&nbsp;the&nbsp;Property,&nbsp;just&nbsp;so&nbsp;we&nbsp;get&nbsp;ReadLocalValue&nbsp;semantics.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Not&nbsp;quite.&nbsp;I&amp;#39;m&nbsp;just&nbsp;going&nbsp;to&nbsp;take&nbsp;Styles&nbsp;as&nbsp;my&nbsp;example:&lt;br&gt;<br>
&lt;br&gt;<br>
Firstly,&nbsp;bear&nbsp;in&nbsp;mind&nbsp;that&nbsp;what&nbsp;we&nbsp;want&nbsp;is&nbsp;for&nbsp;the&nbsp;GetValue&nbsp;logic&nbsp;to&lt;br&gt;<br>
be&nbsp;a&nbsp;plain&nbsp;and&nbsp;simple&nbsp;lookup&nbsp;in&nbsp;a&nbsp;hashtable.&nbsp;Now,&nbsp;suppose&nbsp;we&nbsp;have&nbsp;a&lt;br&gt;<br>
standard&nbsp;Rectangle&nbsp;and&nbsp;we&nbsp;apply&nbsp;a&nbsp;style&nbsp;(rectangle.SetValue&lt;br&gt;<br>
(FrameworkElement.StyleProperty,&nbsp;myStyle)).&nbsp;In&nbsp;order&nbsp;to&nbsp;have&nbsp;the&lt;br&gt;<br>
simple&nbsp;logic&nbsp;in&nbsp;GetValue,&nbsp;we&nbsp;have&nbsp;to&nbsp;iterate&nbsp;all&nbsp;the&nbsp;Setters&nbsp;in&nbsp;the&lt;br&gt;<br>
style&nbsp;and&nbsp;apply&nbsp;their&nbsp;value&nbsp;in&nbsp;a&nbsp;series&nbsp;of&nbsp;SetValue&nbsp;calls.&nbsp;Psuedo&nbsp;code&lt;br&gt;<br>
for&nbsp;what&amp;#39;s&nbsp;in&nbsp;DO::SetValueWithError:&lt;br&gt;<br>
&lt;br&gt;<br>
if&nbsp;(property&nbsp;==&nbsp;FrameworkElement.StyleProperty)&nbsp;{&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Style&nbsp;style&nbsp;=&nbsp;(Style)value;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;foreach&nbsp;(Setter&nbsp;setter&nbsp;in&nbsp;style)&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;SetValue&nbsp;(setter.Property,&nbsp;setter.Value);&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Not&nbsp;incredibly&nbsp;important,&nbsp;but&nbsp;this&nbsp;wouldn&amp;#39;t&nbsp;be&nbsp;done&nbsp;in&nbsp;SetValue&nbsp;-&nbsp;it&nbsp;should&nbsp;be&nbsp;done&nbsp;in&nbsp;FrameworkElement::OnPropertyChanged.&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
<br>
Unfortunately&nbsp;this&nbsp;means&nbsp;that&nbsp;it&amp;#39;s&nbsp;now&nbsp;impossible&nbsp;to&nbsp;tell&nbsp;what&nbsp;the&lt;br&gt;<br>
&amp;#39;LocalValue&amp;#39;&nbsp;is.&nbsp;We&nbsp;can&amp;#39;t&nbsp;just&nbsp;call&nbsp;GetValueNoDefault&nbsp;because&nbsp;there&nbsp;is&lt;br&gt;<br>
now&nbsp;a&nbsp;value&nbsp;there,&nbsp;but&nbsp;that&nbsp;value&nbsp;is&nbsp;*not*&nbsp;a&nbsp;local&nbsp;value.&nbsp;Styles&lt;br&gt;<br>
aren&amp;#39;t&nbsp;considered&nbsp;local&nbsp;values.&nbsp;So,&nbsp;by&nbsp;getting&nbsp;our&nbsp;simple&nbsp;logic&nbsp;for&lt;br&gt;<br>
GetValue,&nbsp;it&amp;#39;s&nbsp;now&nbsp;impossible&nbsp;to&nbsp;use&nbsp;GetValueNoDefault&nbsp;to&nbsp;get&lt;br&gt;<br>
ReadLocalValue&nbsp;semantics.&lt;br&gt;<br>
&lt;div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;no&nbsp;need.&amp;nbsp;&nbsp;as&nbsp;you&nbsp;mention&nbsp;below&nbsp;we&nbsp;could&nbsp;have&nbsp;(and&nbsp;should&nbsp;have)&nbsp;ReadLocalValue&nbsp;in&nbsp;unmanaged&nbsp;code.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
This&nbsp;leads&nbsp;me&nbsp;to&nbsp;another&nbsp;point.&nbsp;Suppose&nbsp;we&nbsp;style&nbsp;the&nbsp;WidthProperty&nbsp;and&lt;br&gt;<br>
we&nbsp;also&nbsp;databind&nbsp;it.&nbsp;Lets&nbsp;assume&nbsp;databinding&nbsp;is&nbsp;first,&nbsp;then&nbsp;styling&nbsp;is&lt;br&gt;<br>
second.&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;we&nbsp;databind,&nbsp;the&nbsp;local&nbsp;value&nbsp;is&nbsp;set.&nbsp;Then,&nbsp;when&nbsp;we&nbsp;apply&nbsp;the&lt;br&gt;<br>
style,&nbsp;nothing&nbsp;happens&nbsp;as&nbsp;we&amp;#39;ve&nbsp;already&nbsp;applied&nbsp;a&nbsp;local&nbsp;value.&nbsp;If&nbsp;we&lt;br&gt;<br>
remove&nbsp;the&nbsp;databinding,&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;style&nbsp;should&nbsp;be&nbsp;automatically&lt;br&gt;<br>
be&nbsp;set&nbsp;and&nbsp;ReadLocalValue&nbsp;will&nbsp;return&nbsp;DependencyProperty.UnsetValue&nbsp;to&lt;br&gt;<br>
indicate&nbsp;there&nbsp;is&nbsp;no&nbsp;locally&nbsp;set&nbsp;value.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;think&nbsp;what&nbsp;we&nbsp;need&nbsp;is&nbsp;an&nbsp;unmanaged&nbsp;equivalent&nbsp;of&nbsp;GetValue&nbsp;and&lt;br&gt;<br>
ReadLocalValue.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;agreed&nbsp;-&nbsp;we&nbsp;do&nbsp;need&nbsp;those,&nbsp;and&nbsp;we&nbsp;already&nbsp;have&nbsp;the&nbsp;former.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&nbsp;I&nbsp;think&nbsp;it&nbsp;would&nbsp;be&nbsp;simplest&nbsp;to&nbsp;implement&nbsp;it&nbsp;as:&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
ReadLocalValue&nbsp;(DependencyProperty&nbsp;property)&nbsp;{&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;if&nbsp;(databindings.Contains&nbsp;(property))&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;return&nbsp;databindings&nbsp;[property];&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;//&nbsp;Check&nbsp;for&nbsp;other&nbsp;&amp;#39;local&nbsp;values&amp;#39;.&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;//&nbsp;Finally,&nbsp;return&nbsp;the&nbsp;current_value&nbsp;in&nbsp;the&nbsp;hash&nbsp;table.&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;return&nbsp;current_values&nbsp;[property];&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;yes&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
GetValue&nbsp;(DependencyProperty&nbsp;property)&nbsp;{&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Value&nbsp;*value&nbsp;=&nbsp;ReadLocalValue&nbsp;();&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;if&nbsp;(value&nbsp;is&nbsp;BindingExpression)&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;return&nbsp;((BindingExpression)value).GetValue&nbsp;();&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;there&amp;#39;s&nbsp;no&nbsp;reason&nbsp;for&nbsp;this.&amp;nbsp;&nbsp;The&nbsp;local&nbsp;always&nbsp;takes&nbsp;precedence&nbsp;over&nbsp;styles,&nbsp;and&nbsp;data&nbsp;binding&nbsp;would&nbsp;set&nbsp;the&nbsp;current_value.&amp;nbsp;&nbsp;If&nbsp;there&amp;#39;s&nbsp;a&nbsp;current&nbsp;value&nbsp;we&nbsp;return&nbsp;it.&amp;nbsp;&nbsp;A&nbsp;binding&nbsp;is&nbsp;not&nbsp;a&nbsp;container&nbsp;for&nbsp;a&nbsp;value.&amp;nbsp;&nbsp;It&amp;#39;s&nbsp;simply&nbsp;a&nbsp;linkage&nbsp;that&nbsp;hooks&nbsp;up&nbsp;property&nbsp;change&nbsp;notifications&nbsp;with&nbsp;SetValue&nbsp;calls.&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;if&nbsp;(value&nbsp;==&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;(value&nbsp;=&nbsp;GetValue&nbsp;(StyleProperty)&nbsp;!=&nbsp;null)&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;value&nbsp;=&nbsp;style.GetValue&nbsp;(property);&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;//&nbsp;If&nbsp;this&nbsp;property&nbsp;does&nbsp;not&nbsp;have&nbsp;a&nbsp;style&nbsp;attached,&nbsp;the&nbsp;above&nbsp;call&lt;br&gt;<br>
will&nbsp;return&nbsp;null&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;//&nbsp;so&nbsp;we&nbsp;return&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;DependencyProperty&nbsp;instead&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;if&nbsp;(value&nbsp;==&nbsp;null)&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;value&nbsp;=&nbsp;property.DefaultValue;&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;return&nbsp;value;&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;benefit&nbsp;of&nbsp;this&nbsp;approach&nbsp;(as&nbsp;I&nbsp;see&nbsp;it)&nbsp;is&nbsp;that&nbsp;Style&nbsp;values&nbsp;will&lt;br&gt;<br>
magically&nbsp;get&nbsp;applied/ignored&nbsp;correctly&nbsp;whenever&nbsp;the&nbsp;local&nbsp;value&nbsp;is&lt;br&gt;<br>
changed.&nbsp;This&nbsp;means&nbsp;that&nbsp;styles&nbsp;do&nbsp;not&nbsp;have&nbsp;to&nbsp;listen&nbsp;for&nbsp;property&lt;br&gt;<br>
changes.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&amp;#39;m&nbsp;also&nbsp;definitely&nbsp;hoping&nbsp;to&nbsp;keep&nbsp;as&nbsp;much&nbsp;logic&nbsp;(and,&nbsp;uh,&nbsp;re-entrancy&nbsp;:)&nbsp;out&nbsp;of&nbsp;GetValue&nbsp;as&nbsp;possible.&amp;nbsp;&nbsp;Styles&nbsp;may&nbsp;force&nbsp;that,&nbsp;but&nbsp;databindings&nbsp;don&amp;#39;t.&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
Taking&nbsp;a&nbsp;step&nbsp;back,&nbsp;this&nbsp;will&nbsp;also&nbsp;simplify&nbsp;databindings.&nbsp;The&lt;br&gt;<br>
DataBinding&nbsp;class&nbsp;won&amp;#39;t&nbsp;have&nbsp;to&nbsp;listen&nbsp;for&nbsp;property&nbsp;changed&nbsp;events&lt;br&gt;<br>
either.&nbsp;In&nbsp;the&nbsp;case&nbsp;of&nbsp;a&nbsp;one&nbsp;way&nbsp;binding&nbsp;what&nbsp;would&nbsp;happen&nbsp;is&nbsp;that&nbsp;the&lt;br&gt;<br>
databinding&nbsp;would&nbsp;raise&nbsp;the&nbsp;PropertyChanged&nbsp;event&nbsp;rather&nbsp;than&nbsp;calling&lt;br&gt;<br>
SetValue&nbsp;directly.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;There&amp;#39;s&nbsp;no&nbsp;reason&nbsp;to&nbsp;do&nbsp;this.&amp;nbsp;&nbsp;Bindings&nbsp;are&nbsp;considered&nbsp;local&nbsp;values,&nbsp;so&nbsp;when&nbsp;you&nbsp;set&nbsp;a&nbsp;binding&nbsp;on&nbsp;a&nbsp;property,&nbsp;it&nbsp;should&nbsp;clear&nbsp;the&nbsp;previous&nbsp;local&nbsp;value,&nbsp;so&nbsp;the&nbsp;binding&nbsp;can&nbsp;just&nbsp;call&nbsp;SetValue.&amp;nbsp;&nbsp;We&nbsp;still&nbsp;have&nbsp;things&nbsp;that&nbsp;shouldn&amp;#39;t&nbsp;be&nbsp;calling&nbsp;OnPropertyChanged&nbsp;calling&nbsp;it.&amp;nbsp;&nbsp;we&nbsp;shouldn&amp;#39;t&nbsp;add&nbsp;another.&lt;br&gt;<br>
&lt;br&gt;One&nbsp;point&nbsp;I&nbsp;was&nbsp;trying&nbsp;to&nbsp;get&nbsp;across&nbsp;in&nbsp;my&nbsp;first&nbsp;message&nbsp;is&nbsp;the&nbsp;possibility&nbsp;that&nbsp;&amp;quot;current_values&amp;quot;&nbsp;!=&nbsp;&amp;quot;local_values&amp;quot;&nbsp;--&nbsp;It&amp;#39;s&nbsp;simply&nbsp;the&nbsp;hash&nbsp;of&nbsp;current&nbsp;values&nbsp;of&nbsp;properties&nbsp;based&nbsp;on&nbsp;whatever&nbsp;mechanism&nbsp;we&nbsp;want.&amp;nbsp;&nbsp;It&amp;#39;s&nbsp;sole&nbsp;purpose&nbsp;is&nbsp;to&nbsp;make&nbsp;GetValue()&nbsp;a&nbsp;simple&nbsp;hash&nbsp;lookup.&amp;nbsp;&nbsp;If&nbsp;you&nbsp;think&nbsp;about&nbsp;it&nbsp;that&nbsp;way,&nbsp;it&nbsp;seems&nbsp;to&nbsp;me&nbsp;that&nbsp;we&nbsp;can&nbsp;do&nbsp;pretty&nbsp;much&nbsp;everything&nbsp;in&nbsp;the&nbsp;Setters&nbsp;(SetValue,&nbsp;SetBinding,&nbsp;etc)&nbsp;and&nbsp;ClearValue.&amp;nbsp;&nbsp;It&nbsp;changes&nbsp;logic&nbsp;slightly,&nbsp;and&nbsp;involves&nbsp;&amp;quot;re-instating&amp;quot;&nbsp;values&nbsp;from&nbsp;lower&nbsp;precedence&nbsp;providers&nbsp;(templates,&nbsp;styles,&nbsp;etc)&nbsp;when&nbsp;higher&nbsp;precedence&nbsp;values&nbsp;aren&amp;#39;t&nbsp;available&nbsp;(specifically&nbsp;in&nbsp;ClearValue),&nbsp;but&nbsp;this&nbsp;also&nbsp;moves&nbsp;everything&nbsp;that&nbsp;might&nbsp;be&nbsp;(serious&nbsp;air-quotes&nbsp;here)&nbsp;&amp;quot;expensive&amp;quot;&nbsp;to&nbsp;cases&nbsp;where&nbsp;we&nbsp;already&nbsp;know&nbsp;there&amp;#39;s&nbsp;an&nbsp;expense&nbsp;-&nbsp;areas&nbsp;where&nbsp;we&nbsp;generate&nbsp;property&nbsp;change&nbsp;notifications.&lt;br&gt;<br>
&lt;br&gt;another&nbsp;alternative&nbsp;is&nbsp;of&nbsp;course&nbsp;to&nbsp;rename&nbsp;&amp;quot;current_values&amp;quot;&nbsp;to&nbsp;&amp;quot;local_values&amp;quot;&nbsp;and&nbsp;start&nbsp;making&nbsp;things&nbsp;explicit.&lt;br&gt;&lt;br&gt;toshok&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
