<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Moonlight-list] OpenSuse 11.2 &amp; binutils-devel
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:moonlight-list%40lists.ximian.com?Subject=%5BMoonlight-list%5D%20OpenSuse%2011.2%20%26%20binutils-devel&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000757.html">
   <LINK REL="Next"  HREF="000741.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Moonlight-list] OpenSuse 11.2 &amp; binutils-devel</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:moonlight-list%40lists.ximian.com?Subject=%5BMoonlight-list%5D%20OpenSuse%2011.2%20%26%20binutils-devel&In-Reply-To="
       TITLE="[Moonlight-list] OpenSuse 11.2 &amp; binutils-devel">rolflists at ya.com
       </A><BR>
    <I>Wed Nov 18 05:47:03 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000757.html">[Moonlight-list] Video on demand player NPO
</A></li>
        <LI>Next message: <A HREF="000741.html">[Moonlight-list] changes committed to the 2.0 branch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#733">[ date ]</a>
              <a href="thread.html#733">[ thread ]</a>
              <a href="subject.html#733">[ subject ]</a>
              <a href="author.html#733">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

With OpenSuse 11.2 there is a build problem if you have binutils-devel
installed:

In file included from /usr/include/demangle.h:33,
                 from debug.cpp:37:
/usr/include/libiberty.h:105: error: new declaration 'char* basename(const
char*)'
/usr/include/string.h:601: error: ambiguates old declaration 'const char*
basename(const char*)

I &quot;fixed&quot; it locally with the patch below, but it has one problem: it causes
g++ to give this warning for every cpp file:

../config.h:142:1: warning: &quot;_GNU_SOURCE&quot; redefined
&lt;command-line&gt;: warning: this is the location of the previous definition

I have no idea if this approach is the right one, somebody who knows more
about autoconf should probably have a look at it ;-) My final solution was
to uninstall binutils-devel.

Rolf

commit b71435f57a7cfdf87a5483b11541f869b503c329
Author: Rolf Bjarne Kvinge &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-list">RKvinge at novell.com</A>&gt;
Date:   Fri Nov 13 10:36:59 2009 +0100

    2009-11-13  Rolf Bjarne Kvinge  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-list">RKvinge at novell.com</A>&gt;
    
        * configure.ac: Add a check for basename, so that HAVE_DECL_BASENAME
is
        set. libiberty.h defines basename unless HAVE_DECL_BASENAME is set,
and
        string.h also defines it (but only when __USE_GNU is defined, which
is
        either defined by default in g++, or in gcc if _GNU_SOURCE is
defined,
        which is the reason for defining _GNU_SOURCE - we need to make
basename
        defined with gcc too because the AC_CHECK_DECL check is executed
with
        gcc).

diff --git a/ChangeLog b/ChangeLog
index 94bba24..7b65cc8 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,14 @@
+2009-11-13  Rolf Bjarne Kvinge  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-list">RKvinge at novell.com</A>&gt;
+
+       * configure.ac: Add a check for basename, so that HAVE_DECL_BASENAME
is
+       set. libiberty.h defines basename unless HAVE_DECL_BASENAME is set,
and
+       string.h also defines it (but only when __USE_GNU is defined, which
is
+       either defined by default in g++, or in gcc if _GNU_SOURCE is
defined,
+       which is the reason for defining _GNU_SOURCE - we need to make
basename
+       defined with gcc too because the AC_CHECK_DECL check is executed
with
+       gcc).
+       
+       
 2009-11-04  Rolf Bjarne Kvinge  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-list">RKvinge at novell.com</A>&gt;
 
        * configure.ac: Show if we were built with debug on or off.
diff --git a/configure.ac b/configure.ac
index 57d74c9..7bccf4c 100644
--- a/configure.ac
+++ b/configure.ac
@@ -20,9 +20,11 @@ PKG_PROG_PKG_CONFIG
 
 AC_DEFINE(__STDC_CONSTANT_MACROS, [], [To make avformat work with C++])
 AC_DEFINE(__STDC_LIMIT_MACROS, [], [To get limits of specified-width
integer types])
+AC_DEFINE(_GNU_SOURCE, [], [To make the basename decl check below actually
work])
 
 AC_SEARCH_LIBS(clock_gettime,rt)
 AC_CHECK_HEADERS(sys/time.h)
+AC_CHECK_DECLS([basename])
 
 changequote(,)dnl
 dnl LIBTOOL=&quot;${LIBTOOL} \$(shell echo \&quot;\$(MFLAGS)\&quot; | awk '/^[^ ]*s/ {
print \&quot;--silent\&quot; }')&quot;

</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000757.html">[Moonlight-list] Video on demand player NPO
</A></li>
	<LI>Next message: <A HREF="000741.html">[Moonlight-list] changes committed to the 2.0 branch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#733">[ date ]</a>
              <a href="thread.html#733">[ thread ]</a>
              <a href="subject.html#733">[ subject ]</a>
              <a href="author.html#733">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/moonlight-list">More information about the Moonlight-list
mailing list</a><br>
</body></html>
