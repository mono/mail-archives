<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [csharplang] Proposal: Expand supported Caller Info Attributes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20Proposal%3A%20Expand%20supported%20Caller%20Info%20Attributes&In-Reply-To=%3CSN2PR03MB2320AD810DB00574DF58687AC14F0%40SN2PR03MB2320.namprd03.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000006.html">
   <LINK REL="Next"  HREF="000007.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[csharplang] Proposal: Expand supported Caller Info Attributes</H1>
    <B>Fred Silberberg</B> 
    <A HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20Proposal%3A%20Expand%20supported%20Caller%20Info%20Attributes&In-Reply-To=%3CSN2PR03MB2320AD810DB00574DF58687AC14F0%40SN2PR03MB2320.namprd03.prod.outlook.com%3E"
       TITLE="[csharplang] Proposal: Expand supported Caller Info Attributes">frsilb at microsoft.com
       </A><BR>
    <I>Fri Feb  3 00:59:17 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000006.html">[csharplang] Proposal: Expand supported Caller Info Attributes
</A></li>
        <LI>Next message (by thread): <A HREF="000007.html">[csharplang] Proposal: Support Async Pattern Methods (Cω Chords)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25">[ date ]</a>
              <a href="thread.html#25">[ thread ]</a>
              <a href="subject.html#25">[ subject ]</a>
              <a href="author.html#25">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I’d also like to be able to get the name of the variable that was passed into another parameter. A common example for assertion libraries is:

Requires.NotNull(argument, nameof(argument));

If we could get the text that was passed to the first argument, it would simplify the code such libraries would have to write.

- Fredric Silberberg

From: csharplang [mailto:<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang-bounces at lists.dot.net</A>] On Behalf Of Justin Spindler
Sent: Thursday, February 2, 2017 13:30
To: <A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang at lists.dot.net</A>
Subject: [csharplang] Proposal: Expand supported Caller Info Attributes

<A HREF="https://github.com/dotnet/roslyn/issues/351&lt;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F351&amp;data=02%7C01%7Cfrsilb%40microsoft.com%7C1e1bbc54fc144787d53708d44bb360d5%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636216681213275581&amp;sdata=SVUmqplU0TKOv%2FSGGgI2PDLoiwIMgEgS2W3otc%2FYjj8%3D&amp;reserved=0">https://github.com/dotnet/roslyn/issues/351&lt;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F351&amp;data=02%7C01%7Cfrsilb%40microsoft.com%7C1e1bbc54fc144787d53708d44bb360d5%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636216681213275581&amp;sdata=SVUmqplU0TKOv%2FSGGgI2PDLoiwIMgEgS2W3otc%2FYjj8%3D&amp;reserved=0</A>&gt;


Problem:

The currently supported caller info attributes can only provide the name of the method, the name of the source file and the line number of the call in the source file. This is fine for scenarios such as simplifying implementations of INotifyPropertyChanged. However, if using these attributed for logging the amount of information available is quite limited.

Solution:

Expand the number of supported caller info attributes to allow embedding additional diagnostic information. The following list is quite expansive to discuss/argue over the potential possibilities.

CallerColumnNumberAttribute: The column number of where the method is invoked.
CallerTypeNameAttribute: The simple name of the declaring type of the calling method.
CallerNamespaceAttribute: The namespace of the declaring type of the calling method.
CallerFullTypeNameAttribute: The full name of the declaring type of the calling method.
CallerTypeAttribute: The declaring type of the calling method. This is replaced by the compiler by ldtoken of the type followed by a call to Type.GetTypeFromHandle.
CallerMethodAttribute: The MethodBase of the calling method. This is replaced by the compiler by ldtoken of the method reference followed by a call to MethodBase.GetMethodFromHandle.

Example usage:

using System;

using System.Diagnostics;

using System.Runtime.CompilerServices;



namespace Project1 {

    public static class Program {

        private static void Foo([CallerMemberName] string memberName = null,

                                [CallerTypeName] string typeName = null,

                                [CallerNamespaceName] string namespaceName = null,

                                [CallerFullTypeName] string fullTypeName = null,

                                [CallerFilePath] string filePath = null,

                                [CallerLineNumber] int lineNumber = 0,

                                [CallerColumnNumber] int columnNumber = 0,

                                [CallerType] Type type,

                                [CallerMethod] MethodBase method)

        {

            Debug.Assert(memberName == &quot;Main&quot;);

            Debug.Assert(typeName == &quot;Program&quot;);

            Debug.Assert(namespaceName == &quot;Project1&quot;);

            Debug.Assert(fullTypeName == &quot;Project1.Program&quot;);

            Debug.Assert(filePath == &quot;c:\\foo\\bar\\Program.cs&quot;);

            Debug.Assert(lineNumber == 29);

            Debug.Assert(columnNumber == 12);

            Debug.Assert(type == typeof(Program));

            Debug.Assert(method == typeof(Program).GetMethod(&quot;Main&quot;));

        }



        public static void Main() {

            Foo();

        }

    }

}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/csharplang/attachments/20170203/a48f07f9/attachment-0001.html">http://lists.dot.net/pipermail/csharplang/attachments/20170203/a48f07f9/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000006.html">[csharplang] Proposal: Expand supported Caller Info Attributes
</A></li>
	<LI>Next message (by thread): <A HREF="000007.html">[csharplang] Proposal: Support Async Pattern Methods (Cω Chords)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25">[ date ]</a>
              <a href="thread.html#25">[ thread ]</a>
              <a href="subject.html#25">[ subject ]</a>
              <a href="author.html#25">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/csharplang">More information about the csharplang
mailing list</a><br>
</body></html>
