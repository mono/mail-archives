<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [csharplang] Operators should be exposed for	`System.IntPtr`	and	`System.UIntPtr`
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20Operators%20should%20be%20exposed%20for%0A%09%60System.IntPtr%60%09and%09%60System.UIntPtr%60&In-Reply-To=%3CDM5PR03MB2666034C4A64351052542348B34E0%40DM5PR03MB2666.namprd03.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000071.html">
   <LINK REL="Next"  HREF="000074.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[csharplang] Operators should be exposed for	`System.IntPtr`	and	`System.UIntPtr`</H1>
    <B>Tanner Gooding</B> 
    <A HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20Operators%20should%20be%20exposed%20for%0A%09%60System.IntPtr%60%09and%09%60System.UIntPtr%60&In-Reply-To=%3CDM5PR03MB2666034C4A64351052542348B34E0%40DM5PR03MB2666.namprd03.prod.outlook.com%3E"
       TITLE="[csharplang] Operators should be exposed for	`System.IntPtr`	and	`System.UIntPtr`">tagoo at microsoft.com
       </A><BR>
    <I>Sat Feb  4 00:20:15 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000071.html">[csharplang] Operators should be exposed for `System.IntPtr`	and	`System.UIntPtr`
</A></li>
        <LI>Next message (by thread): <A HREF="000074.html">[csharplang] Operators should be exposed for `System.IntPtr`	and `System.UIntPtr`
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#72">[ date ]</a>
              <a href="thread.html#72">[ thread ]</a>
              <a href="subject.html#72">[ subject ]</a>
              <a href="author.html#72">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I think one of the concerns here is normal end-users trying to write code using platform sized integers. But the trade-off for that is that writing interop code (where this is actually required) becomes significantly harder.

We have CoreCLR and CoreFX now, and they run on multiple platforms. Platforms where we don’t have a UI stack, where we can’t readily write multimedia based applications, etc.

People (and it may be a minority in some cases) are going to want to write frameworks and libraries for the missing cross platform functionality. They are going to want and need the ability to easily work with platform sized integers to help simplify their code base and infrastructure.

A user shouldn’t need to use pointer arithmetic or write two implementations of a function when using a platform sized integer would simplify things and likely make it more robust and usable on future platforms that come into play.

-Tanner

From: csharplang [mailto:<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang-bounces at lists.dot.net</A>] On Behalf Of Matt Warren via csharplang
Sent: Friday, February 3, 2017 3:46 PM
To: Peter Golde &lt;<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">peter at golde.org</A>&gt;; <A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang at lists.dot.net</A>
Subject: Re: [csharplang] Operators should be exposed for `System.IntPtr` and `System.UIntPtr`

What’s next though, 128 bit architecture?  Not enough address space in 64 bits.. need more.

From: csharplang [mailto:<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang-bounces at lists.dot.net</A>] On Behalf Of Peter Golde
Sent: Friday, February 3, 2017 3:08 PM
To: <A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang at lists.dot.net</A>&lt;mailto:<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang at lists.dot.net</A>&gt;
Subject: [csharplang] Operators should be exposed for `System.IntPtr` and `System.UIntPtr`


As a historical perspective, I can say that this choice was made extremely deliberately and after MUCH debate while creating the initial version of C#.

One of the design principles that we felt strongly about was the core data types (short, int, long, etc.) should be of standardized size and operation across all platforms. This is one of the things that we felt that Java had right, and C had wrong. We felt that it was doing programmers a grave disservice to allow them to write code where integers had different size limits or overflow behavior on different platforms, and this just led to code that was very hard to port between platforms with virtually no benefit. If you need to store integers larger than 2G, use a long, otherwise use an int. This is an algorithmic decision and the behavior shouldn’t change just because you are running on a 32 or 64 bit platform.

IntPtr and UIntPtr were introduced in the base class libraries for various reasons, and C# had to decide how to handle them. We realized that they did have a usefulness in P/Invoke and native interop scenarios, so we added the ability to explicitly cast from the regular integers to them and back. Further than that we were unwilling to go, very deliberately.

We really didn’t want programmers to write libraries that used size-specific integers in their public interface. By NOT putting operators on them, and by making casts to other integers have to be explicit, we made them painful enough that people did not use them as general “platform-specific integers”, like “int” is in C.

…

Now Xamarin had a big problem, and a big installed base, when Apple rolled out 64-bit iOS. I understand why they added nint instead of just moving to long, given how Apple changed their API, how disruptive it would have been to their installed base, and how much code would have broken. I was actually quite impressed that moving to iOS 64-bit was relatively painless in Xamarin (though by no means just a recompile). So it was almost certainly the right decision for Xamarin for interfacing to iOS. Trying to reconcile that already-made decision with the core C# compilers is definitely an interesting problem.

…

As a final thought, it feels weird to (re)debate this just as 32-bit architectures are becoming essentially obsolete.

Peter
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/csharplang/attachments/20170204/8799d033/attachment-0001.html">http://lists.dot.net/pipermail/csharplang/attachments/20170204/8799d033/attachment-0001.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000071.html">[csharplang] Operators should be exposed for `System.IntPtr`	and	`System.UIntPtr`
</A></li>
	<LI>Next message (by thread): <A HREF="000074.html">[csharplang] Operators should be exposed for `System.IntPtr`	and `System.UIntPtr`
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#72">[ date ]</a>
              <a href="thread.html#72">[ thread ]</a>
              <a href="subject.html#72">[ subject ]</a>
              <a href="author.html#72">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/csharplang">More information about the csharplang
mailing list</a><br>
</body></html>
