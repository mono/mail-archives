<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [csharplang] [Proposal]: Allow Dispose by Convention
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20%5BProposal%5D%3A%20Allow%20Dispose%20by%20Convention&In-Reply-To=%3CBLUPR0301MB15244002351E920D7B7007DCE64F0%40BLUPR0301MB1524.namprd03.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000020.html">
   <LINK REL="Next"  HREF="000021.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[csharplang] [Proposal]: Allow Dispose by Convention</H1>
    <B>Dustin Campbell</B> 
    <A HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20%5BProposal%5D%3A%20Allow%20Dispose%20by%20Convention&In-Reply-To=%3CBLUPR0301MB15244002351E920D7B7007DCE64F0%40BLUPR0301MB1524.namprd03.prod.outlook.com%3E"
       TITLE="[csharplang] [Proposal]: Allow Dispose by Convention">Dustin.Campbell at microsoft.com
       </A><BR>
    <I>Fri Feb  3 00:57:29 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000020.html">[csharplang] [Proposal]: Allow Dispose by Convention
</A></li>
        <LI>Next message (by thread): <A HREF="000021.html">[csharplang] Proposal: &quot;while&quot; as a LINQ query expression clause
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23">[ date ]</a>
              <a href="thread.html#23">[ thread ]</a>
              <a href="subject.html#23">[ subject ]</a>
              <a href="author.html#23">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Personally, I'd like to see unification around all of these patterns, many of which have their own little quirks. For example, the foreach GetEnumerator() pattern is not purely syntactic because the GetEnumerator() method can't be defined extension method.

________________________________
From: csharplang &lt;<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang-bounces at lists.dot.net</A>&gt; on behalf of Justin Spindler &lt;<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">justin.spindler at gmail.com</A>&gt;
Sent: Thursday, February 2, 2017 4:48:36 PM
To: <A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang at lists.dot.net</A>
Subject: [csharplang] [Proposal]: Allow Dispose by Convention

<A HREF="https://github.com/dotnet/roslyn/issues/11420&lt;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F11420&amp;data=02%7C01%7Cdustin.campbell%40microsoft.com%7Cd685c241b1b6491a8f5708d44bce6571%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636216797267329372&amp;sdata=KTJ5FApBG5gQMAizxw%2BDC6A%2F99mTzZGct7O6iUv8K0Y%3D&amp;reserved=0">https://github.com/dotnet/roslyn/issues/11420&lt;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F11420&amp;data=02%7C01%7Cdustin.campbell%40microsoft.com%7Cd685c241b1b6491a8f5708d44bce6571%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636216797267329372&amp;sdata=KTJ5FApBG5gQMAizxw%2BDC6A%2F99mTzZGct7O6iUv8K0Y%3D&amp;reserved=0</A>&gt;


Currently the using statement is tied specifically to implementation of the IDisposable interface. This makes it impossible to use resource-like objects from other assemblies within usingstatements.

I propose that the compiler allow resolving an accessible void Dispose() method in the case that the type does not implement IDisposable. That would allow for a developer to extend an existing class through the use of an extension method which would contain the logic for &quot;disposing&quot; of that resource:

public class SomeResource {
    public int Id { get; }
}

public static class SomeResourceExtensions {
    public static void Dispose(this SomeResource resource) {
        Console.WriteLine($&quot;Disposing {resource.Id}&quot;);
    }
}

static class Program {
    static void Main() {
        using (var resource = new SomeResource() { Id = 123 }) {
            Console.WriteLine($&quot;Using ${resource.Id}&quot;);
        }
    }
}

// output:
// Using 123
// Disposing 123

This brings using in line with the conventions also established by foreach, LINQ and await where the compiler can resort to resolving instance members of a specific name/shape rather than require implementation of an interface or base class.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/csharplang/attachments/20170203/b80df4d7/attachment-0001.html">http://lists.dot.net/pipermail/csharplang/attachments/20170203/b80df4d7/attachment-0001.html</A>&gt;
</PRE>




























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000020.html">[csharplang] [Proposal]: Allow Dispose by Convention
</A></li>
	<LI>Next message (by thread): <A HREF="000021.html">[csharplang] Proposal: &quot;while&quot; as a LINQ query expression clause
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23">[ date ]</a>
              <a href="thread.html#23">[ thread ]</a>
              <a href="subject.html#23">[ subject ]</a>
              <a href="author.html#23">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/csharplang">More information about the csharplang
mailing list</a><br>
</body></html>
