<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [csharplang] Operators should be exposed for `System.IntPtr` and `System.UIntPtr`
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20Operators%20should%20be%20exposed%20for%20%60System.IntPtr%60%0A%20and%20%60System.UIntPtr%60&In-Reply-To=%3CMWHPR03MB2446EFAB2B90C0561A6E4064C14F0%40MWHPR03MB2446.namprd03.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000053.html">
   <LINK REL="Next"  HREF="000067.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[csharplang] Operators should be exposed for `System.IntPtr` and `System.UIntPtr`</H1>
    <B>Cyrus Najmabadi</B> 
    <A HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20Operators%20should%20be%20exposed%20for%20%60System.IntPtr%60%0A%20and%20%60System.UIntPtr%60&In-Reply-To=%3CMWHPR03MB2446EFAB2B90C0561A6E4064C14F0%40MWHPR03MB2446.namprd03.prod.outlook.com%3E"
       TITLE="[csharplang] Operators should be exposed for `System.IntPtr` and `System.UIntPtr`">cyrusn at microsoft.com
       </A><BR>
    <I>Fri Feb  3 20:07:23 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000053.html">[csharplang] Operators should be exposed for `System.IntPtr`	and `System.UIntPtr`
</A></li>
        <LI>Next message (by thread): <A HREF="000067.html">[csharplang] Operators should be exposed for `System.IntPtr`	and `System.UIntPtr`
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65">[ date ]</a>
              <a href="thread.html#65">[ thread ]</a>
              <a href="subject.html#65">[ subject ]</a>
              <a href="author.html#65">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Xamarin had to introduce hacks like &quot;System.nint&quot; and &quot;System.nuint&quot; to solve the problem in the world of Apple interop.
</I>
If we support operators for IntPtr and UIntPtr, then you won’t get operators for nint and nuint.  It sounds like having a general operator story might be a better idea that trying to continually bless specific types in the compiler.

&gt;<i> It is only tiny, because we have made it so cumbersome to use.
</I>&gt;<i> Xamarin had to introduce hacks like &quot;System.nint&quot; and &quot;System.nuint&quot; to solve the problem in the world of Apple interop.
</I>
Can you give more data on this.  I’m familiar with coding for iOS, but I’d like to know the cases where:

  1.  Someone really needed to be using these types
  2.  A solution that brought in operators through another library would not be sufficient.

Note: I’m not asking why a user would want this.  I’m asking why a user would want this, and why a *generalized* solution from the C# language would not be sufficient for them.  The more broadly applicable we can make the feature, the far better it would be for our language IMO.

            -- Cyrus

From: Miguel de Icaza [mailto:<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">miguel.de.icaza at gmail.com</A>]
Sent: Friday, February 3, 2017 10:32 AM
To: Cyrus Najmabadi &lt;<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">cyrusn at microsoft.com</A>&gt;
Cc: Tanner Gooding &lt;<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">tagoo at microsoft.com</A>&gt;; Justin Spindler &lt;<A HREF="http://lists.dot.net/mailman/listinfo/csharplang">justin.spindler at gmail.com</A>&gt;; <A HREF="http://lists.dot.net/mailman/listinfo/csharplang">csharplang at lists.dot.net</A>
Subject: Re: [csharplang] Operators should be exposed for `System.IntPtr` and `System.UIntPtr`

Hello,

Sure.  I’d much rather ship a new library versus rev the language just to make working with IntPtrs nicer.  We’re talking about a feature for an absolutely tiny subset of our users.  I think we should be thinking about features that bring about large value to much larger groups.

It is only tiny, because we have made it so cumbersome to use.

Xamarin had to introduce hacks like &quot;System.nint&quot; and &quot;System.nuint&quot; to solve the problem in the world of Apple interop.

On Apple platforms, APIs are defined in terms of the natural integer size, not the 32-bit version, or the 64-bit version.

Had UIntPtr or IntPtr had these APIs, we would not have had to resort to these hacks.

Being able to do basic arithmetic with the natural integer is something that many C libraries expect, and the tools are just not there in C#.

That being said, we are having a discussion in parallel with the runtime people about introducing the same capability for floating point values (again, interop), and we might end up introducing not only the overloaded operations on System.*IntPtr, but also introducing the type aliases &quot;nint&quot;, &quot;nuint&quot;, and &quot;nfloat&quot;.

In other words: I don’t doubt the value of the feature to you (and a small number of others).  What I question is why we’d work on this instead of a larger feature that can benefit more situations.  For example, when we built Linq we didn’t just create the ‘Linq’ feature.  We did an aggregate of many different features, including:

The discussion on priorities is independent.

Miguel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/csharplang/attachments/20170203/84210e96/attachment.html">http://lists.dot.net/pipermail/csharplang/attachments/20170203/84210e96/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000053.html">[csharplang] Operators should be exposed for `System.IntPtr`	and `System.UIntPtr`
</A></li>
	<LI>Next message (by thread): <A HREF="000067.html">[csharplang] Operators should be exposed for `System.IntPtr`	and `System.UIntPtr`
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65">[ date ]</a>
              <a href="thread.html#65">[ thread ]</a>
              <a href="subject.html#65">[ subject ]</a>
              <a href="author.html#65">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/csharplang">More information about the csharplang
mailing list</a><br>
</body></html>
