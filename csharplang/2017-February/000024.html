<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [csharplang] [Proposal]: Explicitly Mutable Anonymous Type Members
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20%5BProposal%5D%3A%20Explicitly%20Mutable%20Anonymous%20Type%20Members&In-Reply-To=%3CCAGu8fCpYryrgppRtS7L8L135Az66NLNpfnhOJk3A_pAkZLFFow%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000030.html">
   <LINK REL="Next"  HREF="000026.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[csharplang] [Proposal]: Explicitly Mutable Anonymous Type Members</H1>
    <B>Justin Spindler</B> 
    <A HREF="mailto:csharplang%40lists.dot.net?Subject=Re%3A%20%5Bcsharplang%5D%20%5BProposal%5D%3A%20Explicitly%20Mutable%20Anonymous%20Type%20Members&In-Reply-To=%3CCAGu8fCpYryrgppRtS7L8L135Az66NLNpfnhOJk3A_pAkZLFFow%40mail.gmail.com%3E"
       TITLE="[csharplang] [Proposal]: Explicitly Mutable Anonymous Type Members">justin.spindler at gmail.com
       </A><BR>
    <I>Fri Feb  3 00:58:17 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000030.html">[csharplang] Proposal: &quot;while&quot; as a LINQ query expression clause
</A></li>
        <LI>Next message (by thread): <A HREF="000026.html">[csharplang] [Proposal]: Explicitly Mutable Anonymous Type Members
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24">[ date ]</a>
              <a href="thread.html#24">[ thread ]</a>
              <a href="subject.html#24">[ subject ]</a>
              <a href="author.html#24">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://github.com/dotnet/roslyn/issues/11421">https://github.com/dotnet/roslyn/issues/11421</A>

I had posted a suggestion like this on UserVoice some time ago. I figure
it'll fly probably about as well as a lead balloon but it might be
interesting just for the sake of discussion. Tuples would likely mostly
suffice in the scenarios in which this would be useful.

Currently in C# all of the members of an anonymous type are readonly. In
some situations where an anonymous type is used as a working space it would
be convenient to be able to mutate specific members. I propose that within
the anonymous type declaration that the keyword ref could be used to
declare a member as mutable:

var id = &quot;123&quot;;var anon = new { id, ref count = 0 };anon.count =
2;anon.count += 1;
anon.id = &quot;456&quot;; // compiler error

As the members marked as ref are mutable the generated anonymous type would
not include them in the compiler-generated GetHashCode() or Equals()
 overrides.

Notes:

   1. The ref keyword was what I had proposed on UserVoice. This was before
   Roslyn or any notion of ref locals/returns, so I don't know if the use
   of the same keyword in this context would be confusing or ambiguous.
   2. This functionality already exists in VB.NET although reversed, where
   immutable members are explicitly marked with the contextual keyword Key:

Dim id = &quot;123&quot;Dim anon = New With {Key .id = id, .count = 0}
anon.count = 2
anon.count += 1

anon.id = &quot;456&quot; ' compiler error
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/csharplang/attachments/20170202/545850ce/attachment.html">http://lists.dot.net/pipermail/csharplang/attachments/20170202/545850ce/attachment.html</A>&gt;
</PRE>































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000030.html">[csharplang] Proposal: &quot;while&quot; as a LINQ query expression clause
</A></li>
	<LI>Next message (by thread): <A HREF="000026.html">[csharplang] [Proposal]: Explicitly Mutable Anonymous Type Members
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24">[ date ]</a>
              <a href="thread.html#24">[ thread ]</a>
              <a href="subject.html#24">[ subject ]</a>
              <a href="author.html#24">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/csharplang">More information about the csharplang
mailing list</a><br>
</body></html>
