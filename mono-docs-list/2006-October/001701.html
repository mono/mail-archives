<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-docs-list] [PATCH] Monodocer &lt;since/&gt; support
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-docs-list%40lists.ximian.com?Subject=%5BMono-docs-list%5D%20%5BPATCH%5D%20Monodocer%20%3Csince/%3E%20support&In-Reply-To=452F88BB.20500%40occams.info">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001700.html">
   <LINK REL="Next"  HREF="001702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-docs-list] [PATCH] Monodocer &lt;since/&gt; support</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-docs-list%40lists.ximian.com?Subject=%5BMono-docs-list%5D%20%5BPATCH%5D%20Monodocer%20%3Csince/%3E%20support&In-Reply-To=452F88BB.20500%40occams.info"
       TITLE="[Mono-docs-list] [PATCH] Monodocer &lt;since/&gt; support">jonpryor at vt.edu
       </A><BR>
    <I>Fri Oct 13 22:02:02 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="001700.html">[Mono-docs-list] [PATCH] Monodocer &lt;since/&gt; support
</A></li>
        <LI>Next message: <A HREF="001702.html">[Mono-docs-list] [PATCH] Monodocer &lt;since/&gt; support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1701">[ date ]</a>
              <a href="thread.html#1701">[ thread ]</a>
              <a href="subject.html#1701">[ subject ]</a>
              <a href="author.html#1701">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2006-10-13 at 08:38 -0400, Joshua Tauberer wrote:
&gt;<i> &gt;  Consider Gtk#, in which
</I>&gt;<i> &gt; members were introduced in versions 2.4, 2.6, 2.8, 2.10...
</I>&gt;<i> &gt; The /Type/AssemblyInfo/AssemblyVersion section of the XML documentation
</I>&gt;<i> &gt; holds only *one* version, the current version, so I'm not sure how best
</I>&gt;<i> &gt; to represent the myriad versions a member can come from that doesn't, to
</I>&gt;<i> &gt; some extent, rely upon some arbitrary string (as since/@version uses).
</I>&gt;<i> 
</I>&gt;<i> We don't use Type/../AssemblyVersion for anything, so let's assume we
</I>&gt;<i> replace it with a new node (maybe at the same location) that has the
</I>&gt;<i> assembly version the type was introduced in, and every Member also gets
</I>&gt;<i> its own such node.
</I>
The problem I have with this is that it's potentially wrong.  Without
having every released version of an assembly, we can't know in which
version a given type/member was introduced, especially since we only
have two sources of information: the assembly we're processing, and the
XML documentation we're attempting to update.

So if someone is writing documentation for an assembly that has already
had several releases (i.e. they're not writing docs concurrently with
the code), or if they accidentally forget to modify the assembly version
before running monodocer, or any number of other random mishaps which
are likely to happen, the version information for the inserted member
*will* be wrong.

Which may not be entirely problematic, but if it can be wrong we'll have
to expect the user to potentially update it, which makes this
information separate from the &quot;normal&quot; metadata (member name, parameter
&amp; return types, etc.) which are *always* automatically generated &amp;
checked.

So version information seems to be, by necessity, some &quot;middle ground&quot;
between pure metadata and user-modifiable data, especially since there's
no way to validate it (outside of Mike Kestner's DocVersionatorPlus).

&gt;<i>   That's what I was suggesting originally.  The
</I>&gt;<i> strings are arbitrary to the extent any strings are, but at least
</I>&gt;<i> they're parseable and able to be dealt with automatically by tools.
</I>
To mutilate an idea you propose later, perhaps we could add an attribute
to the &lt;since/&gt; element which contains the current assembly version,
e.g.

	&lt;since version=&quot;Gtk# 2.4&quot; assembly-version=&quot;2.4.0.0&quot; /&gt;

though I'm not sure this actually buys anything, for the reasons listed
above.

&gt;<i> &gt; Does the additional -since behavior described above satisfy this?
</I>&gt;<i> 
</I>&gt;<i> Yes, in part.  But I would rather not conflate user-written docs
</I>&gt;<i> (&quot;Version 2.0&quot;) with reliably formatted metadata (A.B.C.D) in the same node.
</I>
As mentioned above, I'm not convinced it's possible to completely
separate the user-written metadata from the &quot;reliable metadata&quot;
metadata.

&gt;<i> &gt;&gt;  stores the information in a non-structured way
</I>&gt;<i> &gt;&gt; (opaque to other automated processes that might want to do something
</I>&gt;<i> &gt;&gt; based on the info),
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; To be fair, /Type/AssemblyInfo/AssemblyVersion contains the same string,
</I>&gt;<i> &gt; or is a A.B.C.D string considered &quot;structured&quot;?
</I>&gt;<i> 
</I>&gt;<i> To me, yes.  It's in a reliable format mandated by the CLI specs,
</I>&gt;<i> compared to unstructured user-written text that would go in the since
</I>&gt;<i> tag.  Let's say we wanted to generated HTML docs just for the .NET 1.1
</I>&gt;<i> libraries.  We can do this easily if we have the version as metadata.
</I>&gt;<i> If not, we can only do it if we rely on a convention for how we write
</I>&gt;<i> the since tags in the docs.
</I>
The since/@assembly-version attribute described above would permit this.

&gt;<i> &gt;&gt;  and introduces necessary redundancy by having the
</I>&gt;<i> &gt;&gt; same user-given string &quot;Version 2.0&quot; distributed throughout all the
</I>&gt;<i> &gt;&gt; types/members that appeared at the same time (which makes it difficult
</I>&gt;<i> &gt;&gt; to revise without a find-replace across files).
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; And the solution to this would be a required &quot;level of indirection&quot;, the
</I>&gt;<i> &gt; semantics and implementation of which escape me.
</I>&gt;<i> 
</I>&gt;<i> Yes for indirection, but simple in implementation.  If the types and
</I>&gt;<i> members are already tagged with the version in reliable metadata, 
</I>
Hence my problem, I don't see any way for the version information to
ever be considered &quot;reliable&quot;...

&gt;<i> one
</I>&gt;<i> could easily list the nice/display names of versions once in the
</I>&gt;<i> index.xml file or elsewhere, i.e.:
</I>&gt;<i> 
</I>&gt;<i> &lt;Version Number=&quot;2.0.35.10&quot; Name=&quot;Gtk# Version 2.0&quot;/&gt;
</I>&gt;<i> 
</I>&gt;<i> And that's if you really wanted to do that.  For lots of projects, it
</I>&gt;<i> would probably be enough to just let the A.B.C.D format be displayed.
</I>&gt;<i> 
</I>&gt;<i> A nice compromise might be to just do both.  Keep the since tag as you
</I>&gt;<i> have it now, but in addition add the version metadata to types and
</I>&gt;<i> members as I described.  If a type/member has a since node, display it.
</I>&gt;<i>  Otherwise, display the information from metadata.
</I>
I'm still not entirely sure what your entire proposal is.  Is it to have
two elements, //Member/Version and //Member/Docs/since, the former being
automatically inserted while the latter is controlled by the user?

If so, this still doesn't permit easy change across all files, since if
you wanted to change a version number (e.g. programmer mistake -- you
didn't update the AssemblyVersion attribute before re-running
monodocer), you'd *still* need to update all of the //Member/Version
elements across all the files.  There wouldn't be an intermediate &quot;level
of indirection&quot;.

A true &quot;level of indirection&quot; would be something like a versions.xml
file specifying all known assembly versions, and then a //Member/Version
element which uses a string referencing an identifier within
versions.xml.  That way you could update only versions.xml and all
members which belong to this version would get the correct corresponding
display name.

Again, I see how this would work, but I don't see how it would work, if
you catch my drift.  What would be the version number strings mapping
the //Member/Version tag to the versions.xml tag?  It couldn't be e.g.
&quot;2.1.3.4&quot;, as that looks like a real version number (and thus would
likely need to be changed, resulting in programmer confusion).  Anything
else would be more difficult to generate than I care to think about.

&gt;<i> Adding version metadata only adds, say, one line to each member, and we
</I>&gt;<i> can change the current Type/../Assembly Version so it reflects the
</I>&gt;<i> version the type was added, which means no new lines, and in fact that
</I>&gt;<i> node will stop getting annoyingly updated with each version change.
</I>
Never changing /Type/AssemblyInfo is probably a good thing, but beyond
that I'm still not entirely sure I see all of the details and
ramifications of your proposal.

Perhaps some examples would help?

 - Jon


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001700.html">[Mono-docs-list] [PATCH] Monodocer &lt;since/&gt; support
</A></li>
	<LI>Next message: <A HREF="001702.html">[Mono-docs-list] [PATCH] Monodocer &lt;since/&gt; support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1701">[ date ]</a>
              <a href="thread.html#1701">[ thread ]</a>
              <a href="subject.html#1701">[ subject ]</a>
              <a href="author.html#1701">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-docs-list">More information about the Mono-docs-list
mailing list</a><br>
</body></html>
