<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 537402] New: Strange generic types handling (compiling by csc but not with gmcs)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20537402%5D%20New%3A%20Strange%20generic%20types%20handling%0A%20%28compiling%20by%20csc%20but%20not%20with%20gmcs%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="092383.html">
   <LINK REL="Next"  HREF="092393.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 537402] New: Strange generic types handling (compiling by csc but not with gmcs)</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20537402%5D%20New%3A%20Strange%20generic%20types%20handling%0A%20%28compiling%20by%20csc%20but%20not%20with%20gmcs%29&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 537402] New: Strange generic types handling (compiling by csc but not with gmcs)">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Sep  8 09:26:58 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="092383.html">[Mono-bugs] [Bug 537396] New: LinearGradientBrush crash mono runtime if width or height is set to zero
</A></li>
        <LI>Next message: <A HREF="092393.html">[Mono-bugs] [Bug 537402] Strange generic types handling (compiling by csc but not with gmcs)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92384">[ date ]</a>
              <a href="thread.html#92384">[ thread ]</a>
              <a href="subject.html#92384">[ subject ]</a>
              <a href="author.html#92384">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=537402">http://bugzilla.novell.com/show_bug.cgi?id=537402</A>


           Summary: Strange generic types handling (compiling by csc but
                    not with gmcs)
    Classification: Mono
           Product: Mono: Compilers
           Version: 2.4.x
          Platform: x86
        OS/Version: Windows Server 2008
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: C#
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">atsidaev at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.1.2)
Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)

I simplified problem in few classes, so can show all sources:

using System;
using System.Collections.Generic;
using System.Data.Linq.Mapping;
using System.Linq;
using System.Data.Linq;
using System.Text;

namespace Test
{    
    [System.Data.Linq.Mapping.DatabaseAttribute(Name=&quot;BD&quot;)]
    public partial class MyDataContext : System.Data.Linq.DataContext
    {
        private static System.Data.Linq.Mapping.MappingSource mappingSource =
new AttributeMappingSource();

        public MyDataContext() : base(&quot;&quot;, mappingSource)
        {

        }
    }

    public abstract class Entity&lt;DataContextType&gt; where DataContextType :
System.Data.Linq.DataContext
    {
        protected Entity() {}
    }

    public class Person : Entity&lt;MyDataContext&gt;
    {

    }

    public sealed class TheBox&lt;DataContextType&gt; where DataContextType :
System.Data.Linq.DataContext
    {
        public EntityType GetById&lt;EntityType&gt;(Guid entityId) where EntityType :
Entity&lt;DataContextType&gt; { return null; }
    }

    public class Program
    {
        public static void Main()
        {
            TheBox&lt;MyDataContext&gt; dc = new TheBox&lt;MyDataContext&gt;();
            dc.GetById&lt;Person&gt;(Guid.NewGuid());
        }
    }

}

Saving this as test.cs.
Doing csc.exe /target:library test.cs - it works (and similar code works well
in my Microsoft.NET project for a months).

Doing gmcs -reference:System.Data,System.Data.Linq -target:library test.cs - it
fails.

Error is 

test.cs(41,28): error CS0309: The type `Test.Person' must be convertible to
`Test.Entity&lt;Test.Person&gt;' in order to use it as parameter `EntityType' in the
generic type or method
`Test.TheBox&lt;DataContextType&gt;.GetById&lt;EntityType&gt;(System.Guid)'
test.cs(33,35): (Location of the symbol related to previous error)
test.cs(26,22): (Location of the symbol related to previous error)
Compilation failed: 1 error(s), 0 warnings

For unknown reason compiler waits for some Test.Entity&lt;Test.Person&gt; type, but
this type could not even exist, because of Person is not inherited from
DataContextType.

Mono-2.4.2.3 for Windows has been used.

Reproducible: Always

Steps to Reproduce:
Described above
Actual Results:  
Do not compiling

Expected Results:  
Should compile

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>









































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="092383.html">[Mono-bugs] [Bug 537396] New: LinearGradientBrush crash mono runtime if width or height is set to zero
</A></li>
	<LI>Next message: <A HREF="092393.html">[Mono-bugs] [Bug 537402] Strange generic types handling (compiling by csc but not with gmcs)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92384">[ date ]</a>
              <a href="thread.html#92384">[ thread ]</a>
              <a href="subject.html#92384">[ subject ]</a>
              <a href="author.html#92384">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
