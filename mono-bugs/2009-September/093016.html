<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 542303] New: compiling mono on Snow Leopard fails in mono-sigcontext.h (svn 142581)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20542303%5D%20New%3A%20compiling%20mono%20on%20Snow%20Leopard%20fails%0A%20in%20mono-sigcontext.h%20%28svn%20142581%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="093012.html">
   <LINK REL="Next"  HREF="093017.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 542303] New: compiling mono on Snow Leopard fails in mono-sigcontext.h (svn 142581)</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20542303%5D%20New%3A%20compiling%20mono%20on%20Snow%20Leopard%20fails%0A%20in%20mono-sigcontext.h%20%28svn%20142581%29&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 542303] New: compiling mono on Snow Leopard fails in mono-sigcontext.h (svn 142581)">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Sep 25 14:22:09 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="093012.html">[Mono-bugs] [Bug 490932] Nullable ByRef types do not work correctly via reflection
</A></li>
        <LI>Next message: <A HREF="093017.html">[Mono-bugs] [Bug 542305] New: Debugging remotely fails when debugging on SLES 11 x86_64 w/Mono-X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#93016">[ date ]</a>
              <a href="thread.html#93016">[ thread ]</a>
              <a href="subject.html#93016">[ subject ]</a>
              <a href="author.html#93016">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=542303">http://bugzilla.novell.com/show_bug.cgi?id=542303</A>


           Summary: compiling mono on Snow Leopard fails in
                    mono-sigcontext.h (svn 142581)
    Classification: Mono
           Product: Mono: Runtime
           Version: SVN
          Platform: Macintosh
        OS/Version: Mac OS X 10.6
            Status: NEW
          Severity: Critical
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">uniqueness.template at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_1; en-us)
AppleWebKit/531.9 (KHTML, like Gecko) Version/4.0.3 Safari/531.9

I am attempting to build mono from SVN on Mac OS 10.6 Snow Leopard (due to
unrelated problems with the current Mono Framework binaries for 10.5 Leopard
not working correctly on Snow Leopard). After correctly setting up my build
environment to build mono as an i386 binary (mono's x86_64 support is still
lacking), the build fails in mono/utils/mono-sigcontext.h.


Reproducible: Always

Steps to Reproduce:
I've set up my build environment as follows:
1) Installed MonoFramework-2.4.2.3_4.macos10.novell.x86.dmg
2) Installed MacPorts
3) Installed dependancies as universal i386/x86_64 binaries:
sudo port install libiconv gettext glib2 zlib pkgconfig +universal
4) Retrieved the latest SVN sources for &quot;mono&quot; and &quot;mcs&quot;:
svn co <A HREF="svn://anonsvn.mono-project.com/source/trunk/mono">svn://anonsvn.mono-project.com/source/trunk/mono</A>
svn co <A HREF="svn://anonsvn.mono-project.com/source/trunk/mcs">svn://anonsvn.mono-project.com/source/trunk/mcs</A>

5) The rest of my Terminal commands before the build fails:
cd mono
/autogen.sh CFLAGS=&quot;-m32&quot;
make
Actual Results:  
Compiler output:

In file included from ../../mono/utils/mono-sigcontext.h:9,
                 from mini-x86.h:5,
                 from mini-arch.h:5,
                 from mini.h:33,
                 from genmdesc.c:9:
/usr/include/ucontext.h:42:2: error: #error ucontext routines are deprecated,
and require _XOPEN_SOURCE to be defined
make[3]: *** [genmdesc-genmdesc.o] Error 1
make[2]: *** [all-recursive] Error 1
make[1]: *** [all-recursive] Error 1
make: *** [all] Error 2


Apple has deprecated ucontext.h which contains the old X/Open context
manipulation functions: getcontext, makecontext, setcontext, and swapcontext.
Apple has moved all other ucontext structures and defines formally found in
ucontext.h to sys/ucontext.h.

I successfully compiled mono on Snow Leopard after I modified the following in
mono/utils/sigcontext.h:

===BEFORE===
#if defined(__FreeBSD__) || defined(__APPLE__)
#include &lt;ucontext.h&gt;
#endif
#if defined(__APPLE__)
#include &lt;AvailabilityMacros.h&gt;
#endif
===END BEFORE===

===AFTER===
if defined(__FreeBSD__)
#include &lt;ucontext.h&gt;
#endif

#if defined(__APPLE__)
#include &lt;sys/ucontext.h&gt;
#include &lt;AvailabilityMacros.h&gt;
#endif
===END AFTER===

This would most likely break compilation on 10.5 Leopard, so it's probably not
the best solution.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>







































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="093012.html">[Mono-bugs] [Bug 490932] Nullable ByRef types do not work correctly via reflection
</A></li>
	<LI>Next message: <A HREF="093017.html">[Mono-bugs] [Bug 542305] New: Debugging remotely fails when debugging on SLES 11 x86_64 w/Mono-X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#93016">[ date ]</a>
              <a href="thread.html#93016">[ thread ]</a>
              <a href="subject.html#93016">[ subject ]</a>
              <a href="author.html#93016">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
