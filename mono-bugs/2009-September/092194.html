<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 536294] New: CS0120 for query comprehension	expression
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20536294%5D%20New%3A%20CS0120%20for%20query%20comprehension%0A%09expression&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="092195.html">
   <LINK REL="Next"  HREF="092197.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 536294] New: CS0120 for query comprehension	expression</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20536294%5D%20New%3A%20CS0120%20for%20query%20comprehension%0A%09expression&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 536294] New: CS0120 for query comprehension	expression">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Sep  2 10:54:36 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="092195.html">[Mono-bugs] [Bug 536290] Reports IsPublic=false for public nested	types
</A></li>
        <LI>Next message: <A HREF="092197.html">[Mono-bugs] [Bug 536294] CS0120 for query comprehension expression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92194">[ date ]</a>
              <a href="thread.html#92194">[ thread ]</a>
              <a href="subject.html#92194">[ subject ]</a>
              <a href="author.html#92194">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=536294">http://bugzilla.novell.com/show_bug.cgi?id=536294</A>


           Summary: CS0120 for query comprehension expression
    Classification: Mono
           Product: Mono: Compilers
           Version: SVN
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: C#
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


The following block of code (which accesses no static members):

    var res = from cust in db.Customers
        where (from c in db.Customers
            where c.CompanyName == cust.CompanyName
            select c.CompanyName).Contains(cust.CompanyName)
    select cust.CompanyName;

Results in:

error CS0120: An object reference is required to access non-static member
`DbLinq.Mssql.Example.Program.&lt;Main&gt;c__AnonStorey1.cust'

Removing the nested 'where' allows it to compile (though it also changes
semantics, too, so it's not really a workaround, just narrows down where the
issue is).

To reproduce:

Save the sample code (below) and compile it:

    gmcs foo.cs -r:System.Data.dll -r:System.Data.Linq.dll

Expected results:

    No error.  (CSC compiles with no error.)

Actual results:

    Error CS0120 (see above).

Example code:

    using System;
    using System.Data.Linq.Mapping;
    using System.Data.Linq;
    using System.Data.SqlClient;
    using System.Linq;

    using nwind;

    namespace nwind
    {
        using System.Data.Linq.Mapping;
        using System.Data;
        using System.Collections.Generic;
        using System.Reflection;
        using System.Linq;
        using System.Linq.Expressions;
        using System.ComponentModel;
        using System;

        public partial class Northwind : DataContext
        {
            public Northwind(System.Data.IDbConnection connection)
                : base(connection)
            {
            }

            public Table&lt;Customer&gt; Customers
            {
                get
                {
                    return this.GetTable&lt;Customer&gt;();
                }
            }
        }

        [Table(Name = &quot;dbo.Customers&quot;)]
        public partial class Customer : INotifyPropertyChanging,
INotifyPropertyChanged
        {

            private static PropertyChangingEventArgs emptyChangingEventArgs =
new PropertyChangingEventArgs(String.Empty);

            private string _CompanyName;

            #region Extensibility Method Definitions
            partial void OnCreated();
            partial void OnCompanyNameChanging(string value);
            partial void OnCompanyNameChanged();
            #endregion

            public Customer()
            {
                OnCreated();
            }

            [Column(Storage = &quot;_CompanyName&quot;, DbType = &quot;VarChar(40) NOT NULL&quot;,
CanBeNull = false)]
            public string CompanyName
            {
                get
                {
                    return this._CompanyName;
                }
                set
                {
                    if ((this._CompanyName != value))
                    {
                        this.OnCompanyNameChanging(value);
                        this.SendPropertyChanging();
                        this._CompanyName = value;
                        this.SendPropertyChanged(&quot;CompanyName&quot;);
                        this.OnCompanyNameChanged();
                    }
                }
            }

            public event PropertyChangingEventHandler PropertyChanging;

            public event PropertyChangedEventHandler PropertyChanged;

            protected virtual void SendPropertyChanging()
            {
                if ((this.PropertyChanging != null))
                {
                    this.PropertyChanging(this, emptyChangingEventArgs);
                }
            }

            protected virtual void SendPropertyChanged(String propertyName)
            {
                if ((this.PropertyChanged != null))
                {
                    this.PropertyChanged(this, new
PropertyChangedEventArgs(propertyName));
                }
            }
        }
    }

    namespace DbLinq.Mssql.Example
    {
        class Program
        {
            static void Main(string[] args)
            {
                string connStr = &quot;Data Source=.\\SQLExpress;Integrated
Security=True;Initial Catalog=Northwind&quot;;
                 Northwind db = new Northwind(new SqlConnection(connStr));


                var res = from cust in db.Customers
                    where (from c in db.Customers
                            where c.CompanyName == cust.CompanyName
                            select c.CompanyName).Contains(cust.CompanyName)
                          select cust.CompanyName;


                foreach (var r in res.ToList())
                    Console.WriteLine(r);
            }
        }
    }

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="092195.html">[Mono-bugs] [Bug 536290] Reports IsPublic=false for public nested	types
</A></li>
	<LI>Next message: <A HREF="092197.html">[Mono-bugs] [Bug 536294] CS0120 for query comprehension expression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92194">[ date ]</a>
              <a href="thread.html#92194">[ thread ]</a>
              <a href="subject.html#92194">[ subject ]</a>
              <a href="author.html#92194">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
