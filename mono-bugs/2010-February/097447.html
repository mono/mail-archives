<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 580086] Running mod_mono from svn on apache gives constant &quot;Abnormal string size&quot; exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20580086%5D%20Running%20mod_mono%20from%20svn%20on%20apache%20gives%0A%20constant%20%22Abnormal%20string%20size%22%20exceptions&In-Reply-To=bug-580086-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="097446.html">
   <LINK REL="Next"  HREF="097448.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 580086] Running mod_mono from svn on apache gives constant &quot;Abnormal string size&quot; exceptions</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20580086%5D%20Running%20mod_mono%20from%20svn%20on%20apache%20gives%0A%20constant%20%22Abnormal%20string%20size%22%20exceptions&In-Reply-To=bug-580086-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 580086] Running mod_mono from svn on apache gives constant &quot;Abnormal string size&quot; exceptions">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Feb 16 04:18:52 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="097446.html">[Mono-bugs] [Bug 580086] Running mod_mono from svn on apache gives constant &quot;Abnormal string size&quot; exceptions
</A></li>
        <LI>Next message: <A HREF="097448.html">[Mono-bugs] [Bug 580086] Running mod_mono from svn on apache gives constant &quot;Abnormal string size&quot; exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97447">[ date ]</a>
              <a href="thread.html#97447">[ thread ]</a>
              <a href="subject.html#97447">[ subject ]</a>
              <a href="author.html#97447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=580086">http://bugzilla.novell.com/show_bug.cgi?id=580086</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=580086#c3">http://bugzilla.novell.com/show_bug.cgi?id=580086#c3</A>


--- Comment #3 from Asgeir Halldorsson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">asgeir.halldorsson at dempseyclark.is</A>&gt; 2010-02-16 09:18:50 UTC ---
Sorry about the priority and I will keep that in mind for further submissions
;)

For me to reproduce this problem is easy its happens always with trunk version
of Mono (Might be revision 148995 that caused this).  The exact problem is that
xsp reads from mono the following:

1. Packet size + protocol version (5 bytes in total) (Goes good)
2. Fills the buffer for the rest.  But (here comes the issue)

The read from mod_mono is good but as it is putting it into the byte array of
MemoryStream directly.  When MemoryStream.SetLength is called it clears the
first (5 bytes) from the array.

This causes GetString() method to throw &quot;Abnormal string size&quot; exception.

I know this is an issue with MemoryStream.cs but I also think ModMonoRequest
should not assume how MemoryStream handles it internal buffer.

Another note:
My patch is not perfect as it should reuse the buffer that is used for reading
from the buffer. So I am attaching another patch to fix that (Includes prev
patch).

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>










































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="097446.html">[Mono-bugs] [Bug 580086] Running mod_mono from svn on apache gives constant &quot;Abnormal string size&quot; exceptions
</A></li>
	<LI>Next message: <A HREF="097448.html">[Mono-bugs] [Bug 580086] Running mod_mono from svn on apache gives constant &quot;Abnormal string size&quot; exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97447">[ date ]</a>
              <a href="thread.html#97447">[ thread ]</a>
              <a href="subject.html#97447">[ subject ]</a>
              <a href="author.html#97447">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
