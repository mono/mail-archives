<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 580618] New: mono/mini/tasklets.c: Store gives OutOfMemoryException instead of descriptive message if Mark not called
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20580618%5D%20New%3A%20mono/mini/tasklets.c%3A%20Store%20gives%0A%20OutOfMemoryException%20instead%20of%20descriptive%20message%20if%20Mark%20not%20called&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="097652.html">
   <LINK REL="Next"  HREF="097507.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 580618] New: mono/mini/tasklets.c: Store gives OutOfMemoryException instead of descriptive message if Mark not called</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20580618%5D%20New%3A%20mono/mini/tasklets.c%3A%20Store%20gives%0A%20OutOfMemoryException%20instead%20of%20descriptive%20message%20if%20Mark%20not%20called&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 580618] New: mono/mini/tasklets.c: Store gives OutOfMemoryException instead of descriptive message if Mark not called">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Feb 17 13:23:23 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="097652.html">[Mono-bugs] [Bug 580596] Inconsistent ThreadStart related to LINQ	against vtypes
</A></li>
        <LI>Next message: <A HREF="097507.html">[Mono-bugs] [Bug 580618] mono/mini/tasklets.c: Store gives OutOfMemoryException instead of descriptive message if Mark not called
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97479">[ date ]</a>
              <a href="thread.html#97479">[ thread ]</a>
              <a href="subject.html#97479">[ subject ]</a>
              <a href="author.html#97479">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=580618">http://bugzilla.novell.com/show_bug.cgi?id=580618</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=580618#c0">http://bugzilla.novell.com/show_bug.cgi?id=580618#c0</A>


           Summary: mono/mini/tasklets.c: Store gives OutOfMemoryException
                    instead of descriptive message if Mark not called
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.6.x
          Platform: All
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">xocotl at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=342983)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=342983">http://bugzilla.novell.com/attachment.cgi?id=342983</A>)
patch to fix this issue

User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2)
Gecko/20100212 Ubuntu/10.04 (lucid) Firefox/3.6

Store gives OutOfMemoryException instead of descriptive message if Mark not
called.

Reproducible: Always

Steps to Reproduce:
Call Store without Mark on Mono.Tasklets.Continuation.
Actual Results:  
OutOfMemoryException

Expected Results:  
a descriptive error message

Here is a patch to fix this. It also fixes store letting the call fall through
even if it should return an exception (for example, right now if another thread
calls, it will set the error message, but still allow the call).

Two other things should be fixed:
1) If stacks are over 2GB, the tasklet code is going to burn. Speedwise, sure,
but it also uses int for stack sizes instead of pointer size. :)
2) ArgumentException is really inappropriate passed back directly by
Continuation. It is not a parameter, but instead the state of the Continuation
object: InvalidOperationException. For the low level native API,
ArgumentException works if you want to keep it, but at least try { } catch {
throw InvalidOp...

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="097652.html">[Mono-bugs] [Bug 580596] Inconsistent ThreadStart related to LINQ	against vtypes
</A></li>
	<LI>Next message: <A HREF="097507.html">[Mono-bugs] [Bug 580618] mono/mini/tasklets.c: Store gives OutOfMemoryException instead of descriptive message if Mark not called
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97479">[ date ]</a>
              <a href="thread.html#97479">[ thread ]</a>
              <a href="subject.html#97479">[ subject ]</a>
              <a href="author.html#97479">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
