<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 579252] New: Array.AsReadOnly(x).CopyTo does not	copy anything
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20579252%5D%20New%3A%20Array.AsReadOnly%28x%29.CopyTo%20does%20not%0A%09copy%20anything&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="097512.html">
   <LINK REL="Next"  HREF="097376.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 579252] New: Array.AsReadOnly(x).CopyTo does not	copy anything</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20579252%5D%20New%3A%20Array.AsReadOnly%28x%29.CopyTo%20does%20not%0A%09copy%20anything&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 579252] New: Array.AsReadOnly(x).CopyTo does not	copy anything">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Feb 11 14:17:26 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="097512.html">[Mono-bugs] [Bug 579241] System.Web.HttpFileCollectionWrapper (System.Web.Abstractions.dll) Get method and indexer by name throw exceptions for unfound name/index
</A></li>
        <LI>Next message: <A HREF="097376.html">[Mono-bugs] [Bug 579252] Array.AsReadOnly(x).CopyTo does not copy	anything
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97375">[ date ]</a>
              <a href="thread.html#97375">[ thread ]</a>
              <a href="subject.html#97375">[ subject ]</a>
              <a href="author.html#97375">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=579252">http://bugzilla.novell.com/show_bug.cgi?id=579252</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=579252#c0">http://bugzilla.novell.com/show_bug.cgi?id=579252#c0</A>


           Summary: Array.AsReadOnly(x).CopyTo does not copy anything
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.6.x
          Platform: All
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">cdhowie at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.7)
Gecko/20091221 Firefox/3.5.7 (.NET CLR 3.5.30729)

Array.AsReadOnly with an array (byte[] in my case) returns a read-only wrapper
around the array (of course).  But this wrapper's CopyTo method does nothing at
all.

This causes IEnumerable.ToArray to fail when applied to the result of an
Array.AsReadOnly call, because it uses ICollection&lt;T&gt;.CopyTo if the enumerable
is a collection.

See the following output from csharp:

csharp&gt; ((System.Collections.Generic.IEnumerable&lt;byte&gt;)(new byte [] {1, 2,
3})).ToArray ();
{ 1, 2, 3 }
csharp&gt; Array.AsReadOnly(new byte [] {1, 2, 3}).ToArray();
{ 0, 0, 0 }

Reading the code, I cannot see how this happens, because the two wrappers
around the array simply call into their wrapped objects' CopyTo method.  So it
*should* work... and yet it does not.

Reproducible: Always

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="097512.html">[Mono-bugs] [Bug 579241] System.Web.HttpFileCollectionWrapper (System.Web.Abstractions.dll) Get method and indexer by name throw exceptions for unfound name/index
</A></li>
	<LI>Next message: <A HREF="097376.html">[Mono-bugs] [Bug 579252] Array.AsReadOnly(x).CopyTo does not copy	anything
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97375">[ date ]</a>
              <a href="thread.html#97375">[ thread ]</a>
              <a href="subject.html#97375">[ subject ]</a>
              <a href="author.html#97375">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
