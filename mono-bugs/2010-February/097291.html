<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20573682%5D%20segtaults%20when%20encoding/decoding%20non-UTF8%0A%09strings&In-Reply-To=bug-573682-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="097290.html">
   <LINK REL="Next"  HREF="097292.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20573682%5D%20segtaults%20when%20encoding/decoding%20non-UTF8%0A%09strings&In-Reply-To=bug-573682-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Feb  9 11:46:00 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="097290.html">[Mono-bugs] [Bug 575598] Softdebugging this program crashes the	mono runtime
</A></li>
        <LI>Next message: <A HREF="097292.html">[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97291">[ date ]</a>
              <a href="thread.html#97291">[ thread ]</a>
              <a href="subject.html#97291">[ subject ]</a>
              <a href="author.html#97291">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=573682">http://bugzilla.novell.com/show_bug.cgi?id=573682</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=573682#c13">http://bugzilla.novell.com/show_bug.cgi?id=573682#c13</A>


--- Comment #13 from Ted Unangst &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">tedu at fogcreek.com</A>&gt; 2010-02-09 16:45:59 UTC ---
Sorry, no.  I'm still puzzling out exactly what HandleFallback is doing, but
here's some more info for you.

CP1250:ToBytes is initially called on a string of 44 characters:
init cc 44 bc 44 ci 0 bi 0

It loops a while, then calls HandleFallback (this is with your patch, so
charCount is one less than byteCount).
before cc 34 bc 35 ci 10 bi 10
(recursive calls to ToBytes occur).
after cc 34 bc 35 ci 10 bi 11

The thing I notice here is that HandleFallback has incremented the byte index,
while not touching the character counts.

This continues a while, with the byte index creeping up faster than charCount
or charIndex.
before cc 1 bc 2 ci 43 bi 52
after cc 1 bc 2 ci 43 bi 53
The byte index is now outside the range of the 44 byte allocated array, and we
don't have long to live:
before cc 0 bc 1 ci 44 bi 54
CRASH.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="097290.html">[Mono-bugs] [Bug 575598] Softdebugging this program crashes the	mono runtime
</A></li>
	<LI>Next message: <A HREF="097292.html">[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97291">[ date ]</a>
              <a href="thread.html#97291">[ thread ]</a>
              <a href="subject.html#97291">[ subject ]</a>
              <a href="author.html#97291">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
