<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 75886][Cri] Changed - Remoting Configuration
	Win32-Client Mono-server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075886%5D%5BCri%5D%20Changed%20-%20Remoting%20Configuration%0A%09Win32-Client%20Mono-server&In-Reply-To=bug-75886%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033452.html">
   <LINK REL="Next"  HREF="033454.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 75886][Cri] Changed - Remoting Configuration
	Win32-Client Mono-server</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075886%5D%5BCri%5D%20Changed%20-%20Remoting%20Configuration%0A%09Win32-Client%20Mono-server&In-Reply-To=bug-75886%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 75886][Cri] Changed - Remoting Configuration
	Win32-Client Mono-server">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Fri Sep  9 12:33:53 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="033452.html">[Mono-bugs] [Bug 70878][Nor] Changed - ecma-provider runtime
	Reflection uses LoadWithPartialName
</A></li>
        <LI>Next message: <A HREF="033454.html">[Mono-bugs] [Bug 76012][Nor] Changed - X509Certificates.cs: Parse
	Problem Of Version
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33453">[ date ]</a>
              <a href="thread.html#33453">[ thread ]</a>
              <a href="subject.html#33453">[ subject ]</a>
              <a href="author.html#33453">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">yngve.zackrisson at mobila-kontoret.se.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=75886">http://bugzilla.ximian.com/show_bug.cgi?id=75886</A>

--- shadow/75886	2005-08-30 13:45:16.000000000 -0400
+++ shadow/75886.tmp.8916	2005-09-09 12:33:53.000000000 -0400
@@ -196,6 +196,107 @@
 if I have the --trace=none option on.
 
 To summarise: The main problem seems to be in 
 RemotingConfiguration.Configure(..);
 
 
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">yngve.zackrisson at mobila-kontoret.se</A>  2005-09-09 12:33 -------
+Hi again! 
+
+(1) I think I have found the source to the: 
+
+'400 : Bad request'
+
+In my custom SecureChannel the is additional custom headers 
+named like sc_TransactionType etc that is added 
+to the http request's ITransportHeaders.
+(See: the SecureChannel's Messages.cs internal class CommonHeaders
+for the exact names).
+
+The additional custom header's become something like : 
+
+sc_TransactionType 10
+
+In Mono:s System.Runtime.Remoting.Channels.Http 
+source HttpServer.cs 
+the request is processed and the 
+bool ParseHeader (...) 
+method is executed.
+In this method the custom header is of course not found 
+in ReqMessageParser.ParseHeaderField(...) .
+
+When the ReqMessageParser.IsCustomHeader(...) 
+is executed the abowe custom header is not allowed, 
+causing a : 
+SendResponse (reqArg, 400, null, null);
+hence the '400 : Bad request' i quess.
+
+The question now is whether this is right?.
+In MS .NET i get no '400 : Bad request' 
+using the same custom SecureChannel.
+
+Diving deeper into the IsCustomHeader(...) 
+i found that a Regex was used.
+
+The regular expression goes like this: 
+
+&quot;^(?&lt;header&gt;\\S+)(\\s*:\\s*)(?&lt;field&gt;\\S+(\\s|\\S)*\\S)(\\s*)&quot;
+
+Never having beeing exposed to regular expressions 
+I tryed a number of custom heder strings against 
+this regular expression in my CSharpDevelop on Windows.
+For instance: 
+
+sc_TransactionType 10
+scTransactionType 10
+ sc_TransactionType 10
+ scTransactionType 10
+scTransactionType10
+scTransactionType
+
+All of these tests failed.
+
+When studying .NET regular expressions I could not find 
+any reference to the ( : ) group construct.
+Since I could not understand the (\\s*:\\s*) construct 
+I changed that to simply (\\s*)
+getting the regular expression : 
+
+&quot;^(?&lt;header&gt;\\S+)(\\s*)(?&lt;field&gt;\\S+(\\s|\\S)*\\S)(\\s*)&quot;
+
+After that the test 
+
+sc_TransactionType 10
+
+went ok
+All of the other tests failed.
+
+Maybe the regular expression should be changed?. 
+If not, how should it be possible to add custom headers 
+to a http request?.
+
+------------------------------------------------------------------
+
+(2) EXCEPTION handling: FormatException
+
+During my run of my test app with --trace=none 
+I got FormatException's (se abowe for more on this).
+
+After digging into this I found that the cause for this 
+exception was that the HttpServerChannel property &quot;machineName&quot; 
+was not added, hence the FormatException.
+
+The exception is thrown in : 
+namespace: System.Runtime.Remoting.Channels.Http 
+class: HttpServerChannel 
+method: void SetupMachineName()
+
+AFAIK, this causes no problem to mee. Only the belief there is one.
+
+-------------------------------------------------------------------
+
+Regards 
+
+
+Yngve Zackrisson.
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033452.html">[Mono-bugs] [Bug 70878][Nor] Changed - ecma-provider runtime
	Reflection uses LoadWithPartialName
</A></li>
	<LI>Next message: <A HREF="033454.html">[Mono-bugs] [Bug 76012][Nor] Changed - X509Certificates.cs: Parse
	Problem Of Version
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33453">[ date ]</a>
              <a href="thread.html#33453">[ thread ]</a>
              <a href="subject.html#33453">[ subject ]</a>
              <a href="author.html#33453">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
