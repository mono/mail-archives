<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 75891][Nor] Changed - _wapi_handle_share_release:
	assertion failed: (info-&gt;handle_refs &gt; 0)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075891%5D%5BNor%5D%20Changed%20-%20_wapi_handle_share_release%3A%0A%09assertion%20failed%3A%20%28info-%3Ehandle_refs%20%3E%200%29&In-Reply-To=bug-75891%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033607.html">
   <LINK REL="Next"  HREF="033609.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 75891][Nor] Changed - _wapi_handle_share_release:
	assertion failed: (info-&gt;handle_refs &gt; 0)</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075891%5D%5BNor%5D%20Changed%20-%20_wapi_handle_share_release%3A%0A%09assertion%20failed%3A%20%28info-%3Ehandle_refs%20%3E%200%29&In-Reply-To=bug-75891%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 75891][Nor] Changed - _wapi_handle_share_release:
	assertion failed: (info-&gt;handle_refs &gt; 0)">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Tue Sep 13 15:38:56 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="033607.html">[Mono-bugs] [Bug 76089][Nor] New - Graphics.Save() throws
	NullReferenceException
</A></li>
        <LI>Next message: <A HREF="033609.html">[Mono-bugs] [Bug 74680][Nor] Changed - Creating mutex on new I/O
	layer returns wrong status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33608">[ date ]</a>
              <a href="thread.html#33608">[ thread ]</a>
              <a href="subject.html#33608">[ subject ]</a>
              <a href="author.html#33608">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">trow at ximian.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=75891">http://bugzilla.ximian.com/show_bug.cgi?id=75891</A>

--- shadow/75891	2005-09-13 07:43:13.000000000 -0400
+++ shadow/75891.tmp.14852	2005-09-13 15:38:56.000000000 -0400
@@ -51,6 +51,25 @@
 The problem this patch addresses is opening a file for a second time,
 when for some reason the file descriptor for the first time has been
 closed &quot;behind the back&quot; of io-layer.  It will now return a share
 violation because the file handle is still open, rather than wiping
 out the share info and crashing later when the handles are closed. 
 I'm not sure this is the best rememdy, but it fixes this particular case.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">trow at ximian.com</A>  2005-09-13 15:38 -------
+Dick: It shouldn't take *that* long to run.  Could the process be
+wedged, or does it seem to be doing something?
+
+I built mono 1.1.8.3 with your latest patch.  The patch definitely
+helps --- bludgeon ran longer than ever --- but I got the exact same
+assertion again after a few minutes.  In the cases I've observed, it
+always seems to happen after a file has been deleted.
+
+I'm not sure what would cause a fd to get closed behind the io-layer's
+back... AFAIK, we never manipulate file descriptors directly.
+
+A good bludgeon test to run is:
+bludgeon --cycles 50 --total-time 10 Basic:*
+That will do 50 random operations on the file system, wait for the
+beagled to finish indexing, and then systematically check that the
+index and the file system are in sync.  It will keep doing this until
+10 minutes has passed or until it finds an inconsistency in the index.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033607.html">[Mono-bugs] [Bug 76089][Nor] New - Graphics.Save() throws
	NullReferenceException
</A></li>
	<LI>Next message: <A HREF="033609.html">[Mono-bugs] [Bug 74680][Nor] Changed - Creating mutex on new I/O
	layer returns wrong status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33608">[ date ]</a>
              <a href="thread.html#33608">[ thread ]</a>
              <a href="subject.html#33608">[ subject ]</a>
              <a href="author.html#33608">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
