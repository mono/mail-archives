<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 543540] New: repeatedly creating &amp; disposing of forms on OSX causes problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20543540%5D%20New%3A%20repeatedly%20creating%20%26%20disposing%20of%0A%20forms%20on%20OSX%20causes%20problems&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="093297.html">
   <LINK REL="Next"  HREF="093208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 543540] New: repeatedly creating &amp; disposing of forms on OSX causes problems</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20543540%5D%20New%3A%20repeatedly%20creating%20%26%20disposing%20of%0A%20forms%20on%20OSX%20causes%20problems&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 543540] New: repeatedly creating &amp; disposing of forms on OSX causes problems">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Oct  1 11:39:06 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="093297.html">[Mono-bugs] [Bug 543537] gmcs should report about lacking inner reference even when the assemblies exist
</A></li>
        <LI>Next message: <A HREF="093208.html">[Mono-bugs] [Bug 542305] Debugging doesn't work if 'mono' is a shell script instead of an executable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#93207">[ date ]</a>
              <a href="thread.html#93207">[ thread ]</a>
              <a href="subject.html#93207">[ subject ]</a>
              <a href="author.html#93207">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=543540">http://bugzilla.novell.com/show_bug.cgi?id=543540</A>


           Summary: repeatedly creating &amp; disposing of forms on OSX causes
                    problems
    Classification: Mono
           Product: Mono: Class Libraries
           Version: SVN
          Platform: Macintosh
        OS/Version: Mac OS X 10.5
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Windows.Forms
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">webservices at landmarkdigital.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=320685)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=320685">http://bugzilla.novell.com/attachment.cgi?id=320685</A>)
Test harness source

User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_8; en-us)
AppleWebKit/530.19.2 (KHTML, like Gecko) Version/4.0.2 Safari/530.19

To be precise, this bug should be submitted against the mono 2.6 OSX preview,
but that is not in the web form version list.

On OSX, when a Form is displayed then Dispose'd, the system appears to retain a
reference of some sort to the disposed Form object.  The code below repeatedly
creates a very simple form then disposes of the form once the ShowDialog()
method has returned.  Usually after between 5 and 10 iterations of this,
problems start occuring: either the UI will stop responding entirely, or new
windows won't display, or new windows don't draw.

When the exact same compiled assembly is executed on SLES 11 mono 2.4, no
problems manifest.

Reproducible: Always

Steps to Reproduce:
public class formTest
{
  public static void Main (string[] arg)
  {
    // creating and disposing of forms on mono/OSX causes problems...
    for (int i=0; i&lt;20; i++) {
      System.Windows.Forms.Form form = new System.Windows.Forms.Form();
      System.Windows.Forms.TableLayoutPanel tlPanel = new
System.Windows.Forms.TableLayoutPanel();

      System.Windows.Forms.Label label = new System.Windows.Forms.Label();
      label.Text = &quot;&quot; + i;
      form.Controls.Add(label);

      System.Windows.Forms.Button button = new System.Windows.Forms.Button();
      button.Text = &quot;Close&quot;;
      button.DialogResult = System.Windows.Forms.DialogResult.OK;
      button.Anchor = System.Windows.Forms.AnchorStyles.None;

      tlPanel.Controls.Add(label, 0, 0);
      tlPanel.Controls.Add(button, 0, 1);
      tlPanel.Dock = System.Windows.Forms.DockStyle.Fill;
      tlPanel.Size = new System.Drawing.Size(50, 50);
      form.Controls.Add(tlPanel);

      form.Size = form.GetPreferredSize(new System.Drawing.Size(0, 0));
      form.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
      form.MaximizeBox = false;
      form.MinimizeBox = false;
      form.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
      //form.Scale(new System.Drawing.SizeF(2, 2));
      try {
        form.ShowDialog();
      } finally {
        form.Dispose();
      }
    }
  }
}



gmcs -r:System.Windows.Forms.dll -r:System.Drawing.dll formTest.cs

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="093297.html">[Mono-bugs] [Bug 543537] gmcs should report about lacking inner reference even when the assemblies exist
</A></li>
	<LI>Next message: <A HREF="093208.html">[Mono-bugs] [Bug 542305] Debugging doesn't work if 'mono' is a shell script instead of an executable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#93207">[ date ]</a>
              <a href="thread.html#93207">[ thread ]</a>
              <a href="subject.html#93207">[ subject ]</a>
              <a href="author.html#93207">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
