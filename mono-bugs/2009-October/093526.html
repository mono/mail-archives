<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 546053] New: Same key already exists in the dictionary error when browsing directly to page in sub-folder for precompiled site
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20546053%5D%20New%3A%20Same%20key%20already%20exists%20in%20the%0A%20dictionary%20error%20when%20browsing%20directly%20to%20page%20in%20sub-folder%20for%0A%20precompiled%20site&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="093525.html">
   <LINK REL="Next"  HREF="093539.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 546053] New: Same key already exists in the dictionary error when browsing directly to page in sub-folder for precompiled site</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20546053%5D%20New%3A%20Same%20key%20already%20exists%20in%20the%0A%20dictionary%20error%20when%20browsing%20directly%20to%20page%20in%20sub-folder%20for%0A%20precompiled%20site&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 546053] New: Same key already exists in the dictionary error when browsing directly to page in sub-folder for precompiled site">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun Oct 11 19:21:22 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="093525.html">[Mono-bugs] [Bug 546043] New: WDSL Generation
</A></li>
        <LI>Next message: <A HREF="093539.html">[Mono-bugs] [Bug 546053] Same key already exists in the dictionary error when browsing directly to page in sub-folder for precompiled site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#93526">[ date ]</a>
              <a href="thread.html#93526">[ thread ]</a>
              <a href="subject.html#93526">[ subject ]</a>
              <a href="author.html#93526">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=546053">http://bugzilla.novell.com/show_bug.cgi?id=546053</A>


           Summary: Same key already exists in the dictionary error when
                    browsing directly to page in sub-folder for
                    precompiled site
    Classification: Mono
           Product: Mono: Class Libraries
           Version: SVN
          Platform: i386
        OS/Version: openSUSE 11.1
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.Web
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">chrisbrown76 at hotmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=321967)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=321967">http://bugzilla.novell.com/attachment.cgi?id=321967</A>)
Precompiled test case with source

User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.0; en-GB; rv:1.9.1.3)
Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)

When running a precompiled site if browsing directly to a page in a subfolder
e.g <A HREF="http://localhost:8080/Folder1/sub.aspx">http://localhost:8080/Folder1/sub.aspx</A> prior to browsing to a page in the
root of the site e.g <A HREF="http://localhost:8080">http://localhost:8080</A> a &quot;an element with the same key
already exists in the dictionary&quot; error occurs. 

Reproducible: Always

Steps to Reproduce:
1. Copy precompiled test case into Mono environment
2. Start xsp2 from command line 
3. Open browser and browse directly to <A HREF="http://localhost:8080/Folder1/sub.aspx">http://localhost:8080/Folder1/sub.aspx</A>
Actual Results:  
The following error occurs:

Server Error in '/' Application
An element with the same key already exists in the dictionary.

Description: HTTP 500. Error processing request.

Stack Trace:

System.ArgumentException: An element with the same key already exists in the
dictionary.
  at
System.Collections.Generic.Dictionary`2[System.String,System.Web.Compilation.BuildManager+PreCompilationData].Add
(System.String key, System.Web.Compilation.PreCompilationData value) [0x00000] 
  at System.Web.Compilation.BuildManager.FixVirtualPaths () [0x00000] 
  at System.Web.Compilation.BuildManager.LoadPrecompilationInfo (System.String
precomp_config) [0x00000] 
  at System.Web.Compilation.BuildManager..cctor () [0x00000] 

Version information: Mono Runtime Version: /trunk/mono r143818 Fri Oct 9
15:34:19 NZDT 2009; ASP.NET Version: 2.0.50727.1433


Expected Results:  
Page is returned normally and displays &quot;This is a page in the sub-folder&quot;

As the error states the problem is occurring in
System.Web.Compilation.BuildManager.FixVirtualPaths but specifically it seems
to relate to the fact that both 'global.asax' and 'index.aspx' are present in
our test case. In these two cases 'precompiled.Add' at line 197 will attempt to
add each of these with a 'new_path' value of &quot;/&quot; which consequently results in
the &quot;same key already exists&quot; error we see. However I don't think these files
specifically are related to the problem just any combination of two or more
files that will both have the same new_path value of &quot;/&quot; when FixVirtualPaths
is run. 

I am using using r143818. I see the same behaviour when testing under Apache
also.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="093525.html">[Mono-bugs] [Bug 546043] New: WDSL Generation
</A></li>
	<LI>Next message: <A HREF="093539.html">[Mono-bugs] [Bug 546053] Same key already exists in the dictionary error when browsing directly to page in sub-folder for precompiled site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#93526">[ date ]</a>
              <a href="thread.html#93526">[ thread ]</a>
              <a href="subject.html#93526">[ subject ]</a>
              <a href="author.html#93526">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
