<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 372893] PasswordDeriveBytes.GetBytes() not producing expected output
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20372893%5D%20PasswordDeriveBytes.GetBytes%28%29%20not%0A%20producing%20expected%20output&In-Reply-To=bug-372893-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="070925.html">
   <LINK REL="Next"  HREF="070926.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 372893] PasswordDeriveBytes.GetBytes() not producing expected output</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20372893%5D%20PasswordDeriveBytes.GetBytes%28%29%20not%0A%20producing%20expected%20output&In-Reply-To=bug-372893-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 372893] PasswordDeriveBytes.GetBytes() not producing expected output">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Mar 21 10:24:10 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="070925.html">[Mono-bugs] [Bug 372893] New: PasswordDeriveBytes.GetBytes() not producing expected output
</A></li>
        <LI>Next message: <A HREF="070926.html">[Mono-bugs] [Bug 372897] New: [REGRESSION] Session not available in	Page_Init
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70930">[ date ]</a>
              <a href="thread.html#70930">[ thread ]</a>
              <a href="subject.html#70930">[ subject ]</a>
              <a href="author.html#70930">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=372893">https://bugzilla.novell.com/show_bug.cgi?id=372893</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">spouliot at novell.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=372893#c1">https://bugzilla.novell.com/show_bug.cgi?id=372893#c1</A>


Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">spouliot at novell.com</A>&gt; changed:

           What    |Removed                                         |Added
----------------------------------------------------------------------------
                 CC|                                                |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">spouliot at novell.com</A>
             Status|NEW                                             |RESOLVED
         Resolution|                                                |WONTFIX




--- Comment #1 from Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">spouliot at novell.com</A>&gt;  2008-03-21 08:24:10 MST ---
Hello Drew,

You're in BIG trouble if you use this code (at least on MS platform). 

First MS &quot;extended&quot; PKCS#5 v1.5 outside it's secure limit (you should never ask
more bytes than what the hash function can provide - the standard ask
implementation to abort in such case). MS doesn't (abort) and Mono does not
either (for compatibility).

Second MS &quot;extension&quot; process is *buggy*. How ? have a look at what MS
outputs... (and note the values I aligned).

NET 2.0 Output:
key 12
key 252
key 122
key 125
   key 78
   key 182
   key 178
   key 145
key 136
key 24
key 114
key 225
key 94
key 103
key 178
key 85
   iv 78
   iv 182
   iv 178
   iv 145
iv 14
iv 96
iv 171
iv 186
iv 197
iv 27
iv 203
iv 82
iv 171
iv 228
iv 50
iv 180

Since your IV is generally public data you're leaking 4 bytes (32 bits) of your
key (in this case only 96 bits remains &quot;safe&quot; from this bug).

Mono does not duplicate this bug (so I'm closing this bug as WONTFIX).

You can find more details about this on
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=316364">https://bugzilla.novell.com/show_bug.cgi?id=316364</A>

Since you seem to be using .NET 2.0 I *strongly* recommend that you use the
Rfc2898DeriveBytes class, which implements PKCS#5 v2 and doesn't, at my
knowledge, have a similar issue.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>
























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="070925.html">[Mono-bugs] [Bug 372893] New: PasswordDeriveBytes.GetBytes() not producing expected output
</A></li>
	<LI>Next message: <A HREF="070926.html">[Mono-bugs] [Bug 372897] New: [REGRESSION] Session not available in	Page_Init
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70930">[ date ]</a>
              <a href="thread.html#70930">[ thread ]</a>
              <a href="subject.html#70930">[ subject ]</a>
              <a href="author.html#70930">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
