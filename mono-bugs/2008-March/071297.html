<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 375274] New: Use of a native dll- In this case filehelpers. dll causes a catastrophic failure of the compiler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20375274%5D%20New%3A%20Use%20of%20a%20native%20dll-%20In%20this%20case%0A%20filehelpers.%20dll%20causes%20a%20catastrophic%20failure%20of%20the%20compiler&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="071366.html">
   <LINK REL="Next"  HREF="071298.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 375274] New: Use of a native dll- In this case filehelpers. dll causes a catastrophic failure of the compiler</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20375274%5D%20New%3A%20Use%20of%20a%20native%20dll-%20In%20this%20case%0A%20filehelpers.%20dll%20causes%20a%20catastrophic%20failure%20of%20the%20compiler&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 375274] New: Use of a native dll- In this case filehelpers. dll causes a catastrophic failure of the compiler">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun Mar 30 12:46:47 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="071366.html">[Mono-bugs] [Bug 375273] Glyph Map - crashes FF is you move off the	page
</A></li>
        <LI>Next message: <A HREF="071298.html">[Mono-bugs] [Bug 375275] New: [Regression] HHH Comic - shows only	gray canvas
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71297">[ date ]</a>
              <a href="thread.html#71297">[ thread ]</a>
              <a href="subject.html#71297">[ subject ]</a>
              <a href="author.html#71297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=375274">https://bugzilla.novell.com/show_bug.cgi?id=375274</A>


           Summary: Use of a native dll- In this case filehelpers.dll causes
                    a catastrophic failure of the compiler
           Product: Mono: Compilers
           Version: 1.9.0
          Platform: x86-64
        OS/Version: openSUSE 10.3
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: Other.
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gsteri1 at hotmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Customer


I am compiling a project which works under winXP. The references to some dlls
were missing. The dlls were the output from filehelpers.dll. Instead of
re-building the project (filehelpers) under mono for opensuse 10.3, I did the
bone head thing and just included a reference to the pre-built win32 code. The
following is the mayhem which ensued! -Greg

** ERROR **: file class.c: line 836 (mono_class_setup_fields): assertion
failed: ((packing_size &amp; 0xfffffff0) == 0)
aborting...
Stacktrace:

  at (wrapper managed-to-native) System.Reflection.Assembly.InternalGetType
(System.Reflection.Module,string,bool,bool) &lt;0x00062&gt;
  at (wrapper managed-to-native) System.Reflection.Assembly.InternalGetType
(System.Reflection.Module,string,bool,bool) &lt;0xffffffff&gt;
  at System.Reflection.Assembly.GetType (string,bool,bool) &lt;0x00045&gt;
  at System.Reflection.Assembly.GetType (string) &lt;0x00026&gt;
  at Mono.CSharp.RootNamespace.GetTypeInAssembly
(System.Reflection.Assembly,string) &lt;0x0002d&gt;
  at Mono.CSharp.GlobalRootNamespace.LookupTypeReflection
(string,Mono.CSharp.Location) &lt;0x00060&gt;
  at Mono.CSharp.Namespace.LookupType (string,Mono.CSharp.Location) &lt;0x0016f&gt;
  at Mono.CSharp.Namespace.Lookup
(Mono.CSharp.DeclSpace,string,Mono.CSharp.Location) &lt;0x000b5&gt;
  at Mono.CSharp.NamespaceEntry.Lookup
(Mono.CSharp.DeclSpace,string,Mono.CSharp.Location,bool) &lt;0x001e3&gt;
  at Mono.CSharp.NamespaceEntry.LookupNamespaceOrType
(Mono.CSharp.DeclSpace,string,Mono.CSharp.Location,bool) &lt;0x0007c&gt;
  at Mono.CSharp.DeclSpace.LookupNamespaceOrType
(string,Mono.CSharp.Location,bool) &lt;0x001ad&gt;
  at Mono.CSharp.DeclSpace.LookupNamespaceOrType
(string,Mono.CSharp.Location,bool) &lt;0x00153&gt;
  at Mono.CSharp.SimpleName.ResolveAsTypeStep
(Mono.CSharp.IResolveContext,bool) &lt;0x00101&gt;
  at Mono.CSharp.Expression.ResolveAsBaseTerminal
(Mono.CSharp.IResolveContext,bool) &lt;0x00047&gt;
  at Mono.CSharp.Expression.ResolveAsTypeTerminal
(Mono.CSharp.IResolveContext,bool) &lt;0x00033&gt;
  at Mono.CSharp.MemberBase.get_MemberType () &lt;0x00061&gt;
  at Mono.CSharp.FieldBase.Define () &lt;0x00017&gt;
  at Mono.CSharp.Field.Define () &lt;0x00031&gt;
  at MemberCoreArrayList.DefineContainerMembers () &lt;0x00095&gt;
  at Mono.CSharp.TypeContainer.DefineContainerMembers
(Mono.CSharp.TypeContainer/MemberCoreArrayList) &lt;0x00020&gt;
  at Mono.CSharp.Class.DefineContainerMembers
(Mono.CSharp.TypeContainer/MemberCoreArrayList) &lt;0x00086&gt;
  at Mono.CSharp.TypeContainer.DoDefineMembers () &lt;0x00a64&gt;
  at Mono.CSharp.Class.DoDefineMembers () &lt;0x00083&gt;
  at Mono.CSharp.TypeContainer.DefineMembers () &lt;0x0005e&gt;
  at Mono.CSharp.RootContext.PopulateTypes () &lt;0x00286&gt;
  at Mono.CSharp.Driver.MainDriver (string[]) &lt;0x00cc7&gt;
  at Mono.CSharp.Driver.Main (string[]) &lt;0x00079&gt;
  at (wrapper runtime-invoke) Mono.CSharp.Driver.runtime_invoke_int_string[]
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;

Native stacktrace:

        /usr/bin/mono [0x533f98]
        /lib64/libpthread.so.0 [0x2b0fa83a3fb0]
        /lib64/libc.so.6(gsignal+0x35) [0x2b0fa8834b45]
        /lib64/libc.so.6(abort+0x110) [0x2b0fa88360e0]
        /usr/lib64/libglib-2.0.so.0(g_logv+0x3ba) [0x2b0fa7f0073a]
        /usr/lib64/libglib-2.0.so.0(g_log+0x83) [0x2b0fa7f007d3]
        /usr/bin/mono [0x45fc78]
        /usr/bin/mono(mono_class_init+0x615) [0x45e085]
        /usr/bin/mono [0x45eb36]
        /usr/bin/mono [0x45ed8d]
        /usr/bin/mono [0x45fb42]
        /usr/bin/mono(mono_class_init+0x615) [0x45e085]
        /usr/bin/mono [0x4c8b54]
        /usr/bin/mono [0x4c8e27]
        /usr/bin/mono [0x4b16cf]
        [0x40294602]

Debug info from gdb:

[?1034hUsing host libthread_db library &quot;/lib64/libthread_db.so.1&quot;.
[Thread debugging using libthread_db enabled]
[New Thread 0x2b0fa8d54b40 (LWP 8844)]
[New Thread 0x40224950 (LWP 8848)]
[New Thread 0x40023950 (LWP 8847)]
0x00002b0fa88c2f12 in select () from /lib64/libc.so.6
  3 Thread 0x40023950 (LWP 8847)  0x00002b0fa83a35c1 in nanosleep ()
   from /lib64/libpthread.so.0
  2 Thread 0x40224950 (LWP 8848)  0x00002b0fa83a0656 in
pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  1 Thread 0x2b0fa8d54b40 (LWP 8844)  0x00002b0fa88c2f12 in select ()
   from /lib64/libc.so.6

Thread 3 (Thread 0x40023950 (LWP 8847)):
#0  0x00002b0fa83a35c1 in nanosleep () from /lib64/libpthread.so.0
#1  0x00000000004e6c1a in collection_thread (unused=&lt;value optimized out&gt;)
    at collection.c:34
#2  0x00002b0fa839c020 in start_thread () from /lib64/libpthread.so.0
#3  0x00002b0fa88c928d in clone () from /lib64/libc.so.6
#4  0x0000000000000000 in ?? ()

Thread 2 (Thread 0x40224950 (LWP 8848)):
#0  0x00002b0fa83a0656 in pthread_cond_wait@@GLIBC_2.3.2 ()
   from /lib64/libpthread.so.0
#1  0x00000000004e20ca in timedwait_signal_poll_cond (cond=0x2aaaaadb2268, 
    mutex=0x2aaaaadb2240, timeout=0x0, alertable=-1) at handles.c:1443
#2  0x00000000004e21ee in _wapi_handle_timedwait_signal_handle (
    handle=&lt;value optimized out&gt;, timeout=0x0, alertable=1) at handles.c:1523
#3  0x00000000004e236d in _wapi_handle_wait_signal_handle (
    handle=0x2aaaaadb226c, alertable=3) at handles.c:1483
#4  0x00000000004d3d82 in WaitForSingleObjectEx (handle=0x404, 
    timeout=4294967295, alertable=0) at wait.c:200
#5  0x00000000004a839f in finalizer_thread (unused=&lt;value optimized out&gt;)
    at gc.c:894
#6  0x000000000048daa6 in start_wrapper (data=&lt;value optimized out&gt;)
    at threads.c:589
#7  0x00000000004d5ab0 in thread_start_routine (args=&lt;value optimized out&gt;)
    at threads.c:282
#8  0x00000000004efd47 in GC_start_routine (arg=&lt;value optimized out&gt;)
    at pthread_support.c:1369
#9  0x00002b0fa839c020 in start_thread () from /lib64/libpthread.so.0
#10 0x00002b0fa88c928d in clone () from /lib64/libc.so.6
#11 0x0000000000000000 in ?? ()

Thread 1 (Thread 0x2b0fa8d54b40 (LWP 8844)):
#0  0x00002b0fa88c2f12 in select () from /lib64/libc.so.6
#1  0x00002b0fa7f270ec in g_spawn_sync () from /usr/lib64/libglib-2.0.so.0
#2  0x00002b0fa7f274c8 in g_spawn_command_line_sync ()
   from /usr/lib64/libglib-2.0.so.0
#3  0x0000000000533ffb in mono_handle_native_sigsegv (
    signal=&lt;value optimized out&gt;, ctx=&lt;value optimized out&gt;)
    at mini-exceptions.c:1044
#4  &lt;signal handler called&gt;
#5  0x00002b0fa8834b45 in raise () from /lib64/libc.so.6
#6  0x00002b0fa88360e0 in abort () from /lib64/libc.so.6
#7  0x00002b0fa7f0073a in g_logv () from /usr/lib64/libglib-2.0.so.0
#8  0x00002b0fa7f007d3 in g_log () from /usr/lib64/libglib-2.0.so.0
#9  0x000000000045fc78 in mono_class_setup_fields (class=0xf6b2c0)
    at class.c:923
#10 0x000000000045e085 in mono_class_init (class=0xf6b2c0) at class.c:3024
#11 0x000000000045eb36 in mono_class_has_references (klass=0xf6b2c0)
    at class.c:993
#12 0x000000000045ed8d in mono_class_layout_fields (class=0xf6a2f0)
    at class.c:1098
#13 0x000000000045fb42 in mono_class_setup_fields (class=0xf6a2f0)
    at class.c:962
#14 0x000000000045e085 in mono_class_init (class=0xf6a2f0) at class.c:3024
#15 0x00000000004c8b54 in mono_reflection_get_type_internal (
    rootimage=0xdc5e30, image=&lt;value optimized out&gt;, info=0x7fff03000a20, 
    ignorecase=0) at reflection.c:6473
#16 0x00000000004c8e27 in mono_reflection_get_type_with_rootimage (
    rootimage=0xdc5e30, image=0x228c, info=0x7fff03000a20, ignorecase=0, 
    type_resolve=0x7fff03000a1c) at reflection.c:6578
#17 0x00000000004b16cf in ves_icall_System_Reflection_Assembly_InternalGetType
    (assembly=0x2aaaabf76300, module=0x0, name=0x2aaaac1d3b58, 
    throwOnError=0 '\0', ignoreCase=6 '\006') at icall.c:4068
#18 0x0000000040294602 in ?? ()
#19 0x000000000071c380 in ?? ()
#20 0x0000000000000006 in ?? ()
#21 0x0000000000000000 in ?? ()
#0  0x00002b0fa88c2f12 in select () from /lib64/libc.so.6


=================================================================
Got a SIGABRT while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries 
used by your application.
=================================================================



Build complete -- 1 error, 0 warnings


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="071366.html">[Mono-bugs] [Bug 375273] Glyph Map - crashes FF is you move off the	page
</A></li>
	<LI>Next message: <A HREF="071298.html">[Mono-bugs] [Bug 375275] New: [Regression] HHH Comic - shows only	gray canvas
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71297">[ date ]</a>
              <a href="thread.html#71297">[ thread ]</a>
              <a href="subject.html#71297">[ subject ]</a>
              <a href="author.html#71297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
