<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 647267] Wrong Size of a Struct with Marshal Sizeof
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20647267%5D%20Wrong%20Size%20of%20a%20Struct%20with%20Marshal%20Sizeof&In-Reply-To=bug-647267-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="107141.html">
   <LINK REL="Next"  HREF="107143.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 647267] Wrong Size of a Struct with Marshal Sizeof</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20647267%5D%20Wrong%20Size%20of%20a%20Struct%20with%20Marshal%20Sizeof&In-Reply-To=bug-647267-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 647267] Wrong Size of a Struct with Marshal Sizeof">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sat Dec 11 02:11:38 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="107141.html">[Mono-bugs] [Bug 651317] Missing data rows
</A></li>
        <LI>Next message: <A HREF="107143.html">[Mono-bugs] [Bug 659000] New: Unhandled Exception: System.EntryPointNotFoundException: sqlite3_key
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107142">[ date ]</a>
              <a href="thread.html#107142">[ thread ]</a>
              <a href="subject.html#107142">[ subject ]</a>
              <a href="author.html#107142">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=647267">https://bugzilla.novell.com/show_bug.cgi?id=647267</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=647267#c2">https://bugzilla.novell.com/show_bug.cgi?id=647267#c2</A>


Geoff Norton &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gnorton at novell.com</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
             Status|RESOLVED                    |REOPENED
                 CC|                            |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gnorton at novell.com</A>,
                   |                            |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhutchinson at novell.com</A>
         Resolution|FIXED                       |
           Severity|Normal                      |Major

--- Comment #2 from Geoff Norton &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gnorton at novell.com</A>&gt; 2010-12-11 07:11:37 UTC ---
Rodrigo,

  This commit:

<A HREF="https://gist.github.com/d4409ffc545d91885605">https://gist.github.com/d4409ffc545d91885605</A>

Has cause monodevelop to regress anytime someone clicks a menu on OSX with the
following native stack:


Native stacktrace:

    0   mono                                0x000cc4e9
mono_handle_native_sigsegv + 376
    1   mono                                0x0000f156
mono_sigsegv_signal_handler + 322
    2   libSystem.B.dylib                   0x982e646b _sigtramp + 43
    3   ???                                 0xffffffff 0x0 + 4294967295
    4   CoreFoundation                      0x9026e42f
CFStringCompareWithOptionsAndLocale + 47
    5   CoreFoundation                      0x9026e3f5
CFStringCompareWithOptions + 53
    6   CoreFoundation                      0x9026e3b0 CFStringCompare + 64
    7   HIToolbox                           0x964ce538
_Z28_SetMenuItemTextWithCFStringP8MenuDatatPK10__CFString + 169
    8   HIToolbox                           0x9667b3e9 SetMenuItemData + 1864
    9   ???                                 0x1ad51f4e 0x0 + 450174798
    10  ???                                 0x1ad5189f 0x0 + 450173087
    11  ???                                 0x1ad514f2 0x0 + 450172146
    12  ???                                 0x1ad5094e 0x0 + 450169166
    13  ???                                 0x15f38199 0x0 + 368279961
    14  HIToolbox                           0x9647ff2f
_ZL23DispatchEventToHandlersP14EventTargetRecP14OpaqueEventRefP14HandlerCallRec
+ 1567
    15  HIToolbox                           0x9647f1f6
_ZL30SendEventToEventTargetInternalP14OpaqueEventRefP20OpaqueEventTargetRefP14HandlerCallRec
+ 411
    16  HIToolbox                           0x9647f055
SendEventToEventTargetWithOptions + 58
    17  HIToolbox                           0x964cb75b
_ZL15SendMenuOpeningP14MenuSelectDataP8MenuDatadmP14__CFDictionaryhPh + 537
    18  HIToolbox                           0x964cb171
_ZL11DrawTheMenuP14MenuSelectDataPP9__CFArrayhPh + 263
    19  HIToolbox                           0x964caf3b
_ZL11MenuChangedP14MenuSelectDatahh + 467
    20  HIToolbox                           0x964c9cb9
_ZL15TrackMenuCommonR14MenuSelectDataPh + 1481
    21  HIToolbox                           0x964c2259
_ZL14MenuSelectCoreP8MenuData5PointdmPP13OpaqueMenuRefPt + 315
    22  HIToolbox                           0x964c1a56 _HandleMenuSelection2 +
465
    23  HIToolbox                           0x964c1874 _HandleMenuSelection +
53
    24  AppKit                              0x947981a2 _NSHandleCarbonMenuEvent
+ 285
    25  AppKit                              0x9476cd3e _DPSNextEvent + 2304
    26  AppKit                              0x9476bfce -[NSApplication
nextEventMatchingMask:untilDate:inMode:dequeue:] + 156
    27  libgdk-quartz-2.0.0.dylib           0x02f1fb3d poll_func + 282
    28  libglib-2.0.0.dylib                 0x029370d7 g_main_context_poll +
280
    29  libglib-2.0.0.dylib                 0x029363e2 g_main_context_iterate +
1183
    30  libglib-2.0.0.dylib                 0x02936c62 g_main_loop_run + 992
    31  libgtk-quartz-2.0.0.dylib           0x02b29df9 gtk_main + 239
    32  ???                                 0x1ad0a1db 0x0 + 449880539
    33  ???                                 0x1ad0a1a3 0x0 + 449880483
    34  ???                                 0x1ad0a183 0x0 + 449880451
    35  ???                                 0x0070ed67 0x0 + 7400807
    36  ???                                 0x00700d6c 0x0 + 7343468
    37  ???                                 0x00700fb8 0x0 + 7344056
    38  mono                                0x0000ef11 mono_jit_runtime_invoke
+ 1332
    39  mono                                0x001dc07c mono_runtime_invoke +
137
    40  mono                                0x001de729 mono_runtime_exec_main +
585
    41  mono                                0x001ddab7 mono_runtime_run_main +
843
    42  mono                                0x0009ffbb mono_jit_exec + 200
    43  mono                                0x000a01f2 main_thread_handler +
555
    44  mono                                0x000a22b8 mono_main + 6979
    45  mono                                0x00002262 mono_main_with_options +
536
    46  mono                                0x000022c1 main + 49
    47  mono                                0x0000200d start + 53


Running in GDB we can render and we see HIToolbox is getting garbage from us:

<A HREF="http://sublimeintervention.com/images/hutch-corrupt.png">http://sublimeintervention.com/images/hutch-corrupt.png</A>

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="107141.html">[Mono-bugs] [Bug 651317] Missing data rows
</A></li>
	<LI>Next message: <A HREF="107143.html">[Mono-bugs] [Bug 659000] New: Unhandled Exception: System.EntryPointNotFoundException: sqlite3_key
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107142">[ date ]</a>
              <a href="thread.html#107142">[ thread ]</a>
              <a href="subject.html#107142">[ subject ]</a>
              <a href="author.html#107142">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
