<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 75239][Nor] Changed - Processes creating threads
	have long pauses.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075239%5D%5BNor%5D%20Changed%20-%20Processes%20creating%20threads%0A%09have%20long%20pauses.&In-Reply-To=bug-75239%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032910.html">
   <LINK REL="Next"  HREF="032912.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 75239][Nor] Changed - Processes creating threads
	have long pauses.</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075239%5D%5BNor%5D%20Changed%20-%20Processes%20creating%20threads%0A%09have%20long%20pauses.&In-Reply-To=bug-75239%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 75239][Nor] Changed - Processes creating threads
	have long pauses.">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Sun Aug 28 10:38:29 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="032910.html">[Mono-bugs] [Bug 75871][Nor] Changed - DateTimePicker not working
</A></li>
        <LI>Next message: <A HREF="032912.html">[Mono-bugs] [Bug 75239][Nor] Changed - Processes creating threads
	have long pauses.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32911">[ date ]</a>
              <a href="thread.html#32911">[ thread ]</a>
              <a href="subject.html#32911">[ subject ]</a>
              <a href="author.html#32911">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jan.oravec at 6com.sk.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=75239">http://bugzilla.ximian.com/show_bug.cgi?id=75239</A>

--- shadow/75239	2005-07-05 16:28:48.000000000 -0400
+++ shadow/75239.tmp.20406	2005-08-28 10:38:29.000000000 -0400
@@ -10,12 +10,13 @@
 Component: io-layer
 AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at ximian.com</A>                            
 ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">vguzev at yandex.ru</A>               
 QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
 TargetMilestone: ---
 URL: 
+Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jan.oravec at 6com.sk</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,matt.hargett at logiclibrary.com</A>
 Summary: Processes creating threads have long pauses.
 
 Description of Problem:
 DNS.GetHostName() sometimes hangs on in my programs! When I tried to find 
 a small example why does it happen I found another one error that's 
 connected with DNS.GetHostName and multithreading as I think...
@@ -1634,6 +1635,45 @@
 ------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">bmaurer at users.sf.net</A>  2005-07-05 16:28 -------
 The segfaults and hangs are now fixed in svn. The only remaining
 problem is that the test case frequently pauses. From what I can tell,
 this seems to be an issue in the io-layer. This is no longer major
 though because the process is always able to go forward within a few
 seconds.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jan.oravec at 6com.sk</A>  2005-08-28 10:38 -------
+Frequent pausing is caused by destroying of the threads.
+The following code runs almost forever until WriteLine is reached:
+
+public class M
+{  
+  public static void Main()
+  {
+    Thread[] x=new Thread[1000];
+    ThreadStart ts = new ThreadStart(thr);
+ 
+    for(int i=0; i&lt;1000; ++i)
+      (x[i]=new Thread(ts)).Start();
+    
+    for(int i=0; i&lt;1000; ++i)
+      x[i].Join();
+
+    Console.WriteLine(&quot;Finished&quot;);
+  }
+   
+  private static void thr()
+  {
+//    Thread.Sleep(Timeout.Infinite);
+  }
+}
+ 
+If you uncomment the Sleep line, everything is fast.
+
+
+I have tried to find out more about that. strace shows a thousands of
+semop() system calls per thread when it is finishing:
+
+[pid 21931] semop(0, 0xb78f73ea, 1 &lt;unfinished ...&gt;
+[pid 21931] &lt;... semop resumed&gt; )       = 0
+
+I think that this is major fault, because with ~100 short-term threads
+running system starts to be very inresponsive.
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032910.html">[Mono-bugs] [Bug 75871][Nor] Changed - DateTimePicker not working
</A></li>
	<LI>Next message: <A HREF="032912.html">[Mono-bugs] [Bug 75239][Nor] Changed - Processes creating threads
	have long pauses.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32911">[ date ]</a>
              <a href="thread.html#32911">[ thread ]</a>
              <a href="subject.html#32911">[ subject ]</a>
              <a href="author.html#32911">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
