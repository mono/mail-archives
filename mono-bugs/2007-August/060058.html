<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 82440][Maj] New - [Regression] IOException in	Directory.GetFileSystemEntries
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2082440%5D%5BMaj%5D%20New%20-%20%5BRegression%5D%20IOException%20in%0A%09Directory.GetFileSystemEntries&In-Reply-To=bug-82440%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="060057.html">
   <LINK REL="Next"  HREF="060059.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 82440][Maj] New - [Regression] IOException in	Directory.GetFileSystemEntries</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2082440%5D%5BMaj%5D%20New%20-%20%5BRegression%5D%20IOException%20in%0A%09Directory.GetFileSystemEntries&In-Reply-To=bug-82440%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 82440][Maj] New - [Regression] IOException in	Directory.GetFileSystemEntries">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Tue Aug 14 10:33:36 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="060057.html">[Mono-bugs] [Bug 82438][Wis] Changed - Mono for Windows 1.2.4	failing to start on wine 0.9.42
</A></li>
        <LI>Next message: <A HREF="060059.html">[Mono-bugs] [Bug 82438][Wis] Changed - Mono for Windows 1.2.4	failing to start on wine 0.9.42
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60058">[ date ]</a>
              <a href="thread.html#60058">[ thread ]</a>
              <a href="subject.html#60058">[ subject ]</a>
              <a href="author.html#60058">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">juraj at hotfeet.ch.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=82440">http://bugzilla.ximian.com/show_bug.cgi?id=82440</A>

--- shadow/82440	2007-08-14 10:33:36.000000000 -0400
+++ shadow/82440.tmp.9716	2007-08-14 10:33:36.000000000 -0400
@@ -0,0 +1,57 @@
+Bug#: 82440
+Product: Mono: Runtime
+Version: 1.2
+OS: 
+OS Details: FC6
+Status: NEW   
+Resolution: 
+Severity: 
+Priority: Major
+Component: io-layer
+AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at ximian.com</A>                            
+ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">juraj at hotfeet.ch</A>               
+QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
+TargetMilestone: ---
+URL: 
+Cc: 
+Summary: [Regression] IOException in Directory.GetFileSystemEntries
+
+Commit 83191 seems to have caused a regression. Since the beginning of
+August, I'm often getting the following exception:
+
+System.IO.IOException: Win32 IO returned ERROR_GEN_FAILURE. Path:
+/var/www/html/devel.hotfeet.ch/frauchiger/UserData
+  at System.IO.Directory.GetFileSystemEntries (System.String path,
+System.String pattern, FileAttributes mask, FileAttributes attrs) [0x00000] 
+  at System.IO.Directory.GetFiles (System.String path, System.String
+pattern) [0x00000]
+
+...and mod_mono writes this to Apache's errorlog:
+** Message: Unknown errno: Success
+
+My code called Directory.GetFiles(
+&quot;/var/www/html/devel.hotfeet.ch/frauchiger/UserData&quot;, &quot;offer_00000_*.*&quot;),
+where the searched directory contains following files:
+
+[<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">js at leonardo</A> UserData]$ ls -l
+total 48
+drwxrwxrwx 2 paris  hotfeet 4096 Aug  8 11:41 generated
+-rw------- 1 apache apache  8265 Aug  2 13:23 offer_00000_01_250x229.jpg
+-rw------- 1 apache apache  5159 Aug  2 13:50 offer_00001_00_250x199.jpg
+-rw------- 1 apache apache  8422 Aug  2 14:03 offer_00002_00_244x250.jpg
+-rw------- 1 apache apache  8837 Aug  2 14:05 offer_00003_00_250x249.jpg
+
+I'm using Mono from SVN. (And I'm cleaning /tmp/.wapi on httpd restart.)
+
+After reverting commit 83191 (see below), everything seem to work fine again.
+
+2007-08-01  Dick Porter  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at ximian.com</A>&gt;
+
+	* io-portability.c (_wapi_io_scandir): Special-case patterns
+	ending in '.*' so that files with no extension are also matched.
+	Fixes bug 82212.
+
+	* wapi_glob.h: 
+	* wapi_glob.c: Reinstate WAPI_GLOB_APPEND, and add
+	WAPI_GLOB_UNIQUE to avoid matching the same entry twice when
+	appending.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="060057.html">[Mono-bugs] [Bug 82438][Wis] Changed - Mono for Windows 1.2.4	failing to start on wine 0.9.42
</A></li>
	<LI>Next message: <A HREF="060059.html">[Mono-bugs] [Bug 82438][Wis] Changed - Mono for Windows 1.2.4	failing to start on wine 0.9.42
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60058">[ date ]</a>
              <a href="thread.html#60058">[ thread ]</a>
              <a href="subject.html#60058">[ subject ]</a>
              <a href="author.html#60058">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
