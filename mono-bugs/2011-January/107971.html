<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 421491] &quot;Could not allocate new OCI Handle of type Statement&quot; message when accessing Oracle
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20421491%5D%20%22Could%20not%20allocate%20new%20OCI%20Handle%20of%20type%0A%20Statement%22%20message%20when%20accessing%20Oracle&In-Reply-To=bug-421491-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="107980.html">
   <LINK REL="Next"  HREF="107972.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 421491] &quot;Could not allocate new OCI Handle of type Statement&quot; message when accessing Oracle</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20421491%5D%20%22Could%20not%20allocate%20new%20OCI%20Handle%20of%20type%0A%20Statement%22%20message%20when%20accessing%20Oracle&In-Reply-To=bug-421491-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 421491] &quot;Could not allocate new OCI Handle of type Statement&quot; message when accessing Oracle">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Jan 13 13:59:14 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="107980.html">[Mono-bugs] [Bug 664349] Changing Project.GlobalProperties	duplicates items
</A></li>
        <LI>Next message: <A HREF="107972.html">[Mono-bugs] [Bug 643958] Resource directory in the project solution should be lowercase
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107971">[ date ]</a>
              <a href="thread.html#107971">[ thread ]</a>
              <a href="subject.html#107971">[ subject ]</a>
              <a href="author.html#107971">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=421491">https://bugzilla.novell.com/show_bug.cgi?id=421491</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=421491#c4">https://bugzilla.novell.com/show_bug.cgi?id=421491#c4</A>


Jonathan Vargas &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jvargas at alkaid.cr</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
             Status|NEEDINFO                    |NEW
                 CC|                            |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jvargas at alkaid.cr</A>
       InfoProvider|<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jp.gouigoux at free.fr</A>         |

--- Comment #4 from Jonathan Vargas &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jvargas at alkaid.cr</A>&gt; 2011-01-13 18:59:12 UTC ---
Hi, we also have this problem and I will explain why a test case is difficult
to submit and study is necessary.

Our environment:
--
We have an asp.net app running on mono 2.67 on redhat enterprise 5 and apache
2.2.3 on a 64 bit host.

We have tried to connects to Oracle Database through Oracle Instant Client and
the Oracle's 11g Client, for 64 bits, both to an Oracle XE and a Oracle
Database Standar, on separate hosts.


The problem:
--
The apps works fine, but very often in some queries we get the error described
at this line of code in OracleClient's code: 

<A HREF="https://github.com/mono/mono/blob/master/mcs/class/System.Data.OracleClient/System.Data.OracleClient.Oci/OciHandle.cs#L88">https://github.com/mono/mono/blob/master/mcs/class/System.Data.OracleClient/System.Data.OracleClient.Oci/OciHandle.cs#L88</A>

&quot;Could not allocate new OCI Handle of type {0}&quot;

The error is triggered sometimes with a handler of type &quot;OciSentenceHandle&quot;, or
&quot;OciTransactionHandle&quot;, and in the worst case, mod-mono-server just crashes and
we get the following error in apache's log:


Stacktrace:

Native stacktrace:

[Thu Jan 13 11:47:15 2011] [error] (70014)End of file found: read_data failed
[Thu Jan 13 11:47:15 2011] [error] Command stream corrupted, last command was 1


No solution
--
We haven't found any trick or idea of what's going on, as we are not experts in
OCI's code and operation. After we receive this exception, the previously
stablished connection seems to be dirty or something, because we try to
retrieve schema information for a table and it returns invalid info.


Expectation
--
Determine what are the cases when this call returns unexpected values: 

OCIHandleAlloc (this,
  out newHandle,
  type,
  0,
  IntPtr.Zero
);

And then search for a solution. Also, it the problem is definitively at
oracle's side, or if it should be managed by mono's OracleClient
implementation.

If you need more information please ask us for it. Thanks in advance.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="107980.html">[Mono-bugs] [Bug 664349] Changing Project.GlobalProperties	duplicates items
</A></li>
	<LI>Next message: <A HREF="107972.html">[Mono-bugs] [Bug 643958] Resource directory in the project solution should be lowercase
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107971">[ date ]</a>
              <a href="thread.html#107971">[ thread ]</a>
              <a href="subject.html#107971">[ subject ]</a>
              <a href="author.html#107971">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
