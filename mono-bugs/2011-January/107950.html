<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 664152] New: SoapReflectionImporter encodes xmlName but EnumMap does not in GetEnumName
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20664152%5D%20New%3A%20SoapReflectionImporter%20encodes%0A%20xmlName%20but%20EnumMap%20does%20not%20in%20GetEnumName&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="107983.html">
   <LINK REL="Next"  HREF="107969.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 664152] New: SoapReflectionImporter encodes xmlName but EnumMap does not in GetEnumName</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20664152%5D%20New%3A%20SoapReflectionImporter%20encodes%0A%20xmlName%20but%20EnumMap%20does%20not%20in%20GetEnumName&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 664152] New: SoapReflectionImporter encodes xmlName but EnumMap does not in GetEnumName">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Jan 12 20:32:25 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="107983.html">[Mono-bugs] [Bug 664093] Regression in git master causes ASP.NET MVC 2 App fail to load
</A></li>
        <LI>Next message: <A HREF="107969.html">[Mono-bugs] [Bug 664152] SoapReflectionImporter encodes xmlName but EnumMap does not in GetEnumName
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107950">[ date ]</a>
              <a href="thread.html#107950">[ thread ]</a>
              <a href="subject.html#107950">[ subject ]</a>
              <a href="author.html#107950">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=664152">https://bugzilla.novell.com/show_bug.cgi?id=664152</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=664152#c0">https://bugzilla.novell.com/show_bug.cgi?id=664152#c0</A>


           Summary: SoapReflectionImporter encodes xmlName but EnumMap
                    does not in GetEnumName
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.8.x
          Platform: PC
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">ben at skullsquad.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=408117)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=408117">http://bugzilla.novell.com/attachment.cgi?id=408117</A>)
a MonoDevelop solution.  feel free to just work with main.

User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US) AppleWebKit/534.10
(KHTML, like Gecko) Ubuntu/10.10 Chromium/8.0.552.224 Chrome/8.0.552.224
Safari/534.10

If a SOAP type uses the SoapEnumAttribute to describe a enum field value that
is not a valid language identifier, it fails to create the map correctly.  In
my test case, I have an enum as follows:

public enum EnumTest
{
   [System.Xml.Serialization.SoapEnumAttribute(&quot;0&quot;)]
   Item0,
}

The default System.Xml.dll with mono 2.8.1 imports this value as '_x0030_', as
a result of the call to XmlConvert.EncodeLocalName on line ~380 in
SoapReflectionImporter.cs.

When subsequent deserialization calls occur (simplified via reflection for the
test case), '0' is passed in as the xmlName, and never encoded to match the map
value provided in the EnumMap constructor.

If you remove the call to XmlConvert.EncodeLocalName on line ~380 in
SoapReflectionImporter.cs, the test (and my SOAP client) both pass correctly.

Reproducible: Always

Steps to Reproduce:
1. Run the attached test case.
Actual Results:  
The call fails to correlate the inputted value to the mapped value.  In real
life, this causes the xml deserialization to fail when attempting to parse a
SOAP response.

Expected Results:  
For the GetEnumName function to correctly correlate the inputted xmlName to the
value stored in the map.  This behavior is seen when removing the
EncodeLocalName call.

Sensitive timing on the project this is associated to.  For now I'll just
distribute my hacked System.Xml.dll, but a blessed fix from Novell will be
greatly appreciated!

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="107983.html">[Mono-bugs] [Bug 664093] Regression in git master causes ASP.NET MVC 2 App fail to load
</A></li>
	<LI>Next message: <A HREF="107969.html">[Mono-bugs] [Bug 664152] SoapReflectionImporter encodes xmlName but EnumMap does not in GetEnumName
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107950">[ date ]</a>
              <a href="thread.html#107950">[ thread ]</a>
              <a href="subject.html#107950">[ subject ]</a>
              <a href="author.html#107950">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
