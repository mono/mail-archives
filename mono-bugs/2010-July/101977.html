<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 620411] New: RewritePath crashes with an unidentified null reference exeption in PostAcquireRequestState
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20620411%5D%20New%3A%20RewritePath%20crashes%20with%20an%0A%20unidentified%20null%20reference%20exeption%20in%20PostAcquireRequestState&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="101996.html">
   <LINK REL="Next"  HREF="101978.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 620411] New: RewritePath crashes with an unidentified null reference exeption in PostAcquireRequestState</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20620411%5D%20New%3A%20RewritePath%20crashes%20with%20an%0A%20unidentified%20null%20reference%20exeption%20in%20PostAcquireRequestState&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 620411] New: RewritePath crashes with an unidentified null reference exeption in PostAcquireRequestState">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Jul  7 06:17:05 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="101996.html">[Mono-bugs] [Bug 620404] PFX doesn't work correctly
</A></li>
        <LI>Next message: <A HREF="101978.html">[Mono-bugs] [Bug 620411] RewritePath crashes with an unidentified null reference exeption in PostAcquireRequestState
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#101977">[ date ]</a>
              <a href="thread.html#101977">[ thread ]</a>
              <a href="subject.html#101977">[ subject ]</a>
              <a href="author.html#101977">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=620411">http://bugzilla.novell.com/show_bug.cgi?id=620411</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=620411#c0">http://bugzilla.novell.com/show_bug.cgi?id=620411#c0</A>


           Summary: RewritePath crashes with an unidentified null
                    reference exeption in PostAcquireRequestState
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.6.x
          Platform: x86-64
        OS/Version: SLES 11
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">s.winkler at studdex.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.6)
Gecko/20100625 Firefox/3.6.6

As stated in the summary, as of recent, we have the problem that
HttpApplication.Context.RewritePath crashes on our Linux server running our web
application via mod-mono. Something turns to null while the EventHandler
System.Web.Handlers.ScriptModule.PostAcquireRequestState is executed.

The circumstances are very strange: 
First off, the error only occurs if the virtual path in the mod-mono
configuration says &quot;/&quot;, i.e. points to the root directory. If we set it to
something else, like &quot;/testblabla/&quot; or whatever, it works. No one knows why,
though.

Second, it used to work fine before, until we made one little change: We added
only one simple line ( &lt;%@ Import Namespace=&quot;System.IO&quot; %&gt; ) to an aspx page
that didn't work before, because this part was missing (a few days before that
we converted our solution from a .NET Web Site to a Web Application and we
missed that page before). After that change has been commited to svn and pushed
to the server (we're updating our server via svn) the error started to occur.
We removed that line again, but it didn't help, the error always occured since
then, something must have been corrupted, but there is no evidence whatsoever
what might be causing this strange behaviour. Only a rollback to the old svn
version (the one that was commited before that change mentioned above was made)
helped for the moment, but now we can't update our website without killing the
URL-rewriting. 

We're developing on a Windows machine with Visual Studio and everything works
fine locally. That's why I assume that whatever happened to our web application
at that specific point is a problem that's only affecting mono and is therefore
a bug worthy of being posted here. We hope that someone will look into the
RewritePath implementation and find out under which circumstances an error like
this could occur and why it doesn't happen on IIS / VisualStudio Development
Server.

By the way, the target url is definitely not the problem, when replacing
RewritePath with Response.Redirect it goes to the correct location.

Here is the error with the stack trace:

System.NullReferenceException: Object reference not set to an instance of an
object
  at System.Web.Handlers.ScriptModule.PostAcquireRequestState (System.Object
sender, System.EventArgs e) [0x00000] in &lt;filename unknown&gt;:0 
  at System.Web.HttpApplication+&lt;RunHooks&gt;c__Iterator1.MoveNext () [0x00000] in
&lt;filename unknown&gt;:0 
  at System.Web.HttpApplication+&lt;Pipeline&gt;c__Iterator2.MoveNext () [0x00000] in
&lt;filename unknown&gt;:0 
  at System.Web.HttpApplication.Tick () [0x00000] in &lt;filename unknown&gt;:0 

Reproducible: Always

Steps to Reproduce:
1. Create .NET Web Application that uses RewritePath in global.asax if the url
contains a certain keyword. Then create a svn-repository for it.
2. Take a linux web server running apache and mod-mono, and make a svn-checkout
pointing to that repository in a folder on that server. Then set up a vhost for
that directory.
3. Create an aspx page without a codebehind file (using a &lt;script
runat=&quot;server&quot;&gt;-block instead) that tries to read a file and put it on the
server. The page will crash because it doesn't know System.IO
4. Add the import command for System.IO to that page, commit it to svn and make
an svn up on the server.
5. Check if the URL with the rewriting-keyword works - if doesn't crash with
the error mentioned above, the error can't be replicated because the source of
the problem is so specific, that it only affects our web application (which
contains hundreds of files and thousands of lines of code, so we can't really
provide an example here).
Actual Results:  
If performing the steps above really leads to the same error that bugs us, you
will see the error message provided under &quot;Details&quot;. 
(If not, I'm afraid the error isn't really reproduceable and has to be solved
by searching the code for omissions like forgotten &quot;if (something ==
null)&quot;-checks etc.)

Expected Results:  
Correct URL-rewriting.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="101996.html">[Mono-bugs] [Bug 620404] PFX doesn't work correctly
</A></li>
	<LI>Next message: <A HREF="101978.html">[Mono-bugs] [Bug 620411] RewritePath crashes with an unidentified null reference exeption in PostAcquireRequestState
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#101977">[ date ]</a>
              <a href="thread.html#101977">[ thread ]</a>
              <a href="subject.html#101977">[ subject ]</a>
              <a href="author.html#101977">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
