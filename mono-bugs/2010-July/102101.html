<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 440191] Multiline TextBox has wrong height
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20440191%5D%20Multiline%20TextBox%20has%20wrong%20height&In-Reply-To=bug-440191-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="102100.html">
   <LINK REL="Next"  HREF="102102.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 440191] Multiline TextBox has wrong height</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20440191%5D%20Multiline%20TextBox%20has%20wrong%20height&In-Reply-To=bug-440191-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 440191] Multiline TextBox has wrong height">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Jul 12 15:15:50 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="102100.html">[Mono-bugs] [Bug 569392] Mono 2.6.x fails on Windows due to reference to 'freeaddrinfo' in WS2_32.DLL
</A></li>
        <LI>Next message: <A HREF="102102.html">[Mono-bugs] [Bug 440191] Multiline TextBox has wrong height
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#102101">[ date ]</a>
              <a href="thread.html#102101">[ thread ]</a>
              <a href="subject.html#102101">[ subject ]</a>
              <a href="author.html#102101">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=440191">http://bugzilla.novell.com/show_bug.cgi?id=440191</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=440191#c5">http://bugzilla.novell.com/show_bug.cgi?id=440191#c5</A>


Kenneth Skovhede &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kenneth at hexad.dk</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
                 CC|                            |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kenneth at hexad.dk</A>
           Severity|Normal                      |Major

--- Comment #5 from Kenneth Skovhede &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kenneth at hexad.dk</A>&gt; 2010-07-12 19:15:48 UTC ---
When setting the size of a single line textbox, the size is saved internally,
including the height. This occurs regardless of the Multiline property value.
If Multiline is false, the control will report the visible size of the control
instead of the internal size. When setting the Multiline property to true, the
control reports the internal size.

The following example explains this:

TextBox t = new TextBox(); //Default, Multiline = false
Console.WriteLine(t.Height); //Returns 20 under windows, similar under Mono
t.Height = 200;
Console.WriteLine(t.Height); //Returns 20 under windows, similar under Mono
t.Multiline = true;
Console.WriteLine(t.Height); //Returns 200 under window, returns the old small
value under Mono!
t.Multiline = false;
Console.WriteLine(t.Height); //Returns 20 under windows, similar under Mono

When the resource manager sets the size first and then the Multiline property,
the control is not correctly updated, due to the above.

Since the resource manager uses a Hashtable with property keys, the order in
which the properties are applied is not the same as expected, which means that
the bug is triggered. I think this could lead to other subtle errors, although
it should not.

Unfortunately there is no easy way to retrieve the localized property values
directly, but it is possible to re-apply the values from the resource manager:
new
System.ComponentModel.ComponentResourceManager(typeof(...formname...)).ApplyResources(t,
t.Name);

This fixes the problem because the Multiline is now true, so the resource
manager can set the size without problems.

It is not possible to set the Multiline property before the resource manager
runs, because the resource manager is activated within the Initialize() code
generated by the Windows.Forms designer, and any changes would be lost on form
edit.

It is fairly difficult to read out the correct size from the resource manager
after initialization, which leads me to belive that the above is the best
solution.

I will add a simple workaround that traverses all controls in the form and
re-applies the resource manager, which can be activated after the Initialize()
call has completed.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="102100.html">[Mono-bugs] [Bug 569392] Mono 2.6.x fails on Windows due to reference to 'freeaddrinfo' in WS2_32.DLL
</A></li>
	<LI>Next message: <A HREF="102102.html">[Mono-bugs] [Bug 440191] Multiline TextBox has wrong height
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#102101">[ date ]</a>
              <a href="thread.html#102101">[ thread ]</a>
              <a href="subject.html#102101">[ subject ]</a>
              <a href="author.html#102101">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
