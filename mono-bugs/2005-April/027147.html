<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 74562][Wis] Changed - [IO-LAYER-NO-DAEMON] io-layer-no-daemon locks mcs on osx
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="027146.html">
   <LINK REL="Next"  HREF="027148.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 74562][Wis] Changed - [IO-LAYER-NO-DAEMON] io-layer-no-daemon locks mcs on osx
   </H1>
    <B>bugzilla-daemon@bugzilla.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com"
       TITLE="[Mono-bugs] [Bug 74562][Wis] Changed - [IO-LAYER-NO-DAEMON] io-layer-no-daemon locks mcs on osx">bugzilla-daemon@bugzilla.ximian.com
       </A><BR>
    <I>Sat,  9 Apr 2005 23:46:48 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="027146.html">[Mono-bugs] [Bug 74529][Nor] Changed - mcs fails to detect unassigned variable
</A></li>
        <LI> Next message: <A HREF="027148.html">[Mono-bugs] [Bug 74562][Wis] Changed - [IO-LAYER-NO-DAEMON] io-layer-no-daemon locks mcs on osx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27147">[ date ]</a>
              <a href="thread.html#27147">[ thread ]</a>
              <a href="subject.html#27147">[ subject ]</a>
              <a href="author.html#27147">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:grompf@sublimeintervention.com.">grompf@sublimeintervention.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=74562">http://bugzilla.ximian.com/show_bug.cgi?id=74562</A>

--- shadow/74562	2005-04-09 19:14:43.000000000 -0400
+++ shadow/74562.tmp.26836	2005-04-09 23:46:48.000000000 -0400
@@ -36,6 +36,144 @@
 access_mode=0, share=1, async=0 '\0', error=0xbffff4e0) at file-io.c:519
 
 -kangaroo
 
 ------- Additional Comments From <A HREF="mailto:dick@ximian.com">dick@ximian.com</A>  2005-04-09 19:14 -------
 Works fine on my mac (10.3.8)
+
+------- Additional Comments From <A HREF="mailto:grompf@sublimeintervention.com">grompf@sublimeintervention.com</A>  2005-04-09 23:46 -------
+Dick,
+
+  Following up on our discussion today I have tried this on 2 OSX machines now (10.3.8 
+gcc build 1671); both exhibit the same symptoms.
+
+The g5 was a fresh install of the 1.1.6 framework, fresh checkout of mono and mcs, svn 
+swtich svn+<A HREF="ssh://username@mono-cvs.ximian.com/source/branches/dick/io-layer-no-">ssh://username@mono-cvs.ximian.com/source/branches/dick/io-layer-no-</A>
+daemon the io-layer directory;
+
+./autogen.sh
+make
+
+it locks up on the first step of the make using the new runtime (building System.xml.dll)
+
+the full backtrace on the g5 is:
+
+(gdb) t a a bt
+
+Thread 3 (process 7954 thread 0x1303):
+#0  0x90016f48 in semaphore_wait_signal_trap ()
+#1  0x9000e790 in _pthread_cond_wait ()
+#2  0x000cb50c in _wapi_get_win32_file_error (err=5379) at error.c:141
+#3  0x000bec30 in convert_family (mono_family=5379) at socket-io.c:137
+#4  0x000b0bfc in intersect_ranges (ranges=0x1503, other_ranges=0x1603, delta=40, 
+rela
+tion=48) at abcremoval.c:724
+#5  0x00065a88 in abort_appdomain_thread (key=0x1503, value=0x1d15c, 
+user_data=0xfffff
+fff) at threads.c:1888
+#6  0x000d5088 in __bsd_dtoa (d=-6.3055886190221176e+231, mode=1289780, 
+ndigits=0, dec
+pt=0x0, sign=0x0, rve=0x0, resultp=0xffffffff) at strtod.c:2080
+#7  0x900246e8 in _pthread_body ()
+
+Thread 2 (process 7954 thread 0x113):
+#0  0x90012588 in clock_sleep_trap ()
+#1  0x9000d758 in nanosleep ()
+#2  0x000cbfbc in GC_build_fl_clear2 (h=0x0, ofl=0x1 &lt;Address 0x1 out of bounds&gt;) at 
+n
+ew_hblk.c:67
+#3  0x000e5f84 in cleanup () at daemon.c:100
+#4  0x900246e8 in _pthread_body ()
+
+Thread 1 (process 7954 thread 0x60f):
+#0  0x90012588 in clock_sleep_trap ()
+#1  0x9000d758 in nanosleep ()
+#2  0x000cb780 in GetTickCount () at timefuncs.c:54
+#3  0x000d22ec in _wapi_handle_fd_offset_store (fd=14, handle=0x42588fb8) at ../../
+mon
+o/io-layer/handles-private.h:260
+#4  0x000d2398 in _wapi_handle_fd_offset_store (fd=14, handle=0x42588fb8) at ../../
+mon
+o/io-layer/handles-private.h:216
+#5  0x000d254c in _wapi_handle_get_private_segment (segment=0) at ../../mono/io-
+layer/
+handles-private.h:126
+#6  0x000e1610 in _wapi_accept (fd=1113100216, addr=0x13ae38, addrlen=0x5f5e100) 
+at so
+ckets.c:291
+#7  0x0103da48 in ?? ()
+#8  0x0103cf90 in ?? ()
+#9  0x0103cc04 in ?? ()
+#10 0x0103cb44 in ?? ()
+#11 0x0103ca70 in ?? ()
+#12 0x0103badc in ?? ()
+#13 0x0103b76c in ?? ()
+#14 0x0103b334 in ?? ()
+#15 0x0103aedc in ?? ()
+#16 0x005241dc in ?? ()
+#17 0x00522288 in ?? ()
+#18 0x0052148c in ?? ()
+#19 0x000629b8 in mono_message_invoke (target=0x42588fb8, msg=0x5f5e100, 
+exc=0x542440,
+ out_args=0x13ae38) at object.c:3272
+#20 0x00062608 in mono_raise_exception (ex=0x42588fb8) at object.c:3120
+#21 0x00003d68 in mono_main (argc=0, argv=0x5f5e100) at driver.c:973
+#22 0x00002100 in _dyld_init_check ()
+#23 0x8fe1a558 in __dyld__dyld_start ()
+
+the full backtrace on the g4 is:
+
+Thread 3 (process 22661 thread 0x1303):
+#0  0x90016f48 in semaphore_wait_signal_trap ()
+#1  0x9000e790 in _pthread_cond_wait ()
+#2  0x000c8a40 in _wapi_handle_scratch_store_internal (bytes=259, remap=0xffffffff) at 
+handles.c:909
+#3  0x000bc758 in SHA1Transform (state=0x0, buffer=0x1603 &quot;y/Frameworks/
+Mono.framework/Versions/1.1.5/lib/libglib-2.0.0.dylib&quot;) at mono-sha1.c:159
+#4  0x000ae9bc in ves_icall_System_GC_WaitForPendingFinalizers () at gc.c:288
+#5  0x000644ec in mono_store_remote_field_new (this=0x1818e00, klass=0x1, 
+field=0x0, arg=0x13c56c) at object.c:3698
+#6  0x000d22ec in FileTimeToSystemTime (file_time=0xa000448c, system_time=0x0) at 
+io.c:2702
+#7  0x900246e8 in _pthread_body ()
+
+Thread 2 (process 22661 thread 0x113):
+#0  0x90012588 in clock_sleep_trap ()
+#1  0x9000d758 in nanosleep ()
+#2  0x000c94bc in _wapi_handle_ops_signal (handle=0x1405008) at handles.c:1283
+#3  0x000e2ff4 in _wapi_getsockopt (fd=1113100331, level=1277496, 
+optname=1113100331, optval=0x0, optlen=0x5f5e100) at sockets.c:497
+#4  0x900246e8 in _pthread_body ()
+
+Thread 1 (process 22661 thread 0x60f):
+#0  0x90012588 in clock_sleep_trap ()
+#1  0x9000d758 in nanosleep ()
+#2  0x000c8cb4 in _wapi_handle_scratch_store_string_array (data=0x0) at handles.c:1003
+#3  0x000cf620 in file_write (handle=0x4258902b, buffer=0x137e38, numbytes=0, 
+byteswritten=0x5f5e100, overlapped=0xbfffe8e0) at io.c:351
+#4  0x000cf6cc in file_write (handle=0xbfffeab4, buffer=0x137e38, numbytes=0, 
+byteswritten=0x5f5e100, overlapped=0xbfffe8e0) at io.c:394
+#5  0x000cf880 in file_seek (handle=0x1370570, movedistance=-1073747248, 
+highmovedistance=0x0, method=16) at io.c:492
+#6  0x000de6d4 in ves_icall_System_Globalization_CultureInfo_construct_datetime_format 
+(this=0xe) at locales.c:141
+#7  0x012c2a38 in ?? ()
+#8  0x012c1f88 in ?? ()
+#9  0x012c1bfc in ?? ()
+#10 0x012c1b3c in ?? ()
+#11 0x012c1a68 in ?? ()
+#12 0x012c0ae4 in ?? ()
+#13 0x012c0774 in ?? ()
+#14 0x012c033c in ?? ()
+#15 0x012bfee4 in ?? ()
+#16 0x007fa1a4 in ?? ()
+#17 0x007f8260 in ?? ()
+#18 0x007f746c in ?? ()
+#19 0x0006155c in mono_runtime_run_main (method=0xffffffff, argc=100000000, 
+argv=0xbfffead0, exc=0x0) at object.c:1733
+#20 0x000611e0 in mono_get_delegate_invoke (klass=0xe) at object.c:1581
+#21 0x00003e74 in mono_main (argc=0, argv=0x5f5e100) at driver.c:745
+#22 0x000021d8 in ?? ()
+#23 0x8fe1a558 in __dyld__dyld_start ()
+
+-kangaroo
+

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="027146.html">[Mono-bugs] [Bug 74529][Nor] Changed - mcs fails to detect unassigned variable
</A></li>
	<LI> Next message: <A HREF="027148.html">[Mono-bugs] [Bug 74562][Wis] Changed - [IO-LAYER-NO-DAEMON] io-layer-no-daemon locks mcs on osx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27147">[ date ]</a>
              <a href="thread.html#27147">[ thread ]</a>
              <a href="subject.html#27147">[ subject ]</a>
              <a href="author.html#27147">[ author ]</a>
         </LI>
       </UL>
</body></html>
