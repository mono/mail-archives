<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 634839] New: MKBundle fails(ungraceful) when zlib.h is not present.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20634839%5D%20New%3A%20MKBundle%20fails%28ungraceful%29%20when%0A%20zlib.h%20is%20not%20present.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="103279.html">
   <LINK REL="Next"  HREF="103281.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 634839] New: MKBundle fails(ungraceful) when zlib.h is not present.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20634839%5D%20New%3A%20MKBundle%20fails%28ungraceful%29%20when%0A%20zlib.h%20is%20not%20present.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 634839] New: MKBundle fails(ungraceful) when zlib.h is not present.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Aug 26 14:29:08 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="103279.html">[Mono-bugs] [Bug 599488] Why SocketException with ErrorCode == 10035 means Operation timed out? It breaks .NET compatibility
</A></li>
        <LI>Next message: <A HREF="103281.html">[Mono-bugs] [Bug 634839] MKBundle fails(ungraceful) when zlib.h is	not present.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103280">[ date ]</a>
              <a href="thread.html#103280">[ thread ]</a>
              <a href="subject.html#103280">[ subject ]</a>
              <a href="author.html#103280">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=634839">https://bugzilla.novell.com/show_bug.cgi?id=634839</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=634839#c0">https://bugzilla.novell.com/show_bug.cgi?id=634839#c0</A>


           Summary: MKBundle fails(ungraceful) when zlib.h is not present.
    Classification: Mono
           Product: Mono: Compilers
           Version: 2.4.x
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Minor
          Priority: P5 - None
         Component: Other.
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">pichlmann at fredlarts.at</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.0; de; rv:1.9.2.8)
Gecko/20100722 Firefox/3.6.8 ( .NET CLR 3.5.30729; .NET4.0E)

MKBundle needs zlib.h (probably more?) to compress(parameter -z) the binary.
zlib.h is referenced but never checked if it actually exists. The compiling
then fails.

Suggestion: include a check and fail with message if it doesn't exist. Or amend
the info text of the parameter to explain that zlib.h needs to be present and
is not delivered with Mono.
(Perhaps it is, and I'm missing a package. I can't tell.)

Reproducible: Always

Steps to Reproduce:
1. Create assembly
2. bundle it: mkbundle -z ASSEMBLY.exe
3.
Actual Results:  
OS is: Linux
Sources: 1 Auto-dependencies: False
   embedding: assembly.exe
   compression ratio: 40.29%
Compiling:
as -o temp.o temp.s
cc -ggdb -o a.out -Wall temp.c `pkg-config --cflags --libs mono` -lz temp.o
temp.c:28:18: error: zlib.h: No such file or directory
temp.c:31: warning: type defaults to 'int' in declaration of 'Byte'
temp.c:31: error: expected ';', ',' or ')' before '*' token
temp.c: In function 'mono_mkbundle_init':
temp.c:68: error: 'Bytef' undeclared (first use in this function)
temp.c:68: error: (Each undeclared identifier is reported only once
temp.c:68: error: for each function it appears in.)
temp.c:68: error: 'buffer' undeclared (first use in this function)
temp.c:82: error: 'uLong' undeclared (first use in this function)
temp.c:82: error: expected ';' before 'real_size'
temp.c:83: error: 'uLongf' undeclared (first use in this function)
temp.c:83: error: expected ';' before 'zsize'
temp.c:87: error: 'real_size' undeclared (first use in this function)
temp.c:88: error: 'zsize' undeclared (first use in this function)
temp.c:89: error: expected expression before ')' token
temp.c:90: warning: implicit declaration of function 'my_inflate'
[Fail]


Expected Results:  
bundle the files and compress them...

System is Linux, Debian Lenny. Maybe not all Mono packages are installed? I'm
not the admin, nor experienced enough with Linux, I'm just a user :-(

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="103279.html">[Mono-bugs] [Bug 599488] Why SocketException with ErrorCode == 10035 means Operation timed out? It breaks .NET compatibility
</A></li>
	<LI>Next message: <A HREF="103281.html">[Mono-bugs] [Bug 634839] MKBundle fails(ungraceful) when zlib.h is	not present.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103280">[ date ]</a>
              <a href="thread.html#103280">[ thread ]</a>
              <a href="subject.html#103280">[ subject ]</a>
              <a href="author.html#103280">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
