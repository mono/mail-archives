<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 634931] launcher for each activity class when using period shorthand in AndroidManifest
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20634931%5D%20launcher%20for%20each%20activity%20class%20when%0A%20using%20period%20shorthand%20in%20AndroidManifest&In-Reply-To=bug-634931-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="103286.html">
   <LINK REL="Next"  HREF="103287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 634931] launcher for each activity class when using period shorthand in AndroidManifest</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20634931%5D%20launcher%20for%20each%20activity%20class%20when%0A%20using%20period%20shorthand%20in%20AndroidManifest&In-Reply-To=bug-634931-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 634931] launcher for each activity class when using period shorthand in AndroidManifest">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Aug 27 11:03:57 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="103286.html">[Mono-bugs] [Bug 634931] launcher for each activity class when using period shorthand in AndroidManifest
</A></li>
        <LI>Next message: <A HREF="103287.html">[Mono-bugs] [Bug 634945] New: Report.ShowMessage() should also exclude the case when CurrentToken is EndOfCode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103292">[ date ]</a>
              <a href="thread.html#103292">[ thread ]</a>
              <a href="subject.html#103292">[ subject ]</a>
              <a href="author.html#103292">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=634931">https://bugzilla.novell.com/show_bug.cgi?id=634931</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=634931#c1">https://bugzilla.novell.com/show_bug.cgi?id=634931#c1</A>


Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
             Status|NEW                         |RESOLVED
         Resolution|                            |WONTFIX

--- Comment #1 from Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>&gt; 2010-08-27 15:03:56 UTC ---
So here's the answer: Don't Do That. :-)

Background: monodroid.exe processes AssemblyManifest.xml, partially generating
its contents.  monodroid.exe provides a --package=NAME [0] option to change the
value of the /manifest/@package attribute value.

Why would you want to use --package?  Android only allows having one
application with a given package name to be installed at a time.  Thus, if you
want to install two different versions of your app (e.g. the &quot;stable&quot; and
&quot;development&quot; versions for side-by-side testing), you would need to change the
package name.  `monodroid --package` allows you to trivially change the package
name, allowing you to have the &quot;same&quot; app installed multiple times (under
different package names), thus facilitating testing.

HOWEVER, as you note from the activity docs, //activity/@android:name MUST be
EITHER a fully-qualified class name OR a class name found within the
/manifest/@package package.

Consequently, if you actually used `monodroid --package` to change the package,
AND you used the &quot;.ShortHand&quot; convention, your activity wouldn't be found (as
monodroid generates Java proxies in the Java package corresponding to the
namespace of your managed code, so if you change the package name but not your
namespace the proxies will be in the &quot;wrong&quot; location...  result: it won't
work).

Thus, to allow `monodroid --package` to sanely work, monodroid ALWAYS uses
fully-qualified type names within //activity/@android:name.  This just makes
things easier to deal with. :-)

The problem you're seeing is that the AndroidManifest.xml you're providing is
making use of short names.  monodroid doesn't currently check for short names,
it just checks for full class names.  Since it doesn't find an
//activity/@android:name with the full type name, it creates one.

Result: the AndroidManifest.xml that is actually built into the .apk file has
*4* &lt;activity/&gt; elements, two with the short name and two with the full name. 
See ./obj/Debug/android/AndroidManifest.xml in your project directory.

Which is why you're seeing two launchers: the &lt;activity/&gt; elements that
monodroid generates by default includes the LAUNCHER category, so your attempt
at &quot;removing&quot; LAUNCHER is being negated by monodroid's default behavior.

There are several possible solutions here

 1. Use full type names in your AndroidManifest.xml so that what you write
    takes precedence over what monodroid generates (as monodroid won't 
    generate XML if the //activity/@android:name is already present).

 2. #632611 will allow us to use attributes on the Activity to control
    the AndroidManifest XML that monodroid generates.  This is likely
    the cleanest solution, but I don't know when it'll be complete.

 3. We could fix monodroid to also check for short names and replace them
    with full names if necessary.  I'm leery of this idea, though, as it
    could result in &quot;odd&quot; behavior if someone were to use the same class name
    in different namespaces; which type should the shortname refer to?

    Arguably, you shouldn't do that, but when (1) makes it trivial to support
    this scenario anyway, I don't see much point to adding additional code
    to support (3).

So this bug is either a dup of #632611 or a WONTFIX (as you should be doing (1)
and/or I don't like (3)).

[0] <A HREF="http://monodroid.net/Documentation/Tools/Monodroid.exe">http://monodroid.net/Documentation/Tools/Monodroid.exe</A>

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="103286.html">[Mono-bugs] [Bug 634931] launcher for each activity class when using period shorthand in AndroidManifest
</A></li>
	<LI>Next message: <A HREF="103287.html">[Mono-bugs] [Bug 634945] New: Report.ShowMessage() should also exclude the case when CurrentToken is EndOfCode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103292">[ date ]</a>
              <a href="thread.html#103292">[ thread ]</a>
              <a href="subject.html#103292">[ subject ]</a>
              <a href="author.html#103292">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
