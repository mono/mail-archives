<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 630759] [sgen] is slower than boehm for value types
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20630759%5D%20%5Bsgen%5D%20is%20slower%20than%20boehm%20for%20value%20types&In-Reply-To=bug-630759-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="102877.html">
   <LINK REL="Next"  HREF="102878.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 630759] [sgen] is slower than boehm for value types</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20630759%5D%20%5Bsgen%5D%20is%20slower%20than%20boehm%20for%20value%20types&In-Reply-To=bug-630759-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 630759] [sgen] is slower than boehm for value types">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Aug 12 12:18:13 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="102877.html">[Mono-bugs] [Bug 630759] New: [sgen] is slower than boehm for value	types
</A></li>
        <LI>Next message: <A HREF="102878.html">[Mono-bugs] [Bug 569109] Exponentially increasing compile time for nested anonymous functions.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#102881">[ date ]</a>
              <a href="thread.html#102881">[ thread ]</a>
              <a href="subject.html#102881">[ subject ]</a>
              <a href="author.html#102881">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=630759">http://bugzilla.novell.com/show_bug.cgi?id=630759</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=630759#c1">http://bugzilla.novell.com/show_bug.cgi?id=630759#c1</A>


--- Comment #1 from Mark Probst &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mprobst at novell.com</A>&gt; 2010-08-12 16:18:13 UTC ---
The problem here is that we don't have smart handling of indirect ref stores. 
We always invoke the write barrier for them because the store might be to the
major heap.  In this case the indirect store is to the stack, however, which
doesn't need a write barrier.

Here is a simpler example where the difference is even more pronounced:


using System;
using System.Diagnostics;

public sealed class Program
{
    struct S
    {
        Program p;

        public S (Program p)
        {
            this.p = p;
        }
    }

    public static void Main()
    {
        Stopwatch sw;

        Program p = new Program ();

        sw = Stopwatch.StartNew();
        for (int nn = 0; nn &lt; 300000000; ++nn) {
            S s = new S (p);
        }

        Console.WriteLine(sw.Elapsed + &quot;\tM&quot;);
    }
}

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="102877.html">[Mono-bugs] [Bug 630759] New: [sgen] is slower than boehm for value	types
</A></li>
	<LI>Next message: <A HREF="102878.html">[Mono-bugs] [Bug 569109] Exponentially increasing compile time for nested anonymous functions.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#102881">[ date ]</a>
              <a href="thread.html#102881">[ thread ]</a>
              <a href="subject.html#102881">[ subject ]</a>
              <a href="author.html#102881">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
