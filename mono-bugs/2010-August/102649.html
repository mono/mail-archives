<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 627562] New: FTP Client Lib fails on MONO: Protocol option not supported
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20627562%5D%20New%3A%20FTP%20Client%20Lib%20fails%20on%20MONO%3A%0A%20Protocol%20option%20not%20supported&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="102648.html">
   <LINK REL="Next"  HREF="102650.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 627562] New: FTP Client Lib fails on MONO: Protocol option not supported</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20627562%5D%20New%3A%20FTP%20Client%20Lib%20fails%20on%20MONO%3A%0A%20Protocol%20option%20not%20supported&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 627562] New: FTP Client Lib fails on MONO: Protocol option not supported">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Aug  2 13:38:00 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="102648.html">[Mono-bugs] [Bug 624942] make run-test-ondotnet no longer works on corlib 2.0; cannot decode embedded access permission set
</A></li>
        <LI>Next message: <A HREF="102650.html">[Mono-bugs] [Bug 627562] FTP Client Lib fails on MONO: Protocol option not supported
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#102649">[ date ]</a>
              <a href="thread.html#102649">[ thread ]</a>
              <a href="subject.html#102649">[ subject ]</a>
              <a href="author.html#102649">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=627562">http://bugzilla.novell.com/show_bug.cgi?id=627562</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=627562#c0">http://bugzilla.novell.com/show_bug.cgi?id=627562#c0</A>


           Summary: FTP Client Lib fails on MONO: Protocol option not
                    supported
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.6.x
          Platform: Sparc
        OS/Version: Solaris 10
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">Lorenzo_Solano at Codetel.com.do</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.6)
Gecko/20100625 Firefox/3.6.6 ( .NET CLR 3.5.30729)

We reported this issue to the developers of the FTP library, and they answer to
Us that the problem is in the MONO implementation (2.6.1) for Solaris 10.
<A HREF="http://code.google.com/p/starksoft-component-libraries/issues/detail?id=36">http://code.google.com/p/starksoft-component-libraries/issues/detail?id=36</A> ,
they suggest to us that the problem is on the MONO implementation of the class
System.Net.TcpClient.

The issue is that on Windows and other platforms the same code, without the
modifications that I made to the FTP library; works just fine.


They also point us to this thread on the site of another FTP library having the
same issue with the same environment.
<A HREF="http://ftps.codeplex.com/Thread/View.aspx?ThreadId=61949">http://ftps.codeplex.com/Thread/View.aspx?ThreadId=61949</A>


Reproducible: Always

Steps to Reproduce:
Using starksoft-ftp library
Steps to reproduce problem:
1. Make a console app to connect to FTP server
2. Compile in windows and copy folders release or debug to solaris
3. execute the 'consoleapplication.exe' with mono

This is the code sniped:
this is a piece of code use in the app.

FtpClient ftp = new FtpClient(hostname);

ftp.FileTransferType = TransferType.Binary;
ftp.DataTransferMode = TransferMode.Passive;

// open a connect to the rserver
ftp.Open(user, password);

FtpItemCollection list = ftp.GetDirList(&quot;/*&quot;);

// list all the items to the debug output window
foreach (FtpItem item in list)
{
    Console.WriteLine(item.Name + &quot; &quot; + item.Modified.ToString() + &quot; &quot; +
item.Size.ToString() + &quot; &quot;
+ item.SymbolicLink + &quot; &quot; + item.ItemType.ToString() + &quot; &quot; + item.Attributes +
&quot; ---- &quot; + item.RawText);
}

ftp.Close();
Actual Results:  
GLib: Cannot convert message: Conversion from character set 'UTF-8' to '646' is
not supported

Unhandled Exception: System.Net.Sockets.SocketException: Protocol option not
supported
  at System.Net.Sockets.Socket.SetSocketOption (SocketOptionLevel optionLevel,
SocketOptionName optionName, Int32 optionValue) [0x00000] in &lt;filename
unknown&gt;:0
  at System.Net.Sockets.TcpClient.set_ReceiveTimeout (Int32 value) [0x00000] in
&lt;filename unknown&gt;:0
  at Starksoft.Net.Ftp.FtpBase.CreateCommandConnection () [0x00000] in
&lt;filename unknown&gt;:0
  at Starksoft.Net.Ftp.FtpBase.OpenCommandConn () [0x00000] in &lt;filename
unknown&gt;:0
  at Starksoft.Net.Ftp.FtpClient.Open (System.String user, System.String
password) [0x00000] in &lt;filename unknown&gt;:0
  at ConsoleApplication.Program.Main (System.String[] args) [0x00000] in
&lt;filename unknown&gt;:0


************************************
The problems seams to be on the implementation of System.Net.Sockets.TcpClient,
because when we comment the lines below the application runs just fine:
//_dataConn.SendTimeout = _tcpTimeout; 
//_dataConn.ReceiveTimeout = _tcpTimeout;
_dataConn.ReceiveBufferSize = _tcpBufferSize;
_dataConn.SendBufferSize = _tcpBufferSize;

The same app runs fine on Windows without commenting those lines.

Expected Results:  
No Exception thrown, connect to server and list all files.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="102648.html">[Mono-bugs] [Bug 624942] make run-test-ondotnet no longer works on corlib 2.0; cannot decode embedded access permission set
</A></li>
	<LI>Next message: <A HREF="102650.html">[Mono-bugs] [Bug 627562] FTP Client Lib fails on MONO: Protocol option not supported
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#102649">[ date ]</a>
              <a href="thread.html#102649">[ thread ]</a>
              <a href="subject.html#102649">[ subject ]</a>
              <a href="author.html#102649">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
