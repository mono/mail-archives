<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 46429][Blo] New - XSP from CVS bug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40rocky.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="006392.html">
   <LINK REL="Next"  HREF="006394.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 46429][Blo] New - XSP from CVS bug
   </H1>
    <B>bugzilla-daemon@rocky.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40rocky.ximian.com"
       TITLE="[Mono-bugs] [Bug 46429][Blo] New - XSP from CVS bug">bugzilla-daemon@rocky.ximian.com
       </A><BR>
    <I>Tue, 15 Jul 2003 20:03:26 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="006392.html">[Mono-bugs] Re: I’ll tell you why!
</A></li>
        <LI> Next message: <A HREF="006394.html">[Mono-bugs] [Bug 46397][Nor] Changed - Panel class not working correctly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6393">[ date ]</a>
              <a href="thread.html#6393">[ thread ]</a>
              <a href="subject.html#6393">[ subject ]</a>
              <a href="author.html#6393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:pbaena@uol.com.ar.">pbaena@uol.com.ar.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46429">http://bugzilla.ximian.com/show_bug.cgi?id=46429</A>

--- shadow/46429	Tue Jul 15 20:03:26 2003
+++ shadow/46429.tmp.22087	Tue Jul 15 20:03:26 2003
@@ -0,0 +1,157 @@
+Bug#: 46429
+Product: Mono/Class Libraries
+Version: unspecified
+OS: Debian Woody
+OS Details: 
+Status: NEW   
+Resolution: 
+Severity: 
+Priority: Blocker
+Component: System.Web
+AssignedTo: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>                            
+ReportedBy: <A HREF="mailto:pbaena@uol.com.ar">pbaena@uol.com.ar</A>               
+QAContact: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>
+TargetMilestone: ---
+URL: 
+Summary: XSP from CVS bug
+
+When using XSP with these files:
+
+header.inc--------------------------------------------------
+
+&lt;%@ Page Language=&quot;C#&quot; %&gt;
+
+&lt;html&gt;
+
+&lt;head&gt;
+&lt;link href=&quot;mystyle.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
+
+------------------------------------------------------------
+
+test.aspx---------------------------------------------------
+&lt;!-- #include virtual=&quot;header.inc&quot; --&gt;
+&lt;%@ import namespace=&quot;System.Configuration&quot; %&gt;
+&lt;%@ import namespace=&quot;System.Data&quot; %&gt;
+&lt;%@ import namespace=&quot;System.Reflection&quot; %&gt;
+
+ 
+&lt;script runat=&quot;server&quot;&gt;
+
+	static Type cncType = null;
+
+	void GetConnectionData (out string providerAssembly, out string
+cncTypeName, out string cncString)
+	{
+		providerAssembly = null;
+		cncTypeName = null;
+		cncString = null;
+		NameValueCollection config = ConfigurationSettings.AppSettings as
+NameValueCollection;
+		if (config != null) {
+			foreach (string s in config.Keys) {
+				if (0 == String.Compare (&quot;DBProviderAssembly&quot;, s, true)) {
+					providerAssembly = config [s];
+				} else if (0 == String.Compare (&quot;DBConnectionType&quot;, s, true)) {
+					cncTypeName = config [s];
+				} else if (0 == String.Compare (&quot;DBConnectionString&quot;, s, true)) {
+					cncString = config [s];
+				}
+			}
+		}
+
+		if (providerAssembly == null || providerAssembly == &quot;&quot;)
+			providerAssembly = &quot;Mono.Data.PostgreSqlClient&quot;;
+		
+		if (cncTypeName == null || cncTypeName == &quot;&quot;)
+			cncTypeName = &quot;Mono.Data.PostgreSqlClient.PgSqlConnection&quot;;
+		
+		if (cncString == null || cncString == &quot;&quot;)
+			cncString =
+&quot;hostaddr=127.0.0.1;user=monotest;password=monotest;dbname=monotest&quot;;
+	}
+
+	IDbConnection cnc;
+	void Page_Init (object sender, EventArgs e)
+	{
+		string connectionTypeName;
+		string providerAssemblyName;
+		string cncString;
+
+		GetConnectionData (out providerAssemblyName, out connectionTypeName, out
+cncString);
+		if (cncType == null) {		
+			Assembly dbAssembly = Assembly.Load (providerAssemblyName);
+			cncType = dbAssembly.GetType (connectionTypeName, true);
+			if (!typeof (IDbConnection).IsAssignableFrom (cncType))
+				throw new ApplicationException (&quot;The type '&quot; + cncType +
+								&quot;' does not implement IDbConnection.\n&quot; +
+								&quot;Check 'DbConnectionType' in server.exe.config.&quot;);
+		}
+
+		cnc = (IDbConnection) Activator.CreateInstance (cncType);
+		cnc.ConnectionString = cncString;
+		try {
+			cnc.Open ();
+		} catch (Exception exc) {
+			ShowError (exc);
+			cnc = null;
+		}
+	}
+
+	void Page_Load (object o, EventArgs e)
+	{
+		title.Text = &quot;Cuaderno de visitas&quot;;
+	}
+
+	void ShowError (Exception exc)
+	{
+		noDBLine.InnerHtml += &quot;&lt;p&gt;&lt;b&gt;The error was:&lt;/b&gt;\n&lt;pre&gt; &quot; + exc +
+&quot;&lt;/pre&gt;&lt;/p&gt;&quot;;
+		theForm.Visible = false;
+		noDBLine.Visible = true;
+	}
+
+&lt;/script&gt;
+
+&lt;/head&gt;
+&lt;body&gt;
+
+&lt;form id=&quot;theForm&quot; runat=&quot;server&quot;&gt;
+
+&lt;span runat=&quot;server&quot; visible=&quot;false&quot; id=&quot;noDBLine&quot;&gt;
+&lt;h3&gt;Database Error&lt;/h3&gt;
+Sorry, a database error has occurred.
+&lt;p&gt;
+You should set up a database for user &lt;i&gt;'monotest'&lt;/i&gt;,
+password &lt;i&gt;'monotest'&lt;/i&gt; and dbname &lt;i&gt;'monotest'&lt;/i&gt;.
+&lt;p&gt;
+Then modify the variables DBProviderAssembly, DBConnectionType and
+DBConnectionString in server.exe.config file to fit your needs.
+&lt;p&gt;
+The database should have a table called customers created with the
+following command (or similar):
+&lt;pre&gt;
+CREATE TABLE &quot;test&quot; (
+	&quot;person&quot; character varying(256) NOT NULL,
+	&quot;email&quot; character varying(256) NOT NULL
+);
+
+&lt;/pre&gt;
+&lt;/span&gt;
+
+&lt;br&gt;
+
+&lt;/form&gt;
+&lt;/body&gt;
+&lt;/html&gt;
+-----------------------------------------------------------------
+
+XSP throws:
+Server Error in '/' Application
+Compilation Error
+Description: Error compiling a resource required to service this request.
+Review your source file and modify it to fix this error.
+
+Error message: /tmp/tmp6ee4ca8a.cs(38,0) : error CS8025: : Parsing error
+(0,0) : error .CSharp.yyParser.yyException: irrecoverable syntax error
+(0,0) : error failed: 1 error(s), 0 warnings

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="006392.html">[Mono-bugs] Re: I’ll tell you why!
</A></li>
	<LI> Next message: <A HREF="006394.html">[Mono-bugs] [Bug 46397][Nor] Changed - Panel class not working correctly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6393">[ date ]</a>
              <a href="thread.html#6393">[ thread ]</a>
              <a href="subject.html#6393">[ subject ]</a>
              <a href="author.html#6393">[ author ]</a>
         </LI>
       </UL>
</body></html>
