<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 691517] New: Server error (as WebException) leaves HttpWebRequest in incorrect state
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20691517%5D%20New%3A%20Server%20error%20%28as%20WebException%29%20leaves%0A%20HttpWebRequest%20in%20incorrect%20state&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="111673.html">
   <LINK REL="Next"  HREF="111714.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 691517] New: Server error (as WebException) leaves HttpWebRequest in incorrect state</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20691517%5D%20New%3A%20Server%20error%20%28as%20WebException%29%20leaves%0A%20HttpWebRequest%20in%20incorrect%20state&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 691517] New: Server error (as WebException) leaves HttpWebRequest in incorrect state">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue May  3 15:14:46 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="111673.html">[Mono-bugs] [Bug 691486] New: TcpClient.BeginConnect doesn't call	callback
</A></li>
        <LI>Next message: <A HREF="111714.html">[Mono-bugs] [Bug 691517] Server error (as WebException) leaves HttpWebRequest in incorrect state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111674">[ date ]</a>
              <a href="thread.html#111674">[ thread ]</a>
              <a href="subject.html#111674">[ subject ]</a>
              <a href="author.html#111674">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=691517">https://bugzilla.novell.com/show_bug.cgi?id=691517</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=691517#c0">https://bugzilla.novell.com/show_bug.cgi?id=691517#c0</A>


           Summary: Server error (as WebException) leaves HttpWebRequest
                    in incorrect state
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.10.x
          Platform: Other
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sgsghu at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Description of Problem: After webserver have sent back error code (e.g. 404)
and WebException has been thrown, the next try with the same WebRequest fails
with InvalidOperationException (instead of another WebException).

Steps to reproduce the problem:
1. Run the following code:
WebRequest req = WebRequest.Create(&quot;<A HREF="http://foo.bar&quot;">http://foo.bar&quot;</A>);

try {
    req.GetResponse();
} catch (WebException) {
    Console.WriteLine(&quot;gotcha!&quot;);
}
try {
    req.GetResponse();                    
} catch (WebException) {
    Console.WriteLine(&quot;gotcha!&quot;);
}

Actual Results:
Unhandled Exception: System.InvalidOperationException: Cannot re-call start of
asynchronous method while a previous call is still in progress.
  at System.Net.HttpWebRequest.BeginGetResponse (System.AsyncCallback callback,
System.Object state) [0x00185] in
C:\cygwin\tmp\monobuild\build\BUILD\mono-2.10.2\mcs\class\System\System.Net\HttpWebReq
uest.cs:817
  at System.Net.HttpWebRequest.GetResponse () [0x00000] in
C:\cygwin\tmp\monobuild\build\BUILD\mono-2.10.2\mcs\class\System\System.Net\HttpWebRequest.cs:841

Expected Results:
Two gotcha!-s (WebExceptions) as in .NET.

How often does this happen? 
Always.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="111673.html">[Mono-bugs] [Bug 691486] New: TcpClient.BeginConnect doesn't call	callback
</A></li>
	<LI>Next message: <A HREF="111714.html">[Mono-bugs] [Bug 691517] Server error (as WebException) leaves HttpWebRequest in incorrect state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111674">[ date ]</a>
              <a href="thread.html#111674">[ thread ]</a>
              <a href="subject.html#111674">[ subject ]</a>
              <a href="author.html#111674">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
