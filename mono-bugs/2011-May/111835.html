<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 693367] New: Inherited WebService proxies fail on	Invoke.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20693367%5D%20New%3A%20Inherited%20WebService%20proxies%20fail%20on%0A%09Invoke.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="111841.html">
   <LINK REL="Next"  HREF="111836.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 693367] New: Inherited WebService proxies fail on	Invoke.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20693367%5D%20New%3A%20Inherited%20WebService%20proxies%20fail%20on%0A%09Invoke.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 693367] New: Inherited WebService proxies fail on	Invoke.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu May 12 08:39:33 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="111841.html">[Mono-bugs] [Bug 693366] CommunicationObject fixes
</A></li>
        <LI>Next message: <A HREF="111836.html">[Mono-bugs] [Bug 693370] New: SerialPort.Open() does not throw an exception if serial port is already open by another application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111835">[ date ]</a>
              <a href="thread.html#111835">[ thread ]</a>
              <a href="subject.html#111835">[ subject ]</a>
              <a href="author.html#111835">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=693367">https://bugzilla.novell.com/show_bug.cgi?id=693367</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=693367#c0">https://bugzilla.novell.com/show_bug.cgi?id=693367#c0</A>


           Summary: Inherited WebService proxies fail on Invoke.
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.10.x
          Platform: All
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.Web.Services
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">atsushi at ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">thom at union.waw.pl</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0.1)
Gecko/20100101 Firefox/4.0.1

We define simple webservice proxy (code below is just a problem template):

[System.Web.Service.WebServiceBindingAttribute(Name=&quot;blahblah&quot;,
Namespace=&quot;<A HREF="http://blahblah/blah&quot;]">http://blahblah/blah&quot;]</A>
class FooService : System.Web.Services.Protocols.SoapHttpClientProtocol
{
   public object MyWebMethod()
   {
      object results[]= this.Invoke(&quot;MyWebMethod&quot;, new object[] { });
      return results[0];
   }
}

class BarService : FooService
{
   public object MyAnotherMethod()
   {
      return MyWebMethod();
   }
}

Calling barService.MyAnotherFunction() throws exception:

WebServiceBindingAttribute is required on proxy class 'BarService'.   at
System.Web.Services.Protocols.SoapTypeStubInfo..ctor
(System.Web.Services.Protocols.LogicalTypeInfo logicalTypeInfo) [0x00000] in
&lt;filename unknown&gt;: 0
  at System.Web.Services.Protocols.LogicalTypeInfo.GetTypeStub (System.String
protocolName) [0x00000] in &lt;filename unknown&gt;:0
  at System.Web.Services.Protocols.TypeStubManager.GetTypeStub (System.Type t,
System.String protocolName) [0x00000] in &lt;filename unknown&gt;:0
  at System.Web.Services.Protocols.SoapHttpClientProtocol..ctor () [0x00000] in
&lt;filename unknown&gt;:0

Above exception occurs on internal class SoapTypeStubInfo defined in
System.Web.Services.Protocols/Methods.cs.

In mono sources I've found in files
System.Web.Services.Protocols/TypeStubManager.cs and
System.Web.Services.Protocols/ServerType.cs wrong calls to find
WebServiceBindingAttribute:

type.GetCustomAttributes (typeof (WebServiceBindingAttribute), false);

I think that this should be changed to:

type.GetCustomAttributes (typeof (WebServiceBindingAttribute), true);

This will find attributes on inherited classes and work like in Microsoft .Net
Framework. Later I'll try to compile locally System.Web.Services and check
above change. If it will work, then I'll try to provide a patch.


Reproducible: Always

Steps to Reproduce:
1. Create new class inheriting from webservice proxy class (eg generated by
wsdl.exe)
2. Call web method on inherited class.
3. Exception occurs.
Actual Results:  
Exception occurs:
WebServiceBindingAttribute is required on proxy class 'BarService'.   at
System.Web.Services.Protocols.SoapTypeStubInfo..ctor
(System.Web.Services.Protocols.LogicalTypeInfo logicalTypeInfo) [0x00000] in
&lt;filename unknown&gt;: 0
  at System.Web.Services.Protocols.LogicalTypeInfo.GetTypeStub (System.String
protocolName) [0x00000] in &lt;filename unknown&gt;:0
  at System.Web.Services.Protocols.TypeStubManager.GetTypeStub (System.Type t,
System.String protocolName) [0x00000] in &lt;filename unknown&gt;:0
  at System.Web.Services.Protocols.SoapHttpClientProtocol..ctor () [0x00000] in
&lt;filename unknown&gt;:0


Expected Results:  
Web service call should work properly.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="111841.html">[Mono-bugs] [Bug 693366] CommunicationObject fixes
</A></li>
	<LI>Next message: <A HREF="111836.html">[Mono-bugs] [Bug 693370] New: SerialPort.Open() does not throw an exception if serial port is already open by another application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111835">[ date ]</a>
              <a href="thread.html#111835">[ thread ]</a>
              <a href="subject.html#111835">[ subject ]</a>
              <a href="author.html#111835">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
