<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 690887] FtpWebRequest fails in presence of a proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20690887%5D%20FtpWebRequest%20fails%20in%20presence%20of%20a%20proxy&In-Reply-To=bug-690887-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="111640.html">
   <LINK REL="Next"  HREF="111643.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 690887] FtpWebRequest fails in presence of a proxy</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20690887%5D%20FtpWebRequest%20fails%20in%20presence%20of%20a%20proxy&In-Reply-To=bug-690887-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 690887] FtpWebRequest fails in presence of a proxy">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon May  2 14:36:37 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="111640.html">[Mono-bugs] [Bug 691063] Bin folder is not getting completely	cleaned.
</A></li>
        <LI>Next message: <A HREF="111643.html">[Mono-bugs] [Bug 690887] FtpWebRequest fails in presence of a proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111642">[ date ]</a>
              <a href="thread.html#111642">[ thread ]</a>
              <a href="subject.html#111642">[ subject ]</a>
              <a href="author.html#111642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=690887">https://bugzilla.novell.com/show_bug.cgi?id=690887</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=690887#c3">https://bugzilla.novell.com/show_bug.cgi?id=690887#c3</A>


--- Comment #3 from QuickJack . &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">test051102 at hotmail.com</A>&gt; 2011-05-02 18:36:37 UTC ---
Hi Gonzalo,

thanks for the quick fix. I have checked out your changes and made some new
tests. Anonymous ftp access in presence of a proxy is indeed working now. I
think this is a big step into the right direction.

However, there is still some missing functionality when mixing ftp access and
proxies. Consider the following scenario which in use in many larger companies.
Internet access is generally routed through a standard http proxy server. This
proxy serves as a gateway to the internet. Servers in the intranet can be
accessed directly and must not be routed through the proxy server. In order to
accomplish that goal there is typically a place to setup up a system wide list
of ignored hosts.

I have set up my Quick 'n Easy ftp server as well as a proxy server at address
192.168.1.20. In practice these servers would be placed on two different
machines. The ftp server is password protected
(<A HREF="ftp://user:test@192.168.1.20/test.txt">ftp://user:test@192.168.1.20/test.txt</A>). My Ubuntu client machine is configured
to use 192.168.1.20 as a system wide http proxy for all protocols and to ignore
192.168.1.20 for proxy access.

I used FireFox to verify the setup and I can successfully connect to my ftp
server without using the proxy (FireFox is configured to use system wide proxy
settings). If I use Mono's WebClient.OpenRead() instead, I receive a
System.Exception exception.  Below you will find the corresponding log files:

#####################
#ftp server log file
#####################
10:23:32.937 [3380] FTP Server started on port 21.
10:23:50.390 [3024] Client connected from 192.168.1.20.
10:23:50.406 [3024] 220 Welcome to Quick 'n Easy FTP Server
10:23:50.406 [3024] USER anonymous
10:23:50.406 [3024] Client disconnected from 192.168.1.20.
10:23:50.406 [3024] 331 Password required for anonymous
10:23:50.406 [3024] PASS ******
10:23:50.406 [3024] 530 Not logged in, user or password incorrect!


#####################
#proxy log file
#####################
+++GET 519+++
GET <A HREF="ftp://192.168.1.20/test.txt">ftp://192.168.1.20/test.txt</A> HTTP/1.1
Host: 192.168.1.20
Connection: keep-alive
Accept-Language: en
Cache-Control: no-cache
Browser reload detected...
+++CLOSE 519+++

By looking at the log files we can conclude the following:
(1) Mono still tries to use the proxy and is not aware of Gnome's &#8222;Ignore
Hosts&#8220; setting
(2) If the ftp access is routed through a proxy (which is theoretically
possible), Mono seems to ignore the credentials and uses anonymous access which
is wrong.


Best regards,
Martin

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="111640.html">[Mono-bugs] [Bug 691063] Bin folder is not getting completely	cleaned.
</A></li>
	<LI>Next message: <A HREF="111643.html">[Mono-bugs] [Bug 690887] FtpWebRequest fails in presence of a proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111642">[ date ]</a>
              <a href="thread.html#111642">[ thread ]</a>
              <a href="subject.html#111642">[ subject ]</a>
              <a href="author.html#111642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
