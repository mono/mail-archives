<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 639510] New: BadImageFormatException when delegate
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20639510%5D%20New%3A%20BadImageFormatException%20when%20delegate&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="103901.html">
   <LINK REL="Next"  HREF="103850.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 639510] New: BadImageFormatException when delegate</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20639510%5D%20New%3A%20BadImageFormatException%20when%20delegate&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 639510] New: BadImageFormatException when delegate">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Sep 15 07:29:13 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="103901.html">[Mono-bugs] [Bug 639499] MonoDroid errors not visible in the output	Window
</A></li>
        <LI>Next message: <A HREF="103850.html">[Mono-bugs] [Bug 639510] BadImageFormatException on MS.NET runtime when mono-compiled generic inline delegate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103849">[ date ]</a>
              <a href="thread.html#103849">[ thread ]</a>
              <a href="subject.html#103849">[ subject ]</a>
              <a href="author.html#103849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=639510">https://bugzilla.novell.com/show_bug.cgi?id=639510</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=639510#c0">https://bugzilla.novell.com/show_bug.cgi?id=639510#c0</A>


           Summary: BadImageFormatException when delegate
    Classification: Mono
           Product: Mono: Compilers
           Version: 2.6.x
          Platform: x86-64
        OS/Version: Windows 7
            Status: NEW
          Severity: Critical
          Priority: P5 - None
         Component: C#
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">piotr.wysocki at secpl.cs.put.poznan.pl</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=389724)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=389724">http://bugzilla.novell.com/attachment.cgi?id=389724</A>)
failing example

User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US)
AppleWebKit/534.3 (KHTML, like Gecko) Chrome/6.0.472.55 Safari/534.3

When I compile the attached example source with gmcs,
it runs ok in mono, but it fails to run on MS.NET.

When I compile the attached example source with MS.NET compiler,
it runs ok on both mono and MS.NET.

The resulting ILs differ pretty much between compiled by MS.NET and mono, but
the difference between the failing example and not failing one (see the
attached source, lines 27-38) compiled by mono is very small. I have no idea
what's going on.

I have been using MonoDevelop to compile by both, mono and MS.NET, but that's
rather irrelevant.

Reproducible: Always

Steps to Reproduce:
1. Compile the source file using mono (gmcs).
2. Execute the resulting EXE file using MS.NET.
3. There will be two tests run. Watch for an exception to be printed on the
console during the second test.
Actual Results:  
A System.BadImageFormatException gets thrown when executing a delegate defined
inline in a generic method (the delegate uses those generics).

Expected Results:  
The exception should not appear, as in the first test.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>



















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="103901.html">[Mono-bugs] [Bug 639499] MonoDroid errors not visible in the output	Window
</A></li>
	<LI>Next message: <A HREF="103850.html">[Mono-bugs] [Bug 639510] BadImageFormatException on MS.NET runtime when mono-compiled generic inline delegate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103849">[ date ]</a>
              <a href="thread.html#103849">[ thread ]</a>
              <a href="subject.html#103849">[ subject ]</a>
              <a href="author.html#103849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
