<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 634817] HttpWebRequest fails on HTTPS resources
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20634817%5D%20HttpWebRequest%20fails%20on%20HTTPS%20resources&In-Reply-To=bug-634817-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="104290.html">
   <LINK REL="Next"  HREF="103903.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 634817] HttpWebRequest fails on HTTPS resources</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20634817%5D%20HttpWebRequest%20fails%20on%20HTTPS%20resources&In-Reply-To=bug-634817-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 634817] HttpWebRequest fails on HTTPS resources">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Sep 15 15:27:42 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="104290.html">[Mono-bugs] [Bug 639620] Monotools does not hit break point in Mono	2.8 p4
</A></li>
        <LI>Next message: <A HREF="103903.html">[Mono-bugs] [Bug 579837] System.Configuration.Save() method throws an exception when trying to add an authorization section to an existing Web.config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103899">[ date ]</a>
              <a href="thread.html#103899">[ thread ]</a>
              <a href="subject.html#103899">[ subject ]</a>
              <a href="author.html#103899">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=634817">https://bugzilla.novell.com/show_bug.cgi?id=634817</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=634817#c2">https://bugzilla.novell.com/show_bug.cgi?id=634817#c2</A>


--- Comment #2 from Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>&gt; 2010-09-15 19:27:41 UTC ---
After some cursory investigation, this looks slightly more complicated than I
hoped.  Brain dump follows.

As best as I can currently determine, Android doesn't use any native C library
to store certificates/etc., so P/Invokeing something is of no consequence.

There are, however, Java libraries.  Thus, a solution may look like:

  - Add a callback to the 
    ServicePointManager.ServerCertificateValidationCallback
    property.  This is invoked as part of validating HTTPS certificates.

  - This callback would need to obtain the X509 TrustManager, convert the
    .NET X509Chain+X509Certificate into Java equivalents, and use
    IX509MTrustManager.CheckServerTrusted().

    - Unfortunately, how do we convert the managed types into equivalent
      Java types?  My best guess is to use 
      Java.Security.Cert.CertificateFactory.GenerateCertificate(InputStream)
      from X509Certificate.Export() (which returns a byte[]), which means
      we need a Stream -&gt; InputStream adapter 
      (byte[]-&gt;MemoryStream-&gt;InputStream).

Plus, I'm probably missing something (e.g. how do I convert an X509Chain into
an X509Certficate[]?).

An alternate approach is to hope/pray that /system/etc/security/cacerts.bks (1)
contains all the system-supplied certificates, and (2) won't change format or
location in the future.  We could then add support for the BouncyCastle BKS
container format to our tooling, and just rely on that file.

  <A HREF="http://www.bouncycastle.org/specifications.html">http://www.bouncycastle.org/specifications.html</A>

Either solution looks like lots of work. :-/

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>










































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="104290.html">[Mono-bugs] [Bug 639620] Monotools does not hit break point in Mono	2.8 p4
</A></li>
	<LI>Next message: <A HREF="103903.html">[Mono-bugs] [Bug 579837] System.Configuration.Save() method throws an exception when trying to add an authorization section to an existing Web.config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103899">[ date ]</a>
              <a href="thread.html#103899">[ thread ]</a>
              <a href="subject.html#103899">[ subject ]</a>
              <a href="author.html#103899">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
