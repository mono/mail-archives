<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 639424] New: at (wrapper managed-to-native) string.InternalAllocateStr (int) &lt;0x00049&gt;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20639424%5D%20New%3A%20at%20%28wrapper%20managed-to-native%29%0A%20string.InternalAllocateStr%20%28int%29%20%3C0x00049%3E&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="103844.html">
   <LINK REL="Next"  HREF="103842.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 639424] New: at (wrapper managed-to-native) string.InternalAllocateStr (int) &lt;0x00049&gt;</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20639424%5D%20New%3A%20at%20%28wrapper%20managed-to-native%29%0A%20string.InternalAllocateStr%20%28int%29%20%3C0x00049%3E&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 639424] New: at (wrapper managed-to-native) string.InternalAllocateStr (int) &lt;0x00049&gt;">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Sep 14 21:55:53 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="103844.html">[Mono-bugs] [Bug 639423] /usr/local/src/mono-2.8/bin/mono-sgen()	[0x48b51b]
</A></li>
        <LI>Next message: <A HREF="103842.html">[Mono-bugs] [Bug 639424] at (wrapper managed-to-native) string.InternalAllocateStr (int) &lt;0x00049&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103837">[ date ]</a>
              <a href="thread.html#103837">[ thread ]</a>
              <a href="subject.html#103837">[ subject ]</a>
              <a href="author.html#103837">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=639424">https://bugzilla.novell.com/show_bug.cgi?id=639424</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=639424#c0">https://bugzilla.novell.com/show_bug.cgi?id=639424#c0</A>


           Summary: at (wrapper managed-to-native)
                    string.InternalAllocateStr (int) &lt;0x00049&gt;
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.8.x
          Platform: x86-64
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: GC
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">igouy2 at yahoo.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.9)
Gecko/20100825 Ubuntu/10.04 (lucid) Firefox/3.6.9

Same program that works with mono-2.6.4

<A HREF="http://shootout.alioth.debian.org/u64q/program.php?test=knucleotide&amp;lang=csharp&amp;id=2">http://shootout.alioth.debian.org/u64q/program.php?test=knucleotide&amp;lang=csharp&amp;id=2</A>

FAILS with mono-2.8 preview

<A HREF="http://shootout.alioth.debian.org/u64q/program.php?test=knucleotide&amp;lang=cspreview&amp;id=2#log">http://shootout.alioth.debian.org/u64q/program.php?test=knucleotide&amp;lang=cspreview&amp;id=2#log</A>

Reproducible: Always

Steps to Reproduce:
Wed, 15 Sep 2010 00:24:47 GMT

MAKE:
mv knucleotide.cspreview-2.cspreview knucleotide.cspreview-2.cs
/usr/local/src/mono-2.8/bin/mcs  -optimize+
-out:knucleotide.cspreview-2.cspreview_run knucleotide.cspreview-2.cs
rm knucleotide.cspreview-2.cs
0.16s to complete and log all make actions

COMMAND LINE:
/usr/local/src/mono-2.8/bin/mono --gc=sgen
knucleotide.cspreview-2.cspreview_run 0 &lt; knucleotide-input250000.txt


Actual Results:  
Stacktrace:

  at (wrapper managed-to-native) string.InternalAllocateStr (int) &lt;0x00049&gt;
  at (wrapper managed-to-native) string.InternalAllocateStr (int) &lt;0x00049&gt;
  at string.CreateString (char[],int,int) &lt;0x00067&gt;
  at (wrapper managed-to-managed) string..ctor (char[],int,int) &lt;0x0001b&gt;
  at System.IO.StreamReader.ReadLine () &lt;0x00083&gt;
  at program.Main (string[]) &lt;0x0014c&gt;
  at (wrapper runtime-invoke) .runtime_invoke_void_object
(object,intptr,intptr,intptr) &lt;0x00098&gt;

Native stacktrace:

    /usr/local/src/mono-2.8/bin/mono-sgen() [0x48b51b]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x4de2ef]
    /lib/libpthread.so.0(+0xf8f0) [0x7f08853cc8f0]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x5325e0]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x5327b6]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x532862]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x53989a]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x53b47b]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x53ba03]
    /usr/local/src/mono-2.8/bin/mono-sgen() [0x53badf]
    /usr/local/src/mono-2.8/bin/mono-sgen(mono_string_new_size+0x4c) [0x50dc3c]
    [0x4086ae1a]

Debug info from gdb:

[Thread debugging using libthread_db enabled]
[New Thread 0x7f08830a7710 (LWP 22026)]
0x00007f08853cb93d in read () from /lib/libpthread.so.0
  2 Thread 0x7f08830a7710 (LWP 22026)  0x00007f088506de24 in sigsuspend ()
   from /lib/libc.so.6
* 1 Thread 0x7f0885e68780 (LWP 22024)  0x00007f08853cb93d in read ()
   from /lib/libpthread.so.0

Thread 2 (Thread 0x7f08830a7710 (LWP 22026)):
#0  0x00007f088506de24 in sigsuspend () from /lib/libc.so.6
#1  0x00000000005318c1 in suspend_handler (sig=, 
    siginfo=, context=0x7f08830a6900) at sgen-gc.c:4620
#2  
#3  0x00007f08853cab4e in sem_wait () from /lib/libpthread.so.0
#4  0x00000000005d68e8 in mono_sem_wait (sem=0x8e8920, alertable=0)
    at mono-semaphore.c:102
#5  0x000000000057837d in finalizer_thread (unused=)
    at gc.c:1048
#6  0x00000000005b291f in start_wrapper (data=)
    at threads.c:747
#7  0x00000000005ce724 in thread_start_routine (args=0x244a6f0)
    at wthreads.c:285
#8  0x00000000005345bd in gc_start_thread (arg=0x2471e10) at sgen-gc.c:5351
#9  0x00007f08853c39ca in start_thread () from /lib/libpthread.so.0
#10 0x00007f08851206fd in clone () from /lib/libc.so.6
#11 0x0000000000000000 in ?? ()

Thread 1 (Thread 0x7f0885e68780 (LWP 22024)):
#0  0x00007f08853cb93d in read () from /lib/libpthread.so.0
#1  0x000000000048b6a7 in read (signal=, 
    ctx=) at /usr/include/bits/unistd.h:45
#2  mono_handle_native_sigsegv (signal=, 
    ctx=) at mini-exceptions.c:1935
#3  0x00000000004de2ef in mono_arch_handle_altstack_exception (
    sigctx=0x7fff3c781600, fault_addr=, stack_ovf=0)
    at exceptions-amd64.c:926
#4  
#5  conservatively_pin_objects_from (start=0x7fff3c783000, end=0x7fff3c786000, 
    start_nursery=0x7f0884c00000, end_nursery=0x7f0885000000, 
    pin_type=) at sgen-gc.c:1815
#6  0x00000000005327b6 in scan_thread_data (start_nursery=0x7f0884c00000, 
    end_nursery=0x7f0885000000, precise=0) at sgen-gc.c:4767
#7  0x0000000000532862 in pin_from_roots (start_nursery=0x7f0884c00000, 
    end_nursery=0x7f0885000000) at sgen-gc.c:1898
#8  0x000000000053989a in collect_nursery (
    requested_size=) at sgen-gc.c:2617
#9  0x000000000053b47b in minor_collect_or_expand_inner (size=4096)
    at sgen-gc.c:2984
#10 0x000000000053ba03 in mono_gc_alloc_obj_nolock (vtable=0x23f8318, size=152)
    at sgen-gc.c:3312
#11 0x000000000053badf in mono_gc_alloc_string (vtable=0x23f8318, size=146, 
    len=60) at sgen-gc.c:3482
#12 0x000000000050dc3c in mono_string_new_size (domain=0x23f7fe0, len=60)
    at object.c:4725
#13 0x000000004086ae1a in ?? ()
#14 0x00000000023f7a70 in ?? ()
#15 0x0000000040869008 in ?? ()
#16 0x0000000000000000 in ?? ()

=================================================================
Got a SIGSEGV while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries 
used by your application.
=================================================================


Expected Results:  
A 30.295
T 30.151
C 19.800
G 19.754

AA 9.177
TA 9.132
AT 9.131
TT 9.091
CA 6.002
AC 6.001
AG 5.987
GA 5.984
CT 5.971
TC 5.971
GT 5.957
TG 5.956
CC 3.917
GC 3.911
CG 3.909
GG 3.902

1471758    GGT
446535    GGTA
47336    GGTATT
893    GGTATTTTAATT
893    GGTATTTTAATTTATAGT

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>

























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="103844.html">[Mono-bugs] [Bug 639423] /usr/local/src/mono-2.8/bin/mono-sgen()	[0x48b51b]
</A></li>
	<LI>Next message: <A HREF="103842.html">[Mono-bugs] [Bug 639424] at (wrapper managed-to-native) string.InternalAllocateStr (int) &lt;0x00049&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103837">[ date ]</a>
              <a href="thread.html#103837">[ thread ]</a>
              <a href="subject.html#103837">[ subject ]</a>
              <a href="author.html#103837">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
