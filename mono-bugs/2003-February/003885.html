<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 36704][Nor] Changed - Assorted System.Xml.XmlSchema fixes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40rocky.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003884.html">
   <LINK REL="Next"  HREF="003886.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 36704][Nor] Changed - Assorted System.Xml.XmlSchema fixes
   </H1>
    <B>bugzilla-daemon@rocky.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40rocky.ximian.com"
       TITLE="[Mono-bugs] [Bug 36704][Nor] Changed - Assorted System.Xml.XmlSchema fixes">bugzilla-daemon@rocky.ximian.com
       </A><BR>
    <I>Tue, 18 Feb 2003 13:15:06 -0500 (EST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="003884.html">[Mono-bugs] [Bug 38238][Nor] Changed - Attribute.GetCustomAttributes() doesn't find second attribute
</A></li>
        <LI> Next message: <A HREF="003886.html">[Mono-bugs] [Bug 38291][Nor] New - mcs gets exception when compiling this incorrect code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3885">[ date ]</a>
              <a href="thread.html#3885">[ thread ]</a>
              <a href="subject.html#3885">[ subject ]</a>
              <a href="author.html#3885">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:ginga@kit.hi-ho.ne.jp.">ginga@kit.hi-ho.ne.jp.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=36704">http://bugzilla.ximian.com/show_bug.cgi?id=36704</A>

--- shadow/36704	Mon Feb 17 18:39:54 2003
+++ shadow/36704.tmp.2231	Tue Feb 18 13:15:06 2003
@@ -1,12 +1,12 @@
 Bug#: 36704
 Product: Mono/Class Libraries
 Version: unspecified
 OS: All
 OS Details: 
-Status: NEW   
+Status: NEEDINFO   
 Resolution: 
 Severity: Unknown
 Priority: Normal
 Component: System.XML
 AssignedTo: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>                            
 ReportedBy: <A HREF="mailto:roam@ringlet.net">roam@ringlet.net</A>               
@@ -73,6 +73,63 @@
 Created an attachment (id=3132)
 Read multiple XmlNode's in an &lt;appinfo&gt; element; expect the correct closing tag on &lt;appinfo&gt; and &lt;documentation&gt; elements.
 
 
 ------- Additional Comments From <A HREF="mailto:gonzalo@ximian.com">gonzalo@ximian.com</A>  2003-02-17 18:39 -------
 I'll ask Atsushi to take a look at this.
+
+------- Additional Comments From <A HREF="mailto:ginga@kit.hi-ho.ne.jp">ginga@kit.hi-ho.ne.jp</A>  2003-02-18 13:15 -------
+Hi Peter, thanks and sorry to be so late.
+
+In fact I'm not schema guy and maybe incompletely understanding.
+Anyway...
+
+&gt; xmlschema-enumerator.patch:
+
+Ok.
+
+&gt; xmlschema-iscompiled.patch:
+&gt; - add actual handling of the XmlSchema.isCompiled member variable: 
+reset it
+&gt;   in all routines that change the schema's textual description and 
+set it
+&gt;   to true upon a successful run of the XmlSchema.Compile() method.
+
+Hmm... isn't it hard work to check *all* the members (including all  
+subcomponents)? It will make schema classes so complicated.
+
+One easier solution I thought is (1)to keep schema string using Write
+() method, and (2)when going to Compile(), create current schema 
+string as same way, compare with kept schema string, and if they are 
+different, then continue Compile() process.
+
+&gt; xmlschema-ann.patch
+&gt; - XmlSchemaAppInfo.cs: add the ability to read more than one 
+XmlNode;
+
+Doesn't your code handle all descendants as if they were children?
+
+&gt; - XmlSchemaAnnotation.cs: note that XmlSchemaAppInfo.Read() and
+&gt;   XmlSchemaDocumentation.Read() return with the reader positioned at
+&gt;   the respective element's end, *not* at the next element or at
+&gt;   the annotation end.  Thus, expect and swallow an EndElement for
+&gt;   'appinfo' or 'documentation', instead of choking while expecting
+&gt;   an EndElement for 'annotation'.
+
+Sure, you are right.
+
+&gt; xmldocument-skipread.patch
+&gt; - XmlDocument.ReadNode: check if the reader is already positioned at
+&gt;   an Element, and if so, do not do a Read() that will skip the start
+&gt;   tag of the element.
+
+If your patch is applied, ReadNode() will arise infinite loop. BTW,
+what XmlReader did you used at that time? I assume that XmlNodeReader
+had such bug that didn't handle starting node correctly, and maybe
+fixed in current cvs.
+
+I'll be grateful if you have some tests for those schema problems.
+
+Anyway, I've fixed XmlSchemaObjectEnumerator and XmlSchemaAnnotation.
+Thanks again for those checks and patches!
+
+ Atsushi Eno

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003884.html">[Mono-bugs] [Bug 38238][Nor] Changed - Attribute.GetCustomAttributes() doesn't find second attribute
</A></li>
	<LI> Next message: <A HREF="003886.html">[Mono-bugs] [Bug 38291][Nor] New - mcs gets exception when compiling this incorrect code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3885">[ date ]</a>
              <a href="thread.html#3885">[ thread ]</a>
              <a href="subject.html#3885">[ subject ]</a>
              <a href="author.html#3885">[ author ]</a>
         </LI>
       </UL>
</body></html>
