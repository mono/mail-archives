<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 22668] New - Error initializing a char []
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40rocky.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000207.html">
   <LINK REL="Next"  HREF="000209.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 22668] New - Error initializing a char []
   </H1>
    <B>bugzilla-daemon@rocky.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40rocky.ximian.com"
       TITLE="[Mono-bugs] [Bug 22668] New - Error initializing a char []">bugzilla-daemon@rocky.ximian.com
       </A><BR>
    <I>28 Mar 2002 04:18:11 -0000</I>
    <P><UL>
        <LI> Previous message: <A HREF="000207.html">[Mono-bugs] [Bug 22667] New - Using directive not working with aliases
</A></li>
        <LI> Next message: <A HREF="000209.html">[Mono-bugs] [Bug 22597] Changed - Interface method implementation not found at runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#208">[ date ]</a>
              <a href="thread.html#208">[ thread ]</a>
              <a href="subject.html#208">[ subject ]</a>
              <a href="author.html#208">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:gonzalo@ximian.com.">gonzalo@ximian.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=22668">http://bugzilla.ximian.com/show_bug.cgi?id=22668</A>

--- shadow/22668	Wed Mar 27 23:18:11 2002
+++ shadow/22668.tmp.26757	Wed Mar 27 23:18:11 2002
@@ -0,0 +1,98 @@
+Bug#: 22668
+Product: Mono/Runtime
+Version: unspecified
+OS: other
+OS Details: Windows 2000 Pro
+Status: NEW   
+Resolution: 
+Severity: 
+Priority: Normal
+Component: misc
+AssignedTo: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>                            
+ReportedBy: <A HREF="mailto:gonzalo@ximian.com">gonzalo@ximian.com</A>               
+QAContact: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>
+TargetMilestone: ---
+URL: 
+Cc: 
+Summary: Error initializing a char []
+
+Description of Problem:
+Initializing a static char [] with a value list enclosed in {} fails with
+System.ArgumentException causing the class not to be initialized
+(System.TypeInitializationException is thrown to the caller).
+
+
+Steps to reproduce the problem:
+1. Use version 1.6 of class/corlib/System/IntegerFormatter.cs in CVS.
+2. Remove the lines that exlude IntegerFormatter from the testing in
+class/corlib/Test/corlib_test.build
+3. Run the tests.
+4. In the output, look for IntegerFormatter. You can see that there's an
+error in the type initialization for IntegerFormatter.
+
+Note: I got 301 errors as of  March 28, 3:00 GMT+1
+
+Additional Information:
+
+Debugging the program i get this:
+---begin partial debugging session
+(cordbg) cont
+Warning: couldn't load symbols for
+c:\winnt\assembly\gac\system\1.0.3300.0__b77a5c561934e089\system.
+dll
+Warning: couldn't load symbols for c:\dvp\mcs\class\corlib\test\corlib_test.dll
+..First chance exception generated: (0x00bfe70c) &lt;System.ArgumentException&gt;
+...First chance exception generated: (0x00bfedb4)
+&lt;System.Security.SecurityException&gt;
+First chance exception generated: (0x00bfedb4)
+&lt;System.Security.SecurityException&gt;
+First chance exception generated: (0x00c03d04)
+&lt;System.Reflection.TargetInvocationException&gt;
+First chance exception generated: (0x00c03e5c) &lt;NUnit.Framework.NUnitException&gt;
+E.First chance exception generated: (0x00c04110) &lt;System.ArgumentException&gt;
+Unhandled exception generated: (0x00c04110) &lt;System.ArgumentException&gt;
+  m_paramName=&lt;null&gt;
+  _className=&lt;null&gt;
+  _exceptionMethod=&lt;null&gt;
+  _exceptionMethodString=&lt;null&gt;
+  _message=(0x00c04190) &quot;Value does not fall within the expected range.&quot;
+  _innerException=&lt;null&gt;
+  _helpURL=&lt;null&gt;
+  _stackTrace=(0x00c04200) array with dims=[24]
+  _stackTraceString=&lt;null&gt;
+  _remoteStackTraceString=&lt;null&gt;
+  _remoteStackIndex=0x00000000
+  _HResult=0x80070057
+  _source=&lt;null&gt;
+  _xptrs=0x00000000
+  _xcode=0xe0434f4d
+
+098:            private static char[] digitLowerTable =
+(cordbg)
+
+---end partial debugging session
+
+In corlib/System/IntegerFormatter.cs we can see near the beggining of the
+class implementation:
+
+		private static char[] digitLowerTable = 
+       		{ '0', '1', '2', '3', '4', '5', '6', '7', 
+		  '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };
+
+		private static char[] digitUpperTable = 
+		{ '0', '1', '2', '3', '4', '5', '6', '7', 
+		  '8', '9', 'A', 'B', 'C', 'D', 'E', 'F' };
+
+I get the error when assigning value to digitLowerTable.
+I tried using 'new [16]', 'new []' between the '=' and the '{', but it
+still happens.
+
+Workaround:
+
+Finally I made a workaround (which I will commit when I finish this report)
+which uses a static constructor and assign the values for those two arrays
+in a couple of loops.
+
+Using the workaround, the number of failures when running the tests using
+out IntegerFormatter and adding  IntegerFormatterTests is 282 instead of
+301 without it.


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000207.html">[Mono-bugs] [Bug 22667] New - Using directive not working with aliases
</A></li>
	<LI> Next message: <A HREF="000209.html">[Mono-bugs] [Bug 22597] Changed - Interface method implementation not found at runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#208">[ date ]</a>
              <a href="thread.html#208">[ thread ]</a>
              <a href="subject.html#208">[ subject ]</a>
              <a href="author.html#208">[ author ]</a>
         </LI>
       </UL>
</body></html>
