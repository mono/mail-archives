<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 476081] New: Too many mod_mono instances running and mod-mono server stops responding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20476081%5D%20New%3A%20Too%20many%20mod_mono%20instances%20running%0A%20and%20mod-mono%20server%20stops%20responding&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="086094.html">
   <LINK REL="Next"  HREF="086096.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 476081] New: Too many mod_mono instances running and mod-mono server stops responding</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20476081%5D%20New%3A%20Too%20many%20mod_mono%20instances%20running%0A%20and%20mod-mono%20server%20stops%20responding&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 476081] New: Too many mod_mono instances running and mod-mono server stops responding">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Feb 16 04:05:41 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="086094.html">[Mono-bugs] [Bug 464229] XmlReader.ReadElementContentAsBase64() hangs indefinitely and uses 100% CPU on the last read
</A></li>
        <LI>Next message: <A HREF="086096.html">[Mono-bugs] [Bug 476081] Too many mod_mono instances running and mod-mono server stops responding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#86095">[ date ]</a>
              <a href="thread.html#86095">[ thread ]</a>
              <a href="subject.html#86095">[ subject ]</a>
              <a href="author.html#86095">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=476081">https://bugzilla.novell.com/show_bug.cgi?id=476081</A>


           Summary: Too many mod_mono instances running and mod-mono
                    server stops responding
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.2.x
          Platform: Other
        OS/Version: SLES 10
            Status: NEW
          Severity: Critical
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kuanil at novell.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
                CC: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">bkalidas at novell.com</A>, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">rarul at novell.com</A>,
                    <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">vvaradhan at novell.com</A>, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">vprabudas at novell.com</A>,
                    <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">amahabaleshwar at novell.com</A>, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sbindu at novell.com</A>
          Found By: ---


After discussion with Mono team for bug id 440486, iFolder code was modified so
that it is supported to run with Mono2.x runtime. Currently we are
running/testing iFolder with Mono2.2 runtime tree (This tree is a directory
structure with all mono runtime libraries inside iFolder) as it was decided
alongwith Mono team. When iFolder server is accessed through mod-mono with very
requests coming in one by one, everything works fine. But once many clients
connect and server also starts using mod-mono frequently, suddenly it is seen
that there are many instances of mod-mono running and server stops responding.
Once this happens, then every minute many instances of mod-mono comes up and
get added. Server becomes non-responsive. This can be reproduced within15-30
minutes. Our ST person, when tries to connect around 15 clients, this happens
in first time itself. 
I read <A HREF="http://www.mono-project.com/Mod_mono#Advanced_options">http://www.mono-project.com/Mod_mono#Advanced_options</A> 
and tried putting &quot;MonoAutoRestartTime simias10 00:00:120 &quot; into our conf file
for a restart at every 2 minutes, but this is not working at all. No restart of
mod-mono happens. 
I also used : 
&lt;Location /mono&gt;
  SetHandler mono-ctrl
  Order deny,allow
  Deny from all
  Allow from 127.0.0.1
&lt;/Location&gt;
to check the mod-mono server, but no of requests currently being processed does
not cross 3 (or may be when i am checking this no has reduced ...not sure).

i am writing here a part of the result of &quot;pe -ef | grep mono&quot;  : 


wwwrun   32538     1  0 13:11 ?        00:00:00
/opt/novell/ifolder3/bin/../lib/Mono/usr/bin/mono
/opt/novell/ifolder3/bin/../lib/Mono/usr/lib/mono/2.0/mod-mono-server2.exe
--filename /tmp/mod_mono_server_simias10 --applications
/simias10:/opt/novell/ifolder3/lib/simias/web --nonstop
wwwrun   32554     1  0 13:11 ?        00:00:00
/opt/novell/ifolder3/bin/../lib/Mono/usr/bin/mono
/opt/novell/ifolder3/bin/../lib/Mono/usr/lib/mono/2.0/mod-mono-server2.exe
--filename /tmp/mod_mono_server_simias10 --applications
/simias10:/opt/novell/ifolder3/lib/simias/web --nonstop
wwwrun   32563     1  0 13:12 ?        00:00:00
/opt/novell/ifolder3/bin/../lib/Mono/usr/bin/mono
/opt/novell/ifolder3/bin/../lib/Mono/usr/lib/mono/2.0/mod-mono-server2.exe
--filename /tmp/mod_mono_server_simias10 --applications
/simias10:/opt/novell/ifolder3/lib/simias/web --nonstop

and so-on...........


For you reference, i am writing the conf file used by iFolder and which
reproduces this issue : 
Include /opt/novell/ifolder3/lib/Mono/bin/mod_mono.conf

Alias /simias10 &quot;/opt/novell/ifolder3/lib/simias/web&quot;
AddMonoApplications simias10 &quot;/simias10:/opt/novell/ifolder3/lib/simias/web&quot;
MonoSetEnv simias10
&quot;SimiasRunAsServer=true;SimiasDataDir=/var/simias/data/simias&quot;
MonoServerPath simias10 /opt/novell/ifolder3/lib/Mono/bin/mod-mono-server2
&lt;Location /simias10 &gt;
        MonoSetServerAlias simias10
        Order allow,deny
        Allow from all
        SetHandler mono
&lt;/Location&gt;

even if i do apache2 restart/reload or pkill mono, it does not kill mono..
after sending SIGKILL to mono process, it kills mono. But these manual
workarounds won't be acceptable by customers.Also iFolder will have big
deployments where restarting server every now and then won't be acceptable
scenario. So we would like to have a fix.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>






























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="086094.html">[Mono-bugs] [Bug 464229] XmlReader.ReadElementContentAsBase64() hangs indefinitely and uses 100% CPU on the last read
</A></li>
	<LI>Next message: <A HREF="086096.html">[Mono-bugs] [Bug 476081] Too many mod_mono instances running and mod-mono server stops responding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#86095">[ date ]</a>
              <a href="thread.html#86095">[ thread ]</a>
              <a href="subject.html#86095">[ subject ]</a>
              <a href="author.html#86095">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
