<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 473186] New: Incorrect generic parameter declaring type for recursively nested generic types.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20473186%5D%20New%3A%20Incorrect%20generic%20parameter%20declaring%0A%20type%20for%20recursively%20nested%20generic%20types.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="086278.html">
   <LINK REL="Next"  HREF="085642.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 473186] New: Incorrect generic parameter declaring type for recursively nested generic types.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20473186%5D%20New%3A%20Incorrect%20generic%20parameter%20declaring%0A%20type%20for%20recursively%20nested%20generic%20types.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 473186] New: Incorrect generic parameter declaring type for recursively nested generic types.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Feb  6 03:55:53 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="086278.html">[Mono-bugs] [Bug 473150] Yet another generics related deadlock
</A></li>
        <LI>Next message: <A HREF="085642.html">[Mono-bugs] [Bug 473186] Incorrect generic parameter declaring type for recursively nested generic types.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85641">[ date ]</a>
              <a href="thread.html#85641">[ thread ]</a>
              <a href="subject.html#85641">[ subject ]</a>
              <a href="author.html#85641">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=473186">https://bugzilla.novell.com/show_bug.cgi?id=473186</A>


           Summary: Incorrect generic parameter declaring type for
                    recursively nested generic types.
    Classification: Mono
           Product: Mono: Class Libraries
           Version: unspecified
          Platform: x86
               URL: <A HREF="http:///">http:///</A>
        OS/Version: Windows Vista
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Cecil
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jbevain at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jeff.brown at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Description of Problem:

The wrong generic parameters under certain conditions involving nested
inherited generic types.


Given the following type declaration:

(This code appears in a test of the Gallio Test Automation Platform reflection
layer.)

    public class ReflectionPolicySample
    {
        public class TortureTest&lt;T&gt;
        {
            public class NestedType
            {
                public class DirectlyRecursiveNestedType : NestedType
                {
                }

                public class MiddleType
                {
                    public class IndirectlyRecursiveNestedType : NestedType
                    {
                    }
                }
            }
        }
     }

Then:

TypeReference type = ... grab type reference of IndirectlyRecursiveNestedType
..
TypeReference baseType = type.BaseType;
GenericParameter genericParam = baseType.GenericParameters[0];
TypeReference ownerType = genericParam.Owner as TypeReference;

Actual Results:

ownerType.FullName ==
&quot;MbUnit.TestResources.Reflection.ReflectionPolicySample/TortureTest`1/NestedType/DirectlyRecursiveNestedType&quot;

Expected Results:

ownerType.FullName ==
&quot;MbUnit.TestResources.Reflection.ReflectionPolicySample/TortureTest`1/NestedType/MiddleType/IndirectlyRecursiveNestedType&quot;

How often does this happen? 

Always.

Additional Information:

Yes this is a very weird case but it causes problems because the wrong generic
type parameter is being returned here.  IndirectlyRecursiveNestedType is
completely unrelated to DirectlyRecursiveNestedType yet its generic parameter
type is being returned.

It's not clear to me whether the problem is related to the inheritance of a
declaring type within a nested type or if it's some bad / ambiguous lookup
metadata code in Cecil.

Hope this makes sense.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>

























































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="086278.html">[Mono-bugs] [Bug 473150] Yet another generics related deadlock
</A></li>
	<LI>Next message: <A HREF="085642.html">[Mono-bugs] [Bug 473186] Incorrect generic parameter declaring type for recursively nested generic types.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85641">[ date ]</a>
              <a href="thread.html#85641">[ thread ]</a>
              <a href="subject.html#85641">[ subject ]</a>
              <a href="author.html#85641">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
