<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 472506] New: Mono.Simd doesn't contain Hamming weight function which is in the SSE4.2/4a
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20472506%5D%20New%3A%20Mono.Simd%20doesn%27t%20contain%20Hamming%0A%20weight%20function%20which%20is%20in%20the%20SSE4.2/4a&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="085539.html">
   <LINK REL="Next"  HREF="085580.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 472506] New: Mono.Simd doesn't contain Hamming weight function which is in the SSE4.2/4a</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20472506%5D%20New%3A%20Mono.Simd%20doesn%27t%20contain%20Hamming%0A%20weight%20function%20which%20is%20in%20the%20SSE4.2/4a&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 472506] New: Mono.Simd doesn't contain Hamming weight function which is in the SSE4.2/4a">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Feb  4 12:34:02 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="085539.html">[Mono-bugs] [Bug 467086] ListView.ColumnWidthChanged not raised when changing ColumnHeader.Width programmatically.
</A></li>
        <LI>Next message: <A HREF="085580.html">[Mono-bugs] [Bug 472506] Mono.Simd doesn't contain Hamming weight function which is in the SSE4.2/4a
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85540">[ date ]</a>
              <a href="thread.html#85540">[ thread ]</a>
              <a href="subject.html#85540">[ subject ]</a>
              <a href="author.html#85540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=472506">https://bugzilla.novell.com/show_bug.cgi?id=472506</A>


           Summary: Mono.Simd doesn't contain Hamming weight function
                    which is in the SSE4.2/4a
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.2.x
          Platform: All
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">michal.kovac.develop at centrum.cz</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; cs; rv:1.9.0.5)
Gecko/2009012717 Gentoo Firefox/3.0.5

I haven't found function for counting of number of bits in the VectorXX (we can
call it BitCount, HammingWeight,...). In the SSE4.2 and SSE4a is the POPCNT
operation which does it. It would speed up our software for data mining Ferda
Data Miner (<A HREF="http://ferda.sourceforge.net/">http://ferda.sourceforge.net/</A>). For architectures which does not
have the SSE4.2 or SSE4a I would prefer to use this kind of counting of bits on
architectures without SSE (it is on the amd64 architectures the quickest):


    const ulong m1  = 0x5555555555555555; //binary: 0101...
    const ulong m2  = 0x3333333333333333; //binary: 00110011..
    const ulong m4  = 0x0f0f0f0f0f0f0f0f; //binary:  4 zeros,  4 ones ...
    const ulong h01 = 0x0101010101010101; //the sum of 256 to the power of
0,1,2,3...

static unsafe ulong QuickSum(ulong x) {
    x -= (x &gt;&gt; 1) &amp; m1;//put count of each 2 bits into those 2 bits
    x = (x &amp; m2) + ((x &gt;&gt; 2) &amp; m2); //put count of each 4 bits into those 4
bits
    x = (x + (x &gt;&gt; 4)) &amp; m4;        //put count of each 8 bits into those 8
bits
    return ((x * h01)&gt;&gt;56);  //returns left 8 bits of x + (x&lt;&lt;8) + (x&lt;&lt;16) +
(x&lt;&lt;24) + ...
}

For those architectures which doesn't have SSE 4.2/4a but has a SEE support I
think it can be also speed up.

thanks
Michal Kovac

Reproducible: Always

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="085539.html">[Mono-bugs] [Bug 467086] ListView.ColumnWidthChanged not raised when changing ColumnHeader.Width programmatically.
</A></li>
	<LI>Next message: <A HREF="085580.html">[Mono-bugs] [Bug 472506] Mono.Simd doesn't contain Hamming weight function which is in the SSE4.2/4a
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85540">[ date ]</a>
              <a href="thread.html#85540">[ thread ]</a>
              <a href="subject.html#85540">[ subject ]</a>
              <a href="author.html#85540">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
