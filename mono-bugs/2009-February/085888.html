<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 472732] mod-mono spawns many process and fails to respond when using AutoRestartMode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20472732%5D%20mod-mono%20spawns%20many%20process%20and%20fails%20to%0A%20respond%20when%20using%20AutoRestartMode&In-Reply-To=bug-472732-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="085881.html">
   <LINK REL="Next"  HREF="085898.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 472732] mod-mono spawns many process and fails to respond when using AutoRestartMode</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20472732%5D%20mod-mono%20spawns%20many%20process%20and%20fails%20to%0A%20respond%20when%20using%20AutoRestartMode&In-Reply-To=bug-472732-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 472732] mod-mono spawns many process and fails to respond when using AutoRestartMode">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Feb 11 12:15:59 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="085881.html">[Mono-bugs] [Bug 472732] mod-mono spawns many process and fails to respond when using AutoRestartMode
</A></li>
        <LI>Next message: <A HREF="085898.html">[Mono-bugs] [Bug 472732] mod-mono spawns many process and fails to respond when using AutoRestartMode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85888">[ date ]</a>
              <a href="thread.html#85888">[ thread ]</a>
              <a href="subject.html#85888">[ subject ]</a>
              <a href="author.html#85888">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=472732">https://bugzilla.novell.com/show_bug.cgi?id=472732</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">bassam at symform.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=472732#c15">https://bugzilla.novell.com/show_bug.cgi?id=472732#c15</A>





--- Comment #15 from Bassam Tabbara &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">bassam at symform.com</A>&gt;  2009-02-11 10:15:58 MST ---
Marek, thanks for the explanation. I'm happy for this to be a configuration
issue on my part, and I would happily offer to document it on the mod-mono wiki
once its setteled :-)

A couple of clarifications:
* We are using MPM worker
* I've set the hard and soft per proccess FD limits to 32768. When I check the
limits of the backend process using /proc/BACKENDPID/limits it shows 32768 on
both soft and hard limits. I'm not clear about your comment of this limit being
set on a group of processes.
* I've set the autorestart request limit to 100 only for the repro. It was set
to 10,000 on our servers.
* The repro is most basic ASP.NET app with a single default.aspx page. Shutdown
of this application should be pretty fast.

If I understand your explanation, you are proposing that I size up the request
limits, etc. to *avoid* this issue. It seems that there is a window here where
apache/mod-mono could start a large number of processes and consume a large
number of FD. This window happens when backend are shutdown and restarted and
is a result of the synchornous operations that are performed. Is this correct?

My issues is that I'm unomfortable running without any limits (time or request)
based, and I've yet been able to find the right configuration to avoid this
issue when a limits is reached. I've observed that by setting the request limit
to 10,000 (and having the FD descriptor limit set to a high number) this
prolongs the lock-up issue but it still happens.

The cronjob approach might be the most robust approach at this point.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="085881.html">[Mono-bugs] [Bug 472732] mod-mono spawns many process and fails to respond when using AutoRestartMode
</A></li>
	<LI>Next message: <A HREF="085898.html">[Mono-bugs] [Bug 472732] mod-mono spawns many process and fails to respond when using AutoRestartMode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85888">[ date ]</a>
              <a href="thread.html#85888">[ thread ]</a>
              <a href="subject.html#85888">[ subject ]</a>
              <a href="author.html#85888">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
