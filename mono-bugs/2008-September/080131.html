<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 430477] Debug.Assert() does not work in winform	apps
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20430477%5D%20Debug.Assert%28%29%20does%20not%20work%20in%20winform%0A%09apps&In-Reply-To=bug-430477-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="080116.html">
   <LINK REL="Next"  HREF="080159.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 430477] Debug.Assert() does not work in winform	apps</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20430477%5D%20Debug.Assert%28%29%20does%20not%20work%20in%20winform%0A%09apps&In-Reply-To=bug-430477-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 430477] Debug.Assert() does not work in winform	apps">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Sep 29 14:04:47 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="080116.html">[Mono-bugs] [Bug 430477] Debug.Assert() does not work in winform	apps
</A></li>
        <LI>Next message: <A HREF="080159.html">[Mono-bugs] [Bug 430477] Debug.Assert() does not work in winform	apps
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80131">[ date ]</a>
              <a href="thread.html#80131">[ thread ]</a>
              <a href="subject.html#80131">[ subject ]</a>
              <a href="author.html#80131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=430477">https://bugzilla.novell.com/show_bug.cgi?id=430477</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=430477#c6">https://bugzilla.novell.com/show_bug.cgi?id=430477#c6</A>


Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>&gt; changed:

           What    |Removed                                         |Added
----------------------------------------------------------------------------
                 CC|                                                |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>




--- Comment #6 from Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>&gt;  2008-09-29 12:04:46 MDT ---
It didn't work on .NET because the DefaultTraceListener was handling the
failure message first.  So to see your dialog you'd either have to clear all
the TraceListeners (as you did), or Ignore the first failure dialog, after
which you should see _your_ dialog.  (Yay, two dialogs for every failure
message!)

For Mono integration, I have two suggestions:

1. You should add this to mcs/class/Managed.Windows.Forms and find some
initialization method so that it's always present.  Do NOT call
Debug.Listeners.Clear().

2. More importantly, you should add code so that ShowDebugAssertMsg() grabs the
pre-exising DefaultTraceListener instance, and only shows the UI if
DefaultTraceListener.AssertUiEnabled is true, e.g. (untested):

private DialogResult ShowDebugAssertMsg(string message, string detailMessage)
{
    bool ignore = false;
    foreach (TraceListener tl in Debug.Listeners) {
        DefaultTraceListener d = tl as DefaultTraceListener;
        if (d != null &amp;&amp; !d.AssertUiEnabled) {
            ignore = true;
            break;
        }
    }
    if (ignore)
        return DialogResult.Ignore;

    // as before...
}

The reason to do this is that DefaultTraceListener.AssertUiEnabled is
initialized based on the .exe.config file of the loaded app, thus allowing the
UI to be trivially enabled or disabled via the .config file.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="080116.html">[Mono-bugs] [Bug 430477] Debug.Assert() does not work in winform	apps
</A></li>
	<LI>Next message: <A HREF="080159.html">[Mono-bugs] [Bug 430477] Debug.Assert() does not work in winform	apps
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80131">[ date ]</a>
              <a href="thread.html#80131">[ thread ]</a>
              <a href="subject.html#80131">[ subject ]</a>
              <a href="author.html#80131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
