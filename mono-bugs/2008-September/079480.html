<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 426181] System. AccessViolationException should be raised instead of SIGSEGV alone
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20426181%5D%20System.%20AccessViolationException%20should%20be%0A%20raised%20instead%20of%20SIGSEGV%20alone&In-Reply-To=bug-426181-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="079468.html">
   <LINK REL="Next"  HREF="079494.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 426181] System. AccessViolationException should be raised instead of SIGSEGV alone</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20426181%5D%20System.%20AccessViolationException%20should%20be%0A%20raised%20instead%20of%20SIGSEGV%20alone&In-Reply-To=bug-426181-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 426181] System. AccessViolationException should be raised instead of SIGSEGV alone">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Sep 16 11:00:40 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="079468.html">[Mono-bugs] [Bug 426181] System. AccessViolationException should be raised instead of SIGSEGV alone
</A></li>
        <LI>Next message: <A HREF="079494.html">[Mono-bugs] [Bug 426181] System. AccessViolationException should be raised instead of SIGSEGV alone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79480">[ date ]</a>
              <a href="thread.html#79480">[ thread ]</a>
              <a href="subject.html#79480">[ subject ]</a>
              <a href="author.html#79480">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=426181">https://bugzilla.novell.com/show_bug.cgi?id=426181</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=426181#c8">https://bugzilla.novell.com/show_bug.cgi?id=426181#c8</A>





--- Comment #8 from Paolo Molaro &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A>&gt;  2008-09-16 09:00:40 MDT ---
I think we need to enable the support for throwing the correct exception,
especially because people blame mono for crashing when it's actually their
incorrect p/invoke signatures.
The issue about memory corruption is a poor excuse: the SEGV happens for the
cases where the corruption doesn't occour (the corruption itself is prevented
by the SEGV), so the program may have executed with corrupted state long before
(or even without any SEGV happening). In fact more hard crashes are caused by
the call to abort() overflowing the limited alt stack setup for the SEGV.

Using dladdr() we can also separate SEGV happening inside the mono code (in
those cases we may still want to abort as the mono runtime may be corrupted, or
to force a bug report) from crashes in user code, which will get the
AccessViolation exception. We need to handle the helper functions used by
marshaling, though, as they operate on user p/invoke data.

An option to consider is to generate the exception also for crashes in the
runtime, but in that case generate the same dump of info we do now in some log
file or stderr and use an ExecutionEngine exception (to more easily get the
info from users that hit bugs in mono).

This behaviour needs to be configurable for embedders anyway.

That said, the code Martin uses to get the fields is completely broken: it
should at the very least get the fields by name and handle the case where they
are missing or have different types.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>



































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="079468.html">[Mono-bugs] [Bug 426181] System. AccessViolationException should be raised instead of SIGSEGV alone
</A></li>
	<LI>Next message: <A HREF="079494.html">[Mono-bugs] [Bug 426181] System. AccessViolationException should be raised instead of SIGSEGV alone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79480">[ date ]</a>
              <a href="thread.html#79480">[ thread ]</a>
              <a href="subject.html#79480">[ subject ]</a>
              <a href="author.html#79480">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
