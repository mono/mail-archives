<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 422564] New: Strings Returned Via P/ Invoke Returned Blank When Contain Certain ANSI Characters
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20422564%5D%20New%3A%20Strings%20Returned%20Via%20P/%20Invoke%0A%20Returned%20Blank%20When%20Contain%20Certain%20ANSI%20Characters&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="078737.html">
   <LINK REL="Next"  HREF="078957.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 422564] New: Strings Returned Via P/ Invoke Returned Blank When Contain Certain ANSI Characters</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20422564%5D%20New%3A%20Strings%20Returned%20Via%20P/%20Invoke%0A%20Returned%20Blank%20When%20Contain%20Certain%20ANSI%20Characters&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 422564] New: Strings Returned Via P/ Invoke Returned Blank When Contain Certain ANSI Characters">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Sep  3 09:56:32 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="078737.html">[Mono-bugs] [Bug 422535] New: Missing CS0535 for property accessors
</A></li>
        <LI>Next message: <A HREF="078957.html">[Mono-bugs] [Bug 422564] Strings Returned Via P/ Invoke Returned Blank When Contain Certain ANSI Characters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78738">[ date ]</a>
              <a href="thread.html#78738">[ thread ]</a>
              <a href="subject.html#78738">[ subject ]</a>
              <a href="author.html#78738">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=422564">https://bugzilla.novell.com/show_bug.cgi?id=422564</A>


           Summary: Strings Returned Via P/Invoke Returned Blank When
                    Contain Certain ANSI Characters
           Product: Mono: Class Libraries
           Version: 1.9
          Platform: x86-64
        OS/Version: Linux
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">martin_costello at talk21.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Customer


In my code I have a delegate similar to this:

[UnmanagedFunctionPointer(CallingConvention.Cdecl)]
internal delegate int Function(int param1,
                               int param2,
                               [MarshalAs(UnmanagedType.LPStr)] StringBuilder
param3,
                               int param4);

Which links to a C Static Library.

This works perfectly on Windows (when compiled as a DLL), and has for a long
time.  However, running this under Mono has thrown up a problem.

If the returned string contains an upper-cased diacritic character e.g. &#200; (as
represented in Windows Codepage 1252), then the string returned by param3 is &quot;&quot;
i.e. a zero length string.  The expected string can be any length, and in any
position.  It's mere presence seems to be causing the string to not be returned
to the StringBuilder.

However, the Windows code correctly returns the character using the above C#
code.  The character is also returned in a native C application running on
Linux.  Lower case diacritics appear to be returned correctly, but upper-case
causes this problem.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="078737.html">[Mono-bugs] [Bug 422535] New: Missing CS0535 for property accessors
</A></li>
	<LI>Next message: <A HREF="078957.html">[Mono-bugs] [Bug 422564] Strings Returned Via P/ Invoke Returned Blank When Contain Certain ANSI Characters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78738">[ date ]</a>
              <a href="thread.html#78738">[ thread ]</a>
              <a href="subject.html#78738">[ subject ]</a>
              <a href="author.html#78738">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
