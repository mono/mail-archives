<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 424079] New: Sys.Web. Extensions and Javascript proxy for nested complex types
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20424079%5D%20New%3A%20Sys.Web.%20Extensions%20and%20Javascript%0A%20proxy%20for%20nested%20complex%20types&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="078985.html">
   <LINK REL="Next"  HREF="079388.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 424079] New: Sys.Web. Extensions and Javascript proxy for nested complex types</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20424079%5D%20New%3A%20Sys.Web.%20Extensions%20and%20Javascript%0A%20proxy%20for%20nested%20complex%20types&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 424079] New: Sys.Web. Extensions and Javascript proxy for nested complex types">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sat Sep  6 23:07:04 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="078985.html">[Mono-bugs] [Bug 424077] compute_class_bitmap when using Reflection
</A></li>
        <LI>Next message: <A HREF="079388.html">[Mono-bugs] [Bug 424079] Sys.Web. Extensions and Javascript proxy for nested complex types
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78934">[ date ]</a>
              <a href="thread.html#78934">[ thread ]</a>
              <a href="subject.html#78934">[ subject ]</a>
              <a href="author.html#78934">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=424079">https://bugzilla.novell.com/show_bug.cgi?id=424079</A>


           Summary: Sys.Web.Extensions and Javascript proxy for nested
                    complex types
           Product: Mono: Class Libraries
           Version: SVN
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.Web
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mmorano at mikeandwan.us</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


For my website, I have a webservice which returns a list of custom types, where
those custom types have other nested custom types.  I am using the
ScriptManager to generate the JS proxy to the service, and then use the proxy
to execute calls against the webservice.  

Previously, mono had been serializing both the list elements as well as the
nested types within the list elements.  However, my application stopped working
after updating from SVN.

I have added a quick workaround that will always serialize these complex nested
types, but it does not currently honor the attribute as described in the link
referenced in the comment in the following patch:


Index:
class/System.Web.Extensions/System.Web.Script.Serialization/JSON/JsonSerializer.cs
===================================================================
---
class/System.Web.Extensions/System.Web.Script.Serialization/JSON/JsonSerializer.cs
 (revision 112421)
+++
class/System.Web.Extensions/System.Web.Script.Serialization/JSON/JsonSerializer.cs
 (working copy)
@@ -458,6 +458,15 @@
                                                } else if (topLevelObject) {
                                                        SerializeCustomObject
(writer, value, valueType);
                                                }
+                                               else
+                                               {
+                                                       // this next section
allows for nested complex types to get serialized.  this needs to be
+                                                       // tied into the
attribute that can be specified on the webservice class and/or method
+                                                       // indicating if the
nested type should also be serialized, as described here:
+                                                       //
<A HREF="http://www.asp.net/AJAX/Documentation/Live/mref/T_System_Web_Script_Services_GenerateScriptTypeAttribute.aspx">http://www.asp.net/AJAX/Documentation/Live/mref/T_System_Web_Script_Services_GenerateScriptTypeAttribute.aspx</A>
+                                                       WritePropertyName
(writer, propertyName);
+                                                       SerializeCustomObject
(writer, value, valueType);
+                                               }
                                        }
                                        finally {


After putting this fix in place, my application works once again.  Of course
the above is a quick and dirty hack that needs proper fixing, but it
illustrates the issue.


Thanks,
Mike


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>




















































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="078985.html">[Mono-bugs] [Bug 424077] compute_class_bitmap when using Reflection
</A></li>
	<LI>Next message: <A HREF="079388.html">[Mono-bugs] [Bug 424079] Sys.Web. Extensions and Javascript proxy for nested complex types
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78934">[ date ]</a>
              <a href="thread.html#78934">[ thread ]</a>
              <a href="subject.html#78934">[ subject ]</a>
              <a href="author.html#78934">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
