<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 655872] New: Passing null for string[] Parameters in Activity.ManagedQuery and ContentProvider.Query Causes System.ArgumentNullException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20655872%5D%20New%3A%20Passing%20null%20for%20string%5B%5D%20Parameters%0A%20in%20Activity.ManagedQuery%20and%20ContentProvider.Query%20Causes%0A%20System.ArgumentNullException&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="106578.html">
   <LINK REL="Next"  HREF="106715.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 655872] New: Passing null for string[] Parameters in Activity.ManagedQuery and ContentProvider.Query Causes System.ArgumentNullException</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20655872%5D%20New%3A%20Passing%20null%20for%20string%5B%5D%20Parameters%0A%20in%20Activity.ManagedQuery%20and%20ContentProvider.Query%20Causes%0A%20System.ArgumentNullException&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 655872] New: Passing null for string[] Parameters in Activity.ManagedQuery and ContentProvider.Query Causes System.ArgumentNullException">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Nov 24 17:42:20 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="106578.html">[Mono-bugs] [Bug 655801] styleable does not end up in	Resource.Designer
</A></li>
        <LI>Next message: <A HREF="106715.html">[Mono-bugs] [Bug 655872] Passing null for string[] Parameters in Activity.ManagedQuery and ContentProvider.Query Causes System.ArgumentNullException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#106583">[ date ]</a>
              <a href="thread.html#106583">[ thread ]</a>
              <a href="subject.html#106583">[ subject ]</a>
              <a href="author.html#106583">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=655872">https://bugzilla.novell.com/show_bug.cgi?id=655872</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=655872#c0">https://bugzilla.novell.com/show_bug.cgi?id=655872#c0</A>


           Summary: Passing null for string[] Parameters in
                    Activity.ManagedQuery and ContentProvider.Query Causes
                    System.ArgumentNullException
    Classification: Mono
           Product: MonoDroid
           Version: unspecified
          Platform: x86-64
        OS/Version: Windows 7
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: Runtime
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mkestner at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">danomania at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=402095)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=402095">http://bugzilla.novell.com/attachment.cgi?id=402095</A>)
Solution that demonstrates problem

User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.12)
Gecko/20101026 Firefox/3.6.12

If you pass a null for the projection or selectionArgs parameters in the
Activity.ManagedQuery() or ContentResolver.Query() methods, a
System.ArgumentNullException is thrown.

The methods work as expected by replacing null with new string[]{}. Passing
null in the equivalent Java methods in an Eclipse project execute successfully.

By inspecting the error logs, it appears that the
Android.Runtime.JNIEnv.CopyArray() method is called before checking to see if
the array is null.


Reproducible: Always

Steps to Reproduce:
1. In a MonoDroid project, implement a ContentProvider
2. In your activity, call the Activity.ManagedQuery() method passing null as
the selectionArgs parameter.
3. Run the application (F5 or Ctrl-F5)
4. Wait for exception
Actual Results:  
The system throws a runtime error. The relevant log entries:

E/AndroidRuntime(  671): java.lang.RuntimeException: Unable to start activity
ComponentInfo{com.example.contentprovidersandbox/com.example.contentprovidersandbox.MyActivity}:
java.lang.IllegalArgumentException: System.ArgumentNullException: Argument
cannot be null.
E/AndroidRuntime(  671): Parameter name: src
E/AndroidRuntime(  671):   at Android.Runtime.JNIEnv.CopyArray (System.String[]
src, IntPtr dest) [0x00006] in
/home/jpobst/Desktop/mondroid/Mono.Android/src/Runtime/JNIEnv.cs:1426 
E/AndroidRuntime(  671):   at
Android.Content.ContentProvider.n_Query_Landroid_net_Uri_arrayLjava_lang_String_Ljava_lang_String_arrayLjava_lang_String_Ljava_lang_String_
(IntPtr jnienv, IntPtr native__this, IntPtr native_uri, IntPtr
native_projection, IntPtr native_selection, IntPtr native_selectionArgs, IntPtr
native_sortOrder) [0x0006e] in
/home/jpobst/Desktop/mondroid/Mono.Android/src/generated/Android.Content.ContentProvider.cs:489 


Expected Results:  
Runtime execution w/o exceptions.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>





































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="106578.html">[Mono-bugs] [Bug 655801] styleable does not end up in	Resource.Designer
</A></li>
	<LI>Next message: <A HREF="106715.html">[Mono-bugs] [Bug 655872] Passing null for string[] Parameters in Activity.ManagedQuery and ContentProvider.Query Causes System.ArgumentNullException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#106583">[ date ]</a>
              <a href="thread.html#106583">[ thread ]</a>
              <a href="subject.html#106583">[ subject ]</a>
              <a href="author.html#106583">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
