<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 50530][Min] Changed - Authenticated POST requests do not work with HTTP/1.0 servers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="012476.html">
   <LINK REL="Next"  HREF="012468.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 50530][Min] Changed - Authenticated POST requests do not work with HTTP/1.0 servers
   </H1>
    <B>bugzilla-daemon@bugzilla.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com"
       TITLE="[Mono-bugs] [Bug 50530][Min] Changed - Authenticated POST requests do not work with HTTP/1.0 servers">bugzilla-daemon@bugzilla.ximian.com
       </A><BR>
    <I>Sun, 15 Feb 2004 17:52:44 -0500 (EST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="012476.html">[Mono-bugs] FWD: Everything 4 U Xan:a:x ) Va+l+ium = V1AGR@ * At|'v@n . Pnte:r:min ; S0m@  LX0AE
</A></li>
        <LI> Next message: <A HREF="012468.html">[Mono-bugs] [Bug 51839][Nor] Changed - WSDL tool bug when trying to generate proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12466">[ date ]</a>
              <a href="thread.html#12466">[ thread ]</a>
              <a href="subject.html#12466">[ subject ]</a>
              <a href="author.html#12466">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:helge.hess@opengroupware.org.">helge.hess@opengroupware.org.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=50530">http://bugzilla.ximian.com/show_bug.cgi?id=50530</A>

--- shadow/50530	2004-02-12 13:09:26.000000000 -0500
+++ shadow/50530.tmp.743	2004-02-15 17:52:44.000000000 -0500
@@ -201,6 +201,125 @@
 
 If this still fails for you, please provide all the request/response
 headers or, even better, a tcpdump output file.
 
 Thanks.
 
+
+------- Additional Comments From <A HREF="mailto:helge.hess@opengroupware.org">helge.hess@opengroupware.org</A>  2004-02-15 17:52 -------
+Can't see a difference:
+---snip---
<A HREF="mailto:+helge@move">+helge@move</A>:~/projects/mono/HelgeTests&gt; mono --version
+Mono JIT compiler version 0.30.99, (C) 2002-2004 Novell, Inc.
+www.go-mono.com
+---snap---
+(CVS HEAD of today, also checked 0.30.1)
+
+relevant source:
+---snip---
+      NetworkCredential credentials = 
+	new NetworkCredential(&quot;helge&quot;,&quot;xxx&quot;,null);
+      Uri destination = 
+	new Uri(&quot;<A HREF="http://localhost:22002/RPC2"">http://localhost:22002/RPC2&quot;</A>);
+      
+      HttpWebRequest webRequest =
+	(HttpWebRequest)WebRequest.Create(destination);
+      webRequest.Credentials = credentials;   
+      webRequest.PreAuthenticate = true;
+      webRequest.ProtocolVersion = HttpVersion.Version10;
+      
+      webRequest.Method      = &quot;POST&quot;;
+      webRequest.ContentType = &quot;text/xml&quot;;
+      //webRequest.ExpectContinue = false;
+      
+      /* send request */
+      
+      Stream       rqStream = webRequest.GetRequestStream();
+      StreamWriter sw = new StreamWriter(rqStream);
+      sw.WriteLine(&quot;&lt;?xml version='1.0'?&gt;&quot;);
+      sw.WriteLine(&quot;&lt;a&gt;&lt;/a&gt;&quot;);
+      sw.Flush();
+      sw.Close();
+Console.WriteLine(&quot;Sent Rq ...&quot;);
+
+      string response;
+      
+      try {
+Console.WriteLine(&quot;will get response ...&quot;);
+        HttpWebResponse webResponse = 
+	  (HttpWebResponse)webRequest.GetResponse();
+Console.WriteLine(&quot;did get response ...&quot;);
+				
+        if (webRequest.HaveResponse) {
+          StreamReader stream = 
+	    new StreamReader(webResponse.GetResponseStream());
+          response = stream.ReadToEnd();
+          stream.Close();
+        }
+	else
+	  throw new Exception(&quot;No response received from host.&quot;);
+      }
+      catch(WebException e) {
+        throw new Exception(&quot;Exception occured while sending request.&quot;,e);
+      }
+---snap---
+
+Test program output:
+---snip---
<A HREF="mailto:+helge@move">+helge@move</A>:~/projects/mono/HelgeTests&gt; mono testbasicauth3.exe 
+Sent Rq ...
+will get response ...
+System.Exception: Exception occured while sending request. ---&gt;
+System.Net.WebException: Error getting response stream ---&gt;
+System.Exception: 
+        at System.Net.WebConnection.HandleError()
+        at System.Net.WebConnection.ReadDone()
+        at System.MulticastDelegate.invoke_void_IAsyncResult()
+        at System.Net.Sockets.Socket+Worker.End()
+        at System.Net.Sockets.Socket+Worker.Receive()
+in &lt;0x000ee&gt; System.Net.WebConnection:HandleError
+(System.Net.WebExceptionStatus,System.Exception)
+--- End of inner exception stack trace ---
+
+in &lt;0x0007a&gt; System.Net.HttpWebRequest:CheckFinalStatus
+(System.Net.WebAsyncResult)
+in &lt;0x00065&gt; (wrapper remoting-invoke-with-check)
+System.Net.HttpWebRequest:CheckFinalStatus (System.Net.WebAsyncResult)
+in &lt;0x001d5&gt; System.Net.HttpWebRequest:EndGetResponse
+(System.IAsyncResult)
+in &lt;0x00077&gt; System.Net.HttpWebRequest:GetResponse ()
+in &lt;0x001e8&gt; httpclient:Main ()
+--- End of inner exception stack trace ---
+
+in &lt;0x002ed&gt; httpclient:Main ()
+---snap---
+
+HTTP transaction:
+---snip---
+POST /RPC2 HTTP/1.0
+Content-Type: text/xml
+Content-Length: 30
+Expect: 100-continue
+Connection: keep-alive
+Host: localhost
+
+&lt;?xml version='1.0'?&gt;
+&lt;a&gt;&lt;/a&gt;
+
+Feb 15 22:53:45 xmlrpcd [11484]: response is
+
+HTTP/1.0 401 Authorization Required
+www-authenticate: basic realm=&quot;SKYRiX&quot;
+content-length: 0
+---snap---
+
+
+Summary:
+As you can see &quot;ProtocolVersion&quot; now properly results in HTTP/1.0 in
+the request header but still sends Expect: 100-continue.
+
+In addition the HTTP host header is broken - I send on port &quot;22022&quot;,
+yet the Host header only lists the host name, it should read:
+---snip---
+Host: localhost:22022
+---snap---
+

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="012476.html">[Mono-bugs] FWD: Everything 4 U Xan:a:x ) Va+l+ium = V1AGR@ * At|'v@n . Pnte:r:min ; S0m@  LX0AE
</A></li>
	<LI> Next message: <A HREF="012468.html">[Mono-bugs] [Bug 51839][Nor] Changed - WSDL tool bug when trying to generate proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12466">[ date ]</a>
              <a href="thread.html#12466">[ thread ]</a>
              <a href="subject.html#12466">[ subject ]</a>
              <a href="author.html#12466">[ author ]</a>
         </LI>
       </UL>
</body></html>
