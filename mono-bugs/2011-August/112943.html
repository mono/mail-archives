<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 687865] Async methods of HttpWebRequest fail when compiled for the Device
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20687865%5D%20Async%20methods%20of%20HttpWebRequest%20fail%20when%0A%20compiled%20for%20the%20Device&In-Reply-To=bug-687865-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="112942.html">
   <LINK REL="Next"  HREF="112944.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 687865] Async methods of HttpWebRequest fail when compiled for the Device</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20687865%5D%20Async%20methods%20of%20HttpWebRequest%20fail%20when%0A%20compiled%20for%20the%20Device&In-Reply-To=bug-687865-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 687865] Async methods of HttpWebRequest fail when compiled for the Device">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sat Aug 13 11:16:14 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="112942.html">[Mono-bugs] [Bug 687865] Async methods of HttpWebRequest fail when compiled for the Device
</A></li>
        <LI>Next message: <A HREF="112944.html">[Mono-bugs] [Bug 687865] Async methods of HttpWebRequest fail when compiled for the Device
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112943">[ date ]</a>
              <a href="thread.html#112943">[ thread ]</a>
              <a href="subject.html#112943">[ subject ]</a>
              <a href="author.html#112943">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=687865">https://bugzilla.novell.com/show_bug.cgi?id=687865</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=687865#c23">https://bugzilla.novell.com/show_bug.cgi?id=687865#c23</A>


Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sebastien.pouliot at gmail.com</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
           Severity|Major                       |Critical

--- Comment #23 from Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sebastien.pouliot at gmail.com</A>&gt; 2011-08-13 15:16:11 UTC ---
I have a workaround - that I don't like even a bit but it works...

                using (var response =
state.Request.EndGetResponse(asynchronousResult) as HttpWebResponse)
                {
// as everyone knows a pretty C.WL can fix everything
Console.WriteLine (&quot;state.Callback type {0} is Action&lt;Response&gt; {1}&quot;,
state.Callback.GetType (), (state.Callback is Action&lt;Response&gt;));
                    if (state.Callback is Action&lt;IEnumerable&lt;Response&gt;&gt;)
                    {
                        var callback =
(Action&lt;IEnumerable&lt;Response&gt;&gt;)state.Callback;
                       
callback(Serializer.ReadResponse(response.GetResponseStream()));
                    }
                    else if (state.Callback is Action&lt;Response&gt;)
                    {
                        var callback = (Action&lt;Response&gt;)state.Callback;
                        foreach (var item in
Serializer.ReadResponse(response.GetResponseStream()))
                        {
                            callback(item);
                            return;
                        }
                        callback(null);
                    }
else {
// with the C.WL the code won't reach this part - without it it will!
    Console.WriteLine (&quot;no callback called {0}&quot;, state.Callback.GetType ());
}
                }

My guess is that the caching of the original fix is buggy/incomplete. Having a
call to GetType just before  the *is* check likely help/set it to the right
value.

Hopefully this workaround will help your application until we fix this issue
properly.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="112942.html">[Mono-bugs] [Bug 687865] Async methods of HttpWebRequest fail when compiled for the Device
</A></li>
	<LI>Next message: <A HREF="112944.html">[Mono-bugs] [Bug 687865] Async methods of HttpWebRequest fail when compiled for the Device
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112943">[ date ]</a>
              <a href="thread.html#112943">[ thread ]</a>
              <a href="subject.html#112943">[ subject ]</a>
              <a href="author.html#112943">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
