<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 729275] New: ProgressBar: Updating progressbar control crashes app
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20729275%5D%20New%3A%20ProgressBar%3A%20Updating%20progressbar%0A%20control%20crashes%20app&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="113375.html">
   <LINK REL="Next"  HREF="113377.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 729275] New: ProgressBar: Updating progressbar control crashes app</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20729275%5D%20New%3A%20ProgressBar%3A%20Updating%20progressbar%0A%20control%20crashes%20app&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 729275] New: ProgressBar: Updating progressbar control crashes app">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Nov  9 11:45:43 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="113375.html">[Mono-bugs] [Bug 693810] Concurrent requests to ASP.NET MVC 3 web application effectively serialized
</A></li>
        <LI>Next message: <A HREF="113377.html">[Mono-bugs] [Bug 702532] DuplexClientBase Channel Initialization	Broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#113376">[ date ]</a>
              <a href="thread.html#113376">[ thread ]</a>
              <a href="subject.html#113376">[ subject ]</a>
              <a href="author.html#113376">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=729275">https://bugzilla.novell.com/show_bug.cgi?id=729275</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=729275#c0">https://bugzilla.novell.com/show_bug.cgi?id=729275#c0</A>


           Summary: ProgressBar: Updating progressbar control crashes app
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.6.x
          Platform: i686
        OS/Version: Linux
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Windows.Forms
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">nelson.novell at nelfer.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (X11; Linux x86_64; rv:7.0.1) Gecko/20100101
Firefox/7.0.1

Application: Download a file from a server
Compiled: Mono 2.6.7 as .Net 3.5
Running on Ubuntu 11.04 64bits.

I have an app that downloads a file. I have an event handler attached to the
download progress. This event handler updates the progress bar. The application
works perfectly on a Windows environment (compiled with Mono or Visual Studio).
In Linux (compiled with Mono or Visual Studio) however, sometimes the
application crashes.

To update the progress bar I'm using this code to find the proper progress bar:

ProgressBar pb=(ProgressBar)Controls.Find(&quot;DownloadProgress&quot;,true)[0];

There are other progress bars in the form as well, for other tasks to be
performed after the download.



Reproducible: Sometimes

Steps to Reproduce:
1. Create a windows forms app with a progress bar
2. Create a method that will be update the progress bar value. This method will
be an event handler.
3. Use WebClient.DownloadProgressChanged to attach it to method in point 2.
4.Use WebClient.DownloadFileAsync to start process.
Actual Results:  
Application crashes sometimes with the following error:

Download Progress 36%
Download Progress 36%
System.ArgumentException: A null reference or invalid value was found [GDI+
status: InvalidParameter]
  at System.Drawing.GDIPlus.CheckStatus (Status status) [0x00000] in &lt;filename
unknown&gt;:0 
  at System.Drawing.Region.Exclude (Rectangle rect) [0x00000] in &lt;filename
unknown&gt;:0 
  at (wrapper remoting-invoke-with-check) System.Drawing.Region:Exclude
(System.Drawing.Rectangle)
  at System.Windows.Forms.Control+DoubleBuffer.End
(System.Windows.Forms.PaintEventArgs pe) [0x00000] in &lt;filename unknown&gt;:0 
  at System.Windows.Forms.Control.WmPaint (System.Windows.Forms.Message&amp; m)
[0x00000] in &lt;filename unknown&gt;:0 
  at System.Windows.Forms.Control.WndProc (System.Windows.Forms.Message&amp; m)
[0x00000] in &lt;filename unknown&gt;:0 
  at System.Windows.Forms.Control+ControlWindowTarget.OnMessage
(System.Windows.Forms.Message&amp; m) [0x00000] in &lt;filename unknown&gt;:0 
  at System.Windows.Forms.Control+ControlNativeWindow.WndProc
(System.Windows.Forms.Message&amp; m) [0x00000] in &lt;filename unknown&gt;:0 
  at System.Windows.Forms.NativeWindow.WndProc (IntPtr hWnd, Msg msg, IntPtr
wParam, IntPtr lParam) [0x00000] in &lt;filename unknown&gt;:0 
Download Progress 37%
Download Progress 38%

Expected Results:  
Progress Bar should go from 0 to 100 (empty to full) with no crash.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="113375.html">[Mono-bugs] [Bug 693810] Concurrent requests to ASP.NET MVC 3 web application effectively serialized
</A></li>
	<LI>Next message: <A HREF="113377.html">[Mono-bugs] [Bug 702532] DuplexClientBase Channel Initialization	Broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#113376">[ date ]</a>
              <a href="thread.html#113376">[ thread ]</a>
              <a href="subject.html#113376">[ subject ]</a>
              <a href="author.html#113376">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
