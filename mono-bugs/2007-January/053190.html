<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 75526][Nor] Changed - [PATCH] StreamReader blocks	on reading too much
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075526%5D%5BNor%5D%20Changed%20-%20%5BPATCH%5D%20StreamReader%20blocks%0A%09on%20reading%20too%20much&In-Reply-To=bug-75526%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="053189.html">
   <LINK REL="Next"  HREF="053191.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 75526][Nor] Changed - [PATCH] StreamReader blocks	on reading too much</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2075526%5D%5BNor%5D%20Changed%20-%20%5BPATCH%5D%20StreamReader%20blocks%0A%09on%20reading%20too%20much&In-Reply-To=bug-75526%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 75526][Nor] Changed - [PATCH] StreamReader blocks	on reading too much">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Thu Jan 25 02:43:51 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="053189.html">[Mono-bugs] [Bug 75526][Nor] Changed - [PATCH] StreamReader blocks	on reading too much
</A></li>
        <LI>Next message: <A HREF="053191.html">[Mono-bugs] [Bug 79433][Min] Changed - [Windows - Patch] Menus	steal focus from form.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53190">[ date ]</a>
              <a href="thread.html#53190">[ thread ]</a>
              <a href="subject.html#53190">[ subject ]</a>
              <a href="author.html#53190">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gonzalo at ximian.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=75526">http://bugzilla.ximian.com/show_bug.cgi?id=75526</A>

--- shadow/75526	2007-01-25 02:29:32.000000000 -0500
+++ shadow/75526.tmp.14769	2007-01-25 02:43:51.000000000 -0500
@@ -1,13 +1,13 @@
 Bug#: 75526
 Product: Mono: Class Libraries
 Version: 1.1
 OS: All
 OS Details: 
-Status: NEW   
-Resolution: 
+Status: RESOLVED   
+Resolution: FIXED
 Severity: Unknown
 Priority: Normal
 Component: CORLIB
 AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>                            
 ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gnauck at ag-software.de</A>               
 QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
@@ -230,6 +230,38 @@
 There might be a trick to make this thing work: in ReadBuffer() we
 need to set a flag when the number of bytes read is less than the
 number of bytes requested. That means that the next read could be the
 end of the file (or could not, we won't know until we read again).
 
 I'll attach a patch as soon as I test it.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gonzalo at ximian.com</A>  2007-01-25 02:43 -------
+With this patch:
+
+Index: StreamReader.cs
+===================================================================
+--- StreamReader.cs     (revision 71577)
++++ StreamReader.cs     (working copy)
+@@ -379,6 +379,8 @@
+                                index += cch;
+                                count -= cch;
+                                chars_read += cch;
++                               if (mayBlock)
++                                       break;
+                        }
+                        return chars_read;
+                }
+
+--------------
+
+I get:
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">+gonzalo at lalo-linux</A>:/tmp $ mono miguel.exe 
+Read 8192 bytes
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">+gonzalo at lalo-linux</A>:/tmp $ mono ben.exe 
+Read
+2
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">+gonzalo at lalo-linux</A>:/tmp $ 
+
+and all corlib tests pass.
+
+This has been commited in r71650.
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="053189.html">[Mono-bugs] [Bug 75526][Nor] Changed - [PATCH] StreamReader blocks	on reading too much
</A></li>
	<LI>Next message: <A HREF="053191.html">[Mono-bugs] [Bug 79433][Min] Changed - [Windows - Patch] Menus	steal focus from form.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53190">[ date ]</a>
              <a href="thread.html#53190">[ thread ]</a>
              <a href="subject.html#53190">[ subject ]</a>
              <a href="author.html#53190">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
