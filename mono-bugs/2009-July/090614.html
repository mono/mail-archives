<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 522017] New: XSP2: Modifying the web.config causes ThreadAbortExceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20522017%5D%20New%3A%20XSP2%3A%20Modifying%20the%20web.config%20causes%0A%20ThreadAbortExceptions&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="090613.html">
   <LINK REL="Next"  HREF="090615.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 522017] New: XSP2: Modifying the web.config causes ThreadAbortExceptions</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20522017%5D%20New%3A%20XSP2%3A%20Modifying%20the%20web.config%20causes%0A%20ThreadAbortExceptions&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 522017] New: XSP2: Modifying the web.config causes ThreadAbortExceptions">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Jul 14 12:20:13 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="090613.html">[Mono-bugs] [Bug 522014] New: getting errors about resources using latest svn of Mono
</A></li>
        <LI>Next message: <A HREF="090615.html">[Mono-bugs] [Bug 522017] XSP2: Modifying the web.config causes ThreadAbortExceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90614">[ date ]</a>
              <a href="thread.html#90614">[ thread ]</a>
              <a href="subject.html#90614">[ subject ]</a>
              <a href="author.html#90614">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=522017">http://bugzilla.novell.com/show_bug.cgi?id=522017</A>


           Summary: XSP2: Modifying the web.config causes
                    ThreadAbortExceptions
    Classification: Mono
           Product: Mono: Class Libraries
           Version: SVN
          Platform: i386
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.Web
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kevin at kevinfitzgerald.net</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=305030)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=305030">http://bugzilla.novell.com/attachment.cgi?id=305030</A>)
Complete test solution to exhibit the problem

User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.6)
Gecko/2009011913 Firefox/3.0.6 (.NET CLR 3.5.30729)

With an asp.net website, when modifying its own web.config file, a
ThreadAbortException occurs while or shortly after saving. This causes
unpredictable results, including a yellow-screen-of-death and a completely
wiped-out web.config file (totally blank).

The problem appears to be related to the FileSystemWatcher(s) that watch for
changes to the website's critical files. When a change is detected (immediately
or shortly after the web.config file is modified) it appears that all active
requests are immediately aborted as the AppDomain reloads. This action causes a
major stability problem for websites that need to manage their own web.config
files.

Microsoft's implementation does not exhibit this problem. This makes me
inclined to believe that a different approach for handing AppDomain reloads is
needed. 

In this approach, when a AppDomain reload is to be performed, perhaps a flag
should be toggled, and all active requests should be allowed to finish (subject
to timeout), while delaying any new requests that come in. When all active
requests have finished, then reload the AppDomain and resume accepting new
requests. This approach may provide more stability.

Reproducible: Always

Steps to Reproduce:
Run the attached example website.
Actual Results:  
On Windows: The page executes fully and the log is displayed to the client.
On Linux with xsp2: The page aborts immediately after the first iteration's
save, and most of the time blanking-out the web.config file.

Expected Results:  
No ThreadAbortException or loss of web.config data should occur.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>





















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="090613.html">[Mono-bugs] [Bug 522014] New: getting errors about resources using latest svn of Mono
</A></li>
	<LI>Next message: <A HREF="090615.html">[Mono-bugs] [Bug 522017] XSP2: Modifying the web.config causes ThreadAbortExceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90614">[ date ]</a>
              <a href="thread.html#90614">[ thread ]</a>
              <a href="subject.html#90614">[ subject ]</a>
              <a href="author.html#90614">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
