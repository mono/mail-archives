<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 522631] New: after heavy load, mod-mono server stops serving asmx based requests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20522631%5D%20New%3A%20after%20heavy%20load%2C%0A%20mod-mono%20server%20stops%20serving%20asmx%20based%20requests&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="091081.html">
   <LINK REL="Next"  HREF="090684.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 522631] New: after heavy load, mod-mono server stops serving asmx based requests</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20522631%5D%20New%3A%20after%20heavy%20load%2C%0A%20mod-mono%20server%20stops%20serving%20asmx%20based%20requests&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 522631] New: after heavy load, mod-mono server stops serving asmx based requests">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Jul 16 06:48:59 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="091081.html">[Mono-bugs] [Bug 522624] SQL Data Adapter issues with NULL columns
</A></li>
        <LI>Next message: <A HREF="090684.html">[Mono-bugs] [Bug 522631] after heavy load, mod-mono server stops serving asmx based requests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90683">[ date ]</a>
              <a href="thread.html#90683">[ thread ]</a>
              <a href="subject.html#90683">[ subject ]</a>
              <a href="author.html#90683">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=522631">http://bugzilla.novell.com/show_bug.cgi?id=522631</A>


           Summary: after heavy load, mod-mono server stops serving asmx
                    based requests
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.4.x AddOn CD
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kuanil at novell.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


We are running iFolder server behind mod-mono server. It runs fine initially.
After couple of hours, almost 60 clients complete the connection to server and
start accessing the server concurrently. Clients request for data
synchronization and this request reaches iFolder server through mod-mono
server. Please note that there are 2 iFolder servers for this and all clients
are evenly distributed on both servers. 

When this is going on, try connecting either fresh clients or accessing a
web-service function thorugh UI, then server returns &quot;500 error&quot;. But meanwhile
other 60 clients keep on getting the service from servers and they continue
their synchronization.

We observed that: The 60 clients which are successfully getting their request
served from server are using &quot;ashx&quot; as URL to communicate with server. e.g.
they send <A HREF="https://&lt;IP">https://&lt;IP</A>&gt;/SyncHandler.ashx...  as the URL to server. But new
clients or from UI, when it calls any web-service function from server, then it
sends &quot;asmx&quot; as the request URI. e.g. it uses
<A HREF="https://&lt;IP">https://&lt;IP</A>&gt;/DomainService.asmx... 

Same asmx based calls used to work when server was started in the beginning.

&lt; Output of /var/log/apache2/access_log when server returns 500 error for asmx
based requests, Meanwhile you can see that requests with &quot;ashx&quot; passes with
200&gt;

164.99.139.56 - - [16/Jul/2009:03:19:06 -0600] &quot;GET /simias10/Simias.asmx
HTTP/1.1&quot; 500 2891 &quot;-&quot; &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
rv:1.8.1.20) Gecko/20081217 Firefox/2.0.0.20&quot;
10.200.33.19 - - [16/Jul/2009:03:19:19 -0600] &quot;POST
/simias10/DiscoveryService.asmx HTTP/1.1&quot; 500 2891
10.200.33.3 - - [16/Jul/2009:03:19:23 -0600] &quot;POST
/simias10/DiscoveryService.asmx HTTP/1.1&quot; 500 2891
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 90
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 680
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 -
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 1
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 -
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 -
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 -
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 -
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 -
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 17
10.200.33.59 - - [16/Jul/2009:03:19:26 -0600] &quot;POST /simias10/SyncHandler.ashx
HTTP/1.1&quot; 200 1


&lt;This is the 500 error shown on UI when we try to access a web-service with
&quot;asmx&quot; request&gt;

Server Error in '/simias10' Application

System.InvalidOperationException: Unsupported request format.
  at System.Web.Services.Protocols.WebServiceHandlerFactory.GetHandler
(System.Web.HttpContext context, System.String verb, System.String url,
System.String filePath) [0x00000] 
  at System.Web.HttpApplication.GetHandler (System.Web.HttpContext context,
System.String url, Boolean ignoreContextHandler) [0x00000] 
  at System.Web.HttpApplication.GetHandler (System.Web.HttpContext context,
System.String url) [0x00000] 
  at System.Web.HttpApplication+&lt;Pipeline&gt;c__Iterator2.MoveNext () [0x00000]   

----------------------------------------------------------------------------

We have modified the conf file so that the MonoMaxActiveRequests and
MonoMaxWaitingRequests is 250. We also kept looking these entries through
mod-mono control panel and number of these requests did not cross more than 28.

Once this problem comes, then there is no other way than restarting the server
to get fresh client connected.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>






























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="091081.html">[Mono-bugs] [Bug 522624] SQL Data Adapter issues with NULL columns
</A></li>
	<LI>Next message: <A HREF="090684.html">[Mono-bugs] [Bug 522631] after heavy load, mod-mono server stops serving asmx based requests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#90683">[ date ]</a>
              <a href="thread.html#90683">[ thread ]</a>
              <a href="subject.html#90683">[ subject ]</a>
              <a href="author.html#90683">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
