<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 526069] New: WebClient.DownloadData / HttpWebRequest.CheckFinalStatus generates incorrect WebException on HTTP error status
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20526069%5D%20New%3A%20WebClient.DownloadData%20/%0A%20HttpWebRequest.CheckFinalStatus%20generates%20incorrect%20WebException%20on%20HTTP%0A%20error%20status&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="091113.html">
   <LINK REL="Next"  HREF="091090.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 526069] New: WebClient.DownloadData / HttpWebRequest.CheckFinalStatus generates incorrect WebException on HTTP error status</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20526069%5D%20New%3A%20WebClient.DownloadData%20/%0A%20HttpWebRequest.CheckFinalStatus%20generates%20incorrect%20WebException%20on%20HTTP%0A%20error%20status&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 526069] New: WebClient.DownloadData / HttpWebRequest.CheckFinalStatus generates incorrect WebException on HTTP error status">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Jul 28 13:05:21 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="091113.html">[Mono-bugs] [Bug 526029] metadata-verify.c broken on big-endian	hosts
</A></li>
        <LI>Next message: <A HREF="091090.html">[Mono-bugs] [Bug 526069] WebClient.DownloadData / HttpWebRequest.CheckFinalStatus generates incorrect WebException on HTTP error status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#91088">[ date ]</a>
              <a href="thread.html#91088">[ thread ]</a>
              <a href="subject.html#91088">[ subject ]</a>
              <a href="author.html#91088">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=526069">http://bugzilla.novell.com/show_bug.cgi?id=526069</A>


           Summary: WebClient.DownloadData /
                    HttpWebRequest.CheckFinalStatus generates incorrect
                    WebException on HTTP error status
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.0.x
          Platform: PC
        OS/Version: Ubuntu
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">t8 at pobox.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US;
rv:1.9.1.1) Gecko/20090715 Firefox/3.5.1

mono 2.0.1 (instlled via apt on Ubuntu 9)

Calling WebClient.DownloadData(&quot;<A HREF="http://www.google.com/a/b/c&quot;">http://www.google.com/a/b/c&quot;</A>) throws as
WebException as expected due to the server returning a 404.

According to the MS docs, the WebException.Status prop should have the value
WebExceptionStatus.ProtocolError (and hence casting WebException.Response to
type HttpWebResponse should provide a valid HttpWebResponse.StatusCode (i.e.
404).

However, instead the WebException.Status is WebExceptionStatus.UnknownError and
it isn't possible to retrieve the HTTP response status (except by parsing it
out from the exception Message, which contains &quot;The remote server returned an
error: (404) Not Found.&quot;, or possibly via the response headers directly - which
I've not tried (yet)).

(Please note that I am a Mono *user*, not a Mono developer.  I report this for
your convenience, so please don't ask me to try a newer version of Mono or
recompile or anything like that as I do not have time available for Mono
debugging, sorry.  If further information is required and nobody else has the
resources to provide it, just close the issue).



Reproducible: Always

Steps to Reproduce:
1. Call WebClient.DownloadData(&quot;<A HREF="http://www.google.com/a/b/c&quot;">http://www.google.com/a/b/c&quot;</A>)
2. catch (WebException e)
3. Observe e.Status == WebExceptionStatus.UnknownError
Actual Results:  
e.Status == WebExceptionStatus.UnknownError

Expected Results:  
e.Status == WebExceptionStatus.ProtocolError

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="091113.html">[Mono-bugs] [Bug 526029] metadata-verify.c broken on big-endian	hosts
</A></li>
	<LI>Next message: <A HREF="091090.html">[Mono-bugs] [Bug 526069] WebClient.DownloadData / HttpWebRequest.CheckFinalStatus generates incorrect WebException on HTTP error status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#91088">[ date ]</a>
              <a href="thread.html#91088">[ thread ]</a>
              <a href="subject.html#91088">[ subject ]</a>
              <a href="author.html#91088">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
