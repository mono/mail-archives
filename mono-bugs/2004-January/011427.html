<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 53170][Nor] New - WebService hangs when trying to pass a Dataset in the parameters
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011426.html">
   <LINK REL="Next"  HREF="011393.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 53170][Nor] New - WebService hangs when trying to pass a Dataset in the parameters
   </H1>
    <B>bugzilla-daemon@bugzilla.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com"
       TITLE="[Mono-bugs] [Bug 53170][Nor] New - WebService hangs when trying to pass a Dataset in the parameters">bugzilla-daemon@bugzilla.ximian.com
       </A><BR>
    <I>Wed, 21 Jan 2004 10:03:34 -0500 (EST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="011426.html">[Mono-bugs] =?ISO-8859-1?B?WW91IGdldCBNb3JlIGZvciBoYWxmIHRoZSBwcmljZSE=?=
</A></li>
        <LI> Next message: <A HREF="011393.html">[Mono-bugs] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11427">[ date ]</a>
              <a href="thread.html#11427">[ thread ]</a>
              <a href="subject.html#11427">[ subject ]</a>
              <a href="author.html#11427">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:mono@appshelf.com.">mono@appshelf.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=53170">http://bugzilla.ximian.com/show_bug.cgi?id=53170</A>

--- shadow/53170	2004-01-21 10:03:34.000000000 -0500
+++ shadow/53170.tmp.2971	2004-01-21 10:03:34.000000000 -0500
@@ -0,0 +1,248 @@
+Bug#: 53170
+Product: Mono/Class Libraries
+Version: unspecified
+OS: Red Hat 9.0
+OS Details: RedHat 9.0, MySql 4.0, XSP, Mono 0.29, xsp 0.8
+Status: NEW   
+Resolution: 
+Severity: 
+Priority: Normal
+Component: Sys.Web.Services
+AssignedTo: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>                            
+ReportedBy: <A HREF="mailto:mono@appshelf.com">mono@appshelf.com</A>               
+QAContact: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>
+TargetMilestone: ---
+URL: 
+Cc: 
+Summary: WebService hangs when trying to pass a Dataset in the parameters
+
+Please fill in this template when reporting a bug, unless you know what 
+you are doing.
+Description of Problem:
+
+When calling a WebMethod with SOAP which passes a DataSet as a parameter, 
+it hangs and eventually returns a &quot;Operation has timed out&quot; message in 
+the Exception object.
+
+When retrieving a dataset (as a return value), the method is executed, 
+but fails to reutn any results.
+
+Note that testing the method returning the dataset via HTTP yields 
+correct results on the web page.
+
+
+Steps to reproduce the problem:
+1. Create a webmethod which 
+uses a DataSet	[WebMethod]
+	public int TestDS(DataSet ds)	{
+		return ds.Tables[0].Rows.Count;
+	}
+
+
+
+2. run it from within a windows program.
+3. wait for a while until you get a timeout.
+
+
+Actual Results:
+Additional information: Client found response content type of 'text/html; 
+charset=utf-8', but expected 'text/xml'.
+The request failed with the error message:
+--
+&lt;html&gt;
+&lt;title&gt;Error&lt;/title&gt;&lt;body bgcolor=&quot;white&quot;&gt;&lt;h1&gt;&lt;font color=&quot;red&quot;&gt;Server 
+error in '/' application&lt;/font&gt;&lt;/h1&gt;&lt;hr&gt;
+&lt;h2&gt;&lt;font color=&quot;maroon&quot;&gt;&lt;i&gt;&lt;/i&gt;&lt;/font&gt;&lt;/h2&gt;
+&lt;b&gt;Description: &lt;/b&gt;Error processing request.
+&lt;p&gt;
+&lt;b&gt;Error Message: &lt;/b&gt;
+&lt;p&gt;
+&lt;b&gt;Stack Trace: &lt;/b&gt;&lt;table summary=&quot;Stack Trace&quot; width=&quot;100%&quot; 
+bgcolor=&quot;#ffffc&quot;&gt;
+&lt;tr&gt;&lt;td&gt;&lt;code&gt;&lt;pre&gt;
+System.Threading.ThreadAbortException: Thread was being aborted&lt;br /&gt;in 
+&amp;lt;0x001f0&amp;gt; .StateMachine:ExecuteState (System.Web.
+
+HttpApplication/IStateHandler,bool&amp;amp;)&lt;br /&gt;in 
+&amp;lt;0x00161&amp;gt; .StateMachine:ExecuteNext (System.Exception)&lt;br /&gt;in 
+&amp;lt;0x00051
+
+&amp;gt; .StateMachine:ExecuteNextAsync (System.Exception)&lt;br /&gt;in 
+&amp;lt;0x00022&amp;gt; .StateMachine:Start ()&lt;br /&gt;in &amp;lt;0x0006d&amp;gt; 
+
+System.Web.HttpApplication:System.Web.IHttpAsyncHandler.BeginProcessReques
+t (System.Web.HttpContext,System.AsyncCallback,object)&lt;br 
+
+/&gt;in &amp;lt;0x001f7&amp;gt; System.Web.HttpRuntime:InternalExecuteRequest 
+(System.Web.HttpWorkerRequest)&lt;br /&gt;&lt;/pre&gt;&lt;/code&gt;
+&lt;/td&gt;&lt;/tr&gt;
+&lt;/table&gt;
+&lt;p&gt;
+&lt;hr&gt;
+&lt;/body&gt;
+&lt;/html&gt;
+&lt;!--
+System.Web.HttpException:  ---&amp;gt; System.Threading.ThreadAbortException: 
+Thread was being aborted
+in &amp;lt;0x001f0&amp;gt; .StateMachine:ExecuteState 
+(System.Web.HttpApplication/IStateHandler,bool&amp;amp;)
+in &amp;lt;0x00161&amp;gt; .StateMachine:ExecuteNext (System.Exception)
+in &amp;lt;0x00051&amp;gt; .StateMachine:ExecuteNextAsync (System.Exception)
+in &amp;lt;0x00022&amp;gt; .StateMachine:Start ()
+in &amp;lt;0x0006d&amp;gt; 
+System.Web.HttpApplication:System.Web.IHttpAsyncHandler.BeginProcessReques
+t (System.Web.HttpContext,System.
+
+AsyncCallback,object)
+in &amp;lt;0x001f7&amp;gt; System.Web.HttpRuntime:InternalExecuteRequest 
+(System.Web.HttpWorkerRequest)
+--- End of inner exception stack trace ---
+
+
+
+Expected Results:
+DataSet passed to WebMethod
+
+How often does this happen? 
+Every time I try to execute it
+
+Additional Information:
+
+The proxy generated by the web page dows not work because it declares the 
+dataset as &quot;objet&quot; which is not allowed - in order to pass a Dataset it 
+must be declared as System.Data.DataSet.
+
+
+Here is the proxy as generated by Visual Studio:
+
+//------------------------------------------------------------------------
+------
+// &lt;autogenerated&gt;
+//     This code was generated by a tool.
+//     Runtime Version: 1.1.4322.573
+//
+//     Changes to this file may cause incorrect behavior and will be lost 
+if 
+//     the code is regenerated.
+// &lt;/autogenerated&gt;
+//------------------------------------------------------------------------
+------
+
+// 
+// This source code was auto-generated by Microsoft.VSDesigner, Version 
+1.1.4322.573.
+// 
+namespace SMSSuite.BusinessLayer.SMSSuiteWS {
+    using System.Diagnostics;
+    using System.Xml.Serialization;
+    using System;
+    using System.Web.Services.Protocols;
+    using System.ComponentModel;
+    using System.Web.Services;
+    
+    
+    /// &lt;remarks/&gt;
+    [System.Diagnostics.DebuggerStepThroughAttribute()]
+    [System.ComponentModel.DesignerCategoryAttribute(&quot;code&quot;)]
+    [System.Web.Services.WebServiceBindingAttribute
+(Name=&quot;PlatformServiceSoap&quot;, Namespace=&quot;<A HREF="http://tempuri.org/"">http://tempuri.org/&quot;</A>)]
+    public class PlatformService : 
+System.Web.Services.Protocols.SoapHttpClientProtocol {
+        
+        /// &lt;remarks/&gt;
+        public PlatformService() {
+            this.Url = &quot;<A HREF="http://192.168.100.115:8080/platform.asmx";">http://192.168.100.115:8080/platform.asmx&quot;;</A>
+        }
+        
+        /// &lt;remarks/&gt;
+        [System.Web.Services.Protocols.SoapDocumentMethodAttribute
+(&quot;<A HREF="http://tempuri.org/RetrieveMessageSentUpdates",">http://tempuri.org/RetrieveMessageSentUpdates&quot;,</A> 
+
+RequestNamespace=&quot;<A HREF="http://tempuri.org/",">http://tempuri.org/&quot;,</A> 
+ResponseNamespace=&quot;<A HREF="http://tempuri.org/",">http://tempuri.org/&quot;,</A> 
+Use=System.Web.Services.Description.SoapBindingUse
+
+.Literal, 
+ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped)]
+        public System.Data.DataSet RetrieveMessageSentUpdates(string 
+ClientID) {
+            object[] results = this.Invoke(&quot;RetrieveMessageSentUpdates&quot;, 
+new object[] {
+                        ClientID});
+            return ((System.Data.DataSet)(results[0]));
+        }
+        
+        /// &lt;remarks/&gt;
+        public System.IAsyncResult BeginRetrieveMessageSentUpdates(string 
+ClientID, System.AsyncCallback callback, object 
+
+asyncState) {
+            return this.BeginInvoke(&quot;RetrieveMessageSentUpdates&quot;, new 
+object[] {
+                        ClientID}, callback, asyncState);
+        }
+        
+        /// &lt;remarks/&gt;
+        public System.Data.DataSet EndRetrieveMessageSentUpdates
+(System.IAsyncResult asyncResult) {
+            object[] results = this.EndInvoke(asyncResult);
+            return ((System.Data.DataSet)(results[0]));
+        }
+        
+        /// &lt;remarks/&gt;
+        [System.Web.Services.Protocols.SoapDocumentMethodAttribute
+(&quot;<A HREF="http://tempuri.org/SendMessages",">http://tempuri.org/SendMessages&quot;,</A> RequestNamespace=&quot;http://
+
+tempuri.org/&quot;, ResponseNamespace=&quot;<A HREF="http://tempuri.org/",">http://tempuri.org/&quot;,</A> 
+Use=System.Web.Services.Description.SoapBindingUse.Literal, 
+ParameterStyle=
+
+System.Web.Services.Protocols.SoapParameterStyle.Wrapped)]
+        public int SendMessages(System.Data.DataSet ds) {
+            object[] results = this.Invoke(&quot;SendMessages&quot;, new object[] {
+                        ds});
+            return ((int)(results[0]));
+        }
+        
+        /// &lt;remarks/&gt;
+        public System.IAsyncResult BeginSendMessages(System.Data.DataSet 
+ds, System.AsyncCallback callback, object asyncState) {
+            return this.BeginInvoke(&quot;SendMessages&quot;, new object[] {
+                        ds}, callback, asyncState);
+        }
+        
+        /// &lt;remarks/&gt;
+        public int EndSendMessages(System.IAsyncResult asyncResult) {
+            object[] results = this.EndInvoke(asyncResult);
+            return ((int)(results[0]));
+        }
+        
+        /// &lt;remarks/&gt;
+        [System.Web.Services.Protocols.SoapDocumentMethodAttribute
+(&quot;<A HREF="http://tempuri.org/TestDS",">http://tempuri.org/TestDS&quot;,</A> RequestNamespace=&quot;<A HREF="http://tempuri.">http://tempuri.</A>
+
+org/&quot;, ResponseNamespace=&quot;<A HREF="http://tempuri.org/",">http://tempuri.org/&quot;,</A> 
+Use=System.Web.Services.Description.SoapBindingUse.Literal, 
+ParameterStyle=System.
+
+Web.Services.Protocols.SoapParameterStyle.Wrapped)]
+        public int TestDS(System.Data.DataSet ds) {
+            object[] results = this.Invoke(&quot;TestDS&quot;, new object[] {
+                        ds});
+            return ((int)(results[0]));
+        }
+        
+        /// &lt;remarks/&gt;
+        public System.IAsyncResult BeginTestDS(System.Data.DataSet ds, 
+System.AsyncCallback callback, object asyncState) {
+            return this.BeginInvoke(&quot;TestDS&quot;, new object[] {
+                        ds}, callback, asyncState);
+        }
+        
+        /// &lt;remarks/&gt;
+        public int EndTestDS(System.IAsyncResult asyncResult) {
+            object[] results = this.EndInvoke(asyncResult);
+            return ((int)(results[0]));
+        }
+    }
+}

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011426.html">[Mono-bugs] =?ISO-8859-1?B?WW91IGdldCBNb3JlIGZvciBoYWxmIHRoZSBwcmljZSE=?=
</A></li>
	<LI> Next message: <A HREF="011393.html">[Mono-bugs] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11427">[ date ]</a>
              <a href="thread.html#11427">[ thread ]</a>
              <a href="subject.html#11427">[ subject ]</a>
              <a href="author.html#11427">[ author ]</a>
         </LI>
       </UL>
</body></html>
