<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 79116][Nor] Changed - SIGSEGV using win32	FormatMessage API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2079116%5D%5BNor%5D%20Changed%20-%20SIGSEGV%20using%20win32%0A%09FormatMessage%20API&In-Reply-To=bug-79116%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045800.html">
   <LINK REL="Next"  HREF="045802.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 79116][Nor] Changed - SIGSEGV using win32	FormatMessage API</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2079116%5D%5BNor%5D%20Changed%20-%20SIGSEGV%20using%20win32%0A%09FormatMessage%20API&In-Reply-To=bug-79116%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 79116][Nor] Changed - SIGSEGV using win32	FormatMessage API">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Mon Aug 21 12:33:56 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="045800.html">[Mono-bugs] [Bug 79117][Nor] Changed - Marshal.StringToHGlobalAuto	&amp; PtrToStringAuto not working as expected
</A></li>
        <LI>Next message: <A HREF="045802.html">[Mono-bugs] [Bug 79123][Nor] Changed - UnixUserInfo.ToPasswd fails	when fields are blank
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45801">[ date ]</a>
              <a href="thread.html#45801">[ thread ]</a>
              <a href="subject.html#45801">[ subject ]</a>
              <a href="author.html#45801">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">robertj at gmx.net.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=79116">http://bugzilla.ximian.com/show_bug.cgi?id=79116</A>

--- shadow/79116	2006-08-21 11:25:35.000000000 -0400
+++ shadow/79116.tmp.19506	2006-08-21 12:33:56.000000000 -0400
@@ -228,6 +228,21 @@
 
 ------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gert.driesen at pandora.be</A>  2006-08-21 11:25 -------
 It's probably the PtrToStringAuto and StringToHGlobalAuto issue (bug 
 #79117) that is also causing this SIGSEGV, and not just an issue in 
 PtrToStringAuto alone. The number of bytes returned by FormatMessage 
 is not consistent and that is before PtrToStringAuto gets involved.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">robertj at gmx.net</A>  2006-08-21 12:33 -------
+Both versions of test.cs that I've uploaded report
+
+10
+10
+drieseng
+
+like MS.NET.
+
+The problem is a discrepancy between DllImport.CharSet = CharSet.Xyz
+and PtrToStringXyz ().
+
+Using of pairwise explicit Ansi or Unicode fix the problem.
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045800.html">[Mono-bugs] [Bug 79117][Nor] Changed - Marshal.StringToHGlobalAuto	&amp; PtrToStringAuto not working as expected
</A></li>
	<LI>Next message: <A HREF="045802.html">[Mono-bugs] [Bug 79123][Nor] Changed - UnixUserInfo.ToPasswd fails	when fields are blank
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45801">[ date ]</a>
              <a href="thread.html#45801">[ thread ]</a>
              <a href="subject.html#45801">[ subject ]</a>
              <a href="author.html#45801">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
