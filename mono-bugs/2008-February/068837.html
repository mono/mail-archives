<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 352210] Serialization and deserialization of datetime to and from xml, &quot;shifts&quot; the time with the timezone
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20352210%5D%20Serialization%20and%20deserialization%20of%0A%20datetime%20to%20and%20from%20xml%2C%20%22shifts%22%20the%20time%20with%20the%20timezone&In-Reply-To=bug-352210-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="068836.html">
   <LINK REL="Next"  HREF="068838.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 352210] Serialization and deserialization of datetime to and from xml, &quot;shifts&quot; the time with the timezone</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20352210%5D%20Serialization%20and%20deserialization%20of%0A%20datetime%20to%20and%20from%20xml%2C%20%22shifts%22%20the%20time%20with%20the%20timezone&In-Reply-To=bug-352210-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 352210] Serialization and deserialization of datetime to and from xml, &quot;shifts&quot; the time with the timezone">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Feb  5 01:35:32 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="068836.html">[Mono-bugs] [Bug 352210] Serialization and deserialization of datetime to and from xml, &quot;shifts&quot; the time with the timezone
</A></li>
        <LI>Next message: <A HREF="068838.html">[Mono-bugs] [Bug 352210] Serialization and deserialization of datetime to and from xml, &quot;shifts&quot; the time with the timezone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#68837">[ date ]</a>
              <a href="thread.html#68837">[ thread ]</a>
              <a href="subject.html#68837">[ subject ]</a>
              <a href="author.html#68837">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=352210">https://bugzilla.novell.com/show_bug.cgi?id=352210</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jdpurcell2 at yahoo.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=352210#c9">https://bugzilla.novell.com/show_bug.cgi?id=352210#c9</A>





--- Comment #9 from James Purcell &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jdpurcell2 at yahoo.com</A>&gt;  2008-02-04 23:35:31 MST ---
Created an attachment (id=193152)
 --&gt; (<A HREF="https://bugzilla.novell.com/attachment.cgi?id=193152">https://bugzilla.novell.com/attachment.cgi?id=193152</A>)
tests

As requested I have attached some examples to demonstrate the bugs I'm aware of
in Mono's current DateTime parsing.  Please see the comments in the code for
descriptions of the differences in output between MS.NET and Mono.

I believe you said you were unable to reproduce the issue of parsing returning
Local kind when it should return Unspecified.  I don't understand how this is
possible after reading the code:

result = new DateTime (false, new TimeSpan (newticks));
if (explicit_kind != DateTimeKind.Unspecified)
    result.kind = explicit_kind;
else if (use_localtime)
    result = result.ToLocalTime ();
else
    result.kind = DateTimeKind.Utc;

This is where the result is finally set for NET_2_0, where it will always be
caught by one of the branches of the 'if'.  In the first case .kind is set and
will obviously never be set to Unspecified, in the second case case
ToLocalTime is used which always sets Kind to Local, and in the third case
it's set to UTC.  So there is no way that _DoParse can return successfully with
Kind set to Unspecified.

Regarding the KindPattern test, you can make it pass by adding &quot;style |=
DateTimeStyles.AdjustToUniversal;&quot; to my patch inside &quot;case 'K': if (s
[valuePos] == 'Z') {&quot;.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>






















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="068836.html">[Mono-bugs] [Bug 352210] Serialization and deserialization of datetime to and from xml, &quot;shifts&quot; the time with the timezone
</A></li>
	<LI>Next message: <A HREF="068838.html">[Mono-bugs] [Bug 352210] Serialization and deserialization of datetime to and from xml, &quot;shifts&quot; the time with the timezone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#68837">[ date ]</a>
              <a href="thread.html#68837">[ thread ]</a>
              <a href="subject.html#68837">[ subject ]</a>
              <a href="author.html#68837">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
