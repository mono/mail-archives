<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 360429] New: DateTimeFormatInfo serialization is incompatible with . NET 2.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20360429%5D%20New%3A%20DateTimeFormatInfo%20serialization%20is%0A%20incompatible%20with%20.%20NET%202.0&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="069915.html">
   <LINK REL="Next"  HREF="069164.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 360429] New: DateTimeFormatInfo serialization is incompatible with . NET 2.0</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20360429%5D%20New%3A%20DateTimeFormatInfo%20serialization%20is%0A%20incompatible%20with%20.%20NET%202.0&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 360429] New: DateTimeFormatInfo serialization is incompatible with . NET 2.0">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun Feb 10 12:56:29 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="069915.html">[Mono-bugs] [Bug 360421] [Regression] InvalidOperationException for valid SoapHttpClientProtocol
</A></li>
        <LI>Next message: <A HREF="069164.html">[Mono-bugs] [Bug 360429] DateTimeFormatInfo serialization is incompatible with .NET 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69163">[ date ]</a>
              <a href="thread.html#69163">[ thread ]</a>
              <a href="subject.html#69163">[ subject ]</a>
              <a href="author.html#69163">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=360429">https://bugzilla.novell.com/show_bug.cgi?id=360429</A>


           Summary: DateTimeFormatInfo serialization is incompatible with
                    .NET 2.0
           Product: Mono: Class Libraries
           Version: 1.2.6
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">agallero at netscape.net</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=194054)
 --&gt; (<A HREF="https://bugzilla.novell.com/attachment.cgi?id=194054">https://bugzilla.novell.com/attachment.cgi?id=194054</A>)
Small application to deserialize a DateTimeFormatInfo class

Description of Problem:
It looks like the DateTimeFormatInfo class changed in .NET 2.0 SP1 adding a new
member: dateTimeOffsetPattern that will break deserialization in mono.

I could not find much information on the issue more than this:

<A HREF="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2664127&amp;SiteID=1">http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2664127&amp;SiteID=1</A>

It affects many winforms applications created in Visual Studio that can not run
under mono without recompiling.

I am also not sure if there is a possible fix for this, if it was actually
introduced in 2.0 sp1, in order not to break non-sp1 applications.

Steps to reproduce the problem:
1) Compile and run serialize.cs in windows with .NET 2.0 sp1.  It will create
the file testdatetimeinfo.bin that is also attached.

2) Compile and run deserialize.cs in mono using gcs deserialize.exe.

Actual Results:
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">linux at linux</A>:~/test&gt; mono deserialize.exe

Unhandled Exception: System.Runtime.Serialization.SerializationException: Field
&quot;dateTimeOffsetPattern&quot; not found in class
System.Globalization.DateTimeFormatInfo
  at
System.Runtime.Serialization.Formatters.Binary.ObjectReader.ReadTypeMetadata
(System.IO.BinaryReader reader, Boolean isRuntimeObject, Boolean hasTypeInfo)
[0x00000] 
  at
System.Runtime.Serialization.Formatters.Binary.ObjectReader.ReadObjectInstance
(System.IO.BinaryReader reader, Boolean isRuntimeObject, Boolean hasTypeInfo,
System.Int64&amp; objectId, System.Object&amp; value,
System.Runtime.Serialization.SerializationInfo&amp; info) [0x00000] 
  at System.Runtime.Serialization.Formatters.Binary.ObjectReader.ReadObject
(BinaryElement element, System.IO.BinaryReader reader, System.Int64&amp; objectId,
System.Object&amp; value, System.Runtime.Serialization.SerializationInfo&amp; info)
[0x00000] 
  at System.Runtime.Serialization.Formatters.Binary.ObjectReader.ReadNextObject
(System.IO.BinaryReader reader) [0x00000] 
  at
System.Runtime.Serialization.Formatters.Binary.ObjectReader.ReadObjectGraph
(System.IO.BinaryReader reader, Boolean readHeaders, System.Object&amp; result,
System.Runtime.Remoting.Messaging.Header[]&amp; headers) [0x00000] 
  at
System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.NoCheckDeserialize
(System.IO.Stream serializationStream,
System.Runtime.Remoting.Messaging.HeaderHandler handler) [0x00000] 
  at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize
(System.IO.Stream serializationStream) [0x00000] 
  at TestDateTimeInfoDeserialization.Main () [0x00000] 


Expected Results:
No error

How often does this happen? 
Always


Additional Information:
I have found a similar bug:
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=MONO72007">https://bugzilla.novell.com/show_bug.cgi?id=MONO72007</A>
but I believe this one is different enough to have its own reports, since in
the comments of 317058 says DateTieFormatInfo has been fixed.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

























































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="069915.html">[Mono-bugs] [Bug 360421] [Regression] InvalidOperationException for valid SoapHttpClientProtocol
</A></li>
	<LI>Next message: <A HREF="069164.html">[Mono-bugs] [Bug 360429] DateTimeFormatInfo serialization is incompatible with .NET 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69163">[ date ]</a>
              <a href="thread.html#69163">[ thread ]</a>
              <a href="subject.html#69163">[ subject ]</a>
              <a href="author.html#69163">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
