<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 444431] New: SOAP remoting references inaccessible	URI
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20444431%5D%20New%3A%20SOAP%20remoting%20references%20inaccessible%0A%09URI&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="082224.html">
   <LINK REL="Next"  HREF="082276.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 444431] New: SOAP remoting references inaccessible	URI</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20444431%5D%20New%3A%20SOAP%20remoting%20references%20inaccessible%0A%09URI&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 444431] New: SOAP remoting references inaccessible	URI">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Nov 12 19:17:08 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="082224.html">[Mono-bugs] [Bug 315250] Use frndint for Math.Round
</A></li>
        <LI>Next message: <A HREF="082276.html">[Mono-bugs] [Bug 444431] SOAP remoting references inaccessible URI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82225">[ date ]</a>
              <a href="thread.html#82225">[ thread ]</a>
              <a href="subject.html#82225">[ subject ]</a>
              <a href="author.html#82225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=444431">https://bugzilla.novell.com/show_bug.cgi?id=444431</A>


           Summary: SOAP remoting references inaccessible URI
           Product: Mono: Class Libraries
           Version: 2.0
          Platform: x86-64
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jay at jcornwall.me.uk</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Community User


Created an attachment (id=251750)
 --&gt; (<A HREF="https://bugzilla.novell.com/attachment.cgi?id=251750">https://bugzilla.novell.com/attachment.cgi?id=251750</A>)
Client / Server remoting test case; use a packet tracer to observe SOAP
traffic.

Attached to this bug report is a test case that provides a client and server
for a trivial System.Runtime.Remoting call. In itself it does not trip an
exception, but a packet trace (e.g. with tcpdump or wireshark) will reveal the
problem described below. To reproduce the client and server must be run from
distinct IPs.

The SOAP protocol implemented by System.Runtime.Remoting in Mono causes
exceptions in complex RMI applications. Such an exception in a .NET client
(which is more verbose than the Mono client's exception) is shown here:

System.Net.WebException: Unable to connect to the remote server ---&gt;
System.Net.Sockets.SocketException: No connection could be made because the
target machine
actively refused it 127.0.0.1:52938
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot,
SocketAddress socketAddress)
   at System.Net.Sockets.Socket.InternalConnect(EndPoint remoteEP)
   at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure,
Socket s4, Socket s6, Socket&amp; socket, IPAddress&amp; address, ConnectSocketState
state, IAsyncResult asyncResult, Int32 timeout, Exception&amp; exception)
   --- End of inner exception stack trace ---

Server stack trace:
   at System.Net.HttpWebRequest.GetRequestStream()
   at
System.Runtime.Remoting.Channels.Http.HttpClientTransportSink.ProcessAndSend(IMessage
msg, ITransportHeaders headers, Stream inputStream)
   at
System.Runtime.Remoting.Channels.Http.HttpClientTransportSink.ProcessMessage(IMessage
msg, ITransportHeaders requestHeaders, Stream requestStream, ITransportHeaders&amp;
responseHeaders, Stream&amp; responseStream)
   at
System.Runtime.Remoting.Channels.SoapClientFormatterSink.SyncProcessMessage(IMessage
msg)

Exception rethrown at [0]:
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage
reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp;
msgData, Int32 type)
   at EthTV.Common.IRemoteInterface.GetChannels()
   at EthTV.Client.ServerControl.HandleOpenConnection(String host, Int32 port)
in C:\Users\jay\Desktop\Dev\ethtv\client\ServerControl.cs:line 124

I believe that it is caused by the Mono remoting server providing an
inaccessible URI in its responses. Here is part of a packet trace from a Mono
server and Mono client:

&lt;a2:ChannelDataStore id=&quot;ref-12&quot;
xmlns:a2=&quot;<A HREF="http://schemas.microsoft.com/clr/ns/System.Runtime.Remoting.Channels&quot;">http://schemas.microsoft.com/clr/ns/System.Runtime.Remoting.Channels&quot;</A>&gt;
  &lt;_channelURIs href=&quot;#ref-14&quot; /&gt;
  &lt;_extraData xsi:null=&quot;1&quot; /&gt;
&lt;/a2:ChannelDataStore&gt;
&lt;SOAP-ENC:Array id=&quot;ref-14&quot; SOAP-ENC:arrayType=&quot;SOAP-ENC:string[1]&quot;&gt;
  &lt;item id=&quot;ref-15&quot;&gt;<A HREF="http://127.0.0.1:8000&lt;/item">http://127.0.0.1:8000&lt;/item</A>&gt;
&lt;/SOAP-ENC:Array&gt;

And the equivalent trace with a .NET server and Mono client:

&lt;a3:ChannelDataStore id=&quot;ref-12&quot;
xmlns:a3=&quot;<A HREF="http://schemas.microsoft.com/clr/ns/System.Runtime.Remoting.Channels&quot;">http://schemas.microsoft.com/clr/ns/System.Runtime.Remoting.Channels&quot;</A>&gt;
  &lt;_channelURIs href=&quot;#ref-14&quot;/&gt;
  &lt;_extraData xsi:null=&quot;1&quot;/&gt;
&lt;/a3:ChannelDataStore&gt;
&lt;SOAP-ENC:Array id=&quot;ref-14&quot; SOAP-ENC:arrayType=&quot;xsd:string[1]&quot;&gt;
  &lt;item id=&quot;ref-15&quot;&gt;<A HREF="http://192.168.1.3:8000&lt;/item">http://192.168.1.3:8000&lt;/item</A>&gt;
&lt;/SOAP-ENC:Array&gt;

Notice how the .NET server provides its publicly accessible URI while Mono
provides a localhost (127.0.0.1) address. I am not entirely sure when this URI
is used - as this test case does not use it - but it causes exceptions in more
advanced remoting applications.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>









































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="082224.html">[Mono-bugs] [Bug 315250] Use frndint for Math.Round
</A></li>
	<LI>Next message: <A HREF="082276.html">[Mono-bugs] [Bug 444431] SOAP remoting references inaccessible URI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82225">[ date ]</a>
              <a href="thread.html#82225">[ thread ]</a>
              <a href="subject.html#82225">[ subject ]</a>
              <a href="author.html#82225">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
