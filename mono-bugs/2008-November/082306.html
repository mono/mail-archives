<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 445156] New: Monodoc doesn't handle correctly Node instances that don' t have any child nodes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20445156%5D%20New%3A%20Monodoc%20doesn%27t%20handle%20correctly%20Node%0A%20instances%20that%20don%27%20t%20have%20any%20child%20nodes&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="082305.html">
   <LINK REL="Next"  HREF="082462.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 445156] New: Monodoc doesn't handle correctly Node instances that don' t have any child nodes</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20445156%5D%20New%3A%20Monodoc%20doesn%27t%20handle%20correctly%20Node%0A%20instances%20that%20don%27%20t%20have%20any%20child%20nodes&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 445156] New: Monodoc doesn't handle correctly Node instances that don' t have any child nodes">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Nov 14 11:14:22 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="082305.html">[Mono-bugs] [Bug 445130] TreeView ExpandAll() is very slow
</A></li>
        <LI>Next message: <A HREF="082462.html">[Mono-bugs] [Bug 445156] Monodoc doesn't handle correctly Node instances that don' t have any child nodes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82306">[ date ]</a>
              <a href="thread.html#82306">[ thread ]</a>
              <a href="subject.html#82306">[ subject ]</a>
              <a href="author.html#82306">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=445156">https://bugzilla.novell.com/show_bug.cgi?id=445156</A>


           Summary: Monodoc doesn't handle correctly Node instances that
                    don't have any child nodes
           Product: Mono: Doctools
           Version: SVN
          Platform: x86
        OS/Version: Ubuntu
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: Core
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mario.sopena at gmail.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">etienne.fortin at sympatico.ca</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Development


Description of Problem:
This problem manifested itself while trying latest revision of Monodevelop from
SVN repository. When starting I get this message. After splash screen MD will
vanish:

System.TypeInitializationException: An exception was thrown by the type
initializer for MonoDevelop.Projects.Dom.Parser.ProjectDomService ---&gt;
System.NullReferenceException: Object reference not set to an instance of an
object
  at Monodoc.RootTree.LoadTree (System.String basedir) [0x0025c] in
/tmp/mono2-build.21095/monobuild/monodoc-117204/engine/provider.cs:851 
  at Monodoc.RootTree.LoadTree () [0x0005c] in
/tmp/mono2-build.21095/monobuild/monodoc-117204/engine/provider.cs:761 
  at MonoDevelop.Projects.Dom.Parser.ProjectDomService..cctor () [0x00000]
in
/tmp/mono2-build.964/monobuild/md-svn/main/src/core/MonoDevelop.Projects/MonoDevelop.Projects.CodeGeneration/BaseRefactorer.cs:1 
  --- End of inner exception stack trace ---
  at MonoDevelop.Ide.Gui.Pads.ClassPad.ProjectNodeBuilder.Initialize ()
[0x00017] in
/tmp/mono2-build.964/monobuild/md-svn/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Gui.Pads.ClassPad/ProjectNodeBuilder.cs:57 
  at MonoDevelop.Ide.Gui.Components.NodeBuilder.SetContext
(ITreeBuilderContext context) [0x00007] in
/tmp/mono2-build.964/monobuild/md-svn/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Gui.Components/NodeBuilder.cs:47 


Steps to reproduce the problem:
1. Compile latest revision of Monodoc or use latest package.
2. Compile latest revision of Monodevelop or use latest package.
3. Launch Monodevelop.
4. After the splash screen, Monodevelop will crash in Monodoc with a above
descripbed error.


Actual Results:
Crash after splash screen.

Expected Results:
Monodevelop finish booting and works.


How often does this happen? 
Every time Monodevelop is launched.


Additional Information:
The place where the NullReferenceException comes from is the following line
in provider.cs (@851), in LoadTree() method of RootTree class:

..
NullRef ---&gt;            foreach (Node n in hs.Tree.Nodes){
                                        parent.AddNode (n);
                                }
..

It can be hs that is null (HelpSource). I verified, it can't. It can be
hs.Tree. I verified, it can't. Then only Nodes property can return null. If
you look at the LoadNodes() method of the Node class...

..
        public void LoadNode ()
        {
                if (position &lt; 0)
                        position = -position;

                tree.InputStream.Position = position;
                BinaryReader reader = tree.InputReader;
                int count = DecodeInt (reader);
                element = reader.ReadString ();
                caption = reader.ReadString ();
---&gt;            if (count == 0)
                        return;

                nodes = new ArrayList (count);
                for (int i = 0; i &lt; count; i++){
                        int child_address = DecodeInt (reader);

                        Node t = new Node (this, -child_address);
                        nodes.Add (t);
                }
        }
..

You see there's the if(count == 0) line. So if count == 0, meaning there's
no nodes attached to that node (I guess it's a valid situation, no childs),
then Nodes will be null. I commented out this if, compiled Monodoc again, et
voil&#224;! it works. Now if there's no node, Nodes = new ArrayList(0).


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="082305.html">[Mono-bugs] [Bug 445130] TreeView ExpandAll() is very slow
</A></li>
	<LI>Next message: <A HREF="082462.html">[Mono-bugs] [Bug 445156] Monodoc doesn't handle correctly Node instances that don' t have any child nodes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82306">[ date ]</a>
              <a href="thread.html#82306">[ thread ]</a>
              <a href="subject.html#82306">[ subject ]</a>
              <a href="author.html#82306">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
