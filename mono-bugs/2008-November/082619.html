<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 364488] Handling OnEnter event by selecting a child control causes stack overflow
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20364488%5D%20Handling%20OnEnter%20event%20by%20selecting%20a%0A%20child%20control%20causes%20stack%20overflow&In-Reply-To=bug-364488-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="082618.html">
   <LINK REL="Next"  HREF="082620.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 364488] Handling OnEnter event by selecting a child control causes stack overflow</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20364488%5D%20Handling%20OnEnter%20event%20by%20selecting%20a%0A%20child%20control%20causes%20stack%20overflow&In-Reply-To=bug-364488-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 364488] Handling OnEnter event by selecting a child control causes stack overflow">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun Nov 23 11:47:34 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="082618.html">[Mono-bugs] [Bug 427866] Some WebBrowser fields are initially	unresponsive
</A></li>
        <LI>Next message: <A HREF="082620.html">[Mono-bugs] [Bug 364488] Handling OnEnter event by selecting a child control causes stack overflow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82619">[ date ]</a>
              <a href="thread.html#82619">[ thread ]</a>
              <a href="subject.html#82619">[ subject ]</a>
              <a href="author.html#82619">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=364488">https://bugzilla.novell.com/show_bug.cgi?id=364488</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">avidigal at novell.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=364488#c3">https://bugzilla.novell.com/show_bug.cgi?id=364488#c3</A>


Andreia Gaita &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">avidigal at novell.com</A>&gt; changed:

           What    |Removed                                         |Added
----------------------------------------------------------------------------
             Status|NEW                                             |RESOLVED
         Resolution|                                                |INVALID




--- Comment #3 from Andreia Gaita &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">avidigal at novell.com</A>&gt;  2008-11-23 09:47:34 MST ---
Good thing that it does, too. 

Notes for future reference, because this really needs to be written down
somewhere...

On your example:

1) OnEnter is called when focus is set to the textBox control (if this is the
first Enter event, it's because textBox is the first innermost child, so it
gets set by default. If this is not the first time OnEnter is called, welcome
to infinite loop hell).

2)You then set focus to the listBox via a Select call. This makes the focus
handling code start from the beginning, i.e., generate Enter calls from the top
again.

3) The panel receives an Enter event because of 2), which activates listBox via
a Select call. Since listBox is already activated, it does nothing and goes on
to the next Select call, which activates the textBox. Goto 1), rinse, repeat ad
nauseaum

So why does the panel always get an Enter event when the only thing you're
doing is changing which panel child is focused? All the controls are inside the
Panel, so the focus should always be in the panel no matter what child is
selected, right?

Well, it just so happens that although Panel can have child controls, it is not
a ContainerControl, it's just a regular Control. Only ContainerControls can get
to have special handling code to control how their children are focused, and
all Enter/Leave events are fired from the top of the chain - top being up
until, but not including, the ContainerControl which is the parent of the
control that's getting entered. This last part is important, because it means
that ContainerControls only get Enter/Leave events fired if the focus is
switching to another ContainerControl.

This means that if you had put your three controls (text, button and list)
inside a UserControl instead of a Panel, it would not go into an infinite loop,
because the Enter event would be fired the first time (when focus is set by
default to the textbox), and it would never be fired again until for some
reason you made the focus go away to another container - let's say by forcing
focus on the top Form, which would cause a Leave event on the UserControl, then
an Enter event again on it (because all the focusable controls of the Form
would be inside the UserControl in our little example).

By the way, it's not possible to make a ContainerControl (like a Form or a
UserControl) the primary focused control of an app, since it's focus handling
code automatically forces focus on the first focuseable child.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>




















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="082618.html">[Mono-bugs] [Bug 427866] Some WebBrowser fields are initially	unresponsive
</A></li>
	<LI>Next message: <A HREF="082620.html">[Mono-bugs] [Bug 364488] Handling OnEnter event by selecting a child control causes stack overflow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82619">[ date ]</a>
              <a href="thread.html#82619">[ thread ]</a>
              <a href="subject.html#82619">[ subject ]</a>
              <a href="author.html#82619">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
