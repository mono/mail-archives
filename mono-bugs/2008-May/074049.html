<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 322163] runtime hangs after main() exit
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20322163%5D%20runtime%20hangs%20after%20main%28%29%20exit&In-Reply-To=bug-322163-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="074046.html">
   <LINK REL="Next"  HREF="074050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 322163] runtime hangs after main() exit</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20322163%5D%20runtime%20hangs%20after%20main%28%29%20exit&In-Reply-To=bug-322163-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 322163] runtime hangs after main() exit">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon May 19 18:50:35 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="074046.html">[Mono-bugs] [Bug 371905] TabControl UserPaint does not work
</A></li>
        <LI>Next message: <A HREF="074050.html">[Mono-bugs] [Bug 322163] runtime hangs after main() exit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74049">[ date ]</a>
              <a href="thread.html#74049">[ thread ]</a>
              <a href="subject.html#74049">[ subject ]</a>
              <a href="author.html#74049">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=322163">https://bugzilla.novell.com/show_bug.cgi?id=322163</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">vargaz at gmail.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=322163#c13">https://bugzilla.novell.com/show_bug.cgi?id=322163#c13</A>





--- Comment #13 from Zoltan Varga &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">vargaz at gmail.com</A>&gt;  2008-05-19 16:50:34 MST ---
Shutting down a managed runtime is not easy, see 
<A HREF="http://blogs.msdn.com/cbrumme/archive/2003/08/20/51504.aspx">http://blogs.msdn.com/cbrumme/archive/2003/08/20/51504.aspx</A>
for a discussion of how the MS.NET runtime does it. Basically, we could just
call libc exit () and be done with it, but people expect finalizers to be
called
etc. Some people even expect us to clean up all memory used by the runtime.
Since cleaning up runtime memory structures while some threads are running
which use them is not wise, we need to (at least) suspend all managed threads. 
suspending threads is again not easy, since unix has no SuspendThread call like 
win32 does, if a thread is suspended while holding some lock, the whole stuff 
could deadlock. So this is not a simple problem at all, and I'm not suprised
that 
there are bugs. Also, as I said, f-spot is not a simple program, so it might 
itself hang even when the runtime shutdown code works fine.

For a quick-and-dirty solution, you could try patching f-spot so instead of
calling Environment.Exit (), it would pinvoke the libc exit () function. That
would most likely work, except when some library like gtk installs an atexit ()
handler which does some strange thing and crashes/hangs...


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>




























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="074046.html">[Mono-bugs] [Bug 371905] TabControl UserPaint does not work
</A></li>
	<LI>Next message: <A HREF="074050.html">[Mono-bugs] [Bug 322163] runtime hangs after main() exit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74049">[ date ]</a>
              <a href="thread.html#74049">[ thread ]</a>
              <a href="subject.html#74049">[ subject ]</a>
              <a href="author.html#74049">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
