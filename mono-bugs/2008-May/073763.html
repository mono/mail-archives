<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 389814] New: [crash] double-free at	MediaBase::SetSource
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20389814%5D%20New%3A%20%5Bcrash%5D%20double-free%20at%0A%09MediaBase%3A%3ASetSource&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="073762.html">
   <LINK REL="Next"  HREF="073796.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 389814] New: [crash] double-free at	MediaBase::SetSource</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20389814%5D%20New%3A%20%5Bcrash%5D%20double-free%20at%0A%09MediaBase%3A%3ASetSource&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 389814] New: [crash] double-free at	MediaBase::SetSource">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue May 13 09:58:26 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="073762.html">[Mono-bugs] [Bug 344333] System.Timers.Timer gets very slow on smp	machine
</A></li>
        <LI>Next message: <A HREF="073796.html">[Mono-bugs] [Bug 389814] [crash] double-free at MediaBase::SetSource
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73763">[ date ]</a>
              <a href="thread.html#73763">[ thread ]</a>
              <a href="subject.html#73763">[ subject ]</a>
              <a href="author.html#73763">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=389814">https://bugzilla.novell.com/show_bug.cgi?id=389814</A>


           Summary: [crash] double-free at MediaBase::SetSource
           Product: Moonlight
           Version: 1.0.0
          Platform: x86
        OS/Version: Linux
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: media
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">fherrera at novell.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Development


When parsing a rtsp:// uri (which should fallback to http) we hit a doble-free.
Use a MediaElemente like this:
&lt;MediaElement x:Name=&quot;mPlayer&quot; Width=&quot;640&quot; Height=&quot;480&quot;
Source=&quot;<A HREF="rtsp://fer.name/mms/timecode-long.wmv&quot;/">rtsp://fer.name/mms/timecode-long.wmv&quot;/</A>&gt;

#0  0x003cb832 in _dl_sysinfo_int80 () from /lib/ld-linux.so.2
#1  0x00b87690 in raise () from /lib/libc.so.6
#2  0x00b88f91 in abort () from /lib/libc.so.6
#3  0x00bbf9eb in __libc_message () from /lib/libc.so.6
#4  0x00bc7ac1 in _int_free () from /lib/libc.so.6
#5  0x00bcb0f0 in free () from /lib/libc.so.6
#6  0x00986e61 in IA__g_free (mem=0x9dfdfa8) at gmem.c:190
#7  0x04ff3408 in MediaBase::SetSource (this=0x9dfd9f0, downloader=0x9dfb030,
PartName=0x53c07e5 &quot;&quot;) at media.cpp:146
#8  0x04ff353d in MediaElement::SetSource (this=0x9dfd9f0,
downloader=0x9dfb030, PartName=0x53c07e5 &quot;&quot;) at media.cpp:1356
#9  0x04ff05f1 in MediaElement::DownloaderFailed (this=0x9dfd9f0,
args=0x9dfafc0) at media.cpp:1238
#10 0x04fec579 in MediaBase::downloader_failed (sender=0x9dfe380,
calldata=0x9dfafc0, closure=0x9dfd9f0) at media.cpp:72
#11 0x04fd7733 in EventObject::Emit (this=0x9dfe380, event_id=2,
calldata=0x9dfafc0, only_unemitted=false) at dependencyobject.cpp:410
#12 0x04fda512 in Downloader::NotifyFailed (this=0x9dfe380, msg=0x1b87843
&quot;generic error&quot;) at downloader.cpp:548
#13 0x01b1fb48 in p_downloader_send (state=0x9dfe410) at
plugin-downloader.cpp:246
#14 0x04fda66e in Downloader::SendInternal (this=0x9dfe380) at
downloader.cpp:441
#15 0x04fda6c2 in Downloader::SendNow (this=0x9dfe380) at downloader.cpp:476
#16 0x04ff33a8 in MediaElement::SetSourceInternal (this=0x9dfd9f0,
downloader=0x9dfe380, PartName=0x9dfdfa8 &quot;&#65533;&#65533;&#65533;\ted&quot;) at media.cpp:1335
#17 0x04fee315 in MediaBase::SetSourceAsyncCallback (this=0x9dfd9f0) at
media.cpp:112
#18 0x04fee369 in set_source_async (user_data=0x9dfd9f0) at media.cpp:133
#19 0x0097fa96 in g_timeout_dispatch (source=0x9dfe518, callback=0x6,
user_data=0x9dfd9f0) at gmain.c:3443
#20 0x0097f353 in IA__g_main_context_dispatch (context=0x8cffc18) at
gmain.c:2009
#21 0x00982533 in g_main_context_iterate (context=0x8cffc18, block=1,
dispatch=1, self=0x8cdf868) at gmain.c:2642
#22 0x00982887 in IA__g_main_loop_run (loop=0x9053478) at gmain.c:2850
#23 0x006bd6d4 in IA__gtk_main () at gtkmain.c:1161
#24 0x00f87087 in nsAppShell::Run () from
/opt/gnome224/lib/firefox-2.0.0.14/components/libwidget_gtk2.so
#25 0x01016e97 in nsAppStartup::Run () from
/opt/gnome224/lib/firefox-2.0.0.14/components/libtoolkitcomps.so
#26 0x0804f795 in XRE_main ()
#27 0x0804aa83 in main ()


#7  0x04ff3408 in MediaBase::SetSource (this=0x9dfd9f0, downloader=0x9dfb030,
PartName=0x53c07e5 &quot;&quot;) at media.cpp:146
146                     g_free (source.part_name);
(gdb) p source.part_name
$1 = 0x9dfdfa8 &quot;&#65533;&#65533;&#65533;\ted&quot;

source.part_name was pointing to media-&gt;part_name which was freeed already


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>
































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="073762.html">[Mono-bugs] [Bug 344333] System.Timers.Timer gets very slow on smp	machine
</A></li>
	<LI>Next message: <A HREF="073796.html">[Mono-bugs] [Bug 389814] [crash] double-free at MediaBase::SetSource
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73763">[ date ]</a>
              <a href="thread.html#73763">[ thread ]</a>
              <a href="subject.html#73763">[ subject ]</a>
              <a href="author.html#73763">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
