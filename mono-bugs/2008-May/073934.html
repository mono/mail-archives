<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 322164] ANSI strings are UTF-8 but should be in ANSI code page on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20322164%5D%20ANSI%20strings%20are%20UTF-8%20but%20should%20be%20in%0A%20ANSI%20code%20page%20on%20Windows&In-Reply-To=bug-322164-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="073933.html">
   <LINK REL="Next"  HREF="073935.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 322164] ANSI strings are UTF-8 but should be in ANSI code page on Windows</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20322164%5D%20ANSI%20strings%20are%20UTF-8%20but%20should%20be%20in%0A%20ANSI%20code%20page%20on%20Windows&In-Reply-To=bug-322164-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 322164] ANSI strings are UTF-8 but should be in ANSI code page on Windows">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri May 16 07:48:00 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="073933.html">[Mono-bugs] [Bug 391286] New: Several issues with	AspNetSqlMembershipProvider
</A></li>
        <LI>Next message: <A HREF="073935.html">[Mono-bugs] [Bug 385006] Running mono in a Xen domU fills syslog with &quot;4gb seg fixup&quot; messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73934">[ date ]</a>
              <a href="thread.html#73934">[ thread ]</a>
              <a href="subject.html#73934">[ subject ]</a>
              <a href="author.html#73934">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=322164">https://bugzilla.novell.com/show_bug.cgi?id=322164</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kornelpal at gmail.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=322164#c1">https://bugzilla.novell.com/show_bug.cgi?id=322164#c1</A>


Korn&#233;l P&#225;l &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kornelpal at gmail.com</A>&gt; changed:

           What    |Removed                                         |Added
----------------------------------------------------------------------------
             Status|RESOLVED                                        |REOPENED
         OS/Version|All                                             |Windows
         Resolution|INVALID                                         |
            Summary|ANSI strings are UTF-8 but should be in native  |ANSI strings are UTF-8 but should be in ANSI
                   |encoding                                        |code page on Windows




--- Comment #1 from Korn&#233;l P&#225;l &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kornelpal at gmail.com</A>&gt;  2008-05-16 05:48:00 MST ---
I agree to map ANSI encoding to UTF-8 on operating systems other than Windows.

On Windows we should however use the ANSI encoding of the operating system.
ANSI code page is an operating system wide setting for compatibility with
legacy applications but Windows 9x lacked Unicode support and a lot NT
applications (even new developments) use the ANSI code page rather than
Unicode.

ANSI code page is returned by GetACP
(<A HREF="http://msdn.microsoft.com/en-us/library/ms776259.aspx">http://msdn.microsoft.com/en-us/library/ms776259.aspx</A>) but CP_ACP can be used
for functions using code pages like WideCharToMultiByte.

Using UTF-8 on Windows instead of ANSI code page results in wrong character
conversions because string usually means string encoded in ANSI code on
Windows.

Also note that the runtime is affected as well. C runtime functions expect ANSI
code page while glib functions expect UTF-8. The way to go is to use UTF-8 for
char* and use the Unicode (UTF-16) versions of Windows API functions. The only
think that should be changed is to avoid C runtime functions that call Windows
API because the get an UTF-8 string but the C runtime converts that to UTF-16
using ANSI code page that even can result in security problems.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>













































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="073933.html">[Mono-bugs] [Bug 391286] New: Several issues with	AspNetSqlMembershipProvider
</A></li>
	<LI>Next message: <A HREF="073935.html">[Mono-bugs] [Bug 385006] Running mono in a Xen domU fills syslog with &quot;4gb seg fixup&quot; messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73934">[ date ]</a>
              <a href="thread.html#73934">[ thread ]</a>
              <a href="subject.html#73934">[ subject ]</a>
              <a href="author.html#73934">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
