<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 491508] New: SessionSQLServerHandler : InitializeConnection -&gt; NullReferenceException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20491508%5D%20New%3A%20SessionSQLServerHandler%20%3A%0A%20InitializeConnection%20-%3E%20NullReferenceException&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088060.html">
   <LINK REL="Next"  HREF="087585.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 491508] New: SessionSQLServerHandler : InitializeConnection -&gt; NullReferenceException</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20491508%5D%20New%3A%20SessionSQLServerHandler%20%3A%0A%20InitializeConnection%20-%3E%20NullReferenceException&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 491508] New: SessionSQLServerHandler : InitializeConnection -&gt; NullReferenceException">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Apr  2 10:02:06 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="088060.html">[Mono-bugs] [Bug 491490] [generics] gmcs generates invalid code for comparison with default()
</A></li>
        <LI>Next message: <A HREF="087585.html">[Mono-bugs] [Bug 491508] SessionSQLServerHandler : InitializeConnection -&gt; NullReferenceException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87543">[ date ]</a>
              <a href="thread.html#87543">[ thread ]</a>
              <a href="subject.html#87543">[ subject ]</a>
              <a href="author.html#87543">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=491508">http://bugzilla.novell.com/show_bug.cgi?id=491508</A>


           Summary: SessionSQLServerHandler : InitializeConnection -&gt;
                    NullReferenceException
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.4.x
          Platform: Other
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.Web
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">informatique.internet at fiducial.fr</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=283694)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=283694">http://bugzilla.novell.com/attachment.cgi?id=283694</A>)
this patch should fix this problem... it has been applied on our mono 2.0
production server

User-Agent:       Mozilla/5.0 (X11; U; Linux i686; fr-FR; rv:1.9.0.8)
Gecko/2009032608 Firefox/3.0.8

A NullReferenceException can happens in the SessionSQLServerHandler if :

The database is crashed or unavailable : a SessionSQLServerHandler object is
created, Init is called -&gt; InitializeConnection throw exception and cnc is
nullified.
Just after the database is available but the SessionSQLServerHandler object is
still alive. and it can't recreate the connection (cnc object) because it is
null



Reproducible: Always

Steps to Reproduce:
1. Shut off you session sql database
2. Launch xsp -&gt; Get index.aspx -&gt; You get an exception -&gt; Normal
3. Switch on your session sql database
4. Get index.aspx
Actual Results:  
you'll get this kind of exception
System.NullReferenceException: Object reference not set to an instance of an
object
  at System.Web.SessionState.SessionSQLServerHandler.InitializeConnection ()
[0x00000] 
  at System.Web.SessionState.SessionSQLServerHandler.GetReaderWithRetry
(System.String id) [0x00000] 
  at System.Web.SessionState.SessionSQLServerHandler.SelectSession
(System.String id, Boolean read_only) [0x00000] 
  at System.Web.SessionState.SessionSQLServerHandler.UpdateContext
(System.Web.HttpContext context, System.Web.SessionState.SessionStateModule
module, Boolean required, Boolean read_only, System.Boolean&amp; isNew) [0x00000] 
  at System.Web.SessionState.SessionStateModule.OnAcquireState (System.Object
o, System.EventArgs args) [0x00000] 
  at System.Web.HttpApplication+&lt;RunHooks&gt;c__Iterator0.MoveNext () [0x00000] 
  at System.Web.HttpApplication+&lt;Pipeline&gt;c__Iterator1.MoveNext () [0x00000] 
  at System.Web.HttpApplication.Tick () [0x00000] 

Expected Results:  
It should work

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088060.html">[Mono-bugs] [Bug 491490] [generics] gmcs generates invalid code for comparison with default()
</A></li>
	<LI>Next message: <A HREF="087585.html">[Mono-bugs] [Bug 491508] SessionSQLServerHandler : InitializeConnection -&gt; NullReferenceException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87543">[ date ]</a>
              <a href="thread.html#87543">[ thread ]</a>
              <a href="subject.html#87543">[ subject ]</a>
              <a href="author.html#87543">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
