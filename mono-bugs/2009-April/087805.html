<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 494639] New: ContextMenuStrip/ToolStripMenuItem crashes when pressing ESC.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20494639%5D%20New%3A%20ContextMenuStrip/ToolStripMenuItem%0A%20crashes%20when%20pressing%20ESC.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="087802.html">
   <LINK REL="Next"  HREF="087806.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 494639] New: ContextMenuStrip/ToolStripMenuItem crashes when pressing ESC.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20494639%5D%20New%3A%20ContextMenuStrip/ToolStripMenuItem%0A%20crashes%20when%20pressing%20ESC.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 494639] New: ContextMenuStrip/ToolStripMenuItem crashes when pressing ESC.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Apr 14 07:44:09 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="087802.html">[Mono-bugs] [Bug 435906] fatal errors in GC: too many heap sections
</A></li>
        <LI>Next message: <A HREF="087806.html">[Mono-bugs] [Bug 494639] ContextMenuStrip/ToolStripMenuItem crashes when pressing ESC.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87805">[ date ]</a>
              <a href="thread.html#87805">[ thread ]</a>
              <a href="subject.html#87805">[ subject ]</a>
              <a href="author.html#87805">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=494639">http://bugzilla.novell.com/show_bug.cgi?id=494639</A>


           Summary: ContextMenuStrip/ToolStripMenuItem crashes when
                    pressing ESC.
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.4.x
          Platform: x86
        OS/Version: Windows Vista
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Windows.Forms
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">albin at sunnanbo.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Development


Created an attachment (id=285555)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=285555">http://bugzilla.novell.com/attachment.cgi?id=285555</A>)
Minimal case to reproduce the problem

Description of Problem:
When opening an ContextMenuStrip with a ToolStripMenuItem and then pressing ESC
the runtime throws an unhandled exception.

Steps to reproduce the problem:
1. Start the attached application. A context menu is shown.
2. Press ESC on the keyboard: The application crashes.


Actual Results:
An unhandled exception is thrown.
In the example code the following exception is shown in a message box.

---------------------------

---------------------------
System.NullReferenceException: Object reference not set to an instance of an
object
  at System.Windows.Forms.ToolStripDropDown.ProcessArrowKey (Keys keyData)
[0x00000] 
  at System.Windows.Forms.ToolStrip.ProcessDialogKey (Keys keyData) [0x00000] 
  at System.Windows.Forms.ToolStripDropDown.ProcessDialogKey (Keys keyData)
[0x00000] 
  at System.Windows.Forms.Control.InternalPreProcessMessage
(System.Windows.Forms.Message&amp; msg) [0x00000] 
  at System.Windows.Forms.Control.PreProcessMessage
(System.Windows.Forms.Message&amp; msg) [0x00000] 
  at System.Windows.Forms.Control.PreProcessControlMessageInternal
(System.Windows.Forms.Message&amp; msg) [0x00000] 
  at (wrapper remoting-invoke-with-check)
System.Windows.Forms.Control:PreProcessControlMessageInternal
(System.Windows.Forms.Message&amp;)
  at System.Windows.Forms.Application.RunLoop (Boolean Modal,
System.Windows.Forms.ApplicationContext context) [0x00000] 
  at System.Windows.Forms.Application.Run
(System.Windows.Forms.ApplicationContext context) [0x00000] 
  at System.Windows.Forms.Application.Run (System.Windows.Forms.Form mainForm)
[0x00000] 
  at MonoContextMenuBug.CrashMonoForm.Main () [0x00000] 
---------------------------
OK   
---------------------------


Expected Results:
The context menu should close, nothing else.

How often does this happen? 
Always

Additional Information:
This minimal case is reproduced on Mono 2.4 on Windows Vista with the binary
compiled with Visual Studio 2008 SP1.
Our real application has crashed on older versions of Mono on both Windows and
Linux platforms.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>














































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="087802.html">[Mono-bugs] [Bug 435906] fatal errors in GC: too many heap sections
</A></li>
	<LI>Next message: <A HREF="087806.html">[Mono-bugs] [Bug 494639] ContextMenuStrip/ToolStripMenuItem crashes when pressing ESC.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87805">[ date ]</a>
              <a href="thread.html#87805">[ thread ]</a>
              <a href="subject.html#87805">[ subject ]</a>
              <a href="author.html#87805">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
