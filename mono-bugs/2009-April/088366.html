<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 499864] New: Dispose-Method of Mono.Data.SqliteClient.SqliteConnection doesn't close the connection.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20499864%5D%20New%3A%20Dispose-Method%20of%0A%20Mono.Data.SqliteClient.SqliteConnection%20doesn%27t%20close%20the%20connection.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088365.html">
   <LINK REL="Next"  HREF="088368.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 499864] New: Dispose-Method of Mono.Data.SqliteClient.SqliteConnection doesn't close the connection.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20499864%5D%20New%3A%20Dispose-Method%20of%0A%20Mono.Data.SqliteClient.SqliteConnection%20doesn%27t%20close%20the%20connection.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 499864] New: Dispose-Method of Mono.Data.SqliteClient.SqliteConnection doesn't close the connection.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Apr 30 13:29:00 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="088365.html">[Mono-bugs] [Bug 499851] Need notification for UIA when a FileDialog combo box's selection changes
</A></li>
        <LI>Next message: <A HREF="088368.html">[Mono-bugs] [Bug 499887] New: TabControl.Focus event not fired when SelectionIndex is set
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88366">[ date ]</a>
              <a href="thread.html#88366">[ thread ]</a>
              <a href="subject.html#88366">[ subject ]</a>
              <a href="author.html#88366">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=499864">http://bugzilla.novell.com/show_bug.cgi?id=499864</A>


           Summary: Dispose-Method of
                    Mono.Data.SqliteClient.SqliteConnection doesn't close
                    the connection.
    Classification: Mono
           Product: Mono: Class Libraries
           Version: SVN
          Platform: x86-64
        OS/Version: Linux
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Mono.Data.Sqlite
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">daniel at hofmannmail.ath.cx</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.7)
Gecko/2009030810 Iceweasel/3.0.7 (Debian-3.0.7-1)

There's no component for the old Sqlite-Bindings (Mono.Data.SqliteClient), only
the new Mono.Data.Sqlite. Anyway, this bug concerns only the old!
Sqlite-bindings and is easily worked around:

The following testcase shows the problem. On my system this results in an
exception because no more handles can be allocated. Calling Close () manually
is an easy workaround, that makes the exception disappear in the example.

Compile with:
gmcs gert.cs -r:System.Data -r:Mono.Data.SqliteClient

public class M {
  public static void Main () {
    for (int i = 0; i &lt; 10000; i++) {
      using (System.Data.IDbConnection conn = new
Mono.Data.SqliteClient.SqliteConnection ()) {
        conn.ConnectionString = &quot;version=3,mode=600,URI=file:/tmp/testdb&quot;;
        conn.Open ();
        using (System.Data.IDbCommand c = conn.CreateCommand ()) {
          c.CommandText = &quot;CREATE TABLE IF NOT EXISTS a (id INTEGER);&quot;;
          c.ExecuteNonQuery ();
        }
        //conn.Close ();
      }
    }

    //System.Diagnostics.Process.Start (&quot;sh -c 'ls -l /proc/$PPID/fd/ | wc
-l'&quot;).WaitForExit ();
  }
}

The problem also persists on r133188 from trunk.

Reproducible: Always

Steps to Reproduce:
1.
2.
3.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088365.html">[Mono-bugs] [Bug 499851] Need notification for UIA when a FileDialog combo box's selection changes
</A></li>
	<LI>Next message: <A HREF="088368.html">[Mono-bugs] [Bug 499887] New: TabControl.Focus event not fired when SelectionIndex is set
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88366">[ date ]</a>
              <a href="thread.html#88366">[ thread ]</a>
              <a href="subject.html#88366">[ subject ]</a>
              <a href="author.html#88366">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
