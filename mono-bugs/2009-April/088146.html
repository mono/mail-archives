<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 497848] New: ReaderWriterLock: ReaderLocks do not appear to block WriterLocks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20497848%5D%20New%3A%20ReaderWriterLock%3A%20ReaderLocks%20do%20not%0A%20appear%20to%20block%20WriterLocks&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088221.html">
   <LINK REL="Next"  HREF="088159.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 497848] New: ReaderWriterLock: ReaderLocks do not appear to block WriterLocks</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20497848%5D%20New%3A%20ReaderWriterLock%3A%20ReaderLocks%20do%20not%0A%20appear%20to%20block%20WriterLocks&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 497848] New: ReaderWriterLock: ReaderLocks do not appear to block WriterLocks">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Apr 23 23:22:02 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="088221.html">[Mono-bugs] [Bug 497839] xbuild don't recognize  $(SolutionDir)
</A></li>
        <LI>Next message: <A HREF="088159.html">[Mono-bugs] [Bug 497848] ReaderWriterLock: ReaderLocks do not appear to block WriterLocks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88146">[ date ]</a>
              <a href="thread.html#88146">[ thread ]</a>
              <a href="subject.html#88146">[ subject ]</a>
              <a href="author.html#88146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=497848">http://bugzilla.novell.com/show_bug.cgi?id=497848</A>


           Summary: ReaderWriterLock: ReaderLocks do not appear to block
                    WriterLocks
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.0.x
          Platform: x86-64
        OS/Version: openSUSE 11.1
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">charlesb770 at yahoo.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=287943)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=287943">http://bugzilla.novell.com/attachment.cgi?id=287943</A>)
An nunit test with failing test: TestReadLockBlocksWrites

User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.8)
Gecko/2009032600 SUSE/3.0.8-1.1.1 Firefox/3.0.8

When I have one thread use ReaderWriterLock.AcquireReaderLock followed by
another thread which uses ReaderWriterLock.AcquireWriterLock, the writer lock
is granted immediately.

In MS .Net 3.5 (VS2008) this is not the observed behavior. The WriterLock
should not be granted until the ReaderLock is released.

This seems to be a major bug; dirty reads are unavoidable in this state. This
class does not do what it is supposed to do.

I have attached an nunit testfixture which reproduces the issue. I have run
this test in VS2008 and it passes.

Reproducible: Always

Steps to Reproduce:
1.Start a thread that acquires a ReaderLock
2.Start a thread that acquires a WriterLock on the same resource

Actual Results:  
WriterLock is granted immediately

Expected Results:  
WriterLock should wait until the ReaderLock is released

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088221.html">[Mono-bugs] [Bug 497839] xbuild don't recognize  $(SolutionDir)
</A></li>
	<LI>Next message: <A HREF="088159.html">[Mono-bugs] [Bug 497848] ReaderWriterLock: ReaderLocks do not appear to block WriterLocks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88146">[ date ]</a>
              <a href="thread.html#88146">[ thread ]</a>
              <a href="subject.html#88146">[ subject ]</a>
              <a href="author.html#88146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
