<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 494567] r131501 breaks compilation of System.Windows.Forms_test_net_1_1.dll
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20494567%5D%20r131501%20breaks%20compilation%20of%0A%20System.Windows.Forms_test_net_1_1.dll&In-Reply-To=bug-494567-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="087846.html">
   <LINK REL="Next"  HREF="087888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 494567] r131501 breaks compilation of System.Windows.Forms_test_net_1_1.dll</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20494567%5D%20r131501%20breaks%20compilation%20of%0A%20System.Windows.Forms_test_net_1_1.dll&In-Reply-To=bug-494567-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 494567] r131501 breaks compilation of System.Windows.Forms_test_net_1_1.dll">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Apr 16 13:21:57 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="087846.html">[Mono-bugs] [Bug 494567] r131501 breaks compilation of System.Windows.Forms_test_net_1_1.dll
</A></li>
        <LI>Next message: <A HREF="087888.html">[Mono-bugs] [Bug 494567] r131501 breaks compilation of System.Windows.Forms_test_net_1_1.dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87885">[ date ]</a>
              <a href="thread.html#87885">[ thread ]</a>
              <a href="subject.html#87885">[ subject ]</a>
              <a href="author.html#87885">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=494567">http://bugzilla.novell.com/show_bug.cgi?id=494567</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">harinath at hurrynot.org</A> added comment
<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=494567#c9">http://bugzilla.novell.com/show_bug.cgi?id=494567#c9</A>





--- Comment #9 from Raja Harinath &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">harinath at hurrynot.org</A>&gt;  2009-04-16 11:21:56 MDT ---
The patch works, but is probably somewhat of a red-herring I think.  Basically,
since your patch changes offsets of instructions everywhere, this particular
bug might've been hidden, since it's highly dependent on the exact bit pattern
of the surrounding code and the bit pattern of the relative jump.

My understanding is that the bug is with a 0xe8 call instruction
(x86_call_code), not with a 0xff call instruction (x86_call_membase).  Maybe
this should go into emit_call() instead?  

Also, I was wondering if it was worth the effort to do something like this
instead of always emitting nops:

  static const guint32 dummy_regs [NUMBER_OF_REGISTERS];
  int ntries = 0;
  retry:
   old_code = code;
   x86_call_...(code, ...);
   if (mono_arch_get_vcall_slot_addr (code, (guint32*)dummy_regs)) {
      /* ugh, this absolute call looks just like as a virtual/interface call */
      code = old_code;
      /* let's pad with a nop and see ... */
      x86_nop (code);
      if (++ntries &gt; 5) g_warning (&quot;%s: padding with too many nops? (%d)&quot;,
mono_method_full_name (current_method), ntries);
      goto retry;
   }

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>






















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="087846.html">[Mono-bugs] [Bug 494567] r131501 breaks compilation of System.Windows.Forms_test_net_1_1.dll
</A></li>
	<LI>Next message: <A HREF="087888.html">[Mono-bugs] [Bug 494567] r131501 breaks compilation of System.Windows.Forms_test_net_1_1.dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87885">[ date ]</a>
              <a href="thread.html#87885">[ thread ]</a>
              <a href="subject.html#87885">[ subject ]</a>
              <a href="author.html#87885">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
