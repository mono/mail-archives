<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 471257] New: Inconsistent Reflection behavior with custom Binder on Mono versus .NET
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20471257%5D%20New%3A%20Inconsistent%20Reflection%20behavior%20with%0A%20custom%20Binder%20on%20Mono%20versus%20.NET&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="085345.html">
   <LINK REL="Next"  HREF="085332.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 471257] New: Inconsistent Reflection behavior with custom Binder on Mono versus .NET</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20471257%5D%20New%3A%20Inconsistent%20Reflection%20behavior%20with%0A%20custom%20Binder%20on%20Mono%20versus%20.NET&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 471257] New: Inconsistent Reflection behavior with custom Binder on Mono versus .NET">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Jan 30 22:49:14 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="085345.html">[Mono-bugs] [Bug 471255] Type.GetType returns null for a given type only on Mono (works in .NET)
</A></li>
        <LI>Next message: <A HREF="085332.html">[Mono-bugs] [Bug 471257] Inconsistent Reflection behavior with custom Binder on Mono versus .NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85328">[ date ]</a>
              <a href="thread.html#85328">[ thread ]</a>
              <a href="subject.html#85328">[ subject ]</a>
              <a href="author.html#85328">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=471257">https://bugzilla.novell.com/show_bug.cgi?id=471257</A>


           Summary: Inconsistent Reflection behavior with custom Binder on
                    Mono versus .NET
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.2.x
          Platform: x86
        OS/Version: openSUSE 11.0
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">joe at mistachkin.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.20)
Gecko/20081217 Firefox/2.0.0.20 (.NET CLR 3.5.30729)


The Eagle unit tests object-14.1, object-14.2, object-14.4, object-14.5, and
object-14.6 demonstrate an inconsistency between the Reflection implementations
on Mono and .NET.  Judging from the stack traces, it looks like Mono may not be
supplying the correct arguments to my custom Binder implementation; however, on
NET the custom IBinder implementation is not even called for these unit tests.

---- object-14.1 start

==== object-14.1 nested static/non-static type resolution FAILED
==== Contents of test case:

  object invoke System.Console.BackgroundColor ToString

---- Test generated error; Return code was: Error
---- Return code should have been one of: Ok Return
---- errorInfo: System.NullReferenceException: Object reference not set to an
instance of an object
  at Eagle._Components.Private.ScriptBinder.BindToMethod (BindingFlags
bindingAttr, System.Reflection.MethodBase[] match, System.Object[]&amp; args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] names, System.Object&amp;
state) [0x00000] 
  at System.MonoType.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] namedParameters)
[0x00000] 
  at System.Type.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args)
[0x00000] 
  at Eagle._Components.Public.Value.GetNestedObject
(Eagle._Components.Public.Interpreter interpreter, System.String text,
System.AppDomain appDomain, BindingFlags bindingFlags, Boolean strict, Boolean
verbose, Boolean noCase, Boolean noNested, System.Globalization.CultureInfo
cultureInfo, Eagle._Components.Public.TypedInstance&amp; value,
Eagle._Components.Public.Result&amp; error, System.Exception&amp; exception) [0x00000] 
    while executing
&quot;object invoke System.Console.BackgroundColor ToString&quot;
---- errorCode: NONE
==== object-14.1 FAILED
---- object-14.2 start

==== object-14.2 nested static/non-static type resolution FAILED
==== Contents of test case:

  list [catch {object invoke System.Console.GetType ToString} msg] $msg

---- Result was:
1 {System.NullReferenceException: Object reference not set to an instance of an
object
  at Eagle._Components.Private.ScriptBinder.BindToMethod (BindingFlags
bindingAttr, System.Reflection.MethodBase[] match, System.Object[]&amp; args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] names, System.Object&amp;
state) [0x00000] 
  at System.MonoType.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] namedParameters)
[0x00000] 
  at System.Type.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args)
[0x00000] 
  at Eagle._Components.Public.Value.GetNestedObject
(Eagle._Components.Public.Interpreter interpreter, System.String text,
System.AppDomain appDomain, BindingFlags bindingFlags, Boolean strict, Boolean
verbose, Boolean noCase, Boolean noNested, System.Globalization.CultureInfo
cultureInfo, Eagle._Components.Public.TypedInstance&amp; value,
Eagle._Components.Public.Result&amp; error, System.Exception&amp; exception) [0x00000]
}
---- Result should have been (Glob matching):
1 {System.Reflection.TargetException: Non-static method requires a target.*}
==== object-14.2 FAILED
---- object-14.3 start
++++ object-14.3 PASSED
---- object-14.4 start

==== object-14.4 nested static/non-static type resolution FAILED
==== Contents of test case:

  object invoke Eagle._Tests.Default StaticObjectProperty null
  list [catch {object invoke Eagle._Tests.Default.StaticObjectProperty 
ToString} msg] $msg

---- Result was:
1 {System.NullReferenceException: Object reference not set to an instance of an
object
  at Eagle._Components.Private.ScriptBinder.BindToMethod (BindingFlags
bindingAttr, System.Reflection.MethodBase[] match, System.Object[]&amp; args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] names, System.Object&amp;
state) [0x00000] 
  at System.MonoType.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] namedParameters)
[0x00000] 
  at System.Type.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args)
[0x00000] 
  at Eagle._Components.Public.Value.GetNestedObject
(Eagle._Components.Public.Interpreter interpreter, System.String text,
System.AppDomain appDomain, BindingFlags bindingFlags, Boolean strict, Boolean
verbose, Boolean noCase, Boolean noNested, System.Globalization.CultureInfo
cultureInfo, Eagle._Components.Public.TypedInstance&amp; value,
Eagle._Components.Public.Result&amp; error, System.Exception&amp; exception) [0x00000]
}
---- Result should have been (Exact matching):
1 {invalid object or type &quot;Eagle._Tests.Default.StaticObjectProperty&quot;}
==== object-14.4 FAILED
---- object-14.5 start

==== object-14.5 nested static/non-static type resolution FAILED
==== Contents of test case:

  object invoke Eagle._Tests.Default StaticObjectProperty foo
  object invoke Eagle._Tests.Default.StaticObjectProperty ToString

---- Test generated error; Return code was: Error
---- Return code should have been one of: Ok Return
---- errorInfo: System.NullReferenceException: Object reference not set to an
instance of an object
  at Eagle._Components.Private.ScriptBinder.BindToMethod (BindingFlags
bindingAttr, System.Reflection.MethodBase[] match, System.Object[]&amp; args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] names, System.Object&amp;
state) [0x00000] 
  at System.MonoType.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] namedParameters)
[0x00000] 
  at System.Type.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args)
[0x00000] 
  at Eagle._Components.Public.Value.GetNestedObject
(Eagle._Components.Public.Interpreter interpreter, System.String text,
System.AppDomain appDomain, BindingFlags bindingFlags, Boolean strict, Boolean
verbose, Boolean noCase, Boolean noNested, System.Globalization.CultureInfo
cultureInfo, Eagle._Components.Public.TypedInstance&amp; value,
Eagle._Components.Public.Result&amp; error, System.Exception&amp; exception) [0x00000] 
    while executing
&quot;object invoke Eagle._Tests.Default.StaticObjectProperty ToString&quot;
---- errorCode: NONE
==== object-14.5 FAILED
---- object-14.6 start

==== object-14.6 nested static/non-static type resolution FAILED
==== Contents of test case:

  $test TypeProperty $type
  list [object invoke $test.TypeProperty ToString] [object invoke 
$test.TypeProperty.BaseType ToString] $object [$type ToString]  [$baseType
ToString]

---- Test generated error; Return code was: Error
---- Return code should have been one of: Ok Return
---- errorInfo: System.NullReferenceException: Object reference not set to an
instance of an object
  at Eagle._Components.Private.ScriptBinder.BindToMethod (BindingFlags
bindingAttr, System.Reflection.MethodBase[] match, System.Object[]&amp; args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] names, System.Object&amp;
state) [0x00000] 
  at System.MonoType.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args,
System.Reflection.ParameterModifier[] modifiers,
System.Globalization.CultureInfo culture, System.String[] namedParameters)
[0x00000] 
  at System.Type.InvokeMember (System.String name, BindingFlags invokeAttr,
System.Reflection.Binder binder, System.Object target, System.Object[] args)
[0x00000] 
  at Eagle._Components.Public.Value.GetNestedObject
(Eagle._Components.Public.Interpreter interpreter, System.String text,
System.AppDomain appDomain, BindingFlags bindingFlags, Boolean strict, Boolean
verbose, Boolean noCase, Boolean noNested, System.Globalization.CultureInfo
cultureInfo, Eagle._Components.Public.TypedInstance&amp; value,
Eagle._Components.Public.Result&amp; error, System.Exception&amp; exception) [0x00000] 
    while executing
&quot;object invoke $test.TypeProperty ToString&quot;
    invoked from within
&quot;list [object invoke $test.TypeProperty ToString] [object invoke 
$test.TypeProperty.BaseType ToString] $object [$type ToString]  [$baseType
ToString]&quot;
---- errorCode: NONE
==== object-14.6 FAILED


Reproducible: Always

Steps to Reproduce:
1. Download the &quot;Mono-on-Unix&quot; binaries distribution from: <A HREF="http://eagle.to/">http://eagle.to/</A>
2. Start the EagleShell.exe under the Mono of your choice (fails in 2.0 and
2.2)
3. Type &quot;set argv [list -constraints monoBug]&quot; and hit enter.
4. Type &quot;#test object14*&quot; and hit enter to see the failure (complete with stack
trace).

Actual Results:  
Exceptions from inside the custom Binder implementations.

Expected Results:  
The custom Binder implementation should not be called for these unit tests and
the tests should all pass.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="085345.html">[Mono-bugs] [Bug 471255] Type.GetType returns null for a given type only on Mono (works in .NET)
</A></li>
	<LI>Next message: <A HREF="085332.html">[Mono-bugs] [Bug 471257] Inconsistent Reflection behavior with custom Binder on Mono versus .NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85328">[ date ]</a>
              <a href="thread.html#85328">[ thread ]</a>
              <a href="subject.html#85328">[ subject ]</a>
              <a href="author.html#85328">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
