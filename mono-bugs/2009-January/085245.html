<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 470951] New: Most functions in io-portability.c and io.c does not handle EINTR correctly.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20470951%5D%20New%3A%20Most%20functions%20in%20io-portability.c%0A%20and%20io.c%20does%20not%20handle%20EINTR%20correctly.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="085249.html">
   <LINK REL="Next"  HREF="085246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 470951] New: Most functions in io-portability.c and io.c does not handle EINTR correctly.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20470951%5D%20New%3A%20Most%20functions%20in%20io-portability.c%0A%20and%20io.c%20does%20not%20handle%20EINTR%20correctly.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 470951] New: Most functions in io-portability.c and io.c does not handle EINTR correctly.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Jan 30 07:02:35 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="085249.html">[Mono-bugs] [Bug 470918] Compilation fails due to unknown type
</A></li>
        <LI>Next message: <A HREF="085246.html">[Mono-bugs] [Bug 470951] Most functions in io-portability.c and io.c does not handle EINTR correctly.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85245">[ date ]</a>
              <a href="thread.html#85245">[ thread ]</a>
              <a href="subject.html#85245">[ subject ]</a>
              <a href="author.html#85245">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=470951">https://bugzilla.novell.com/show_bug.cgi?id=470951</A>


           Summary: Most functions in io-portability.c and io.c does not
                    handle EINTR correctly.
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.2.x
          Platform: 32bit
        OS/Version: Solaris 10
            Status: NEW
          Severity: Minor
          Priority: P5 - None
         Component: io-layer
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">burkhard.linke at CeBiTec.Uni-Bielefeld.DE</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Most functions in the io-layer does not handle EINTR correctly if syscalls
return and indicate and error.

EINTR indicates that the syscall was interrupted by a signal. Since I'm working
with networked filesystems file operation may take some time if the nfs server
is under high load, raising the probability that signals may occur while being
blocked in the syscall.

The result are irreproducible errors. Since EINTR is not handled in the
indented way (restarting the syscalls), the error is propagated to the upper
layers, resulting in IOExceptions.

The attached patches add wrappers to most syscalls in mono/io-layer/io.c and
mono/io-layer/io-portability.c that restart syscalls if they were interrupted
by a signal.

According to the Solaris manpages &quot;lseek&quot; is one of the few syscalls used in
the files that does not return EINTR; so the calls to lseek are not patched.

You should check the files afterwards in case I've missed some syscalls.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="085249.html">[Mono-bugs] [Bug 470918] Compilation fails due to unknown type
</A></li>
	<LI>Next message: <A HREF="085246.html">[Mono-bugs] [Bug 470951] Most functions in io-portability.c and io.c does not handle EINTR correctly.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85245">[ date ]</a>
              <a href="thread.html#85245">[ thread ]</a>
              <a href="subject.html#85245">[ subject ]</a>
              <a href="author.html#85245">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
