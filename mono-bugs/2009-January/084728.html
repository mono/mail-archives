<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 467225] New: Several bugs in TreeView and TreeNode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20467225%5D%20New%3A%20Several%20bugs%20in%20TreeView%20and%20TreeNode&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="084727.html">
   <LINK REL="Next"  HREF="084729.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 467225] New: Several bugs in TreeView and TreeNode</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20467225%5D%20New%3A%20Several%20bugs%20in%20TreeView%20and%20TreeNode&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 467225] New: Several bugs in TreeView and TreeNode">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun Jan 18 22:48:54 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="084727.html">[Mono-bugs] [Bug 442105] XSP2.0.1 on Windows crashes when exiting [assert in mono_get_lmf_addr]
</A></li>
        <LI>Next message: <A HREF="084729.html">[Mono-bugs] [Bug 467225] Several bugs in TreeView and TreeNode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84728">[ date ]</a>
              <a href="thread.html#84728">[ thread ]</a>
              <a href="subject.html#84728">[ subject ]</a>
              <a href="author.html#84728">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=467225">https://bugzilla.novell.com/show_bug.cgi?id=467225</A>


           Summary: Several bugs in TreeView and TreeNode
    Classification: Mono
           Product: Mono: Class Libraries
           Version: SVN
          Platform: PC
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Windows.Forms
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">djlawler at aol.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Community User


Description of Problem:

Was using the multi-select TreeView from here:
<A HREF="http://sourceforge.net/projects/mstreeview/.">http://sourceforge.net/projects/mstreeview/.</A>  This works fine on .net but well
on Mono at all.  I tried the standard Mono present on Ubuntu 8.10, then
compiled my own version of 2.2 for 8.10 and even tried Windows Mono version  I
finally loaded the project on Windows in Visual Studio Express and referenced
the mono SWF2k5 project and still had the following problems in the
TreeViewTest project that comes with the multi-select TreeView.

Random (but frequent) null reference exceptions when you click on nodes (or
'near' nodes).  This might be related to bug 438650.  Also, if you expand all,
select a node near the bottom, and then collapse all you get an exception. 
Also, using the arrow keys to move up or down in the treeview does not work 
Also, when you enable multi-select and use shift to select a range it not only
does not work....it goes into an infinite loop! 

Additional Information:

Here are my suggested patches to solve these issues:

For TreeNode.cs:
539,547c539
&lt;                 // following lines added because OpenTreeNodeEnumerator
returns the node passed
&lt;                 // to it when initialized on the first MoveNext which puts
code in multi-select
&lt;                 // treeview into an endless loop.
&lt;                 if (o.CurrentNode == this)
&lt;                 {
&lt;                     if (!o.MoveNext())
&lt;                         return null;
&lt;                 }
&lt;                 TreeNode c = o.CurrentNode;
---
&gt;<i> 				TreeNode c = o.CurrentNode;
</I>620,628c612
&lt;                 // following lines added because OpenTreeNodeEnumerator
returns the node passed
&lt;                 // to it when initialized on the first MovePrevious which
puts code in multi-select
&lt;                 // treeview into an endless loop.
&lt;                 if (o.CurrentNode == this)
&lt;                 {
&lt;                     if (!o.MovePrevious())
&lt;                         return null;
&lt;                 }
&lt;                 TreeNode c = o.CurrentNode;
---
&gt;<i> 				TreeNode c = o.CurrentNode;
</I>
For TreeView.cs:

1379,1383c1379
&lt;             // don't allow vbar.Value to be set to a negative
&lt;             int temp = vbar.Maximum - VisibleCount + 1;
&lt;             if (temp &lt; 0)
&lt;                 temp = 0;
&lt;             vbar.Value = Math.Min(order, temp);
---
&gt;<i> 			vbar.Value = Math.Min (order, vbar.Maximum - VisibleCount + 1);
</I>2210,2221c2206,2212
&lt;             // lots of null checking added to avoid null Exceptions when
using
&lt;             // multi-select Treeview
&lt;             if (highlighted_node != null)
&lt;                 Invalidate (highlighted_node.Bounds);
&lt;             if (focused_node != null)
&lt;                 Invalidate (focused_node.Bounds);
&lt;             if (selected_node != null)
&lt;             {
&lt;                 Invalidate(selected_node.Bounds);
&lt;                 highlighted_node = selected_node;
&lt;                 focused_node = selected_node;
&lt;             }
---
&gt;<i> 			Invalidate (highlighted_node.Bounds);
</I>&gt;<i> 			Invalidate (selected_node.Bounds);
</I>&gt;<i> 			Invalidate (focused_node.Bounds);
</I>&gt;<i> 
</I>&gt;<i> 			highlighted_node = selected_node;
</I>&gt;<i> 			focused_node = selected_node;
</I>&gt;<i>
</I>
-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>



























































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="084727.html">[Mono-bugs] [Bug 442105] XSP2.0.1 on Windows crashes when exiting [assert in mono_get_lmf_addr]
</A></li>
	<LI>Next message: <A HREF="084729.html">[Mono-bugs] [Bug 467225] Several bugs in TreeView and TreeNode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84728">[ date ]</a>
              <a href="thread.html#84728">[ thread ]</a>
              <a href="subject.html#84728">[ subject ]</a>
              <a href="author.html#84728">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
