<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 465937] New: Mono 2.2 JIT crash on method-to-ir.c:10432:mono_spill_global_vars after upgrade from 2.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20465937%5D%20New%3A%20Mono%202.2%20JIT%20crash%20on%0A%20method-to-ir.c%3A10432%3Amono_spill_global_vars%20after%20upgrade%20from%202.0&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="084573.html">
   <LINK REL="Next"  HREF="084588.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 465937] New: Mono 2.2 JIT crash on method-to-ir.c:10432:mono_spill_global_vars after upgrade from 2.0</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20465937%5D%20New%3A%20Mono%202.2%20JIT%20crash%20on%0A%20method-to-ir.c%3A10432%3Amono_spill_global_vars%20after%20upgrade%20from%202.0&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 465937] New: Mono 2.2 JIT crash on method-to-ir.c:10432:mono_spill_global_vars after upgrade from 2.0">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Jan 14 01:17:28 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="084573.html">[Mono-bugs] [Bug 459432] HttpListener ObjectDisposedException
</A></li>
        <LI>Next message: <A HREF="084588.html">[Mono-bugs] [Bug 465937] Mono 2.2 JIT crash on method-to-ir.c:10432:mono_spill_global_vars after upgrade from 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84576">[ date ]</a>
              <a href="thread.html#84576">[ thread ]</a>
              <a href="subject.html#84576">[ subject ]</a>
              <a href="author.html#84576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=465937">https://bugzilla.novell.com/show_bug.cgi?id=465937</A>


           Summary: Mono 2.2 JIT crash on
                    method-to-ir.c:10432:mono_spill_global_vars after
                    upgrade from 2.0
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.2.x
          Platform: x86
        OS/Version: Mac OS X 10.5
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: JIT
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">eugeny.grishul at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=264927)
 --&gt; (<A HREF="https://bugzilla.novell.com/attachment.cgi?id=264927">https://bugzilla.novell.com/attachment.cgi?id=264927</A>)
NObjective runtime + Tests

User-Agent:       Opera/9.63 (Windows NT 6.0; U; ru) Presto/2.1.1

My library uses many tricks to provide best performance in the world for
interop with Objective-C. After upgrade to Mono 2.2 I can't run validation
NUnit tests due to Mono crash ( crash in code that generated by Reflection.Emit
):

ERROR:method-to-ir.c:10432:mono_spill_global_vars: assertion failed:
(load_opcode != OP_LOADV_MEMBASE)

Reproducible: Always

Steps to Reproduce:
1. Download and unpack attached files or build NObjective from trunk
(<A HREF="http://code.google.com/p/objcmapper/">http://code.google.com/p/objcmapper/</A>) on Mac OS 10.5 system
2. nunit-console2 /nologo NObjective.Tests.Leopard.dll

Actual Results:  
Crash with message
ERROR:method-to-ir.c:10432:mono_spill_global_vars: assertion failed:
(load_opcode != OP_LOADV_MEMBASE)
Stacktrace:

  at TransitionNObjective.Tests.AutoRegisteredClass.-ctor0
(int*,int*,int,int,NObjective.RuntimeObject,NObjective.Selector) &lt;0xffffffff&gt;
  at (wrapper managed-to-native)
NObjective.Runtime/NativeMethods.objc_msgSend_eh
(intptr,NObjective.Selector,intptr&amp;,int,NObjective.Runtime/ArgumentsStack&amp;)
&lt;0x00004&gt;
  at (wrapper managed-to-native)
NObjective.Runtime/NativeMethods.objc_msgSend_eh
(intptr,NObjective.Selector,intptr&amp;,int,NObjective.Runtime/ArgumentsStack&amp;)
&lt;0xffffffff&gt;
  at NObjective.Runtime.SendObjectiveCMessage
(NObjective.Runtime/MessageSendingOptions,intptr,NObjective.Selector,NObjective.RuntimeMethodEncoding&amp;,intptr,int,object[])
&lt;0x01ec6&gt;
  at NObjective.Runtime.InvokeRawFast
(NObjective.RuntimeObject,NObjective.Selector,NObjective.RuntimeMethodEncoding,object[])
&lt;0x0002c&gt;
  at NObjective.Runtime.InvokeRaw
(NObjective.RuntimeObject,NObjective.Selector,object[]) &lt;0x00015&gt;
  at NObjective.RuntimeObject.InvokeRaw (NObjective.Selector,object[])
&lt;0x0001e&gt;
  at NObjective.RuntimeObject.InvokeIntPtr (NObjective.Selector,object[])
&lt;0x00016&gt;
  at NObjective.RuntimeObject.InvokeObject (NObjective.Selector,object[])
&lt;0x00016&gt;
  at NObjective.RuntimeClass.CreateInstance (NObjective.Selector,object[])
&lt;0x00031&gt;
  at NObjective.Tests.RegistrationTest.ConstructorsTest () &lt;0x0009b&gt;
  at (wrapper runtime-invoke) object.runtime_invoke_void__this__
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0x00004&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0xffffffff&gt;
  at System.Reflection.MonoMethod.Invoke
(object,System.Reflection.BindingFlags,System.Reflection.Binder,object[],System.Globalization.CultureInfo)
[0x00057] in /private/tmp/monobuild/build/BUILD/mono-2.2/mcs/c
lass/corlib/System.Reflection/MonoMethod.cs:159
  at System.Reflection.MethodBase.Invoke (object,object[]) [0x00000] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/class/corlib/System.Reflection/MethodBase.cs:111
  at NUnit.Core.Reflect.InvokeMethod (System.Reflection.MethodInfo,object)
[0x00006] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/Reflect.cs:373
  at NUnit.Core.TemplateTestCase.doTestCase (NUnit.Core.TestCaseResult)
[0x00000] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TemplateTestCase.cs:155
  at NUnit.Core.TemplateTestCase.doRun (NUnit.Core.TestCaseResult) [0x00011] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TemplateTestCase.cs:113
  at NUnit.Core.TemplateTestCase.Run (NUnit.Core.TestCaseResult) [0x0006b] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TemplateTestCase.cs:76
  at NUnit.Core.TestCase.Run (NUnit.Core.EventListener) [0x0001d] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestCase.cs:68
  at NUnit.Core.TestCase.Run (NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x00000] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestCase.cs:58
  at NUnit.Core.TestSuite.RunAllTests
(NUnit.Core.TestSuiteResult,NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0008c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:259
  at NUnit.Core.TestSuite.Run (NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0003c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:213
  at NUnit.Core.TestSuite.RunAllTests
(NUnit.Core.TestSuiteResult,NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0008c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:259
  at NUnit.Core.TestSuite.Run (NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0003c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:213
  at NUnit.Core.TestSuite.RunAllTests
(NUnit.Core.TestSuiteResult,NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0008c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:259
  at NUnit.Core.TestSuite.Run (NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0003c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:213
  at NUnit.Core.TestSuite.RunAllTests
(NUnit.Core.TestSuiteResult,NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0008c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:259
  at NUnit.Core.TestSuite.Run (NUnit.Core.EventListener,NUnit.Core.IFilter)
[0x0003c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestSuite.cs:213
  at NUnit.Core.AssemblyTestSuite.Run
(NUnit.Core.EventListener,NUnit.Core.IFilter) [0x00028] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/TestAssembly.cs:67
  at NUnit.Core.RemoteTestRunner.Run
(NUnit.Core.EventListener,NUnit.Core.Test[]) [0x0010c] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/RemoteTestRunner.cs:411
  at NUnit.Core.RemoteTestRunner.Run (NUnit.Core.EventListener,NUnit.Core.Test)
[0x0000b] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/RemoteTestRunner.cs:355
  at NUnit.Core.RemoteTestRunner.Run (NUnit.Core.EventListener) [0x00000] in
/private/tmp/monobuild/build/BUILD/mono-2.2/mcs/nunit20/core/RemoteTestRunner.cs:292
  at (wrapper remoting-invoke-with-check) NUnit.Core.RemoteTestRunner.Run
(NUnit.Core.EventListener) &lt;0xffffffff&gt;
  at (wrapper xdomain-dispatch) NUnit.Core.RemoteTestRunner.Run
(object,byte[]&amp;,byte[]&amp;) &lt;0xffffffff&gt;
  at (wrapper xdomain-invoke) NUnit.Core.RemoteTestRunner.Run
(NUnit.Core.EventListener) &lt;0xffffffff&gt;
  at NUnit.Util.TestDomain.Run (NUnit.Core.EventListener) &lt;0x00082&gt;
  at NUnit.Console.ConsoleUi.Execute (NUnit.Util.ConsoleOptions) &lt;0x0040c&gt;
  at NUnit.Console.ConsoleUi.Main (string[]) &lt;0x0013a&gt;
  at (wrapper runtime-invoke) NUnit.Console.ConsoleUi.runtime_invoke_int_object
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;
/NObjective/tests/test_leopard.sh: line 14:  1072 Abort trap             
nunit-console2 /nologo NObjective.Tests.Leopard.dll

Expected Results:  
Same behaviour like on Mono 2.0 (all tests should be passed)

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>









































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="084573.html">[Mono-bugs] [Bug 459432] HttpListener ObjectDisposedException
</A></li>
	<LI>Next message: <A HREF="084588.html">[Mono-bugs] [Bug 465937] Mono 2.2 JIT crash on method-to-ir.c:10432:mono_spill_global_vars after upgrade from 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84576">[ date ]</a>
              <a href="thread.html#84576">[ thread ]</a>
              <a href="subject.html#84576">[ subject ]</a>
              <a href="author.html#84576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
