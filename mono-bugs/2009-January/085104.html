<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 469858] New: [regression] crash if using constrained generic parameter in nested class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20469858%5D%20New%3A%20%5Bregression%5D%20crash%20if%20using%0A%20constrained%20generic%20parameter%20in%20nested%20class&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="085102.html">
   <LINK REL="Next"  HREF="085105.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 469858] New: [regression] crash if using constrained generic parameter in nested class</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20469858%5D%20New%3A%20%5Bregression%5D%20crash%20if%20using%0A%20constrained%20generic%20parameter%20in%20nested%20class&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 469858] New: [regression] crash if using constrained generic parameter in nested class">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Jan 27 12:39:58 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="085102.html">[Mono-bugs] [Bug 469848] New: Attribute.GetCustomAttributes doesn't fully inherit attributes
</A></li>
        <LI>Next message: <A HREF="085105.html">[Mono-bugs] [Bug 469858] [regression] crash if using constrained generic parameter in nested class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85104">[ date ]</a>
              <a href="thread.html#85104">[ thread ]</a>
              <a href="subject.html#85104">[ subject ]</a>
              <a href="author.html#85104">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=469858">https://bugzilla.novell.com/show_bug.cgi?id=469858</A>


           Summary: [regression] crash if using constrained generic
                    parameter in nested class
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.4.x
          Platform: x86-64
        OS/Version: Kubuntu
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: generics
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">silk at boktor.net</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Created an attachment (id=268028)
 --&gt; (<A HREF="https://bugzilla.novell.com/attachment.cgi?id=268028">https://bugzilla.novell.com/attachment.cgi?id=268028</A>)
test case

User-Agent:       Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.5)
Gecko/2008121621 Ubuntu/8.04 (hardy) Firefox/3.0.5

This code compiles fine. Works under MS.NET, and mono up to mono 2.0.
It throws exception in mono 2.2, or current mono 2.4 branch.

It seems to work fine with mono trunk from rev r124177 in my friend's
environment.


public class P
{
    public int Metoda () { return 2; }
}

public class Packer&lt;T&gt; where T : P
{
    class Node {
        public void Insert(T item)
        {
            System.Console.WriteLine (item.Metoda());
        }
    }

    public void M (T item) {
        System.Console.WriteLine (item.Metoda());
        Node n = new Node ();
        n.Insert (item);
    }
}

public class T {
    public static void Main ()
    {
        Packer&lt;P&gt; pack = new Packer&lt;P&gt; ();
        pack.M (new P ());
    }

}


Same code in attachement.

Reproducible: Always

Steps to Reproduce:
1. Create a generic class A&lt;T&gt; with a constrint T : SomeClass
2. Create a nested non-generic class B in A&lt;T&gt;
3. Add a method B.Met(T item)
4. Call from B.Met some method existing in SomeClass
5. Compile &amp; run

Actual Results:  
Runtime exception:
** (NestedGeneric.exe:28410): WARNING **: Missing method .P.Metoda in assembly
/home/silk/devel/test/bugs/iface/NestedGeneric.exe token 6000002

Unhandled Exception: System.TypeLoadException: A type load exception has
occurred.
  at Packer`1[P].M (.P item) [0x00018] in
/home/silk/devel/test/bugs/iface/NestedGeneric.cs:18
  at T.Main () [0x00006] in
/home/silk/devel/test/bugs/iface/NestedGeneric.cs:26



Expected Results:  
Does not crash. The method is sucessfully called.

OpenTK.Fonts library requires this to work.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>












































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="085102.html">[Mono-bugs] [Bug 469848] New: Attribute.GetCustomAttributes doesn't fully inherit attributes
</A></li>
	<LI>Next message: <A HREF="085105.html">[Mono-bugs] [Bug 469858] [regression] crash if using constrained generic parameter in nested class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85104">[ date ]</a>
              <a href="thread.html#85104">[ thread ]</a>
              <a href="subject.html#85104">[ subject ]</a>
              <a href="author.html#85104">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
