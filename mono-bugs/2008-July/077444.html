<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 413534] New: VUL-0: Mono ASP. NET class library has potential XSS problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20413534%5D%20New%3A%20VUL-0%3A%20Mono%20ASP.%20NET%20class%20library%0A%20has%20potential%20XSS%20problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077466.html">
   <LINK REL="Next"  HREF="077445.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 413534] New: VUL-0: Mono ASP. NET class library has potential XSS problem</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20413534%5D%20New%3A%20VUL-0%3A%20Mono%20ASP.%20NET%20class%20library%0A%20has%20potential%20XSS%20problem&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 413534] New: VUL-0: Mono ASP. NET class library has potential XSS problem">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Jul 31 05:34:13 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="077466.html">[Mono-bugs] [Bug 413501] PrintPreviewDialog Toolbar bad layouting
</A></li>
        <LI>Next message: <A HREF="077445.html">[Mono-bugs] [Bug 413534] VUL-0: Mono ASP.NET class library has potential XSS problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77444">[ date ]</a>
              <a href="thread.html#77444">[ thread ]</a>
              <a href="subject.html#77444">[ subject ]</a>
              <a href="author.html#77444">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=413534">https://bugzilla.novell.com/show_bug.cgi?id=413534</A>


           Summary: VUL-0: Mono ASP.NET class library has potential XSS
                    problem
           Product: Mono: Class Libraries
           Version: 2.0
          Platform: Other
        OS/Version: Other
            Status: NEW
          Keywords: security_vulnerability
          Severity: Major
          Priority: P5 - None
         Component: Sys.Web
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">meissner at novell.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
                CC: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jshort at novell.com</A>, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">security-team at suse.de</A>,
                    <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dean at brettle.com</A>
          Found By: Third Party Developer/Partner


We received this report from a mono developer (is cc'ed).


Please clarify.


&gt;&gt;&gt;<i> On 7/27/2008 at  3:36 PM, &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">genericemail at novell.com</A>&gt; wrote: 
</I>&gt;<i> 12-Job Title: 
</I>&gt;<i> 13-Company: 
</I>&gt;<i> 14-Phone: 301-990-7141
</I>&gt;<i> 22-Additional: 
</I>&gt;<i> 19-Country: United States
</I>&gt;<i> 11-Your Name: Dean Brettle
</I>&gt;<i> 17-State: CA
</I>&gt;<i> 16-City: Redwood City
</I>&gt;<i> from: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dean at brettle.com</A>
</I>&gt;<i> 21-Issue: Mono's ASP.NET implementation HTML-encodes most 
</I>&gt;<i> properties/attributes, but does not encode some. As a result an unsuspecting 
</I>&gt;<i> ASP.NET developer can inadvertently create an XSS vulnerability.
</I>&gt;<i> 
</I>&gt;<i> The following properties/attributes are not encoded by Mono but are encoded 
</I>&gt;<i> by MS' ASP.NET implementation:
</I>&gt;<i> 
</I>&gt;<i> 1. HtmlSelect.Value and HtmlSelect.Text
</I>&gt;<i> 2. The &quot;action&quot; attribute of a &lt;form&gt; element.
</I>&gt;<i> 
</I>&gt;<i> The lack of encoding for the form &quot;action&quot; attribute is particularly 
</I>&gt;<i> dangerous because the default &quot;action&quot; is the URL used visit the page.  To 
</I>&gt;<i> see why this is a problem, change the hostname and page in the following HTML 
</I>&gt;<i> so that they point to a page hosted by Mono and then use IE (not Firefox) to 
</I>&gt;<i> view the HTML and follow the link:
</I>&gt;<i> &lt;a 
</I>&gt;<i> href=&quot;<A HREF="http://hostname/page.aspx?&amp;quot;onmouseover=&amp;quot;window.alert('xss'">http://hostname/page.aspx?&amp;quot;onmouseover=&amp;quot;window.alert('xss'</A>);&amp;q
</I>&gt;<i> uot;&quot;&gt;link&lt;/a&gt;
</I>&gt;<i> 
</I>&gt;<i> In addition to the above attributes, the following attributes are not 
</I>&gt;<i> encoded by Mono or MS.NET, but should be IMO:
</I>&gt;<i> HtmlInputRadioButton.Value, HtmlImage.Src and HtmlInputImage.Src.  I just 
</I>&gt;<i> reported these  to <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">secure at microsoft.com.</A>  I don't know what action they will 
</I>&gt;<i> take, but even if they choose not to fix these, I think Mono should sacrifice 
</I>&gt;<i> strict compatibility with MS.NET to provide better security in situations 
</I>&gt;<i> like this.
</I>&gt;<i> 
</I>&gt;<i> I have commit privs for Mono SVN and have a patch for all of the above 
</I>&gt;<i> (including unit tests).  I can commit to the mono-2-0 branch and trunk, but I 
</I>&gt;<i> need clarification on whether to encode the attributes that aren't currently 
</I>&gt;<i> encoded by MS.
</I>&gt;<i> 
</I>&gt;<i> Also, since this is a security issue I wasn't sure if you needed me to wait 
</I>&gt;<i> until you could put out patched packages or something similar.
</I>&gt;<i> 
</I>&gt;<i> I posted an earlier (incomplete) version of the patch to the mono-devel list 
</I>&gt;<i> before I realized the security implications:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/2008-July/028633.html">http://lists.ximian.com/pipermail/mono-devel-list/2008-July/028633.html</A>
</I>&gt;<i> 
</I>&gt;<i> I can also email you my latest patch if it helps.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> --Dean
</I>&gt;<i> 20-Product: Mono (at least 1.2, probably all versions)
</I>

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077466.html">[Mono-bugs] [Bug 413501] PrintPreviewDialog Toolbar bad layouting
</A></li>
	<LI>Next message: <A HREF="077445.html">[Mono-bugs] [Bug 413534] VUL-0: Mono ASP.NET class library has potential XSS problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77444">[ date ]</a>
              <a href="thread.html#77444">[ thread ]</a>
              <a href="subject.html#77444">[ subject ]</a>
              <a href="author.html#77444">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
