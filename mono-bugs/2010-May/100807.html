<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 608195] Enumerable.Reverse should be lazier
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20608195%5D%20Enumerable.Reverse%20should%20be%20lazier&In-Reply-To=bug-608195-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="100796.html">
   <LINK REL="Next"  HREF="100809.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 608195] Enumerable.Reverse should be lazier</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20608195%5D%20Enumerable.Reverse%20should%20be%20lazier&In-Reply-To=bug-608195-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 608195] Enumerable.Reverse should be lazier">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon May 24 10:25:13 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="100796.html">[Mono-bugs] [Bug 608195] Enumerable.Reverse should be lazier
</A></li>
        <LI>Next message: <A HREF="100809.html">[Mono-bugs] [Bug 608195] Enumerable.Reverse should be lazier
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#100807">[ date ]</a>
              <a href="thread.html#100807">[ thread ]</a>
              <a href="subject.html#100807">[ subject ]</a>
              <a href="author.html#100807">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=608195">http://bugzilla.novell.com/show_bug.cgi?id=608195</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=608195#c3">http://bugzilla.novell.com/show_bug.cgi?id=608195#c3</A>


Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
                 CC|                            |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>

--- Comment #3 from Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jpryor at novell.com</A>&gt; 2010-05-24 14:25:13 UTC ---
I fail to see how this is a significant change/benefit.

For your example, the current behavior:

    var reversedInts = Enumerable.Range(0, int.MaxValue).Reverse();
    // memory increased by 8GB

For your &quot;improved&quot; example:

    var reversedInts = Enumerable.Range(0, int.MaxValue).Reverse();
    // negligible memory increase

    foreach (int n in reversedInts) {
        // memory increased by 8GB
    }

You're just moving where the 8GB is allocated, you're not reducing or removing
the 8GB memory allocation.  Nor can you remove the 8GB memory allocation -- in
order for Reverse() to work, it needs to find the end of the sequence,
therefore it needs to traverse the entire list.

(OK, I suppose if you wanted to severely tradeoff performance for memory use
you could actually do .Count(), then .ElementAt(), which would keep from
loading the entire sequence into memory at once, but at the cost of N+1
iterations of the sequence, which won't be cheap execution-wise...)

The database case is also ~completely different, assuming Linq-to-SQL or Entity
Framework, as those will use Queryable.Reverse(), not Enumerable.Reverse(),
which will allow the 'reverse' to be handled at the SQL level, not in managed
code. If you're intermixing Linq-to-SQL and Linq-to-Objects you might have a
case here, but you can't otherwise avoid the requirement that
Enumerable.Reverse() store the entire sequence contents.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="100796.html">[Mono-bugs] [Bug 608195] Enumerable.Reverse should be lazier
</A></li>
	<LI>Next message: <A HREF="100809.html">[Mono-bugs] [Bug 608195] Enumerable.Reverse should be lazier
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#100807">[ date ]</a>
              <a href="thread.html#100807">[ thread ]</a>
              <a href="subject.html#100807">[ subject ]</a>
              <a href="author.html#100807">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
