<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 610416] New: ArgumentException when calling Encoding.GetString (UTF8)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20610416%5D%20New%3A%20ArgumentException%20when%20calling%0A%20Encoding.GetString%20%28UTF8%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="101010.html">
   <LINK REL="Next"  HREF="101014.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 610416] New: ArgumentException when calling Encoding.GetString (UTF8)</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20610416%5D%20New%3A%20ArgumentException%20when%20calling%0A%20Encoding.GetString%20%28UTF8%29&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 610416] New: ArgumentException when calling Encoding.GetString (UTF8)">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon May 31 10:24:25 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="101010.html">[Mono-bugs] [Bug 610044] [SDB] When trying to step into a method of a property, stepping out of the property get jumps over the method call
</A></li>
        <LI>Next message: <A HREF="101014.html">[Mono-bugs] [Bug 610453] New: Cannot use web interface after some	time.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#101012">[ date ]</a>
              <a href="thread.html#101012">[ thread ]</a>
              <a href="subject.html#101012">[ subject ]</a>
              <a href="author.html#101012">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=610416">http://bugzilla.novell.com/show_bug.cgi?id=610416</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=610416#c0">http://bugzilla.novell.com/show_bug.cgi?id=610416#c0</A>


           Summary: ArgumentException when calling Encoding.GetString
                    (UTF8)
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.4.x
          Platform: Other
        OS/Version: Linux
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">benjamin.klueglein at googlemail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=365893)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=365893">http://bugzilla.novell.com/attachment.cgi?id=365893</A>)
The file which contains the bytes I passed to Encoding.GetString

User-Agent:       Mozilla/5.0 (X11; U; Linux i686; de; rv:1.9.2.3)
Gecko/20100423 Ubuntu/10.04 (lucid) Firefox/3.6.3

An argument exception occurs when a big byte array (in my case red from a odt
document) is given to Encoding.GetString (Utf8 encoding)
Testing the same thing under MS.NET doesn't fail.

Reproducible: Always

Steps to Reproduce:
1. Use this small program:
using System;
using System.IO;
using System.Text;

namespace EncodingTest
{
    class MainClass
    {
        public static void Main (string[] args)
        {
            var bytes = File.ReadAllBytes (&quot;use_cases.odt&quot;);
            var encoding = Encoding.UTF8;

            Console.WriteLine (encoding.GetString (bytes));
        }
    }
}
2. Compile it and put the attached odt file in the same dir as the exe file
3. Run the program from where the exe lies.
Actual Results:  
This exception:
Unhandled Exception: System.ArgumentException: Arg_InsufficientSpace
Parameter name: chars
  at System.Text.UTF8Encoding.InternalGetChars (System.Byte* bytes, Int32
byteCount, System.Char* chars, Int32 charCount, System.UInt32&amp; leftOverBits,
System.UInt32&amp; leftOverCount, System.Object provider,
System.Text.DecoderFallbackBuffer&amp; fallbackBuffer, System.Byte[]&amp; bufferArg,
Boolean flush) [0x00000] 
  at System.Text.UTF8Encoding.InternalGetChars (System.Byte[] bytes, Int32
byteIndex, Int32 byteCount, System.Char[] chars, Int32 charIndex,
System.UInt32&amp; leftOverBits, System.UInt32&amp; leftOverCount, System.Object
provider, System.Text.DecoderFallbackBuffer&amp; fallbackBuffer, System.Byte[]&amp;
bufferArg, Boolean flush) [0x00000] 
  at System.Text.UTF8Encoding.GetChars (System.Byte[] bytes, Int32 byteIndex,
Int32 byteCount, System.Char[] chars, Int32 charIndex) [0x00000] 
  at System.Text.Encoding.GetChars (System.Byte[] bytes, Int32 index, Int32
count) [0x00000] 
  at System.Text.Encoding.GetString (System.Byte[] bytes, Int32 index, Int32
count) [0x00000] 
  at System.Text.UTF8Encoding.GetString (System.Byte[] bytes, Int32 index,
Int32 count) [0x00000] 
  at System.Text.Encoding.GetString (System.Byte[] bytes) [0x00000] 
  at EncodingTest.MainClass.Main (System.String[] args) [0x00000] 


Expected Results:  
A string should be returned (printed with the example program)

Mono JIT compiler version 2.4.4 (Debian 2.4.4~svn151842-1ubuntu4)
Copyright (C) 2002-2010 Novell, Inc and Contributors. www.mono-project.com
        TLS:           __thread
        GC:            Included Boehm (with typed GC)
        SIGSEGV:       altstack
        Notifications: epoll
        Architecture:  x86
        Disabled:      none

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="101010.html">[Mono-bugs] [Bug 610044] [SDB] When trying to step into a method of a property, stepping out of the property get jumps over the method call
</A></li>
	<LI>Next message: <A HREF="101014.html">[Mono-bugs] [Bug 610453] New: Cannot use web interface after some	time.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#101012">[ date ]</a>
              <a href="thread.html#101012">[ thread ]</a>
              <a href="subject.html#101012">[ subject ]</a>
              <a href="author.html#101012">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
