<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 78352][Wis] New - System.Text.Encoding.UTF8 does
	not treat character 0xfeff (65279) The same way as Microsoft .Net
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2078352%5D%5BWis%5D%20New%20-%20System.Text.Encoding.UTF8%20does%0A%09not%20treat%20character%200xfeff%20%2865279%29%20The%20same%20way%20as%20Microsoft%20.Net&In-Reply-To=bug-78352%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042498.html">
   <LINK REL="Next"  HREF="042500.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 78352][Wis] New - System.Text.Encoding.UTF8 does
	not treat character 0xfeff (65279) The same way as Microsoft .Net</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2078352%5D%5BWis%5D%20New%20-%20System.Text.Encoding.UTF8%20does%0A%09not%20treat%20character%200xfeff%20%2865279%29%20The%20same%20way%20as%20Microsoft%20.Net&In-Reply-To=bug-78352%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 78352][Wis] New - System.Text.Encoding.UTF8 does
	not treat character 0xfeff (65279) The same way as Microsoft .Net">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Tue May  9 19:59:59 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="042498.html">[Mono-bugs] [Bug 78309][Nor] Changed - [GMCS] Assertion while
	compiling
</A></li>
        <LI>Next message: <A HREF="042500.html">[Mono-bugs] [Bug 78241][Maj] Changed - CreateThread failure/out of
	wapi handles slots
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42499">[ date ]</a>
              <a href="thread.html#42499">[ thread ]</a>
              <a href="subject.html#42499">[ subject ]</a>
              <a href="author.html#42499">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">scott at imeem.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=78352">http://bugzilla.ximian.com/show_bug.cgi?id=78352</A>

--- shadow/78352	2006-05-09 19:59:59.000000000 -0400
+++ shadow/78352.tmp.11597	2006-05-09 19:59:59.000000000 -0400
@@ -0,0 +1,54 @@
+Bug#: 78352
+Product: Mono: Class Libraries
+Version: 1.1
+OS: 
+OS Details: 
+Status: NEW   
+Resolution: 
+Severity: 
+Priority: Wishlist
+Component: System
+AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>                            
+ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">scott at imeem.com</A>               
+QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
+TargetMilestone: ---
+URL: 
+Cc: 
+Summary: System.Text.Encoding.UTF8 does not treat character 0xfeff (65279) The same way as Microsoft .Net
+
+Please fill in this template when reporting a bug, unless you know what you
+are doing.
+Description of Problem:
+The UTF8 code for charater 65279 is a 3 byte code, the windows libraries
+decode the byte combination to the correct single character. 
+The Mono implementation will decode this to an empty string
+
+
+Steps to reproduce the problem:
+
+byte[] stringBytes = new byte[3];
+// 3 byte chars....
+i = 65279;
+stringBytes[0] = (byte) (((i &gt;&gt; 12) &amp; 0x0f) | 0xe0);
+stringBytes[1] = (byte) (((i &gt;&gt; 6) &amp; 0x3f) | 0x80);
+stringBytes[2] = (byte) ((i &amp; 0x3f) | 0x80);
+
+string decoded = System.Text.Encoding.UTF8.GetString(stringBytes);
+Console.WriteLine(decoded.Length);
+
+
+Actual Results:
+0 
+(empty string on mono)
+
+Expected Results:
+1
+(1 character string on Messy windows)
+
+How often does this happen? 
+if you pick a random character? 1 in 2^16
+
+Additional Information:
+Character 65279 is a special byte ordering marker, it may have special
+meaning at the start of the string, so it's entirely possible that windows
+is doing the wrong thing here.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042498.html">[Mono-bugs] [Bug 78309][Nor] Changed - [GMCS] Assertion while
	compiling
</A></li>
	<LI>Next message: <A HREF="042500.html">[Mono-bugs] [Bug 78241][Maj] Changed - CreateThread failure/out of
	wapi handles slots
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42499">[ date ]</a>
              <a href="thread.html#42499">[ thread ]</a>
              <a href="subject.html#42499">[ subject ]</a>
              <a href="author.html#42499">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
