<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 78451][Maj] Changed - Trivial VB.NET WebForm runs
	on Mono 1.1.8, fails on 1.1.15. *No VB.NET web page will run at all*
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2078451%5D%5BMaj%5D%20Changed%20-%20Trivial%20VB.NET%20WebForm%20runs%0A%09on%20Mono%201.1.8%2C%20fails%20on%201.1.15.%20%2ANo%20VB.NET%20web%20page%20will%20run%20at%20all%2A&In-Reply-To=bug-78451%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043072.html">
   <LINK REL="Next"  HREF="043074.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 78451][Maj] Changed - Trivial VB.NET WebForm runs
	on Mono 1.1.8, fails on 1.1.15. *No VB.NET web page will run at all*</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2078451%5D%5BMaj%5D%20Changed%20-%20Trivial%20VB.NET%20WebForm%20runs%0A%09on%20Mono%201.1.8%2C%20fails%20on%201.1.15.%20%2ANo%20VB.NET%20web%20page%20will%20run%20at%20all%2A&In-Reply-To=bug-78451%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 78451][Maj] Changed - Trivial VB.NET WebForm runs
	on Mono 1.1.8, fails on 1.1.15. *No VB.NET web page will run at all*">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Thu May 18 20:26:57 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="043072.html">[Mono-bugs] [Bug 78452][Nor] Changed - MDI windows do not stay on
	the same desktop as the parent.
</A></li>
        <LI>Next message: <A HREF="043074.html">[Mono-bugs] [Bug 78451][Maj] Changed - Trivial VB.NET WebForm runs
	on Mono 1.1.8, fails on 1.1.15. *No VB.NET web page will run at all*
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43073">[ date ]</a>
              <a href="thread.html#43073">[ thread ]</a>
              <a href="subject.html#43073">[ subject ]</a>
              <a href="author.html#43073">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kevin-f at linkprior.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=78451">http://bugzilla.ximian.com/show_bug.cgi?id=78451</A>

--- shadow/78451	2006-05-18 19:31:16.000000000 -0400
+++ shadow/78451.tmp.10515	2006-05-18 20:26:57.000000000 -0400
@@ -91,6 +91,199 @@
 Additional Information:
 Same problem can be observed using Mono 1.1.15 on Windows, whereas works
 with Mono 1.1.8 on Windows.
 
 ------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gonzalo at ximian.com</A>  2006-05-18 19:31 -------
 That error means that mbas is not anywhere in your PATH.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kevin-f at linkprior.com</A>  2006-05-18 20:26 -------
+I have ensured mbas is in the path on SuSE, which has changed the
+behaviour (which now mirrors what was in fact different behaviour on
+Windows), but there is still a problem with 1.1.15 that is fine on
+1.1.8. I shall provide details of the changed behaviour below, but
+first of all I should like to make some observations which may
+indicate that pathing is not really the issue (observations before
+making path changes):
+
+1. The SuSE box has no mono directories in the path at all, not for
+1.1.8 nor 1.1.15. Yet xsp serves the page fine on 1.1.8, but not if
+switching to 1.1.15. 
+2. I can write exactly the same trivial WebForm in C# and it works
+fine on 1.1.8 and 1.1.15. The scripts mbas and mcs are in the same bin
+directories in their installed directories trees, so no difference in
+pathing.
+3. Since the WebForm had already been compiled into a dll in the bin
+subdirectory, is it not the case that there was no need for mbas at
+all? When I first began to develop with Mono, mbas was not very
+complete, so I had to compile on Windows then copy dll to SuSE. Still
+do, but now with 1.1.15 Mono appears to have begun to try to compile
+where it previously did not.
+
+Having added /opt/mono-1.1.15/bin to the path, if I execute this - 
+/opt/mono-1.1.15/bin/xsp --root . --port 8088 --applications /:.
+
+- then try to access the WebForm, this is the result - 
+Server Error in '/' Application
+Compilation Error
+Description: Error compiling a resource required to service this
+request. Review your source file and modify it to fix this error.
+
+Error message: /tmp/root-temp-aspnet-0/39b6c921/74457.0.vb(79,37) :
+error BC30524: Property 'Label1' lacks a 'get' accesor
+/tmp/root-temp-aspnet-0/39b6c921/74457.0.vb(87,13) : error BC30524:
+Property 'Label1' lacks a 'set' accesor
+/tmp/root-temp-aspnet-0/39b6c921/74457.0.vb(97,13) : error BC30524:
+Property 'TraceModeValue' lacks a 'set' accesor
+/tmp/root-temp-aspnet-0/39b6c921/74457.0.vb(52,27) : error BC30524:
+Property 'Context' lacks a 'get' accesor
+
+File name: /srv/www/HW/WebForm1.aspx
+
+Source File: /tmp/root-temp-aspnet-0/39b6c921/74457.0.vb
+
+Line 1:
+'------------------------------------------------------------------------------
+Line 2: ' &lt;autogenerated&gt;
+Line 3: '     This code was generated by a tool.
+Line 4: '     Mono Runtime Version: 1.1.4322.2032
+Line 5: '
+Line 6: '     Changes to this file may cause incorrect behavior and
+will be lost if 
+Line 7: '     the code is regenerated.
+Line 8: ' &lt;/autogenerated&gt;
+Line 9:
+'------------------------------------------------------------------------------
+Line 10: 
+Line 11: Option Explicit On
+Line 12: Option Strict Off
+Line 13: 
+Line 14: Imports System
+Line 15: Imports System.Collections
+Line 16: Imports System.Collections.Specialized
+Line 17: Imports System.Configuration
+Line 18: Imports System.Text
+Line 19: Imports System.Text.RegularExpressions
+Line 20: Imports System.Web
+Line 21: Imports System.Web.Caching
+Line 22: Imports System.Web.Security
+Line 23: Imports System.Web.SessionState
+Line 24: Imports System.Web.UI
+Line 25: Imports System.Web.UI.WebControls
+Line 26: Imports System.Web.UI.HtmlControls
+Line 27: 
+Line 28: Namespace ASP
+Line 29:     Public Class WebForm1_aspx
+Line 30:         Inherits HelloWorld.WebForm1
+Line 31:         Implements System.Web.SessionState.IRequiresSessionState
+Line 32:         
+Line 33:         Private Shared __initialized As Boolean = false
+Line 34:         
+Line 35:         Protected Form1 As System.Web.UI.HtmlControls.HtmlForm
+Line 36:         
+Line 37:         Public Sub New()
+Line 38:             MyBase.New()
+Line 39:             If (ASP.WebForm1_aspx.__initialized = false) Then
+Line 40:                 ASP.WebForm1_aspx.__initialized = true
+Line 41:             End If
+Line 42:         End Sub
+Line 43:         
+Line 44:         Protected Overrides ReadOnly Property
+SupportAutoEvents As Boolean
+Line 45:             Get
+Line 46:                 Return false
+Line 47:             End Get
+Line 48:         End Property
+Line 49:         
+Line 50:         Protected ReadOnly Property ApplicationInstance As
+System.Web.HttpApplication
+Line 51:             Get
+Line 52:                 Return CType(Me.Context.ApplicationInstance,
+System.Web.HttpApplication)
+Line 53:             End Get
+Line 54:         End Property
+Line 55:         
+Line 56:         Public Overrides ReadOnly Property
+TemplateSourceDirectory As String
+Line 57:             Get
+Line 58:                 Return &quot;/&quot;
+Line 59:             End Get
+Line 60:         End Property
+Line 61:         
+Line 62:         Private Sub __BuildControlTree(ByVal __ctrl As
+WebForm1_aspx)
+Line 63:             Dim __parser As System.Web.UI.IParserAccessor =
+CType(__ctrl, System.Web.UI.IParserAccessor)
+Line 64:             __parser.AddParsedSubObject(New
+System.Web.UI.LiteralControl(&quot;&lt;!DOCTYPE HTML PUBLIC &quot;&quot;-//W3C//DTD HTML
+4.0
+Transitional//EN&quot;&quot;&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;&quot;&lt;HTML&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;HEAD&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;title&gt;WebForm1&lt;/title&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;meta
+name=&quot;&quot;GENERATOR&quot;&quot; content=&quot;&quot;Microsoft Visual Studio .NET
+7.1&quot;&quot;&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;meta
+name=&quot;&quot;CODE_LANGUAGE&quot;&quot; content=&quot;&quot;Visual Basic .NET
+7.1&quot;&quot;&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;meta
+name=&quot;&quot;vs_defaultClientScript&quot;&quot;
+content=&quot;&quot;JavaScript&quot;&quot;&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;meta
+name=&quot;&quot;vs_targetSchema&quot;&quot;
+content=&quot;&quot;<A HREF="http://schemas.microsoft.com/intellisense/ie5&quot;&quot;">http://schemas.microsoft.com/intellisense/ie5&quot;&quot;</A>&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;/HEAD&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;body
+MS_POSITIONING=&quot;&quot;GridLayout&quot;&quot;&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)))
+Line 65:             Me.__BuildControl_Form1()
+Line 66:             __parser.AddParsedSubObject(Me.Form1)
+Line 67:             __parser.AddParsedSubObject(New
+System.Web.UI.LiteralControl(&quot;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;&quot;&lt;/body&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;&quot;&lt;/HTML&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)))
+Line 68:         End Sub
+Line 69:         
+Line 70:         Private Function __BuildControl_Form1() As
+System.Web.UI.Control
+Line 71:             Dim __ctrl As System.Web.UI.HtmlControls.HtmlForm
+Line 72:             __ctrl = New System.Web.UI.HtmlControls.HtmlForm()
+Line 73:             Me.Form1 = __ctrl
+Line 74:             __ctrl.ID = &quot;Form1&quot;
+Line 75:             __ctrl.Method = &quot;post&quot;
+Line 76:             Dim __parser As System.Web.UI.IParserAccessor =
+CType(__ctrl, System.Web.UI.IParserAccessor)
+Line 77:             __parser.AddParsedSubObject(New
+System.Web.UI.LiteralControl(&quot;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)))
+Line 78:             Me.__BuildControl_Label1()
+Line 79:             __parser.AddParsedSubObject(Me.Label1)
+Line 80:             __parser.AddParsedSubObject(New
+System.Web.UI.LiteralControl(&quot;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.ChrW(9)&amp;Microsoft.VisualBasic.ChrW(9)))
+Line 81:             Return __ctrl
+Line 82:         End Function
+Line 83:         
+Line 84:         Private Function __BuildControl_Label1() As
+System.Web.UI.Control
+Line 85:             Dim __ctrl As System.Web.UI.WebControls.Label
+Line 86:             __ctrl = New System.Web.UI.WebControls.Label()
+Line 87:             Me.Label1 = __ctrl
+Line 88:             __ctrl.ID = &quot;Label1&quot;
+Line 89:             CType(__ctrl,
+System.Web.UI.IAttributeAccessor).SetAttribute(&quot;style&quot;, &quot;Z-INDEX: 101;
+LEFT: 104px; POSITION: absolute; TOP: 96px&quot;)
+Line 90:             Dim __parser As System.Web.UI.IParserAccessor =
+CType(__ctrl, System.Web.UI.IParserAccessor)
+Line 91:             __parser.AddParsedSubObject(New
+System.Web.UI.LiteralControl(&quot;Label&quot;))
+Line 92:             Return __ctrl
+Line 93:         End Function
+Line 94:         
+Line 95:         Protected Overrides Sub FrameworkInitialize()
+Line 96:             MyBase.FrameworkInitialize()
+Line 97:             Me.TraceModeValue = System.Web.TraceMode.SortByTime
+Line 98:             Me.Request.ValidateInput()
+Line 99:             Me.__BuildControlTree(Me)
+Line 100:         End Sub
+Line 101:         
+Line 102:         Public Overrides Function GetTypeHashCode() As Integer
+Line 103:             Return 1822404600
+Line 104:         End Function
+Line 105:     End Class
+Line 106: End Namespace
+
+Note:
+1. If I then stop xsp and run xsp of Mono 1.1.8, the page is again
+served fine
+2. The error output above is in fact now the same error output
+produced on Windows with 1.1.15 - I had not noticed before that the
+error on Windows was different. The batch file used to launch xsp
+1.1.15 on Windows does indeed set the path so mbas can be found. 
+
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043072.html">[Mono-bugs] [Bug 78452][Nor] Changed - MDI windows do not stay on
	the same desktop as the parent.
</A></li>
	<LI>Next message: <A HREF="043074.html">[Mono-bugs] [Bug 78451][Maj] Changed - Trivial VB.NET WebForm runs
	on Mono 1.1.8, fails on 1.1.15. *No VB.NET web page will run at all*
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43073">[ date ]</a>
              <a href="thread.html#43073">[ thread ]</a>
              <a href="subject.html#43073">[ subject ]</a>
              <a href="author.html#43073">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
