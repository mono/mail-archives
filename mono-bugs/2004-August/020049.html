<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 63758][Cri] Changed - Assembly.Load fails in remoting scenario
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="020048.html">
   <LINK REL="Next"  HREF="020050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 63758][Cri] Changed - Assembly.Load fails in remoting scenario
   </H1>
    <B>bugzilla-daemon@bugzilla.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com"
       TITLE="[Mono-bugs] [Bug 63758][Cri] Changed - Assembly.Load fails in remoting scenario">bugzilla-daemon@bugzilla.ximian.com
       </A><BR>
    <I>Wed, 25 Aug 2004 09:18:16 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="020048.html">[Mono-bugs] [Bug 63981][Min] Changed - Sorting of strings difference in .NET and Mono
</A></li>
        <LI> Next message: <A HREF="020050.html">[Mono-bugs] [Bug 63758][Cri] Changed - Assembly.Load fails when loading MS.NET compiled assembly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20049">[ date ]</a>
              <a href="thread.html#20049">[ thread ]</a>
              <a href="subject.html#20049">[ subject ]</a>
              <a href="author.html#20049">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:vivek.varma@honeywell.com.">vivek.varma@honeywell.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=63758">http://bugzilla.ximian.com/show_bug.cgi?id=63758</A>

--- shadow/63758	2004-08-24 14:49:33.000000000 -0400
+++ shadow/63758.tmp.27741	2004-08-25 09:18:16.000000000 -0400
@@ -119,6 +119,182 @@
 
 ------- Additional Comments From <A HREF="mailto:lluis@ximian.com">lluis@ximian.com</A>  2004-08-24 14:49 -------
 I guess that the server has the same copy of ClassLib1.dll that the
 client has, right?
 
 What happens if you run both client and server in mono?
+
+------- Additional Comments From <A HREF="mailto:vivek.varma@honeywell.com">vivek.varma@honeywell.com</A>  2004-08-25 09:18 -------
+I guess that the server has the same copy of ClassLib1.dll that the
+client has, right?
+Vivek&gt;&gt;Not sure what you meant, but i do not have ClassLib1.dll 
+where the RemoteServer.exe runs
+
+
+What happens if you run both client and server in mono?
+Vivek&gt;&gt;Works fine. No exceptions or crashes.
+
+Vivek&gt;&gt;Have provided the sample code below.
+
+################# CODE STARTS HERE############################
+
+ClassLibrary1.cs (builds into ClassLibrary1.dll)
+************************************************
+using System;
+
+namespace ClassLibrary1
+{
+	public class Class1
+	{
+		public void foo()
+		{
+			Console.WriteLine(&quot;ClassLibrar1::foo&quot;);
+		}
+	}
+}
+
+
+ClassLibrary2.cs  (builds into ClassLibrary1.dll) references 
+ClassLibrary1.dll
+*********************************************************************
+**********
+using System;
+
+namespace ClassLibrary2
+{
+	public class Class1
+	{
+		public void foobar()
+		{
+			Console.WriteLine(&quot;ClassLibrary2::foobar&quot;);
+			ClassLibrary1.Class1 C1 = new 
+ClassLibrary1.Class1();
+		}
+	}
+}
+
+
+IRemotingServer.cs (builds into IRemotingServer.dll)
+****************************************************
+using System;
+
+namespace RemoteServer
+{
+	public interface IRemotingServer
+	{
+		void RemoteLoad(byte[] assembly);
+	}
+}
+
+
+RemoteObject.cs (builds into RemoteObject.dll) references 
+IRemotingServer.dll)
+*********************************************************************
+**********
+using System;
+
+namespace RemoteServer
+{
+		public class RemoteObject: 
+MarshalByRefObject,IRemotingServer
+		{
+			public void RemoteLoad(byte[] assembly)
+			{
+				System.Reflection.Assembly assm = 
+System.Reflection.Assembly.Load(assembly);
+				Console.WriteLine(&quot;Loaded : &quot; + 
+assm.FullName);
+			}
+
+		}
+}
+
+
+
+RemoteServer.cs (builds into RemoteServer.exe) references 
+RemoteObject.dll
+*********************************************************************
+******
+using System;
+using System.Runtime.Remoting;
+using System.Runtime.Remoting.Channels;
+using System.Runtime.Remoting.Channels.Tcp;
+
+namespace RemoteServer
+{
+	class Class1
+	{
+
+		static void Main(string[] args)
+		{
+
+			Console.WriteLine (&quot;Remote Server&quot;);
+
+			TcpChannel chan = new TcpChannel(8086);
+			ChannelServices.RegisterChannel(chan);
+		
+	RemotingConfiguration.RegisterWellKnownServiceType
+(Type.GetType
+(&quot;RemoteServer.RemoteObject,RemoteObject&quot;),&quot;MyRemoteObject&quot;, 
+WellKnownObjectMode.Singleton);
+
+			Console.WriteLine (&quot;Press &lt;Ctrl+C&gt; to 
+finish&quot;);
+			Console.ReadLine();
+		}
+	}
+}
+
+
+
+RemotingClient.cs (builds into RemoteClient.exe) refereces 
+IRemotingServer.dll and RemoteObject.dll
+*********************************************************************
+*******************************
+ClassLibrary1.dll &amp; ClassLibrary2.dll exist in the same folder where 
+RemoteClinet.exe exists
+*********************************************************************
+************************
+
+using System;
+using System.Runtime.Remoting;
+
+namespace RemoteClient
+{
+	class Class1
+	{
+		static void Main(string[] args)
+		{
+
+			
+			string assemblypathname = 
+@&quot;ClassLibrary2.dll&quot;;
+			System.IO.FileStream fs = 
+System.IO.File.OpenRead(assemblypathname);
+			System.IO.BinaryReader br = new 
+System.IO.BinaryReader(fs);
+			byte[] assembly = br.ReadBytes((int)
+br.BaseStream.Length);
+			br.Close();
+			fs.Close();
+			
+			MarshalByRefObject obj;
+			if(args.Length ==  0)
+				 obj = (MarshalByRefObject) 
+RemotingServices.Connect(typeof
+(RemoteServer.IRemotingServer), &quot;<A HREF="tcp://localhost:8086/MyRemoteObject"">tcp://localhost:8086/MyRemoteObject&quot;</A>
+);
+			else
+				obj = (MarshalByRefObject) 
+RemotingServices.Connect(typeof
+(RemoteServer.IRemotingServer), &quot;<A HREF="tcp://"">tcp://&quot;</A> + args[0] 
++ &quot;:8086/MyRemoteObject&quot;);
+			((RemoteServer.IRemotingServer)
+obj).RemoteLoad(assembly);
+	
+		}
+	}
+
+}
+
+################# CODE ENDS HERE############################
+

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="020048.html">[Mono-bugs] [Bug 63981][Min] Changed - Sorting of strings difference in .NET and Mono
</A></li>
	<LI> Next message: <A HREF="020050.html">[Mono-bugs] [Bug 63758][Cri] Changed - Assembly.Load fails when loading MS.NET compiled assembly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20049">[ date ]</a>
              <a href="thread.html#20049">[ thread ]</a>
              <a href="subject.html#20049">[ subject ]</a>
              <a href="author.html#20049">[ author ]</a>
         </LI>
       </UL>
</body></html>
