<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 437683] ToolStripSplitButton issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20437683%5D%20ToolStripSplitButton%20issues&In-Reply-To=bug-437683-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081462.html">
   <LINK REL="Next"  HREF="081257.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 437683] ToolStripSplitButton issues</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20437683%5D%20ToolStripSplitButton%20issues&In-Reply-To=bug-437683-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 437683] ToolStripSplitButton issues">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Oct 24 18:46:47 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="081462.html">[Mono-bugs] [Bug 437683] ToolStripSplitButton issues
</A></li>
        <LI>Next message: <A HREF="081257.html">[Mono-bugs] [Bug 437691] New: System.InvalidCastException: Cannot cast from source type to destination type. at System.Web. HttpApplicationFactory.AttachEvents (System.Web.HttpApplication app) [ 0x00000]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81494">[ date ]</a>
              <a href="thread.html#81494">[ thread ]</a>
              <a href="subject.html#81494">[ subject ]</a>
              <a href="author.html#81494">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=437683">https://bugzilla.novell.com/show_bug.cgi?id=437683</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">johnm at hlaustralia.com.au</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=437683#c5">https://bugzilla.novell.com/show_bug.cgi?id=437683#c5</A>





--- Comment #5 from John Mortlock &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">johnm at hlaustralia.com.au</A>&gt;  2008-10-24 16:46:46 MDT ---
One thing i found when testing this is that mono does not pass the correct
Mouse Location in the Mouse events, and this is why the bounds checking is
actually failing.

If you look at .NET it will pass the mouse location relative to the button
being pressed, in MONO it is relative to the ToolStrip itself.. Hence the first
button drop down button bounds check X coordinate is out by the GripMargin and
subsequent buttons have no hope.. 

Adding the folowing to ToolStripItem gives the correct mouse location and is
used in the OnMouseDown, etc events.

internal MouseEventArgs TranslateMouseEventArgs (MouseEventArgs mea)
{
return new MouseEventArgs (mea.Button, mea.Clicks, mea.X -
mouse_currently_over.Left, mea.Y, mea.Delta);
}

In ToolStripSplitButton.cs I also modified HandleClick
to use the translated mouse events.

MouseEventArgs mea = this.Owner.TranslateMouseEventArgs (e as MouseEventArgs);

Basically these changes fix the original problem in the task and also more
closely matches .NETs behaviour.

Thanks for your time!


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081462.html">[Mono-bugs] [Bug 437683] ToolStripSplitButton issues
</A></li>
	<LI>Next message: <A HREF="081257.html">[Mono-bugs] [Bug 437691] New: System.InvalidCastException: Cannot cast from source type to destination type. at System.Web. HttpApplicationFactory.AttachEvents (System.Web.HttpApplication app) [ 0x00000]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81494">[ date ]</a>
              <a href="thread.html#81494">[ thread ]</a>
              <a href="subject.html#81494">[ subject ]</a>
              <a href="author.html#81494">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
