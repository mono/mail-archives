<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 430040] TcpClient breaks after 1000 consecutive	connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20430040%5D%20TcpClient%20breaks%20after%201000%20consecutive%0A%09connections&In-Reply-To=bug-430040-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="080341.html">
   <LINK REL="Next"  HREF="080343.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 430040] TcpClient breaks after 1000 consecutive	connections</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20430040%5D%20TcpClient%20breaks%20after%201000%20consecutive%0A%09connections&In-Reply-To=bug-430040-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 430040] TcpClient breaks after 1000 consecutive	connections">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Oct  3 12:17:02 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="080341.html">[Mono-bugs] [Bug 417891] System.Net.ServicePointManager	FindServicePoint broken
</A></li>
        <LI>Next message: <A HREF="080343.html">[Mono-bugs] [Bug 430040] TcpClient breaks after 1000 consecutive	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80342">[ date ]</a>
              <a href="thread.html#80342">[ thread ]</a>
              <a href="subject.html#80342">[ subject ]</a>
              <a href="author.html#80342">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=430040">https://bugzilla.novell.com/show_bug.cgi?id=430040</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">webservices at landmarkdigital.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=430040#c6">https://bugzilla.novell.com/show_bug.cgi?id=430040#c6</A>





--- Comment #6 from WebServices Group &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">webservices at landmarkdigital.com</A>&gt;  2008-10-03 10:17:02 MDT ---
I have attached two archives which should enable you to manifest the described
symptoms.

The BugReportService.tgz attachment
(<A HREF="https://bugzilla.novell.com/attachment.cgi?id=243398">https://bugzilla.novell.com/attachment.cgi?id=243398</A>) contains the source and
binary for a web service.  In testing, I was running the service with the xsp2
utility.  The service contains a single method which accepts a hostname, a port
number, and a byte array as parameters.  The method attempts to create a
TCPClient connection with the specified host on the specified port, but does
not read or write anything on the socket.  The byte array parameter is unused,
but is apparently necessary to manifest the bug; when I removed that parameter,
the bug did not manifest.

The BugReportClient.zip attachment
(<A HREF="https://bugzilla.novell.com/attachment.cgi?id=243399">https://bugzilla.novell.com/attachment.cgi?id=243399</A>) contains the source and
binary for a VisualStudio/.Net client to the above web service.  The client
application creates ten threads which each repeatedly invoke the web service
200 times.  In testing, I have been connecting either to a host on my own
network or to a remote host (google.com).  Both scenarios trigger an error, but
the local network host error is different from the remote network host error. 
Apparently after 1012 successful connections, the remote network host
(google.com, port 80) scenario triggers the error:

System.Net.Sockets.SocketException: No such host is known
  at System.Net.Dns.GetHostByName (System.String hostName) [0x00000] 
  at System.Net.Sockets.TcpClient.Connect (System.String hostname, Int32 port)
[0x00000] 
  at System.Net.Sockets.TcpClient..ctor (System.String hostname, Int32 port)
[0x00000] 
  at BugReport.BugReportService.Connect (System.String serverName, Int32 port,
System.Byte[] data) [0x00000]

whereas the local network host scenario cast triggers the error:

System.Net.Sockets.SocketException: Too many open files
  at System.Net.Sockets.Socket..ctor (AddressFamily family, SocketType type,
ProtocolType proto) [0x00000] 
  at System.Net.Sockets.TcpClient.Init (AddressFamily family) [0x00000] 
  at System.Net.Sockets.TcpClient.Connect (System.Net.IPAddress[] ipAddresses,
Int32 port) [0x00000] 
  at System.Net.Sockets.TcpClient.Connect (System.String hostname, Int32 port)
[0x00000] 
  at System.Net.Sockets.TcpClient..ctor (System.String hostname, Int32 port)
[0x00000] 
  at BugReport.BugReportService.Connect (System.String serverName, Int32 port,
System.Byte[] data) [0x00000]


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>






































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="080341.html">[Mono-bugs] [Bug 417891] System.Net.ServicePointManager	FindServicePoint broken
</A></li>
	<LI>Next message: <A HREF="080343.html">[Mono-bugs] [Bug 430040] TcpClient breaks after 1000 consecutive	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80342">[ date ]</a>
              <a href="thread.html#80342">[ thread ]</a>
              <a href="subject.html#80342">[ subject ]</a>
              <a href="author.html#80342">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
