<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 486234] New: System.String.LastIndexOf(string, StringComparison) crashes when using StringComparison.Ordinal on empty strings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20486234%5D%20New%3A%20System.String.LastIndexOf%28string%2C%0A%20StringComparison%29%20crashes%20when%20using%20StringComparison.Ordinal%20on%0A%20empty%20strings&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="087155.html">
   <LINK REL="Next"  HREF="087252.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 486234] New: System.String.LastIndexOf(string, StringComparison) crashes when using StringComparison.Ordinal on empty strings</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20486234%5D%20New%3A%20System.String.LastIndexOf%28string%2C%0A%20StringComparison%29%20crashes%20when%20using%20StringComparison.Ordinal%20on%0A%20empty%20strings&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 486234] New: System.String.LastIndexOf(string, StringComparison) crashes when using StringComparison.Ordinal on empty strings">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Mar 17 17:45:53 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="087155.html">[Mono-bugs] [Bug 486225] cannot use URIs that end without /
</A></li>
        <LI>Next message: <A HREF="087252.html">[Mono-bugs] [Bug 486234] System.String.LastIndexOf(string, StringComparison) crashes when using StringComparison.Ordinal on empty strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87157">[ date ]</a>
              <a href="thread.html#87157">[ thread ]</a>
              <a href="subject.html#87157">[ subject ]</a>
              <a href="author.html#87157">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=486234">https://bugzilla.novell.com/show_bug.cgi?id=486234</A>


           Summary: System.String.LastIndexOf(string, StringComparison)
                    crashes when using StringComparison.Ordinal on empty
                    strings
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.4.x
          Platform: PowerPC
        OS/Version: Linux
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jan.pruente at alice-dsl.net</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Hello,

when LastIndexOf(&quot;any text&quot;, StringComparison.Ordinal) is invoked on an empty
(&quot;&quot;) string, it will crash instead of returning -1. The reason for this is that
LastIndexOf(string, StringComparison) calls LastIndexOf(string, this.Length -
1, this.Length, comparisonType). this.Length is 0 =&gt; this.Length - 1 = MAXINT.
This makes LastIndexOfOrdinal throw an ArgumentOutOfRangeException (for the
startIndex).

I tried replacing the original call by:
if (this.Length &gt;= 1)
  return LastIndexOf (value, this.Length - 1, this.Length, comparisonType);
else
  return -1;

But strangely, I could not get this to compile (The compiler crashes throwing
exceptions). I'm not sure if this is correct, how should the call behave when
it is invoked on an empty string with an empty string as parameter?
I don't have a Windows system, so I can't check it myself.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>




































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="087155.html">[Mono-bugs] [Bug 486225] cannot use URIs that end without /
</A></li>
	<LI>Next message: <A HREF="087252.html">[Mono-bugs] [Bug 486234] System.String.LastIndexOf(string, StringComparison) crashes when using StringComparison.Ordinal on empty strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87157">[ date ]</a>
              <a href="thread.html#87157">[ thread ]</a>
              <a href="subject.html#87157">[ subject ]</a>
              <a href="author.html#87157">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
