<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 381223] New: HttpWebResponse.Close() should only close the stream
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20381223%5D%20New%3A%20HttpWebResponse.Close%28%29%20should%20only%0A%20close%20the%20stream&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="072372.html">
   <LINK REL="Next"  HREF="072542.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 381223] New: HttpWebResponse.Close() should only close the stream</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20381223%5D%20New%3A%20HttpWebResponse.Close%28%29%20should%20only%0A%20close%20the%20stream&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 381223] New: HttpWebResponse.Close() should only close the stream">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Apr 18 05:15:08 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="072372.html">[Mono-bugs] [Bug 381219] Problem with DataSet on Viewstate
</A></li>
        <LI>Next message: <A HREF="072542.html">[Mono-bugs] [Bug 381223] HttpWebResponse.Close() should only close	the stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#72332">[ date ]</a>
              <a href="thread.html#72332">[ thread ]</a>
              <a href="subject.html#72332">[ subject ]</a>
              <a href="author.html#72332">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=381223">https://bugzilla.novell.com/show_bug.cgi?id=381223</A>


           Summary: HttpWebResponse.Close() should only close the stream
           Product: Mono: Class Libraries
           Version: SVN
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">informatique.internet at fiducial.fr</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Today if you call HttpWebResponse.Close(),it'll dispose the HttpWebResponse
object (and Dispose method close the stream...) According to msdn (and
behaviour of my test case on MS.NET 1.1) HttpWebResponse.Close() should just
close the stream

Try my test case :

// Main.cs created with MonoDevelop
// User: hubert at 16:41&#160;16/04/2008
//
// To change standard headers go to Edit-&gt;Preferences-&gt;Coding-&gt;Standard Headers
//
using System;
using System.Web.UI;
using System.Data;
using System.IO;
using System.Net;
using Npgsql;
using NpgsqlTypes;

namespace TestViewState
{
        class MainClass
        {
                public static void Main(string[] args)
                {
                        HttpWebRequest req =
(HttpWebRequest)WebRequest.Create(&quot;<A HREF="http://www.google.fr/pipo.aspx&quot;">http://www.google.fr/pipo.aspx&quot;</A>);
                        req.Method = &quot;GET&quot;;
                        req.Timeout=1000;
                        HttpWebResponse resp;
                        try
                        {
                                resp = (HttpWebResponse)req.GetResponse();      
                        }
                        catch (System.Net.WebException ex)
                        {
                                Console.WriteLine(&quot;ex :&quot;+ex);
                                resp = (HttpWebResponse)ex.Response;            
                        }
                        resp.Close();
                        Console.WriteLine(resp.StatusCode);
                        Console.WriteLine(resp.StatusDescription);
                }
        }
}

on mono it does:
ex :System.Net.WebException: The remote server returned an error: (404) Not
Found.
  at System.Net.HttpWebRequest.CheckFinalStatus (System.Net.WebAsyncResult
result) [0x002c7] in
/home/hubert/mono/mcs/class/System/System.Net/HttpWebRequest.cs:1310 
  at System.Net.HttpWebRequest.SetResponseData (System.Net.WebConnectionData
data) [0x00102] in
/home/hubert/mono/mcs/class/System/System.Net/HttpWebRequest.cs:1179 

Unhandled Exception: System.ObjectDisposedException: The object was used after
being disposed.
  at System.Net.HttpWebResponse.CheckDisposed () [0x0000b] in
/home/hubert/mono/mcs/class/System/System.Net/HttpWebResponse.cs:348 
  at System.Net.HttpWebResponse.get_StatusCode () [0x00000] in
/home/hubert/mono/mcs/class/System/System.Net/HttpWebResponse.cs:232 
  at (wrapper remoting-invoke-with-check)
System.Net.HttpWebResponse:get_StatusCode ()
  at TestViewState.MainClass.Main (System.String[] args) [0x0005f] in
/home/hubert/Projects/TestViewState/Main.cs:34 


on MS.NET it does

ex :System.Net.WebException: The remote server returned an error: (404) Not
Found.
  at System.Net.HttpWebRequest.CheckFinalStatus (System.Net.WebAsyncResult
result) [0x002c7] in
/home/hubert/mono/mcs/class/System/System.Net/HttpWebRequest.cs:1310 
  at System.Net.HttpWebRequest.SetResponseData (System.Net.WebConnectionData
data) [0x00102] in
/home/hubert/mono/mcs/class/System/System.Net/HttpWebRequest.cs:1179 

NotFound
NotFound


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>






















































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="072372.html">[Mono-bugs] [Bug 381219] Problem with DataSet on Viewstate
</A></li>
	<LI>Next message: <A HREF="072542.html">[Mono-bugs] [Bug 381223] HttpWebResponse.Close() should only close	the stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#72332">[ date ]</a>
              <a href="thread.html#72332">[ thread ]</a>
              <a href="subject.html#72332">[ subject ]</a>
              <a href="author.html#72332">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
