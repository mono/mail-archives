<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 324338] Thread.ApartmentState differences with MS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20324338%5D%20Thread.ApartmentState%20differences%20with%20MS&In-Reply-To=bug-324338-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="071690.html">
   <LINK REL="Next"  HREF="071692.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 324338] Thread.ApartmentState differences with MS</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20324338%5D%20Thread.ApartmentState%20differences%20with%20MS&In-Reply-To=bug-324338-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 324338] Thread.ApartmentState differences with MS">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Apr  7 07:13:08 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="071690.html">[Mono-bugs] [Bug 368492] [win32] OutOfMemoryException when using ToolStrip with Icons
</A></li>
        <LI>Next message: <A HREF="071692.html">[Mono-bugs] [Bug 368492] [win32] OutOfMemoryException when using ToolStrip with Icons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71691">[ date ]</a>
              <a href="thread.html#71691">[ thread ]</a>
              <a href="subject.html#71691">[ subject ]</a>
              <a href="author.html#71691">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=324338">https://bugzilla.novell.com/show_bug.cgi?id=324338</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at novell.com</A> added comment
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=324338#c1">https://bugzilla.novell.com/show_bug.cgi?id=324338#c1</A>


Dick Porter &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at novell.com</A>&gt; changed:

           What    |Removed                                         |Added
----------------------------------------------------------------------------
                 CC|                                                |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jonathan.chambers at ansys.com</A>
         AssignedTo|<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at novell.com</A>                                 |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>




--- Comment #1 from Dick Porter &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dick at novell.com</A>&gt;  2008-04-07 05:13:07 MST ---
I've fixed the exception throwing part in svn r100010

However, someone that understands COM apartment states is going to have to fix
the  behaviour when setting the state of the current thread on the 2.0 profile.
 Modifying your repro slightly to remove the
Thread.CurrentThread.ApartmentState = ApartmentState.Unknown; section shows
that the state stays at MTA throughout without that line.  It seems to suggest
that setting the state to Unknown clears the 'has already been set' state,
contrary to the documentation.  I've also no idea how to tell the COM internals
what to do here.

Reassigning back to general ownership, and CCing Jon Chambers for expert
opinion.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="071690.html">[Mono-bugs] [Bug 368492] [win32] OutOfMemoryException when using ToolStrip with Icons
</A></li>
	<LI>Next message: <A HREF="071692.html">[Mono-bugs] [Bug 368492] [win32] OutOfMemoryException when using ToolStrip with Icons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71691">[ date ]</a>
              <a href="thread.html#71691">[ thread ]</a>
              <a href="subject.html#71691">[ subject ]</a>
              <a href="author.html#71691">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
