<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 397934] New: DataSet. ReadXML is unable to read time zone information in a xs:dateTime column
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20397934%5D%20New%3A%20DataSet.%20ReadXML%20is%20unable%20to%20read%0A%20time%20zone%20information%20in%20a%20xs%3AdateTime%20column&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="074763.html">
   <LINK REL="Next"  HREF="074802.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 397934] New: DataSet. ReadXML is unable to read time zone information in a xs:dateTime column</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20397934%5D%20New%3A%20DataSet.%20ReadXML%20is%20unable%20to%20read%0A%20time%20zone%20information%20in%20a%20xs%3AdateTime%20column&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 397934] New: DataSet. ReadXML is unable to read time zone information in a xs:dateTime column">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Jun  6 08:57:50 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="074763.html">[Mono-bugs] [Bug 341420] DragDrop event not fired in ListView
</A></li>
        <LI>Next message: <A HREF="074802.html">[Mono-bugs] [Bug 397934] DataSet. ReadXML is unable to read time zone information in a xs:dateTime column
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74765">[ date ]</a>
              <a href="thread.html#74765">[ thread ]</a>
              <a href="subject.html#74765">[ subject ]</a>
              <a href="author.html#74765">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=397934">https://bugzilla.novell.com/show_bug.cgi?id=397934</A>


           Summary: DataSet.ReadXML is unable to read time zone information
                    in a xs:dateTime column
           Product: Mono: Class Libraries
           Version: 1.9.0
          Platform: x86
        OS/Version: Windows XP
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.Data
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">bnc-blr-team-mono at forge.provo.novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">novell at vokabeln.de</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Development


Description of Problem:

I created a System.Data.DataTable with a DateTime column and saved it into a
file using DataSet.WriteXML. Using the same code, the files created by .NET and
MONO 1.9.1 differ because, apparently, MONO saves DateTime values in a
different way: 

NET: 
&lt;TestColumn&gt;2008-06-06T07:07:00.009+02:00&lt;/TestColumn&gt; 
MONO: 
&lt;TestColumn&gt;2008-06-06T07:07:00.0088888&lt;/TestColumn&gt; 

MONO saves the milliseconds more accurately but seems to be unaware of time
zones. What's worse, however, is that when I create a file with .NET and then
try to read it with MONO I get an &quot;Invalid format&quot; error message: MONO does not
seem to be able to deal with the time zone information &quot;+02:00&quot; saved by .NET. 


Steps to reproduce the problem:

1. Compile the following C# console application into test.exe:

-----
using System;
using System.Collections.Generic;
using System.Text;
using System.Data;

namespace DataSetDateTime
{
    class test
    {
        static void Main(string[] args)
        {
            if (args.Length &lt; 2)
            {
                Console.WriteLine(&quot;please use syntax 'test.exe write
filename.xls' or 'test.exe read filename.xls'&quot;);
            }
            else
            {
                if (args[0] == &quot;write&quot;)
                    CreateFile(args[1]);
                if (args[0] == &quot;read&quot;)
                    ReadFile(args[1]);
            }
        }

        private static void CreateFile(string testFile)
        {
            DateTime myDate = DateTime.Parse(&quot;06.06.2008
07:07&quot;).AddMilliseconds(8.8888);
            DataTable testTable = new DataTable(&quot;TestTable&quot;);
            testTable.Columns.Add(&quot;TestColumn&quot;,
Type.GetType(&quot;System.DateTime&quot;));
            DataRow testRow = testTable.NewRow();
            testRow[&quot;TestColumn&quot;] = myDate;
            testTable.Rows.Add(testRow);
            DataSet testDataSet = new DataSet(&quot;TestDataSet&quot;);
            testDataSet.Tables.Add(testTable);
            testDataSet.WriteXml(testFile, XmlWriteMode.WriteSchema);
            Console.WriteLine(&quot;Success&quot;);
        }

        private static void ReadFile(string testFile)
        {
             try 
             {
                DataSet testDataSet = new DataSet();
                testDataSet.ReadXml(testFile, XmlReadMode.ReadSchema);
                Console.WriteLine(&quot;Success&quot;);
             }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
            }
        }
    }
}
-----


2. Start &quot;Mono Command Prompt&quot; and create two files by prompting

test.exe write filecreatedbynet.xml
mono test.exe write filecreatedbymono.xml

3. Open the xml files (using Editor etc.) and compare the way the datetime
information is written by .NET and MONO

4. Now see what happens when you try to read the files using .NET and MONO:

mono test.exe read filecreatedbynet.xml
mono test.exe read filecreatedbymono.xml
test.exe read filecreatedbynet.xml
test.exe read filecreatedbymono.xml


Actual Results:

Step 3: The files created by .NET and MONO differ because .NET includes a time
zone information such as &quot;+02:00&quot; in the DateTime value whereas MONO does not. 

Step 4: The first command &quot;mono test.exe read filecreatedbynet.xml&quot; produces
the error message &quot;Invalid format.&quot;; all the other commands are successful. 


Expected Results:

Step 3: The files created by .NET and MONO should be equal, i.e. MONO should
write time zone information as well. 

Step 4: MONO should be able to read time zone information, i.e. &quot;mono test.exe
read filecreatedbynet.xml&quot; should result in &quot;Success&quot; as well instead of
throwing an exception. 


How often does this happen? 

Always. 


Additional Information:

None


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>



















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="074763.html">[Mono-bugs] [Bug 341420] DragDrop event not fired in ListView
</A></li>
	<LI>Next message: <A HREF="074802.html">[Mono-bugs] [Bug 397934] DataSet. ReadXML is unable to read time zone information in a xs:dateTime column
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74765">[ date ]</a>
              <a href="thread.html#74765">[ thread ]</a>
              <a href="subject.html#74765">[ subject ]</a>
              <a href="author.html#74765">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
