<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 397612] New: Mutually exclusive behaviour between Mono and MS. NET for xs:import
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20397612%5D%20New%3A%20Mutually%20exclusive%20behaviour%20between%0A%20Mono%20and%20MS.%20NET%20for%20xs%3Aimport&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="074731.html">
   <LINK REL="Next"  HREF="074733.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 397612] New: Mutually exclusive behaviour between Mono and MS. NET for xs:import</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20397612%5D%20New%3A%20Mutually%20exclusive%20behaviour%20between%0A%20Mono%20and%20MS.%20NET%20for%20xs%3Aimport&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 397612] New: Mutually exclusive behaviour between Mono and MS. NET for xs:import">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Jun  5 14:39:03 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="074731.html">[Mono-bugs] [Bug 362034] Halo 3 not detecting Moonlight
</A></li>
        <LI>Next message: <A HREF="074733.html">[Mono-bugs] [Bug 397612] Mutually exclusive behaviour between Mono and MS.NET for xs: import
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74732">[ date ]</a>
              <a href="thread.html#74732">[ thread ]</a>
              <a href="subject.html#74732">[ subject ]</a>
              <a href="author.html#74732">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=397612">https://bugzilla.novell.com/show_bug.cgi?id=397612</A>


           Summary: Mutually exclusive behaviour between Mono and MS.NET for
                    xs:import
           Product: Mono: Class Libraries
           Version: SVN
          Platform: x86-64
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.XML
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">atsushi at ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">james.fitzsimons at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


There is a mutually exclusive behaviour between Mono and MS.NET when a schema
references another schema using the xs:import syntax. This means that
applications that rely on this functionality (such as Spring.Net) aren't
portable across runtimes.

Scenario: You have and XmlSchemaSet that contains two schemas A &amp; B and A
references B via an xs:import 

On Mono unless the schemaLocation attribute is supplied an
&quot;System.Xml.Schema.XmlSchemaException : XmlSchema error: Required attribute
name must be present Related schema item SourceUri: &quot;. For example:

System.Xml.Schema.XmlSchemaException : XmlSchema error: Referenced group
<A HREF="http://tempuri.org/importedNamespace.xsd:objectList">http://tempuri.org/importedNamespace.xsd:objectList</A> was not found in the
corresponding schema. Related schema item SourceUri:
<A HREF="file:///home/james/Desktop/mono/svnbuild/svn/mcs/class/System.XML/Test/XmlFiles/xsd/importNamespaceTest.xsd,">file:///home/james/Desktop/mono/svnbuild/svn/mcs/class/System.XML/Test/XmlFiles/xsd/importNamespaceTest.xsd,</A>
Line 15, Position 8.


On the MS.NET if the schemaLocation is supplied, an exception with the message
&quot;The global element '{namespace:elementname}' has already been declared&quot; is
thrown.
For example: 

System.Configuration.ConfigurationErrorsException: Error creating context
'spring.root': The global element '<A HREF="http://www.sprin">http://www.sprin</A>

gframework.net:objects' has already been declared. ---&gt;
Spring.Util.FatalReflectionException: Cannot instantiate Type [Spring

Context.Support.XmlApplicationContext] using ctor [Void .ctor(System.String,
Boolean, System.String[])] : 'Exception has bee

n thrown by the target of an invocation.' ---&gt;
System.Reflection.TargetInvocationException: Exception has been thrown by the

target of an invocation. ---&gt;
Spring.Objects.Factory.ObjectDefinitionStoreException: Unexpected exception
parsing XML documen

t from config [spring/objects]Inner exception message= The global element
'<A HREF="http://www.springframework.net:objects'">http://www.springframework.net:objects'</A> has alread

y been declared. ---&gt; System.Xml.Schema.XmlSchemaValidationException: The
global element '<A HREF="http://www.springframework.net:obje">http://www.springframework.net:obje</A>

cts' has already been declared.

   at
System.Xml.Schema.XmlSchemaValidator.SendValidationEvent(XmlSchemaValidationException
e, XmlSeverityType severity)

   at
System.Xml.Schema.XmlSchemaValidator.SendValidationEvent(XmlSchemaException e)

   at System.Xml.Schema.XmlSchemaValidator.RecompileSchemaSet()

   at System.Xml.Schema.XmlSchemaValidator.Init()

   at System.Xml.Schema.XmlSchemaValidator..ctor(XmlNameTable nameTable,
XmlSchemaSet schemas, IXmlNamespaceResolver namespac

eResolver, XmlSchemaValidationFlags validationFlags)

On the MS.NET runtime omitting the schemaLocation works as expected. My
hypothesis is that they keep the schemas stored keyed by namespace and if they
encounter an import they check their cache by namespace to see if it already
exists in the set and if so use that.

The W3C documentation (<A HREF="http://www.w3.org/TR/xmlschema-0/#schemaLocation">http://www.w3.org/TR/xmlschema-0/#schemaLocation</A>) states
that schemaLocation attribute is optional, which seems a further argument for
changing this behaviour in Mono.

I propose a change to Monos behaviour such that if the schemaLocation is
omitted it checks the other schemas in the schema set for a match by namespace
first before throwing an exception. This would make it functionally equivalent
to the MS.NET implementation and bring it inline with the W3C documentation.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="074731.html">[Mono-bugs] [Bug 362034] Halo 3 not detecting Moonlight
</A></li>
	<LI>Next message: <A HREF="074733.html">[Mono-bugs] [Bug 397612] Mutually exclusive behaviour between Mono and MS.NET for xs: import
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74732">[ date ]</a>
              <a href="thread.html#74732">[ thread ]</a>
              <a href="subject.html#74732">[ subject ]</a>
              <a href="author.html#74732">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
