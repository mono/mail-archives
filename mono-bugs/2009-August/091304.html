<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 312172] [2.0] BeginRead on console input blocks	program exit
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20312172%5D%20%5B2.0%5D%20BeginRead%20on%20console%20input%20blocks%0A%09program%20exit&In-Reply-To=bug-312172-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="091302.html">
   <LINK REL="Next"  HREF="091305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 312172] [2.0] BeginRead on console input blocks	program exit</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20312172%5D%20%5B2.0%5D%20BeginRead%20on%20console%20input%20blocks%0A%09program%20exit&In-Reply-To=bug-312172-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 312172] [2.0] BeginRead on console input blocks	program exit">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Aug  6 14:58:57 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="091302.html">[Mono-bugs] [Bug 512807] DataGridView poor performance for moderate number of records (1000) makes it unusable
</A></li>
        <LI>Next message: <A HREF="091305.html">[Mono-bugs] [Bug 504606] The cpu has been disabled by the guest	operating system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#91304">[ date ]</a>
              <a href="thread.html#91304">[ thread ]</a>
              <a href="subject.html#91304">[ subject ]</a>
              <a href="author.html#91304">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=312172">http://bugzilla.novell.com/show_bug.cgi?id=312172</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">aki.viper at gmail.com</A> added comment
<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=312172#c3">http://bugzilla.novell.com/show_bug.cgi?id=312172#c3</A>


Andrew Kurochka &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">aki.viper at gmail.com</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
                 CC|                            |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">aki.viper at gmail.com</A>




--- Comment #3 from Andrew Kurochka &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">aki.viper at gmail.com</A>&gt;  2009-08-06 12:58:52 MDT ---
I've checked code above and it really behaves differently on Mono. BeginRead
blocks calling thread. Actually, all BeginXXX methods of Console class are
blocking. The problem is that all standard console streams are created as
FileStream with isAsync flag set to false.

[SecurityPermission (SecurityAction.Assert, UnmanagedCode = true)]
public static Stream OpenStandardInput (int bufferSize)
{
    try {
        return new FileStream (MonoIO.ConsoleInput, FileAccess.Read, false,
bufferSize, false /*This argument*/, bufferSize == 0);
    } catch (IOException) {
        return new NullStream ();
    }
}

As result BeginXXX operations are handled by Stream class which, unlike it's
NET variant, executes them syncroniously.

I've tried to use async versions of FileStream contructors and everything seems
to work and behave fine. Waere there reasons to use sync version of FileStream
constructors? Should it be fixed?

What makes me curious, why Mono variant of the Stream class handles differently
BeginXXX methods?

PS Sorry, for long post, I'm new to Mono codebase and trying not to mess up.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="091302.html">[Mono-bugs] [Bug 512807] DataGridView poor performance for moderate number of records (1000) makes it unusable
</A></li>
	<LI>Next message: <A HREF="091305.html">[Mono-bugs] [Bug 504606] The cpu has been disabled by the guest	operating system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#91304">[ date ]</a>
              <a href="thread.html#91304">[ thread ]</a>
              <a href="subject.html#91304">[ subject ]</a>
              <a href="author.html#91304">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
