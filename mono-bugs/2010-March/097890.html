<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 584198] New: Improvements to /proc/cpuinfo parsing on ARM, notably for qemu
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20584198%5D%20New%3A%20Improvements%20to%20/proc/cpuinfo%20parsing%0A%20on%20ARM%2C%20notably%20for%20qemu&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="097889.html">
   <LINK REL="Next"  HREF="097891.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 584198] New: Improvements to /proc/cpuinfo parsing on ARM, notably for qemu</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20584198%5D%20New%3A%20Improvements%20to%20/proc/cpuinfo%20parsing%0A%20on%20ARM%2C%20notably%20for%20qemu&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 584198] New: Improvements to /proc/cpuinfo parsing on ARM, notably for qemu">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Mar  1 04:43:37 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="097889.html">[Mono-bugs] [Bug 584050] ServerCertificateValidationCallback receives wrong certificate chain
</A></li>
        <LI>Next message: <A HREF="097891.html">[Mono-bugs] [Bug 584198] Improvements to /proc/cpuinfo parsing on ARM, notably for qemu
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97890">[ date ]</a>
              <a href="thread.html#97890">[ thread ]</a>
              <a href="subject.html#97890">[ subject ]</a>
              <a href="author.html#97890">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=584198">http://bugzilla.novell.com/show_bug.cgi?id=584198</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=584198#c0">http://bugzilla.novell.com/show_bug.cgi?id=584198#c0</A>


           Summary: Improvements to /proc/cpuinfo parsing on ARM, notably
                    for qemu
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.4.x
          Platform: All
        OS/Version: Ubuntu
            Status: NEW
          Severity: Minor
          Priority: P5 - None
         Component: JIT
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lool at dooz.org</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=345551)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=345551">http://bugzilla.novell.com/attachment.cgi?id=345551</A>)
ARM cpuinfo parsing improvements dpatch

User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; fr; rv:1.9.2)
Gecko/20100222 Ubuntu/10.04 (lucid) Firefox/3.6

Hi

The mono ARM JIT implementation reads /proc/cpuinfo to check the family of the
ARM CPU it's running on and whether it supports Thumb.  When cpuinfo is missing
or has data mono can't parse, it assumes non-thumb and &lt;= ARMv4, and if you urn
some thumb code, it triggers an assertion failure.

/proc/cpuinfo is typically missing in chroots if you don't mount /proc, and
might have bogus data when using qemu-arm syscall emulation; the latter is
clearly a qemu bug, but I think it makes sense to improve the cpudetection
routine to handle the case where the data doesn't seem like it's an ARM CPU. 
The parsing is relatively weak in that it looks for &quot;(v&quot; in the Processor line
and uses the digit after that to decide of the ARM family.

I'd like to propose merging the attached patch.

One important thing to keep in mind is that families older than ARMv4 (and in
fact even some ARMv4 families) aren't supported anymore and all ARMv5 and later
families have Thumb.  So I believe the only case where we care that Thumb might
not be enabled is when Processor is ARMv4 and Features lacks &quot;thumb&quot;.

Thanks,

Reproducible: Always

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="097889.html">[Mono-bugs] [Bug 584050] ServerCertificateValidationCallback receives wrong certificate chain
</A></li>
	<LI>Next message: <A HREF="097891.html">[Mono-bugs] [Bug 584198] Improvements to /proc/cpuinfo parsing on ARM, notably for qemu
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97890">[ date ]</a>
              <a href="thread.html#97890">[ thread ]</a>
              <a href="subject.html#97890">[ subject ]</a>
              <a href="author.html#97890">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
