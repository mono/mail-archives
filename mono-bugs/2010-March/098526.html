<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 589474] calling WebBrowser.Dispose() Seg faults
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20589474%5D%20calling%20WebBrowser.Dispose%28%29%20Seg%20faults&In-Reply-To=bug-589474-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="098319.html">
   <LINK REL="Next"  HREF="098527.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 589474] calling WebBrowser.Dispose() Seg faults</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20589474%5D%20calling%20WebBrowser.Dispose%28%29%20Seg%20faults&In-Reply-To=bug-589474-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 589474] calling WebBrowser.Dispose() Seg faults">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Mar 25 23:42:30 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="098319.html">[Mono-bugs] [Bug 589474] New: calling WebBrowser.Dispose() Seg	faults
</A></li>
        <LI>Next message: <A HREF="098527.html">[Mono-bugs] [Bug 589474] calling WebBrowser.Dispose() Seg faults
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98526">[ date ]</a>
              <a href="thread.html#98526">[ thread ]</a>
              <a href="subject.html#98526">[ subject ]</a>
              <a href="author.html#98526">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=589474">http://bugzilla.novell.com/show_bug.cgi?id=589474</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=589474#c1">http://bugzilla.novell.com/show_bug.cgi?id=589474#c1</A>


--- Comment #1 from tom hindle &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">tom_hindle at sil.org</A>&gt; 2010-03-26 03:42:27 UTC ---
Created an attachment (id=350713)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=350713">http://bugzilla.novell.com/attachment.cgi?id=350713</A>)
Test case showing seg fault creating and displaying two web browsers
sequentially

The seconded attached test case shows that is not possible to show a WebBrowser
then close it down and then show it again.


The believe this is caused by gluezilla semi cleaning it XPCom / xul objects. 
However I have experimented with also doing a NS_ShutdownXPCOM() (in addition
to XPComGlueShutdown in Widget.cpp) but this caused it to break in other areas.
Possibly some of the XPCom object are brittle, and can't handle the XPCom
init/Shutdown cycle happening multiple times in a single process instance.

I also tried disabling the XPCom shutdown and only doing the initialization
once and this improved matters meaning I could display the the WebBrowser
multiple times, however each additional WebBrowser create got progressively
slower until the create hung.

The third thing I tried was to create a libgluzilla wrapper which dlopened and
dlclosed the real libgluzilla, on each init and shutdown, to ensure XPCom
global vars were not persisted. This seem to improve matters but caused issues
with the 'NativeEmbedWidget' user defined type (I think it registers it self
with some global defined data struct, and doesn't take kindly to being dlcosed
and then  dl(re)opened)

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="098319.html">[Mono-bugs] [Bug 589474] New: calling WebBrowser.Dispose() Seg	faults
</A></li>
	<LI>Next message: <A HREF="098527.html">[Mono-bugs] [Bug 589474] calling WebBrowser.Dispose() Seg faults
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98526">[ date ]</a>
              <a href="thread.html#98526">[ thread ]</a>
              <a href="subject.html#98526">[ subject ]</a>
              <a href="author.html#98526">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
