<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 585968] New: XmlDataSource does not update cache when DataFile property changes.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20585968%5D%20New%3A%20XmlDataSource%20does%20not%20update%20cache%0A%20when%20DataFile%20property%20changes.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="098094.html">
   <LINK REL="Next"  HREF="098047.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 585968] New: XmlDataSource does not update cache when DataFile property changes.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20585968%5D%20New%3A%20XmlDataSource%20does%20not%20update%20cache%0A%20when%20DataFile%20property%20changes.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 585968] New: XmlDataSource does not update cache when DataFile property changes.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Mar  5 16:21:59 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="098094.html">[Mono-bugs] [Bug 585933] DropDownList items and GridView columns don't translate.
</A></li>
        <LI>Next message: <A HREF="098047.html">[Mono-bugs] [Bug 585968] XmlDataSource does not update cache when DataFile property changes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98046">[ date ]</a>
              <a href="thread.html#98046">[ thread ]</a>
              <a href="subject.html#98046">[ subject ]</a>
              <a href="author.html#98046">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=585968">http://bugzilla.novell.com/show_bug.cgi?id=585968</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=585968#c0">http://bugzilla.novell.com/show_bug.cgi?id=585968#c0</A>


           Summary: XmlDataSource does not update cache when DataFile
                    property changes.
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.6.x
          Platform: All
        OS/Version: All
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: Sys.Web
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kuritsu at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=346901)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=346901">http://bugzilla.novell.com/attachment.cgi?id=346901</A>)
MonoDevelop project that demostrates the bug.

User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; es-MX; rv:1.9.1.5)
Gecko/20091109 Ubuntu/9.10 (karmic) Firefox/3.5.5

I have an ASP.NET web page with a GridView and an associated XmlDataSource.
When I change during a postback the value of the DataFile property of the
XmlDataSource, and then invoke gridView.DataBind(), the data of the grid
remains the same. I also tried with other databound controls like DropDownList
and so on, so the problem is the XmlDataSource, which does not update its cache
when the DataFile or Data properties change.

Reproducible: Always

Steps to Reproduce:
1. Create a C# ASP.NET project using MonoDevelop.
2. In the default page, inside the runat=&quot;server&quot; form tag, put the following
code:

&lt;asp:GridView ID=&quot;gvData&quot; runat=&quot;server&quot; DataSourceID=&quot;xdsData&quot;
AutoGenerateColumns=&quot;false&quot; &gt;
    &lt;Columns&gt;
        &lt;asp:BoundField DataField=&quot;name&quot; HeaderText=&quot;Name&quot;
                    SortExpression=&quot;name&quot; /&gt;
        &lt;asp:BoundField DataField=&quot;description&quot; HeaderText=&quot;Description&quot; 
            SortExpression=&quot;description&quot; /&gt;
    &lt;/Columns&gt;
&lt;/asp:GridView&gt;
&lt;asp:XmlDataSource ID=&quot;xdsData&quot; runat=&quot;server&quot; DataFile=&quot;~/data1.xml&quot;
XPath=&quot;/root/element&quot; /&gt;
&lt;asp:Button id=&quot;btnChange&quot; runat=&quot;server&quot; Text=&quot;Change XML!&quot;
OnClick=&quot;btnChange_Click&quot; /

3. In the code behind, inside the page class, put the following code:

protected void btnChange_Click (object sender, System.EventArgs e)
{
    Session[&quot;DataFile&quot;] = ((string)Session[&quot;DataFile&quot;] == &quot;~/data2.xml&quot;) ?
&quot;~/data1.xml&quot; : &quot;~/data2.xml&quot;;
    xdsData.DataFile = (string)Session[&quot;DataFile&quot;];
    gvData.DataBind();
}

4. Add two XML files in the root folder of the project:

data1.xml:

&lt;root&gt;
    &lt;element name=&quot;John&quot; description=&quot;administrator&quot; /&gt;
    &lt;element name=&quot;David&quot; description=&quot;art director&quot; /&gt;
    &lt;element name=&quot;Anna&quot; description=&quot;finances&quot; /&gt;
&lt;/root&gt;

data2.xml:

&lt;root&gt;
    &lt;element name=&quot;Pedro&quot; description=&quot;peon&quot; /&gt;
    &lt;element name=&quot;Juan&quot; description=&quot;alfil&quot; /&gt;
    &lt;element name=&quot;Troya&quot; description=&quot;torre&quot; /&gt;
&lt;/root&gt;

5. Run the web site and enter the Default Page.

6. Click the Change XML button several times and see what happens.
Actual Results:  
No changes. The grid still shows the same data.

Expected Results:  
The data of the grid changes every time the button is clicked.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="098094.html">[Mono-bugs] [Bug 585933] DropDownList items and GridView columns don't translate.
</A></li>
	<LI>Next message: <A HREF="098047.html">[Mono-bugs] [Bug 585968] XmlDataSource does not update cache when DataFile property changes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98046">[ date ]</a>
              <a href="thread.html#98046">[ thread ]</a>
              <a href="subject.html#98046">[ subject ]</a>
              <a href="author.html#98046">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
