<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 585933] New: DropDownList items and GridView columns don't translate.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20585933%5D%20New%3A%20DropDownList%20items%20and%20GridView%0A%20columns%20don%27t%20translate.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="098039.html">
   <LINK REL="Next"  HREF="098041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 585933] New: DropDownList items and GridView columns don't translate.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20585933%5D%20New%3A%20DropDownList%20items%20and%20GridView%0A%20columns%20don%27t%20translate.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 585933] New: DropDownList items and GridView columns don't translate.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Mar  5 14:48:54 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="098039.html">[Mono-bugs] [Bug 576426] Windows.Forms app gives kCGErrorCannotComplete, invalid device window errors
</A></li>
        <LI>Next message: <A HREF="098041.html">[Mono-bugs] [Bug 585933] DropDownList items and GridView columns don't translate.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98040">[ date ]</a>
              <a href="thread.html#98040">[ thread ]</a>
              <a href="subject.html#98040">[ subject ]</a>
              <a href="author.html#98040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=585933">http://bugzilla.novell.com/show_bug.cgi?id=585933</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=585933#c0">http://bugzilla.novell.com/show_bug.cgi?id=585933#c0</A>


           Summary: DropDownList items and GridView columns don't
                    translate.
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.6.x
          Platform: All
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.Web
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mhabersack at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">kuritsu at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=346878)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=346878">http://bugzilla.novell.com/attachment.cgi?id=346878</A>)
A MonoDevelop project that shows the bug.

User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; es-MX; rv:1.9.1.5)
Gecko/20091109 Ubuntu/9.10 (karmic) Firefox/3.5.5

I have an ASP.NET web page with a DropDownList with items with the
meta:resourcekey attribute. I also have a GridView with columns defined by
BoundFields that also have the meta:resourcekey attribute. I also have .resx
files with the correct names and strings for several cultures/languages, inside
the App_LocalResources directory. I also set culture=&quot;auto&quot; as attribute of the
@Page tag inside the aspx file. In the code behind, I override the
InitializeCulture and set the thread and page culture to the one set in a
session variable. I also put several buttons to change the page's
language/culture and a label with meta:resourcekey to show that the culture
changes correctly. The problem is that nor ListItems from the DropDownList nor
BoundFields from the GridView are translated. This page runs successfully using
Microsoft .NET Framework. 

Reproducible: Always

Steps to Reproduce:
1. Create a C# ASP.NET project using MonoDevelop.
2. In the Default page aspx file, add the following attribute to the &lt;%@ Page
tag: culture=&quot;auto&quot;
3. Inside the form runat=&quot;server&quot; tag, put the following code:

        &lt;asp:Button id=&quot;btnEnglish&quot; runat=&quot;server&quot; Text=&quot;English!&quot;
OnClick=&quot;btnEnglishClicked&quot; /&gt;
        &lt;asp:Button id=&quot;btnEspanol&quot; runat=&quot;server&quot; Text=&quot;Espa&#241;ol!&quot;
OnClick=&quot;btnEspanolClicked&quot; /&gt;
        &lt;asp:Label ID=&quot;lblDayOfWeek&quot; runat=&quot;server&quot;
meta:resourcekey=&quot;lblDayOfWeekResource1&quot; Text=&quot;Day of week: &quot;&gt;&lt;/asp:Label&gt;
        &lt;asp:DropDownList ID=&quot;ddlDayOfWeek&quot; runat=&quot;server&quot; 
            meta:resourcekey=&quot;ddlDayOfWeekResource1&quot;&gt;
            &lt;asp:ListItem
meta:resourcekey=&quot;ListItemResource1&quot;&gt;Sunday&lt;/asp:ListItem&gt;
            &lt;asp:ListItem
meta:resourcekey=&quot;ListItemResource2&quot;&gt;Monday&lt;/asp:ListItem&gt;
            &lt;asp:ListItem
meta:resourcekey=&quot;ListItemResource3&quot;&gt;Tuesday&lt;/asp:ListItem&gt;
            &lt;asp:ListItem
meta:resourcekey=&quot;ListItemResource4&quot;&gt;Wednesday&lt;/asp:ListItem&gt;
            &lt;asp:ListItem
meta:resourcekey=&quot;ListItemResource5&quot;&gt;Thursday&lt;/asp:ListItem&gt;
            &lt;asp:ListItem
meta:resourcekey=&quot;ListItemResource6&quot;&gt;Friday&lt;/asp:ListItem&gt;
            &lt;asp:ListItem
meta:resourcekey=&quot;ListItemResource7&quot;&gt;Saturday&lt;/asp:ListItem&gt;
        &lt;/asp:DropDownList&gt;
        &lt;asp:GridView ID=&quot;gvData&quot; runat=&quot;server&quot; DataSourceID=&quot;xdsData&quot;
AutoGenerateColumns=&quot;false&quot; &gt;
            &lt;Columns&gt;
                &lt;asp:BoundField DataField=&quot;name&quot; HeaderText=&quot;Name&quot;
meta:resourcekey=&quot;BoundFieldResource1&quot;
                            SortExpression=&quot;name&quot; /&gt;
                &lt;asp:BoundField DataField=&quot;description&quot;
HeaderText=&quot;Description&quot; meta:resourcekey=&quot;BoundFieldResource2&quot;
                    SortExpression=&quot;description&quot; /&gt;
            &lt;/Columns&gt;
        &lt;/asp:GridView&gt;
        &lt;asp:XmlDataSource ID=&quot;xdsData&quot; runat=&quot;server&quot; DataFile=&quot;~/data.xml&quot;
XPath=&quot;/root/element&quot; /&gt;

4. In the usings section of the page's code behind, add the following:

using System;
using System.Web;
using System.Web.UI;
using System.Globalization;
using System.Threading;

4. Inside the page class put the following code:

protected override void InitializeCulture ()
{
    base.InitializeCulture ();
    string lang = (string)Session[&quot;Language&quot;];
    if (lang == null)
        lang = &quot;en-US&quot;;
    CultureInfo culture = new CultureInfo(lang);
    this.UICulture = culture.Name;
    this.Culture = culture.Name;
    Thread.CurrentThread.CurrentCulture = culture;
    Thread.CurrentThread.CurrentUICulture = culture;
}

public virtual void btnEnglishClicked (object sender, EventArgs args)
{
    Session[&quot;Language&quot;] = &quot;en-US&quot;;
    Response.Redirect(Request.Url.ToString());
}

public virtual void btnEspanolClicked (object sender, EventArgs args)
{
    Session[&quot;Language&quot;] = &quot;es-MX&quot;;
    Response.Redirect(Request.Url.ToString());
}

5. Add an App_LocalResources directory in the project's root.

6. Create two or more resx files with names Default.aspx.resx and like
Default.aspx.es.resx, Default.aspx.es-MX.resx inside the created folder of step
5. Put the XML code with the required object translations, like the following
shows:

&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;root&gt;
  &lt;xsd:schema id=&quot;root&quot; xmlns=&quot;&quot; xmlns:xsd=&quot;<A HREF="http://www.w3.org/2001/XMLSchema&quot;">http://www.w3.org/2001/XMLSchema&quot;</A>
xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;
    &lt;xsd:import namespace=&quot;<A HREF="http://www.w3.org/XML/1998/namespace&quot;">http://www.w3.org/XML/1998/namespace&quot;</A> /&gt;
    &lt;xsd:element name=&quot;root&quot; msdata:IsDataSet=&quot;true&quot;&gt;
      &lt;xsd:complexType&gt;
        &lt;xsd:choice maxOccurs=&quot;unbounded&quot;&gt;
          &lt;xsd:element name=&quot;metadata&quot;&gt;
            &lt;xsd:complexType&gt;
              &lt;xsd:sequence&gt;
                &lt;xsd:element name=&quot;value&quot; type=&quot;xsd:string&quot; minOccurs=&quot;0&quot; /&gt;
              &lt;/xsd:sequence&gt;
              &lt;xsd:attribute name=&quot;name&quot; use=&quot;required&quot; type=&quot;xsd:string&quot; /&gt;
              &lt;xsd:attribute name=&quot;type&quot; type=&quot;xsd:string&quot; /&gt;
              &lt;xsd:attribute name=&quot;mimetype&quot; type=&quot;xsd:string&quot; /&gt;
              &lt;xsd:attribute ref=&quot;xml:space&quot; /&gt;
            &lt;/xsd:complexType&gt;
          &lt;/xsd:element&gt;
          &lt;xsd:element name=&quot;assembly&quot;&gt;
            &lt;xsd:complexType&gt;
              &lt;xsd:attribute name=&quot;alias&quot; type=&quot;xsd:string&quot; /&gt;
              &lt;xsd:attribute name=&quot;name&quot; type=&quot;xsd:string&quot; /&gt;
            &lt;/xsd:complexType&gt;
          &lt;/xsd:element&gt;
          &lt;xsd:element name=&quot;data&quot;&gt;
            &lt;xsd:complexType&gt;
              &lt;xsd:sequence&gt;
                &lt;xsd:element name=&quot;value&quot; type=&quot;xsd:string&quot; minOccurs=&quot;0&quot;
msdata:Ordinal=&quot;1&quot; /&gt;
                &lt;xsd:element name=&quot;comment&quot; type=&quot;xsd:string&quot; minOccurs=&quot;0&quot;
msdata:Ordinal=&quot;2&quot; /&gt;
              &lt;/xsd:sequence&gt;
              &lt;xsd:attribute name=&quot;name&quot; type=&quot;xsd:string&quot; use=&quot;required&quot;
msdata:Ordinal=&quot;1&quot; /&gt;
              &lt;xsd:attribute name=&quot;type&quot; type=&quot;xsd:string&quot; msdata:Ordinal=&quot;3&quot;
/&gt;
              &lt;xsd:attribute name=&quot;mimetype&quot; type=&quot;xsd:string&quot;
msdata:Ordinal=&quot;4&quot; /&gt;
              &lt;xsd:attribute ref=&quot;xml:space&quot; /&gt;
            &lt;/xsd:complexType&gt;
          &lt;/xsd:element&gt;
          &lt;xsd:element name=&quot;resheader&quot;&gt;
            &lt;xsd:complexType&gt;
              &lt;xsd:sequence&gt;
                &lt;xsd:element name=&quot;value&quot; type=&quot;xsd:string&quot; minOccurs=&quot;0&quot;
msdata:Ordinal=&quot;1&quot; /&gt;
              &lt;/xsd:sequence&gt;
              &lt;xsd:attribute name=&quot;name&quot; type=&quot;xsd:string&quot; use=&quot;required&quot; /&gt;
            &lt;/xsd:complexType&gt;
          &lt;/xsd:element&gt;
        &lt;/xsd:choice&gt;
      &lt;/xsd:complexType&gt;
    &lt;/xsd:element&gt;
  &lt;/xsd:schema&gt;
  &lt;resheader name=&quot;resmimetype&quot;&gt;
    &lt;value&gt;text/microsoft-resx&lt;/value&gt;
  &lt;/resheader&gt;
  &lt;resheader name=&quot;version&quot;&gt;
    &lt;value&gt;2.0&lt;/value&gt;
  &lt;/resheader&gt;
  &lt;resheader name=&quot;reader&quot;&gt;
    &lt;value&gt;System.Resources.ResXResourceReader, System.Windows.Forms,
Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;
  &lt;/resheader&gt;
  &lt;resheader name=&quot;writer&quot;&gt;
    &lt;value&gt;System.Resources.ResXResourceWriter, System.Windows.Forms,
Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;
  &lt;/resheader&gt;
  &lt;data name=&quot;lblDayOfWeekResource1.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Day of week: &lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;ListItemResource1.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Sunday&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;ListItemResource2.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Monday&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;ListItemResource3.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Tuesday&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;ListItemResource4.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Wednesday&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;ListItemResource5.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Thursday&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;ListItemResource6.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Friday&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;ListItemResource7.Text&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Saturday&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;BoundFieldResource1.HeaderText&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Name&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name=&quot;BoundFieldResource2.HeaderText&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;value&gt;Description&lt;/value&gt;
  &lt;/data&gt;
&lt;/root&gt;

7. Create an XML file named data.xml to fill the gridview with some data:

&lt;root&gt;
    &lt;element name=&quot;John&quot; description=&quot;administrator&quot; /&gt;
    &lt;element name=&quot;David&quot; description=&quot;art director&quot; /&gt;
    &lt;element name=&quot;Anna&quot; description=&quot;finances&quot; /&gt;
&lt;/root&gt;

8. Run the website in an internet browser and enter page Default.aspx.

9. Click on the language change buttons and see what happens.
Actual Results:  
The pages displays fine, and when you click the buttons, the label changes the
text to the desired language, but the DropDownList (combo) and GridView still
show the items and column header in the default language (english).

Expected Results:  
When you click on the buttons to change the page language, the set of items in
the DropDownList and the column headers should display text in the selected
language.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="098039.html">[Mono-bugs] [Bug 576426] Windows.Forms app gives kCGErrorCannotComplete, invalid device window errors
</A></li>
	<LI>Next message: <A HREF="098041.html">[Mono-bugs] [Bug 585933] DropDownList items and GridView columns don't translate.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98040">[ date ]</a>
              <a href="thread.html#98040">[ thread ]</a>
              <a href="subject.html#98040">[ subject ]</a>
              <a href="author.html#98040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
