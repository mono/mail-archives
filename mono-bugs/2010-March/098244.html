<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 587994] BigInteger.ModPow can get stuck in an infinite loop using up CPU resources
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20587994%5D%20BigInteger.ModPow%20can%20get%20stuck%20in%20an%0A%20infinite%20loop%20using%20up%20CPU%20resources&In-Reply-To=bug-587994-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="098184.html">
   <LINK REL="Next"  HREF="098245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 587994] BigInteger.ModPow can get stuck in an infinite loop using up CPU resources</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20587994%5D%20BigInteger.ModPow%20can%20get%20stuck%20in%20an%0A%20infinite%20loop%20using%20up%20CPU%20resources&In-Reply-To=bug-587994-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 587994] BigInteger.ModPow can get stuck in an infinite loop using up CPU resources">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Mar 15 07:58:58 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="098184.html">[Mono-bugs] [Bug 587994] BigInteger.ModPow can get stuck in an infinite loop using up CPU resources
</A></li>
        <LI>Next message: <A HREF="098245.html">[Mono-bugs] [Bug 587994] BigInteger.ModPow can get stuck in an infinite loop using up CPU resources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98244">[ date ]</a>
              <a href="thread.html#98244">[ thread ]</a>
              <a href="subject.html#98244">[ subject ]</a>
              <a href="author.html#98244">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=587994">http://bugzilla.novell.com/show_bug.cgi?id=587994</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=587994#c2">http://bugzilla.novell.com/show_bug.cgi?id=587994#c2</A>


--- Comment #2 from Michael Wood &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">michaelw at dip.co.uk</A>&gt; 2010-03-15 11:58:57 UTC ---
We've been experimenting more and discovered it isn't a problem specific to a
random number or prime set.  After discovering a set of numbers that it
occurred using I found re-doing the method with those numbers did not cause the
infinite loop.  It appears to only occur when the system is at high CPU usage,
whether this is due to other Mod Pows being performed or not. Here is a simple
sample application where the effect occurs most of the time I run it (over 50%
CPU and the code hung on that method):

    class Program
    {
        static void Main(string[] args)
        {
            int num = 300;

            BigIntThread[] bigInts = new BigIntThread[num];

            for (int i = 0; i &lt; num; i++)
            {
                bigInts[i] = new BigIntThread(i);
            }

            for (int i = 0; i &lt; num; i++)
            {
                bigInts[i].Start();
            }
        }

        public class BigIntThread
        {
            BigInteger bigTwo;
            BigInteger bigRandom;
            BigInteger bigPrime;
            Thread t;
            int id;

            public BigIntThread(int id)
            {
                this.id = id;
                bigTwo = BigInteger.Parse(&quot;2&quot;);

                bigRandom =
BigInteger.Parse(&quot;8258688429231270565973030503031952155764594082923760158315539651487325699428433445581150837282627302891508519305772657577848996431519075307578973539562427&quot;);

                bigPrime =
BigInteger.Parse(&quot;179769313486231590770839156793787453197860296048756011706444423684197180216158519368947833795864925541502180565485980503646440548199239100050792877003355816639229553136239076508735759914822574862575007425302077447712589550957937778424442426617334727629299387668709205606050270810842907692932019128194467627007&quot;);
                t = new Thread(new ThreadStart(ModPow));
            }

            public void Start()
            {
                t.Start();
            }

            public void ModPow()
            {
                Console.WriteLine(id + &quot; started&quot;);
                BigInteger bigPower = bigTwo.ModPow(bigRandom, bigPrime);
                Console.WriteLine(id + &quot; stopped&quot;);
            }
        }
    }


Could this be attributed to the use of unsafe code within Mod Pow?  We've
changed our implementation to use a singleton for performing the ModPow
however, this effect still occurs when the system is busy and it being a
singleton means that it sticks for all subsequent threads that use the method.

It's a requirement for us to be running 500+ threads that could use Mod Pow in
a short time period.



(In reply to comment #1)
&gt;<i> Please provide a tiple of numbers that show this behavior.
</I>
-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="098184.html">[Mono-bugs] [Bug 587994] BigInteger.ModPow can get stuck in an infinite loop using up CPU resources
</A></li>
	<LI>Next message: <A HREF="098245.html">[Mono-bugs] [Bug 587994] BigInteger.ModPow can get stuck in an infinite loop using up CPU resources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#98244">[ date ]</a>
              <a href="thread.html#98244">[ thread ]</a>
              <a href="subject.html#98244">[ subject ]</a>
              <a href="author.html#98244">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
