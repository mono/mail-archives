<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 584664] New: Xml schema violations are indicated when an element base type contains sub-elements of an extension type of that base type
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20584664%5D%20New%3A%20Xml%20schema%20violations%20are%20indicated%0A%20when%20an%20element%20base%20type%20contains%20sub-elements%20of%20an%20extension%20type%20of%0A%20that%20base%20type&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="097945.html">
   <LINK REL="Next"  HREF="098241.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 584664] New: Xml schema violations are indicated when an element base type contains sub-elements of an extension type of that base type</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20584664%5D%20New%3A%20Xml%20schema%20violations%20are%20indicated%0A%20when%20an%20element%20base%20type%20contains%20sub-elements%20of%20an%20extension%20type%20of%0A%20that%20base%20type&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 584664] New: Xml schema violations are indicated when an element base type contains sub-elements of an extension type of that base type">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Mar  2 09:24:45 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="097945.html">[Mono-bugs] [Bug 415439] Eventual threading-related crash
</A></li>
        <LI>Next message: <A HREF="098241.html">[Mono-bugs] [Bug 584664] Xml schema violations are indicated when an element base type contains sub-elements of an extension type of that base type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97946">[ date ]</a>
              <a href="thread.html#97946">[ thread ]</a>
              <a href="subject.html#97946">[ subject ]</a>
              <a href="author.html#97946">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=584664">http://bugzilla.novell.com/show_bug.cgi?id=584664</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=584664#c0">http://bugzilla.novell.com/show_bug.cgi?id=584664#c0</A>


           Summary: Xml schema violations are indicated when an element
                    base type contains sub-elements of an extension type
                    of that base type
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.6.x
          Platform: 32bit
        OS/Version: Windows Vista
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.XML
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">atsushi at ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">florianhaag at freenet.de</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=345988)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=345988">http://bugzilla.novell.com/attachment.cgi?id=345988</A>)
C# source for a little Xml validator + 2 xml schemas + 2 xml documents

User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.0; de; rv:1.9.1.2)
Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)

In an Xml schema, I define a complex type &quot;base&quot; and a complex type &quot;derived&quot;.
&quot;base&quot; may contain an element &quot;leaf&quot; (no particular type) and optionally an
element &quot;nested&quot; of type &quot;base&quot;. &quot;derived&quot; is defined as an extension of
&quot;base&quot;.

The root element must be of type &quot;derived&quot;.
(attached schema1.xsd)

A minimal document satisfying this schema, such as:

&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;root xmlns=&quot;<A HREF="http://a&quot;">http://a&quot;</A>&gt;
  &lt;leaf/&gt;
&lt;/root&gt;

(attached document1.xml)

validates in .NET 3.5 when loaded using System.Xml.XmlReader.Create and
supplying an XmlReaderSettings-instance that asks for schema validation. In
Mono, the same code produces validation errors, saying that the leaf element is
invalid there (see actual result).

If the schema is changed so that &quot;base&quot; can only contain an element &quot;leaf&quot;,
there are no validation errors (attached schema2.xsd and document2.xml).

Reproducible: Always

Steps to Reproduce:
1. Extract the attached file TestCase.tar.gz.
2. Compile TinyXmlValidator.cs (e.g. gmcs TinyXmlValidator.cs)
3. Run TinyXmlValidator.exe with Mono:
mono TinyXmlValidator.exe -s schema1.xsd -d document1.xml
=&gt; Actual Results.

4a. For a comparison, validate on .NET:
TinyXmlValidator -s schema1.xsd -d document1.xml
=&gt; Expected Results.
4b. For a comparison, validate the changed schema:
mono TinyXmlValidator.exe -s schema2.xsd -d document2.xml
=&gt; Expected Results.
Actual Results:  
  Error: XmlSchema error: Invalid start element: <A HREF="http://a:leaf">http://a:leaf</A> XML  Line 3,
Position 4. (Line 3, Column 4)
  Error: XmlSchema error: Element declaration for <A HREF="http://a:leaf">http://a:leaf</A> is missing. XML
 Line 3, Position 4. (Line 3, Column 4)
  Error: XmlSchema error: Invalid end element. There are still required content
items. XML  Line 4, Position 3. (Line 4, Column 3)

Expected Results:  
Successful validation.

I am using a German Windows Vista 32 Bit SP 2 and Mono 2.6.1.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="097945.html">[Mono-bugs] [Bug 415439] Eventual threading-related crash
</A></li>
	<LI>Next message: <A HREF="098241.html">[Mono-bugs] [Bug 584664] Xml schema violations are indicated when an element base type contains sub-elements of an extension type of that base type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97946">[ date ]</a>
              <a href="thread.html#97946">[ thread ]</a>
              <a href="subject.html#97946">[ subject ]</a>
              <a href="author.html#97946">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
