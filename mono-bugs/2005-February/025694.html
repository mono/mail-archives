<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 72605][Wis] Changed - gdiplus must check malloc results
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025693.html">
   <LINK REL="Next"  HREF="025695.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 72605][Wis] Changed - gdiplus must check malloc results
   </H1>
    <B>bugzilla-daemon@bugzilla.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com"
       TITLE="[Mono-bugs] [Bug 72605][Wis] Changed - gdiplus must check malloc results">bugzilla-daemon@bugzilla.ximian.com
       </A><BR>
    <I>Thu, 24 Feb 2005 07:12:40 -0500 (EST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="025693.html">[Mono-bugs] [Bug 72957][Nor] New - mcs fails to compile long double constant
</A></li>
        <LI> Next message: <A HREF="025695.html">[Mono-bugs] [Bug 72605][Wis] Changed - gdiplus must check malloc results
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25694">[ date ]</a>
              <a href="thread.html#25694">[ thread ]</a>
              <a href="subject.html#25694">[ subject ]</a>
              <a href="author.html#25694">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:vguzev@yandex.ru.">vguzev@yandex.ru.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=72605">http://bugzilla.ximian.com/show_bug.cgi?id=72605</A>

--- shadow/72605	2005-02-19 14:55:00.000000000 -0500
+++ shadow/72605.tmp.2752	2005-02-24 07:12:40.000000000 -0500
@@ -1,13 +1,13 @@
 Bug#: 72605
 Product: Mono: Class Libraries
 Version: unspecified
 OS: GNU/Linux [Other]
 OS Details: Linux skif 2.4.25 #2 SMP Fri Apr 23 14:03:00 MSD 2004 i686 athlon i386 GNU/Linux
-Status: RESOLVED   
-Resolution: FIXED
+Status: REOPENED   
+Resolution: 
 Severity: Unknown
 Priority: Wishlist
 Component: Sys.Drawing.
 AssignedTo: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>                            
 ReportedBy: <A HREF="mailto:vguzev@yandex.ru">vguzev@yandex.ru</A>               
 QAContact: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>
@@ -579,6 +579,199 @@
 ------- Additional Comments From <A HREF="mailto:vguzev@yandex.ru">vguzev@yandex.ru</A>  2005-02-19 14:55 -------
 Thanks, it seems to be working :)
 
 Best regards,
 Vadim B. Guzev
 <A HREF="http://u.pereslavl.ru/~vadim/MCSharp/">http://u.pereslavl.ru/~vadim/MCSharp/</A>
+
+------- Additional Comments From <A HREF="mailto:vguzev@yandex.ru">vguzev@yandex.ru</A>  2005-02-24 07:12 -------
+&gt; Is this bag fixed in 1.1.4 version ?
+    
+&gt; No, it is fixed in svn. 1.1.4 was finalized 2 weeks ago.
+
+&gt; lupus
+
+  
+Hi, Paolo !
+
+We have tested our program ( see attach ) on  libgdiplus version 
+from svn ( release 41000 ).
+But the results are even worse :
+
+
+[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> tmp]$ mono -V
+Mono JIT compiler version 1.1.4, (C) 2002-2004 Novell, Inc and 
+Contributors. www.go-mono.com
+        TLS:           __thread
+        GC:            Included Boehm (with typed GC)
+        SIGSEGV      : normal
+        Globalization: none
+[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> tmp]$ ulimit -v 200000
+[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> tmp]$ mono TestGDIPlus.exe 64
+
+GLib-ERROR **: gmem.c:157: failed to allocate 76 bytes
+aborting...
+
+GLib-ERROR **: gmem.c:157: failed to allocate 232 bytes
+aborting...
+
+GLib-ERROR **: gmem.c:157: failed to allocate 148 bytes
+aborting...
+
+GLib-ERROR **: gmem.c:157: failed to allocate 232 bytes
+aborting...
+
+GLib-ERROR **: gmem.c:157: failed to allocate 232 bytes
+aborting...
+Aborted
+
+
+
+--8&lt;----------------------------------------
+[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> tmp]$
+
+
+using System;
+using System.Threading;
+using System.Drawing;
+
+public class TestGDIPlus  {
+
+ public static void Main( string[] args ) {
+ 
+  int nThreads = int.Parse( args [0] );
+  
+  for ( int i = 0; i &lt; nThreads; i++ ) {
+   Thread t = new Thread( new ThreadStart( TestGDIPlus.Run ) );
+   t.Start();
+  }
+  
+ }
+
+ public static void Run() {
+  
+  try {
+   Bitmap bmp = new Bitmap ( 1000, 1000, 
+                  
+System.Drawing.Imaging.PixelFormat.Format32bppArgb );
+  }
+  catch ( Exception ex )
+  {
+   Console.WriteLine ( &quot;SOURCE : &quot; + ex.Source + &quot;\n&quot; +
+                       &quot;TARGETSITE : &quot; + ex.TargetSite.ToString() 
++ &quot;\n&quot; +
+		       &quot;Message : &quot; + ex.Message + &quot;\n&quot; +
+		       &quot;StackTrace : &quot; + ex.StackTrace);
+  }
+   
+ }
+ 
+}
+
+
+
+
+[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> tmp]$ mono TestGDIPlus.exe 8
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+
+Unhandled Exception: System.NullReferenceException: Object reference 
+not set to an instance of an object
+in &lt;0x000b8&gt; TestGDIPlus:Run ()
+in &lt;0x00041&gt; (wrapper delegate-invoke) 
+System.MulticastDelegate:invoke_void ()
+
+[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> tmp]$
+--8&lt;----------------------------------------
+
+
+With best regards,
+                             Yury Serdyuk.
+
+Example that we've used:
+--8&lt;----------------------------------------
+using System;
+using System.Threading;
+using System.Drawing;
+
+public class TestGDIPlus  {
+
+ public static void Main( string[] args ) {
+ 
+  int nThreads = int.Parse( args [0] );
+  
+  for ( int i = 0; i &lt; nThreads; i++ ) {
+   Thread t = new Thread( new ThreadStart( TestGDIPlus.Run ) );
+   t.Start();
+  }
+  
+ }
+
+ public static void Run() {
+  
+  try {
+   Bitmap bmp = new Bitmap ( 1000, 1000, 
+                  
+System.Drawing.Imaging.PixelFormat.Format32bppArgb );
+  }
+  catch ( Exception ex )
+  {
+   Console.WriteLine ( &quot;SOURCE : &quot; + ex.Source + &quot;\n&quot; +
+                       &quot;TARGETSITE : &quot; + ex.TargetSite.ToString() 
++ &quot;\n&quot; +
+		       &quot;Message : &quot; + ex.Message + &quot;\n&quot; +
+		       &quot;StackTrace : &quot; + ex.StackTrace);
+  }
+   
+ }
+ 
+}
+--8&lt;----------------------------------------
+
+

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025693.html">[Mono-bugs] [Bug 72957][Nor] New - mcs fails to compile long double constant
</A></li>
	<LI> Next message: <A HREF="025695.html">[Mono-bugs] [Bug 72605][Wis] Changed - gdiplus must check malloc results
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25694">[ date ]</a>
              <a href="thread.html#25694">[ thread ]</a>
              <a href="subject.html#25694">[ subject ]</a>
              <a href="author.html#25694">[ author ]</a>
         </LI>
       </UL>
</body></html>
