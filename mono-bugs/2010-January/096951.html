<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20573682%5D%20segtaults%20when%20encoding/decoding%20non-UTF8%0A%09strings&In-Reply-To=bug-573682-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="096948.html">
   <LINK REL="Next"  HREF="096964.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20573682%5D%20segtaults%20when%20encoding/decoding%20non-UTF8%0A%09strings&In-Reply-To=bug-573682-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Jan 27 12:36:13 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="096948.html">[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
</A></li>
        <LI>Next message: <A HREF="096964.html">[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#96951">[ date ]</a>
              <a href="thread.html#96951">[ thread ]</a>
              <a href="subject.html#96951">[ subject ]</a>
              <a href="author.html#96951">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=573682">http://bugzilla.novell.com/show_bug.cgi?id=573682</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=573682#c10">http://bugzilla.novell.com/show_bug.cgi?id=573682#c10</A>


--- Comment #10 from Ted Unangst &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">tedu at fogcreek.com</A>&gt; 2010-01-27 17:36:13 UTC ---
Hmm, I can still reproduce using both 1250 and 1252 encodings with 2.6.1 built
from source on a linux 32 machine.  But I note that the sample must be built
with gmcs, not mcs, or it doesn't crash.  By removing the fallback code
entirely I resolved both calls.  At least for us, the fallback code is messing
things up.

I think the continue is not the entire story.  As I read the code, even with
the misplaced continue, failure to decrement charindex will result in
overreading the input array, but in that case we don't write to bytes (nor
increment byteIndex), and the crash we're looking at is from bogus writes, not
just out of bounds reads.

In our original app, the bug manifested as a string with a Length field of
1.9GB, but no crashes.  The test app loops and doubles the string in an attempt
to force dramatic corruption, but you may need to vary the input string or loop
to trigger.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="096948.html">[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
</A></li>
	<LI>Next message: <A HREF="096964.html">[Mono-bugs] [Bug 573682] segtaults when encoding/decoding non-UTF8	strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#96951">[ date ]</a>
              <a href="thread.html#96951">[ thread ]</a>
              <a href="subject.html#96951">[ subject ]</a>
              <a href="author.html#96951">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
