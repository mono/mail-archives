<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 575600] New: MapPath() does not work for virtual directories outside of the current application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20575600%5D%20New%3A%20MapPath%28%29%20does%20not%20work%20for%20virtual%0A%20directories%20outside%20of%20the%20current%20application&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="097051.html">
   <LINK REL="Next"  HREF="097052.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 575600] New: MapPath() does not work for virtual directories outside of the current application</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20575600%5D%20New%3A%20MapPath%28%29%20does%20not%20work%20for%20virtual%0A%20directories%20outside%20of%20the%20current%20application&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 575600] New: MapPath() does not work for virtual directories outside of the current application">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun Jan 31 08:34:42 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="097051.html">[Mono-bugs] [Bug 575598] Softdebugging this program crashes the	mono runtime
</A></li>
        <LI>Next message: <A HREF="097052.html">[Mono-bugs] [Bug 565152] Directory.Exist should not ever throw an	exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97050">[ date ]</a>
              <a href="thread.html#97050">[ thread ]</a>
              <a href="subject.html#97050">[ subject ]</a>
              <a href="author.html#97050">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=575600">http://bugzilla.novell.com/show_bug.cgi?id=575600</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=575600#c0">http://bugzilla.novell.com/show_bug.cgi?id=575600#c0</A>


           Summary: MapPath() does not work for virtual directories
                    outside of the current application
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.6.x
          Platform: 32bit
        OS/Version: openSUSE 11.2
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">test051102 at hotmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=339844)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=339844">http://bugzilla.novell.com/attachment.cgi?id=339844</A>)
VS2008 Testprojects

User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.1.7)
Gecko/20091221 Firefox/3.5.7 (.NET CLR 3.5.30729)

MapPath() does not work for virtual directories outside of the current
application. However, this works perfectly using WinXP and the integrated IIS.

Reproducible: Always

Steps to Reproduce:
To reproduce this bug I created two simple WebApplications using VS2008.
/WebApplication1 tries to access /WebApplication2 and read back some
application settings. To do this drag a Label from the toolbox to
WebApplication1 and add the following to the code behind class for
WebApplication1:

protected void Page_Load(object sender, EventArgs e)
        protected void Page_Load(object sender, EventArgs e)
{
    Label1.Text=&quot;Server.MapPath(\&quot;/WebApplication1\&quot;): &quot;;

    try
    {
        Label1.Text += &quot;&lt;b&gt;&quot; + Server.MapPath(&quot;/WebApplication1&quot;) + &quot;&lt;/b&gt;&quot;;
    }
    catch
    {
        Label1.Text+=&quot;ERROR&quot;;
    }

    Label1.Text+=&quot;&lt;br/&gt;HostingEnvironment.MapPath(\&quot;/WebApplication1\&quot;): &quot;;

    try
    {
        Label1.Text += &quot;&lt;b&gt;&quot; + HostingEnvironment.MapPath(&quot;/WebApplication1&quot;) +
&quot;&lt;/b&gt;&quot;;
    }
    catch
    {
        Label1.Text+=&quot;ERROR&quot;;
    }


    Label1.Text += &quot;&lt;br/&gt;Server.MapPath(\&quot;/WebApplication2\&quot;): &quot;;

    try
    {
        Label1.Text += &quot;&lt;b&gt;&quot; + Server.MapPath(&quot;/WebApplication2&quot;) + &quot;&lt;/b&gt;&quot;;
    }
    catch
    {
        Label1.Text += &quot;ERROR&quot;;
    }

    Label1.Text += &quot;&lt;br/&gt;HostingEnvironment.MapPath(\&quot;/WebApplication2\&quot;): &quot;;

    try
    {
        Label1.Text += &quot;&lt;b&gt;&quot; + HostingEnvironment.MapPath(&quot;/WebApplication2&quot;) +
&quot;&lt;/b&gt;&quot;;
    }
    catch
    {
        Label1.Text += &quot;ERROR&quot;;
    }

    string strPhysPath = Server.MapPath(&quot;/WebApplication2&quot;);
    Configuration config =
WebConfigurationManager.OpenWebConfiguration(&quot;/WebApplication2&quot;);

    KeyValueConfigurationElement test =
(KeyValueConfigurationElement)config.AppSettings.Settings[&quot;test&quot;];

    if (test != null) Label1.Text += &quot;&lt;br/&gt;[test]=&quot; + test.Value.ToString();
        else Label1.Text += &quot;&lt;br/&gt;[test]=null&quot;;
}

In the Web.config for WebApplication2 add
&lt;appSettings&gt;
      &lt;add key=&quot;test&quot; value=&quot;Hello World!&quot;/&gt;
&lt;/appSettings&gt;


To deploy the applications on IIS do the following:
1.    Delete all files within c:\inetpub\wwwroot and copy the output of both
WebApplications from above to some other directory
2.    Create two virtual directories in IIS for each WebApplication and call
them WebApplication1 and WebApplication2 and map them to the directories from
(3)
3.    Start a browser and enter <A HREF="http://localhost/WebApplication1">http://localhost/WebApplication1</A>

To deploy the applications on the Mono 2.6.1 Live CD do the following:
1.    Create a directory below your home dir and copy both WebApplications to
it
2.    Enter xsp2 &#8211;applications
/WebApplication1:./WebApplication1,/WebApplication2:,/WebApplication2
3.    Start a browser and enter <A HREF="http://localhost/WebApplication1">http://localhost/WebApplication1</A>

Actual Results:  
The output from the test under Mono 2.6.1 is as follows:
&#8220;Server.MapPath(&quot;/WebApplication1&quot;): /home/rupert/DemoTest/WebApplication1 
HostingEnvironment.MapPath(&quot;/WebApplication1&quot;):
/home/rupert/DemoTest/WebApplication1
Server.MapPath(&quot;/WebApplication2&quot;):
/home/rupert/DemoTest/WebApplication1/WebApplication2
HostingEnvironment.MapPath(&quot;/WebApplication2&quot;):
/home/rupert/DemoTest/WebApplication1/WebApplication2
[test]=null&#8220;


Expected Results:  
The output from the test under IIS produces the following:

Server.MapPath(&quot;/WebApplication1&quot;): C:\Inetpub\temp\WebApplication1
HostingEnvironment.MapPath(&quot;/WebApplication1&quot;): C:\Inetpub\temp\WebApplication1
Server.MapPath(&quot;/WebApplication2&quot;): C:\Inetpub\temp\WebApplication2
HostingEnvironment.MapPath(&quot;/WebApplication2&quot;): C:\Inetpub\temp\WebApplication2
[test]=Hello World!


By the way, calling
WebConfigrationManager.OpenWebConfiguration(&#8220;/WebApplication2&#8221;) from within
WebApplication1 will throw an exception on Mono 2.6.1 but not on Windows/IIS.

All in all, the following methods are not working as expected
System.Web.HttpServerUtility.MapPath()
System.Web.Hosting.HostingEnvironment.MapPath()
System.Web.Configuration.WebConfigrationManager.OpenWebConfiguration()

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="097051.html">[Mono-bugs] [Bug 575598] Softdebugging this program crashes the	mono runtime
</A></li>
	<LI>Next message: <A HREF="097052.html">[Mono-bugs] [Bug 565152] Directory.Exist should not ever throw an	exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#97050">[ date ]</a>
              <a href="thread.html#97050">[ thread ]</a>
              <a href="subject.html#97050">[ subject ]</a>
              <a href="author.html#97050">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
