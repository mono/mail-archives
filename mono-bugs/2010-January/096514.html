<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 570930] New: System.Net.Mail.Attachment	ArgumentNullException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20570930%5D%20New%3A%20System.Net.Mail.Attachment%0A%09ArgumentNullException&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="096513.html">
   <LINK REL="Next"  HREF="096783.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 570930] New: System.Net.Mail.Attachment	ArgumentNullException</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20570930%5D%20New%3A%20System.Net.Mail.Attachment%0A%09ArgumentNullException&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 570930] New: System.Net.Mail.Attachment	ArgumentNullException">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Jan 15 05:55:11 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="096513.html">[Mono-bugs] [Bug 570911] http://schemas.microsoft.com/2003/datacontract:guid is not supported in svcutil
</A></li>
        <LI>Next message: <A HREF="096783.html">[Mono-bugs] [Bug 570930] System.Net.Mail.Attachment	ArgumentNullException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#96514">[ date ]</a>
              <a href="thread.html#96514">[ thread ]</a>
              <a href="subject.html#96514">[ subject ]</a>
              <a href="author.html#96514">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=570930">http://bugzilla.novell.com/show_bug.cgi?id=570930</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=570930#c0">http://bugzilla.novell.com/show_bug.cgi?id=570930#c0</A>


           Summary: System.Net.Mail.Attachment ArgumentNullException
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 1.2.0
          Platform: x86-64
        OS/Version: Windows 7
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dr0zaxx at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64;
Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729;
Media Center PC 6.0; .NET4.0C; FDM)

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Mail;
using System.Net;
using System.IO;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            AttachFile(&quot;/root/Status_Log.txt&quot;);
        }

        static void AttachFile(string file)
        {
            MailAddress toAddress = new MailAddress(&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">user at gmail.com</A>&quot;);
            MailAddress fromAddress = new MailAddress(&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">user at gmail.com</A>&quot;);
            MailMessage mm = new MailMessage(fromAddress, toAddress);
            mm.Subject = &quot;Test Subject&quot;;
            Attachment mailAttachment = new Attachment(file);
            mm.Attachments.Add(mailAttachment);
            mm.IsBodyHtml = true;
            mm.BodyEncoding = System.Text.Encoding.UTF8;
            SendMail(mm);

        }

        static void SendMail(MailMessage mm)
        {
            try
            {
                string smtpHost = &quot;smtp.gmail.com&quot;;
                string userName = &quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">user at gmail.com</A>&quot;;             
                string password = &quot;password&quot;;
                SmtpClient mClient = new SmtpClient();
                mClient.Port = 587;
                mClient.EnableSsl = true;
                mClient.UseDefaultCredentials = false;
                mClient.Credentials = new NetworkCredential(userName,
password);
                mClient.Host = smtpHost;
                mClient.DeliveryMethod = SmtpDeliveryMethod.Network;
                mClient.Send(mm);
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.InnerException);
            }
        }
    }
}

The code returns the following when executed on Ubuntu Linux:

System.ArgumentNullException: Argument cannot be null.
Parameter name: content
  at System.Net.Mail.Attachment.CreateAttachmentFromString (System.String
content, System.String name, System.Text.Encoding contentEncoding,
System.String mediaType) [0x00000]
  at System.Net.Mail.SmtpClient.SendWithAttachments
(System.Net.Mail.MailMessage message) [0x00000]
  at System.Net.Mail.SmtpClient.SendCore (System.Net.Mail.MailMessage message)
[0x00000]
  at System.Net.Mail.SmtpClient.SendInternal (System.Net.Mail.MailMessage
message) [0x00000]
  at System.Net.Mail.SmtpClient.Send (System.Net.Mail.MailMessage message)
[0x00000]

[Test]
AttachFile(&quot;/root/Status_Log.txt&quot;); for Linux
AttachFile(@&quot;C:\Status_Log.txt&quot;); for Windows

[Result]
Exception as stated above - Linux
Mail with attachment successfully sent and received in inbox - Windows

Reproducible: Always

Steps to Reproduce:
1. Compile the code above for both Linux and Windows
2. Execute the Windows example. Mail will be sent successfully with attachment.
3. Execute the Linux example. Exception as stated above will occur.
Actual Results:  
Mail should be sent with both examples.

Expected Results:  
Unable to send mail with attachment with Linux example.
Working for Windows.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="096513.html">[Mono-bugs] [Bug 570911] http://schemas.microsoft.com/2003/datacontract:guid is not supported in svcutil
</A></li>
	<LI>Next message: <A HREF="096783.html">[Mono-bugs] [Bug 570930] System.Net.Mail.Attachment	ArgumentNullException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#96514">[ date ]</a>
              <a href="thread.html#96514">[ thread ]</a>
              <a href="subject.html#96514">[ subject ]</a>
              <a href="author.html#96514">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
