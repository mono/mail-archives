<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 332314] DatePart wrong results for WeekOfYear+System+FirstFullWeek on non en-US culture
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20332314%5D%20DatePart%20wrong%20results%20for%0A%20WeekOfYear%2BSystem%2BFirstFullWeek%20on%20non%20en-US%20culture&In-Reply-To=bug-332314-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062753.html">
   <LINK REL="Next"  HREF="062946.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 332314] DatePart wrong results for WeekOfYear+System+FirstFullWeek on non en-US culture</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20332314%5D%20DatePart%20wrong%20results%20for%0A%20WeekOfYear%2BSystem%2BFirstFullWeek%20on%20non%20en-US%20culture&In-Reply-To=bug-332314-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 332314] DatePart wrong results for WeekOfYear+System+FirstFullWeek on non en-US culture">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Oct 11 10:33:58 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="062753.html">[Mono-bugs] [Bug 332314] Folow sugestion
</A></li>
        <LI>Next message: <A HREF="062946.html">[Mono-bugs] [Bug 332314] DatePart wrong results for WeekOfYear+System+FirstFullWeek on non en-US culture
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62887">[ date ]</a>
              <a href="thread.html#62887">[ thread ]</a>
              <a href="subject.html#62887">[ subject ]</a>
              <a href="author.html#62887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=332314#c2">https://bugzilla.novell.com/show_bug.cgi?id=332314#c2</A>


Andy Hume &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">andyhume32 at yahoo.co.uk</A>&gt; changed:

           What    |Removed                                         |Added
----------------------------------------------------------------------------
                 CC|                                                |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">andyhume32 at yahoo.co.uk</A>
            Summary|Folow sugestion                                 |DatePart wrong results for
                   |                                                |WeekOfYear+System+FirstFullWeek on non en-US
                   |                                                |culture




--- Comment #2 from Andy Hume &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">andyhume32 at yahoo.co.uk</A>&gt;  2007-10-11 08:33:57 MST ---
The following gives different results on MSFT vs Mono, for at least fr-Fr and
en-GB.  It is ok for en-US.
[[
  DatePart(DateInterval.WeekOfYear, _
     someDate, 
     FirstDayOfWeek.System, FirstWeekOfYear.FirstFullWeek)
]]

For e.g.
[[
  DatePart(DateInterval.WeekOfYear, _
    new Date(2007, 10, 11), 
    FirstDayOfWeek.System, FirstWeekOfYear.FirstFullWeek)
]]
gives 41 on MSFT but 40 on Mono.  And for 2007-01-05, 1 versus 53.

Main testing on Mono SVN head Win32, but same Mono results seen on 1.2.5 Suse
VM.

For more, diff the output from the following when run on MSFT vs Mono.  Bad
results are seen for en-GB and fr-FR, but not en-US.  So, as Jonathon noted in
the original bug, a problem with FirstDayOfWeek.System when its not Sunday? 
That's the US default IIRC.

[[
Class Foo
    Shared Sub Main
        Console.WriteLine(&quot;-----------------------------------------&quot;)
        System.Threading.Thread.CurrentThread.CurrentCulture _
            = New System.Globalization.CultureInfo(&quot;en-US&quot;)
        Console.WriteLine(System.Threading.Thread.CurrentThread.CurrentCulture)
        Console.WriteLine
        RunTests

        Console.WriteLine
        Console.WriteLine
        Console.WriteLine(&quot;-----------------------------------------&quot;)
        System.Threading.Thread.CurrentThread.CurrentCulture _
            = New System.Globalization.CultureInfo(&quot;fr-FR&quot;)
        Console.WriteLine(System.Threading.Thread.CurrentThread.CurrentCulture)
        Console.WriteLine
        RunTests

        Console.WriteLine
        Console.WriteLine
        Console.WriteLine(&quot;-----------------------------------------&quot;)
        System.Threading.Thread.CurrentThread.CurrentCulture _
            = New System.Globalization.CultureInfo(&quot;en-GB&quot;)
        Console.WriteLine(System.Threading.Thread.CurrentThread.CurrentCulture)
        Console.WriteLine
        RunTests
    End Sub

    Shared Sub RunTests
        WoyAllSettings
        WoyAllSettings(new Date(2007,1,5))
        Woy
        Woy(new Date(2007,1,5))
    End Sub        


    Shared Sub Woy()
        Woy(new Date(2007, 10, 11))
    End Sub

    Shared Sub Woy(date1 As DateTime)
        Console.WriteLine(&quot;foo : &quot; &amp; 1.111) ' see comma when fr-FR
        Dim woy As Integer = DatePart(DateInterval.WeekOfYear, _
            date1, _
            FirstDayOfWeek.System, FirstWeekOfYear.FirstFullWeek)
        Console.WriteLine(woy)
        If woy = -1 Then
            Throw New Exception(&quot;DatePart returned -1&quot;)
        End If
    End Sub


    Shared Sub WoyAllSettings()
        WoyAllSettings(new Date(2007, 10, 11))
    End Sub

    Shared Sub WoyAllSettings(date1 As DateTime)
        For Each fwoy As FirstWeekOfYear in
[Enum].GetValues(GetType(FirstWeekOfYear))
            For Each fdow As FirstDayOfWeek in
[Enum].GetValues(GetType(FirstDayOfWeek))
                Dim week As Integer = DatePart(DateInterval.WeekOfYear, _
                    date1, fdow, fwoy)
                Console.WriteLine(&quot;{0,-10} {1,-13}: {2}&quot;, _
                    fdow, fwoy, week)
            Next
        Next
    End Sub
End Class
]]

I can't reproduce any -1 result however.  Can you supply any two line program
that does so Eric?


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062753.html">[Mono-bugs] [Bug 332314] Folow sugestion
</A></li>
	<LI>Next message: <A HREF="062946.html">[Mono-bugs] [Bug 332314] DatePart wrong results for WeekOfYear+System+FirstFullWeek on non en-US culture
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62887">[ date ]</a>
              <a href="thread.html#62887">[ thread ]</a>
              <a href="subject.html#62887">[ subject ]</a>
              <a href="author.html#62887">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
