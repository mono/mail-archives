<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 333808] New: MonoCurses does not compile on x86-64	platforms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20333808%5D%20New%3A%20MonoCurses%20does%20not%20compile%20on%20x86-64%0A%09platforms&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="063862.html">
   <LINK REL="Next"  HREF="063250.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 333808] New: MonoCurses does not compile on x86-64	platforms</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20333808%5D%20New%3A%20MonoCurses%20does%20not%20compile%20on%20x86-64%0A%09platforms&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 333808] New: MonoCurses does not compile on x86-64	platforms">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Oct 15 06:01:03 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="063862.html">[Mono-bugs] [Bug 333806] XslTransform.Load does not validate the	given xml
</A></li>
        <LI>Next message: <A HREF="063250.html">[Mono-bugs] [Bug 333808] MonoCurses does not compile on x86-64	platforms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63091">[ date ]</a>
              <a href="thread.html#63091">[ thread ]</a>
              <a href="subject.html#63091">[ subject ]</a>
              <a href="author.html#63091">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=333808">https://bugzilla.novell.com/show_bug.cgi?id=333808</A>

           Summary: MonoCurses does not compile on x86-64 platforms
           Product: Mono: Class Libraries
           Version: unspecified
          Platform: x86-64
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Mono.POSIX
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">miguel at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">directhex at hotmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
          Found By: Customer


Description of Problem:
MonoCurses is unable to build correctly on x86-64.



Steps to reproduce the problem:
1. Attempt to run &quot;make&quot; on MonoCurses on an x86-64 machine



Actual Results:
if test `uname` = Darwin; then make t-bugosx; else make detect; fi
make[1]: Entering directory `/tmp/mono-curses'
echo &quot;main () {initscr();}&quot; &gt; tmp.c
gcc tmp.c -lncurses -o tmp
make binding CURSES=`ldd ./tmp  | grep ncurses | awk '{print $3}' | sed
's#.*libncurses#ncurses#'`
make[2]: Entering directory `/tmp/mono-curses'
sed -e 's/@CURSES@/ncurses.so.5/' -e 's/@MONO_CURSES@/mono-curses/' &lt;
binding.cs.in &gt; binding.cs
make[2]: Leaving directory `/tmp/mono-curses'
make[1]: Leaving directory `/tmp/mono-curses'
gcc -o attrib attrib.c  -lncurses
/attrib constants.cs
gmcs -doc:mono-curses.xml -debug -target:library -out:mono-curses.dll -debug
handles.cs binding.cs gui.cs constants.cs
constants.cs(53,26): error CS0031: Constant value `4294967295' cannot be
converted to a `int'
Compilation failed: 1 error(s), 0 warnings
make: *** [mono-curses.dll] Error 1



Expected Results:
if test `uname` = Darwin; then make t-bugosx; else make detect; fi
make[1]: Entering directory `/tmp/mono-curses'
echo &quot;main () {initscr();}&quot; &gt; tmp.c
gcc tmp.c -lncurses -o tmp
make binding CURSES=`ldd ./tmp  | grep ncurses | awk '{print $3}' | sed
's#.*libncurses#ncurses#'`
make[2]: Entering directory `/tmp/mono-curses'
sed -e 's/@CURSES@/ncurses.so.5/' -e 's/@MONO_CURSES@/mono-curses/' &lt;
binding.cs.in &gt; binding.cs
make[2]: Leaving directory `/tmp/mono-curses'
make[1]: Leaving directory `/tmp/mono-curses'
gcc -o attrib attrib.c  -lncurses
/attrib constants.cs
gmcs -doc:mono-curses.xml -debug -target:library -out:mono-curses.dll -debug
handles.cs binding.cs gui.cs constants.cs
if test `uname` = Darwin; then gcc -dynamiclib mono-curses.c -o
libmono-curses.dylib -lncurses; else gcc -g -shared -fPIC mono-curses.c -o
libmono-curses.so -lncurses; fi
if pkg-config --atleast-version=0.1 monotorrent; then \
                cp `pkg-config --variable=Libraries monotorrent` .; \
        else \
                echo You must install The Monotorrent libraries first;  \
                exit 1; \
        fi
You must install The Monotorrent libraries first
make: *** [MonoTorrent.dll] Error 1



How often does this happen? 
Every time



Additional Information:
The error occurs because a constant defined in constants.cs is larger than the
largest number that can be stored in a .NET &quot;int&quot; object. constants.cs is a
machine-generated file, made by a small C program called attrib. attrib simply
writes out a number of integer constants defined in the system's ncurses.h C
header. However, the main method to do this looks like this:
#define put(x) fprintf (OUT, &quot;\tpublic const int &quot; #x &quot; = %ld;\n&quot;, x)
The input types are all C &quot;int&quot;, and the generated .cs file defines all the
constants as a .NET &quot;int&quot; - but the printf here interprets all the values in
ncurses.h with %ld, i.e. a &quot;long int&quot;. Using &quot;long int&quot; here doesn't match up
with the input OR output, and is the reason that the input value from
ncurses.h:
#define ERR     (-1)
is written to constants.cs as:
        public const int ERR = 4294967295;

This &quot;%ld&quot; should be changed to &quot;%d&quot;, which is correct (given the input and
output data types) and allows the assembly to compile fine


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>




















































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="063862.html">[Mono-bugs] [Bug 333806] XslTransform.Load does not validate the	given xml
</A></li>
	<LI>Next message: <A HREF="063250.html">[Mono-bugs] [Bug 333808] MonoCurses does not compile on x86-64	platforms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63091">[ date ]</a>
              <a href="thread.html#63091">[ thread ]</a>
              <a href="subject.html#63091">[ subject ]</a>
              <a href="author.html#63091">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
