<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 331144] New: ComboBox: X11 error changing	DropDownStyle
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20331144%5D%20New%3A%20ComboBox%3A%20X11%20error%20changing%0A%09DropDownStyle&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062579.html">
   <LINK REL="Next"  HREF="062527.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 331144] New: ComboBox: X11 error changing	DropDownStyle</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20331144%5D%20New%3A%20ComboBox%3A%20X11%20error%20changing%0A%09DropDownStyle&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 331144] New: ComboBox: X11 error changing	DropDownStyle">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Oct  5 11:46:21 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="062579.html">[Mono-bugs] [Bug 331126] Type. IsAssignableTo results inconsistent with Microsoft implementation (4 cases)
</A></li>
        <LI>Next message: <A HREF="062527.html">[Mono-bugs] [Bug 331144] ComboBox: X11 error changing DropDownStyle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62518">[ date ]</a>
              <a href="thread.html#62518">[ thread ]</a>
              <a href="subject.html#62518">[ subject ]</a>
              <a href="author.html#62518">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=331144">https://bugzilla.novell.com/show_bug.cgi?id=331144</A>

           Summary: ComboBox: X11 error changing DropDownStyle
           Product: Mono: Class Libraries
           Version: 1.2
          Platform: Other
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Windows.Forms
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gert.driesen at pandora.be</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
          Found By: ---


When changing the DropDownStyle of a created ComboBox from Simple to DropDown,
the following X11 error is reported:

X11 Error encountered: 
  Error: BadMatch (invalid parameter attributes)
  Request:     12 (0)
  Resource ID: 0x2A00016
  Serial:      390
  Hwnd:        Hwnd, Mapped:True ClientWindow:0x2A00017, WholeWindow:0x2A00016,
Zombie=True, Parent:[&lt;null&gt;]
  Control:     &lt;handle 44040215 non-existant&gt;   at
System.Environment.get_StackTrace()
   at System.Windows.Forms.XplatUIX11.HandleError(IntPtr display, XErrorEvent
ByRef error_event)
   at System.Windows.Forms.XplatUIX11.HandleError(IntPtr , XErrorEvent ByRef )
   at System.Drawing.GDIPlus.GdipCreateFromXDrawable_linux(IntPtr , IntPtr ,
IntPtr ByRef )
   at System.Drawing.GDIPlus.GdipCreateFromXDrawable_linux(IntPtr , IntPtr ,
IntPtr ByRef )
   at System.Drawing.Graphics.FromXDrawable(IntPtr drawable, IntPtr display)
   at System.Drawing.Graphics.FromHwnd(IntPtr hwnd)
   at System.Windows.Forms.Control.CreateGraphics()
   at System.Windows.Forms.TextBoxBase.CreateGraphicsInternal()
   at System.Windows.Forms.TextBoxBase.CalculateDocument()
   at System.Windows.Forms.TextBoxBase.TextBoxBase_SizeChanged(System.Object
sender, System.EventArgs e)
   at System.Windows.Forms.Control.OnSizeChanged(System.EventArgs e)
   at System.Windows.Forms.Control.UpdateBounds(Int32 x, Int32 y, Int32 width,
Int32 height, Int32 clientWidth, Int32 clientHeight)
   at System.Windows.Forms.Control.UpdateBounds()
   at System.Windows.Forms.Control.WmWindowPosChanged(Message ByRef m)
   at System.Windows.Forms.Control.WndProc(Message ByRef m)
   at System.Windows.Forms.TextBoxBase.WndProc(Message ByRef m)
   at System.Windows.Forms.TextBox.WndProc(Message ByRef m)
   at System.Windows.Forms.Control+ControlWindowTarget.OnMessage(Message ByRef
m)
   at System.Windows.Forms.Control+ControlNativeWindow.WndProc(Message ByRef m)
   at System.Windows.Forms.NativeWindow.WndProc(IntPtr hWnd, Msg msg, IntPtr
wParam, IntPtr lParam)
   at System.Windows.Forms.XplatUIX11.SendMessage(IntPtr hwnd, Msg message,
IntPtr wParam, IntPtr lParam)
   at System.Windows.Forms.XplatUIX11.SetWindowPos(IntPtr handle, Int32 x,
Int32 y, Int32 width, Int32 height)
   at System.Windows.Forms.XplatUI.SetWindowPos(IntPtr handle, Int32 x, Int32
y, Int32 width, Int32 height)
   at System.Windows.Forms.Control.SetBoundsCore(Int32 x, Int32 y, Int32 width,
Int32 height, BoundsSpecified specified)
   at System.Windows.Forms.TextBoxBase.SetBoundsCore(Int32 x, Int32 y, Int32
width, Int32 height, BoundsSpecified specified)
   at System.Windows.Forms.Control.SetBounds(Int32 x, Int32 y, Int32 width,
Int32 height, BoundsSpecified specified)
   at System.Windows.Forms.Control.set_Width(Int32 value)
   at System.Windows.Forms.ComboBox.LayoutComboBox()
   at System.Windows.Forms.ComboBox.set_DropDownStyle(ComboBoxStyle value)
   at Program.Main()

To reproduce, compile and run the following code snippet:

using System;
using System.Windows.Forms;

class Program
{
        [STAThread]
        static void Main ()
        {
                ComboBox comboBox = new ComboBox ();
                comboBox.Items.Add (&quot;abc&quot;);

                Form form = new Form ();
                form.Controls.Add (comboBox);
                form.Show ();

                comboBox.DropDownStyle = ComboBoxStyle.Simple;
                comboBox.DropDownStyle = ComboBoxStyle.DropDown;

                form.Dispose ();
        }
}

I've also added this as a (NotWorking) unit test to ComboBoxTest.cs. Please
enable this test once a fix is available.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>




















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062579.html">[Mono-bugs] [Bug 331126] Type. IsAssignableTo results inconsistent with Microsoft implementation (4 cases)
</A></li>
	<LI>Next message: <A HREF="062527.html">[Mono-bugs] [Bug 331144] ComboBox: X11 error changing DropDownStyle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62518">[ date ]</a>
              <a href="thread.html#62518">[ thread ]</a>
              <a href="subject.html#62518">[ subject ]</a>
              <a href="author.html#62518">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
