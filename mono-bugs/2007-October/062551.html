<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 331525] New: Int32.TryParse fails to recognize	overflows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20331525%5D%20New%3A%20Int32.TryParse%20fails%20to%20recognize%0A%09overflows&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062550.html">
   <LINK REL="Next"  HREF="062552.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 331525] New: Int32.TryParse fails to recognize	overflows</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20331525%5D%20New%3A%20Int32.TryParse%20fails%20to%20recognize%0A%09overflows&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 331525] New: Int32.TryParse fails to recognize	overflows">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Oct  5 22:14:49 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="062550.html">[Mono-bugs] [Bug 328019] MDIParent crash
</A></li>
        <LI>Next message: <A HREF="062552.html">[Mono-bugs] [Bug 331525] Int32.TryParse fails to recognize overflows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62551">[ date ]</a>
              <a href="thread.html#62551">[ thread ]</a>
              <a href="subject.html#62551">[ subject ]</a>
              <a href="author.html#62551">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=331525">https://bugzilla.novell.com/show_bug.cgi?id=331525</A>

           Summary: Int32.TryParse fails to recognize overflows
           Product: Mono: Class Libraries
           Version: 1.2
          Platform: i686
        OS/Version: Linux
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">leonardo+novell at diptongonante.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
          Found By: ---


Since r82261 in the mcs repository[1], Int32.TryParse incorrectly parses a
number below Int32.MinValue and returns true. See attached test case.

The problem is that the logic implemented in Int32.cs by Miguel in that commit,
although clever, is not guaranteed to behave as expected (i.e. a positive
integer is not always going to become a negative number after overflowing, or
viceversa). When detecting integer overflows in multiplications we're stuck
with having to cast to a larger type (C#'s long in this case) and then make the
check. Not as optimal, but still about 5 times faster than try+catch in my
machine.

Attached is also a patch that includes a possible fix, and adds a few more unit
tests to cover this scenario, and some other cases for the TryParse method
involving hexadecimal numbers.

Thanks.

[1] As a side note, this bug is present in mono 1.2.5


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062550.html">[Mono-bugs] [Bug 328019] MDIParent crash
</A></li>
	<LI>Next message: <A HREF="062552.html">[Mono-bugs] [Bug 331525] Int32.TryParse fails to recognize overflows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62551">[ date ]</a>
              <a href="thread.html#62551">[ thread ]</a>
              <a href="subject.html#62551">[ subject ]</a>
              <a href="author.html#62551">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
