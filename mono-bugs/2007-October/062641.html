<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 329714] ErrorProvider: NRE in ErrorProvider+ErrorProperty.window_Tick
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20329714%5D%20ErrorProvider%3A%20NRE%20in%0A%20ErrorProvider%2BErrorProperty.window_Tick&In-Reply-To=bug-329714-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062263.html">
   <LINK REL="Next"  HREF="062874.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 329714] ErrorProvider: NRE in ErrorProvider+ErrorProperty.window_Tick</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20329714%5D%20ErrorProvider%3A%20NRE%20in%0A%20ErrorProvider%2BErrorProperty.window_Tick&In-Reply-To=bug-329714-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 329714] ErrorProvider: NRE in ErrorProvider+ErrorProperty.window_Tick">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Oct  8 10:05:31 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="062263.html">[Mono-bugs] [Bug 329714] New: ErrorProvider: NRE in ErrorProvider+ErrorProperty. window_Tick
</A></li>
        <LI>Next message: <A HREF="062874.html">[Mono-bugs] [Bug 329714] ErrorProvider: NRE in ErrorProvider+ErrorProperty.window_Tick
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62641">[ date ]</a>
              <a href="thread.html#62641">[ thread ]</a>
              <a href="subject.html#62641">[ subject ]</a>
              <a href="author.html#62641">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=329714#c1">https://bugzilla.novell.com/show_bug.cgi?id=329714#c1</A>





--- Comment #1 from Andy Hume &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">andyhume32 at yahoo.co.uk</A>&gt;  2007-10-08 08:05:31 MST ---
OK, found a simple repro:
[[
using System;
using System.Windows.Forms;

class ErrorProviderNotAddSetCC : Form
{
    static void Main(string[] args)
    {
        Application.Run(new ErrorProviderNotAddSetCC());
    }

    ErrorProviderNotAddSetCC()
    {
        TextBox tb = new TextBox();
        //
        ErrorProvider ep = new ErrorProvider();
        ep.SetIconAlignment(tb, ErrorIconAlignment.MiddleRight);
        ep.SetIconPadding(tb, 2);
        //
        ep.ContainerControl = this;
        //
        this.Controls.Add(tb);
        //
        //
        ep.SetError(tb, &quot;arggggh&quot;);
    }
}
]]

The case is, create the textbox (etc), set the ErrorProvider for it, set the
EP's ContainerControl, and lastly add the textbox to the form.  This causes the
ErrorWindow.parent to be unset both at initialization and not set -- when it
normally is in event control_ParentChanged -- because of the ContainerControl
setting.  This is the format of code that the VS Form Designer creates.


*A* hack(?) fix is the below:
[[
Index:
D:/cygwin/usr/src/mono/mcs/class/Managed.Windows.Forms/System.Windows.Forms/ErrorProvider.cs
===================================================================
---
D:/cygwin/usr/src/mono/mcs/class/Managed.Windows.Forms/System.Windows.Forms/ErrorProvider.cs
       (revision 87029)
+++
D:/cygwin/usr/src/mono/mcs/class/Managed.Windows.Forms/System.Windows.Forms/ErrorProvider.cs
       (working copy)
@@ -255,7 +255,7 @@

        private void control_ParentChanged (object sender, EventArgs e)
        {
-               if (ep.container != null)
+               if (ep.container != null &amp;&amp; window.Parent != null)
                        return;
                control.Parent.Controls.Add (window);
                control.Parent.Controls.SetChildIndex (window, 0);
]]


However should set_ContainerControl also(?) do *something* like the following:
[[
   foreach (ErrorProperty ep in controls.Values) {
      container.Controls.Add(ep.window);
      container.Controls.SetChildIndex(ep.window, 0);
   }
]]

Don't know what set_ContainerControl's intended for?  Maybe it is meant to
override any parent setting(s) implied from attaching to the extended controls.


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062263.html">[Mono-bugs] [Bug 329714] New: ErrorProvider: NRE in ErrorProvider+ErrorProperty. window_Tick
</A></li>
	<LI>Next message: <A HREF="062874.html">[Mono-bugs] [Bug 329714] ErrorProvider: NRE in ErrorProvider+ErrorProperty.window_Tick
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62641">[ date ]</a>
              <a href="thread.html#62641">[ thread ]</a>
              <a href="subject.html#62641">[ subject ]</a>
              <a href="author.html#62641">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
