<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 330357] Mono + Mod_Mono + Apache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20330357%5D%20Mono%20%2B%20Mod_Mono%20%2B%20Apache&In-Reply-To=bug-330357-28286%40https.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="063225.html">
   <LINK REL="Next"  HREF="063260.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 330357] Mono + Mod_Mono + Apache</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20330357%5D%20Mono%20%2B%20Mod_Mono%20%2B%20Apache&In-Reply-To=bug-330357-28286%40https.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 330357] Mono + Mod_Mono + Apache">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Oct 17 09:42:25 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="063225.html">[Mono-bugs] [Bug 330357] Mono + Mod_Mono + Apache
</A></li>
        <LI>Next message: <A HREF="063260.html">[Mono-bugs] [Bug 330357] Mono + Mod_Mono + Apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63251">[ date ]</a>
              <a href="thread.html#63251">[ thread ]</a>
              <a href="subject.html#63251">[ subject ]</a>
              <a href="author.html#63251">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=330357#c17">https://bugzilla.novell.com/show_bug.cgi?id=330357#c17</A>


Frederic MEYER &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">f.meyer at tetco.fr</A>&gt; changed:

           What    |Removed                                         |Added
----------------------------------------------------------------------------
                 CC|                                                |<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">f.meyer at tetco.fr</A>
             Status|NEEDINFO                                        |ASSIGNED
      Info Provider|<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mirko-novell at nextware.it</A>                        |




--- Comment #17 from Frederic MEYER &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">f.meyer at tetco.fr</A>&gt;  2007-10-17 07:42:24 MST ---
We here have the same random behaviour.

RHEL4 + mono 1.2.5.1 + patched mcs 1.2.5.1 System.Web.Services.dll to get fix
for bug #331183 + apache + mod-mono

The way we can get this error is to stress the first compilation of the web
application (just upon apache or mod_mono restart)

We wrote a script that parses all our aspx pages with a curl in order to get
the compilation done. We have more that one web application.

The problem never arise when we launch our script on only one web application
(which compiles its pages then sequentially)

The problem appears, randomly, when :
- we launch our compilation script on several web apps at the same time
- we launch several compilation scripts on the *same* web app (making
concurrent access like in the real life)

When the problem appears, mono (mod_mono, mod-mono-server2) is still here but
completly deadlocked.

The problem can be somewhat bypassed on multiple apps if we slow down the page
request process, (for instance with a 1s sleep in between each request). But
this is not the real life.

Here are the logs :

[Sun Oct 07 10:42:41 2007] [notice] Apache/2.0.54 (Unix) mod_mono/1.2.5
configured -- resuming normal operations
System.IO.DirectoryNotFoundException: Directory
'/tmp/apache-temp-aspnet-0/stamp' does not exist
  at System.IO.Directory.Delete (System.String path) [0x00000]
  at System.Web.Hosting.ApplicationHost.CreateApplicationHost (System.Type
hostType, System.String virtualDir, System.String physicalDir) [0x00000]
  at Mono.WebServer.VPathToHost.CreateHost (Mono.WebServer.ApplicationServer
server, Mono.WebServer.WebSource webSource) [0x00000]
  at Mono.WebServer.ApplicationServer.GetApplicationForPath (System.String
vhost, Int32 port, System.String path, Boolean defaultToRoot) [0x00000]
  at (wrapper remoting-invoke-with-check)
Mono.WebServer.ApplicationServer:GetApplicationForPath (string,int,string,bool)
  at Mono.WebServer.ModMonoWorker.GetOrCreateApplication (System.String vhost,
Int32 port, System.String filepath, System.String virt) [0x00000]
  at Mono.WebServer.ModMonoWorker.InnerRun (System.Object state) [0x00000]
  at Mono.WebServer.ModMonoWorker.Run (System.Object state) [0x00000]
System.IO.DirectoryNotFoundException: Directory
'/tmp/apache-temp-aspnet-0/stamp' does not exist
  at System.IO.Directory.Delete (System.String path) [0x00000]
  at System.Web.Hosting.ApplicationHost.CreateApplicationHost (System.Type
hostType, System.String virtualDir, System.String physicalDir) [0x00000]
  at Mono.WebServer.VPathToHost.CreateHost (Mono.WebServer.ApplicationServer
server, Mono.WebServer.WebSource webSource) [0x00000]
  at Mono.WebServer.ApplicationServer.GetApplicationForPath (System.String
vhost, Int32 port, System.String path, Boolean defaultToRoot) [0x00000]
  at (wrapper remoting-invoke-with-check)
Mono.WebServer.ApplicationServer:GetApplicationForPath (string,int,string,bool)
  at Mono.WebServer.ModMonoWorker.GetOrCreateApplication (System.String vhost,
Int32 port, System.String filepath, System.String virt) [0x00000]
  at Mono.WebServer.ModMonoWorker.InnerRun (System.Object state) [0x00000]
  at Mono.WebServer.ModMonoWorker.Run (System.Object state) [0x00000]
[Sun Oct 07 10:42:52 2007] [error] (70014)End of file found: read_data failed
[Sun Oct 07 10:42:52 2007] [error] (70014)End of file found: read_data failed
[Sun Oct 07 10:42:52 2007] [error] Command stream corrupted, last command was
-1
[Sun Oct 07 10:42:52 2007] [error] Command stream corrupted, last command was
-1
System.Runtime.Serialization.SerializationException: The object with ID 2 could
not be resolved

Server stack trace:
  at System.Runtime.Serialization.ObjectManager.DoFixups () [0x00000]
  at System.Runtime.Serialization.Formatters.Binary.ObjectReader.ReadNextObject
(System.IO.BinaryReader reader) [0x00000]
  at
System.Runtime.Serialization.Formatters.Binary.ObjectReader.ReadObjectGraph
(System.IO.BinaryReader reader, Boolean readHeaders, System.Object&amp; result,
System.Runtime.Remoting.Messaging.Header[]&amp; headers) [0x00000]
  at
System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.NoCheckDeserialize
(System.IO.Stream serializationStream,
System.Runtime.Remoting.Messaging.HeaderHandler handler) [0x00000]
  at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize
(System.IO.Stream serializationStream) [0x00000]
  at System.Runtime.Remoting.RemotingServices.DeserializeCallData
(System.Byte[] array) [0x00000]
  at (wrapper xdomain-dispatch) Mono.WebServer.BaseApplicationHost:set_Server
(object,byte[]&amp;,byte[]&amp;)

Exception rethrown at [0]:

  at (wrapper xdomain-invoke) Mono.WebServer.BaseApplicationHost:set_Server
(Mono.WebServer.ApplicationServer)
  at Mono.WebServer.VPathToHost.CreateHost (Mono.WebServer.ApplicationServer
server, Mono.WebServer.WebSource webSource) [0x00000]
  at Mono.WebServer.ApplicationServer.GetApplicationForPath (System.String
vhost, Int32 port, System.String path, Boolean defaultToRoot) [0x00000]
  at (wrapper remoting-invoke-with-check)
Mono.WebServer.ApplicationServer:GetApplicationForPath (string,int,string,bool)
  at Mono.WebServer.ModMonoWorker.GetOrCreateApplication (System.String vhost,
Int32 port, System.String filepath, System.String virt) [0x00000]
  at Mono.WebServer.ModMonoWorker.InnerRun (System.Object state) [0x00000]
  at Mono.WebServer.ModMonoWorker.Run (System.Object state) [0x00000]
[Sun Oct 07 10:42:52 2007] [error] (70014)End of file found: read_data failed
[Sun Oct 07 10:42:52 2007] [error] Command stream corrupted, last command was
-1
System.NullReferenceException: Object reference not set to an instance of an
object
  at Mono.WebServer.ModMonoWorker.InnerRun (System.Object state) [0x00000]
  at Mono.WebServer.ModMonoWorker.Run (System.Object state) [0x00000]
[Sun Oct 07 10:42:52 2007] [error] (70014)End of file found: read_data failed
[Sun Oct 07 10:42:52 2007] [error] Command stream corrupted, last command was
-1
System.NullReferenceException: Object reference not set to an instance of an
object
  at Mono.WebServer.ModMonoWorker.InnerRun (System.Object state) [0x00000]
  at Mono.WebServer.ModMonoWorker.Run (System.Object state) [0x00000]
[Sun Oct 07 10:42:52 2007] [error] (70014)End of file found: read_data failed
[Sun Oct 07 10:42:52 2007] [error] Command stream corrupted, last command was
-1
System.NullReferenceException: Object reference not set to an instance of an
object
  at Mono.WebServer.ModMonoWorker.InnerRun (System.Object state) [0x00000]
  at Mono.WebServer.ModMonoWorker.Run (System.Object state) [0x00000]
[Sun Oct 07 10:42:52 2007] [error] (70014)End of file found: read_data failed
[Sun Oct 07 10:42:52 2007] [error] Command stream corrupted, last command was
-1


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="063225.html">[Mono-bugs] [Bug 330357] Mono + Mod_Mono + Apache
</A></li>
	<LI>Next message: <A HREF="063260.html">[Mono-bugs] [Bug 330357] Mono + Mod_Mono + Apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63251">[ date ]</a>
              <a href="thread.html#63251">[ thread ]</a>
              <a href="subject.html#63251">[ subject ]</a>
              <a href="author.html#63251">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
