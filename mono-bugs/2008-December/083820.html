<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 462438] New: SIGSEGV while running	tests/pinvoke2.exe on PowerPC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20462438%5D%20New%3A%20SIGSEGV%20while%20running%0A%09tests/pinvoke2.exe%20on%20PowerPC&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="083819.html">
   <LINK REL="Next"  HREF="083826.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 462438] New: SIGSEGV while running	tests/pinvoke2.exe on PowerPC</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20462438%5D%20New%3A%20SIGSEGV%20while%20running%0A%09tests/pinvoke2.exe%20on%20PowerPC&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 462438] New: SIGSEGV while running	tests/pinvoke2.exe on PowerPC">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Dec 24 11:44:00 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="083819.html">[Mono-bugs] [Bug 439545] Process class no longer works correctly on Mac OS X 10. 4 or earlier
</A></li>
        <LI>Next message: <A HREF="083826.html">[Mono-bugs] [Bug 462438] SIGSEGV while running tests/pinvoke2.exe	on PowerPC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83820">[ date ]</a>
              <a href="thread.html#83820">[ thread ]</a>
              <a href="subject.html#83820">[ subject ]</a>
              <a href="author.html#83820">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=462438">https://bugzilla.novell.com/show_bug.cgi?id=462438</A>


           Summary: SIGSEGV while running tests/pinvoke2.exe on PowerPC
           Product: Mono: Runtime
           Version: 2.2.x
          Platform: PowerPC
        OS/Version: openSUSE 10.3
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: JIT
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">munroesj at us.ibm.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Development


Description of Problem:


Steps to reproduce the problem:
1. for mono-2.2 run configure and make
2. run make check


Actual Results: from make check log

Testing pinvoke2.exe... sh: line 1: 32410 Segmentation fault     
MONO_PATH=/home/sjmunroe/src/mono-ppc/mono-2.2/mcs/class/lib/net_2_0
MONO_SHARED_DIR=/home/sjmunroe/src/mono-ppc/build32_22/runtime
MONO_CFG_DIR=/home/sjmunroe/src/mono-ppc/build32_22/runtime/etc /bin/sh
./../libtool --mode=execute ../mini/mono --config tests-config --optimize=all
--debug pinvoke2.exe 2&gt; pinvoke2.exe.stderr &gt; pinvoke2.exe.stdout
failed 35584 (139) signal (0).

or manually: cd into mono/tests/

MONO_PATH=../../../mcs/class/lib/net_2_0
MONO_SHARED_DIR=$HOME/src/mono-ppc/build32_22/runtime
MONO_CFG_DIR=$HOME/src/mono-ppc/build32_22/runtime/etc ../../mono/mini/mono
pinvoke2.exe

Expected Results:

Testing pinvoke2.exe... pass.


How often does this happen? every time


Additional Information: The manual test returns the following:

Stacktrace:

  at Tests.test_0_amd64_struct1_gen () &lt;0xffffffff&gt;
  at Tests.test_0_amd64_struct1_gen () &lt;0x000f0&gt;
  at Tests.test_0_amd64_struct1_gen () &lt;0x000ec&gt;
  at (wrapper runtime-invoke) Tests.runtime_invoke_int
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0x0009c&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0xffffffff&gt;
  at System.Reflection.MonoMethod.Invoke
(object,System.Reflection.BindingFlags,System.Reflection.Binder,object[],System.Globalization.CultureInfo)
&lt;0x0010c&gt;
  at System.Reflection.MethodBase.Invoke (object,object[]) &lt;0x00040&gt;
  at TestDriver.RunTests (System.Type,string[]) &lt;0x0048c&gt;
  at Tests.Main (string[]) &lt;0x00028&gt;
  at (wrapper runtime-invoke) Tests.runtime_invoke_int_object
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;

Native stacktrace:

        ../../mono/mini/mono [0x100c7b98]
        ../../mono/mini/mono [0x100e8098]
        [0x100350]
        ../../mono/mini/mono(mono_class_init+0xb4) [0x1015f9b4]
        ../../mono/mini/mono [0x1011303c]
        ../../mono/mini/mono [0x10113504]
        ../../mono/mini/mono [0x1001bad8]
        ../../mono/mini/mono [0x100e78a0]
        ../../mono/mini/mono [0x1005272c]
        ../../mono/mini/mono [0x10053080]
        ../../mono/mini/mono(mono_compile_method+0x30) [0x10176890]
        ../../mono/mini/mono [0x10052e84]
        ../../mono/mini/mono(mono_compile_method+0x30) [0x10176890]
        ../../mono/mini/mono [0x100cfe70]
        [0xf7fc4114]
        [0xf75d4598]
        [0xf75f3084]
        ../../mono/mini/mono [0x1005394c]
        ../../mono/mini/mono(mono_runtime_invoke+0x80) [0x10177c90]
        ../../mono/mini/mono(mono_runtime_invoke_array+0x304) [0x1017b304]
        ../../mono/mini/mono [0x1019a448]
        [0xf75f2fa8]
        [0xf75f2a58]
        [0xf75f2934]
        [0xf7ba5988]
        [0xf7ba54cc]
        [0xf7ba539c]
        ../../mono/mini/mono [0x1005394c]
        ../../mono/mini/mono(mono_runtime_invoke+0x80) [0x10177c90]
        ../../mono/mini/mono(mono_runtime_exec_main+0x1bc) [0x1017e74c]
        ../../mono/mini/mono(mono_runtime_run_main+0x194) [0x1017ff44]
        ../../mono/mini/mono(mono_jit_exec+0xa4) [0x100adb44]
        ../../mono/mini/mono(mono_main+0x1490) [0x100af010]
        ../../mono/mini/mono [0x100139c8]
        /lib/libc.so.6 [0xfc1a37c]
        /lib/libc.so.6 [0xfc1a5a0]

Debug info from gdb:

Using host libthread_db library &quot;/lib/libthread_db.so.1&quot;.
[Thread debugging using libthread_db enabled]
[New Thread 0xf7fb6210 (LWP 29619)]
[New Thread 0xf77434b0 (LWP 29621)]
[New Thread 0xf77a34b0 (LWP 29620)]
0x0fe3de40 in read () from /lib/libpthread.so.0
  3 Thread 0xf77a34b0 (LWP 29620)  0x0fe3e6c8 in nanosleep ()
   from /lib/libpthread.so.0
  2 Thread 0xf77434b0 (LWP 29621)  0x0fe3cb64 in <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sem_wait at GLIBC_2.0</A> ()
   from /lib/libpthread.so.0
  1 Thread 0xf7fb6210 (LWP 29619)  0x0fe3de40 in read ()
   from /lib/libpthread.so.0

Thread 3 (Thread 0xf77a34b0 (LWP 29620)):
#0  0x0fe3e6c8 in nanosleep () from /lib/libpthread.so.0
#1  0x101d4a4c in collection_thread (unused=&lt;value optimized out&gt;)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/io-layer/collection.c:34
#2  0x0fe34a64 in start_thread () from /lib/libpthread.so.0
#3  0x0fcd5b58 in clone () from /lib/libc.so.6
Backtrace stopped: previous frame inner to this frame (corrupt stack?)

Thread 2 (Thread 0xf77434b0 (LWP 29621)):
#0  0x0fe3cb64 in <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sem_wait at GLIBC_2.0</A> () from /lib/libpthread.so.0
#1  0x1014fcfc in finalizer_thread (unused=&lt;value optimized out&gt;)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/gc.c:928
#2  0x1018a434 in start_wrapper (data=&lt;value optimized out&gt;)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/threads.c:620
#3  0x101d6b00 in thread_start_routine (args=0x103143b8)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/io-layer/threads.c:279
#4  0x102007ec in GC_start_routine (arg=0xf7e6cf20)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/libgc/pthread_support.c:1382
#5  0x0fe34a64 in start_thread () from /lib/libpthread.so.0
#6  0x0fcd5b58 in clone () from /lib/libc.so.6
Backtrace stopped: previous frame inner to this frame (corrupt stack?)

Thread 1 (Thread 0xf7fb6210 (LWP 29619)):
#0  0x0fe3de40 in read () from /lib/libpthread.so.0
#1  0x100c7d14 in mono_handle_native_sigsegv (signal=&lt;value optimized out&gt;,
    ctx=&lt;value optimized out&gt;)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini-exceptions.c:1437
#2  0x100e8098 in mono_arch_handle_altstack_exception (sigctx=0xf7e66a80,
    fault_addr=&lt;value optimized out&gt;, stack_ovf=0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/exceptions-ppc.c:640
#3  &lt;signal handler called&gt;
#4  0x1015fa38 in mono_class_init (class=0x10381e48)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/class.c:3525
#5  0x1011303c in mono_marshal_load_type_info (klass=0x10381e48)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/marshal.c:11349
#6  0x10113504 in mono_class_native_size (klass=0x10381e48, align=0xffa2d258)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/marshal.c:11488
#7  0x1001bad8 in mono_allocate_stack_slots_full (cfg=0x10390900, backward=0,
    stack_size=0xffa2d2dc, stack_align=0xffa2d2e0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini.c:10364
#8  0x100e78a0 in mono_arch_allocate_vars (m=0x10390900)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini-ppc.c:1185
#9  0x1005272c in mini_method_compile (method=0x1039c220,
    opts=&lt;value optimized out&gt;, domain=0xf7e6bee0,
    run_cctors=&lt;value optimized out&gt;, compile_aot=&lt;value optimized out&gt;,
    parts=0) at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini.c:12744
#10 0x10053080 in mono_jit_compile_method (method=0x1039c220)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini.c:13137
#11 0x10176890 in mono_compile_method (method=0xffffffff)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/object.c:529
#12 0x10052e84 in mono_jit_compile_method (method=0x103546d8)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini.c:13093
#13 0x10176890 in mono_compile_method (method=0xffffffff)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/object.c:529
#14 0x100cfe70 in mono_magic_trampoline (regs=0xffa2d4bc,
    code=0xf75d4598 &quot;\200a&quot;, m=0x103546d8, tramp=&lt;value optimized out&gt;)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini-trampolines.c:290
#15 0xf7fc4114 in ?? ()
#16 0xf75d4598 in ?? ()
#17 0xf75f3084 in ?? ()
#18 0x1005394c in mono_jit_runtime_invoke (method=0xffa2d6b0, obj=0x0,
    params=0x0, exc=0x0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini.c:13481
#19 0x10177c90 in mono_runtime_invoke (method=0x103546f8, obj=0x0, params=0x0,
    exc=0x0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/object.c:2399
#20 0x1017b304 in mono_runtime_invoke_array (method=0x103546f8, obj=0x0,
    params=0x0, exc=0x0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/object.c:3488
#21 0x1019a448 in ves_icall_InternalInvoke (method=&lt;value optimized out&gt;,
    this=0x0, params=0x0, exc=0xffa2d944)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/icall.c:3038
#22 0xf75f2fa8 in ?? ()
#23 0xf75f2a58 in ?? ()
#24 0xf75f2934 in ?? ()
#25 0xf7ba5988 in ?? ()
#26 0xf7ba54cc in ?? ()
#27 0xf7ba539c in ?? ()
#28 0x1005394c in mono_jit_runtime_invoke (method=0xffa2d910, obj=0xf7630450,
    params=0xf762ffc8, exc=0x0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/mini.c:13481
#29 0x10177c90 in mono_runtime_invoke (method=0x102fb098, obj=0x0,
    params=0xffa2db08, exc=0x0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/object.c:2399
#30 0x1017e74c in mono_runtime_exec_main (method=0x102fb098,
    args=&lt;value optimized out&gt;, exc=0x0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/object.c:3291
#31 0x1017ff44 in mono_runtime_run_main (method=0xf7632aa0, argc=1, argv=0x6,
    exc=0x0)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/metadata/object.c:3084
#32 0x100adb44 in mono_jit_exec (domain=&lt;value optimized out&gt;,
    assembly=&lt;value optimized out&gt;, argc=1, argv=0xffa2df28)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/driver.c:920
#33 0x100af010 in mono_main (argc=2, argv=&lt;value optimized out&gt;)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/driver.c:968
#34 0x100139c8 in main (argc=-1, argv=0x10381e48)
    at /home/sjmunroe/src/mono-ppc/mono-2.2/mono/mini/main.c:34
#0  0x0fe3de40 in read () from /lib/libpthread.so.0

=================================================================
Got a SIGSEGV while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries
used by your application.
=================================================================

Aborted


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>
















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="083819.html">[Mono-bugs] [Bug 439545] Process class no longer works correctly on Mac OS X 10. 4 or earlier
</A></li>
	<LI>Next message: <A HREF="083826.html">[Mono-bugs] [Bug 462438] SIGSEGV while running tests/pinvoke2.exe	on PowerPC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83820">[ date ]</a>
              <a href="thread.html#83820">[ thread ]</a>
              <a href="subject.html#83820">[ subject ]</a>
              <a href="author.html#83820">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
