<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 462688] New: IPv6 bug in TcpClient calling	Socket.Bind()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20462688%5D%20New%3A%20IPv6%20bug%20in%20TcpClient%20calling%0A%09Socket.Bind%28%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="083952.html">
   <LINK REL="Next"  HREF="083888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 462688] New: IPv6 bug in TcpClient calling	Socket.Bind()</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20462688%5D%20New%3A%20IPv6%20bug%20in%20TcpClient%20calling%0A%09Socket.Bind%28%29&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 462688] New: IPv6 bug in TcpClient calling	Socket.Bind()">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun Dec 28 14:32:40 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="083952.html">[Mono-bugs] [Bug 462687] Drag and Drop files on the WinForm doesn't	work
</A></li>
        <LI>Next message: <A HREF="083888.html">[Mono-bugs] [Bug 462688] IPv6 bug in TcpClient calling Socket.Bind()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83887">[ date ]</a>
              <a href="thread.html#83887">[ thread ]</a>
              <a href="subject.html#83887">[ subject ]</a>
              <a href="author.html#83887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=462688">https://bugzilla.novell.com/show_bug.cgi?id=462688</A>


           Summary: IPv6 bug in TcpClient calling Socket.Bind()
           Product: Mono: Runtime
           Version: 2.0.x
          Platform: i686
        OS/Version: Linux
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: remoting
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lluis at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">d.paleino at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Development


Trying to debug why a c# IRC client did not connect through IPv6, I've found
out that a bug probably exists in TcpClient calling Bind(). I'm attaching a
simple testcase, with a server and a client both communicating locally with
IPv6.

Also, I believe it's the internal call of Bind() from TcpClient that is buggy,
since an implementation with the lower-level Socket class is successful.

Here's the mdb run (sorry I've not been able to go further):

$ mdb ./Client/bin/Debug/Client.exe 
Mono Debugger
(mdb) run
Starting program: ./Client/bin/Debug/Client.exe 
Thread @1 stopped at #0: 0xb79547b9 in ipv6.Client.Main(string[])+0x9 at
/home/neo/code/c-sharp/ipv6/Client/Client.cs:31.
  31                    if (!Socket.OSSupportsIPv6) {
(mdb) c

Unhandled Exception: System.Net.Sockets.SocketException: Invalid arguments
  at System.Net.Sockets.Socket.Bind (System.Net.EndPoint local_end) [0x0006c]
in /tmp/buildd/mono-2.0.1/mcs/class/System/System.Net.Sockets/Socket.cs:2038 
  at System.Net.Sockets.TcpClient..ctor (AddressFamily family) [0x0002c] in
/tmp/buildd/mono-2.0.1/mcs/class/System/System.Net.Sockets/TcpClient.cs:87 
  at ipv6.Client.Main (System.String[] args) [0x00028] in
/home/neo/code/c-sharp/ipv6/Client/Client.cs:40 
Thread @1 caught unhandled exception at #0: 0xb700d77b in
System.Net.Sockets.Socket.Bind(System.Net.EndPoint)+0xeb.
0xb700d77b      add    %ch,0xffffffe4(%eax)
(mdb) f
#0: 0xb700d77b in System.Net.Sockets.Socket.Bind(System.Net.EndPoint)+0xeb
0xb700d77b      add    %ch,0xffffffe4(%eax)
(mdb) show locals
ERROR: Selected stack frame has no method.
(mdb) show params
ERROR: Selected stack frame has no method.
(mdb) up
#1: 0xb700d4de in
System.Net.Sockets.TcpClient..ctor(System.Net.Sockets.AddressFamily)+0x56 at
/tmp/buildd/mono-2.0.1/mcs/class/System/System.Net.Sockets/TcpClient.cs:87
0xb700d4de      call  
0xb700d690:System.Net.Sockets.Socket.Bind(System.Net.EndPoint)
(mdb) show locals
(mdb) show params
family = (System.Net.Sockets.AddressFamily) InterNetworkV6
(mdb) up
#2: 0xb795481b in ipv6.Client.Main(string[])+0x6b at
/home/neo/code/c-sharp/ipv6/Client/Client.cs:40
  40                    TcpClient client = new
TcpClient(AddressFamily.InterNetworkV6);
(mdb) show locals
b = (byte[]) null
client = &lt;cannot display object&gt;
ip = (System.Net.IPAddress) { m_Address = 0, m_Family = InterNetworkV6,
m_Numbers = 0x0008b6e0, 
   m_ScopeId = 0, m_HashCode = 0 }
iploop = (System.Net.IPAddress) { m_Address = 0, m_Family = InterNetworkV6, 
   m_Numbers = 0x000484a0, m_ScopeId = 0, m_HashCode = 0 }
IPv6_ADDR = (string) &quot;::1&quot;
(mdb) show params
args = (string[]) [ ]
(mdb)


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>

















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="083952.html">[Mono-bugs] [Bug 462687] Drag and Drop files on the WinForm doesn't	work
</A></li>
	<LI>Next message: <A HREF="083888.html">[Mono-bugs] [Bug 462688] IPv6 bug in TcpClient calling Socket.Bind()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83887">[ date ]</a>
              <a href="thread.html#83887">[ thread ]</a>
              <a href="subject.html#83887">[ subject ]</a>
              <a href="author.html#83887">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
