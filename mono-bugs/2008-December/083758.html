<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 462016] New: make check for pinvoke2.exe fails for	PowerPC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20462016%5D%20New%3A%20make%20check%20for%20pinvoke2.exe%20fails%20for%0A%09PowerPC&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="083757.html">
   <LINK REL="Next"  HREF="083761.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 462016] New: make check for pinvoke2.exe fails for	PowerPC</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20462016%5D%20New%3A%20make%20check%20for%20pinvoke2.exe%20fails%20for%0A%09PowerPC&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 462016] New: make check for pinvoke2.exe fails for	PowerPC">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Dec 23 12:20:36 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="083757.html">[Mono-bugs] [Bug 324335] [Vista] Win32 Interop Issue
</A></li>
        <LI>Next message: <A HREF="083761.html">[Mono-bugs] [Bug 462016] make check for pinvoke2.exe fails for	PowerPC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83758">[ date ]</a>
              <a href="thread.html#83758">[ thread ]</a>
              <a href="subject.html#83758">[ subject ]</a>
              <a href="author.html#83758">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=462016">https://bugzilla.novell.com/show_bug.cgi?id=462016</A>


           Summary: make check for pinvoke2.exe fails for PowerPC
           Product: Mono: Runtime
           Version: SVN
          Platform: PowerPC
        OS/Version: openSUSE 10.3
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: JIT
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">munroesj at us.ibm.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Development


Description of Problem:

with mono r121910 the mae check fails consistently for pinvoke2.exe

** ERROR **: file class.c: line 3617 (mono_class_init): assertion failed:
(class-&gt;interface_count == gklass-&gt;interface_count)
aborting...
Stacktrace:

  at Tests.test_0_amd64_struct1_gen () &lt;0xffffffff&gt;
  at Tests.test_0_amd64_struct1_gen () &lt;0x000f0&gt;
  at Tests.test_0_amd64_struct1_gen () &lt;0x000ec&gt;
  at (wrapper runtime-invoke) Tests.runtime_invoke_int
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0x000e4&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0xffffffff&gt;
  at System.Reflection.MonoMethod.Invoke
(object,System.Reflection.BindingFlags,System.Reflection.Binder,object[],System.Globalization.CultureInfo)
&lt;0x0010c&gt;
  at System.Reflection.MethodBase.Invoke (object,object[]) &lt;0x00040&gt;
  at TestDriver.RunTests (System.Type,string[]) &lt;0x0048c&gt;
  at Tests.Main (string[]) &lt;0x00028&gt;
  at (wrapper runtime-invoke) Tests.runtime_invoke_int_object
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;


Steps to reproduce the problem:
1. on a ppc machine svn checkout
2. from the mono/ configure and make
3. make check

can also manually run by cding into the mono/mono/tests directory and:

MONO_PATH=../../../mcs/class/lib/net_2_0
MONO_SHARED_DIR=$HOME/src/mono-svn/mono/runtime
MONO_CFG_DIR=$HOME/src/mono-ppc/mono-svn/mono/runtime/etc ../../mono/mini/mono
pinvoke2.exe


Actual Results:

** ERROR **: file class.c: line 3617 (mono_class_init): assertion failed:
(class-&gt;interface_count == gklass-&gt;interface_count)
aborting...

Expected Results:

pinvoke2.exe pass

How often does this happen? every time


Additional Information: Full abort dump:

** ERROR **: file class.c: line 3617 (mono_class_init): assertion failed:
(class-&gt;interface_count == gklass-&gt;interface_count)
aborting...
Stacktrace:

  at Tests.test_0_amd64_struct1_gen () &lt;0xffffffff&gt;
  at Tests.test_0_amd64_struct1_gen () &lt;0x000f0&gt;
  at Tests.test_0_amd64_struct1_gen () &lt;0x000ec&gt;
  at (wrapper runtime-invoke) Tests.runtime_invoke_int
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0x000e4&gt;
  at (wrapper managed-to-native) System.Reflection.MonoMethod.InternalInvoke
(object,object[],System.Exception&amp;) &lt;0xffffffff&gt;
  at System.Reflection.MonoMethod.Invoke
(object,System.Reflection.BindingFlags,System.Reflection.Binder,object[],System.Globalization.CultureInfo)
&lt;0x0010c&gt;
  at System.Reflection.MethodBase.Invoke (object,object[]) &lt;0x00040&gt;
  at TestDriver.RunTests (System.Type,string[]) &lt;0x0048c&gt;
  at Tests.Main (string[]) &lt;0x00028&gt;
  at (wrapper runtime-invoke) Tests.runtime_invoke_int_object
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;

Native stacktrace:

        ../../mono/mini/mono [0x1008b928]
        [0x100350]
        [0xff936a18]
        /lib/libc.so.6(abort+0x230) [0xfc33278]
        /usr/lib/libglib-2.0.so.0(g_logv+0x450) [0xff410d0]
        /usr/lib/libglib-2.0.so.0(g_log+0x68) [0xff41148]
        /usr/lib/libglib-2.0.so.0(g_assert_warning+0x8c) [0xff411ec]
        ../../mono/mini/mono(mono_class_init+0x228) [0x100fb6e8]
        ../../mono/mini/mono(mono_class_init+0x188) [0x100fb648]
        ../../mono/mini/mono(mono_class_init+0x24c) [0x100fb70c]
        ../../mono/mini/mono [0x100ae60c]
        ../../mono/mini/mono [0x100aead4]
        ../../mono/mini/mono [0x10019bb8]
        ../../mono/mini/mono [0x100a5d44]
        ../../mono/mini/mono [0x1001bd34]
        ../../mono/mini/mono [0x1001c9f0]
        ../../mono/mini/mono(mono_compile_method+0x30) [0x101125a0]
        ../../mono/mini/mono [0x1001c7f4]
        ../../mono/mini/mono(mono_compile_method+0x30) [0x101125a0]
        ../../mono/mini/mono [0x10093b40]
        [0xf7fc4114]
        [0xf75d6ca0]
        [0xf75f548c]
        ../../mono/mini/mono [0x1001d2bc]
        ../../mono/mini/mono(mono_runtime_invoke+0x80) [0x101139a0]
        ../../mono/mini/mono(mono_runtime_invoke_array+0x304) [0x10117024]
        ../../mono/mini/mono [0x10136328]
        [0xf75f53b0]
        [0xf75f4e38]
        [0xf75f4d14]
        [0xf7ba5990]
        [0xf7ba54d4]
        [0xf7ba53a4]
        ../../mono/mini/mono [0x1001d2bc]
        ../../mono/mini/mono(mono_runtime_invoke+0x80) [0x101139a0]
        ../../mono/mini/mono(mono_runtime_exec_main+0x1bc) [0x1011a46c]
        ../../mono/mini/mono(mono_runtime_run_main+0x194) [0x1011bc94]
        ../../mono/mini/mono(mono_jit_exec+0xa4) [0x10071b44]
        ../../mono/mini/mono(mono_main+0x1490) [0x10073010]
        ../../mono/mini/mono [0x10013648]
        /lib/libc.so.6 [0xfc1a37c]
        /lib/libc.so.6 [0xfc1a5a0]

Debug info from gdb:

Using host libthread_db library &quot;/lib/libthread_db.so.1&quot;.
[Thread debugging using libthread_db enabled]
[New Thread 0xf7fb6210 (LWP 14264)]
[New Thread 0xf77434a0 (LWP 14266)]
[New Thread 0xf77a34a0 (LWP 14265)]
0x0fe3de40 in read () from /lib/libpthread.so.0
  3 Thread 0xf77a34a0 (LWP 14265)  0x0fe3e6c8 in nanosleep ()
   from /lib/libpthread.so.0
  2 Thread 0xf77434a0 (LWP 14266)  0x0fe3cb64 in <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sem_wait at GLIBC_2.0</A> ()
   from /lib/libpthread.so.0
  1 Thread 0xf7fb6210 (LWP 14264)  0x0fe3de40 in read ()
   from /lib/libpthread.so.0

Thread 3 (Thread 0xf77a34a0 (LWP 14265)):
#0  0x0fe3e6c8 in nanosleep () from /lib/libpthread.so.0
#1  0x10170a6c in collection_thread (unused=&lt;value optimized out&gt;)
    at collection.c:34
#2  0x0fe34a64 in start_thread () from /lib/libpthread.so.0
#3  0x0fcd5b58 in clone () from /lib/libc.so.6
Backtrace stopped: previous frame inner to this frame (corrupt stack?)

Thread 2 (Thread 0xf77434a0 (LWP 14266)):
#0  0x0fe3cb64 in <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sem_wait at GLIBC_2.0</A> () from /lib/libpthread.so.0
#1  0x100eb7fc in finalizer_thread (unused=&lt;value optimized out&gt;) at gc.c:928
#2  0x10126220 in start_wrapper (data=&lt;value optimized out&gt;) at threads.c:620
#3  0x10172b20 in thread_start_routine (args=0x102bb3f0) at threads.c:279
#4  0x1019c80c in GC_start_routine (arg=0xf7e6cf20) at pthread_support.c:1382
#5  0x0fe34a64 in start_thread () from /lib/libpthread.so.0
#6  0x0fcd5b58 in clone () from /lib/libc.so.6
Backtrace stopped: previous frame inner to this frame (corrupt stack?)

Thread 1 (Thread 0xf7fb6210 (LWP 14264)):
#0  0x0fe3de40 in read () from /lib/libpthread.so.0
#1  0x1008baa4 in mono_handle_native_sigsegv (signal=&lt;value optimized out&gt;,
    ctx=&lt;value optimized out&gt;) at mini-exceptions.c:1439
#2  &lt;signal handler called&gt;
#3  0x0fc316c8 in raise () from /lib/libc.so.6
#4  0x0fc33144 in abort () from /lib/libc.so.6
#5  0x0ff410d0 in g_logv () from /usr/lib/libglib-2.0.so.0
#6  0x0ff41148 in g_log () from /usr/lib/libglib-2.0.so.0
#7  0x0ff411ec in g_assert_warning () from /usr/lib/libglib-2.0.so.0
#8  0x100fb6e8 in mono_class_init (class=0x102f6ee8) at class.c:3617
#9  0x100fb648 in mono_class_init (class=0x10312cd0) at class.c:3604
#10 0x100fb70c in mono_class_init (class=0x1033a630) at class.c:3621
#11 0x100ae60c in mono_marshal_load_type_info (klass=0x1033a630)
    at marshal.c:11439
#12 0x100aead4 in mono_class_native_size (klass=0x1033a630, align=0xff937228)
    at marshal.c:11578
#13 0x10019bb8 in mono_allocate_stack_slots_full (cfg=0x1033a2d0, backward=0,
    stack_size=0xff9372ac, stack_align=0xff9372b0) at mini.c:1630
#14 0x100a5d44 in mono_arch_allocate_vars (m=0x1033a2d0) at mini-ppc.c:1252
#15 0x1001bd34 in mini_method_compile (method=0x10342c90, opts=271804944,
    domain=0xf7e6bee0, run_cctors=270287268, compile_aot=1, parts=0)
    at mini.c:3432
#16 0x1001c9f0 in mono_jit_compile_method (method=0x10342c90) at mini.c:3826
#17 0x101125a0 in mono_compile_method (method=0x0) at object.c:529
#18 0x1001c7f4 in mono_jit_compile_method (method=0x102ef9c0) at mini.c:3782
#19 0x101125a0 in mono_compile_method (method=0x0) at object.c:529
#20 0x10093b40 in mono_magic_trampoline (regs=0xff93749c,
    code=0xf75d6ca0 &quot;\200a&quot;, m=0x102ef9c0, tramp=&lt;value optimized out&gt;)
    at mini-trampolines.c:292
#21 0xf7fc4114 in ?? ()
#22 0xf75d6ca0 in ?? ()
#23 0xf75f548c in ?? ()
#24 0x1001d2bc in mono_jit_runtime_invoke (method=0xff9376a0, obj=0x0,
    params=0x0, exc=0x0) at mini.c:4170
#25 0x101139a0 in mono_runtime_invoke (method=0x102ef9e0, obj=0x0, params=0x0,
    exc=0x0) at object.c:2399
#26 0x10117024 in mono_runtime_invoke_array (method=0x102ef9e0, obj=0x0,
    params=0x0, exc=0x0) at object.c:3493
#27 0x10136328 in ves_icall_InternalInvoke (method=&lt;value optimized out&gt;,
    this=0x0, params=0x0, exc=0xff93793c) at icall.c:3056
#28 0xf75f53b0 in ?? ()
#29 0xf75f4e38 in ?? ()
#30 0xf75f4d14 in ?? ()
#31 0xf7ba5990 in ?? ()
#32 0xf7ba54d4 in ?? ()
#33 0xf7ba53a4 in ?? ()
#34 0x1001d2bc in mono_jit_runtime_invoke (method=0xff937910, obj=0xf7631450,
    params=0xf7630fc8, exc=0x0) at mini.c:4170
#35 0x101139a0 in mono_runtime_invoke (method=0x102a20a8, obj=0x0,
    params=0xff937b18, exc=0x0) at object.c:2399
#36 0x1011a46c in mono_runtime_exec_main (method=0x102a20a8,
    args=&lt;value optimized out&gt;, exc=0x0) at object.c:3296
#37 0x1011bc94 in mono_runtime_run_main (method=0xf7633aa0, argc=1, argv=0x6,
    exc=0x0) at object.c:3084
#38 0x10071b44 in mono_jit_exec (domain=&lt;value optimized out&gt;,
    assembly=&lt;value optimized out&gt;, argc=1, argv=0xff937f38) at driver.c:921
#39 0x10073010 in mono_main (argc=2, argv=&lt;value optimized out&gt;)
    at driver.c:969
#40 0x10013648 in main (argc=0, argv=0x37b8) at main.c:34
#0  0x0fe3de40 in read () from /lib/libpthread.so.0

=================================================================
Got a SIGABRT while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries
used by your application.
=================================================================

Aborted


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="083757.html">[Mono-bugs] [Bug 324335] [Vista] Win32 Interop Issue
</A></li>
	<LI>Next message: <A HREF="083761.html">[Mono-bugs] [Bug 462016] make check for pinvoke2.exe fails for	PowerPC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83758">[ date ]</a>
              <a href="thread.html#83758">[ thread ]</a>
              <a href="subject.html#83758">[ subject ]</a>
              <a href="author.html#83758">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
