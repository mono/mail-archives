<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 77028][Min] Changed - mono build process segfaults
	on powerpc
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2077028%5D%5BMin%5D%20Changed%20-%20mono%20build%20process%20segfaults%0A%09on%20powerpc&In-Reply-To=bug-77028%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043712.html">
   <LINK REL="Next"  HREF="043714.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 77028][Min] Changed - mono build process segfaults
	on powerpc</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2077028%5D%5BMin%5D%20Changed%20-%20mono%20build%20process%20segfaults%0A%09on%20powerpc&In-Reply-To=bug-77028%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 77028][Min] Changed - mono build process segfaults
	on powerpc">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Thu Jun 15 11:32:50 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="043712.html">[Mono-bugs] [Bug 78652][Nor] Changed - [2.0] Control.BeginInvoke
	crashes if security not enabled.
</A></li>
        <LI>Next message: <A HREF="043714.html">[Mono-bugs] [Bug 78641][Cos] Changed - [PATCH] quiet some gcc
	signed warnings in ppc port
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43713">[ date ]</a>
              <a href="thread.html#43713">[ thread ]</a>
              <a href="subject.html#43713">[ subject ]</a>
              <a href="author.html#43713">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at ximian.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=77028">http://bugzilla.ximian.com/show_bug.cgi?id=77028</A>

--- shadow/77028	2006-03-28 23:38:54.000000000 -0500
+++ shadow/77028.tmp.5485	2006-06-15 11:32:50.000000000 -0400
@@ -1,22 +1,22 @@
 Bug#: 77028
 Product: Mono: Runtime
 Version: 1.1
 OS: unknown
 OS Details: Ubuntu
-Status: NEW   
-Resolution: 
+Status: RESOLVED   
+Resolution: FIXED
 Severity: Unknown
 Priority: Minor
 Component: misc
 AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at ximian.com</A>                            
 ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">slomo at ubuntu.com</A>               
 QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
 TargetMilestone: ---
 URL: 
-Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">brandon at smarterits.com</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,cjwatson at ubuntu.com</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,dostrow at gentoo.org</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,eric at extremeboredom.net</A>
+Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">brandon at smarterits.com</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,cjwatson at ubuntu.com</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,dostrow at gentoo.org</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,eric at extremeboredom.net</A><A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">,johannes at sipsolutions.net</A>
 Summary: mono build process segfaults on powerpc
 
 Hi,
 mono 1.1.11 (and 1.1.10.1 but not 1.1.10) segfault while building on ppc64
 machines running in 32bit mode. It works on an normal ppc.
 It happens every time but always in another file while compiling some c#
@@ -406,6 +406,57 @@
 +    unsigned long mask = 1;
 +    sched_setaffinity(0, sizeof(mask), &amp;mask);
 +    #endif
         return mono_main (argc, argv);
  }
 
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">johannes at sipsolutions.net</A>  2006-06-09 12:20 -------
+I ran it in valgrind and got some more info:
+<A HREF="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=371134">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=371134</A>
+
+valgrind isn't working all too well reporting literally thousands of
+errors,
+but the last error before mono is terminated is:
+
+==8225== Process terminating with default action of signal 11 (SIGSEGV)
+==8225==  Bad permissions for mapped region at address 0xB0B8C28
+==8225==    at 0xB0B8C28: ???
+==8225==    by 0xFA09C0C: sigsuspend (in /lib/tls/libc-2.3.6.so)
+==8225==    by 0xFF1C008: GC_suspend_handler (in
+/usr/lib/libmono.so.0.0.0)
+==8225==    by 0xB0B9564: ???
+==8225==    by 0xFE36AFC: mono_arch_output_basic_block (in
+/usr/lib/libmono.so.0.0.0)
+==8225==    by 0xFDEE77C: mono_codegen (in /usr/lib/libmono.so.0.0.0)
+==8225==    by 0xFE0A218: mini_method_compile (in
+/usr/lib/libmono.so.0.0.0)
+==8225==    by 0xFE0AF98: (within /usr/lib/libmono.so.0.0.0)
+==8225==    by 0xFE6D2BC: mono_compile_method (in
+/usr/lib/libmono.so.0.0.0)
+==8225==    by 0xFE0B16C: (within /usr/lib/libmono.so.0.0.0)
+==8225==    by 0xFE0B2D4: (within /usr/lib/libmono.so.0.0.0)
+==8225==    by 0xFE6CD10: mono_runtime_invoke (in
+/usr/lib/libmono.so.0.0.0)
+
+
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">johannes at sipsolutions.net</A>  2006-06-13 05:12 -------
+That valgrind output is misleading, seems to be a valgrind bug with
+signal handling or something strange. At least it doesn't seem to be
+the cause of the problem, stay tuned.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">johannes at sipsolutions.net</A>  2006-06-13 05:20 -------
+Created an attachment (id=17171)
+patch + description of the problem
+
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">johannes at sipsolutions.net</A>  2006-06-13 05:22 -------
+Failed to mention: I've had beagle index *a lot* of things with the
+mono created with this patch (and the debian patches) and it never
+crashed.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at ximian.com</A>  2006-06-15 11:32 -------
+Thanks Johannes, a more complete fix is in svn.
+The sched_setaffinity () workaround should not be needed anymore:
+people who could reproduce the error should test current svn and
+reopen the bug if it happens again.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043712.html">[Mono-bugs] [Bug 78652][Nor] Changed - [2.0] Control.BeginInvoke
	crashes if security not enabled.
</A></li>
	<LI>Next message: <A HREF="043714.html">[Mono-bugs] [Bug 78641][Cos] Changed - [PATCH] quiet some gcc
	signed warnings in ppc port
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43713">[ date ]</a>
              <a href="thread.html#43713">[ thread ]</a>
              <a href="subject.html#43713">[ subject ]</a>
              <a href="author.html#43713">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
