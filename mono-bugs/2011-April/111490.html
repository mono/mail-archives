<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 690475] New: Unexpected XmlConvert.ToDateTime(string, XmlDateTimeSerializationMode) behaviour
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20690475%5D%20New%3A%20Unexpected%0A%20XmlConvert.ToDateTime%28string%2C%20XmlDateTimeSerializationMode%29%20behaviour&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="111491.html">
   <LINK REL="Next"  HREF="111495.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 690475] New: Unexpected XmlConvert.ToDateTime(string, XmlDateTimeSerializationMode) behaviour</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20690475%5D%20New%3A%20Unexpected%0A%20XmlConvert.ToDateTime%28string%2C%20XmlDateTimeSerializationMode%29%20behaviour&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 690475] New: Unexpected XmlConvert.ToDateTime(string, XmlDateTimeSerializationMode) behaviour">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Apr 28 03:39:27 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="111491.html">[Mono-bugs] [Bug 690474] mod_mono autorestart under load drops connections and may corrupt the command stream
</A></li>
        <LI>Next message: <A HREF="111495.html">[Mono-bugs] [Bug 690475] Unexpected XmlConvert.ToDateTime(string, XmlDateTimeSerializationMode) behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111490">[ date ]</a>
              <a href="thread.html#111490">[ thread ]</a>
              <a href="subject.html#111490">[ subject ]</a>
              <a href="author.html#111490">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=690475">https://bugzilla.novell.com/show_bug.cgi?id=690475</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=690475#c0">https://bugzilla.novell.com/show_bug.cgi?id=690475#c0</A>


           Summary: Unexpected
                    XmlConvert.ToDateTime(string,XmlDateTimeSerializationM
                    ode) behaviour
    Classification: Mono
           Product: Mono: Class Libraries
           Version: unspecified
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Sys.XML
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">atsushi at ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">a.selle at subsembly.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Windows NT 6.1; rv:2.0) Gecko/20100101
Firefox/4.0

When converting a UTC time specification using the following method call:

XmlConvert.ToDateTime(&quot;2009-12-15T08:44:05.2700544Z&quot;,
XmlDateTimeSerializationMode.Local);

the method produces the following exception:

System.FormatException: Invalid format string
  at System.DateTime.ParseExact (System.String s, System.String[] formats,
IFormatProvider provider, DateTimeStyles style) [0x0005c] in
/home/jon/Development/mono-droid/mono/mcs/class/corlib/System/DateTime.cs:1761
  at System.Xml.XmlConvert.ToDateTime (System.String s, System.String[]
formats, DateTimeStyles style) [0x00000] in
/home/jon/Development/mono-droid/mono/mcs/class/System.XML/System.Xml/XmlConvert.cs:403
  at System.Xml.XmlConvert.ToDateTime (System.String s, System.String[]
formats) [0x00000] in
/home/jon/Development/mono-droid/mono/mcs/class/System.XML/System.Xml/XmlConvert.cs:397
  at System.Xml.XmlConvert.ToDateTime (System.String value,
XmlDateTimeSerializationMode mode) [0x0001d] in
/home/jon/Development/mono-droid/mono/mcs/class/System.XML/System.Xml/XmlConvert.cs:371
..

The Mono implementation of this method requires that a local date time
specification is passed to the method in order to work successfully. This
behaviour, however, is different to the documented (and implemented) Microsoft
NET Framework behaviour where the parameter XmlDateTimeSerializationMode is
documented as:

&quot;One of the XmlDateTimeSerializationMode values that specify whether the date
should be converted to local time or preserved as Coordinated Universal Time
(UTC), if it is a UTC date.&quot;

Thus the expected behaviour (which is also the actual behaviour of the MS .NET
Framework) would be that the UTC date time specification is parsed
successfully, and then converted to a local date time representation which is
returned to the caller.


Reproducible: Always

Steps to Reproduce:
Just call

XmlConvert.ToDateTime(&quot;2009-12-15T08:44:05.2700544Z&quot;,
XmlDateTimeSerializationMode.Local);
Actual Results:  
System.FormatException: Invalid format string


Expected Results:  
The UTC date time specification whould be parsed successfully, and then
converted to a local DateTime instance which is returned to the caller.

I observed this when working with Mono for Android, but I think it probably
applies to all Mono class library implementations.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>




































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="111491.html">[Mono-bugs] [Bug 690474] mod_mono autorestart under load drops connections and may corrupt the command stream
</A></li>
	<LI>Next message: <A HREF="111495.html">[Mono-bugs] [Bug 690475] Unexpected XmlConvert.ToDateTime(string, XmlDateTimeSerializationMode) behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111490">[ date ]</a>
              <a href="thread.html#111490">[ thread ]</a>
              <a href="subject.html#111490">[ subject ]</a>
              <a href="author.html#111490">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
