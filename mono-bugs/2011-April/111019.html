<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 685267] &lt;asp:TreeView&gt; PostBack problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20685267%5D%20%3Casp%3ATreeView%3E%20PostBack%20problem&In-Reply-To=bug-685267-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="110977.html">
   <LINK REL="Next"  HREF="111056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 685267] &lt;asp:TreeView&gt; PostBack problem</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20685267%5D%20%3Casp%3ATreeView%3E%20PostBack%20problem&In-Reply-To=bug-685267-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 685267] &lt;asp:TreeView&gt; PostBack problem">bugzilla_noreply at novell.com
       </A><BR>
    <I>Wed Apr 13 14:42:33 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="110977.html">[Mono-bugs] [Bug 685267] &lt;asp:TreeView&gt; PostBack problem
</A></li>
        <LI>Next message: <A HREF="111056.html">[Mono-bugs] [Bug 685267] &lt;asp:TreeView&gt; PostBack problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111019">[ date ]</a>
              <a href="thread.html#111019">[ thread ]</a>
              <a href="subject.html#111019">[ subject ]</a>
              <a href="author.html#111019">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=685267">https://bugzilla.novell.com/show_bug.cgi?id=685267</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=685267#c2">https://bugzilla.novell.com/show_bug.cgi?id=685267#c2</A>


--- Comment #2 from QuickJack . &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">test051102 at hotmail.com</A>&gt; 2011-04-13 18:42:31 UTC ---
I have debugged the problematic parts inside System.Web.UI and found a possible
solution.

Analysis
==============================
Next are the steps to reproduce the problematic parts using
Mono 2.10.1:

(1) Open the sample WebApp in MonoDevelop 2.6 Beta 1
(2) Put a breakpoint into line 146 of System.Web.UI.ClientScriptManager.cs
(3) Put a breakpoint into Page.Page_Load() and setup a watch expression to
evaluate the value of Page.IsPostBack
(4) Start the sample WebApp and click the button.
(5) The breakpoint in ClientScriptManager is hit. The call to
RegisterHiddenField (Page.PreviousPageID, page.Request.FilePath) tries to add a
hidden field to the
page. This hidden field contains a reference to the previous page for the next
postback. However, page.Request.FilePath points to /Default.aspx which is
wrong.
(5) The breakpoint in Page.Page_Load() is hit. Page.IsPostback is false, which
is correct.
(6) Hit the button on Page.aspx. Now, the previously set up page using the
wrong reference to the previous page is posted back. As a result, the postback
is not working as expected. When observing the value of Page.IsPostBack inside
Page.Page_Load() we can see, that it is still false instead of true!

Solution
==============================
I have changed line 146 of System.Web.UI.ClientScriptManager.cs as follows:

if (page.Request.Url != null)
    RegisterHiddenField (Page.PreviousPageID, page.Request.Url.AbsolutePath);

Result: The behaviour of the LinkButton and that of the TreeView as well is
working as expected using my sample WebApp.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="110977.html">[Mono-bugs] [Bug 685267] &lt;asp:TreeView&gt; PostBack problem
</A></li>
	<LI>Next message: <A HREF="111056.html">[Mono-bugs] [Bug 685267] &lt;asp:TreeView&gt; PostBack problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111019">[ date ]</a>
              <a href="thread.html#111019">[ thread ]</a>
              <a href="subject.html#111019">[ subject ]</a>
              <a href="author.html#111019">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
