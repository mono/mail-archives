<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 649994] New: PrinterSettings.InstalledPrinters throws an exception
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20649994%5D%20New%3A%20PrinterSettings.InstalledPrinters%0A%20throws%20an%20exception&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="105603.html">
   <LINK REL="Next"  HREF="105614.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 649994] New: PrinterSettings.InstalledPrinters throws an exception</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20649994%5D%20New%3A%20PrinterSettings.InstalledPrinters%0A%20throws%20an%20exception&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 649994] New: PrinterSettings.InstalledPrinters throws an exception">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Oct 28 15:29:19 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="105603.html">[Mono-bugs] [Bug 649969] Web service test form formatting problem with braces in attribute values
</A></li>
        <LI>Next message: <A HREF="105614.html">[Mono-bugs] [Bug 649994] PrinterSettings.InstalledPrinters throws	an exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#105590">[ date ]</a>
              <a href="thread.html#105590">[ thread ]</a>
              <a href="subject.html#105590">[ subject ]</a>
              <a href="author.html#105590">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=649994">https://bugzilla.novell.com/show_bug.cgi?id=649994</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=649994#c0">https://bugzilla.novell.com/show_bug.cgi?id=649994#c0</A>


           Summary: PrinterSettings.InstalledPrinters throws an exception
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 1.2.0
          Platform: Macintosh
        OS/Version: Mac OS X 10.5
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: Sys.Drawing.
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dpldobrev at yahoo.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=397641)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=397641">http://bugzilla.novell.com/attachment.cgi?id=397641</A>)
A project reproducing the issue.

User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; bg;
rv:1.9.2.12) Gecko/20101026 Firefox/3.6.12

Trying to use PrinterSettings.InstalledPrinters generates an error: &quot;libcups
not found. To have printing support, you need cups installed&quot; on Mac OS X
Leopard. This is incorrect because libcups (/usr/lib/libcups.dylib) is present;
it is instlled by default because Mac OS X uses it itself for its native
printing.

Reproducible: Always

Steps to Reproduce:
1. Call PrinterSettings.InstalledPrinters in Mac OS X Leopard.
Actual Results:  
An exception that the unmanaged library of libcups cannot be found.

Expected Results:  
Obtain a list of the names of all installed printers (or an empty list if there
are none).

I made an experiment which you can find in the attached project. I copied the
class of PrintingServicesUnix, which PrinterSettings uses internally, from the
mono code base, along with its depencencies. After commenting out the usage of
some internal members (to be able to compile) I tried to access
PrintingServicesUnix.InstalledPrinters. The result was the same, libcups not
found. Then I replaced all occurences of DllImport(&quot;libcups&quot;) with
DllImport(&quot;libcups.dylib&quot;). Recompiled, ran it again - this time it worked
right away and correcty got the name of my (virtual) printer. This is quite
strange, I thought the Mono runtime was able to find the libraries on its own
if they are specified with no extension as they are in this case?

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="105603.html">[Mono-bugs] [Bug 649969] Web service test form formatting problem with braces in attribute values
</A></li>
	<LI>Next message: <A HREF="105614.html">[Mono-bugs] [Bug 649994] PrinterSettings.InstalledPrinters throws	an exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#105590">[ date ]</a>
              <a href="thread.html#105590">[ thread ]</a>
              <a href="subject.html#105590">[ subject ]</a>
              <a href="author.html#105590">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
