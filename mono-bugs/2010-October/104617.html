<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 644699] New: System.Math functions 2x slower than	libc
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20644699%5D%20New%3A%20System.Math%20functions%202x%20slower%20than%0A%09libc&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="104672.html">
   <LINK REL="Next"  HREF="104619.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 644699] New: System.Math functions 2x slower than	libc</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20644699%5D%20New%3A%20System.Math%20functions%202x%20slower%20than%0A%09libc&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 644699] New: System.Math functions 2x slower than	libc">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Oct  7 13:41:13 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="104672.html">[Mono-bugs] [Bug 644673] The -addmodule parameter fails to load types in the loaded module for type resolution
</A></li>
        <LI>Next message: <A HREF="104619.html">[Mono-bugs] [Bug 461947] wrong sourcesdir
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104617">[ date ]</a>
              <a href="thread.html#104617">[ thread ]</a>
              <a href="subject.html#104617">[ subject ]</a>
              <a href="author.html#104617">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=644699">https://bugzilla.novell.com/show_bug.cgi?id=644699</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=644699#c0">https://bugzilla.novell.com/show_bug.cgi?id=644699#c0</A>


           Summary: System.Math functions 2x slower than libc
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.8.x
          Platform: i686
        OS/Version: All
            Status: NEW
          Severity: Enhancement
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jonathan.shore at gmail.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=393626)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=393626">http://bugzilla.novell.com/attachment.cgi?id=393626</A>)
C++ and C# code for 2 variants of benchmark

Description of Problem:

Benchmarks such as the &quot;language shootout&quot; nbody problem highlight a severe
peformance problem with regard to fundamental numerical routines (such as
Sqrt).   In tests the mono implementation of Sqrt is 2x slower than libc or JVM
implementations.   libc uses MMX instructions in many cases and I believe that
the mono implementation does not

Other math functions in System.Math should also be inspected for their relative
performance to libc.   Suggest the build option or default to map many of the
System.Math functions to libc calls short of a comparably performant
implementation in Mono directly.


Steps to reproduce the problem:
1. Run nbody benchmark on 64 bit linux box  g++ version vs mono C#
implementation
2. Run for 500 miilion iterators for fair comparison
2. Observe that C++ implementation 2x as fast
3. change calls to Math.Sqrt and sqrt() in C++ implementation to alternate
inlined implementation
4. Observe that the performance of the 2 programs is 1:1 with an alternate
impl.

Actual Results:

191 seconds for mono run
92 seconds c++ run

Expected Results:

~100 seconds for each



How often does this happen? 


Additional Information:

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="104672.html">[Mono-bugs] [Bug 644673] The -addmodule parameter fails to load types in the loaded module for type resolution
</A></li>
	<LI>Next message: <A HREF="104619.html">[Mono-bugs] [Bug 461947] wrong sourcesdir
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104617">[ date ]</a>
              <a href="thread.html#104617">[ thread ]</a>
              <a href="subject.html#104617">[ subject ]</a>
              <a href="author.html#104617">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
