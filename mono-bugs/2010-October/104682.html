<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 645193] New: BinaryWriter on Console standard output no longer works correctly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20645193%5D%20New%3A%20BinaryWriter%20on%20Console%20standard%0A%20output%20no%20longer%20works%20correctly&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="104697.html">
   <LINK REL="Next"  HREF="105611.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 645193] New: BinaryWriter on Console standard output no longer works correctly</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20645193%5D%20New%3A%20BinaryWriter%20on%20Console%20standard%0A%20output%20no%20longer%20works%20correctly&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 645193] New: BinaryWriter on Console standard output no longer works correctly">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sat Oct  9 05:46:28 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="104697.html">[Mono-bugs] [Bug 645189] Assembly.LoadWithPartialName completely	non-functional
</A></li>
        <LI>Next message: <A HREF="105611.html">[Mono-bugs] [Bug 645193] BinaryWriter on Console standard output no longer works correctly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104682">[ date ]</a>
              <a href="thread.html#104682">[ thread ]</a>
              <a href="subject.html#104682">[ subject ]</a>
              <a href="author.html#104682">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=645193">https://bugzilla.novell.com/show_bug.cgi?id=645193</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=645193#c0">https://bugzilla.novell.com/show_bug.cgi?id=645193#c0</A>


           Summary: BinaryWriter on Console standard output no longer
                    works correctly
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.8.x
          Platform: x86
        OS/Version: Windows 7
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: CORLIB
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">joe at mistachkin.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.10)
Gecko/20100914 Firefox/3.6.10

There seems to be an issue with using BinaryWriter and the Console together;
however, it may just be a problem with BinaryWriter.  Output appears to be
&quot;lost&quot; unless Flush is used.  This worked perfectly with Mono 2.6.7 and it
works with the .NET Framework.  Small writes seem to be the most troublesome.


Reproducible: Always

Steps to Reproduce:
1. Compile and run the following program.
2. Type some short strings into the program and they should be displayed
verbatim back to you.
3. Observe that newline characters and possibly other output is missing.

using System;
using System.IO;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            Stream stream = Console.OpenStandardOutput();
            BinaryWriter writer = new BinaryWriter(stream, Encoding.ASCII);

            int count = 100;

            while (count-- &gt; 0)
            {
                //
                // NOTE: For maximum fun, try typing short strings like
                //       &quot;hi&quot; or &quot;foo&quot;.
                //
                string line = Console.ReadLine();

                //
                // NOTE: Yes, this is a slightly odd way of doing this.
                //       However, it worked in Mono 2.6.7 and it works
                //       in the .NET Framework.
                //
                writer.Write(Encoding.ASCII.GetBytes(line));
                writer.Write(Encoding.ASCII.GetBytes(Environment.NewLine));

                //
                // NOTE: This &quot;fixes&quot; the issue; however, it should not
                //       be required.
                //
                // writer.Flush();
            }
        }
    }
}

Actual Results:  
1. Missing newline characters.
2. Output does not display correctly on the screen (this is probably due to
some internal buffer not being flushed).


Expected Results:  
Each line entered should be displayed verbatim, including the newline
character.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>

























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="104697.html">[Mono-bugs] [Bug 645189] Assembly.LoadWithPartialName completely	non-functional
</A></li>
	<LI>Next message: <A HREF="105611.html">[Mono-bugs] [Bug 645193] BinaryWriter on Console standard output no longer works correctly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104682">[ date ]</a>
              <a href="thread.html#104682">[ thread ]</a>
              <a href="subject.html#104682">[ subject ]</a>
              <a href="author.html#104682">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
