<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 559575] New: System.Text.UF7Encoding throws on invalid UTF7, unlike .Net 2.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20559575%5D%20New%3A%20System.Text.UF7Encoding%20throws%20on%0A%20invalid%20UTF7%2C%20unlike%20.Net%202.0&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="095368.html">
   <LINK REL="Next"  HREF="095370.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 559575] New: System.Text.UF7Encoding throws on invalid UTF7, unlike .Net 2.0</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20559575%5D%20New%3A%20System.Text.UF7Encoding%20throws%20on%0A%20invalid%20UTF7%2C%20unlike%20.Net%202.0&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 559575] New: System.Text.UF7Encoding throws on invalid UTF7, unlike .Net 2.0">bugzilla_noreply at novell.com
       </A><BR>
    <I>Tue Dec  1 10:56:26 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="095368.html">[Mono-bugs] [Bug 464929] Sorting strings is 10x slower than MS.NET
</A></li>
        <LI>Next message: <A HREF="095370.html">[Mono-bugs] [Bug 559575] System.Text.UTF7Encoding throws on invalid UTF7, unlike .Net 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95369">[ date ]</a>
              <a href="thread.html#95369">[ thread ]</a>
              <a href="subject.html#95369">[ subject ]</a>
              <a href="author.html#95369">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=559575">http://bugzilla.novell.com/show_bug.cgi?id=559575</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=559575#c0">http://bugzilla.novell.com/show_bug.cgi?id=559575#c0</A>


           Summary: System.Text.UF7Encoding throws on invalid UTF7, unlike
                    .Net 2.0
    Classification: Mono
           Product: Mono: Class Libraries
           Version: 2.4.x
          Platform: All
        OS/Version: All
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: System
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">brett at fogcreek.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


Created an attachment (id=330289)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=330289">http://bugzilla.novell.com/attachment.cgi?id=330289</A>)
A tiny test app that illustrates the crash

User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.9.1.5)
Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)

This might be the intended behavior, but since we are using Mono 2.0 to run an
app originally targeted at .Net 2.0, we are seeing throws in some inconvenient
places where .Net just writes a '?'. So the right thing to do here depends on
what Mono wants to be.



Reproducible: Always

Steps to Reproduce:
Run the attached test app against Mono 2.4.2.3.

Expected:
?
(Same as .Net 2.0)

Observed:

Actual Results:  
Unhandled Exception: System.ArgumentException: Arg_InvalidUTF7
Parameter name: chars
  at System.Text.UTF7Encoding.InternalGetChars (System.Byte[] bytes, Int32
byteIndex, Int32 byteCount, System.Char[] chars, Int32 charIndex, System.Int32&amp;
leftOver) [0x00000]
  at System.Text.UTF7Encoding+UTF7Decoder.GetChars (System.Byte[] bytes, Int32
byteIndex, Int32 byteCount, System.Char[] chars, Int32 charIndex) [0x00000]
  at System.IO.StreamReader.ReadBuffer () [0x00000]
  at System.IO.StreamReader.ReadLine () [0x00000]
  at StreamReaderTest.InvalidUTF7.Main (System.String[] args) [0x00000]


Expected Results:  
?
(Same as .Net 2.0)

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="095368.html">[Mono-bugs] [Bug 464929] Sorting strings is 10x slower than MS.NET
</A></li>
	<LI>Next message: <A HREF="095370.html">[Mono-bugs] [Bug 559575] System.Text.UTF7Encoding throws on invalid UTF7, unlike .Net 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95369">[ date ]</a>
              <a href="thread.html#95369">[ thread ]</a>
              <a href="subject.html#95369">[ subject ]</a>
              <a href="author.html#95369">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
