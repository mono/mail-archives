<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 560946] New: Moving an XmlAttribute from one XmlElement to another throws System.ArgumentException: This attribute is already set to another element.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20560946%5D%20New%3A%20Moving%20an%20XmlAttribute%20from%20one%0A%20XmlElement%20to%20another%20throws%20System.ArgumentException%3A%20This%20attribute%20is%0A%20already%20set%20to%20another%20element.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="095522.html">
   <LINK REL="Next"  HREF="095524.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 560946] New: Moving an XmlAttribute from one XmlElement to another throws System.ArgumentException: This attribute is already set to another element.</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20560946%5D%20New%3A%20Moving%20an%20XmlAttribute%20from%20one%0A%20XmlElement%20to%20another%20throws%20System.ArgumentException%3A%20This%20attribute%20is%0A%20already%20set%20to%20another%20element.&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 560946] New: Moving an XmlAttribute from one XmlElement to another throws System.ArgumentException: This attribute is already set to another element.">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Dec  4 14:21:26 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="095522.html">[Mono-bugs] [Bug 434754] NotifyIcon not working on MacOSX
</A></li>
        <LI>Next message: <A HREF="095524.html">[Mono-bugs] [Bug 560946] Moving an XmlAttribute from one XmlElement to another throws System.ArgumentException: This attribute is already set to another element.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95523">[ date ]</a>
              <a href="thread.html#95523">[ thread ]</a>
              <a href="subject.html#95523">[ subject ]</a>
              <a href="author.html#95523">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=560946">http://bugzilla.novell.com/show_bug.cgi?id=560946</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=560946#c0">http://bugzilla.novell.com/show_bug.cgi?id=560946#c0</A>


           Summary: Moving an XmlAttribute from one XmlElement to another
                    throws System.ArgumentException: This attribute is
                    already set to another element.
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.4.x
          Platform: x86
        OS/Version: FreeBSD
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: JIT
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">yvan at mabel.ca</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Community User
           Blocker: No


Description of Problem:
In the .NET runtime an XmlAttribute can be moved from one XmlElement to another
in the same XmlDocument by Appending it to the new XmlElement. It is
automatically removed from the source, since a node can only have on instance
in the document tree. In the Mono runtime this throws
&quot;System.ArgumentException: This attribute is already set to another element.&quot;.

Steps to reproduce the problem:

Instantiate this class:
============================= snip =============================
using System.Xml;

/// &lt;summary&gt;
/// Demonstrates attribute bug in Mono.
/// &lt;/summary&gt;
/// &lt;remarks&gt;
/// This does not cause an error in the .NET runtime. 
/// The attribute is moved from one element to another.
/// To reproduce the bug in Mono, instatiate this class.
/// &lt;/remarks&gt;
public class AttributeBug
{
    public AttributeBug()
    {
        // make a document
        var xml = new XmlDocument();
        // add a root element
        var band = xml.CreateElement(&quot;band&quot;);
        xml.AppendChild(band);

        // give it an attribute
        var genre = xml.CreateAttribute(&quot;genre&quot;);
        xml.DocumentElement.Attributes.Append(genre);

        // make another node
        var musician = xml.CreateElement(&quot;musician&quot;);
        xml.DocumentElement.AppendChild(musician);

        /*
         *   // this doesn't make a difference FWIW
         *   band.Attributes.Remove(genre);   
         */

        // move the attribute
        // This line throws the exception.
        musician.Attributes.Append(genre);
    }
}
============================= snip =============================

Actual Results:
In the Mono runtime the exception is thrown with a stack trace like:

System.ArgumentException: This attribute is already set to another element.
  at System.Xml.XmlAttributeCollection.SetNamedItem (System.Xml.XmlNode node)
[0x00000] 
  at System.Xml.XmlAttributeCollection.Append (System.Xml.XmlAttribute node)
[0x00000] 
  at AttributeBug..ctor (System.Xml.XmlNode node) [0x00000] 

Expected Results:

The XmlAttribute node should move to the target element.

How often does this happen? 

Consistently.

Additional Information:
Removing the XmlAttribute from the source XmlElement first does not alter the
outcome.

Workarounds: None.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="095522.html">[Mono-bugs] [Bug 434754] NotifyIcon not working on MacOSX
</A></li>
	<LI>Next message: <A HREF="095524.html">[Mono-bugs] [Bug 560946] Moving an XmlAttribute from one XmlElement to another throws System.ArgumentException: This attribute is already set to another element.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95523">[ date ]</a>
              <a href="thread.html#95523">[ thread ]</a>
              <a href="subject.html#95523">[ subject ]</a>
              <a href="author.html#95523">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
