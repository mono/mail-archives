<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 80024][Nor] Changed - [ARM] file inssel.c: line	3522 (mono_burg_emit): should not be reached
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2080024%5D%5BNor%5D%20Changed%20-%20%5BARM%5D%20file%20inssel.c%3A%20line%0A%093522%20%28mono_burg_emit%29%3A%20should%20not%20be%20reached&In-Reply-To=bug-80024%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="057087.html">
   <LINK REL="Next"  HREF="057089.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 80024][Nor] Changed - [ARM] file inssel.c: line	3522 (mono_burg_emit): should not be reached</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2080024%5D%5BNor%5D%20Changed%20-%20%5BARM%5D%20file%20inssel.c%3A%20line%0A%093522%20%28mono_burg_emit%29%3A%20should%20not%20be%20reached&In-Reply-To=bug-80024%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 80024][Nor] Changed - [ARM] file inssel.c: line	3522 (mono_burg_emit): should not be reached">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Thu May 10 14:15:33 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="057087.html">[Mono-bugs] [Bug 81296][Min] Changed - System.Diagnostics	configuration sometimes doesn't work
</A></li>
        <LI>Next message: <A HREF="057089.html">[Mono-bugs] [Bug 81296][Min] Changed - System.Diagnostics	configuration sometimes doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57088">[ date ]</a>
              <a href="thread.html#57088">[ thread ]</a>
              <a href="subject.html#57088">[ subject ]</a>
              <a href="author.html#57088">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">alp at atoker.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=80024">http://bugzilla.ximian.com/show_bug.cgi?id=80024</A>

--- shadow/80024	2007-04-22 21:10:21.000000000 -0400
+++ shadow/80024.tmp.31196	2007-05-10 14:15:33.000000000 -0400
@@ -109,6 +109,103 @@
 
 
 ------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">alp at atoker.com</A>  2007-04-22 21:10 -------
 I should mention, this is with SVN head. Have not been able to check
 against older versions or isolate the issue yet, but the same code
 does work on Mono x86 and MS.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">alp at atoker.com</A>  2007-05-10 14:15 -------
+I isolated the issue a little (but don't have a standalone test case yet).
+
+(Here, DType is a byte-backed enum)
+
+object ReadType (Type type) {
+  object val;
+  DType dtype = Signature.TypeToDType (type);
+
+  //SIGABRT happens here, after ReadValue(DType) is called but before
+it is entered
+
+  val = ReadValue (dtype);
+  return val;
+}
+
+
+		public object ReadValue (DType dtype)
+		{
+			//this point is not reached in failure cases
+
+			switch (dtype)
+			{
+				case DType.Byte:
+					return ReadByte ();
+
+				case DType.Boolean:
+					return ReadBoolean ();
+
+				case DType.Int16:
+					return ReadInt16 ();
+
+				case DType.UInt16:
+					return ReadUInt16 ();
+
+				case DType.Int32:
+					return ReadInt32 ();
+
+				case DType.UInt32:
+					return ReadUInt32 ();
+
+				case DType.Int64:
+					return ReadInt64 ();
+
+				case DType.UInt64:
+					return ReadUInt64 ();
+
+#if !DISABLE_SINGLE
+				case DType.Single:
+					return ReadSingle ();
+#endif
+
+				case DType.Double:
+					return ReadDouble ();
+
+				case DType.String:
+					return ReadString ();
+
+				case DType.ObjectPath:
+					return ReadObjectPath ();
+
+				case DType.Signature:
+					return ReadSignature ();
+
+				case DType.Variant:
+					return ReadVariant ();
+
+				default:
+					return null;
+				//	throw new Exception (&quot;Unhandled D-Bus type: &quot; + dtype);
+			}
+		}
+
+
+
+This workaround (replacing the above two methods) works:
+
+object ReadType (Type type) {
+  object val;
+  DType dtype = Signature.TypeToDType (type);
+
+  //SIGABRT happens here, after ReadValue(DType) is called but before
+it is entered
+
+				if (dtype == DType.Byte)
+					val = ReadByte ();
+				else if (dtype == DType.UInt32)
+					val = ReadUInt32 ();
+				else if (dtype == DType.Boolean)
+					val = ReadBoolean ();
+				else
+					throw new Exception (&quot;This case is not important&quot;);
+
+  return val;
+}
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="057087.html">[Mono-bugs] [Bug 81296][Min] Changed - System.Diagnostics	configuration sometimes doesn't work
</A></li>
	<LI>Next message: <A HREF="057089.html">[Mono-bugs] [Bug 81296][Min] Changed - System.Diagnostics	configuration sometimes doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57088">[ date ]</a>
              <a href="thread.html#57088">[ thread ]</a>
              <a href="subject.html#57088">[ subject ]</a>
              <a href="author.html#57088">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
