<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 81693][Nor] New - mono 1.2.4 - creating GZipStream	fails
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2081693%5D%5BNor%5D%20New%20-%20mono%201.2.4%20-%20creating%20GZipStream%0A%09fails&In-Reply-To=bug-81693%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="057421.html">
   <LINK REL="Next"  HREF="057423.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 81693][Nor] New - mono 1.2.4 - creating GZipStream	fails</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2081693%5D%5BNor%5D%20New%20-%20mono%201.2.4%20-%20creating%20GZipStream%0A%09fails&In-Reply-To=bug-81693%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 81693][Nor] New - mono 1.2.4 - creating GZipStream	fails">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Sun May 20 19:32:58 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="057421.html">[Mono-bugs] [Bug 81690][Maj] Changed - Value of Cache.Count	variable not equal to Keys amount available via	Cache.GetEnumerator()
</A></li>
        <LI>Next message: <A HREF="057423.html">[Mono-bugs] [Bug 78158][Nor] Changed - [GMCS] MemberRef duplicate	when encoding MethodSpec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57422">[ date ]</a>
              <a href="thread.html#57422">[ thread ]</a>
              <a href="subject.html#57422">[ subject ]</a>
              <a href="author.html#57422">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">spam at mrwax.de.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=81693">http://bugzilla.ximian.com/show_bug.cgi?id=81693</A>

--- shadow/81693	2007-05-20 19:32:58.000000000 -0400
+++ shadow/81693.tmp.26920	2007-05-20 19:32:58.000000000 -0400
@@ -0,0 +1,230 @@
+Bug#: 81693
+Product: Mono: Class Libraries
+Version: unspecified
+OS: GNU/Linux [Other]
+OS Details: Ubuntu 7.04
+Status: NEW   
+Resolution: 
+Severity: 024 Three days
+Priority: Normal
+Component: Mono.POSIX
+AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">miguel at ximian.com</A>                            
+ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">spam at mrwax.de</A>               
+QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
+TargetMilestone: ---
+URL: 
+Cc: 
+Summary: mono 1.2.4 - creating GZipStream fails
+
+Today I tried to use gzip-functionality provided from 
+System.IO.Compression like in this (very simple) test-case:
+
+
+class MainClass
+{
+		public static void Main(string[] args)
+		{
+			byte[] input = {1,2,3,4,5};
+			MemoryStream output = new MemoryStream();
+			GZipStream gz = new 
+GZipStream(output,CompressionMode.Compress,true);
+			gz.Write(input,0,input.Length);
+			gz.Close();
+			
+		}
+	}
+}
+
+
+
+
+
+
+Trying to execute giving me this:
+
+*** glibc detected *** mono: free(): invalid pointer: 0x00007fff ***
+======= Backtrace: =========
+/lib/tls/i686/cmov/libc.so.6[0xb7de07cd]
+/lib/tls/i686/cmov/libc.so.6(cfree+0x90)[0xb7de3e30]
+/usr/lib/libz.so.1(zcfree+0x1d)[0xb71e3e5d]
+/usr/lib/libz.so.1(inflateEnd+0x41)[0xb71e4121]
+/usr/lib/libMonoPosixHelper.so(free_z_stream+0x48)[0xb7200f58]
+[0xb7470e7b]
+[0xb7470deb]
+[0xb7470d45]
+[0xb7470c2e]
+[0xb7470d0c]
+[0xb7470cc1]
+[0xb7470c66]
+[0xb7470c2e]
+[0xb746e636]
+[0xb746e075]
+mono(mono_runtime_exec_main+0x62)[0x80c45f2]
+mono(mono_runtime_run_main+0x1b9)[0x80c48d9]
+mono(mono_main+0xe9e)[0x805a90e]
+mono[0x8059562]
+/lib/tls/i686/cmov/libc.so.6(__libc_start_main+0xdc)[0xb7d8eebc]
+mono[0x80594b1]
+======= Memory map: ========
+00001000-00051000 rwxp 00001000 00:00 0
+08048000-081fb000 r-xp 00000000 08:04 99682      /usr/bin/mono
+081fb000-081fd000 rwxp 001b2000 08:04 99682      /usr/bin/mono
+081fd000-082fb000 rwxp 081fd000 00:00 0          [heap]
+b7000000-b7021000 rwxp b7000000 00:00 0
+b7021000-b7100000 ---p b7021000 00:00 0
+b71da000-b71ed000 r-xp 00000000 08:04 245204     /usr/lib/libz.so.1.2.3
+b71ed000-b71ee000 rwxp 00012000 08:04 245204     /usr/lib/libz.so.1.2.3
+b71ee000-b7202000 r-xp 00000000 08:04 
+212616     /usr/lib/libMonoPosixHelper.so
+b7202000-b7203000 rwxp 00013000 08:04 
+212616     /usr/lib/libMonoPosixHelper.so
+b7215000-b736b000 r-xp 00000000 08:04 
+669122     /usr/lib/mono/gac/System/2.0.0.0__b77a5c561934e089/System.dll
+b736b000-b736c000 ---p b736b000 00:00 0
+b736c000-b747c000 rwxp b736c000 00:00 0
+b747c000-b7801000 rwxs 00000000 08:04 
+511018     /home/alex/.wapi/shared_fileshare-amilo-Linux-i686-36-11-0
+b7801000-b793a000 rwxs 00000000 08:04 
+511016     /home/alex/.wapi/shared_data-amilo-Linux-i686-312-11-0
+b793a000-b79a7000 rwxp b793a000 00:00 0
+b79a7000-b79b0000 r-xp 00000000 08:04 
+1975894    /lib/tls/i686/cmov/libnss_files-2.5.so
+b79b0000-b79b2000 rwxp 00008000 08:04 
+1975894    /lib/tls/i686/cmov/libnss_files-2.5.so
+b79b2000-b79ba000 r-xp 00000000 08:04 
+1975898    /lib/tls/i686/cmov/libnss_nis-2.5.so
+b79ba000-b79bc000 rwxp 00007000 08:04 
+1975898    /lib/tls/i686/cmov/libnss_nis-2.5.so
+b79bc000-b79cf000 r-xp 00000000 08:04 
+1975888    /lib/tls/i686/cmov/libnsl-2.5.so
+b79cf000-b79d1000 rwxp 00012000 08:04 
+1975888    /lib/tls/i686/cmov/libnsl-2.5.so
+b79d1000-b79d3000 rwxp b79d1000 00:00 0
+b79d3000-b79da000 r-xp 00000000 08:04 
+1975890    /lib/tls/i686/cmov/libnss_compat-2.5.so
+b79da000-b79dc000 rwxp 00006000 08:04 
+1975890    /lib/tls/i686/cmov/libnss_compat-2.5.so
+b79de000-b79e9000 r-xp 00000000 08:04 1942142    /lib/libgcc_s.so.1
+b79e9000-b79ea000 rwxp 0000a000 08:04 1942142    /lib/libgcc_s.so.1
+b79ea000-b79eb000 ---p b79ea000 00:00 0
+b79eb000-b79ee000 rwxp b79eb000 00:00 0
+b79ee000-b7c44000 r-xp 00000000 08:04 
+653272     /usr/lib/mono/2.0/mscorlib.dll
+b7c44000-b7c45000 r-xp 00000000 08:04 
+767429     /home/alex/Projects/gzipTest/gzipTest/bin/Debug/gzipTest.exe
+b7c45000-b7c65000 rwxp b7c45000 00:00 0
+b7c65000-b7ca0000 r-xp 00000000 08:04 
+131205     /usr/lib/locale/de_DE.utf8/LC_CTYPE
+b7ca0000-b7d77000 r-xp 00000000 08:04 
+131373     /usr/lib/locale/de_DE.utf8/LC_COLLATE
+b7d77000-b7d79000 rwxp b7d77000 00:00 0
+b7d79000-b7eb4000 r-xp 00000000 08:04 
+1975877    /lib/tls/i686/cmov/libc-2.5.so
+b7eb4000-b7eb5000 r-xp 0013b000 08:04 
+1975877    /lib/tls/i686/cmov/libc-2.5.so
+b7eb5000-b7eb7000 rwxp 0013c000 08:04 
+1975877    /lib/tls/i686/cmov/libc-2.5.so
+b7eb7000-b7eba000 rwxp b7eb7000 00:00 0
+b7eba000-b7edf000 r-xp 00000000 08:04 
+1975885    /lib/tls/i686/cmov/libm-2.5.so
+b7edf000-b7ee1000 rwxp 00024000 08:04 
+1975885    /lib/tls/i686/cmov/libm-2.5.so
+b7ee1000-b7ef4000 r-xp 00000000 08:04 
+1975903    /lib/tls/i686/cmov/libpthread-2.5.so
+b7ef4000-b7ef6000 rwxp 00013000 08:04 
+1975903    /lib/tls/i686/cmov/libpthread-2.5.so
+b7ef6000-b7ef8000 rwxp b7ef6000 00:00 0
+b7ef8000-b7efa000 r-xp 00000000 08:04 
+1975883    /lib/tls/i686/cmov/libdl-2.5.so
+b7efa000-b7efc000 rwxp 00001000 08:04 
+1975883    /lib/tls/i686/cmov/libdl-2.5.so
+b7efc000-b7f90000 r-xp 00000000 08:04 
+212293     /usr/lib/libglib-2.0.so.0.1200.11
+b7f90000-b7f91000 rwxp 00093000 08:04 
+212293     /usr/lib/libglib-2.0.so.0.1200.11
+b7f91000-b7f92000 rwxp b7f91000 00:00 0
+b7f92000-b7f99000 r-xp 00000000 08:04 
+1975907    /lib/tls/i686/cmov/librt-2.5.so
+b7f99000-b7f9b000 rwxp 00006000 08:04 
+1975907    /lib/tls/i686/cmov/librt-2.5.so
+b7f9b000-b7f9f000 r-xp 00000000 08:04 
+212365     /usr/lib/libgthread-2.0.so.0.1200.11
+b7f9f000-b7fa0000 rwxp 00003000 08:04 
+212365     /usr/lib/libgthread-2.0.so.0.1200.11
+b7fa1000-b7fa2000 r-xp 00000000 08:04 
+131210     /usr/lib/locale/de_DE.utf8/LC_NUMERIC
+b7fa2000-b7fa3000 r-xp 00000000 08:04 
+131197     /usr/lib/locale/de_DE.utf8/LC_TIME
+b7fa3000-b7fa4000 r-xp 00000000 08:04 
+131191     /usr/lib/locale/de_DE.utf8/LC_MONETARY
+b7fa4000-b7fa5000 r-xp 00000000 08:04 
+131214     /usr/lib/locale/de_DE.utf8/LC_MESSAGES/SYS_LC_MESSAGES
+b7fa5000-b7fa6000 r-xp 00000000 08:04 
+131380     /usr/lib/locale/de_DE.utf8/LC_PAPER
+b7fa6000-b7fa7000 r-xp 00000000 08:04 
+131195     /usr/lib/locale/de_DE.utf8/LC_NAME
+b7fa7000-b7fa8000 r-xp 00000000 08:04 
+131190     /usr/lib/locale/de_DE.utf8/LC_ADDRESS
+b7fa8000-b7fa9000 r-xp 00000000 08:04 
+131196     /usr/lib/locale/de_DE.utf8/LC_TELEPHONE
+b7fa9000-b7faa000 r-xp 00000000 08:04 
+131376     /usr/lib/locale/de_DE.utf8/LC_MEASUREMENT
+b7faa000-b7fb1000 r-xs 00000000 08:04 
+115260     /usr/lib/gconv/gconv-modules.cache
+b7fb1000-b7fb2000 r-xp 00000000 08:04 
+131193     /usr/lib/locale/de_DE.utf8/LC_IDENTIFICATION
+b7fb2000-b7fb4000 rwxp b7fb2000 00:00 0
+b7fb4000-b7fcd000 r-xp 00000000 08:04 1942101    /lib/ld-2.5.so
+b7fcd000-b7fcf000 rwxp 00019000 08:04 1942101    /lib/ld-2.5.so
+bff04000-bff1a000 rwxp bff04000 00:00 0          [stack]
+ffffe000-fffff000 r-xp 00000000 00:00 0          [vdso]
+Stacktrace:
+
+  at (wrapper managed-to-native) 
+System.IO.Compression.DeflateStream.free_z_stream (intptr) &lt;0x00004&gt;
+  at (wrapper managed-to-native) 
+System.IO.Compression.DeflateStream.free_z_stream (intptr) &lt;0xffffffff&gt;
+  at System.IO.Compression.DeflateStream.DisposeCore () &lt;0x0006a&gt;
+  at System.IO.Compression.DeflateStream.Dispose (bool) &lt;0x00034&gt;
+  at System.IO.Stream.Close () &lt;0x0000d&gt;
+  at System.IO.Stream.Dispose () &lt;0x0000b&gt;
+  at (wrapper remoting-invoke-with-check) System.IO.Stream.Dispose () 
+&lt;0xffffffff&gt;
+  at System.IO.Compression.GZipStream.Dispose (bool) &lt;0x0002d&gt;
+  at System.IO.Stream.Close () &lt;0x0000d&gt;
+  at gzipTest.MainClass.Main (string[]) &lt;0x0009d&gt;
+  at (wrapper runtime-invoke) System.Object.runtime_invoke_void_string[] 
+(object,intptr,intptr,intptr) &lt;0xffffffff&gt;
+
+Native stacktrace:
+
+        mono [0x81538ce]
+        [0xffffe440]
+        /lib/tls/i686/cmov/libc.so.6(abort+0x101) [0xb7da4641]
+        /lib/tls/i686/cmov/libc.so.6 [0xb7dd89bb]
+        /lib/tls/i686/cmov/libc.so.6 [0xb7de07cd]
+        /lib/tls/i686/cmov/libc.so.6(cfree+0x90) [0xb7de3e30]
+        /usr/lib/libz.so.1(zcfree+0x1d) [0xb71e3e5d]
+        /usr/lib/libz.so.1(inflateEnd+0x41) [0xb71e4121]
+        /usr/lib/libMonoPosixHelper.so(free_z_stream+0x48) [0xb7200f58]
+        [0xb7470e7b]
+        [0xb7470deb]
+        [0xb7470d45]
+        [0xb7470c2e]
+        [0xb7470d0c]
+        [0xb7470cc1]
+        [0xb7470c66]
+        [0xb7470c2e]
+        [0xb746e636]
+        [0xb746e075]
+        mono(mono_runtime_exec_main+0x62) [0x80c45f2]
+        mono(mono_runtime_run_main+0x1b9) [0x80c48d9]
+        mono(mono_main+0xe9e) [0x805a90e]
+        mono [0x8059562]
+        /lib/tls/i686/cmov/libc.so.6(__libc_start_main+0xdc) [0xb7d8eebc]
+        mono [0x80594b1]
+
+I think the error appears when I try to instantiate the GZipStream 
+object. Actually I'm using a self-compiled mono 1.2.4 on ubuntu 7.04 
+(using glib 2.12.11) - but I also tried it at openSUSE with rpms provided 
+by the mono-project - same results
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="057421.html">[Mono-bugs] [Bug 81690][Maj] Changed - Value of Cache.Count	variable not equal to Keys amount available via	Cache.GetEnumerator()
</A></li>
	<LI>Next message: <A HREF="057423.html">[Mono-bugs] [Bug 78158][Nor] Changed - [GMCS] MemberRef duplicate	when encoding MethodSpec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57422">[ date ]</a>
              <a href="thread.html#57422">[ thread ]</a>
              <a href="subject.html#57422">[ subject ]</a>
              <a href="author.html#57422">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
