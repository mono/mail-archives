<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 507712] New: Error VBNC99999: Type 'System.Text.CP1252' was been referenced while compiling, but it wasn't found...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20507712%5D%20New%3A%20Error%20VBNC99999%3A%20Type%0A%20%27System.Text.CP1252%27%20was%20been%20referenced%20while%20compiling%2C%0A%20but%20it%20wasn%27t%20found...&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="089254.html">
   <LINK REL="Next"  HREF="089242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 507712] New: Error VBNC99999: Type 'System.Text.CP1252' was been referenced while compiling, but it wasn't found...</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20507712%5D%20New%3A%20Error%20VBNC99999%3A%20Type%0A%20%27System.Text.CP1252%27%20was%20been%20referenced%20while%20compiling%2C%0A%20but%20it%20wasn%27t%20found...&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 507712] New: Error VBNC99999: Type 'System.Text.CP1252' was been referenced while compiling, but it wasn't found...">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu May 28 04:27:15 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="089254.html">[Mono-bugs] [Bug 507666] url-decode failed with encoded shift_jis	query
</A></li>
        <LI>Next message: <A HREF="089242.html">[Mono-bugs] [Bug 507712] Error VBNC99999: Type 'System.Text.CP1252' was been referenced while compiling, but it wasn't found...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89241">[ date ]</a>
              <a href="thread.html#89241">[ thread ]</a>
              <a href="subject.html#89241">[ subject ]</a>
              <a href="author.html#89241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=507712">http://bugzilla.novell.com/show_bug.cgi?id=507712</A>


           Summary: Error VBNC99999: Type 'System.Text.CP1252' was been
                    referenced while compiling, but it wasn't found...
    Classification: Mono
           Product: Mono: Compilers
           Version: 2.0.x
          Platform: i686
        OS/Version: Ubuntu
            Status: NEW
          Severity: Blocker
          Priority: P5 - None
         Component: Basic
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">rkvinge at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gonnetp at inf.ethz.ch</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


Description of Problem:
Small VB program won't compile using MonoDevelop.


Steps to reproduce the problem:
Public Class Application

    ' declare simulation space
    Dim Room ( 100 , 100 ) As Double

    Public Shared Sub Main()

        ' declare array runners
        Dim i As Integer
        Dim j As Integer

        ' init Room with 20 degrees
        For i = 1 to 100
            For j = 1 to 100
                Room(i,j) = 20
            Next
        Next

        System.Console.WriteLine(&quot;Hello world!&quot;)

    End Sub

End Class


Actual Results:
Building: console test (Debug)
Performing main compilation...
vbnc &quot;-out:/home/gonnetp/work/vb/Projects/test/console test/bin/Debug/console
test.exe&quot; -nologo -utf8output -debug:full -optionstrict- -optionexplicit+
-optioncompare:binary -optioninfer- -target:exe 
&quot;/home/gonnetp/work/vb/Projects/test/console test/Application.vb&quot;
&quot;/home/gonnetp/work/vb/Projects/test/console test/AssemblyInfo.vb&quot;
Warning: Option Strict Off will probably fail.
Warning : VBNC2009: the option optioninfer- was not recognized - ignored

/home/gonnetp/work/vb/Projects/test/console test/&lt;MyGenerator&gt; (1,1) : Error
VBNC99999: Unexpected error: There has been an internal error in the compiler:
Type 'System.Text.CP1252' was been referenced while compiling, but it wasn't
found...

  at vbnc.TypeResolution.TypeResolver (System.Object sender,
System.ResolveEventArgs args) [0x00000] 
  at System.AppDomain.DoTypeResolve (System.Object name_or_tb) [0x00000] 
  at (wrapper managed-to-native) System.Type:internal_from_name
(string,bool,bool)
  at System.Type.GetType (System.String typeName) [0x00000] 
  at System.Text.Encoding.GetEncoding (Int32 codepage) [0x00000] 
  at Microsoft.VisualBasic.Strings.Asc (Char c) [0x00000] 
  at vbnc.TypeConverter.GetResultType (TypeCode op1, TypeCode op2,
System.String array) [0x00000] 
  at vbnc.TypeConverter.GetBinaryAddResultType (TypeCode op1, TypeCode op2)
[0x00000] 
  at vbnc.TypeConverter.GetBinaryOperandType (KS op, TypeCode op1, TypeCode
op2) [0x00000] 
  at vbnc.TypeConverter.GetBinaryOperandType (vbnc.Compiler Compiler, KS op,
System.Type op1, System.Type op2) [0x00000] 
  at vbnc.BinaryExpression.get_OperandTypeCode () [0x00000] 
  at vbnc.BinaryExpression.ResolveExpressionInternal (vbnc.ResolveInfo Info)
[0x00000] 
  at vbnc.BinaryAddExpression.ResolveExpressionInternal (vbnc.ResolveInfo Info)
[0x00000] 
  at vbnc.Expression.ResolveExpression (vbnc.ResolveInfo ResolveInfo) [0x00000] 
  at vbnc.ArrayCreationExpression.EmitArrayCreation (vbnc.ParsedObject Parent,
vbnc.EmitInfo Info, System.Type ArrayType, vbnc.ArraySizeInitializationModifier
asim) [0x00000] 
  at vbnc.VariableDeclaration.EmitVariableInitializer (vbnc.EmitInfo Info)
[0x00000] 
  at vbnc.ConstructorDeclaration.EmitVariableInitialization (vbnc.EmitInfo
Info) [0x00000] 
  at vbnc.ConstructorDeclaration.GenerateCode (vbnc.EmitInfo Info) [0x00000] 
  at vbnc.Helper.GenerateCodeCollection (IEnumerable Collection, vbnc.EmitInfo
Info) [0x00000] 
  at vbnc.BaseObjects`1[vbnc.IMember].GenerateCode (vbnc.EmitInfo Info)
[0x00000] 
  at vbnc.AssemblyDeclaration.Emit (vbnc.TypeDeclaration Type) [0x00000] 
  at vbnc.AssemblyDeclaration.Emit () [0x00000] 
  at vbnc.Compiler.Compile () [0x00000] 

Compilation took 00:00:01.0440690

Build complete -- 1 error, 0 warnings

---------------------- Done ----------------------

Build: 1 error, 0 warnings


Expected Results:
If I comment-out the declaration of &quot;Room&quot; and its use, it compiles ok.


How often does this happen? 
Always.


Additional Information:

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="089254.html">[Mono-bugs] [Bug 507666] url-decode failed with encoded shift_jis	query
</A></li>
	<LI>Next message: <A HREF="089242.html">[Mono-bugs] [Bug 507712] Error VBNC99999: Type 'System.Text.CP1252' was been referenced while compiling, but it wasn't found...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89241">[ date ]</a>
              <a href="thread.html#89241">[ thread ]</a>
              <a href="subject.html#89241">[ subject ]</a>
              <a href="author.html#89241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
