<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 504791] New: NRE in FileSystem.FileOpen due to	compiler problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20504791%5D%20New%3A%20NRE%20in%20FileSystem.FileOpen%20due%20to%0A%09compiler%20problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088956.html">
   <LINK REL="Next"  HREF="088958.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 504791] New: NRE in FileSystem.FileOpen due to	compiler problem</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20504791%5D%20New%3A%20NRE%20in%20FileSystem.FileOpen%20due%20to%0A%09compiler%20problem&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 504791] New: NRE in FileSystem.FileOpen due to	compiler problem">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon May 18 11:09:23 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="088956.html">[Mono-bugs] [Bug 495562] Calling Show() on a maximized form changes Window state to Normal .NET difference
</A></li>
        <LI>Next message: <A HREF="088958.html">[Mono-bugs] [Bug 504791] NRE in FileSystem.FileOpen due to compiler	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88957">[ date ]</a>
              <a href="thread.html#88957">[ thread ]</a>
              <a href="subject.html#88957">[ subject ]</a>
              <a href="author.html#88957">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=504791">http://bugzilla.novell.com/show_bug.cgi?id=504791</A>


           Summary: NRE in FileSystem.FileOpen due to compiler problem
    Classification: Mono
           Product: Mono: Compilers
           Version: 2.4.x
          Platform: Other
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: Basic
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">rkvinge at novell.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">andyhume32 at yahoo.co.uk</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR
2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648;
NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)

Calling FileSystem.FileOpen on the Mono Runtime fails with a fault in the Mono
VBRuntime.
[[
Class UseVbrtFileSystemFileOpen
  Shared Sub Main
    FileSystem.FileOpen(1, &quot;foo.txt&quot;, OpenMode.Append)
  End Sub
End Class
]]

Fails with:
[[
Unhandled Exception: System.NullReferenceException: Object reference not set to
an instance of an object
  at Microsoft.VisualBasic.FileSystem.FileOpen (Int32 FileNumber, System.String
FileName, OpenMode Mode, OpenAccess Access, OpenShare Share, Int32
RecordLength) [0x00000]
  at UseVbrtFileSystemFileOpen.Main () [0x00000]
]]

Inspecting the runtime library code shows that incorrect IL has been generated,
the first If statement in the FileOpen method being badly mangled, with some
clauses having their conditions reversed, and other clauses skipped.


I can't see any workaround.  (One would need to make m_OpenFiles non-null, but
it is only assigned by that method).

Reproducible: Always

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
</PRE>



























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088956.html">[Mono-bugs] [Bug 495562] Calling Show() on a maximized form changes Window state to Normal .NET difference
</A></li>
	<LI>Next message: <A HREF="088958.html">[Mono-bugs] [Bug 504791] NRE in FileSystem.FileOpen due to compiler	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88957">[ date ]</a>
              <a href="thread.html#88957">[ thread ]</a>
              <a href="subject.html#88957">[ subject ]</a>
              <a href="author.html#88957">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
