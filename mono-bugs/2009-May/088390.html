<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 499988] New: Unhandled Exception: System.InvalidCastException: Cannot cast from source type to destination type. at Mono.CSharp.BaseAccess.CommonResolve
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20499988%5D%20New%3A%20Unhandled%20Exception%3A%0A%20System.InvalidCastException%3A%20Cannot%20cast%20from%20source%20type%20to%20destination%0A%20type.%20at%20Mono.CSharp.BaseAccess.CommonResolve&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="088391.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 499988] New: Unhandled Exception: System.InvalidCastException: Cannot cast from source type to destination type. at Mono.CSharp.BaseAccess.CommonResolve</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20499988%5D%20New%3A%20Unhandled%20Exception%3A%0A%20System.InvalidCastException%3A%20Cannot%20cast%20from%20source%20type%20to%20destination%0A%20type.%20at%20Mono.CSharp.BaseAccess.CommonResolve&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 499988] New: Unhandled Exception: System.InvalidCastException: Cannot cast from source type to destination type. at Mono.CSharp.BaseAccess.CommonResolve">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri May  1 00:04:00 EDT 2009</I>
    <P><UL>
        
        <LI>Next message: <A HREF="088391.html">[Mono-bugs] [Bug 499864] Dispose-Method of Mono.Data.SqliteClient.SqliteConnection doesn't close the connection.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88390">[ date ]</a>
              <a href="thread.html#88390">[ thread ]</a>
              <a href="subject.html#88390">[ subject ]</a>
              <a href="author.html#88390">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=499988">http://bugzilla.novell.com/show_bug.cgi?id=499988</A>


           Summary: Unhandled Exception: System.InvalidCastException:
                    Cannot cast from source type to destination type.  at
                    Mono.CSharp.BaseAccess.CommonResolve
    Classification: Mono
           Product: Mono: Compilers
           Version: 1.9
          Platform: x86-64
        OS/Version: Other
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: C#
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">dzonatas at dzonux.net</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.7)
Gecko/2009032813 Iceweasel/3.0.6 (Debian-3.0.6-1)

The included example is not syntactically correct, but instead of a graceful
exception and exit the mono compiler vm crashes. If this is truly unhandled,
then it may cause runtime environments to crash, which could be a security
grief.

The exception is caused when an abstract class has a delegate with the same
name of a method in derived class. There is unreachable code triggered. The
base delegate was attempted to be called in the unreachable state. The
exception is not properly caught and the runtime exits.



Reproducible: Always

Steps to Reproduce:
..
       class test2 : test
           {
           int meth( bool b )
               {
               return 1 ;
               base.meth( true ) ;
               }
           }
       abstract class test
           {
           delegate void meth( bool b ) ;
           } 
..
Actual Results:  
Exception caught by the compiler while compiling:
  Block that caused the problem begin at:
/home/dzonatas/workspace/example.cs(30,29):
                    Block being compiled:
[/home/dzonatas/workspace/example.cs(31,33):,/home/dzonatas/workspace/.example.cs(34,33):]
System.InvalidCastException: Cannot cast from source type to destination type.
Internal compiler error at /home/dzonatas/workspace/example.cs(30,29)::
exception caught while emitting MethodBuilder [test2::meth]

Unhandled Exception: System.InvalidCastException: Cannot cast from source type
to destination type.
 at Mono.CSharp.BaseAccess.CommonResolve (Mono.CSharp.EmitContext ec) [0x00000]
 at Mono.CSharp.BaseAccess.DoResolve (Mono.CSharp.EmitContext ec) [0x00000]
 at Mono.CSharp.Expression.Resolve (Mono.CSharp.EmitContext ec, ResolveFlags
flags) [0x00000]
 at Mono.CSharp.Invocation.DoResolve (Mono.CSharp.EmitContext ec) [0x00000]
 at Mono.CSharp.Expression.Resolve (Mono.CSharp.EmitContext ec, ResolveFlags
flags) [0x00000]
 at Mono.CSharp.Expression.Resolve (Mono.CSharp.EmitContext ec) [0x00000]
 at Mono.CSharp.ExpressionStatement.ResolveStatement (Mono.CSharp.EmitContext
ec) [0x00000]
 at Mono.CSharp.StatementExpression.Resolve (Mono.CSharp.EmitContext ec)
[0x00000]
 at Mono.CSharp.Block.Resolve (Mono.CSharp.EmitContext ec) [0x00000]
 at Mono.CSharp.EmitContext.ResolveTopBlock (Mono.CSharp.EmitContext
anonymous_method_host, Mono.CSharp.ToplevelBlock block, Mono.CSharp.Parameters
ip, IMethodData md, System.Boolean&amp; unreachable) [0x00000] 

Expected Results:  
I expected it to error about the improper abstraction and unreachable code, but
not crash the vm.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="088391.html">[Mono-bugs] [Bug 499864] Dispose-Method of Mono.Data.SqliteClient.SqliteConnection doesn't close the connection.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88390">[ date ]</a>
              <a href="thread.html#88390">[ thread ]</a>
              <a href="subject.html#88390">[ subject ]</a>
              <a href="author.html#88390">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
