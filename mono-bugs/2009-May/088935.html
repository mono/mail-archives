<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 473660] Disabled button images don't look the same as .NET (grayscale / greyed out)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20473660%5D%20Disabled%20button%20images%20don%27t%20look%20the%20same%0A%20as%20.NET%20%28grayscale%20/%20greyed%20out%29&In-Reply-To=bug-473660-28286%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="088934.html">
   <LINK REL="Next"  HREF="088936.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 473660] Disabled button images don't look the same as .NET (grayscale / greyed out)</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20473660%5D%20Disabled%20button%20images%20don%27t%20look%20the%20same%0A%20as%20.NET%20%28grayscale%20/%20greyed%20out%29&In-Reply-To=bug-473660-28286%40http.bugzilla.novell.com/"
       TITLE="[Mono-bugs] [Bug 473660] Disabled button images don't look the same as .NET (grayscale / greyed out)">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sun May 17 09:11:44 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="088934.html">[Mono-bugs] [Bug 490705] System.NullReferenceException when starting to drag a node in a treeview
</A></li>
        <LI>Next message: <A HREF="088936.html">[Mono-bugs] [Bug 421827] [PATCH] CookieContainer.GetCookie skips cookie when domain has no leading dot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88935">[ date ]</a>
              <a href="thread.html#88935">[ thread ]</a>
              <a href="subject.html#88935">[ subject ]</a>
              <a href="author.html#88935">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=473660">http://bugzilla.novell.com/show_bug.cgi?id=473660</A>

User <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">stifu at free.fr</A> added comment
<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=473660#c2">http://bugzilla.novell.com/show_bug.cgi?id=473660#c2</A>





--- Comment #2 from Thomas Goldstein &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">stifu at free.fr</A>&gt;  2009-05-17 07:11:42 MDT ---
Created an attachment (id=292646)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=292646">http://bugzilla.novell.com/attachment.cgi?id=292646</A>)
Patch that makes Mono's behavior closer to .NET's

I had a good look at this, and I now have a patch to propose.
This isn't a pixel perfect match with .NET, but it's very close (if anyone
wants to try to make it match .NET perfectly, I've made a little solution that
checks if each pixel matches, if you'd like. Let me know).

My changes (to
mcs/class/Managed.Windows.Forms/System.Windows.Forms/ToolStripRenderer.cs)
include:

- A different grayscale_matrix, to match .NET more closely (also removing old
commented code which simply produced a darker grayscale image)
- A different Bitmap creation in CreateDisabledImage. We used to create a new
Bitmap from the original Bitmap (Bitmap b = new Bitmap(normalImage)), then draw
on it. Now we create a blank Bitmap (Bitmap b = new Bitmap(normalImage.Width,
normalImage.Height)), then draw on it. This has 2 consequences: this lets us
make the disabled image 30% transparent rather than fully opaque (just like
NET does) when applying the new matrix, and it also improves perfs a tiny bit
(on my computer, through 10000 iterations through CreateDisabledImage, the old
version consistently takes just below 54 seconds, while the new version takes
just over 51 seconds).

This is my first patch (yay!), let me know if I'm doing it right.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>





















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="088934.html">[Mono-bugs] [Bug 490705] System.NullReferenceException when starting to drag a node in a treeview
</A></li>
	<LI>Next message: <A HREF="088936.html">[Mono-bugs] [Bug 421827] [PATCH] CookieContainer.GetCookie skips cookie when domain has no leading dot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88935">[ date ]</a>
              <a href="thread.html#88935">[ thread ]</a>
              <a href="subject.html#88935">[ subject ]</a>
              <a href="author.html#88935">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
