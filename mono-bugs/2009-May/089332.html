<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 508538] New: System.Reflection.TargetInvocationException when calling MethodInfo.invoke
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20508538%5D%20New%3A%0A%20System.Reflection.TargetInvocationException%20when%20calling%20MethodInfo.invoke&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="089331.html">
   <LINK REL="Next"  HREF="089344.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 508538] New: System.Reflection.TargetInvocationException when calling MethodInfo.invoke</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20508538%5D%20New%3A%0A%20System.Reflection.TargetInvocationException%20when%20calling%20MethodInfo.invoke&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 508538] New: System.Reflection.TargetInvocationException when calling MethodInfo.invoke">bugzilla_noreply at novell.com
       </A><BR>
    <I>Sat May 30 12:26:13 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="089331.html">[Mono-bugs] [Bug 508532] [2.0] Assembly.GetType should throw TypeLoadException when type cannot be loaded
</A></li>
        <LI>Next message: <A HREF="089344.html">[Mono-bugs] [Bug 508538] System.Reflection.TargetInvocationException when calling MethodInfo.invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89332">[ date ]</a>
              <a href="thread.html#89332">[ thread ]</a>
              <a href="subject.html#89332">[ subject ]</a>
              <a href="author.html#89332">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=508538">http://bugzilla.novell.com/show_bug.cgi?id=508538</A>


           Summary: System.Reflection.TargetInvocationException when
                    calling MethodInfo.invoke
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.4.x
          Platform: x86
        OS/Version: Mac OS X 10.5
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">rksm at gmx.net</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---


User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_7; en-us)
AppleWebKit/525.28.3 (KHTML, like Gecko) Version/3.2.3 Safari/525.28.3

The bug appears when trying to use the C# application OMeta#
(<A HREF="https://ometasharp.svn.codeplex.com/svn/">https://ometasharp.svn.codeplex.com/svn/</A>).

When trying to translate a grammar using
OMetaSharp.Grammars.ParseGrammarThenOptimizeThenTranslate a call to
System.Reflection.MonoMethod.Invoke throws a
System.Reflection.TargetInvocationException.

Reproducible: Always

Steps to Reproduce:
In a shell do:
tar -xzf ometacrash.tar.gz
/loadCompileRun.sh

This will
- load the OMeta sources from <A HREF="https://ometasharp.svn.codeplex.com/svn/trunk">https://ometasharp.svn.codeplex.com/svn/trunk</A>
- compile the required assemblies OMetaSharp.dll and OMetaSharp.OMetaCS.dll
- compile and run the test application
Actual Results:  
Unhandled Exception: System.Reflection.TargetInvocationException: Exception has
been thrown by the target of an invocation. ---&gt;
System.InvalidProgramException: Invalid IL code in (wrapper runtime-invoke)
OMetaSharp.OMetaParser:runtime_invoke_bool__this___OMetaStream`1&lt;char&gt;_OMetaList`1&lt;HostExpression&gt;&amp;_OMetaStream`1&lt;char&gt;&amp;
(object,intptr,intptr,intptr): IL_0026: call      0x00000004


  at (wrapper managed-to-native) System.Reflection.MonoMethod:InternalInvoke
(object,object[],System.Exception&amp;)
  at System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags
invokeAttr, System.Reflection.Binder binder, System.Object[] parameters,
System.Globalization.CultureInfo culture) [0x00000] 
  --- End of inner exception stack trace ---
  at System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags
invokeAttr, System.Reflection.Binder binder, System.Object[] parameters,
System.Globalization.CultureInfo culture) [0x00000] 
  at System.Reflection.MethodBase.Invoke (System.Object obj, System.Object[]
parameters) [0x00000] 
  at OMetaSharp.OMeta`1+&lt;TryGetMethod&gt;c__AnonStorey6[System.Char].&lt;&gt;m__A
(OMetaSharp.OMetaStream`1 inputStream, OMetaSharp.OMetaList`1&amp; result,
OMetaSharp.OMetaStream`1&amp; modifiedStream) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMeta`1[System.Char].FirstAndRest (OMetaSharp.OMetaStream`1
inputStream, OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp;
modifiedStream) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.ApplyWithArgs
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream,
OMetaSharp.OMetaList`1[] arguments) [0x00000] 
  at OMetaSharp.OMetaParser+&lt;TSName&gt;c__AnonStorey2.&lt;&gt;m__C
(OMetaSharp.OMetaStream`1 inputStream2, OMetaSharp.OMetaList`1&amp; result2,
OMetaSharp.OMetaStream`1&amp; modifiedStream2) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser.TSName (OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser+&lt;NamespacePart&gt;c__AnonStorey1A.&lt;&gt;m__8D
(OMetaSharp.OMetaStream`1 inputStream3, OMetaSharp.OMetaList`1&amp; result3,
OMetaSharp.OMetaStream`1&amp; modifiedStream3) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Many1
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser+&lt;NamespacePart&gt;c__AnonStorey1A.&lt;&gt;m__33
(OMetaSharp.OMetaStream`1 inputStream2, OMetaSharp.OMetaList`1&amp; result2,
OMetaSharp.OMetaStream`1&amp; modifiedStream2) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser.NamespacePart (OMetaSharp.OMetaStream`1
inputStream, OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp;
modifiedStream) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser+&lt;Namespace&gt;c__AnonStorey1B.&lt;&gt;m__90
(OMetaSharp.OMetaStream`1 inputStream4, OMetaSharp.OMetaList`1&amp; result4,
OMetaSharp.OMetaStream`1&amp; modifiedStream4) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Many1
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser+&lt;Namespace&gt;c__AnonStorey1B.&lt;&gt;m__8E
(OMetaSharp.OMetaStream`1 inputStream3, OMetaSharp.OMetaList`1&amp; result3,
OMetaSharp.OMetaStream`1&amp; modifiedStream3) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser+&lt;Namespace&gt;c__AnonStorey1B.&lt;&gt;m__34
(OMetaSharp.OMetaStream`1 inputStream2, OMetaSharp.OMetaList`1&amp; result2,
OMetaSharp.OMetaStream`1&amp; modifiedStream2) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Or
(OMetaSharp.OMetaStream`1 inputStream, OMetaSharp.OMetaList`1&amp; result,
OMetaSharp.OMetaStream`1&amp; modifiedStream, OMetaSharp.Rule`1[] rules) [0x00000] 
  at OMetaSharp.OMetaParser.Namespace (OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser+&lt;Grammar&gt;c__AnonStorey1E.&lt;&gt;m__3B
(OMetaSharp.OMetaStream`1 inputStream2, OMetaSharp.OMetaList`1&amp; result2,
OMetaSharp.OMetaStream`1&amp; modifiedStream2) [0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMetaParser.Grammar (OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at
OMetaSharp.OMetaBase`1[System.Char].OMetaSharp.IMetaRuleEvaluator&lt;TInput&gt;.Apply
(OMetaSharp.Rule`1 rule, OMetaSharp.OMetaStream`1 inputStream,
OMetaSharp.OMetaList`1&amp; result, OMetaSharp.OMetaStream`1&amp; modifiedStream)
[0x00000] 
  at OMetaSharp.OMeta`1[System.Char].GenericMatch (OMetaSharp.OMetaStream`1
inputStream, OMetaSharp.Rule`1 rule, OMetaSharp.OMetaList`1[] arguments,
OMetaSharp.OMetaStream`1&amp; modifiedStream) [0x00000] 
  at OMetaSharp.OMeta`1[System.Char].GenericMatch (OMetaSharp.OMetaStream`1
inputStream, OMetaSharp.Rule`1 rule, OMetaSharp.OMetaList`1[] arguments)
[0x00000] 
  at OMetaSharp.OMeta`1[System.Char].Match (OMetaSharp.OMetaStream`1
inputStream, OMetaSharp.Rule`1 rule) [0x00000] 
  at OMetaSharp.Grammars.ParseWith[OMetaParser,Char] (OMetaSharp.OMetaStream`1
inputStream, System.Func`2 ruleFetcher) [0x00000] 
  at OMetaSharp.Grammars.ParseWith[OMetaParser] (System.String input,
System.Func`2 ruleFetcher) [0x00000] 
  at
OMetaSharp.Grammars.ParseGrammarThenOptimizeThenTranslate[OMetaParser,OMetaOptimizer,OMetaTranslator]
(System.String grammarContents, System.Func`2 topParserRuleFetcher,
System.Func`2 topOptimizerRuleFetcher, System.Func`2 topTranslatorRuleFetcher)
[0x00000] 
  at Test.Main () [0x00000]

Expected Results:  
The following should appear on stdout:
using OMetaSharp;

namespace OMetaSharp
{
    public class Test : Parser
    {
    }
}

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="089331.html">[Mono-bugs] [Bug 508532] [2.0] Assembly.GetType should throw TypeLoadException when type cannot be loaded
</A></li>
	<LI>Next message: <A HREF="089344.html">[Mono-bugs] [Bug 508538] System.Reflection.TargetInvocationException when calling MethodInfo.invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89332">[ date ]</a>
              <a href="thread.html#89332">[ thread ]</a>
              <a href="subject.html#89332">[ subject ]</a>
              <a href="author.html#89332">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
