<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 76485][Maj] Changed - [GMCS] assertion failed in
	monodis
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2076485%5D%5BMaj%5D%20Changed%20-%20%5BGMCS%5D%20assertion%20failed%20in%0A%09monodis&In-Reply-To=bug-76485%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038318.html">
   <LINK REL="Next"  HREF="038320.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 76485][Maj] Changed - [GMCS] assertion failed in
	monodis</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2076485%5D%5BMaj%5D%20Changed%20-%20%5BGMCS%5D%20assertion%20failed%20in%0A%09monodis&In-Reply-To=bug-76485%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 76485][Maj] Changed - [GMCS] assertion failed in
	monodis">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Wed Jan 18 05:36:22 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="038318.html">[Mono-bugs] [Bug 77295][Wis] New - Problems with danish chars in
	X.509 certificate
</A></li>
        <LI>Next message: <A HREF="038320.html">[Mono-bugs] [Bug 77296][Nor] New - Datagrid does not paint cells
	when editing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38319">[ date ]</a>
              <a href="thread.html#38319">[ thread ]</a>
              <a href="subject.html#38319">[ subject ]</a>
              <a href="author.html#38319">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">malekith at pld-linux.org.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=76485">http://bugzilla.ximian.com/show_bug.cgi?id=76485</A>

--- shadow/76485	2006-01-16 11:21:01.000000000 -0500
+++ shadow/76485.tmp.11701	2006-01-18 05:36:22.000000000 -0500
@@ -42,6 +42,107 @@
 ------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">jankit at novell.com</A>  2006-01-16 11:21 -------
 monodis seems to be working with Nemerle.dll fine. ilasm2(svn) can
 roundtrip it also now. But am not sure whether there might be any
 issues with the roundtripped assembly. It would be nice if nemerle's
 test-suite could be tried on this and let us know if there are issues
 with that. Thanks.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">malekith at pld-linux.org</A>  2006-01-18 05:36 -------
+So the good news: it works fine with the testsuite.
+
+There is a single tiny problem: monodis says special-name, while ilasm
+accepts only specialname. I think ilasm is right.
+
+However there are issues with PEVerify run on the resulting assemblies:
+
+[IL]: Error: [C:\cygwin\home\malekith\boot\Nemerle.dll :
+Nemerle.Collections.Set`1['a]::Sum['a]][offset 0x00000006] Unable to
+resolve token.
+[token  0x0200002F] Type load failed.
+2 Errors Verifying Nemerle.dll
+
+(similar errors occur in Nemerle.Compiler.dll).
+
+Offending method, when disassembled by MS ildasm:
+  .method public hidebysig instance class
+Nemerle.Collections.Set`1&lt;!'\'a'&gt;
+          Sum(class Nemerle.Collections.Set`1&lt;!'\'a'&gt; s) cil managed
+  {
+    // Code size       30 (0x1e)
+    .maxstack  4
+    .locals init (class Nemerle.Builtins.Function`3&lt;!'\'a',class
+Nemerle.Collections.Tree/Node`1&lt;!'\'a'&gt;,
+             class Nemerle.Collections.Tree/Node`1&lt;!'\'a'&gt;&gt; V_0)
+    IL_0000:  ldarg.1
+    IL_0001:  ldfld      class Nemerle.Collections.Tree/Node`1&lt;!0&gt;
+class Nemerle.Collections.Set`1&lt;!'\'a'&gt;::root
+    IL_0006:  ldarg.0
+    IL_0007:  ldfld      class Nemerle.Collections.Tree/Node`1&lt;!0&gt;
+class Nemerle.Collections.Set`1&lt;!'\'a'&gt;::root
+    IL_000c:  newobj     instance void class
+Nemerle.Collections.Set`1/_N__N_l10568_10578&lt;!'\'a'&gt;::.ctor()
+    IL_0011:  stloc.0
+    IL_0012:  ldloc.0
+    IL_0013:  call       !!1
+Nemerle.Collections.Tree::Fold&lt;!'\'a',class
+Nemerle.Collections.Tree/Node`1&lt;!'\'a'&gt;&gt;(class
+Nemerle.Collections.Tree/Node`1&lt;!!0&gt;,!!1,class
+Nemerle.Builtins.Function`3&lt;!!0,
+                                                                     
+                                            !!1,
+                                                                     
+                                            !!1&gt;)
+    IL_0018:  newobj     instance void class
+Nemerle.Collections.Set`1&lt;!'\'a'&gt;::.ctor(class
+Nemerle.Collections.Tree/Node`1&lt;!0&gt;)
+    IL_001d:  ret
+  } // end of method Set`1::Sum
+
+and by monodis:
+
+    // method line 610
+    .method public hidebysig
+           instance default class Nemerle.Collections.Set`1&lt;!'\'a'&gt;
+Sum (class Nemerle.Collections.Set`1&lt;!'\'a'&gt; s) -&gt; cil managed
+    {
+        // Method begins at RVA 0xcd0c
+        // Code size 30 (0x1e)         .maxstack 4
+        .locals init (
+                class Nemerle.Builtins.Function`3&lt;!'\'a', class
+Nemerle.Collections.Tree/Node`1&lt;!'\'a'&gt;, class -&gt;
+Nemerle.Collections.Tree/Node`1&lt;!'\'a'&gt;&gt;        V_0)
+        IL_0000:  ldarg.1
+        IL_0001:  ldfld  class Nemerle.Collections.Tree/Node`1&lt;!0&gt;
+class Nemerle.Collections.Set`1&lt;!0&gt;::root
+        IL_0006:  ldarg.0
+        IL_0007:  ldfld  class Nemerle.Collections.Tree/Node`1&lt;!0&gt;
+class Nemerle.Collections.Set`1&lt;!0&gt;::root
+        IL_000c:  newobj instance void class
+Nemerle.Collections.Set`1/_N__N_l10577_10587&lt;!'\'a'&gt;::.ctor()        
+IL_0011:  stloc.0
+        IL_0012:  ldloc.0         IL_0013:  call !!1 class
+Nemerle.Collections.Tree::Fold&lt;!0, class
+Nemerle.Collections.Tree/Node`1&lt;!0&gt;&gt; -&gt; (class
+Nemerle.Collections.Tree/Node`1&lt;!!0&gt;, !!1, class
+Nemerle.Builtins.Function`3&lt;!!0,!!1,!!1&gt;)
+        IL_0018:  newobj instance void class
+Nemerle.Collections.Set`1&lt;!'\'a'&gt;::.ctor(class
+Nemerle.Collections.Tree/-&gt; Node`1&lt;!0&gt;)
+        IL_001d:  ret
+    } // end of method Set`1::instance default class
+Nemerle.Collections.Set`1&lt;!'\'a'&gt; Sum (class Nemerle. -&gt;
+Collections.Set`1&lt;!'\'a'&gt; s)
+
+
+Also when trying to ms.ilasm monodis produced assembly, it assembles
+fine, but later PEVerify screams:
+[IL]: Error: [C:\cygwin\home\malekith\stage3\n.dll :
+Nemerle.Utility.Getopt::Usage] Type load failed.
+[IL]: Error: [C:\cygwin\home\malekith\stage3\n.dll :
+Nemerle.Utility.Getopt::Parse] Type load failed.
+[IL]: Error: [C:\cygwin\home\malekith\stage3\n.dll :
+Nemerle.Utility.Getopt::Parse] Type load failed.
+[IL]: Error: [C:\cygwin\home\malekith\stage3\n.dll :
+Nemerle.Utility.Getopt::_N_concat4729] Type load failed.
+
+and so on, but it can be something wrong with my setup here.
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038318.html">[Mono-bugs] [Bug 77295][Wis] New - Problems with danish chars in
	X.509 certificate
</A></li>
	<LI>Next message: <A HREF="038320.html">[Mono-bugs] [Bug 77296][Nor] New - Datagrid does not paint cells
	when editing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38319">[ date ]</a>
              <a href="thread.html#38319">[ thread ]</a>
              <a href="subject.html#38319">[ subject ]</a>
              <a href="author.html#38319">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
