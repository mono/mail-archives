<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 77268][Wis] Changed - Sqlite DateTime Parameters	Handled Incorrectly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2077268%5D%5BWis%5D%20Changed%20-%20Sqlite%20DateTime%20Parameters%0A%09Handled%20Incorrectly&In-Reply-To=bug-77268%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="044173.html">
   <LINK REL="Next"  HREF="044175.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 77268][Wis] Changed - Sqlite DateTime Parameters	Handled Incorrectly</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2077268%5D%5BWis%5D%20Changed%20-%20Sqlite%20DateTime%20Parameters%0A%09Handled%20Incorrectly&In-Reply-To=bug-77268%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 77268][Wis] Changed - Sqlite DateTime Parameters	Handled Incorrectly">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Tue Jul  4 07:02:32 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="044173.html">[Mono-bugs] [Bug 78509][Maj] Changed - OracleClient trims trailing	spaces
</A></li>
        <LI>Next message: <A HREF="044175.html">[Mono-bugs] [Bug 78759][Nor] Changed - ImageListStreamer fails to	load image resources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44174">[ date ]</a>
              <a href="thread.html#44174">[ thread ]</a>
              <a href="subject.html#44174">[ subject ]</a>
              <a href="author.html#44174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">anmar at gmx.net.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=77268">http://bugzilla.ximian.com/show_bug.cgi?id=77268</A>

--- shadow/77268	2006-03-08 08:44:42.000000000 -0500
+++ shadow/77268.tmp.22077	2006-07-04 07:02:32.000000000 -0400
@@ -146,6 +146,43 @@
 (automatically).  Also since Sqlite doesn't store DATETIMEs natively
 in any special format besides as a string, it makes some sense to me
 that the client user should specify how he wants the DateTime encoded
 in the DB.
 
 It's not an ideal situation, but I'm marking this as not a bug.
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">anmar at gmx.net</A>  2006-07-04 07:02 -------
+Here I see several possible improvements for this situation:
+
+ 1. The default date representation in SqLite is 'The number of days
+since noon in Greenwich on November 24, 4714 B.C.'. Going from
+ToFileTime() to julian representation would be cheap enough. In this
+case the date functions in sqlite will parse the date properly by
+default without using modifiers.
+
+ 2. Push for a new date modifier in sqlite such as 'dotnet' or 'mono'
+that parses the ToFileTime() format. It's simple to implement, though
+I guess hard to get included into sqlite codebase. It also forces the
+use of that modifier when using dates in expressions. Sample
+implementation for parseModifier function:
+    case 'd': {
+      if( strcmp(z, &quot;dotnet&quot;)==0 &amp;&amp; p-&gt;validJD ){
+        p-&gt;rJD = (p-&gt;rJD/86400.0)/1000000000.0 + 2305813.5;
+        p-&gt;rJD += localtimeOffset(p);
+        clearYMD_HMS_TZ(p);
+        rc = 0;
+      }
+      break;
+    }
+
+ 3. Add a connection string option to select which way to store dates.
+Then it could use ISO 8601 format for those cases where we don't care
+about performance when parsing strings but prefer ease of use in sql
+expressions. The best about this options is that it would play well if
+you also access the same data through the odbc driver as it uses ISO
+8601 format.
+
+I'd prefer 1) as it's the simplest to work with, and can be even done
+in a somewhat backwards compatible way detecting the order of
+magnitude of the stored number.
+
+I'd be willing to provide patches for any of them.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="044173.html">[Mono-bugs] [Bug 78509][Maj] Changed - OracleClient trims trailing	spaces
</A></li>
	<LI>Next message: <A HREF="044175.html">[Mono-bugs] [Bug 78759][Nor] Changed - ImageListStreamer fails to	load image resources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44174">[ date ]</a>
              <a href="thread.html#44174">[ thread ]</a>
              <a href="subject.html#44174">[ subject ]</a>
              <a href="author.html#44174">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
