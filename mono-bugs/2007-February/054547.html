<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 80980][Nor] Changed - SIGSEGV loading invalid image
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2080980%5D%5BNor%5D%20Changed%20-%20SIGSEGV%20loading%20invalid%20image&In-Reply-To=bug-80980%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="054546.html">
   <LINK REL="Next"  HREF="054548.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 80980][Nor] Changed - SIGSEGV loading invalid image</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2080980%5D%5BNor%5D%20Changed%20-%20SIGSEGV%20loading%20invalid%20image&In-Reply-To=bug-80980%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 80980][Nor] Changed - SIGSEGV loading invalid image">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Tue Feb 27 18:24:27 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="054546.html">[Mono-bugs] [Bug 80980][Nor] New - SIGSEGV loading invalid image
</A></li>
        <LI>Next message: <A HREF="054548.html">[Mono-bugs] [Bug 80901][Cos] Changed - Menu is drawn inconsistently
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54547">[ date ]</a>
              <a href="thread.html#54547">[ thread ]</a>
              <a href="subject.html#54547">[ subject ]</a>
              <a href="author.html#54547">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sebastien at ximian.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=80980">http://bugzilla.ximian.com/show_bug.cgi?id=80980</A>

--- shadow/80980	2007-02-27 17:48:05.000000000 -0500
+++ shadow/80980.tmp.1508	2007-02-27 18:24:27.000000000 -0500
@@ -2,15 +2,15 @@
 Product: Mono: Class Libraries
 Version: 1.2
 OS: GNU/Linux [Other]
 OS Details: 
 Status: NEW   
 Resolution: 
-Severity: 
+Severity: Unknown
 Priority: Normal
-Component: Sys.Drawing.
+Component: libgdiplus
 AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>                            
 ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">gert.driesen at pandora.be</A>               
 QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
 TargetMilestone: ---
 URL: 
 Cc: 
@@ -129,6 +129,60 @@
 
 I'm running Mono SVN on Gentoo Linux.
 
 If you need more info, just let me know. Sorry if I'm short on details 
 right now (spent already too much time on Mono today, if you ask my gf ;-
 )).
+
+------- Additional Comments From <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">sebastien at ximian.com</A>  2007-02-27 18:24 -------
+In general(*) we trap the errors from the library we call. In this
+case the crash is inside libjpeg (see stack trace). Note that it still
+could be libgdiplus fault (e.g. bad checks). Will check that...
+
+(*) BMP, ICO (and soon WMF and EMF) are our own codec/code.
+
+&gt; mono imageview.exe bad.jpg
+Stacktrace:
+
+  at (wrapper managed-to-native)
+System.Drawing.GDIPlus.GdipLoadImageFromFile (string,intptr&amp;) &lt;0x00004&gt;
+  at (wrapper managed-to-native)
+System.Drawing.GDIPlus.GdipLoadImageFromFile (string,intptr&amp;) &lt;0xffffffff&gt;
+  at System.Drawing.Image.FromFile (string,bool) &lt;0x0004b&gt;
+  at System.Drawing.Image.FromFile (string) &lt;0x0000c&gt;
+  at MainForm..ctor (string) &lt;0x0001c&gt;
+  at (wrapper remoting-invoke-with-check) MainForm..ctor (string)
+&lt;0xffffffff&gt;
+  at MainForm.Main (string[]) &lt;0x00043&gt;
+  at (wrapper runtime-invoke)
+System.Object.runtime_invoke_void_string[]
+(object,intptr,intptr,intptr) &lt;0xffffffff&gt;
+
+Native stacktrace:
+
+        mono(mono_handle_native_sigsegv+0xd4) [0x816c814]
+        mono [0x8136888]
+        [0xffffe440]
+        /usr/lib/libjpeg.so.62(jinit_master_decompress+0x268) [0xb6d0e688]
+        /usr/lib/libjpeg.so.62(jpeg_start_decompress+0xe1) [0xb6d0da71]
+       
+/usr/local/lib/libgdiplus.so(gdip_load_jpeg_image_internal+0x1e5)
+[0xb6fb0965]
+       
+/usr/local/lib/libgdiplus.so(gdip_load_jpeg_image_from_file+0xaf)
+[0xb6fb10bf]
+        /usr/local/lib/libgdiplus.so(GdipLoadImageFromFile+0x1e4)
+[0xb6f967d4]
+        [0xb6597951]
+        [0xb65970ec]
+        [0xb6597085]
+        [0xb7495bc5]
+        [0xb74958ba]
+        [0xb74957ec]
+        [0xb74947d5]
+        mono(mono_runtime_exec_main+0x62) [0x80e7202]
+        mono(mono_runtime_run_main+0x1b9) [0x80e74e9]
+        mono(mono_main+0xe8f) [0x805f23f]
+        mono [0x805dea2]
+        /lib/libc.so.6(__libc_start_main+0xdc) [0xb7d3a87c]
+        mono [0x805ddf1]
+
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="054546.html">[Mono-bugs] [Bug 80980][Nor] New - SIGSEGV loading invalid image
</A></li>
	<LI>Next message: <A HREF="054548.html">[Mono-bugs] [Bug 80901][Cos] Changed - Menu is drawn inconsistently
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54547">[ date ]</a>
              <a href="thread.html#54547">[ thread ]</a>
              <a href="subject.html#54547">[ subject ]</a>
              <a href="author.html#54547">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
