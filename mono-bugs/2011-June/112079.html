<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 698973] New: Garbage collector prematurely	collects objects
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20698973%5D%20New%3A%20Garbage%20collector%20prematurely%0A%09collects%20objects&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="112077.html">
   <LINK REL="Next"  HREF="112080.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 698973] New: Garbage collector prematurely	collects objects</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20698973%5D%20New%3A%20Garbage%20collector%20prematurely%0A%09collects%20objects&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 698973] New: Garbage collector prematurely	collects objects">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Jun  9 04:08:22 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="112077.html">[Mono-bugs] [Bug 698756] When building certain projects, XBuild throws an error about importing mscorlib multiple times
</A></li>
        <LI>Next message: <A HREF="112080.html">[Mono-bugs] [Bug 698976] New: Mono compilation fails under msvc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112079">[ date ]</a>
              <a href="thread.html#112079">[ thread ]</a>
              <a href="subject.html#112079">[ subject ]</a>
              <a href="author.html#112079">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=698973">https://bugzilla.novell.com/show_bug.cgi?id=698973</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=698973#c0">https://bugzilla.novell.com/show_bug.cgi?id=698973#c0</A>


           Summary: Garbage collector prematurely collects objects
    Classification: Mono
           Product: MonoTouch
           Version: unspecified
          Platform: x86-64
        OS/Version: Mac OS X 10.6
            Status: NEW
          Keywords: Reliability
          Severity: Critical
          Priority: P5 - None
         Component: Runtime
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">vittorio.monaco at merqurio.it</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: Customer
           Blocker: No


Description of Problem:
Application crashes on start. Debugging the code shows that elements of a List
are prematurely collected, even if the reference to the List is still being
used. 
Using MonoTouch 3.2.6 this does not happen, anyway I have to upgrade to
MonoTouch 4.0.3
The code is below:

List&lt;MerqurioMenuNode&gt; rootMenu =  MenuManager.GetRootMenu();

the next debugging step already shows the list with the correct elements count,
but drilling down the elements shows the message 'The requested operation
cannot be completed because the object has been garbage collected'

The method is below:

public List&lt;MerqurioMenuNode&gt; GetRootMenu()
{
     XmlNodeList nodes = rootNode.ChildNodes;

     currentNodes.Clear();
     Livello=0;
     Nonno=0;
     Bisnonno=0;
     Padre=0;

     StackNonno.Push(Nonno);
     StackBisnonno.Push(Bisnonno);

     for (int i = 0; i &lt; nodes.Count; i++)
     {
          tmp = GetMerqurioMenuNodeFromXmlNode(nodes[i]);
      tmp.ParentMenuID = 0;
      tmp.Direction = NodeDirection.Forward;
      currentNodes.Add(tmp);
     }

     return currentNodes;
}

every relevant variable except for nodes (currentNodes, rootNode, tmp) is
declared static in the class, so for what I can see there are no elements for
the gc to collect the list items.


Steps to reproduce the problem:
1. Execute the code
2. The next debugging step already shows the items as collected


Actual Results:
The application crashes on startup

Expected Results:
The items should be reachable

How often does this happen? 
Always

Additional Information:
The project is a iPad Window-based project 
(MonoDevelop 2.4.2)
(MonoTouch 4.0.3)
(SnowLeopard 10.6.7)

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="112077.html">[Mono-bugs] [Bug 698756] When building certain projects, XBuild throws an error about importing mscorlib multiple times
</A></li>
	<LI>Next message: <A HREF="112080.html">[Mono-bugs] [Bug 698976] New: Mono compilation fails under msvc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112079">[ date ]</a>
              <a href="thread.html#112079">[ thread ]</a>
              <a href="subject.html#112079">[ subject ]</a>
              <a href="author.html#112079">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
