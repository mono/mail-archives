<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 670945] New: XML Serialization output differs from Microsoft .NET Runtime (or CLR)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20670945%5D%20New%3A%20XML%20Serialization%20output%20differs%20from%0A%20Microsoft%20.NET%20Runtime%20%28or%20CLR%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="108935.html">
   <LINK REL="Next"  HREF="108937.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 670945] New: XML Serialization output differs from Microsoft .NET Runtime (or CLR)</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%20670945%5D%20New%3A%20XML%20Serialization%20output%20differs%20from%0A%20Microsoft%20.NET%20Runtime%20%28or%20CLR%29&In-Reply-To="
       TITLE="[Mono-bugs] [Bug 670945] New: XML Serialization output differs from Microsoft .NET Runtime (or CLR)">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Feb 10 08:14:17 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="108935.html">[Mono-bugs] [Bug 670900] Monotouch 2.4.1. compile problem - plist invalid with XCode4 GM
</A></li>
        <LI>Next message: <A HREF="108937.html">[Mono-bugs] [Bug 670945] XML Serialization output differs from Microsoft .NET Runtime (or CLR)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#108934">[ date ]</a>
              <a href="thread.html#108934">[ thread ]</a>
              <a href="subject.html#108934">[ subject ]</a>
              <a href="author.html#108934">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=670945">https://bugzilla.novell.com/show_bug.cgi?id=670945</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=670945#c0">https://bugzilla.novell.com/show_bug.cgi?id=670945#c0</A>


           Summary: XML Serialization output differs from Microsoft .NET
                    Runtime (or CLR)
    Classification: Mono
           Product: Mono: Runtime
           Version: 2.8.x
          Platform: i686
        OS/Version: Linux
            Status: NEW
          Severity: Major
          Priority: P5 - None
         Component: misc
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">charles.nepveu at verint.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US)
AppleWebKit/534.7 (KHTML, like Gecko) Chrome/7.0.517.41 Safari/534.7

Hi,

I'm using a generated ServiceModel.ClientBase&lt;&gt; implementation, generated by
ONVIF WSDL documents (e.g.: DdviceManagement.wsdl) found on onvif.org (though
web references).

I found out that when serializing an array of enum values, the output differs
when using the Mono 2.8.2 runtime compared to the Microsoft .NET runtime.

Because of this difference, the remote web service doesn't understand the
request and responds with a &quot;400 - Bad Request&quot; message.

However, when I do a manual serialization of instances of the problematic class
(using an XmlSerializer and StringWriter), the serialized XML output is the
same whether I use the Mono 2.8.2 or Microsoft .NET runtimes. So it seems that
the problem deep within the ServiceModel web services client classes that
perform XML serialization under the hood.

The problem is related to the serialization of an array of enum values. See the
actual and expected results.

Reproducible: Always

Steps to Reproduce:
1. Create a console app project, and add the following Web Reference to your
project: <A HREF="http://www.onvif.org/onvif/ver10/device/wsdl/devicemgmt.wsdl">http://www.onvif.org/onvif/ver10/device/wsdl/devicemgmt.wsdl</A>
2. Instantiate a DeviceClient object, with an HTTP basic binding, and an
endpoint.
3. Invoke the 'GetCapabilities(CapabilityCategory[]) method.
4. Check the XML request message that is output.
Actual Results:  
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;s:Envelope xmlns:s=&quot;<A HREF="http://schemas.xmlsoap.org/soap/envelope/&quot;">http://schemas.xmlsoap.org/soap/envelope/&quot;</A>&gt;
   &lt;s:Body&gt;
      &lt;GetCapabilities xmlns:xsi=&quot;<A HREF="http://www.w3.org/2001/XMLSchema-instance&quot;">http://www.w3.org/2001/XMLSchema-instance&quot;</A>
xmlns:xsd=&quot;<A HREF="http://www.w3.org/2001/XMLSchema&quot;">http://www.w3.org/2001/XMLSchema&quot;</A>
xmlns=&quot;<A HREF="http://www.onvif.org/ver10/device/wsdl&quot;">http://www.onvif.org/ver10/device/wsdl&quot;</A>&gt;
         &lt;Category&gt;
            &lt;CapabilityCategory&gt;All&lt;/CapabilityCategory&gt;
         &lt;/Category&gt;
      &lt;/GetCapabilities&gt;
   &lt;/s:Body&gt;
&lt;/s:Envelope&gt;


Expected Results:  
&lt;s:Envelope xmlns:s=&quot;<A HREF="http://schemas.xmlsoap.org/soap/envelope/&quot;">http://schemas.xmlsoap.org/soap/envelope/&quot;</A>&gt;
   &lt;s:Body xmlns:xsi=&quot;<A HREF="http://www.w3.org/2001/XMLSchema-instance&quot;">http://www.w3.org/2001/XMLSchema-instance&quot;</A>
xmlns:xsd=&quot;<A HREF="http://www.w3.org/2001/XMLSchema&quot;">http://www.w3.org/2001/XMLSchema&quot;</A>&gt;
      &lt;GetCapabilities xmlns=&quot;<A HREF="http://www.onvif.org/ver10/device/wsdl&quot;">http://www.onvif.org/ver10/device/wsdl&quot;</A>&gt;
         &lt;Category&gt;All&lt;/Category&gt;
      &lt;/GetCapabilities&gt;
   &lt;/s:Body&gt;
&lt;/s:Envelope&gt;


The difference (apart from the XML header) is that the CapabilityCategory
element should not be there in the actual result.

The CapabilityCategory name is in fact the name of the enumeration from which
'All' is from. See the declarations:

public partial class GetCapabilitiesRequest
{
  ...
  [System.Xml.Serialization.XmlElementAttribute(&quot;Category&quot;)]
  public CapabilityCategory[] Category;
  ...
}

public enum CapabilityCategory
{
  All,
  ...
}

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>








































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="108935.html">[Mono-bugs] [Bug 670900] Monotouch 2.4.1. compile problem - plist invalid with XCode4 GM
</A></li>
	<LI>Next message: <A HREF="108937.html">[Mono-bugs] [Bug 670945] XML Serialization output differs from Microsoft .NET Runtime (or CLR)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#108934">[ date ]</a>
              <a href="thread.html#108934">[ thread ]</a>
              <a href="subject.html#108934">[ subject ]</a>
              <a href="author.html#108934">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
