<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 77494][Maj] New - Mono runtime after 1.1.8.x goes
	into infinite recursion when accessing virtual override property.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2077494%5D%5BMaj%5D%20New%20-%20Mono%20runtime%20after%201.1.8.x%20goes%0A%09into%20infinite%20recursion%20when%20accessing%20virtual%20override%20property.&In-Reply-To=bug-77494%40chernobyl.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039023.html">
   <LINK REL="Next"  HREF="039025.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 77494][Maj] New - Mono runtime after 1.1.8.x goes
	into infinite recursion when accessing virtual override property.</H1>
    <B>bugzilla-daemon at bugzilla.ximian.com</B> 
    <A HREF="mailto:mono-bugs%40lists.ximian.com?Subject=%5BMono-bugs%5D%20%5BBug%2077494%5D%5BMaj%5D%20New%20-%20Mono%20runtime%20after%201.1.8.x%20goes%0A%09into%20infinite%20recursion%20when%20accessing%20virtual%20override%20property.&In-Reply-To=bug-77494%40chernobyl.ximian.com"
       TITLE="[Mono-bugs] [Bug 77494][Maj] New - Mono runtime after 1.1.8.x goes
	into infinite recursion when accessing virtual override property.">bugzilla-daemon at bugzilla.ximian.com
       </A><BR>
    <I>Tue Feb  7 15:29:14 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="039023.html">[Mono-bugs] [Bug 76663][Nor] Changed - [2.0] Cannot set master page
	title using Title attribute
</A></li>
        <LI>Next message: <A HREF="039025.html">[Mono-bugs] [Bug 77495][Cri] New - Mono compiler crashes while
	compiling C# code.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39024">[ date ]</a>
              <a href="thread.html#39024">[ thread ]</a>
              <a href="subject.html#39024">[ subject ]</a>
              <a href="author.html#39024">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mwickline at maad.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=77494">http://bugzilla.ximian.com/show_bug.cgi?id=77494</A>

--- shadow/77494	2006-02-07 15:29:14.000000000 -0500
+++ shadow/77494.tmp.31025	2006-02-07 15:29:14.000000000 -0500
@@ -0,0 +1,211 @@
+Bug#: 77494
+Product: Mono: Runtime
+Version: 1.1
+OS: Mandrake 9.0
+OS Details: x86, glibc 2.2.5
+Status: NEW   
+Resolution: 
+Severity: 
+Priority: Major
+Component: JIT
+AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">lupus at ximian.com</A>                            
+ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mwickline at maad.com</A>               
+QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-bugs">mono-bugs at ximian.com</A>
+TargetMilestone: ---
+URL: 
+Cc: 
+Summary: Mono runtime after 1.1.8.x goes into infinite recursion when accessing virtual override property.
+
+Please fill in this template when reporting a bug, unless you know what you
+are doing.
+Description of Problem:
+The mono runtime after version 1.1.8.x goes into an infinite recursion (and
+crashes with seg fault) when accessing a public property that overrides an
+ancestor class property.  The code itself should never produce infinite
+recursion (and doesn't on Microsoft .NET 1.1, nor on Mono 1.1.8.x).  My
+apologies, for not having a smaller test case to exhibit the problem.
+
+Steps to reproduce the problem:
+1. Using the test case given, under mono 1.1.12.1 (for example) run:
+   mono --trace=T:MAAD.IPME.Common.IPMEPreferences TestSMG.exe
+
+Actual Results:
+You will see that accessing the IPMEPreferences.StartID public property
+(eventually, like after 15-20 seconds on slow machines) produces an
+infinite recursion:
+
+ENTER: MAAD.IPME.Common.IPMEPreferences:GetSerializer
+(MAAD.IPME.Schedulers.ISchedulerCapable)([MAAD.IPME.SimEngine.MicroSaintSimulationApplication:0x837aea0],
+)
+LEAVE: MAAD.IPME.Common.IPMEPreferences:GetSerializer
+(MAAD.IPME.Schedulers.ISchedulerCapable)[System.Xml.Serialization.XmlSerializer:0x84c4fa0]
+ENTER: MAAD.IPME.Common.IPMEPreferences:.ctor
+()(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. ENTER: MAAD.IPME.Common.IPMEPreferences:set_StartID
+(string)(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe],
+[STRING:0x8273f80:1], )
+. . ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. . . ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. . . . ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. . . . . ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. . . . . . ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. . . . . . . ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8645d68[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+And so on...
+
+
+Expected Results:
+Under mono 1.1.8.0 it produces the correct result:
+
+ENTER: MAAD.IPME.Common.IPMEPreferences:GetSerializer
+(MAAD.IPME.Schedulers.ISchedulerCapable)([MAAD.IPME.SimEngine.MicroSaintSimulationApplication:0x8383ea0],
+)
+LEAVE: MAAD.IPME.Common.IPMEPreferences:GetSerializer
+(MAAD.IPME.Schedulers.ISchedulerCapable)[System.Xml.Serialization.XmlSerializer:0x856efa0]
+ENTER: MAAD.IPME.Common.IPMEPreferences:.ctor
+()(this:0x8383c30[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. ENTER: MAAD.IPME.Common.IPMEPreferences:set_StartID
+(string)(this:0x8383c30[MAAD.IPME.Common.IPMEPreferences TestSMG.exe],
+[STRING:0x8262f80:1], )
+. . ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8383c30[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. . LEAVE: MAAD.IPME.Common.IPMEPreferences:get_StartID ()[STRING:null],
+. LEAVE: MAAD.IPME.Common.IPMEPreferences:set_StartID (string)
+LEAVE: MAAD.IPME.Common.IPMEPreferences:.ctor ()
+ENTER: MAAD.IPME.Common.IPMEPreferences:set_StartID
+(string)(this:0x8383c30[MAAD.IPME.Common.IPMEPreferences TestSMG.exe],
+[STRING:0x83a3940:1], )
+. ENTER: MAAD.IPME.Common.IPMEPreferences:get_StartID
+()(this:0x8383c30[MAAD.IPME.Common.IPMEPreferences TestSMG.exe], )
+. LEAVE: MAAD.IPME.Common.IPMEPreferences:get_StartID ()[STRING:0x8262f80:1]
+LEAVE: MAAD.IPME.Common.IPMEPreferences:set_StartID (string)
+ENTER: MAAD.IPME.Common.IPMEPreferences:set_MissionTimeLimit
+(double)(this:0x8383c30[MAAD.IPME.Common.IPMEPreferences TestSMG.exe],
+0.000000, )
+And so on, until it eventually completes with the message:
+Simulation Complete - 0.25 seconds.
+
+
+How often does this happen? 
+Always.
+
+Additional Information:
+These assemblies were compiled under Visual Studio .NET 2003, using
+Microsoft's .NET 1.1 C# compiler.
+The class heirarchy, and assemblies containing the classes, look like:
+
+class MAAD.IPME.Common.IPMEPreferences in assembly IPME.Common.dll
+
+	[ Serializable(),
+	  XmlRoot(&quot;IPMEPreferences&quot;)
+	]
+	public class IPMEPreferences : MAAD.Network.Preferences
+	{
+
+		[ XmlAttribute() ]
+		public override string StartID
+		{
+			get
+			{
+				if(base.StartID != null &amp;&amp; IDDelimiter != null)
+					return base.StartID.Replace(IDDelimiter, &quot;_&quot;);
+				return base.StartID;
+			}
+			set
+			{
+				// NOTE:  IDDelimiter may be undefined here during the XML deserialization,
+				// so we have to do the replacement in the getter.
+				base.StartID = value;
+			}
+		}
+	}
+
+class MAAD.Network.Preferences in assembly MAAD.Network.dll
+
+
+	[
+	DisplayAttribute(ImageNumber = 4, Name = &quot;Execution Settings&quot;),
+	Serializable()
+	]
+	public class Preferences : DefaultPreferences, IPreferences
+	{
+		private string idDelimiter;
+
+		public Preferences()
+		{
+			IDDelimiter = &quot;_&quot;;
+		}
+
+		[
+		Browsable(false),
+		XmlAttribute()
+		]
+		public virtual string IDDelimiter
+		{
+			get { return idDelimiter; }
+			set
+			{
+				OldValue = IDDelimiter;
+				idDelimiter = value;
+				LaunchChangedEvent(EChanged.DataEdited, &quot;IDDelimiter&quot;, OldValue);
+			}
+		}
+
+	}
+
+class MAAD.Utilities.Document.DefaultPreferences in assembly MAAD.Utilities.dll
+
+	[Serializable()]
+	public class DefaultPreferences : DefaultEditable, ISettings
+	{
+		private string startID;
+		public DefaultPreferences()
+		{
+			StartID = &quot;1&quot;;
+		}
+
+		[
+		XmlAttribute(),
+		SearchableAttribute(),
+		Description(&quot;The ID of the start task in the network.&quot;)
+		]
+		public virtual string StartID
+		{
+			get { return startID; }
+			set
+			{
+				OldValue = StartID;
+				startID = value;
+				LaunchChangedEvent(EChanged.DataEdited, &quot;StartID&quot;, OldValue);
+			}
+		}
+	}
+
+class MAAD.Utilities.DefaultEditable in assembly MAAD.Utilities.dll
+
+	[Serializable()]
+	public abstract class DefaultEditable : DefaultLightEditable, IEditable,
+ICustomTypeDescriptor, IEditOperationsID, IUndoEventsHelper
+	{
+		[NonSerialized()] private object oldValue;
+		public DefaultEditable()
+		{
+			OldValue = null;
+		}
+
+		[
+		Browsable(false),
+		XmlIgnore(),
+		DisplayIntelliPromptAttribute(false)
+		]
+		protected object OldValue
+		{
+			get { return oldValue; }
+			set { oldValue = value; }
+		}
+	}
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039023.html">[Mono-bugs] [Bug 76663][Nor] Changed - [2.0] Cannot set master page
	title using Title attribute
</A></li>
	<LI>Next message: <A HREF="039025.html">[Mono-bugs] [Bug 77495][Cri] New - Mono compiler crashes while
	compiling C# code.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39024">[ date ]</a>
              <a href="thread.html#39024">[ thread ]</a>
              <a href="subject.html#39024">[ subject ]</a>
              <a href="author.html#39024">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-bugs">More information about the mono-bugs
mailing list</a><br>
</body></html>
