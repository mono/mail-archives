<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 58065][Maj] Changed - Random Crash or Freeze running threadpool.exe
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016306.html">
   <LINK REL="Next"  HREF="016308.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 58065][Maj] Changed - Random Crash or Freeze running threadpool.exe
   </H1>
    <B>bugzilla-daemon@bugzilla.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com"
       TITLE="[Mono-bugs] [Bug 58065][Maj] Changed - Random Crash or Freeze running threadpool.exe">bugzilla-daemon@bugzilla.ximian.com
       </A><BR>
    <I>Thu, 27 May 2004 14:03:22 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="016306.html">[Mono-bugs] [Bug 58462][Maj] Changed - ilasm literal value gets lost
</A></li>
        <LI> Next message: <A HREF="016308.html">[Mono-bugs] [Bug 47720][Wis] Changed - DateTime.Parse (RFC1123) does not handle timezone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16307">[ date ]</a>
              <a href="thread.html#16307">[ thread ]</a>
              <a href="subject.html#16307">[ subject ]</a>
              <a href="author.html#16307">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:lupus@ximian.com.">lupus@ximian.com.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=58065">http://bugzilla.ximian.com/show_bug.cgi?id=58065</A>

--- shadow/58065	2004-05-27 13:06:07.000000000 -0400
+++ shadow/58065.tmp.32074	2004-05-27 14:03:22.000000000 -0400
@@ -329,6 +329,195 @@
 bug in our code.
 
 ------- Additional Comments From <A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>  2004-05-27 13:06 -------
 As an additional data point: kangaroo reported on irc that 10 runs of
 threadpool.exe all worked fine on his ibook running MacOSX, so this is
 most likely a thread race.
+
+------- Additional Comments From <A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>  2004-05-27 14:03 -------
+On a x86 smo box we get hangs, too (with different backtrace, though):
+Thread 8 (Thread 1095158576 (LWP 7685)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#3  0x080afec4 in _wapi_lookup_handle (handle=0x7,
+type=WAPI_HANDLE_THREAD, shared=0x4146c8f0, 
+    private=0x4146c8f4) at handles.c:418
+#4  0x080bb503 in _wapi_thread_apc_pending (handle=0x7) at threads.c:949
+#5  0x080bc74f in WaitForSingleObjectEx (handle=0x3,
+timeout=4294967295, alertable=1) at wait.c:115
+#6  0x08087ca0 in finalizer_thread (unused=0x0) at gc.c:532
+#7  0x08092fcd in start_wrapper (data=0x8239c10) at threads.c:249
+#8  0x080bbcd8 in timed_thread_start_routine (args=0x8239c28) at
+timed-thread.c:134
+#9  0x080cc6a5 in GC_start_routine (arg=0x81a5d40) at
+pthread_support.c:1184
+#10 0x40a3c484 in start_thread () from /lib/tls/libpthread.so.0
+
+Thread 7 (Thread 1099414320 (LWP 7687)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#3  0x080afec4 in _wapi_lookup_handle (handle=0xd,
+type=WAPI_HANDLE_THREAD, shared=0x4187b464, 
+    private=0x4187b468) at handles.c:418
+#4  0x080bb47b in QueueUserAPC (apc_callback=0x80948b0 &lt;dummy_apc&gt;,
+handle=0xd, param=0x0)
+    at threads.c:924
+#5  0x08094a20 in mono_thread_request_interruption
+(running_managed=135751892) at threads.c:1881
+#6  0x080e2005 in sigusr1_signal_handler (_dummy=34) at mini.c:8161
+#7  &lt;signal handler called&gt;
+#8  0xffffe002 in ?? ()
+#9  0x081138e4 in _wapi_daemon_request_response_internal (fd=4,
+msg=0x4187b838, resp=0x4187b888)
+    at daemon-messages.c:74
+#10 0x08113b6c in _wapi_daemon_request_response (fd=4, req=0xfffffffc,
+resp=0x4187b888)
+    at daemon-messages.c:189
+#11 0x080b0464 in _wapi_handle_unref (handle=0xc) at handles.c:640
+#12 0x080bc5f6 in WaitForSingleObjectEx (handle=0xc, timeout=500,
+alertable=1) at handles-private.h:380
+#13 0x08094fff in async_invoke_thread (data=0x0) at threadpool.c:256
+#14 0x08092fcd in start_wrapper (data=0x82f2198) at threads.c:249
+#15 0x080bbcd8 in timed_thread_start_routine (args=0x82f44d0) at
+timed-thread.c:134
+#16 0x080cc6a5 in GC_start_routine (arg=0x81a5840) at
+pthread_support.c:1184
+#17 0x40a3c484 in start_thread () from /lib/tls/libpthread.so.0
+---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
+
+Thread 6 (Thread 1101515568 (LWP 7688)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#3  0x080afec4 in _wapi_lookup_handle (handle=0xe,
+type=WAPI_HANDLE_THREAD, shared=0x41a7c514, 
+    private=0x41a7c518) at handles.c:418
+#4  0x080bb47b in QueueUserAPC (apc_callback=0x80948b0 &lt;dummy_apc&gt;,
+handle=0xe, param=0x0)
+    at threads.c:924
+#5  0x08094a20 in mono_thread_request_interruption
+(running_managed=135751892) at threads.c:1881
+#6  0x080e2005 in sigusr1_signal_handler (_dummy=34) at mini.c:8161
+#7  &lt;signal handler called&gt;
+#8  0xffffe002 in ?? ()
+#9  0x40a3e780 in pthread_cond_timedwait@@GLIBC_2.3.2 () from
+/lib/tls/libpthread.so.0
+
+Thread 5 (Thread 1110666032 (LWP 7689)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#3  0x080afec4 in _wapi_lookup_handle (handle=0xf,
+type=WAPI_HANDLE_THREAD, shared=0x42336534, 
+    private=0x42336538) at handles.c:418
+#4  0x080bb47b in QueueUserAPC (apc_callback=0x80948b0 &lt;dummy_apc&gt;,
+handle=0xf, param=0x0)
+    at threads.c:924
+#5  0x08094a20 in mono_thread_request_interruption
+(running_managed=135751892) at threads.c:1881
+#6  0x080e2005 in sigusr1_signal_handler (_dummy=34) at mini.c:8161
+#7  &lt;signal handler called&gt;
+#8  0xffffe002 in ?? ()
+
+Thread 4 (Thread 1112767280 (LWP 7690)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#3  0x080afec4 in _wapi_lookup_handle (handle=0x10,
+type=WAPI_HANDLE_THREAD, shared=0x42537534, 
+    private=0x42537538) at handles.c:418
+#4  0x080bb47b in QueueUserAPC (apc_callback=0x80948b0 &lt;dummy_apc&gt;,
+handle=0x10, param=0x0)
+    at threads.c:924
+#5  0x08094a20 in mono_thread_request_interruption
+(running_managed=135751892) at threads.c:1881
+#6  0x080e2005 in sigusr1_signal_handler (_dummy=34) at mini.c:8161
+---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
+#7  &lt;signal handler called&gt;
+#8  0xffffe002 in ?? ()
+
+Thread 3 (Thread 1114868528 (LWP 7691)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#3  0x080afec4 in _wapi_lookup_handle (handle=0x11,
+type=WAPI_HANDLE_THREAD, shared=0x42738534, 
+    private=0x42738538) at handles.c:418
+#4  0x080bb47b in QueueUserAPC (apc_callback=0x80948b0 &lt;dummy_apc&gt;,
+handle=0x11, param=0x0)
+    at threads.c:924
+#5  0x08094a20 in mono_thread_request_interruption
+(running_managed=135751892) at threads.c:1881
+#6  0x080e2005 in sigusr1_signal_handler (_dummy=34) at mini.c:8161
+#7  &lt;signal handler called&gt;
+#8  0xffffe002 in ?? ()
+
+Thread 2 (Thread 1116969776 (LWP 7692)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#3  0x080afec4 in _wapi_lookup_handle (handle=0x12,
+type=WAPI_HANDLE_THREAD, shared=0x429394ac, 
+    private=0x429394b0) at handles.c:418
+#4  0x080bb47b in QueueUserAPC (apc_callback=0x80948b0 &lt;dummy_apc&gt;,
+handle=0x12, param=0x0)
+    at threads.c:924
+#5  0x08094a20 in mono_thread_request_interruption
+(running_managed=135751892) at threads.c:1881
+#6  0x080e2005 in sigusr1_signal_handler (_dummy=34) at mini.c:8161
+#7  &lt;signal handler called&gt;
+#8  0x40a3da96 in pthread_mutex_lock () from /lib/tls/libpthread.so.0
+#9  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#10 0x080b1bef in _wapi_handle_ensure_mapped (segment=0) at
+handles-private.h:148
+#11 0x080afec4 in _wapi_lookup_handle (handle=0x12,
+type=WAPI_HANDLE_THREAD, shared=0x429398f0, 
+    private=0x429398f4) at handles.c:418
+#12 0x080bb503 in _wapi_thread_apc_pending (handle=0x12) at threads.c:949
+#13 0x080bc74f in WaitForSingleObjectEx (handle=0xc, timeout=500,
+alertable=1) at wait.c:115
+#14 0x08094fff in async_invoke_thread (data=0x0) at threadpool.c:256
+#15 0x08092fcd in start_wrapper (data=0x41d02898) at threads.c:249
+#16 0x080bbcd8 in timed_thread_start_routine (args=0x41d007a8) at
+timed-thread.c:134
+#17 0x080cc6a5 in GC_start_routine (arg=0x81a57a0) at
+pthread_support.c:1184
+---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
+#18 0x40a3c484 in start_thread () from /lib/tls/libpthread.so.0
+
+Thread 1 (Thread 1085498016 (LWP 7677)):
+#0  0xffffe002 in ?? ()
+#1  0x080b1a56 in _wapi_handle_get_shared_segment (segment=4294967292)
+at handles-private.h:103
+#2  0x080b0dfb in _wapi_handle_test_capabilities (handle=0xf,
+caps=4294967292) at handles.c:1185
+#3  0x080bce3e in WaitForMultipleObjectsEx (numobjects=6,
+handles=0x8250668, waitall=1, 
+    timeout=4294967295, alertable=0) at wait.c:441
+#4  0x08093ec3 in wait_for_tids (wait=0x8250668, timeout=4294967295)
+at threads.c:1231
+#5  0x08094126 in mono_thread_manage () at threads.c:1377
+#6  0x08084ade in mono_runtime_exec_managed_code (domain=0x81a8ed8, 
+    main_func=0x8065e30 &lt;main_thread_handler&gt;, main_args=0xbfffef30)
+at object.c:1419
+#7  0x08066535 in mono_main (argc=1, argv=0xbfffefd4) at driver.c:801
+#8  0x08065473 in main (argc=2, argv=0xbfffefd4) at main.c:6
+#9  0x42015704 in __libc_start_main () from /lib/tls/libc.so.6
+#0  0xffffe002 in ?? ()
+

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016306.html">[Mono-bugs] [Bug 58462][Maj] Changed - ilasm literal value gets lost
</A></li>
	<LI> Next message: <A HREF="016308.html">[Mono-bugs] [Bug 47720][Wis] Changed - DateTime.Parse (RFC1123) does not handle timezone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16307">[ date ]</a>
              <a href="thread.html#16307">[ thread ]</a>
              <a href="subject.html#16307">[ subject ]</a>
              <a href="author.html#16307">[ author ]</a>
         </LI>
       </UL>
</body></html>
