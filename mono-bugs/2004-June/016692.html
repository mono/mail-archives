<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-bugs] [Bug 59555][Maj] New - Overriden Properties, AddressOf, etc.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016691.html">
   <LINK REL="Next"  HREF="016693.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-bugs] [Bug 59555][Maj] New - Overriden Properties, AddressOf, etc.
   </H1>
    <B>bugzilla-daemon@bugzilla.ximian.com
    </B> 
    <A HREF="mailto:bugzilla-daemon%40bugzilla.ximian.com"
       TITLE="[Mono-bugs] [Bug 59555][Maj] New - Overriden Properties, AddressOf, etc.">bugzilla-daemon@bugzilla.ximian.com
       </A><BR>
    <I>Thu,  3 Jun 2004 10:24:25 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="016691.html">[Mono-bugs] [Bug 59470][Nor] Changed - Beta 2 build fails (missing -lintl)
</A></li>
        <LI> Next message: <A HREF="016693.html">[Mono-bugs] [Bug 59556][Nor] New - Wrong exception when allocating an array of a negative (or unsigned) size
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16692">[ date ]</a>
              <a href="thread.html#16692">[ thread ]</a>
              <a href="subject.html#16692">[ subject ]</a>
              <a href="author.html#16692">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please do not reply to this email- if you want to comment on the bug, go to the
URL shown below and enter your comments there.

Changed by <A HREF="mailto:jwezel@compumaster.de.">jwezel@compumaster.de.</A>

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=59555">http://bugzilla.ximian.com/show_bug.cgi?id=59555</A>

--- shadow/59555	2004-06-03 10:24:25.000000000 -0400
+++ shadow/59555.tmp.11204	2004-06-03 10:24:25.000000000 -0400
@@ -0,0 +1,165 @@
+Bug#: 59555
+Product: Mono: Compilers
+Version: unspecified
+OS: Red Hat 9.0
+OS Details: 
+Status: NEW   
+Resolution: 
+Severity: 
+Priority: Major
+Component: Basic
+AssignedTo: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>                            
+ReportedBy: <A HREF="mailto:jwezel@compumaster.de">jwezel@compumaster.de</A>               
+QAContact: <A HREF="mailto:mono-bugs@ximian.com">mono-bugs@ximian.com</A>
+TargetMilestone: ---
+URL: 
+Cc: 
+Summary: Overriden Properties, AddressOf, etc.
+
+Description of Problem:
+=======================
+
+Compilation of the attached file works fine in MS.NET VBC, but not in MBAS:
+
+' -------------------------------------------------------------------------
+-----
+'  &lt;autogenerated&gt;
+'      This code was generated by a tool.
+'      Mono Runtime Version: 1.1.4322.573
+' 
+'      Changes to this file may cause incorrect behavior and will be lost 
+if 
+'      the code is regenerated.
+'  &lt;/autogenerated&gt;
+' -------------------------------------------------------------------------
+-----
+
+Option Explicit Off
+Option Strict On
+
+Imports Microsoft.VisualBasic
+Imports System
+Imports System.Collections
+Imports System.Collections.Specialized
+Imports System.Configuration
+Imports System.Text
+Imports System.Text.RegularExpressions
+Imports System.Web
+Imports System.Web.Caching
+Imports System.Web.Security
+Imports System.Web.SessionState
+Imports System.Web.UI
+Imports System.Web.UI.WebControls
+Imports System.Web.UI.HtmlControls
+
+Namespace ASP
+    Public Class index_aspx
+        Inherits System.Web.UI.Page
+        Implements System.Web.SessionState.IRequiresSessionState
+
+        Private Shared __intialized As Boolean = False
+
+        Private Shared __autoHandlers As Integer
+
+        Public Sub New()
+            If ((ASP.index_aspx.__intialized = False)) Then
+                ASP.index_aspx.__intialized = True
+            End If
+        End Sub
+
+        Protected Overrides Property AutoHandlers As Integer
+            Get
+                Return ASP.index_aspx.__autoHandlers
+            End Get
+            Set (Value As Integer)
+                ASP.index_aspx.__autoHandlers = Value
+            End Set
+        End Property
+
+        Protected ReadOnly Property ApplicationInstance As 
+System.Web.HttpApplication
+            Get
+                Return CType(Me.Context.ApplicationInstance, 
+System.Web.HttpApplication)
+            End Get
+        End Property
+
+        Public Overrides ReadOnly Property TemplateSourceDirectory As 
+String
+            Get
+                Return &quot;/&quot;
+            End Get
+        End Property
+
+        Private Sub __RenderTree(__output As System.Web.UI.HtmlTextWriter, 
+parameterContainer As System.Web.UI.Control)
+            __output.Write(&quot;&lt;html&gt;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10)
+&amp;&quot;&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;&lt;/head&gt;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10)
+&amp;&quot;&lt;body&gt;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10))
+            __output.Write( &quot;&lt;h1&gt;Hello world&lt;/h1&gt;&quot; )
+            __output.Write(&quot;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10))
+            Response.Write (&quot;This is a running VB website :))&quot;)
+
+            __output.Write(&quot;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10)
+&amp;&quot;&lt;p&gt;End of test.&lt;/p&gt;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10)
+&amp;&quot;&lt;/body&gt;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10)
+&amp;&quot;&lt;/html&gt;&quot;&amp;Microsoft.VisualBasic.Strings.ChrW(10))
+        End Sub
+
+        Private Sub __BuildControlTree(__ctrl As System.Web.UI.Control)
+	 '*** Should be corrected in ASP.NET Runtime respectively 
+VBCogeGenerator to use AddressOf operator / JW/2004-06-03
+		'__ctrl.SetRenderMethodDelegate(New 
+System.Web.UI.RenderMethod(Me.__RenderTree))
+            __ctrl.SetRenderMethodDelegate(AddressOf Me.__RenderTree)
+        End Sub
+
+        Protected Overrides Sub FrameworkInitialize()
+            Me.TraceEnabled = True
+            Me.TraceModeValue = System.Web.TraceMode.SortByTime
+            Me.Request.ValidateInput()
+            Me.__BuildControlTree(Me)
+        End Sub
+
+        Public Overrides Function GetTypeHashCode() As Integer
+            Return 1821841690
+        End Function
+    End Class
+    'Why is the indentation not working correctly here? --&gt; see in 
+mcs/class/System/Micrisoft.VisualBasic/VBCodeGenerator.cs
+    'Indent=0
+    End Namespace
+    'Indent=-1
+
+
+
+One of the problems reside in line 42  (&quot;Protected Overrides Property 
+AutoHandlers As Integer&quot;) and not in line 52 as shown in the compiler 
+message:
+
+[<A HREF="mailto:root@lwezel">root@lwezel</A> wwwroot]# mbas 
+testsrc.vb.txt /r:Microsoft.VisualBasic.dll,System.dll,System.Web.dll,Syste
+m.Data.dll
+--------
+MonoBASIC: THIS IS STILL ALPHA AND UNSUPPORTED SOFTWARE, USE AT YOUR OWN 
+RISK.
+--------
+testsrc.vb.txt(52,0) error BC30284: `ASP.index_aspx.AutoHandlers' no 
+suitable properties found to override
+Compilation failed: 1 Error(s), 0 warnings
+[<A HREF="mailto:root@lwezel">root@lwezel</A> wwwroot]#
+
+
+I'd say, the property exists since in C# the ASP.NET generation is 
+successfull.
+
+As I've seen, a second problem is the missing support of the AddressOf 
+operator. But simply compile, you'll see...
+
+
+Steps to reproduce the problem:
+===============================
+1. Compile on MS.NET with P:\&gt;vbc 
+test.vb /r:Microsoft.VisualBasic.dll,System.dll,System.Web.dll,System.Data.
+dll /target:library
+2. Try the same with mbas and it will fail because of several problems

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016691.html">[Mono-bugs] [Bug 59470][Nor] Changed - Beta 2 build fails (missing -lintl)
</A></li>
	<LI> Next message: <A HREF="016693.html">[Mono-bugs] [Bug 59556][Nor] New - Wrong exception when allocating an array of a negative (or unsigned) size
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16692">[ date ]</a>
              <a href="thread.html#16692">[ thread ]</a>
              <a href="subject.html#16692">[ subject ]</a>
              <a href="author.html#16692">[ author ]</a>
         </LI>
       </UL>
</body></html>
