<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Moonlight-bugs] [Bug 607967] XmlSerializer: Error while serializing an object to XDocument\XmlWriter
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20607967%5D%20XmlSerializer%3A%20Error%20while%0A%20serializing%20an%20object%20to%20XDocument%5CXmlWriter&In-Reply-To=bug-607967-37086%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002330.html">
   <LINK REL="Next"  HREF="002332.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Moonlight-bugs] [Bug 607967] XmlSerializer: Error while serializing an object to XDocument\XmlWriter</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20607967%5D%20XmlSerializer%3A%20Error%20while%0A%20serializing%20an%20object%20to%20XDocument%5CXmlWriter&In-Reply-To=bug-607967-37086%40http.bugzilla.novell.com/"
       TITLE="[Moonlight-bugs] [Bug 607967] XmlSerializer: Error while serializing an object to XDocument\XmlWriter">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Jun 28 00:15:30 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002330.html">[Moonlight-bugs] Your Bugzilla bug list needs attention.
</A></li>
        <LI>Next message: <A HREF="002332.html">[Moonlight-bugs] [Bug 607967] XmlSerializer: Error while serializing an object to XDocument\XmlWriter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2331">[ date ]</a>
              <a href="thread.html#2331">[ thread ]</a>
              <a href="subject.html#2331">[ subject ]</a>
              <a href="author.html#2331">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=607967">http://bugzilla.novell.com/show_bug.cgi?id=607967</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=607967#c5">http://bugzilla.novell.com/show_bug.cgi?id=607967#c5</A>


--- Comment #5 from Andreia Gaita &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">avidigal at novell.com</A>&gt; 2010-06-28 04:15:28 UTC ---
Created an attachment (id=371996)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=371996">http://bugzilla.novell.com/attachment.cgi?id=371996</A>)
small repro source (moon)

The serialization1.tar.gz attachment contains a small repro that produces the
following stacktrace on moon:

Moonlight: Unhandled exception in Events.SafeDispatcher:
System.InvalidOperationException: There was an error generating the XML
document. ---&gt; System.NotSupportedException: Operation is not supported.
  at System.Xml.Linq.XNodeBuilder.get_WriteState () [0x00000] in &lt;filename
unknown&gt;:0 
  at System.Xml.Serialization.XmlSerializationWriter.WriteStartDocument ()
[0x00000] in &lt;filename unknown&gt;:0 
  at
Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriterList1.Write1_ArrayOfString
(System.Object o) [0x00000] in &lt;filename unknown&gt;:0 
  at (wrapper managed-to-native) System.Reflection.MonoMethod:InternalInvoke
(System.Reflection.MonoMethod*,object,object[],System.Exception&amp;)
  at System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags
invokeAttr, System.Reflection.Binder binder, System.Object[] parameters,
System.Globalization.CultureInfo culture) [0x000c0] in MonoMethod.cs:223 
  --- End of inner exception stack trace ---
  at System.Xml.Serialization.XmlSerializer.Serialize (System.Xml.XmlWriter
xmlWriter, System.Object o, System.Xml.Serialization.XmlSerializerNamespaces
namespaces, System.String encodingStyle, System.String id) [0x00000] in
&lt;filename unknown&gt;:0 
  at System.Xml.Serialization.XmlSerializer.Serialize (System.Xml.XmlWriter
xmlWriter, System.Object o, System.Xml.Serialization.XmlSerializerNamespaces
namespaces, System.String encodingStyle) [0x00000] in &lt;filename unknown&gt;:0 
  at System.Xml.Serialization.XmlSerializer.Serialize (System.Xml.XmlWriter
xmlWriter, System.Object o, System.Xml.Serialization.XmlSerializerNamespaces
namespaces) [0x00000] in &lt;filename unknown&gt;:0 
  at System.Xml.Serialization.XmlSerializer.Serialize (System.Xml.XmlWriter
xmlWriter, System.Object o) [0x00000] in &lt;filename unknown&gt;:0 
  at serialization1.Page.&lt;Page&gt;m__1 (System.Object ,
System.Windows.RoutedEventArgs ) [0x00032] in Page.xaml.cs:26 
  at System.Windows.Controls.Primitives.ButtonBase.OnClick () [0x00037] in
ButtonBase.cs:403 
  at System.Windows.Controls.Button.OnClick () [0x00000] in Button.cs:92 
  at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp
(System.Windows.Input.MouseButtonEventArgs e) [0x0005a] in ButtonBase.cs:768 

It looks like the sdk is dynamically generating an assembly to serialize data,
and it's calling WriteStarDocument, which calls the WriteState getter on
XNodeBuilder, which doesn't seem to be implemented, so this is probably not the
codepath it is expecting. Since the generated code expects WriteStartDocument
to Just Work(tm), it seems likely that their sys.xml has some internal
behaviour which wraps XmlWriter upon creation with some wrapper that implements
this in a way that the call always works.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002330.html">[Moonlight-bugs] Your Bugzilla bug list needs attention.
</A></li>
	<LI>Next message: <A HREF="002332.html">[Moonlight-bugs] [Bug 607967] XmlSerializer: Error while serializing an object to XDocument\XmlWriter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2331">[ date ]</a>
              <a href="thread.html#2331">[ thread ]</a>
              <a href="subject.html#2331">[ subject ]</a>
              <a href="author.html#2331">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">More information about the Moonlight-bugs
mailing list</a><br>
</body></html>
