<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Moonlight-bugs] [Bug 436060] New: Plugin leaking most	EventListenerProxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20436060%5D%20New%3A%20Plugin%20leaking%20most%0A%09EventListenerProxy&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000701.html">
   <LINK REL="Next"  HREF="000626.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Moonlight-bugs] [Bug 436060] New: Plugin leaking most	EventListenerProxy</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20436060%5D%20New%3A%20Plugin%20leaking%20most%0A%09EventListenerProxy&In-Reply-To="
       TITLE="[Moonlight-bugs] [Bug 436060] New: Plugin leaking most	EventListenerProxy">bugzilla_noreply at novell.com
       </A><BR>
    <I>Thu Oct 16 09:14:42 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000701.html">[Moonlight-bugs] [Bug 435912] Rewinding of a video does not work.
</A></li>
        <LI>Next message: <A HREF="000626.html">[Moonlight-bugs] [Bug 436060] Plugin leaking most EventListenerProxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#614">[ date ]</a>
              <a href="thread.html#614">[ thread ]</a>
              <a href="subject.html#614">[ subject ]</a>
              <a href="author.html#614">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=436060">https://bugzilla.novell.com/show_bug.cgi?id=436060</A>


           Summary: Plugin leaking most EventListenerProxy
           Product: Moonlight
           Version: SVN
          Platform: x86
        OS/Version: openSUSE 11.0
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: plugin
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">moonlight-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">spouliot at novell.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">moonlight-bugs at lists.ximian.com</A>
          Found By: ---


[this was discussed a while ago on IRC]

EventListenerProxy are created in two cases. The one for XAML events are freed
correctly (only one by events) but the other (e.g. added using javascript) are
not freed. 

I'm not sure if this should be re-written in a single case.


Parts of a Valgrind log showing the leaks

==30554== 51,157 (38,976 direct, 12,181 indirect) bytes in 812 blocks are
definitely lost in loss record 217 of 225
==30554==    at 0x402476E: operator new(unsigned) (in
/usr/lib/valgrind/x86-linux/vgpreload_memcheck.so)
==30554==    by 0x101CF21C: MoonlightDependencyObjectObject::Invoke(int, void*,
_NPVariant const*, unsigned, _NPVariant*) (plugin-class.cpp:2913)
==30554==    by 0x101CFCAD: MoonlightImageBrushObject::Invoke(int, void*,
_NPVariant const*, unsigned, _NPVariant*) (plugin-class.cpp:3537)
==30554==    by 0x101D406C: _ZL7_invokeP8NPObjectPvPK10_NPVariantjPS2_
(plugin-class.cpp:1752)
==30554==    by 0x4F43431:
_ZL20CallNPMethodInternalP9JSContextP8JSObjectjPlS3_i (nsJSNPRuntime.cpp:1378)
==30554==    by 0x470A08D: js_Invoke (jsinterp.c:1297)
==30554==    by 0x46FDE8B: js_Interpret (jsinterp.c:4857)
==30554==    by 0x470A0DC: js_Invoke (jsinterp.c:1313)
==30554==    by 0x46F8D11: fun_apply (jsfun.c:1678)
==30554==    by 0x46FDE4A: js_Interpret (jsinterp.c:4840)
==30554==    by 0x470A0DC: js_Invoke (jsinterp.c:1313)
==30554==    by 0x46F8D11: fun_apply (jsfun.c:1678)

==30554== 16,041 bytes in 950 blocks are indirectly lost in loss record 209 of
225
==30554==    at 0x4024D5E: malloc (in
/usr/lib/valgrind/x86-linux/vgpreload_memcheck.so)
==30554==    by 0x5845583: g_malloc (in /usr/lib/libglib-2.0.so.0.1600.3)
==30554==    by 0x585F4E8: g_strdup (in /usr/lib/libglib-2.0.so.0.1600.3)
==30554==    by 0x101CD556: EventListenerProxy::EventListenerProxy(_NPP*, char
const*, _NPVariant const*) (plugin-class.cpp:618)
==30554==    by 0x101CF24B: MoonlightDependencyObjectObject::Invoke(int, void*,
_NPVariant const*, unsigned, _NPVariant*) (plugin-class.cpp:2913)
==30554==    by 0x101D406C: _ZL7_invokeP8NPObjectPvPK10_NPVariantjPS2_
(plugin-class.cpp:1752)
==30554==    by 0x4F43431:
_ZL20CallNPMethodInternalP9JSContextP8JSObjectjPlS3_i (nsJSNPRuntime.cpp:1378)
==30554==    by 0x470A08D: js_Invoke (jsinterp.c:1297)
==30554==    by 0x46FDE8B: js_Interpret (jsinterp.c:4857)
==30554==    by 0x470A0DC: js_Invoke (jsinterp.c:1313)
==30554==    by 0x46F8D11: fun_apply (jsfun.c:1678)
==30554==    by 0x46FDE4A: js_Interpret (jsinterp.c:4840)


-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>
























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000701.html">[Moonlight-bugs] [Bug 435912] Rewinding of a video does not work.
</A></li>
	<LI>Next message: <A HREF="000626.html">[Moonlight-bugs] [Bug 436060] Plugin leaking most EventListenerProxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#614">[ date ]</a>
              <a href="thread.html#614">[ thread ]</a>
              <a href="subject.html#614">[ subject ]</a>
              <a href="author.html#614">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">More information about the Moonlight-bugs
mailing list</a><br>
</body></html>
