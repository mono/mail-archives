<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Moonlight-bugs] [Bug 637140] New: 2.99.0.8 - fails to reload ironRuby SL applet after refresh - MissingFieldException: Field 'IronRuby.Compiler.ParserStack`3._locations' not found
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20637140%5D%20New%3A%202.99.0.8%20-%20fails%20to%20reload%0A%20ironRuby%20SL%20applet%20after%20refresh%20-%20MissingFieldException%3A%20Field%0A%20%27IronRuby.Compiler.ParserStack%603._locations%27%20not%20found&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002428.html">
   <LINK REL="Next"  HREF="002430.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Moonlight-bugs] [Bug 637140] New: 2.99.0.8 - fails to reload ironRuby SL applet after refresh - MissingFieldException: Field 'IronRuby.Compiler.ParserStack`3._locations' not found</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20637140%5D%20New%3A%202.99.0.8%20-%20fails%20to%20reload%0A%20ironRuby%20SL%20applet%20after%20refresh%20-%20MissingFieldException%3A%20Field%0A%20%27IronRuby.Compiler.ParserStack%603._locations%27%20not%20found&In-Reply-To="
       TITLE="[Moonlight-bugs] [Bug 637140] New: 2.99.0.8 - fails to reload ironRuby SL applet after refresh - MissingFieldException: Field 'IronRuby.Compiler.ParserStack`3._locations' not found">bugzilla_noreply at novell.com
       </A><BR>
    <I>Fri Sep  3 18:08:46 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002428.html">[Moonlight-bugs] [Bug 637036] New: Moonlight does not work with	www.tkexe.tk
</A></li>
        <LI>Next message: <A HREF="002430.html">[Moonlight-bugs] Your Bugzilla bug list needs attention.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2429">[ date ]</a>
              <a href="thread.html#2429">[ thread ]</a>
              <a href="subject.html#2429">[ subject ]</a>
              <a href="author.html#2429">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=637140">https://bugzilla.novell.com/show_bug.cgi?id=637140</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=637140#c0">https://bugzilla.novell.com/show_bug.cgi?id=637140#c0</A>


           Summary: 2.99.0.8 - fails to reload ironRuby SL applet after
                    refresh - MissingFieldException: Field
                    'IronRuby.Compiler.ParserStack`3._locations' not found
    Classification: Mono
           Product: Moonlight
           Version: unspecified
          Platform: 64bit
        OS/Version: Ubuntu
            Status: NEW
          Severity: Normal
          Priority: P5 - None
         Component: plugin
        AssignedTo: <A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">moonlight-bugs at lists.ximian.com</A>
        ReportedBy: <A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">val at untweaked.com</A>
         QAContact: <A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">moonlight-bugs at lists.ximian.com</A>
          Found By: ---
           Blocker: ---


User-Agent:       Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.9)
Gecko/20100402 Ubuntu/9.10 (karmic) Firefox/3.5.9

Created a 'hello world' IronRuby SL3 app. The plugin loads fine initially, but
if I hit resfresh in the browser, it fails with:

MissingFieldException: Field 'IronRuby.Compiler.ParserStack`3._locations' not
found

MissingFieldException
  at IronRuby.Compiler.Parser.InitializeTables () [0x00000] in &lt;filename
unknown&gt;:0  
  at IronRuby.Compiler.Parser..ctor (Microsoft.Scripting.ErrorSink errorSink)
[0x00000] in &lt;filename unknown&gt;:0  
  at IronRuby.Compiler.Parser..ctor () [0x00000] in &lt;filename unknown&gt;:0  
  at IronRuby.Runtime.RubyContext.ParseSourceCode[Func`3]
(Microsoft.Scripting.SourceUnit sourceUnit,
IronRuby.Compiler.RubyCompilerOptions options, Microsoft.Scripting.ErrorSink
errorSink) [0x00000] in &lt;filename unknown&gt;:0 
  at IronRuby.Runtime.RubyContext.CompileSourceCode
(Microsoft.Scripting.SourceUnit sourceUnit, Microsoft.Scripting.CompilerOptions
options, Microsoft.Scripting.ErrorSink errorSink) [0x00000] in &lt;filename
unknown&gt;:0 
  at Microsoft.Scripting.SourceUnit.Compile
(Microsoft.Scripting.CompilerOptions options, Microsoft.Scripting.ErrorSink
errorSink) [0x00000] in &lt;filename unknown&gt;:0 
  at Microsoft.Scripting.SourceUnit.Execute (Microsoft.Scripting.Runtime.Scope
scope, Microsoft.Scripting.ErrorSink errorSink) [0x00000] in &lt;filename
unknown&gt;:0 
  at Microsoft.Scripting.SourceUnit.Execute (Microsoft.Scripting.Runtime.Scope
scope) [0x00000] in &lt;filename unknown&gt;:0  
  at Microsoft.Scripting.Hosting.ScriptSource.Execute
(Microsoft.Scripting.Hosting.ScriptScope scope) [0x00000] in &lt;filename
unknown&gt;:0  
  at Microsoft.Scripting.Silverlight.LanguageTypeExtensions.LoadByExtension
(System.String fileExtension) [0x00000] in &lt;filename unknown&gt;:0 
  at Microsoft.Scripting.Silverlight.LanguageTypeExtensions.Load
(Microsoft.Scripting.Silverlight.DynamicLanguageConfig langConfig) [0x00000] in
&lt;filename unknown&gt;:0 
  at
Microsoft.Scripting.Silverlight.DynamicApplication.&lt;DynamicApplication_Startup&gt;b__2
() [0x00000] in &lt;filename unknown&gt;:0  
  at
Microsoft.Scripting.Silverlight.DownloadCache+DownloadCacheDownloader.Download
(System.Collections.Generic.List`1 uris, System.Action onComplete) [0x00000] in
&lt;filename unknown&gt;:0 
  at Microsoft.Scripting.Silverlight.DownloadCache.Download
(System.Collections.Generic.List`1 uris, System.Action onComplete) [0x00000] in
&lt;filename unknown&gt;:0 
  at Microsoft.Scripting.Silverlight.HttpVirtualFilesystem.DownloadAndCache
(System.Collections.Generic.List`1 uris, System.Action onComplete) [0x00000] in
&lt;filename unknown&gt;:0 
  at Microsoft.Scripting.Silverlight.DynamicScriptTags.DownloadAndCache
(System.Collections.Generic.List`1 uris, System.Action onComplete) [0x00000] in
&lt;filename unknown&gt;:0 
  at Microsoft.Scripting.Silverlight.DynamicScriptTags.DownloadExternalCode
(System.Action onComplete) [0x00000] in &lt;filename unknown&gt;:0  
  at
Microsoft.Scripting.Silverlight.DynamicApplication.&lt;DynamicApplication_Startup&gt;b__1
() [0x00000] in &lt;filename unknown&gt;:0  
  at Microsoft.Scripting.Silverlight.DynamicLanguageConfig.DownloadLanguages
(Microsoft.Scripting.Silverlight.DynamicAppManifest appManifest, System.Action
onComplete) [0x00000] in &lt;filename unknown&gt;:0 
  at
Microsoft.Scripting.Silverlight.DynamicApplication.&lt;DynamicApplication_Startup&gt;b__0
() [0x00000] in &lt;filename unknown&gt;:0  
  at
Microsoft.Scripting.Silverlight.DownloadCache+DownloadCacheDownloader.InternalDownloadComplete
(System.Uri uri, System.Action onComplete) [0x00000] in &lt;filename unknown&gt;:0 
  at
Microsoft.Scripting.Silverlight.DownloadCache+DownloadCacheDownloader.DownloadComplete
(System.Uri uri, System.Byte[] content, System.Action onComplete) [0x00000] in
&lt;filename unknown&gt;:0 
  at
Microsoft.Scripting.Silverlight.DownloadCache+DownloadCacheDownloader.DownloadComplete
(System.Uri uri, System.IO.Stream content, System.Action onComplete) [0x00000]
in &lt;filename unknown&gt;:0 
  at
Microsoft.Scripting.Silverlight.DownloadCache+DownloadCacheDownloader+&lt;&gt;c__DisplayClass5.&lt;DownloadWithWebClient&gt;b__4
(System.Object s, System.Net.OpenReadCompletedEventArgs e) [0x00000] in
&lt;filename unknown&gt;:0 
  at System.Net.WebClient.OnOpenReadCompleted
(System.Net.OpenReadCompletedEventArgs args) [0x00000] in &lt;filename unknown&gt;:0  
  at System.Net.WebClient+&lt;OpenReadAsyncCallback&gt;c__AnonStorey3.&lt;&gt;m__6
(System.Object sender) [0x00000] in &lt;filename unknown&gt;:0  
  at System.Windows.Threading.Dispatcher.InvokeDelegate (System.Delegate d,
System.Object[] args) [0x00000] in &lt;filename unknown&gt;:0  
  at System.Windows.Threading.Dispatcher+&lt;Invoke&gt;c__AnonStorey3B.&lt;&gt;m__85 ()
[0x00000] in &lt;filename unknown&gt;:0 

I compared this with SL running on Windows/IE, and the problem did not show.
Closing the browser and reopening the applet solves the problem.

It is possible it is an IronRuby issue, but on the other hand, it does work on
Windows.



Reproducible: Always

Steps to Reproduce:
1. Install Moonlight 2.99.0.8 in either FF or Chrome on Ubuntu 10, 64-bit
2. On windows, download the ironruby package and create a SL plugin.

<A HREF="http://ironruby.codeplex.com/releases/view/43540#DownloadId=133276">http://ironruby.codeplex.com/releases/view/43540#DownloadId=133276</A>

3. I followed this tutorial:

<A HREF="http://www.switchonthecode.com/tutorials/getting-started-with-ironruby-and-silverlight">http://www.switchonthecode.com/tutorials/getting-started-with-ironruby-and-silverlight</A>

3a. Unpack the ironruby distro
3b. create a sample hello world plugin (&quot;script\sl.bat ruby MyTestApp&quot;, see
article)
3c. expose the directory via a web server

4. browse to the page via a webbrowser from linux. Plugin displays correctly,
and ruby console is active.
5. hit refresh



Actual Results:  
After pressing refresh, the error and stack trace above is displayed (stack
trace is black on black for some reason, so use the mouse to highlight it)


Expected Results:  
Plugin should reload ok.


Linux FF 3.5.9 - Fail
Linux Chrome 6.0.472.3 - Fail
Windows IE / MS SL Plugin - Pass

Note that I didn't modify the code at all, this is code generated from the
sl.bat script.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002428.html">[Moonlight-bugs] [Bug 637036] New: Moonlight does not work with	www.tkexe.tk
</A></li>
	<LI>Next message: <A HREF="002430.html">[Moonlight-bugs] Your Bugzilla bug list needs attention.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2429">[ date ]</a>
              <a href="thread.html#2429">[ thread ]</a>
              <a href="subject.html#2429">[ subject ]</a>
              <a href="author.html#2429">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">More information about the Moonlight-bugs
mailing list</a><br>
</body></html>
