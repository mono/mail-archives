<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Moonlight-bugs] [Bug 535709] My Silverlight chess board throws NRE when clicking buttons
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20535709%5D%20My%20Silverlight%20chess%20board%20throws%20NRE%0A%20when%20clicking%20buttons&In-Reply-To=bug-535709-37086%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001823.html">
   <LINK REL="Next"  HREF="001827.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Moonlight-bugs] [Bug 535709] My Silverlight chess board throws NRE when clicking buttons</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20535709%5D%20My%20Silverlight%20chess%20board%20throws%20NRE%0A%20when%20clicking%20buttons&In-Reply-To=bug-535709-37086%40http.bugzilla.novell.com/"
       TITLE="[Moonlight-bugs] [Bug 535709] My Silverlight chess board throws NRE when clicking buttons">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Dec 21 10:08:17 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001823.html">[Moonlight-bugs] [Bug 544214] &quot;Waiting for video&quot; - Moonlight 1.99.5 malfunctioning when both VLC (mozilla-plugin-vlc) and Totem (totem-mozilla) browser plugins are installed
</A></li>
        <LI>Next message: <A HREF="001827.html">[Moonlight-bugs] [Bug 566425] New: Moonlight Codecs Installer licence text is illegible due to wrong colours
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1826">[ date ]</a>
              <a href="thread.html#1826">[ thread ]</a>
              <a href="subject.html#1826">[ subject ]</a>
              <a href="author.html#1826">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://bugzilla.novell.com/show_bug.cgi?id=535709">http://bugzilla.novell.com/show_bug.cgi?id=535709</A>

<A HREF="http://bugzilla.novell.com/show_bug.cgi?id=535709#c2">http://bugzilla.novell.com/show_bug.cgi?id=535709#c2</A>


Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">spouliot at novell.com</A>&gt; changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
            Version|1.99.1                      |2.0.x

--- Comment #2 from Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">spouliot at novell.com</A>&gt; 2009-12-21 15:08:14 UTC ---
Here's what I get in GDB

(gdb) bt
#0  0x0000000040b95363 in SilverBoard.BoardControl:AddSquare
(this=@0x7fc18d02fe00, squareSize=50, file=6, rank=3, square=&lt;value optimized
out&gt;, fontPiece=110, color=-16777216, z=2) at xdb.il:6546
#1  0x0000000040b95060 in SilverBoard.BoardControl:AddSquare
(this=@0x7fc18d02fe00, squareSize=50, file=6, rank=3, square=WhiteKnight) at
xdb.il:6468
#2  0x0000000040b94100 in SilverBoard.BoardControl:.ctor (this=@0x7fc18d02fe00,
board=@0x7fc18d8549f0, squareSize=50, iterator=@0x7fc18d69d310, turned=false,
arrows=true, lightSquareColor=-12642, 
    darkSquareColor=-3044537) at xdb.il:6134
#3  0x0000000040b9385c in SilverBoard.Page:PaintBoard (this=@0x7fc18db97e00) at
xdb.il:5956
#4  0x0000000044855464 in SilverBoard.Page:forward_Click (this=@0x7fc18db97e00,
sender=&lt;value optimized out&gt;, e=&lt;value optimized out&gt;) at xdb.il:13985
#5  0x00000000448552a0 in System.Windows.Controls.Primitives.ButtonBase:OnClick
(this=@0x7fc18d9caa00)
    at
/home/poupou/svn/moon-2-0/moon/class/Microsoft.SilverlightControls/RuntimeControls/SilverlightControls/Primitives/ButtonBase.cs:323
#6  0x0000000044855220 in System.Windows.Controls.Button:OnClick
(this=@0x7fc18d9caa00) at
/home/poupou/svn/moon-2-0/moon/class/Microsoft.SilverlightControls/RuntimeControls/SilverlightControls/Button.cs:92
#7  0x0000000044855173 in
System.Windows.Controls.Primitives.ButtonBase:OnMouseLeftButtonUp
(this=@0x7fc18d9caa00, e=@0x7fc18d2d3a80)
    at
/home/poupou/svn/moon-2-0/moon/class/Microsoft.SilverlightControls/RuntimeControls/SilverlightControls/Primitives/ButtonBase.cs:686
#8  0x000000004485506b in
System.Windows.Controls.Control:&lt;on_mouse_left_button_up&gt;m__38 (target=&lt;value
optimized out&gt;, calldata=11997744, closure=65847936)
    at
/home/poupou/svn/moon-2-0/moon/class/System.Windows/System.Windows.Controls/Control.cs:131
#9  0x0000000040b80408 in
Mono.Events/&lt;SafeDispatcher&gt;c__AnonStorey1/&lt;SafeDispatcher&gt;c__AnonStorey2:&lt;&gt;m__15
(this=@0x7fc18d2d3ab0)
#10 0x0000000040b802ef in Mono.Events:SafeAction (action=@0x7fc18c8788f0) at
/home/poupou/svn/moon-2-0/moon/class/System.Windows/Mono/Events.cs:52
#11 0x0000000040b802b4 in Mono.Events/&lt;SafeDispatcher&gt;c__AnonStorey1:&lt;&gt;m__3
(this=@0x7fc18db32570, sender=65847936, calldata=11997744, closure=65847936)
#12 0x00007fc18dafcf85 in (wrapper native-to-managed)
Mono.Events/&lt;SafeDispatcher&gt;c__AnonStorey1:&lt;&gt;m__3 (param0=65847936,
param1=11997744, param2=65847936) at xdb.il:3780
#13 0x00007fc18f0b01e3 in EventObject::DoEmit (this=0x3ecc280, event_id=12,
calldata=0xb71230) at dependencyobject.cpp:1147
#14 0x00007fc18f171df1 in Surface::EmitEventOnList (this=0x30b0610,
event_id=12, element_list=0x6c6ec60, event=0x4e711e0, end_idx=3) at
runtime.cpp:1417
#15 0x00007fc18f172f84 in Surface::HandleMouseEvent (this=0x30b0610,
event_id=12, emit_leave=true, emit_enter=true, force_emit=true,
event=0x4e711e0) at runtime.cpp:1532
#16 0x00007fc18f173bff in Surface::HandleUIButtonRelease (this=0x30b0610,
event=0x4e71170) at runtime.cpp:1895
#17 0x00007fc18f1ca630 in MoonWindowGtk::button_release (widget=0x2eea340,
event=0x4e71170, data=0x30b04b0) at window-gtk.cpp:451
#18 0x00007fc1a0c5e998 in _gtk_marshal_BOOLEAN__BOXED (closure=0x3450280,
return_value=0x7fffaed41a10, n_param_values=&lt;value optimized out&gt;,
param_values=0x7fffaed41ac0, 
    invocation_hint=&lt;value optimized out&gt;, marshal_data=0x7fc18f1ca5de) at
gtkmarshalers.c:84
#19 0x00007fc1a1d0620d in g_closure_invoke () from
/usr/lib64/libgobject-2.0.so.0
#20 0x00007fc1a1d1a08c in ?? () from /usr/lib64/libgobject-2.0.so.0
#21 0x00007fc1a1d1b392 in g_signal_emit_valist () from
/usr/lib64/libgobject-2.0.so.0
#22 0x00007fc1a1d1ba53 in g_signal_emit () from /usr/lib64/libgobject-2.0.so.0
#23 0x00007fc1a0d73a8e in gtk_widget_event_internal (widget=0x2eea340,
event=0x4e71170) at gtkwidget.c:4678
#24 0x00007fc1a0c57513 in IA__gtk_propagate_event (widget=0x2eea340,
event=0x4e71170) at gtkmain.c:2337
#25 0x00007fc1a0c5855b in IA__gtk_main_do_event (event=0x4e71170) at
gtkmain.c:1557
#26 0x00007fc1a06972ac in gdk_event_dispatch (source=&lt;value optimized out&gt;,
callback=&lt;value optimized out&gt;, user_data=&lt;value optimized out&gt;) at
gdkevents-x11.c:2352
#27 0x00007fc1a186c95a in g_main_context_dispatch () from
/usr/lib64/libglib-2.0.so.0
#28 0x00007fc1a1870060 in ?? () from /usr/lib64/libglib-2.0.so.0
#29 0x00007fc1a18701fc in g_main_context_iteration () from
/usr/lib64/libglib-2.0.so.0
#30 0x00007fc1a4806d1d in ?? () from /usr/lib64/xulrunner-1.9.0.14/libxul.so
#31 0x00007fc1a4806e6b in ?? () from /usr/lib64/xulrunner-1.9.0.14/libxul.so
#32 0x00007fc1a48af22d in ?? () from /usr/lib64/xulrunner-1.9.0.14/libxul.so
#33 0x00007fc1a48842e2 in ?? () from /usr/lib64/xulrunner-1.9.0.14/libxul.so
#34 0x00007fc1a4806f89 in ?? () from /usr/lib64/xulrunner-1.9.0.14/libxul.so
#35 0x00007fc1a46e626d in ?? () from /usr/lib64/xulrunner-1.9.0.14/libxul.so
#36 0x00007fc1a4163b21 in XRE_main () from
/usr/lib64/xulrunner-1.9.0.14/libxul.so
#37 0x00000000004016e4 in ?? ()
#38 0x00007fc1a5c56436 in __libc_start_main () from /lib64/libc.so.6
#39 0x00000000004011e9 in ?? ()
#40 0x00007fffaed45ad8 in ?? ()
#41 0x000000000000001c in ?? ()
#42 0x0000000000000005 in ?? ()
#43 0x00007fffaed471d7 in ?? ()
#44 0x00007fffaed4720a in ?? ()
#45 0x0000000000000000 in ?? ()

The xdb.il:6546 IL source looks like:
IL_00b2: ldstr     &quot;MERIFONT.TTF&quot;
IL_00b7: ldc.i4.2  
IL_00b8: newobj    &lt;System.Uri:.ctor (string,System.UriKind)&gt;
IL_00bd: stloc.1   
IL_00be: ldloc.1   
*IL_00bf: call      &lt;System.Windows.Application:GetResourceStream (System.Uri)&gt;
IL_00c4: callvirt  &lt;System.Windows.Resources.StreamResourceInfo:get_Stream ()&gt;

So my guess is that repetitive loading of the font is the issue, i.e. at some
point you receive a NULL StreamResourceInfo from GetResourceStream and this
cause the NRE.

Could you confirm this ? e.g. with a custom build that reports the NULL

I'll continue looking at this using the above assumption.

-- 
Configure bugmail: <A HREF="http://bugzilla.novell.com/userprefs.cgi?tab=email">http://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001823.html">[Moonlight-bugs] [Bug 544214] &quot;Waiting for video&quot; - Moonlight 1.99.5 malfunctioning when both VLC (mozilla-plugin-vlc) and Totem (totem-mozilla) browser plugins are installed
</A></li>
	<LI>Next message: <A HREF="001827.html">[Moonlight-bugs] [Bug 566425] New: Moonlight Codecs Installer licence text is illegible due to wrong colours
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1826">[ date ]</a>
              <a href="thread.html#1826">[ thread ]</a>
              <a href="subject.html#1826">[ subject ]</a>
              <a href="author.html#1826">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">More information about the Moonlight-bugs
mailing list</a><br>
</body></html>
