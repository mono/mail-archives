<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Moonlight-bugs] [Bug 660293] Converter for List&lt;&gt; property doesn't	like new list
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20660293%5D%20Converter%20for%20List%3C%3E%20property%20doesn%27t%0A%09like%20new%20list&In-Reply-To=bug-660293-37086%40http.bugzilla.novell.com/">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002742.html">
   <LINK REL="Next"  HREF="002744.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Moonlight-bugs] [Bug 660293] Converter for List&lt;&gt; property doesn't	like new list</H1>
    <B>bugzilla_noreply at novell.com</B> 
    <A HREF="mailto:moonlight-bugs%40lists.ximian.com?Subject=%5BMoonlight-bugs%5D%20%5BBug%20660293%5D%20Converter%20for%20List%3C%3E%20property%20doesn%27t%0A%09like%20new%20list&In-Reply-To=bug-660293-37086%40http.bugzilla.novell.com/"
       TITLE="[Moonlight-bugs] [Bug 660293] Converter for List&lt;&gt; property doesn't	like new list">bugzilla_noreply at novell.com
       </A><BR>
    <I>Mon Jan  3 12:03:08 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002742.html">[Moonlight-bugs] [Bug 624533] universalsports.com videos get stuck	(regression)
</A></li>
        <LI>Next message: <A HREF="002744.html">[Moonlight-bugs] [Bug 375236] [performance] Cairo Tesselator is	slow with huge paths
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2743">[ date ]</a>
              <a href="thread.html#2743">[ thread ]</a>
              <a href="subject.html#2743">[ subject ]</a>
              <a href="author.html#2743">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=660293">https://bugzilla.novell.com/show_bug.cgi?id=660293</A>

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=660293#c2">https://bugzilla.novell.com/show_bug.cgi?id=660293#c2</A>


--- Comment #2 from Rui Craveiro &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">rui at ruicraveiro.com</A>&gt; 2011-01-03 17:03:07 UTC ---
Created an attachment (id=406766)
 --&gt; (<A HREF="http://bugzilla.novell.com/attachment.cgi?id=406766">http://bugzilla.novell.com/attachment.cgi?id=406766</A>)
More behavioural aspects Demo

Hi,

I am attaching a demo of some extra findings I made concerning this bug. I
recall that the problem is to have a converter that creates a new list instead
of manipulating the given one and returning that instance. My first approach
for a workaround was to simply manipulate the given list instead of creating a
new one. My customer rejected that approach stating it was not valid due their
intended architecture. So, I set out to investigate things further.

I found out two things:

- For some reason, the converter is being called multiple times for the same
control, while in SL, it is called a single time. This is demonstrated in the
demo I'm attaching by using a messagebox in the converter's code.

- The other thing I found is that if under the successive call to the
converter, it returns the same instance, then the final behaviour (the selected
element) will be the correct one. Well, since the original code of the
converter is creating a new instance of a list, each time it is called, it is
returning a different instance as a result. This is coherent with my first
approach of returning the source list instead of creating a new one. The
returned instance is always the same. You can see this in line
<A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">1720 at dependencyobject.cpp</A>:

  equal = !property-&gt;AlwaysChange() &amp;&amp; (*current_value == *value);
/* the == operator is overloaded in <A HREF="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">870 at value.cpp.</A> */

This information was sufficient for me to try a different approach to the
workaround. I do create a new list indeed, but cache it to a dictionary using
the input to the converter as the key. On a repeated call to the converter for
the same input, I am simply returning again the previously created list,
instead of creating a new one. This seems to work.

I would say however, that the repetitive call to the converter is in itself a
bug as it represents a different behaviour from SL and can introduce other
unexpected side effects under different scenarios.

Hope this information helps.

-- 
Configure bugmail: <A HREF="https://bugzilla.novell.com/userprefs.cgi?tab=email">https://bugzilla.novell.com/userprefs.cgi?tab=email</A>
------- You are receiving this mail because: -------
You are the QA contact for the bug.
You are the assignee for the bug.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002742.html">[Moonlight-bugs] [Bug 624533] universalsports.com videos get stuck	(regression)
</A></li>
	<LI>Next message: <A HREF="002744.html">[Moonlight-bugs] [Bug 375236] [performance] Cairo Tesselator is	slow with huge paths
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2743">[ date ]</a>
              <a href="thread.html#2743">[ thread ]</a>
              <a href="subject.html#2743">[ subject ]</a>
              <a href="author.html#2743">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/moonlight-bugs">More information about the Moonlight-bugs
mailing list</a><br>
</body></html>
