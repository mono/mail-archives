<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-devel] Glade Binding Framework
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:glade-devel%40lists.ximian.com?Subject=%5BGlade-devel%5D%20Glade%20Binding%20Framework&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001475.html">
   <LINK REL="Next"  HREF="001483.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-devel] Glade Binding Framework</H1>
    <B>Juan Pablo Ugarte</B> 
    <A HREF="mailto:glade-devel%40lists.ximian.com?Subject=%5BGlade-devel%5D%20Glade%20Binding%20Framework&In-Reply-To="
       TITLE="[Glade-devel] Glade Binding Framework">juanpablougarte at gmail.com
       </A><BR>
    <I>Thu Mar  8 15:32:17 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001475.html">[Glade-devel] Glade branched for gnome 2.18
</A></li>
        <LI>Next message: <A HREF="001483.html">[Glade-devel] Glade Binding Framework
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1476">[ date ]</a>
              <a href="thread.html#1476">[ thread ]</a>
              <a href="subject.html#1476">[ subject ]</a>
              <a href="author.html#1476">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There you go, This is a draft i would like to include in the binding
directory and use it as a base for the documentation.

Please ask as many question you like!

glade rules!

Juan Pablo
-------------- next part --------------
GladeBindings plugins are to add support for differents interpreted languages such as python and perl.

Support is divided in two things: catalog support and script support.

The bindings modules provides these functionalities to the core trough a couple of obligatory functions.

GladeBindingInitFunc
	called after loading the binding plugin (initialize the language's interpreter)

GladeBindingFinalizeFunc
	called after unloading the binding plugin. should freed everything allocated by the init function

GladeBindingLibraryLoadFunc
	used to load a library written in the language that is supported by the binding

GladeBindingRunScriptFunc
	optionally to add scripting support.

Catalog Support:
the ability to load a widget library and its support code plugin written in other language than C.

First we need to specify the catalog's language (language=&quot;GladeBinding plugin name&quot;)
then for each widget class that needs support code we setup an adaptor class name (GladeWidgetAdaptor)
which has to be registered in the GType system when the library is loaded.

-- pythontest.xml

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;glade-catalog name=&quot;pythontest&quot; library=&quot;pythontest&quot; domain=&quot;glade-3&quot; depends=&quot;gtk+&quot; language=&quot;python&quot;&gt;
	&lt;glade-widget-classes&gt;
		&lt;glade-widget-class title=&quot;MyBox&quot; name=&quot;MyBox&quot; generic-name=&quot;mybox&quot; adaptor=&quot;GladeMyBoxAdaptor&quot;/&gt;
	&lt;/glade-widget-classes&gt;
	&lt;glade-widget-group name=&quot;python&quot; title=&quot;Python&quot;&gt;
    	&lt;glade-widget-class-ref name=&quot;MyBox&quot;/&gt;
	&lt;/glade-widget-group&gt;
&lt;/glade-catalog&gt;

When the core find this catalog it will try to find a GladeBinding called &quot;python&quot; if it does it will load
the library &quot;pythontest&quot; calling GladeBindingLibraryLoadFunc function.

Luckily Python's gtk binding registers GTypes when importing a module.(Name is specified by __gtype_name__ variable)

-- pythontest.py

import gtk
import gobject
import glade

class GladeMyBoxAdaptor(glade.get_adaptor_for_type ('GtkHBox')):
        __gtype_name__ = 'GladeMyBoxAdaptor'
        def __init__(self):
                glade.GladeGtkHBoxAdaptor.__init__(self)
        def do_post_create(self, obj, reason):
                print &quot;Hello Monty world!\n&quot;;
        def do_child_set_property(self, container, child, property_name, value):
                glade.GladeGtkHBoxAdaptor.do_child_set_property(self,container, child, property_name, value);
                print &quot;Hello do_child_set_property\n&quot;;
        def do_child_get_property(self, container, child, property_name):
                a = glade.GladeGtkHBoxAdaptor.do_child_get_property(self,container, child, property_name);
                print &quot;Hello do_child_get_property\n&quot;;
                return a;
        def do_get_children(self, container):
                a = glade.GladeGtkHBoxAdaptor.do_get_children(self, container);
                print &quot;Hello do_get_children\n&quot;;
                return a;

class MyBox(gtk.HBox):
        __gtype_name__ = 'MyBox'
        def __init__(self):
                gtk.HBox.__init__(self)

Scripts:

The core will search for script in two different directories,
datadir/package/scripts/ and g_get_user_config_dir()/package/scripts/

The hierarchy in those directories should be binding_name/gtype_name/ *
For example if you want to add a python script to GtkContainers you can do it by
installing the script file in g_get_user_config_dir()/glade3/scripts/python/GtkContainer/Delete_Children.py
This will add a context menu item called &quot;Delete Children&quot; for any GtkContainer 
that will trigger GtkContainer's widget adaptor &quot;action-activated::Delete_Children&quot; signal.
This signal is used by the core to call glade_binding_run_script()

The GladeBinding has to provide a set of useful functions to be used in the scripts.

Command list:
	undo: Execute undo command.
	redo: Execute redo command.
	project_new: Create a new project.
	project_open: Open an existing project.
	project_save: Save the current project.
	project_close: Close the current project.
	project_get: Get the current project.
	project_set: Set the current project.
	project_list: List all projects.
	widget_new: Create a new GtkWidget.
	widget_delete: Delete a GtkWidget.
	widget_set: Set a GtkWidget's property.
	widget_get: Get a GtkWidget's property.
	widget_list: List all widgets.

GladeBinding TODO:

	* Support every GNOME Platform Bindings (<A HREF="http://gtk.org/bindings.html">http://gtk.org/bindings.html</A>)

	* Perl: do some research to find out if perl gtk binding makes an actual gobject 
	  when creating a perl object derived from a gobject wrapper,
	  and if it does wel.. write a GladeBinding!

	* Java: see <A HREF="http://sablevm.org">http://sablevm.org</A> we might be able to use that jvm to run java widgets
	  (<A HREF="http://java-gnome.sourceforge.net/">http://java-gnome.sourceforge.net/</A>)

Python binding TODO:
	* rename glade module to gladeui to avoid possible naming conflicts with libglade
	* add gladeui widgets wrappers (Palette, Inspector, etc)
	* review command list, are those command enough to use in a script?
	* find out a way to provide translations for script names!
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001475.html">[Glade-devel] Glade branched for gnome 2.18
</A></li>
	<LI>Next message: <A HREF="001483.html">[Glade-devel] Glade Binding Framework
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1476">[ date ]</a>
              <a href="thread.html#1476">[ thread ]</a>
              <a href="subject.html#1476">[ subject ]</a>
              <a href="author.html#1476">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/glade-devel">More information about the Glade-devel
mailing list</a><br>
</body></html>
