Index: src/glade-widget.c
===================================================================
RCS file: /cvs/gnome/glade3/src/glade-widget.c,v
retrieving revision 1.153
diff -u -r1.153 glade-widget.c
--- src/glade-widget.c	15 Jan 2006 21:14:56 -0000	1.153
+++ src/glade-widget.c	17 Jan 2006 11:28:29 -0000
@@ -1822,12 +1822,16 @@
 glade_widget_retrieve_from_position (GtkWidget *base, int x, int y)
 {
 	GtkWidget *toplevel_widget;
+	GtkWidget *next_widget;
 	gint top_x;
 	gint top_y;
 	
-	toplevel_widget = gtk_widget_get_toplevel (base);
-	if (!GTK_WIDGET_TOPLEVEL (toplevel_widget))
-		return NULL;
+	next_widget = base;
+	toplevel_widget = base;
+	while (next_widget && glade_widget_get_from_gobject (next_widget)) {
+		toplevel_widget = next_widget;
+		next_widget = gtk_widget_get_parent (next_widget);
+	}
 
 	gtk_widget_translate_coordinates (base, toplevel_widget, x, y, &top_x, &top_y);
 	return glade_widget_find_deepest_child_at_position
