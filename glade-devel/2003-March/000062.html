<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-devel] [patch, glade3] add menu tips displayed in the status bar
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:pborelli%40katamail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000064.html">
   <LINK REL="Next"  HREF="000063.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-devel] [patch, glade3] add menu tips displayed in the status bar
   </H1>
    <B>paolo borelli
    </B> 
    <A HREF="mailto:pborelli%40katamail.com"
       TITLE="[Glade-devel] [patch, glade3] add menu tips displayed in the status bar">pborelli@katamail.com
       </A><BR>
    <I>21 Mar 2003 19:00:18 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="000064.html">[Glade-devel] Re: Toolbox widget for libegg
</A></li>
        <LI> Next message: <A HREF="000063.html">[Glade-devel] glade 1.1.3 fails to build with the latest libgnomedb2 (0.11.0)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62">[ date ]</a>
              <a href="thread.html#62">[ thread ]</a>
              <a href="subject.html#62">[ subject ]</a>
              <a href="author.html#62">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-ahOe7YOkEgf5f1+/K7Kf
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hi!

The attached patch shows tips for menu items in the recently introduced
statusbar. Since I didn't find any examples on how to do it, I had to
figure out by myself, so maybe there is a better method! I appreciate
any suggestion.

While at it I also added undo/redo to the toolbar as suggested by
Joaquin.

ciao
	paolo



--=-ahOe7YOkEgf5f1+/K7Kf
Content-Disposition: attachment; filename=menu_tips.patch
Content-Type: text/x-patch; name=menu_tips.patch; charset=UTF-8
Content-Transfer-Encoding: 7bit

diff -pur gnome2/glade3/ChangeLog glade3/ChangeLog
--- gnome2/glade3/ChangeLog	2003-03-21 12:54:27.000000000 +0100
+++ glade3/ChangeLog	2003-03-21 16:17:23.000000000 +0100
@@ -1,3 +1,8 @@
+2003-03-21 Paolo Borelli &lt;<A HREF="mailto:pborelli@katamail.com">pborelli@katamail.com</A>&gt;
+
+	* src/glade-project-window.c: show menu tips in the statusbar
+	* src/glade-project-window.c: add undo/redo to the toolbar
+
 2003-03-20  Joaquin Cuenca Abela  &lt;<A HREF="mailto:e98cuenc@yahoo.com">e98cuenc@yahoo.com</A>&gt;
 
 	* src/glade-keys-dialog.[ch]: Dialog box that appears when the user
diff -pur gnome2/glade3/src/glade-project-window.c glade3/src/glade-project-window.c
--- gnome2/glade3/src/glade-project-window.c	2003-03-21 12:54:52.000000000 +0100
+++ glade3/src/glade-project-window.c	2003-03-21 16:13:27.000000000 +0100
@@ -188,51 +188,95 @@ gpw_redo_cb (void)
 	glade_command_redo ();
 }
 
-
 static GtkItemFactoryEntry menu_items[] =
 {
-  /* ============ FILE ===================== */
-  { &quot;/_File&quot;,            NULL,         0,              0, &quot;&lt;Branch&gt;&quot; },
-  { &quot;/File/_New&quot;,        &quot;&lt;control&gt;N&quot;,        gpw_new_cb,     0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_NEW },
-  { &quot;/File/_Open&quot;,       &quot;&lt;control&gt;O&quot;,        gpw_open_cb,    0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_OPEN },
+  /* ============ FILE ============ */
+  { &quot;/_File&quot;, NULL, 0, 0, &quot;&lt;Branch&gt;&quot; },
+  { &quot;/File/_New&quot;,        &quot;&lt;control&gt;N&quot;,        gpw_new_cb,     1, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_NEW },
+  { &quot;/File/_Open&quot;,       &quot;&lt;control&gt;O&quot;,        gpw_open_cb,    2, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_OPEN },
   { &quot;/File/sep1&quot;,        NULL,                NULL,           0, &quot;&lt;Separator&gt;&quot; },
-  { &quot;/File/_Save&quot;,       &quot;&lt;control&gt;S&quot;,        gpw_save_cb,    0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_SAVE },
-  { &quot;/File/Save _As...&quot;, &quot;&lt;control&gt;&lt;shift&gt;S&quot;, gpw_save_as_cb, 0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_SAVE_AS },
+  { &quot;/File/_Save&quot;,       &quot;&lt;control&gt;S&quot;,        gpw_save_cb,    3, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_SAVE },
+  { &quot;/File/Save _As...&quot;, &quot;&lt;control&gt;&lt;shift&gt;S&quot;, gpw_save_as_cb, 4, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_SAVE_AS },
   { &quot;/File/sep2&quot;,        NULL,                NULL,           0, &quot;&lt;Separator&gt;&quot; },
-  { &quot;/File/_Quit&quot;,       &quot;&lt;control&gt;Q&quot;,        gpw_quit_cb,    0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_QUIT },
-
+  { &quot;/File/_Quit&quot;,       &quot;&lt;control&gt;Q&quot;,        gpw_quit_cb,    5, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_QUIT },
 
-  /* ============ EDIT ===================== */
-  { &quot;/Edit&quot;,        NULL, 0, 0, &quot;&lt;Branch&gt;&quot; },
-  { &quot;/Edit/_Undo&quot;,   &quot;&lt;control&gt;Z&quot;, gpw_undo_cb,   0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_UNDO },
-  { &quot;/Edit/_Redo&quot;,   &quot;&lt;control&gt;R&quot;, gpw_redo_cb,   0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_REDO },
-  { &quot;/Edit/sep1&quot;,    NULL,         NULL,          0, &quot;&lt;Separator&gt;&quot; },
-  { &quot;/Edit/C_ut&quot;,    NULL,         gpw_cut_cb,    0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_CUT },
-  { &quot;/Edit/_Copy&quot;,   NULL,         gpw_copy_cb,   0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_COPY },
-  { &quot;/Edit/_Paste&quot;,  NULL,         gpw_paste_cb,  0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_PASTE },
-  { &quot;/Edit/_Delete&quot;, &quot;Delete&quot;,     gpw_delete_cb, 0, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_DELETE },
+  /* ============ EDIT ============ */
+  { &quot;/Edit&quot;, NULL, 0, 0, &quot;&lt;Branch&gt;&quot; },
+  { &quot;/Edit/_Undo&quot;,   &quot;&lt;control&gt;Z&quot;, gpw_undo_cb,    6, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_UNDO },
+  { &quot;/Edit/_Redo&quot;,   &quot;&lt;control&gt;R&quot;, gpw_redo_cb,    7, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_REDO },
+  { &quot;/Edit/sep1&quot;,    NULL,         NULL,           0, &quot;&lt;Separator&gt;&quot; },
+  { &quot;/Edit/C_ut&quot;,    NULL,         gpw_cut_cb,     8, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_CUT },
+  { &quot;/Edit/_Copy&quot;,   NULL,         gpw_copy_cb,    9, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_COPY },
+  { &quot;/Edit/_Paste&quot;,  NULL,         gpw_paste_cb,  10, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_PASTE },
+  { &quot;/Edit/_Delete&quot;, &quot;Delete&quot;,     gpw_delete_cb, 11, &quot;&lt;StockItem&gt;&quot;, GTK_STOCK_DELETE },
 
-  /* ============ VIEW ===================== */
+  /* ============ VIEW ============ */
   { &quot;/View&quot;, NULL, 0, 0, &quot;&lt;Branch&gt;&quot; },
-  { &quot;/View/_Palette&quot;,         NULL, gpw_toggle_palette_cb,     0, &quot;&lt;ToggleItem&gt;&quot; },
-  { &quot;/View/Property _Editor&quot;, NULL, gpw_toggle_editor_cb,      0, &quot;&lt;ToggleItem&gt;&quot; },
-  { &quot;/View/_Widget Tree&quot;,     NULL, gpw_toggle_widget_tree_cb, 0, &quot;&lt;ToggleItem&gt;&quot; },
-  { &quot;/View/_Clipboard&quot;,       NULL, gpw_toggle_clipboard_cb,   0, &quot;&lt;ToggleItem&gt;&quot; },
+  { &quot;/View/_Palette&quot;,         NULL, gpw_toggle_palette_cb,     12, &quot;&lt;ToggleItem&gt;&quot; },
+  { &quot;/View/Property _Editor&quot;, NULL, gpw_toggle_editor_cb,      13, &quot;&lt;ToggleItem&gt;&quot; },
+  { &quot;/View/_Widget Tree&quot;,     NULL, gpw_toggle_widget_tree_cb, 14, &quot;&lt;ToggleItem&gt;&quot; },
+  { &quot;/View/_Clipboard&quot;,       NULL, gpw_toggle_clipboard_cb,   15, &quot;&lt;ToggleItem&gt;&quot; },
 
-  /* ============ PROJECT=================== */
+  /* =========== PROJECT ========== */
   { &quot;/Project&quot;, NULL, 0, 0, &quot;&lt;Branch&gt;&quot; },
 
-  /* ============ HELP ===================== */
+  /* ============ HELP ============ */
   { &quot;/_Help&quot;,       NULL, NULL, 0, &quot;&lt;Branch&gt;&quot; },
-  { &quot;/Help/_About&quot;, NULL, gpw_about_cb, 0 },
+  { &quot;/Help/_About&quot;, NULL, gpw_about_cb, 16 },
 };
 
+/*
+ * Note! The action number in menu_items MUST match the position in this array
+ */
+static gchar *menu_tips[] =
+{
+	NULL,					/* action 0 (branches and separators) */
+	N_(&quot;Create a new project file&quot;),	/* action 1 (New)  */
+	N_(&quot;Open a project file&quot;),		/* action 2 (Open) */
+	N_(&quot;Save the current project file&quot;),	/* action 3 (Save) */
+	N_(&quot;Save the current project file with a different name&quot;),	/* action 4 (Save as) */ 
+	N_(&quot;Quit the program&quot;),			/* action 5 (Quit) */
+
+	N_(&quot;Undo the last action&quot;),		/* action 6  (Undo) */ 
+	N_(&quot;Redo the last action&quot;),		/* action 7  (Redo) */
+	N_(&quot;Cut the selection&quot;),		/* action 8  (Cut)  */
+	N_(&quot;Copy the selection&quot;),		/* action 9  (Copy) */
+	N_(&quot;Paste the clipboard&quot;),		/* action 10 (Paste) */
+	N_(&quot;Delete the selection&quot;),		/* action 11 (Delete) */
+
+	N_(&quot;Change the visibility of the palette of widgets&quot;),	/* action 12 (Palette) */
+	N_(&quot;Change the visibility of the property editor&quot;),	/* action 13 (Editor) */
+	N_(&quot;Change the visibility of the project widget tree&quot;),	/* action 14 (Tree) */
+	N_(&quot;Change the visibility of the clipboard&quot;),		/* action 15 (Clipboard) */
+
+	N_(&quot;About this application&quot;),		/* action 16 (About) */
+};
+
+
+static void
+gpw_push_statusbar_hint (GtkWidget* menuitem, const gchar *tip)
+{
+	GladeProjectWindow *gpw;
+
+	gpw = glade_project_window_get ();
+	gtk_statusbar_push ( GTK_STATUSBAR (gpw-&gt;statusbar), 1, tip);
+}
+
+static void
+gpw_pop_statusbar_hint (GtkWidget* menuitem, gpointer not_used)
+{
+	GladeProjectWindow *gpw;
+
+	gpw = glade_project_window_get ();
+	gtk_statusbar_pop (GTK_STATUSBAR (gpw-&gt;statusbar), 1);
+}
 
 static void
 gpw_construct_menu (GladeProjectWindow *gpw)
 {
 	GtkItemFactory *item_factory;
 	GtkAccelGroup *accel_group;
+	gint i;
 
 	/* Accelerators */
 	accel_group = gtk_accel_group_new ();
@@ -253,6 +297,19 @@ gpw_construct_menu (GladeProjectWindow *
 				       menu_items, gpw-&gt;window);
 	gtk_box_pack_start_defaults (GTK_BOX (gpw-&gt;main_vbox),
 				     gtk_item_factory_get_widget (item_factory, &quot;&lt;main&gt;&quot;));
+
+	/* set the tooltips */
+	for (i = 1; i &lt; G_N_ELEMENTS (menu_tips); i++) {
+		GtkWidget *item;
+
+		item = gtk_item_factory_get_widget_by_action (item_factory, i);
+		g_signal_connect (G_OBJECT (item), &quot;select&quot;,
+				  G_CALLBACK (gpw_push_statusbar_hint),
+				  menu_tips[i]);
+		g_signal_connect (G_OBJECT (item), &quot;deselect&quot;,
+				  G_CALLBACK (gpw_pop_statusbar_hint),
+				  NULL);
+	}
 }
 
 static void
@@ -276,6 +333,19 @@ gpw_construct_toolbar (GladeProjectWindo
 				  gpw, -1);
 	gtk_toolbar_append_space (GTK_TOOLBAR (toolbar));
 	gtk_toolbar_insert_stock (GTK_TOOLBAR (toolbar),
+				  GTK_STOCK_UNDO,
+				  &quot;Undo the last action&quot;,
+				  NULL,
+				  G_CALLBACK (gpw_undo_cb),
+				  gpw, -1);
+	gtk_toolbar_insert_stock (GTK_TOOLBAR (toolbar),
+				  GTK_STOCK_REDO,
+				  &quot;Redo the last action&quot;,
+				  NULL,
+				  G_CALLBACK (gpw_redo_cb),
+				  gpw, -1);
+	gtk_toolbar_append_space (GTK_TOOLBAR (toolbar));
+	gtk_toolbar_insert_stock (GTK_TOOLBAR (toolbar),
 				  GTK_STOCK_QUIT,
 				  &quot;Quit glade&quot;,
 				  NULL,

--=-ahOe7YOkEgf5f1+/K7Kf--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000064.html">[Glade-devel] Re: Toolbox widget for libegg
</A></li>
	<LI> Next message: <A HREF="000063.html">[Glade-devel] glade 1.1.3 fails to build with the latest libgnomedb2 (0.11.0)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62">[ date ]</a>
              <a href="thread.html#62">[ thread ]</a>
              <a href="subject.html#62">[ subject ]</a>
              <a href="author.html#62">[ author ]</a>
         </LI>
       </UL>
</body></html>
