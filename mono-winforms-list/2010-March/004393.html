<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] TreeView.TreeViewNodeSorter seem to have	no effect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20TreeView.TreeViewNodeSorter%20seem%20to%20have%0A%09no%20effect&In-Reply-To=1c146861003231103h52a4f1f2se811bb61108a6003%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004390.html">
   <LINK REL="Next"  HREF="004386.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] TreeView.TreeViewNodeSorter seem to have	no effect</H1>
    <B>Latif Khalifa</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20TreeView.TreeViewNodeSorter%20seem%20to%20have%0A%09no%20effect&In-Reply-To=1c146861003231103h52a4f1f2se811bb61108a6003%40mail.gmail.com"
       TITLE="[Mono-winforms-list] TreeView.TreeViewNodeSorter seem to have	no effect">latifer at radegastclient.org
       </A><BR>
    <I>Wed Mar 24 08:24:21 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004390.html">[Mono-winforms-list] TreeView.TreeViewNodeSorter seem to have	no effect
</A></li>
        <LI>Next message: <A HREF="004386.html">[Mono-winforms-list] Application.EnableVisualStyles() on Windows - Luna (Windows XP) theme issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4393">[ date ]</a>
              <a href="thread.html#4393">[ thread ]</a>
              <a href="subject.html#4393">[ subject ]</a>
              <a href="author.html#4393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I finally managed to figure out under what circumstances the bug
shows. I have a single root node, creatively labeled &quot;root&quot;. In that
case TreeView ignores the sorter and sorts alphabetically. Here is my
simple Compare() that is supposed to sort nodes in reverse
alphabetical order:

    public class SorterClass : System.Collections.IComparer
    {
        public int Compare(object a, object b)
        {
            int res = string.Compare(((TreeNode)a).Text, ((TreeNode)b).Text);
            res *= -1;
            return res;
        }
    }

And here is a short example that creates TreeView:

            invTree = new TreeView();
            invTree.Dock = DockStyle.Fill;
            invTree.TreeViewNodeSorter = new SorterClass();
            Controls.Add(invTree);

            TreeNode root = new TreeNode(&quot;My root&quot;);
            invTree.Nodes.Add(root);

            for (char c = 'A'; c &lt;= 'Z'; c++)
            {
                TreeNode n = new TreeNode();
                n.Text = c.ToString();
                n.Name = c.ToString();
                for (int i=0; i&lt;20; i++)
                {
                    TreeNode inside = new TreeNode(i.ToString());
                    n.Nodes.Add(inside);
                }
                root.Nodes.Add(n);
            }

            invTree.Sort();

Two observed behaviors differ from .net

1) Bug, Setting TreeViewNodeSorter has no effect if there is only one
top level node. (actually it does have an effect of turning on
sorting, just that the Compare() is never called and sorting is done
by a default system function).
2) Different behavior. On Windows under .NET one does not need to
explicitly call Sort(). Nodes are sorted as they are inserted.

Latif

On Tue, Mar 23, 2010 at 7:03 PM, Carlos Alberto Cortez
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">calberto.cortez at gmail.com</A>&gt; wrote:
&gt;<i> Hey!
</I>&gt;<i> I tested this on those same versions, and I cannot get the error. Could you
</I>&gt;<i> cook a small test case?
</I>&gt;<i> Carlos.
</I>&gt;<i>
</I>&gt;<i> 2010/3/23 Latif Khalifa &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">latifer at radegastclient.org</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have had this problem with both 2.4.2.3 and 2.6.3. Identical code
</I>&gt;&gt;<i> works on .net side, in mono's TreeView sorting is always alphabetic
</I>&gt;&gt;<i> and my Compare() never gets called.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Latif
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Tue, Mar 23, 2010 at 4:00 PM, Carlos Alberto Cortez
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">calberto.cortez at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; Hey,
</I>&gt;&gt;<i> &gt; This should be working. Maybe you hit a bug, but it seems, based on the
</I>&gt;&gt;<i> &gt; other information, that you are using an old version. Take a look at
</I>&gt;&gt;<i> &gt; that
</I>&gt;&gt;<i> &gt; and let us know.
</I>&gt;&gt;<i> &gt; Carlos.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; 2010/3/23 Latif Khalifa &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">latifer at radegastclient.org</A>&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Hi,
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; I'm trying to cure a few last quirks an an application I'm porting
</I>&gt;&gt;<i> &gt;&gt; from windows. The problem I'm having is that setting
</I>&gt;&gt;<i> &gt;&gt; TreeView.TreeViewNodeSorter seem to have no effect. The nodes gets
</I>&gt;&gt;<i> &gt;&gt; sorted alphabetically and Compare() in my IComparer class never gets
</I>&gt;&gt;<i> &gt;&gt; called. Any ideas?
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Also TreeView seem to be missing [+] and [-] images next to the nodes
</I>&gt;&gt;<i> &gt;&gt; that can be expanded and collapsed.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Latif
</I>&gt;&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;&gt;<i> &gt;&gt; Mono-winforms-list maillist &#160;- &#160;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">Mono-winforms-list at lists.ximian.com</A>
</I>&gt;&gt;<i> &gt;&gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">http://lists.ximian.com/mailman/listinfo/mono-winforms-list</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004390.html">[Mono-winforms-list] TreeView.TreeViewNodeSorter seem to have	no effect
</A></li>
	<LI>Next message: <A HREF="004386.html">[Mono-winforms-list] Application.EnableVisualStyles() on Windows - Luna (Windows XP) theme issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4393">[ date ]</a>
              <a href="thread.html#4393">[ thread ]</a>
              <a href="subject.html#4393">[ subject ]</a>
              <a href="author.html#4393">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
