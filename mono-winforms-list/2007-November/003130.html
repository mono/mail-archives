<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Project status of WinForms on MacOS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Project%20status%20of%20WinForms%20on%20MacOS&In-Reply-To=OFCBC8B2EF.A8B2CAD8-ON8625738C.0066AD83-8625738C.006F0FCF%40ni.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003128.html">
   <LINK REL="Next"  HREF="003129.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Project status of WinForms on MacOS</H1>
    <B>Geoff Norton</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Project%20status%20of%20WinForms%20on%20MacOS&In-Reply-To=OFCBC8B2EF.A8B2CAD8-ON8625738C.0066AD83-8625738C.006F0FCF%40ni.com"
       TITLE="[Mono-winforms-list] Project status of WinForms on MacOS">gnorton at novell.com
       </A><BR>
    <I>Wed Nov  7 15:25:27 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003128.html">[Mono-winforms-list] [PATCH] Invalidate non visible areas	when	scrolling
</A></li>
        <LI>Next message: <A HREF="003129.html">[Mono-winforms-list] Project status of WinForms on MacOS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3130">[ date ]</a>
              <a href="thread.html#3130">[ thread ]</a>
              <a href="subject.html#3130">[ subject ]</a>
              <a href="author.html#3130">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Brock,

On Wed, 2007-11-07 at 13:25 -0600, Brock Reeve wrote:
&gt;<i> 
</I>&gt;<i> Ok. I have looked into this some more and am getting the button to
</I>&gt;<i> draw somewhat. The middle part isn't drawing correctly. I got this to
</I>&gt;<i> work running a simple test program in C and compiled on the Mac. 
</I>&gt;<i> 
</I>
Great!

&gt;<i> The graphics object doesn't give access to the raw quartz handle
</I>&gt;<i> (CGContext) which is created in Graphics.FromHwnd and set on
</I>&gt;<i> GDIPlus.Display static variable. The only way I could get it was to
</I>&gt;<i> copy the code from Carbon.GetCGContextForView and use that in my
</I>&gt;<i> drawing code for my button. I think this might be screwing it up
</I>&gt;<i> somehow because I am creating another CGContext when one was already
</I>&gt;<i> created for the Graphics object. Maybe we could support
</I>&gt;<i> IServiceProvider or something on the Graphics object so we could query
</I>&gt;<i> for the CGContext. There is another issue where if you click on the
</I>&gt;<i> button it fails to draw again. Here is the code for the button and a
</I>&gt;<i> screen shot. I am just experiementing for now putting the code in the
</I>&gt;<i> button OnPaint rather than the Theme stuff. 
</I>
Be aware that code there is going to be updated to use QDBeginCGContext
at some point.  It also had the flaw of not CFRelease-ing the used
context.  Lastly its been refactored today; because using that static
wasn't thread safe so we now store the CGContextRef in a internal
variable to the Graphics context.  This leaves you with two choices:

#1: Reflection
#2: Generate your own (these can be cached in fact; we dont do it on the
Graphics side right now, but we could and QDBeginCGContext takes care of
this for you)

As for something like IServiceProvider, this wont happen as we cannot
change the public API for System.Drawing.

As for the click issue; its probably where you're hooking the drawing,
but I'd have to look more closely at Button(Base) to tell you.

-g


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003128.html">[Mono-winforms-list] [PATCH] Invalidate non visible areas	when	scrolling
</A></li>
	<LI>Next message: <A HREF="003129.html">[Mono-winforms-list] Project status of WinForms on MacOS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3130">[ date ]</a>
              <a href="thread.html#3130">[ thread ]</a>
              <a href="subject.html#3130">[ subject ]</a>
              <a href="author.html#3130">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
