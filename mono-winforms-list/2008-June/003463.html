<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] VisualStyles implementation based on GTK+
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20VisualStyles%20implementation%20based%20on%20GTK%2B&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003462.html">
   <LINK REL="Next"  HREF="003472.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] VisualStyles implementation based on GTK+</H1>
    <B>George Giolfan</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20VisualStyles%20implementation%20based%20on%20GTK%2B&In-Reply-To="
       TITLE="[Mono-winforms-list] VisualStyles implementation based on GTK+">georgegiolfan at yahoo.com
       </A><BR>
    <I>Thu Jun  5 21:21:08 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003462.html">[Mono-winforms-list] System.Windows.Forms incompatible with	OS	X 10.5?
</A></li>
        <LI>Next message: <A HREF="003472.html">[Mono-winforms-list] VisualStyles implementation based on GTK+
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3463">[ date ]</a>
              <a href="thread.html#3463">[ thread ]</a>
              <a href="subject.html#3463">[ subject ]</a>
              <a href="author.html#3463">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This patch contains a refactoring of the managed VisualStyles API to allow multiple implementations. The existing implementation was moved to VisualStylesNative.

Design
The new code is split in two parts. The code in GtkPlus wraps GTK+ and exposes methods to paint controls (mostly based on ThemeGtk in the experimental mode, but faster and with less bugs). The VisualStyles implementation itself is VisualStylesGtkPlus and it translates class name/part/state combinations to calls to GtkPlus.
This new VisualStyles implementation combined with the VisualStyles theme would achieve a native GTK+ look for many of the usual controls. However, due to some differences between the VisualStyles and GTK+ APIs, a better (faster and more flexible) long term solution for having a native GTK+ look would be to write a new theme (or refactor ThemeGtk) to use the GtkPlus code directly. This would be faster especially for controls with a solid color background and would allow painting control elements not supported by the VisualStyles API (if there are any).

Status
The code is far from finished. It is meant as proof of concept. I need to know if the approach is good.
Only background painting for the VisualStyleElement.Button.CheckBox.UncheckedNormal element is implemented.
You can use this to test it
using System.Drawing;
using System.Windows.Forms;
using System.Windows.Forms.VisualStyles;
class Test
{
	static void Main ()
	{
		Application.Run (new TestForm ());
	}
	class TestForm : Form
	{
		public TestForm ()
		{
			SetStyle (ControlStyles.ResizeRedraw, true);
			DoubleBuffered = true;
			BackgroundImage = Icon.ToBitmap ();
		}
		protected override void OnPaint (PaintEventArgs e)
		{
			new VisualStyleRenderer (VisualStyleElement.Button.CheckBox.UncheckedNormal).DrawBackground (e.Graphics, ClientRectangle);
		}
	}
}

On Windows, in the HKEY_CURRENT_USER\Software\Mono registry key, you need to add a string value named &quot;VisualStyles&quot; with the data &quot;GTK+&quot;.
On non-Windows platforms you can either use DLL mapping for the GTK+ libraries or disable the &quot;#define Windows&quot; line in GtkPlus.cs.


      
-------------- next part --------------
A non-text attachment was scrubbed...
Name: VisualStylesGtkPlus.patch.gz
Type: application/x-gzip
Size: 10629 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20080605/defd83c7/attachment.gz">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20080605/defd83c7/attachment.gz</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003462.html">[Mono-winforms-list] System.Windows.Forms incompatible with	OS	X 10.5?
</A></li>
	<LI>Next message: <A HREF="003472.html">[Mono-winforms-list] VisualStyles implementation based on GTK+
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3463">[ date ]</a>
              <a href="thread.html#3463">[ thread ]</a>
              <a href="subject.html#3463">[ subject ]</a>
              <a href="author.html#3463">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
