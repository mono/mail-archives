<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Window Capture
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Window%20Capture&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002091.html">
   <LINK REL="Next"  HREF="002098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Window Capture</H1>
    <B>yom</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Window%20Capture&In-Reply-To="
       TITLE="[Mono-winforms-list] Window Capture">guillaume.bibaut at gmail.com
       </A><BR>
    <I>Sat Oct 22 10:06:33 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002091.html">[Mono-winforms-list] Regarding MONO  run time error...
</A></li>
        <LI>Next message: <A HREF="002098.html">[Mono-winforms-list] Window Capture
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2097">[ date ]</a>
              <a href="thread.html#2097">[ thread ]</a>
              <a href="subject.html#2097">[ subject ]</a>
              <a href="author.html#2097">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I've recently found a way to get a window capture with C# on the .NET
1.1Framework using Message class and WndProc method. While on Windows
it
returns me the bitmap of the window, with Mono on Linux, I'm just getting an
empty bitmap (black bitmap, no window drawing). Is it the normal behavior ?

the following source code is a click on a button on a form.

## CODE ##

Bitmap inter = new Bitmap(this.Width, this.Height);
Graphics gfxInter = Graphics.FromImage(inter);
IntPtr hInter = gfxInter.GetHdc();

// Complete Window Capture
Message msg = new Message();
msg.Msg = WM_PRINT;
msg.HWnd = this.Handle;
msg.WParam = hInter;
msg.LParam = new IntPtr(PRF_CLIENT | PRF_CHILDREN | PRF_NONCLIENT |
PRF_ERASEBKGND);
this.WndProc(ref msg);

gfxInter.ReleaseHdc(hInter);
gfxInter.Dispose();

inter.Save(&quot;test.jpg&quot;, ImageFormat.Jpeg);

## CODE ##
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20051022/c83009c0/attachment.html">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20051022/c83009c0/attachment.html</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002091.html">[Mono-winforms-list] Regarding MONO  run time error...
</A></li>
	<LI>Next message: <A HREF="002098.html">[Mono-winforms-list] Window Capture
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2097">[ date ]</a>
              <a href="thread.html#2097">[ thread ]</a>
              <a href="subject.html#2097">[ subject ]</a>
              <a href="author.html#2097">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
