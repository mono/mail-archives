<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Window Capture
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Window%20Capture&In-Reply-To=9374c35d0510220706x32016b1bv%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002097.html">
   <LINK REL="Next"  HREF="002092.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Window Capture</H1>
    <B>Miguel de Icaza</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Window%20Capture&In-Reply-To=9374c35d0510220706x32016b1bv%40mail.gmail.com"
       TITLE="[Mono-winforms-list] Window Capture">miguel at ximian.com
       </A><BR>
    <I>Mon Oct 24 14:14:51 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002097.html">[Mono-winforms-list] Window Capture
</A></li>
        <LI>Next message: <A HREF="002092.html">[Mono-winforms-list] What ImageList bugs do we need?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2098">[ date ]</a>
              <a href="thread.html#2098">[ thread ]</a>
              <a href="subject.html#2098">[ subject ]</a>
              <a href="author.html#2098">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

&gt;<i> I've recently found a way to get a window capture with C# on the .NET
</I>&gt;<i> 1.1 Framework using Message class and WndProc method. While on Windows
</I>&gt;<i> it returns me the bitmap of the window, with Mono on Linux, I'm just
</I>&gt;<i> getting an empty bitmap (black bitmap, no window drawing). Is it the
</I>&gt;<i> normal behavior ?
</I>
As I explained to you before, Managed.Windows.Forms only implements the
necessary messages required to support its own widgets and not every
possible windows message.

This message is not necessary for Windows.Forms to work, so it has not
been implemented. 

Although this could be implemented, it is not really a priority for us.
This is one of those situations where someone who has enough interest
will have to provide a patch if they want to get the functionality.

Miguel.

&gt;<i> the following source code is a click on a button on a form.
</I>&gt;<i> 
</I>&gt;<i> ## CODE ##
</I>&gt;<i> 
</I>&gt;<i>                 Bitmap inter = new Bitmap(this.Width, this.Height); 
</I>&gt;<i>                 Graphics gfxInter = Graphics.FromImage(inter); 
</I>&gt;<i>                 IntPtr hInter = gfxInter.GetHdc(); 
</I>&gt;<i>  
</I>&gt;<i>                 // Complete Window Capture 
</I>&gt;<i>                 Message msg = new Message(); 
</I>&gt;<i>                 msg.Msg = WM_PRINT; 
</I>&gt;<i>                 msg.HWnd = this.Handle; 
</I>&gt;<i>                 msg.WParam = hInter; 
</I>&gt;<i>                 msg.LParam = new IntPtr(PRF_CLIENT | PRF_CHILDREN |
</I>&gt;<i> PRF_NONCLIENT | PRF_ERASEBKGND); 
</I>&gt;<i>                 this.WndProc(ref msg); 
</I>&gt;<i>  
</I>&gt;<i>                 gfxInter.ReleaseHdc(hInter); 
</I>&gt;<i>                 gfxInter.Dispose();
</I>&gt;<i> 
</I>&gt;<i>                 inter.Save(&quot;test.jpg&quot;, ImageFormat.Jpeg); 
</I>&gt;<i> 
</I>&gt;<i> ## CODE ##
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-winforms-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">Mono-winforms-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">http://lists.ximian.com/mailman/listinfo/mono-winforms-list</A>
</I>-- 
Miguel de Icaza &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">miguel at ximian.com</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002097.html">[Mono-winforms-list] Window Capture
</A></li>
	<LI>Next message: <A HREF="002092.html">[Mono-winforms-list] What ImageList bugs do we need?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2098">[ date ]</a>
              <a href="thread.html#2098">[ thread ]</a>
              <a href="subject.html#2098">[ subject ]</a>
              <a href="author.html#2098">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
