<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Weird issues reading pixels of jpg file	on	osx
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Weird%20issues%20reading%20pixels%20of%20jpg%20file%09on%0A%09osx&In-Reply-To=5fe9674f0608310902j4654b738x507ad5c5048d44eb%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="002473.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Weird issues reading pixels of jpg file	on	osx</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Weird%20issues%20reading%20pixels%20of%20jpg%20file%09on%0A%09osx&In-Reply-To=5fe9674f0608310902j4654b738x507ad5c5048d44eb%40mail.gmail.com"
       TITLE="[Mono-winforms-list] Weird issues reading pixels of jpg file	on	osx">sebastien at ximian.com
       </A><BR>
    <I>Fri Sep  1 10:08:02 EDT 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="002473.html">[Mono-winforms-list] [Mono-dev] Mono Winforms Team: we are	hiring.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2472">[ date ]</a>
              <a href="thread.html#2472">[ thread ]</a>
              <a href="subject.html#2472">[ subject ]</a>
              <a href="author.html#2472">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Dan,

I've opened bug #79246 for the LockBits issues which, from the unit
tests I added this morning, appears to affect every type of bitmaps.

FYI the problem that affected the (first two lines of) JPEG bitmaps
doesn't happen on any other type of pictures.

On Thu, 2006-08-31 at 09:02 -0700, Dan Shryock wrote:
&gt;<i> Sebastien,
</I>&gt;<i> 
</I>&gt;<i> I just ran the code for reading jpegs on the 1.1.14 build on osx and
</I>&gt;<i> it had different results that those that I am currently getting, but
</I>&gt;<i> they were still not correct.  Hope this helps.
</I>&gt;<i> 
</I>&gt;<i> Dan
</I>&gt;<i> 
</I>&gt;<i> On 1.1.14 it came out as:
</I>&gt;<i> 
</I>&gt;<i> 255
</I>&gt;<i> 255
</I>&gt;<i> 255
</I>&gt;<i> 255
</I>&gt;<i> 77
</I>&gt;<i> 255
</I>&gt;<i> 255
</I>&gt;<i> 75
</I>&gt;<i> 144
</I>&gt;<i> 255
</I>&gt;<i> 75
</I>&gt;<i> 143
</I>&gt;<i> 255
</I>&gt;<i> 73
</I>&gt;<i> 144
</I>&gt;<i> 255
</I>&gt;<i> 74
</I>&gt;<i> 145
</I>&gt;<i> 255
</I>&gt;<i> 74
</I>&gt;<i> 147
</I>&gt;<i> 255
</I>&gt;<i> 74
</I>&gt;<i> 147
</I>&gt;<i> 255
</I>&gt;<i> 75
</I>&gt;<i> 150
</I>&gt;<i> 255
</I>&gt;<i> 74
</I>&gt;<i> 149
</I>&gt;<i> 
</I>&gt;<i> On 8/31/06, Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">sebastien at ximian.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hello Dan,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [please c.c. the mailing-list in your answers]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I found a problem with (most) JPEG files where the first two lines had
</I>&gt;<i> &gt; some bad values. This is fixed in SVN :-)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; However my (new) unit tests using LockBits are all failing - even for
</I>&gt;<i> &gt; bitmaps. Something else is wrong there :-(
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Note that I'm still curious to know if this was working on previous Mac
</I>&gt;<i> &gt; OS X releases ;-)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Thu, 2006-08-31 at 08:21 -0700, Dan Shryock wrote:
</I>&gt;<i> &gt; &gt; Hi Sebastien,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Thanks for looking into this.  I just tried it on a png file instead
</I>&gt;<i> &gt; &gt; of the jpeg, and I am still seeing different results for the pixel
</I>&gt;<i> &gt; &gt; data.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; On windows the first few bytes were as follows:
</I>&gt;<i> &gt; &gt; 196
</I>&gt;<i> &gt; &gt; 144
</I>&gt;<i> &gt; &gt; 73
</I>&gt;<i> &gt; &gt; 195
</I>&gt;<i> &gt; &gt; 143
</I>&gt;<i> &gt; &gt; 72
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; while on osx they were:
</I>&gt;<i> &gt; &gt; 255
</I>&gt;<i> &gt; &gt; 144
</I>&gt;<i> &gt; &gt; 73
</I>&gt;<i> &gt; &gt; 255
</I>&gt;<i> &gt; &gt; 255
</I>&gt;<i> &gt; &gt; 72
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; So something similar seems to be affecting png reading as well as jpeg reading.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Dan
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; On 8/31/06, Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">sebastien at ximian.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; Hello Dan,
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; It may be unrelated to endian issues (but I still like your answers,
</I>&gt;<i> &gt; &gt; &gt; multiple problems are common ;-) as I also found out differences between
</I>&gt;<i> &gt; &gt; &gt; Mono on Linux i386 and Windows.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; It seems, in my test case, that the first two lines of the decoded jpeg
</I>&gt;<i> &gt; &gt; &gt; aren't correct. In the first line all 2nd and 4th bytes are identical,
</I>&gt;<i> &gt; &gt; &gt; while on the second line all 3rd and 4th bytes are identical (on the
</I>&gt;<i> &gt; &gt; &gt; mono side, the 4th byte being correct). All other lines looks correct
</I>&gt;<i> &gt; &gt; &gt; (but needs more investigation).
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I'm re-enabling the JpegCodec unit tests (not sure why they were
</I>&gt;<i> &gt; &gt; &gt; commented, the ChangeLog says &quot;fixed&quot;) and adding new test cases.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Thanks for noticing this.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; On Wed, 2006-08-30 at 20:08 -0400, Sebastien Pouliot wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; Hello Dan,
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Did the same code worked on a previous version of Mono ? (if so which
</I>&gt;<i> &gt; &gt; &gt; &gt; version ?) or are you testing this for the first time ?
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Because I recently fixed many endian issues affecting Mac OS X (and
</I>&gt;<i> &gt; &gt; &gt; &gt; other architectures). It is possible that one of them has broken
</I>&gt;<i> &gt; &gt; &gt; &gt; something else :-(
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; I'll try to build a similar test case using one of the embedded bitmap
</I>&gt;<i> &gt; &gt; &gt; &gt; files we have in the unit tests and see how to bots reacts to it.
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; On Wed, 2006-08-30 at 15:56 -0700, Dan Shryock wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; When attempting to read the pixel bytes of a jpg on osx (using the
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 1.1.17 build just released) I am getting different results on windows
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; versus osx.  Does anybody have any ideas why I am getting these
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; different results?  Any information is very appreciated.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Dan
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; The code being used is as follows:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Bitmap bmp = new Bitmap(&quot;file.jpg&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; BitmapData bmpdata = bmp.LockBits(new Rectangle(0,0,bmp.Width,
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; bmp.Height),ImageLockMode.ReadOnly,PixelFormat.Format24bppRgb);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; unsafe{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;     byte* scandata = (byte*) bmpdata.Scan0;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;     for(int i=0; i&lt;30; i++){
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;             Console.WriteLine(scandata[i]);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;     }
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; }
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; and the results using mono on windows are:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 187
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 144
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 77
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 187
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 144
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 77
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 186
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 144
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 75
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 188
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 143
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 75
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 188
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 144
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 73
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 189
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 145
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 74
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 192
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 147
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 74
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 192
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 147
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 74
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 192
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 150
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 75
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 191
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 149
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 74
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; while the results on osx are:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 77
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 77
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 144
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 75
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 143
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 75
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 73
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 188
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 188
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 144
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 255
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 189
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Mono-winforms-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">Mono-winforms-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">http://lists.ximian.com/mailman/listinfo/mono-winforms-list</A>
</I>&gt;<i> &gt; &gt; &gt; --
</I>&gt;<i> &gt; &gt; &gt; Sebastien Pouliot  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">sebastien at ximian.com</A>&gt;
</I>&gt;<i> &gt; &gt; &gt; Blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Sebastien Pouliot  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">sebastien at ximian.com</A>&gt;
</I>&gt;<i> &gt; Blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>-- 
Sebastien Pouliot  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">sebastien at ximian.com</A>&gt;
Blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="002473.html">[Mono-winforms-list] [Mono-dev] Mono Winforms Team: we are	hiring.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2472">[ date ]</a>
              <a href="thread.html#2472">[ thread ]</a>
              <a href="subject.html#2472">[ subject ]</a>
              <a href="author.html#2472">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
