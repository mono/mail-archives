<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] When will winforms be working?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:peter%40novonyx.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000616.html">
   <LINK REL="Next"  HREF="000618.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] When will winforms be working?
   </H1>
    <B>Peter Dennis Bartok
    </B> 
    <A HREF="mailto:peter%40novonyx.com"
       TITLE="[Mono-winforms-list] When will winforms be working?">peter@novonyx.com
       </A><BR>
    <I>Thu, 19 Feb 2004 07:38:00 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="000616.html">[Mono-winforms-list] When will winforms be working?
</A></li>
        <LI> Next message: <A HREF="000618.html">[Mono-winforms-list] When will winforms be working?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#614">[ date ]</a>
              <a href="thread.html#614">[ thread ]</a>
              <a href="subject.html#614">[ subject ]</a>
              <a href="author.html#614">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Vlad,

My solution does not have any of the drawbacks of monostub. It is modeled
after what you did, with the older version of wine. Wine *is* used as a
shared library, there is no special version of mono linked in with wine,
etc.

*Please* why don't you take the time and actually look at the patch? I
also included the SWF side of it, it shows you how it is used from the C#
side. Three lines of code, ultimately, no special app, linking, etc.

Peter


-----Original Message-----
From: &quot;Vlad kaluzhny&quot; &lt;<A HREF="mailto:vkaluzhny@openlinksw.co.uk">vkaluzhny@openlinksw.co.uk</A>&gt;
To: &quot;Roderick Colenbrander&quot; &lt;<A HREF="mailto:thunderbird2k@gmx.net">thunderbird2k@gmx.net</A>&gt;
Cc: &quot;Peter Dennis Bartok&quot; &lt;<A HREF="mailto:peter@novonyx.com">peter@novonyx.com</A>&gt;;
&lt;<A HREF="mailto:mono-winforms-list@lists.ximian.com">mono-winforms-list@lists.ximian.com</A>&gt;; &lt;<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&gt;; &quot;Yrjana
Rankka&quot; &lt;<A HREF="mailto:ghard@openlinksw.com">ghard@openlinksw.com</A>&gt;
Date: 19 February, 2004 06:48
Subject: Re: [Mono-winforms-list] When will winforms be working?


&gt;<i>Hi All.
</I>&gt;<i>Roderick.
</I>&gt;<i>The approach  which Peter suggests  to implement  was already  disccused
</I>&gt;<i>before my patches  where done.
</I>&gt;<i>Actually if you all remember we had  an application under wine (I do not
</I>&gt;<i>remember its name),
</I>&gt;<i>which  did exactly the same - it ran  Mono under Wine
</I>&gt;<i>When I suggested to create Win32 API  shared libraries from Wine,
</I>&gt;<i>Miguel gave me support and decided to stop  to run Mono  under Wine.
</I>&gt;<i>Thus I started to write my patches and so shared libraries were created.
</I>&gt;<i>
</I>&gt;<i>Unfortunately we were not able to integrate them to Wine CVS, since
</I>&gt;<i>there were
</I>&gt;<i>some suggestions from Wine team and some time later  Wine's structure
</I>&gt;<i>was completely changed.
</I>&gt;<i>Therefore we faced  to apply my patches onto latest version of Wine.
</I>&gt;<i>That is what I do atm.
</I>&gt;<i>
</I>&gt;<i>Now   you suggest to get us back and  run Mono under Wine again.
</I>&gt;<i>Actually I  would not support this idea, but the final  decision will be
</I>&gt;<i>taken by Miguel.
</I>&gt;<i>
</I>&gt;<i>Miguel, please give us your opinion -  do we actually need to create
</I>&gt;<i>Win32 API shared libraries
</I>&gt;<i>for latest version of wine or we will go back to Mono under Wine.
</I>&gt;<i>
</I>&gt;<i>Regards, Vlad
</I>&gt;<i>
</I>&gt;<i>Roderick Colenbrander wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>If I understand it correctly you (Vlad) like the wine as a shared
</I>library
&gt;&gt;<i>approach more than Peter's approach. Why not continue with Peter's
</I>approach?
&gt;&gt;<i>Ofcourse it is nicer to use wine as a shared library but the other
</I>approach has
&gt;&gt;<i>a huge advantage as that wine version is allmost the same as normal
</I>wine.
&gt;&gt;<i>These days there are already various hybrid .net apps that for example
</I>use com
&gt;&gt;<i>or various native windows dlls. With the new patch those hybrid apps
</I>should
&gt;&gt;<i>be easy to get working (perhaps they already work out of the box).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Regards,
</I>&gt;&gt;<i>Roderick Colenbrander
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Vlad, please have a look at the patch I attached to my earlier message.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I did not pick/patch a particular part of wine, I simply prevented wine
</I>&gt;&gt;&gt;&gt;<i>from running WinMain and instead it returns control to the app that
</I>&gt;&gt;&gt;<i>called
</I>&gt;&gt;&gt;<i>wine_init. To take care of initialization without having to plow
</I>through
&gt;&gt;&gt;<i>too much code I created a winelib binary that is used for a)
</I>&gt;&gt;&gt;<i>initialization of wine itself (passed to wine_init as argument) and b)
</I>to
&gt;&gt;&gt;<i>actually do the initialization of wine (by calling wine_init)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I have not done extensive tests yet, but it seems to work. The
</I>advantage
&gt;&gt;&gt;<i>is that I don't need to specifically recompile wine as a shared
</I>library;
&gt;&gt;&gt;<i>it inherently is a shared library and this patch allows me to use it as
</I>&gt;&gt;&gt;<i>such. The same wine code will allow to run regular apps and mono.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I tried to coordinate with you, but by the time I got your first
</I>response
&gt;&gt;&gt;<i>the patch was already finished; also tried your ICQ address, but you
</I>never
&gt;&gt;&gt;<i>added me to your contact list.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Cheers,
</I>&gt;&gt;&gt;<i>  Peter
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>-----Original Message-----
</I>&gt;&gt;&gt;<i>From: &quot;Vlad kaluzhny&quot; &lt;<A HREF="mailto:vkaluzhny@openlinksw.co.uk">vkaluzhny@openlinksw.co.uk</A>&gt;
</I>&gt;&gt;&gt;<i>To: &quot;Peter Dennis Bartok&quot; &lt;<A HREF="mailto:peter@novonyx.com">peter@novonyx.com</A>&gt;
</I>&gt;&gt;&gt;<i>Cc: &quot;M. Scott Ford&quot; &lt;<A HREF="mailto:vaderpi@scottandlaurie.com">vaderpi@scottandlaurie.com</A>&gt;; &quot;'Miguel de Icaza'&quot;
</I>&gt;&gt;&gt;<i>&lt;<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&gt;; &lt;<A HREF="mailto:mono-winforms-list@lists.ximian.com">mono-winforms-list@lists.ximian.com</A>&gt;
</I>&gt;&gt;&gt;<i>Date: 18 February, 2004 22:05
</I>&gt;&gt;&gt;<i>Subject: Re: [Mono-winforms-list] When will winforms be working?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Hi All.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Peter  It  definitely is not clear to me - which part of Wine are  you
</I>&gt;&gt;&gt;<i>patching?
</I>&gt;&gt;&gt;<i>And second - lets coordinate our efforts in patches writing,
</I>&gt;&gt;&gt;<i>otherwise we will duplicate  our work
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I have already patched ntdll.dll and now working on kernel32.dll.......
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Regards, Vlad
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Peter Dennis Bartok wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Hi All,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Sorry for having been so quiet. I was hoping I'd get all the changes
</I>&gt;&gt;&gt;&gt;<i>done and could just present a 'complete solution'. But I'm not quite
</I>&gt;&gt;&gt;&gt;<i>there yet.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>The first patch is in CVS already, it's located under
</I>&gt;&gt;&gt;&gt;<i>mcs/class/System.Windows.Forms/wine-patch
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I've also attached the patch and a readme.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Keep in mind that it's not complete yet. The patches will allow you to
</I>&gt;&gt;&gt;&gt;<i>use Wine as a shared library. Unlike the previous patch, where wine
</I>&gt;&gt;&gt;&gt;<i>itself was hacked up to be compiled either the traditional way or as a
</I>&gt;&gt;&gt;&gt;<i>shared library I tried to have a patch that could make it back to the
</I>&gt;&gt;&gt;&gt;<i>main wine repository. So the only actual changes to wine itself was
</I>&gt;&gt;&gt;&gt;<i>that I prevent wine from calling the WinMain of a passed-in winelib
</I>&gt;&gt;&gt;&gt;<i>executable, if the name of the executable is 'mono-winelib'.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Everything else is handled in the mono-winelib executable. It acts as
</I>&gt;&gt;&gt;&gt;<i>a winelib binary as well as the library that gets loaded to initialize
</I>&gt;&gt;&gt;&gt;<i>wine as a shared library. Simply dlopen() and import the
</I>&gt;&gt;&gt;&gt;<i>MonoWineInit() function and run it. That function in turn will
</I>&gt;&gt;&gt;&gt;<i>initialize wine and then return. At that point any caller should be
</I>&gt;&gt;&gt;&gt;<i>able to import and use any symbols/functions from wine.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Keep in mind that I have done only minimal testing with the approach
</I>&gt;&gt;&gt;&gt;<i>so far, since I still need to develop a second patch, to make the
</I>&gt;&gt;&gt;&gt;<i>x11drv coexist with cairo. It seems that there's some offscreen
</I>&gt;&gt;&gt;&gt;<i>caching happening in cairo and when wine draws on the screen cairo
</I>&gt;&gt;&gt;&gt;<i>isn't aware and 'overwrites' the wine changes. I'm still in the
</I>&gt;&gt;&gt;&gt;<i>process of debugging the issues, give me a few days more on that.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Check the readme that goes along with the patch for some symbolic
</I>&gt;&gt;&gt;&gt;<i>links that have to be created manually currently before the wine patch
</I>&gt;&gt;&gt;&gt;<i>can be used.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I have also attached a patch that's not in CVS yet (mcs-0.30.patch)
</I>&gt;&gt;&gt;&gt;<i>which fixes up SWF to properly load the new wine library. Pathnames
</I>&gt;&gt;&gt;&gt;<i>are currently fixed to /usr/local/lib/wine. Once the hard problems are
</I>&gt;&gt;&gt;&gt;<i>worked out I'll take care of these things.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Hope this wasn't too much detail. Please send me any feedback you may
</I>&gt;&gt;&gt;&gt;<i>have, but keep in mind that SWF (while it may start displaying windows
</I>&gt;&gt;&gt;&gt;<i>again) will still not work properly due to the cairo/x11drv issue (and
</I>&gt;&gt;&gt;&gt;<i>potentially some of the new work done in System.Drawing)
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I'm also working on a roadmap for SWF itself, so that we can
</I>&gt;&gt;&gt;&gt;<i>coordinate work on the library, but I figure the basic framework
</I>&gt;&gt;&gt;&gt;<i>(Wine/Cairo/SWF) needs to be in working order first.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Cheers,
</I>&gt;&gt;&gt;&gt;<i> Peter
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>M. Scott Ford wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Miguel,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Thanks for the update. I remember seeing the Cairo/GDI+ conversation,
</I>&gt;&gt;&gt;&gt;&gt;<i>but I
</I>&gt;&gt;&gt;&gt;&gt;<i>had no idea that it had led to so many cool changes. WINE as a
</I>&gt;&gt;&gt;&gt;&gt;<i>library will
</I>&gt;&gt;&gt;&gt;&gt;<i>be great! Please let us know as soon as the changes are committed. I
</I>am
&gt;&gt;&gt;&gt;&gt;<i>eager to start working. :)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Are there any other lists that we should be watching to keep up with
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>the
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>news?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Thanks,
</I>&gt;&gt;&gt;&gt;&gt;<i>-Scott
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>-----Original Message-----
</I>&gt;&gt;&gt;&gt;&gt;<i>From: <A HREF="mailto:mono-winforms-list-admin@lists.ximian.com">mono-winforms-list-admin@lists.ximian.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>[mailto:<A HREF="mailto:mono-winforms-list-admin@lists.ximian.com">mono-winforms-list-admin@lists.ximian.com</A>] On Behalf Of
</I>&gt;&gt;&gt;&gt;&gt;<i>Miguel de
</I>&gt;&gt;&gt;&gt;&gt;<i>Icaza
</I>&gt;&gt;&gt;&gt;&gt;<i>Sent: Wednesday, February 18, 2004 12:14 AM
</I>&gt;&gt;&gt;&gt;&gt;<i>To: Scott Ford
</I>&gt;&gt;&gt;&gt;&gt;<i>Cc: <A HREF="mailto:mono-winforms-list@lists.ximian.com">mono-winforms-list@lists.ximian.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>Subject: RE: [Mono-winforms-list] When will winforms be working?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Hello,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>What are the problems? I have not really seen mention of any in this
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>list. If they are being discussed, where is the discussion taking
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>place?
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>I am sure that many of us are willing to help, but have no idea what
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>is
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>going on.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>The short answer is &quot;soon&quot;.  The long answer is:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>* When Peter was fixing the Wine/Cairo integration issues, he found
</I>&gt;&gt;&gt;&gt;&gt;<i>  a way of doing this cleanly: to build a driver that knows about
</I>&gt;&gt;&gt;&gt;&gt;<i>  Cairo/GDI+.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>* When he started writing the driver, we noticed that our patches
</I>Wine
&gt;&gt;&gt;&gt;&gt;<i>  was too old, and that the code we wrote would have to be discarded
</I>&gt;&gt;&gt;&gt;&gt;<i>  when we upgraded to Wine.  So...
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>* Peter started working on porting/patching the latest Wine to work
</I>&gt;&gt;&gt;&gt;&gt;<i>as   a library.  Peter noticed that the new Wine requires even less
</I>&gt;&gt;&gt;&gt;&gt;<i>changes
</I>&gt;&gt;&gt;&gt;&gt;<i>  to turn into a library and found a fairly clever way of even being
</I>&gt;&gt;&gt;&gt;&gt;<i>able
</I>&gt;&gt;&gt;&gt;&gt;<i>  to turn Wine into a library and minimizing the changes.
</I>&gt;&gt;&gt;&gt;&gt;<i>  These are good news, because we might be able to merge the few
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>changes
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>  into the main Wine.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>* We will be building packages of the modified Wine very soon now ;-)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>* Work on the C#-side of Windows.Forms will resume in a couple of
</I>days.
&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Miguel.
</I>&gt;&gt;&gt;&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;<i>Mono-winforms-list maillist  -  <A HREF="mailto:Mono-winforms-list@lists.ximian.com">Mono-winforms-list@lists.ximian.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">http://lists.ximian.com/mailman/listinfo/mono-winforms-list</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;<i>Mono-winforms-list maillist  -  <A HREF="mailto:Mono-winforms-list@lists.ximian.com">Mono-winforms-list@lists.ximian.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">http://lists.ximian.com/mailman/listinfo/mono-winforms-list</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>----------------------------------------------------------------------
</I>--
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>diff -ruN wine-20040121/configure wine-20040121-mono/configure
</I>&gt;&gt;&gt;&gt;<i>--- wine-20040121/configure 2004-01-21 18:02:29.000000000 -0700
</I>&gt;&gt;&gt;&gt;<i>+++ wine-20040121-mono/configure 2004-02-12 14:33:46.000000000 -0700
</I>&gt;&gt;&gt;&gt;<i>@@ -19070,7 +19070,7 @@
</I>&gt;&gt;&gt;&gt;<i>MAKE_PROG_RULES=programs/Makeprog.rules
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>-
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>ac_config_files=&quot;$ac_config_files Make.rules dlls/Makedll.rules
</I>&gt;&gt;&gt;<i>dlls/Maketest.rules libs/Makelib.rules programs/Makeprog.rules Makefile
</I>&gt;&gt;&gt;<i>dlls/Makefile dlls/advapi32/Makefile dlls/advapi32/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/avicap32/Makefile dlls/avifil32/Makefile dlls/cabinet/Makefile
</I>&gt;&gt;&gt;<i>dlls/capi2032/Makefile dlls/cfgmgr32/Makefile dlls/comcat/Makefile
</I>&gt;&gt;&gt;<i>dlls/comctl32/Makefile dlls/comctl32/tests/Makefile
</I>dlls/commdlg/Makefile
&gt;&gt;&gt;<i>dlls/crtdll/Makefile dlls/crypt32/Makefile dlls/ctl3d/Makefile
</I>&gt;&gt;&gt;<i>dlls/wined3d/Makefile dlls/d3d8/Makefile dlls/d3d9/Makefile
</I>&gt;&gt;&gt;<i>dlls/d3dim/Makefile dlls/d3dx8/Makefile dlls/dciman32/Makefile
</I>&gt;&gt;&gt;<i>dlls/ddraw/Makefile dlls/ddraw/tests/Makefile dlls/devenum/Makefile
</I>&gt;&gt;&gt;<i>dlls/dinput/Makefile dlls/dinput8/Makefile dlls/dmband/Makefile
</I>&gt;&gt;&gt;<i>dlls/dmcompos/Makefile dlls/dmime/Makefile dlls/dmloader/Makefile
</I>&gt;&gt;&gt;<i>dlls/dmscript/Makefile dlls/dmstyle/Makefile dlls/dmsynth/Makefile
</I>&gt;&gt;&gt;<i>dlls/dmusic/Makefile dlls/dmusic32/Makefile dlls/dplay/Makefile
</I>&gt;&gt;&gt;<i>dlls/dplayx/Makefile dlls/dpnhpast/Makefile dlls/dsound/Makefile
</I>&gt;&gt;&gt;<i>dlls/dsound/tests/Makefile dlls/dswave/Makefile dlls/gdi/Makefile
</I>&gt;&gt;&gt;<i>dlls/gdi/tests/Makefile dlls/glu32/Makefile dlls/glut32/Makefile
</I>&gt;&gt;&gt;<i>dlls/iccvid/Makefile dlls/icmp/Makefile dlls/imagehlp/Makefile
</I>&gt;&gt;&gt;<i>dlls/imm32/Makefile dlls/iphlpapi/Makefile dlls/iphlpapi/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/kernel/Makefile dlls/kernel/tests/Makefile dlls/lzexpand/Makefile
</I>&gt;&gt;&gt;<i>dlls/mapi32/Makefile dlls/mpr/Makefile dlls/msacm/Makefile
</I>&gt;&gt;&gt;<i>dlls/msacm/imaadp32/Makefile dlls/msacm/msadp32/Makefile
</I>&gt;&gt;&gt;<i>dlls/msacm/msg711/Makefile dlls/msacm/winemp3/Makefile
</I>dlls/msdmo/Makefile
&gt;&gt;&gt;<i>dlls/mshtml/Makefile dlls/msi/Makefile dlls/msimg32/Makefile
</I>&gt;&gt;&gt;<i>dlls/msisys/Makefile dlls/msnet32/Makefile dlls/msvcrt/Makefile
</I>&gt;&gt;&gt;<i>dlls/msvcrt/tests/Makefile dlls/msvcrt20/Makefile
</I>dlls/msvcrt40/Makefile
&gt;&gt;&gt;<i>dlls/msvcrtd/Makefile dlls/msvideo/Makefile
</I>dlls/msvideo/msrle32/Makefile
&gt;&gt;&gt;<i>dlls/mswsock/Makefile dlls/netapi32/Makefile
</I>dlls/netapi32/tests/Makefile
&gt;&gt;&gt;<i>dlls/newdev/Makefile dlls/ntdll/Makefile dlls/ntdll/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/odbc32/Makefile dlls/ole32/Makefile dlls/oleacc/Makefile
</I>&gt;&gt;&gt;<i>dlls/oleaut32/Makefile dlls/oleaut32/tests/Makefile
</I>dlls/olecli/Makefile
&gt;&gt;&gt;<i>dlls/oledlg/Makefile dlls/olepro32/Makefile dlls/olesvr/Makefile
</I>&gt;&gt;&gt;<i>dlls/opengl32/Makefile dlls/psapi/Makefile dlls/qcap/Makefile
</I>&gt;&gt;&gt;<i>dlls/quartz/Makefile dlls/rasapi32/Makefile dlls/richedit/Makefile
</I>&gt;&gt;&gt;<i>dlls/rpcrt4/Makefile dlls/rpcrt4/tests/Makefile dlls/serialui/Makefile
</I>&gt;&gt;&gt;<i>dlls/setupapi/Makefile dlls/shdocvw/Makefile dlls/shell32/Makefile
</I>&gt;&gt;&gt;<i>dlls/shell32/tests/Makefile dlls/shfolder/Makefile
</I>dlls/shlwapi/Makefile
&gt;&gt;&gt;<i>dlls/shlwapi/tests/Makefile dlls/snmpapi/Makefile dlls/sti/Makefile
</I>&gt;&gt;&gt;<i>dlls/tapi32/Makefile dlls/ttydrv/Makefile dlls/twain/Makefile
</I>&gt;&gt;&gt;<i>dlls/unicows/Makefile dlls/url/Makefile dlls/urlmon/Makefile
</I>&gt;&gt;&gt;<i>dlls/urlmon/tests/Makefile dlls/user/Makefile dlls/user/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/uxtheme/Makefile dlls/version/Makefile dlls/win32s/Makefile
</I>&gt;&gt;&gt;<i>dlls/winaspi/Makefile dlls/winedos/Makefile dlls/wineps/Makefile
</I>&gt;&gt;&gt;<i>dlls/wininet/Makefile dlls/wininet/tests/Makefile dlls/winmm/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/joystick/Makefile dlls/winmm/mcianim/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/mciavi/Makefile dlls/winmm/mcicda/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/mciseq/Makefile dlls/winmm/mciwave/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/midimap/Makefile dlls/winmm/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/wavemap/Makefile dlls/winmm/winealsa/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/winearts/Makefile dlls/winmm/wineaudioio/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/winenas/Makefile dlls/winmm/winejack/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/wineoss/Makefile dlls/winnls/Makefile dlls/winsock/Makefile
</I>&gt;&gt;&gt;<i>dlls/winsock/tests/Makefile dlls/winspool/Makefile
</I>&gt;&gt;&gt;<i>dlls/winspool/tests/Makefile dlls/wintab32/Makefile
</I>dlls/wintrust/Makefile
&gt;&gt;&gt;<i>dlls/wow32/Makefile dlls/wsock32/Makefile dlls/x11drv/Makefile
</I>&gt;&gt;&gt;<i>documentation/Makefile include/Makefile libs/Makefile
</I>libs/port/Makefile
&gt;&gt;&gt;<i>libs/unicode/Makefile libs/uuid/Makefile libs/wine/Makefile
</I>&gt;&gt;&gt;<i>libs/wpp/Makefile loader/Makefile programs/Makefile
</I>&gt;&gt;&gt;<i>programs/avitools/Makefile programs/clock/Makefile
</I>&gt;&gt;&gt;<i>programs/cmdlgtst/Makefile programs/control/Makefile
</I>&gt;&gt;&gt;<i>programs/expand/Makefile programs/notepad/Makefile
</I>&gt;&gt;&gt;<i>programs/progman/Makefile programs/regedit/Makefile
</I>&gt;&gt;&gt;<i>programs/regsvr32/Makefile programs/rpcss/Makefile
</I>&gt;&gt;&gt;<i>programs/rundll32/Makefile programs/start/Makefile
</I>&gt;&gt;&gt;<i>programs/uninstaller/Makefile programs/view/Makefile
</I>&gt;&gt;&gt;<i>programs/wcmd/Makefile programs/wineboot/Makefile
</I>&gt;&gt;&gt;<i>programs/winebrowser/Makefile programs/winecfg/Makefile
</I>&gt;&gt;&gt;<i>programs/wineconsole/Makefile programs/winedbg/Makefile
</I>&gt;&gt;&gt;<i>programs/winefile/Makefile programs/winemenubuilder/Makefile
</I>&gt;&gt;&gt;<i>programs/winemine/Makefile programs/winepath/Makefile
</I>&gt;&gt;&gt;<i>programs/winetest/Makefile programs/winevdm/Makefile
</I>&gt;&gt;&gt;<i>programs/winhelp/Makefile programs/winver/Makefile server/Makefile
</I>&gt;&gt;&gt;<i>tools/Makefile tools/widl/Makefile tools/winapi/Makefile
</I>&gt;&gt;&gt;<i>tools/winebuild/Makefile tools/winedump/Makefile tools/winegcc/Makefile
</I>&gt;&gt;&gt;<i>tools/wmc/Makefile tools/wrc/Makefile&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>ac_config_files=&quot;$ac_config_files Make.rules dlls/Makedll.rules
</I>&gt;&gt;&gt;<i>dlls/Maketest.rules libs/Makelib.rules programs/Makeprog.rules Makefile
</I>&gt;&gt;&gt;<i>dlls/Makefile dlls/advapi32/Makefile dlls/advapi32/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/avicap32/Makefile dlls/avifil32/Makefile dlls/cabinet/Makefile
</I>&gt;&gt;&gt;<i>dlls/capi2032/Makefile dlls/cfgmgr32/Makefile dlls/comcat/Makefile
</I>&gt;&gt;&gt;<i>dlls/comctl32/Makefile dlls/comctl32/tests/Makefile
</I>dlls/commdlg/Makefile
&gt;&gt;&gt;<i>dlls/crtdll/Makefile dlls/crypt32/Makefile dlls/ctl3d/Makefile
</I>&gt;&gt;&gt;<i>dlls/wined3d/Makefile dlls/d3d8/Makefile dlls/d3d9/Makefile
</I>&gt;&gt;&gt;<i>dlls/d3dim/Makefile dlls/d3dx8/Makefile dlls/dciman32/Makefile
</I>&gt;&gt;&gt;<i>dlls/ddraw/Makefile dlls/ddraw/tests/Makefile dlls/devenum/Makefile
</I>&gt;&gt;&gt;<i>dlls/dinput/Makefile dlls/dinput8/Makefile dlls/dmband/Makefile
</I>&gt;&gt;&gt;<i>dlls/dmcompos/Makefile dlls/dmime/Makefile dlls/dmloader/Makefile
</I>&gt;&gt;&gt;<i>dlls/dmscript/Makefile dlls/dmstyle/Makefile dlls/dmsynth/Makefile
</I>&gt;&gt;&gt;<i>dlls/dmusic/Makefile dlls/dmusic32/Makefile dlls/dplay/Makefile
</I>&gt;&gt;&gt;<i>dlls/dplayx/Makefile dlls/dpnhpast/Makefile dlls/dsound/Makefile
</I>&gt;&gt;&gt;<i>dlls/dsound/tests/Makefile dlls/dswave/Makefile dlls/gdi/Makefile
</I>&gt;&gt;&gt;<i>dlls/gdi/tests/Makefile dlls/glu32/Makefile dlls/glut32/Makefile
</I>&gt;&gt;&gt;<i>dlls/iccvid/Makefile dlls/icmp/Makefile dlls/imagehlp/Makefile
</I>&gt;&gt;&gt;<i>dlls/imm32/Makefile dlls/iphlpapi/Makefile dlls/iphlpapi/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/kernel/Makefile dlls/kernel/tests/Makefile dlls/lzexpand/Makefile
</I>&gt;&gt;&gt;<i>dlls/mapi32/Makefile dlls/mpr/Makefile dlls/msacm/Makefile
</I>&gt;&gt;&gt;<i>dlls/msacm/imaadp32/Makefile dlls/msacm/msadp32/Makefile
</I>&gt;&gt;&gt;<i>dlls/msacm/msg711/Makefile dlls/msacm/winemp3/Makefile
</I>dlls/msdmo/Makefile
&gt;&gt;&gt;<i>dlls/mshtml/Makefile dlls/msi/Makefile dlls/msimg32/Makefile
</I>&gt;&gt;&gt;<i>dlls/msisys/Makefile dlls/msnet32/Makefile dlls/msvcrt/Makefile
</I>&gt;&gt;&gt;<i>dlls/msvcrt/tests/Makefile dlls/msvcrt20/Makefile
</I>dlls/msvcrt40/Makefile
&gt;&gt;&gt;<i>dlls/msvcrtd/Makefile dlls/msvideo/Makefile
</I>dlls/msvideo/msrle32/Makefile
&gt;&gt;&gt;<i>dlls/mswsock/Makefile dlls/netapi32/Makefile
</I>dlls/netapi32/tests/Makefile
&gt;&gt;&gt;<i>dlls/newdev/Makefile dlls/ntdll/Makefile dlls/ntdll/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/odbc32/Makefile dlls/ole32/Makefile dlls/oleacc/Makefile
</I>&gt;&gt;&gt;<i>dlls/oleaut32/Makefile dlls/oleaut32/tests/Makefile
</I>dlls/olecli/Makefile
&gt;&gt;&gt;<i>dlls/oledlg/Makefile dlls/olepro32/Makefile dlls/olesvr/Makefile
</I>&gt;&gt;&gt;<i>dlls/opengl32/Makefile dlls/psapi/Makefile dlls/qcap/Makefile
</I>&gt;&gt;&gt;<i>dlls/quartz/Makefile dlls/rasapi32/Makefile dlls/richedit/Makefile
</I>&gt;&gt;&gt;<i>dlls/rpcrt4/Makefile dlls/rpcrt4/tests/Makefile dlls/serialui/Makefile
</I>&gt;&gt;&gt;<i>dlls/setupapi/Makefile dlls/shdocvw/Makefile dlls/shell32/Makefile
</I>&gt;&gt;&gt;<i>dlls/shell32/tests/Makefile dlls/shfolder/Makefile
</I>dlls/shlwapi/Makefile
&gt;&gt;&gt;<i>dlls/shlwapi/tests/Makefile dlls/snmpapi/Makefile dlls/sti/Makefile
</I>&gt;&gt;&gt;<i>dlls/tapi32/Makefile dlls/ttydrv/Makefile dlls/twain/Makefile
</I>&gt;&gt;&gt;<i>dlls/unicows/Makefile dlls/url/Makefile dlls/urlmon/Makefile
</I>&gt;&gt;&gt;<i>dlls/urlmon/tests/Makefile dlls/user/Makefile dlls/user/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/uxtheme/Makefile dlls/version/Makefile dlls/win32s/Makefile
</I>&gt;&gt;&gt;<i>dlls/winaspi/Makefile dlls/winedos/Makefile dlls/wineps/Makefile
</I>&gt;&gt;&gt;<i>dlls/wininet/Makefile dlls/wininet/tests/Makefile dlls/winmm/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/joystick/Makefile dlls/winmm/mcianim/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/mciavi/Makefile dlls/winmm/mcicda/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/mciseq/Makefile dlls/winmm/mciwave/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/midimap/Makefile dlls/winmm/tests/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/wavemap/Makefile dlls/winmm/winealsa/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/winearts/Makefile dlls/winmm/wineaudioio/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/winenas/Makefile dlls/winmm/winejack/Makefile
</I>&gt;&gt;&gt;<i>dlls/winmm/wineoss/Makefile dlls/winnls/Makefile dlls/winsock/Makefile
</I>&gt;&gt;&gt;<i>dlls/winsock/tests/Makefile dlls/winspool/Makefile
</I>&gt;&gt;&gt;<i>dlls/winspool/tests/Makefile dlls/wintab32/Makefile
</I>dlls/wintrust/Makefile
&gt;&gt;&gt;<i>dlls/wow32/Makefile dlls/wsock32/Makefile dlls/x11drv/Makefile
</I>&gt;&gt;&gt;<i>documentation/Makefile include/Makefile libs/Makefile
</I>libs/port/Makefile
&gt;&gt;&gt;<i>libs/unicode/Makefile libs/uuid/Makefile libs/wine/Makefile
</I>&gt;&gt;&gt;<i>libs/wpp/Makefile loader/Makefile programs/Makefile
</I>&gt;&gt;&gt;<i>programs/avitools/Makefile programs/clock/Makefile
</I>&gt;&gt;&gt;<i>programs/cmdlgtst/Makefile programs/control/Makefile
</I>&gt;&gt;&gt;<i>programs/expand/Makefile programs/mono-winelib/Makefile
</I>&gt;&gt;&gt;<i>programs/notepad/Makefile programs/progman/Makefile
</I>&gt;&gt;&gt;<i>programs/regedit/Makefile programs/regsvr32/Makefile
</I>&gt;&gt;&gt;<i>programs/rpcss/Makefile programs/rundll32/Makefile
</I>programs/start/Makefile
&gt;&gt;&gt;<i>programs/uninstaller/Makefile programs/view/Makefile
</I>&gt;&gt;&gt;<i>programs/wcmd/Makefile programs/wineboot/Makefile
</I>&gt;&gt;&gt;<i>programs/winebrowser/Makefile programs/winecfg/Makefile
</I>&gt;&gt;&gt;<i>programs/wineconsole/Makefile programs/winedbg/Makefile
</I>&gt;&gt;&gt;<i>programs/winefile/Makefile programs/winemenubuilder/Makefile
</I>&gt;&gt;&gt;<i>programs/winemine/Makefile programs/winepath/Makefile
</I>&gt;&gt;&gt;<i>programs/winetest/Makefile programs/winevdm/Makefile
</I>&gt;&gt;&gt;<i>programs/winhelp/Makefile programs/winver/Makefile server/Makefile
</I>&gt;&gt;&gt;<i>tools/Makefile tools/widl/Makefile tools/winapi/Makefile
</I>&gt;&gt;&gt;<i>tools/winebuild/Makefile tools/winedump/Makefile tools/winegcc/Makefile
</I>&gt;&gt;&gt;<i>tools/wmc/Makefile tools/wrc/Makefile&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>cat &gt;confcache &lt;&lt;\_ACEOF
</I>&gt;&gt;&gt;&gt;<i>@@ -19772,6 +19772,7 @@
</I>&gt;&gt;&gt;&gt;<i>  &quot;programs/cmdlgtst/Makefile&quot; ) CONFIG_FILES=&quot;$CONFIG_FILES
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>programs/cmdlgtst/Makefile&quot; ;;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  &quot;programs/control/Makefile&quot; ) CONFIG_FILES=&quot;$CONFIG_FILES
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>programs/control/Makefile&quot; ;;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  &quot;programs/expand/Makefile&quot; ) CONFIG_FILES=&quot;$CONFIG_FILES
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>programs/expand/Makefile&quot; ;;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+  &quot;programs/mono-winelib/Makefile&quot; ) CONFIG_FILES=&quot;$CONFIG_FILES
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>programs/mono-winelib/Makefile&quot; ;;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  &quot;programs/notepad/Makefile&quot; ) CONFIG_FILES=&quot;$CONFIG_FILES
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>programs/notepad/Makefile&quot; ;;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  &quot;programs/progman/Makefile&quot; ) CONFIG_FILES=&quot;$CONFIG_FILES
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>programs/progman/Makefile&quot; ;;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  &quot;programs/regedit/Makefile&quot; ) CONFIG_FILES=&quot;$CONFIG_FILES
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>programs/regedit/Makefile&quot; ;;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>diff -ruN wine-20040121/dlls/kernel/process.c
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>wine-20040121-mono/dlls/kernel/process.c
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>--- wine-20040121/dlls/kernel/process.c 2004-01-20
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>14:51:27.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+++ wine-20040121-mono/dlls/kernel/process.c 2004-02-13
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>15:14:40.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -752,8 +752,12 @@
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>        SetLastError( 0 );  /* clear error code */
</I>&gt;&gt;&gt;&gt;<i>        if (peb-&gt;BeingDebugged) DbgBreakPoint();
</I>&gt;&gt;&gt;&gt;<i>-        ExitProcess( entry( peb ) );
</I>&gt;&gt;&gt;&gt;<i>+        if (__wine_main_argc!=1 || !(__wine_main_argc==1 &amp;&amp;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>strlen(__wine_main_argv[0])&gt;=19 &amp;&amp;
</I>&gt;&gt;&gt;<i>strncasecmp(__wine_main_argv[0]+strlen(__wine_main_argv[0])-19,
</I>&gt;&gt;&gt;<i>&quot;mono-winelib.exe.so&quot;, 19)==0)) {
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+            // This starts the main app and then exits wine
</I>&gt;&gt;&gt;&gt;<i>+            ExitProcess( entry( peb ) );
</I>&gt;&gt;&gt;&gt;<i>+        }
</I>&gt;&gt;&gt;&gt;<i>    }
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>    __EXCEPT(UnhandledExceptionFilter)
</I>&gt;&gt;&gt;&gt;<i>    {
</I>&gt;&gt;&gt;&gt;<i>        TerminateThread( GetCurrentThread(), GetExceptionCode() );
</I>&gt;&gt;&gt;&gt;<i>@@ -897,7 +901,16 @@
</I>&gt;&gt;&gt;&gt;<i>    if (!THREAD_InitStack( NtCurrentTeb(), stack_size )) goto error;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>    /* switch to the new stack */
</I>&gt;&gt;&gt;&gt;<i>-    wine_switch_to_stack( start_process, NULL,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>NtCurrentTeb()-&gt;Tib.StackBase );
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+    if (__wine_main_argc==1 &amp;&amp; strlen(__wine_main_argv[0])&gt;=19 &amp;&amp;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>strncasecmp(__wine_main_argv[0]+strlen(__wine_main_argv[0])-19,
</I>&gt;&gt;&gt;<i>&quot;mono-winelib.exe.so&quot;, 19)==0) {
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+        /* We don't want a new stack. Screws up our return path */
</I>&gt;&gt;&gt;&gt;<i>+        start_process(NULL);
</I>&gt;&gt;&gt;&gt;<i>+    } else {
</I>&gt;&gt;&gt;&gt;<i>+        /* Regular wine startup */
</I>&gt;&gt;&gt;&gt;<i>+        wine_switch_to_stack( start_process, NULL,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>NtCurrentTeb()-&gt;Tib.StackBase );
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+    }
</I>&gt;&gt;&gt;&gt;<i>+    return;
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> error:
</I>&gt;&gt;&gt;&gt;<i>    ExitProcess( GetLastError() );
</I>&gt;&gt;&gt;&gt;<i>diff -ruN wine-20040121/dlls/ntdll/loader.c
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>wine-20040121-mono/dlls/ntdll/loader.c
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>--- wine-20040121/dlls/ntdll/loader.c 2004-01-07
</I>20:36:53.000000000 -0700
&gt;&gt;&gt;&gt;<i>+++ wine-20040121-mono/dlls/ntdll/loader.c 2004-02-13
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>15:17:45.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -1955,7 +1955,9 @@
</I>&gt;&gt;&gt;&gt;<i>    WINE_MODREF *wm;
</I>&gt;&gt;&gt;&gt;<i>    NTSTATUS status;
</I>&gt;&gt;&gt;&gt;<i>    ANSI_STRING func_name;
</I>&gt;&gt;&gt;&gt;<i>-    void (* DECLSPEC_NORETURN init_func)();
</I>&gt;&gt;&gt;&gt;<i>+    /* We might return for shared-lib startup */
</I>&gt;&gt;&gt;&gt;<i>+    /* void (* DECLSPEC_NORETURN init_func)(); */
</I>&gt;&gt;&gt;&gt;<i>+    void (* init_func)();
</I>&gt;&gt;&gt;&gt;<i>    extern void __wine_dbg_ntdll_init(void);
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>    thread_init();
</I>&gt;&gt;&gt;&gt;<i>diff -ruN wine-20040121/programs/Makefile.in
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>wine-20040121-mono/programs/Makefile.in
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>--- wine-20040121/programs/Makefile.in 2004-01-06
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>13:49:59.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+++ wine-20040121-mono/programs/Makefile.in 2004-02-12
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>14:32:58.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -11,6 +11,7 @@
</I>&gt;&gt;&gt;&gt;<i>cmdlgtst \
</I>&gt;&gt;&gt;&gt;<i>control \
</I>&gt;&gt;&gt;&gt;<i>expand \
</I>&gt;&gt;&gt;&gt;<i>+ mono-winelib \
</I>&gt;&gt;&gt;&gt;<i>notepad \
</I>&gt;&gt;&gt;&gt;<i>progman \
</I>&gt;&gt;&gt;&gt;<i>regedit \
</I>&gt;&gt;&gt;&gt;<i>@@ -41,6 +42,7 @@
</I>&gt;&gt;&gt;&gt;<i>clock \
</I>&gt;&gt;&gt;&gt;<i>control \
</I>&gt;&gt;&gt;&gt;<i>expand \
</I>&gt;&gt;&gt;&gt;<i>+ mono-winelib \
</I>&gt;&gt;&gt;&gt;<i>notepad \
</I>&gt;&gt;&gt;&gt;<i>progman \
</I>&gt;&gt;&gt;&gt;<i>regedit \
</I>&gt;&gt;&gt;&gt;<i>@@ -179,6 +181,9 @@
</I>&gt;&gt;&gt;&gt;<i>icinfo.exe$(DLLEXT): avitools/icinfo.exe$(DLLEXT)
</I>&gt;&gt;&gt;&gt;<i>$(RM) $@ &amp;&amp; $(LN_S) avitools/icinfo.exe$(DLLEXT) $@
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+mono-winelib.exe$(DLLEXT): mono-winelib/mono-winelib.exe$(DLLEXT)
</I>&gt;&gt;&gt;&gt;<i>+ $(RM) $@ &amp;&amp; $(LN_S) mono-winelib/mono-winelib.exe$(DLLEXT) $@
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>notepad.exe$(DLLEXT): notepad/notepad.exe$(DLLEXT)
</I>&gt;&gt;&gt;&gt;<i>$(RM) $@ &amp;&amp; $(LN_S) notepad/notepad.exe$(DLLEXT) $@
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -255,6 +260,7 @@
</I>&gt;&gt;&gt;&gt;<i>control/control.exe$(DLLEXT): control
</I>&gt;&gt;&gt;&gt;<i>expand/expand.exe$(DLLEXT): expand
</I>&gt;&gt;&gt;&gt;<i>avitools/icinfo.exe$(DLLEXT): avitools
</I>&gt;&gt;&gt;&gt;<i>+mono-winelib/mono-winelib.exe$(DLLEXT): mono-winelib
</I>&gt;&gt;&gt;&gt;<i>notepad/notepad.exe$(DLLEXT): notepad
</I>&gt;&gt;&gt;&gt;<i>progman/progman.exe$(DLLEXT): progman
</I>&gt;&gt;&gt;&gt;<i>regedit/regedit.exe$(DLLEXT): regedit
</I>&gt;&gt;&gt;&gt;<i>diff -ruN wine-20040121/programs/mono-winelib/Makefile.in
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>wine-20040121-mono/programs/mono-winelib/Makefile.in
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>--- wine-20040121/programs/mono-winelib/Makefile.in 1969-12-31
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>17:00:00.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+++ wine-20040121-mono/programs/mono-winelib/Makefile.in 2004-02-12
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>14:36:36.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -0,0 +1,26 @@
</I>&gt;&gt;&gt;&gt;<i>+TOPSRCDIR = @top_srcdir@
</I>&gt;&gt;&gt;&gt;<i>+TOPOBJDIR = ../..
</I>&gt;&gt;&gt;&gt;<i>+SRCDIR    = @srcdir@
</I>&gt;&gt;&gt;&gt;<i>+VPATH     = @srcdir@
</I>&gt;&gt;&gt;&gt;<i>+MODULE    = mono-winelib.exe
</I>&gt;&gt;&gt;&gt;<i>+APPMODE   = gui
</I>&gt;&gt;&gt;&gt;<i>+IMPORTS   = kernel32
</I>&gt;&gt;&gt;&gt;<i>+DELAYIMPORTS = user32
</I>&gt;&gt;&gt;&gt;<i>+EXTRAINCL =
</I>&gt;&gt;&gt;&gt;<i>+EXTRADEFS =
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+C_SRCS = \
</I>&gt;&gt;&gt;&gt;<i>+ mono-winelib.c \
</I>&gt;&gt;&gt;&gt;<i>+ ../../loader/pthread.c
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+RC_SRCS =
</I>&gt;&gt;&gt;&gt;<i>+RC_BINSRC =
</I>&gt;&gt;&gt;&gt;<i>+RC_BINARIES =
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+PLTESTS =
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+EXTRASUBDIRS =
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i><A HREF="mailto:+@MAKE_PROG_RULES">+@MAKE_PROG_RULES</A>@
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+### Dependencies:
</I>&gt;&gt;&gt;&gt;<i>diff -ruN wine-20040121/programs/mono-winelib/mono-winelib.c
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>wine-20040121-mono/programs/mono-winelib/mono-winelib.c
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>--- wine-20040121/programs/mono-winelib/mono-winelib.c 1969-12-31
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>17:00:00.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+++ wine-20040121-mono/programs/mono-winelib/mono-winelib.c 2004-02-13
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>14:52:52.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -0,0 +1,86 @@
</I>&gt;&gt;&gt;&gt;<i>+/*
</I>&gt;&gt;&gt;&gt;<i>+ * mono-winelib code
</I>&gt;&gt;&gt;&gt;<i>+ *
</I>&gt;&gt;&gt;&gt;<i>+ * Copyright 2004 Novell, Inc. (<A HREF="http://www.novell.com/">http://www.novell.com/</A>)
</I>&gt;&gt;&gt;&gt;<i>+ *
</I>&gt;&gt;&gt;&gt;<i>+ * This library is free software; you can redistribute it and/or
</I>&gt;&gt;&gt;&gt;<i>+ * modify it under the terms of the GNU Lesser General Public
</I>&gt;&gt;&gt;&gt;<i>+ * License as published by the Free Software Foundation; either
</I>&gt;&gt;&gt;&gt;<i>+ * version 2.1 of the License, or (at your option) any later version.
</I>&gt;&gt;&gt;&gt;<i>+ *
</I>&gt;&gt;&gt;&gt;<i>+ * This library is distributed in the hope that it will be useful,
</I>&gt;&gt;&gt;&gt;<i>+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;&gt;&gt;&gt;<i>+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
</I>&gt;&gt;&gt;&gt;<i>+ * Lesser General Public License for more details.
</I>&gt;&gt;&gt;&gt;<i>+ *
</I>&gt;&gt;&gt;&gt;<i>+ * You should have received a copy of the GNU Lesser General Public
</I>&gt;&gt;&gt;&gt;<i>+ * License along with this library; if not, write to the Free
</I>Software
&gt;&gt;&gt;&gt;<i>+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
</I>02111-1307
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>USA
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+ */
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+#include &lt;wine/library.h&gt;
</I>&gt;&gt;&gt;&gt;<i>+#include &lt;windows.h&gt;
</I>&gt;&gt;&gt;&gt;<i>+#include &lt;winsock.h&gt;
</I>&gt;&gt;&gt;&gt;<i>+#include &lt;dlfcn.h&gt;
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+/*
</I>&gt;&gt;&gt;&gt;<i>+ Dummy WinMain. Wine is modified so that this function is never
</I>actually
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>called
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+*/
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+int WINAPI
</I>&gt;&gt;&gt;&gt;<i>+WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR
</I>lpszCmdLine,
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>int nCmdShow)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+{
</I>&gt;&gt;&gt;&gt;<i>+ int dummy;
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+   dummy=GetSystemMetrics(SM_CXSCREEN);
</I>&gt;&gt;&gt;&gt;<i>+ wine_pthread_init_process(NULL);
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+   return(0);
</I>&gt;&gt;&gt;&gt;<i>+}
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+/*
</I>&gt;&gt;&gt;&gt;<i>+ WineLoadLibrary is used by System.Windows.Forms to import the Wine
</I>dlls
&gt;&gt;&gt;&gt;<i>+*/
</I>&gt;&gt;&gt;&gt;<i>+void *(*NTDLL_LoadLibraryA)(unsigned char *);
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+void *
</I>&gt;&gt;&gt;&gt;<i>+WineLoadLibrary(unsigned char *dll)
</I>&gt;&gt;&gt;&gt;<i>+{
</I>&gt;&gt;&gt;&gt;<i>+   return(NTDLL_LoadLibraryA(dll));
</I>&gt;&gt;&gt;&gt;<i>+}
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+/*
</I>&gt;&gt;&gt;&gt;<i>+ MonoWineInit() Must be called to initialize wine. We pass special
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>arguments
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+ which will tell wine to not actually run the specified
</I>&gt;&gt;&gt;&gt;<i>+ application
</I>&gt;&gt;&gt;&gt;<i>+*/
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+int
</I>&gt;&gt;&gt;&gt;<i>+MonoWineInit(void)
</I>&gt;&gt;&gt;&gt;<i>+{
</I>&gt;&gt;&gt;&gt;<i>+ unsigned char Error[1024]=&quot;&quot;;
</I>&gt;&gt;&gt;&gt;<i>+ char *WineArguments[] = {&quot;monoapp&quot;,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>&quot;/usr/local/lib/wine/mono-winelib.exe.so&quot;, NULL};
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+ void *hModule;
</I>&gt;&gt;&gt;&gt;<i>+ int FileExists;
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+ wine_init(2, WineArguments, Error, sizeof(Error));
</I>&gt;&gt;&gt;&gt;<i>+ if (Error[0]!='\0') {
</I>&gt;&gt;&gt;&gt;<i>+ printf(&quot;Wine initialization error:%s\n&quot;, Error);
</I>&gt;&gt;&gt;&gt;<i>+ exit(-1);
</I>&gt;&gt;&gt;&gt;<i>+ }
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+   /* Now load kernel32 go get the pointers for LoadLibraryA and
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>GetProcAddress */
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+   hModule=wine_dll_load(&quot;kernel32.dll&quot;, Error, sizeof(Error),
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>&amp;FileExists);
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+   if (hModule==NULL) {
</I>&gt;&gt;&gt;&gt;<i>+      printf(&quot;Error loading kernel32.dll: %s\n&quot;, Error);
</I>&gt;&gt;&gt;&gt;<i>+      exit(-2);
</I>&gt;&gt;&gt;&gt;<i>+   }
</I>&gt;&gt;&gt;&gt;<i>+
</I>&gt;&gt;&gt;&gt;<i>+   NTDLL_LoadLibraryA=dlsym(hModule, &quot;LoadLibraryA&quot;);
</I>&gt;&gt;&gt;&gt;<i>+   if (NTDLL_LoadLibraryA==NULL) {
</I>&gt;&gt;&gt;&gt;<i>+      printf(&quot;Did not find symbol LoadLibraryA in kernel32.dll\n&quot;);
</I>&gt;&gt;&gt;&gt;<i>+      exit(-3);
</I>&gt;&gt;&gt;&gt;<i>+   }
</I>&gt;&gt;&gt;&gt;<i>+}
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>----------------------------------------------------------------------
</I>--
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>System.Windows.Forms wine-patch README
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>After applying the patch to wine, run ./configure in the wine
</I>directory
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>and
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>'make &amp;&amp; make depend &amp;&amp; make install'.
</I>&gt;&gt;&gt;&gt;<i>For now the patch assumes that the prefix_dir is /usr/local.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Also, once the install is done you will need to create symbolic links
</I>for
&gt;&gt;&gt;&gt;<i>all the dlls you plan on using in System.Windows.Forms:
</I>&gt;&gt;&gt;&gt;<i>ln -s /usr/local/lib/wine/kernel32.dll.so
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>/usr/local/lib/libkernel32.dll.so
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>ln -s /usr/local/lib/wine/user32.dll.so
</I>/usr/local/lib/libuser32.dll.so
&gt;&gt;&gt;&gt;<i>ln -s /usr/local/lib/wine/gdi32.dll.so /usr/local/lib/libgdi32.dll.so
</I>&gt;&gt;&gt;&gt;<i>ln -s /usr/local/lib/wine/advapi32.dll.so
</I>/usr/local/lib/libgdi32.dll.so
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I still need to work out how to teach mono to load the libs from the
</I>wine
&gt;&gt;&gt;&gt;<i>directory and without the lib prefix.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Peter
</I>&gt;&gt;&gt;&gt;<i><A HREF="mailto:pbartok@novell.com">pbartok@novell.com</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>----------------------------------------------------------------------
</I>--
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>--- 
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>mcs-0.29/class/System.Windows.Forms/System.Windows.Forms/win32functions
</I>.cs
&gt;&gt;&gt;<i>2003-11-12 03:16:24.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+++
</I>mcs/class/System.Windows.Forms/System.Windows.Forms/win32functions.cs
&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>2004-02-12 16:47:29.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -1288,12 +1288,8 @@
</I>&gt;&gt;&gt;&gt;<i>return 0;
</I>&gt;&gt;&gt;&gt;<i>}
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>-
</I>&gt;&gt;&gt;&gt;<i>- [DllImport (&quot;libwinnt.dll.so&quot;, EntryPoint=&quot;PROCESS_InitWine&quot;)]
</I>&gt;&gt;&gt;&gt;<i>- extern static void PROCESS_InitWine (int argc, string [] args);
</I>&gt;&gt;&gt;&gt;<i>-
</I>&gt;&gt;&gt;&gt;<i>- [DllImport (&quot;libwinnt.dll.so&quot;, EntryPoint=&quot;LoadLibraryA&quot;)]
</I>&gt;&gt;&gt;&gt;<i>- extern static void NTDLL_LoadLibraryA (string s);
</I>&gt;&gt;&gt;&gt;<i>+ [DllImport (&quot;/usr/local/lib/wine/mono-winelib.exe.so&quot;,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>EntryPoint=&quot;WineLoadLibrary&quot;)]
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+ extern static void WineLoadLibrary(string s);
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>static string[] WinColors = {
</I>&gt;&gt;&gt;&gt;<i>&quot;COLOR_SCROLLBAR&quot;,
</I>&gt;&gt;&gt;&gt;<i>@@ -1389,14 +1385,12 @@
</I>&gt;&gt;&gt;&gt;<i>Console.WriteLine (&quot;MonoWin32: Needs Wine MonoStub&quot;);
</I>&gt;&gt;&gt;&gt;<i>return;
</I>&gt;&gt;&gt;&gt;<i>}
</I>&gt;&gt;&gt;&gt;<i>-
</I>&gt;&gt;&gt;&gt;<i>- string [] args = new string [1];
</I>&gt;&gt;&gt;&gt;<i>- args [0] = &quot;mono&quot;;
</I>&gt;&gt;&gt;&gt;<i>-
</I>&gt;&gt;&gt;&gt;<i>- PROCESS_InitWine (0, args);
</I>&gt;&gt;&gt;&gt;<i>- NTDLL_LoadLibraryA (&quot;kernel32.dll&quot;);
</I>&gt;&gt;&gt;&gt;<i>- NTDLL_LoadLibraryA (&quot;user32.dll&quot;);
</I>&gt;&gt;&gt;&gt;<i>- NTDLL_LoadLibraryA (&quot;comctl32.dll&quot;);
</I>&gt;&gt;&gt;&gt;<i>+ Console.WriteLine(&quot;Loading Wine dlls&quot;);
</I>&gt;&gt;&gt;&gt;<i>+ WineLoadLibrary(&quot;gdi32.dll&quot;);
</I>&gt;&gt;&gt;&gt;<i>+ WineLoadLibrary(&quot;kernel32.dll&quot;);
</I>&gt;&gt;&gt;&gt;<i>+ WineLoadLibrary(&quot;comctl32.dll&quot;);
</I>&gt;&gt;&gt;&gt;<i>+ WineLoadLibrary(&quot;user32.dll&quot;);
</I>&gt;&gt;&gt;&gt;<i>+ Console.WriteLine(&quot;Loading Wine dlls complete&quot;);
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>string gtk_colors = Environment.GetEnvironmentVariable
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>(&quot;SWF_GTK_COLORS&quot;);
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>if (gtk_colors == &quot;1&quot;) {
</I>&gt;&gt;&gt;&gt;<i>--- mcs-0.29/class/System.Windows.Forms/System.Windows.Forms/Form.cs
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>2003-11-14 21:25:32.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+++ mcs/class/System.Windows.Forms/System.Windows.Forms/Form.cs
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>2004-02-13 11:59:08.000000000 -0700
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>@@ -105,8 +105,13 @@
</I>&gt;&gt;&gt;&gt;<i>cancelButton = null;
</I>&gt;&gt;&gt;&gt;<i>}
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>- static Form () {
</I>&gt;&gt;&gt;&gt;<i>+   // Initialization for Wine
</I>&gt;&gt;&gt;&gt;<i>+ [DllImport (&quot;/usr/local/lib/wine/mono-winelib.exe.so&quot;,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>EntryPoint=&quot;MonoWineInit&quot;)]
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+ extern static int MonoWineInit();
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>+ static Form () {
</I>&gt;&gt;&gt;&gt;<i>+            Console.WriteLine(&quot;Initializing wine\n&quot;);
</I>&gt;&gt;&gt;&gt;<i>+            MonoWineInit();
</I>&gt;&gt;&gt;&gt;<i>}
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>//  --- Public Properties
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;&gt;<i>Mono-winforms-list maillist  -  <A HREF="mailto:Mono-winforms-list@lists.ximian.com">Mono-winforms-list@lists.ximian.com</A>
</I>&gt;&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">http://lists.ximian.com/mailman/listinfo/mono-winforms-list</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000616.html">[Mono-winforms-list] When will winforms be working?
</A></li>
	<LI> Next message: <A HREF="000618.html">[Mono-winforms-list] When will winforms be working?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#614">[ date ]</a>
              <a href="thread.html#614">[ thread ]</a>
              <a href="subject.html#614">[ subject ]</a>
              <a href="author.html#614">[ author ]</a>
         </LI>
       </UL>
</body></html>
