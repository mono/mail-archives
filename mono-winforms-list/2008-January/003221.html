<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Application.Run() and ContextStripMenu
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Application.Run%28%29%20and%20ContextStripMenu&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003222.html">
   <LINK REL="Next"  HREF="003223.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Application.Run() and ContextStripMenu</H1>
    <B>AutoLyrix (NoWayX)</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Application.Run%28%29%20and%20ContextStripMenu&In-Reply-To="
       TITLE="[Mono-winforms-list] Application.Run() and ContextStripMenu">autolyrix at gmail.com
       </A><BR>
    <I>Mon Jan 21 21:28:25 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003222.html">[Mono-winforms-list] [Patch] Invalidate non visible areas in scrolling
</A></li>
        <LI>Next message: <A HREF="003223.html">[Mono-winforms-list] Application.Run() and ContextStripMenu
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3221">[ date ]</a>
              <a href="thread.html#3221">[ thread ]</a>
              <a href="subject.html#3221">[ subject ]</a>
              <a href="author.html#3221">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everyone,

I have an application that does not contain a form. It has a notifyicon only.
So, I have to run my app using Application.Run() and not Application.Run(FORM)

If my notifyIcon has a contextmenustrip I get an exception:
Unhandled Exception: System.NullReferenceException: Object reference
not set to an instance of an object at
System.Windows.Forms.ToolStripDropDown.OnHandleCreated
(System.EventArgs)

The line that raise the exception inside ToolStripDropDown.cs is (line 564)
               XplatUI.SetOwner (this.Handle,
Application.MWFThread.Current.Context.MainForm.Handle);


I attached one example that generates the exception. Compile it with
-res:test.ico,test.Resources.test.ico (copy the test.ico from
somewhere), so it has an icon.
If you change the class Controller to inherit from the class Form and
call Application.Run(controller) it works just fine.... (but of
course, it shows a form!)

But I dont want to create a form... does anyone know how to fix this?
Does anyone have suggestions?

Thanks,
Alex
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: test2.cs
Url: <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20080121/2fdb40ca/attachment.pl">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20080121/2fdb40ca/attachment.pl</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003222.html">[Mono-winforms-list] [Patch] Invalidate non visible areas in scrolling
</A></li>
	<LI>Next message: <A HREF="003223.html">[Mono-winforms-list] Application.Run() and ContextStripMenu
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3221">[ date ]</a>
              <a href="thread.html#3221">[ thread ]</a>
              <a href="subject.html#3221">[ subject ]</a>
              <a href="author.html#3221">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
