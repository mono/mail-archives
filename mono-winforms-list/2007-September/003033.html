<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Dynamic drawing of Images on the form
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Dynamic%20drawing%20of%20Images%20on%20the%20form&In-Reply-To=01f901c7f546%240d700730%2428501590%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003032.html">
   <LINK REL="Next"  HREF="003037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Dynamic drawing of Images on the form</H1>
    <B>Maser, Dan</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Dynamic%20drawing%20of%20Images%20on%20the%20form&In-Reply-To=01f901c7f546%240d700730%2428501590%24%40com"
       TITLE="[Mono-winforms-list] Dynamic drawing of Images on the form">Dan.Maser at inin.com
       </A><BR>
    <I>Wed Sep 12 10:08:50 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003032.html">[Mono-winforms-list] Dynamic drawing of Images on the form
</A></li>
        <LI>Next message: <A HREF="003037.html">[Mono-winforms-list] Dynamic drawing of Images on the form
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3033">[ date ]</a>
              <a href="thread.html#3033">[ thread ]</a>
              <a href="subject.html#3033">[ subject ]</a>
              <a href="author.html#3033">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
   In most cases, yeah.  In my experience the decision is made based on how often the images change.  If there's at least 1s between images changing, then I prefer the Invalidate route and let them get painted according to the natural paint process.  If it's intended to be an animation or pseudo-animation with 4 images per second or more then I get a better effect by constructing the Graphics and painting directly outside of the OnPaint handler.  

-----Original Message-----
From: Rolf Bjarne Kvinge [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">rolflists at ya.com</A>] 
Sent: Wednesday, September 12, 2007 9:06 AM
To: Maser, Dan; 'Abir Bhattacharya'; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">mono-winforms-list at lists.ximian.com</A>
Subject: RE: [Mono-winforms-list] Dynamic drawing of Images on the form

Hi, 

&gt;<i>
</I>&gt;<i>
</I>
(...)

&gt;<i>B. you can code up the OnPaint function to paint the correct ONE of 
</I>&gt;<i>your
</I>images.&#160; Then you can make a Timer object on your form.&#160; When the timer fires, you can call the static Graphics.FromHwnd to get a graphics object and directly &gt;paint the newer image.&#160; Also update a member variable with the current image so that if your window is covered and uncovered it will paint the correct thing.

Instead of directly drawing the image, in this case use Invalidate
(ImageRectangle) which will cause OnPaint to be called, thereby avoiding Graphics.FromHwnd.

Rolf
&#160;
&#160;
______________________________________
From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">mono-winforms-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">mono-winforms-list-bounces at lists.ximian.com</A>] On Behalf Of Abir Bhattacharya
Sent: Wednesday, September 12, 2007 6:16 AM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">mono-winforms-list at lists.ximian.com</A>
Subject: [Mono-winforms-list] Dynamic drawing of Images on the form HI, 

I need to display some dynamic images on a windows form at regular intervals based on some logic. The code runs perfectly fine with .NET and as well as the Win MONO(1.2.4) platforms , but when I port the identical code to the Mono develop running on the Linux (2.6.22-Fedora) the images are displayed in sporadic bursts . 

The code snippet:
protected override void OnPaint(PaintEventArgs e)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //base.OnPaint(e);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Graphics gr ,gf;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; gr = e.Graphics;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; gf = Graphics.FromHwnd(this.Handle);

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; for (; intCtr &lt; Cntr; intCtr += 1)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // call the final rect
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //passEncStr = enS.EnCodeString((string)a2[intCtr]);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PaintFinalRect(enS.EnCodeString((string)a2[intCtr]),gr);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;Thread.Sleep(100);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; base.OnPaint(e);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; gf.FillRectangle(new SolidBrush(this.BackColor), this.ClientRectangle);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; gr.Dispose();

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (intCtr == Cntr - 1)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; intCtr = 0;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 

&#160;&#160;&#160;&#160;&#160;&#160;&#160; }

I s there a problem with the primary thread Sleep methods ?


-- Visit us at <A HREF="http://www.2pirad.com/">http://www.2pirad.com/</A> --




</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003032.html">[Mono-winforms-list] Dynamic drawing of Images on the form
</A></li>
	<LI>Next message: <A HREF="003037.html">[Mono-winforms-list] Dynamic drawing of Images on the form
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3033">[ date ]</a>
              <a href="thread.html#3033">[ thread ]</a>
              <a href="subject.html#3033">[ subject ]</a>
              <a href="author.html#3033">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
