<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Re: Error running monostub.exe.so
 after following directions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:2a5gjx302%40sneakemail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000244.html">
   <LINK REL="Next"  HREF="000247.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Re: Error running monostub.exe.so
 after following directions
   </H1>
    <B>2a5gjx302@sneakemail.com
    </B> 
    <A HREF="mailto:2a5gjx302%40sneakemail.com"
       TITLE="[Mono-winforms-list] Re: Error running monostub.exe.so
 after following directions">2a5gjx302@sneakemail.com
       </A><BR>
    <I>Sun, 27 Apr 2003 12:09:20 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="000244.html">[Mono-winforms-list] Re: Error running monostub.exe.so
 afterfollowing directions
</A></li>
        <LI> Next message: <A HREF="000247.html">[Mono-winforms-list] Re: Error running monostub.exe.so after
 following directions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#246">[ date ]</a>
              <a href="thread.html#246">[ thread ]</a>
              <a href="subject.html#246">[ subject ]</a>
              <a href="author.html#246">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At 09:18 PM 27/04/2003 +0200, Alexandre Pigolkine wrote:
&gt;<i>On Sun, 2003-04-27 at 18:03, <A HREF="mailto:2a5gjx302@sneakemail.com">2a5gjx302@sneakemail.com</A> wrote:
</I>&gt;&gt;<i> Forgot to include the output text itself :-)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> linsux:/c/mono# runwine Test.exe
</I>&gt;&gt;<i> parsing configuration file
</I>&gt;&gt;<i> initializing JIT engine
</I>&gt;&gt;<i> Initializing Boehm GC library...
</I>&gt;&gt;<i> exclusion ranges overlap
</I>&gt;<i>
</I>&gt;<i>I have this if monostub uses new libmono.so
</I>&gt;<i>Can you please check that monostub.exe.so depends on liboldmono.so.0
</I>&gt;<i>by ldd monostub.exe.so
</I>I checked this, and it is definitely depending on oldmono and not the new
mono library.

&gt;&gt;<i> wine: Unhandled exception, starting debugger...
</I>&gt;&gt;<i> Couldn't start process '10 0x40 '
</I>&gt;&gt;<i> Couldn't start process '10 0x40 '
</I>&gt;<i>...
</I>I guess WINE doesn't know how to invoke a debugger on my system :-)

&gt;<i>Alexandre
</I>

At 09:12 PM 27/04/2003 +0200, Alexandre Pigolkine wrote:
&gt;<i>Hmm, unexpected behaviour :(
</I>&gt;<i>
</I>&gt;<i>For a moment I think that monostub cannot get some symbols 
</I>&gt;<i>from gc.dll.
</I>&gt;<i>
</I>&gt;<i>Can you do following, please: 
</I>&gt;<i>
</I>&gt;<i>In the System.Windows.Forms folder, file monogc.c:
</I>&gt;<i>
</I>&gt;<i>change line
</I>&gt;<i>#define TRACE printf_stub
</I>&gt;<i>
</I>&gt;<i>to
</I>&gt;<i>
</I>&gt;<i>#define TRACE printf
</I>&gt;<i>
</I>&gt;<i>rebuild monostub, and send me output from program.
</I>&gt;<i>
</I>&gt;<i>Alexandre
</I>
I also isolated the code that outputs that error. The only place that emits
it is a function in mark_rts.c which is part of the GC. I added code to
that to emit trace information about static root exclusion ranges. Here is
the output with your change as well:

linsux:/c/mono# runwine Test.exe
parsing configuration file
initializing JIT engine
Initializing Boehm GC library...
adding exclusion range: 1084673760 1084731984
success
adding exclusion range: 1084671040 1084671360
success
GC_malloc start
GC_malloc end
(previous 2 lines repeated 2 more times)
GC_register_finalizer
GC_register_finalizer end
GC_malloc start
GC_malloc end
(previous 2 lines repeated 35 more times)
exclusion ranges overlap
wine: unhandled exception, starting debugger...
Segmentation fault
linsux:/c/mono# 

Notice that my debugging code doesn't show up in the second instance. At
first, I assumed this to mean that stderr had been redirected, since the
chance of control flow randomly jumping onto the line 'ABORT(&quot;exclusion
ranges overlap&quot;)' is exceedingly low. Unfortunately, without my debugging
code's output, it was difficult to see exactly what was going on. So, I
modified my debug code to append to a file instead of writing to the
standard error. The error file contained only the two above trace lines.

Having thought about it in more depth, it seems as though the other GC
library is being used for GC calls from the main mono interpreter, while
the WINE GC library is being used only by monogc.c directly.

What now? :-)

Jonathan

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000244.html">[Mono-winforms-list] Re: Error running monostub.exe.so
 afterfollowing directions
</A></li>
	<LI> Next message: <A HREF="000247.html">[Mono-winforms-list] Re: Error running monostub.exe.so after
 following directions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#246">[ date ]</a>
              <a href="thread.html#246">[ thread ]</a>
              <a href="subject.html#246">[ subject ]</a>
              <a href="author.html#246">[ author ]</a>
         </LI>
       </UL>
</body></html>
