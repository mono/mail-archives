<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] NullReferenceException calling	SWF.Control.set_AccessibleRole
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20NullReferenceException%20calling%0A%09SWF.Control.set_AccessibleRole&In-Reply-To=dd99b8c80608280629ha13b59xcfe65c94ca2b5f00%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002454.html">
   <LINK REL="Next"  HREF="002458.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] NullReferenceException calling	SWF.Control.set_AccessibleRole</H1>
    <B>Nick Thorpe</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20NullReferenceException%20calling%0A%09SWF.Control.set_AccessibleRole&In-Reply-To=dd99b8c80608280629ha13b59xcfe65c94ca2b5f00%40mail.gmail.com"
       TITLE="[Mono-winforms-list] NullReferenceException calling	SWF.Control.set_AccessibleRole">nt at zrho.com
       </A><BR>
    <I>Wed Aug 30 13:50:32 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002454.html">[Mono-winforms-list] NullReferenceException calling	SWF.Control.set_AccessibleRole
</A></li>
        <LI>Next message: <A HREF="002458.html">[Mono-winforms-list] NullReferenceException	calling	SWF.Control.set_AccessibleRole
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2457">[ date ]</a>
              <a href="thread.html#2457">[ thread ]</a>
              <a href="subject.html#2457">[ subject ]</a>
              <a href="author.html#2457">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I did some digging through the Infragistics code that I mentioned in my
first e-mail and I do not see any class that overrides AccessibleObject.
This UltraToolBarsDockArea extends and abstract called UltraControlBase,
which itself extends SWF.Control. Neither of the Ultra classes overrides the
Accessibility methods.

The InitControlStyles method that results in the NullRef exception is more
or less doing this:

      if (!base.DesignMode)
      {
            if (this.isPopupArea)
            {
                  base.AccessibleRole = AccessibleRole.MenuPopup;
            }
            else
            {
                  base.AccessibleRole = AccessibleRole.Grouping;
            }
      }

In .NET 1.1 that should go to:

public AccessibleRole AccessibleRole
{
      set
      {
            if (!Enum.IsDefined(typeof(AccessibleRole), value))
            {
                  throw new InvalidEnumArgumentException(&quot;value&quot;, (int)
value, typeof(AccessibleRole));
            }
            this.Properties.SetInteger(Control.PropAccessibleRole, (int)
value);
      }
}

But in MWF.Control, as I'm sure you know, it's doing:

public AccessibleRole AccessibleRole {
            set {
                AccessibilityObject.role=value;
            }

That doesn't look like a problem unless the AccessibleObject is for some
reason not getting initialized before the set.

I also tried running this on Mono 1.1.6 and it basically gave me the same
exception with the addition of:

in (wrapper stfld)
System.Object:__stfld_wrapper_System.Int32(object,intptr,intptr,intptr,int)

I don't know enough about the Mono code to say whether that is meaningful,
although I do wonder if the AccessibleRole property has a problem with the
value.

If you have any thoughts on additional things I can look at or additional
data I can provide please let me know. At this point this appears to be an
incompatibility with Mono, but I certainly don't have enough evidence to say
there's a bug here.

Thanks,
Nick


On 8/28/06, Rafael Teixeira &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">monoman at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Looking at our code, I would say that the only chance of happening a
</I>&gt;<i> null reference error is if the control that UltraToolbarsDockArea is
</I>&gt;<i> trying to set the AccessibleRole (presumbaly itself) redefines
</I>&gt;<i> (overrides) the method:
</I>&gt;<i>
</I>&gt;<i>         protected virtual AccessibleObject CreateAccessibilityInstance() {
</I>&gt;<i>                         return new Control.ControlAccessibleObject(this);
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i> With one that is not able to return a new AcessibleObject-compatible
</I>&gt;<i> instance, for some other cause.
</I>&gt;<i>
</I>&gt;<i> Good luck,
</I>&gt;<i>
</I>&gt;<i> On 8/24/06, Nick Thorpe &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">nt at zrho.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi all,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm trying to get a 3rd party GUI library (Infragistics NetAdvantage)
</I>&gt;<i> &gt; working with Mono 1.1.16.1. When I run our application it dies almost
</I>&gt;<i> &gt; instantly with this exception:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  Unhandled Exception: System.NullReferenceException: Object reference
</I>&gt;<i> not
</I>&gt;<i> &gt; set to an instance of an object
</I>&gt;<i> &gt;   at System.Windows.Forms.Control.set_AccessibleRole
</I>&gt;<i> &gt; (AccessibleRole value) [0x00000]
</I>&gt;<i> &gt;   at
</I>&gt;<i> &gt;
</I>&gt;<i> Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea.InitControlStyles
</I>&gt;<i> &gt; () [0x00000]
</I>&gt;<i> &gt;   at
</I>&gt;<i> &gt; Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea..ctor
</I>&gt;<i> &gt; () [0x00000]
</I>&gt;<i> &gt;   at (wrapper remoting-invoke-with-check)
</I>&gt;<i> &gt; Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea:.ctor
</I>&gt;<i> &gt; ()
</I>&gt;<i> &gt;   at PSOMA.Form1.InitializeComponent () [0x00000]
</I>&gt;<i> &gt;   at PSOMA.Form1..ctor () [0x00000]
</I>&gt;<i> &gt;   at (wrapper remoting-invoke-with-check) PSOMA.Form1:.ctor ()
</I>&gt;<i> &gt;   at PSOMA.Form1.Main () [0x00000]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I checked the CIL to see if the library was using something outside of
</I>&gt;<i> .NET,
</I>&gt;<i> &gt; but it looks pretty standard and is seems to be failing at this call:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   IL_0098:  call       instance void
</I>&gt;<i> &gt; [System.Windows.Forms
</I>&gt;<i> ]System.Windows.Forms.Control::set_AccessibleRole(valuetype
</I>&gt;<i> &gt; [System.Windows.Forms]System.Windows.Forms.AccessibleRole)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't know enough about SWF to say whether this is a bug, or if these
</I>&gt;<i> &gt; libraries are doing something unsupported. If anyone has any input on
</I>&gt;<i> the
</I>&gt;<i> &gt; problem I'd appreciate it.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt; Nick
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060830/83e8d604/attachment.html">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060830/83e8d604/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002454.html">[Mono-winforms-list] NullReferenceException calling	SWF.Control.set_AccessibleRole
</A></li>
	<LI>Next message: <A HREF="002458.html">[Mono-winforms-list] NullReferenceException	calling	SWF.Control.set_AccessibleRole
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2457">[ date ]</a>
              <a href="thread.html#2457">[ thread ]</a>
              <a href="subject.html#2457">[ subject ]</a>
              <a href="author.html#2457">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
