<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Question on release notes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Question%20on%20release%20notes&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="002442.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Question on release notes</H1>
    <B>Peter Dennis Bartok</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Question%20on%20release%20notes&In-Reply-To="
       TITLE="[Mono-winforms-list] Question on release notes">Peter at novonyx.com
       </A><BR>
    <I>Tue Aug  1 07:37:45 EDT 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="002442.html">{&#179;&#175;&#165;&#195;&#167;&#198;}&#162;b&#162;c&#162;d&#162;e&#182;R&#165;&#187;&#175;&#184; VCD/DVD &#179;&#211;&#185;L&#167;A&#182;R&#188;&#198;&#164;Q&#174;a&#164;&#249;&#176;&#211;&#170;&#186;&#171;~&#189;&#232; &#171;O&#195;&#210;&#181;&#180;&#165;@ &#166;n&#188;v&#164;&#249;&#162;e&#162;d&#162;c&#162;b{Atsushi}
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2441">[ date ]</a>
              <a href="thread.html#2441">[ thread ]</a>
              <a href="subject.html#2441">[ subject ]</a>
              <a href="author.html#2441">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Before 1.1.16 we stored a WM_PAINT event in the queue whenever we got an ExposeNotify for a window. We had some logic so we'd never put more than one for any particular window in, and instead just updated the existing region if one already existed, but we stored an actual WM_PAINT in the queue and it was processed along with other events in order.

Starting with 1.1.16 we matched MS behaviour. MS uses the event queue only for keyboard/mouse events (I'm simplifying a tad).
Many other messages are sent 'directly' to the window procedure on Windows, via SendMessage (for example WM_WINDOWPOSCHANGED or WM_SETFOCUS, etc).
WM_PAINT events are neither. They are returned via GetMessage, but they don't come from the queue. Instead, GetMessage returns all events from the queue, and once there are no more real events, it looks if there are any windows with invalid content. If it firds one, it generates and returns a WM_PAINT event for each of these windows, and so on. Starting with 1.1.16 our driver behaves like that. 
Around the same timeframe we also added thread-specific message queues. That means that events events are stored in an event queue associated with the thread that created the window, allowing multiple message queues to run in parallel in the same app in multiple threads, again matching MS.

Hope my explanation makes sense. If you still have an old MSDN subscription, search for the &quot;GetMessage and PeekMessage Internals&quot; article, MS seems to recently have removed it from their website or I would have given you a link.

Cheers
       Peter

-----Original Message-----
From: &quot;Dennis Hayes&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">dennisdotnet at yahoo.com</A>&gt;
To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">mono-winforms-list at lists.ximian.com</A>&gt;
Date: Tuesday, August 01, 2006 04:17
Subject: [Mono-winforms-list] Question on release notes


  The release notes for 1.1.16 states:
   
  &#147;Repaint logic changed: Instead of having paint events that are contained in the queue and make their way to the head of the queue, we now only generate synthetic paint events for dirty windows once the queue is empty. This matches MS behavior and allows for a more responsive UI if lots of activity (or slow drawing) happens.&#148;
   
  Can someone give me a short explanation of that to me?
  I assume it means something like if there are more than one paint event in the que, you try to combine them together if possible.
   
  I need to explain this to the readers of my &#147;Monkey Business&#148; column, and want to get it right.
   
  Thanks,
  Dennis


------------------------------------------------------------------------------
  Talk is cheap. Use Yahoo! Messenger to make PC-to-Phone calls. Great rates starting at 1&#162;/min.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060801/624e0521/attachment.html">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060801/624e0521/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="002442.html">{&#179;&#175;&#165;&#195;&#167;&#198;}&#162;b&#162;c&#162;d&#162;e&#182;R&#165;&#187;&#175;&#184; VCD/DVD &#179;&#211;&#185;L&#167;A&#182;R&#188;&#198;&#164;Q&#174;a&#164;&#249;&#176;&#211;&#170;&#186;&#171;~&#189;&#232; &#171;O&#195;&#210;&#181;&#180;&#165;@ &#166;n&#188;v&#164;&#249;&#162;e&#162;d&#162;c&#162;b{Atsushi}
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2441">[ date ]</a>
              <a href="thread.html#2441">[ thread ]</a>
              <a href="subject.html#2441">[ subject ]</a>
              <a href="author.html#2441">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
