<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] NullReferenceException	callingSWF.Control.set_AccessibleRole
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20NullReferenceException%0A%09callingSWF.Control.set_AccessibleRole&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002471.html">
   <LINK REL="Next"  HREF="002461.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] NullReferenceException	callingSWF.Control.set_AccessibleRole</H1>
    <B>Peter Dennis Bartok</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20NullReferenceException%0A%09callingSWF.Control.set_AccessibleRole&In-Reply-To="
       TITLE="[Mono-winforms-list] NullReferenceException	callingSWF.Control.set_AccessibleRole">Peter at novonyx.com
       </A><BR>
    <I>Wed Aug 30 14:03:33 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002471.html">[Mono-winforms-list] [PATCH] ListView sorting fixes
</A></li>
        <LI>Next message: <A HREF="002461.html">[Mono-winforms-list] Weird issues reading pixels of jpg file on osx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2459">[ date ]</a>
              <a href="thread.html#2459">[ thread ]</a>
              <a href="subject.html#2459">[ subject ]</a>
              <a href="author.html#2459">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You did not just post decompiled Microsoft code, did you?

You just killed any chance of anyone who read your message fixing that 
function.

Do not post decompiled code to the list. Do not decompile MS code if you're 
involved with fixing MWF, or even making suggestions on how to fix bugs you 
encounter.

Peter

-----Original Message-----
From: &quot;Nick Thorpe&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">nt at zrho.com</A>&gt;
To: &quot;Rafael Teixeira&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">monoman at gmail.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">mono-winforms-list at lists.ximian.com</A>&gt;
Date: Wednesday, August 30, 2006 13:50
Subject: Re: [Mono-winforms-list] NullReferenceException 
callingSWF.Control.set_AccessibleRole


&gt;<i>I did some digging through the Infragistics code that I mentioned in my
</I>&gt;<i>first e-mail and I do not see any class that overrides AccessibleObject.
</I>&gt;<i>This UltraToolBarsDockArea extends and abstract called UltraControlBase,
</I>&gt;<i>which itself extends SWF.Control. Neither of the Ultra classes overrides 
</I>&gt;<i>the
</I>&gt;<i>Accessibility methods.
</I>&gt;<i>
</I>&gt;<i>The InitControlStyles method that results in the NullRef exception is more
</I>&gt;<i>or less doing this:
</I>&gt;<i>
</I>&gt;<i>      if (!base.DesignMode)
</I>&gt;<i>      {
</I>&gt;<i>            if (this.isPopupArea)
</I>&gt;<i>            {
</I>&gt;<i>                  base.AccessibleRole = AccessibleRole.MenuPopup;
</I>&gt;<i>            }
</I>&gt;<i>            else
</I>&gt;<i>            {
</I>&gt;<i>                  base.AccessibleRole = AccessibleRole.Grouping;
</I>&gt;<i>            }
</I>&gt;<i>      }
</I>&gt;<i>
</I>&gt;<i>In .NET 1.1 that should go to:
</I>&gt;<i>
</I>&gt;<i>public AccessibleRole AccessibleRole
</I>&gt;<i>{
</I>&gt;<i>      set
</I>&gt;<i>      {
</I>&gt;<i>            if (!Enum.IsDefined(typeof(AccessibleRole), value))
</I>&gt;<i>            {
</I>&gt;<i>                  throw new InvalidEnumArgumentException(&quot;value&quot;, (int)
</I>&gt;<i>value, typeof(AccessibleRole));
</I>&gt;<i>            }
</I>&gt;<i>            this.Properties.SetInteger(Control.PropAccessibleRole, (int)
</I>&gt;<i>value);
</I>&gt;<i>      }
</I>&gt;<i>}
</I>&gt;<i>
</I>&gt;<i>But in MWF.Control, as I'm sure you know, it's doing:
</I>&gt;<i>
</I>&gt;<i>public AccessibleRole AccessibleRole {
</I>&gt;<i>            set {
</I>&gt;<i>                AccessibilityObject.role=value;
</I>&gt;<i>            }
</I>&gt;<i>
</I>&gt;<i>That doesn't look like a problem unless the AccessibleObject is for some
</I>&gt;<i>reason not getting initialized before the set.
</I>&gt;<i>
</I>&gt;<i>I also tried running this on Mono 1.1.6 and it basically gave me the same
</I>&gt;<i>exception with the addition of:
</I>&gt;<i>
</I>&gt;<i>in (wrapper stfld)
</I>&gt;<i>System.Object:__stfld_wrapper_System.Int32(object,intptr,intptr,intptr,int)
</I>&gt;<i>
</I>&gt;<i>I don't know enough about the Mono code to say whether that is meaningful,
</I>&gt;<i>although I do wonder if the AccessibleRole property has a problem with the
</I>&gt;<i>value.
</I>&gt;<i>
</I>&gt;<i>If you have any thoughts on additional things I can look at or additional
</I>&gt;<i>data I can provide please let me know. At this point this appears to be an
</I>&gt;<i>incompatibility with Mono, but I certainly don't have enough evidence to 
</I>&gt;<i>say
</I>&gt;<i>there's a bug here.
</I>&gt;<i>
</I>&gt;<i>Thanks,
</I>&gt;<i>Nick
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>On 8/28/06, Rafael Teixeira &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">monoman at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Looking at our code, I would say that the only chance of happening a
</I>&gt;&gt;<i> null reference error is if the control that UltraToolbarsDockArea is
</I>&gt;&gt;<i> trying to set the AccessibleRole (presumbaly itself) redefines
</I>&gt;&gt;<i> (overrides) the method:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         protected virtual AccessibleObject CreateAccessibilityInstance() 
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i>                         return new Control.ControlAccessibleObject(this);
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> With one that is not able to return a new AcessibleObject-compatible
</I>&gt;&gt;<i> instance, for some other cause.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Good luck,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 8/24/06, Nick Thorpe &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">nt at zrho.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; Hi all,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I'm trying to get a 3rd party GUI library (Infragistics NetAdvantage)
</I>&gt;&gt;<i> &gt; working with Mono 1.1.16.1. When I run our application it dies almost
</I>&gt;&gt;<i> &gt; instantly with this exception:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;  Unhandled Exception: System.NullReferenceException: Object reference
</I>&gt;&gt;<i> not
</I>&gt;&gt;<i> &gt; set to an instance of an object
</I>&gt;&gt;<i> &gt;   at System.Windows.Forms.Control.set_AccessibleRole
</I>&gt;&gt;<i> &gt; (AccessibleRole value) [0x00000]
</I>&gt;&gt;<i> &gt;   at
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea.InitControlStyles
</I>&gt;&gt;<i> &gt; () [0x00000]
</I>&gt;&gt;<i> &gt;   at
</I>&gt;&gt;<i> &gt; Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea..ctor
</I>&gt;&gt;<i> &gt; () [0x00000]
</I>&gt;&gt;<i> &gt;   at (wrapper remoting-invoke-with-check)
</I>&gt;&gt;<i> &gt; Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea:.ctor
</I>&gt;&gt;<i> &gt; ()
</I>&gt;&gt;<i> &gt;   at PSOMA.Form1.InitializeComponent () [0x00000]
</I>&gt;&gt;<i> &gt;   at PSOMA.Form1..ctor () [0x00000]
</I>&gt;&gt;<i> &gt;   at (wrapper remoting-invoke-with-check) PSOMA.Form1:.ctor ()
</I>&gt;&gt;<i> &gt;   at PSOMA.Form1.Main () [0x00000]
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I checked the CIL to see if the library was using something outside of
</I>&gt;&gt;<i> .NET,
</I>&gt;&gt;<i> &gt; but it looks pretty standard and is seems to be failing at this call:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;   IL_0098:  call       instance void
</I>&gt;&gt;<i> &gt; [System.Windows.Forms
</I>&gt;&gt;<i> ]System.Windows.Forms.Control::set_AccessibleRole(valuetype
</I>&gt;&gt;<i> &gt; [System.Windows.Forms]System.Windows.Forms.AccessibleRole)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I don't know enough about SWF to say whether this is a bug, or if these
</I>&gt;&gt;<i> &gt; libraries are doing something unsupported. If anyone has any input on
</I>&gt;&gt;<i> the
</I>&gt;&gt;<i> &gt; problem I'd appreciate it.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks,
</I>&gt;&gt;<i> &gt; Nick
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;<i> 
</I>
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002471.html">[Mono-winforms-list] [PATCH] ListView sorting fixes
</A></li>
	<LI>Next message: <A HREF="002461.html">[Mono-winforms-list] Weird issues reading pixels of jpg file on osx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2459">[ date ]</a>
              <a href="thread.html#2459">[ thread ]</a>
              <a href="subject.html#2459">[ subject ]</a>
              <a href="author.html#2459">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
