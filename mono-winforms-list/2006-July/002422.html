<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Feedback for System.Windows.Forms.VisualStyles
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Feedback%20for%20System.Windows.Forms.VisualStyles&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002421.html">
   <LINK REL="Next"  HREF="002423.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Feedback for System.Windows.Forms.VisualStyles</H1>
    <B>Jonathan Pobst</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Feedback%20for%20System.Windows.Forms.VisualStyles&In-Reply-To="
       TITLE="[Mono-winforms-list] Feedback for System.Windows.Forms.VisualStyles">monkey at jpobst.com
       </A><BR>
    <I>Wed Jul 19 15:46:38 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002421.html">[Mono-winforms-list] Endians
</A></li>
        <LI>Next message: <A HREF="002423.html">[Mono-winforms-list] Feedback	for	System.Windows.Forms.VisualStyles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2422">[ date ]</a>
              <a href="thread.html#2422">[ thread ]</a>
              <a href="subject.html#2422">[ subject ]</a>
              <a href="author.html#2422">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've written an implementation of the VisualStyles namespace for Mono 
(MWF 2.0).  If anyone is feeling bored and/or adventurous, I'd 
appreciate it if they can verify that I've included all the required 
patches and that it works for someone other than myself.  Obviously, 
this API is designed to only work on XP/2003/Vista with Windows Visual 
Styles turned on, however it is designed so that any API consumers are 
required to check for available functionality before using it, since it 
doesn't run on Windows 9X (even on MS).

First you will need this patch for System.Drawing.Graphics (or else you 
will get &quot;Object Busy&quot; exceptions):
<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/2006-July/019407.html">http://lists.ximian.com/pipermail/mono-devel-list/2006-July/019407.html</A>

Then you will need the attached patch &quot;application.patch&quot; which adds the 
Application.RenderWithVisualStyles and Application.VisualStyleState 
methods, as well as changes to XPlatUI to expose the themes_enabled 
variable.

Finally, you will need to add the classes in the zip file to 
System.Windows.Forms.dll.

Once you get everything compiled, you can compile and run the attached 
Form1.cs.  It will present you with a tree of every defined style part.  
Selecting each one will use Windows Visual Styles to draw the style part 
as well as query various information about the style part and theme.

If anyone tries this, please let me know how it goes for you.

Thanks!
Jonathan
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: application.patch
Url: <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060719/0f9c4b8c/attachment-0002.pl">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060719/0f9c4b8c/attachment-0002.pl</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: System.Windows.Forms.VisualStyles.zip
Type: application/x-zip-compressed
Size: 60830 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060719/0f9c4b8c/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060719/0f9c4b8c/attachment-0001.bin</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Form1.cs
Url: <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060719/0f9c4b8c/attachment-0003.pl">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20060719/0f9c4b8c/attachment-0003.pl</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002421.html">[Mono-winforms-list] Endians
</A></li>
	<LI>Next message: <A HREF="002423.html">[Mono-winforms-list] Feedback	for	System.Windows.Forms.VisualStyles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2422">[ date ]</a>
              <a href="thread.html#2422">[ thread ]</a>
              <a href="subject.html#2422">[ subject ]</a>
              <a href="author.html#2422">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
