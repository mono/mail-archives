<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] PATCH: Correct layouting of child controls on
	windows with menus
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20PATCH%3A%20Correct%20layouting%20of%20child%20controls%20on%0A%09windows%20with%20menus&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001900.html">
   <LINK REL="Next"  HREF="001904.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] PATCH: Correct layouting of child controls on
	windows with menus</H1>
    <B>Rafael Teixeira</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20PATCH%3A%20Correct%20layouting%20of%20child%20controls%20on%0A%09windows%20with%20menus&In-Reply-To="
       TITLE="[Mono-winforms-list] PATCH: Correct layouting of child controls on
	windows with menus">monoman at gmail.com
       </A><BR>
    <I>Fri Aug 19 00:43:05 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001900.html">[Mono-winforms-list] Master's Thesis
</A></li>
        <LI>Next message: <A HREF="001904.html">[Mono-winforms-list] PATCH: FullRowSelection implemented in TreeView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1903">[ date ]</a>
              <a href="thread.html#1903">[ thread ]</a>
              <a href="subject.html#1903">[ subject ]</a>
              <a href="author.html#1903">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've spent the whole day chasing why my StatusBar, docked at the
bottom of my form, was nearly out-of-sight on MWF. The problem was
that the ClientSize wasn't being correctly adjusted by subtracting the
Menu height. The attached diff corrects the two problems leading to
this and some other bits, with the Changelog entry:

2005-08-19  Rafael Teixeira &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">rafaelteixeirabr at hotmail.com</A>&gt; 
	-- Making Windows with Menus layout correctly --
	* XplatUI.cs : Just an updated console reminder
	* Form.cs : The first leg of the fix
		Menu setter - adjust Client Size as needed to make space for the menu
		SetClientSizeCore - doesn't call base version to be able to pass the 
			menu handle to XplatUI.CalculateWindowRect
	* Hwnd.cs: Fix for menu_height, now gets from MenuAPI.MENU
	* XplatUIX11.cs: The critical second leg of the fix
		GetWindowPos needs to use a recalculated client_rect
		so that resizing the window doesn't break layout of child controls. 
		Also a more complete rule to avoid X Server roundtrips in SetWindowPos


May I commit?

-- 
Rafael &quot;Monoman&quot; Teixeira
---------------------------------------
I'm trying to become a &quot;Rosh Gadol&quot; before my own eyes. 
See <A HREF="http://www.joelonsoftware.com/items/2004/12/06.html">http://www.joelonsoftware.com/items/2004/12/06.html</A> for enlightment.
It hurts!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mwfmenuxlayout.diff
Type: text/x-patch
Size: 6750 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20050819/57851785/mwfmenuxlayout.bin">http://lists.ximian.com/pipermail/mono-winforms-list/attachments/20050819/57851785/mwfmenuxlayout.bin</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001900.html">[Mono-winforms-list] Master's Thesis
</A></li>
	<LI>Next message: <A HREF="001904.html">[Mono-winforms-list] PATCH: FullRowSelection implemented in TreeView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1903">[ date ]</a>
              <a href="thread.html#1903">[ thread ]</a>
              <a href="subject.html#1903">[ subject ]</a>
              <a href="author.html#1903">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
