<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] ImageViewer still causing problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20ImageViewer%20still%20causing%20problems&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002334.html">
   <LINK REL="Next"  HREF="002345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] ImageViewer still causing problems</H1>
    <B>PFJ</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20ImageViewer%20still%20causing%20problems&In-Reply-To="
       TITLE="[Mono-winforms-list] ImageViewer still causing problems">paul at all-the-johnsons.co.uk
       </A><BR>
    <I>Wed Apr 19 09:33:56 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002334.html">[Mono-winforms-list] set_Value seems to be having a problem
</A></li>
        <LI>Next message: <A HREF="002345.html">[Mono-winforms-list] ImageViewer still causing problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2331">[ date ]</a>
              <a href="thread.html#2331">[ thread ]</a>
              <a href="subject.html#2331">[ subject ]</a>
              <a href="author.html#2331">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Again, same source as I posted yesterday (below). If I load a jpeg in
and drag the slider bars, it rescales the window rather than show the
next section of the picture.

If I click beneath where the slider is (so it's on the bar itself), then
the picture moves.

I reserve the right to be wrong, insane or a bit foamy on this. I will
put it into BZ if needs be. Mono was compiled about 20 minutes before
posting this email ( 14:15 BST )

8--&gt;
/*
 * ImageViewer.cs - Simple MDI-based image viewer.
 *
 * Copyright (C) 2003  Southern Storm Software, Pty Ltd.
 *
 * This program is free software, you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY, without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program, if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307
USA
 */

using System;
using System.IO;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Windows.Forms;

public class ImageViewer : Form
{
	private ImageViewer()
	{
		MenuItem openMenuItem = new MenuItem(&quot;Open&quot;);
		MenuItem quitMenuItem = new MenuItem(&quot;Quit&quot;);
		MenuItem fileMenuItem =
			new MenuItem(&quot;File&quot;, new MenuItem[]
				{openMenuItem, quitMenuItem});
		MainMenu mainMenu = new MainMenu(new MenuItem[] { fileMenuItem });
		Menu = mainMenu;

		Size = new Size(600, 500);
		Text = &quot;DotGNU Image Viewer&quot;;
		IsMdiContainer = true;

		openMenuItem.Click += new EventHandler(OpenClicked);
		quitMenuItem.Click += new EventHandler(QuitClicked);
	}

	private void OpenClicked(Object sender, EventArgs e)
	{
		OpenFileDialog dialog = new OpenFileDialog();
		dialog.Filter =
			&quot;All image files (*.bmp, *.jpg, *.png, *.gif, *.ico, *.cur)&quot; +
			&quot;|*.bmp;*.jpg;*.png;*.gif;*.ico;*.cur&quot; +
			&quot;|BMP files (*.bmp)|*.bmp&quot; +
			&quot;|JPEG files (*.jpg)|*.jpg&quot; +
			&quot;|PNG files (*.png)|*.png&quot; +
			&quot;|GIF files (*.gif)|*.gif&quot; +
			&quot;|Icon files (*.ico)|*.ico&quot; +
			&quot;|Cursor files (*.cur)|*.cur&quot; +
			&quot;|All files (*.*)|*.*&quot;;
		if(dialog.ShowDialog(this) == DialogResult.OK)
		{
			Bitmap image;
			try
			{
				image = new Bitmap(dialog.FileName);
			}
			catch(Exception)
			{
				MessageBox.Show
					(String.Format(&quot;Unknown image format for \&quot;{0}\&quot;&quot;,
								   dialog.FileName),
					 &quot;Error&quot;, MessageBoxButtons.OK, MessageBoxIcon.Hand);
				image = null;
			}
			if(image != null)
			{
				ImageWindow window = new ImageWindow
					(dialog.FileName, image);
				window.MdiParent = this;
				window.Visible = true;
			}
		}
	}

	private void QuitClicked(Object sender, EventArgs e)
	{
		Close();
	}

	protected override bool ProcessDialogKey(Keys keyData)
	{
		if(keyData == (Keys.Control | Keys.O))
		{
			OpenClicked(this, EventArgs.Empty);
			return true;
		}
		return base.ProcessDialogKey(keyData);
	}

	public static void Main(String[] args)
	{
		ImageViewer form = new ImageViewer();
		Application.Run(form);
	}

}

internal class ImageWindow : Form
{
	private Image image;

	public ImageWindow(String filename, Image image)
	{
		this.image = image;
		ClientSize = image.Size;
		Text = Path.GetFileName(filename);
	}

	protected override void OnPaint(PaintEventArgs args)
	{
		args.Graphics.DrawImage(image, 0, 0);
	}

}
&lt;--8

TTFN

Paul
-- 
&quot;Logic, my dear Zoe, is merely the ability to be wrong with authority&quot; -
Dr Who

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002334.html">[Mono-winforms-list] set_Value seems to be having a problem
</A></li>
	<LI>Next message: <A HREF="002345.html">[Mono-winforms-list] ImageViewer still causing problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2331">[ date ]</a>
              <a href="thread.html#2331">[ thread ]</a>
              <a href="subject.html#2331">[ subject ]</a>
              <a href="author.html#2331">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
