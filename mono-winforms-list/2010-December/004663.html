<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-winforms-list] Help fixing bug 661753 (cloning ToolStripItem	objects)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Help%20fixing%20bug%20661753%20%28cloning%20ToolStripItem%0A%09objects%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004662.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-winforms-list] Help fixing bug 661753 (cloning ToolStripItem	objects)</H1>
    <B>stifu at free.fr</B> 
    <A HREF="mailto:mono-winforms-list%40lists.ximian.com?Subject=%5BMono-winforms-list%5D%20Help%20fixing%20bug%20661753%20%28cloning%20ToolStripItem%0A%09objects%29&In-Reply-To="
       TITLE="[Mono-winforms-list] Help fixing bug 661753 (cloning ToolStripItem	objects)">stifu at free.fr
       </A><BR>
    <I>Fri Dec 31 12:18:40 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004662.html">[Mono-winforms-list] Winforms and Monomac
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4663">[ date ]</a>
              <a href="thread.html#4663">[ thread ]</a>
              <a href="subject.html#4663">[ subject ]</a>
              <a href="author.html#4663">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>See bug 661753: TreeNode clones aren't complete, some properties are missing.

This is the code I have so far (in TreeNode.cs):


		public virtual object Clone()
		{
			TreeNode tn = (TreeNode)Activator.CreateInstance (GetType ());
			tn.name = name;
			tn.text = text;
			tn.image_key = image_key;
			tn.image_index = image_index;
			tn.selected_image_index = selected_image_index;
			tn.selected_image_key = selected_image_key;
			tn.state_image_index = state_image_index;
			tn.state_image_key = state_image_key;
			if (nodes != null) {
				foreach (TreeNode child in nodes)
					tn.nodes.Add ((TreeNode)child.Clone ());
			}
			if (context_menu != null) {
			    tn.context_menu = new ContextMenu();
				foreach (MenuItem item in context_menu.menu_items)
				    tn.context_menu.menu_items.Add (item.CloneMenu ());
			}
			if (context_menu_strip != null) {
			    tn.context_menu_strip = new ContextMenuStrip();
				//foreach (ToolStripItem item in context_menu_strip.Items)
				//    tn.context_menu_strip.Items.Add (item.Clone ());
			}
			tn.tag = tag;
			tn.check = check;
			tn.tool_tip_text = tool_tip_text;
			if (prop_bag != null)
				tn.prop_bag = OwnerDrawPropertyBag.Copy (prop_bag);
			return tn;	
		}


However, the problem is the commented lines for context_menu_strip: I can't clone the ToolStripItem objects, as it has no clone method.
So, what would be the best way to clone the ToolStripItem objects? Do I have to copy each property manually (as in here: <A HREF="http://blogs.msdn.com/b/jfoscoding/archive/2005/09/28/475177.aspx">http://blogs.msdn.com/b/jfoscoding/archive/2005/09/28/475177.aspx</A>)? Hopefully not... If I have to, maybe I should make it an internal method inside ToolStripItem, so other objects can reuse it...?

Thanks for the help.

PS: the original code used both private fields and public properties, but mostly private fields, so I homogenized the whole thing and used private fields everywhere (as I don't think it's necessary to run the property code in this case). Maybe I should have used public properties instead... *shrugs*
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004662.html">[Mono-winforms-list] Winforms and Monomac
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4663">[ date ]</a>
              <a href="thread.html#4663">[ thread ]</a>
              <a href="subject.html#4663">[ subject ]</a>
              <a href="author.html#4663">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-winforms-list">More information about the Mono-winforms-list
mailing list</a><br>
</body></html>
