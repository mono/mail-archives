<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Cocoa-sharp] debug log fix checked in
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:umuff%40quark.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000293.html">
   <LINK REL="Next"  HREF="000295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cocoa-sharp] debug log fix checked in
   </H1>
    <B>Urs C Muff
    </B> 
    <A HREF="mailto:umuff%40quark.com"
       TITLE="[Cocoa-sharp] debug log fix checked in">umuff@quark.com
       </A><BR>
    <I>Wed, 8 Sep 2004 07:11:03 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="000293.html">[Cocoa-sharp] patch problem
</A></li>
        <LI> Next message: <A HREF="000295.html">[Cocoa-sharp] Alternate build scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#294">[ date ]</a>
              <a href="thread.html#294">[ thread ]</a>
              <a href="subject.html#294">[ subject ]</a>
              <a href="author.html#294">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Adhamh,

I checked in a fix for the debug log stuff, here is the diff I checked 
in:

<A HREF="mailto:umuff@umuff-g5">umuff@umuff-g5</A>:~/mono-cvs/cocoa-sharp/generator&gt; cvs diff -u
Index: Interface.cs
===================================================================
RCS file: /cvs/public/cocoa-sharp/generator/Interface.cs,v
retrieving revision 1.24
diff -u -r1.24 Interface.cs
--- Interface.cs        1 Jul 2004 12:41:33 -0000       1.24
+++ Interface.cs        8 Sep 2004 11:58:59 -0000
@@ -95,9 +95,8 @@
                         foreach(string import in Imports)
                                 _gs.WriteLine(&quot;#import &lt;{0}&gt;&quot;, import);

-                       _gs.WriteLine();
-                       _gs.WriteLine(&quot;BOOL sIs{0}Verbose = YES;&quot;,Name);
-                       _gs.WriteLine(&quot;BOOL Is{0}Verbose() {{ return 
sIs{0}Verbose; }}&quot;,Name);
+                       _gs.WriteLine(&quot;BOOL sIs{0}Verbose = NO; BOOL 
sIs{0}VerboseInit = NO; void Init{0}Verbose() {{ if (sIs{0}VerboseInit) 
return; sIs{0}VerboseInit = YES; sIs{0}Verbose = 
getenv(\&quot;COCOASHARP_DEBUG_LEVEL\&quot;) != 0 &amp;&amp; 
atoi(getenv(\&quot;COCOASHARP_DEBUG_LEVEL\&quot;)) &gt;= 1; }}&quot;,Name);
+                       _gs.WriteLine(&quot;BOOL Is{0}Verbose() {{ 
Init{0}Verbose(); return sIs{0}Verbose; }}&quot;,Name);
                         _gs.WriteLine(&quot;void Set{0}Verbose(BOOL verbose) 
{{ sIs{0}Verbose = verbose; }}&quot;,Name);
                         _gs.WriteLine();

Index: custom/Foundation/NSObject.addin
===================================================================
RCS file: 
/cvs/public/cocoa-sharp/generator/custom/Foundation/NSObject.addin,v
retrieving revision 1.29
diff -u -r1.29 NSObject.addin
--- custom/Foundation/NSObject.addin    7 Sep 2004 21:16:37 -0000       
1.29
+++ custom/Foundation/NSObject.addin    8 Sep 2004 11:59:00 -0000
@@ -20,14 +20,13 @@
                         return TypeConverter.Net2NS(obj);
                 }

-        public static string debugLevel = 
System.Environment.GetEnvironmentVariable(&quot;COCOASHARP_DEBUG_LEVEL&quot;);
+               public static int sDebugLevel = 0;

+               //level 1 = error
+               //level 2 = debug
                 public static void DebugLog(int debug_level, string 
message, params object[]args) {
-                       //level 1 = error
-                       //level 2 = debug
-                       if (debugLevel != null  &amp;&amp; 
Int32.Parse(debugLevel) &gt;= debug_level) {
+                       if (sDebugLevel &gt;= debug_level)
                                 Console.WriteLine(message,args);
-                               }
                 }

                 private IntPtr _obj;
@@ -282,6 +281,11 @@
                 static NSObject() {
                         sClassHandler = new 
ClassHandlerDelegate(ClassHandler);
                         InitGlue(sClassHandler);
+                       string debugLevel = 
System.Environment.GetEnvironmentVariable(&quot;COCOASHARP_DEBUG_LEVEL&quot;);
+                       try {
+                               sDebugLevel = int.Parse(debugLevel);
+                       }
+                       catch {}
                 }

                 #endregion


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000293.html">[Cocoa-sharp] patch problem
</A></li>
	<LI> Next message: <A HREF="000295.html">[Cocoa-sharp] Alternate build scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#294">[ date ]</a>
              <a href="thread.html#294">[ thread ]</a>
              <a href="subject.html#294">[ subject ]</a>
              <a href="author.html#294">[ author ]</a>
         </LI>
       </UL>
</body></html>
