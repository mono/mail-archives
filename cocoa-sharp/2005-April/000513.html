<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Cocoa-sharp] question about Coca# internal
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:grompf%40sublimeintervention.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000512.html">
   <LINK REL="Next"  HREF="000514.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cocoa-sharp] question about Coca# internal
   </H1>
    <B>kangaroo
    </B> 
    <A HREF="mailto:grompf%40sublimeintervention.com"
       TITLE="[Cocoa-sharp] question about Coca# internal">grompf@sublimeintervention.com
       </A><BR>
    <I>Tue, 26 Apr 2005 01:14:55 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="000512.html">[Cocoa-sharp] question about Coca# internal
</A></li>
        <LI> Next message: <A HREF="000514.html">[Cocoa-sharp] question about Coca# internal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#513">[ date ]</a>
              <a href="thread.html#513">[ thread ]</a>
              <a href="subject.html#513">[ subject ]</a>
              <a href="author.html#513">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Describing the full architecture of cocoa# (ie; dynamic class 
registration and method overloading in the objc runtime) is not a task 
for a simple e-mail (I suggest you read the code found in the 
generator/* and src/glue/* folders in SVN).

It sounds like your real question is how does it pinvoke; so I'll 
address that.

Every objc method like
[myobjc foo:bar baz:bla]
actually translates into one of 4 C calls (different semantics based on 
arguments and wether it returns a structure); but for all intensive 
purposes it pretty much is this
objc_msgSend (receiver, selector, arg, arg, arg);

Every cocoa# managed method calls our class ObjCMessaging, which uses 
dynamic S.R.E (System.Reflection.Emit) to create binding code in memory 
which will dynamically create the pinvoke call (and cache it as needed) 
for the needed functions.  It then translates the managed call down to 
the objc runtime.

Subclassing and fully managed classes do the same thing (pretty much) 
but use a feature of the objc messaging system where all &quot;unhandled&quot; 
selectors get sent to forwardInvocation: (I think; this may be called 
something else).  So we register a managed callback into the objc 
runtime for that and pass all those messages back up to managed land.  
In managed land we process the NS(Concrete)Notification for the 
Invocation pulling out the arguments and call the required managed 
method.

I hope that is enough of a high level overview to get you started.

-kangaroo

On 26-Apr-05, at 1:04 AM, Lloyd Dupont wrote:

&gt;<i> Well, that's partly porting / partly rewritting.
</I>&gt;<i> Apparently GNUstep base (the 'FoundationKit') work well and seems 
</I>&gt;<i> reliable. And let you port easily things.
</I>&gt;<i> Regarding AppKit that's an other matter which would requires 
</I>&gt;<i> rewritting.
</I>&gt;<i> I haven't heard of this application before (being hired) but some 
</I>&gt;<i> client do, apparently ^_^. it's
</I>&gt;<i> <A HREF="http://www.nova-mind.com">http://www.nova-mind.com</A>
</I>&gt;<i>
</I>&gt;<i> Anyway, go back to the original question: how does Coca# work?
</I>&gt;<i> Because I would like to make my ObjectiveC class available to .NET and 
</I>&gt;<i> need good idea!
</I>&gt;<i>
</I>&gt;<i> Otherwise I think I will create a code generator which, given some 
</I>&gt;<i> class's header, will generate a C library wrapper around the 
</I>&gt;<i> ObjectiveC object and some DLlImport C# class. But if there is any 
</I>&gt;<i> better way I'm curious to know...
</I>&gt;<i>
</I>&gt;<i> ----- Original Message ----- From: &quot;Adhamh Findlay&quot; 
</I>&gt;<i> &lt;<A HREF="mailto:cocoa-sharp@adhamh.com">cocoa-sharp@adhamh.com</A>&gt;
</I>&gt;<i> To: &quot;Lloyd Dupont&quot; &lt;<A HREF="mailto:lloyd@nova-mind.com">lloyd@nova-mind.com</A>&gt;
</I>&gt;<i> Cc: &lt;<A HREF="mailto:cocoa-sharp@lists.ximian.com">cocoa-sharp@lists.ximian.com</A>&gt;
</I>&gt;<i> Sent: Tuesday, April 26, 2005 2:48 PM
</I>&gt;<i> Subject: Re: [Cocoa-sharp] question about Coca# internal
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Lloyd Dupont wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> the application is a Cocoa/ObjectiveC application.
</I>&gt;&gt;&gt;<i> why?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have NEVER EVER heard of someone porting a Cocoa app to Windows.  
</I>&gt;&gt;<i> It would require that you rewrite the entire app in something like 
</I>&gt;&gt;<i> mono or C++.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I don't know about the GNUStep option.  I don't really know anything 
</I>&gt;&gt;<i> about GNUStep though either.  If you port the app to GNUStep I 
</I>&gt;&gt;<i> suppose that would work.  Does GNUSTEP run under Windows?  I think it 
</I>&gt;&gt;<i> is its own OS and replaces windows though...
</I>&gt;&gt;<i> Is this application something anyone has heard of?
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Cocoa-sharp mailing list
</I>&gt;<i> <A HREF="mailto:Cocoa-sharp@lists.ximian.com">Cocoa-sharp@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/cocoa-sharp">http://lists.ximian.com/mailman/listinfo/cocoa-sharp</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> !DSPAM:426dcbc3257961597914613!
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000512.html">[Cocoa-sharp] question about Coca# internal
</A></li>
	<LI> Next message: <A HREF="000514.html">[Cocoa-sharp] question about Coca# internal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#513">[ date ]</a>
              <a href="thread.html#513">[ thread ]</a>
              <a href="subject.html#513">[ subject ]</a>
              <a href="author.html#513">[ author ]</a>
         </LI>
       </UL>
</body></html>
