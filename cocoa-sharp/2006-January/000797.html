<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Cocoa-sharp] ObjCMessaging?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cocoa-sharp%40lists.ximian.com?Subject=%5BCocoa-sharp%5D%20ObjCMessaging%3F&In-Reply-To=6ED0F5A6-1006-4300-9279-D94834BDF120%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000795.html">
   <LINK REL="Next"  HREF="000798.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cocoa-sharp] ObjCMessaging?</H1>
    <B>Andreas F&#228;rber</B> 
    <A HREF="mailto:cocoa-sharp%40lists.ximian.com?Subject=%5BCocoa-sharp%5D%20ObjCMessaging%3F&In-Reply-To=6ED0F5A6-1006-4300-9279-D94834BDF120%40gmail.com"
       TITLE="[Cocoa-sharp] ObjCMessaging?">andreas.faerber at web.de
       </A><BR>
    <I>Wed Jan 18 05:27:20 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000795.html">[Cocoa-sharp] ObjCMessaging?
</A></li>
        <LI>Next message: <A HREF="000798.html">[Cocoa-sharp] ObjCMessaging?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#797">[ date ]</a>
              <a href="thread.html#797">[ thread ]</a>
              <a href="subject.html#797">[ subject ]</a>
              <a href="author.html#797">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Tim,

&gt;<i> I'm currently working on this -&gt;&#160;- (id)initImageCell:(NSImage *)anImage
</I>&gt;<i>
</I>&gt;<i> From what I've been able to learn from internet sources, the return 
</I>&gt;<i> type of (id) means that it's a dynamic object pointer, meaning that 
</I>&gt;<i> the object doesn't have to be of a particular class...is that right?
</I>
Theoretically yes, but it depends on the method.

&gt;<i> I just want to also ask about what the 
</I>&gt;<i> different&#160;ObjCMessaging.objc_msgSend are for:
</I>&gt;<i>
</I>&gt;<i> The first one:
</I>&gt;<i> public static object objc_msgSend (IntPtr receiver, string selector, 
</I>&gt;<i> Type rettype)
</I>&gt;<i>
</I>&gt;<i> So from what I gather the first one is for items that return something 
</I>&gt;<i> but have no parameters.&#160; The first passed arg is the NativeObject, the 
</I>&gt;<i> second one is the property/method/etc, and the third one is the return 
</I>&gt;<i> type.&#160; Is this correct?
</I>&gt;<i>
</I>&gt;<i> The second one:
</I>&gt;<i> public static object objc_msgSend (IntPtr receiver, string selector, 
</I>&gt;<i> Type rettype, params object[] args)
</I>&gt;<i>
</I>&gt;<i> &#160;This one is for items that have parameters, which must be the last 
</I>&gt;<i> item....I have to look up the params keyword.&#160; I don't think I've ever 
</I>&gt;<i> seen that before.
</I>&gt;<i>
</I>&gt;<i> So in converting the ObjC statement I supplied earlier would you tell 
</I>&gt;<i> me if this is correct?
</I>&gt;<i>
</I>&gt;<i> public Cocoa.Cell InitImageCell( Cocoa.Image anImage ) {
</I>&gt;<i>     return (Cocoa.Cell)Native.NativeToManaged 
</I>&gt;<i> ((IntPtr)ObjCMessaging.objc_msgSend( NativeObject, &quot;initImageCell&quot;, 
</I>&gt;<i> typeof (IntPtr), typeof (Cocoa.Image), anImage )));
</I>&gt;<i> }
</I>
Same as above: The call to objc_msgSend has the right syntax, &quot;params&quot; 
catches all arguments beyond the initial ones. However, &quot;initXXX:&quot; 
(note that when arguments follow it ends with a colon) is a 
second-phase constructor in Objective-C and thus should be a 
constructor in C#. ;-) That means:
public Cell (Cocoa.Image image) {
	NativeObject = (IntPtr) ObjC...
}
No native2managed conversion because &quot;you&quot; are already the managed 
wrapper.

&gt;<i> I noticed that Native.NativeToManaged is ALWAYS used, is that always 
</I>&gt;<i> the case or is that just&#160;coincidence for now?&#160; Now the &quot;typeof 
</I>&gt;<i> (IntPtr)&quot; that is right before the typeof (Cocoa.Image), should that 
</I>&gt;<i> be the IntPtr because it's returning a pointer to a dynamic object?
</I>
objc_msgSend and companions virtually always return an id in C, so that 
we get an IntPtr (the exception are the _stret C functions). If you 
want the wrapper object instead of an IntPtr it needs to be converted - 
Native.NativeToManaged in the current implementation, 
ObjectiveCObject.FromId in my suggestion. A way to avoid this would be 
to support the relevant objects in the ObjectiveC.SendMessage method, 
I'll look into that once I'm done with the basics.

Andreas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: text/enriched
Size: 4065 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/cocoa-sharp/attachments/20060118/c7df56c6/attachment-0001.bin">http://lists.ximian.com/pipermail/cocoa-sharp/attachments/20060118/c7df56c6/attachment-0001.bin</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000795.html">[Cocoa-sharp] ObjCMessaging?
</A></li>
	<LI>Next message: <A HREF="000798.html">[Cocoa-sharp] ObjCMessaging?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#797">[ date ]</a>
              <a href="thread.html#797">[ thread ]</a>
              <a href="subject.html#797">[ subject ]</a>
              <a href="author.html#797">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/cocoa-sharp">More information about the Cocoa-sharp
mailing list</a><br>
</body></html>
