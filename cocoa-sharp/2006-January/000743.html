<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Cocoa-sharp] Some thoughts on Cocoa# evolvement for 2006
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cocoa-sharp%40lists.ximian.com?Subject=%5BCocoa-sharp%5D%20Some%20thoughts%20on%20Cocoa%23%20evolvement%20for%202006&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000742.html">
   <LINK REL="Next"  HREF="000744.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cocoa-sharp] Some thoughts on Cocoa# evolvement for 2006</H1>
    <B>Aaron Flynt</B> 
    <A HREF="mailto:cocoa-sharp%40lists.ximian.com?Subject=%5BCocoa-sharp%5D%20Some%20thoughts%20on%20Cocoa%23%20evolvement%20for%202006&In-Reply-To="
       TITLE="[Cocoa-sharp] Some thoughts on Cocoa# evolvement for 2006">aaron at aaronflynt.com
       </A><BR>
    <I>Mon Jan  2 14:58:24 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000742.html">[Cocoa-sharp] Bundle problem workaround!
</A></li>
        <LI>Next message: <A HREF="000744.html">[Cocoa-sharp] Some thoughts on Cocoa# evolvement for 2006
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#743">[ date ]</a>
              <a href="thread.html#743">[ thread ]</a>
              <a href="subject.html#743">[ subject ]</a>
              <a href="author.html#743">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jan 2, 2006, at 6:42 AM, Andreas F&#228;rber wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> with more and  more classes arriving I am proposing to split the  
</I>&gt;&gt;&gt;<i> classes up  (again) into Cocoa (OC interop and Foundation),  
</I>&gt;&gt;&gt;<i> Cocoa.AppKit (the  name says it all, equivalent of Apple.AppKit)  
</I>&gt;&gt;&gt;<i> and rename WebKit to  Cocoa.WebKit (equivalent of Apple.WebKit).  
</I>&gt;&gt;&gt;<i> Possibly also move the  Interop stuff to Cocoa.Interop. This  
</I>&gt;&gt;&gt;<i> could all remain inside the  existing two Assemblies - cosmetics  
</I>&gt;&gt;&gt;<i> that could improve the  documentation and src/Cocoa directory.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm adverse to renaming namespaces _again_ forcing everyones code  
</I>&gt;&gt;<i> to  be changed _again_.  That being said; I have no problem with  
</I>&gt;&gt;<i> a  Cocoa.Interop sub-namespace with a bunch of Interop stuff in  
</I>&gt;&gt;<i> it.   Without a &quot;good reason&quot; I'd like to avoid renaming  
</I>&gt;&gt;<i> namespaces again.
</I>&gt;<i>
</I>&gt;<i> Well, my motivation was to resemble both the .NET class library and  
</I>&gt;<i> Cocoa API structure. In both, base types are separated from user  
</I>&gt;<i> interface classes, making it easier to look through the  
</I>&gt;<i> documentation when looking for some kind of control or UI element  
</I>&gt;<i> without tripping over core classes.
</I>&gt;<i> Like some of the other changes I would be willing to provide a  
</I>&gt;<i> patch once Aaron and you have applied your respective patches; this  
</I>&gt;<i> way the only difference for up-to-date end users apart from  
</I>&gt;<i> improved documentation would be an additional &quot;using  
</I>&gt;<i> Cocoa.AppKit;&quot;. It might also make it easier for everyone still  
</I>&gt;<i> migrating from the old Cocoa# - they would only have to replace  
</I>&gt;<i> &quot;Apple&quot; by &quot;Cocoa&quot; and &quot;NS&quot; by empty string.
</I>&gt;<i> Not to mention that you yourself just said we were not providing  
</I>&gt;<i> API stability yet. :-)
</I>&gt;<i>
</I>
Maybe we should try to set some sort of API stability target date or  
release version goal so that people know what to expect and when.

&gt;&gt;<i> I'll look into getting the current documentation on go-mono.com/docs;
</I>&gt;<i>
</I>&gt;<i> That would be great.
</I>&gt;<i>
</I>&gt;&gt;<i>   if not maybe we can run a monodoc aspx for cocoadoc on   
</I>&gt;&gt;<i> cocoasharp.org;
</I>&gt;<i>
</I>&gt;<i> That would be fine too.
</I>&gt;<i>
</I>
I think go-mono.com/docs would be the ideal place for it unless we  
just were hosting the Cocoa# docs alone. It might be kind of  
confusing to see different versions of stuff (mono docs w/ and w/o  
cocoa# docs) in two places.

I also agree that we should get CocoaDoc.app up and running w/o too  
much manual hacking for people (primarily for contributors as I  
suspect end users will gravitate towards the online docs).

&gt;&gt;<i> As for the wiki; pretty much everything there is out of date; it  
</I>&gt;&gt;<i> may  be smart to just start again?  Thoughts?
</I>&gt;<i>
</I>&gt;<i> I vote against. Lots of stuff is out-of-date, yes, but some parts  
</I>&gt;<i> have really been helpful for someone starting with Cocoa/Cocoa# and  
</I>&gt;<i> possibly the Mac. We should keep at least some content in whatever  
</I>&gt;<i> form that may be.
</I>&gt;<i>
</I>&gt;<i> What I would support though is a move to an improved or different  
</I>&gt;<i> Wiki software ... for instance it seems impossible to both mark  
</I>&gt;<i> something camel-cased as not-a-link and apply some formatting. Also  
</I>&gt;<i> a login capability with the ability to remove one's own pages would  
</I>&gt;<i> be handy (I created a page with a space in the name and was  
</I>&gt;<i> therefore unable to link to it).
</I>&gt;<i> Mono-project.com appears to be using the MediaWiki, like Wikipedia.
</I>&gt;<i>
</I>&gt;<i> Oh, and the CocoaSharp.org and Mono CocoaSharp pages need to be  
</I>&gt;<i> updated!
</I>&gt;<i>
</I>
Yes. All of the stray cocoa-sharp docs out there if at all possible  
should either be updated or deleted. They should all at least point  
to up to date information.

&gt;&gt;&gt;<i> * test arguments of our methods and make them compatible with  
</I>&gt;&gt;&gt;<i> null  values where applicable - value.NativeObject or similar  
</I>&gt;&gt;&gt;<i> constructs  have already been causing problems for me; can't we  
</I>&gt;&gt;&gt;<i> use  Cocoa.Object parameters for objc_msgSend instead of IntPtr  
</I>&gt;&gt;&gt;<i> and have  them translated (value == null) ? IntPtr.Zero :  
</I>&gt;&gt;&gt;<i> value.NativeObject  in a central place?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is true; nunit test cases would be phenominal if someone  
</I>&gt;&gt;<i> wants  to start working on them.  I thought about allowing  
</I>&gt;&gt;<i> Cocoa.Objects  into objc_msgSend; the reason I didn't is for EVERY  
</I>&gt;&gt;<i> objc_msgSend  invocation we would need to do a type lookup on  
</I>&gt;&gt;<i> EVERY variable to  determine if its a Cocoa.Object and convert it;  
</I>&gt;&gt;<i> this seems like  expensive overhead to me; more expensive than (if  
</I>&gt;&gt;<i> obj == null) in the  caller.  If someone wants to make a change  
</I>&gt;&gt;<i> and benchmark it showing  that we wont loose a ton of cycles on  
</I>&gt;&gt;<i> this; feel free.
</I>&gt;<i>
</I>&gt;<i> Will have a look a the relevant functions. I thought I already saw  
</I>&gt;<i> something like that somewhere in your code...
</I>
Checking the parameters in the binding doesn't seem too bad to me. I  
found in practice that, contrary to the AppKit docs, some bindings  
can take nil and some can't so you really have to evaluate it on a  
case by case basis anyway.

&gt;<i> I'm not yet familiar with NUnit, only JUnit/J2MEUnit and  
</I>&gt;<i> SymbianOSUnit. Would be helpful to have an initial example of how  
</I>&gt;<i> it's supposed to be organized. :-)
</I>
I believe that the mono class libraries use NUnit. Perhaps we should  
use those as a model?

For the GUI stuff I think more sample apps that make extensive use  
the libraries would be helpful too. Maybe each time you implement  
something you add a new test sample app for it, or add another item  
to a big AppKit sample app. I realize that the idea is generally to  
have people add stuff as they need it in their app so it should  
theoretically all be tested, but that doesn't help us with regressions.

&gt;&gt;&gt;<i> I do like the new CLR-style event handling in Control that has  
</I>&gt;&gt;&gt;<i> made  it into SVN and I would appreciate if we could avoid as  
</I>&gt;&gt;&gt;<i> much  Objective-C as possible in user-derived classes or instances.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Your implementation is similar to what I was planning and works  
</I>&gt;&gt;<i> like  what I wanted to do (did you read my mind?) and I think its  
</I>&gt;&gt;<i> MUCH  better than the target/action pair and allows for the  
</I>&gt;&gt;<i> benefit of  having multiple events fire on one action.
</I>
Yeah! That's definitely the ideal way to do it. Could we maybe  
encapsulate some of that stuff in an abstract base class to make it  
less verbose for each implementation? Does the ActionReceiver class  
work with delegates that pass event arguments?

&gt;&gt;&gt;<i> Might it be possible to avoid needing the ExportAttribute  
</I>&gt;&gt;&gt;<i> outside  the Cocoa# Assemblies for standard apps? I believe  
</I>&gt;&gt;&gt;<i> passing a  delegate to a function is an improvement over passing  
</I>&gt;&gt;&gt;<i> target and  selector but maybe we can improve this even further  
</I>&gt;&gt;&gt;<i> so that a  delegate is called with CLR semantics only and does  
</I>&gt;&gt;&gt;<i> not need to be  exported?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> Its totally possible; but we would need to register every single   
</I>&gt;&gt;<i> class/method/member of every single class in the running assembly   
</I>&gt;&gt;<i> with the objc runtime.  This seems like overkill to me.  What  
</I>&gt;&gt;<i> does  everyone else think.  Should classes autoregister?  Maybe we  
</I>&gt;&gt;<i> should  run a autoregistry if we find a unknown type?  Maybe we  
</I>&gt;&gt;<i> register  every method in a [Register]'d class?
</I>&gt;<i>
</I>&gt;<i> No, on the contrary! I don't believe *any* &quot;standard&quot; CLR class  
</I>&gt;<i> should register any methods with Objective-C. I was thinking more  
</I>&gt;<i> of catching all methods currently needing external [Export] within  
</I>&gt;<i> such &quot;proxies&quot; like in Control and passing them on from there. This  
</I>&gt;<i> is some more work for us and it implies more object instances  
</I>&gt;<i> around, but it will lead to Cocoa# classes complying with CLR  
</I>&gt;<i> semantics.
</I>&gt;<i>
</I>&gt;<i> For instance, an XXXHandler can be pretty much anything in .NET -  
</I>&gt;<i> null, a Delegate or a MulticastDelegate instance - whereas in  
</I>&gt;<i> Aaron's sheet patch, which I repeat is an improvement and can go  
</I>&gt;<i> in, the ActionHandler just like in the old Control.DoubleClick is  
</I>&gt;<i> being misused as mapping a selector to a single method only that  
</I>&gt;<i> additionally needs to be exported by the caller. If instead *we*  
</I>&gt;<i> exported a method in case of non-null delegate arguments we could  
</I>&gt;<i> dispatch it to any CLR delegate with the expected semantics of &quot;if  
</I>&gt;<i> (myDelegate != null) myDelegate(...);&quot;. That's what Control.Action  
</I>&gt;<i> was trying to accomplish, and I am thinking about ways of doing  
</I>&gt;<i> this for a TableView data source too via a new abstract class.
</I>&gt;<i>
</I>&gt;<i> Problem in general will be that an Objective-C protocol does not  
</I>&gt;<i> seem to map to a CLR interface, right? It appears to be more like a  
</I>&gt;<i> purely virtual class with virtual ... Method(...) = 0; in C++? I do  
</I>&gt;<i> not seem to need to implement _all_ methods of a certain protocol  
</I>&gt;<i> and the lack of some may cause some class-dependent default  
</I>&gt;<i> behavior? Wherever there are no such side-effects I vote for  
</I>&gt;<i> abstract or virtual CLR methods, for instance a protected virtual  
</I>&gt;<i> void View.OnDrawRect. Possibly additionally doing the same as in  
</I>&gt;<i> S.W.F, that is raising an event in the base implementation, e.g.  
</I>&gt;<i> View.Draw.
</I>&gt;<i> That way we could also tackle my contextInfo request. ;-)
</I>
You mean just expose a virtual Alert.OnSheetEnd method, and don't  
have any delegate parameter for Alert.BeginSheet? Then just add the  
Export attribute to the base method and drop the ContextInfo altogether?

-=Aaron=-


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000742.html">[Cocoa-sharp] Bundle problem workaround!
</A></li>
	<LI>Next message: <A HREF="000744.html">[Cocoa-sharp] Some thoughts on Cocoa# evolvement for 2006
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#743">[ date ]</a>
              <a href="thread.html#743">[ thread ]</a>
              <a href="subject.html#743">[ subject ]</a>
              <a href="author.html#743">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/cocoa-sharp">More information about the Cocoa-sharp
mailing list</a><br>
</body></html>
