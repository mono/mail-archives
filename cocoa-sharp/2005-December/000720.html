<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Cocoa-sharp] [PATCH] CocoaDoc fix
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cocoa-sharp%40lists.ximian.com?Subject=%5BCocoa-sharp%5D%20%5BPATCH%5D%20CocoaDoc%20fix&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000724.html">
   <LINK REL="Next"  HREF="000722.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cocoa-sharp] [PATCH] CocoaDoc fix</H1>
    <B>Andreas F&#228;rber</B> 
    <A HREF="mailto:cocoa-sharp%40lists.ximian.com?Subject=%5BCocoa-sharp%5D%20%5BPATCH%5D%20CocoaDoc%20fix&In-Reply-To="
       TITLE="[Cocoa-sharp] [PATCH] CocoaDoc fix">andreas.faerber at web.de
       </A><BR>
    <I>Sat Dec 31 11:02:27 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000724.html">[Cocoa-sharp] [PATCH] trunk/cocoa-sharp
</A></li>
        <LI>Next message: <A HREF="000722.html">[Cocoa-sharp] [PATCH] Class additions and enhancements, the second
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#720">[ date ]</a>
              <a href="thread.html#720">[ thread ]</a>
              <a href="subject.html#720">[ subject ]</a>
              <a href="author.html#720">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I've fixed the CGSWindow internal inconsistency exception raised by 
CocoaDoc. The error code 1002 indicated invalid connections, so I've 
moved the LoadNib call to before the indexing (which created the window 
raising this exception). Adapted it to WindowStyle while searching for 
the error. Now CocoaDoc finally starts up!

Unfortunately it's not been of much use yet as it does not display any 
Cocoa documentation. Do I need to do anything special for it to display 
the Cocoa documentation?

Andreas
-------------- next part --------------
Index: CocoaDoc.cs
===================================================================
--- CocoaDoc.cs	(revision 54580)
+++ CocoaDoc.cs	(working copy)
@@ -145,8 +145,8 @@
 		drawer.Open();
 		mainWindow.Center ();
 		mainWindow.Show ();
-		indexBrowser.DoubleClick += new ActionHandler (browserDoubleAction);
-		outlineView.DoubleClick += new ActionHandler (outlineViewDoubleAction);
+		indexBrowser.DoubleAction += new EventHandler (OnBrowserDoubleAction);
+		outlineView.DoubleAction += new EventHandler (OnOutlineViewDoubleAction);
 		// use history.
 		webView.HasBackForwardList = true;
 		webView.BackForwardList.Capacity = 100;
@@ -160,8 +160,7 @@
 		addHistoryItem(&quot;root:&quot;);
 	}
 	
-	[Export(&quot;browserdoubleAction:&quot;)]
-	public void browserDoubleAction(Cocoa.Object sender) {
+	private void OnBrowserDoubleAction(System.Object sender, EventArgs e) {
 		IndexEntry entry = IndexDataSource.GetEntry(indexBrowser.SelectedRowInColumn(0));
 		if(entry != null) {
 			Topic t = entry[0];
@@ -173,8 +172,7 @@
 			addHistoryItem(t.Url);
 		}
 	}
-	[Export(&quot;doubleAction:&quot;)]
-	public void outlineViewDoubleAction(Cocoa.Object sender) {
+	private void OnOutlineViewDoubleAction(System.Object sender, EventArgs e) {
 		BrowserItem bi = outlineView.SelectedItem as BrowserItem;
 		try {
 			if(bi.node.URL != null)
@@ -193,7 +191,7 @@
 				outlineView.ExpandItem(bi);
 
 			}
-		} catch (Exception e) { Console.WriteLine(&quot;ERROR: &quot; + e); }
+		} catch (Exception ex) { Console.WriteLine(&quot;ERROR: &quot; + ex); }
 	}
 
 	[Export(&quot;webView:resource:willSendRequest:redirectResponse:fromDataSource:&quot;)]
@@ -272,11 +270,13 @@
 	}
 }
 
-class DocumentBrowser {
-	public DocumentBrowser() {}
-	public void Run() {
+class DocumentBrowser : Cocoa.Object {
+	public DocumentBrowser () : base () {}
+	public DocumentBrowser (IntPtr native) : base (native) {}
+	public void Run () {
 		Application.Init ();
 		Application.LoadFramework (&quot;WebKit&quot;);
+		Application.LoadNib (&quot;MonoDoc.nib&quot;);
 		if (!File.Exists (&quot;monodoc.index&quot;)) {
 			Rect rect;
 			Image image = new Image (&quot;mono.png&quot;);
@@ -287,7 +287,8 @@
 			rect.Origin.Y = (Screen.Main.Frame.Size.Height-300)/2;
 			rect.Size.Height += 20;
 			
-			Window window = new Window (rect, 0, BackingStoreType.Buffered, false);
+			Window window = new Window (rect, WindowStyle.Borderless, BackingStoreType.Buffered, false);
+
 			rect.Origin.X = 0;
 			rect.Origin.Y = 0;
 			rect.Size.Height = 20;
@@ -316,7 +317,6 @@
 			p_indicator.StopAnimation ();
 			window.Close ();
 		}
-		Application.LoadNib (&quot;MonoDoc.nib&quot;);
 		Application.Run ();
 	}
 	static void MakeIndex ()
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000724.html">[Cocoa-sharp] [PATCH] trunk/cocoa-sharp
</A></li>
	<LI>Next message: <A HREF="000722.html">[Cocoa-sharp] [PATCH] Class additions and enhancements, the second
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#720">[ date ]</a>
              <a href="thread.html#720">[ thread ]</a>
              <a href="subject.html#720">[ subject ]</a>
              <a href="author.html#720">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/cocoa-sharp">More information about the Cocoa-sharp
mailing list</a><br>
</body></html>
