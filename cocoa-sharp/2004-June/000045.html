<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Cocoa-sharp] New changes to genstubs.pl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:umuff%40quark.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000044.html">
   <LINK REL="Next"  HREF="000046.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Cocoa-sharp] New changes to genstubs.pl
   </H1>
    <B>Urs C Muff
    </B> 
    <A HREF="mailto:umuff%40quark.com"
       TITLE="[Cocoa-sharp] New changes to genstubs.pl">umuff@quark.com
       </A><BR>
    <I>Fri, 11 Jun 2004 11:34:27 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="000044.html">[Cocoa-sharp] New changes to genstubs.pl
</A></li>
        <LI> Next message: <A HREF="000046.html">[Cocoa-sharp] Stuff we need to do by 1.0?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45">[ date ]</a>
              <a href="thread.html#45">[ thread ]</a>
              <a href="subject.html#45">[ subject ]</a>
              <a href="author.html#45">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jun 11, 2004, at 2:53 AM, C.J.Collier wrote:

&gt;<i> *whew*
</I>&gt;<i>
</I>&gt;<i> I'm cc'ing you because the list is ass slow.
</I>&gt;<i>
</I>&gt;<i> Mostly this is to merge my changes in with kangaroo's and Urs' before 
</I>&gt;<i> it gets any more hairy.  I was hoping I would be able to have 
</I>&gt;<i> parseMethod just fill in the fields of the %objC hash.  I would then 
</I>&gt;<i> use that hash to fill in the %c and %cSharp hashes.  We'd be able to 
</I>&gt;<i> get a bunch of the code that doesn't belong in the parsing method out 
</I>&gt;<i> of it.
</I>&gt;<i>
</I>&gt;<i> I also think that the @interface parser should be separate from the 
</I>&gt;<i> rest of the code.  I feel like it's mucking things up a bit.  So, 
</I>&gt;<i> here's a list of the changes:
</I>&gt;<i>
</I>&gt;<i> - made a note to not overwrite the entire file... in the future.
</I>cool: this is more important for the .cs files
&gt;<i> - modified the $origmethod regex to catch whitespace before the [-+].  
</I>&gt;<i> Also made the type optional
</I>good
&gt;<i> - defaulting return type to id
</I>good
&gt;<i> - removed comment about not supporting methods without explicit return 
</I>&gt;<i> types
</I>good
&gt;<i> - altered some of the variable names to match the ObjC nomenclature
</I>good, explain, so that we all learn :)
&gt;<i> - printing complaint if duplicate method name is discovered
</I>good (sorry I was too lazy to print)
&gt;<i> - storing generation date in a variable so we don't call localtime() a 
</I>&gt;<i> bunch of times
</I>good
&gt;<i> - changed File::BaseName::fileparse() return variable name from $class 
</I>&gt;<i> to $name.  Mostly because I thought some folks might think that we had 
</I>&gt;<i> gotten the $class
</I>&gt;<i>  variable from the @interface line - we didn't.  it was coming from 
</I>&gt;<i> the filename.  In the future, we should be using $objCHash-&gt;{class} to 
</I>&gt;<i> get the class name from within
</I>&gt;<i>  parseMethod().  Although, since we are passing $interface as the 
</I>&gt;<i> second arg now, it's the same difference.
</I>good (we need to handle multiple prototype references in @interface, I 
think the syntax is &lt;NSObject, NSLock, NSCoding&gt; for instance
&gt;<i> - removed the need for the $skip variable by using a nifty comment 
</I>&gt;<i> removal regex.  It's really long, so I put it in its own subroutine.
</I>good
&gt;<i> - created %objC, %c and %cSharp hashes that contain information 
</I>&gt;<i> gathered from parseMethod.
</I>very good :)
&gt;<i> - added code to combine multi-line method definitions.  Please check 
</I>&gt;<i> this out for me.  I haven't had much of a chance to test it.
</I>point out where that is @

I found another issue: we need to inherit all class methods, and 
generate stubs for them: that is automatically generate __alloc for all 
classes, so we don't need that ugly hack anymore, we are missing many 
class methods on derived interface because of that!  Like 
NSMutableArray will get all the class methods of NSArray as well.

&gt;<i>
</I>&gt;<i> And that's just about it.  After a bit of review, I'll even submit it.
</I>&gt;<i>
</I>&gt;<i> G'night,
</I>&gt;<i>
</I>&gt;<i> C.J.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Cocoa-sharp mailing list
</I>&gt;<i> <A HREF="mailto:Cocoa-sharp@lists.ximian.com">Cocoa-sharp@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/cocoa-sharp">http://lists.ximian.com/mailman/listinfo/cocoa-sharp</A>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000044.html">[Cocoa-sharp] New changes to genstubs.pl
</A></li>
	<LI> Next message: <A HREF="000046.html">[Cocoa-sharp] Stuff we need to do by 1.0?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45">[ date ]</a>
              <a href="thread.html#45">[ thread ]</a>
              <a href="subject.html#45">[ subject ]</a>
              <a href="author.html#45">[ author ]</a>
         </LI>
       </UL>
</body></html>
