<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-packagers] binaries in tarball
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-packagers-list%40lists.ximian.com?Subject=Re%3A%20%5Bmono-packagers%5D%20binaries%20in%20tarball&In-Reply-To=%3C55279D05.9060408%40apebox.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000218.html">
   <LINK REL="Next"  HREF="000220.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-packagers] binaries in tarball</H1>
    <B>Jo Shields</B> 
    <A HREF="mailto:mono-packagers-list%40lists.ximian.com?Subject=Re%3A%20%5Bmono-packagers%5D%20binaries%20in%20tarball&In-Reply-To=%3C55279D05.9060408%40apebox.org%3E"
       TITLE="[mono-packagers] binaries in tarball">directhex at apebox.org
       </A><BR>
    <I>Fri Apr 10 09:51:01 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="000218.html">[mono-packagers] binaries in tarball
</A></li>
        <LI>Next message: <A HREF="000220.html">[mono-packagers] binaries in tarball
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#219">[ date ]</a>
              <a href="thread.html#219">[ thread ]</a>
              <a href="subject.html#219">[ subject ]</a>
              <a href="author.html#219">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 10/04/15 10:08, Timotheus Pokorra wrote:
&gt;<i> Hello Jo,
</I>&gt;<i>
</I>&gt;<i> First I want to thank you and Xamarin for providing uptodate Mono
</I>&gt;<i> packages for various Linux distributions.
</I>&gt;<i>
</I>&gt;<i> But as it has been stated on the Mono mailing list before [1], the end
</I>&gt;<i> goal is to have uptodate Mono packages provided by the Linux
</I>&gt;<i> distributions themselves.
</I>
This is still true, it'd definitely best for everyone if distributions
can offer up-to-date packages themselves - relationships between
distributions and upstreams are always best served if they're 2-way.

&gt;<i> I am trying to help to get a newer version of Mono into Fedora.
</I>&gt;<i> I don't have so much experience with packaging like yourself, so I
</I>&gt;<i> would like to ask for some advice.
</I>
Hooray, it's been rather quiet on the Fedora front for a while. Remember
to consider #mono on GIMPnet for discussion with other people into this
packaging stuff.

&gt;<i> According to the Fedora rules [2] and [3], the packages must build
</I>&gt;<i> from source completely.
</I>&gt;<i> I think this is the same for Debian.
</I>&gt;<i> There are many dlls in the tarball, in
</I>&gt;<i> mono-4.0.0/external/binary-reference-assemblies/v4.0
</I>&gt;<i>
</I>&gt;<i> I have checked the latest version that you built for Debian:
</I>&gt;<i> <A HREF="https://packages.debian.org/source/testing/mono">https://packages.debian.org/source/testing/mono</A>
</I>&gt;<i> I have learned that you create your own tarball: eg mono_3.2.8+dfsg.orig.tar.gz
</I>&gt;<i> This happens in the debian/rules file:
</I>&gt;<i> find $(TARBALL_DIR) -name &quot;*.dll&quot; -not -path
</I>&gt;<i> &quot;$(TARBALL_DIR)/mcs/class/lib/monolite/*&quot; -print -delete
</I>&gt;<i> find $(TARBALL_DIR) -name &quot;*.exe&quot; -not -path
</I>&gt;<i> &quot;$(TARBALL_DIR)/mcs/class/lib/monolite/*&quot; -print -delete
</I>&gt;<i>
</I>&gt;<i> There was no directory external/binary-reference-assemblies/ in 3.2.8.
</I>&gt;<i> What will you do for 4.0 for the Debian packages?
</I>
The official Debian packages will not contain that directory at all. The
&quot;+dfsg&quot; suffix in a version number in a Debian orig tarball signifies
that it has been altered to comply with the Debian Free Software
Guidelines (which, like Fedora, forbid inclusion of needless binaries).
4.0.0 in Debian will be +dfsg'd.

Technically the binaries in question are Free Software - they have been
produced from Free source, with Free tools - but they cannot be produced
by the mono 4.0.0 source tree (they're built from a 3.12 source tree).

The Xamarin packages include the binaries, as that no-binaries
requirement is not a requirement (although it is a personal
nice-to-have, as a FOSS guy).

The binary-reference-assemblies files are needed when trying to compile
software which needs to target an older .NET version than 4.5 (which is
all Mono 4.0 supports natively) - if you don't care about that
requirement, then the binary-reference-assemblies simply are not needed.

&gt;<i> Can we join efforts to build the external binaries somehow during the
</I>&gt;<i> package build process?
</I>&gt;<i> Or do we need to create separate packages for the external binaries?
</I>
You would need a &quot;mono_3.12.1&quot; source package as a distinct and separate
source package from &quot;mono&quot;. The build process would look approximately
like &quot;configure &amp;&amp; make &amp;&amp; run CLI-stripping tool whose name I've
forgotten &amp;&amp; manually package files in question without using make install&quot;

This isn't a discussion I've had within Debian yet, as the 8.0 release
freeze means Mono updates haven't been a topic of discussion. My
*personal* feeling is &quot;I don't care enough about building against old
frameworks to put in the work, I'd rather just delete the files entirely&quot;

&gt;<i> Another question about monolite: Did you negotiate in the Debian
</I>&gt;<i> project to keep the monolite binaries, so that you can build Mono
</I>&gt;<i> without requiring Mono during the build?
</I>&gt;<i> I have just tested to build Mono without monolite on Fedora 21:
</I>
Typically, decisions on such matters are made by the FTP Masters, whose
job is to gatekeep uploads by developers. A clear explanation of why
certain binaries have been kept, and a sworn statement that those
binaries can be regenerated by the source tree in question, has been
fine IME (see also F#, VBNC... compilers, generally). I couldn't find
the specific policy clause covering this whole topic, though. Doesn't
mean it's not there, just that our search mechanisms suck.

When a compiler is self-hosting, that tends to also mean it needs itself
in order to compile, and any casual observer would agree that &quot;contains
a minimal copy of itself to bootstrap itself&quot; is better than &quot;circular
build dependency on itself, meaning the archive can never be cleanly
rebuilt from source&quot; - although instances of both exist in the Debian
archive.

&gt;<i> build/common/basic-profile-check.cs(40,30): error CS0117:
</I>&gt;<i> `System.Version' does not contain a definition for `TryParse'
</I>&gt;<i> /usr/lib/mono/2.0/mscorlib.dll (Location of the symbol related to
</I>&gt;<i> previous error)
</I>&gt;<i> build/common/basic-profile-check.cs(43,21): error CS0165: Use of
</I>&gt;<i> unassigned local variable `version'
</I>&gt;<i> Compilation failed: 2 error(s), 0 warnings
</I>&gt;<i> build/profiles/basic.make:93: recipe for target
</I>&gt;<i> 'build/deps/basic-profile-check.exe' failed
</I>&gt;<i> make[6]: *** [build/deps/basic-profile-check.exe] Error 1
</I>&gt;<i> *** The compiler 'mcs' doesn't appear to be usable.
</I>&gt;<i> *** You need Mono version 3.8 or better installed to build MCS
</I>&gt;<i> *** Check mono README for information on how to bootstrap a Mono installation.
</I>&gt;<i> *** The version of 'mcs' is: Mono C# compiler version 2.10.8.0.
</I>&gt;<i> build/profiles/basic.make:60: recipe for target 'do-profile-check' failed
</I>&gt;<i>
</I>&gt;<i> It seems that Mono 4 Alpha 1 does not build with the old Fedora Mono
</I>&gt;<i> 2.10 packages anymore.
</I>
I don't believe the 3.8 requirement is entirely accurate, but 2.10 is
certainly too old. This is a great illustration of my point from above,
actually - a blanket ban on self-hosting bootstrap binaries makes it
tedious and incremental to update to latest. Unfortunately, it seems
Fedora packaging policy is &quot;hooray for tedious and incremental&quot;. You
should have some luck with the spec files I use for Xamarin RPMs, at
<A HREF="https://github.com/directhex/xamarin-mono/tree/centos">https://github.com/directhex/xamarin-mono/tree/centos</A> (I haven't been
tagging releases as I should - my development process is still very
Debian-centric - a gap of several days is a good indicator that I did an
upload). These are based on what was the state of the art in openSUSE
when I started my job, but with a bunch of changes to better cope with
gaps in RH's version of RPM.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000218.html">[mono-packagers] binaries in tarball
</A></li>
	<LI>Next message: <A HREF="000220.html">[mono-packagers] binaries in tarball
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#219">[ date ]</a>
              <a href="thread.html#219">[ thread ]</a>
              <a href="subject.html#219">[ subject ]</a>
              <a href="author.html#219">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-packagers-list">More information about the mono-packagers-list
mailing list</a><br>
</body></html>
