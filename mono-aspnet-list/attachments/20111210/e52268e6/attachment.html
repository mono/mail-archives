<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;small;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;TEXT-DECORATION:&nbsp;none&quot;&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;<br>
&lt;DIV&gt;I&nbsp;try&nbsp;to&nbsp;port&nbsp;ASP&nbsp;.NET&nbsp;MVC2&nbsp;password&nbsp;recovery&nbsp;code&nbsp;in&nbsp;&lt;A&nbsp;<br>
title=http://stackoverflow.com/questions/7793108/where-to-find-c-sharp-sample-code-to-implement-password-recovery-in-asp-net-mvc&nbsp;<br>
href=&quot;http://stackoverflow.com/questions/7793108/where-to-find-c-sharp-sample-code-to-implement-password-recovery-in-asp-net-mvc&quot;&gt;http://stackoverflow.com/questions/7793108/where-to-find-c-sharp-sample-code-to-implement-password-recovery-in-asp-net-mvc&lt;/A&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;to&nbsp;Mono.&lt;/DIV&gt;<br>
&lt;DIV&gt;I&nbsp;it&nbsp;contains&nbsp;procedure&nbsp;below.&nbsp;In&nbsp;this&nbsp;CryptDeriveKey&nbsp;call&nbsp;causes&nbsp;exception&nbsp;<br>
in&nbsp;Mono&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;CspParameters&nbsp;not&nbsp;supported&nbsp;by&nbsp;Mono&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;How&nbsp;to&nbsp;implement&nbsp;password&nbsp;recovery&nbsp;in&nbsp;Mono&nbsp;in&nbsp;ASP&nbsp;.NET&nbsp;MVC2&nbsp;application&nbsp;<br>
?&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;///&nbsp;&amp;lt;summary&amp;gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;///&nbsp;Takes&nbsp;a&nbsp;text&nbsp;message&nbsp;and&nbsp;<br>
encrypts&nbsp;it&nbsp;using&nbsp;a&nbsp;password&nbsp;as&nbsp;a&nbsp;key.&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;///&nbsp;&amp;lt;/summary&amp;gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;///&nbsp;&amp;lt;param&nbsp;<br>
name=&quot;plainMessage&quot;&amp;gt;A&nbsp;text&nbsp;to&nbsp;encrypt.&amp;lt;/param&amp;gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;///&nbsp;&amp;lt;param&nbsp;<br>
name=&quot;password&quot;&amp;gt;The&nbsp;password&nbsp;to&nbsp;encrypt&nbsp;the&nbsp;message&nbsp;with.&amp;lt;/param&amp;gt;&nbsp;<br>
&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;///&nbsp;&amp;lt;returns&amp;gt;Encrypted&nbsp;<br>
string.&amp;lt;/returns&amp;gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;///&nbsp;&amp;lt;remarks&amp;gt;This&nbsp;method&nbsp;<br>
uses&nbsp;TripleDES&nbsp;symmmectric&nbsp;encryption.&amp;lt;/remarks&amp;gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;static&nbsp;string&nbsp;<br>
EncodeMessageWithPassword(string&nbsp;plainMessage,&nbsp;string&nbsp;password)&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;<br>
(plainMessage&nbsp;==&nbsp;null)&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
throw&nbsp;new&nbsp;ArgumentNullException(&quot;encryptedMessage&quot;,&nbsp;&quot;The&nbsp;message&nbsp;cannot&nbsp;be&nbsp;<br>
null&quot;);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
TripleDESCryptoServiceProvider&nbsp;des&nbsp;=&nbsp;new&nbsp;TripleDESCryptoServiceProvider();&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;des.IV&nbsp;=&nbsp;<br>
new&nbsp;byte[8];&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
//Creates&nbsp;the&nbsp;key&nbsp;based&nbsp;on&nbsp;the&nbsp;password&nbsp;and&nbsp;stores&nbsp;it&nbsp;in&nbsp;a&nbsp;byte&nbsp;array.&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
PasswordDeriveBytes&nbsp;pdb&nbsp;=&nbsp;new&nbsp;PasswordDeriveBytes(password,&nbsp;new&nbsp;byte[0]);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;in&nbsp;<br>
mono&nbsp;CryptDeriveKey&nbsp;causes&nbsp;exception:&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;<br>
CspParameters&nbsp;not&nbsp;supported&nbsp;by&nbsp;Mono&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;des.Key&nbsp;<br>
=&nbsp;pdb.CryptDeriveKey(&quot;RC2&quot;,&nbsp;&quot;MD5&quot;,&nbsp;128,&nbsp;new&nbsp;byte[8]);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
MemoryStream&nbsp;ms&nbsp;=&nbsp;new&nbsp;MemoryStream(plainMessage.Length&nbsp;*&nbsp;2);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
CryptoStream&nbsp;encStream&nbsp;=&nbsp;new&nbsp;CryptoStream(ms,&nbsp;des.CreateEncryptor(),&nbsp;<br>
CryptoStreamMode.Write);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;byte[]&nbsp;<br>
plainBytes&nbsp;=&nbsp;Encoding.UTF8.GetBytes(plainMessage);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
encStream.Write(plainBytes,&nbsp;0,&nbsp;plainBytes.Length);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
encStream.FlushFinalBlock();&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;byte[]&nbsp;<br>
encryptedBytes&nbsp;=&nbsp;new&nbsp;byte[ms.Length];&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
ms.Position&nbsp;=&nbsp;0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
ms.Read(encryptedBytes,&nbsp;0,&nbsp;(int)ms.Length);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
encStream.Close();&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;<br>
Convert.ToBase64String(encryptedBytes);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;reference:&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;&lt;A&nbsp;<br>
title=http://stackoverflow.com/questions/8459011/how-to-fix-cspparameters-not-supported-by-mono-exception-calling-cryptderivekey&nbsp;<br>
href=&quot;http://stackoverflow.com/questions/8459011/how-to-fix-cspparameters-not-supported-by-mono-exception-calling-cryptderivekey&quot;&gt;http://stackoverflow.com/questions/8459011/how-to-fix-cspparameters-not-supported-by-mono-exception-calling-cryptderivekey&lt;/A&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
