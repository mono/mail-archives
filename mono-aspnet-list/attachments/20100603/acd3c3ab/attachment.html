<tt>
&lt;html&gt;<br>
&lt;body&gt;<br>
Hi,&nbsp;&lt;br&gt;&lt;br&gt;<br>
I'm&nbsp;trying&nbsp;so&nbsp;send&nbsp;secured&nbsp;mail&nbsp;with&nbsp;mono&nbsp;using&nbsp;System.Web.Mail&nbsp;in<br>
aspnet.&lt;br&gt;<br>
I&nbsp;read&nbsp;this<br>
&lt;a&nbsp;href=&quot;http://www.mono-project.com/FAQ:_Security#Does_SSL_works_for_SMTP.2C_like_GMail_.3F&quot;&gt;<br>
http://www.mono-project.com/FAQ:_Security#Does_SSL_works_for_SMTP.2C_like_GMail_.3F&lt;/a&gt;<br>
&nbsp;and&nbsp;I&nbsp;made&nbsp;the&nbsp;described&nbsp;operations&nbsp;but&nbsp;when&nbsp;I&nbsp;try&nbsp;to&nbsp;send&nbsp;the&nbsp;mail&nbsp;I<br>
always&nbsp;immediately&nbsp;obtain&nbsp;&lt;br&gt;&lt;br&gt;<br>
&lt;tt&gt;System.Web.HttpException:&nbsp;Connection&nbsp;refused&nbsp;---&amp;gt;<br>
System.Net.Sockets.SocketException:&nbsp;Connection&nbsp;refused&nbsp;at<br>
System.Net.Sockets.Socket.Connect&nbsp;(System.Net.EndPoint&nbsp;remote_end)<br>
[0x00000]&nbsp;&lt;br&gt;<br>
at&nbsp;System.Net.Sockets.TcpClient.Connect&nbsp;(System.Net.IPEndPoint<br>
remote_end_point)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
at&nbsp;System.Net.Sockets.TcpClient.Connect&nbsp;(System.Net.IPAddress[]<br>
ipAddresses,&nbsp;Int32&nbsp;port)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---&nbsp;&lt;br&gt;<br>
at&nbsp;System.Web.Mail.SmtpMail.Send&nbsp;(System.Web.Mail.MailMessage&nbsp;message)<br>
[0x00000]&lt;br&gt;&lt;br&gt;<br>
&lt;/tt&gt;Launching&nbsp;this&nbsp;command&lt;br&gt;&lt;br&gt;<br>
&lt;tt&gt;openssl&nbsp;s_client&nbsp;-connect&nbsp;smtp.gmail.com:465&lt;br&gt;&lt;br&gt;<br>
&lt;/tt&gt;I&nbsp;obtain&lt;br&gt;&lt;br&gt;<br>
&lt;tt&gt;220&nbsp;mx.google.com&nbsp;ESMTP&lt;br&gt;&lt;br&gt;<br>
&lt;/tt&gt;so&nbsp;I&nbsp;think&nbsp;it's&nbsp;not&nbsp;a&nbsp;problem&nbsp;of&nbsp;blocked&nbsp;ports&nbsp;and&nbsp;so&nbsp;on.&nbsp;Can&nbsp;anyone<br>
help&nbsp;me&nbsp;on&nbsp;understanding&nbsp;the&nbsp;problem?&nbsp;The&nbsp;code&nbsp;is&nbsp;the&nbsp;following.&nbsp;Running<br>
it&nbsp;with&nbsp;.NET&nbsp;Framework&nbsp;result&nbsp;in&nbsp;an&nbsp;error&nbsp;due&nbsp;to&nbsp;invalid&nbsp;sender&nbsp;address<br>
but&nbsp;the&nbsp;connection&nbsp;works.&nbsp;Thanks&nbsp;in&nbsp;advance.&lt;br&gt;&lt;br&gt;<br>
&lt;tt&gt;System.Web.Mail.MailMessage&nbsp;msg&nbsp;=&nbsp;new<br>
System.Web.Mail.MailMessage();&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
msg.From&nbsp;=&nbsp;&amp;quot;test@gmail.com&amp;quot;;&lt;br&gt;<br>
msg.To&nbsp;=&nbsp;&amp;quot;test@gmail.com&amp;quot;;&lt;br&gt;<br>
msg.Subject&nbsp;=&nbsp;&amp;quot;test&amp;quot;;&lt;br&gt;<br>
msg.Body&nbsp;=&nbsp;&amp;quot;test&amp;quot;;&lt;br&gt;<br>
msg.BodyFormat&nbsp;=&nbsp;System.Web.Mail.MailFormat.Html;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
msg.Fields[&amp;quot;&lt;a&nbsp;href=&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;&nbsp;eudora=&quot;autourl&quot;&gt;<br>
http://schemas.microsoft.com/cdo/configuration/smtpserver&lt;/a&gt;&amp;quot;]&nbsp;=<br>
&amp;quot;smtp.gmail.com&amp;quot;;&lt;br&gt;<br>
msg.Fields[&amp;quot;&lt;a&nbsp;href=&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;&nbsp;eudora=&quot;autourl&quot;&gt;<br>
http://schemas.microsoft.com/cdo/configuration/smtpserverport&lt;/a&gt;&amp;quot;]<br>
=&nbsp;465;&lt;br&gt;<br>
msg.Fields[&amp;quot;&lt;a&nbsp;href=&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;&nbsp;eudora=&quot;autourl&quot;&gt;<br>
http://schemas.microsoft.com/cdo/configuration/sendusing&lt;/a&gt;&amp;quot;]&nbsp;=<br>
2;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
msg.Fields[&amp;quot;&lt;a&nbsp;href=&quot;http://schemas.microsoft.com/cdo/configuration/smtpusessl&quot;&nbsp;eudora=&quot;autourl&quot;&gt;<br>
http://schemas.microsoft.com/cdo/configuration/smtpusessl&lt;/a&gt;&amp;quot;]&nbsp;=<br>
true;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
msg.Fields[&amp;quot;&lt;a&nbsp;href=&quot;http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;&nbsp;eudora=&quot;autourl&quot;&gt;<br>
http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&lt;/a&gt;<br>
&amp;quot;]&nbsp;=&nbsp;1;&lt;br&gt;<br>
msg.Fields[&amp;quot;&lt;a&nbsp;href=&quot;http://schemas.microsoft.com/cdo/configuration/sendusername&quot;&nbsp;eudora=&quot;autourl&quot;&gt;<br>
http://schemas.microsoft.com/cdo/configuration/sendusername&lt;/a&gt;&amp;quot;]&nbsp;=<br>
&amp;quot;test&amp;quot;;&lt;br&gt;<br>
msg.Fields[&amp;quot;&lt;a&nbsp;href=&quot;http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;&nbsp;eudora=&quot;autourl&quot;&gt;<br>
http://schemas.microsoft.com/cdo/configuration/sendpassword&lt;/a&gt;&amp;quot;]&nbsp;=<br>
&amp;quot;test&amp;quot;;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
System.Web.Mail.SmtpMail.Send(msg);&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
