<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;small;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;TEXT-DECORATION:&nbsp;none&quot;&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;small;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;TEXT-DECORATION:&nbsp;none&quot;&gt;<br>
&lt;P&gt;&gt;I'm&nbsp;not&nbsp;at&nbsp;home,&nbsp;so&nbsp;it's&nbsp;tough&nbsp;to&nbsp;look&nbsp;up&nbsp;-&nbsp;can&nbsp;you&nbsp;specify&nbsp;the&nbsp;response&nbsp;<br>
output&nbsp;stream&nbsp;as&nbsp;the&nbsp;target&nbsp;for&nbsp;the&nbsp;standard&nbsp;&gt;output&nbsp;redirection&nbsp;for&nbsp;the&nbsp;<br>
process?&nbsp;&nbsp;If&nbsp;so,&nbsp;that&nbsp;would&nbsp;connect&nbsp;the&nbsp;two,&nbsp;and&nbsp;you'd&nbsp;likely&nbsp;not&nbsp;even&nbsp;need&nbsp;<br>
to&nbsp;read&nbsp;from&nbsp;&gt;the&nbsp;process&nbsp;and&nbsp;write&nbsp;to&nbsp;the&nbsp;output.&nbsp;&nbsp;&lt;/P&gt;<br>
&lt;P&gt;I&nbsp;tried&lt;/P&gt;<br>
&lt;DIV&gt;process.StandardOutput&nbsp;=&nbsp;Response.OutputStream;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;and&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;Response.OutputStream&nbsp;=&nbsp;process.StandardOutput;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;but&nbsp;got&nbsp;compile&nbsp;error&nbsp;that&nbsp;property&nbsp;is&nbsp;read&nbsp;only&nbsp;in&nbsp;both&nbsp;cases.&lt;/DIV&gt;<br>
&lt;P&gt;&gt;You&nbsp;might&nbsp;need&nbsp;to&nbsp;fiddle&nbsp;with&nbsp;the&nbsp;flush&nbsp;interval&nbsp;for&nbsp;the&nbsp;stream,&nbsp;so&nbsp;it&nbsp;<br>
doesn't&nbsp;&lt;/P&gt;<br>
&lt;P&gt;&gt;try&nbsp;to&nbsp;accrue&nbsp;the&nbsp;whole&nbsp;result&nbsp;before&nbsp;writing&nbsp;it.&lt;/P&gt;<br>
&lt;DIV&gt;Code&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
[AcceptVerbs(HttpVerbs.Get)]&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;FileStreamResult&nbsp;<br>
BackupPipe()&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;<br>
process&nbsp;=&nbsp;new&nbsp;Process();&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
process.StartInfo.Arguments&nbsp;=&nbsp;&quot;&nbsp;-ib&nbsp;-Z6&nbsp;-Fc&nbsp;-h&nbsp;1.2.3.4&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
process.StartInfo.UseShellExecute&nbsp;=&nbsp;false;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
process.StartInfo.FileName&nbsp;=&nbsp;“/usr/pgsql/9.1/bin/pg_dump”;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
process.StartInfo.RedirectStandardOutput&nbsp;=&nbsp;true;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
Server.ScriptTimeout&nbsp;=&nbsp;8&nbsp;*&nbsp;60&nbsp;*&nbsp;60;&nbsp;//&nbsp;8&nbsp;hours&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
process.Start();&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<br>
new&nbsp;FileStreamResult(process.StandardOutput.BaseStream,&nbsp;<br>
&quot;application/backup&quot;);&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;seems&nbsp;to&nbsp;work&nbsp;in&nbsp;both&nbsp;Linux&nbsp;and&nbsp;Windows.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;top&nbsp;shows&nbsp;mono.bin&nbsp;and&nbsp;after&nbsp;download&nbsp;starts&nbsp;httpd&nbsp;%MEM&nbsp;values&nbsp;up&nbsp;to&nbsp;<br>
36%&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;How&nbsp;to&nbsp;add&nbsp;error&nbsp;reporting&nbsp;so&nbsp;that&nbsp;user&nbsp;can&nbsp;notified&nbsp;if&nbsp;error&nbsp;occurs?&nbsp;<br>
Currently&nbsp;bad&nbsp;file&nbsp;is&nbsp;received&nbsp;without&nbsp;any&nbsp;notice.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Before&nbsp;download&nbsp;starts,&nbsp;pg_dump&nbsp;runs&nbsp;without&nbsp;data&nbsp;being&nbsp;sent&nbsp;to&nbsp;browser&nbsp;and&nbsp;<br>
users&nbsp;sees&nbsp;hourglass&nbsp;for&nbsp;a&nbsp;long&nbsp;time.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;File&nbsp;download&nbsp;prompt&nbsp;in&nbsp;browser&nbsp;occurs&nbsp;only&nbsp;after&nbsp;pg_dump&nbsp;and&nbsp;mono.bin&nbsp;<br>
commands&nbsp;are&nbsp;completed.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;How&nbsp;to&nbsp;force&nbsp;download&nbsp;to&nbsp;start&nbsp;earlier&nbsp;or&nbsp;show&nbsp;some&nbsp;progress&nbsp;message&nbsp;to&nbsp;<br>
user&nbsp;in&nbsp;browser&nbsp;during&nbsp;pg_dump&nbsp;run?&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Andrus.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Note.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Wrapping&nbsp;process&nbsp;creation&nbsp;to&nbsp;use&nbsp;statement:&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;use&nbsp;(&nbsp;var&nbsp;process&nbsp;=&nbsp;new&nbsp;Process()&nbsp;)&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;process.StartInfo.Arguments&nbsp;=&nbsp;&quot;&nbsp;-ib&nbsp;-Z6&nbsp;-Fc&nbsp;-h&nbsp;1.2.3.4&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;process.StartInfo.UseShellExecute&nbsp;=&nbsp;false;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;process.StartInfo.RedirectStandardOutput&nbsp;=&nbsp;true;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;process.StartInfo.FileName&nbsp;=&nbsp;“/usr/pgsql/9.1/bin/pg_dump”;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;Server.ScriptTimeout&nbsp;=&nbsp;8&nbsp;*&nbsp;60&nbsp;*&nbsp;60;&nbsp;//&nbsp;8&nbsp;hours&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;process.Start();&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;return&nbsp;new&nbsp;FileStreamResult(process.StandardOutput.BaseStream,&nbsp;<br>
&quot;application/backup&quot;);&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;causes&nbsp;“object&nbsp;is&nbsp;used&nbsp;after&nbsp;being&nbsp;disposed”&nbsp;exception&nbsp;in&nbsp;Mono&nbsp;but&nbsp;works&nbsp;in&nbsp;<br>
windows.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Is&nbsp;this&nbsp;mono&nbsp;bug&nbsp;?&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
