<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-aspnet-list] Auto SQL generation during Update requires a valid SelectCommand
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Auto%20SQL%20generation%20during%20Update%20requires%20a%0A%20valid%20SelectCommand&In-Reply-To=22550410.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000118.html">
   <LINK REL="Next"  HREF="000121.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-aspnet-list] Auto SQL generation during Update requires a valid SelectCommand</H1>
    <B>trucu</B> 
    <A HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Auto%20SQL%20generation%20during%20Update%20requires%20a%0A%20valid%20SelectCommand&In-Reply-To=22550410.post%40talk.nabble.com"
       TITLE="[Mono-aspnet-list] Auto SQL generation during Update requires a valid SelectCommand">jrtaveras at gmail.com
       </A><BR>
    <I>Sat Apr 25 22:25:29 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000118.html">[Mono-aspnet-list] Auto SQL generation during Update requires a valid SelectCommand
</A></li>
        <LI>Next message: <A HREF="000121.html">[Mono-aspnet-list]  Problem using a web service.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#120">[ date ]</a>
              <a href="thread.html#120">[ thread ]</a>
              <a href="subject.html#120">[ subject ]</a>
              <a href="author.html#120">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
hello, be shure that you table, having key in any field, because if you table
don't having key the commandbuilder fails!!


jan van der watt wrote:
&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> This error has been reported in this forum (in 2006 and 2008), but no
</I>&gt;<i> apparent resolution has been provided, so I am re-posting with more
</I>&gt;<i> information.
</I>&gt;<i> 
</I>&gt;<i> I must be missing something really obvious so I would really appreciate a
</I>&gt;<i> pointer in the right direction as updating/inserting is obviously
</I>&gt;<i> essential to any web site :-) and posting a definite/detailed resolution
</I>&gt;<i> would also help other beginners.
</I>&gt;<i> 
</I>&gt;<i> I get this error during any and all attempts to update/add a record in my
</I>&gt;<i> MySQL database on openSUSE 11 using MONO 2.2 (or 1.9) with MySql Connector
</I>&gt;<i> 5.x (or 6.0).
</I>&gt;<i> 
</I>&gt;<i> Caught an exception:
</I>&gt;<i> Message: [Auto SQL generation during Update requires a valid
</I>&gt;<i> SelectCommand.]
</I>&gt;<i> Occurred: [  at System.Data.Common.DbDataAdapter.Update
</I>&gt;<i> (System.Data.DataRow[] dataRows, System.Data.Common.DataTableMapping
</I>&gt;<i> tableMapping) [0x00000] ]
</I>&gt;<i> In: [Int32 Update(System.Data.DataRow[],
</I>&gt;<i> System.Data.Common.DataTableMapping)]
</I>&gt;<i> 
</I>&gt;<i> Note: The code works fine on Windows XP using the same connectors and
</I>&gt;<i> connection strings to the same MySQL database.
</I>&gt;<i> 
</I>&gt;<i> After many many variations and attempts, all failing, I took the example
</I>&gt;<i> from the MySQL Connector Manual (I only added the connection string/table
</I>&gt;<i> name and error trapping):
</I>&gt;<i> 
</I>&gt;<i>         String myConnection =
</I>&gt;<i> &quot;Server=www.xxxyyyzzz.org;Uid=demo;Pwd=xxxyyyzzz;Database=demo;&quot;;
</I>&gt;<i>         String mySelectQuery = &quot;SELECT * FROM Tenant;&quot;;
</I>&gt;<i>         String myTableName = &quot;Tenant&quot;;
</I>&gt;<i> 
</I>&gt;<i>         MySqlConnection myConn = new MySqlConnection(myConnection);
</I>&gt;<i>         MySqlDataAdapter myDataAdapter = new MySqlDataAdapter();
</I>&gt;<i>         myDataAdapter.SelectCommand = new MySqlCommand(mySelectQuery,
</I>&gt;<i> myConn);
</I>&gt;<i>         MySqlCommandBuilder cb = new MySqlCommandBuilder(myDataAdapter);
</I>&gt;<i> 
</I>&gt;<i>         try {
</I>&gt;<i> 
</I>&gt;<i>             myConn.Open();
</I>&gt;<i> 
</I>&gt;<i>             DataSet ds = new DataSet();
</I>&gt;<i>             myDataAdapter.Fill(ds, myTableName);
</I>&gt;<i> 
</I>&gt;<i>             //code to modify data in DataSet here
</I>&gt;<i>             DataRow row = ds.Tables[myTableName].Rows[0];
</I>&gt;<i>             row.BeginEdit();
</I>&gt;<i>             row[&quot;Tenant&quot;] += &quot;-&quot;;      // very simple change
</I>&gt;<i>             row.EndEdit();
</I>&gt;<i> 
</I>&gt;<i>             //Without the MySqlCommandBuilder this line would fail
</I>&gt;<i>             int updated_records = myDataAdapter.Update(ds, myTableName);
</I>&gt;<i> 
</I>&gt;<i>             Response.Write(Utilities.variable(&quot;updated records&quot;,
</I>&gt;<i> updated_records));
</I>&gt;<i>         } catch (Exception ex) {
</I>&gt;<i>             Response.Write(Utilities.format_exception(ex));
</I>&gt;<i>         }
</I>&gt;<i> 
</I>&gt;<i>         myConn.Close();
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> The schema for Tenant is:
</I>&gt;<i> CREATE TABLE `Tenant` (
</I>&gt;<i>   `TenantID` int(11) NOT NULL auto_increment,
</I>&gt;<i>   `Tenant` varchar(50) NOT NULL,
</I>&gt;<i>   PRIMARY KEY  (`TenantID`),
</I>&gt;<i>   KEY `TenantID` (`TenantID`)
</I>&gt;<i> ) ENGINE=MyISAM AUTO_INCREMENT=28 DEFAULT CHARSET=utf8;
</I>&gt;<i> 
</I>&gt;<i> I have two openSUSE boxes, one built from the openSUSE 11 distro DVD, and
</I>&gt;<i> another, a Linode (virtual machine) set up from the Linode pre-installed
</I>&gt;<i> images. Both machines give the same problem.
</I>&gt;<i> 
</I>&gt;<i> I installed using YaST (so, I did not compile from source) trying both:
</I>&gt;<i> <A HREF="ftp://ftp.novell.com/pub/mono/download-stable/openSUSE_11.1/i586/">ftp://ftp.novell.com/pub/mono/download-stable/openSUSE_11.1/i586/</A> and
</I>&gt;<i> <A HREF="http://download.opensuse.org/update/11.0/rpm/">http://download.opensuse.org/update/11.0/rpm/</A>
</I>&gt;<i> 
</I>&gt;<i> Thanks in advance.
</I>&gt;<i> 
</I>&gt;<i> Jan
</I>&gt;<i> 
</I>
-- 
View this message in context: <A HREF="http://www.nabble.com/Auto-SQL-generation-during-Update-requires-a-valid-SelectCommand-tp22550410p23238564.html">http://www.nabble.com/Auto-SQL-generation-during-Update-requires-a-valid-SelectCommand-tp22550410p23238564.html</A>
Sent from the Mono - ASP.NET mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000118.html">[Mono-aspnet-list] Auto SQL generation during Update requires a valid SelectCommand
</A></li>
	<LI>Next message: <A HREF="000121.html">[Mono-aspnet-list]  Problem using a web service.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#120">[ date ]</a>
              <a href="thread.html#120">[ thread ]</a>
              <a href="subject.html#120">[ subject ]</a>
              <a href="author.html#120">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">More information about the Mono-aspnet-list
mailing list</a><br>
</body></html>
