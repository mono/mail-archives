<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-aspnet-list] FluentNHibernate InvalidCastException at creating SessionFactory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20FluentNHibernate%20InvalidCastException%20at%0A%20creating%20SessionFactory&In-Reply-To=1314360013067-3770661.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001395.html">
   <LINK REL="Next"  HREF="001397.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-aspnet-list] FluentNHibernate InvalidCastException at creating SessionFactory</H1>
    <B>gajcz</B> 
    <A HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20FluentNHibernate%20InvalidCastException%20at%0A%20creating%20SessionFactory&In-Reply-To=1314360013067-3770661.post%40n4.nabble.com"
       TITLE="[Mono-aspnet-list] FluentNHibernate InvalidCastException at creating SessionFactory">gajczewski at gmail.com
       </A><BR>
    <I>Fri Aug 26 11:01:56 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001395.html">[Mono-aspnet-list] FluentNHibernate InvalidCastException at	creating SessionFactory
</A></li>
        <LI>Next message: <A HREF="001397.html">[Mono-aspnet-list] FluentNHibernate InvalidCastException at creating SessionFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1396">[ date ]</a>
              <a href="thread.html#1396">[ thread ]</a>
              <a href="subject.html#1396">[ subject ]</a>
              <a href="author.html#1396">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok, it seems I resolved this problem by myself. This is what I found (maybe
it will help someone):

Going deeper to NHibernate sources I noticed that only when
*setting.IsKeywordsImportEnabled* is set the crashing part is fired
(SchemaMetadataUpdater.Update(this)).
There the SuppliedConnectionProviderConnectionHelper tries to cast some type
to DbConnection, this type is probably NpgsqlConnection class which doesn't
derive from DbConnection, however it implements IDbConnection.

How to disable IsKeywordImportEnabled?

sessionFactory = Fluently.Configure() 
                .Database(databaseConfiguration) 
                .Mappings(m =&gt; 
                    { 
                       
m.FluentMappings.AddFromAssemblyOf&lt;Models.MyClass&gt;(); 
                    }) 
                *.ExposeConfiguration(c =&gt;
                    {
                        c.SetProperty(Environment.Hbm2ddlKeyWords, &quot;none&quot;);
                    })*
                .BuildSessionFactory();

Actually I don't know what this setting will cause, but retrieving and
inserting entities seem to work fine.

--
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/FluentNHibernate-InvalidCastException-at-creating-SessionFactory-tp3770661p3771120.html">http://mono.1490590.n4.nabble.com/FluentNHibernate-InvalidCastException-at-creating-SessionFactory-tp3770661p3771120.html</A>
Sent from the Mono - ASP.NET mailing list archive at Nabble.com.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001395.html">[Mono-aspnet-list] FluentNHibernate InvalidCastException at	creating SessionFactory
</A></li>
	<LI>Next message: <A HREF="001397.html">[Mono-aspnet-list] FluentNHibernate InvalidCastException at creating SessionFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1396">[ date ]</a>
              <a href="thread.html#1396">[ thread ]</a>
              <a href="subject.html#1396">[ subject ]</a>
              <a href="author.html#1396">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">More information about the Mono-aspnet-list
mailing list</a><br>
</body></html>
