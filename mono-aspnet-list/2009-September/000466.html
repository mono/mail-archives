<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-aspnet-list] Apache mod_mono web service timeout exception not as expected
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Apache%20mod_mono%20web%20service%20timeout%0A%20exception%20not%20as%20expected&In-Reply-To=25491479.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000465.html">
   <LINK REL="Next"  HREF="000467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-aspnet-list] Apache mod_mono web service timeout exception not as expected</H1>
    <B>Wagark</B> 
    <A HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Apache%20mod_mono%20web%20service%20timeout%0A%20exception%20not%20as%20expected&In-Reply-To=25491479.post%40talk.nabble.com"
       TITLE="[Mono-aspnet-list] Apache mod_mono web service timeout exception not as expected">dantespace.ml at gmail.com
       </A><BR>
    <I>Thu Sep 24 09:15:55 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000465.html">[Mono-aspnet-list] ASP.NET MVC - LINQ Datacontext not implemented
</A></li>
        <LI>Next message: <A HREF="000467.html">[Mono-aspnet-list] CompilationException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#466">[ date ]</a>
              <a href="thread.html#466">[ thread ]</a>
              <a href="subject.html#466">[ subject ]</a>
              <a href="author.html#466">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello guys,
   anybody can help?

Thanks and regards,
Dante

----------------------------------

Hi,

I have developed a web service that will run on Linux. I have an issue when
the web method called spend more time to run than timeount set in
Web.config.

I added these lines in web.config to manage timeout exception:

&lt;system.web&gt;
&lt;!-- [...] --&gt;
      &lt;httpRuntime executionTimeout=&quot;1&quot;
          maxRequestLength=&quot;4096&quot;
          useFullyQualifiedRedirectUrl=&quot;false&quot;
          minFreeThreads=&quot;8&quot;
          minLocalRequestFreeThreads=&quot;4&quot;
          appRequestQueueLimit=&quot;100&quot; /&gt;

      &lt;customErrors mode=&quot;Off&quot;/&gt;
&lt;!-- [...] --&gt;
&lt;/system.web&gt;

My web service is the following:

[WebMethod]
public string HelloWorld(int timeout)
{
     Thread.Sleep(timeout);   //milliseconds
     return &quot;Hello World&quot;;
}

I tested timeout exception from remote machine using a test project from
Visual Studio with the following test:

        // Calling HelloWorld that sleeps 10 seconds but setting mod_mono
timeout just to 1 second.
        [TestMethod]
        public void TestWsUtilitiesHelloWorldTimeoutExceptionOnLinux()
        {
            PrepareDiskSoapClient c = new PrepareDiskSoapClient(
           &quot;PrepareDiskSoap&quot;,
&quot;<A HREF="http://[ipMachine]/[ProjectName]/PrepareNewVMDiskImage.asmx&quot;">http://[ipMachine]/[ProjectName]/PrepareNewVMDiskImage.asmx&quot;</A>);

            c.HelloWorld(10000);
        }

As you can see I used a client/proxy created with WCF to call the web
service.
I also tried to use the client proxy automatically generated by mod_mono
application.

Anyway, in both scenarios an exception not just about the timeout is thrown.
Using mod_mono automatically generated client proxy the exception is the
following:

Test method
Reply.PrivateCloud.Tests.WsUtilitiesTest.TestTimeoutExceptionOnLinuxWithClientProxyGeneratedByLinux
threw exception: System.InvalidOperationException: Client found response
content type of 'text/html; charset=utf-8', but expected 'text/xml'.
The request failed with the error message:
--
&lt;?xml version=&quot;1.0&quot; ?&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
&quot;<A HREF="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</A>&gt;&lt;html
xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml&quot;">http://www.w3.org/1999/xhtml&quot;</A> xml:lang=&quot;en&quot;
lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;Error 500&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body
{font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:normal;font-size:
.7em;color:black;background-color: white}
p {font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:normal;color:black;margin-top: -5px}
b {font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:bold;color:black;margin-top: -5px}
h1 { font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:normal;font-size:18pt;color:red }
h2 { font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:normal;font-size:14pt;color:maroon }
pre,code {font-family:&quot;Lucida Console&quot;,&quot;DejaVu Sans
Mono&quot;,monospace;font-size: 0.9em,white-space: pre-line}
div.bodyText {font-family: &quot;Verdana&quot;,&quot;DejaVu Sans&quot;,sans-serif}
table.sampleCode {width: 100%; background-color: #ffffcc; }
.errorText {color: red; font-weight: bold}
.marker {font-weight: bold; color: black;text-decoration: none;}
.version {color: gray;}
.error {margin-bottom: 10px;}
.expandable { text-decoration:underline; font-weight:bold; color:navy;
cursor:pointer; }&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Server Error in
'/Reply.PrivateCloud.WSUtilities' Application&lt;/h1&gt;&lt;hr style=&quot;color:
silver&quot;/&gt;&lt;h2&gt;&lt;em&gt;The request timed out.&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Description: &lt;/strong&gt;HTTP 500. Error processing request.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stack Trace: &lt;/strong&gt;&lt;/p&gt;&lt;table summary=&quot;Stack Trace&quot;
class=&quot;sampleCode&quot;&gt;
&lt;tr&gt;&lt;td&gt;&lt;pre&gt;System.Web.HttpException: The request timed
out.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;hr style=&quot;color: silver&quot;/&gt;&lt;strong&gt;Version information: &lt;/strong&gt; Mono
Version: 2.0.50727.42; ASP.NET Version: 2.0.50727.42&lt;/body&gt;&lt;/html&gt;
&lt;!--
[System.Web.HttpException]: The request timed out.

--&gt;
--.

Basically the client wait for a XML answer but receives an HTML answer.
Mod_mono is configured using AutoHosting method.

Could anyone help to solve this issue?

Thank you in advance for your help,
Dante


-- 
View this message in context: <A HREF="http://www.nabble.com/Apache-mod_mono-web-service-timeout-exception-not-as-expected-tp25491479p25567738.html">http://www.nabble.com/Apache-mod_mono-web-service-timeout-exception-not-as-expected-tp25491479p25567738.html</A>
Sent from the Mono - ASP.NET mailing list archive at Nabble.com.

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000465.html">[Mono-aspnet-list] ASP.NET MVC - LINQ Datacontext not implemented
</A></li>
	<LI>Next message: <A HREF="000467.html">[Mono-aspnet-list] CompilationException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#466">[ date ]</a>
              <a href="thread.html#466">[ thread ]</a>
              <a href="subject.html#466">[ subject ]</a>
              <a href="author.html#466">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">More information about the Mono-aspnet-list
mailing list</a><br>
</body></html>
