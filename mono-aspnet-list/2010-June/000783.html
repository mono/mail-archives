<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-aspnet-list] Socket error sending secured mail.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Socket%20error%20sending%20secured%20mail.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000782.html">
   <LINK REL="Next"  HREF="000784.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-aspnet-list] Socket error sending secured mail.</H1>
    <B>APS</B> 
    <A HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Socket%20error%20sending%20secured%20mail.&In-Reply-To="
       TITLE="[Mono-aspnet-list] Socket error sending secured mail.">dev.malst at apsystems.it
       </A><BR>
    <I>Thu Jun  3 05:10:40 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000782.html">[Mono-aspnet-list] problem internet explorer
</A></li>
        <LI>Next message: <A HREF="000784.html">[Mono-aspnet-list] Socket error sending secured mail.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#783">[ date ]</a>
              <a href="thread.html#783">[ thread ]</a>
              <a href="subject.html#783">[ subject ]</a>
              <a href="author.html#783">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm trying so send secured mail with mono using System.Web.Mail in aspnet.
I read this 
&lt;<A HREF="http://www.mono-project.com/FAQ:_Security#Does_SSL_works_for_SMTP.2C_like_GMail_.3F">http://www.mono-project.com/FAQ:_Security#Does_SSL_works_for_SMTP.2C_like_GMail_.3F</A>&gt;<A HREF="http://www.mono-project.com/FAQ:_Security#Does_SSL_works_for_SMTP.2C_like_GMail_.3F">http://www.mono-project.com/FAQ:_Security#Does_SSL_works_for_SMTP.2C_like_GMail_.3F</A> 
and I made the described operations but when I try to send the mail I 
always immediately obtain

System.Web.HttpException: Connection refused ---&gt; 
System.Net.Sockets.SocketException: Connection refused at 
System.Net.Sockets.Socket.Connect (System.Net.EndPoint remote_end) [0x00000]
at System.Net.Sockets.TcpClient.Connect (System.Net.IPEndPoint 
remote_end_point) [0x00000]
at System.Net.Sockets.TcpClient.Connect (System.Net.IPAddress[] 
ipAddresses, Int32 port) [0x00000]
--- End of inner exception stack trace ---
at System.Web.Mail.SmtpMail.Send (System.Web.Mail.MailMessage 
message) [0x00000]

Launching this command

openssl s_client -connect smtp.gmail.com:465

I obtain

220 mx.google.com ESMTP

so I think it's not a problem of blocked ports and so on. Can anyone 
help me on understanding the problem? The code is the following. 
Running it with .NET Framework result in an error due to invalid 
sender address but the connection works. Thanks in advance.

System.Web.Mail.MailMessage msg = new System.Web.Mail.MailMessage();

msg.From = &quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">test at gmail.com</A>&quot;;
msg.To = &quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">test at gmail.com</A>&quot;;
msg.Subject = &quot;test&quot;;
msg.Body = &quot;test&quot;;
msg.BodyFormat = System.Web.Mail.MailFormat.Html;

msg.Fields[&quot;<A HREF="http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;]">http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;]</A> 
= &quot;smtp.gmail.com&quot;;
msg.Fields[&quot;<A HREF="http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;]">http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;]</A> 
= 465;
msg.Fields[&quot;<A HREF="http://schemas.microsoft.com/cdo/configuration/sendusing&quot;]">http://schemas.microsoft.com/cdo/configuration/sendusing&quot;]</A> = 2;

msg.Fields[&quot;<A HREF="http://schemas.microsoft.com/cdo/configuration/smtpusessl&quot;]">http://schemas.microsoft.com/cdo/configuration/smtpusessl&quot;]</A> = true;

msg.Fields[&quot;<A HREF="http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;]">http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;]</A> 
= 1;
msg.Fields[&quot;<A HREF="http://schemas.microsoft.com/cdo/configuration/sendusername&quot;]">http://schemas.microsoft.com/cdo/configuration/sendusername&quot;]</A> 
= &quot;test&quot;;
msg.Fields[&quot;<A HREF="http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;]">http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;]</A> 
= &quot;test&quot;;

System.Web.Mail.SmtpMail.Send(msg);
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-aspnet-list/attachments/20100603/acd3c3ab/attachment-0001.html">http://lists.ximian.com/pipermail/mono-aspnet-list/attachments/20100603/acd3c3ab/attachment-0001.html</A> 
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000782.html">[Mono-aspnet-list] problem internet explorer
</A></li>
	<LI>Next message: <A HREF="000784.html">[Mono-aspnet-list] Socket error sending secured mail.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#783">[ date ]</a>
              <a href="thread.html#783">[ thread ]</a>
              <a href="subject.html#783">[ subject ]</a>
              <a href="author.html#783">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">More information about the Mono-aspnet-list
mailing list</a><br>
</body></html>
