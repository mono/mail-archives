<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-aspnet-list] Finding reason for Internal Server Error 500	when opening openXML document
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Finding%20reason%20for%20Internal%20Server%20Error%20500%0A%09when%20opening%20openXML%20document&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000531.html">
   <LINK REL="Next"  HREF="000532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-aspnet-list] Finding reason for Internal Server Error 500	when opening openXML document</H1>
    <B>Jan van der watt</B> 
    <A HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Finding%20reason%20for%20Internal%20Server%20Error%20500%0A%09when%20opening%20openXML%20document&In-Reply-To="
       TITLE="[Mono-aspnet-list] Finding reason for Internal Server Error 500	when opening openXML document">janvanderwatt at gmail.com
       </A><BR>
    <I>Tue Oct 27 22:42:18 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000531.html">[Mono-aspnet-list] Having trouble registering mysql.data.dll with gac
</A></li>
        <LI>Next message: <A HREF="000532.html">[Mono-aspnet-list] Having trouble registering mysql.data.dll with gac
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#530">[ date ]</a>
              <a href="thread.html#530">[ thread ]</a>
              <a href="subject.html#530">[ subject ]</a>
              <a href="author.html#530">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm trying to use Microsoft's DocumentFormat.OpenXml.dll on Mono 2.4 on
openSuse 11.1 to modify a 2007 docx Word file. I get a &quot;Error 500 - Internal
Server error&quot; as soon as I hit this line of code:

WordprocessingDocument package =
WordprocessingDocument.Open(template_filename, true);

This issue is potentially not specific to the ASP part of Mono, but since it
causes a Server Error, perhaps it is. Searching for this (e.g. &quot;Internal
Server Error WordprocessingDocument.Open&quot;) on Google returns a lot of
irrelevant results.

The code works on ASP.NET on XP.

I have:
- checked that the file exists (if ( File.Exists(template_filename) ) { ...
}) (it's 177 kB, expanded, 902 kB)
- given full rights to the file (0777)
- checked that DocumentFormat.OpenXml.dll is loaded (if I rename it, I get
the appropriate &quot;Could not load file or assembly 'DocumentFormat.OpenXml,
Version=2.0.4330.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one
of its dependencies.&quot;error)
- installed WindowsBase.dll (3.0.0.0, via mono-winfxcore 1.0-1.8)
- tried using XP's WindowsBase.dll (but this turned out to be a bad idea as
it relies on other WIN32 dll's)

Unfortunately, since the server aborts, it isn't possible to get a more
detailed message.

So, I'd really appreciate some help discovering:
- what causes a server error of the magnitude that it aborts without more
information
- if it can be fixed (i.e. some guidelines on how to get Microsoft's openXML
going on Mono (I'm not aware of any licensing issues))
- how to fix it

Sample code can be viewed at: <A HREF="http://diag.pastebin.com/m71027189">http://diag.pastebin.com/m71027189</A>

Thanks!

Jan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-aspnet-list/attachments/20091028/57a09651/attachment.html">http://lists.ximian.com/pipermail/mono-aspnet-list/attachments/20091028/57a09651/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000531.html">[Mono-aspnet-list] Having trouble registering mysql.data.dll with gac
</A></li>
	<LI>Next message: <A HREF="000532.html">[Mono-aspnet-list] Having trouble registering mysql.data.dll with gac
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#530">[ date ]</a>
              <a href="thread.html#530">[ thread ]</a>
              <a href="subject.html#530">[ subject ]</a>
              <a href="author.html#530">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">More information about the Mono-aspnet-list
mailing list</a><br>
</body></html>
