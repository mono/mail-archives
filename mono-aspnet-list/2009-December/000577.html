<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-aspnet-list] Finding reason for Internal Server Error 500 when opening openXML document
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Finding%20reason%20for%20Internal%20Server%20Error%20500%0A%20when%20opening%20openXML%20document&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000576.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-aspnet-list] Finding reason for Internal Server Error 500 when opening openXML document</H1>
    <B>karenb</B> 
    <A HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=%5BMono-aspnet-list%5D%20Finding%20reason%20for%20Internal%20Server%20Error%20500%0A%20when%20opening%20openXML%20document&In-Reply-To="
       TITLE="[Mono-aspnet-list] Finding reason for Internal Server Error 500 when opening openXML document">kerenba at shaam.gov.il
       </A><BR>
    <I>Thu Dec 31 05:31:02 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000576.html">[Mono-aspnet-list]  nBrowser.Build.InitializeTree Error
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#577">[ date ]</a>
              <a href="thread.html#577">[ thread ]</a>
              <a href="subject.html#577">[ subject ]</a>
              <a href="author.html#577">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
HI Jan
i would like to know if you solved this problem that you have explained. 
I am trying the same code and am recieving the same error. I am working on
it ofr a few weeks and have not found the reason for the problem.
On my localhost the code works but on the main server i get the 500 error
Thank you
Karen


jan van der watt wrote:
&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I'm trying to use Microsoft's DocumentFormat.OpenXml.dll on Mono 2.4 on
</I>&gt;<i> openSuse 11.1 to modify a 2007 docx Word file. I get a &quot;Error 500 -
</I>&gt;<i> Internal
</I>&gt;<i> Server error&quot; as soon as I hit this line of code:
</I>&gt;<i> 
</I>&gt;<i> WordprocessingDocument package =
</I>&gt;<i> WordprocessingDocument.Open(template_filename, true);
</I>&gt;<i> 
</I>&gt;<i> This issue is potentially not specific to the ASP part of Mono, but since
</I>&gt;<i> it
</I>&gt;<i> causes a Server Error, perhaps it is. Searching for this (e.g. &quot;Internal
</I>&gt;<i> Server Error WordprocessingDocument.Open&quot;) on Google returns a lot of
</I>&gt;<i> irrelevant results.
</I>&gt;<i> 
</I>&gt;<i> The code works on ASP.NET on XP.
</I>&gt;<i> 
</I>&gt;<i> I have:
</I>&gt;<i> - checked that the file exists (if ( File.Exists(template_filename) ) {
</I>&gt;<i> ...
</I>&gt;<i> }) (it's 177 kB, expanded, 902 kB)
</I>&gt;<i> - given full rights to the file (0777)
</I>&gt;<i> - checked that DocumentFormat.OpenXml.dll is loaded (if I rename it, I get
</I>&gt;<i> the appropriate &quot;Could not load file or assembly 'DocumentFormat.OpenXml,
</I>&gt;<i> Version=2.0.4330.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or
</I>&gt;<i> one
</I>&gt;<i> of its dependencies.&quot;error)
</I>&gt;<i> - installed WindowsBase.dll (3.0.0.0, via mono-winfxcore 1.0-1.8)
</I>&gt;<i> - tried using XP's WindowsBase.dll (but this turned out to be a bad idea
</I>&gt;<i> as
</I>&gt;<i> it relies on other WIN32 dll's)
</I>&gt;<i> 
</I>&gt;<i> Unfortunately, since the server aborts, it isn't possible to get a more
</I>&gt;<i> detailed message.
</I>&gt;<i> 
</I>&gt;<i> So, I'd really appreciate some help discovering:
</I>&gt;<i> - what causes a server error of the magnitude that it aborts without more
</I>&gt;<i> information
</I>&gt;<i> - if it can be fixed (i.e. some guidelines on how to get Microsoft's
</I>&gt;<i> openXML
</I>&gt;<i> going on Mono (I'm not aware of any licensing issues))
</I>&gt;<i> - how to fix it
</I>&gt;<i> 
</I>&gt;<i> Sample code can be viewed at: <A HREF="http://diag.pastebin.com/m71027189">http://diag.pastebin.com/m71027189</A>
</I>&gt;<i> 
</I>&gt;<i> Thanks!
</I>&gt;<i> 
</I>&gt;<i> Jan
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-aspnet-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">Mono-aspnet-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">http://lists.ximian.com/mailman/listinfo/mono-aspnet-list</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-- 
View this message in context: <A HREF="http://old.nabble.com/Finding-reason-for-Internal-Server-Error-500-when-opening-openXML-document-tp26088478p26975812.html">http://old.nabble.com/Finding-reason-for-Internal-Server-Error-500-when-opening-openXML-document-tp26088478p26975812.html</A>
Sent from the Mono - ASP.NET mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000576.html">[Mono-aspnet-list]  nBrowser.Build.InitializeTree Error
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#577">[ date ]</a>
              <a href="thread.html#577">[ thread ]</a>
              <a href="subject.html#577">[ subject ]</a>
              <a href="author.html#577">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">More information about the Mono-aspnet-list
mailing list</a><br>
</body></html>
