<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-aspnet-list] Contents of Mono-aspnet-list digest...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-aspnet-list%5D%20Contents%20of%20Mono-aspnet-list%20digest...&In-Reply-To=%3C00aa01ce0472%24c78e2ed0%2456aa8c70%24%40ishafoundation.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001788.html">
   <LINK REL="Next"  HREF="001791.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-aspnet-list] Contents of Mono-aspnet-list digest...</H1>
    <B>Saravanan S</B> 
    <A HREF="mailto:mono-aspnet-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-aspnet-list%5D%20Contents%20of%20Mono-aspnet-list%20digest...&In-Reply-To=%3C00aa01ce0472%24c78e2ed0%2456aa8c70%24%40ishafoundation.org%3E"
       TITLE="[Mono-aspnet-list] Contents of Mono-aspnet-list digest...">saravanan.subramaniam at ishafoundation.org
       </A><BR>
    <I>Wed Feb  6 14:03:41 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001788.html">[Mono-aspnet-list] &quot;No application found&quot; errors from mod_mono
</A></li>
        <LI>Next message: <A HREF="001791.html">[Mono-aspnet-list] ORM use to manipulate data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1790">[ date ]</a>
              <a href="thread.html#1790">[ thread ]</a>
              <a href="subject.html#1790">[ subject ]</a>
              <a href="author.html#1790">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Pranam
SARAVANAN

-----Original Message-----
From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list-bounces at lists.ximian.com</A>] On Behalf Of
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list-request at lists.ximian.com</A>
Sent: 06 February 2013 5:30 PM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list at lists.ximian.com</A>
Subject: Mono-aspnet-list Digest, Vol 48, Issue 2

Send Mono-aspnet-list mailing list submissions to
	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list at lists.ximian.com</A>

To subscribe or unsubscribe via the World Wide Web, visit
	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">http://lists.ximian.com/mailman/listinfo/mono-aspnet-list</A>
or, via email, send a message with subject or body 'help' to
	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list-request at lists.ximian.com</A>

You can reach the person managing the list at
	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list-owner at lists.ximian.com</A>

When replying, please edit your Subject line so it is more specific than
&quot;Re: Contents of Mono-aspnet-list digest...&quot;


Today's Topics:

   1. &quot;No application found&quot; errors from mod_mono (Richard Birkby)
   2. Re: WebRequest POST with client certificate (Stefan Kadow)


----------------------------------------------------------------------

Message: 1
Date: Tue, 5 Feb 2013 14:52:47 +0000
From: Richard Birkby &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">rbirkby at gmail.com</A>&gt;
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list at lists.ximian.com</A>
Subject: [Mono-aspnet-list] &quot;No application found&quot; errors from
	mod_mono
Message-ID:
	&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">CAO+Vd0gMOQ6z0rm3WNJrK3fqb5vmxkfoyq63xE+fLPjtd5GjzQ at mail.gmail.com</A>&gt;
Content-Type: text/plain; charset=&quot;iso-8859-1&quot;

Hi,

I'm moving a website from a SheevaPlug appliance (Debian ARM) to a Raspberry
Pi (Raspbian/Wheezy).

Apache works fine, but whenever I make a request to a .aspx page, error.log
gets an entry saying:

[error] No application found for XXXX.aspx

I believe I've configured everything in the same way as on the SheevaPlug
(mod_mono_auto), but I can't get past this message. It looks like
mod-mono-server4 has been started as it's in my process list, and I've also
made sure the MonoServerPath is set correctly (as it seemed to default to
mod-mono-server2). /tmp/mod_mono_server_global and
/tmp/mod_mono_server_global_&lt;number&gt; both exist.

Where can I look next? What other debugging options will help me drill down
further?


Thanks,
Richard
-------------- next part --------------
An HTML attachment was scrubbed...
URL:
&lt;<A HREF="http://lists.ximian.com/pipermail/mono-aspnet-list/attachments/20130205/5ee">http://lists.ximian.com/pipermail/mono-aspnet-list/attachments/20130205/5ee</A>
570ac/attachment-0001.html&gt;

------------------------------

Message: 2
Date: Tue, 05 Feb 2013 17:44:28 +0100
From: Stefan Kadow &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">stefan.kadow at cervis.de</A>&gt;
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">mono-aspnet-list at lists.ximian.com</A>
Subject: Re: [Mono-aspnet-list] WebRequest POST with client
	certificate
Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">511136EC.90405 at cervis.de</A>&gt;
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Now, I have a version which works with mono (2.6.7 and 2.10.8) on Linux and
mono (2.10.9) on Windows, but not with .NET This time I used the
SslStream-class for the HTTP-request. It is important to use a
LocalCertificateSelectionCallback method, which will be called while the
ssl-renegotiation!

What I do not understand is the property sslStream.IsMutuallyAuthenticated,
which will allways be false!

The following code (HTTP &quot;POST&quot;) runs successful on mono (Linux &amp; Windows),
but throws an excpection with .NET:
static void postSslStream()
{
     string hostname = &quot;server.net&quot;;

     byte[] contentBytes = Encoding.UTF8.GetBytes(&quot;&lt;?xml version=\&quot;1.0\&quot; 
encoding=\&quot;utf-8\&quot;?&gt;&lt;message/&gt;&quot;);

     StringBuilder headerSB = new StringBuilder();
     headerSB.AppendLine(&quot;POST /mvc/contr/action HTTP/1.1&quot;);
     headerSB.Append(&quot;Host: &quot;).AppendLine(hostname);
     headerSB.AppendLine(&quot;Content-Type: text/xml; charset=utf-8&quot;);
     headerSB.Append(&quot;Content-Length: 
&quot;).Append(contentBytes.Length).AppendLine();
     headerSB.AppendLine();
     byte[] headerBytes = Encoding.UTF8.GetBytes(headerSB.ToString());

     X509Certificate2Collection certColl = new X509Certificate2Collection();
     certColl.Import(&quot;certfile.p12&quot;, string.Empty,
X509KeyStorageFlags.DefaultKeySet);

     TcpClient client = new TcpClient(hostname, 443);
     try
     {
         using (SslStream sslStream = new SslStream(client.GetStream(),
false,
             new
RemoteCertificateValidationCallback(RemoteCertificateValidation),
             new
LocalCertificateSelectionCallback(LocalCertificateSelection)))
         {
             sslStream.AuthenticateAsClient(hostname, certColl,
System.Security.Authentication.SslProtocols.Tls, false);
             sslStream.Write(headerBytes);
             sslStream.Write(contentBytes);
             sslStream.Flush();

             StreamReader reader = new StreamReader(sslStream);
             Console.WriteLine(reader.ReadToEnd());
         }
     }
     finally
     {
         client.Close();
     }
}

public static bool RemoteCertificateValidation(object sender,
X509Certificate certificate,
     X509Chain chain, SslPolicyErrors sslPolicyErrors) {
     return (sslPolicyErrors == SslPolicyErrors.None); }

public static X509Certificate LocalCertificateSelection(Object sender,
string targetHost,
     X509CertificateCollection localCertificates, X509Certificate
remoteCertificate, string[] acceptableIssuers) {
     if (remoteCertificate.Issuer == localCertificates[0].Issuer)
         return localCertificates[0];

     return null;
}



Am 14.01.2013 00:36, schrieb Stefan Kadow:
&gt;<i> Hello,
</I>&gt;<i> I have a MVC2 web application running on Debian squeeze with Apache 
</I>&gt;<i> 2.2.16, OpenSSL 0.9.8 and mono 2.6.7. I want to secure the access with 
</I>&gt;<i> SSL client certificates, for identification and authorization.
</I>&gt;<i>
</I>&gt;<i> The client programm running on another machine uses the HttpWebRequest 
</I>&gt;<i> class for accessing the server with HTTP methods &quot;GET&quot; and &quot;POST&quot;. On 
</I>&gt;<i> windows machines the client program runs fine using .NET 3.5.
</I>&gt;<i> On Linux machines the client program runs only with HTTP method &quot;GET&quot;. 
</I>&gt;<i> A WebRequest with HTTP method &quot;POST&quot; throws an exception. I tried the 
</I>&gt;<i> following code on client machines with Debian squeeze (mono 2.6.7) and 
</I>&gt;<i> Debian wheezy (mono 2.10.8).
</I>&gt;<i>
</I>&gt;<i> The following code (HTTP &quot;GET&quot;) runs successful on Windows and Linux:
</I>&gt;<i> HttpWebRequest request = (HttpWebRequest) 
</I>&gt;<i> WebRequest.Create(&quot;<A HREF="https://server.net/mvc/contr/action">https://server.net/mvc/contr/action</A>&quot;);
</I>&gt;<i>
</I>&gt;<i> X509Certificate2Collection certColl =
</I>&gt;<i> new X509Certificate2Collection();
</I>&gt;<i> certColl.Import(&quot;certfile.p12&quot;, &quot;123&quot;, 
</I>&gt;<i> X509KeyStorageFlags.Exportable); 
</I>&gt;<i> request.ClientCertificates.AddRange(certColl);
</I>&gt;<i>
</I>&gt;<i> HttpWebResponse response = (HttpWebResponse)request.GetResponse();
</I>&gt;<i> Console.WriteLine(response.StatusDescription);
</I>&gt;<i>
</I>&gt;<i> Stream responseStream = response.GetResponseStream(); StreamReader 
</I>&gt;<i> reader = new StreamReader(responseStream); 
</I>&gt;<i> Console.WriteLine(reader.ReadToEnd());
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The following code (HTTP &quot;POST&quot;) runs successful on Windows, but 
</I>&gt;<i> throws an excpection on Linux:
</I>&gt;<i> HttpWebRequest request = (HttpWebRequest) 
</I>&gt;<i> WebRequest.Create(&quot;<A HREF="https://server.net/mvc/contr/action">https://server.net/mvc/contr/action</A>&quot;);
</I>&gt;<i>
</I>&gt;<i> X509Certificate2Collection certColl =
</I>&gt;<i> new X509Certificate2Collection();
</I>&gt;<i> certColl.Import(&quot;certfile.p12&quot;, &quot;123&quot;, 
</I>&gt;<i> X509KeyStorageFlags.Exportable); 
</I>&gt;<i> request.ClientCertificates.AddRange(certColl);
</I>&gt;<i>
</I>&gt;<i> string postData = @&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt; 
</I>&gt;<i> &lt;message/&gt;&quot;; byte[] byteArray = Encoding.UTF8.GetBytes(postData); 
</I>&gt;<i> request.Method = &quot;POST&quot;; request.ContentType = &quot;text/xml&quot;; 
</I>&gt;<i> request.ContentLength = byteArray.Length; request.KeepAlive = false; 
</I>&gt;<i> // needed for POST-requests(?)
</I>&gt;<i>
</I>&gt;<i> Stream requestStream = request.GetRequestStream(); 
</I>&gt;<i> requestStream.Write(byteArray, 0, byteArray.Length); // exception 
</I>&gt;<i> requestStream.Close();
</I>&gt;<i>
</I>&gt;<i> HttpWebResponse response = (HttpWebResponse)request.GetResponse();
</I>&gt;<i> Console.WriteLine(response.StatusDescription);
</I>&gt;<i>
</I>&gt;<i> Stream responseStream = response.GetResponseStream(); StreamReader 
</I>&gt;<i> reader = new StreamReader(responseStream); 
</I>&gt;<i> Console.WriteLine(reader.ReadToEnd());
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The exception thrown is:
</I>&gt;<i> System.Net.WebException: Error getting response stream (ReadDone1):
</I>&gt;<i> ReceiveFailure ---&gt; System.IO.IOException: The authentication or 
</I>&gt;<i> decryption has failed. ---&gt; Mono.Security.Protocol.Tls.TlsException: 
</I>&gt;<i> The authentication or decryption has failed.
</I>&gt;<i>
</I>&gt;<i> Apache error log lists:
</I>&gt;<i> [error] Re-negotiation handshake failed: Not accepted by client!?
</I>&gt;<i>
</I>&gt;<i> Apache configuration:
</I>&gt;<i> # mono.security needs old/insecure re-negotiation:
</I>&gt;<i> SSLInsecureRenegotiation on
</I>&gt;<i> &lt;Directory /var/www/bin/mvc&gt;
</I>&gt;<i> SSLVerifyClient require
</I>&gt;<i> SSLVerifyDepth 1
</I>&gt;<i> SSLUserName SSL_CLIENT_S_DN_CN
</I>&gt;<i> SSLOptions +StdEnvVars +ExportCertData +OptRenegotiate &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i> The server certificate is signed by GeoTrust, the GeoTrust root 
</I>&gt;<i> certificate is installed with certmgr.exe in Trust store. The 
</I>&gt;<i> self-signed CA certificate, which signed the client certificates is 
</I>&gt;<i> part of the pkcs12-file and additionally installed in Trust store, too.
</I>&gt;<i> But, the certificates can not be the problem, because the WebRequests 
</I>&gt;<i> with HTTP method GET are running fine on Linux client machines.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-aspnet-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">Mono-aspnet-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">http://lists.ximian.com/mailman/listinfo/mono-aspnet-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

------------------------------

_______________________________________________
Mono-aspnet-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">Mono-aspnet-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">http://lists.ximian.com/mailman/listinfo/mono-aspnet-list</A>


End of Mono-aspnet-list Digest, Vol 48, Issue 2
***********************************************

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001788.html">[Mono-aspnet-list] &quot;No application found&quot; errors from mod_mono
</A></li>
	<LI>Next message: <A HREF="001791.html">[Mono-aspnet-list] ORM use to manipulate data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1790">[ date ]</a>
              <a href="thread.html#1790">[ thread ]</a>
              <a href="subject.html#1790">[ subject ]</a>
              <a href="author.html#1790">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-aspnet-list">More information about the Mono-aspnet-list
mailing list</a><br>
</body></html>
