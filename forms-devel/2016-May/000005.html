<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [forms-devel] Fixing the iOS ListView when using HasUnevenRows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:forms-devel%40lists.xamarin.com?Subject=Re%3A%20%5Bforms-devel%5D%20Fixing%20the%20iOS%20ListView%20when%20using%20HasUnevenRows&In-Reply-To=%3CCACz56BzzA7qc_Orr%2BbPue3D-RnWokcx-KViY0a8ZvXTR5nebzw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000002.html">
   <LINK REL="Next"  HREF="000003.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[forms-devel] Fixing the iOS ListView when using HasUnevenRows</H1>
    <B>Jason Smith</B> 
    <A HREF="mailto:forms-devel%40lists.xamarin.com?Subject=Re%3A%20%5Bforms-devel%5D%20Fixing%20the%20iOS%20ListView%20when%20using%20HasUnevenRows&In-Reply-To=%3CCACz56BzzA7qc_Orr%2BbPue3D-RnWokcx-KViY0a8ZvXTR5nebzw%40mail.gmail.com%3E"
       TITLE="[forms-devel] Fixing the iOS ListView when using HasUnevenRows">jason.smith at xamarin.com
       </A><BR>
    <I>Fri May  6 16:48:27 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000002.html">[forms-devel] Fixing the iOS ListView when using HasUnevenRows
</A></li>
        <LI>Next message: <A HREF="000003.html">[forms-devel] TargetPlatform and Device.OnPlatform Changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5">[ date ]</a>
              <a href="thread.html#5">[ thread ]</a>
              <a href="subject.html#5">[ subject ]</a>
              <a href="author.html#5">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Johan,

The estimated row height is supposed to prevent iOS from realizing
everything in your ListView, thats the reason it is there. We will need to
look into why exactly that is triggering you to get full list realization
in your case, our test case doesn't seem to trigger this effect when
HasUnevenRows = true. Also as we continue this conversation can I please
ask that you specify iOS:Cell vs Forms:Cell for clarity.

Jason

On Fri, May 6, 2016 at 1:32 AM, Johan Otterud &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">johan.otterud at gmail.com</A>&gt;
wrote:

&gt;<i> Hi everyone!
</I>&gt;<i>
</I>&gt;<i> I began posting in gitter by Miguel asked to use the mail list so I will
</I>&gt;<i> do that :)
</I>&gt;<i>
</I>&gt;<i> I want to discuss some fixes to the ListView for iOS. After you released
</I>&gt;<i> the source code I could finally get it working really well in my project.
</I>&gt;<i>
</I>&gt;<i> I needed to make a listview that used elements that could collapse and
</I>&gt;<i> expand. It also needed recycling of cells. The current implementation has a
</I>&gt;<i> bug/oversight that brakes virtualization when using HasUnevenRows = true.
</I>&gt;<i> In the GetHeightForRow in UnevenListViewSource it will create new cells in
</I>&gt;<i> order to be able to measure their height. This gives really choppy and bad
</I>&gt;<i> performance. Also it will never realse my viewcells causing memory leaks.
</I>&gt;<i> This works a lot better when not using HasUnevenRows = false, but that is
</I>&gt;<i> not possible for many applications such as mine.
</I>&gt;<i>
</I>&gt;<i> I fixed this in my implementation by getting the height directly from the
</I>&gt;<i> data items in the ListProxy class (by using an ICellHeight interface or
</I>&gt;<i> reflection). I also had to remove estimate row height to fix scrolling
</I>&gt;<i> issues.
</I>&gt;<i>
</I>&gt;<i> Finally I made collapsing expanding work nicely by not using
</I>&gt;<i> ForceUpdateSize since this also contains some bugs. I do this by listening
</I>&gt;<i> to a INotifyPropertyChanged event for each data item in ListProxy (a
</I>&gt;<i> &quot;Height&quot; property name), I set this up in the UnevenListViewSource. I also
</I>&gt;<i> batch these updates together so I can make a single
</I>&gt;<i> tableView.ReloadRows(...) call for all the items that should expand /
</I>&gt;<i> collapse.
</I>&gt;<i>
</I>&gt;<i> How can I help fix these issues in the official release? I understand that
</I>&gt;<i> things like this affect the design of the product so the way I solved it
</I>&gt;<i> might not be ok for the general public release.
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i> /Johan
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> forms-devel mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">forms-devel at lists.xamarin.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">http://lists.ximian.com/mailman/listinfo/forms-devel</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/forms-devel/attachments/20160506/35f270a2/attachment.html">http://lists.ximian.com/pipermail/forms-devel/attachments/20160506/35f270a2/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000002.html">[forms-devel] Fixing the iOS ListView when using HasUnevenRows
</A></li>
	<LI>Next message: <A HREF="000003.html">[forms-devel] TargetPlatform and Device.OnPlatform Changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5">[ date ]</a>
              <a href="thread.html#5">[ thread ]</a>
              <a href="subject.html#5">[ subject ]</a>
              <a href="author.html#5">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/forms-devel">More information about the forms-devel
mailing list</a><br>
</body></html>
