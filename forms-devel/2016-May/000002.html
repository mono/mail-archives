<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [forms-devel] Fixing the iOS ListView when using HasUnevenRows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:forms-devel%40lists.xamarin.com?Subject=Re%3A%20%5Bforms-devel%5D%20Fixing%20the%20iOS%20ListView%20when%20using%20HasUnevenRows&In-Reply-To=%3CCAJ9oYHC%2BA2JnEq2DKwppd2s8ze4X1hXz3V9zD%2BP%2B5%3DDFSC4s7A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000001.html">
   <LINK REL="Next"  HREF="000005.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[forms-devel] Fixing the iOS ListView when using HasUnevenRows</H1>
    <B>Johan Otterud</B> 
    <A HREF="mailto:forms-devel%40lists.xamarin.com?Subject=Re%3A%20%5Bforms-devel%5D%20Fixing%20the%20iOS%20ListView%20when%20using%20HasUnevenRows&In-Reply-To=%3CCAJ9oYHC%2BA2JnEq2DKwppd2s8ze4X1hXz3V9zD%2BP%2B5%3DDFSC4s7A%40mail.gmail.com%3E"
       TITLE="[forms-devel] Fixing the iOS ListView when using HasUnevenRows">johan.otterud at gmail.com
       </A><BR>
    <I>Fri May  6 08:32:35 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000001.html">[forms-devel] API: OnPlatform and Device.Platform extension to	support Mac properly
</A></li>
        <LI>Next message: <A HREF="000005.html">[forms-devel] Fixing the iOS ListView when using HasUnevenRows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2">[ date ]</a>
              <a href="thread.html#2">[ thread ]</a>
              <a href="subject.html#2">[ subject ]</a>
              <a href="author.html#2">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everyone!

I began posting in gitter by Miguel asked to use the mail list so I will do
that :)

I want to discuss some fixes to the ListView for iOS. After you released
the source code I could finally get it working really well in my project.

I needed to make a listview that used elements that could collapse and
expand. It also needed recycling of cells. The current implementation has a
bug/oversight that brakes virtualization when using HasUnevenRows = true.
In the GetHeightForRow in UnevenListViewSource it will create new cells in
order to be able to measure their height. This gives really choppy and bad
performance. Also it will never realse my viewcells causing memory leaks.
This works a lot better when not using HasUnevenRows = false, but that is
not possible for many applications such as mine.

I fixed this in my implementation by getting the height directly from the
data items in the ListProxy class (by using an ICellHeight interface or
reflection). I also had to remove estimate row height to fix scrolling
issues.

Finally I made collapsing expanding work nicely by not using
ForceUpdateSize since this also contains some bugs. I do this by listening
to a INotifyPropertyChanged event for each data item in ListProxy (a
&quot;Height&quot; property name), I set this up in the UnevenListViewSource. I also
batch these updates together so I can make a single
tableView.ReloadRows(...) call for all the items that should expand /
collapse.

How can I help fix these issues in the official release? I understand that
things like this affect the design of the product so the way I solved it
might not be ok for the general public release.

Thanks
/Johan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/forms-devel/attachments/20160506/c8da27aa/attachment.html">http://lists.ximian.com/pipermail/forms-devel/attachments/20160506/c8da27aa/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000001.html">[forms-devel] API: OnPlatform and Device.Platform extension to	support Mac properly
</A></li>
	<LI>Next message: <A HREF="000005.html">[forms-devel] Fixing the iOS ListView when using HasUnevenRows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2">[ date ]</a>
              <a href="thread.html#2">[ thread ]</a>
              <a href="subject.html#2">[ subject ]</a>
              <a href="author.html#2">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/forms-devel">More information about the forms-devel
mailing list</a><br>
</body></html>
