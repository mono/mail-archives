<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [forms-devel] Making the Effect constructor protected
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:forms-devel%40lists.xamarin.com?Subject=Re%3A%20%5Bforms-devel%5D%20Making%20the%20Effect%20constructor%20protected&In-Reply-To=%3CD575F319-7FBD-4D02-B55A-8B2D4684F308%40xamarin.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000034.html">
   <LINK REL="Next"  HREF="000033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[forms-devel] Making the Effect constructor protected</H1>
    <B>Alex Corrado</B> 
    <A HREF="mailto:forms-devel%40lists.xamarin.com?Subject=Re%3A%20%5Bforms-devel%5D%20Making%20the%20Effect%20constructor%20protected&In-Reply-To=%3CD575F319-7FBD-4D02-B55A-8B2D4684F308%40xamarin.com%3E"
       TITLE="[forms-devel] Making the Effect constructor protected">corrado at xamarin.com
       </A><BR>
    <I>Thu May 26 18:49:07 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000034.html">[forms-devel] Making the Effect constructor protected
</A></li>
        <LI>Next message: <A HREF="000033.html">[forms-devel] Quick question on ABI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42">[ date ]</a>
              <a href="thread.html#42">[ thread ]</a>
              <a href="subject.html#42">[ subject ]</a>
              <a href="author.html#42">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Miguel and co,

I had 2 scenarios for which I was looking to use an Effect. But with some guidance from Jason, I&#8217;ve realized that there are better approaches:

a) To apply some changes using Xamarin.Forms portable APIs to arbitrary Views on attach, and then to reset them on detach. For this scenario, Behaviors are a better choice.

b) Similar to (a), but Behaviors would not work because they do not guarantee that the renderer is available (while Effects do). While I needed the renderer, I was just doing a little reflection that was not platform-specific, so I was originally looking to do it in the PCL by subclassing Effect. However, I am now convinced it will be less fragile to just make the extra platform-specific assemblies and subclass PlatformEffect, even if the code in those assemblies is identical.

So in light of this, I am withdrawing my proposal. However, I suggest we add a note to the API documentation for the Effect class to point people at Behaviors who fall into category (a) above. This might save some people from starting down the same path I did.

Thanks everyone for your time,

Alex


&gt;<i> On May 25, 2016, at 10:56 PM, Miguel de Icaza &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">miguel at xamarin.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> Alex, can you shed some light as to what is the scenario that you wanted to cover by making the constructor accessible beyond the assembly?
</I>&gt;<i> 
</I>&gt;<i> On Wed, May 25, 2016 at 5:45 PM, Jason Smith &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">jason.smith at xamarin.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">jason.smith at xamarin.com</A>&gt;&gt; wrote:
</I>&gt;<i> We cannot move where OnElementPropertyChanged is declared without breaking ABI.
</I>&gt;<i> 
</I>&gt;<i> My objection is subclassing Effect directly has uses, but we have not clearly identified even a reasonable subset of them. Without having even the faintest idea of what we are going to use this API for we are about to open it up. However by opening it we drive users away from Behaviors which are more intended for the use case I assume you are thinking of doing with the Effect, which was part of the reason Effect is sealed. The Effect being sealed thing is really just a convenient implementation detail working around our platform limitations.
</I>&gt;<i> 
</I>&gt;<i> On Wed, May 25, 2016 at 2:36 PM, Alex Corrado &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">corrado at xamarin.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">corrado at xamarin.com</A>&gt;&gt; wrote:
</I>&gt;<i> Hey,
</I>&gt;<i> 
</I>&gt;<i> Thank you for saving me from writing a spec Miguel :)
</I>&gt;<i> 
</I>&gt;<i> Jason, to address your concern, we are already allowing people to subclass Effect indirectly, because PlatformEffect subclasses it and we are encouraging people to subclass that. So I don&#8217;t think making the Effect constructor public adds any additional constraints on our end.
</I>&gt;<i> 
</I>&gt;<i> The only (minor) API issue I see is that PlatformEffect declares `OnElementPropertyChanged`, when that should probably be declared in Effect itself. I&#8217;m not sure if we could move that without breaking ABI. But Effect also exposes the Element directly, so a subclassor could just subscribe to the property changed event themselves. 
</I>&gt;<i> 
</I>&gt;<i> -Alex
</I>&gt;<i> 
</I>&gt;&gt;<i> On May 25, 2016, at 5:03 PM, Miguel de Icaza &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">miguel at xamarin.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">miguel at xamarin.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I think we have enough information on this thread as to what is needed and we should make a decision.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Currently the Effect class can not be subclassed.   If we think that there are problems with the current implementation that would prevent us from opening that, let us have a discussion about what are the design problems with Effect, so we can decide what to do about it.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> MIguel.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Tue, May 24, 2016 at 3:15 PM, Jason Smith &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">jason.smith at xamarin.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">jason.smith at xamarin.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i> Hi Alex,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The issue I see with this is we just are not sure that we are ready to expose the effects API as is publicly. Once it is protected instead of internal that is forever a type users can inherit. That said, please submit a spec so we can have a formal discussion/review about it.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Jason
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Tue, May 24, 2016 at 12:13 PM, Alex Corrado &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">corrado at xamarin.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">corrado at xamarin.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i> Hello Forms people,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> As it stands now, it is impossible to create a cross-platform Effect in a PCL. To enable this, I propose we make the Xamarin.Forms.Effect constructor `protected` instead of `internal`.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I have already tried it and found it to work great, and I can&#8217;t think of any way this could break any existing code. I already submitted a PR, <A HREF="https://github.com/xamarin/Xamarin.Forms/pull/178">https://github.com/xamarin/Xamarin.Forms/pull/178</A> &lt;<A HREF="https://github.com/xamarin/Xamarin.Forms/pull/178">https://github.com/xamarin/Xamarin.Forms/pull/178</A>&gt; , but was told to discuss here first.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i> Alex Corrado
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> forms-devel mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">forms-devel at lists.xamarin.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">forms-devel at lists.xamarin.com</A>&gt;
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">http://lists.ximian.com/mailman/listinfo/forms-devel</A> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">http://lists.ximian.com/mailman/listinfo/forms-devel</A>&gt;
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> forms-devel mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">forms-devel at lists.xamarin.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">forms-devel at lists.xamarin.com</A>&gt;
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">http://lists.ximian.com/mailman/listinfo/forms-devel</A> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/forms-devel">http://lists.ximian.com/mailman/listinfo/forms-devel</A>&gt;
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/forms-devel/attachments/20160526/158aa8e1/attachment.html">http://lists.ximian.com/pipermail/forms-devel/attachments/20160526/158aa8e1/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000034.html">[forms-devel] Making the Effect constructor protected
</A></li>
	<LI>Next message: <A HREF="000033.html">[forms-devel] Quick question on ABI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42">[ date ]</a>
              <a href="thread.html#42">[ thread ]</a>
              <a href="subject.html#42">[ subject ]</a>
              <a href="author.html#42">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/forms-devel">More information about the forms-devel
mailing list</a><br>
</body></html>
