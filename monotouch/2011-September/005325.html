<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] btouch and structs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20btouch%20and%20structs&In-Reply-To=1317036511234-3843442.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005317.html">
   <LINK REL="Next"  HREF="005328.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] btouch and structs</H1>
    <B>Jeff Stedfast</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20btouch%20and%20structs&In-Reply-To=1317036511234-3843442.post%40n4.nabble.com"
       TITLE="[MonoTouch] btouch and structs">jeff at xamarin.com
       </A><BR>
    <I>Mon Sep 26 10:30:43 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="005317.html">[MonoTouch] btouch and structs
</A></li>
        <LI>Next message: <A HREF="005328.html">[MonoTouch] btouch and structs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5325">[ date ]</a>
              <a href="thread.html#5325">[ thread ]</a>
              <a href="subject.html#5325">[ subject ]</a>
              <a href="author.html#5325">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Walter,

Try this:  /Developer/MonoTouch/usr/bin/btouch libTestLib.cs Stuff.cs

(e.g. no -s:)

Jeff

On Mon, Sep 26, 2011 at 7:28 AM, retlaW &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">walterszewelanczyk at gmail.com</A>&gt;wrote:

&gt;<i> Hi.
</I>&gt;<i>
</I>&gt;<i> I am attempt to use btouch to bind to an obj-c library that needs to pass
</I>&gt;<i> data back and forth via structs.
</I>&gt;<i>
</I>&gt;<i> Ultimately I want to bind to the Wahoo Fitness ANT+ API they have but have
</I>&gt;<i> built a test library just to ensure I get the mapping concepts working
</I>&gt;<i> before I attempt to bind to the real library.
</I>&gt;<i>
</I>&gt;<i> Now I can bind everything I need with the exception of the struct.  I have
</I>&gt;<i> a
</I>&gt;<i> separate file with the struct definition and have tried to include the
</I>&gt;<i> struct in the mappingFile itself.  The struct is named Stuff and the error
</I>&gt;<i> I
</I>&gt;<i> get is : error CS0246: The type or namespace name `Stuff' could not be
</I>&gt;<i> found. Are you missing a using directive or an assembly reference?
</I>&gt;<i>
</I>&gt;<i> now the interesting part is if I leave the struct in the mapping file and
</I>&gt;<i> include the separate struct file I get this error : Stuff.cs(7,23): error
</I>&gt;<i> CS0101: The namespace `TestOne' already contains a definition for `Stuff'
</I>&gt;<i>  So it appears to see the struct yet it wont let me bind anything with it.
</I>&gt;<i>
</I>&gt;<i> Do I need to annotate the struct in some way for it to be used in btouch?
</I>&gt;<i>
</I>&gt;<i> If I comment out the parts that use the struct the everything else works as
</I>&gt;<i> expected.
</I>&gt;<i>
</I>&gt;<i> The command line I am using when the struct tis defined in the mapping file
</I>&gt;<i> is
</I>&gt;<i> /Developer/MonoTouch/usr/bin/btouch libTestLib.cs
</I>&gt;<i>
</I>&gt;<i> and when I have the struct in a separate file i use:
</I>&gt;<i>  /Developer/MonoTouch/usr/bin/btouch libTestLib.cs -s:Stuff.cs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Any help would be greatly appreciated.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Walt
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Below are the files in question :
</I>&gt;<i>
</I>&gt;<i> I have created a Obj-C Lib with the following header :
</I>&gt;<i> #import &amp;lt;Foundation/Foundation.h&amp;gt;
</I>&gt;<i>
</I>&gt;<i> --begin heder
</I>&gt;<i> typedef unsigned char                  UCHAR;
</I>&gt;<i>
</I>&gt;<i> typedef struct
</I>&gt;<i> {
</I>&gt;<i>        UCHAR messageSize;
</I>&gt;<i>        UCHAR messageId;
</I>&gt;<i>        UCHAR data1;
</I>&gt;<i>        UCHAR data2;
</I>&gt;<i> } Stuff;
</I>&gt;<i>
</I>&gt;<i> @protocol StructDelegate
</I>&gt;<i> - (void)processStruct:(Stuff)antMessage;
</I>&gt;<i> @end
</I>&gt;<i>
</I>&gt;<i> @protocol SimpleDelegate
</I>&gt;<i> - (NSString*)process:(NSString*)msg;
</I>&gt;<i> @end
</I>&gt;<i>
</I>&gt;<i> @interface TestLib : NSObject
</I>&gt;<i> {
</I>&gt;<i>    id &lt;StructDelegate&gt; del;
</I>&gt;<i>    id&lt;SimpleDelegate&gt; sDel;
</I>&gt;<i> }
</I>&gt;<i> - (NSString *) RepeatAfterMe:(NSString*) repeatMe;
</I>&gt;<i> - (NSString*) SayHello;
</I>&gt;<i> - (int) HardCodedValue;
</I>&gt;<i> - (NSString*) Send:(Stuff) s;
</I>&gt;<i> + (NSString*) classMethod;
</I>&gt;<i> - (void) save:(id &lt;StructDelegate&gt;) d;
</I>&gt;<i> - (void) saveSimple:(id &lt;SimpleDelegate&gt;) d;
</I>&gt;<i> - (NSString*) callSimple:(NSString*) s;
</I>&gt;<i> @end
</I>&gt;<i>
</I>&gt;<i> -- end header
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> and I have a mapping file for bTouch as :
</I>&gt;<i>
</I>&gt;<i> -- begin mapping file  (libTestLib.cs)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> using System;
</I>&gt;<i> using MonoTouch.Foundation;
</I>&gt;<i> using System.Runtime.InteropServices;
</I>&gt;<i> using MonoTouch.ObjCRuntime;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> namespace TestOne
</I>&gt;<i> {
</I>&gt;<i>        [BaseType (typeof(NSObject))]
</I>&gt;<i>        [Model]
</I>&gt;<i>        interface StructDelegate
</I>&gt;<i>        {
</I>&gt;<i>                [Export (&quot;processStruct:&quot;)]
</I>&gt;<i>        string processStruct (Stuff s);
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        [BaseType (typeof(NSObject))]
</I>&gt;<i>        [Model]
</I>&gt;<i>        interface SimpleDelegate
</I>&gt;<i>        {
</I>&gt;<i>                [Export (&quot;process:&quot;)]
</I>&gt;<i>        string process (string s);
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        [BaseType (typeof (NSObject))]
</I>&gt;<i>        interface TestLib {
</I>&gt;<i>                [Export (&quot;RepeatAfterMe:&quot;)]
</I>&gt;<i>                string RepeatAfterMe (string repeatMe);
</I>&gt;<i>
</I>&gt;<i>                [Export (&quot;SayHello&quot;)]
</I>&gt;<i>                string SayHello { get; }
</I>&gt;<i>
</I>&gt;<i>                [Export (&quot;HardCodedValue&quot;)]
</I>&gt;<i>                int HardCodedValue { get; }
</I>&gt;<i>
</I>&gt;<i>                [Static, Export (&quot;classMethod&quot;)]
</I>&gt;<i>                string ClassMethod { get; }
</I>&gt;<i>
</I>&gt;<i>                [Export(&quot;saveSimple:&quot;)]
</I>&gt;<i>                void SaveSimple(SimpleDelegate del);
</I>&gt;<i>
</I>&gt;<i>                [Export(&quot;callSimple:&quot;)]
</I>&gt;<i>                string CallSimple (string s);
</I>&gt;<i>
</I>&gt;<i>                [Export (&quot;save:&quot;)]
</I>&gt;<i>                void Save(StructDelegate d);
</I>&gt;<i>
</I>&gt;<i>                [Export (&quot;Send:&quot;)]
</I>&gt;<i>                string Send (Stuff s);
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i> /*
</I>&gt;<i>        [StructLayout(LayoutKind.Sequential)]
</I>&gt;<i>        [Serializable]
</I>&gt;<i>        public struct Stuff
</I>&gt;<i>        {
</I>&gt;<i>                public byte messageSize;
</I>&gt;<i>                public byte messageId;
</I>&gt;<i>                public byte data1;
</I>&gt;<i>                public byte data2;
</I>&gt;<i>        }
</I>&gt;<i> */
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> -- end mapping file
</I>&gt;<i>
</I>&gt;<i> and I have a file for the struct that I pass in defined as :
</I>&gt;<i>
</I>&gt;<i> -- begin struct file  (Stuff.cs)
</I>&gt;<i> using System;
</I>&gt;<i>
</I>&gt;<i> namespace TestOne
</I>&gt;<i> {
</I>&gt;<i>        //[StructLayout(LayoutKind.Sequential)]
</I>&gt;<i>        [Serializable ]
</I>&gt;<i>        public struct Stuff
</I>&gt;<i>        {
</I>&gt;<i>                public byte messageSize;
</I>&gt;<i>                public byte messageId;
</I>&gt;<i>                public byte data1;
</I>&gt;<i>                public byte data2;
</I>&gt;<i>        }
</I>&gt;<i> }
</I>&gt;<i> -end struct file
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://monotouch.2284126.n4.nabble.com/btouch-and-structs-tp3843442p3843442.html">http://monotouch.2284126.n4.nabble.com/btouch-and-structs-tp3843442p3843442.html</A>
</I>&gt;<i> Sent from the MonoTouch mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20110926/9e4e0d89/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20110926/9e4e0d89/attachment-0001.html</A> 
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005317.html">[MonoTouch] btouch and structs
</A></li>
	<LI>Next message: <A HREF="005328.html">[MonoTouch] btouch and structs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5325">[ date ]</a>
              <a href="thread.html#5325">[ thread ]</a>
              <a href="subject.html#5325">[ subject ]</a>
              <a href="author.html#5325">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
