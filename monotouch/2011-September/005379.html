<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Native code issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Native%20code%20issue&In-Reply-To=E3F83CB1185AF24EBF19FD93966BBFBD1E73C251%40MAILR012.mail.lan">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005377.html">
   <LINK REL="Next"  HREF="005380.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Native code issue</H1>
    <B>Jeff Stedfast</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Native%20code%20issue&In-Reply-To=E3F83CB1185AF24EBF19FD93966BBFBD1E73C251%40MAILR012.mail.lan"
       TITLE="[MonoTouch] Native code issue">jeff at xamarin.com
       </A><BR>
    <I>Wed Sep 28 19:16:13 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="005377.html">[MonoTouch] Native code issue
</A></li>
        <LI>Next message: <A HREF="005380.html">[MonoTouch] Native code issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5379">[ date ]</a>
              <a href="thread.html#5379">[ thread ]</a>
              <a href="subject.html#5379">[ subject ]</a>
              <a href="author.html#5379">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Conway, Walter,

Yes, unfortunately there are some issues that come about when linked with
some thumb libraries. I think Chris Toshok has been digging into these
issues but I'm unsure of the details. If you don't need thumb support, best
to disable it if possible (for now, at least).

Jeff

On Wed, Sep 28, 2011 at 6:13 PM, Conway Wieler &lt;
<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">conway.wieler at librestream.com</A>&gt; wrote:

&gt;<i> Walt,
</I>&gt;<i> If you have the ability to rebuild the native lib, you might want to try to
</I>&gt;<i> rebuild it without Thumb instruction support (&quot;Compile For Thumb&quot;==NO in
</I>&gt;<i> xcode build settings). We had a similar series of bizarre crashes and
</I>&gt;<i> failures until we turned off Thumb support. I've seen a few places on the
</I>&gt;<i> net (like
</I>&gt;<i> <A HREF="http://stackoverflow.com/questions/4565488/how-do-i-add-a-library-compiled-in-xcode-into-monotouch-so-that-it-works-for-bothand">http://stackoverflow.com/questions/4565488/how-do-i-add-a-library-compiled-in-xcode-into-monotouch-so-that-it-works-for-bothand</A>
</I>&gt;<i> <A HREF="http://stackoverflow.com/questions/5934121/application-with-static-library-runs-on-simulator-but-not-on-actual-device">http://stackoverflow.com/questions/5934121/application-with-static-library-runs-on-simulator-but-not-on-actual-device</A>)
</I>&gt;<i> that suggest Thumb should be disabled for linking with MonoTouch.
</I>&gt;<i> Hope this helps!
</I>&gt;<i> Conway
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A> [mailto:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>] On Behalf Of retlaW
</I>&gt;<i> Sent: September 28, 2011 3:51 PM
</I>&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>
</I>&gt;<i> Subject: [MonoTouch] Native code issue
</I>&gt;<i>
</I>&gt;<i> Hi Everyone.
</I>&gt;<i>
</I>&gt;<i> I am attempting to use the Wahoo Fitness lib to access their hardware ANT+
</I>&gt;<i> dongle.
</I>&gt;<i>
</I>&gt;<i> Now for the lib itself there are some instructions for XCode.  One is that
</I>&gt;<i> the info.plist needs Supported external accessory protocols, Value:
</I>&gt;<i> com.momentumoftechnology.fisica and the other was that the Other Linker
</I>&gt;<i> Flags key in the Linker section of the project settings needs to have this
</I>&gt;<i> added :  -lstdc++ -all_load.
</I>&gt;<i>
</I>&gt;<i> I have added these to the -gcc_flags and have added -cxx as shown here :
</I>&gt;<i>  -cxx -gcc_flags &quot;-L${ProjectDir}/Lib -lWFConnector  -framework
</I>&gt;<i> ExternalAccessory  -force_load ${ProjectDir}/Lib/libWFConnector.a
</I>&gt;<i> -lstdc++
</I>&gt;<i> -all_load &quot;
</I>&gt;<i>
</I>&gt;<i> I have mapped the lib using btouch and included the dll into the solution
</I>&gt;<i> as
</I>&gt;<i> well.
</I>&gt;<i>
</I>&gt;<i> I have 2 test apps that use the lib.  One is a real test with a few
</I>&gt;<i> projects, and the other is a stripped down version with no other projects
</I>&gt;<i> included. I have also created the equivalent ObjC version of the stripped
</I>&gt;<i> down app in XCode and that works as expected (so the lib itself should be
</I>&gt;<i> fine).
</I>&gt;<i>
</I>&gt;<i> For both apps when linking &quot;the SDK assemblies only&quot; both will give me a
</I>&gt;<i> SIGSEGV of :
</I>&gt;<i>
</I>&gt;<i> Native stacktrace:
</I>&gt;<i>
</I>&gt;<i>        0   WFConnTest                          0x001c1378
</I>&gt;<i> mono_handle_native_sigsegv + 412
</I>&gt;<i>        1   WFConnTest                          0x00191390
</I>&gt;<i> mono_sigsegv_signal_handler + 360
</I>&gt;<i>        2   libsystem_c.dylib                   0x33f1453d _sigtramp + 48
</I>&gt;<i>        3   libobjc.A.dylib                     0x37d34e71
</I>&gt;<i> objc_setProperty_non_gc
</I>&gt;<i> + 144
</I>&gt;<i>
</I>&gt;<i> =================================================================
</I>&gt;<i> Got a SIGSEGV while executing native code. This usually indicates
</I>&gt;<i> a fatal error in the mono runtime or one of the native libraries
</I>&gt;<i> used by your application.
</I>&gt;<i> =================================================================
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> For the Larger of the 2 apps if I &quot;don't link&quot; I get this error in the
</I>&gt;<i> debugger:
</I>&gt;<i>
</I>&gt;<i> System.NullReferenceException has been thrown
</I>&gt;<i> Object reference not set to an instance of an object.
</I>&gt;<i>
</I>&gt;<i> Then in the window it has :
</I>&gt;<i> at MonoTouch.ObjCRuntime.Method.RegisterTrampolines(IntPtr one, IntPtr two,
</I>&gt;<i> ...IntPtr nine)[0x00000] in &lt;filename unknown&gt;:0
</I>&gt;<i>
</I>&gt;<i> For the smaller app when I &quot;dont link&quot;, even in debug mode it crashes and
</I>&gt;<i> just closes the connection to the debugger with no output.
</I>&gt;<i>
</I>&gt;<i> I have searched around and will continue to do so , but at this point any
</I>&gt;<i> guidance, web references, books etc that may help me in being able to
</I>&gt;<i> resolve this would be greatly appreciated.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thank in advance,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Walt
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://monotouch.2284126.n4.nabble.com/Native-code-issue-tp3853257p3853257.html">http://monotouch.2284126.n4.nabble.com/Native-code-issue-tp3853257p3853257.html</A>
</I>&gt;<i> Sent from the MonoTouch mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20110928/2c741f24/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20110928/2c741f24/attachment-0001.html</A> 
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005377.html">[MonoTouch] Native code issue
</A></li>
	<LI>Next message: <A HREF="005380.html">[MonoTouch] Native code issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5379">[ date ]</a>
              <a href="thread.html#5379">[ thread ]</a>
              <a href="subject.html#5379">[ subject ]</a>
              <a href="author.html#5379">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
