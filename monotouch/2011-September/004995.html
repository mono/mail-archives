<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] UITextField.ShouldReturn crashes app
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20UITextField.ShouldReturn%20crashes%20app&In-Reply-To=1E768AF206E7E94FA03F838C8BA063A0053E1F%40COM03.paradigm.local">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004993.html">
   <LINK REL="Next"  HREF="005010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] UITextField.ShouldReturn crashes app</H1>
    <B>Pete Macko</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20UITextField.ShouldReturn%20crashes%20app&In-Reply-To=1E768AF206E7E94FA03F838C8BA063A0053E1F%40COM03.paradigm.local"
       TITLE="[MonoTouch] UITextField.ShouldReturn crashes app">pmacko at me.com
       </A><BR>
    <I>Thu Sep  8 19:37:25 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004993.html">[MonoTouch] UITextField.ShouldReturn crashes app
</A></li>
        <LI>Next message: <A HREF="005010.html">[MonoTouch] UITextField.ShouldReturn crashes app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4995">[ date ]</a>
              <a href="thread.html#4995">[ thread ]</a>
              <a href="subject.html#4995">[ subject ]</a>
              <a href="author.html#4995">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You might also want to check out how many new cells your code is actually creating (how many times DequeueReusableCell doesn't return a cell). Shouldn't be more than the max number visible in the list at a given time. Using the nib method of creating cell controllers, if you don't set the cell reuse identifier in the nib, it may not work the way you want.

Here's an example of a cell controller cache from some of my code (probably not the most elite way of doing this but it's working for me). I either cribbed this method from another MT developer, or translated it from some Obj-C, not sure which. What's happening is that the system is only instantiating a small number of cell controllers, to match the number of cells iOS wants to create. The code pokes new content into the controllers as needed. Keeps memory usage down but still lets you push the display and UI concerns into the cell controller class.

private Dictionary&lt;int, CompositionTableCell&gt; controllers = new Dictionary&lt;int, CompositionTableCell&gt;();
...
public override UITableViewCell GetCell(UITableView tableView, NSIndexPath indexPath)
{
	UITableViewCell cell = tableView.DequeueReusableCell(_cellIdentifier);
	CompositionTableCell cellController = null;
	if(cell == null)
	{
// !! can put a log statement in here to check for reuse
		cellController = new CompositionTableCell();
		cellController.ListDelegate = this; 
		cell = cellController.Cell;
		cell.Tag = Environment.TickCount;
		controllers[cell.Tag] = cellController;
	}
	else
	{
		cellController = controllers[cell.Tag];
// check for null &amp;&amp; backup create code deleted
	}
			
	var item = _filledContents[indexPath.Row]; //_filledContents is just a local array containing the data I want in the list

// the next line sets the current content of the cell controller - the cell controller code
// handles populating the image, labels, etc. in the cell
	cellController.Ingredient = AppState.State.MainModel.GetIngredientComponent(item);
	
	return cell;
}


On Sep 8, 2011, at 6:09 PM, Derik Palacino wrote:

&gt;<i> Great! Thanks again for all your help. I&#8217;ll try this first thing in the AM and post back that&#8230;err, I mean if&#8230;it worked.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Derik
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> From: Rolf Bjarne Kvinge [via MonoTouch] [mailto:ml-node+[hidden email]] 
</I>&gt;<i> Sent: Thursday, September 08, 2011 5:08 PM
</I>&gt;<i> To: Derik J. Palacino
</I>&gt;<i> Subject: Re: UITextField.ShouldReturn crashes app
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Hi Derik, 
</I>&gt;<i> 
</I>&gt;<i> On Thu, Sep 8, 2011 at 11:57 PM, Derik Palacino &lt;[hidden email]&gt; wrote: 
</I>&gt;<i> &gt; That&#8217;s what I thought you&#8217;d say. Is there cause for concern regarding memory 
</I>&gt;<i> &gt; usage maintaining a list of the cells outside the table itself? I&#8217;m just 
</I>&gt;<i> &gt; asking because I don&#8217;t know how the Mono framework tracks references (is it 
</I>&gt;<i> &gt; just a reference?) between managed and unmanaged memory. 
</I>&gt;<i> 
</I>&gt;<i> I wouldn't worry about memory usage as long as you keep an eye on the 
</I>&gt;<i> number of items in the list - have in mind that cell instances are 
</I>&gt;<i> reused, so in most cases the total number of live cells isn't that 
</I>&gt;<i> big. If it ever grows too much, you should be able to remove cells 
</I>&gt;<i> from the list that aren't in the table anymore. 
</I>&gt;<i> 
</I>&gt;<i> Rolf
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20110908/87667a08/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20110908/87667a08/attachment-0001.html</A> 
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004993.html">[MonoTouch] UITextField.ShouldReturn crashes app
</A></li>
	<LI>Next message: <A HREF="005010.html">[MonoTouch] UITextField.ShouldReturn crashes app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4995">[ date ]</a>
              <a href="thread.html#4995">[ thread ]</a>
              <a href="subject.html#4995">[ subject ]</a>
              <a href="author.html#4995">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
