<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Custom MapKit Pins/Circles
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Custom%20MapKit%20Pins/Circles&In-Reply-To=CACWcBbm-puw8QrgdPkb7Ppn4uxGunZdXiJNay6311dL70bpWKg%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004900.html">
   <LINK REL="Next"  HREF="004902.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Custom MapKit Pins/Circles</H1>
    <B>Mikkel L&#248;now</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Custom%20MapKit%20Pins/Circles&In-Reply-To=CACWcBbm-puw8QrgdPkb7Ppn4uxGunZdXiJNay6311dL70bpWKg%40mail.gmail.com"
       TITLE="[MonoTouch] Custom MapKit Pins/Circles">mloenow at gmail.com
       </A><BR>
    <I>Mon Sep  5 09:39:26 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004900.html">[MonoTouch] MonoTouch Research
</A></li>
        <LI>Next message: <A HREF="004902.html">[MonoTouch] Custom MapKit Pins/Circles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4899">[ date ]</a>
              <a href="thread.html#4899">[ thread ]</a>
              <a href="subject.html#4899">[ subject ]</a>
              <a href="author.html#4899">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At first glance it looks correct.

Is Build Action for pin.png set to Content? Can you make sure they are
actually copied to the .app package? (there's a bug in some versions of
MonoDevelop where images would not be copied).

Mikkel

P.S. Replied to all.

On Mon, Sep 5, 2011 at 15:32, Tomasz Cielecki &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">tomasz at ostebaronen.dk</A>&gt; wrote:

&gt;<i> I think your suggestion is more or less the same way I am implementing it.
</I>&gt;<i>
</I>&gt;<i> Code can be seen here <A HREF="https://gist.github.com/1194994">https://gist.github.com/1194994</A> or:
</I>&gt;<i>
</I>&gt;<i> Here is my Main.cs file:
</I>&gt;<i> using System;
</I>&gt;<i> using System.Collections.Generic;
</I>&gt;<i> using System.Linq;
</I>&gt;<i> using MonoTouch.Foundation;
</I>&gt;<i> using MonoTouch.UIKit;
</I>&gt;<i> using LoadSiteList;
</I>&gt;<i> using MonoTouch.MapKit;
</I>&gt;<i> using MonoTouch.CoreLocation;
</I>&gt;<i>
</I>&gt;<i> namespace MapsStuff
</I>&gt;<i> {
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        public class Application
</I>&gt;<i>        {
</I>&gt;<i>                static void Main (string[] args)
</I>&gt;<i>                {
</I>&gt;<i>                        UIApplication.Main (args);
</I>&gt;<i>                }
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        // The name AppDelegate is referenced in the MainWindow.xib file.
</I>&gt;<i>        public partial class AppDelegate : UIApplicationDelegate
</I>&gt;<i>        {
</I>&gt;<i>                UITabBarController tabBarController;
</I>&gt;<i>                os4MapsViewController viewController;
</I>&gt;<i>                MapsStuff.TableViewController viewController2;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                // This method is invoked when the application has loaded
</I>&gt;<i> its UI and
</I>&gt;<i> its ready to run
</I>&gt;<i>                public override bool FinishedLaunching (UIApplication app,
</I>&gt;<i> NSDictionary options)
</I>&gt;<i>                {
</I>&gt;<i>                        window = new UIWindow (UIScreen.MainScreen.Bounds);
</I>&gt;<i>                        tabBarController = new UITabBarController();
</I>&gt;<i>
</I>&gt;<i>                        viewController = new os4MapsViewController();
</I>&gt;<i>                        viewController2 = new TableViewController();
</I>&gt;<i>
</I>&gt;<i>                        viewController.TabBarItem = new UITabBarItem (&quot;Map&quot;,
</I>&gt;<i> UIImage.FromFile(&quot;Images/103-map.png&quot;), 0);
</I>&gt;<i>                        viewController2.TabBarItem = new UITabBarItem
</I>&gt;<i> (&quot;List&quot;,
</I>&gt;<i> UIImage.FromFile(&quot;Images/103-map.png&quot;), 0);
</I>&gt;<i>                        tabBarController.ViewControllers = new
</I>&gt;<i> UIViewController[]
</I>&gt;<i> {viewController, viewController2};
</I>&gt;<i>
</I>&gt;<i>                        window.AddSubview(tabBarController.View);
</I>&gt;<i>                        // If you have defined a view, add it here:
</I>&gt;<i>                        // window.AddSubview (navigationController.View);
</I>&gt;<i>
</I>&gt;<i>                        window.MakeKeyAndVisible ();
</I>&gt;<i>
</I>&gt;<i>                        return true;
</I>&gt;<i>                }
</I>&gt;<i>
</I>&gt;<i>                // This method is required in iPhoneOS 3.0
</I>&gt;<i>                public override void OnActivated (UIApplication application)
</I>&gt;<i>                {
</I>&gt;<i>                }
</I>&gt;<i>        }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> Next here is the os4MapsViewController.cs:
</I>&gt;<i>
</I>&gt;<i> using System;
</I>&gt;<i> using System.Drawing;
</I>&gt;<i> using System.Collections.Generic;
</I>&gt;<i> using System.Diagnostics;
</I>&gt;<i> using MonoTouch.Foundation;
</I>&gt;<i> using MonoTouch.UIKit;
</I>&gt;<i> using MonoTouch.MapKit;
</I>&gt;<i> using MonoTouch.CoreLocation;
</I>&gt;<i>
</I>&gt;<i> namespace MapsStuff
</I>&gt;<i> {
</I>&gt;<i>        public class os4MapsViewController: UIViewController
</I>&gt;<i>        {
</I>&gt;<i>                private MKMapView _mapView { get; set; }
</I>&gt;<i>                List&lt;MapsStuff.MapAnnotation&gt; pins;
</I>&gt;<i>
</I>&gt;<i>                public MKMapView MapView
</I>&gt;<i>                {
</I>&gt;<i>                        get { return _mapView; }
</I>&gt;<i>                }
</I>&gt;<i>
</I>&gt;<i>                public os4MapsViewController () : base()
</I>&gt;<i>                {}
</I>&gt;<i>
</I>&gt;<i>                public override void ViewDidLoad ()
</I>&gt;<i>                {
</I>&gt;<i>                        base.ViewDidLoad ();
</I>&gt;<i>
</I>&gt;<i>                        //
</I>&gt;<i>                        // Create our map view and add it as as subview.
</I>&gt;<i>                        //
</I>&gt;<i>                        pins = CreateRandomPins();
</I>&gt;<i>                        _mapView = new MKMapView();
</I>&gt;<i>                        _mapView.Frame = new RectangleF (0, 0,
</I>&gt;<i> this.View.Frame.Width,
</I>&gt;<i> this.View.Frame.Height);
</I>&gt;<i>                        _mapView.ShowsUserLocation = true;
</I>&gt;<i>                        _mapView.MapType = MKMapType.Hybrid;
</I>&gt;<i>                        _mapView.Delegate = new MapViewDelegate();
</I>&gt;<i>                        foreach (MapAnnotation m in pins)
</I>&gt;<i>                        {
</I>&gt;<i>                                _mapView.AddAnnotation(m);
</I>&gt;<i>                        }
</I>&gt;<i>                        View.AddSubview(_mapView);
</I>&gt;<i>                }
</I>&gt;<i>
</I>&gt;<i>                List&lt;MapsStuff.MapAnnotation&gt; CreateRandomPins()
</I>&gt;<i>                {
</I>&gt;<i>                        Random r = new Random();
</I>&gt;<i>                        List&lt;MapsStuff.MapAnnotation&gt; locations = new
</I>&gt;<i> List&lt;MapsStuff.MapAnnotation&gt;();
</I>&gt;<i>                        for (int i = 0; i &lt; 4; i++)
</I>&gt;<i>                        {
</I>&gt;<i>                                        locations.Add(
</I>&gt;<i>                                              new MapsStuff.MapAnnotation(
</I>&gt;<i>                                                  new
</I>&gt;<i> CLLocationCoordinate2D(r.NextDouble() * 180,
</I>&gt;<i> r.NextDouble() * 180),
</I>&gt;<i>                                                  &quot;test&quot; + i,
</I>&gt;<i>                                                  &quot;sub&quot; + i
</I>&gt;<i>                                              ));
</I>&gt;<i>                        }
</I>&gt;<i>
</I>&gt;<i>                        return locations;
</I>&gt;<i>                }
</I>&gt;<i>        }
</I>&gt;<i>        public class MapViewDelegate : MKMapViewDelegate
</I>&gt;<i>        {
</I>&gt;<i>                public MapViewDelegate (): base()
</I>&gt;<i>                {
</I>&gt;<i>                }
</I>&gt;<i>                public override MKAnnotationView GetViewForAnnotation
</I>&gt;<i> (MKMapView
</I>&gt;<i> mapView, NSObject annotation)
</I>&gt;<i>                {
</I>&gt;<i>                        var anv =
</I>&gt;<i> mapView.DequeueReusableAnnotation(&quot;thislocation&quot;);
</I>&gt;<i>                        if (anv == null)
</I>&gt;<i>                        {
</I>&gt;<i>                                Console.WriteLine(&quot;creating new
</I>&gt;<i> MKAnnotationView&quot;);
</I>&gt;<i>                                anv = new MKPinAnnotationView(annotation,
</I>&gt;<i> &quot;thislocation&quot;);
</I>&gt;<i>                        }
</I>&gt;<i>                        else
</I>&gt;<i>                        {
</I>&gt;<i>                                anv.Annotation = annotation;
</I>&gt;<i>                        }
</I>&gt;<i>                        anv.Image = new UIImage(&quot;pin.png&quot;);
</I>&gt;<i>                        anv.CanShowCallout = true;
</I>&gt;<i>                        return anv;
</I>&gt;<i>                }
</I>&gt;<i>        }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> So both the referenced images in Main.cs and the ones in
</I>&gt;<i> os4MapsViewController.cs are not shown
</I>&gt;<i> <A HREF="http://imageshack.us/photo/my-images/850/screenshot20110905at323.png/">http://imageshack.us/photo/my-images/850/screenshot20110905at323.png/</A>
</I>&gt;<i> &lt;-- this image shows what I get on the emulator.
</I>&gt;<i>
</I>&gt;<i> pin.png lies in the root folder of my project. The other image lies in
</I>&gt;<i> the folder Images in the project dir. None of them seems to show up.
</I>&gt;<i>
</I>&gt;<i> Any ideas? I know the code provided uses MKPinAnnotationView, but
</I>&gt;<i> changing it to MKAnnotationView simply shows nothing.
</I>&gt;<i>
</I>&gt;<i> On Mon, Sep 5, 2011 at 2:48 PM, Mikkel L&#248;now &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">mloenow at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi Tomasz,
</I>&gt;<i> &gt; I believe MKAnnotationView would be your best option. Use a custom
</I>&gt;<i> &gt; MKMapViewDelegate and override GetViewForAnnotation where you call
</I>&gt;<i> &gt; mapView.DequeueReusableAnnotation to reuse the annotation view (or create
</I>&gt;<i> a
</I>&gt;<i> &gt; new if null). Here you can set your image to the annotation view.
</I>&gt;<i> &gt; Feel free to share your implementation if you need more help.
</I>&gt;<i> &gt; Mikkel
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Mon, Sep 5, 2011 at 14:01, Tomasz Cielecki &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">tomasz at ostebaronen.dk</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Hello MonoTouch list,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I am in the midst of creating a iPhone app where I need a map with
</I>&gt;<i> &gt;&gt; some circles, where the circle colors changes depending on the data
</I>&gt;<i> &gt;&gt; received asynchronously in the background.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; So my first approach to this was to get a Map shown on the devices
</I>&gt;<i> &gt;&gt; with a circle, which works fine. Only problem is that MKCircle takes a
</I>&gt;<i> &gt;&gt; radius for that circle, which means the circle is only visible at some
</I>&gt;<i> &gt;&gt; zoom level. So lets say the circle radius is 100 meters, then I have
</I>&gt;<i> &gt;&gt; to zoom to almost the biggest zoom level to get to a point where I
</I>&gt;<i> &gt;&gt; actually can see the circle, this is not the desirable behavior. I
</I>&gt;<i> &gt;&gt; want to have the circle resize along with the zoom level, just like
</I>&gt;<i> &gt;&gt; pins do.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; So I have also tried to use a custom image on MKPinAnnotationView and
</I>&gt;<i> &gt;&gt; on MKAnnotationView, neither of them seems to show my custom image.
</I>&gt;<i> &gt;&gt; The normal pin image shows when using MKPinAnnotationView. I have put
</I>&gt;<i> &gt;&gt; the pin image in the root of my project and referencing it with the
</I>&gt;<i> &gt;&gt; path &quot;pin.png&quot; (the name of the image is actually pin.png).
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; So maybe someone here can help me find out what is wrong, or provide
</I>&gt;<i> &gt;&gt; me with some examples on how to do this? I would prefer if I could use
</I>&gt;<i> &gt;&gt; MKCircle and just choose the color. But using images could be a
</I>&gt;<i> &gt;&gt; solution.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; --
</I>&gt;<i> &gt;&gt; Med Venlig Hilsen / With Best Regards
</I>&gt;<i> &gt;&gt; Tomasz Cielecki
</I>&gt;<i> &gt;&gt; <A HREF="http://ostebaronen.dk">http://ostebaronen.dk</A>
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; MonoTouch mailing list
</I>&gt;<i> &gt;&gt; <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> &gt;&gt; <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Med Venlig Hilsen / With Best Regards
</I>&gt;<i> Tomasz Cielecki
</I>&gt;<i> <A HREF="http://ostebaronen.dk">http://ostebaronen.dk</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20110905/e80d50f2/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20110905/e80d50f2/attachment-0001.html</A> 
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004900.html">[MonoTouch] MonoTouch Research
</A></li>
	<LI>Next message: <A HREF="004902.html">[MonoTouch] Custom MapKit Pins/Circles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4899">[ date ]</a>
              <a href="thread.html#4899">[ thread ]</a>
              <a href="subject.html#4899">[ subject ]</a>
              <a href="author.html#4899">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
