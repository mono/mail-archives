<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] ALAssetsLibrary - AddAssetsGroupAlbum Block Returns Invalid ALAssetsGroup Object
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20ALAssetsLibrary%20-%20AddAssetsGroupAlbum%20Block%20Returns%0A%20Invalid%20ALAssetsGroup%20Object&In-Reply-To=%3CCAP-t25-icE6a_ZAcBWDsPdwATnEF6F_hdzDE44Gy13D-ZSbxjw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010657.html">
   <LINK REL="Next"  HREF="010654.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] ALAssetsLibrary - AddAssetsGroupAlbum Block Returns Invalid ALAssetsGroup Object</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20ALAssetsLibrary%20-%20AddAssetsGroupAlbum%20Block%20Returns%0A%20Invalid%20ALAssetsGroup%20Object&In-Reply-To=%3CCAP-t25-icE6a_ZAcBWDsPdwATnEF6F_hdzDE44Gy13D-ZSbxjw%40mail.gmail.com%3E"
       TITLE="[MonoTouch] ALAssetsLibrary - AddAssetsGroupAlbum Block Returns Invalid ALAssetsGroup Object">rolf at xamarin.com
       </A><BR>
    <I>Mon Jul 16 23:58:23 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="010657.html">[MonoTouch] ALAssetsLibrary - AddAssetsGroupAlbum Block Returns Invalid ALAssetsGroup Object
</A></li>
        <LI>Next message: <A HREF="010654.html">[MonoTouch] MVC philosophy when it comes to deriving from [Element]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10761">[ date ]</a>
              <a href="thread.html#10761">[ thread ]</a>
              <a href="subject.html#10761">[ subject ]</a>
              <a href="author.html#10761">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

This sounds like a bug somewhere, can you file it here:
<A HREF="http://bugzilla.xamarin.com">http://bugzilla.xamarin.com</A> with a complete test project we can use to
reproduce this?

Thanks,
Rolf

On Tue, Jul 10, 2012 at 7:43 PM, Jim Crismale
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">jim.crismale at canfieldsci.com</A>&gt;wrote:

&gt;<i> Is there a best practice code example demonstrating how to use the
</I>&gt;<i> ALAssetsLibrary, specifically with adding new asset groups and adding
</I>&gt;<i> photos to them?
</I>&gt;<i>
</I>&gt;<i> I've seen a few samples out there, but none of them seem to handle the
</I>&gt;<i> async nature of these methods properly and I am running into difficulty
</I>&gt;<i> with what should be an extremely simple task.
</I>&gt;<i>
</I>&gt;<i> In the code example below, 50% of the time the newly added group has one
</I>&gt;<i> or more null property values, preventing the image from being added to the
</I>&gt;<i> new group. According to Apple's docs, you are supposed to do &quot;work&quot; with
</I>&gt;<i> the object received in the block but I can't see how you can when it is in
</I>&gt;<i> an invalid state.
</I>&gt;<i>
</I>&gt;<i> I set up an observer to detect when the
</I>&gt;<i> &quot;ALAssetsLibraryChangedNotification&quot; gets fired to reload (as suggested on
</I>&gt;<i> SO) and determined that there were many times this notification did not get
</I>&gt;<i> fired between the time of the call and the addition of the new object which
</I>&gt;<i> was returned in an invalid state.
</I>&gt;<i>
</I>&gt;<i> I've tried re-enumerating after adding with sleep timers and pulling the
</I>&gt;<i> object out that way, but apparently it still wasn't &quot;ready&quot; with all of
</I>&gt;<i> it's property values yet.
</I>&gt;<i>
</I>&gt;<i> alibrary.AddAssetsGroupAlbum(albumName.ToString(),delegate(ALAssetsGroup newGroup) {
</I>&gt;<i> 	try {
</I>&gt;<i> 		Helper.LogMessage(&quot;New Asset Group added, named: &quot; + newGroup.Name);
</I>&gt;<i> 		Helper.LogMessage(&quot;New Group type: &quot; + newGroup.Type);
</I>&gt;<i> 		Helper.LogMessage(&quot;New Group ID: &quot; + newGroup.PersistentID);
</I>&gt;<i> 		Helper.LogMessage(&quot;New Group URL: &quot; + newGroup.PropertyUrl);
</I>&gt;<i> 	}   catch (Exception) {
</I>&gt;<i> 		Helper.LogMessage(&quot;one or more properties of newly created asset group is null.&quot;);
</I>&gt;<i> 	}
</I>&gt;<i>
</I>&gt;<i> 	alibrary.AssetForUrl(assetUrl, delegate(ALAsset asset) {
</I>&gt;<i> 		Helper.LogMessage(&quot;asset retrieved.&quot;);
</I>&gt;<i> 		newGroup.AddAsset(asset);
</I>&gt;<i> 	    	} , delegate(NSError assetError) {
</I>&gt;<i> 		    Helper.LogMessage(assetError.ToString());
</I>&gt;<i> 	    	} );
</I>&gt;<i>
</I>&gt;<i> }, delegate (NSError errorFailVar) {
</I>&gt;<i> 	Helper.LogMessage(errorFailVar.ToString());
</I>&gt;<i> } );
</I>&gt;<i>
</I>&gt;<i> There has to be an easy way to do this. Appreciate any help!
</I>&gt;<i> ------------------------------
</I>&gt;<i> View this message in context: ALAssetsLibrary - AddAssetsGroupAlbum Block
</I>&gt;<i> Returns Invalid ALAssetsGroup Object&lt;<A HREF="http://monotouch.2284126.n4.nabble.com/ALAssetsLibrary-AddAssetsGroupAlbum-Block-Returns-Invalid-ALAssetsGroup-Object-tp4655909.html">http://monotouch.2284126.n4.nabble.com/ALAssetsLibrary-AddAssetsGroupAlbum-Block-Returns-Invalid-ALAssetsGroup-Object-tp4655909.html</A>&gt;
</I>&gt;<i> Sent from the MonoTouch mailing list archive&lt;<A HREF="http://monotouch.2284126.n4.nabble.com/">http://monotouch.2284126.n4.nabble.com/</A>&gt;at Nabble.com.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120717/d08970b6/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120717/d08970b6/attachment.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010657.html">[MonoTouch] ALAssetsLibrary - AddAssetsGroupAlbum Block Returns Invalid ALAssetsGroup Object
</A></li>
	<LI>Next message: <A HREF="010654.html">[MonoTouch] MVC philosophy when it comes to deriving from [Element]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10761">[ date ]</a>
              <a href="thread.html#10761">[ thread ]</a>
              <a href="subject.html#10761">[ subject ]</a>
              <a href="author.html#10761">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
