<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Odd SSL error - any ideas?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Odd%20SSL%20error%20-%20any%20ideas%3F&In-Reply-To=%3CCACp3Zk2FsKRck6%3DLsPTC4_0debwBOiUMKVwFE4owFueD0WbeSA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009816.html">
   <LINK REL="Next"  HREF="009818.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Odd SSL error - any ideas?</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Odd%20SSL%20error%20-%20any%20ideas%3F&In-Reply-To=%3CCACp3Zk2FsKRck6%3DLsPTC4_0debwBOiUMKVwFE4owFueD0WbeSA%40mail.gmail.com%3E"
       TITLE="[MonoTouch] Odd SSL error - any ideas?">sebastien at xamarin.com
       </A><BR>
    <I>Mon May 28 13:02:02 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009816.html">[MonoTouch] Odd SSL error - any ideas?
</A></li>
        <LI>Next message: <A HREF="009818.html">[MonoTouch] Odd SSL error - any ideas?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9817">[ date ]</a>
              <a href="thread.html#9817">[ thread ]</a>
              <a href="subject.html#9817">[ subject ]</a>
              <a href="author.html#9817">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Maybe some devices / ISP / cell providers are more likely to have
networking issues. Try to get keep track of the data maybe some
pattern will emerge and allow us to pinpoint the root cause (first
step toward a resolution, if possible).

On Mon, May 28, 2012 at 8:59 AM, Nic Wise &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">nicw at fastchicken.co.nz</A>&gt; wrote:
&gt;<i> thanks Sebastien - that makes sense. It appears to only happen with a
</I>&gt;<i> small number of my customers - a VERY small number. I wonder if it's a
</I>&gt;<i> device issue....
</I>&gt;<i>
</I>&gt;<i> On Mon, May 28, 2012 at 1:52 PM, Sebastien Pouliot
</I>&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">sebastien at xamarin.com</A>&gt; wrote:
</I>&gt;&gt;<i> Hello Nic,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Mon, May 28, 2012 at 8:30 AM, Nic Wise &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">nicw at fastchicken.co.nz</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> This is a bit of an oddball one, and not one I can reproduce.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 20120528/113316: URL: <A HREF="https://bbsc.freeagent.com/verify">https://bbsc.freeagent.com/verify</A>
</I>&gt;&gt;&gt;<i> 20120528/113317: Ex in Verify: Error getting response stream (Write:
</I>&gt;&gt;&gt;<i> The authentication or decryption has failed.): SendFailure
</I>&gt;&gt;&gt;<i> 20120528/113317: Exception: System.Net.WebException: Error getting
</I>&gt;&gt;&gt;<i> response stream (Write: The authentication or decryption has failed.):
</I>&gt;&gt;&gt;<i> SendFailure ---&gt; System.IO.IOException: The authentication or
</I>&gt;&gt;&gt;<i> decryption has failed. ---&gt; Mono.Security.Protocol.Tls.TlsException:
</I>&gt;&gt;&gt;<i> The authentication or decryption has failed.
</I>&gt;&gt;&gt;<i> &#160;at Mono.Security.Protocol.Tls.RecordProtocol.ReadRecordBuffer (Int32
</I>&gt;&gt;&gt;<i> contentType, System.IO.Stream record) [0x00000] in &lt;filename
</I>&gt;&gt;&gt;<i> unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback
</I>&gt;&gt;&gt;<i> (IAsyncResult asyncResult) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;--- End of inner exception stack trace ---
</I>&gt;&gt;&gt;<i> &#160;at Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback
</I>&gt;&gt;&gt;<i> (IAsyncResult asyncResult) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;--- End of inner exception stack trace ---
</I>&gt;&gt;&gt;<i> &#160;at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult
</I>&gt;&gt;&gt;<i> asyncResult) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.HttpWebRequest.GetResponse () [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.WebClient.GetWebResponse (System.Net.WebRequest
</I>&gt;&gt;&gt;<i> request) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.WebClient.ReadAll (System.Net.WebRequest request,
</I>&gt;&gt;&gt;<i> System.Object userToken) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.WebClient.DownloadDataCore (System.Uri address,
</I>&gt;&gt;&gt;<i> System.Object userToken) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> 20120528/113317: StackTrace: &#160; at
</I>&gt;&gt;&gt;<i> System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult)
</I>&gt;&gt;&gt;<i> [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.HttpWebRequest.GetResponse () [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.WebClient.GetWebResponse (System.Net.WebRequest
</I>&gt;&gt;&gt;<i> request) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.WebClient.ReadAll (System.Net.WebRequest request,
</I>&gt;&gt;&gt;<i> System.Object userToken) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> &#160;at System.Net.WebClient.DownloadDataCore (System.Uri address,
</I>&gt;&gt;&gt;<i> System.Object userToken) [0x00000] in &lt;filename unknown&gt;:0
</I>&gt;&gt;&gt;<i> 20120528/113317: In complete. success is False
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The user said that all/most other traffic was flowing well. He's on
</I>&gt;&gt;&gt;<i> the same carrier (in the same city) as me, and a lot of other people.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm using the &quot;accept all SSL certs&quot; thing, if that helps:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ServicePointManager.ServerCertificateValidationCallback = (sender,
</I>&gt;&gt;&gt;<i> cert, chain, ssl) =&gt; &#160;true;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You should not - but the exception points to transmission, i.e. well
</I>&gt;&gt;<i> after the certificates validations.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Any thoughts? Anywhere to look? I think this is using an older version
</I>&gt;&gt;&gt;<i> of MonoTouch,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> SSL/TLS are, by design, difficult to debug since they don't tell you
</I>&gt;&gt;<i> much about what (or when) things fails. That makes attacks harder and
</I>&gt;&gt;<i> debugging (near) impossible.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now at the stage this occurs we know that SSL negotiation was done.
</I>&gt;&gt;<i> IOW client/server decided on a common cipher suite, certificate were
</I>&gt;&gt;<i> accepted... and that the request was sent.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (More likely) a network glitch. SSL/TLS ensure integrity of the data.
</I>&gt;&gt;<i> One single bad bit will result in an error - and since the internal
</I>&gt;&gt;<i> state becomes invalid the whole SSL session must be restarted (i.e.
</I>&gt;&gt;<i> there's no low-level try it again). If this is not something that can
</I>&gt;&gt;<i> be duplicated again then it's a likely culprit.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (Unlikely) the server asked for a renegotiation. That can occurs (it's
</I>&gt;&gt;<i> optional) after a large amount of data was sent. It's very uncommon*
</I>&gt;&gt;<i> (for HTTPS) so it's less tested than the general code (but bugs were
</I>&gt;&gt;<i> fixed years ago and not reported again). If that's the case then it
</I>&gt;&gt;<i> should be possible to duplicate the same issue with the same web site
</I>&gt;&gt;<i> (same server configuration).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> * it's more common in long sessions, e.g. with a database, than for HTTPS
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> before the recent crypto changes that Sebastian blogged
</I>&gt;&gt;&gt;<i> about.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The recent changes should not affect how SSL/TLS behave. It should be
</I>&gt;&gt;<i> faster (I/O are predominant in this case so it might not show off a
</I>&gt;&gt;<i> lot) but not different. More than 2000 test cases were ported to
</I>&gt;&gt;<i> ensure this :-).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sebastien
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Nic Wise
</I>&gt;<i> t.&#160; +44 7788 592 806 |&#160;@fastchicken | <A HREF="http://www.linkedin.com/in/nicwise">http://www.linkedin.com/in/nicwise</A>
</I>&gt;<i> b. <A HREF="http://www.fastchicken.co.nz/">http://www.fastchicken.co.nz/</A>
</I>&gt;<i>
</I>&gt;<i> Earnest: Self-employed? Track your business expenses and income.
</I>&gt;<i> <A HREF="http://earnestapp.com">http://earnestapp.com</A>
</I>&gt;<i> Nearest Bus: find when the next bus is coming to your stop. <A HREF="http://goo.gl/Vcz1p">http://goo.gl/Vcz1p</A>
</I>&gt;<i> mobileAgent (for FreeAgent): get your accounts in your pocket.
</I>&gt;<i> <A HREF="http://goo.gl/IuBU">http://goo.gl/IuBU</A>
</I>&gt;<i> Trip Wallet: Keep track of your budget on the go: <A HREF="http://goo.gl/ePhKa">http://goo.gl/ePhKa</A>
</I>&gt;<i> London Bike App: Find the nearest Boris Bike, and get riding! <A HREF="http://goo.gl/Icp2">http://goo.gl/Icp2</A>
</I></PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009816.html">[MonoTouch] Odd SSL error - any ideas?
</A></li>
	<LI>Next message: <A HREF="009818.html">[MonoTouch] Odd SSL error - any ideas?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9817">[ date ]</a>
              <a href="thread.html#9817">[ thread ]</a>
              <a href="subject.html#9817">[ subject ]</a>
              <a href="author.html#9817">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
