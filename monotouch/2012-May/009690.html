<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] SQLite database confusion - code not reading table
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20SQLite%20database%20confusion%20-%20code%20not%20reading%20table&In-Reply-To=%3C1337466911438-4646351.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009689.html">
   <LINK REL="Next"  HREF="009691.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] SQLite database confusion - code not reading table</H1>
    <B>Chris_M</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20SQLite%20database%20confusion%20-%20code%20not%20reading%20table&In-Reply-To=%3C1337466911438-4646351.post%40n4.nabble.com%3E"
       TITLE="[MonoTouch] SQLite database confusion - code not reading table">kungfuchris99 at yahoo.com
       </A><BR>
    <I>Sat May 19 22:35:11 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009689.html">[MonoTouch] SQLite database confusion - code not reading table
</A></li>
        <LI>Next message: <A HREF="009691.html">[MonoTouch] SQLite database confusion - code not reading table
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9690">[ date ]</a>
              <a href="thread.html#9690">[ thread ]</a>
              <a href="subject.html#9690">[ subject ]</a>
              <a href="author.html#9690">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Jason, 

Thanks for the reply. Below is the code that I'm using (based on the Data
Access example from the Xamarin galleries). I guess the main reason I'm
struggling with this is that all of the examples I've found for using
SQLite-Net create the database and the table used programmatically. I
haven't found or seen a simple example using SQLite-Net to read data from a
pre-existing table in a pre-existing database. Now, it seems like it should
be straightforward of course, and it seems like this code should work, but
obviously there's something I'm just not grokking.  Thanks for taking the
time to look!

==code below==========================================


namespace CountyDataAccess
{
	public class HomeNavController : UITableViewController
	{
				
		protected List&lt;CountyInfo&gt; counties = new List&lt;CountyInfo&gt; ();
		protected TableSource tableSource;
		CountyInfo county;
		
		string dbName = &quot;SaleSites_v1_2.sqlite&quot;;
		
		public HomeNavController () //: base(UITableViewStyle.Grouped)
		{
		}
					
		public override void ViewWillAppear (bool animated)
		{
			base.ViewWillAppear (animated);
			// hide the nav bar when this controller appears
			NavigationController.SetNavigationBarHidden (true, true);
		}   
		
		public override void ViewWillDisappear (bool animated)
		{
			base.ViewWillDisappear (animated);
			// show the nav bar when other controllers appear
			NavigationController.SetNavigationBarHidden (false, true);
		}
		
		public override void ViewDidLoad ()
		{			
			var connection = new SQLiteConnection(GetDBPath(dbName));
			
			var countiesTable = connection.Table&lt;CountyInfo&gt;();
			var counties = (from i in countiesTable select i).ToList (); // using
System.Linq
			
			tableSource = new TableSource (counties);
			
			TableView = new UITableView () {
					Source = tableSource
				} ;
			
			connection.Close ();
			
		}
		
		
		// The following also from BasicOperations.cs
		
		protected string GetDBPath (string dbName)
		{
			// get a reference to the documents folder
			var documents = Environment.GetFolderPath
(Environment.SpecialFolder.Personal);
			
			// create the db path
			string db = Path.Combine (documents, dbName);
			
			return db;
		}
		
		// A simple data source for our table -- took this from BasicOperations.cs
		
		protected class TableSource : UITableViewSource
		{
			List&lt;CountyInfo&gt; items;
			
			public TableSource (List&lt;CountyInfo&gt; items) : base() { this.items =
items; }
			
			public override int NumberOfSections (UITableView tableView) { return 1;
}
			
			public override int RowsInSection (UITableView tableview, int section) {
return this.items.Count; }
			
			public override UITableViewCell GetCell (UITableView tableView,
NSIndexPath indexPath)
			{
				UITableViewCell cell;
				cell = tableView.DequeueReusableCell (&quot;item&quot;);
				if(cell == null) 
					cell = new UITableViewCell(UITableViewCellStyle.Default, &quot;item&quot;);
				cell.TextLabel.Text = this.items[indexPath.Row].County + &quot;County, &quot; +
this.items[indexPath.Row].CountySeat;
				return cell;
			}
			
		}
		
	}
}

=== Also, here's the code for the CountyInfo class (from CountyInfo.cs)
=================

namespace CountyDataAccess
{
	public class CountyInfo
	{
		public CountyInfo ()
		{
		}
		
		public int ID { get; set; }
		public string County { get; set; }
		public string CountySeat { get; set; }
		public int ZipCode { get; set; }
		public string StreetAdd { get; set; }
		public string CountyWeb1 { get; set; }
	}
}



jawbrey wrote
&gt;<i> 
</I>&gt;<i> sqlite_sequence is an internal table used to manage autoincrement columns
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.sqlite.org/autoinc.html">http://www.sqlite.org/autoinc.html</A>
</I>&gt;<i> 
</I>&gt;<i> can you post a code sample showing your data access?
</I>&gt;<i> 
</I>&gt;<i> On Sat, May 19, 2012 at 3:52 PM, Chris_M &lt;kungfuchris99@&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm building an app that needs to use a pre-existing SQLite database
</I>&gt;&gt;<i> already
</I>&gt;&gt;<i> populated with data. Right now I'm just working on reading the data and
</I>&gt;&gt;<i> displaying it in a UITableView. (I'm using SQLite-Net in my code, just
</I>&gt;&gt;<i> FYI.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have created the database, and I created a table called &quot;CountyInfo&quot; in
</I>&gt;&gt;<i> the database, and I have imported all the relevant data. Everything looks
</I>&gt;&gt;<i> ship-shape.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When I compile and test my code, it finds the database just fine, but for
</I>&gt;&gt;<i> some reason it's not seeing the &quot;CountyInfo&quot; table that's already in
</I>&gt;&gt;<i> there.
</I>&gt;&gt;<i> Instead, it creates a new, second table in the database called
</I>&gt;&gt;<i> &quot;sqlite_sequence&quot;, which has one record with three fields: rowid (value:
</I>&gt;&gt;<i> 1),
</I>&gt;&gt;<i> name (value: CountyInfo), and seq (value: 254). (My original &quot;CountyInfo&quot;
</I>&gt;&gt;<i> table is still sitting there in the database with all its data intact.)
</I>&gt;&gt;<i> The
</I>&gt;&gt;<i> data from the original CountyInfo is not displayed in my table view,
</I>&gt;&gt;<i> presumably because the app isn't seeing or reading the table for some
</I>&gt;&gt;<i> reason.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What in the world is going on?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I can post the relevant code from my project if necessary, but does
</I>&gt;&gt;<i> anyone
</I>&gt;&gt;<i> know what is happening just based on the above information?
</I>&gt;<i> 
</I>

--
View this message in context: <A HREF="http://monotouch.2284126.n4.nabble.com/SQLite-database-confusion-code-not-reading-table-tp4646271p4646351.html">http://monotouch.2284126.n4.nabble.com/SQLite-database-confusion-code-not-reading-table-tp4646271p4646351.html</A>
Sent from the MonoTouch mailing list archive at Nabble.com.
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009689.html">[MonoTouch] SQLite database confusion - code not reading table
</A></li>
	<LI>Next message: <A HREF="009691.html">[MonoTouch] SQLite database confusion - code not reading table
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9690">[ date ]</a>
              <a href="thread.html#9690">[ thread ]</a>
              <a href="subject.html#9690">[ subject ]</a>
              <a href="author.html#9690">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
