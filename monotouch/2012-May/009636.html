<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] When and why would TryGetNSObject() fail?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20When%20and%20why%20would%20TryGetNSObject%28%29%20fail%3F&In-Reply-To=%3CCAP-t258tF82E6B%2BG7LcEzYh97zgLv8gNxYV_ribipHuQru_aOQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009635.html">
   <LINK REL="Next"  HREF="009655.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] When and why would TryGetNSObject() fail?</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20When%20and%20why%20would%20TryGetNSObject%28%29%20fail%3F&In-Reply-To=%3CCAP-t258tF82E6B%2BG7LcEzYh97zgLv8gNxYV_ribipHuQru_aOQ%40mail.gmail.com%3E"
       TITLE="[MonoTouch] When and why would TryGetNSObject() fail?">rolf at xamarin.com
       </A><BR>
    <I>Thu May 17 08:46:50 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009635.html">[MonoTouch] When and why would TryGetNSObject() fail?
</A></li>
        <LI>Next message: <A HREF="009655.html">[MonoTouch] When and why would TryGetNSObject() fail?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9636">[ date ]</a>
              <a href="thread.html#9636">[ thread ]</a>
              <a href="subject.html#9636">[ subject ]</a>
              <a href="author.html#9636">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I just looked at the source and this is something that should not happen.
We're looking up an object using the pointer to that object in a
dictionary, and then casting the result to NSObject. The problem is that
the only thing we ever put in that dictionary is NSObjects, i.e. it is
impossible for this to happen, which leads to the possibility of memory
corruption or GC bug. Is it a reproducible issue? We could probably give
you instrumented monotouch.dlls which could help tracking it down if it
happens for you once in a while.

Rolf

On Thu, May 17, 2012 at 9:44 AM, Ren&#233; Ruppert
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rene.ruppert at googlemail.com</A>&gt;wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Can somebody give me an example that would lead to the exception below?
</I>&gt;<i>
</I>&gt;<i> Is that simply caused by trying to case a null ref into an NSObject?
</I>&gt;<i>
</I>&gt;<i> Would can cause this? Does it mean that there is a managed object that
</I>&gt;<i> tries to access its unmanaged counterpart that no longer exists?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> System.InvalidCastException: Cannot cast from source type to destination
</I>&gt;<i> type.
</I>&gt;<i>
</I>&gt;<i> at MonoTouch.ObjCRuntime.Runtime.TryGetNSObject (IntPtr ptr) [0x00000] in
</I>&gt;<i> &lt;filename unknown&gt;:0
</I>&gt;<i>
</I>&gt;<i> at MonoTouch.ObjCRuntime.Runtime.GetNSObject (IntPtr ptr) [0x00000] in
</I>&gt;<i> &lt;filename unknown&gt;:0
</I>&gt;<i>
</I>&gt;<i> at MonoTouch.ObjCRuntime.Runtime.GetNSObjectWrapped (IntPtr ptr) [0x00000]
</I>&gt;<i> in &lt;filename unknown&gt;:0
</I>&gt;<i>
</I>&gt;<i> at (wrapper native-to-managed)
</I>&gt;<i> MonoTouch.ObjCRuntime.Runtime:GetNSObjectWrapped (intptr)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Ren&#233;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120517/cea5e3b4/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120517/cea5e3b4/attachment.html</A>&gt;
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009635.html">[MonoTouch] When and why would TryGetNSObject() fail?
</A></li>
	<LI>Next message: <A HREF="009655.html">[MonoTouch] When and why would TryGetNSObject() fail?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9636">[ date ]</a>
              <a href="thread.html#9636">[ thread ]</a>
              <a href="subject.html#9636">[ subject ]</a>
              <a href="author.html#9636">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
