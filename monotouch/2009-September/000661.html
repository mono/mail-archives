<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] RES: Extension methods
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20RES%3A%20Extension%20methods&In-Reply-To=00b601ca2d7d%24f45c44d0%24dd14ce70%24%40net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000656.html">
   <LINK REL="Next"  HREF="000628.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] RES: Extension methods</H1>
    <B>Terry Westley</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20RES%3A%20Extension%20methods&In-Reply-To=00b601ca2d7d%24f45c44d0%24dd14ce70%24%40net"
       TITLE="[MonoTouch] RES: Extension methods">monotouch at sabonrai.com
       </A><BR>
    <I>Fri Sep  4 14:55:04 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000656.html">[MonoTouch] RES:  Extension methods
</A></li>
        <LI>Next message: <A HREF="000628.html">[MonoTouch] NSBundle.LoadNib return value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#661">[ date ]</a>
              <a href="thread.html#661">[ thread ]</a>
              <a href="subject.html#661">[ subject ]</a>
              <a href="author.html#661">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The short answer is: I think you're right; it has to do with text encodings.

The long answer is that I wrote this method intentionally to allow the
caller to control as much of the graphics state as possible. It assumes that
the caller has set the colors, the text drawing mode, and selected the font.
That's why it saves the graphics state before writing the invisible text and
then restoring the state.

When selecting the font, you also set a text encoding. The Apple CGContext
class reference says that kCGEncodingFontSpecific is &quot;the built-in encoding
of the font&quot; and that kCGEncodingMacRoman is &quot;the MacRoman encoding.
MacRoman is an ASCII variant originally created for use in the Mac OS, in
which characters 127 and lower are ASCII, and characters 128 and higher are
non-English characters and symbols.&quot;

I tried both FontSpecific and MacRoman with a traditional Mac font such as
Helvetica. FontSpecific yielded strange characters and MacRoman looked good.
Unfortunately,  I have no better answer than this utilitarian one until I've
spent more time to understand fonts, text encodings, unicode, et. al.

Here is an example:

context.SetRGBFillColor(0, 0, 0, 1); // black
context.SetTextDrawingMode(CGTextDrawingMode.Fill);
context.SelectFont(&quot;Helvetica-Bold&quot;, 14, CGTextEncoding.MacRoman);
context.ShowTextAtCenterPoint(100, 100, &quot;Helvetica-Bold 14&quot;);

--Terry

2009/9/4 Jos&#233; Antonio Leal de Farias &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">jalf at sharpgames.net</A>&gt;

&gt;<i>  This code works for you? In my code he draw some strange
</I>&gt;<i> characters&#8230;perhaps something about the text encoding?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Jos&#233;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> * *
</I>&gt;<i>
</I>&gt;<i> *De:* <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A> [mailto:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>] *Em nome de *Terry Westley
</I>&gt;<i> *Enviada em:* quinta-feira, 3 de setembro de 2009 21:24
</I>&gt;<i> *Para:* <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> *Assunto:* [MonoTouch] Extension methods
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I am I an iPhone SDK, Objective-C, Xcode, and Mono newbie. But I'm also a
</I>&gt;<i> newbie to anything post .Net 2.0: we're still using VS 2005 at work. Today I
</I>&gt;<i> found that extension methods are implemented and that MonoDevelop handles
</I>&gt;<i> the (insert generic name for Intellisense here).
</I>&gt;<i>
</I>&gt;<i> I found this method particularly useful:
</I>&gt;<i>
</I>&gt;<i> // Inspired by technique described in section
</I>&gt;<i> // &quot;Measuring Text Before Drawing&quot; of
</I>&gt;<i> // &quot;Quartz 2D Programming Guide.&quot;
</I>&gt;<i> // Note: only works for CGAffineTransform.MakeRotation(0)
</I>&gt;<i> public static void ShowTextAtCenterPoint (
</I>&gt;<i>     this CGContext context, float centerX, float y, string text)
</I>&gt;<i> {
</I>&gt;<i>     context.SaveState();
</I>&gt;<i>     context.SetTextDrawingMode (CGTextDrawingMode.Invisible);
</I>&gt;<i>     context.ShowTextAtPoint (centerX, y, text, text.Length);
</I>&gt;<i>     context.RestoreState();
</I>&gt;<i>     context.ShowTextAtPoint (
</I>&gt;<i>         centerX - (context.TextPosition.X - centerX)/2,
</I>&gt;<i>         y,
</I>&gt;<i>         text,
</I>&gt;<i>         text.Length);
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> Kudos and thanks to Mono, MonoDevelop, and MonoTouch developers.
</I>&gt;<i>
</I>&gt;<i> --Terry
</I>&gt;<i>
</I>&gt;<i> P.S. Please feel free to suggest improvements to this method.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/mailman/private/monotouch/attachments/20090904/9e1ef3e8/attachment.html">http://lists.ximian.com/mailman/private/monotouch/attachments/20090904/9e1ef3e8/attachment.html</A> 
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000656.html">[MonoTouch] RES:  Extension methods
</A></li>
	<LI>Next message: <A HREF="000628.html">[MonoTouch] NSBundle.LoadNib return value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#661">[ date ]</a>
              <a href="thread.html#661">[ thread ]</a>
              <a href="subject.html#661">[ subject ]</a>
              <a href="author.html#661">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
