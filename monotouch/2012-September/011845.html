<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] TypeInitializationException on device
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20TypeInitializationException%20on%20device&In-Reply-To=%3CCAEa9nayDpry%3D0JH%3Dx_VyMVHUA-vO%3DusAdtdyuS3s-2CwPwjErA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011809.html">
   <LINK REL="Next"  HREF="011847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] TypeInitializationException on device</H1>
    <B>Len Charest</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20TypeInitializationException%20on%20device&In-Reply-To=%3CCAEa9nayDpry%3D0JH%3Dx_VyMVHUA-vO%3DusAdtdyuS3s-2CwPwjErA%40mail.gmail.com%3E"
       TITLE="[MonoTouch] TypeInitializationException on device">len at shingl.com
       </A><BR>
    <I>Thu Sep 20 18:39:41 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011809.html">[MonoTouch] TypeInitializationException on device
</A></li>
        <LI>Next message: <A HREF="011847.html">[MonoTouch] TypeInitializationException on device
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11845">[ date ]</a>
              <a href="thread.html#11845">[ thread ]</a>
              <a href="subject.html#11845">[ subject ]</a>
              <a href="author.html#11845">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you, Sebastien. I have submitted bug 7354.

Another work-around is to simply have my app call String.Contains (and all
other methods needed by TypeSystem static constructor). The linker does not
remove these methods if they are explicitly used.

On Mon, Sep 17, 2012 at 12:38 PM, Sebastien Pouliot
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">sebastien at xamarin.com</A>&gt;wrote:

&gt;<i> Hello Len,
</I>&gt;<i>
</I>&gt;<i> On Mon, Sep 17, 2012 at 3:13 PM, Len Charest &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">len at shingl.com</A>&gt; wrote:
</I>&gt;<i> &gt; When running on a device, my app is throwing a
</I>&gt;<i> TypeInitializationException
</I>&gt;<i> &gt; from the static constructor for
</I>&gt;<i> System.Data.Services.Client.TypeSystem.The
</I>&gt;<i> &gt; constructor is attempting to populate a Dictionary&lt;MethodInfo, string&gt;
</I>&gt;<i> and
</I>&gt;<i> &gt; failing on the lookup of method info for String.Contains(String); see
</I>&gt;<i> &gt; TypeSystem.cs, line 42. This code works fine on the simulator.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm hitting the error when my app tries to do the following:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; var context = new MyDataServiceContext(myServiceRoot); // context class
</I>&gt;<i> &gt; generated by dataSvcUtil.exe
</I>&gt;<i> &gt; var query = context.Users.AddQueryOption(&quot;$filter&quot;, &quot;Username eq
</I>&gt;<i> 'bob'&quot;); //
</I>&gt;<i> &gt; query is a DataServiceQuery&lt;User&gt;
</I>&gt;<i> &gt; var uri = query.RequestUri;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The getter for RequestUri starts a call chain that eventually hits
</I>&gt;<i> &gt; TypeSystem.GetElementType, which thereby triggers the static constructor.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any ideas?
</I>&gt;<i>
</I>&gt;<i> It seems that System.Data.Services.Client.dll depends a lot of
</I>&gt;<i> reflection. By default linking is disabled on the simulator so almost*
</I>&gt;<i> everything is available at runtime. However the default, for devices,
</I>&gt;<i> is to enable the linker (small app size and faster builds) and this
</I>&gt;<i> can remove some of the methods (or even types) that SDSC.dll might
</I>&gt;<i> need.
</I>&gt;<i>
</I>&gt;<i> A very quick turn around is to disable the linker (no link). That will
</I>&gt;<i> allow you to resume development / testing on device. Please fill a bug
</I>&gt;<i> report on bugzilla.xamarin.com and we'll look to fix this and give you
</I>&gt;<i> a better workaround until this fix is released.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Sebastien
</I>&gt;<i>
</I>&gt;<i> * not the parts about Microsoft.VisualBasic.*
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120920/d24f8812/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120920/d24f8812/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011809.html">[MonoTouch] TypeInitializationException on device
</A></li>
	<LI>Next message: <A HREF="011847.html">[MonoTouch] TypeInitializationException on device
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11845">[ date ]</a>
              <a href="thread.html#11845">[ thread ]</a>
              <a href="subject.html#11845">[ subject ]</a>
              <a href="author.html#11845">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
