<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] CoreImage Memory Consumption / Recipe affected
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20CoreImage%20Memory%20Consumption%20/%20Recipe%20affected&In-Reply-To=%3C1347386939186-4656953.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011760.html">
   <LINK REL="Next"  HREF="011710.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] CoreImage Memory Consumption / Recipe affected</H1>
    <B>couchworx</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20CoreImage%20Memory%20Consumption%20/%20Recipe%20affected&In-Reply-To=%3C1347386939186-4656953.post%40n4.nabble.com%3E"
       TITLE="[MonoTouch] CoreImage Memory Consumption / Recipe affected">boris at couchworx.com
       </A><BR>
    <I>Tue Sep 11 18:08:59 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011760.html">[MonoTouch] Best way to catch .NET crash with TestFlight
</A></li>
        <LI>Next message: <A HREF="011710.html">[MonoTouch] CoreImage Memory Consumption / Recipe affected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11709">[ date ]</a>
              <a href="thread.html#11709">[ thread ]</a>
              <a href="subject.html#11709">[ subject ]</a>
              <a href="author.html#11709">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm trying for days to work with the CoreImage framework. My app let's the
user take pictures and publishes them to a cloud server. To make the
pictures a little bit more interesting I use CoreImage filters. Now, when
using the filters a couple time in row the app crashes. 

To eliminate own faults in my code I've tried the Adjust Contrast and
Brightness of an Image recipe
<A HREF="http://docs.xamarin.com/ios/recipes/Media/CoreImage/Adjust_Contrast_and_Brightness_of_an_Image">http://docs.xamarin.com/ios/recipes/Media/CoreImage/Adjust_Contrast_and_Brightness_of_an_Image</A>

It shows the same behavior: after 5 changes of contrast/brightness on a 5 MB
picture the app crashes. When using the 108 KB 'clouds.jpg' picture provided
with the recipe the app crashes after around 150 changes. So it looks like
it is tied to memory usage 'internally'!?

Here is the code straight from the recipe. 

void HandleValueChanged (object sender, EventArgs e)
{
    if (colorCtrls == null)
        colorCtrls = new CIColorControls () {
            Image = CIImage.FromCGImage (image.CGImage),
        };
    // set the values
    colorCtrls.Brightness = sliderBrightness.Value; 
    colorCtrls.Saturation = sliderSaturation.Value; 
    colorCtrls.Contrast = sliderContrast.Value;
    // do the transformation
    var output = colorCtrls.OutputImage;
    var context = CIContext.FromOptions (null);
    var result = context.CreateCGImage (output, output.Extent);
    // display the result in the UIImageView
    imageView.Image = UIImage.FromImage(result);
}

I've already tried &quot;using&quot; statements around every single call and did a lot
testing with NSAutoReleasePool's and GC.Collect(). Now I've run out of ideas
how to get this working .....

I use MD 3.0.4.6 / MT 5.4.0 / XCode 4.4.1 / iOS 5.1.1 on iPhone 4GS 

Anybody has a suggestion how to proceed from here ???
thanks
Boris




--
View this message in context: <A HREF="http://monotouch.2284126.n4.nabble.com/CoreImage-Memory-Consumption-Recipe-affected-tp4656953.html">http://monotouch.2284126.n4.nabble.com/CoreImage-Memory-Consumption-Recipe-affected-tp4656953.html</A>
Sent from the MonoTouch mailing list archive at Nabble.com.
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011760.html">[MonoTouch] Best way to catch .NET crash with TestFlight
</A></li>
	<LI>Next message: <A HREF="011710.html">[MonoTouch] CoreImage Memory Consumption / Recipe affected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11709">[ date ]</a>
              <a href="thread.html#11709">[ thread ]</a>
              <a href="subject.html#11709">[ subject ]</a>
              <a href="author.html#11709">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
