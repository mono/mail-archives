<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] HttpWebRequest in thread returns result from another	thread
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20HttpWebRequest%20in%20thread%20returns%20result%20from%20another%0A%09thread&In-Reply-To=%3C1347717441518-4657042.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011803.html">
   <LINK REL="Next"  HREF="011795.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] HttpWebRequest in thread returns result from another	thread</H1>
    <B>activa</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20HttpWebRequest%20in%20thread%20returns%20result%20from%20another%0A%09thread&In-Reply-To=%3C1347717441518-4657042.post%40n4.nabble.com%3E"
       TITLE="[MonoTouch] HttpWebRequest in thread returns result from another	thread">philippe at activa.be
       </A><BR>
    <I>Sat Sep 15 13:57:21 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011803.html">[MonoTouch] Get current time for a specific Timezone
</A></li>
        <LI>Next message: <A HREF="011795.html">[MonoTouch] Saving Zoomed/Panned image from ScrollView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11787">[ date ]</a>
              <a href="thread.html#11787">[ thread ]</a>
              <a href="subject.html#11787">[ subject ]</a>
              <a href="author.html#11787">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am experiencing the weirdest problem I have seen in a very long time.

I launch 2 threads, where each thread creates a HttpWebRequest. These
threads are started at the same time (well, one millisecond apart). What
happens is that the call to GetResponse() from the first HTTP request
sometimes receives the contents of the second HTTP request. When this
happens, the second HTTP request times out after 30 seconds.

This doesn't happen every time, but it does happen 4 out of 5 times.


This is the code: (simplified to produce a working test case)




public void Launch()
{
   Thread thread1 = new Thread(() =&gt; { GetData(&quot;<A HREF="http://url1">http://url1</A>&quot;); });
   Thread thread2 = new Thread(() =&gt; { GetData(&quot;<A HREF="http://url2">http://url2</A>&quot;); });

   thread1.Start();
   thread2.Start();
}

public static void GetData(string url)
{
   try
   {
      XDocument xDoc;
	
      var webRequest = HttpWebRequest.Create(url);
				
      using (var response = webRequest.GetResponse())
      {
         using (var stream = response.GetResponseStream())
         {
             xDoc = XDocument.Load(stream);

             Logger.Default.Log(xDoc);
         }
      }
   }
   catch(Exception ex)
   {
       Logger.Default.LogException(ex);
   }
}





--
View this message in context: <A HREF="http://monotouch.2284126.n4.nabble.com/HttpWebRequest-in-thread-returns-result-from-another-thread-tp4657042.html">http://monotouch.2284126.n4.nabble.com/HttpWebRequest-in-thread-returns-result-from-another-thread-tp4657042.html</A>
Sent from the MonoTouch mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120915/63884060/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120915/63884060/attachment.html</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011803.html">[MonoTouch] Get current time for a specific Timezone
</A></li>
	<LI>Next message: <A HREF="011795.html">[MonoTouch] Saving Zoomed/Panned image from ScrollView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11787">[ date ]</a>
              <a href="thread.html#11787">[ thread ]</a>
              <a href="subject.html#11787">[ subject ]</a>
              <a href="author.html#11787">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
