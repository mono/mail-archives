<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Still IntPtr Constructor issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Still%20IntPtr%20Constructor%20issues&In-Reply-To=A55E445F-F2E7-41CF-84FF-B225D8037D13%40googlemail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006988.html">
   <LINK REL="Next"  HREF="007010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Still IntPtr Constructor issues</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Still%20IntPtr%20Constructor%20issues&In-Reply-To=A55E445F-F2E7-41CF-84FF-B225D8037D13%40googlemail.com"
       TITLE="[MonoTouch] Still IntPtr Constructor issues">rolf at xamarin.com
       </A><BR>
    <I>Thu Dec  8 10:56:30 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006988.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
        <LI>Next message: <A HREF="007010.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7006">[ date ]</a>
              <a href="thread.html#7006">[ thread ]</a>
              <a href="subject.html#7006">[ subject ]</a>
              <a href="author.html#7006">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Dec 8, 2011 at 1:52 AM, Rene Ruppert &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rene.ruppert at googlemail.com</A>&gt;wrote:

&gt;<i> But isn't that then,like Miguel said, an issue of Monotouch? Shouldn't it
</I>&gt;<i> keep a reference?
</I>&gt;<i> I have not seen a single MT example so far tat keeps explicit references
</I>&gt;<i> to table view cells. Are they all wrong?
</I>&gt;<i>
</I>
It's actually quite a tricky subject, we've tried a lot of possible
solutions and we've come to the conclusion that it's virtually impossible
to make it perfect (which is that managed code should not need to hold
objects alive manually and at the same time no objects should be leaked).
We have improved some scenarios (included in the current v5.1.1 beta, but
it has to be enabled manually), and we're working on documentation
explaining exactly what has been improved.

Returning to your particular problem: in theory it should work if you
subclass UITableViewCell (which you do) - in which case the object is kept
alive while native code has a ref. Unfortunately objc might not keep a ref
in all cases (for instance look at assign setter semantics here:
<A HREF="http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW2">http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW2</A>),
which I suspect is what's happening to you. It is however hard to find the
exact cause without a sample we can run ourselves.

Keeping an explicit ref to table view cells is a pretty easy workaround
(and it doesn't suffer from the undefined behavior adding the IntPtr ctor
would have). The problem is of course to know when to remove the explicit
ref - but in my experience you don't end up with that many table view cell
instances if you reuse them (and just release the explicit ref when the
corresponding view is unloaded).

I hope this helps,
Rolf
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20111208/6b4392d6/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20111208/6b4392d6/attachment.html</A> 
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006988.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
	<LI>Next message: <A HREF="007010.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7006">[ date ]</a>
              <a href="thread.html#7006">[ thread ]</a>
              <a href="subject.html#7006">[ subject ]</a>
              <a href="author.html#7006">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
