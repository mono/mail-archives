<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Still IntPtr Constructor issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Still%20IntPtr%20Constructor%20issues&In-Reply-To=CAP-t25-akAMTPEqxge28EZ_Yob_VRc8tJo1Ozconb2FxiX%3D8Bg%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006983.html">
   <LINK REL="Next"  HREF="006987.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Still IntPtr Constructor issues</H1>
    <B>Rene Ruppert</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Still%20IntPtr%20Constructor%20issues&In-Reply-To=CAP-t25-akAMTPEqxge28EZ_Yob_VRc8tJo1Ozconb2FxiX%3D8Bg%40mail.gmail.com"
       TITLE="[MonoTouch] Still IntPtr Constructor issues">rene.ruppert at googlemail.com
       </A><BR>
    <I>Wed Dec  7 17:24:16 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006983.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
        <LI>Next message: <A HREF="006987.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6984">[ date ]</a>
              <a href="thread.html#6984">[ thread ]</a>
              <a href="subject.html#6984">[ subject ]</a>
              <a href="author.html#6984">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Rolf! I tried that! Here is the result. But I'm none wiser! It is supposed to relayout, I can relayout, but why does it go for the IntPtr ctor? What is thie &quot;_createPreparedCellForGlobalRow&quot; about?
My &quot;fix&quot; is: if the IntPtr ctor is called, I set a bool to indicate the cell if in invalid state. When dequeing cells, I check if the cell is NULL or that bool is set. In both cases I create a new instance of the cell and everything works fine. But still I would like to know if somebody can make sense from the debugger output:

#0  0x933b583e in __psynch_cvwait ()
#1  0x9a6aae21 in _pthread_cond_wait ()
#2  0x9a65b42c in pthread_cond_wait$UNIX2003 ()
#3  0x00104188 in suspend_current () at debugger-agent.c:2375
#4  0x00105da6 in process_event (event=EVENT_KIND_BREAKPOINT, arg=0xa1ac33c, il_offset=0, ctx=0xbfffca08, events=0x0, suspend_policy=2) at debugger-agent.c:3017
#5  0x001080c4 in process_breakpoint_inner (tls=0x9c78f10, ctx=0xbfffca08) at debugger-agent.c:3837
#6  0x00108199 in process_breakpoint () at debugger-agent.c:3855
#7  0xbfffc6c8 in ?? ()
#8  0x10a7e06f in ?? ()
#9  0x00011aef in mono_jit_runtime_invoke (method=0xa1ac33c, obj=0x9ae7cc0, params=0xbfffcb60, exc=0x0) at mini.c:5770
#10 0x0022011a in mono_runtime_invoke (method=0xa1ac33c, obj=0x9ae7cc0, params=0xbfffcb60, exc=0x0) at object.c:2757
#11 0x002ee535 in monotouch_trampoline ()
#12 0x0248e852 in -[UITableViewCell setSelected:] ()
#13 0x0234044d in -[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:withIndexPath:] ()
#14 0x02340589 in -[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:] ()
#15 0x0232bdfd in -[UITableView(_UITableViewPrivate) _updateVisibleCellsNow:] ()
#16 0x0233a851 in -[UITableView layoutSubviews] ()
#17 0x022e5322 in -[UIView(CALayerDelegate) layoutSublayersOfLayer:] ()
#18 0x012d8e72 in -[NSObject performSelector:withObject:] ()
#19 0x0427592d in -[CALayer layoutSublayers] ()
#20 0x0427f827 in CA::Layer::layout_if_needed ()
#21 0x04205fa7 in CA::Context::commit_transaction ()
#22 0x04207ea6 in CA::Transaction::commit ()
#23 0x04207580 in CA::Transaction::observer_callback ()
#24 0x012ab9ce in __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ ()
#25 0x01242670 in __CFRunLoopDoObservers ()
#26 0x0120e4f6 in __CFRunLoopRun ()
#27 0x0120ddb4 in CFRunLoopRunSpecific ()
#28 0x0120dccb in CFRunLoopRunInMode ()
#29 0x0489f879 in GSEventRunModal ()
#30 0x0489f93e in GSEventRun ()
#31 0x022a6a9b in UIApplicationMain ()
#32 0x0cfdcb0d in ?? ()
#33 0x0cfdb2f0 in ?? ()
#34 0x0cfdafe8 in ?? ()
#35 0x0cfdb13e in ?? ()
#36 0x00011aef in mono_jit_runtime_invoke (method=0xa9e5e2c, obj=0x0, params=0xbffff158, exc=0x0) at mini.c:5770
#37 0x0022011a in mono_runtime_invoke (method=0xa9e5e2c, obj=0x0, params=0xbffff158, exc=0x0) at object.c:2757
#38 0x00222e51 in mono_runtime_exec_main (method=0xa9e5e2c, args=0xcd52960, exc=0x0) at object.c:3940
#39 0x00222061 in mono_runtime_run_main (method=0xa9e5e2c, argc=0, argv=0xbffff300, exc=0x0) at object.c:3562
#40 0x000ad6df in mono_jit_exec (domain=0x9a6fe00, assembly=0x997d1c0, argc=1, argv=0xbffff2fc) at driver.c:1102
#41 0x002f41ca in main ()


Ren&#233;

Am 07.12.2011 um 23:09 schrieb Rolf Bjarne Kvinge:

&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> On Wed, Dec 7, 2011 at 9:03 PM, Rene Ruppert &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rene.ruppert at googlemail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> And there's one more thing I would like to add: If I put a breakpoint in SetSelected() of the cell I can see that it is called constantly (even for cells constructed without using the IntPtr) but the interesting thing is that the call stack is always pretty small and does not show where the call is coming from.
</I>&gt;<i> It contains these two lines and that's it:
</I>&gt;<i> 
</I>&gt;<i> MonoTouch.UIKit.UIApplication.Main (args={string[0]}, principalClassName=&quot;UIApplicationMain&quot;, delegateClassName=&quot;AppDelegateIPad&quot;) in 
</I>&gt;<i> 
</I>&gt;<i> /Developer/MonoTouch/Source/monotouch/src/UIKit/UIApplication.cs:29
</I>&gt;<i> Browser.Application.Main (args={string[0]}) in /Users/Krumelur/Documents/Develop/.../Main.cs:15
</I>&gt;<i> 
</I>&gt;<i> The problem here is that native (objc) frames aren't shown in the managed stack trace.
</I>&gt;<i> 
</I>&gt;<i> To get native frames you can attach gdb while at the breakpoint. Get the pid of the application (printed to the application output in MonoDevelop when the app starts), and execute in a terminal:
</I>&gt;<i> 
</I>&gt;<i> gdb program &lt;pid&gt;
</I>&gt;<i> (gdb) bt
</I>&gt;<i> &lt;you should now get a stack trace with native frames&gt;
</I>&gt;<i> (gdb) quit
</I>&gt;<i> 
</I>&gt;<i> Unfortunately the native stack trace will not have managed frames  (1).
</I>&gt;<i> 
</I>&gt;<i> Rolf
</I>&gt;<i> 
</I>&gt;<i> (1) You can get information for managed frames in gdb, look at mono_pmip here: <A HREF="http://www.mono-project.com/Debugging#Debugging_with_GDB">http://www.mono-project.com/Debugging#Debugging_with_GDB</A>
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> So something seems to trigger it magically.
</I>&gt;<i> 
</I>&gt;<i> Ren&#233;
</I>&gt;<i> 
</I>&gt;<i> Am 07.12.2011 um 20:55 schrieb Rene Ruppert:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I'm still struggling with the IntPtr Constructor issue I started on SO.
</I>&gt;&gt;<i> I got a bit further meanwhile.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The case is: I'm subclassing UITableViewCell and do not provide the IntPtr:ctor.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> By adding the ctor and breaking in there I figured out what ObjC wants my class to do: it is calling void SetSelected ( bool selected, bool animated ).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This means &quot;something&quot; wants to select my cell. I looked through my code and found exactly ONE place where I call SelectRow(). I commented that out and STILL it goes through the ctor and to SetSelected().
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> What are my options now? Does UITableViewCell maybe always require the IntPtr ctor?
</I>&gt;&gt;<i> What could possibly still select a row in a UITableView besides SelectRow()?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Ren&#233;
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20111207/a7765ec8/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20111207/a7765ec8/attachment.html</A> 
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006983.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
	<LI>Next message: <A HREF="006987.html">[MonoTouch] Still IntPtr Constructor issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6984">[ date ]</a>
              <a href="thread.html#6984">[ thread ]</a>
              <a href="subject.html#6984">[ subject ]</a>
              <a href="author.html#6984">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
