<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Infinite%20loop%20and%20crash%20when%20calling%20native%20library%0A%20-%20the%20ghost%20of%20bug%20%23707%3F&In-Reply-To=%3CCACp3Zk27VsTdWui%3Du8rqHP437TQViBiqTxTvjsNLg1H%2BXkjayw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010105.html">
   <LINK REL="Next"  HREF="010120.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Infinite%20loop%20and%20crash%20when%20calling%20native%20library%0A%20-%20the%20ghost%20of%20bug%20%23707%3F&In-Reply-To=%3CCACp3Zk27VsTdWui%3Du8rqHP437TQViBiqTxTvjsNLg1H%2BXkjayw%40mail.gmail.com%3E"
       TITLE="[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?">sebastien at xamarin.com
       </A><BR>
    <I>Thu Jun 14 22:27:03 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="010105.html">[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?
</A></li>
        <LI>Next message: <A HREF="010120.html">[MonoTouch] Failed to load AOT module 'mscorlib' while running in aot-only mode: not compiled with --aot=full.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10143">[ date ]</a>
              <a href="thread.html#10143">[ thread ]</a>
              <a href="subject.html#10143">[ subject ]</a>
              <a href="author.html#10143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Daniel,

Such recursion crashes often occurs when the native library is not
included with the application. Please ensure that you're effectively
linking with the static library in your device builds.

Many people (Xamarin and otherwise) are at the WWDC this week (and
network connectivity varies quite a bit) so if this does not solve
your issue then it may be better for you to fill a bug report and
include your full (device) build log. Be sure to add a &quot;-v -v&quot; to the
extra mtouch arguments (project's options) so every little details are
included.

Regards,
Sebastien

On Wed, Jun 13, 2012 at 3:34 PM, Daniel MacDonald &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">dmacd10 at gmail.com</A>&gt; wrote:
&gt;<i> Hi guys,
</I>&gt;<i>
</I>&gt;<i> I hope someone has an idea, because I've been at this for days and am out of
</I>&gt;<i> ideas. I have created bindings for a native library (TouchDB) and got
</I>&gt;<i> everything working great in the simulator. But when I try to run in the
</I>&gt;<i> device, I always get a crash as soon as I call anything other than a
</I>&gt;<i> constructor (see full report at <A HREF="http://pastebin.com/1MbmeJQi">http://pastebin.com/1MbmeJQi</A> ). Basically,
</I>&gt;<i> its going in to an infinite (or very long) loop consisting of
</I>&gt;<i>
</I>&gt;<i> wrapper_managed_to_native_MonoTouch_ObjCRuntime_Messaging_IntPtr_objc_msgSend_IntPtr_IntPtr_intptr_intptr_intptr_intptr
</I>&gt;<i> wrapper_runtime_invoke_object_runtime_invoke_dynamic_intptr_intptr_intptr_intptr_0
</I>&gt;<i> mono_jit_runtime_invoke
</I>&gt;<i> mono_runtime_invoke
</I>&gt;<i> monotouch_static_trampoline
</I>&gt;<i> wrapper_managed_to_native_MonoTouch_ObjCRuntime_Messaging_IntPtr_objc_msgSend_IntPtr_IntPtr_intptr_intptr_intptr_intptr
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I found an old mail indicating this was due to bug #707 (which is long since
</I>&gt;<i> resolved, but then again I'm only on the latest MT stable so maybe not?) and
</I>&gt;<i> I went ahead and rebuilt my library with THUMB disabled.
</I>&gt;<i>
</I>&gt;<i> I verified visually with otool -tv that the library being linked had no
</I>&gt;<i> thumb instructions, but I suppose there could be others lurking around.
</I>&gt;<i>
</I>&gt;<i> On the MT side, I've tried building both with and without the LLVM compiler
</I>&gt;<i> and with and without enabling thumb support and got the same results
</I>&gt;<i> (certain combinations of compiler/arch/instruction set didn't build due to
</I>&gt;<i> unresolved symbols for some framework libraries used by TouchDB though,
</I>&gt;<i> which is bizarre, not ameliorated by adding them explicitly in the build
</I>&gt;<i> phase in Xcode, but hopefully unrelated).
</I>&gt;<i>
</I>&gt;<i> I am on Xcode 4.2 (stuck on snow leopard), using apple's llvm 3.0. I have
</I>&gt;<i> not tried LLVM GCC 4.2 as the library sources use features it doesnt
</I>&gt;<i> support.
</I>&gt;<i>
</I>&gt;<i> Any help would be greatly appreciated, as my app is pretty much dead in the
</I>&gt;<i> water without being able to link to this lib.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Daniel
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I></PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010105.html">[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?
</A></li>
	<LI>Next message: <A HREF="010120.html">[MonoTouch] Failed to load AOT module 'mscorlib' while running in aot-only mode: not compiled with --aot=full.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10143">[ date ]</a>
              <a href="thread.html#10143">[ thread ]</a>
              <a href="subject.html#10143">[ subject ]</a>
              <a href="author.html#10143">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
