<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Response timeout on HttpWebRequest with chunked	encoding &amp; https
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Response%20timeout%20on%20HttpWebRequest%20with%20chunked%0A%09encoding%20%26%20https&In-Reply-To=%3C1340808159443-4655607.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010393.html">
   <LINK REL="Next"  HREF="010378.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Response timeout on HttpWebRequest with chunked	encoding &amp; https</H1>
    <B>rwittev1</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Response%20timeout%20on%20HttpWebRequest%20with%20chunked%0A%09encoding%20%26%20https&In-Reply-To=%3C1340808159443-4655607.post%40n4.nabble.com%3E"
       TITLE="[MonoTouch] Response timeout on HttpWebRequest with chunked	encoding &amp; https">robin at reeleezee.nl
       </A><BR>
    <I>Wed Jun 27 14:42:39 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="010393.html">[MonoTouch] google street view with monotouch
</A></li>
        <LI>Next message: <A HREF="010378.html">[MonoTouch] Response timeout on HttpWebRequest with chunked encoding &amp; https
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10368">[ date ]</a>
              <a href="thread.html#10368">[ thread ]</a>
              <a href="subject.html#10368">[ subject ]</a>
              <a href="author.html#10368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We're sometimes getting a timeout on a HttpWebRequest response. Some data is
received, but not all, resulting in an exception in
WebConnectionStream.Read()
The request is over SSL and the response is using chunked transfer encoding.
Bypassing one of these 2 (i.e. chunked over http or non-chunked over https)
solves the problem for this specific instance. As we only have this problem
with a very few requests, there is no way to be certain that this solves the
actual problem or only circumvents our only reproducible case.
However, I might have found a cause in WebConnection.BeginRead() an was
wondering if anyone can confirm this:

Here is a (simplified) part of WebConnection.BeginRead():
1.	if (!chunkedRead || (!chunkStream.DataAvailable &amp;&amp; chunkStream.WantMore))
{
2.		result = nstream.BeginRead (buffer, offset, size, cb, state);
3.		cb = null;
4.	}
5.
6.	if (chunkedRead) {
7.		WebAsyncResult wr = new WebAsyncResult (cb, state, buffer, offset,
size);
8.		wr.InnerAsyncResult = result;
9.		...
10.		return wr;
11.	}

When chunkStream has only read a part of a chunk, then the 2nd part of line
1 will be true. However, line 2 directly reads from the HttpsClientStream to
the buffer. And so, bypassing data which is still in the chunkedStream.


Robin

Monotouch: 5.2.12

--
View this message in context: <A HREF="http://monotouch.2284126.n4.nabble.com/Response-timeout-on-HttpWebRequest-with-chunked-encoding-https-tp4655607.html">http://monotouch.2284126.n4.nabble.com/Response-timeout-on-HttpWebRequest-with-chunked-encoding-https-tp4655607.html</A>
Sent from the MonoTouch mailing list archive at Nabble.com.
</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010393.html">[MonoTouch] google street view with monotouch
</A></li>
	<LI>Next message: <A HREF="010378.html">[MonoTouch] Response timeout on HttpWebRequest with chunked encoding &amp; https
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10368">[ date ]</a>
              <a href="thread.html#10368">[ thread ]</a>
              <a href="subject.html#10368">[ subject ]</a>
              <a href="author.html#10368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
