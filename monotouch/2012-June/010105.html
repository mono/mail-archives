<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Infinite%20loop%20and%20crash%20when%20calling%20native%20library%20-%0A%20the%20ghost%20of%20bug%20%23707%3F&In-Reply-To=%3C4FD91573.8010501%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010338.html">
   <LINK REL="Next"  HREF="010143.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?</H1>
    <B>Daniel MacDonald</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Infinite%20loop%20and%20crash%20when%20calling%20native%20library%20-%0A%20the%20ghost%20of%20bug%20%23707%3F&In-Reply-To=%3C4FD91573.8010501%40gmail.com%3E"
       TITLE="[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?">dmacd10 at gmail.com
       </A><BR>
    <I>Wed Jun 13 22:34:27 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="010338.html">[MonoTouch] How to use a UILabel as a button?
</A></li>
        <LI>Next message: <A HREF="010143.html">[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10105">[ date ]</a>
              <a href="thread.html#10105">[ thread ]</a>
              <a href="subject.html#10105">[ subject ]</a>
              <a href="author.html#10105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi guys,

I hope someone has an idea, because I've been at this for days and am 
out of ideas. I have created bindings for a native library (TouchDB) and 
got everything working great in the simulator. But when I try to run in 
the device, I always get a crash as soon as I call anything other than a 
constructor (see full report at <A HREF="http://pastebin.com/1MbmeJQi">http://pastebin.com/1MbmeJQi</A> ). 
Basically, its going in to an infinite (or very long) loop consisting of

wrapper_managed_to_native_MonoTouch_ObjCRuntime_Messaging_IntPtr_objc_msgSend_IntPtr_IntPtr_intptr_intptr_intptr_intptr 

wrapper_runtime_invoke_object_runtime_invoke_dynamic_intptr_intptr_intptr_intptr_0 

mono_jit_runtime_invoke
mono_runtime_invoke
monotouch_static_trampoline
wrapper_managed_to_native_MonoTouch_ObjCRuntime_Messaging_IntPtr_objc_msgSend_IntPtr_IntPtr_intptr_intptr_intptr_intptr 

...


I found an old mail indicating this was due to bug #707 (which is long 
since resolved, but then again I'm only on the latest MT stable so maybe 
not?) and I went ahead and rebuilt my library with THUMB disabled.

I verified visually with otool -tv that the library being linked had no 
thumb instructions, but I suppose there could be others lurking around.

On the MT side, I've tried building both with and without the LLVM 
compiler and with and without enabling thumb support and got the same 
results (certain combinations of compiler/arch/instruction set didn't 
build due to unresolved symbols for some framework libraries used by 
TouchDB though, which is bizarre, not ameliorated by adding them 
explicitly in the build phase in Xcode, but hopefully unrelated).

I am on Xcode 4.2 (stuck on snow leopard), using apple's llvm 3.0. I 
have not tried LLVM GCC 4.2 as the library sources use features it 
doesnt support.

Any help would be greatly appreciated, as my app is pretty much dead in 
the water without being able to link to this lib.

Thanks,

Daniel
</PRE>










































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010338.html">[MonoTouch] How to use a UILabel as a button?
</A></li>
	<LI>Next message: <A HREF="010143.html">[MonoTouch] Infinite loop and crash when calling native library - the ghost of bug #707?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10105">[ date ]</a>
              <a href="thread.html#10105">[ thread ]</a>
              <a href="subject.html#10105">[ subject ]</a>
              <a href="author.html#10105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
