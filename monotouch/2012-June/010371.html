<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] DialogViewController and async search
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20DialogViewController%20and%20async%20search&In-Reply-To=%3CCANfFwGSfcxW7y_qhKKxqZT4PQ9y%3D_1g9V1%3DQ1ZwA_XmVOxxvYQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010366.html">
   <LINK REL="Next"  HREF="010420.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] DialogViewController and async search</H1>
    <B>Nic Wise</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20DialogViewController%20and%20async%20search&In-Reply-To=%3CCANfFwGSfcxW7y_qhKKxqZT4PQ9y%3D_1g9V1%3DQ1ZwA_XmVOxxvYQ%40mail.gmail.com%3E"
       TITLE="[MonoTouch] DialogViewController and async search">nicw at fastchicken.co.nz
       </A><BR>
    <I>Thu Jun 28 07:40:23 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="010366.html">[MonoTouch] DialogViewController and async search
</A></li>
        <LI>Next message: <A HREF="010420.html">[MonoTouch] DialogViewController and async search
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10371">[ date ]</a>
              <a href="thread.html#10371">[ thread ]</a>
              <a href="subject.html#10371">[ subject ]</a>
              <a href="author.html#10371">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Kim

SearchTextChanged it called as you type, so it should go each time you
hit a key.

To get rid of the keyboard, you need to use the ResignFirstResponder
method, or you can try setting EndEditing to true (you need to either
call it on the searchbox, or on the dialogviewcontroller itself)

As for the rest of it (pun kind of intended), I would:

1. get the SearchTextChanged event, and start a timer. if the timer
fires, keep going. If the user hits another key, restart the timer.
2. when the timer fires, start a new thread (ThreadPool, or use
System.Threading.Tasks) and do your rest call.
3. Once you have the data, use InvokeOnMainThread (which is on any UI*
object, or even NSString or NSObject) to pass in the results of the
search, and update the dialogviewcontroller. You MUST do the update on
the UI thread, and unless you want the UI to jump and around and stop
and stutter, you need to do the rest call (and any other non-UI
processing) OFF the main thread.

How you do the update is up to you. For a first attempt, just rebuild
the Root and reload it. If thats not smooth enough, you may need to
take the current root, insert the new results in the right places, and
allow it to animate the table cells (you get the animations for free,
pretty much)

//in a thread, do the rest calls

ThreadPool.QueueUserWorkItem(delegate {

  var results = DoSomeWorkAndGetSomeResults(searchText);

//once you have the results, update the UI - check to see if the
object you are using has InvokeOnMainThread, if so, you dont need to
make a string to use it :)

  var temp = new NSString(&quot;foo&quot;);

  temp.InvokeOnMainThread(delegate {
    var localresults = results; //keep a reference to it

    var newroot = new RootElement(&quot;results!&quot;);
    //add in secetions and elements based on your rest results
    foreach(var result in localresults) {
      //do stuff, make objects, put them into the root
    }

    Root = newroot; //display it.

  });

});





On Wed, Jun 27, 2012 at 1:50 PM, tiede &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at tiede.dk</A>&gt; wrote:
&gt;<i> I am new to mono touch and iOs programming.
</I>&gt;<i>
</I>&gt;<i> I am considering using the mono touch dialog for showing a search result
</I>&gt;<i> from a REST service. So the table is initially empty but by pressing the
</I>&gt;<i> search button (search is enabled in the dialog viewcontroller).
</I>&gt;<i>
</I>&gt;<i> Is this an ok use of the dialogviewcontroller? And what it the right pattern
</I>&gt;<i> for calling the service and supplying the result into the &quot;model&quot; of the
</I>&gt;<i> controller?
</I>&gt;<i>
</I>&gt;<i> I have tried implementing in the SearchButtonClicked and that works but the
</I>&gt;<i> keyboard does not disappear. I have tried in the SearchTextChanged but the
</I>&gt;<i> data is not refreshed.
</I>&gt;<i>
</I>&gt;<i> So I am looking for a pattern for this kind of use case?
</I>&gt;<i>
</I>&gt;<i> Thanks in advance
</I>&gt;<i>
</I>&gt;<i> Kim
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://monotouch.2284126.n4.nabble.com/DialogViewController-and-async-search-tp4655604.html">http://monotouch.2284126.n4.nabble.com/DialogViewController-and-async-search-tp4655604.html</A>
</I>&gt;<i> Sent from the MonoTouch mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>


-- 
Nic Wise
t.&#160; +44 7788 592 806 |&#160;@fastchicken | <A HREF="http://www.linkedin.com/in/nicwise">http://www.linkedin.com/in/nicwise</A>
b. <A HREF="http://www.fastchicken.co.nz/">http://www.fastchicken.co.nz/</A>

Earnest: Self-employed? Track your business expenses and income.
<A HREF="http://earnestapp.com">http://earnestapp.com</A>
Nearest Bus: find when the next bus is coming to your stop. <A HREF="http://goo.gl/Vcz1p">http://goo.gl/Vcz1p</A>
mobileAgent (for FreeAgent): get your accounts in your pocket.
<A HREF="http://goo.gl/IuBU">http://goo.gl/IuBU</A>
Trip Wallet: Keep track of your budget on the go: <A HREF="http://goo.gl/ePhKa">http://goo.gl/ePhKa</A>
London Bike App: Find the nearest Boris Bike, and get riding! <A HREF="http://goo.gl/Icp2">http://goo.gl/Icp2</A>
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010366.html">[MonoTouch] DialogViewController and async search
</A></li>
	<LI>Next message: <A HREF="010420.html">[MonoTouch] DialogViewController and async search
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10371">[ date ]</a>
              <a href="thread.html#10371">[ thread ]</a>
              <a href="subject.html#10371">[ subject ]</a>
              <a href="author.html#10371">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
