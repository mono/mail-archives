<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] trouble with object lifetime...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20trouble%20with%20object%20lifetime...&In-Reply-To=%3CCA%2BCP9O5D0kmfq5j5tVaEsMUNOXTEQE2dXd%2B_s6AKopazW%2BP-Sw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012729.html">
   <LINK REL="Next"  HREF="012722.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] trouble with object lifetime...</H1>
    <B>David Jeske</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20trouble%20with%20object%20lifetime...&In-Reply-To=%3CCA%2BCP9O5D0kmfq5j5tVaEsMUNOXTEQE2dXd%2B_s6AKopazW%2BP-Sw%40mail.gmail.com%3E"
       TITLE="[MonoTouch] trouble with object lifetime...">davidj at gmail.com
       </A><BR>
    <I>Wed Jan 23 20:08:54 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="012729.html">[MonoTouch] trouble with object lifetime...
</A></li>
        <LI>Next message: <A HREF="012722.html">[MonoTouch] Background of StyledStringElement's Value hides element	background
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12735">[ date ]</a>
              <a href="thread.html#12735">[ thread ]</a>
              <a href="subject.html#12735">[ subject ]</a>
              <a href="author.html#12735">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jan 23, 2013 at 1:37 AM, Rolf Bjarne Kvinge &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rolf at xamarin.com</A>&gt;wrote:

&gt;<i> This is due to an optimization, we do not make instances of non-inherited
</I>&gt;<i> framework types track the life-time of their corresponding native/ObjC
</I>&gt;<i> object.
</I>&gt;<i>
</I>
Thanks for the reply. Can you explain a bit further?

For example, I don't understand why Mono/C# tracking the lifetime of the
native object is related to the native UIView tracking the lifetime of the
native UIButton. I expect my &quot;UIView.AddSubview(UIButton)&quot; to cause the
native UIView to hold a reference to the native UIButton alive, even if the
C# wrapper object was collected.

...or is this a problem with my &quot;target&quot; delegate being collected, and not
the UIButton itself?

This problem is one that I run into frequently when using Xamarin. Because
my UI is instantiated in code, my classes are filled
with superfluous instance variables holding views and delegates simply to
avoid them being prematurely collected. Subclassing every one of those
would be even more cumbersome than making them instance variables. I
encourage you to reconsider this optimization, as it's a constant
re-occuring &quot;surprise&quot; when these objects being collected cause segfaults.

I don't know much about the details of how the Xamarin C# mirrors work, but
I would think there would be a way to make the API put a mirror in place
anytime a native object is returned without breaking the native-to-native,
or native-to-C#-delegate lifetime tracking.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20130123/8d90a5b0/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20130123/8d90a5b0/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012729.html">[MonoTouch] trouble with object lifetime...
</A></li>
	<LI>Next message: <A HREF="012722.html">[MonoTouch] Background of StyledStringElement's Value hides element	background
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12735">[ date ]</a>
              <a href="thread.html#12735">[ thread ]</a>
              <a href="subject.html#12735">[ subject ]</a>
              <a href="author.html#12735">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
