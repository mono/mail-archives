<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] XIB to code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20XIB%20to%20code&In-Reply-To=2EBC6748-9009-452E-B4AD-21C2D9B62267%40rory.me">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001696.html">
   <LINK REL="Next"  HREF="001681.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] XIB to code</H1>
    <B>Ed Anuff</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20XIB%20to%20code&In-Reply-To=2EBC6748-9009-452E-B4AD-21C2D9B62267%40rory.me"
       TITLE="[MonoTouch] XIB to code">ed at anuff.com
       </A><BR>
    <I>Sun Dec 13 14:49:54 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001696.html">[MonoTouch] XIB to code
</A></li>
        <LI>Next message: <A HREF="001681.html">[MonoTouch] Startup times: nib vs. nib-less [was Re: Can I show splash image within a second?]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1697">[ date ]</a>
              <a href="thread.html#1697">[ thread ]</a>
              <a href="subject.html#1697">[ subject ]</a>
              <a href="author.html#1697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In the spirit of Rory's posts, I'm going to contribute what I've found this
weekend.

It appears that you can use NIB's and get good startup performance if you
use lazy-loading properly.  Lazy-loading with UITabBarControllers is
sometimes non-obvious, at least to me.  The following two links were good
reads for figuring out how to properly break up my monolithic NIB file into
smaller NIB files:

<A HREF="http://www.drobnik.com/touch/index.php/2009/04/xib-lazy-loading-part-1/">http://www.drobnik.com/touch/index.php/2009/04/xib-lazy-loading-part-1/</A>

<A HREF="http://stackoverflow.com/questions/883510/loading-uinavigationcontroller-from-another-nib-automatically-by-uitabbarcontroll">http://stackoverflow.com/questions/883510/loading-uinavigationcontroller-from-another-nib-automatically-by-uitabbarcontroll</A>

Unfortunately, the author of the first article didn't ever follow up with a
part 2, which is where the second link comes in, because you need to take a
slightly different approach for your tabs that contain
UINavigationControllers.

My application starts up to a login screen.  When the user enters their
credentials and logs in, a network login is started and when it completes,
the main view of the application, which is tabbar-based, is displayed.  For
reasons that are not fully understand (Google 'load UITabBarController from
nib' for details), loading a UITabBarController from a Nib that is outside
of the MainWindow.xib doesn't work very well.  This means that, for most
apps of this kind, the login screen and the tab bar controller are in the
same Nib and although the user only sees the login screen, the tab bar
controller is also getting loaded before the user sees anything, so the
loading time of the tab bar controller is added to the time the user waits
before the app is seen as being &quot;started up&quot;.

The generally prescribed way to deal with this is via the links above,
basically emptying out your UITabBarController of it's contents as much as
possible and moving the controllers for the enclosed tabs into seperate
NIBs.

Before taking this approach, I was seeing startup times (counting ticks
elapsed from Application.Main() to FinishedLaunching()) of 1.85s, throwing
away the first launch after install and repeating the launch several times,
each of which was within .01 of each other.  FWIW, this is on a 3GS.

After going to seperate NIBs, startup time when to .97s, which was a very
nice improvement for what was essentially moving things around in Interface
Builder.  However, stopwatching the app rather than measuring elapsed time
in the code, shows that there's still another second or so of overhead, so
I'd consistently see around 2.2s by the stopwatch.  Now, I know a stopwatch
is hardly precise, but suitable for relative perception of start times
against other apps.  Most of the apps I use regularly (Twitter apps,
Foursquare, etc.) seem to stopwatch at around 1.5 seconds.  Much more than
that feels slow.

After refactoring so that the UITabBarController isn't built in the NIB, and
building it programmatically after the login screen is presented, although
still loading each controller inside of it from NIBs, I was able to get my
startup time to .58s as measure in the code.  By the stopwatch, it's at
around 1.7s now, which puts it in the range of regular apps.

The other thing though, is that these times are from doing several runs at a
time, throwing away the first run because it's an outlier.  Testing again
after random usage of after apps tends to result in similar times, but
occasionally, it will take quite a bit more time.  Ideally, I would have
been doing some sort of clear of memory between runs, but that also will
yield questionable data.

Anyway, long and short is that using IB isn't a bad idea, but you definitely
want to break up your monolithic NIB into smaller files, and IMHO, paying
attention to when views are actually being loaded with some debugging code
will yield some interesting insights of how to shave some more time off of
the process.

Ed
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20091213/62380794/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20091213/62380794/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001696.html">[MonoTouch] XIB to code
</A></li>
	<LI>Next message: <A HREF="001681.html">[MonoTouch] Startup times: nib vs. nib-less [was Re: Can I show splash image within a second?]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1697">[ date ]</a>
              <a href="thread.html#1697">[ thread ]</a>
              <a href="subject.html#1697">[ subject ]</a>
              <a href="author.html#1697">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
