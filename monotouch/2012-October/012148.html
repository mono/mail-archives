<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Live update of MKAnnotations coordinates	in	MKMapView
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Live%20update%20of%20MKAnnotations%20coordinates%0A%09in%09MKMapView&In-Reply-To=%3C683667F3-2897-4530-83EA-8307C5A39508%40keylogic.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012145.html">
   <LINK REL="Next"  HREF="012143.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Live update of MKAnnotations coordinates	in	MKMapView</H1>
    <B>Robert Reck</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Live%20update%20of%20MKAnnotations%20coordinates%0A%09in%09MKMapView&In-Reply-To=%3C683667F3-2897-4530-83EA-8307C5A39508%40keylogic.com%3E"
       TITLE="[MonoTouch] Live update of MKAnnotations coordinates	in	MKMapView">rreck at keylogic.com
       </A><BR>
    <I>Fri Oct  5 13:45:42 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012145.html">[MonoTouch] Live update of MKAnnotations coordinates in	MKMapView
</A></li>
        <LI>Next message: <A HREF="012143.html">[MonoTouch] setCoordinate binding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12148">[ date ]</a>
              <a href="thread.html#12148">[ thread ]</a>
              <a href="subject.html#12148">[ subject ]</a>
              <a href="author.html#12148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Arvis,
I'm doing something similar in an app I'm currently working on. But I just remove all the annotations and then reload them.

The effect is that when the map is scrolled or zoomed, all pins disappear and then reappear.

Bob

--
Bob Reck &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rreck at keylogic.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rreck at keylogic.com</A>&gt;&gt;
PII Quality Assurance Auditor
Senior Applications Developer
___________________
www.keylogic.com&lt;<A HREF="http://www.keylogic.com/">http://www.keylogic.com/</A>&gt;
443.539.9065
301.621.8920 (fax)

The information contained in this message may be privileged, private and protected from disclosure. If the reader of this message is not the intended recipient, or an employee or agent responsible for delivering this message to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited. If you have received this message in error, please notify us immediately by replying to the message.

On Oct 5, 2012, at 9:12 AM, &quot;Nic Wise&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">nicw at fastchicken.co.nz</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">nicw at fastchicken.co.nz</A>&gt;&gt; wrote:

Do you need to tell the MKMapView that it need to redraw everything?
Same as you sometimes do with a view?

On Fri, Oct 5, 2012 at 1:45 PM, Arvis Lie&#291;enieks &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">arvis at progoteam.lv</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">arvis at progoteam.lv</A>&gt;&gt; wrote:
What I'm trying to accomplish is to update collections of MyAnnotations
already added in MapView:

Dictionary&lt;long, MyAnnotation&gt; _annotations;

private void OnUpdate(Dictionary&lt;uint, MyObject&gt; updatedObjects)
{
   // Add or Update annotations on map
   foreach (var pair in updatedObjects)
   {
       uint id = pair.Key;
       MyObject obj = pair.Value;

       double lat = obj.Latitude;
       double lon = obj.Longitude;

       if (_annotations.ContainsKey(key)) // Update existing objects
       {
           _annotations[id].Coordinate = new CLLocationCoordinate2D(lat,
lon);
           _annotations[id].Obj = obj;
       }
       else // Add new object to map
       {
           var annotation = new MyAnnotation(new
CLLocationCoordinate2D(lat, lon), obj);
           _annotations.Add(id, annotation);
           InvokeOnMainThread(() =&gt; MapView.AddAnnotation(annotation));
       }
   }
}


but annotations does not get updates!!!

Does MapView receive KVO notifications automaticly when
MKAnnotation.Coordinate property has been changed and what is the
AddAnnotationObject methode for?

Falowed by this thread (
<A HREF="http://monotouch.2284126.n4.nabble.com/setCoordinate-binding-td3799997.html">http://monotouch.2284126.n4.nabble.com/setCoordinate-binding-td3799997.html</A>
)
made my annotation (but not help - annotation did not change coordinates):

       protected class MapAnnotation : MKAnnotation
       {
           private CLLocationCoordinate2D _coordinate;

           public MapAnnotation(CLLocationCoordinate2D coordinate, MyObject
obj)
           {
               _coordinate = coordinate;
               Obj = obj;
           }

           public override sealed CLLocationCoordinate2D Coordinate
           {
               get { return _coordinate; }
               set
               {
                   WillChangeValue(&quot;coordinate&quot;); // supose to triger
MapView KVO
                   _coordinate = value;
                   DidChangeValue(&quot;coordinate&quot;); // supose to triger
MapView KVO
               }
           }

           public override string Title
           {
               get { return Obj.MyTitle; }
           }

           public override string Subtitle
           {
               get { return Obj.MySubtitle; }
           }

           public Object Obj { get; set; }
       }

_______________________________________________
MonoTouch mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&gt;
<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>




--
Nic Wise
t.  +44 7788 592 806 | @fastchicken | <A HREF="http://www.linkedin.com/in/nicwise">http://www.linkedin.com/in/nicwise</A>
b. <A HREF="http://www.fastchicken.co.nz/">http://www.fastchicken.co.nz/</A>

mobileAgent (for FreeAgent): get your accounts in your pocket.
<A HREF="http://goo.gl/IuBU">http://goo.gl/IuBU</A>
Trip Wallet: Keep track of your budget on the go: <A HREF="http://goo.gl/ePhKa">http://goo.gl/ePhKa</A>
Earnest: Self-employed? Track your business expenses and income.
<A HREF="http://earnestapp.com">http://earnestapp.com</A>
Nearest Bus: find when the next bus is coming to your stop. <A HREF="http://goo.gl/Vcz1p">http://goo.gl/Vcz1p</A>
London Bike App: Find the nearest Boris Bike, and get riding! <A HREF="http://goo.gl/Icp2">http://goo.gl/Icp2</A>
_______________________________________________
MonoTouch mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&gt;
<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012145.html">[MonoTouch] Live update of MKAnnotations coordinates in	MKMapView
</A></li>
	<LI>Next message: <A HREF="012143.html">[MonoTouch] setCoordinate binding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12148">[ date ]</a>
              <a href="thread.html#12148">[ thread ]</a>
              <a href="subject.html#12148">[ subject ]</a>
              <a href="author.html#12148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
