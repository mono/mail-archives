<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;<br>
&lt;DIV&gt;Hello&nbsp;everyone,&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;I¡¯m&nbsp;binding&nbsp;a&nbsp;obj-c&nbsp;library&nbsp;in&nbsp;MonoTouch.&nbsp;But&nbsp;one&nbsp;of&nbsp;the&nbsp;API&nbsp;causes&nbsp;an&nbsp;<br>
error&nbsp;says:&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;=================================================================&lt;/DIV&gt;<br>
&lt;DIV&gt;Got&nbsp;a&nbsp;SIGSEGV&nbsp;while&nbsp;executing&nbsp;native&nbsp;code.&nbsp;This&nbsp;usually&nbsp;indicates&lt;/DIV&gt;<br>
&lt;DIV&gt;a&nbsp;fatal&nbsp;error&nbsp;in&nbsp;the&nbsp;mono&nbsp;runtime&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;native&nbsp;libraries&lt;/DIV&gt;<br>
&lt;DIV&gt;used&nbsp;by&nbsp;your&nbsp;application.&lt;/DIV&gt;<br>
&lt;DIV&gt;=================================================================&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;The&nbsp;complete&nbsp;error&nbsp;message&nbsp;is&nbsp;too&nbsp;large&nbsp;so&nbsp;I&nbsp;put&nbsp;it&nbsp;here:&nbsp;&lt;A&nbsp;<br>
title=https://docs.google.com/document/pub?id=1X0291lBugLhIsGkiVKm9fKiMN3FXB8IdmiaG5tCTD3U&nbsp;<br>
href=&quot;https://docs.google.com/document/pub?id=1X0291lBugLhIsGkiVKm9fKiMN3FXB8IdmiaG5tCTD3U&quot;&gt;https://docs.google.com/document/pub?id=1X0291lBugLhIsGkiVKm9fKiMN3FXB8IdmiaG5tCTD3U&lt;/A&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;I&nbsp;found&nbsp;something&nbsp;in&nbsp;the&nbsp;web:&nbsp;&lt;A&nbsp;<br>
title=http://www.mono-project.com/Interop_with_Native_Libraries#Strings_as_Return_Values&nbsp;<br>
href=&quot;http://www.mono-project.com/Interop_with_Native_Libraries#Strings_as_Return_Values&quot;&gt;http://www.mono-project.com/Interop_with_Native_Libraries#Strings_as_Return_Values&lt;/A&gt;.&nbsp;<br>
It&nbsp;seems&nbsp;the&nbsp;problem&nbsp;is&nbsp;caused&nbsp;by&nbsp;an&nbsp;unexpect-freed&nbsp;String&nbsp;object.&nbsp;In&nbsp;the&nbsp;<br>
assembly&nbsp;generated&nbsp;by&nbsp;mtouch,&nbsp;I&nbsp;found&nbsp;the&nbsp;following&nbsp;details&nbsp;of&nbsp;the&nbsp;error&nbsp;<br>
method:&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;public&nbsp;void&nbsp;Login(string&nbsp;username,&nbsp;string&nbsp;password,&nbsp;bool&nbsp;isAutoLogin,&nbsp;<br>
OpenApiDelegate&nbsp;del)&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;argument&nbsp;check&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;NSString&nbsp;V_0&nbsp;=&nbsp;new&nbsp;NSString(username);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;NSString&nbsp;V_1&nbsp;=&nbsp;new&nbsp;NSString(password);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(this.IsDirectBinding)&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Messaging.void_objc_xxx...&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&nbsp;else&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Messaging.void_objc_xxx...&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;V_0.Dispose();&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;V_1.Dispose();&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Is&nbsp;that&nbsp;caused&nbsp;by&nbsp;the&nbsp;string&nbsp;disposed&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;method?&nbsp;The&nbsp;Login&nbsp;<br>
method&nbsp;would&nbsp;print&nbsp;some&nbsp;log&nbsp;which&nbsp;shows&nbsp;the&nbsp;communication&nbsp;to&nbsp;the&nbsp;server&nbsp;is&nbsp;<br>
successful&nbsp;with&nbsp;the&nbsp;result&nbsp;I&nbsp;need,&nbsp;but&nbsp;the&nbsp;error&nbsp;occurred&nbsp;when&nbsp;calling-back&nbsp;to&nbsp;<br>
the&nbsp;local&nbsp;code.&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;The&nbsp;method&nbsp;below&nbsp;can&nbsp;be&nbsp;used&nbsp;normally&nbsp;in&nbsp;obj-c&nbsp;project:&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;(void)login:(NSString*)acnt&nbsp;password:(NSString*)pwd&nbsp;<br>
isAutoLogin:(BOOL)autoLogin&nbsp;<br>
withDelegate:(id&amp;lt;OpenAPIDelegate&amp;gt;)delegate;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;And&nbsp;here¡¯s&nbsp;what&nbsp;I&nbsp;did&nbsp;for&nbsp;binding:&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;[BaseType&nbsp;(typeof&nbsp;(NSObject))]&lt;/DIV&gt;<br>
&lt;DIV&gt;[Model]&lt;/DIV&gt;<br>
&lt;DIV&gt;interface&nbsp;OpenApiDelegate&lt;/DIV&gt;<br>
&lt;DIV&gt;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[Export(&quot;onSuccess:result:&quot;)]&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[Abstract]&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;OnSuccess(int&nbsp;result,&nbsp;NSDictionary&nbsp;paraDic);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[Export(&quot;onFail:result:&quot;)]&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[Abstract]&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;OnFail(int&nbsp;optType,&nbsp;NSDictionary&nbsp;paraDic);&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;//&nbsp;binding&nbsp;to&nbsp;OpenAPI&nbsp;class.&nbsp;btw,&nbsp;how&nbsp;do&nbsp;use&nbsp;another&nbsp;name?&lt;/DIV&gt;<br>
&lt;DIV&gt;[BaseType(typeof(NSObject))]&lt;/DIV&gt;<br>
&lt;DIV&gt;interface&nbsp;OpenAPI&lt;/DIV&gt;<br>
&lt;DIV&gt;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[Export(&quot;startOAWithDelegate:&quot;)]&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;StartOA(OpenApiDelegate&nbsp;d);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
[Export(&quot;login:password:isAutoLogin:withDelegate:&quot;)]&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;Login(string&nbsp;username,&nbsp;string&nbsp;password,&nbsp;bool&nbsp;<br>
isAutoLogin,&nbsp;OpenApiDelegate&nbsp;del);&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;BTW,&nbsp;the&nbsp;StartOA&nbsp;method&nbsp;without&nbsp;using&nbsp;string&nbsp;as&nbsp;the&nbsp;argument&nbsp;works&nbsp;<br>
fine.&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-SIZE:&nbsp;12pt&quot;&gt;Jeffrey&nbsp;<br>
Zhao&lt;BR&gt;Blog:&nbsp;http://blog.zhaojie.me/&lt;BR&gt;Twitter:&nbsp;<br>
http://twitter.com/jeffz_cn&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
