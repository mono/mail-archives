<tt>
&lt;div&gt;Hi,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don&amp;#39;t&nbsp;know&nbsp;exactly&nbsp;what&amp;#39;s&nbsp;going&nbsp;on,&nbsp;but&nbsp;I&nbsp;have&nbsp;a&nbsp;few&nbsp;questions&nbsp;that&nbsp;might&nbsp;help&nbsp;you:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;*&nbsp;It&nbsp;seems&nbsp;you&amp;#39;re&nbsp;using&nbsp;https,&nbsp;do&nbsp;you&nbsp;have&nbsp;the&nbsp;same&nbsp;problem&nbsp;with&nbsp;just&nbsp;http?&lt;/div&gt;<br>
&lt;div&gt;*&nbsp;Does&nbsp;it&nbsp;fail&nbsp;instantly&nbsp;when&nbsp;it&nbsp;fails,&nbsp;or&nbsp;does&nbsp;it&nbsp;start&nbsp;uploading&nbsp;and&nbsp;then&nbsp;fail&nbsp;after&nbsp;some&nbsp;random&nbsp;amount&nbsp;of&nbsp;time?&lt;/div&gt;&lt;div&gt;*&nbsp;(If&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;fail&nbsp;instantly)&nbsp;does&nbsp;a&nbsp;slow&nbsp;network&nbsp;make&nbsp;it&nbsp;fail&nbsp;faster/more&nbsp;often?&lt;/div&gt;<br>
&lt;div&gt;*&nbsp;You&nbsp;say&nbsp;you&amp;#39;re&nbsp;uploading&nbsp;&amp;quot;very&nbsp;large&nbsp;wav&nbsp;files&amp;quot;,&nbsp;but&nbsp;exactly&nbsp;how&nbsp;large&nbsp;is&nbsp;&amp;quot;very&nbsp;large&amp;quot;?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don&amp;#39;t&nbsp;think&nbsp;it&amp;#39;s&nbsp;an&nbsp;iOS&nbsp;restriction&nbsp;you&amp;#39;re&nbsp;running&nbsp;into&nbsp;if&nbsp;it&nbsp;works&nbsp;sometimes.&nbsp;To&nbsp;me&nbsp;it&nbsp;sounds&nbsp;either&nbsp;like&nbsp;a&nbsp;network&nbsp;hiccup,&nbsp;or&nbsp;an&nbsp;obscure&nbsp;bug&nbsp;inside&nbsp;MonoTouch&nbsp;(and&nbsp;the&nbsp;questions&nbsp;above&nbsp;will&nbsp;help&nbsp;point&nbsp;the&nbsp;location,&nbsp;but&nbsp;in&nbsp;any&nbsp;case&nbsp;a&nbsp;reproducible&nbsp;test&nbsp;case&nbsp;would&nbsp;likely&nbsp;be&nbsp;required&nbsp;to&nbsp;track&nbsp;down&nbsp;a&nbsp;MonoTouch&nbsp;bug).&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Rolf&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sun,&nbsp;Dec&nbsp;18,&nbsp;2011&nbsp;at&nbsp;4:23&nbsp;AM,&nbsp;jlindborg&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jlindborg2000@gmail.com&quot;&gt;jlindborg2000@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hey&nbsp;folks&nbsp;–&nbsp;been&nbsp;banging&nbsp;heads&nbsp;with&nbsp;this&nbsp;for&nbsp;several&nbsp;hours&nbsp;today&nbsp;–&nbsp;just&lt;br&gt;<br>
adding&nbsp;a&nbsp;simple&nbsp;WAV&nbsp;file&nbsp;upload/download&nbsp;facility&nbsp;into&nbsp;my&nbsp;app&nbsp;to&nbsp;a&nbsp;REST&lt;br&gt;<br>
based&nbsp;server&nbsp;–&nbsp;all&nbsp;the&nbsp;downloads&nbsp;work&nbsp;dandy&nbsp;regardless&nbsp;of&nbsp;size,&nbsp;however&lt;br&gt;<br>
uploads&nbsp;will&nbsp;occasionally&nbsp;throw&nbsp;an&nbsp;error&nbsp;on&nbsp;me&nbsp;–&nbsp;if&nbsp;you&nbsp;retry&nbsp;the&nbsp;file&nbsp;a&lt;br&gt;<br>
time&nbsp;or&nbsp;two&nbsp;when&nbsp;you&nbsp;get&nbsp;the&nbsp;failure&nbsp;they&nbsp;do&nbsp;go&nbsp;through&nbsp;but&nbsp;that&nbsp;makes&nbsp;me&lt;br&gt;<br>
sad…&nbsp;I’d&nbsp;rather&nbsp;not&nbsp;have&nbsp;to&nbsp;resort&nbsp;to&nbsp;a&nbsp;retry&nbsp;hack&nbsp;to&nbsp;smother&nbsp;this.&nbsp; Largely&lt;br&gt;<br>
the&nbsp;same&nbsp;C#&nbsp;code&nbsp;is&nbsp;in&nbsp;use&nbsp;on&nbsp;my&nbsp;WinForms&nbsp;projects&nbsp;and&nbsp;uploads&nbsp;of&nbsp;very&nbsp;large&lt;br&gt;<br>
wav&nbsp;files&nbsp;(long&nbsp;winded&nbsp;voice&nbsp;mail&nbsp;greetings&nbsp;for&nbsp;instance)&nbsp;go&nbsp;through&nbsp;ok&nbsp;to&lt;br&gt;<br>
the&nbsp;same&nbsp;servers.&lt;br&gt;<br>
&lt;br&gt;<br>
So…&nbsp;I’m&nbsp;not&nbsp;sure&nbsp;if&nbsp;this&nbsp;is&nbsp;me&nbsp;being&nbsp;a&nbsp;bonehead&nbsp;about&nbsp;something&nbsp;(always&nbsp;a&lt;br&gt;<br>
possibility)&nbsp;or&nbsp;if&nbsp;I’m&nbsp;not&nbsp;taking&nbsp;some&nbsp;iOS&nbsp;limitation&nbsp;into&nbsp;account&nbsp;or&nbsp;this&lt;br&gt;<br>
is&nbsp;a&nbsp;bug&nbsp;somewhere&nbsp;in&nbsp;Mono…&nbsp;anyway&nbsp;–&nbsp;here’s&nbsp;the&nbsp;upload&nbsp;code&nbsp;(simplified&nbsp;a&lt;br&gt;<br>
bit&nbsp;for&nbsp;brevity)&nbsp;.&lt;br&gt;<br>
==========&lt;br&gt;<br>
&lt;br&gt;<br>
private&nbsp;static&nbsp;bool&nbsp;UploadWavFile(string&nbsp;pFullResourcePath,&nbsp;string&nbsp;pLogin,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string&nbsp;pPassword,&nbsp;string&nbsp;pLocalWavFilePath)&lt;br&gt;<br>
&nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; Stream&nbsp;oStream&nbsp;=&nbsp;null;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; HttpWebRequest&nbsp;webReq;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; byte[]&nbsp;buffer;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; BinaryReader&nbsp;binReader&nbsp;=&nbsp;null;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FileStream&nbsp;oFileStream&nbsp;=&nbsp;null;&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; try&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oFileStream&nbsp;=&nbsp;File.Open(pLocalWavFilePath,&nbsp;FileMode.Open);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;binReader&nbsp;=&nbsp;new&nbsp;BinaryReader(oFileStream);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;buffer&nbsp;=&nbsp;new&nbsp;byte[Convert.ToInt32(binReader.BaseStream.Length)&nbsp;+&lt;br&gt;<br>
1];&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;binReader.Read(buffer,&nbsp;0,&nbsp;buffer.Length);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; catch&nbsp;(Exception&nbsp;ex)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine(ex.ToString());&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;false;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; webReq&nbsp;=&nbsp;(HttpWebRequest)WebRequest.Create(pFullResourcePath);&lt;br&gt;<br>
&nbsp; &nbsp; webReq.Method&nbsp;=&nbsp;&amp;quot;PUT&amp;quot;;&lt;br&gt;<br>
&nbsp; &nbsp; webReq.ContentLength&nbsp;=&nbsp;buffer.Length;&lt;br&gt;<br>
&nbsp; &nbsp; webReq.ContentType&nbsp;=&nbsp;&amp;quot;audio/wav&amp;quot;;&lt;br&gt;<br>
&nbsp; &nbsp; webReq.Credentials&nbsp;=&nbsp;new&nbsp;NetworkCredential(pLogin,&nbsp;pPassword);&lt;br&gt;<br>
&nbsp; &nbsp; webReq.KeepAlive&nbsp;=&nbsp;false;&lt;br&gt;<br>
&nbsp; &nbsp; webReq.ReadWriteTimeout=&nbsp;50000;&lt;br&gt;<br>
&nbsp; &nbsp; oStream&nbsp;=&nbsp;webReq.GetRequestStream();&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; Try&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //LINE&nbsp;THAT&nbsp;THROWS&nbsp;ERROR&nbsp;FROM&nbsp;TIME&nbsp;TO&nbsp;TIME&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; oStream.Write(buffer,0,&nbsp;buffer.Length);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; catch&nbsp;(Exception&nbsp;ex)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine&nbsp;(ex.ToString());&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;false;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
...&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;here’s&nbsp;the&nbsp;error&nbsp;it’s&nbsp;throwing&nbsp;at&nbsp;the&nbsp;noted&nbsp;line:&lt;br&gt;<br>
&lt;br&gt;<br>
System.IO.IOException:&nbsp;IO&nbsp;exception&nbsp;during&nbsp;Write.&nbsp;---&amp;gt;&lt;br&gt;<br>
System.NullReferenceException:&nbsp;Object&nbsp;reference&nbsp;not&nbsp;set&nbsp;to&nbsp;an&nbsp;instance&nbsp;of&nbsp;an&lt;br&gt;<br>
object\n&nbsp; at&nbsp;Mono.Security.Protocol.Tls.SslStreamBase.InternalBeginWrite&lt;br&gt;<br>
(Mono.Security.Protocol.Tls.InternalAsyncResult&nbsp;asyncResult)&nbsp;[0x00031]&nbsp;in&lt;br&gt;<br>
/Developer/MonoTouch/Source/mono/mcs/class/Mono.Security/Mono.Security.Protocol.Tls/SslStreamBase.cs:775&lt;br&gt;<br>
\n&nbsp; ---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---\n&nbsp; at&lt;br&gt;<br>
Mono.Security.Protocol.Tls.SslStreamBase.InternalBeginWrite&lt;br&gt;<br>
(Mono.Security.Protocol.Tls.InternalAsyncResult&nbsp;asyncResult)&nbsp;[0x00089]&nbsp;in&lt;br&gt;<br>
/Developer/MonoTouch/Source/mono/mcs/class/Mono.Security/Mono.Security.Protocol.Tls/SslStreamBase.cs:788&lt;br&gt;<br>
\n&nbsp; at&nbsp;Mono.Security.Protocol.Tls.SslStreamBase.BeginWrite&nbsp;(System.Byte[]&lt;br&gt;<br>
buffer,&nbsp;Int32&nbsp;offset,&nbsp;Int32&nbsp;count,&nbsp;System.AsyncCallback&nbsp;callback,&lt;br&gt;<br>
System.Object&nbsp;state)&nbsp;[0x000a3]&nbsp;in&lt;br&gt;<br>
/Developer/MonoTouch/Source/mono/mcs/class/Mono.Security/Mono.Security.Protocol.Tls/SslStreamBase.cs:857&lt;br&gt;<br>
\n&nbsp; at&nbsp;System.Net.WebConnection.BeginWrite&nbsp;(System.Net.HttpWebRequest&lt;br&gt;<br>
request,&nbsp;System.Byte[]&nbsp;buffer,&nbsp;Int32&nbsp;offset,&nbsp;Int32&nbsp;size,&lt;br&gt;<br>
System.AsyncCallback&nbsp;cb,&nbsp;System.Object&nbsp;state)&nbsp;[0x00055]&nbsp;in&lt;br&gt;<br>
/Developer/MonoTouch/Source/mono/mcs/class/System/System.Net/WebConnection.cs:927&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://monotouch.2284126.n4.nabble.com/Odd-sporatic-error-on-WAV-uploads-via-PUT-HTTP-request-tp4210028p4210028.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://monotouch.2284126.n4.nabble.com/Odd-sporatic-error-on-WAV-uploads-via-PUT-HTTP-request-tp4210028p4210028.html&lt;/a&gt;&lt;br&gt;<br>
<br>
Sent&nbsp;from&nbsp;the&nbsp;MonoTouch&nbsp;mailing&nbsp;list&nbsp;archive&nbsp;at&nbsp;Nabble.com.&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
MonoTouch&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:MonoTouch@lists.ximian.com&quot;&gt;MonoTouch@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/monotouch&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/monotouch&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
