<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;10pt;<br>
font-family:Tahoma<br>
}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;<br>
Admittedly,&nbsp;I&nbsp;am&nbsp;much&nbsp;more&nbsp;familiar&nbsp;with&nbsp;the&nbsp;threadpool&nbsp;in&nbsp;.NET&nbsp;than&nbsp;I&nbsp;am&nbsp;in&nbsp;Mono,&nbsp;so&nbsp;if&nbsp;I&nbsp;say&nbsp;something&nbsp;that&nbsp;is&nbsp;full&nbsp;of&nbsp;****&nbsp;(aka&nbsp;bad&nbsp;stuff),&nbsp;please&nbsp;chime&nbsp;in.&nbsp;&nbsp;&lt;img&nbsp;style=&quot;border-style:&nbsp;none;&nbsp;vertical-align:&nbsp;text-bottom;&quot;&nbsp;title=&quot;Smile&quot;&nbsp;alt=&quot;Smile&quot;&nbsp;src=&quot;https://gfx5.hotmail.com/mail/w4/pr04/ltr/emo/smile.gif&quot;&nbsp;height=&quot;19&quot;&nbsp;width=&quot;19&quot;&gt;&lt;br&gt;&lt;br&gt;I'm&nbsp;pulling&nbsp;this&nbsp;from&nbsp;memory&nbsp;back&nbsp;in&nbsp;.net&nbsp;2&nbsp;days,&nbsp;so&nbsp;it&nbsp;could&nbsp;be&nbsp;complete&nbsp;whack.&nbsp;&nbsp;If&nbsp;you&nbsp;queue&nbsp;up&nbsp;a&nbsp;bunch&nbsp;of&nbsp;threadpool&nbsp;threads&nbsp;in&nbsp;.NET,&nbsp;they&nbsp;don't&nbsp;always&nbsp;run&nbsp;at&nbsp;the&nbsp;same&nbsp;exact&nbsp;moment.&nbsp;&nbsp;The&nbsp;TP&nbsp;uses&nbsp;some&nbsp;kind&nbsp;of&nbsp;internal&nbsp;monitors&nbsp;to&nbsp;queue&nbsp;the&nbsp;threads&nbsp;up&nbsp;and&nbsp;run&nbsp;them&nbsp;as&nbsp;&quot;resources&nbsp;permit.&quot;&nbsp;&nbsp;I&nbsp;found&nbsp;this&nbsp;out&nbsp;when&nbsp;I&nbsp;had&nbsp;an&nbsp;application&nbsp;that&nbsp;was&nbsp;making&nbsp;async&nbsp;http&nbsp;calls&nbsp;and&nbsp;it&nbsp;never&nbsp;would&nbsp;go&nbsp;beyond&nbsp;a&nbsp;few&nbsp;tp&nbsp;threads&nbsp;running&nbsp;in&nbsp;parallel&nbsp;when&nbsp;I&nbsp;had&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;bandwidth.&nbsp;&nbsp;When&nbsp;I&nbsp;had&nbsp;a&nbsp;large&nbsp;amount&nbsp;of&nbsp;bandwidth,&nbsp;it&nbsp;would&nbsp;exhaust&nbsp;the&nbsp;tp.&nbsp;&nbsp;Another&nbsp;issue&nbsp;I&nbsp;ran&nbsp;into&nbsp;was&nbsp;the&nbsp;relationship&nbsp;between&nbsp;the&nbsp;tp&nbsp;and&nbsp;the&nbsp;http&nbsp;requests.&nbsp;&nbsp;iirc,&nbsp;even&nbsp;in&nbsp;.net&nbsp;2&nbsp;sync&nbsp;requests,&nbsp;a&nbsp;tp&nbsp;thread&nbsp;was&nbsp;used,&nbsp;which&nbsp;meant&nbsp;that&nbsp;one&nbsp;tp&nbsp;call&nbsp;used&nbsp;two&nbsp;tps&nbsp;(the&nbsp;call&nbsp;itself&nbsp;and&nbsp;one&nbsp;for&nbsp;a&nbsp;sync&nbsp;tp&nbsp;call).&nbsp;&nbsp;I'm&nbsp;sure&nbsp;that&nbsp;this&nbsp;has&nbsp;improved&nbsp;with&nbsp;.net&nbsp;4&nbsp;as&nbsp;I&nbsp;am&nbsp;currently&nbsp;queuing&nbsp;up&nbsp;tons&nbsp;of&nbsp;tasks&nbsp;and&nbsp;executing&nbsp;them&nbsp;one&nbsp;right&nbsp;after&nbsp;the&nbsp;other.&lt;br&gt;&lt;br&gt;My&nbsp;suggestion&nbsp;in&nbsp;this&nbsp;would&nbsp;be&nbsp;to&nbsp;run&nbsp;it,&nbsp;see&nbsp;what&nbsp;the&nbsp;results&nbsp;are&nbsp;over&nbsp;a&nbsp;bad&nbsp;connection,&nbsp;and&nbsp;then&nbsp;try&nbsp;to&nbsp;improve&nbsp;things.&nbsp;&nbsp;A&nbsp;queue&nbsp;of&nbsp;1&nbsp;at&nbsp;a&nbsp;time&nbsp;and&nbsp;a&nbsp;tp&nbsp;to&nbsp;handle&nbsp;this&nbsp;off&nbsp;the&nbsp;ui&nbsp;thread&nbsp;sounds&nbsp;like&nbsp;the&nbsp;right&nbsp;way&nbsp;to&nbsp;start.&nbsp;&nbsp;I&nbsp;am&nbsp;guessing&nbsp;that&nbsp;if&nbsp;the&nbsp;tp&nbsp;algorithm&nbsp;in&nbsp;MT&nbsp;is&nbsp;like&nbsp;the&nbsp;one&nbsp;in&nbsp;.NET,&nbsp;the&nbsp;bandwidth&nbsp;will&nbsp;severely&nbsp;limit&nbsp;what&nbsp;you&nbsp;can&nbsp;do.&nbsp;&nbsp;Also,&nbsp;I'd&nbsp;look&nbsp;at&nbsp;using&nbsp;the&nbsp;task&nbsp;parallel&nbsp;library(tpl).&nbsp;&nbsp;if&nbsp;I&nbsp;have&nbsp;read&nbsp;what&nbsp;is&nbsp;trying&nbsp;to&nbsp;be&nbsp;accomplished&nbsp;correctly,&nbsp;I&nbsp;think&nbsp;that&nbsp;it&nbsp;will&nbsp;give&nbsp;you&nbsp;most&nbsp;of&nbsp;what&nbsp;you&nbsp;want.&nbsp;&nbsp;I&nbsp;know&nbsp;that&nbsp;in&nbsp;the&nbsp;.NET&nbsp;world,&nbsp;there&nbsp;is&nbsp;a&nbsp;move&nbsp;away&nbsp;from&nbsp;the&nbsp;TP&nbsp;and&nbsp;a&nbsp;move&nbsp;towards&nbsp;TPL&nbsp;and&nbsp;such.&nbsp;&nbsp;Though,&nbsp;I&nbsp;admit&nbsp;that&nbsp;I&nbsp;don't&nbsp;know&nbsp;the&nbsp;specifics&nbsp;of&nbsp;what&nbsp;is&nbsp;happening&nbsp;under&nbsp;the&nbsp;covers&nbsp;and&nbsp;would&nbsp;greatly&nbsp;appreciate&nbsp;to&nbsp;get&nbsp;more&nbsp;better&nbsp;info&nbsp;that&nbsp;what&nbsp;I&nbsp;have&nbsp;(which&nbsp;isn't&nbsp;much).&nbsp;&nbsp;Admittedly,&nbsp;debugging&nbsp;is&nbsp;going&nbsp;to&nbsp;be&nbsp;problematic,&nbsp;but&nbsp;its&nbsp;hard&nbsp;to&nbsp;debug&nbsp;threads&nbsp;anywhere.&lt;br&gt;&lt;br&gt;Wally&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;div&nbsp;id=&quot;SkyDrivePlaceholder&quot;&gt;&lt;/div&gt;&gt;&nbsp;Date:&nbsp;Thu,&nbsp;23&nbsp;Feb&nbsp;2012&nbsp;12:06:52&nbsp;+1300&lt;br&gt;&gt;&nbsp;From:&nbsp;felix@intranel.com&lt;br&gt;&gt;&nbsp;To:&nbsp;monotouch@lists.ximian.com&lt;br&gt;&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[MonoTouch]&nbsp;Threading&nbsp;best&nbsp;practice&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;&gt;&nbsp;-Have&nbsp;a&nbsp;queue&nbsp;with&nbsp;the&nbsp;100&nbsp;requests.&lt;br&gt;&gt;&nbsp;-Start&nbsp;a&nbsp;background&nbsp;thread&nbsp;with&nbsp;that&nbsp;keeps&nbsp;an&nbsp;eye&nbsp;on&nbsp;how&nbsp;many&nbsp;requests&lt;br&gt;&gt;&nbsp;are&nbsp;in&nbsp;progress&lt;br&gt;&gt;&nbsp;-Inside&nbsp;the&nbsp;thread&nbsp;start&nbsp;the&nbsp;async&nbsp;requests&nbsp;one&nbsp;by&nbsp;one&nbsp;untill&nbsp;you&nbsp;have&lt;br&gt;&gt;&nbsp;reached&nbsp;your&nbsp;limit.&lt;br&gt;&gt;&nbsp;-When&nbsp;each&nbsp;of&nbsp;the&nbsp;requests&nbsp;call&nbsp;back&nbsp;update&nbsp;the&nbsp;status&nbsp;of&nbsp;how&nbsp;many&lt;br&gt;&gt;&nbsp;requests&nbsp;are&nbsp;in&nbsp;progress.&lt;br&gt;&gt;&nbsp;-End&nbsp;the&nbsp;whole&nbsp;thing&nbsp;when&nbsp;you&nbsp;are&nbsp;done&nbsp;processing.&lt;br&gt;&gt;&nbsp;&lt;&lt;&lt;&lt;&lt;&lt;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;instead&nbsp;of&nbsp;having&nbsp;a&nbsp;separate&nbsp;thread&nbsp;to&nbsp;monitor&nbsp;the&nbsp;queue,&nbsp;you&nbsp;could&nbsp;just&nbsp;have&nbsp;a&nbsp;method&nbsp;(WebCallDone&nbsp;say)&nbsp;that&nbsp;is&nbsp;called&nbsp;when&nbsp;each&nbsp;async&nbsp;web&nbsp;call&nbsp;returns.&nbsp;&nbsp;WebCallDone&nbsp;check&nbsp;the&nbsp;queue&nbsp;and&nbsp;a&nbsp;count&nbsp;of&nbsp;current&nbsp;pending&nbsp;calls&nbsp;and&nbsp;fires&nbsp;another&nbsp;call&nbsp;off&nbsp;the&nbsp;queue&nbsp;if&nbsp;required.&nbsp;Queue&nbsp;operations&nbsp;and&nbsp;count&nbsp;checking&nbsp;need&nbsp;to&nbsp;be&nbsp;thread&nbsp;safe&nbsp;obviously.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;_______________________________________________&lt;br&gt;&gt;&nbsp;MonoTouch&nbsp;mailing&nbsp;list&lt;br&gt;&gt;&nbsp;MonoTouch@lists.ximian.com&lt;br&gt;&gt;&nbsp;http://lists.ximian.com/mailman/listinfo/monotouch&lt;br&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
