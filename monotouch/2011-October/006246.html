<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] UIDocumentInteractionController Question/Problem only with iOS 5.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20UIDocumentInteractionController%20Question/Problem%0A%20only%20with%20iOS%205.0&In-Reply-To=CAD05E39.2FE9C%25dpronk%40probe-asp.eu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006210.html">
   <LINK REL="Next"  HREF="006261.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] UIDocumentInteractionController Question/Problem only with iOS 5.0</H1>
    <B>Miguel de Icaza</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20UIDocumentInteractionController%20Question/Problem%0A%20only%20with%20iOS%205.0&In-Reply-To=CAD05E39.2FE9C%25dpronk%40probe-asp.eu"
       TITLE="[MonoTouch] UIDocumentInteractionController Question/Problem only with iOS 5.0">miguel at xamarin.com
       </A><BR>
    <I>Mon Oct 31 08:29:42 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006210.html">[MonoTouch] UIDocumentInteractionController Question/Problem only	with iOS 5.0
</A></li>
        <LI>Next message: <A HREF="006261.html">[MonoTouch] UIDocumentInteractionController Question/Problem only with iOS 5.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6246">[ date ]</a>
              <a href="thread.html#6246">[ thread ]</a>
              <a href="subject.html#6246">[ subject ]</a>
              <a href="author.html#6246">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Danny,

    I noticed that you are using a local variable &quot;docControl&quot;, and that
object might be collected once the method exists.

    You do keep an InvokeOnMainThread there, but I do not believe that is
keeping a reference around.   Could you try assigning that to a global
variable for now, and report if that fixes the issue?

Miguel

On Fri, Oct 28, 2011 at 7:27 AM, Danny Pronk &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">dpronk at probe-asp.eu</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am using the following code to display the OpenInMenu.
</I>&gt;<i> On the iPhone when the UIDocumentInteractionController is shown, you can
</I>&gt;<i> see a cancel button, and there things work like clockwork.
</I>&gt;<i>
</I>&gt;<i> However on the iPad (both with iOS 4.3 and iOS 5.0) you see the
</I>&gt;<i> applications where you can open the file with, but NO cancel button is
</I>&gt;<i> visible.
</I>&gt;<i>
</I>&gt;<i> When the OpenInMenu is visible and you click somewhere outside the menu it
</I>&gt;<i> disappears but still remains active in memory.
</I>&gt;<i> Is my problem related to the RectangleF size or am I missing something
</I>&gt;<i> essential how to give the user the dismiss option on the iPad !
</I>&gt;<i>
</I>&gt;<i> The strange thing is that on an iPad with iOS 4.3 things seem to work ok,
</I>&gt;<i> but on and iPad with iOS 5.0 the DidDissmissOpenInMenu is NEVER fired.
</I>&gt;<i>
</I>&gt;<i> Please help. (I have found this code on StackOverflow and until iOS 5.0
</I>&gt;<i> things worked like expected!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Below you find the code I am using.
</I>&gt;<i>
</I>&gt;<i> using (var pool = new NSAutoreleasePool()) {
</I>&gt;<i>
</I>&gt;<i> UIDocumentInteractionController docControl =
</I>&gt;<i> UIDocumentInteractionController.FromUrl(nsurl);
</I>&gt;<i>
</I>&gt;<i> docControl.Delegate = newDialogs.UIDocumentInteractionControllerDelegateClass();
</I>&gt;<i>
</I>&gt;<i> docControl.DidDismissOpenInMenu += HandleDocControlDidDismissOpenInMenu;
</I>&gt;<i>
</I>&gt;<i> docControl.DidEndSendingToApplication +=
</I>&gt;<i> HandleDocControlDidEndSendingToApplication;
</I>&gt;<i>
</I>&gt;<i> docControl.
</I>&gt;<i>
</I>&gt;<i> docControl.InvokeOnMainThread(
</I>&gt;<i>
</I>&gt;<i>                delegate {
</I>&gt;<i>
</I>&gt;<i> if(_webView.IsFirstResponder)
</I>&gt;<i>
</I>&gt;<i> _webView.ResignFirstResponder();
</I>&gt;<i>
</I>&gt;<i> RectangleF theScreenSize = UIScreen.MainScreen.Bounds;
</I>&gt;<i>
</I>&gt;<i>                 float width = theScreenSize.Width;
</I>&gt;<i>
</I>&gt;<i> bool isValid = docControl.PresentOpenInMenu(new RectangleF(width-40,0,0,20),
</I>&gt;<i> _viewController.View,false);
</I>&gt;<i>
</I>&gt;<i> if(!isValid)
</I>&gt;<i>
</I>&gt;<i> {
</I>&gt;<i>
</I>&gt;<i> UIAlertView avAlert = new UIAlertView(_viewController.Language.FieldValue(
</I>&gt;<i> &quot;reader_title&quot;), _viewController.Language.FieldValue(&quot;reader_message&quot;),
</I>&gt;<i> null,_viewController.Language.FieldValue(&quot;reader_close&quot;));
</I>&gt;<i>
</I>&gt;<i> avAlert.AutoresizingMask = UIViewAutoresizing.FlexibleLeftMargin |
</I>&gt;<i> UIViewAutoresizing.FlexibleTopMargin;
</I>&gt;<i>
</I>&gt;<i> avAlert.Show();
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> } );
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20111031/1be4dfce/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20111031/1be4dfce/attachment.html</A> 
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006210.html">[MonoTouch] UIDocumentInteractionController Question/Problem only	with iOS 5.0
</A></li>
	<LI>Next message: <A HREF="006261.html">[MonoTouch] UIDocumentInteractionController Question/Problem only with iOS 5.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6246">[ date ]</a>
              <a href="thread.html#6246">[ thread ]</a>
              <a href="subject.html#6246">[ subject ]</a>
              <a href="author.html#6246">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
