<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Obj-C Categories in Monotouch?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Obj-C%20Categories%20in%20Monotouch%3F&In-Reply-To=%3CCAP-t25-791vR2C%3DKxt_v%3D7pvzp49k6kTLXhWjmNV0Ess2G0hRQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009244.html">
   <LINK REL="Next"  HREF="009230.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Obj-C Categories in Monotouch?</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Obj-C%20Categories%20in%20Monotouch%3F&In-Reply-To=%3CCAP-t25-791vR2C%3DKxt_v%3D7pvzp49k6kTLXhWjmNV0Ess2G0hRQ%40mail.gmail.com%3E"
       TITLE="[MonoTouch] Obj-C Categories in Monotouch?">rolf at xamarin.com
       </A><BR>
    <I>Thu Apr 19 11:02:44 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009244.html">[MonoTouch] Obj-C Categories in Monotouch?
</A></li>
        <LI>Next message: <A HREF="009230.html">[MonoTouch] Displaying UIViewAlert to the user from background tasks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9253">[ date ]</a>
              <a href="thread.html#9253">[ thread ]</a>
              <a href="subject.html#9253">[ subject ]</a>
              <a href="author.html#9253">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i>From what I understand you want to replace the implementation of a method
</I>without deriving from the corresponding class.

It is possible to do, but it's not easy. What you need to do is to manually
replace the method implementation of the class using objective-c runtime
functions (which are described here:
<A HREF="https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html">https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html</A>
)

In pseudo code it would be something like this:

static extern IntPtr class_getInstanceMethod (IntPtr, IntPtr);
static extern IntPtr method_setImplementation (IntPtr, IntPtr);

delegate void DrawDelegate (IntPtr @this, IntPtr selector, &lt;additional
draw() parameters&gt;);
[MonoPInvokeCallback (typeof (DrawDelegate))]
static void Draw (IntPtr @this, IntPtr selector, &lt;additional draw()
parameters&gt;)
{
    // the two first arguments are required, that's how objc method
invocation works.
    NavigationBar nav_bar = new NavigationBar (@this);
    // do your custom drawing here
    nav_bar.Dispose ();
}
static DrawDelegate DrawImplementation =  Draw;

void ReplaceDraw ()
{
    IntPtr nav_bar_class = new Class (typeof (NavigationBar)).Handle;
    IntPtr method = class_getInstanceMethod (nav_bar_class, new Selector
(&quot;draw:&quot;).Handle);
    IntPtr new_impl = Marshal.GetFunctionPointerForDelegate
(DrawImplementation);

    method_setImplementation (method, new_impl);
}

I hope this helps (but I recommend you find another way of doing it :)
Rolf

On Thu, Apr 19, 2012 at 4:42 AM, dermotos &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">me at dermotos.com</A>&gt; wrote:

&gt;<i> Thanks for the replies, you have more or less come to the same conclusions
</I>&gt;<i> I
</I>&gt;<i> have regarding extension methods etc...
</I>&gt;<i> The partial class approach wont work as the original class also needs to be
</I>&gt;<i> marked as partial. Also, partial is just a compiler convenience, that joins
</I>&gt;<i> two .cs files together before compilation, so wont work with any
</I>&gt;<i> pre-compiled framework code.
</I>&gt;<i>
</I>&gt;<i> I've decided I will be using a &quot;pretty enough&quot; approach for ios4 users. Its
</I>&gt;<i> too much extra work for a constantly shrinking user base. If they're too
</I>&gt;<i> lazy to plug their phone into iTunes once a year, then they cant have nice
</I>&gt;<i> things. :-)
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://monotouch.2284126.n4.nabble.com/Obj-C-Categories-in-Monotouch-tp4567460p4569728.html">http://monotouch.2284126.n4.nabble.com/Obj-C-Categories-in-Monotouch-tp4567460p4569728.html</A>
</I>&gt;<i> Sent from the MonoTouch mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120419/d7a41fda/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120419/d7a41fda/attachment.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009244.html">[MonoTouch] Obj-C Categories in Monotouch?
</A></li>
	<LI>Next message: <A HREF="009230.html">[MonoTouch] Displaying UIViewAlert to the user from background tasks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9253">[ date ]</a>
              <a href="thread.html#9253">[ thread ]</a>
              <a href="subject.html#9253">[ subject ]</a>
              <a href="author.html#9253">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
