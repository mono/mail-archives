<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Nested push animations
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Nested%20push%20animations&In-Reply-To=%3C7F97B03DB6DACB45AB6E5C5E1267AD042456740A%40MXXSLAUS001.xsl.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009180.html">
   <LINK REL="Next"  HREF="009164.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Nested push animations</H1>
    <B>Dean Cleaver</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Nested%20push%20animations&In-Reply-To=%3C7F97B03DB6DACB45AB6E5C5E1267AD042456740A%40MXXSLAUS001.xsl.com%3E"
       TITLE="[MonoTouch] Nested push animations">dean.cleaver at xceptionsoftware.com
       </A><BR>
    <I>Sun Apr 15 14:14:57 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009180.html">[MonoTouch] Nested push animations
</A></li>
        <LI>Next message: <A HREF="009164.html">[MonoTouch] Does	UILongPressGestureRecognizer(Action&lt;UILongPressGestureRecognizer&gt;)	constructor exist?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9181">[ date ]</a>
              <a href="thread.html#9181">[ thread ]</a>
              <a href="subject.html#9181">[ subject ]</a>
              <a href="author.html#9181">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've seen it when you Pop animated and then push immediately afterwards, or when you pop twice in a row. Usually corrupts the navigation bar (as in the title will not match the view etc.

In this case I am describing, I can't be 100% certain whether it was going to show a new view or display a uiactionsheet after it popped, but it was one or the other.

Dino

From: Ren&#233; Ruppert [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rene.ruppert at googlemail.com</A>]
Sent: Sunday, April 15, 2012 6:40
To: Dean Cleaver; <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>
Subject: AW: [MonoTouch] Nested push animations

Can somebody comment WHEN these problems with nested animations occur? I'm animating controller views left and right in my own view controller containment implementation (a split view clone) and have never seen these problems when animating views manually.
However I noticed once that I got an exception that informed that a transition to another controller cannot be started while one is still running.
Where's the difference between manual view animation and using controller's transitions?

Ren&#233;

Von: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>&gt; [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>]&lt;mailto:[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>]&gt; Im Auftrag von Dean Cleaver
Gesendet: Samstag, 14. April 2012 02:23
An: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>&gt;
Betreff: Re: [MonoTouch] Nested push animations

Worked it out in the end. You can do it this way:

using MonoTouch.UIKit;

namespace Your.Namespace
{
                    public class NavigationControllerDelegate : UINavigationControllerDelegate
                    {
                                         public bool Transitioning = true;

                                        public override void DidShowViewController (UINavigationController navigationController, UIViewController viewController, bool animated)
                                         {
                                                             this.Transitioning = false;
                                         }
                    }
}

And do this on each PopViewControllerAnimated:


NavigationControllerDelegate navigationControllerDelegate = new NavigationControllerDelegate();



navigationController.Delegate = navigationControllerDelegate;

navigationController.PopViewControllerAnimated(true);



while (navigationControllerDelegate.Transitioning)

    NSRunLoop.Current.RunUntil(DateTime.Now.AddMilliseconds(50));



navigationController.Delegate = null;


But rather than do that everywhere, I created this extension method (using the above delegate class):


using System;



using MonoTouch.Foundation;



using Your.Namespace;



namespace MonoTouch.UIKit

{

                    public static class NavigationControllerExtension

                    {

                                        public static UIViewController PopViewControllerAnimatedPause(this UINavigationController navigationController, bool animated)

                                         {

                                                             if (animated)

                                                             {

                                                                                 NavigationControllerDelegate  existing = navigationController.Delegate ;

                                                                                 NavigationControllerDelegate navigationControllerDelegate = new NavigationControllerDelegate();



                                                                                 navigationController.Delegate = navigationControllerDelegate;

                                                                                 UIViewController result = navigationController.PopViewControllerAnimated(true);



                                                                                 while (navigationControllerDelegate.Transitioning)

                                                                                                      NSRunLoop.Current.RunUntil(DateTime.Now.AddMilliseconds(50));



                                                                                 navigationController.Delegate = existing;



                                                                                 return result;

                                                             }



                                                             return navigationController.PopViewControllerAnimated(false);

                                         }

                    }

}




Now all I have to do is call &quot;PopViewControllerAnimatedPause(true);&quot; and it's all handled for me.

Dino

From: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>&gt; [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>]&lt;mailto:[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>]&gt; On Behalf Of Dean Cleaver
Sent: Friday, April 13, 2012 1:42 PM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>&gt;
Subject: [MonoTouch] Nested push animations

Hi,

I'm getting some nested push animation errors when transitioning between screens, and I'm not sure how I can prevent it nicely. Basically:


1.       I push a screen that the user fills in.

2.       I pop the screen animated.

3.       I call other code that depending on circumstances, may or may not show a UIActionSheet or another UIView animated.

On showing the UIActionSheet or UIView I get the nested animation problems.

Now, I can pop the screen not animated in step 2, but it looks rather abrupt if step 3 doesn't show any other UI elements. What I'm looking for is a way to detect that the pop in step 2 has completed before I continue with step 3 - is there an easy way to detect that its completed?

Dino
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120415/567c812f/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120415/567c812f/attachment-0001.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009180.html">[MonoTouch] Nested push animations
</A></li>
	<LI>Next message: <A HREF="009164.html">[MonoTouch] Does	UILongPressGestureRecognizer(Action&lt;UILongPressGestureRecognizer&gt;)	constructor exist?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9181">[ date ]</a>
              <a href="thread.html#9181">[ thread ]</a>
              <a href="subject.html#9181">[ subject ]</a>
              <a href="author.html#9181">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
