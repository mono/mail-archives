<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] When is BeginInvokeOnMainThread done?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20When%20is%20BeginInvokeOnMainThread%20done%3F&In-Reply-To=%3C4F7F614C.5050601%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009025.html">
   <LINK REL="Next"  HREF="009028.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] When is BeginInvokeOnMainThread done?</H1>
    <B>Chris Hatton</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20When%20is%20BeginInvokeOnMainThread%20done%3F&In-Reply-To=%3C4F7F614C.5050601%40gmail.com%3E"
       TITLE="[MonoTouch] When is BeginInvokeOnMainThread done?">christopherhattonuk at gmail.com
       </A><BR>
    <I>Fri Apr  6 21:34:04 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009025.html">[MonoTouch] When is BeginInvokeOnMainThread done?
</A></li>
        <LI>Next message: <A HREF="009028.html">[MonoTouch] When is BeginInvokeOnMainThread done?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9027">[ date ]</a>
              <a href="thread.html#9027">[ thread ]</a>
              <a href="subject.html#9027">[ subject ]</a>
              <a href="author.html#9027">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Convention

Sometimes a framework dictates what our thread context will be...  The 
code fragment provided by the OP might go inside a network call-back 
method, which will not be called on the main thread. Surely every App. 
developer has faced this kind of scenario. Switching to the main thread 
is necessary, by convention, to ensure UI related code will not be run 
concurrently with other UI related code. The Cocoa Touch framework isn't 
designed for concurrent access, and most Apps will break very quickly if 
this isn't observed...

Chris

On 06/04/12 19:19, Ren&#233; Ruppert wrote:
&gt;<i>
</I>&gt;<i> Then I&#8217;m wondering: why would you want to execute something on  a 
</I>&gt;<i> separate thread in the first place, if all you do is wait until it 
</I>&gt;<i> finishes and do everything possible to **not** execute your code on 
</I>&gt;<i> the thread on which you currently are!?
</I>&gt;<i>
</I>&gt;<i> Ren&#233;
</I>&gt;<i>
</I>&gt;<i> *Von:*<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A> 
</I>&gt;<i> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>] *Im Auftrag von *Chris Hatton
</I>&gt;<i> *Gesendet:* Freitag, 6. April 2012 15:55
</I>&gt;<i> *An:* <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>
</I>&gt;<i> *Betreff:* Re: [MonoTouch] When is BeginInvokeOnMainThread done?
</I>&gt;<i>
</I>&gt;<i> Don't know how that happened! Yes the quote should of course read:
</I>&gt;<i>
</I>&gt;<i> /&quot;*InvokeOnMainThread* will suspend the execution of your thread, and 
</I>&gt;<i> wait for the delegate to be executed on the main thread. When that 
</I>&gt;<i> completes, the thread resumes execution.&quot;/
</I>&gt;<i>
</I>&gt;<i> Seems this is the solution to the OP's question? Mojo can you confirm?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Chris
</I>&gt;<i>
</I>&gt;<i> On 06/04/12 14:17, Alan wrote:
</I>&gt;<i>
</I>&gt;<i> Hey,
</I>&gt;<i>
</I>&gt;<i> You misquoted the site. &quot;InvokeOnMainThread&quot; blocks execution until 
</I>&gt;<i> the delegate is invoked. *Begin*InvokeOnMainThread does not.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Alan
</I>&gt;<i>
</I>&gt;<i> On 6 April 2012 13:45, Chris Hatton &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">christopherhattonuk at gmail.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">christopherhattonuk at gmail.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> Wouldn't plain 'InvokeOnMainThread' do what you are looking for?
</I>&gt;<i>
</I>&gt;<i> From the Wiki at: <A HREF="http://wiki.ios.xamarin.com/HowTo/Threading">http://wiki.ios.xamarin.com/HowTo/Threading</A>
</I>&gt;<i>
</I>&gt;<i> /&quot;BeginInvokeOnMainThread will suspend the execution of your thread, 
</I>&gt;<i> and wait for the delegate to be executed on the main thread. When that 
</I>&gt;<i> completes, the thread resumes execution.&quot;/
</I>&gt;<i>
</I>&gt;<i> - Chris
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 06/04/12 07:00, Ren&#233; Ruppert wrote:
</I>&gt;<i>
</I>&gt;<i> I would opt for Task and ContinueWith(). It's an awesome way of 
</I>&gt;<i> dealing with such situations.
</I>&gt;<i>
</I>&gt;<i> All locking, WaitHandles or Sleep calls can block the UI thread on 
</I>&gt;<i> iPhone and cause very weird behavior or lockups.
</I>&gt;<i>
</I>&gt;<i> Gr&#252;&#223;e, Ren&#233;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Am 05.04.2012 um 23:34 schrieb Rodrigo Kumpera &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">kumpera at xamarin.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">kumpera at xamarin.com</A>&gt;&gt;:
</I>&gt;<i>
</I>&gt;<i>     You really can't do it without manually waiting for it.
</I>&gt;<i>
</I>&gt;<i>     What you can do is:
</I>&gt;<i>
</I>&gt;<i>     object obj = new object ();
</I>&gt;<i>
</I>&gt;<i>     BeginInvokeOnMainThread (delegate {
</I>&gt;<i>
</I>&gt;<i>      //Do something
</I>&gt;<i>
</I>&gt;<i>      lock (obj) { Monitor.Notify (obj); }
</I>&gt;<i>
</I>&gt;<i>     });
</I>&gt;<i>
</I>&gt;<i>     Thread.Sleep (2000);
</I>&gt;<i>
</I>&gt;<i>     lock (obk) { Monitor.Wait (obj); }
</I>&gt;<i>
</I>&gt;<i>     Ideally we would provide wrappers for common idioms of the .NET
</I>&gt;<i>     plataform like making the
</I>&gt;<i>
</I>&gt;<i>     function return an IAsyncResult or Task object.
</I>&gt;<i>
</I>&gt;<i>     On Thu, Apr 5, 2012 at 6:13 PM, MojoDK &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">mrj at fpr.dk</A>
</I>&gt;<i>     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">mrj at fpr.dk</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     Hi,
</I>&gt;<i>
</I>&gt;<i>     In this code...
</I>&gt;<i>
</I>&gt;<i>     ThreadPool.QueueUserWorkItem (delegate {
</I>&gt;<i>        BeginInvokeOnMainThread (delegate {
</I>&gt;<i>            // Do something
</I>&gt;<i>        });
</I>&gt;<i>        Thread.Sleep(2000);
</I>&gt;<i>        // Check something
</I>&gt;<i>     });
</I>&gt;<i>
</I>&gt;<i>     ... how can I make sure the &quot;// Do something&quot; is completely done
</I>&gt;<i>     before
</I>&gt;<i>     &quot;//Check something&quot;?
</I>&gt;<i>
</I>&gt;<i>     In other words, how can I check when BeginInvokeOnMainThread is
</I>&gt;<i>     done and
</I>&gt;<i>     then do some stuff still in the ThreadPool.QueueUserWorkItem?
</I>&gt;<i>
</I>&gt;<i>     Thanks!
</I>&gt;<i>     Mojo
</I>&gt;<i>
</I>&gt;<i>     --
</I>&gt;<i>     View this message in context:
</I>&gt;<i>     <A HREF="http://monotouch.2284126.n4.nabble.com/When-is-BeginInvokeOnMainThread-done-tp4536089p4536089.html">http://monotouch.2284126.n4.nabble.com/When-is-BeginInvokeOnMainThread-done-tp4536089p4536089.html</A>
</I>&gt;<i>     Sent from the MonoTouch mailing list archive at Nabble.com
</I>&gt;<i>     &lt;<A HREF="http://Nabble.com">http://Nabble.com</A>&gt;.
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     MonoTouch mailing list
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     MonoTouch mailing list
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>  &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&gt;
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&gt;
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120406/a4fd3b8e/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120406/a4fd3b8e/attachment.html</A>&gt;
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009025.html">[MonoTouch] When is BeginInvokeOnMainThread done?
</A></li>
	<LI>Next message: <A HREF="009028.html">[MonoTouch] When is BeginInvokeOnMainThread done?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9027">[ date ]</a>
              <a href="thread.html#9027">[ thread ]</a>
              <a href="subject.html#9027">[ subject ]</a>
              <a href="author.html#9027">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
