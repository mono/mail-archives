<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] System.ServiceModel.ProtocolException for mac client on	lan
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20System.ServiceModel.ProtocolException%20for%20mac%20client%20on%0A%09lan&In-Reply-To=%3C4F7B8514.90700%40intranel.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008971.html">
   <LINK REL="Next"  HREF="008974.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] System.ServiceModel.ProtocolException for mac client on	lan</H1>
    <B>Felix Collins</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20System.ServiceModel.ProtocolException%20for%20mac%20client%20on%0A%09lan&In-Reply-To=%3C4F7B8514.90700%40intranel.com%3E"
       TITLE="[MonoTouch] System.ServiceModel.ProtocolException for mac client on	lan">felix at intranel.com
       </A><BR>
    <I>Tue Apr  3 23:17:40 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="008971.html">[MonoTouch] On wifi, 3G, 4G or nothing?
</A></li>
        <LI>Next message: <A HREF="008974.html">[MonoTouch] System.ServiceModel.ProtocolException for mac client on lan
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8973">[ date ]</a>
              <a href="thread.html#8973">[ thread ]</a>
              <a href="subject.html#8973">[ subject ]</a>
              <a href="author.html#8973">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm running a WCF service on windows 7 .net3.5 on ISS and accessing it with a variety of clients. Using basic http binding with no security. (I also tried custom binding with keepalive off but that made no difference.)  Each request is made with a new wcf client object which is then closed after the request responds.

I get an intermittent exception on the server (maybe 1 in 10 requests but not predictable) for requests coming from a Mac running Lion (on same subnet connected with a switch). Other configurations seem to be ok (see table below) . The implementation of the WCF client on mac and iOS is using Mono and MonoTouch WCF. The source code for the mono WCF client is the same actual files as compiled for the .net wcf client.

The message from the exception is &quot;The number of bytes available is inconsistent with the HTTP Content-Length header.  There may have been a network error or the client may be sending invalid requests.&quot;

I have checked this with wireshark and it is not true.  The Http headers (and soap payload) are identical for the requests that work and the ones that don't . The requests that fail get a ACK/RST instead of a soap response

Does anyone have any ideas what might be the problem here? Or further things to check? In the end this is really just a PITA for development which I can probably live with, but not knowing what the problem is makes me nervous.

*Client * 	*Routing * 	*WCF Server * 	*Result *
winxp console app 	same lan switch 	WCF service on same subnet 	okay - no exceptions
win7 console app 	localhost 	WCF service on same computer 	okay - no exceptions
Mac console app 	same lan switch 	WCF service on same subnet 	bad - ProtocolException thrown intermittently
Mac running iOS simulator app 	same lan switch 	WCF service on same subnet 	bad - ProtocolException thrown intermittently
Mac running iOS simulator app 	internet 	WCF service on remote subnet 	okay - no exceptions
Ipad running app under debug 	wifi to same lan 	WCF service on same subnet 	okay - no exceptions

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008971.html">[MonoTouch] On wifi, 3G, 4G or nothing?
</A></li>
	<LI>Next message: <A HREF="008974.html">[MonoTouch] System.ServiceModel.ProtocolException for mac client on lan
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8973">[ date ]</a>
              <a href="thread.html#8973">[ thread ]</a>
              <a href="subject.html#8973">[ subject ]</a>
              <a href="author.html#8973">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
