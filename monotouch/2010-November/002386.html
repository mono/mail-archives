<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Trouble binding with delegates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Trouble%20binding%20with%20delegates&In-Reply-To=AANLkTimR%3DYBHUD3XhbfcEOzuNiS1b4%2Bgsv4a-85vf03o%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002384.html">
   <LINK REL="Next"  HREF="002385.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Trouble binding with delegates</H1>
    <B>David Moles</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Trouble%20binding%20with%20delegates&In-Reply-To=AANLkTimR%3DYBHUD3XhbfcEOzuNiS1b4%2Bgsv4a-85vf03o%40mail.gmail.com"
       TITLE="[MonoTouch] Trouble binding with delegates">davidmoles at thegogame.com
       </A><BR>
    <I>Fri Nov 12 16:03:18 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002384.html">[MonoTouch] Trouble binding with delegates
</A></li>
        <LI>Next message: <A HREF="002385.html">[MonoTouch] Trouble binding with delegates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2386">[ date ]</a>
              <a href="thread.html#2386">[ thread ]</a>
              <a href="subject.html#2386">[ subject ]</a>
              <a href="author.html#2386">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Never mind, my bad, that was a typo -- forgot one of the -s in --noregistrar.

On Fri, Nov 12, 2010 at 12:57 PM, David Moles &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">davidmoles at thegogame.com</A>&gt; wrote:
&gt;<i> Possibly related to bug #552982? I tried adding -noregistrar to my
</I>&gt;<i> build arguments, per this forum discussion:
</I>&gt;<i> <A HREF="http://forums.monotouch.net/yaf_postst98_Linker-failure-when-using-btouch-generated-RedLaserdll.aspx">http://forums.monotouch.net/yaf_postst98_Linker-failure-when-using-btouch-generated-RedLaserdll.aspx</A>
</I>&gt;<i> -- but that was pure cargo cult on my part, and it didn't work: I got
</I>&gt;<i> &quot;Cannot bundle unregistered option &#8216;-o&#8217;&quot;.
</I>&gt;<i>
</I>&gt;<i> Here's the generated code, if anyone has any guesses. If someone could
</I>&gt;<i> even point me to some good docs on P/Invoke etc., that'd be good -- I
</I>&gt;<i> think I can follow what's going on in the generated code here, but I'm
</I>&gt;<i> at a loss to improve on it.
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;[Register(&quot;AVUtils&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160;public partial class AVUtils : NSObject {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;static IntPtr selDubAudioWithTrackOutputToHandleSuccessHandleFailure
</I>&gt;<i> = Selector.GetHandle
</I>&gt;<i> (&quot;dubAudio:withTrack:outputTo:handleSuccess:handleFailure:&quot;);
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;static IntPtr class_ptr = Class.GetHandle (&quot;AVUtils&quot;);
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;public override IntPtr ClassHandle { get { return class_ptr; } }
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;[Export (&quot;init&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;public AVUtils () : base (NSObjectFlag.Empty)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;{
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;IsDirectBinding = GetType ().Assembly ==
</I>&gt;<i> GoGame.iOS.AV.Messaging.this_assembly;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if (IsDirectBinding) {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Handle = MonoTouch.ObjCRuntime.Messaging.IntPtr_objc_msgSend
</I>&gt;<i> (this.Handle, Selector.Init);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;} else {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Handle = MonoTouch.ObjCRuntime.Messaging.IntPtr_objc_msgSendSuper
</I>&gt;<i> (this.SuperHandle, Selector.Init);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;[Export (&quot;initWithCoder:&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;public AVUtils (NSCoder coder) : base (NSObjectFlag.Empty)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;{
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;IsDirectBinding = GetType ().Assembly ==
</I>&gt;<i> GoGame.iOS.AV.Messaging.this_assembly;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if (IsDirectBinding) {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Handle = MonoTouch.ObjCRuntime.Messaging.IntPtr_objc_msgSend_IntPtr
</I>&gt;<i> (this.Handle, Selector.InitWithCoder, coder.Handle);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;} else {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Handle = MonoTouch.ObjCRuntime.Messaging.IntPtr_objc_msgSendSuper_IntPtr
</I>&gt;<i> (this.SuperHandle, Selector.InitWithCoder, coder.Handle);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;public AVUtils (NSObjectFlag t) : base (t) {}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;public AVUtils (IntPtr handle) : base (handle) {}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;[Export (&quot;dubAudio:withTrack:outputTo:handleSuccess:handleFailure:&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;public unsafe static void DubAudio (NSUrl videoUrl, NSUrl audioUrl,
</I>&gt;<i> NSUrl newUrl, Action handleSuccess, Action&lt;NSError&gt; handleFailure)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;{
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if (videoUrl == null)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;throw new ArgumentNullException (&quot;videoUrl&quot;);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if (audioUrl == null)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;throw new ArgumentNullException (&quot;audioUrl&quot;);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if (newUrl == null)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;throw new ArgumentNullException (&quot;newUrl&quot;);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if (handleSuccess == null)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;throw new ArgumentNullException (&quot;handleSuccess&quot;);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if (handleFailure == null)
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;throw new ArgumentNullException (&quot;handleFailure&quot;);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;BlockLiteral *block_ptr_handleSuccess;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;BlockLiteral block_handleSuccess;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_handleSuccess = new BlockLiteral ();
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_ptr_handleSuccess = &amp;block_handleSuccess;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_handleSuccess.SetupBlock (static_InnerHandleSuccess, handleSuccess);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;BlockLiteral *block_ptr_handleFailure;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;BlockLiteral block_handleFailure;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_handleFailure = new BlockLiteral ();
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_ptr_handleFailure = &amp;block_handleFailure;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_handleFailure.SetupBlock (static_InnerHandleFailure, handleFailure);
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;GoGame.iOS.AV.Messaging.void_objc_msgSend_IntPtr_IntPtr_IntPtr_IntPtr_IntPtr
</I>&gt;<i> (class_ptr, selDubAudioWithTrackOutputToHandleSuccessHandleFailure,
</I>&gt;<i> videoUrl.Handle, audioUrl.Handle, newUrl.Handle, (IntPtr)
</I>&gt;<i> block_ptr_handleSuccess, (IntPtr) block_ptr_handleFailure);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_ptr_handleSuccess-&gt;CleanupBlock ();
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;block_ptr_handleFailure-&gt;CleanupBlock ();
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;internal delegate void InnerHandleSuccess (IntPtr block);
</I>&gt;<i> &#160; &#160; &#160; &#160;static InnerHandleSuccess static_InnerHandleSuccess = new
</I>&gt;<i> InnerHandleSuccess (TrampolineHandleSuccess);
</I>&gt;<i> &#160; &#160; &#160; &#160;[MonoPInvokeCallback (typeof (InnerHandleSuccess))]
</I>&gt;<i> &#160; &#160; &#160; &#160;static unsafe void TrampolineHandleSuccess (IntPtr block) {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;var descriptor = (BlockLiteral *) block;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;var del = (Action) (descriptor-&gt;global_handle != IntPtr.Zero ?
</I>&gt;<i> GCHandle.FromIntPtr (descriptor-&gt;global_handle).Target :
</I>&gt;<i> GCHandle.FromIntPtr (descriptor-&gt;local_handle).Target);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;del ();
</I>&gt;<i> &#160; &#160; &#160; &#160;}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;internal delegate void InnerHandleFailure (IntPtr block, IntPtr err);
</I>&gt;<i> &#160; &#160; &#160; &#160;static InnerHandleFailure static_InnerHandleFailure = new
</I>&gt;<i> InnerHandleFailure (TrampolineHandleFailure);
</I>&gt;<i> &#160; &#160; &#160; &#160;[MonoPInvokeCallback (typeof (InnerHandleFailure))]
</I>&gt;<i> &#160; &#160; &#160; &#160;static unsafe void TrampolineHandleFailure (IntPtr block, IntPtr err) {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;var descriptor = (BlockLiteral *) block;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;var del = (Action&lt;NSError&gt;) (descriptor-&gt;global_handle !=
</I>&gt;<i> IntPtr.Zero ? GCHandle.FromIntPtr (descriptor-&gt;global_handle).Target :
</I>&gt;<i> GCHandle.FromIntPtr (descriptor-&gt;local_handle).Target);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;del ((MonoTouch.Foundation.NSError) Runtime.GetNSObject (err));
</I>&gt;<i> &#160; &#160; &#160; &#160;}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;} /* class AVUtils */
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> David Moles
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">davidmoles at thegogame.com</A>
</I>&gt;<i>
</I>


-- 
David Moles
<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">davidmoles at thegogame.com</A>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002384.html">[MonoTouch] Trouble binding with delegates
</A></li>
	<LI>Next message: <A HREF="002385.html">[MonoTouch] Trouble binding with delegates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2386">[ date ]</a>
              <a href="thread.html#2386">[ thread ]</a>
              <a href="subject.html#2386">[ subject ]</a>
              <a href="author.html#2386">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
