<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Custom UIImagePickerController overlay issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Custom%20UIImagePickerController%20overlay%20issue&In-Reply-To=AANLkTinFjDwuSjzQwBVf8248RFQCmrYGqXQLiYGtTkUQ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002338.html">
   <LINK REL="Next"  HREF="002342.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Custom UIImagePickerController overlay issue</H1>
    <B>bryan costanich</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Custom%20UIImagePickerController%20overlay%20issue&In-Reply-To=AANLkTinFjDwuSjzQwBVf8248RFQCmrYGqXQLiYGtTkUQ%40mail.gmail.com"
       TITLE="[MonoTouch] Custom UIImagePickerController overlay issue">b at wowzer.net
       </A><BR>
    <I>Thu Nov  4 20:42:15 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002338.html">[MonoTouch] Custom UIImagePickerController overlay issue
</A></li>
        <LI>Next message: <A HREF="002342.html">[MonoTouch] Bitmap.GetPixel equivalent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2339">[ date ]</a>
              <a href="thread.html#2339">[ thread ]</a>
              <a href="subject.html#2339">[ subject ]</a>
              <a href="author.html#2339">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yup, I wrote a little controller to display it, works just fine.

And yeah, I did the transform for that very reason.

Either way, when I view the view with a standard controller, it looks fine. I'd attach a screen shot but the mailing list would puke. :(

From: Mike Bluestein &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">mike.bluestein at gmail.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">mike.bluestein at gmail.com</A>&gt;&gt;
Date: Thu, 4 Nov 2010 20:34:37 -0400
To: bryan costanich &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">b at wowzer.net</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">b at wowzer.net</A>&gt;&gt;
Cc: MonoTouch MailingList &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>&gt;&gt;
Subject: Re: [MonoTouch] Custom UIImagePickerController overlay issue

Hmm, that's interesting.

Have you tried rendering the view on its own, outside of the UIImagePickerController?

The transform you have in Draw is what you usually use to draw into a bitmap or pdf backed context to compensate for the origin being in the lower left in those cases. Unless I'm missing something in looking at the code, I don't think you need that here. Could that be the problem?

On Thu, Nov 4, 2010 at 7:05 PM, bryan costanich &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">b at wowzer.net</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">b at wowzer.net</A>&gt;&gt; wrote:
Gotcha.

Interestingly enough, it works with a label that isn't a class var:

UILabel overlay = new UILabel (new System.Drawing.RectangleF (20, 100, 200, 30));
overlay.Text = &quot;This is an overlay&quot;;
this._imagePicker.CameraOverlayView = overlay;

So I wonder if there's something about the graphic context, because this is the view that I'm throwing up on  it, it created a context and draws some stars:

public class CameraOverlayView : UIView
{
//========================================================================
#region -= constructors =-

//========================================================================
public CameraOverlayView () : base()
{
}
//========================================================================

#endregion
//========================================================================
/// &lt;summary&gt;
/// rect changes depending on if the whole view is being redrawn, or just a section
/// &lt;/summary&gt;
/// &lt;param name=&quot;rect&quot;&gt;
/// A &lt;see cref=&quot;RectangleF&quot;/&gt;
/// &lt;/param&gt;
public override void Draw (RectangleF rect)
{
Console.WriteLine (&quot;Draw() Called&quot;);
base.Draw (rect);
//---- get a reference to the context
using (CGContext context = UIGraphics.GetCurrentContext ())
{
//---- convert to View space
CGAffineTransform affineTransform = CGAffineTransform.MakeIdentity ();
//---- invert the y axis
affineTransform.Scale (1, -1);
//---- move the y axis up
affineTransform.Translate (0, this.Frame.Height);
context.ConcatCTM (affineTransform);
//---- draw some stars
this.DrawStars(context);
}
}
protected void DrawStars(CGContext context)
{
context.SetRGBFillColor (1f, 0f, 0f, 1f);

// save state so that as we translate (move the origin around,
// it goes back to normal when we restore)
context.SetRGBFillColor (0f, 0f, 0.329f, 1.0f);
context.SaveState ();
context.TranslateCTM (30, 300);
this.DrawStar(context, 30);
context.RestoreState();

context.SetRGBFillColor (1f, 0f, 0f, 1f);
context.SaveState ();
context.TranslateCTM (120, 200);
this.DrawStar(context, 30);
context.RestoreState();

}
/// &lt;summary&gt;
/// Draws a star at the bottom left of the context of the specified diameter
/// &lt;/summary&gt;
protected void DrawStar (CGContext context, float starDiameter)
{
//---- declare vars
// 144&#186;
float theta = 2 * (float)Math.PI * (2f / 5f);
float radius = starDiameter / 2;
//---- move up and over
context.TranslateCTM (starDiameter / 2, starDiameter / 2);
context.MoveTo (0, radius);
for (int i = 1; i &lt; 5; i++)
{
context.AddLineToPoint (radius * (float)Math.Sin (i * theta), radius * (float)Math.Cos (i * theta));
}
//context.SetRGBFillColor (1, 1, 1, 1);
context.ClosePath ();
context.FillPath ();
}

}



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20101104/57c6d11a/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20101104/57c6d11a/attachment-0001.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002338.html">[MonoTouch] Custom UIImagePickerController overlay issue
</A></li>
	<LI>Next message: <A HREF="002342.html">[MonoTouch] Bitmap.GetPixel equivalent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2339">[ date ]</a>
              <a href="thread.html#2339">[ thread ]</a>
              <a href="subject.html#2339">[ subject ]</a>
              <a href="author.html#2339">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
