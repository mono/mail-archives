<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Image In Cell Can Leak Memory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Image%20In%20Cell%20Can%20Leak%20Memory&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002198.html">
   <LINK REL="Next"  HREF="002188.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Image In Cell Can Leak Memory</H1>
    <B>Tim Scott</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Image%20In%20Cell%20Can%20Leak%20Memory&In-Reply-To="
       TITLE="[MonoTouch] Image In Cell Can Leak Memory">tscott at lunaversesoftware.com
       </A><BR>
    <I>Tue Sep 14 11:44:14 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002198.html">[MonoTouch] Anyone use GKAchievement.ReportAchievement in	GameKit sdk?
</A></li>
        <LI>Next message: <A HREF="002188.html">[MonoTouch] Image In Cell Can Leak Memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2182">[ date ]</a>
              <a href="thread.html#2182">[ thread ]</a>
              <a href="subject.html#2182">[ subject ]</a>
              <a href="author.html#2182">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I just learned something that I thought I would share.  Did you know that
this will leak memory?

public class MyCell : UITableViewCell
{
    UImageView myImageView;

    public MyCell () : base(UITableViewCellStyle.Default, &#179;myCell&#178;)
    {
        ...
        myImageView = new UIImageView(someRectF);
        myImageView.Image = UiImage.FromFile(&#179;Images/myimage.png&#178;);
    }
    ...
}

It makes sense that this image is duplicated in memory for each cell.
That&#185;s bad enough.  The bigger problem, it seems,  is that these images do
not get disposed when the table controller is popped.  If you push and pop
this controller enough times with enough cells, you will run out of memory.

I solved it like this:

public static class Images
{
    static Images ()
    {
        MyImage = UIImage.FromFile (&quot;Images/ myimage.png&quot;);
    }

    public static UIImage MyImage { get; private set; }
}

Then in the ctor of the cell:

myImageView.Image = Images .MyImage;

Comments???
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20100914/7ae1da13/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20100914/7ae1da13/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002198.html">[MonoTouch] Anyone use GKAchievement.ReportAchievement in	GameKit sdk?
</A></li>
	<LI>Next message: <A HREF="002188.html">[MonoTouch] Image In Cell Can Leak Memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2182">[ date ]</a>
              <a href="thread.html#2182">[ thread ]</a>
              <a href="subject.html#2182">[ subject ]</a>
              <a href="author.html#2182">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
