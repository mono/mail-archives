<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] 2 Threading Questions ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%202%20Threading%20Questions%20...&In-Reply-To=017101cc9b0f%24f24a44b0%24d6dece10%24%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006400.html">
   <LINK REL="Next"  HREF="006435.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] 2 Threading Questions ...</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%202%20Threading%20Questions%20...&In-Reply-To=017101cc9b0f%24f24a44b0%24d6dece10%24%40gmail.com"
       TITLE="[MonoTouch] 2 Threading Questions ...">rolf at xamarin.com
       </A><BR>
    <I>Fri Nov  4 18:32:12 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006400.html">[MonoTouch] 2 Threading Questions ...
</A></li>
        <LI>Next message: <A HREF="006435.html">[MonoTouch] 2 Threading Questions ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6431">[ date ]</a>
              <a href="thread.html#6431">[ thread ]</a>
              <a href="subject.html#6431">[ subject ]</a>
              <a href="author.html#6431">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Thread.Abort is really an evil thing that you should avoid at pretty
much all costs. It has serious implications and unexpected pitfalls
(it will not abort if you're in native code for instance), and we
really recommend not using it.

Rolf

On Fri, Nov 4, 2011 at 5:36 PM, Ren&#233; Ruppert
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">rene.ruppert at googlemail.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> you should use System.Threading.ThreadPool instead:
</I>&gt;<i> <A HREF="http://docs.xamarin.com/ios/advanced_topics/threading">http://docs.xamarin.com/ios/advanced_topics/threading</A>
</I>&gt;<i> The main advantage: the threads are managed in a pool (who would have
</I>&gt;<i> guessed?) and you don't need to worry about creating an auto release pool.
</I>&gt;<i> Apart from that, your current code looks okay but you don't need all those
</I>&gt;<i> Export() attributes, do you?
</I>&gt;<i> If you want to end a long running thread, you can either Abort() it or
</I>&gt;<i> Interrupt() it (read about the difference on MSDN). If you abort you might
</I>&gt;<i> create leaks or other unwanted situations as your code execution stops right
</I>&gt;<i> where it is.
</I>&gt;<i> Starting with .Net 3 I think Thread.Abort() no longer interrupts finally
</I>&gt;<i> blocks, so Abort() is not that evil anymore. I am not sure if a constructor
</I>&gt;<i> is considered a safe block. Microsoft is unclear about it and I don't know
</I>&gt;<i> how it is handled in MONO and if something like &quot;var a = new A();&quot; can fail
</I>&gt;<i> at the &quot;=&quot; sign.
</I>&gt;<i> The safer way is to set a bool (if you only have one thread writing to it)
</I>&gt;<i> or use an AutoResetEvent and set it if you want to abort. Your thread then
</I>&gt;<i> has to check regularly if the flag is set and has to exit ASAP.
</I>&gt;<i>
</I>&gt;<i> If your target is to check for internet connectivity, you could also have a
</I>&gt;<i> look at Miguel's Reachability class:
</I>&gt;<i> <A HREF="https://github.com/xamarin/monotouch-samples/blob/master/ReachabilitySample/">https://github.com/xamarin/monotouch-samples/blob/master/ReachabilitySample/</A>
</I>&gt;<i> reachability.cs
</I>&gt;<i> With that you can even get notified if &#160;connectivity changes.
</I>&gt;<i>
</I>&gt;<i> Ren&#233;
</I>&gt;<i>
</I>&gt;<i> -----Urspr&#252;ngliche Nachricht-----
</I>&gt;<i> Von: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>
</I>&gt;<i> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch-bounces at lists.ximian.com</A>] Im Auftrag von simarx
</I>&gt;<i> Gesendet: Freitag, 4. November 2011 15:56
</I>&gt;<i> An: <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">monotouch at lists.ximian.com</A>
</I>&gt;<i> Betreff: [MonoTouch] 2 Threading Questions ...
</I>&gt;<i>
</I>&gt;<i> Hi - I have the following code that kicks of a new thread (the thread is
</I>&gt;<i> designed to check for internet reachability) and at the end check I want it
</I>&gt;<i> to call a method on the main UI thread. Two questions really...
</I>&gt;<i>
</I>&gt;<i> 1. Is the code safe from memory-leaks, in particular the way my &quot;EndCheck&quot;
</I>&gt;<i> method is called from within the thread?
</I>&gt;<i>
</I>&gt;<i> 2. If during the process I wish to terminate the busy new thread, how can I
</I>&gt;<i> safely do that?
</I>&gt;<i>
</I>&gt;<i> -----------
</I>&gt;<i>
</I>&gt;<i> public void InternetCheckShowBusyView(string sMessage) {
</I>&gt;<i> &#160; &#160; &#160; &#160;Thread thread = new System.Threading.Thread(DoCheckInternet as
</I>&gt;<i> ThreadStart);
</I>&gt;<i> &#160; &#160; &#160; &#160;thread.Start();
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> [Export(&quot;DoCheckInternet&quot;)]
</I>&gt;<i> void DoCheckInternet()
</I>&gt;<i> {
</I>&gt;<i> &#160; &#160; &#160; &#160;using (var pool = new NSAutoreleasePool())
</I>&gt;<i> &#160; &#160; &#160; &#160;{
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;bool bResult = MyInternetCheckMethod();
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;InvokeOnMainThread(EndCheck);
</I>&gt;<i> &#160; &#160; &#160; &#160;}
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> [Export(&quot;EndCheck&quot;)]
</I>&gt;<i> void EndCheck()
</I>&gt;<i> {
</I>&gt;<i> &#160; &#160; &#160; &#160;// Do whatever I want...
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://monotouch.2284126.n4.nabble.com/2-Threading-Questions-tp3990347p39903">http://monotouch.2284126.n4.nabble.com/2-Threading-Questions-tp3990347p39903</A>
</I>&gt;<i> 47.html
</I>&gt;<i> Sent from the MonoTouch mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I></PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006400.html">[MonoTouch] 2 Threading Questions ...
</A></li>
	<LI>Next message: <A HREF="006435.html">[MonoTouch] 2 Threading Questions ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6431">[ date ]</a>
              <a href="thread.html#6431">[ thread ]</a>
              <a href="subject.html#6431">[ subject ]</a>
              <a href="author.html#6431">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
