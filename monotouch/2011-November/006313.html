<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Proper UIViewController/UIView handeling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Proper%20UIViewController/UIView%20handeling&In-Reply-To=CACiCqskzDLSV0FEKpvpgCBsSjGvFwEXQb-n49XspUdDEZUU3NQ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006309.html">
   <LINK REL="Next"  HREF="006465.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Proper UIViewController/UIView handeling</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Proper%20UIViewController/UIView%20handeling&In-Reply-To=CACiCqskzDLSV0FEKpvpgCBsSjGvFwEXQb-n49XspUdDEZUU3NQ%40mail.gmail.com"
       TITLE="[MonoTouch] Proper UIViewController/UIView handeling">robertj at gmx.net
       </A><BR>
    <I>Wed Nov  2 04:51:02 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006309.html">[MonoTouch] Proper UIViewController/UIView handeling
</A></li>
        <LI>Next message: <A HREF="006465.html">[MonoTouch] Best of breed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6313">[ date ]</a>
              <a href="thread.html#6313">[ thread ]</a>
              <a href="subject.html#6313">[ subject ]</a>
              <a href="author.html#6313">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02.11.2011 09:05, Ivan Nikitin wrote:
&gt;&gt;<i> The test code from my previous post is run as described. I understand that
</I>&gt;<i> the delegate { } call will cause by view controller to be referenced; this
</I>&gt;<i> is desired. Even though my VC is referenced I expect that the view, which
</I>&gt;<i> my WeakReference is targeting, should be removed at some point.
</I>&gt;<i>
</I>&gt;<i> That's the problem. You confused C# runtime and iOS SDK. WeakReference and
</I>&gt;<i> hard references are C# objects. iOS knows nothing if it is a hard reference
</I>&gt;<i> or a weak reference - it lives its own life. WeakReference tells GC it can
</I>&gt;<i> collect this object if there are no other hard references to it. Since
</I>&gt;<i> there is one (delegate), this will never happen.
</I>
That's not the real issue. When an ObjC property like &quot;View&quot;
is accessed, MonoTouch will store its .NET representation in a
backer field of the controller:

object viewBacker;
UIView View {
     get {
         viewBacker = get_objc_object(...);
         return (UIView) viewBacker;
     }
}

This means that a WeakReference taken from &quot;controller.View&quot;
will remain alive as long as the controller isn't GCed, or
until &quot;controller.View&quot; is invoked again and its value has
actually changed.

If you don't poll controller.View periodically you won't be
able to detect when it's set to null by Cocoa. But in this
case ViewDidUnload will be called anyway. However, this happens
only in emergency cases, so you can't rely on it.

Robert

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006309.html">[MonoTouch] Proper UIViewController/UIView handeling
</A></li>
	<LI>Next message: <A HREF="006465.html">[MonoTouch] Best of breed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6313">[ date ]</a>
              <a href="thread.html#6313">[ thread ]</a>
              <a href="subject.html#6313">[ subject ]</a>
              <a href="author.html#6313">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
