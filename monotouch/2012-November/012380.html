<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] How to generate Reports through Monotouch on IPAD
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20How%20to%20generate%20Reports%20through%20Monotouch%20on%20IPAD&In-Reply-To=%3CC561F4EE-EE8C-4EED-ABE0-90BC505A0E6F%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012370.html">
   <LINK REL="Next"  HREF="012329.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] How to generate Reports through Monotouch on IPAD</H1>
    <B>Alex White</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20How%20to%20generate%20Reports%20through%20Monotouch%20on%20IPAD&In-Reply-To=%3CC561F4EE-EE8C-4EED-ABE0-90BC505A0E6F%40gmail.com%3E"
       TITLE="[MonoTouch] How to generate Reports through Monotouch on IPAD">alexwhite68 at gmail.com
       </A><BR>
    <I>Wed Nov  7 11:13:48 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012370.html">[MonoTouch] How to generate Reports through Monotouch on IPAD
</A></li>
        <LI>Next message: <A HREF="012329.html">[MonoTouch] Bindings for MapBox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12380">[ date ]</a>
              <a href="thread.html#12380">[ thread ]</a>
              <a href="subject.html#12380">[ subject ]</a>
              <a href="author.html#12380">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have used monotouch to code my reports, it works very well and it is quick, I use the uiwebview to show the reports.

Sorry about the untidy (still work in progress) code but here is some code that I have written, hopefully it should help.

		public class cls_pdf_reports : IDisposable {

		// need to setup all the colours here, normal alternate etc.

		private UIColor			foreColour 		= UIColor.Black;
		private UIColor 		altForeColour 	= UIColor.FromRGB(4,0,143);
		private UIColor 		bikeNotesColour	= UIColor.Red;
		private float 			PdfWidth 		= 595; // standard width of A4
		private float 			PdfHeight 		= 841; // standard height of A4
		private float 			PdfCentreWidth 	= 595/2;
		private int   			CurrentPage 	= 0;
		private int   			CurrentPos 		= 0;
		private int   			MaxPos 			= 760; // max position down the page before starting a new page

		public cls_pdf_reports (){ }

		void IDisposable.Dispose ()
		{
			if (foreColour != null) {
				foreColour.Dispose ();
				foreColour = null;
			}
			if (altForeColour != null) {
				altForeColour.Dispose ();
				altForeColour = null;
			}
			if (bikeNotesColour != null) {
				bikeNotesColour.Dispose ();
				bikeNotesColour = null;
			}
		}

		// report generators

		public void generateBikeListSmall(string pdfDocument, long pRevision_Set) {
			string fullPdfName = &quot;&quot;;
			string pointName = &quot;&quot;;
			string roadStreet = &quot;&quot;;
			bool alternateColour = false;
			StringBuilder sql = new StringBuilder();
			fullPdfName	=Path.Combine(Environment.GetFolderPath (Environment.SpecialFolder.MyDocuments),pdfDocument);
			if (File.Exists(fullPdfName) == true) {
				File.Delete(fullPdfName);
			}
			RectangleF canvasRect =  new RectangleF(0, 0, PdfWidth, PdfHeight);
    		CGPDFInfo info = new CGPDFInfo();
    		info.AllowsPrinting = true;
    		UIGraphics.BeginPDFContext (fullPdfName, canvasRect, info);
			UIGraphics.BeginPDFPage ();
			CurrentPage++;
			CGContext gctx = UIGraphics.GetCurrentContext ();
			gctx.ScaleCTM (1, -1);
			gctx.TranslateCTM (0, -25f);
			alignLeft(gctx,&quot;Produced. &quot; + DateTime.Now.ToLongDateString(),&quot;Helvetica&quot;, 6, 20, 0, false, UIColor.Black); 
			alignCentre(gctx, &quot;WizAnn Bike List&quot;,&quot;Times New Roman&quot;, 20, PdfCentreWidth, 5, false, UIColor.Black);
			UIImage image = UIImage.FromFile(@&quot;Logos/wizann512.png&quot;);
			RectangleF imageRect = new RectangleF(595-78, -50,60,60);
			if (Core.Instance.showLogoPdf == true) {
				gctx.DrawImage(imageRect, image.CGImage);
			}
            sql.Append(&quot;select tblpoints.ppoint, tblpoints.road_street_no, tblpoints.bike_notes, tblpoints.list_run, &quot;);
            sql.Append(&quot;tblpoints.road_street, tblpoints.postcode, tblpoints.times_asked, tblpoints.street_view_link, &quot;);
            sql.Append(&quot;tblpoints.point_name, tblpoints.pstatus_type, tblpoint_status.status_description, &quot;);
            sql.Append(&quot;tblrevision_set_point.score &quot;);
            sql.Append(&quot;from tblrevision_set_point left outer join &quot;);
            sql.Append(&quot;tblpoints on tblpoints.ppoint = tblrevision_set_point.ppoint left outer join &quot;);
            sql.Append(&quot;tblpoint_status on tblpoint_status.pstatus_type = tblpoints.pstatus_type &quot;);
            sql.Append(&quot;where (tblrevision_set_point.prevision_set=&quot; + pRevision_Set.ToString() + &quot;) &quot;);
            sql.Append(&quot;order by tblrevision_set_point.list_order, tblrevision_set_point.prevision_ppoint &quot;);
			// need to draw the header fields and a line across the page
			CurrentPos = 55;
			alignLeft(gctx, &quot;Point Name&quot;,&quot;Helvetica&quot;, 12, 20, CurrentPos, true, UIColor.Black);
			alignLeft(gctx, &quot;Road&quot;,&quot;Helvetica&quot;, 12, 280, CurrentPos, true, UIColor.Black);
			alignRight(gctx, &quot;Run/List&quot;,&quot;Helvetica&quot;, 12, 470, CurrentPos, true, UIColor.Black);
			alignRight(gctx, &quot;P/C&quot;,&quot;Helvetica&quot;, 12, 500, CurrentPos, true, UIColor.Black);
			alignRight(gctx, &quot;T/A&quot;,&quot;Helvetica&quot;, 12, 540, CurrentPos, true, UIColor.Black);
			alignRight(gctx, &quot;Id&quot;,&quot;Helvetica&quot;, 12, 570, CurrentPos, true, UIColor.Black);
			CurrentPos+=14;
			// TODO try/catch
			using (WizPR.cls_db mydb = new WizPR.cls_db()) {
				using (SqliteDataReader bikeList = mydb.OpenTable(sql.ToString())) {
					while (bikeList.Read() == true) {
						pointName = &quot;&quot;;
						roadStreet = &quot;&quot;;
						pointName = bikeList[&quot;point_name&quot;].ToString();
						roadStreet = bikeList[&quot;road_street&quot;].ToString();
						if (pointName.Length &gt; 60) {
							pointName = pointName.Substring(0,60);
						}
						if (roadStreet.Length &gt; 22) {
							roadStreet = roadStreet.Substring(0,22);
						}
						if (CurrentPos &gt;= MaxPos) {
							UIGraphics.BeginPDFPage ();
							CurrentPage++;
							gctx.ScaleCTM (1, -1);
							gctx.TranslateCTM (0, -25f);
							gctx.ShowTextAtPoint(0,0,&quot;&quot;,0);
							alignLeft(gctx,&quot;Produced. &quot; + DateTime.Now.ToLongDateString(),&quot;Helvetica&quot;, 6, 20, 0, false, UIColor.Black); 
							alignCentre(gctx, &quot;WizAnn Bike List&quot;,&quot;Times New Roman&quot;, 20, PdfCentreWidth, 5, false, UIColor.Black);
							if (Core.Instance.showLogoPdf == true) {
								gctx.DrawImage(imageRect, image.CGImage);
							}
							CurrentPos = 55;
							alignLeft(gctx, &quot;Point Name&quot;,&quot;Helvetica&quot;, 12, 20, CurrentPos, true, UIColor.Black);
							alignLeft(gctx, &quot;Road&quot;,&quot;Helvetica&quot;, 12, 280, CurrentPos, true, UIColor.Black);
							alignRight(gctx, &quot;Run/List&quot;,&quot;Helvetica&quot;, 12, 470, CurrentPos, true, UIColor.Black);
							alignRight(gctx, &quot;P/C&quot;,&quot;Helvetica&quot;, 12, 500, CurrentPos, true, UIColor.Black);
							alignRight(gctx, &quot;T/A&quot;,&quot;Helvetica&quot;, 12, 540, CurrentPos, true, UIColor.Black);
							alignRight(gctx, &quot;Id&quot;,&quot;Helvetica&quot;, 12, 570, CurrentPos, true, UIColor.Black);
							CurrentPos+=14;
						}
						if (Core.Instance.colourPdf == true) {
							if (alternateColour == false){
								alignLeft(gctx, pointName,&quot;Helvetica&quot;, 10, 20, CurrentPos, false, foreColour);
								alignLeft(gctx, roadStreet,&quot;Helvetica&quot;, 10, 280, CurrentPos, false, foreColour);
								alignRight(gctx, bikeList[&quot;list_run&quot;].ToString(),&quot;Helvetica&quot;, 9, 470, CurrentPos, false, foreColour);
								alignRight(gctx, bikeList[&quot;postcode&quot;].ToString(),&quot;Helvetica&quot;, 9, 500, CurrentPos, false, foreColour);
								alignRight(gctx, bikeList[&quot;times_asked&quot;].ToString(),&quot;Helvetica&quot;, 9, 540, CurrentPos, false, foreColour);
								alignRight(gctx, bikeList[&quot;ppoint&quot;].ToString(),&quot;Helvetica&quot;, 9, 570, CurrentPos, false, foreColour);
								if (bikeList[&quot;bike_notes&quot;].ToString() != &quot;&quot;) {
									CurrentPos+=11;
									alignLeft(gctx, bikeList[&quot;bike_notes&quot;].ToString(),&quot;Helvetica&quot;, 9, 20, CurrentPos, false, bikeNotesColour);
								}
								alternateColour =! alternateColour;
							}  else {
								alignLeft(gctx, pointName,&quot;Helvetica&quot;, 10, 20, CurrentPos, false, altForeColour);
								alignLeft(gctx, roadStreet,&quot;Helvetica&quot;, 10, 280, CurrentPos, false, altForeColour);
								alignRight(gctx, bikeList[&quot;list_run&quot;].ToString(),&quot;Helvetica&quot;, 9, 470, CurrentPos, false, altForeColour);
								alignRight(gctx, bikeList[&quot;postcode&quot;].ToString(),&quot;Helvetica&quot;, 9, 500, CurrentPos, false, altForeColour);
								alignRight(gctx, bikeList[&quot;times_asked&quot;].ToString(),&quot;Helvetica&quot;, 9, 540, CurrentPos, false, altForeColour);
								alignRight(gctx, bikeList[&quot;ppoint&quot;].ToString(),&quot;Helvetica&quot;, 9, 570, CurrentPos, false, altForeColour);
								if (bikeList[&quot;bike_notes&quot;].ToString() != &quot;&quot;) {
									CurrentPos+=11;
									alignLeft(gctx, bikeList[&quot;bike_notes&quot;].ToString(),&quot;Helvetica&quot;, 9, 20, CurrentPos, false, bikeNotesColour);
								}
								alternateColour =! alternateColour;
							}
							CurrentPos+=14;
						}  else {
							alignLeft(gctx, pointName,&quot;Helvetica&quot;, 10, 20, CurrentPos, false, foreColour);
							alignLeft(gctx, roadStreet,&quot;Helvetica&quot;, 10, 280, CurrentPos, false, foreColour);
							alignRight(gctx, bikeList[&quot;list_run&quot;].ToString(),&quot;Helvetica&quot;, 9, 470, CurrentPos, false, foreColour);
							alignRight(gctx, bikeList[&quot;postcode&quot;].ToString(),&quot;Helvetica&quot;, 9, 500, CurrentPos, false, foreColour);
							alignRight(gctx, bikeList[&quot;times_asked&quot;].ToString(),&quot;Helvetica&quot;, 9, 540, CurrentPos, false, foreColour);
							alignRight(gctx, bikeList[&quot;ppoint&quot;].ToString(),&quot;Helvetica&quot;, 9, 570, CurrentPos, false, foreColour);
							if (bikeList[&quot;bike_notes&quot;].ToString() != &quot;&quot;) {
								CurrentPos+=11;
								alignLeft(gctx, bikeList[&quot;bike_notes&quot;].ToString(),&quot;Helvetica&quot;, 9, 20, CurrentPos, false, foreColour);
							}
							CurrentPos+=14;
						}
					}
				}
			}
			UIGraphics.EndPDFContent ();
		}




		// member functions for text alignment
		public void alignCentre (CGContext gctx, string text, string fontName, float fontSize, float X, float Y, bool Bold, UIColor textColour)
		{
			if (Bold == true) {
				gctx.SelectFont (fontName + &quot;-Bold&quot;, fontSize, CGTextEncoding.MacRoman);
			}  else {
				gctx.SelectFont (fontName, fontSize, CGTextEncoding.MacRoman);
			}
			gctx.SetTextDrawingMode(CGTextDrawingMode.Invisible);
			gctx.ShowTextAtPoint(X, Y, text, text.Length);
			float start = gctx.TextPosition.X;
			gctx.SetFillColor(textColour.CGColor);
			gctx.SetTextDrawingMode(CGTextDrawingMode.Fill);
			gctx.ShowTextAtPoint( X-(start-X)/2, (0-(Y+5)), text, text.Length);
		}
		public void alignRight (CGContext gctx, string text, string fontName, float fontSize, float X, float Y, bool Bold, UIColor textColour)
		{
			string strippedText = text.Trim ();
			gctx.SetTextDrawingMode (CGTextDrawingMode.Invisible);
			gctx.ShowTextAtPoint (X, Y, &quot;&quot;, 0);
			PointF origPoint = gctx.TextPosition;
			if (Bold == true) {
				gctx.SelectFont (fontName + &quot;-Bold&quot;, fontSize, CGTextEncoding.MacRoman);
			}  else {
				gctx.SelectFont (fontName, fontSize, CGTextEncoding.MacRoman);
			}
			gctx.ShowTextAtPoint(origPoint.X, origPoint.Y, strippedText, strippedText.Length);
			PointF newPoint = gctx.TextPosition;
			float textWidthX = newPoint.X - origPoint.X;
			gctx.SetFillColor(textColour.CGColor);
			gctx.SetTextDrawingMode(CGTextDrawingMode.Fill);
			gctx.ShowTextAtPoint(origPoint.X - textWidthX, (0-(Y+5)), strippedText, strippedText.Length);
		}
		public void alignLeft (CGContext gctx, string text, string fontName, float fontSize, float X, float Y, bool Bold, UIColor textColour)
		{
			if (Bold == true) {
				gctx.SelectFont (fontName + &quot;-Bold&quot;, fontSize, CGTextEncoding.MacRoman);
			}  else {
				gctx.SelectFont (fontName, fontSize, CGTextEncoding.MacRoman);
			}
			gctx.SetFillColor(textColour.CGColor);
			gctx.SetTextDrawingMode(CGTextDrawingMode.Fill);
			gctx.ShowTextAtPoint(X, (0-(Y+5)), text, text.Length);
		}
	}



On 7 Nov 2012, at 10:56, Nic Wise &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">nicw at fastchicken.co.nz</A>&gt; wrote:

&gt;<i> Well, once you have a PDF, it's fairly easy to display (thats built in).
</I>&gt;<i> 
</I>&gt;<i> HTML might be easiest, tho. What requirements for reporting do you
</I>&gt;<i> have? Can you work it into the UI somehow?
</I>&gt;<i> 
</I>&gt;<i> For example, you could argue that all of Earnest (
</I>&gt;<i> <A HREF="http://www.earnestapp.com/">http://www.earnestapp.com/</A>  - MonoTouch inside :) ) is _all_
</I>&gt;<i> reporting, tho there is a plan to add some more reporting to it. But
</I>&gt;<i> it's worked into the UI - the user wouldn't call it reporting in the
</I>&gt;<i> normal sense.
</I>&gt;<i> 
</I>&gt;<i> On Tue, Nov 6, 2012 at 9:14 AM, sama446 &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">sudhiipreddi at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> So is there any other substitute method like using a PDF in efficient manner,
</I>&gt;&gt;<i> just to reduce the need of reports??
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> View this message in context: <A HREF="http://monotouch.2284126.n4.nabble.com/How-to-generate-Reports-through-Monotouch-on-IPAD-tp4657587p4657626.html">http://monotouch.2284126.n4.nabble.com/How-to-generate-Reports-through-Monotouch-on-IPAD-tp4657587p4657626.html</A>
</I>&gt;&gt;<i> Sent from the MonoTouch mailing list archive at Nabble.com.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> MonoTouch mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Nic Wise
</I>&gt;<i> t.  +44 7788 592 806 | @fastchicken | <A HREF="http://www.linkedin.com/in/nicwise">http://www.linkedin.com/in/nicwise</A>
</I>&gt;<i> b. <A HREF="http://www.fastchicken.co.nz/">http://www.fastchicken.co.nz/</A>
</I>&gt;<i> 
</I>&gt;<i> mobileAgent (for FreeAgent): get your accounts in your pocket.
</I>&gt;<i> <A HREF="http://goo.gl/IuBU">http://goo.gl/IuBU</A>
</I>&gt;<i> Trip Wallet: Keep track of your budget on the go: <A HREF="http://goo.gl/ePhKa">http://goo.gl/ePhKa</A>
</I>&gt;<i> Earnest: Self-employed? Track your business expenses and income.
</I>&gt;<i> <A HREF="http://earnestapp.com">http://earnestapp.com</A>
</I>&gt;<i> Nearest Bus: find when the next bus is coming to your stop. <A HREF="http://goo.gl/Vcz1p">http://goo.gl/Vcz1p</A>
</I>&gt;<i> London Bike App: Find the nearest Boris Bike, and get riding! <A HREF="http://goo.gl/Icp2">http://goo.gl/Icp2</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20121107/0f617f5b/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20121107/0f617f5b/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012370.html">[MonoTouch] How to generate Reports through Monotouch on IPAD
</A></li>
	<LI>Next message: <A HREF="012329.html">[MonoTouch] Bindings for MapBox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12380">[ date ]</a>
              <a href="thread.html#12380">[ thread ]</a>
              <a href="subject.html#12380">[ subject ]</a>
              <a href="author.html#12380">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
