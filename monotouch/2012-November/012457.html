<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Auto network credentials
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Auto%20network%20credentials&In-Reply-To=%3CCAMcfPoSB4DWm1d%2BhBrCXfHzkVV0NRXHawNTMJg3-7%2BTknhY%3DEw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012479.html">
   <LINK REL="Next"  HREF="012464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Auto network credentials</H1>
    <B>Brad Moore</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Auto%20network%20credentials&In-Reply-To=%3CCAMcfPoSB4DWm1d%2BhBrCXfHzkVV0NRXHawNTMJg3-7%2BTknhY%3DEw%40mail.gmail.com%3E"
       TITLE="[MonoTouch] Auto network credentials">b.moore at 4pilabs.com.au
       </A><BR>
    <I>Mon Nov 26 07:25:05 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012479.html">[MonoTouch] Error MT0010: Could not parse the command line	arguments
</A></li>
        <LI>Next message: <A HREF="012464.html">[MonoTouch] Auto network credentials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12457">[ date ]</a>
              <a href="thread.html#12457">[ thread ]</a>
              <a href="subject.html#12457">[ subject ]</a>
              <a href="author.html#12457">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey
Trying to load some data off my server (xml data). I normally just
use HttpWebRequest as I can set the utomaticDecompression to
DecompressionMethods.GZip | DecompressionMethods.Deflate in order to use
gzip compression of my data automatically.

Recently a client has emailed me saying that it does not work from within
his school. Sent out another copy of the app to him via TestFlightApp to
get more debugging info from him and the app responds with a 407 auth
error. Since then I have set up a proxy on my computer which I redirect my
iPhone traffic through to test on.

My original setup was like so,

HttpWebRequest request = (HttpWebRequest)WebRequest.Create(_url);
request.CachePolicy = new
HttpRequestCachePolicy(HttpRequestCacheLevel.NoCacheNoStore);
request.Proxy = null;
request.AutomaticDecompression = DecompressionMethods.GZip |
DecompressionMethods.Deflate;
WebResponse response = request.GetResponse();

and then so on from there.

I'd set Proxy to null because in most cases the user would not be behind a
proxy and this cut off 1-2 seconds of proxy resolving. There is code later
to catch this and then re-create the HttpWebRequest but by not nulling the
proxy, which I thought would be default proxy. Apparently not so...

I tried to then get the default proxy settings of the device.

CFProxySettings proxy0 = CFNetwork.GetSystemProxySettings();
IWebProxy proxy1 = WebRequest.GetSystemWebProxy();
IWebProxy proxy2 = HttpWebRequest.DefaultWebProxy;
IWebProxy proxy3 = HttpWebRequest.GetSystemWebProxy();
IWebProxy proxy4 = CFNetwork.GetDefaultProxy();

proxy1 - proxy4 have null for the credentials. proxy0 contains proxy
information which I need such as proxy url, port, username, but no
password...

I manually made a WebProxy with my credentials

WebProxy webProxy = new WebProxy(proxy0.HTTPProxy, proxy0.HTTPPort);
webProxy.Credentials = new NetworkCredential(&quot;user&quot;, &quot;pass&quot;);
request.Proxy = webProxy;

and this works.
Falling short of requesting username and password for the proxy on a 407
error I am not sure what to do...
WebClient downloads do not work, but UIWebView and MKMapView does auto-auth
itself.

Any ideas what I am missing?

- Brad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20121126/d62d273e/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20121126/d62d273e/attachment.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012479.html">[MonoTouch] Error MT0010: Could not parse the command line	arguments
</A></li>
	<LI>Next message: <A HREF="012464.html">[MonoTouch] Auto network credentials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12457">[ date ]</a>
              <a href="thread.html#12457">[ thread ]</a>
              <a href="subject.html#12457">[ subject ]</a>
              <a href="author.html#12457">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
