<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Call for beta testers for new Dispose semantics
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Call%20for%20beta%20testers%20for%20new%20Dispose%20semantics&In-Reply-To=%3CCAP-t2584b_vpxGhEHCOvzWGs0-zdMFM4_tjTFQVsq4_QdZgXmQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012419.html">
   <LINK REL="Next"  HREF="012427.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Call for beta testers for new Dispose semantics</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20Call%20for%20beta%20testers%20for%20new%20Dispose%20semantics&In-Reply-To=%3CCAP-t2584b_vpxGhEHCOvzWGs0-zdMFM4_tjTFQVsq4_QdZgXmQ%40mail.gmail.com%3E"
       TITLE="[MonoTouch] Call for beta testers for new Dispose semantics">rolf at xamarin.com
       </A><BR>
    <I>Thu Nov 15 01:56:12 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012419.html">[MonoTouch] &quot;Invalid binary&quot; when uploading my MonoTouch app
</A></li>
        <LI>Next message: <A HREF="012427.html">[MonoTouch] Restrict interaction to UIView only &#8230;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12420">[ date ]</a>
              <a href="thread.html#12420">[ thread ]</a>
              <a href="subject.html#12420">[ subject ]</a>
              <a href="author.html#12420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Call for beta tests

We are looking for developers to test their applications with a different
set of semantics for Dispose() on NSObjects and provide us with feedback
and let us know if this breaks their existing applications.

The semantics for MonoTouch&#8217;s Dispose on NSObject and their subclasses as
of MonoTouch 6.0.6 (the current stable release) are as follows:


   - Release the native reference
   - Clear the handle of the object
   - Clear any managed fields that cache or point to other managed objects
   - Break the Unmanaged-&gt;Managed link


This means that when you call Dispose, you have effectively registered your
lack of interest in the object. The above is problematic in some
conditions, for instance, when the unmanaged world keeps a reference to the
managed object that has been Disposed and a method is invoked on it.
Typically users will see an error message like this:

Selector invoked from objective-c on a managed object of type MyApp.MyType
(0x10D27C50) that has been GC'ed

However the above is not always true. The managed object could still be
alive, but the linkage between the two worlds has been broken and when
MonoTouch tries to find the managed object for a particular native object
it won't find it and throws this exception.

Sadly, calling Dispose() actively is a common pattern, so we are
experimenting with some new semantics for Dispose that would eliminate the
above problem for the conditions outlined before.

We have implemented a new approach for Dispose in MonoTouch 6.0.7
(currently available in the Beta channel).

In this beta, Dispose() instead performs these steps:

   - Release the native reference
   - Handle and backing fields are preserved unless this was the last
   reference to the object.


This means that a managed NSObject subclass that is being referenced by
unmanaged code is kept intact and fully operational after a call to
Dispose. The managed object will be kept alive for as long as the unmanaged
code references the object.

This has the potential downside that some objects that would have
previously been eligible for collection will not be, until a later point in
time.

But the advantage is that the managed hierarchy more closely mimics the
behavior of the unmanaged one.

*How to install*

Enable the beta channel in MonoDevelop's update preferences, and you'll be
offered this beta (it's MonoTouch 6.0.7). If you find any bugs that blocks
you, it is possible to downgrade to a previous release by downloading it
from your Xamarin Store account (<A HREF="https://store.xamarin.com/Account/Products">https://store.xamarin.com/Account/Products</A>)
and install it over this beta.

Feedback

We're interested in any kind of feedback, either positive (it works just
like it used to / it works a lot better than it used to) or negative (it
crashes / even more inexplicable exceptions are thrown), even if you don't
think this applies to your apps.

Thanks,
Rolf
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20121115/1ed9a9b1/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20121115/1ed9a9b1/attachment.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012419.html">[MonoTouch] &quot;Invalid binary&quot; when uploading my MonoTouch app
</A></li>
	<LI>Next message: <A HREF="012427.html">[MonoTouch] Restrict interaction to UIView only &#8230;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12420">[ date ]</a>
              <a href="thread.html#12420">[ thread ]</a>
              <a href="subject.html#12420">[ subject ]</a>
              <a href="author.html#12420">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
