<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] EXC_BAD_ACCESS with NSString	sizeWithFont:constrainedToSize:lineBreakMode:
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20EXC_BAD_ACCESS%20with%20NSString%0A%09sizeWithFont%3AconstrainedToSize%3AlineBreakMode%3A&In-Reply-To=3EDBDF36-E248-41AE-9740-E26DD885155D%40novell.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001417.html">
   <LINK REL="Next"  HREF="001415.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] EXC_BAD_ACCESS with NSString	sizeWithFont:constrainedToSize:lineBreakMode:</H1>
    <B>Ed Anuff</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20EXC_BAD_ACCESS%20with%20NSString%0A%09sizeWithFont%3AconstrainedToSize%3AlineBreakMode%3A&In-Reply-To=3EDBDF36-E248-41AE-9740-E26DD885155D%40novell.com"
       TITLE="[MonoTouch] EXC_BAD_ACCESS with NSString	sizeWithFont:constrainedToSize:lineBreakMode:">ed at anuff.com
       </A><BR>
    <I>Fri Oct 16 12:00:51 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001417.html">[MonoTouch] EXC_BAD_ACCESS with NSString	sizeWithFont:constrainedToSize:lineBreakMode:
</A></li>
        <LI>Next message: <A HREF="001415.html">[MonoTouch] Error Invoke WCF Service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1418">[ date ]</a>
              <a href="thread.html#1418">[ thread ]</a>
              <a href="subject.html#1418">[ subject ]</a>
              <a href="author.html#1418">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>D'oh!

FWIW, I was also able to fix the problem by using objc_msgSend_stret.
The page at <A HREF="http://monotouch.net/Documentation/Objective-C_Selectors">http://monotouch.net/Documentation/Objective-C_Selectors</A>
that describes using selectors unfortunately uses sizeWithFont as the
example for regular selector usage without explicitly mentioning that
it's also an example of the type of selector which must use the _stret
invocation method, instead using selConvertPointFromWindow as the
example of when you need to use objc_msgSend_stret.

Ed

On Fri, Oct 16, 2009 at 5:40 AM, Geoff Norton &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">gnorton at novell.com</A>&gt; wrote:
&gt;<i> Ed,
</I>&gt;<i>
</I>&gt;<i> &#160;Try UIView.StringSize (msg, font, max_size, mode);
</I>&gt;<i>
</I>&gt;<i> -g
</I>&gt;<i>
</I>&gt;<i> On 16-Oct-09, at 2:55 AM, Ed Anuff wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I'm trying to use the sizeWithFont method in NSString using the
</I>&gt;&gt;<i> following code. &#160;It works fine on the simulator, but crashes on the
</I>&gt;&gt;<i> device. &#160;Any thought on how to fix this?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> public static SizeF StringSizeWithFontConstrainedToSize(string msg,
</I>&gt;&gt;<i> UIFont font, SizeF max_size, UILineBreakMode mode)
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160;NSString target = new NSString(msg);
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160;Selector selector = new Selector
</I>&gt;&gt;<i> (&quot;sizeWithFont:constrainedToSize:lineBreakMode:&quot;);
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160;SizeF size = cgsize_objc_msgSend_IntPtr_cgsize_int(
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;target.Handle,
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;selector.Handle,
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;font == null ? IntPtr.Zero : font.Handle,
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;max_size,
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;mode);
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160;return size;
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> MonoTouch mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001417.html">[MonoTouch] EXC_BAD_ACCESS with NSString	sizeWithFont:constrainedToSize:lineBreakMode:
</A></li>
	<LI>Next message: <A HREF="001415.html">[MonoTouch] Error Invoke WCF Service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1418">[ date ]</a>
              <a href="thread.html#1418">[ thread ]</a>
              <a href="subject.html#1418">[ subject ]</a>
              <a href="author.html#1418">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
