<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] Expressions? One Hurdle Down and More After It
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Expressions%3F%20One%20Hurdle%20Down%20and%20More%20After%20It&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001482.html">
   <LINK REL="Next"  HREF="001488.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] Expressions? One Hurdle Down and More After It</H1>
    <B>Tim Scott</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20Expressions%3F%20One%20Hurdle%20Down%20and%20More%20After%20It&In-Reply-To="
       TITLE="[MonoTouch] Expressions? One Hurdle Down and More After It">tscott at lunaversesoftware.com
       </A><BR>
    <I>Wed Oct 28 23:09:33 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001482.html">[MonoTouch] WCF support Improve
</A></li>
        <LI>Next message: <A HREF="001488.html">[MonoTouch] Expressions? One Hurdle Down and More After It
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1487">[ date ]</a>
              <a href="thread.html#1487">[ thread ]</a>
              <a href="subject.html#1487">[ subject ]</a>
              <a href="author.html#1487">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the suggestion, Jb.  Indeed, 1.2 corrects this issue.  However,
my app did not get much father before it blew up again.

Straight away I got this error:

Attempting to JIT compile method
'Catnap.Maps.Impl.EntityMap`
1&lt;Lunaverse.BillIt.Core.Model.TimeEntry&gt;:Property&lt;bool&gt;
(System.Linq.Expressions.Expression`
1&lt;System.Func`2&lt;Lunaverse.BillIt.Core.Model.TimeEntry, bool&gt;&gt;)' while
running with --aot-only.

   at Lunaverse.BillIt.Core.PersistenceConfigurator.Configure
(System.String connectionString) [0x00000]
   at BillIt.UI.Application.InitializeDatabase () [0x00000]
   at BillIt.UI.Application.Main (System.String[] args) [0x00000]

The line in my code where it blew up is:

   Map.Entity&lt;TimeEntry&gt;().Property(x =&gt; x.Billed)

It might not be very clear what this does.  Here is the method signature is:

   EntityMap&lt;T&gt;.Property&lt;TProperty&gt;(Expression&lt;Func&lt;T, TProperty&gt;&gt; property)

Billed is a bool property of TimeEntry.

The section of code where the trouble occurs calls the same Property method
several times with various values for TProperty.  I decided to move things
around and see which ones failed and which ones passed.  Here are the other
errors I was able to produce:

------------------
Attempting to JIT compile method
'Catnap.Maps.Impl.EntityMap`
1&lt;Lunaverse.BillIt.Core.Model.TimeEntry&gt;:Property&lt;System.Decimal&gt;
(System.Linq.Expressions.Expression`
1&lt;System.Func`2&lt;Lunaverse.BillIt.Core.Model.TimeEntry,
System.Decimal&gt;&gt;)' while running with --aot-only.
------------------
Attempting to JIT compile method
'Catnap.Maps.Impl.EntityMap`
1&lt;Lunaverse.BillIt.Core.Model.TimeEntry&gt;
:<i>Property&lt;System.Nullable`1&lt;System.DateTime&gt;&gt;
</I>(System.Linq.Expressions.Expression`
1&lt;System.Func`2&lt;Lunaverse.BillIt.Core.Model.TimeEntry,
System.Nullable`1&lt;System.DateTime&gt;&gt;&gt;)' while running with --aot-only.
-------------------
Attempting to JIT compile method
'Catnap.Maps.Impl.EntityMap`
1&lt;L
unaverse.BillIt.Core.Model.NavigationState&gt;
:<i>Property&lt;System.Nullable`1&lt;int&gt;&gt;
</I>(System.Linq.Expressions.Expression`
1&lt;System.Func`2&lt;Lunaverse.BillIt.Core.Model.NavigationState,
System.Nullable`1&lt;int&gt;&gt;&gt;)' while running with --aot-only.
-------------------

So the types that I have seen to fail are:

int?
decimal
bool
DateTime?

On the other had, it seems to work fine if the type string or a complex
type.

This is a bug (or bugs) in Monotouch, yes?  I guess the team MT just has to
work through these as they come up?  Let me know if there is anything I can
do to expedite.  I would be happy to submit a ticket or whatever will help.



On 10/28/09 9:15 AM, &quot;Jb Evain&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">jb at nurv.fr</A>&gt; wrote:

&gt;<i> Hey,
</I>&gt;<i> 
</I>&gt;<i> On 10/27/09, Tim Scott &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">tscott at lunaversesoftware.com</A>&gt; wrote:
</I>&gt;&gt;<i>  This code does not seem to be doing any JIT compiling.  Should this be
</I>&gt;&gt;<i> supported by MT?  If so I will submit a defect ticket.  Thanks.
</I>&gt;<i> 
</I>&gt;<i> The issue is the one described here:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://monotouch.net/Documentation/Troubleshoot">http://monotouch.net/Documentation/Troubleshoot</A>
</I>&gt;<i> 
</I>&gt;<i> It's the #16. You can apply the workaround in your own code to make it
</I>&gt;<i> work. MonoTouch 1.2 should fix a few of those cases also.
</I>

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001482.html">[MonoTouch] WCF support Improve
</A></li>
	<LI>Next message: <A HREF="001488.html">[MonoTouch] Expressions? One Hurdle Down and More After It
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1487">[ date ]</a>
              <a href="thread.html#1487">[ thread ]</a>
              <a href="subject.html#1487">[ subject ]</a>
              <a href="author.html#1487">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
