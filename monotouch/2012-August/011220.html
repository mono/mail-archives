<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] PUT call to server using WebRequest
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20PUT%20call%20to%20server%20using%20WebRequest&In-Reply-To=%3CCAAEjJnGtbqD%3D_%2BC1u2oHQENqWgWWcdqEt-k0P38hBs7BjZnVkA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011219.html">
   <LINK REL="Next"  HREF="011224.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] PUT call to server using WebRequest</H1>
    <B>Jason Awbrey</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20PUT%20call%20to%20server%20using%20WebRequest&In-Reply-To=%3CCAAEjJnGtbqD%3D_%2BC1u2oHQENqWgWWcdqEt-k0P38hBs7BjZnVkA%40mail.gmail.com%3E"
       TITLE="[MonoTouch] PUT call to server using WebRequest">jason at awbrey.net
       </A><BR>
    <I>Sun Aug 12 14:30:18 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011219.html">[MonoTouch] PUT call to server using WebRequest
</A></li>
        <LI>Next message: <A HREF="011224.html">[MonoTouch] PUT call to server using WebRequest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11220">[ date ]</a>
              <a href="thread.html#11220">[ thread ]</a>
              <a href="subject.html#11220">[ subject ]</a>
              <a href="author.html#11220">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I believe you can get WebClient status codes by catching WebException and
looking at it's Response.StatusCode

assuming you're only interested in failure status codes, this might work
for you

On Sun, Aug 12, 2012 at 8:34 AM, Phil Cockfield &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">phil at cockfield.net</A>&gt; wrote:

&gt;<i> Hello!
</I>&gt;<i>
</I>&gt;<i> I'm using the *HttpWebRequest *to do a PUT on my server.  The web-server
</I>&gt;<i> is Node.js.  The code is very by the book standard stuff:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         // Prepare the data.
</I>&gt;<i>           var dataText = data.ToString();
</I>&gt;<i>           var byteArray = dataText.ToByteArray();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>           // Setup the web-request.
</I>&gt;<i>
</I>&gt;<i>           var req = WebRequest.Create(url);
</I>&gt;<i>           req.Method = &quot;PUT&quot;;
</I>&gt;<i>           req.ContentType = &quot;Content-Type: application/json; charset=utf-8&quot;;
</I>&gt;<i>           req.ContentLength = byteArray.Length;
</I>&gt;<i>
</I>&gt;<i>           // Process the stream.
</I>&gt;<i>           var dataStream = req.*GetRequestStream*();
</I>&gt;<i>           dataStream.Write(byteArray, 0, byteArray.Length);
</I>&gt;<i>           dataStream.Close();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The problem is, when I call *GetRequestStream* it issues the request to
</I>&gt;<i> the server and the response is complete before the next line (dataStream.
</I>&gt;<i> Write) executes.  As a result no data is actually sent.  It's like the
</I>&gt;<i> stream prematurely flushes upon creation.  In fact, I didn't think it was
</I>&gt;<i> supposed to call the server at all until *GetResponse* was invoked.
</I>&gt;<i>
</I>&gt;<i> Am I doing something dumb here?  Or, is it something with the way Node is
</I>&gt;<i> behaving (that would be weird if it were).  Or is HttpWebRequest flakey?
</I>&gt;<i>
</I>&gt;<i> This works if I use *WebClient*.  But I need HttpStatus codes - and my
</I>&gt;<i> understanding is you can't get at those from *WebClient*.  (If you can, I
</I>&gt;<i> can't find them anywhere! :-))
</I>&gt;<i>
</I>&gt;<i> Anyone else seeing weirdness with *HttpWebRequest*?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> *Phil *Cockfield
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20120812/b0aae307/attachment-0001.html">http://lists.ximian.com/pipermail/monotouch/attachments/20120812/b0aae307/attachment-0001.html</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011219.html">[MonoTouch] PUT call to server using WebRequest
</A></li>
	<LI>Next message: <A HREF="011224.html">[MonoTouch] PUT call to server using WebRequest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11220">[ date ]</a>
              <a href="thread.html#11220">[ thread ]</a>
              <a href="subject.html#11220">[ subject ]</a>
              <a href="author.html#11220">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
