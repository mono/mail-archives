<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] EAAccessory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20EAAccessory&In-Reply-To=%3C1331046358656-4450129.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008447.html">
   <LINK REL="Next"  HREF="008448.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] EAAccessory</H1>
    <B>danmiser</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=Re%3A%20%5BMonoTouch%5D%20EAAccessory&In-Reply-To=%3C1331046358656-4450129.post%40n4.nabble.com%3E"
       TITLE="[MonoTouch] EAAccessory">danmiser at gmail.com
       </A><BR>
    <I>Tue Mar  6 15:05:58 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="008447.html">[MonoTouch] EAAccessory
</A></li>
        <LI>Next message: <A HREF="008448.html">[MonoTouch] Not sure if MT Bug. Would appreciate MT guys taking a	quick look
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8459">[ date ]</a>
              <a href="thread.html#8459">[ thread ]</a>
              <a href="subject.html#8459">[ subject ]</a>
              <a href="author.html#8459">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have the code narrowed down to a pretty simple test case. Unfortunately, it
relies on having the printer that I'm using. If anyone has access to the
source code for the MT EAAccessory code, can you take a look at what's
happening to the creation/assignment of EASession OutputStream and
InputStream. They are null when getting created the second time.

My code looks like this:

private EAAccessory GetConnectedPrinter() {
  EAAcessory accessory = null;
  foreach (var obj in
EAAcessoryManager.SharedAccessoryManager.ConnectedAccessories) { 
    if (accessory != null) break;
    foreach (var p in obj.ProtocolStrings) {
      if (p.Contains(&quot;com.bluebamboo.p25i&quot;)) {
        accessory = obj;
        break;
      }
    }
  return accessory;
}

Then in a button TouchUpInside event:
EAAccessory accessory = GetConnectedPrinter(); 
// Ignore error check for test (printer is on so accessory is set properly
EASession session = new EASession(accessory, &quot;com.bluebamboo.p25i&quot;);

The first time, session is created and OutputStream and InputStream are
created.
The second time, session is created, but OutputStream and InputStream are
null. This creates problems later on in the code because I need to write on
the OutputStream.

Other notes:
* It doesn't matter if the session variable is declared at the class level
or inside the method.
* It doesn't matter if I do session.Dispose() and set it to null. It still
returns null for OutputStream and InputStream on the second create.
* On a semi-related note, the Delegate and OnEvent methods aren't firing the
events in the MT sample, but they do fire in the XCode sample.

I can't find the code where I originally got the sample. I thought it was
posted from here on a gist, but my google fu is weak today. :(

Hopefully this is enough to go on to have the devs do a quick code review of
the EASession class at least. If you need more details, I'm happy to provide
them.


--
View this message in context: <A HREF="http://monotouch.2284126.n4.nabble.com/EAAccessory-tp4448799p4450129.html">http://monotouch.2284126.n4.nabble.com/EAAccessory-tp4448799p4450129.html</A>
Sent from the MonoTouch mailing list archive at Nabble.com.
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008447.html">[MonoTouch] EAAccessory
</A></li>
	<LI>Next message: <A HREF="008448.html">[MonoTouch] Not sure if MT Bug. Would appreciate MT guys taking a	quick look
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8459">[ date ]</a>
              <a href="thread.html#8459">[ thread ]</a>
              <a href="subject.html#8459">[ subject ]</a>
              <a href="author.html#8459">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
