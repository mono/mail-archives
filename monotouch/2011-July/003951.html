<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] System.MissingMethodException: No constructor found	for	MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20System.MissingMethodException%3A%20No%20constructor%20found%0A%09for%0A%09MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate%3A%3A.ctor%28System.IntPtr%29&In-Reply-To=CAL4ggqsNBzGMc5yKO%2B9ZxZPktMh-ri6ScAjQk5eGr_Fg216u2Q%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003949.html">
   <LINK REL="Next"  HREF="003958.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] System.MissingMethodException: No constructor found	for	MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)</H1>
    <B>Mark Smith</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20System.MissingMethodException%3A%20No%20constructor%20found%0A%09for%0A%09MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate%3A%3A.ctor%28System.IntPtr%29&In-Reply-To=CAL4ggqsNBzGMc5yKO%2B9ZxZPktMh-ri6ScAjQk5eGr_Fg216u2Q%40mail.gmail.com"
       TITLE="[MonoTouch] System.MissingMethodException: No constructor found	for	MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)">mark at julmar.com
       </A><BR>
    <I>Tue Jul 19 09:08:10 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003949.html">[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
        <LI>Next message: <A HREF="003958.html">[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3951">[ date ]</a>
              <a href="thread.html#3951">[ thread ]</a>
              <a href="subject.html#3951">[ subject ]</a>
              <a href="author.html#3951">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Tom,

I had similar problems with that code fragment, I had to use AVAudioPlayer for exactly the same reason (volume control) and found that some combination of the GC, creating additional objects and my handling of the FinishedPlaying event would cause the same crash.  I only have 5 sounds I play so I finally ended up punting on the issue and holding hard references to each of the players for the lifetime of the application (as I play the sounds periodically throughout).  That solved my problem.

mark

Mark Smith

___________________________________________________

.NET Solutions Mentor &amp; Consultant
DEVELOPMENTOR Instructor and Course Author         

<A HREF="http://www.julmar.com">http://www.julmar.com</A>   Twitter: marksm
Blog: <A HREF="http://www.julmar.com/blog/mark">http://www.julmar.com/blog/mark</A>
___________________________________________________






On Jul 19, 2011, at 5:28 AM, Tom Fanning wrote:

&gt;<i> Okay, I think I've got this reliable - at least it's not crashed with
</I>&gt;<i> 150+ button pushes on my last few goes.
</I>&gt;<i> 
</I>&gt;<i> For reference
</I>&gt;<i> 
</I>&gt;<i> The AudioSession code is required to get volume control working.
</I>&gt;<i> Without that, my volume buttons change the ringer volume, not the
</I>&gt;<i> media volume.
</I>&gt;<i> 
</I>&gt;<i> I have to call AudioSession.SetActive(true); every time I create an
</I>&gt;<i> AVAudioPlayer, otherwise I risk an AudioSessionException with message
</I>&gt;<i> &quot;Application Audio Session is not active&quot;.
</I>&gt;<i> 
</I>&gt;<i> I removed the anonymous method from FinishedPlaying, and instead do
</I>&gt;<i> the following.
</I>&gt;<i> 
</I>&gt;<i> I have a class-scoped List&lt;AVAudioPlayer&gt; called toDispose.
</I>&gt;<i> 
</I>&gt;<i> On button press:
</I>&gt;<i> 
</I>&gt;<i> {
</I>&gt;<i>    // call Play on a freshly instantiated AVAudioPlayer ap:
</I>&gt;<i>    var ap = AVAudioPlayer.FromUrl(url, out err);
</I>&gt;<i>    ap.Play();
</I>&gt;<i> 
</I>&gt;<i>    // next I check to see if toDispose has a bunch of AVAudioPlayers
</I>&gt;<i> piled up, and if so, dispose all but the last couple in the list (my
</I>&gt;<i> samples are only 0.15 seconds long so it's unlikely I'll dispose one
</I>&gt;<i> that's currently playing this way)
</I>&gt;<i>    // code snipped for brevity
</I>&gt;<i> 
</I>&gt;<i>    // add the current AVAudioPlayer to the list of players to keep track of
</I>&gt;<i>    toDispose.Add(ap);
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> then finally in ViewWillDisappear() I dispose any remaining
</I>&gt;<i> AVAudioPlayers in toDispose, and remove the disposed player from the
</I>&gt;<i> list.
</I>&gt;<i> 
</I>&gt;<i> Horrible but stable with many short samples being played, unlike the
</I>&gt;<i> sample code on the MonoTouch website.
</I>&gt;<i> 
</I>&gt;<i> Thanks for the suggestions.
</I>&gt;<i> Tom
</I>&gt;<i> 
</I>&gt;<i> On Tue, Jul 19, 2011 at 1:07 AM, David Moles &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">davidmoles at thegogame.com</A>&gt; wrote:
</I>&gt;&gt;<i> FWIW, I'm using AVAudioPlayer.FromUrl() and it works for me. I'm not
</I>&gt;&gt;<i> disposing on FinishedPlaying, though, I've got separate code that calls Stop
</I>&gt;&gt;<i> and then Dispose. I'm also not using AudioSession at all.
</I>&gt;&gt;<i> Note though that I'm still on MT 3.2.x, if that makes a difference.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Mon, Jul 18, 2011 at 3:18 PM, Tom Fanning &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">ml at tomfanning.eu</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Weird one this.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> In a ViewController I call the following code in ViewDidLoad():
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> AudioSession.Initialize();
</I>&gt;&gt;&gt;<i> AudioSession.Category = AudioSessionCategory.MediaPlayback;
</I>&gt;&gt;&gt;<i> AudioSession.SetActive(true);
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Then in response to some button presses I do:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> NSError err;
</I>&gt;&gt;&gt;<i> var ap = AVAudioPlayer.FromUrl(new NSUrl(&quot;mysound.caf&quot;), out err);
</I>&gt;&gt;&gt;<i> ap.FinishedPlaying += delegate { ap.Dispose(); };
</I>&gt;&gt;&gt;<i> ap.Play();
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> And this works great, pretty responsive etc.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Except sometimes, seemingly randomly, I get the following unhandled
</I>&gt;&gt;&gt;<i> exception in release mode on the device (iPhone 3GS):
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> System.MissingMethodException: No constructor found for
</I>&gt;&gt;&gt;<i> MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Any ideas? Google comes up blank for that specific missing constructor.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Thanks
</I>&gt;&gt;&gt;<i> Tom
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> Tom Fanning
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> MonoTouch mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> David Moles
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">davidmoles at thegogame.com</A>
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Tom Fanning
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monotouch/attachments/20110719/a5cfe6bd/attachment.html">http://lists.ximian.com/pipermail/monotouch/attachments/20110719/a5cfe6bd/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003949.html">[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
	<LI>Next message: <A HREF="003958.html">[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3951">[ date ]</a>
              <a href="thread.html#3951">[ thread ]</a>
              <a href="subject.html#3951">[ subject ]</a>
              <a href="author.html#3951">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
