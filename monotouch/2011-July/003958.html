<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20System.MissingMethodException%3A%20No%20constructor%20found%0A%20for%0A%20MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate%3A%3A.ctor%28System.IntPtr%29&In-Reply-To=B975BFA1-F832-492E-BFB9-A9B86F5EAB8D%40julmar.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003951.html">
   <LINK REL="Next"  HREF="003948.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)</H1>
    <B>Tom Fanning</B> 
    <A HREF="mailto:monotouch%40lists.ximian.com?Subject=%5BMonoTouch%5D%20System.MissingMethodException%3A%20No%20constructor%20found%0A%20for%0A%20MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate%3A%3A.ctor%28System.IntPtr%29&In-Reply-To=B975BFA1-F832-492E-BFB9-A9B86F5EAB8D%40julmar.com"
       TITLE="[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)">ml at tomfanning.eu
       </A><BR>
    <I>Wed Jul 20 03:58:43 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003951.html">[MonoTouch] System.MissingMethodException: No constructor found	for	MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
        <LI>Next message: <A HREF="003948.html">[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3958">[ date ]</a>
              <a href="thread.html#3958">[ thread ]</a>
              <a href="subject.html#3958">[ subject ]</a>
              <a href="author.html#3958">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Cheers. In effect I guess we're doing much the same thing to work
around this issue.

This is now Bug 23.

<A HREF="http://bugzilla.xamarin.com/show_bug.cgi?id=23">http://bugzilla.xamarin.com/show_bug.cgi?id=23</A>

Tom

On Tue, Jul 19, 2011 at 2:08 PM, Mark Smith &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">mark at julmar.com</A>&gt; wrote:
&gt;<i> Hi Tom,
</I>&gt;<i> I had similar problems with that code fragment, I had to use AVAudioPlayer
</I>&gt;<i> for exactly the same reason (volume control) and found that some combination
</I>&gt;<i> of the GC, creating additional objects and my handling of the
</I>&gt;<i> FinishedPlaying event would cause the same crash. &#160;I only have 5 sounds I
</I>&gt;<i> play so I finally ended up punting on the issue and holding hard references
</I>&gt;<i> to each of the players for the lifetime of the application (as I play the
</I>&gt;<i> sounds periodically throughout). &#160;That solved my problem.
</I>&gt;<i> mark
</I>&gt;<i>
</I>&gt;<i> Mark Smith
</I>&gt;<i>
</I>&gt;<i> ___________________________________________________
</I>&gt;<i>
</I>&gt;<i> .NET Solutions Mentor &amp; Consultant
</I>&gt;<i> DEVELOPMENTOR&#160;Instructor and Course Author
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.julmar.com&#160;&#160;&#160;Twitter:&#160;marksm">http://www.julmar.com&#160;&#160;&#160;Twitter:&#160;marksm</A>
</I>&gt;<i> Blog:&#160;<A HREF="http://www.julmar.com/blog/mark">http://www.julmar.com/blog/mark</A>
</I>&gt;<i> ___________________________________________________
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Jul 19, 2011, at 5:28 AM, Tom Fanning wrote:
</I>&gt;<i>
</I>&gt;<i> Okay, I think I've got this reliable - at least it's not crashed with
</I>&gt;<i> 150+ button pushes on my last few goes.
</I>&gt;<i>
</I>&gt;<i> For reference
</I>&gt;<i>
</I>&gt;<i> The AudioSession code is required to get volume control working.
</I>&gt;<i> Without that, my volume buttons change the ringer volume, not the
</I>&gt;<i> media volume.
</I>&gt;<i>
</I>&gt;<i> I have to call AudioSession.SetActive(true); every time I create an
</I>&gt;<i> AVAudioPlayer, otherwise I risk an AudioSessionException with message
</I>&gt;<i> &quot;Application Audio Session is not active&quot;.
</I>&gt;<i>
</I>&gt;<i> I removed the anonymous method from FinishedPlaying, and instead do
</I>&gt;<i> the following.
</I>&gt;<i>
</I>&gt;<i> I have a class-scoped List&lt;AVAudioPlayer&gt; called toDispose.
</I>&gt;<i>
</I>&gt;<i> On button press:
</I>&gt;<i>
</I>&gt;<i> {
</I>&gt;<i> &#160;&#160;&#160;// call Play on a freshly instantiated AVAudioPlayer ap:
</I>&gt;<i> &#160;&#160;&#160;var ap = AVAudioPlayer.FromUrl(url, out err);
</I>&gt;<i> &#160;&#160;&#160;ap.Play();
</I>&gt;<i>
</I>&gt;<i> &#160;&#160;&#160;// next I check to see if toDispose has a bunch of AVAudioPlayers
</I>&gt;<i> piled up, and if so, dispose all but the last couple in the list (my
</I>&gt;<i> samples are only 0.15 seconds long so it's unlikely I'll dispose one
</I>&gt;<i> that's currently playing this way)
</I>&gt;<i> &#160;&#160;&#160;// code snipped for brevity
</I>&gt;<i>
</I>&gt;<i> &#160;&#160;&#160;// add the current AVAudioPlayer to the list of players to keep track of
</I>&gt;<i> &#160;&#160;&#160;toDispose.Add(ap);
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> then finally in ViewWillDisappear() I dispose any remaining
</I>&gt;<i> AVAudioPlayers in toDispose, and remove the disposed player from the
</I>&gt;<i> list.
</I>&gt;<i>
</I>&gt;<i> Horrible but stable with many short samples being played, unlike the
</I>&gt;<i> sample code on the MonoTouch website.
</I>&gt;<i>
</I>&gt;<i> Thanks for the suggestions.
</I>&gt;<i> Tom
</I>&gt;<i>
</I>&gt;<i> On Tue, Jul 19, 2011 at 1:07 AM, David Moles &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">davidmoles at thegogame.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> FWIW, I'm using AVAudioPlayer.FromUrl() and it works for me. I'm not
</I>&gt;<i>
</I>&gt;<i> disposing on FinishedPlaying, though, I've got separate code that calls Stop
</I>&gt;<i>
</I>&gt;<i> and then Dispose. I'm also not using AudioSession at all.
</I>&gt;<i>
</I>&gt;<i> Note though that I'm still on MT 3.2.x, if that makes a difference.
</I>&gt;<i>
</I>&gt;<i> On Mon, Jul 18, 2011 at 3:18 PM, Tom Fanning &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">ml at tomfanning.eu</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> Weird one this.
</I>&gt;<i>
</I>&gt;<i> In a ViewController I call the following code in ViewDidLoad():
</I>&gt;<i>
</I>&gt;<i> AudioSession.Initialize();
</I>&gt;<i>
</I>&gt;<i> AudioSession.Category = AudioSessionCategory.MediaPlayback;
</I>&gt;<i>
</I>&gt;<i> AudioSession.SetActive(true);
</I>&gt;<i>
</I>&gt;<i> Then in response to some button presses I do:
</I>&gt;<i>
</I>&gt;<i> NSError err;
</I>&gt;<i>
</I>&gt;<i> var ap = AVAudioPlayer.FromUrl(new NSUrl(&quot;mysound.caf&quot;), out err);
</I>&gt;<i>
</I>&gt;<i> ap.FinishedPlaying += delegate { ap.Dispose(); };
</I>&gt;<i>
</I>&gt;<i> ap.Play();
</I>&gt;<i>
</I>&gt;<i> And this works great, pretty responsive etc.
</I>&gt;<i>
</I>&gt;<i> Except sometimes, seemingly randomly, I get the following unhandled
</I>&gt;<i>
</I>&gt;<i> exception in release mode on the device (iPhone 3GS):
</I>&gt;<i>
</I>&gt;<i> System.MissingMethodException: No constructor found for
</I>&gt;<i>
</I>&gt;<i> MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</I>&gt;<i>
</I>&gt;<i> Any ideas? Google comes up blank for that specific missing constructor.
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i>
</I>&gt;<i> Tom
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i>
</I>&gt;<i> Tom Fanning
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i>
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i>
</I>&gt;<i> David Moles
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">davidmoles at thegogame.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Tom Fanning
</I>&gt;<i> _______________________________________________
</I>&gt;<i> MonoTouch mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">MonoTouch at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monotouch">http://lists.ximian.com/mailman/listinfo/monotouch</A>
</I>&gt;<i>
</I>&gt;<i>
</I>


-- 
Tom Fanning
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003951.html">[MonoTouch] System.MissingMethodException: No constructor found	for	MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
	<LI>Next message: <A HREF="003948.html">[MonoTouch] System.MissingMethodException: No constructor found for MonoTouch.AVFoundation.InternalAVAudioPlayerDelegate::.ctor(System.IntPtr)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3958">[ date ]</a>
              <a href="thread.html#3958">[ thread ]</a>
              <a href="subject.html#3958">[ subject ]</a>
              <a href="author.html#3958">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monotouch">More information about the MonoTouch
mailing list</a><br>
</body></html>
