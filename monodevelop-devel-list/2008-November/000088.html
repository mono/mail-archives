<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-devel] [gendarme] Re:  MD Gendarme Addin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-devel-list%40lists.ximian.com?Subject=%5BMonodevelop-devel%5D%20%5Bgendarme%5D%20Re%3A%20%20MD%20Gendarme%20Addin&In-Reply-To=aec34c770811261517i6cdbe19aocd3e6b872d8452f1%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000087.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-devel] [gendarme] Re:  MD Gendarme Addin</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:monodevelop-devel-list%40lists.ximian.com?Subject=%5BMonodevelop-devel%5D%20%5Bgendarme%5D%20Re%3A%20%20MD%20Gendarme%20Addin&In-Reply-To=aec34c770811261517i6cdbe19aocd3e6b872d8452f1%40mail.gmail.com"
       TITLE="[Monodevelop-devel] [gendarme] Re:  MD Gendarme Addin">sebastien at ximian.com
       </A><BR>
    <I>Wed Nov 26 21:02:33 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000087.html">[Monodevelop-devel] MD Gendarme Addin
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88">[ date ]</a>
              <a href="thread.html#88">[ thread ]</a>
              <a href="subject.html#88">[ subject ]</a>
              <a href="author.html#88">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Luciano,

If you're not already I suggest you subscribe to
<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-devel-list">gendarme at googlegroups.com</A>

On Wed, 2008-11-26 at 18:17 -0500, Michael Hutchinson wrote:
&gt;<i> On Wed, Nov 26, 2008 at 4:02 PM, Luciano _ &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-devel-list">lnc19 at hotmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; HI All:
</I>&gt;<i> &gt;  I was talking to Michael and i will try to start the MonoDevelop Gendarme
</I>&gt;<i> &gt; addin.
</I>&gt;<i> &gt;  I have some affirmations/questions, Based on Michael post [*], that i need
</I>&gt;<i> &gt; to clarify, any help will be helpfull.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1) I use Gendarme with System.Diagnostic.Process to not depend on it.
</I>&gt;<i> 
</I>&gt;<i> Yup, it'll need to run gendarme to produce an xml file in the output
</I>&gt;<i> directory, then read in the XML. The Smokey code analysis addin
</I>&gt;<i> already does this, so that code might be a good starting point.
</I>
Basically you can have:
* one input XML file (optional, but it's how to configure everything);
* a few parameters, like the assemblies being analyzed;
* an ignore-list file (optional, but so useful); and
* one output XML file.

&gt;<i> This is the main priority IMO.
</I>&gt;<i> 
</I>&gt;<i> &gt; 2) I have to make a widget/dialog to setup 
</I>
Before setting up you'll need to know what to setup. This means you must
be able to discover what is available (rules as a minimum, potentially
configurable options later) to present them to the user. 

Today different runners have different strategy. E.g. the console runner
base itself on a file (the rules.xml file shipped w/Gendarme) while the
wizard GUI runner inspects the rules assemblies to find the rules
available. The addin needs is kind of in-between. In any case there's no
need to link with the Gendarme binaries to get the information.

The other important feature IMO is to handle the &quot;ignore-list&quot;, i.e.
stuff you don't want to be warned about the next time you ask for your
code to be analyzed. There should be a way to add to this list and a way
to remove ignored stuff from it.

&gt;<i> Rules.xml file with all the
</I>&gt;<i> &gt; futures: Rules sets, ignore rules, Severity levels, etc.
</I>
Using an XML file you can*

(a) specify which rules are used (or not) during analysis;

(b) define different rule sets (inside the same XML file);

(c) set options on rules [1];

(d) set the applicability of each rule on:
	everything (the default on the console runner);
	code visible outside the assembly;
	code only visible inside the assembly;

        * but you don't need to support all possible options in order to
        have a useful addin ;-)

What you cannot set in the XML file are filters on Severity and
Confidence (i.e. filters on the defects) but you can specify them on the
command-line (since Gendarme 2.2). 

However it may be easier to filter defects later, i.e. not at analysis
time, when you load the XML results (and that would work on Gendarme 2.0
too). This would let users change filtering without re-analyzing the
solution (or projects) which would be faster (since you would need to
reload the results anyway).

&gt;<i> See #4.
</I>&gt;<i> 
</I>&gt;<i> &gt; 3) User must jump to the offending code line/file and an explanation of the
</I>&gt;<i> &gt; fault: This is the hard part, i will try to save log file, an parse it, any
</I>&gt;<i> &gt; other way? (Parse html could be another way, but i think is harder than log
</I>&gt;<i> &gt; file). I didn't see the log file, i didn't know if my approach is correct.
</I>&gt;<i> 
</I>&gt;<i> There's the XML file, which should be very easy to load. The smokey
</I>&gt;<i> addin does this.
</I>
You can use &quot;--xml results.xml&quot; to get the defects inside an XML file.
The text and HTML formats would not only be harder to parse but also
more likely to change too in future releases.

&gt;<i> &gt; 4) I will use One rules.xml file per solution/target (Solution &amp;
</I>&gt;<i> &gt; Debug/Release/Test/etc)
</I>&gt;<i> 
</I>&gt;<i> I'm not sure how rule sets should apply to
</I>&gt;<i> project/solutions/configurations, but this seems like a good model:
</I>&gt;<i> <A HREF="http://blogs.msdn.com/fxcop/archive/2008/11/12/fun-with-code-analysis-rulesets.aspx">http://blogs.msdn.com/fxcop/archive/2008/11/12/fun-with-code-analysis-rulesets.aspx</A>
</I>
In VS.NET people generally defines a target for code analysis - i.e.
where CODE_ANALYSIS is defined (you can see it inside the above link).
This lets attributes, like [SuppressMessage], be compiled into the
assemblies [2]. In the future it's likely people will want contracts to
be part of the analysis (since it gives more clues about the code and
rules are always hungry for clues).

I think people expects to be able to run analysis on both the solution
and on specific projects. It's important to note that running the
analysis on each projects will be a bit different (result wise) than
running it on the solution. This is because some rules works on the set
of assemblies being analyzed (so more assemblies, more complete the
analysis can be and more potential defects can be found). IMO both
options are valid (even if the solution-level analysis is more
complete).

&gt;<i> &gt; 5) Allow to check the rules before checking to VCS.
</I>
That's (quite) an advanced option - but something that you should keep
in mind.

&gt;<i> &gt; 6) Use the MD Code DOM to find things not listed in MDB files. What is this?
</I>&gt;<i> 
</I>&gt;<i> Some analyses might report an error in a member, without having a
</I>&gt;<i> location. MD has an internal type database with lots of line/col/file
</I>&gt;<i> information so this could be a good fallback. Very low priority
</I>&gt;<i> anyway, so don't worry about it :)
</I>
Yes, MDB has some limitations (e.g. fields, attributes) where no line
information is available. Having a fallback, eventually, would be a nice
addition.

&gt;<i> &gt; 7) Add the Gendarme configuration file to the project.
</I>&gt;<i> &gt; 8) Warning message of gendarme result could it be shown in Construction Pad,
</I>&gt;<i> &gt; as &quot;Wanings&quot;.
</I>&gt;<i> 
</I>&gt;<i> It's debatable exactly how gendarme severity should map to
</I>&gt;<i> error/warnings in the errors pad.
</I>
It's unlikely that people will want all of them mixed with compiler
errors and warnings. You would be best to start with a separate view
where filtering and sorting is possible.

Later you might want to give the options, for each rule, to act as an
error, a warning or simply be shown in the code analysis view. That
could be a great place to ask if some defects are &quot;commit
breakers&quot; (point #5).

Don't hesitate to ask any questions (by email or on IRC).
&#65279;Sebastien


[1] Right now the console runner use reflection to set options. Future
versionS of Gendarme (planned for 2.4) will start using System.Component
attributes to advertise rules options in a way that makes it easy to
build an UI on top of it.

[2] The [SuppressMessage] attribute is not supported in current version
of Gendarme - but the infrastructure is already in place (i.e. matching
Gendarme and FxCop rules) to make this possible in the future.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000087.html">[Monodevelop-devel] MD Gendarme Addin
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#88">[ date ]</a>
              <a href="thread.html#88">[ thread ]</a>
              <a href="subject.html#88">[ subject ]</a>
              <a href="author.html#88">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-devel-list">More information about the Monodevelop-devel-list
mailing list</a><br>
</body></html>
