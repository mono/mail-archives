<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-devel] Working on the monodevelop dom after 2.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-devel-list%40lists.ximian.com?Subject=%5BMonodevelop-devel%5D%20Working%20on%20the%20monodevelop%20dom%20after%202.2&In-Reply-To=1253621338.14255.11.camel%40linux-2fwj.site">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000215.html">
   <LINK REL="Next"  HREF="000219.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-devel] Working on the monodevelop dom after 2.2</H1>
    <B>Lluis Sanchez Gual</B> 
    <A HREF="mailto:monodevelop-devel-list%40lists.ximian.com?Subject=%5BMonodevelop-devel%5D%20Working%20on%20the%20monodevelop%20dom%20after%202.2&In-Reply-To=1253621338.14255.11.camel%40linux-2fwj.site"
       TITLE="[Monodevelop-devel] Working on the monodevelop dom after 2.2">lluis at novell.com
       </A><BR>
    <I>Fri Sep 25 13:43:12 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000215.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
        <LI>Next message: <A HREF="000219.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#217">[ date ]</a>
              <a href="thread.html#217">[ thread ]</a>
              <a href="subject.html#217">[ subject ]</a>
              <a href="author.html#217">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>El dt 22 de 09 de 2009 a les 14:08 +0200, en/na Mike Kr&#252;ger va escriure:
&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> Currently we've two DOMs: 
</I>&gt;<i> 
</I>&gt;<i> MonoDevelop DOM
</I>&gt;<i> Language specific DOM
</I>&gt;<i> 
</I>&gt;<i> The idea of the monodevelop dom is that most parts of the IDE only use
</I>&gt;<i> the upper level (namespaces/types/members etc.) of the .NET doms for
</I>&gt;<i> some parts (class browser, quick method navigation etc.). This DOM
</I>&gt;<i> reflects the capabilities of .NET reflection.
</I>&gt;<i> 
</I>&gt;<i> Now some people have the opinion that this limits monodevelop when
</I>&gt;<i> supporting non .NET languages and I think they're right.
</I>&gt;<i> I see that currently the main problem is that monodevelop uses the
</I>&gt;<i> type-&gt;member model.
</I>&gt;<i> I would rather suggest working with a tree model instead, adding some
</I>&gt;<i> new 'types' to be able to do have a file-&gt;member structure.
</I>&gt;<i> 
</I>&gt;<i> I would:
</I>&gt;<i> 
</I>&gt;<i> + Replace IDomVisitable with a tree node - each tree node knows it's
</I>&gt;<i> parent, children and siblings.
</I>&gt;<i> 
</I>&gt;<i> + Remove compilation unit, replace it with IFile. 
</I>&gt;<i> 
</I>&gt;<i> Then it's possible to have file-&gt;methods/fields as well as
</I>&gt;<i> file-&gt;type-&gt;methods/members and the class browser/code navigator can
</I>&gt;<i> show the new 'model' as well. I don't expect huge changes in the current
</I>&gt;<i> code base. The parser database needs to change a bit, but shouldn't
</I>&gt;<i> change much.
</I>
Right now the DOM we have is very .NET centric. It is not just a matter
of DOM structure (e.g. assembly-&gt;namespace-&gt;type-&gt;member), but also
about the semantics of the DOM (for example, all types are subclasses of
System.Object). .NET semantics are everywhere in the DOM.

The problem we have is that we are trying to do too many things with a
single DOM. The MD DOM is used basically for three things:

     1. Fill navigation widgets such as the member/type combos at the
        top of the editor, the document outline or the class pad.
     2. Support code completion for .NET languages. It can be used for
        example to resolve types across all referenced assemblies of a
        project, no matter which language were those assemblies written
        on.
     3. A general purpose DOM, used by add-ins to extract information
        about classes and members and do something with them (for
        example, the Stetic designer uses that to detect classes bound
        to a designer).

The current situation is that if a non .NET language wants to provide
support for 1), we are forcing the use of the MD DOM, even when it
really doesn't fit. And there isn't much gain with that, because that
language won't be really able to leverage 2) and 3). The type resolution
rules of the MD DOM strictly follow the .NET semantics, so it won't be
of much use for non .NET languages. Also, as a general purpose DOM for
the language it won't be really useful because it won't allow expressing
the particularities of the language.

My ideas for improving the situation are the following:

      * Create a new DOM, which would be very high level, with just the
        information required to support 1). It would be a simple DOM,
        intended only for displaying information to the user, not for
        type resolution or other operations.
      * Make it explicit that the current MD DOM is only for .NET
        languages.
      * Each .NET language would implement its own DOM to support code
        completion.
      * Generalize a bit the parser service, so we can share some of its
        logic. We can keep the parser database as it is right now, but
        it would be used only for .NET languages. Non .NET languages
        would use its own DOM storage model. Maybe we wouldn't be able
        to share much, but at least we could share the thread that
        checks for changes and triggers parse operations or something
        like that.

Lluis.


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000215.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
	<LI>Next message: <A HREF="000219.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#217">[ date ]</a>
              <a href="thread.html#217">[ thread ]</a>
              <a href="subject.html#217">[ subject ]</a>
              <a href="author.html#217">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-devel-list">More information about the Monodevelop-devel-list
mailing list</a><br>
</body></html>
