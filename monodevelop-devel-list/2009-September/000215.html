<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-devel] Working on the monodevelop dom after 2.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-devel-list%40lists.ximian.com?Subject=%5BMonodevelop-devel%5D%20Working%20on%20the%20monodevelop%20dom%20after%202.2&In-Reply-To=1a3a3e310909230814g42690f28v3a520338b6f19fcb%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000214.html">
   <LINK REL="Next"  HREF="000217.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-devel] Working on the monodevelop dom after 2.2</H1>
    <B>Mike Kr&#252;ger</B> 
    <A HREF="mailto:monodevelop-devel-list%40lists.ximian.com?Subject=%5BMonodevelop-devel%5D%20Working%20on%20the%20monodevelop%20dom%20after%202.2&In-Reply-To=1a3a3e310909230814g42690f28v3a520338b6f19fcb%40mail.gmail.com"
       TITLE="[Monodevelop-devel] Working on the monodevelop dom after 2.2">mkrueger at novell.com
       </A><BR>
    <I>Thu Sep 24 10:02:52 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000214.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
        <LI>Next message: <A HREF="000217.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#215">[ date ]</a>
              <a href="thread.html#215">[ thread ]</a>
              <a href="subject.html#215">[ subject ]</a>
              <a href="author.html#215">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

&gt;<i> &gt; + Remove compilation unit, replace it with IFile.
</I>&gt;<i> 
</I>&gt;<i> I'm not sure what's the best way to approach this.
</I>&gt;<i> For a lot of languages, file-level separation doesn't make sense: it
</I>&gt;<i> may require the contents of multiple files (whose relationship is not
</I>&gt;<i> explicitly specified at the source level) to build a coherent model
</I>&gt;<i> for any one file (Vala); nodes may be declared and/or defined across
</I>&gt;<i> multiple files (C, C#, Ruby, Python); etc. These issues can be worked
</I>&gt;<i> out / worked around while retaining the IFile model, but IMO they
</I>&gt;<i> /should/ be worked out before any code gets changed.
</I>&gt;<i> 
</I>
Doesn't matter at this level, because it's required to get the file
where the node is declared. That is the main reason for using a IFile
node. To define cross file nodes (like partial types in c#) it's
required to do something like the CompoundType. This doesn't change - in
contrast it makes more sense, because now CompoundType has a compilation
unit attached which is really senseless for this type.

&gt;<i> &gt; Then it's possible to have file-&gt;methods/fields as well as
</I>&gt;<i> &gt; file-&gt;type-&gt;methods/members and the class browser/code navigator can
</I>&gt;<i> &gt; show the new 'model' as well. I don't expect huge changes in the current
</I>&gt;<i> &gt; code base. The parser database needs to change a bit, but shouldn't
</I>&gt;<i> &gt; change much.
</I>&gt;<i> 
</I>&gt;<i> It would be nice to have a more &quot;global&quot; (per-solution? per-project?)
</I>&gt;<i> builtin parse db that's a sink for any/all parse operations, and _the_
</I>&gt;<i> source for completion, quickfinder, folding, class browser,
</I>&gt;<i> refactoring, etc.
</I>&gt;<i> 
</I>
We've a 'builtin' parse db where all parse operations 'should' occur -
this is the source for completion, class browser, folding markers and
quick finder.

The problem is refactoring and folding. Folding can be partially done
for all languages but refactoring (and the resolving for completion) is
language bound. I've tried to merge at least c#/vb.net in the past but I
doubt that this did really make sense - at least there are always nodes
or properties that are incompatible with language X. This makes the DOM
harder to handle and visitors or analyzers harder to write/maintain.

But what can be done is dom node sharing - having the language bound dom
using the monodevelop dom structures, wrapping the monodevelop
interfaces (this will safe one tree conversion). But at the end the DOMs
are still distinct. But I would like to have more shared data structures
(for example having always translate the coordinates NRefactor location
&lt;-&gt; DOM location &lt;-&gt; DocumentLocation &lt;-&gt; text offsets can drive me
crazy, as well as IReturnType &lt;-&gt; TypeReference).

I think that language bindings need to bring their own dom for
refactoring, resolving and code formatting. These things are strictly
bound to the language and can't be abstracted - except for having two
very similiar languages (but even than it has a price).
But the good thing is that much other stuff can be shared - that's what
the monodevlop DOM is for. 

But there should be a central point where the language specific DOM
should be available (I think the Document is the right place).

Regards
Mike 

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000214.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
	<LI>Next message: <A HREF="000217.html">[Monodevelop-devel] Working on the monodevelop dom after 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#215">[ date ]</a>
              <a href="thread.html#215">[ thread ]</a>
              <a href="subject.html#215">[ subject ]</a>
              <a href="author.html#215">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-devel-list">More information about the Monodevelop-devel-list
mailing list</a><br>
</body></html>
