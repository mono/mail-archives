<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] 0.17 bug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="010480.html">
   <LINK REL="Next"  HREF="010488.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] 0.17 bug
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] 0.17 bug">lupus@ximian.com
       </A><BR>
    <I>Wed, 18 Dec 2002 15:54:45 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="010480.html">[Mono-list] 0.17 bug
</A></li>
        <LI> Next message: <A HREF="010488.html">[Mono-list] 0.17 bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10482">[ date ]</a>
              <a href="thread.html#10482">[ thread ]</a>
              <a href="subject.html#10482">[ subject ]</a>
              <a href="author.html#10482">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/18/02 Jeroen Frijters wrote:
&gt;<i> I tried to run &quot;Hello World&quot; (compiled from Java, see <A HREF="http://jeroen.nu/">http://jeroen.nu/</A>)
</I>&gt;<i> with the 0.17 (windows) build and got:
</I>&gt;<i>  at slot 24: hashCode (-1) overrides GetHashCode (4)
</I>&gt;<i>  at slot 24: equals (-1) overrides Equals (0)
</I>&gt;<i>  at slot 24: toString (-1) overrides ToString (7)
</I>&gt;<i> no implementation for interface method java.lang.reflect.Member::.cctor() in
</I>&gt;<i> class java.lang.reflect.Constructor
</I>[...]
&gt;<i> &lt;message box&gt;
</I>&gt;<i> ** ERROR **: file class.c: line 693 (mono_class_setup_vtable): should not be
</I>&gt;<i> reached
</I>&gt;<i> aborting...
</I>&gt;<i> &lt;/message box&gt;
</I>&gt;<i> 
</I>&gt;<i> It seems that static methods in interfaces aren't handled correctly. Also,
</I>
Apply this patch in mono/metadata:

Index: class.c
===================================================================
RCS file: /cvs/public/mono/mono/metadata/class.c,v
retrieving revision 1.140
diff -u -r1.140 class.c
--- class.c	11 Dec 2002 17:27:56 -0000	1.140
+++ class.c	18 Dec 2002 14:44:19 -0000
@@ -672,7 +672,9 @@
 			if (!(class-&gt;flags &amp; TYPE_ATTRIBUTE_ABSTRACT)) {
 				for (l = 0; l &lt; ic-&gt;method.count; l++) {
 					char *msig;
-					MonoMethod *im = ic-&gt;methods [l];						
+					MonoMethod *im = ic-&gt;methods [l];
+					if (im-&gt;flags &amp; METHOD_ATTRIBUTE_STATIC)
+							continue;
 					g_assert (io + l &lt;= max_vtsize);
 					if (!(vtable [io + l])) {
 						for (j = 0; j &lt; onum; ++j) {

&gt;<i> why are the first three lines printed?
</I>
It's part of the debug output for the error: we'll disable it and raise
an exception when mono is more mature.

I downloaded the binaries and compiled a hello world app. After the
change to class.c it still doesn't work, put it looks promising:

<A HREF="mailto:lupus@luna">lupus@luna</A>:/mnt/net/ikvm$ mono helloj.exe 
caught: System.NotImplementedException, handler: java.lang.Exception
System.NotImplementedException: The requested feature is not yet implemented
in &lt;0x0002f&gt; 00 System.Xml.Serialization.XmlSerializer:Deserialize (System.IO.Stream)
in &lt;0x0024f&gt; 00 .ClassLoaderWrapper:LoadRemappedTypes ()
in &lt;0x00058&gt; 00 .ClassLoaderWrapper:GetBootstrapClassLoader ()
in &lt;0x0001a&gt; 00 .ClassLoaderWrapper:GetType (string)
in &lt;0x00073&gt; 00 .ExceptionHelper:MapException (System.Exception,System.Type)
in &lt;0x003e9&gt; 00 gnu.java.io.EncodingManager:findDecoderConstructor (string,bool)
in &lt;0x001c2&gt; 00 gnu.java.io.EncodingManager:.cctor ()

It would help to know what the xml serialization is used for, maybe for
some simple types it's easy to implement to get ik.vm going.

Thanks!

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="010480.html">[Mono-list] 0.17 bug
</A></li>
	<LI> Next message: <A HREF="010488.html">[Mono-list] 0.17 bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10482">[ date ]</a>
              <a href="thread.html#10482">[ thread ]</a>
              <a href="subject.html#10482">[ subject ]</a>
              <a href="author.html#10482">[ author ]</a>
         </LI>
       </UL>
</body></html>
