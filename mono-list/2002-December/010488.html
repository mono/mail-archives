<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] 0.17 bug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jeroen%40sumatra.nl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="010482.html">
   <LINK REL="Next"  HREF="010486.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] 0.17 bug
   </H1>
    <B>Jeroen Frijters
    </B> 
    <A HREF="mailto:jeroen%40sumatra.nl"
       TITLE="[Mono-list] 0.17 bug">jeroen@sumatra.nl
       </A><BR>
    <I>Wed, 18 Dec 2002 16:19:41 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="010482.html">[Mono-list] 0.17 bug
</A></li>
        <LI> Next message: <A HREF="010486.html">[Mono-list] 0.17 bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10488">[ date ]</a>
              <a href="thread.html#10488">[ thread ]</a>
              <a href="subject.html#10488">[ subject ]</a>
              <a href="author.html#10488">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Paolo,

The XmlSerializer is currently used to parse the XML file (actually an
embedded resource in ik.vm.net.dll) that contains the type remapping
information. It's pretty trivial stuff, look at remapper.cs to see the
object model that is used. It's not too important though, because I'm going
to go to a scheme were the XML file is compiled statically into a DLL
instead of parsed at runtime.

BTW, since I'm too lame to build Mono, if anyone could mail me a new build
(for Windows) including the patch below, that would be really cool.

Regards,
Jeroen

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> 
</I>&gt;<i> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>] On Behalf Of Paolo Molaro
</I>&gt;<i> Sent: Wednesday, December 18, 2002 15:55
</I>&gt;<i> To: <A HREF="mailto:mono-list@go-mono.com">mono-list@go-mono.com</A>
</I>&gt;<i> Subject: Re: [Mono-list] 0.17 bug
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 12/18/02 Jeroen Frijters wrote:
</I>&gt;<i> &gt; I tried to run &quot;Hello World&quot; (compiled from Java, see 
</I>&gt;<i> <A HREF="http://jeroen.nu/">http://jeroen.nu/</A>)
</I>&gt;<i> &gt; with the 0.17 (windows) build and got:
</I>&gt;<i> &gt;  at slot 24: hashCode (-1) overrides GetHashCode (4)
</I>&gt;<i> &gt;  at slot 24: equals (-1) overrides Equals (0)
</I>&gt;<i> &gt;  at slot 24: toString (-1) overrides ToString (7)
</I>&gt;<i> &gt; no implementation for interface method 
</I>&gt;<i> java.lang.reflect.Member::.cctor() in
</I>&gt;<i> &gt; class java.lang.reflect.Constructor
</I>&gt;<i> [...]
</I>&gt;<i> &gt; &lt;message box&gt;
</I>&gt;<i> &gt; ** ERROR **: file class.c: line 693 
</I>&gt;<i> (mono_class_setup_vtable): should not be
</I>&gt;<i> &gt; reached
</I>&gt;<i> &gt; aborting...
</I>&gt;<i> &gt; &lt;/message box&gt;
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; It seems that static methods in interfaces aren't handled 
</I>&gt;<i> correctly. Also,
</I>&gt;<i> 
</I>&gt;<i> Apply this patch in mono/metadata:
</I>&gt;<i> 
</I>&gt;<i> Index: class.c
</I>&gt;<i> ===================================================================
</I>&gt;<i> RCS file: /cvs/public/mono/mono/metadata/class.c,v
</I>&gt;<i> retrieving revision 1.140
</I>&gt;<i> diff -u -r1.140 class.c
</I>&gt;<i> --- class.c	11 Dec 2002 17:27:56 -0000	1.140
</I>&gt;<i> +++ class.c	18 Dec 2002 14:44:19 -0000
</I>&gt;<i> @@ -672,7 +672,9 @@
</I>&gt;<i>  			if (!(class-&gt;flags &amp; TYPE_ATTRIBUTE_ABSTRACT)) {
</I>&gt;<i>  				for (l = 0; l &lt; ic-&gt;method.count; l++) {
</I>&gt;<i>  					char *msig;
</I>&gt;<i> -					MonoMethod *im = 
</I>&gt;<i> ic-&gt;methods [l];						
</I>&gt;<i> +					MonoMethod *im = 
</I>&gt;<i> ic-&gt;methods [l];
</I>&gt;<i> +					if (im-&gt;flags &amp; 
</I>&gt;<i> METHOD_ATTRIBUTE_STATIC)
</I>&gt;<i> +							continue;
</I>&gt;<i>  					g_assert (io + l &lt;= max_vtsize);
</I>&gt;<i>  					if (!(vtable [io + l])) {
</I>&gt;<i>  						for (j = 0; j &lt; 
</I>&gt;<i> onum; ++j) {
</I>&gt;<i> 
</I>&gt;<i> &gt; why are the first three lines printed?
</I>&gt;<i> 
</I>&gt;<i> It's part of the debug output for the error: we'll disable it 
</I>&gt;<i> and raise
</I>&gt;<i> an exception when mono is more mature.
</I>&gt;<i> 
</I>&gt;<i> I downloaded the binaries and compiled a hello world app. After the
</I>&gt;<i> change to class.c it still doesn't work, put it looks promising:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="mailto:lupus@luna">lupus@luna</A>:/mnt/net/ikvm$ mono helloj.exe 
</I>&gt;<i> caught: System.NotImplementedException, handler: java.lang.Exception
</I>&gt;<i> System.NotImplementedException: The requested feature is not 
</I>&gt;<i> yet implemented
</I>&gt;<i> in &lt;0x0002f&gt; 00 
</I>&gt;<i> System.Xml.Serialization.XmlSerializer:Deserialize (System.IO.Stream)
</I>&gt;<i> in &lt;0x0024f&gt; 00 .ClassLoaderWrapper:LoadRemappedTypes ()
</I>&gt;<i> in &lt;0x00058&gt; 00 .ClassLoaderWrapper:GetBootstrapClassLoader ()
</I>&gt;<i> in &lt;0x0001a&gt; 00 .ClassLoaderWrapper:GetType (string)
</I>&gt;<i> in &lt;0x00073&gt; 00 .ExceptionHelper:MapException 
</I>&gt;<i> (System.Exception,System.Type)
</I>&gt;<i> in &lt;0x003e9&gt; 00 
</I>&gt;<i> gnu.java.io.EncodingManager:findDecoderConstructor (string,bool)
</I>&gt;<i> in &lt;0x001c2&gt; 00 gnu.java.io.EncodingManager:.cctor ()
</I>&gt;<i> 
</I>&gt;<i> It would help to know what the xml serialization is used for, 
</I>&gt;<i> maybe for
</I>&gt;<i> some simple types it's easy to implement to get ik.vm going.
</I>&gt;<i> 
</I>&gt;<i> Thanks!
</I>&gt;<i> 
</I>&gt;<i> lupus
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> -----------------------------------------------------------------
</I>&gt;<i> <A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
</I>&gt;<i> <A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> 
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="010482.html">[Mono-list] 0.17 bug
</A></li>
	<LI> Next message: <A HREF="010486.html">[Mono-list] 0.17 bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10488">[ date ]</a>
              <a href="thread.html#10488">[ thread ]</a>
              <a href="subject.html#10488">[ subject ]</a>
              <a href="author.html#10488">[ author ]</a>
         </LI>
       </UL>
</body></html>
