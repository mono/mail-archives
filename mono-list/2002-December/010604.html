<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Trusted_connection with the ADO.NET providers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:danmorg%40sc.rr.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="010599.html">
   <LINK REL="Next"  HREF="010603.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Trusted_connection with the ADO.NET providers
   </H1>
    <B>Daniel Morgan
    </B> 
    <A HREF="mailto:danmorg%40sc.rr.com"
       TITLE="[Mono-list] Trusted_connection with the ADO.NET providers">danmorg@sc.rr.com
       </A><BR>
    <I>Sat, 21 Dec 2002 12:01:44 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="010599.html">[Mono-list] Re: Mono-list digest, Vol 1 #660 - 22 msgs
</A></li>
        <LI> Next message: <A HREF="010603.html">[Mono-list] Nunit2 tests for corlib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10604">[ date ]</a>
              <a href="thread.html#10604">[ thread ]</a>
              <a href="subject.html#10604">[ subject ]</a>
              <a href="author.html#10604">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Bob,

You are trying to use trusted connections.  None of the data providers in
Mono support trusted connections (Windows Authentication).  When connecting,
let the database server authenticate the user.  A default installation of
Microsoft SQL Server 2000 only does Windows authentication.  You have to
change this to Mixed mode or SQL Server authentication mode.

Here is a connection string for an ODBC DSN that uses SQL Server
authentication to connect to a Microsoft SQL Server 7/2000:

&quot;DSN=SqlServerDsn;UID=someuser;PWD=somepass&quot;

Here is a connection string for the SqlClient data provider:

&quot;Server=MYCOMPUTERNAME;Database=pubs;User ID=someuser;Password=somepass&quot;

Make sure the SQL Server database is set to authenticate the user via SQL
Server.

If you want to learn more about how to get the SqlClient and ODBC data
providers to use Windows or Windows Domain Authentication, try contacting
the FreeTDS developers.  I believe these people have found a way to connect
to SQL Server with Windows Domain authentication from a non-windows machine.
See <A HREF="http://www.freetds.org/">http://www.freetds.org/</A> and subscribe to their mailing list.

Daniel

-----Original Message-----
From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>]On
Behalf Of B Johnson
Sent: Saturday, December 21, 2002 9:33 AM
To: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
Subject: [Mono-list] Re: Mono-list digest, Vol 1 #660 - 22 msgs


Hello,

I was just looking at the features that are available for the ODBC Data
Provider on the web site and  I decided to write up some test code for
&quot;Insert&quot;, &quot;Delete&quot;, Update&quot;. I just compiled my Insert test (Which is using
an Access 200 database) and the code compiles ok with mono but the insert is
not happening. I also compile this same code with CSC and the code does
insert the recode ok.  The OS I am using to test this is windows XP
Professional. I have attached the code I used at the end of my posting.

I also have a question. Is it ok to do more of this kind of ODBC testing? IS
there some sort of test plan to use for these types of test?

Bob J

My test Code:
// created on 12/21/2002 at 8:33 AM

//

// OdbcTest.cs - Test for the ODBC ADO.NET Provider in System.Data.Odbc

//

//

//

//

// Author:

// Bob Johnson &lt;<A HREF="mailto:bobjohnson11@comcast.net">bobjohnson11@comcast.net</A>&gt;

//

using System;

using System.Data;

using System.Data.Odbc;

namespace Test.OdbcInsertTest

{

class OdbcInsertTest

{

[STAThread]

static void Main(string[] args)

{

OdbcConnection dbcon = new OdbcConnection();

// connection string to a Microsoft SQL Server 2000 database

// that does not use a DSN

//dbcon.ConnectionString =

// &quot;DRIVER={SQL Server};&quot; +

// &quot;SERVER=(local);&quot; +

// &quot;Trusted_connection=true;&quot; +

// &quot;DATABASE=pubs;&quot;;

// connection string that uses a DSN.

dbcon.ConnectionString =

&quot;DSN=testdb;UID=sa;PWD=&quot;;

int rowsAffected;

dbcon.Open();

OdbcCommand dbcmd = new OdbcCommand();

dbcmd.Connection = dbcon;

dbcmd.CommandType = CommandType.Text;

//dbcmd.CommandText = &quot;SELECT LastName FROM address&quot;;

dbcmd.CommandText = &quot;Insert into Address&quot; + &quot;(FirstName, LastName, Phone)&quot; +
&quot;values ('Robert', 'Johnson', '212-111-1111')&quot;;

rowsAffected= dbcmd.ExecuteNonQuery();

Console.WriteLine (&quot;Rows Affected: &quot; + rowsAffected);

dbcon.Close();


}

}

}



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="010599.html">[Mono-list] Re: Mono-list digest, Vol 1 #660 - 22 msgs
</A></li>
	<LI> Next message: <A HREF="010603.html">[Mono-list] Nunit2 tests for corlib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10604">[ date ]</a>
              <a href="thread.html#10604">[ thread ]</a>
              <a href="subject.html#10604">[ subject ]</a>
              <a href="author.html#10604">[ author ]</a>
         </LI>
       </UL>
</body></html>
