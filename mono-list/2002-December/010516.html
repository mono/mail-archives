<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono/.NET delegate incompatibility
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tum%40veridicus.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="010503.html">
   <LINK REL="Next"  HREF="010528.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono/.NET delegate incompatibility
   </H1>
    <B>Tum
    </B> 
    <A HREF="mailto:tum%40veridicus.com"
       TITLE="[Mono-list] Mono/.NET delegate incompatibility">tum@veridicus.com
       </A><BR>
    <I>Thu, 19 Dec 2002 12:43:57 +1300</I>
    <P><UL>
        <LI> Previous message: <A HREF="010503.html">[Mono-list] Mono/.NET delegate incompatibility
</A></li>
        <LI> Next message: <A HREF="010528.html">[Mono-list] Mono/.NET delegate incompatibility
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10516">[ date ]</a>
              <a href="thread.html#10516">[ thread ]</a>
              <a href="subject.html#10516">[ subject ]</a>
              <a href="author.html#10516">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I guess the default calling convention in mono is cdecl.  According to
MSDN, the default calling convention for dllimport should be stdcall
(which IMHO really only makes sense on windows).

You could try setting the CallingConvention property on the DllImport to
cdecl.

e.g.

[DllImport(&quot;mydll.dll&quot;, CallingConvention=CallingConvention.Cdecl)]
public static extern void myfunc(int x);

^Tum

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>]
</I>On
&gt;<i> Behalf Of J. Perkins
</I>&gt;<i> Sent: Thursday, 19 December 2002 9:24 a.m.
</I>&gt;<i> To: Mono-L
</I>&gt;<i> Subject: [Mono-list] Mono/.NET delegate incompatibility
</I>&gt;<i> 
</I>&gt;<i> I am using a delegate to pass a function pointer into a unmanaged DLL.
</I>&gt;<i> Under Linux/Mono everything works fine. Under Windows/.NET, my
</I>callback
&gt;<i> function signature must look like this:
</I>&gt;<i> 
</I>&gt;<i>   void (__stdcall *func)(int);
</I>&gt;<i> 
</I>&gt;<i> But Windows/Mono seems to want:
</I>&gt;<i> 
</I>&gt;<i>   void (*func)(int);
</I>&gt;<i> 
</I>&gt;<i> Changing the signature will cause the other CLR to corrupt the stack.
</I>&gt;<i> 
</I>&gt;<i> Jason
</I>&gt;<i> 379
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="010503.html">[Mono-list] Mono/.NET delegate incompatibility
</A></li>
	<LI> Next message: <A HREF="010528.html">[Mono-list] Mono/.NET delegate incompatibility
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10516">[ date ]</a>
              <a href="thread.html#10516">[ thread ]</a>
              <a href="subject.html#10516">[ subject ]</a>
              <a href="author.html#10516">[ author ]</a>
         </LI>
       </UL>
</body></html>
