<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> Fwd: [Mono-list] https server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Fwd%3A%20%5BMono-list%5D%20https%20server&In-Reply-To=e1b2e97f0604270633j6ccdcaf9r%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031446.html">
   <LINK REL="Next"  HREF="031431.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Fwd: [Mono-list] https server</H1>
    <B>Pere Rodr&#237;guez</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Fwd%3A%20%5BMono-list%5D%20https%20server&In-Reply-To=e1b2e97f0604270633j6ccdcaf9r%40mail.gmail.com"
       TITLE="Fwd: [Mono-list] https server">pere.rodriguez.rodriguez at gmail.com
       </A><BR>
    <I>Thu Apr 27 09:35:33 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="031446.html">[Mono-list] RE: target:winexe in MonoDevelop  WAS: where is
	System.Windows.Forms ?
</A></li>
        <LI>Next message: <A HREF="031431.html">[Mono-list] https server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31430">[ date ]</a>
              <a href="thread.html#31430">[ thread ]</a>
              <a href="subject.html#31430">[ subject ]</a>
              <a href="author.html#31430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>---------- Forwarded message ----------
From: Pere Rodr&#237;guez &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">pere.rodriguez.rodriguez at gmail.com</A>&gt;
Date: 27/04/2006 15:33
Subject: Re: [Mono-list] https server
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sebastien.pouliot at gmail.com</A>


Hello Sebastien,

sorry, the correct command is:

xsp --https --port 443 --p12file cert.p12 --pkpwd abc

I forgot to type password. The PKCS#12 file has password.

The -12243 error appears in firefox.

I test on mono 1.1.13.4-1 and it run ok, and in mono 1.1.13.6-3 it
doesn't run. Perhaps I don't have installed some paquet ???

If I sniff the network I see this ssl result:

Client (firefox)   Server (xsp)
ClientHello --&gt;
&lt;-- ServerHello
&lt;-- Certificate    (the certificate that send is ok)
&lt;-- ServerKeyExchange  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
&lt;-- Alert:Warning:InternalError
Alert:Fatal:UnexpectedMessage --&gt;

If I program my https server, in firefox I obtain the same error, and
the ssl handshake is the same (..., certificate, serverkeyexchange,
...). Now I obtain this mono error:

System.IO.IOException: The authentication or decryption has failed.
---&gt; System.NotSupportedException: Operation is not supported.
in [0x00005] (at
/home/ingo/mono-1.1.13.6/mcs/class/Mono.Security/Mono.Security.Protocol.Tls.Handshake.Server/TlsServerKeyExchange.cs:51)
Mono.Security.Protocol.Tls.Handshake.Server.TlsServerKeyExchange:Update
()
in [0x00019] (at
/home/ingo/mono-1.1.13.6/mcs/class/Mono.Security/Mono.Security.Protocol.Tls/RecordProtocol.cs:663)
Mono.Security.Protocol.Tls.RecordProtocol:InternalSendRecordCallback
(IAsyncResult ar)--- End of inner exception stack trace ---

in [0x00054] (at
/home/ingo/mono-1.1.13.6/mcs/class/Mono.Security/Mono.Security.Protocol.Tls/SslStreamBase.cs:107)
Mono.Security.Protocol.Tls.SslStreamBase:AsyncHandshakeCallback
(IAsyncResult asyncResult)

The same source works fine in mono 1.1.13.4-1, but in 1.1.13.6 appears
this error.

Now I will install more mono packages (I think that I don't need them
...) and, if the error persist, I will install mono 1.1.15 from bin
installer, but I don't like it, I prefer debian packages.

Thanks in advance,

pere


2006/4/27, Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sebastien.pouliot at gmail.com</A>&gt;:
&gt;<i> Hello Pere,
</I>&gt;<i>
</I>&gt;<i> On Thu, 2006-04-27 at 08:49 +0200, Pere Rodr&#237;guez wrote:
</I>&gt;<i> &gt; Hello Sebastien,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; at the moment I don't use client certificate,
</I>&gt;<i>
</I>&gt;<i> Ah, the article you referenced confused me.
</I>&gt;<i>
</I>&gt;<i> &gt; I do:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; xsp --https --port 443 --p12file cert.p12 --pkpwd
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; and it doesn't run ok, with firefox appears -12243 error.
</I>&gt;<i>
</I>&gt;<i> Where ? on XSP console or in FireFox ?
</I>&gt;<i>
</I>&gt;<i> &gt; I test that with mono 1.1.13.4-1 it runs but with 1.1.13.6-3 it
</I>&gt;<i> &gt; doesn't run. Xsp always is 1.1.13-1 version. I work with debian sid.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Some idea?
</I>&gt;<i>
</I>&gt;<i> I recall a change was done to handle PKCS#12 empty password (but I'm
</I>&gt;<i> unsure when). Try generating a PKCS#12 file with a password.
</I>&gt;<i>
</I>&gt;<i> &gt; Thanks in advance,
</I>&gt;<i>
</I>&gt;<i> No problem, but please continue to c.c. the mailing-list so all problems
</I>&gt;<i> (and solutions) can be indexed.
</I>&gt;<i>
</I>&gt;<i> &gt; pere
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 2006/4/24, Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sebastien.pouliot at gmail.com</A>&gt;:
</I>&gt;<i> &gt; &gt; Hello Pere,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I can do almost any steps in the wiki without problem. However it seems
</I>&gt;<i> &gt; &gt; that wget 1.10 changed it's SSL options and doesn't accept the
</I>&gt;<i> &gt; &gt; certificate as it used to (in version 1.9.1).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Now, even then I do not get the same error as you are describing. This
</I>&gt;<i> &gt; &gt; may be due to how you created the certificates (and/or executed XSP).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Also note that executing &quot;wget <A HREF="https://estudion/cctest.aspx&quot;">https://estudion/cctest.aspx&quot;</A> doesn't
</I>&gt;<i> &gt; &gt; send any client certificate, so an error is normal if XSP is running
</I>&gt;<i> &gt; &gt; with the --https-client-require parameter.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; On Mon, 2006-04-24 at 09:45 +0200, Pere Rodr&#237;guez wrote:
</I>&gt;<i> &gt; &gt; &gt; Hello,
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I'm testing <A HREF="http://www.mono-project.com/UsingClientCertificatesWithXSP">http://www.mono-project.com/UsingClientCertificatesWithXSP</A>
</I>&gt;<i> &gt; &gt; &gt; example and when I execute wget <A HREF="https://localhost/cctest.aspx">https://localhost/cctest.aspx</A> I obtain
</I>&gt;<i> &gt; &gt; &gt; this error:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">prr at estudion</A>:~/pki$ wget <A HREF="https://estudion/cctest.aspx">https://estudion/cctest.aspx</A>
</I>&gt;<i> &gt; &gt; &gt; --09:38:30--  <A HREF="https://estudion/cctest.aspx">https://estudion/cctest.aspx</A>
</I>&gt;<i> &gt; &gt; &gt;            =&gt; `cctest.aspx'
</I>&gt;<i> &gt; &gt; &gt; S'est&#224; resolguent estudion... 127.0.0.1
</I>&gt;<i> &gt; &gt; &gt; Connecting to estudion|127.0.0.1|:443... connexi&#243; establerta.
</I>&gt;<i> &gt; &gt; &gt; OpenSSL: error:1408D078:SSL routines:SSL3_GET_KEY_EXCHANGE:bad rsa e length
</I>&gt;<i> &gt; &gt; &gt; No s'ha pogut establir la connexi&#243; SSL.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I created PKCS#12 with openssl and with makecert and the error always
</I>&gt;<i> &gt; &gt; &gt; is the same.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I also test <A HREF="http://pages.infinit.net/ctech/200411.html">http://pages.infinit.net/ctech/200411.html</A> example and the
</I>&gt;<i> &gt; &gt; &gt; error with wget is the same. With this example the mono error is:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; System.IO.IOException: The authentication or decryption has failed.
</I>&gt;<i> &gt; &gt; &gt; ---&gt; System.NotSupportedException: Operation is not supported.
</I>&gt;<i> &gt; &gt; &gt; in [0x00005] (at
</I>&gt;<i> &gt; &gt; &gt; /home/ingo/mono-1.1.13.6/mcs/class/Mono.Security/Mono.Security.Protocol.Tls.Handshake.Server/TlsServerKeyExchange.cs:51)
</I>&gt;<i> &gt; &gt; &gt; Mono.Security.Protocol.Tls.Handshake.Server.TlsServerKeyExchange:Update
</I>&gt;<i> &gt; &gt; &gt; ()
</I>&gt;<i> &gt; &gt; &gt; in [0x00019] (at
</I>&gt;<i> &gt; &gt; &gt; /home/ingo/mono-1.1.13.6/mcs/class/Mono.Security/Mono.Security.Protocol.Tls/RecordProtocol.cs:663)
</I>&gt;<i> &gt; &gt; &gt; Mono.Security.Protocol.Tls.RecordProtocol:InternalSendRecordCallback
</I>&gt;<i> &gt; &gt; &gt; (IAsyncResult ar)--- End of inner exception stack trace ---
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; in [0x00054] (at
</I>&gt;<i> &gt; &gt; &gt; /home/ingo/mono-1.1.13.6/mcs/class/Mono.Security/Mono.Security.Protocol.Tls/SslStreamBase.cs:107)
</I>&gt;<i> &gt; &gt; &gt; Mono.Security.Protocol.Tls.SslStreamBase:AsyncHandshakeCallback
</I>&gt;<i> &gt; &gt; &gt; (IAsyncResult asyncResult)
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Thanks in advance,
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; pere
</I>&gt;<i> &gt; &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; &gt; Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> &gt; &gt; --
</I>&gt;<i> &gt; &gt; Sebastien Pouliot  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sebastien at ximian.com</A>&gt;
</I>&gt;<i> &gt; &gt; Blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> --
</I>&gt;<i> Sebastien Pouliot  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sebastien at ximian.com</A>&gt;
</I>&gt;<i> Blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031446.html">[Mono-list] RE: target:winexe in MonoDevelop  WAS: where is
	System.Windows.Forms ?
</A></li>
	<LI>Next message: <A HREF="031431.html">[Mono-list] https server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31430">[ date ]</a>
              <a href="thread.html#31430">[ thread ]</a>
              <a href="subject.html#31430">[ subject ]</a>
              <a href="author.html#31430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
