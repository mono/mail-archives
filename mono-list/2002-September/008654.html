<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Some news about a CORBA ORB implementation for.Net
 framework
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jonpryor%40vt.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="008648.html">
   <LINK REL="Next"  HREF="008673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Some news about a CORBA ORB implementation for.Net
 framework
   </H1>
    <B>Jonathan Pryor
    </B> 
    <A HREF="mailto:jonpryor%40vt.edu"
       TITLE="[Mono-list] Some news about a CORBA ORB implementation for.Net
 framework">jonpryor@vt.edu
       </A><BR>
    <I>25 Sep 2002 21:27:20 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="008648.html">[Mono-list] Some news about a CORBA ORB implementation for.Net
 framework
</A></li>
        <LI> Next message: <A HREF="008673.html">[Mono-list] Some news about a CORBA ORB implementation for.Net
 framework
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8654">[ date ]</a>
              <a href="thread.html#8654">[ thread ]</a>
              <a href="subject.html#8654">[ subject ]</a>
              <a href="author.html#8654">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 2002-09-25 at 18:49, Miguel de Icaza wrote:
&gt;<i> &gt; some &quot;bits&quot; like the IIOP encoding, but it is doubtful how useful that
</I>&gt;<i> &gt; &gt; really is.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; The in-proc features are cool, but it would need things to be
</I>&gt;<i> &gt; &gt; implemented with the ORBit model in mind, and not with a C# mind set.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; How else would we acomplish binding of bonobo objects?
</I>&gt;<i> 
</I>&gt;<i> There are two ways of integrating with Bonobo:
</I>&gt;<i> 
</I>&gt;<i> 	* At the binding level, just be a user, and not an 
</I>&gt;<i> 	  implementor:  Use Gtk# to produce the binding
</I>&gt;<i> 
</I>&gt;<i> 	* At the interface-level, a pure Bonobo# implementation
</I>&gt;<i> 	  would have to implement the Bonobo interfaces and a set of
</I>&gt;<i> 	  the helper functions.  
</I>&gt;<i>
</I>&gt;<i> Miguel.
</I>

Uh, yuck?  Let me get this straight: if I want to implement Bonobo CORBA
interfaces from C#, I'll have to manually implement Bonobo::Unknown (or
use helper functions that in turn implement Bonobo::Unknown).  Again, I
say: yuck.

This is where Bonobo use should follow COM-interop, as COM and Bonobo
are similar models

COM-interop has two parts.  The first part allows .NET classes to use
COM objects.  This would be equivalent to using Gtk# to produce a
binding, as you suggested above.

The second part allows COM objects to call .NET objects.  See:
<A HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconexposingnetframeworkcomponentstocom.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconexposingnetframeworkcomponentstocom.asp</A>

The summary is that when a COM application creates a COM object which is
actually a .NET object, it doesn't get the .NET object.  It gets a &quot;COM
Callable Wrapper&quot; (CCW), which handles the mundane issues of IUnknown,
such as QueryInterface (easily handled through run-time type checking),
AddRef, and Release, all of which have equivalents in Bonobo::Unknown.

This makes it very clean for a .NET object to implement a COM
interface.  The .NET object doesn't worry about
IUnknown::QueryInterface; the CCW can handle it.  Ditto for
IUnknown::AddRef and IUnknown::Release.  The .NET object is garbage
collected; why would it care about the reference count, anyway?

For more information on COM Callable Wrappers:
<A HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconcomcallablewrapper.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconcomcallablewrapper.asp</A>

What mono needs is a Bonobo Callable Wrapper. :-)

The downside to this approach is that it requires runtime support, which
is likely preferable to developers who need to inter-operate with Bonobo
objects.

 - Jon





</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="008648.html">[Mono-list] Some news about a CORBA ORB implementation for.Net
 framework
</A></li>
	<LI> Next message: <A HREF="008673.html">[Mono-list] Some news about a CORBA ORB implementation for.Net
 framework
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8654">[ date ]</a>
              <a href="thread.html#8654">[ thread ]</a>
              <a href="subject.html#8654">[ subject ]</a>
              <a href="author.html#8654">[ author ]</a>
         </LI>
       </UL>
</body></html>
