<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mcs compiles on linux. Now what?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lewism%40businesslogic.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003934.html">
   <LINK REL="Next"  HREF="003911.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mcs compiles on linux. Now what?
   </H1>
    <B>Mark Lewis
    </B> 
    <A HREF="mailto:lewism%40businesslogic.com"
       TITLE="[Mono-list] mcs compiles on linux. Now what?">lewism@businesslogic.com
       </A><BR>
    <I>Fri, 8 Mar 2002 09:29:18 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="003934.html">[Mono-list] Array.GetEnumerator()
</A></li>
        <LI> Next message: <A HREF="003911.html">[Mono-list] mcs compiles on linux. Now what?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3909">[ date ]</a>
              <a href="thread.html#3909">[ thread ]</a>
              <a href="subject.html#3909">[ subject ]</a>
              <a href="author.html#3909">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This message is in MIME format. Since your mail reader does not understand
this format, some or all of this message may not be legible.

--------------InterScan_NT_MIME_Boundary
Content-Type: multipart/alternative;
	boundary=&quot;----_=_NextPart_001_01C1C6B6.038F6040&quot;

------_=_NextPart_001_01C1C6B6.038F6040
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;

It's not that String.GetHashCode() itself is slow, it's that hashtable
overhead is slow because of poor hashing, due to the current hashcode
implementation.  But I don't see any hashtable calls in your profile report,
so maybe it's still not a big deal?
-- Mark Lewis

-----Original Message-----
From: Paolo Molaro [mailto:<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>]
Sent: Friday, March 08, 2002 9:06 AM
To: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
Subject: Re: [Mono-list] mcs compiles on linux. Now what?
Importance: Low


On 03/08/02 Dan Lewis wrote:
&gt;<i> Is there any way to find out how much of this is spent in the lexer? MCS
</I>uses a
&gt;<i> custom lexer, and in particular uses a hashtable lookup to recognize
</I>keywords.
&gt;<i> 
</I>&gt;<i> String.GetHashCode() is computed in C# at the moment. It should definitely
</I>have
&gt;<i> an icall (btw I'm not saying that icalls are the way to make things faster
</I>--
&gt;<i> but it's such a fundamental operation). Also it is not cached, although
</I>strings
&gt;<i> are supposed to be immutable, right? Perhaps change it to:
</I>&gt;<i> 
</I>&gt;<i>   public override int GetHashCode () {
</I>&gt;<i>           if (!is_hashed) {
</I>&gt;<i>                   // compute hash_code
</I>&gt;<i>                   is_hashed = true;
</I>&gt;<i>           }
</I>&gt;<i> 
</I>&gt;<i>           return hash_code;
</I>&gt;<i>   }
</I>&gt;<i> 
</I>&gt;<i> This may/may not make any difference. As ever, profiling's your best
</I>weapon :)

String.GetHashCode() accounts for 1.3% of the total time spent compiling,
so its not an obvious candidate for optimizations:-)

Here is some relevant data:
Method name                                           Total (ms)  Calls
Mono.CSharp.Driver::ProcessFile(1)                    214055      28
Mono.CSharp.Driver::parse(1)                          214051      28
Mono.CSharp.CSharpParser::parse(0)                    214008      28
Mono.CSharp.CSharpParser::yyparse(1)                  214007      28
Mono.CSharp.Tokenizer::token(0)                       163886  161657
Mono.CSharp.Tokenizer::xtoken(0)                      163273  161657
Mono.CSharp.Tokenizer::peekChar(0)                     25279  888884
Mono.CSharp.Tokenizer::is_number(1)                    24166   19362
Mono.CSharp.Tokenizer::getChar(0)                      17076  888825
Mono.CSharp.Tokenizer::decimal_digits(1)               13687   19335
Mono.CSharp.Tokenizer::is_punct(2)                      7934  290123
Mono.CSharp.Tokenizer::advance(0)                       4676  161685
Mono.CSharp.Tokenizer::is_keyword(1)                    4247   56199
Mono.CSharp.Tokenizer::handle_preprocessing_directive(0)    2216     410
Mono.CSharp.Tokenizer::get_cmd_arg(2)                   2081     410
Mono.CSharp.Tokenizer::is_identifier_part_character(1)    1960  355818
Mono.CSharp.Tokenizer::escape(1)                        1544   49420
Mono.CSharp.Tokenizer::adjust_int(1)                    1430   19327
Mono.CSharp.Tokenizer::GetKeyword(1)                     980   16811

System.Text.StringBuilder::Append(1)                   77733  453475
System.Char::IsLetter(1)                                1400  734049
System.Char::IsDigit(1)                                  731  444015

So it looks like StringBuilder::Append() gets a huge chunk and next to
it are IO functions and many small functions that add up. I'd need to
add call graph info to have more precise data, but this should give an
idea.

&gt;<i> In general custom lexers are slower than machine generated ones. I did
</I>some
&gt;<i> work a long time ago on porting a fast lexer generator to C# -- I could
</I>dig it
&gt;<i> up if there's need for it.
</I>
This is miguel's call.

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

_______________________________________________
Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>

------_=_NextPart_001_01C1C6B6.038F6040
Content-Type: text/html;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: quoted-printable

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META HTTP-EQUIV=3D&quot;Content-Type&quot; CONTENT=3D&quot;text/html; =
charset=3Diso-8859-1&quot;&gt;
&lt;META NAME=3D&quot;Generator&quot; CONTENT=3D&quot;MS Exchange Server version =
5.5.2653.12&quot;&gt;
&lt;TITLE&gt;RE: [Mono-list] mcs compiles on linux. Now what?&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;It's not that String.GetHashCode() itself is slow, =
it's that hashtable overhead is slow because of poor hashing, due to =
the current hashcode implementation.&amp;nbsp; But I don't see any =
hashtable calls in your profile report, so maybe it's still not a big =
deal?&lt;/FONT&gt;&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;-- Mark Lewis&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;-----Original Message-----&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;From: Paolo Molaro [&lt;A =
HREF=3D&quot;mailto:<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>&quot;&gt;mailto:<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>&lt;/A&gt;]&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;Sent: Friday, March 08, 2002 9:06 AM&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;To: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;Subject: Re: [Mono-list] mcs compiles on linux. Now =
what?&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;Importance: Low&lt;/FONT&gt;
&lt;/P&gt;
&lt;BR&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;On 03/08/02 Dan Lewis wrote:&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Is there any way to find out how much of this =
is spent in the lexer? MCS uses a&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; custom lexer, and in particular uses a =
hashtable lookup to recognize keywords.&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; String.GetHashCode() is computed in C# at the =
moment. It should definitely have&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; an icall (btw I'm not saying that icalls are =
the way to make things faster --&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; but it's such a fundamental operation). Also it =
is not cached, although strings&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; are supposed to be immutable, right? Perhaps =
change it to:&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; public override int GetHashCode () =
{&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; if (!is_hashed) {&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // compute =
hash_code&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; is_hashed =3D =
true;&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; }&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; return hash_code;&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; }&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; This may/may not make any difference. As ever, =
profiling's your best weapon :)&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;String.GetHashCode() accounts for 1.3% of the total =
time spent compiling,&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;so its not an obvious candidate for =
optimizations:-)&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;Here is some relevant data:&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;Method =
name&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;n=
bsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;n=
bsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;n=
bsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Total (ms)&amp;nbsp; Calls&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Driver::ProcessFile(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp; 214055&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 28&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Driver::parse(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
214051&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 28&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.CSharpParser::parse(0)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp; 214008&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 28&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.CSharpParser::yyparse(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp; 214007&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 28&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::token(0)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;n=
bsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;n=
bsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 163886&amp;nbsp; 161657&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::xtoken(0)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;=
nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;=
nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 163273&amp;nbsp; 161657&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::peekChar(0)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; 25279&amp;nbsp; 888884&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::is_number(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&amp;nbsp; 24166&amp;nbsp;&amp;nbsp; 19362&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::getChar(0)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 17076&amp;nbsp; 888825&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::decimal_digits(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
13687&amp;nbsp;&amp;nbsp; 19335&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::is_punct(2)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 7934&amp;nbsp; 290123&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::advance(0)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 4676&amp;nbsp; 161685&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::is_keyword(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp; 4247&amp;nbsp;&amp;nbsp; 56199&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::handle_preprocessing_directive(0)&amp;nbsp;&amp;=
nbsp;&amp;nbsp; 2216&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 410&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::get_cmd_arg(2)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;n=
bsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;n=
bsp;&amp;nbsp; 2081&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 410&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::is_identifier_part_character(1)&amp;nbsp;&amp;nb=
sp;&amp;nbsp; 1960&amp;nbsp; 355818&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::escape(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;=
nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;=
nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1544&amp;nbsp;&amp;nbsp; 49420&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::adjust_int(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp; 1430&amp;nbsp;&amp;nbsp; 19327&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;Mono.CSharp.Tokenizer::GetKeyword(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 980&amp;nbsp;&amp;nbsp; 16811&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT =
SIZE=3D2&gt;System.Text.StringBuilder::Append(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp; 77733&amp;nbsp; 453475&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;System.Char::IsLetter(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp; 1400&amp;nbsp; 734049&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;System.Char::IsDigit(1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&amp;nbsp; 731&amp;nbsp; 444015&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;So it looks like StringBuilder::Append() gets a huge =
chunk and next to&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;it are IO functions and many small functions that =
add up. I'd need to&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;add call graph info to have more precise data, but =
this should give an&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;idea.&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; In general custom lexers are slower than machine =
generated ones. I did some&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; work a long time ago on porting a fast lexer =
generator to C# -- I could dig it&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; up if there's need for it.&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;This is miguel's call.&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;lupus&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;-- &lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;---------------------------------------------------------------=
--&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; debian/rules&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Monkeys do it =
better&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT =
SIZE=3D2&gt;_______________________________________________&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;Mono-list maillist&amp;nbsp; -&amp;nbsp; =
<A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>&lt;/FONT&gt;
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&lt;A =
HREF=3D&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list"">http://lists.ximian.com/mailman/listinfo/mono-list&quot;</A> =
TARGET=3D&quot;_blank&quot;&gt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list</A">http://lists.ximian.com/mailman/listinfo/mono-list&lt;/A</A>&gt;=
&lt;/FONT&gt;
&lt;/P&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
------_=_NextPart_001_01C1C6B6.038F6040--

--------------InterScan_NT_MIME_Boundary--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003934.html">[Mono-list] Array.GetEnumerator()
</A></li>
	<LI> Next message: <A HREF="003911.html">[Mono-list] mcs compiles on linux. Now what?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3909">[ date ]</a>
              <a href="thread.html#3909">[ thread ]</a>
              <a href="subject.html#3909">[ subject ]</a>
              <a href="author.html#3909">[ author ]</a>
         </LI>
       </UL>
</body></html>
