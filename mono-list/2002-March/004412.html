<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Re: [DotGNU]C# compiler command line parsing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rweather%40zip.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="004402.html">
   <LINK REL="Next"  HREF="004422.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Re: [DotGNU]C# compiler command line parsing
   </H1>
    <B>Rhys Weatherley
    </B> 
    <A HREF="mailto:rweather%40zip.com.au"
       TITLE="[Mono-list] Re: [DotGNU]C# compiler command line parsing">rweather@zip.com.au
       </A><BR>
    <I>Thu, 28 Mar 2002 19:31:42 +1000</I>
    <P><UL>
        <LI> Previous message: <A HREF="004402.html">[Mono-list] C# compiler command line parsing
</A></li>
        <LI> Next message: <A HREF="004422.html">[Mono-list] Re: [DotGNU]C# compiler command line parsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4412">[ date ]</a>
              <a href="thread.html#4412">[ thread ]</a>
              <a href="subject.html#4412">[ subject ]</a>
              <a href="author.html#4412">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.
--------------B15878C6D882B391DB5D5641
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Fergus Henderson wrote:

&gt;<i> One way to do this would be to just add support for Microsoft's
</I>&gt;<i> command-line interface to the .NET and Mono C# compilers.  Another way
</I>&gt;<i> to do it would be to define a Unix-like command-line syntax, and write
</I>&gt;<i> a wrapper for Microsoft's csc that would convert the Unix-like syntax
</I>&gt;<i> into Microsoft's syntax and then invoke csc.  Software written in C#
</I>&gt;<i> could ship with this wrapper program included.
</I>
Portable.NET's C# compiler already uses the gcc syntax.
Attached is a script I wrote to wrap up &quot;csc&quot; and give it
the same gcc-like syntax, so as to improve interoperability.

Microsoft's syntax does not fit into a Unix environment very
well, because it uses '/' as a switch character.  I don't see
why we should dumb down our compilers, when a shell script
can be used to smarten up Microsoft's.

The only drawback with the script is that it only works in
Cygwin and Unix environments.  It doesn't work at the
raw Windows command prompt.  That could be easily fixed
by re-implementing the script in C or C#.

As another option, Portable.NET's &quot;csant&quot; tool, which is
a C-only variant of NAnt, supports csc, mcs, and cscc
syntax transparently.  The XML file describes what needs
to be compiled, and &quot;csant&quot; converts it into the correct
conventions depending upon which compiler has been
configured.  Environment variables or command-line
options are used to specify which compiler to use.

Cheers,

Rhys.


--------------B15878C6D882B391DB5D5641
Content-Type: application/x-sh;
 name=&quot;mscsc.sh&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;mscsc.sh&quot;

#! /bin/sh
#
# mscsc.sh - Wrapper around Microsoft's CSC.EXE to give it a more
#            cscc-like command-line syntax.
#
# Copyright (C) 2001  Southern Storm Software, Pty Ltd.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

# Get the name of the compiler to invoke.
if test -z &quot;$1&quot; ; then
	echo &quot;Usage: $0 csc [options] inputfiles&quot; 1&gt;&amp;2
	exit 1
fi
PROGNAME=&quot;$0&quot;
CSC=&quot;$1&quot;
shift

# Parse the command-line options.
FLAGS=&quot;/nologo&quot;
FILES=&quot;&quot;
NEEDARG=&quot;&quot;
DEFINES=&quot;&quot;
LIBDIRS=&quot;&quot;
LIBRARIES=&quot;&quot;
RESOURCES=&quot;&quot;
for i in $*; do
	if test -z &quot;$NEEDARG&quot; ; then
		case &quot;$i&quot; in
			-nostdlib)				FLAGS=&quot;$FLAGS /nostdlib&quot; ;;
			-g)						FLAGS=&quot;$FLAGS /debug+&quot; ;;
			-O|-O2|-O3)				FLAGS=&quot;$FLAGS /optimize+&quot; ;;
			-O0)					FLAGS=&quot;$FLAGS /optimize-&quot; ;;
			-o)						NEEDARG=&quot;o&quot; ;;
			-c|-S|-E|-v|-vv)		;;
			-Werror)				FLAGS=&quot;$FLAGS /warnaserror+&quot; ;;
			-Wall)					FLAGS=&quot;$FLAGS /warn:4&quot; ;;
			-Wno-dll-import)		FLAGS=&quot;$FLAGS /nowarn:626&quot; ;;
			-Wno-field-assign)		FLAGS=&quot;$FLAGS /nowarn:649&quot; ;;
			-Wno-event-unused)		FLAGS=&quot;$FLAGS /nowarn:67&quot; ;;
			-fsyntax-check)			;; #FLAGS=&quot;$FLAGS /nooutput&quot; ;;
			-fchecked)				FLAGS=&quot;$FLAGS /checked+&quot; ;;
			-funchecked)			FLAGS=&quot;$FLAGS /checked-&quot; ;;
			-fincremental)			FLAGS=&quot;$FLAGS /incremental&quot; ;;
			-funsafe)				FLAGS=&quot;$FLAGS /unsafe&quot; ;;
			-fresources=)
				 RESOURCES=`expr &quot;$i&quot; : '-fresources=\(.*\)$'` ;;
			-e)						NEEDARG=&quot;e&quot; ;;
			-I*|-f*|-W*)			;;
			-D*) if test -z &quot;$DEFINES&quot; ; then
					DEFINES=`expr &quot;$i&quot; : '-D\(.*\)$'`
				 else
				 	DEFINES=&quot;$DEFINES;&quot;`expr &quot;$i&quot; : '-D\(.*\)$'`
				 fi ;;
			-L*) LIBDIRS=&quot;$LIBDIRS &quot;`expr &quot;$i&quot; : '-L\(.*\)$'` ;;
			-l*) LIBRARIES=&quot;$LIBRARIES &quot;`expr &quot;$i&quot; : '-l\(.*\)$'` ;;
			-*)	 echo &quot;${PROGNAME}: unknown option $i&quot; 1&gt;&amp;2
				 exit 1 ;;
			 *)	 FILES=&quot;$FILES $i&quot; ;;
		esac
	else
		case &quot;$NEEDARG&quot; in
			o)	case &quot;$i&quot; in
					*.dll) FLAGS=&quot;$FLAGS /target:library&quot; ;;
					*.exe) FLAGS=&quot;$FLAGS /target:exe&quot; ;;
					    *) FLAGS=&quot;$FLAGS /target:module&quot; ;;
				esac
				FLAGS=&quot;$FLAGS /out:$i&quot; ;;
			e)	FLAGS=&quot;$FLAGS /main:$i&quot; ;;
			*)	;;
		esac
		NEEDARG=&quot;&quot;
	fi
done

# Add extra flags as necessary.
if test -n &quot;$DEFINES&quot; ; then
	FLAGS=&quot;$FLAGS /define:$DEFINES&quot;
fi
if test -n &quot;$LIBRARIES&quot; -a -n &quot;$LIBDIRS&quot; ; then
	REFS=&quot;&quot;
	for lib in $LIBRARIES; do
		for dir in $LIBDIRS; do
			if test -f &quot;${dir}/${lib}.dll&quot; ; then
				if test -z &quot;$REFS&quot; ; then
					REFS=&quot;${dir}/${lib}.dll&quot;
				else
					REFS=&quot;$REFS;${dir}/${lib}.dll&quot;
				fi
			fi
		done
	done
	if test -n &quot;$REFS&quot; ; then
		FLAGS=&quot;$FLAGS /reference:&quot;`echo &quot;$REFS&quot; | sed -e '1,$s%/%\\\\%g' -`
	fi

fi
if test -n &quot;$RESOURCES&quot; ; then
	FLAGS=&quot;$FLAGS /resource:&quot;`echo &quot;$RESOURCES&quot; | sed -e '1,$s%/%\\\\%g' -`
fi

# Convert forward slashes in the filenames into backslashes
# so that CSC.EXE doesn't try to treat the names as options.
FILES=`echo &quot;$FILES&quot; | sed -e '1,$s%/%\\\\%g' -`

# Execute the compiler.
echo &quot;$CSC&quot; $FLAGS $FILES
exec &quot;$CSC&quot; $FLAGS $FILES

--------------B15878C6D882B391DB5D5641--




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="004402.html">[Mono-list] C# compiler command line parsing
</A></li>
	<LI> Next message: <A HREF="004422.html">[Mono-list] Re: [DotGNU]C# compiler command line parsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4412">[ date ]</a>
              <a href="thread.html#4412">[ thread ]</a>
              <a href="subject.html#4412">[ subject ]</a>
              <a href="author.html#4412">[ author ]</a>
         </LI>
       </UL>
</body></html>
