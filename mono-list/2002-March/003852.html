<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] new color.cs for inclusion in CVS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:brian%40fluggo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003846.html">
   <LINK REL="Next"  HREF="003854.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] new color.cs for inclusion in CVS
   </H1>
    <B>Brian Crowell
    </B> 
    <A HREF="mailto:brian%40fluggo.com"
       TITLE="[Mono-list] new color.cs for inclusion in CVS">brian@fluggo.com
       </A><BR>
    <I>Thu, 7 Mar 2002 13:22:50 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="003846.html">[Mono-list] new color.cs for inclusion in CVS
</A></li>
        <LI> Next message: <A HREF="003854.html">[Mono-list] new color.cs for inclusion in CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3852">[ date ]</a>
              <a href="thread.html#3852">[ thread ]</a>
              <a href="subject.html#3852">[ subject ]</a>
              <a href="author.html#3852">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Casts are not checked either.  The only difference that you will get is
</I>&gt;<i> that &quot;unchecked&quot; will disable the compile-time checking for overflows
</I>&gt;<i> (that might happen inadvertently), the resulting code is the same
</I>&gt;<i> cast-wise.
</I>&gt;<i> 
</I>&gt;<i> (Either that, or I have to fix a bug in mcs, so if we can actually pin
</I>&gt;<i> point a problem, I would love to hear about this, because then I need to
</I>&gt;<i> go fix mcs ;-)
</I>
See for yourself. Try compiling and running the code below.


======================================

using System;

namespace test
{
	/// &lt;summary&gt;
	/// Summary description for Class1.
	/// &lt;/summary&gt;
	class Class1
	{
		public struct Color
		{
			public byte a, r, g, b;
			
			public override string ToString()
			{
				return string.Format( &quot;[{0},{1},{2},{3}]&quot;, a, r, g, b );
			}
		}
	
		/// &lt;summary&gt;
		/// The main entry point for the application.
		/// &lt;/summary&gt;
		[STAThread]
		static void Main(string[] args)
		{
			Color colorChecked, colorUnchecked, colorHouston;
			
			int packed = 0x12345678;
			
			// This code prints &quot;Unchecked color: [18,52,86,120]&quot;
			try
			{
				unchecked {
					colorUnchecked.a = (byte)(packed &gt;&gt; 24);
					colorUnchecked.r = (byte)(packed &gt;&gt; 16);
					colorUnchecked.g = (byte)(packed &gt;&gt; 8);
					colorUnchecked.b = (byte)(packed);
				}
				
				Console.WriteLine( &quot;Unchecked color: {0}&quot;, colorUnchecked );
			}
			catch( Exception e )
			{
				Console.WriteLine( e.ToString() );
			}

			// This code causes a run-time System.OverflowException
			try
			{
				checked {
					colorChecked.a = (byte)(packed &gt;&gt; 24);
					colorChecked.r = (byte)(packed &gt;&gt; 16);
					colorChecked.g = (byte)(packed &gt;&gt; 8);
					colorChecked.b = (byte)(packed);
				}
				
				Console.WriteLine( &quot;Checked color: {0}&quot;, colorChecked );
			}
			catch( Exception e )
			{
				Console.WriteLine( e.ToString() );
			}

			// This code will not compile:
			// colorHouston.a = ( packed &amp; 0xff000000 ) &gt;&gt; 24;
			// colorHouston.r = ( packed &amp; 0xff0000 ) &gt;&gt; 16;
			// colorHouston.g = ( packed &amp; 0xff00 ) &gt;&gt; 8;
			// colorHouston.b = ( packed &amp; 0xff );
				
			// This line will not compile:
			// int mask = 0xFF000000;
			
			// Nor will this:
			// checked { int mask = (int)0xFF000000; }
			
			// But this will:
			unchecked { int mask = (int)0xFF000000; }
			
			Console.ReadLine();
		}
	}
}


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003846.html">[Mono-list] new color.cs for inclusion in CVS
</A></li>
	<LI> Next message: <A HREF="003854.html">[Mono-list] new color.cs for inclusion in CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3852">[ date ]</a>
              <a href="thread.html#3852">[ thread ]</a>
              <a href="subject.html#3852">[ subject ]</a>
              <a href="author.html#3852">[ author ]</a>
         </LI>
       </UL>
</body></html>
