<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mcs compiles on linux. Now what?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003916.html">
   <LINK REL="Next"  HREF="003917.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mcs compiles on linux. Now what?
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] mcs compiles on linux. Now what?">lupus@ximian.com
       </A><BR>
    <I>Fri, 8 Mar 2002 17:13:34 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="003916.html">[Mono-list] mcs compiles on linux. Now what?
</A></li>
        <LI> Next message: <A HREF="003917.html">[Mono-list] mcs compiles on linux. Now what?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3913">[ date ]</a>
              <a href="thread.html#3913">[ thread ]</a>
              <a href="subject.html#3913">[ subject ]</a>
              <a href="author.html#3913">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/08/02 Miguel de Icaza wrote:
&gt;<i> &gt; 45-50 % of the time is spent parsing, now. miguel mentioned he had a few
</I>&gt;<i> &gt; ideas about ways to speed-up the parser, maybe when he wakes up
</I>&gt;<i> &gt; he can elaborate. Loading the file in memory at once is sure worth,
</I>&gt;<i> &gt; but this should probably be implemented at the IO.FileStream level.
</I>&gt;<i> 
</I>&gt;<i> We need to run mcs with --timestamps in both Linux and Windows.   The
</I>&gt;<i> first time stamp shown is the parsing time.  In my Windows machine, this
</I>
We need to implement formatting output first :-)

&gt;<i> So 1/15h of the time is spent on parsing on Windows.  If we are getting
</I>&gt;<i> different numbers on Linux, we should not look into optimizing the
</I>&gt;<i> parser and the tokenizer, but optimizing the underlying functions.
</I>
Here is StringBuilder::Append(char):
	public StringBuilder Append( char value ) {
		return Append (value, 1);
	}

	public StringBuilder Append( char value, int repeatCount) {
		if( repeatCount &lt; 0 ) {
			throw new ArgumentOutOfRangeException();
		}

		return Append( new String( value, repeatCount));
	}

Append(string) will have to call String.ToCharArray() to get back the
char. I changed this to do the obvious thing, and the time to compile
mcs (with a debug mint build) went from 5m28s to 4m29s, not bad :-)

&gt;<i> &gt; 15 % is spent in String.BoyerMoore: a dumb search is sure faster than
</I>&gt;<i> &gt; initializing a 65536 element skiptable :-)
</I>&gt;<i> 
</I>&gt;<i> Heh, is this initialized for every string?  Oh my
</I>
Every time you call String.IndexOf (string).

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003916.html">[Mono-list] mcs compiles on linux. Now what?
</A></li>
	<LI> Next message: <A HREF="003917.html">[Mono-list] mcs compiles on linux. Now what?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3913">[ date ]</a>
              <a href="thread.html#3913">[ thread ]</a>
              <a href="subject.html#3913">[ subject ]</a>
              <a href="author.html#3913">[ author ]</a>
         </LI>
       </UL>
</body></html>
