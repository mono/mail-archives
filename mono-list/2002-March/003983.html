<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] GetTypeCode for Enum
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:ndrochak%40gol.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003979.html">
   <LINK REL="Next"  HREF="004014.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] GetTypeCode for Enum
   </H1>
    <B>Nick Drochak
    </B> 
    <A HREF="mailto:ndrochak%40gol.com"
       TITLE="[Mono-list] GetTypeCode for Enum">ndrochak@gol.com
       </A><BR>
    <I>Mon, 11 Mar 2002 15:27:09 +0900</I>
    <P><UL>
        <LI> Previous message: <A HREF="003979.html">[Mono-list] GetTypeCode for Enum
</A></li>
        <LI> Next message: <A HREF="004014.html">[Mono-list] GetTypeCode for Enum
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3983">[ date ]</a>
              <a href="thread.html#3983">[ thread ]</a>
              <a href="subject.html#3983">[ subject ]</a>
              <a href="author.html#3983">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0020_01C1C911.35754770
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: 7bit

|<i> The trick is based on the fact that under CLR class that implements
</I>|<i> interface must implement all methods of that interface, but not necessary
</I>|<i> under the same name.
</I>|<i> See .override directive description in Partition II (9.3.2) for details.
</I>|<i> C# syntax for this is to explicitly include interface name in declaration
</I>|<i> (and without any visibility modifiers):
</I>|<i>    bool IConvertible.ToBool(...) {...}
</I>|<i> This way method becomes &quot;visible&quot; when instance is casted to
</I>|<i> interface type.
</I>|<i>    ((IConvertible)MyEnum).ToBool(...);
</I>|<i>
</I>
Thanks Sergey.  That was clear.

I put in the IConvertible interface stubs using that technique (see
attachment). However, I'm not sure what they do in mscorlib since they are
not public, and the compiler won't even allow the cast from an enum value to
an IConvertible.  Code such as below does not compile:

enum TestEnum {eeny, miney, moe};
//...
TestEnum e = TestEnum.eeny;
bool b = ((IConvertible)e).ToBoolean();  // &lt;- compile error

I suppose those methods only need to be implemented if and when the runtime
needs them.

Thanks again,
Nick D.

------=_NextPart_000_0020_01C1C911.35754770
Content-Type: application/octet-stream;
	name=&quot;enum.diff&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;enum.diff&quot;

Index: Enum.cs=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvs/public/mcs/class/corlib/System/Enum.cs,v=0A=
retrieving revision 1.14=0A=
diff -u -r1.14 Enum.cs=0A=
--- Enum.cs	2002/03/01 14:41:46	1.14=0A=
+++ Enum.cs	2002/03/11 02:19:00=0A=
@@ -28,7 +28,112 @@=0A=
 	};=0A=
 =0A=
 	[MonoTODO]=0A=
-	public abstract class Enum : ValueType, IComparable {=0A=
+	public abstract class Enum : ValueType, IComparable, IConvertible {=0A=
+=0A=
+		// IConvertible methods Start --&gt;=0A=
+=0A=
+		[CLSCompliant(false)]=0A=
+		public TypeCode GetTypeCode () {=0A=
+			MonoEnumInfo info;=0A=
+			MonoEnumInfo.GetInfo (this.GetType (), out info);=0A=
+			return Type.GetTypeCode (info.utype);=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		bool IConvertible.ToBoolean (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		byte IConvertible.ToByte (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		char IConvertible.ToChar (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		DateTime IConvertible.ToDateTime (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		decimal IConvertible.ToDecimal (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		double IConvertible.ToDouble (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		short IConvertible.ToInt16 (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		int IConvertible.ToInt32 (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		long IConvertible.ToInt64 (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+    		[CLSCompliant(false)]=0A=
+		sbyte IConvertible.ToSByte (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		float IConvertible.ToSingle (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+		object IConvertible.ToType (Type conversionType, IFormatProvider =
provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+		=0A=
+		[MonoTODO]=0A=
+    		[CLSCompliant(false)]=0A=
+		public ushort ToUInt16 (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+    		[CLSCompliant(false)]=0A=
+		uint IConvertible.ToUInt32 (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		[MonoTODO]=0A=
+    		[CLSCompliant(false)]=0A=
+		ulong IConvertible.ToUInt64 (IFormatProvider provider)=0A=
+		{=0A=
+			throw new NotImplementedException ();=0A=
+		}=0A=
+=0A=
+		// &lt;-- End IConvertible methods=0A=
 =0A=
 		[MethodImplAttribute(MethodImplOptions.InternalCall)]=0A=
 		private extern object get_value ();=0A=

------=_NextPart_000_0020_01C1C911.35754770--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003979.html">[Mono-list] GetTypeCode for Enum
</A></li>
	<LI> Next message: <A HREF="004014.html">[Mono-list] GetTypeCode for Enum
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3983">[ date ]</a>
              <a href="thread.html#3983">[ thread ]</a>
              <a href="subject.html#3983">[ subject ]</a>
              <a href="author.html#3983">[ author ]</a>
         </LI>
       </UL>
</body></html>
