<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Loading System.Data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:piersh%40friskit.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003942.html">
   <LINK REL="Next"  HREF="003944.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Loading System.Data
   </H1>
    <B>Piers Haken
    </B> 
    <A HREF="mailto:piersh%40friskit.com"
       TITLE="[Mono-list] Loading System.Data">piersh@friskit.com
       </A><BR>
    <I>Fri, 8 Mar 2002 21:55:36 -0800</I>
    <P><UL>
        <LI> Previous message: <A HREF="003942.html">[Mono-list] RE: Environment.SpecialFolder
</A></li>
        <LI> Next message: <A HREF="003944.html">[Mono-list] Loading System.Data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3943">[ date ]</a>
              <a href="thread.html#3943">[ thread ]</a>
              <a href="subject.html#3943">[ subject ]</a>
              <a href="author.html#3943">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a .NET question more than a mono question, I'm hoping someone
can shed some light on this:

I'm trying to load Assemblies from the GAC using System.Load(string). 

I'm using the code from the docs for that method:
<A HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/h">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/h</A>
tml/frlrfSystemReflectionAssemblyClassLoadTopic3.asp
&lt;<A HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/</A>
html/frlrfSystemReflectionAssemblyClassLoadTopic3.asp&gt; 

Here's my test case:

using System.Reflection;
namespace Foo
{
	class Foo
	{
		public static void Main ()
		{
			Assembly ass = Assembly.Load (&quot;System.Data&quot;);
		}
	}
}

Pretty simple, huh? But I'm getting an exception (see below). This
worked fine in beta2 - I just upgraded to release.

Can someone try to run this for me and tell me if they get the same
error?

Is there any other way to load an assembly like this? I tried
Assembly.LoadFrom() but it can't find it either.

Piers.

C:\&gt; test.exe
Unhandled Exception: System.IO.FileNotFoundException: File or assembly
name System.Data, or one of its dependencies, was not found.
File name: &quot;System.Data&quot;
   at System.Reflection.Assembly.nLoad(AssemblyName fileName, String
codeBase, Boolean isStringized, Evidence assemblySecurity, Boolean
throwOnFileNotFound, Assembly locationHint, StackCrawlMark&amp; stackMark)
   at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef,
Boolean stringized, Evidence assemblySecurity, StackCrawlMark&amp;
stackMark)
   at System.Reflection.Assembly.LoadFrom(String assemblyFile, Evidence
security Evidence)
   at Foo.Foo.Main()

Fusion log follows:
=== Pre-bind state information ===
LOG: Where-ref bind. Location = C:\System.Data
LOG: Appbase = C:\
LOG: Initial PrivatePath = NULL
Calling assembly : (Unknown).
===

LOG: Application configuration file does not exist.
LOG: Policy not being applied to reference at this time (private,
custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL <A HREF="file:///C:/System.Data">file:///C:/System.Data</A>
&lt;<A HREF="file:///C:/System.Data">file:///C:/System.Data</A>&gt; .

C:\&gt; 


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003942.html">[Mono-list] RE: Environment.SpecialFolder
</A></li>
	<LI> Next message: <A HREF="003944.html">[Mono-list] Loading System.Data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3943">[ date ]</a>
              <a href="thread.html#3943">[ thread ]</a>
              <a href="subject.html#3943">[ subject ]</a>
              <a href="author.html#3943">[ author ]</a>
         </LI>
       </UL>
</body></html>
