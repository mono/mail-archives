<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Fwd: Concurrency issue with AWS Simple Email Service	REST API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Fwd%3A%20Concurrency%20issue%20with%20AWS%20Simple%20Email%20Service%0A%09REST%20API&In-Reply-To=%3CCAPxVnoDdniO%2BJfvBykA94P4TFT2QL_KY2qrOz1aZmUYM1LGEHg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="049464.html">
   <LINK REL="Next"  HREF="049474.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Fwd: Concurrency issue with AWS Simple Email Service	REST API</H1>
    <B>J&#248;rn Schou-Rode</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Fwd%3A%20Concurrency%20issue%20with%20AWS%20Simple%20Email%20Service%0A%09REST%20API&In-Reply-To=%3CCAPxVnoDdniO%2BJfvBykA94P4TFT2QL_KY2qrOz1aZmUYM1LGEHg%40mail.gmail.com%3E"
       TITLE="[Mono-list] Fwd: Concurrency issue with AWS Simple Email Service	REST API">jsr at malamute.dk
       </A><BR>
    <I>Wed Jan 23 08:57:53 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="049464.html">[Mono-list] A script for downloading,	compile and prepare a parallel environmnent
</A></li>
        <LI>Next message: <A HREF="049474.html">[Mono-list] Process.GetProcess()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49465">[ date ]</a>
              <a href="thread.html#49465">[ thread ]</a>
              <a href="subject.html#49465">[ subject ]</a>
              <a href="author.html#49465">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Mono experts,

I am in the process of moving an email newsletter service from a Windows
server running Microsoft.NET 4.5 to a Linux server running Mono 3.0.3. The
service uses Amazon's &quot;Simple Email Service&quot; (SES) to deliver the emails,
via the official .NET SDK (wrapping a REST interface) [1].

While sending emails via SES sequentially from Mono turns out to be
slightly faster than Microsoft.NET using similar hardware, I am running
into serious performance trouble when attempting to deliver multiple mails
in parallel. I have experimented a bit and drawn a chart [2] showing the
time required to send 128 emails on both platforms using a varying number
of threads. As you can see, performance on Mono degrades rapidly after 8
threads, and with 128 threads I get only HTTP timeouts &#8211; not a single email
is delivered.

Profiling via console output, it turns out that the first &quot;batch&quot; of mails
is the source of the slowdown. With two threads, sending one email in each,
both threads finish in around 2200 ms. With four threads, sending one email
in each, they all finish in around 4400 ms. Eight threads, around 8800 ms,
etc. It seems as if the web service, while spawned simultaneously, are run
sequentially and are required to wait for one another before returning.

Any ideas what might be triggering this behavior? The source code for the
Amazon SDK is available on GitHub [3], but I have not been able to pinpoint
anything suspiciously. Maybe the use of the async methods on HttpWebRequest?

Thanks in advance.

J&#248;rn

[1]: <A HREF="http://aws.amazon.com/sdkfornet/">http://aws.amazon.com/sdkfornet/</A>
[2]: <A HREF="http://i.stack.imgur.com/tiuDg.png">http://i.stack.imgur.com/tiuDg.png</A>
[3]: <A HREF="https://github.com/aws/aws-sdk-net">https://github.com/aws/aws-sdk-net</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20130123/39e7eb1e/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20130123/39e7eb1e/attachment.html</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="049464.html">[Mono-list] A script for downloading,	compile and prepare a parallel environmnent
</A></li>
	<LI>Next message: <A HREF="049474.html">[Mono-list] Process.GetProcess()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49465">[ date ]</a>
              <a href="thread.html#49465">[ thread ]</a>
              <a href="subject.html#49465">[ subject ]</a>
              <a href="author.html#49465">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
