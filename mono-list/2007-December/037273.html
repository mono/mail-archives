<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ilasm2 can't compile vbbyref marshalled parameter
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20ilasm2%20can%27t%20compile%20vbbyref%20marshalled%20parameter&In-Reply-To=c6a8d61b0712132148k74389549p1df157847bbb616e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037267.html">
   <LINK REL="Next"  HREF="037271.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ilasm2 can't compile vbbyref marshalled parameter</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20ilasm2%20can%27t%20compile%20vbbyref%20marshalled%20parameter&In-Reply-To=c6a8d61b0712132148k74389549p1df157847bbb616e%40mail.gmail.com"
       TITLE="[Mono-list] ilasm2 can't compile vbbyref marshalled parameter">sebastien.pouliot at gmail.com
       </A><BR>
    <I>Fri Dec 14 08:14:55 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="037267.html">[Mono-list] ilasm2 can't compile vbbyref marshalled parameter
</A></li>
        <LI>Next message: <A HREF="037271.html">[Mono-list] SQL Server 2005 Support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37273">[ date ]</a>
              <a href="thread.html#37273">[ thread ]</a>
              <a href="subject.html#37273">[ subject ]</a>
              <a href="author.html#37273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Joe,

On Fri, 2007-12-14 at 00:48 -0500, Joe Mason wrote:
&gt;<i> I'm trying to make some small edits to a closed-source VB app to get
</I>&gt;<i> it running on Linux (the System.Drawing.Image.FromFile &quot;OutOfMemory&quot;
</I>&gt;<i> problem) by disassembling it with monodis and reassembling it with
</I>&gt;<i> ilasm2.
</I>
Has the problem been filled in bugzilla.ximian.com ? because AFAIK
there's none in FromFile, unless the file is bad.

FromStream can have some issues on Win32 (only) since the way MS deals
with loading requires the stream to be alive as long as the image.

&gt;<i> ilasm2 gives an &quot;unrecoverable syntax error&quot; on this line (char 75):
</I>&gt;<i> 
</I>&gt;<i>     .method public static  pinvokeimpl (&quot;kernel32&quot; as
</I>&gt;<i> &quot;GetVolumeInformationA&quot; ansi winapi nomangle  lasterr )
</I>&gt;<i>            default int32 GetVolumeInformation (string&amp; marshal
</I>&gt;<i> (vbbyrefstr) lpRootPathName, string&amp; marshal (vbbyrefstr)
</I>&gt;<i> lpVolumeNameBuffer, int32 nVolumeNameSize, int32&amp;
</I>&gt;<i> lpVolumeSerialNumber, int32&amp; lpMaximumComponentLength, int32&amp;
</I>&gt;<i> lpFileSystemFlags, string&amp; marshal (vbbyrefstr)
</I>&gt;<i> lpFileSystemNameBuffer, int16 nFileSystemNameSize)  cil managed
</I>&gt;<i> preservesig
</I>&gt;<i>     {
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i> The problem seems to by the &quot;marshal (vbbyrefstr)&quot; tags.  If I remove
</I>&gt;<i> them, it compiles fine (but then dies with a runtime error because it
</I>&gt;<i> can't find a copy of GetVolumeInformation with the correct signature).
</I>&gt;<i>  It also compiles if I change it to &quot;marshal (int32)&quot;.
</I>
Sounds like another bugzilla issue to me ;-)

&gt;<i> Is there anything I can do to get this compiling?  I assume the
</I>&gt;<i> problem is that vbbyrefstr was added by Visual Basic and ilasm2
</I>&gt;<i> doesn't recognize it - is there a fully-qualified type name I can
</I>&gt;<i> change it to?  (I can also change the call site to call marshalling
</I>&gt;<i> functions by hand if I have to, but I'm not sure where to start with
</I>&gt;<i> that.)
</I>
Have a look at pinvoke.net

&gt;<i> Thanks,
</I>&gt;<i> Joe
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037267.html">[Mono-list] ilasm2 can't compile vbbyref marshalled parameter
</A></li>
	<LI>Next message: <A HREF="037271.html">[Mono-list] SQL Server 2005 Support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37273">[ date ]</a>
              <a href="thread.html#37273">[ thread ]</a>
              <a href="subject.html#37273">[ subject ]</a>
              <a href="author.html#37273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
