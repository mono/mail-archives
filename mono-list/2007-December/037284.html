<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Fwd: ilasm2 can't compile vbbyref marshalled parameter
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Fwd%3A%20ilasm2%20can%27t%20compile%20vbbyref%20marshalled%20parameter&In-Reply-To=c6a8d61b0712140720w780845ddxb408d85fad7494c6%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037283.html">
   <LINK REL="Next"  HREF="037288.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Fwd: ilasm2 can't compile vbbyref marshalled parameter</H1>
    <B>Joe Mason</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Fwd%3A%20ilasm2%20can%27t%20compile%20vbbyref%20marshalled%20parameter&In-Reply-To=c6a8d61b0712140720w780845ddxb408d85fad7494c6%40mail.gmail.com"
       TITLE="[Mono-list] Fwd: ilasm2 can't compile vbbyref marshalled parameter">joe at notcharles.ca
       </A><BR>
    <I>Fri Dec 14 22:57:27 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="037283.html">[Mono-list] Mono on Win32
</A></li>
        <LI>Next message: <A HREF="037288.html">[Mono-list] Fwd: ilasm2 can't compile vbbyref	marshalled	parameter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37284">[ date ]</a>
              <a href="thread.html#37284">[ thread ]</a>
              <a href="subject.html#37284">[ subject ]</a>
              <a href="author.html#37284">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/14/07, Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sebastien.pouliot at gmail.com</A>&gt; wrote:
&gt;<i> Hello Joe,
</I>&gt;<i>
</I>&gt;<i> On Fri, 2007-12-14 at 00:48 -0500, Joe Mason wrote:
</I>&gt;<i> &gt; I'm trying to make some small edits to a closed-source VB app to get
</I>&gt;<i> &gt; it running on Linux (the System.Drawing.Image.FromFile &quot;OutOfMemory&quot;
</I>&gt;<i> &gt; problem) by disassembling it with monodis and reassembling it with
</I>&gt;<i> &gt; ilasm2.
</I>&gt;<i>
</I>&gt;<i> Has the problem been filled in bugzilla.ximian.com ? because AFAIK
</I>&gt;<i> there's none in FromFile, unless the file is bad.
</I>
As far as I could tell from Googling, the problem is with the .NET
design, rather than mono itself - at least, lots of people are
reporting it for .NET apps they're writing themselves, often in VB,
and I assume most of these use Microsoft's .NET.

The problem is that FromFile throws OutOfMemory on any error condition
(permissions problems, bad image format, etc).  See the following two
posts - the first advises people to use OpenRead and FromStream, and
the second has a huge list of people saying, &quot;I got the same
exception, but my problem was something different!&quot;

<A HREF="http://dotnetjunkies.com/Forums/ShowPost.aspx?PostID=3344">http://dotnetjunkies.com/Forums/ShowPost.aspx?PostID=3344</A>
<A HREF="http://jcapka.blogspot.com/2006/06/imagefromfile-gives-out-of-memory.html">http://jcapka.blogspot.com/2006/06/imagefromfile-gives-out-of-memory.html</A>

I had assumed that Mono's FromFile was just following the Microsoft
behaviour for compatibility, even though it would be better to have it
throw a wider range of errors.

I can't really file a bug until I'm sure why this particular code
causes the exception, though, otherwise I don't have a very repeatable
bug report.

&gt;<i> FromStream can have some issues on Win32 (only) since the way MS deals
</I>&gt;<i> with loading requires the stream to be alive as long as the image.
</I>
Thanks, good to know.

(snip errors when pinvoking GetVolumeInformationA)

&gt;<i> Have a look at pinvoke.net
</I>
Uh, it just occured to me - will pinvoking this even WORK on Linux,
even if I get it to compile?  I do have Wine installed, so I have a
version of this function somewhere, but getting Mono to find it sounds
like a huge hassle.  Surely .NET has its own equivalent that could be
called natively?

Thanks for the help,
Joe
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037283.html">[Mono-list] Mono on Win32
</A></li>
	<LI>Next message: <A HREF="037288.html">[Mono-list] Fwd: ilasm2 can't compile vbbyref	marshalled	parameter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37284">[ date ]</a>
              <a href="thread.html#37284">[ thread ]</a>
              <a href="subject.html#37284">[ subject ]</a>
              <a href="author.html#37284">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
