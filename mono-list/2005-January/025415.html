<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono C# and Windows Shares
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:martinf%40mfconsulting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025402.html">
   <LINK REL="Next"  HREF="025445.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono C# and Windows Shares
   </H1>
    <B>Francisco T. Martinez
    </B> 
    <A HREF="mailto:martinf%40mfconsulting.com"
       TITLE="[Mono-list] Mono C# and Windows Shares">martinf@mfconsulting.com
       </A><BR>
    <I>Sat, 22 Jan 2005 04:54:24 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="025402.html">[Mono-list] Mono C# and Windows Shares
</A></li>
        <LI> Next message: <A HREF="025445.html">[Mono-list] Mono C# and Windows Shares
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25415">[ date ]</a>
              <a href="thread.html#25415">[ thread ]</a>
              <a href="subject.html#25415">[ subject ]</a>
              <a href="author.html#25415">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Trygve Falch wrote:

&gt;<i>On Fri, 2005-01-21 at 10:55 +0000, Dick Porter wrote:
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>On Fri, 2005-01-21 at 11:27 +0100, Trygve Falch wrote:
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;&gt;<i>File.Copy using UNC-paths under windows works OK, but not surprisingly
</I>&gt;&gt;&gt;<i>under say Linux.
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>We don't support UNC paths.  To do so would I think involve building
</I>&gt;&gt;<i>samba into mono, which is not sane.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Yeah, I know. But my question was rather; 'Is there a way to do that
</I>&gt;<i>(eg. copying files to a windows-share from Linux using Mono) any other
</I>&gt;<i>way?'
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>Dicks answer is pretty much definitive.  However, in the event that what 
I will explain below can help you...

If you were to mount the samba share into the file system of the Linux 
machine running Mono, then you could address the Windows shares as if 
they were a local path.  Of course, at that point it is the operating 
system facilities that make those files available to Mono apps and not 
any of the Mono framework class libraries.

Once samba client is installed on your system you could do something 
like the example below.

In this example you have su as root so that you can mount volumens and 
you create a direcotry in your file system called smbvol so it can serve 
as the mounting point.
Example 1:

mount -t smbfs -o &quot;username=jmartinez,password=monito&quot; 
//mfc13bdc/MyShare /mnt/smbvol

using System;
using System.IO;

namespace Mfcon.General.Test
{

    public class DirList
    {
        public static void Main(string []args)
        {
            string []files;
           
            files = Directory.GetFiles(&quot;/mnt/smbvol&quot;);

            foreach(string fileName in files)
            {
                Console.WriteLine(fileName);
            }
        }
    }
}

Example 2:

using System;
using System.Diagnostics;

namespace Mfcon.General.Test
{

    public class DirList
    {
        public static void Main(string []args)
        {
            string dirOutPut;

            dirOutPut = DirList.ListFilesInSmbVol(&quot;//mfc13bdc/MyShare&quot;, 
&quot;MFCONSAULT/jmartinez&quot;, &quot;monito&quot;);
           
            Console.WriteLine(dirOutPut);
        }

        public static string ListFilesInSmbVol(string service, string 
userName, string userPassword)
        {
            string retVal;

            ProcessStartInfo pi = new ProcessStartInfo ();
            pi.FileName = &quot;smbclient&quot;;
            pi.RedirectStandardOutput = true;
            pi.UseShellExecute = false;
            pi.Arguments = String.Format(&quot;{0} {1} -U {2} -c \&quot;dir\&quot;&quot;,
                service, userPassword, userName); 
           
            Process p = null;
            try
            {
                p = Process.Start (pi);
            }
            catch (Exception e)
            {
                Console.WriteLine(&quot;Couldn't run smbclient: &quot; + e.Message);
                return null;
            }
          
            retVal = p.StandardOutput.ReadToEnd ();       
            p.WaitForExit ();
            if (p.ExitCode != 0)
            {
                Console.WriteLine(&quot;Error running smbclient.&quot;);
                return null;
            }

            if (retVal != null)
            {
                p.Close ();
                return retVal;
            }

            p.Close ();

            return null;
        }
    }
}


Hope this helps


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025402.html">[Mono-list] Mono C# and Windows Shares
</A></li>
	<LI> Next message: <A HREF="025445.html">[Mono-list] Mono C# and Windows Shares
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25415">[ date ]</a>
              <a href="thread.html#25415">[ thread ]</a>
              <a href="subject.html#25415">[ subject ]</a>
              <a href="author.html#25415">[ author ]</a>
         </LI>
       </UL>
</body></html>
