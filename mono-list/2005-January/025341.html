<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Questions on the Mono roadmap
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:miguel%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025335.html">
   <LINK REL="Next"  HREF="025344.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Questions on the Mono roadmap
   </H1>
    <B>Miguel de Icaza
    </B> 
    <A HREF="mailto:miguel%40ximian.com"
       TITLE="[Mono-list] Questions on the Mono roadmap">miguel@ximian.com
       </A><BR>
    <I>Tue, 18 Jan 2005 10:31:51 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="025335.html">[Mono-list] Questions on the Mono roadmap
</A></li>
        <LI> Next message: <A HREF="025344.html">[Mono-list] Questions on the Mono roadmap
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25341">[ date ]</a>
              <a href="thread.html#25341">[ thread ]</a>
              <a href="subject.html#25341">[ subject ]</a>
              <a href="author.html#25341">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

&gt;<i> * Delegates with the attribute to specify that if they're
</I>&gt;<i>   used to call native code, said code uses the C (cdecl) 
</I>&gt;<i>   calling convention, rather than the Pascal (stdcall) 
</I>&gt;<i>   calling convention that's the default for Microsoft C#.
</I>&gt;<i>   The syntax goes thus:
</I>&gt;<i> 
</I>&gt;<i>     [UnmanagedFunctionPointerAttribute( CallingConvention.Cdecl)]
</I>&gt;<i>     public delegate int TEST_callback_f_t(int a, int b);
</I>&gt;<i> 
</I>&gt;<i> * Marshal.GetDelegateForFunctionPointer(), which creates a
</I>&gt;<i>   delegate that wraps a pointer to a native code function.
</I>
These seem relatively simple, and could be implemented.  

Please file a bug report in Bugzilla against these.

&gt;<i> * Managed C++ ;-) We will use this to create interfaces 
</I>&gt;<i>   to .NET code that can be called by native C code. There 
</I>&gt;<i>   doesn't seem to be an equivalent of C++ 'extern &quot;C&quot;' in 
</I>&gt;<i>   C#, so we haven't found a way to create C-callable 
</I>&gt;<i>   functions in C#. It seems very unlikely that we'd be 
</I>&gt;<i>   able to take a Managed C++ DLL from Windows onto a Mono
</I>&gt;<i>   platform and link C code against it successfully, so we 
</I>&gt;<i>   need a way to build Managed C++ code on the Mono platform 
</I>&gt;<i>   - or some other language that can provide C-callable 
</I>&gt;<i>   interfaces and call C# code.
</I>
There is no solution at this point. 

One possibility is to add support for the runtime consumed by the new
&quot;pure&quot; CLI C++ code, but at this point we have not looked into what it
would take, nor how complete the support could be.

Even if we were able to run pure C++/CLI code, the problem is that this
code will likely depend on the internal structure of the vtables and
classes specific to the MS C++ compiler on Windows.  It will very likely
be different than the GCC produced output (in GCC this has changed
across versions for example).

My suggestion is to manually wrap the API entry points from C++ that you
need to consume, something like this:

#include &quot;greeter.hpp&quot;
extern &quot;C&quot; { int SayHello (void *object, char *person); }

int SayHello (void *object, char *person)
{
	((Greeter) object)-&gt;Hello (person);
}


&gt;<i> * Support for calling 64-bit native code, on 64-bit Linux, 
</I>&gt;<i>   Solaris, et al. 
</I>
Mono 1.2 will work at least on two 64-bit platforms: amd64 and Solaris
64 bits (Mono 1.1.3 already supports this).

Miguel

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025335.html">[Mono-list] Questions on the Mono roadmap
</A></li>
	<LI> Next message: <A HREF="025344.html">[Mono-list] Questions on the Mono roadmap
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25341">[ date ]</a>
              <a href="thread.html#25341">[ thread ]</a>
              <a href="subject.html#25341">[ subject ]</a>
              <a href="author.html#25341">[ author ]</a>
         </LI>
       </UL>
</body></html>
