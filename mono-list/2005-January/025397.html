<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] AuthenticationTypes.Secure problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jonathan.wallmander%40consultant.volvo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025412.html">
   <LINK REL="Next"  HREF="025399.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] AuthenticationTypes.Secure problem
   </H1>
    <B>Wallmander Jonathan
    </B> 
    <A HREF="mailto:jonathan.wallmander%40consultant.volvo.com"
       TITLE="[Mono-list] AuthenticationTypes.Secure problem">jonathan.wallmander@consultant.volvo.com
       </A><BR>
    <I>Fri, 21 Jan 2005 11:33:10 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="025412.html">[Mono-list] Mono C# and Windows Shares
</A></li>
        <LI> Next message: <A HREF="025399.html">[Mono-list] AuthenticationTypes.Secure problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25397">[ date ]</a>
              <a href="thread.html#25397">[ thread ]</a>
              <a href="subject.html#25397">[ subject ]</a>
              <a href="author.html#25397">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I'm trying to write a small script that verifies users against AD using =
mono.
Or rather, I'm porting one from windows.NET and want to run this in mono =
on linux.

Here's the code, based on examples here:

			DirectoryEntry de =3D new =
DirectoryEntry(&quot;<A HREF="LDAP://server.domain.net/DC=3Dfoo,DC=3Dbar,DC=3Dbaz,DC=3D=">LDAP://server.domain.net/DC=3Dfoo,DC=3Dbar,DC=3Dbaz,DC=3D=</A>
net&quot;
				,&quot;myusername\myusername&quot;,&quot;mypass&quot;,AuthenticationTypes.Secure);
			DirectorySearcher src =3D new =
DirectorySearcher(&quot;(objectclass=3DUser)&quot;);
			//DataTable for users
			DataTable tbUsers =3D new DataTable(&quot;users&quot;);
			//Create Columns for DataTable.
			tbUsers.Columns.Add(&quot;cn&quot;,System.Type.GetType(&quot;System.String&quot;));
			ds.Tables.Add(tbUsers);
			//DataTable for properties
			DataTable tbProperties =3D new DataTable(&quot;properties&quot;);
			//Create Columns for DataTable.
			=
tbProperties.Columns.Add(&quot;PropertyName&quot;,System.Type.GetType(&quot;System.Strin=
g&quot;));
			=
tbProperties.Columns.Add(&quot;PropertyValue&quot;,System.Type.GetType(&quot;System.Stri=
ng&quot;));
			ds.Tables.Add(tbProperties);
				=09
			src.SearchRoot =3D de;
			src.SearchScope =3D SearchScope.Subtree;
			src.Filter =3D (&quot;(SAMAccountName=3Dmyusername)&quot;);
			SearchResult res =3D null;
			{
				res =3D src.FindOne();
				Console.WriteLine(res.ToString());
			}
		=09
			/*catch (Exception ex) {
				Console.WriteLine(&quot;Error authenticating user.&quot; + ex.Message);
			}*/
		=09
			//foreach(SearchResult res in src.FindAll())
			//{
				//System.Collections.IDictionaryEnumerator ien =3D =
res.Properties.GetEnumerator();
			if (res !=3D null) {
				DataRow topRow =3D ds.Tables[&quot;users&quot;].NewRow();
				topRow[&quot;cn&quot;] =3Dres.Properties[&quot;cn&quot;][0];
				ds.Tables[&quot;users&quot;].Rows.Add(topRow);
				DataGrid1.DataSource =3D ds.Tables[&quot;users&quot;];
				DataGrid1.DataBind();
			}

---------


On the linux server (apache+mod_mono), i get this error:

Error Message: HTTP 500.

Stack Trace:

System.ArgumentNullException: Argument cannot be null.
in &lt;0x00078&gt; System.String:FormatHelper =
(System.Text.StringBuilder,System.IFormatProvider,string,object[])
in &lt;0x0003d&gt; System.String:Format =
(System.IFormatProvider,string,object[])
in &lt;0x00175&gt; Novell.Directory.Ldap.Utilclass.ResourcesHandler:getMessage =
(string,object[],System.Globalization.CultureInfo)
in &lt;0x00013&gt; Novell.Directory.Ldap.Utilclass.ResourcesHandler:getMessage =
(string,object[])
in &lt;0x000bf&gt; Novell.Directory.Ldap.LdapException:getExceptionString =
(string)
in &lt;0x00013&gt; Novell.Directory.Ldap.LdapException:ToString ()
in &lt;0x0021f&gt; System.Web.HttpException:GetDefaultErrorMessage ()
in &lt;0x00047&gt; System.Web.HttpException:GetHtmlErrorMessage ()
in &lt;0x0021b&gt; System.Web.HttpRuntime:FinishRequest =
(System.Web.HttpContext,System.Exception)
in &lt;0x000fb&gt; System.Web.HttpRuntime:OnHandlerReady (System.IAsyncResult)
in &lt;0x0005d&gt; (wrapper delegate-invoke) =
System.MulticastDelegate:invoke_void_IAsyncResult (System.IAsyncResult)
in &lt;0x0003e&gt; System.Web.HttpAsyncResult:Complete =
(bool,object,System.Exception)
in &lt;0x00240&gt; StateMachine:ExecuteNext (System.Exception)
in &lt;0x00051&gt; StateMachine:ExecuteNextAsync (System.Exception)
in &lt;0x00022&gt; StateMachine:Start ()
in &lt;0x0006a&gt; =
System.Web.HttpApplication:System.Web.IHttpAsyncHandler.BeginProcessReque=
st (System.Web.HttpContext,System.AsyncCallback,object)
in &lt;0x002ee&gt; System.Web.HttpRuntime:InternalExecuteRequest =
(System.Web.HttpWorkerRequest)

The examples

Does this mean that the .Secure type of the AuthenticationTypes enum =
isn't available? From what I can see,
AD uses kerberos+LDAP (but the manual of the .Secure in msdn says NTLM)
and hence should be possible to implement in mono on linux.. Or am I =
wrong?

Any explanation about this or help greatly appreciated :)

/jonathan wallmander

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025412.html">[Mono-list] Mono C# and Windows Shares
</A></li>
	<LI> Next message: <A HREF="025399.html">[Mono-list] AuthenticationTypes.Secure problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25397">[ date ]</a>
              <a href="thread.html#25397">[ thread ]</a>
              <a href="subject.html#25397">[ subject ]</a>
              <a href="author.html#25397">[ author ]</a>
         </LI>
       </UL>
</body></html>
