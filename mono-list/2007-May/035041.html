<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Strange timing issue when reading ExitCode from spawned	process
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Strange%20timing%20issue%20when%20reading%20ExitCode%20from%20spawned%0A%09process&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035063.html">
   <LINK REL="Next"  HREF="035064.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Strange timing issue when reading ExitCode from spawned	process</H1>
    <B>Patrick Fernie</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Strange%20timing%20issue%20when%20reading%20ExitCode%20from%20spawned%0A%09process&In-Reply-To="
       TITLE="[Mono-list] Strange timing issue when reading ExitCode from spawned	process">pfernie at jwmp.com
       </A><BR>
    <I>Wed May  9 18:24:08 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035063.html">[Mono-list] XML-RPC Thread Falling Asleep
</A></li>
        <LI>Next message: <A HREF="035064.html">[Mono-list] how to configure monodoc-http
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35041">[ date ]</a>
              <a href="thread.html#35041">[ thread ]</a>
              <a href="subject.html#35041">[ subject ]</a>
              <a href="author.html#35041">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm having some weird behavior with processes being spawned and getting
the ExitCode of that process. Sample code can be seen at
<A HREF="http://pastebin.ca/479814.">http://pastebin.ca/479814.</A> This code is a simplification of a much more
complex system we have. Basically, we have a job distribution and
logging system that controls processes launching on remote machines.
This much simplified version simply spawns a process (a simple program
that returns as its exit code the parameter passed to it), polls
HasExited on that Process object until true, and then reads the
ExitCode. If a trivial WaitForExit(1) is placed after the call to
Start(), the ExitCode can be read fine. If not, the ExitCode comes back
0. If a Sleep() call is used to delay reading the ExitCode, it will once
again get the proper exit code. If, as the sample pasted shows, you
sleep for even up to 5 seconds, poll the ExitCode, it will be 0, but
wait another 5 seconds and poll again, and the ExitCode will be set.
This seems like some odd timing behavior; is this in any way expected? I
did a quick search and didn't really find mention of this bug/behavior.
If there is a valid reason for it, is there a known way to properly
recover the ExitCode? (WaitForExit(1) is our current solution, but seems
less that optimal!). Basically, it seems to me that the ExitCode should
be populated as soon as/before HasExited becomes true.

 

-Patrick

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20070509/8196f1d4/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20070509/8196f1d4/attachment.html</A> 
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035063.html">[Mono-list] XML-RPC Thread Falling Asleep
</A></li>
	<LI>Next message: <A HREF="035064.html">[Mono-list] how to configure monodoc-http
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35041">[ date ]</a>
              <a href="thread.html#35041">[ thread ]</a>
              <a href="subject.html#35041">[ subject ]</a>
              <a href="author.html#35041">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
