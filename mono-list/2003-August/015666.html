<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] TripleDES encryption problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:carlosga%40telefonica.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="015658.html">
   <LINK REL="Next"  HREF="015667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] TripleDES encryption problem
   </H1>
    <B>Carlos Guzman Alvarez
    </B> 
    <A HREF="mailto:carlosga%40telefonica.net"
       TITLE="[Mono-list] TripleDES encryption problem">carlosga@telefonica.net
       </A><BR>
    <I>Sat, 30 Aug 2003 00:56:30 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="015658.html">[Mono-list] TripleDES encryption problem
</A></li>
        <LI> Next message: <A HREF="015667.html">[Mono-list] TripleDES encryption problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15666">[ date ]</a>
              <a href="thread.html#15666">[ thread ]</a>
              <a href="subject.html#15666">[ subject ]</a>
              <a href="author.html#15666">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello:

&gt;<i> However this isn't the MAC used in SSL nor TLS - so it
</I>&gt;<i> shouldn't affect you.
</I>
Yes i'm not using MACTripleDES :)

&gt;<i> When you say that it works under Windows/MS.NET do you mean your TLS code
</I>&gt;<i> runs normally using the MS TripleDES implementation ?
</I>
Yes, at least with my sample code, in Windows it finish the handshake
protocol sends ok a message and receives ok a message from the openssl
server, in linux the first message send encrypted is rejected by openssl 
server ( The Client Finished message ).

I have recompiled OpenSSL for use better debug capabilities and add some 
  output to the console in the TLS implementation, i think that the 
problem can be with the padding ( but i'm not sure ) what do you think 
?? Here is the debug output:



TLS Implementation Debug Output

Cipher mode CBC
Padding mode PKCS7
KeySize size 192
Block size 64

Initialization vector
429D93CF52066A15

Encryption info
Fragment length 37
Padding length 3
Cipher length 40

MAC Contents
25 f7 8b 4e e7 dd 0d 34 66 9c fa 1d e2 29 9b 7e ee b3 e0 11

Fragment Contents
14 00 00 0c 29 80 4d a0 a6 74 1e 46 08 a8 8b c4

Ciphered message contents
7e 86 4f 37 75 84 d4 6f ea 26 45 f9 1d 2a 73 04 40 fc 84 10 46 54 74 2c 
75 6b 53 45 55 a4 33 9d 08 95 24 3c 26 e9 ed ce


OpenSSL Debug Output


tls1_enc(0)
EVP_Cipher(ds=0x8184a20,rec-&gt;data=0x81744c5,rec-&gt;input=0x81744c5,l=40) ==&gt;
         EVP_CIPHER_CTX: 0 buf_len, 24 key_len [8 128], 8 iv_len
                 IV: 429D93CF52066A15
         rec-&gt;input= 7e 86 4f 37 75 84 d4 6f ea 26 45 f9 1d 2a 73 04 40 
fc 84 10
46 54 74 2c 75 6b 53 45 55 a4 33 9d 08 95 24 3c 26 e9 ed ce
des_ede_cbc_cipher(ctx=8184a20, buflen=0)
          iv= 429D93CF52066A15
         rec-&gt;data= 14 00 00 0c 29 80 4d a0 a6 74 1e 46 08 a8 8b c4 25 
f7 8b 4e e7 dd 0d 34 66 9c fa 1d e2 29 9b 7e 03 07 07 07 07 07 07 07
dec 40
14 00 00 0C 29 80 4D A0 A6 74 1E 46 08 A8 8B C4
25 F7 8B 4E E7 DD 0D 34 66 9C FA 1D E2 29 9B 7E
03 07 07 07 07 07 07 07







-- 
Best regards

Carlos Guzmán Álvarez
Vigo-Spain



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="015658.html">[Mono-list] TripleDES encryption problem
</A></li>
	<LI> Next message: <A HREF="015667.html">[Mono-list] TripleDES encryption problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15666">[ date ]</a>
              <a href="thread.html#15666">[ thread ]</a>
              <a href="subject.html#15666">[ subject ]</a>
              <a href="author.html#15666">[ author ]</a>
         </LI>
       </UL>
</body></html>
