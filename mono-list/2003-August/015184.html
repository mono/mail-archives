<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Finalizer never called
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jonpryor%40vt.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="015182.html">
   <LINK REL="Next"  HREF="015185.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Finalizer never called
   </H1>
    <B>Jonathan Pryor
    </B> 
    <A HREF="mailto:jonpryor%40vt.edu"
       TITLE="[Mono-list] Finalizer never called">jonpryor@vt.edu
       </A><BR>
    <I>01 Aug 2003 07:58:53 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="015182.html">[Mono-list] Finalizer never called
</A></li>
        <LI> Next message: <A HREF="015185.html">[Mono-list] Finalizer never called
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15184">[ date ]</a>
              <a href="thread.html#15184">[ thread ]</a>
              <a href="subject.html#15184">[ subject ]</a>
              <a href="author.html#15184">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&lt;snip/&gt;
&gt;<i> A question: could really happen that a finalizer is never called?
</I>&gt;<i> If so, how would managed resources be released?
</I>
Is it possible for finalizers to never be called?  Yes.  Why?  Because
of this:

	class BadClass {
		~BadClass () {
			System.GC.ReRegisterForFinalize (this);
		}
	}

This class will never finalize, because every time the GC attempts to
finalize the class, it requests that it be kept alive.

The basic idea is that the GC keeps track of how many objects need to be
finalized.  During process shutdown, as long as this number is
declining, finalizers will continue to be run.  If this number stops
declining before reaching 0 (which would occur with the class above),
finalizers stop being executed, just so that the process can be shut
down within a reasonable timeframe.

Additionally, finalizers are run on a different thread, so that if a
finalizer never terminates (e.g. &quot;while (true) {}&quot;), the finalizer
thread can be terminated, allowing the process to shut down in an
orderly fashion.

It's unlikely that either of these situations will occur, but they need
to be taken into consideration.  Most of the time, finalizers should
always be run.  I would consider failure to do so to be a bug in the
runtime.

 - Jon



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="015182.html">[Mono-list] Finalizer never called
</A></li>
	<LI> Next message: <A HREF="015185.html">[Mono-list] Finalizer never called
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15184">[ date ]</a>
              <a href="thread.html#15184">[ thread ]</a>
              <a href="subject.html#15184">[ subject ]</a>
              <a href="author.html#15184">[ author ]</a>
         </LI>
       </UL>
</body></html>
