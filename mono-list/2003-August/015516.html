<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Re: [Gtk-sharp-list] DllImport on *.so files
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:dag%40wieers.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="015507.html">
   <LINK REL="Next"  HREF="015519.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Re: [Gtk-sharp-list] DllImport on *.so files
   </H1>
    <B>Dag Wieers
    </B> 
    <A HREF="mailto:dag%40wieers.com"
       TITLE="[Mono-list] Re: [Gtk-sharp-list] DllImport on *.so files">dag@wieers.com
       </A><BR>
    <I>Wed, 20 Aug 2003 02:42:22 +0200 (CEST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="015507.html">[Mono-list] Re: [Gtk-sharp-list] DllImport on *.so files
</A></li>
        <LI> Next message: <A HREF="015519.html">[Mono-list] Re: [Gtk-sharp-list] DllImport on *.so files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15516">[ date ]</a>
              <a href="thread.html#15516">[ thread ]</a>
              <a href="subject.html#15516">[ subject ]</a>
              <a href="author.html#15516">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 19 Aug 2003, Paolo Molaro wrote:

&gt;<i> On 08/19/03 Dag Wieers wrote:
</I>&gt;<i> &gt; &gt; &lt;dllmap dll=&quot;libgtk-win32-2.0-0.dll&quot; target=&quot;libgtk-x11-2.0.so.0&quot; /&gt;
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; This will load the same library through it's versioned soname, just like
</I>&gt;<i> &gt; &gt; when a normal C program is linked against libgtk+. No need for extra
</I>&gt;<i> &gt; &gt; libraries, you can just fix the config file on your system or test and
</I>&gt;<i> &gt; &gt; submit a patch for the config file installed by default by mono.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Nice, and I guess the mapping is used at buildtime ?
</I>&gt;<i> 
</I>&gt;<i> The mapping is used when the P/Invoke function is called.
</I>
So it is used at runtime. Doesn't that slow things down ?


&gt;<i> &gt; Still this does not guarantee that the .dll's work with the specific 
</I>&gt;<i> &gt; libraries installed, if I'm correct.
</I>&gt;<i> 
</I>&gt;<i> There is no way for any CLR implementation to fix the billions of ways
</I>&gt;<i> a programmer can screw up:-) When you use P/Invoke you're implicitly
</I>&gt;<i> using one binary interface of a library, so you must make sure that
</I>&gt;<i> specific library is loaded (hence the use of the versioned soname in the
</I>&gt;<i> dll mapping instead of the simple .so map).
</I>
Well, it surprised me that what is hardcoded is the .so file and not a 
versioned one. The developers now best what version(s) work. I would have 
expected a more intelligent way for developers to indicate what versioned 
soname are guaranteed to work (or at least should work).


&gt;<i> &gt; Eg. gtk-sharp requires gtkhtml3 and Red Hat only ships gtkhtml2 (and 
</I>&gt;<i> &gt; building gtkhtml3 is a real mess as it requires a newer gtk2 etc etc...)
</I>&gt;<i> 
</I>&gt;<i> If gtk-sharp really requires version 3, you can't use version 2.
</I>
Well, there's no way for me (an end-user or packager) to know this unless 
I test applications that use these libraries in any possible way. I only 
know that 'libgtkhtml3' is hardcoded what may mean that

  a. The developer has this by sheer luck installed and therefor used it
  b. The developer thinks it's better to use this one for what he needs it
  c. The developer _knows_ gtkhtml2 is not sufficient

I'd assume c. is the real reason, but there's no way to find out (because 
the others are plausible too ;-)))


&gt;<i> &gt; Some way of verifying if function-calls map with existing libraries would 
</I>&gt;<i> &gt; be prefered.
</I>&gt;<i> 
</I>&gt;<i> With C libraries you can check just the function name: not very useful.
</I>
That's why I would have expected something more thorough (by relying on 
header-files) to find out whether the API is supported. So that you at 
least know when it will never work.


But don't mind my criticism, I'm just a concerned packager and a novice C# 
developer that is trying to understand what the best way to make sure I'm 
not shipping packages that may break for other developers.

Thanks for your feedback,
--   dag wieers,  <A HREF="mailto:dag@wieers.com">dag@wieers.com</A>,  <A HREF="http://dag.wieers.com/">http://dag.wieers.com/</A>   --
[Any errors in spelling, tact or fact are transmission errors]


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="015507.html">[Mono-list] Re: [Gtk-sharp-list] DllImport on *.so files
</A></li>
	<LI> Next message: <A HREF="015519.html">[Mono-list] Re: [Gtk-sharp-list] DllImport on *.so files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15516">[ date ]</a>
              <a href="thread.html#15516">[ thread ]</a>
              <a href="subject.html#15516">[ subject ]</a>
              <a href="author.html#15516">[ author ]</a>
         </LI>
       </UL>
</body></html>
