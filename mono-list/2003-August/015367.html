<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Marshal.SizeOf() vs. sizeof operator
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mathpup%40mylinuxisp.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="015362.html">
   <LINK REL="Next"  HREF="015368.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Marshal.SizeOf() vs. sizeof operator
   </H1>
    <B>Marcus
    </B> 
    <A HREF="mailto:mathpup%40mylinuxisp.com"
       TITLE="[Mono-list] Marshal.SizeOf() vs. sizeof operator">mathpup@mylinuxisp.com
       </A><BR>
    <I>Tue, 12 Aug 2003 16:34:38 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="015362.html">[Mono-list] Marshal.SizeOf() vs. sizeof operator
</A></li>
        <LI> Next message: <A HREF="015368.html">[Mono-list] Marshal.SizeOf() vs. sizeof operator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15367">[ date ]</a>
              <a href="thread.html#15367">[ thread ]</a>
              <a href="subject.html#15367">[ subject ]</a>
              <a href="author.html#15367">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The sizeof operator can only be applied to valuetypes (e.g. char, int, struct) 
and not to reference types (classes). The sizeof operator is only available 
in unsafe code.

Marshal.SizeOf() can be applied to an instance or a Type, and it returns the 
unmanaged size of the object. Unlike the sizeof operator, Marshal.SizeOf() is 
not restricted to valuetypes.

I don't quite understand what you were saying about char types. Can you 
provide an example?

As for custom classes, I suspect that you need to use the StructLayout
attribute, such as [StructLayout(LayoutKind.Sequential)] or using
explicit layout. The error on Rotor is System.ArgumentException: Type Class 
can not be marshaled as an unmanaged structure; no meaningful size or offset 
can be computed.




On Tuesday 12 August 2003 7:29 am, Giuseppe Greco wrote:

&gt;<i> Marshal.SizeOf() and the sizeof() operator
</I>&gt;<i> return the same result, so what's the real
</I>&gt;<i> difference between them?
</I>&gt;<i>
</I>&gt;<i> Until now, I've used Marshal.SizeOf()...
</I>&gt;<i> and with Mono on Linux it works fine.
</I>&gt;<i>
</I>&gt;<i> This morning I've had the good (or bad) idea
</I>&gt;<i> to test my code on Windows with .NET... and
</I>&gt;<i> the result was
</I>&gt;<i>
</I>&gt;<i> 1. Marshal.SizeOf() is unable to determine the
</I>&gt;<i>    type of custom classes
</I>&gt;<i>
</I>&gt;<i> 2. for char types, Marshal.SizeOf() always returns
</I>&gt;<i>    &quot;System.byte[]&quot; instead of &quot;System.Char&quot;
</I>
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="015362.html">[Mono-list] Marshal.SizeOf() vs. sizeof operator
</A></li>
	<LI> Next message: <A HREF="015368.html">[Mono-list] Marshal.SizeOf() vs. sizeof operator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15367">[ date ]</a>
              <a href="thread.html#15367">[ thread ]</a>
              <a href="subject.html#15367">[ subject ]</a>
              <a href="author.html#15367">[ author ]</a>
         </LI>
       </UL>
</body></html>
