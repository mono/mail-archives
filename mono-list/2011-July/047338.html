<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] HttpWebRequest.GetResponse() can trigger an uncatchable exception
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20HttpWebRequest.GetResponse%28%29%20can%20trigger%20an%0A%20uncatchable%20exception&In-Reply-To=4E171891.7060100%40chrishowie.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="047330.html">
   <LINK REL="Next"  HREF="047340.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] HttpWebRequest.GetResponse() can trigger an uncatchable exception</H1>
    <B>Gonzalo Paniagua Javier</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20HttpWebRequest.GetResponse%28%29%20can%20trigger%20an%0A%20uncatchable%20exception&In-Reply-To=4E171891.7060100%40chrishowie.com"
       TITLE="[Mono-list] HttpWebRequest.GetResponse() can trigger an uncatchable exception">gonzalo.mono at gmail.com
       </A><BR>
    <I>Sat Jul  9 11:50:34 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="047330.html">[Mono-list] HttpWebRequest.GetResponse() can trigger an uncatchable exception
</A></li>
        <LI>Next message: <A HREF="047340.html">[Mono-list] HttpWebRequest.GetResponse() can trigger an uncatchable exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47338">[ date ]</a>
              <a href="thread.html#47338">[ thread ]</a>
              <a href="subject.html#47338">[ subject ]</a>
              <a href="author.html#47338">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jul 8, 2011 at 10:47 AM, Christopher David Howie
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">me at chrishowie.com</A>&gt; wrote:
&gt;<i> On 07/08/2011 10:43 AM, Gonzalo Paniagua Javier wrote:
</I>&gt;&gt;<i> Do you have a small test case that reproduces the problem?
</I>&gt;<i>
</I>&gt;<i> No, unfortunately. &#160;This happens in maybe one out of a few thousand
</I>&gt;<i> requests. &#160;The only test case I can really come up with is &quot;make lots of
</I>&gt;<i> web requests on different threads until a crash happens.&quot; &#160;I will poke
</I>&gt;<i> around a bit and see if I can come up with a better repro, but it's just
</I>&gt;<i> too intermittent to predict. &#160;I suspect that it is dependent on a socket
</I>&gt;<i> error to trigger.
</I>
Not much I can do without a test case.

I'd say that this is a problem reusing a connection and somehow 2
threads &quot;own&quot; the same stream. Set KeepAlive to false (and increase
the number of file descriptors! (ulimit)) and see if you can still
reproduce the problem. If it does not happen, bingo! Reduce the
'maxconnections' setting via app.config file to 1 and begin as many
requests as possible to the same URL. If you can reproduce it this
way, it's easier to find when 2 threads are using the same stream.

Also check the values of the variables involved in that BlockCopy call
and the values of readBuffer* before the call.

-Gonzalo
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="047330.html">[Mono-list] HttpWebRequest.GetResponse() can trigger an uncatchable exception
</A></li>
	<LI>Next message: <A HREF="047340.html">[Mono-list] HttpWebRequest.GetResponse() can trigger an uncatchable exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47338">[ date ]</a>
              <a href="thread.html#47338">[ thread ]</a>
              <a href="subject.html#47338">[ subject ]</a>
              <a href="author.html#47338">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
