<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Why is 0.1f + 0.2f - 0.3f produces such a large	error number?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Why%20is%200.1f%20%2B%200.2f%20-%200.3f%20produces%20such%20a%20large%0A%09error%20number%3F&In-Reply-To=%3CCAGu5pZf%3DqqeQfKzf37Gp0-HWmZRWwni0GZVW95VnkYw9eoLNDg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="052102.html">
   <LINK REL="Next"  HREF="052104.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Why is 0.1f + 0.2f - 0.3f produces such a large	error number?</H1>
    <B>Alan</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Why%20is%200.1f%20%2B%200.2f%20-%200.3f%20produces%20such%20a%20large%0A%09error%20number%3F&In-Reply-To=%3CCAGu5pZf%3DqqeQfKzf37Gp0-HWmZRWwni0GZVW95VnkYw9eoLNDg%40mail.gmail.com%3E"
       TITLE="[Mono-list] Why is 0.1f + 0.2f - 0.3f produces such a large	error number?">alan.mcgovern at gmail.com
       </A><BR>
    <I>Tue May 17 12:23:23 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="052102.html">[Mono-list] Why is 0.1f + 0.2f - 0.3f produces such a large	error number?
</A></li>
        <LI>Next message: <A HREF="052104.html">[Mono-list] Why is 0.1f + 0.2f - 0.3f produces such a large	error number?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52103">[ date ]</a>
              <a href="thread.html#52103">[ thread ]</a>
              <a href="subject.html#52103">[ subject ]</a>
              <a href="author.html#52103">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There's no reason you should not use it if the errors you are seeing are
within the tolerance of floating point calculation limits. If you require
more accuracy then use double instead of float. If you require perfect
accuracy then you'll have to use a special type/library which provides more
accuracy than standard float/double precision.

This is a good example of what can happen depending on what underlying CPU
instruction you end up invoking:
<A HREF="http://stackoverflow.com/questions/8795550/casting-a-result-to-float-in-method-returning-float-changes-result">http://stackoverflow.com/questions/8795550/casting-a-result-to-float-in-method-returning-float-changes-result</A>
. This is true for any language as the calculation is performed in
hardware, not in software. Some languages/compilers may provide more
explicit control on which CPU instruction you end up using and which
floating point precision mode is enabled.

Alan

On 17 May 2016 at 12:32, MarLOne &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">InfoSeeker002 at gmail.com</A>&gt; wrote:

&gt;<i> Thanks for the reply. The following disclosure may not have anything to do
</I>&gt;<i> with explaining this but it highlights some inconsistency in .Net:
</I>&gt;<i>
</I>&gt;<i> I know Mono is not exactly VS (well very close as Xamarin is now part of
</I>&gt;<i> Microsoft) but the following comparison is still valid and interesting:
</I>&gt;<i> VS2003, 2005, 2010, 2012 all returning a delta value of -7.450581E-09
</I>&gt;<i>
</I>&gt;<i> Anyone with a VS2013 can help by reporting what it produces.
</I>&gt;<i>
</I>&gt;<i> *VS2015 (regardless Update 1 or 2) returning 0*.
</I>&gt;<i>
</I>&gt;<i> Also regardless on what machine and processor type (even on mac), Swift,
</I>&gt;<i> Java, and C all returning 0 as expected. It seems from day one the C#
</I>&gt;<i> compiler is producing this same number until it comes to VS2015.
</I>&gt;<i>
</I>&gt;<i> I also had a look at the IL code generated and the compiler compiles the
</I>&gt;<i> constant expression so the IL code does not show any arithmetic expression.
</I>&gt;<i> I guess we can blame the compiler. But I rewrite the code in such a way the
</I>&gt;<i> compiler cannot compile away the value at compile time. Yet I am getting
</I>&gt;<i> the
</I>&gt;<i> same non-zero delta. I guess Microsoft and Mono can claim that is literally
</I>&gt;<i> zero because float according to ECMA C# standard is only good to 7 digits.
</I>&gt;<i> But that does not explain why the other compiler/languages have so much
</I>&gt;<i> more
</I>&gt;<i> accuracy.
</I>&gt;<i>
</I>&gt;<i> Does this mean one should not use C# when performing scientific
</I>&gt;<i> calculations? The above information is interesting.
</I>&gt;<i>
</I>&gt;<i> If you construct a DLL or COM component using C/C++, the return value (by
</I>&gt;<i> P/Invoke or COM call) will be zero. If you then enhance the DLL by
</I>&gt;<i> rewriting
</I>&gt;<i> it in a .Net component, the return value to a .net client is
</I>&gt;<i> -7.450581E-09!!
</I>&gt;<i> The same client but component developed with different languages. Is this a
</I>&gt;<i> good language to deal with integration?
</I>&gt;<i>
</I>&gt;<i> May be that's why VS2015 took the decision to fix it. When will a mono
</I>&gt;<i> compiler matching VS2015's?
</I>&gt;<i>
</I>&gt;<i> Leon
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://mono.1490590.n4.nabble.com/Why-is-0-1f-0-2f-0-3f-produces-such-a-large-error-number-tp4667837p4667848.html">http://mono.1490590.n4.nabble.com/Why-is-0-1f-0-2f-0-3f-produces-such-a-large-error-number-tp4667837p4667848.html</A>
</I>&gt;<i> Sent from the Mono - General mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20160517/9d6bbf8e/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20160517/9d6bbf8e/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="052102.html">[Mono-list] Why is 0.1f + 0.2f - 0.3f produces such a large	error number?
</A></li>
	<LI>Next message: <A HREF="052104.html">[Mono-list] Why is 0.1f + 0.2f - 0.3f produces such a large	error number?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52103">[ date ]</a>
              <a href="thread.html#52103">[ thread ]</a>
              <a href="subject.html#52103">[ subject ]</a>
              <a href="author.html#52103">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
