<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Npgsql.dll
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Npgsql.dll&In-Reply-To=20050514201724.5A91070013%40frontgate.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027006.html">
   <LINK REL="Next"  HREF="027175.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Npgsql.dll</H1>
    <B>Chris Aitken</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Npgsql.dll&In-Reply-To=20050514201724.5A91070013%40frontgate.ximian.com"
       TITLE="[Mono-list] Npgsql.dll">chris at ion-dreams.com
       </A><BR>
    <I>Mon May 23 05:09:20 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="027006.html">[Mono-list] Npgsql.dll
</A></li>
        <LI>Next message: <A HREF="027175.html">[Mono-list] Npgsql.dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27169">[ date ]</a>
              <a href="thread.html#27169">[ thread ]</a>
              <a href="subject.html#27169">[ subject ]</a>
              <a href="author.html#27169">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> I have the page working better now, but the stored procedures 
</I>&gt;<i> aren't doing what I want.  I'm using an sql stored procedure 
</I>&gt;<i> that returns a set of records.  My function is called 
</I>&gt;<i> senators() - (&quot;select * from
</I>&gt;<i> senate_members&quot;) and it returns the entire table.  The Npgsql 
</I>&gt;<i> command text is &quot;select field1(senators()), 
</I>&gt;<i> field2(senators())&quot; and it returns the information correctly. 
</I>&gt;<i>  I was just hoping I could write (&quot;select field1,
</I>&gt;<i> field2 from senators&quot;) as the function instead of returning 
</I>&gt;<i> the entire table.  It seems like the stored procedures in 
</I>&gt;<i> MSSQL 2000 are a lot better than the stored procedures in 
</I>&gt;<i> PostgreSQL, but maybe I still don't know what I'm doing.  I 
</I>&gt;<i> could just as easily execute this query directly on my 
</I>&gt;<i> database and return only the two fields I need.  The stored 
</I>&gt;<i> procedure isn't giving me any increase in efficiency, and it 
</I>&gt;<i> actually appears to be less efficient.
</I>
This is a PostgreSQL function written in SQL. If you get really bored, you
could rewrite it in PL/pgSQL - although then you'd need to define a type to
hold the record, then write the function.

But as Francisco says - &quot;select field1, field2 from senators()&quot; should work.

Examples:
CREATE FUNCTION company() RETURNS setof tblcustomerinformation
    AS 'select * from tblcustomerinformation;'
    LANGUAGE SQL

To run the stored procedure: &quot;select * from company();&quot; - all recordsets
returned. (1)

To select only customername &amp; postcode: select customername,postcode from
company(); (2)

this runs the stored procedure, selecting ALL the information, and then
filters out just the cusotomername &amp; postcode. So running the sproc at (2)
is as intensive as running the sproc at (1).

As mentioned above - you could use a PL/PgSQL function.

Create the type first (customername &amp; postcode as both varchar in my table
tblcustomerinformation):

CREATE TYPE tp_company AS
   (customername varchar,
    postcode varchar);

Now create the function:
-- Function: plpgsql_company()

-- DROP FUNCTION plpgsql_company();

CREATE OR REPLACE FUNCTION plpgsql_company()
  RETURNS SETOF tp_company AS
'
DECLARE
	r tp_company%rowtype;
BEGIN
	FOR r IN SELECT customername,postcode FROM tblcustomerinformation
LOOP
		RETURN NEXT r;
	END LOOP;
	RETURN;
END
'
  LANGUAGE 'plpgsql' VOLATILE;

Unfortunartely this is the only way to directly return explicit columns from
a table via a sproc.

HTH

Chris


-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027006.html">[Mono-list] Npgsql.dll
</A></li>
	<LI>Next message: <A HREF="027175.html">[Mono-list] Npgsql.dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27169">[ date ]</a>
              <a href="thread.html#27169">[ thread ]</a>
              <a href="subject.html#27169">[ subject ]</a>
              <a href="author.html#27169">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
