<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Re: IStream implementation on Win32 for System.Drawing.Image.InitFromStream
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:kornelpal%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="026904.html">
   <LINK REL="Next"  HREF="026861.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Re: IStream implementation on Win32 for System.Drawing.Image.InitFromStream
   </H1>
    <B>Kornél Pál
    </B> 
    <A HREF="mailto:kornelpal%40hotmail.com"
       TITLE="[Mono-list] Re: IStream implementation on Win32 for System.Drawing.Image.InitFromStream">kornelpal@hotmail.com
       </A><BR>
    <I>Tue, 10 May 2005 10:21:50 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="026904.html">[Mono-list] Re: IStream implementation on Win32 for System.Drawing.Image.InitFromStream
</A></li>
        <LI> Next message: <A HREF="026861.html">[Mono-list] Recent Tutorials Feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26905">[ date ]</a>
              <a href="thread.html#26905">[ thread ]</a>
              <a href="subject.html#26905">[ subject ]</a>
              <a href="author.html#26905">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i> Could you post the code to the mailing list, so we can comment on it?
</I>
I have tried to send the source code several times in the last few day but
it seems to be imposible to send it:

I sent a previous version to Sanjay Gupta and he sent and reply to the list
then I answered it but none of these messages arrived yet, they are waitng
for moderation...

Then I sent a single ZIP file containing the source, it never appeared on
the list.
Finally I sent a message with all the source files attached separately as
plain text but it did not appeared.

Could you tell me what are the moderation and attachment rules of this list?

Previously I have tried to forward at the end of this message my discussion
with Sanjay Gupta but I think this may cause my message to be filtered out.

I uploaded the source code to
<A HREF="http://www1.kornelpal.hu/files/GdiPlusStream.zip">http://www1.kornelpal.hu/files/GdiPlusStream.zip</A>
It will be available at least for a week.

Note that as this is Win32 specific (GDI+ and IStream, the code itself not)
you have to run it under Windows.

Comments are welcome.

There is a question about debugging under Mono. If someone has better
solution please let me know.

ComIStreamWrapper.cs is a Stream to IStream wrapper. This is compatible with
.NET Framework COM interop without custom marshaling.
ComIStreamMarshaler.cs is a custom marshaler for UCOMIStream. It implements
CCW and RCW as well. When COM interface marshaling will be available in Mono
this is no longer required and if Mono will provide proper marshaling
support ComIStreamWrapper will be able to be used without
ComIStreamMarshaler.

These classes are based on only documented functionality.

Form1.cs is a demonstration form, it is full of hack as image creation form
a GDI+ handle is not supported using public methods.

RCW implementation is not supported on Mono as it does not implement
function pointer to delegate marshaling.
There are other limitations in Mono marshaling that could to be worked
around.

I filed the following bug reports:
<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=74882">http://bugzilla.ximian.com/show_bug.cgi?id=74882</A>
<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=74875">http://bugzilla.ximian.com/show_bug.cgi?id=74875</A>

Sincerely,
Kornél


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="026904.html">[Mono-list] Re: IStream implementation on Win32 for System.Drawing.Image.InitFromStream
</A></li>
	<LI> Next message: <A HREF="026861.html">[Mono-list] Recent Tutorials Feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26905">[ date ]</a>
              <a href="thread.html#26905">[ thread ]</a>
              <a href="subject.html#26905">[ subject ]</a>
              <a href="author.html#26905">[ author ]</a>
         </LI>
       </UL>
</body></html>
