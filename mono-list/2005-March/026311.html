<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Good Mono Project
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jonpryor%40vt.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="026310.html">
   <LINK REL="Next"  HREF="026308.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Good Mono Project
   </H1>
    <B>Jonathan Pryor
    </B> 
    <A HREF="mailto:jonpryor%40vt.edu"
       TITLE="[Mono-list] Good Mono Project">jonpryor@vt.edu
       </A><BR>
    <I>Fri, 18 Mar 2005 07:03:25 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="026310.html">[Mono-list] Re: Good Mono Project
</A></li>
        <LI> Next message: <A HREF="026308.html">[Mono-list] VB Good Mono Project
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26311">[ date ]</a>
              <a href="thread.html#26311">[ thread ]</a>
              <a href="subject.html#26311">[ subject ]</a>
              <a href="author.html#26311">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2005-03-18 at 22:33 +1300, Ralph Mason wrote:
&gt;<i> Seems to me that one can easily do a layer to create the com 'controls' 
</I>&gt;<i> (eg the standard ones provided) on top of WIndows.Forms.  Com controls 
</I>&gt;<i> are supported under windows.
</I>
Mono doesn't currently support COM controls anywhere.

&gt;<i> I can't imagine it's that hard to load a 
</I>&gt;<i> shared library and provide the 3 or 4 functions you need to make a com 
</I>&gt;<i> control work, and the standard interop stuff provided in the CLR should 
</I>&gt;<i> make calling those functions a snap.
</I>
Yes, only 3 or 4 functions...  Let's look at those functions:

DllRegisterServer() and DllUnregisterServer() are supposed to insert the
COM object into the Registry.  This requires Win32 Registry function
support.  (If you don't support the Win32 registry functions, no
existing COM object code will work, requiring developers to re-write
their code, which won't happen, eliminating the whole point of COM
support.)

DllCanUnloadNow() is easy enough to support.

DllGetClassObject() is also easy enough to support...  Except for
defining a COM interface layout (use GCC's __attribute__
((com_interface))?), and the implementation of the COM object (which
will likely require support for more Win32 functions such as
InterlockedIncrement() and InterlockedDecrement() if the COM object is
thread-safe).

Then there's the semantics of COM, such as the various apartment models.

COM is love, COM is simple (&quot;as simple as possible, but no simpler&quot;),
COM is great, but it isn't portable, and it was never intended to be.
COM object lookup is intimately tied into the Registry, the
implementation of most (all?) COM objects will require Win32 anyway, and
some COM apartment models require a Windows Message Loop.  It's very
difficult to remove COM from Win32 (it can be done; see Mozilla's
XPCOM), and if you want to maintain *any* compatibility with existing
COM objects, you need Win32.

If you don't care for maintaining Win32 support, then why are you
bothering with COM in the first place?  Just re-write in Mono, you'll
need to re-write anyway...

COM support is much more than just supporting 4 DLL exports.  At least,
it's much more than those 4 exports if you want it to mean anything.

 - Jon (who's done some COM programming...)



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="026310.html">[Mono-list] Re: Good Mono Project
</A></li>
	<LI> Next message: <A HREF="026308.html">[Mono-list] VB Good Mono Project
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26311">[ date ]</a>
              <a href="thread.html#26311">[ thread ]</a>
              <a href="subject.html#26311">[ subject ]</a>
              <a href="author.html#26311">[ author ]</a>
         </LI>
       </UL>
</body></html>
