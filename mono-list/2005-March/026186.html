<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Datasets passed between methods loses data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tont%40o2.ie">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="026182.html">
   <LINK REL="Next"  HREF="026187.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Datasets passed between methods loses data
   </H1>
    <B>anthony whalley
    </B> 
    <A HREF="mailto:tont%40o2.ie"
       TITLE="[Mono-list] Datasets passed between methods loses data">tont@o2.ie
       </A><BR>
    <I>Mon, 07 Mar 2005 11:00:37 +0000 (GMT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="026182.html">[Mono-list] fix for gtk# bug - Fedora Core 2
</A></li>
        <LI> Next message: <A HREF="026187.html">[Mono-list] Datasets passed between methods loses data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26186">[ date ]</a>
              <a href="thread.html#26186">[ thread ]</a>
              <a href="subject.html#26186">[ subject ]</a>
              <a href="author.html#26186">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Atsushi

I should of been more explicit in my example.
If I call 
 ds.GetXml(); 
in the GetLogFile method before passing it over
then it returns the full XML document and
I can also access the full structure using 
the usual methods. e.g. ds.Tables[0]

It is only when I pass it to a new method that 
the issue arises. 

Thanks for the hint on the loading of 
mal formed XML but the file i am loading
is the Xml formatted log from log4net not
a tab deliniated. 

TTFN 

tont


----- Original Message -----
From: Atsushi Eno &lt;<A HREF="mailto:atsushi@ximian.com">atsushi@ximian.com</A>&gt;
Date: Monday, March 7, 2005 10:07 am
Subject: Re: [Mono-list] Datasets passed between methods loses data

&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> Actually it depends on the content of &quot;server.log&quot; since the XML
</I>&gt;<i> structure is not determined only with that code. If that log file
</I>&gt;<i> contains only simple text (BTW that code is really not recommended
</I>&gt;<i> because it will raise an XmlException if there is broken XML
</I>&gt;<i> fragment), it won't return any XML content, since that simple text
</I>&gt;<i> content is not mapped to any DataTable, nor the &quot;root&quot; element is
</I>&gt;<i> not regarded as a DataTable.
</I>&gt;<i> 
</I>&gt;<i> DataSet is not such universal XML store. It just holds such contents
</I>&gt;<i> that is mappable to table set structure and ReadXml() ignores
</I>&gt;<i> other content. Just FYI, MS.NET also ignores the text content.
</I>&gt;<i> 
</I>&gt;<i> Atsushi Eno
</I>&gt;<i> 
</I>&gt;<i> anthony whalley wrote:
</I>&gt;<i> &gt; Hi All 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I am writing an application that marshells a log4net 
</I>&gt;<i> &gt; file into a dataset and then passes the dataset
</I>&gt;<i> &gt; over to another method. I am using v 1.1.4 from the 
</I>&gt;<i> &gt; RPMs on Suse 9.2 and below is the code.
</I>&gt;<i> &gt; However when I test the dataset returned it 
</I>&gt;<i> &gt; has only a root node even though before
</I>&gt;<i> &gt; it is passed it has all the data inside it. 
</I>&gt;<i> &gt; I have solved the prolem for now by passing over
</I>&gt;<i> &gt; the data as a string type and marhalling the 
</I>&gt;<i> &gt; data there but wondered if I should
</I>&gt;<i> &gt; report it as a bug?? 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; public class obj{
</I>&gt;<i> &gt;         	public DataSet GetLogFile()
</I>&gt;<i> &gt;         	{
</I>&gt;<i> &gt;                 	DataSet ds = new DataSet() ;
</I>&gt;<i> &gt;                 	try 
</I>&gt;<i> &gt;                 	{
</I>&gt;<i> &gt;                         	string _logLocation = 
</I>&gt;<i> Environment.CurrentDirectory + Path.DirectorySeparatorChar + 
</I>&gt;<i> &quot;server.log&quot; ;
</I>&gt;<i> &gt;                         	Stream stm = File.Open(_logLocation, 
</I>&gt;<i> FileMode.Open, FileAccess.Read, FileShare.ReadWrite) ;
</I>&gt;<i> &gt;                         	
</I>&gt;<i> &gt;                         	StreamReader str = new 
</I>&gt;<i> StreamReader(stm) ;
</I>&gt;<i> &gt;                         	ds.ReadXml(new StringReader(&quot;&lt;root 
</I>&gt;<i> xmlns:log4net='&quot; target=&quot;l&quot;&gt;<A HREF="http://logging.apache.org/log4net/LogSchema'">http://logging.apache.org/log4net/LogSchema'</A>&gt;&quot; + 
</I>&gt;<i> &gt;                                 	str.ReadToEnd() + 
</I>&gt;<i> &gt;                                 	&quot;&lt;/root&gt;&quot;)) ;
</I>&gt;<i> &gt;                         	str.Close();
</I>&gt;<i> &gt;                         	stm.Close();
</I>&gt;<i> &gt;                         	
</I>&gt;<i> &gt;                 	}
</I>&gt;<i> &gt;                 	catch(Exception e)
</I>&gt;<i> &gt;                 	{
</I>&gt;<i> &gt;                         	log.Error(&quot;Get log file error&quot;, e) ; 
</I>&gt;<i> &gt;                 	}
</I>&gt;<i> &gt;                 	return ds ;
</I>&gt;<i> &gt;         	}
</I>&gt;<i> &gt; }
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; public class otherObj
</I>&gt;<i> &gt; {
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   obj o = new obj() ;
</I>&gt;<i> &gt;   DataSet ds = new DataSet() ;
</I>&gt;<i> &gt;   public void testxml(){
</I>&gt;<i> &gt;   ds = o.GetLogFile() ;
</I>&gt;<i> &gt;   Console.WriteLine(ds.GetXml()); //returns &lt;root /&gt;
</I>&gt;<i> &gt; }
</I>&gt;<i> &gt; }
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="026182.html">[Mono-list] fix for gtk# bug - Fedora Core 2
</A></li>
	<LI> Next message: <A HREF="026187.html">[Mono-list] Datasets passed between methods loses data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26186">[ date ]</a>
              <a href="thread.html#26186">[ thread ]</a>
              <a href="subject.html#26186">[ subject ]</a>
              <a href="author.html#26186">[ author ]</a>
         </LI>
       </UL>
</body></html>
