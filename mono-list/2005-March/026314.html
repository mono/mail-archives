<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] OutOfMemoryException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Yury%40serdyuk.botik.ru">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="026305.html">
   <LINK REL="Next"  HREF="026336.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] OutOfMemoryException
   </H1>
    <B>Yury Serdyuk
    </B> 
    <A HREF="mailto:Yury%40serdyuk.botik.ru"
       TITLE="[Mono-list] OutOfMemoryException">Yury@serdyuk.botik.ru
       </A><BR>
    <I>Fri, 18 Mar 2005 15:29:38 +0300</I>
    <P><UL>
        <LI> Previous message: <A HREF="026305.html">[Mono-list] Color coding my ASP pages?
</A></li>
        <LI> Next message: <A HREF="026336.html">[Mono-list] OutOfMemoryException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26314">[ date ]</a>
              <a href="thread.html#26314">[ thread ]</a>
              <a href="subject.html#26314">[ subject ]</a>
              <a href="author.html#26314">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.
--------------000209080300000406020905
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit

Hi !

I've encountered problem trying allocate array of  &gt; 1 Gb size on 
machine with 4 Gb RAM :

        total:    used:    free:  shared: buffers:  cached:
Mem:  4234272768 2322898944 1911373824        0 128507904 1867874304
Swap: 2097434624        0 2097434624
MemTotal:      4135032 kB
MemFree:       1866576 kB
MemShared:           0 kB
Buffers:        125496 kB
Cached:        1824096 kB
SwapCached:          0 kB
Active:         506704 kB
Inactive:      1471372 kB
HighTotal:     3276224 kB
HighFree:      1613452 kB
LowTotal:       858808 kB
LowFree:        253124 kB
SwapTotal:     2048276 kB
SwapFree:      2048276 kB
meminfo (END)

[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ uname -a
Linux server 2.4.25bigmem #7 SMP Wed Dec 15 10:05:05 EET 2004 i686 i686 
i386 GNU/Linux

[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ mono Test1GbMemory.exe 400
Array size = 512000000
Allocated bytes = 512098304
[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ mono Test1GbMemory.exe 500

Unhandled Exception: System.OutOfMemoryException: Out of memory
in (unmanaged) 0x8080be0
in &lt;0x00004&gt; (wrapper managed-to-native) 
System.Object:__icall_wrapper_ves_array_new_va_3 
(intptr,intptr,intptr,intptr)
in &lt;0x00037&gt; Test1GbMemory:Main (string[])

[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$

[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ mono -V
Mono JIT compiler version 1.1.4, (C) 2002-2004 Novell, Inc and 
Contributors. www.go-mono.com
        TLS:           __thread
        GC:            Included Boehm (with typed GC)
        SIGSEGV      : normal
        Globalization: none
[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$

&gt;<i> using System;
</I>&gt;<i>
</I>&gt;<i> public class Test1GbMemory {
</I>&gt;<i>
</I>&gt;<i>  public static void Main ( String[] args ) {
</I>&gt;<i>
</I>&gt;<i>   int N = System.Convert.ToInt32 ( args [ 0 ] );
</I>&gt;<i>
</I>&gt;<i>   double[,,] array = new double [ N, N, N ];
</I>&gt;<i>
</I>&gt;<i>   Console.WriteLine ( &quot;Array size = &quot; + ( N * N * N * 8 ) + &quot;\n&quot; +
</I>&gt;<i>                       &quot;Allocated bytes = &quot; + GC.GetTotalMemory  ( 
</I>&gt;<i> false ) );
</I>&gt;<i>   return;
</I>&gt;<i>
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i> }
</I>
Is it a bug  or
there are some special tools to work  on  big memory  ?

Thanks.

Yury.

--------------000209080300000406020905
Content-Type: text/html; charset=us-ascii
Content-Transfer-Encoding: 7bit

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta content=&quot;text/html;charset=ISO-8859-1&quot; http-equiv=&quot;Content-Type&quot;&gt;
  &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body bgcolor=&quot;#ffffff&quot; text=&quot;#000000&quot;&gt;
Hi !&lt;br&gt;
&lt;br&gt;
I've encountered problem trying allocate array of&amp;nbsp; &amp;gt; 1 Gb size on
machine with 4 Gb RAM :&lt;br&gt;
&lt;br&gt;
&amp;nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; total:&amp;nbsp;&amp;nbsp;&amp;nbsp; used:&amp;nbsp;&amp;nbsp;&amp;nbsp; free:&amp;nbsp; shared: buffers:&amp;nbsp; cached:&lt;br&gt;
Mem:&amp;nbsp; 4234272768 2322898944 1911373824&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0 128507904 1867874304&lt;br&gt;
Swap: 2097434624&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0 2097434624&lt;br&gt;
MemTotal:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 4135032 kB&lt;br&gt;
MemFree:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1866576 kB&lt;br&gt;
MemShared:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0 kB&lt;br&gt;
Buffers:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 125496 kB&lt;br&gt;
Cached:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1824096 kB&lt;br&gt;
SwapCached:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0 kB&lt;br&gt;
Active:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 506704 kB&lt;br&gt;
Inactive:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1471372 kB&lt;br&gt;
HighTotal:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 3276224 kB&lt;br&gt;
HighFree:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1613452 kB&lt;br&gt;
LowTotal:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 858808 kB&lt;br&gt;
LowFree:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 253124 kB&lt;br&gt;
SwapTotal:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 2048276 kB&lt;br&gt;
SwapFree:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 2048276 kB&lt;br&gt;
meminfo (END)&lt;/small&gt;&lt;br&gt;
&lt;br&gt;
[&lt;small&gt;<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ uname -a&lt;br&gt;
Linux server 2.4.25bigmem #7 SMP Wed Dec 15 10:05:05 EET 2004 i686 i686
i386 GNU/Linux&lt;br&gt;
&lt;br&gt;
[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ mono Test1GbMemory.exe 400&lt;br&gt;
Array size = 512000000&lt;br&gt;
Allocated bytes = 512098304&lt;br&gt;
[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ mono Test1GbMemory.exe 500&lt;br&gt;
&lt;br&gt;
Unhandled Exception: System.OutOfMemoryException: Out of memory&lt;br&gt;
in (unmanaged) 0x8080be0&lt;br&gt;
in &amp;lt;0x00004&amp;gt; (wrapper managed-to-native)
System.Object:__icall_wrapper_ves_array_new_va_3
(intptr,intptr,intptr,intptr)&lt;br&gt;
in &amp;lt;0x00037&amp;gt; Test1GbMemory:Main (string[])&lt;br&gt;
&lt;br&gt;
[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$&lt;br&gt;
&lt;br&gt;
[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$ mono -V&lt;br&gt;
Mono JIT compiler version 1.1.4, (C) 2002-2004 Novell, Inc and
Contributors. &lt;a class=&quot;moz-txt-link-abbreviated&quot; href=&quot;<A HREF="http://www.go-mono.com"">http://www.go-mono.com&quot;</A>&gt;www.go-mono.com&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; TLS:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; __thread&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; GC:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Included Boehm (with typed GC)&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; SIGSEGV&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; : normal&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Globalization: none&lt;br&gt;
[<A HREF="mailto:serdyuk@itk-104">serdyuk@itk-104</A> StreamRLI]$&lt;/small&gt;&lt;br&gt;
&lt;br&gt;
&lt;blockquote type=&quot;cite&quot;&gt;&lt;small&gt;using System;&lt;br&gt;
  &lt;br&gt;
public class Test1GbMemory {&lt;br&gt;
  &lt;br&gt;
&amp;nbsp;public static void Main ( String[] args ) {&lt;br&gt;
  &lt;br&gt;
&amp;nbsp; int N = System.Convert.ToInt32 ( args [ 0 ] );&lt;br&gt;
  &lt;br&gt;
&amp;nbsp; double[,,] array = new double [ N, N, N ];&lt;br&gt;
  &lt;br&gt;
&amp;nbsp; Console.WriteLine ( &quot;Array size = &quot; + ( N * N * N * 8 ) + &quot;\n&quot; +&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &quot;Allocated bytes = &quot; + GC.GetTotalMemory&amp;nbsp; ( false
) );&lt;br&gt;
&amp;nbsp; return;&lt;br&gt;
  &lt;br&gt;
&amp;nbsp;}&lt;br&gt;
  &lt;br&gt;
}&lt;/small&gt;&lt;/blockquote&gt;
Is it a bug&amp;nbsp; or&lt;br&gt;
there are some special tools to work&amp;nbsp; on&amp;nbsp; big memory&amp;nbsp; ?&lt;br&gt;
&lt;br&gt;
Thanks.&lt;br&gt;
&lt;br&gt;
Yury. &lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;

--------------000209080300000406020905--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="026305.html">[Mono-list] Color coding my ASP pages?
</A></li>
	<LI> Next message: <A HREF="026336.html">[Mono-list] OutOfMemoryException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26314">[ date ]</a>
              <a href="thread.html#26314">[ thread ]</a>
              <a href="subject.html#26314">[ subject ]</a>
              <a href="author.html#26314">[ author ]</a>
         </LI>
       </UL>
</body></html>
