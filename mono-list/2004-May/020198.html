<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] A couple of Remoting Questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Robert.Remen%40nextranet.at">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="020161.html">
   <LINK REL="Next"  HREF="020160.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] A couple of Remoting Questions
   </H1>
    <B>Robert Remen
    </B> 
    <A HREF="mailto:Robert.Remen%40nextranet.at"
       TITLE="[Mono-list] A couple of Remoting Questions">Robert.Remen@nextranet.at
       </A><BR>
    <I>Tue, 11 May 2004 12:31:17 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="020161.html">[Mono-list] Windows installer - Take 3, a.k.a. &quot;this should w
 ork for everyone&quot;
</A></li>
        <LI> Next message: <A HREF="020160.html">[Mono-list] A couple of Remoting Questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20198">[ date ]</a>
              <a href="thread.html#20198">[ thread ]</a>
              <a href="subject.html#20198">[ subject ]</a>
              <a href="author.html#20198">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

1) You do not need a configuration file, but you must somehow configure
the remoting inside your application. You have two options:
- Call RemotingConfiguration.Configure(). You can use null as the
filename parameter. Passing a null reference as the filename parameter
will cause default remoting initialization without requiring the
existence of a configuration file.
Example: &quot;RemotingConfiguration.Configure(null);&quot;
- Call at least ChannelServices.RegisterChannel() passing as a parameter
an instance of channel class (in your case HttpChannel Class). You do
not need to define the port on the client side.
Example: &quot;ChannelServices.RegisterChannel(new HttpChannel());&quot;

2) I have RH9 with mono beta 1 installed. I have run your app for about
30 times (and also my own apps many times in past), but never seen such
a strange behavior... Everything works nice and clean, no asserts, no
left behind processes. I have no idea what's wrong.

3) Here ist the soap specification <A HREF="http://www.w3.org/TR/soap/">http://www.w3.org/TR/soap/</A> and here
<A HREF="http://msdn.microsoft.com/library/en-us/dnsoap/html/understandsoap.asp">http://msdn.microsoft.com/library/en-us/dnsoap/html/understandsoap.asp</A>
an article from microsoft regarding soap (with good examples).

Robert

-----Original Message-----
From: Jonathan Stowe [mailto:<A HREF="mailto:jns@gellyfish.com">jns@gellyfish.com</A>]=20
Sent: Montag, 10. Mai 2004 14:21
To: Mono-List
Subject: [Mono-list] A couple of Remoting Questions

I have been playing around with remoting and a couple of things have
come up

I am trying a test based in the example in MS SDK:

Client:

using System;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Http;

namespace RemotingTest
{
  public class Client
  {
    public static void Main(string [] args)
    {
      RemotingConfiguration.Configure(&quot;remoting.config&quot;);
      HelloServer obj =3D
(HelloServer)Activator.GetObject(typeof(RemotingTest.HelloServer),
&quot;<A HREF="http://localhost:8085/Hello"">http://localhost:8085/Hello&quot;</A>);
      if (obj =3D=3D null)
      {
         System.Console.WriteLine(&quot;Could not locate server&quot;);
      }
      else
      {
         string name =3D &quot;blah&quot;;
         if ( args.Length &gt; 0 )
         {
            name =3D args[0];
         }
         Console.WriteLine(obj.Hello(name));
      }
    }
  }
}


Server:

using System;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Http;

namespace RemotingTest
{
  public class Server
  {

    public static void Main(string [] args) {

      HttpChannel chan =3D new HttpChannel(8085);
      ChannelServices.RegisterChannel(chan);
    =20
RemotingConfiguration.RegisterWellKnownServiceType(Type.GetType(&quot;Remotin
gTest.HelloServer,Object&quot;), &quot;Hello&quot;, WellKnownObjectMode.SingleCall);
      System.Console.WriteLine(&quot;Hit &lt;enter&gt; to exit...&quot;);
      System.Console.ReadLine();
    }
  }
}

Test Class:

using System;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Http;
using System.Reflection;

namespace RemotingTest
{
  public class HelloServer : MarshalByRefObject
  {

    public HelloServer()
    {
      Console.WriteLine(this.ToString() + &quot; activated&quot;);
    }

    public String Hello(String name)
    {
      Console.WriteLine(&quot;HelloServer.Hello : {0}&quot;, name);
      return String.Format(&quot;Hi there {0}&quot;, name);
    }
  }
}


Firstly, unlike using the MS.NET SDK it will not work unless one loads
the configuration like:

&lt;configuration&gt;
   &lt;system.runtime.remoting&gt;
      &lt;application&gt;
         &lt;client&gt;
         &lt;/client&gt;
         &lt;channels&gt;
            &lt;channel
               ref=3D&quot;http&quot;
               port=3D&quot;0&quot;
            /&gt;
         &lt;/channels&gt;
      &lt;/application&gt;
   &lt;/system.runtime.remoting&gt;
&lt;/configuration&gt;

I was wondering why the difference in behaviour - does windows have the
http channels already registered in some default configuration which
mono doesn't have or is there a difference in behaviour of
ChannelServices.RegisterChannel() in the mono library - I notice that
the registered channels are stored in a static array in the
ChannelServices class so it strikes me that another program is not going
to have access to this - or am I missing something here?  It would be
nice to have an example that worked the same with both mono and the MS
SDK.

Secondly I am getting weird intermittent behaviour from both server and
client code - every once in a while I am getting:

** (process:5787): ERROR (recursed) **: file class.c: line 1272
(mono_class_init): assertion failed: (class) aborting...

from the client code, which appears to hang afterwards - the server
however behaves as expected.  I am unable to reproduce this at will
however.

I also am occasionally getting:

=20
** (server.exe:12805): WARNING **: : unref on 38 called when ref was
already 0
=20
&gt;<i>From the server after the remote method has been called - again this is
</I>intermittent and not reproducible at will.

It also appears that neither the client or the server are cleaning up
properly as there are parentless processes left behind (which I take to
be threads - but I never found out how to distinguish processes and
threads with 'ps' on Linux).  This is with Beta 1 on Mandrake 9.2 x86.

Finally does anyone know of any documentation regarding the SOAP
messages involved in http remoting or am I going to have to use a proxy
to dump the exchanges?

Thanks.


_______________________________________________
Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="020161.html">[Mono-list] Windows installer - Take 3, a.k.a. &quot;this should w
 ork for everyone&quot;
</A></li>
	<LI> Next message: <A HREF="020160.html">[Mono-list] A couple of Remoting Questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20198">[ date ]</a>
              <a href="thread.html#20198">[ thread ]</a>
              <a href="subject.html#20198">[ subject ]</a>
              <a href="author.html#20198">[ author ]</a>
         </LI>
       </UL>
</body></html>
