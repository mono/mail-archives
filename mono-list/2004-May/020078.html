<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] threads and Async Socket methods
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:boykin%40pobox.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="020077.html">
   <LINK REL="Next"  HREF="020079.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] threads and Async Socket methods
   </H1>
    <B>P Oscar Boykin
    </B> 
    <A HREF="mailto:boykin%40pobox.com"
       TITLE="[Mono-list] threads and Async Socket methods">boykin@pobox.com
       </A><BR>
    <I>Fri, 7 May 2004 11:59:46 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="020077.html">[Mono-list] threads and Async Socket methods
</A></li>
        <LI> Next message: <A HREF="020079.html">[Mono-list] threads and Async Socket methods
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20078">[ date ]</a>
              <a href="thread.html#20078">[ thread ]</a>
              <a href="subject.html#20078">[ subject ]</a>
              <a href="author.html#20078">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--R+My9LyyhiUvIEro
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Thanks for pointing out this article.

This appears to be my problem:

When I have enough sockets waiting on a BeginReceive, I cannot do
any other Async method.  I guess the worker queue gets filled with the
BeginReceive calls, and then BeginSend calls cannot get through.

For our work, the limit of 25 ThreadPool threads waiting on tcp sockets
is just not going to work.

It seems like there are two options here:

1) Avoid Async socket operations for systems that need to scale to large
numbers.  Prefer Select I guess.

2) Reimplement the Async sockets to make sure they always use native
operating system asynchronous facilities.

I think you already said that in the 2.6 kernel, the Async Sockets use
the posix aio interface.

It seems like in linux 2.4 there is a means to get the kernel to send
signals a socket is ready for IO:

<A HREF="http://www.kegel.com/c10k.html#nb.sigio">http://www.kegel.com/c10k.html#nb.sigio</A>

What would be the issues with doing a 2.4 implementation using the
signals mechanism?

Best,
Oscar

On Fri, May 07, 2004 at 08:02:48PM +0200, Gonzalo Paniagua Javier wrote:
&gt;<i> The default socket implementation for asynchronous methods uses the
</I>&gt;<i> threadpool, which, by default, has 25 worker threads. If you use all of
</I>&gt;<i> them bad things may happen. I wrote something about that:
</I>&gt;<i> <A HREF="http://primates.ximian.com/~gonzalo/mono/blog/archives/2003_10.html">http://primates.ximian.com/~gonzalo/mono/blog/archives/2003_10.html</A>
</I>&gt;<i>=20
</I>&gt;<i> -Gonzalo
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
--=20
<A HREF="mailto:boykin@pobox.com">boykin@pobox.com</A>    <A HREF="http://pobox.com/~boykin">http://pobox.com/~boykin</A>    jabber: <A HREF="mailto:johnynek@jabber.org">johnynek@jabber.org</A>
fingerprint=3DD250 4AD9 4544 B7D2 A17C  911D D608 D387 6718 D75F
Understand Free Software: <A HREF="http://www.gnu.org/philosophy/philosophy.html">http://www.gnu.org/philosophy/philosophy.html</A>

--R+My9LyyhiUvIEro
Content-Type: application/pgp-signature; name=&quot;signature.asc&quot;
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAm9yi1gjTh2cY118RAn+mAJ0eTmNJdnSFQ9UAeSqJ439FjOi9RwCfVtxi
EXoES1ZdptZJZpmJv0dY22Y=
=jDqX
-----END PGP SIGNATURE-----

--R+My9LyyhiUvIEro--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="020077.html">[Mono-list] threads and Async Socket methods
</A></li>
	<LI> Next message: <A HREF="020079.html">[Mono-list] threads and Async Socket methods
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20078">[ date ]</a>
              <a href="thread.html#20078">[ thread ]</a>
              <a href="subject.html#20078">[ subject ]</a>
              <a href="author.html#20078">[ author ]</a>
         </LI>
       </UL>
</body></html>
