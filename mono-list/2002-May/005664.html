<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Microsoft.VisualBasic.Collection Exception problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cjbreisch%40altavista.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="005663.html">
   <LINK REL="Next"  HREF="005665.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Microsoft.VisualBasic.Collection Exception problems
   </H1>
    <B>Chris J. Breisch
    </B> 
    <A HREF="mailto:cjbreisch%40altavista.net"
       TITLE="[Mono-list] Microsoft.VisualBasic.Collection Exception problems">cjbreisch@altavista.net
       </A><BR>
    <I>Sat, 11 May 2002 11:04:10 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="005663.html">[Mono-list] Microsoft.VisualBasic.Collection Exception problems
</A></li>
        <LI> Next message: <A HREF="005665.html">[Mono-list] When MS Implementation differs from spec/help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5664">[ date ]</a>
              <a href="thread.html#5664">[ thread ]</a>
              <a href="subject.html#5664">[ subject ]</a>
              <a href="author.html#5664">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0008_01C1F8DB.948699E0
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: quoted-printable

Would help if I attached the &quot;attached file&quot;, wouldn't it?


Chris J. Breisch, MCSD, MCDBA



-----Original Message-----
From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>] On
Behalf Of Chris J. Breisch
Sent: Saturday, May 11, 2002 10:55 AM
To: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
Subject: [Mono-list] Microsoft.VisualBasic.Collection Exception problems

FYI,

Visual Basic Language reference states that for class
Microsoft.VisualBasic.Collection:

	ReadOnly Public Default Overloads Property Item( _
	   ByVal Index As {=A0Integer=A0| Object=A0} _
	)=A0As Object


should throw an IndexOutOfRangeException when &quot;Index doesn't match an
existing member of the collection.&quot;

It properly does so, if Index is an invalid Integer, but throws
ArgumentException if Index is an invalid Object.

Further, the Collection class implements IENumerable (by way of IList),
and the on-line documentation for the IENumerable interface states:

	object Current {get;}

should throw an InvalidOperationException when &quot;The enumerator is
positioned before the first element of the collection or after the last
element.&quot;

Instead, the Collection class throws an IndexOutOfRangeException.

Further, the on-line documentation for IENumerable also states:

	bool MoveNext();

and

	void Reset();

should throw an InvalidOperationException when &quot;The collection was
modified after the enumerator was created.&quot;

Instead, no exception is thrown at all.

These are amply demonstrated by the attached file (ripped from my
TestCollection.cs Nunit Test)


Will be adding these to mcs/class/doc/API-notes when I can.

			-chris



Chris J. Breisch, MCSD, MCDBA





_______________________________________________
Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>

------=_NextPart_000_0008_01C1F8DB.948699E0
Content-Type: text/plain;
	name=&quot;CollectionTesterrs.cs&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;CollectionTesterrs.cs&quot;

// Collection.cs - NUnit Test Cases for Microsoft.VisualBasic.Collection
//
// Author:
//   Chris J. Breisch (<A HREF="mailto:cjbreisch@altavista.net">cjbreisch@altavista.net</A>)
//
// (C) Chris J. Breisch
//=20

using NUnit.Framework;
using System;
using Microsoft.VisualBasic;
using System.Collections;

namespace MonoTests.Microsoft.VisualBasic
{

	public class CollectionTest : TestCase=20
	{
=09
		public CollectionTest() : base (&quot;Microsoft.VisualBasic.Collection&quot;) {}
		public CollectionTest(string name) : base(name) {}

		protected override void SetUp() {}
		protected override void TearDown() {}

		public static ITest Suite=20
		{
			get=20
			{=20
				return new TestSuite(typeof(CollectionTest));=20
			}
		}

		// Test all the Exceptions we're supposed to throw
		public void TestException ()
		{
			Collection c;
			bool CaughtException;

			c =3D new Collection();

			c.Add(&quot;Baseball&quot;, &quot;Base&quot;, null, null);
			c.Add(&quot;Football&quot;, &quot;Foot&quot;, null, null);
			c.Add(&quot;Basketball&quot;, &quot;Basket&quot;, null, null);
			c.Add(&quot;Volleyball&quot;, &quot;Volley&quot;, null, null);

			CaughtException =3D false;
		=09
			try=20
			{
				// no member with Key =3D=3D &quot;Kick&quot;
				object o =3D c[&quot;Kick&quot;];
			}
			catch (Exception e)
			{
				// VB Language Reference says IndexOutOfRangeException here, but MS =
throws ArgumentException
				// AssertEquals(&quot;#E07&quot;, typeof(IndexOutOfRangeException), =
e.GetType());
				AssertEquals(&quot;#E07&quot;, typeof(ArgumentException), e.GetType());
				CaughtException =3D true;
			}

			AssertEquals(&quot;#E08&quot;, true, CaughtException);
        =20
			CaughtException =3D false;
		=09
			try=20
			{
				IEnumerator e =3D c.GetEnumerator();
			=09
				// Must MoveNext before Current
				object item =3D e.Current;
			}
			catch (Exception e)
			{
				// On-line help says InvalidOperationException here, but MS throws =
IndexOutOfRangeException
				// AssertEquals(&quot;#E25&quot;, typeof(InvalidOperationException), =
e.GetType());
				AssertEquals(&quot;#E25&quot;, typeof(IndexOutOfRangeException), e.GetType());
				CaughtException =3D true;
			}

			AssertEquals(&quot;#E26&quot;, true, CaughtException);
       =20
			CaughtException =3D false;
		=09
			try=20
			{
				IEnumerator e =3D c.GetEnumerator();
				e.MoveNext();

				c.Add(&quot;Paintball&quot;, &quot;Paint&quot;, null, null);

				// Can't MoveNext if Collection has been modified
				e.MoveNext();
			}
			catch (Exception e)
			{
				// On-line help says this should throw an error. MS doesn't.
				AssertEquals(&quot;#E27&quot;, typeof(InvalidOperationException), =
e.GetType());
				CaughtException =3D true;
			}


			// What to do about this?  MS doesn't throw an error
			// AssertEquals(&quot;#E28&quot;, true, CaughtException);
			AssertEquals(&quot;#E28&quot;, false, CaughtException);
       =20
			CaughtException =3D false;
		=09
			try=20
			{
				IEnumerator e =3D c.GetEnumerator();
				e.MoveNext();

				c.Add(&quot;Racketball&quot;, &quot;Racket&quot;, null, null);

				// Can't Reset if Collection has been modified
				e.Reset();
			}
			catch (Exception e)
			{
				// On-line help says this should throw an error.  MS doesn't.
				AssertEquals(&quot;#E29&quot;, typeof(InvalidOperationException), =
e.GetType());
				CaughtException =3D true;
			}

			// What to do about this?  MS doesn't throw an error
			// AssertEquals(&quot;#E30&quot;, true, CaughtException);
			AssertEquals(&quot;#E30&quot;, false, CaughtException);

			CaughtException =3D false;
		}
	}
}
------=_NextPart_000_0008_01C1F8DB.948699E0--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="005663.html">[Mono-list] Microsoft.VisualBasic.Collection Exception problems
</A></li>
	<LI> Next message: <A HREF="005665.html">[Mono-list] When MS Implementation differs from spec/help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5664">[ date ]</a>
              <a href="thread.html#5664">[ thread ]</a>
              <a href="subject.html#5664">[ subject ]</a>
              <a href="author.html#5664">[ author ]</a>
         </LI>
       </UL>
</body></html>
