<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] &quot;finally&quot; problem in mcs.exe
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jarek%40atm.com.pl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="005849.html">
   <LINK REL="Next"  HREF="005856.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] &quot;finally&quot; problem in mcs.exe
   </H1>
    <B>Jaroslaw Kowalski
    </B> 
    <A HREF="mailto:jarek%40atm.com.pl"
       TITLE="[Mono-list] &quot;finally&quot; problem in mcs.exe">jarek@atm.com.pl
       </A><BR>
    <I>Wed, 22 May 2002 08:25:32 +0200 (CEST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="005849.html">[Mono-list] mono_runtime_invoke_array - bug and patch
</A></li>
        <LI> Next message: <A HREF="005856.html">[Mono-list] &quot;finally&quot; problem in mcs.exe
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5853">[ date ]</a>
              <a href="thread.html#5853">[ thread ]</a>
              <a href="subject.html#5853">[ subject ]</a>
              <a href="author.html#5853">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In a bug 24699/&quot;finally being called twice&quot; i described a problem where
&quot;finally&quot; handler is being called twice when an exception occurs.

It's not mentioned in the bug description, but the sample file was
compiled on Windows using csc.exe.

Today I've noticed that when I compile the program with mcs.exe on linux,
it behaves correctly under &quot;mint&quot; and &quot;mono&quot; but when compiled with
csc.exe there is still a problem with &quot;mint&quot; (mono was fixed and works
ok).

So: mcs + mono = OK, mcs + mint = OK, csc + mono = OK, csc + mint =
FAILURE

This suggests there's a bug in mcs compiler in the way finally handlers
are compiled. Also there's a problem with mint/mono that allows such
incorrectly-compiled program to run properly. Strange.

Are you aware of such a problem? If not, cosider this to be a new bug
report.

Jarek

---
Bug report from bugzilla:

Looks like the finally block is being called twice as in the example:
Seems to be critical.

==========
   int c = 0;
   try
   {
    throw new Exception(&quot;Test exception&quot;);
   }
   catch (Exception e)
   {
    Console.WriteLine(&quot;Exception: {0}&quot;, e.Message);
   }
   finally
   { 
    Console.WriteLine(&quot;Finally... {0}&quot;, c++);
   }
==============

Actual Results:
===============
Exception: Test exception
Finally... 0
Finally... 1

Expected Results:
=================
Exception: Test exception
Finally... 0
------- Additional Comments From Dietmar Maurer 2002-05-16 06:44 -------
fixed in mono, mint still have problems.







</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="005849.html">[Mono-list] mono_runtime_invoke_array - bug and patch
</A></li>
	<LI> Next message: <A HREF="005856.html">[Mono-list] &quot;finally&quot; problem in mcs.exe
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5853">[ date ]</a>
              <a href="thread.html#5853">[ thread ]</a>
              <a href="subject.html#5853">[ subject ]</a>
              <a href="author.html#5853">[ author ]</a>
         </LI>
       </UL>
</body></html>
