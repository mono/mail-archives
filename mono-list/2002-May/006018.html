<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Diagnostic Messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:AjayKumar.Dwivedi%40dresdner-bank.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="006031.html">
   <LINK REL="Next"  HREF="006024.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Diagnostic Messages
   </H1>
    <B>Dwivedi , Ajay Kumar
    </B> 
    <A HREF="mailto:AjayKumar.Dwivedi%40dresdner-bank.com"
       TITLE="[Mono-list] Diagnostic Messages">AjayKumar.Dwivedi@dresdner-bank.com
       </A><BR>
    <I>Mon, 27 May 2002 08:24:41 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="006031.html">[Mono-list] Testing rss feed.
</A></li>
        <LI> Next message: <A HREF="006024.html">[Mono-list] Diagnostic Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6018">[ date ]</a>
              <a href="thread.html#6018">[ thread ]</a>
              <a href="subject.html#6018">[ subject ]</a>
              <a href="author.html#6018">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,
	Great discussion going on. I couln't resist jumping in ;)
I like the trace functionality but don't like the way they are used. I mean
writing my own tracelistener etc..Here's my suggestion for the trace classes
based on the discussion.

We should Use the config file as in the .NET , our aim is to make mono run
exactly similiar or better than .NET :) For each key defined in the
settings,
we add a class to the Trace.Listeners by reflection. And every call to
Trace.Write() calls the Write() methods on eash of the objects in Listener.

The default should be not to do anything. The DefaultTraceListener can send
the output to /dev/null but that would be an added overhead.

As lupus suggested, we should allow Environment Variable based
configurations too. This is especially needed when the application and its
configuration settings are readonly for a user. (There doesn't seem to be
any security risks involved)

Further, mono should have some built-in TraceListeners. These should include
syslog, file and console listener. Lazy developers like me might not like to
write their own listeners ;) We can use the syslog library call for
implementing syslog.
	   
Happy Hacking,
Ajay

PS: While going through the Mono source for Trace class, I see all the
methods delegated to an internal class. Trace is not an abstract class, so
is there any particular reason for doing so?

         

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Jonathan Pryor [mailto:<A HREF="mailto:jonpryor@vt.edu">jonpryor@vt.edu</A>]
</I>&gt;<i> Sent: Monday, May 27, 2002 8:50 AM
</I>&gt;<i> To: Mono List
</I>&gt;<i> Subject: Re: [Mono-list] Diagnostic Messages
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Reply inline.
</I>&gt;<i> 
</I>&gt;<i> On Sun, 2002-05-26 at 14:03, Lawrence Pit wrote:
</I>&gt;<i>     Hi Jonathan,
</I>&gt;<i>     
</I>&gt;<i>     &gt; Linux/Unix, as far as I can tell, has no equivalent to
</I>&gt;<i>     &gt; `OutputDebugString'.  The console must be used instead 
</I>&gt;<i> (until someone
</I>&gt;<i>     &gt; tells me a better way to do it).
</I>&gt;<i>     
</I>&gt;<i>     I'm not really familiar with Linux, but google tells me 
</I>&gt;<i> it has a syslog
</I>&gt;<i>     (which they got from BSD). Regardless, if a system 
</I>&gt;<i> doesn't have something
</I>&gt;<i>     similar to OutputDebugString I see no problem in simply 
</I>&gt;<i> sending the output
</I>&gt;<i>     to /dev/null by default.
</I>&gt;<i> 
</I>&gt;<i> Yes, by default.  Notice that this was the behavior of my proposal: by
</I>&gt;<i> default the calls to {Trace|Debug}.WriteLine is ignored.  
</I>&gt;<i> Output is only
</I>&gt;<i> present if mono/mint is started with a ``--diagnostic'' parameter.
</I>&gt;<i>     
</I>&gt;<i>     &gt; So I have a problem: I want to leave trace code in the 
</I>&gt;<i> program, but I
</I>&gt;<i>     &gt; don't want the user to see it by default.
</I>&gt;<i>     [...]
</I>&gt;<i>     &gt; If I want to see debug messages:
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; $ mono --diagnostics=debug
</I>&gt;<i>     &gt; ** Mono-Debug: Debug Message
</I>&gt;<i>     &gt; Console Message
</I>&gt;<i>     [...]
</I>&gt;<i>     &gt; The point I'm attempting to demonstrate is that this 
</I>&gt;<i> isn't a compiler
</I>&gt;<i>     &gt; issue, this is a runtime issue.  Trace and debug 
</I>&gt;<i> messages need to be
</I>&gt;<i>     &gt; sent somewhere in order to be seen (and thus useful), 
</I>&gt;<i> but we don't want
</I>&gt;<i>     &gt; them to be seen all the time, as it isn't appropriate.
</I>&gt;<i>     
</I>&gt;<i>     The point I was trying to make is that it should not be a 
</I>&gt;<i> runtime issue, but
</I>&gt;<i>     a compile time issue. Read the remarks in the documentation for
</I>&gt;<i>     ConditionalAttribute, the compiler should ignore calls to 
</I>&gt;<i> Debug and Trace
</I>&gt;<i>     methods unless a compilation variable is defined.
</I>&gt;<i> 
</I>&gt;<i> Yes, I'm well aware of this.  Again, the behavior I'm 
</I>&gt;<i> concerned about is
</I>&gt;<i> when the call to {Debug|Trace}.WriteLine is within the IL code --
</I>&gt;<i> meaning that TRACE or DEBUG was defined when the program was 
</I>&gt;<i> compiled. 
</I>&gt;<i> So I'm concerned with post-compiler behavior, hence runtime behavior.
</I>&gt;<i>     
</I>&gt;<i>     Certainly for debugging no switch should exist for mono. 
</I>&gt;<i> That would be a bit
</I>&gt;<i>     of a shame, as the consequence would be that all 
</I>&gt;<i> debugging statements are in
</I>&gt;<i>     the compiled code regardless of how it's compiled, 
</I>&gt;<i> therefor impacting
</I>&gt;<i>     performance and code size of production software.
</I>&gt;<i>     
</I>&gt;<i> I'm not sure that I follow you here.  Debugging statements 
</I>&gt;<i> would only be
</I>&gt;<i> present in the compiled code if the appropriate macro (TRACE, 
</I>&gt;<i> DEBUG) was
</I>&gt;<i> defined during compilation, in which case it should be a reasonable
</I>&gt;<i> assumption that run-time diagnostic behavior may be desired.
</I>&gt;<i> 
</I>&gt;<i>     Tracing is somewhat different as you MIGHT want to enable 
</I>&gt;<i> that (temporarily)
</I>&gt;<i>     in a production environment. Tracing is however usually 
</I>&gt;<i> controlled through
</I>&gt;<i>     the application configuration file as it's not simply a 
</I>&gt;<i> matter of switching
</I>&gt;<i>     tracing on or off when you startup a program, instead you 
</I>&gt;<i> can switch tracing
</I>&gt;<i>     on for an ASP.NET application and off for another while 
</I>&gt;<i> both are running in
</I>&gt;<i>     the same mono runtime instance. Also, via the app 
</I>&gt;<i> configuration file you can
</I>&gt;<i>     configure more than just the property values on/off, but 
</I>&gt;<i> also things like
</I>&gt;<i>     indent level, the trace switches that should be used, etc.
</I>&gt;<i>     
</I>&gt;<i> I will have to read more about the configuration files, but I believe
</I>&gt;<i> that I have a general idea of how they work.
</I>&gt;<i> 
</I>&gt;<i> Thus, I'll pose a question to you: what should happen at 
</I>&gt;<i> runtime if the
</I>&gt;<i> application configuration file specifies that diagnostic 
</I>&gt;<i> messages should
</I>&gt;<i> be displayed, and it leaves the `DefaultTraceListener' intact?  (For
</I>&gt;<i> example, it only adds additional listeners, or otherwise 
</I>&gt;<i> doesn't remove
</I>&gt;<i> the &quot;Default&quot; trace listener.)
</I>&gt;<i> 
</I>&gt;<i> Should the `DefaultTraceListener' do nothing, even though diagnostic
</I>&gt;<i> messages have been requested?  I should think not; it should do
</I>&gt;<i> something, otherwise it will look like it isn't working, leading to
</I>&gt;<i> annoyed developers.
</I>&gt;<i> 
</I>&gt;<i> If it should do something, then what should it do?  This is 
</I>&gt;<i> the crux of
</I>&gt;<i> all my questioning: when we *know* that the `DefaultTraceListener'
</I>&gt;<i> should do something, what should it do?  Send output to `syslog'?  A
</I>&gt;<i> plausible idea, but I'm not too keen on it until someone 
</I>&gt;<i> demonstrates a
</I>&gt;<i> way to view `syslog' messages without needing to directly view
</I>&gt;<i> `/var/log/messages,' which is readable only by the root user 
</I>&gt;<i> (on Red Hat
</I>&gt;<i> 7.3, anyway).
</I>&gt;<i> 
</I>&gt;<i> Should it send output to the console?  This is my current thinking,
</I>&gt;<i> lacking any other idea of where to send it.
</I>&gt;<i> 
</I>&gt;<i> However...what if the program has no application configuration file? 
</I>&gt;<i> What is a reasonable default?  Not everyone will know about 
</I>&gt;<i> application
</I>&gt;<i> configuration files, though perhaps they should.  This is where I
</I>&gt;<i> believe a ``--diagnostics'' parameter to mono/mint would be 
</I>&gt;<i> useful: you
</I>&gt;<i> could enable/disable the output of diagnostic messages without needing
</I>&gt;<i> to create a configuration file.
</I>&gt;<i> 
</I>&gt;<i> I would find this tremendously useful, as I tend to write 
</I>&gt;<i> lots of small
</I>&gt;<i> test programs to gain greater understanding about how something works,
</I>&gt;<i> and needing to create configuration files for such programs could be a
</I>&gt;<i> nuisance.  (Of course we can also argue about the usefulness of Trace
</I>&gt;<i> messages within such small applications, but I'll skip that discussion
</I>&gt;<i> for now.)
</I>&gt;<i>     
</I>&gt;<i>     Greets,
</I>&gt;<i>     Lawrence
</I>&gt;<i> 
</I>&gt;<i> Thank you for contributing to the discussion.  This is raising several
</I>&gt;<i> issues I hadn't considered before.
</I>&gt;<i> 
</I>&gt;<i>  - Jon
</I>&gt;<i>     
</I>&gt;<i>     
</I>&gt;<i>     
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> 
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="006031.html">[Mono-list] Testing rss feed.
</A></li>
	<LI> Next message: <A HREF="006024.html">[Mono-list] Diagnostic Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6018">[ date ]</a>
              <a href="thread.html#6018">[ thread ]</a>
              <a href="subject.html#6018">[ subject ]</a>
              <a href="author.html#6018">[ author ]</a>
         </LI>
       </UL>
</body></html>
