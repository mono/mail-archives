<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] SQL Parser for System.Data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:piersh%40friskit.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="005673.html">
   <LINK REL="Next"  HREF="005675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] SQL Parser for System.Data
   </H1>
    <B>Piers Haken
    </B> 
    <A HREF="mailto:piersh%40friskit.com"
       TITLE="[Mono-list] SQL Parser for System.Data">piersh@friskit.com
       </A><BR>
    <I>Sat, 11 May 2002 13:26:41 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="005673.html">[Mono-list] Retrive MS-fw without MS Windows
</A></li>
        <LI> Next message: <A HREF="005675.html">[Mono-list] SQL Parser for System.Data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5674">[ date ]</a>
              <a href="thread.html#5674">[ thread ]</a>
              <a href="subject.html#5674">[ subject ]</a>
              <a href="author.html#5674">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sure, you'll need to support providers that don't natively support
prepared statements in the backend.

PostgreSQL's JDBC driver does exactly this.

Here's the code:

#line 58 &quot;org/postgresql/jdbc2/PreparedStatement.java&quot;
        for (i = 0; i &lt; sql.length(); ++i)
        {
            int c = sql.charAt(i);

            if (c == '\'')
                inQuotes = !inQuotes;
            if (c == '?' &amp;&amp; !inQuotes)
            {
                v.addElement(sql.substring (lastParmEnd, i));
                lastParmEnd = i + 1;
            }
        }
        v.addElement(sql.substring (lastParmEnd, sql.length()));


I'm not saying you guys shouldn't embark on writing a SQL parser, I'm
just saying that there isn't really a need for it in System.Data.

Piers.

-----Original Message-----
From: Rodrigo Moya [mailto:<A HREF="mailto:rodrigo@ximian.com">rodrigo@ximian.com</A>] 
Sent: Saturday, May 11, 2002 7:47 AM
To: Piers Haken
Cc: Daniel Morgan; Mono List
Subject: RE: [Mono-list] SQL Parser for System.Data


On Sat, 2002-05-11 at 15:31, Piers Haken wrote:
&gt;<i> But this breaks the whole idea of prepared statements: where you
</I>&gt;<i> prepare a statement in the database and then bind the parameters to it
</I>
&gt;<i> on each call.
</I>&gt;<i> 
</I>&gt;<i> I don't know about other databases but I know that for MS SQL, there's
</I>&gt;<i> a significant performance gain in preparing a statement and then 
</I>&gt;<i> calling it multiple times, as opposed to just calling an ad-hoc 
</I>&gt;<i> statement multiple times. As far as I know it's essentially creating a
</I>
&gt;<i> stored procedure out of the statement.
</I>&gt;<i> 
</I>yes, MS SQL does it, and thus System.Data has a lot of MSSQLisms. But
not all managed providers will support the same. That's why we'd need a
SQL parser.

&gt;<i> If you do the parameter replacement on the client side then you lose
</I>&gt;<i> all this benefit. The whole idea of SqlParameter is that the parameter
</I>
&gt;<i> replacement is done by the DBMS.
</I>&gt;<i> 
</I>we are not talking about doing the parsing on the clients, but on the
managed providers, as an internal implementation detail. That is, the
whateverSQL provider can't send SQL commands with parameter placeholders
because the DB server does not support it. So, internally, the
whateverSQL provider parses the SQL command, finds placeholders,
replaces them with values, and send the clean SQL to the DB server.

In fact, that SQL parser could even be an internal class to be used only
in System.Data managed providers.

cheers



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="005673.html">[Mono-list] Retrive MS-fw without MS Windows
</A></li>
	<LI> Next message: <A HREF="005675.html">[Mono-list] SQL Parser for System.Data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5674">[ date ]</a>
              <a href="thread.html#5674">[ thread ]</a>
              <a href="subject.html#5674">[ subject ]</a>
              <a href="author.html#5674">[ author ]</a>
         </LI>
       </UL>
</body></html>
