<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Microsoft.VisualBasic.Collection Exception problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cjbreisch%40altavista.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="005661.html">
   <LINK REL="Next"  HREF="005664.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Microsoft.VisualBasic.Collection Exception problems
   </H1>
    <B>Chris J. Breisch
    </B> 
    <A HREF="mailto:cjbreisch%40altavista.net"
       TITLE="[Mono-list] Microsoft.VisualBasic.Collection Exception problems">cjbreisch@altavista.net
       </A><BR>
    <I>Sat, 11 May 2002 10:55:13 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="005661.html">[Mono-list] SQL Parser for System.Data
</A></li>
        <LI> Next message: <A HREF="005664.html">[Mono-list] Microsoft.VisualBasic.Collection Exception problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5663">[ date ]</a>
              <a href="thread.html#5663">[ thread ]</a>
              <a href="subject.html#5663">[ subject ]</a>
              <a href="author.html#5663">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>FYI,

Visual Basic Language reference states that for class
Microsoft.VisualBasic.Collection:

	ReadOnly Public Default Overloads Property Item( _
	   ByVal Index As { Integer | Object } _
	) As Object


should throw an IndexOutOfRangeException when &quot;Index doesn't match an
existing member of the collection.&quot;

It properly does so, if Index is an invalid Integer, but throws
ArgumentException if Index is an invalid Object.

Further, the Collection class implements IENumerable (by way of IList),
and the on-line documentation for the IENumerable interface states:

	object Current {get;}

should throw an InvalidOperationException when &quot;The enumerator is
positioned before the first element of the collection or after the last
element.&quot;

Instead, the Collection class throws an IndexOutOfRangeException.

Further, the on-line documentation for IENumerable also states:

	bool MoveNext();

and

	void Reset();

should throw an InvalidOperationException when &quot;The collection was
modified after the enumerator was created.&quot;

Instead, no exception is thrown at all.

These are amply demonstrated by the attached file (ripped from my
TestCollection.cs Nunit Test)


Will be adding these to mcs/class/doc/API-notes when I can.

			-chris



Chris J. Breisch, MCSD, MCDBA






</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="005661.html">[Mono-list] SQL Parser for System.Data
</A></li>
	<LI> Next message: <A HREF="005664.html">[Mono-list] Microsoft.VisualBasic.Collection Exception problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5663">[ date ]</a>
              <a href="thread.html#5663">[ thread ]</a>
              <a href="subject.html#5663">[ subject ]</a>
              <a href="author.html#5663">[ author ]</a>
         </LI>
       </UL>
</body></html>
