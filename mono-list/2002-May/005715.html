<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] silly samba/nt4/cygwin problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cwitty%40newtonlabs.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="005612.html">
   <LINK REL="Next"  HREF="005803.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] silly samba/nt4/cygwin problem
   </H1>
    <B>Carl R. Witty
    </B> 
    <A HREF="mailto:cwitty%40newtonlabs.com"
       TITLE="[Mono-list] silly samba/nt4/cygwin problem">cwitty@newtonlabs.com
       </A><BR>
    <I>13 May 2002 11:37:22 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="005612.html">[Mono-list] silly samba/nt4/cygwin problem
</A></li>
        <LI> Next message: <A HREF="005803.html">[Mono-list] silly samba/nt4/cygwin problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5715">[ date ]</a>
              <a href="thread.html#5715">[ thread ]</a>
              <a href="subject.html#5715">[ subject ]</a>
              <a href="author.html#5715">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Martin Baulig &lt;<A HREF="mailto:martin@gnome.org">martin@gnome.org</A>&gt; writes:

&gt;<i> Daniel Stodden &lt;<A HREF="mailto:stodden@in.tum.de">stodden@in.tum.de</A>&gt; writes:
</I>&gt;<i> 
</I>&gt;<i> &gt; this might be somewhat offtopic for mono-list, but since the nt4 box
</I>&gt;<i> &gt; under my desk is mostly there for running csc -- maybe someone around
</I>&gt;<i> &gt; here can help me out.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; bitch is running samba-2.2.3a on linux 2.4.18.
</I>&gt;<i> &gt; ballmer NT4sp6a with cygwin.
</I>&gt;<i> &gt; xemacs on X for coding, secure shell into bash on ballmer for builds.
</I>&gt;<i> &gt; $HOME shared to ballmer via smb.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; the strange behavior is this: 
</I>&gt;<i> &gt; 1. save a .cs file on the linux box
</I>&gt;<i> &gt; 2. switch to the NT terminal
</I>&gt;<i> &gt; 3. run csc
</I>&gt;<i> &gt; 4. parse error: ';' missing in line y (or similar).
</I>&gt;<i> &gt; 5. investigate. but no typos at all..
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; i've originally thought csc has troubles with unix line endings. it has
</I>&gt;<i> &gt; not:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 6. ballmer: &quot;csc x.cs&quot;
</I>&gt;<i> &gt; 7. parser error again.
</I>&gt;<i> &gt; 8. cat x.cs
</I>&gt;<i> &gt; 9. csc x.cs
</I>&gt;<i> &gt; 10. compilation successful. wow.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; the share does _never_ really mess up the contents. what it does is
</I>&gt;<i> &gt; producing very small typos like repeating just one or two ascii
</I>&gt;<i> &gt; characters, e.g. a comma or so, leading to small syntax errors.
</I>&gt;<i> &gt; doing a simple 'cat' on that file always seems to fix the problem.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; anyone with similar phenomenons or a tip which screw to turn?
</I>&gt;<i> 
</I>&gt;<i> I get the same behavior, but I have no idea what it is.
</I>&gt;<i> 
</I>&gt;<i> Doing a `cat *.cs &gt; /dev/null ; &lt;some command&gt;' helps.
</I>
I've seen behavior like this using Samba with &quot;oplocks = True&quot; (which
is the default, I believe).  Basically, Samba serves files in a way
that tells the Windows box that it is allowed to cache pieces; this
works if all modifications are made through Samba, but fails if some
modifications are made directly on the Linux box.  It can happen that
the Windows box will see one sector from an old version of the file
and another sector from a new version; if you changed the file size,
this can manifest as what looks like a few characters added or deleted
at the sector boundary, which will often cause syntax errors.

To disable this Samba behavior (which will reduce performance, but
restore correctness for modifications made from the Linux side), add a
line:

   oplocks = False

to an appropriate place in your smb.conf.  (Either in the [global]
section or in the section for your share.)

Carl Witty


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="005612.html">[Mono-list] silly samba/nt4/cygwin problem
</A></li>
	<LI> Next message: <A HREF="005803.html">[Mono-list] silly samba/nt4/cygwin problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5715">[ date ]</a>
              <a href="thread.html#5715">[ thread ]</a>
              <a href="subject.html#5715">[ subject ]</a>
              <a href="author.html#5715">[ author ]</a>
         </LI>
       </UL>
</body></html>
