<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Design by Contract
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:nazgul%40nemerle.org">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025060.html">
   <LINK REL="Next"  HREF="025070.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Design by Contract
   </H1>
    <B>Kamil Skalski
    </B> 
    <A HREF="mailto:nazgul%40nemerle.org"
       TITLE="[Mono-list] Design by Contract">nazgul@nemerle.org
       </A><BR>
    <I>Mon, 27 Dec 2004 18:09:39 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="025060.html">[Mono-list] Design by Contract
</A></li>
        <LI> Next message: <A HREF="025070.html">[Mono-list] Design by Contract
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25061">[ date ]</a>
              <a href="thread.html#25061">[ thread ]</a>
              <a href="subject.html#25061">[ subject ]</a>
              <a href="author.html#25061">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Monday 27 of December 2004 17:46, Stephen Touset wrote:

You can take a look at:
<A HREF="http://nemerle.org/macrouse.html#designbycontract">http://nemerle.org/macrouse.html#designbycontract</A>

With compiler designed to be extensible you can treat attributes more like 
commands for the compiler than purely runtime metadata.

We don't have attributes inheritance implemented yet, but general DBC 
framework works fine. 
You would have to switch to Nemerle, but maybe in future we will have C# 
frontend for our compiler. Currently to compile subset (no gotos and unsafe 
code) of C#, it would requre only plugging another parser to our compiler 
pipeline.

&gt;<i> I've been using C# for quite awhile now, but one feature that I wish was
</I>&gt;<i> available in the language is support for Design by Contract:
</I>&gt;<i> automatically-enforced preconditions and postconditions on functions, and
</I>&gt;<i> invariants on classes.
</I>&gt;<i>
</I>&gt;<i> Having done some research into the problem, the best approach seems to be
</I>&gt;<i> using attributes. Using statements inside functions works, but induces a
</I>&gt;<i> lot of programmatic overhead; specifically, inheritance rules for DBC
</I>&gt;<i> would need to be implemented manually. Invariants, also, would be tedious:
</I>&gt;<i> code to check against the invariant would need to be added before the
</I>&gt;<i> preconditions and after the postconditions of every function in the class.
</I>&gt;<i> Worse still is that postconditions must be inserted above every return
</I>&gt;<i> statement. This isn't too bad if you insist upon only one return statement
</I>&gt;<i> per function, but for anyone with multiple returns, this becomes tedious
</I>&gt;<i> quickly. And of course, all of these are clear violations of the Don't
</I>&gt;<i> Repeat Yourself rule.
</I>&gt;<i>
</I>&gt;<i> Attributes seem to be the way to go. The pre/postconditions and invariants
</I>&gt;<i> are, at the core, metadata about the functions and class. The attributes
</I>&gt;<i> themselves would be able to understand their own inheritance criteria, and
</I>&gt;<i> code can automatically be generated to verify the terms of the contract
</I>&gt;<i> wherever needed. Unfortunately, the way attributes in C# are implemented,
</I>&gt;<i> there seems to be no way to practically use them. Reflection may be
</I>&gt;<i> powerful, but there doesn't appear to be a way that an attribute can
</I>&gt;<i> access (or even determine) the function or class that it applies to.
</I>&gt;<i>
</I>&gt;<i> My initial approach was to use the CodeDom libraries to insert code into
</I>&gt;<i> functions that would be dynamically based upon the applicable attributes,
</I>&gt;<i> and enforce the conditions correctly. However, the inability for
</I>&gt;<i> attributes to access the &quot;calling&quot; class all but cripples this attempt. My
</I>&gt;<i> next thought was to simply have a script which would understand the
</I>&gt;<i> attributes and insert the applicable statements at compile-time. However,
</I>&gt;<i> the need for attribute inheritance quickly caused this approach to become
</I>&gt;<i> unwieldy.
</I>&gt;<i>
</I>&gt;<i> Does anyone have an idea about how this could be done in a reasonable
</I>&gt;<i> fashion? If so, would anyone be willing to help on the project?
</I>
-- 
Kamil Skalski

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025060.html">[Mono-list] Design by Contract
</A></li>
	<LI> Next message: <A HREF="025070.html">[Mono-list] Design by Contract
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25061">[ date ]</a>
              <a href="thread.html#25061">[ thread ]</a>
              <a href="subject.html#25061">[ subject ]</a>
              <a href="author.html#25061">[ author ]</a>
         </LI>
       </UL>
</body></html>
