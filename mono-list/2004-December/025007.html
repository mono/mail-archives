<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Patch for jsDriver.pl (in order to use mjs with the automated
 rhino's testsuite)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mauro%40novell.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025044.html">
   <LINK REL="Next"  HREF="025015.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Patch for jsDriver.pl (in order to use mjs with the automated
 rhino's testsuite)
   </H1>
    <B>Mauro Parra Miranda
    </B> 
    <A HREF="mailto:mauro%40novell.com"
       TITLE="[Mono-list] Patch for jsDriver.pl (in order to use mjs with the automated
 rhino's testsuite)">mauro@novell.com
       </A><BR>
    <I>Mon, 20 Dec 2004 12:14:32 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="025044.html">[Mono-list] Re: Seeing Values of Unwound Stack variables
 atException Handler
</A></li>
        <LI> Next message: <A HREF="025015.html">[Mono-list] Re: Installing Mono on Fedora Core 3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25007">[ date ]</a>
              <a href="thread.html#25007">[ thread ]</a>
              <a href="subject.html#25007">[ subject ]</a>
              <a href="author.html#25007">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-lUTJgE4H7Xhrs6oY82YE
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hello, 
I just made simple modification in jsDriver.pl to support the mjs
engine. 

Cheers,
Mauro

--=-lUTJgE4H7Xhrs6oY82YE
Content-Disposition: attachment; filename=mjsdriver.diff
Content-Type: text/x-patch; name=mjsdriver.diff; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

--- jsDriver-mozilla.pl	2004-12-20 11:57:51.461655200 -0600
+++ jsDriver.pl	2004-12-20 12:04:24.378922696 -0600
@@ -551,6 +551,9 @@
     }  elsif ($opt_engine_type =~ /^ep(opt|debug)$/) {
         &amp;dd (&quot;getting epimetheus engine command.&quot;);
         $retval = &amp;get_ep_engine_command;
+    } elsif ($opt_engine_type eq &quot;mjs&quot;) {
+	&amp;dd (&quot;getting msj engine command.&quot;);
+	$retval = &amp;get_mjs_engine_command;
     } else {
         die (&quot;Unknown engine type selected, '$opt_engine_type'.\n&quot;);
     }
@@ -770,6 +773,66 @@
     return $retval;
 }
 
+
+#
+# get the shell command used to run epimetheus
+#
+sub get_mjs_engine_command {
+    my $retval;
+
+    if ($opt_shell_path) {
+        # if the user provided a path to the shell, return that -
+        $retval = $opt_shell_path;
+
+    } else {
+        my $dir;
+        my $os;
+        my $debug;
+        my $opt;
+        my $exe;
+
+        $dir = &quot;/usr/local/bin/&quot;;
+
+        if ($os_type eq &quot;MAC&quot;) {
+            #
+            # On the Mac, the debug and opt builds lie in the same directory -
+            #
+            $os = &quot;macbuild:&quot;;
+            $debug = &quot;&quot;;
+            $opt = &quot;&quot;;
+            $exe = &quot;mjs&quot;;
+        } elsif ($os_type eq &quot;WIN&quot;) {
+            $os = &quot;winbuild/Epimetheus/&quot;;
+            $debug = &quot;Debug/&quot;;
+            $opt = &quot;Release/&quot;;
+            $exe = &quot;mjs&quot;;
+        } else {
+            $os = &quot;&quot;;
+            $debug = &quot;&quot;;
+            $opt = &quot;&quot;;    # &lt;&lt;&lt;----- XXX THIS IS NOT RIGHT! CHANGE IT!
+            $exe = &quot;mjs&quot;;
+        }
+
+
+        if ($opt_engine_type eq &quot;mjsdebug&quot;) {
+            $retval = $dir . $os . $debug . $exe;
+        } else {
+            $retval = $dir . $os . $opt . $exe;
+        }
+
+        $retval = &amp;xp_path($retval);
+
+    }# (user provided a path)
+
+
+    if (($os_type ne &quot;MAC&quot;) &amp;&amp; !(-x $retval)) {
+        # mac doesn't seem to deal with -x correctly
+        die ($retval . &quot; is not a valid executable on this system.\n&quot;);
+    }
+
+    return $retval;
+}
+
 #
 # get the shell command used to run the liveconnect shell
 #

--=-lUTJgE4H7Xhrs6oY82YE--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025044.html">[Mono-list] Re: Seeing Values of Unwound Stack variables
 atException Handler
</A></li>
	<LI> Next message: <A HREF="025015.html">[Mono-list] Re: Installing Mono on Fedora Core 3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25007">[ date ]</a>
              <a href="thread.html#25007">[ thread ]</a>
              <a href="subject.html#25007">[ subject ]</a>
              <a href="author.html#25007">[ author ]</a>
         </LI>
       </UL>
</body></html>
