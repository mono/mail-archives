<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Interop
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jonpryor%40vt.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="024914.html">
   <LINK REL="Next"  HREF="024922.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Interop
   </H1>
    <B>Jonathan Pryor
    </B> 
    <A HREF="mailto:jonpryor%40vt.edu"
       TITLE="[Mono-list] Interop">jonpryor@vt.edu
       </A><BR>
    <I>Mon, 13 Dec 2004 06:54:09 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="024914.html">[Mono-list] Interop
</A></li>
        <LI> Next message: <A HREF="024922.html">[Mono-list] RE: Interop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24917">[ date ]</a>
              <a href="thread.html#24917">[ thread ]</a>
              <a href="subject.html#24917">[ subject ]</a>
              <a href="author.html#24917">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2004-12-13 at 10:35 +0100, Javier Miguel Gonzalez wrote:
&gt;<i> I want to call a .Net function (in a class) from unmanaged code, like
</I>&gt;<i> VC++ 6 or Delphi 7.
</I>&gt;<i> 
</I>&gt;<i> Do you know if it is possible?
</I>
Maybe.  It depends on what syntax/functionality you want to enable.

&gt;<i> Are there something like JNI in .Net?
</I>
Platform Invoke (P/Invoke) is the closest equivalent to JNI, though
P/Invoke doesn't permit use of .NET classes from unmanaged code, nor
does it offer an equivalent to JNI's reflection mechanisms.

&gt;<i> I have read this articles:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.blong.com/Conferences/BorCon2004/Interop1/Win32AndDotNetInterop.h">http://www.blong.com/Conferences/BorCon2004/Interop1/Win32AndDotNetInterop.h</A>
</I>&gt;<i> tm#InversePInvoke
</I>
This won't work on Mono/Linux, principally because it assumes that the
PE file format is the platform's native file format.  Inverse P/Invoke
allows you to make a library export that invokes a .NET function.
However, this library export is a &quot;normal&quot; PE export.  While this makes
things brain-dead simple for Windows platforms, it doesn't work for
platforms which don't use PE for the native file format, such as Linux
(which uses ELF).

&gt;<i> <A HREF="http://www.codeproject.com/csharp/Win32_to_NET.asp">http://www.codeproject.com/csharp/Win32_to_NET.asp</A>
</I>
This is the recommended approach, and is supported by both Mono
and .NET.  Delegates are your friend. :-)

One thing the above article doesn't mention is that the function pointer
the unmanaged code receives lives only as long as the managed delegate.
Once the managed delegate is GC'd, so is the function pointer that the
unmanaged code has, so if the unmanaged code invokes the function
pointer, you could crash the program.

&gt;<i> Are in Mono something better to do it than in MS .Net Framework?
</I>
Define &quot;better&quot;.  If you want portability between Mono and .NET,
delegates are the only portable approach.

If you don't mind being tied to Mono, then you could use the embedding
API, which permits unmanaged code to add additional internal calls,
create new managed objects, and invoke them.

See: <A HREF="http://www.go-mono.com/embedded-api.html">http://www.go-mono.com/embedded-api.html</A>

 - Jon



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="024914.html">[Mono-list] Interop
</A></li>
	<LI> Next message: <A HREF="024922.html">[Mono-list] RE: Interop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24917">[ date ]</a>
              <a href="thread.html#24917">[ thread ]</a>
              <a href="subject.html#24917">[ subject ]</a>
              <a href="author.html#24917">[ author ]</a>
         </LI>
       </UL>
</body></html>
