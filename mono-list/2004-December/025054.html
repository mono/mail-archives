<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Reading from a NonBlocking socket closes the connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:scott%40imeem.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025055.html">
   <LINK REL="Next"  HREF="025066.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Reading from a NonBlocking socket closes the connection
   </H1>
    <B>scott@imeem.com
    </B> 
    <A HREF="mailto:scott%40imeem.com"
       TITLE="[Mono-list] Reading from a NonBlocking socket closes the connection">scott@imeem.com
       </A><BR>
    <I>Sun, 26 Dec 2004 15:52:30 -0800 (PST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="025055.html">[Mono-list] State of mono on XScale?
</A></li>
        <LI> Next message: <A HREF="025066.html">[Mono-list] Reading from a NonBlocking socket closes the
 connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25054">[ date ]</a>
              <a href="thread.html#25054">[ thread ]</a>
              <a href="subject.html#25054">[ subject ]</a>
              <a href="author.html#25054">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This something of a nasty discrepancy between .Net and Mono

If you connect using a TCP socket and then set Socket.Blocking = false and
then immediately read with no data on the wire the Receive call throws an
exception - the equivalent of the EAGAIN code. If you catch this exception
and then test the socket's Connected property you'll notice that under
.Net the socket is still Connected  and can be used again, while under
Mono the socket is no longer connected.


IPEndPoint endpoint = new IPEndPoint(IPAddress.Parse(&quot;127.0.0.1&quot;),80); //
pick a destination which doesn't send data back
Socket sock = new (Socket(endPoint,AddressFamily, SocketType.Stream,
ProtocolType.Tcp);
sock.Connect(endPoint);

if(sock.Connected) {
    try {
        sock.Blocking = false;
        byte[] test = new byte[8];
        sock.Receive(test);
    }
    catch (Exception e)
    {
        Console.WriteLine(&quot;Connected = &quot; + sock.Connected);

    }
}

This was observed on Mono 1.1.3

Scott Manley





</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025055.html">[Mono-list] State of mono on XScale?
</A></li>
	<LI> Next message: <A HREF="025066.html">[Mono-list] Reading from a NonBlocking socket closes the
 connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25054">[ date ]</a>
              <a href="thread.html#25054">[ thread ]</a>
              <a href="subject.html#25054">[ subject ]</a>
              <a href="author.html#25054">[ author ]</a>
         </LI>
       </UL>
</body></html>
