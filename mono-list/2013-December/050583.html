<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Size of thread in Mono (65MB per thread ?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Size%20of%20thread%20in%20Mono%20%2865MB%20per%20thread%20%3F%29&In-Reply-To=%3CCAGUnuBFz_kqrjOFSyFxp1T0ySTQjHHjW0MqZ7bBsgYrh_nmv5g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="050580.html">
   <LINK REL="Next"  HREF="050581.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Size of thread in Mono (65MB per thread ?)</H1>
    <B>Ian Norton</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Size%20of%20thread%20in%20Mono%20%2865MB%20per%20thread%20%3F%29&In-Reply-To=%3CCAGUnuBFz_kqrjOFSyFxp1T0ySTQjHHjW0MqZ7bBsgYrh_nmv5g%40mail.gmail.com%3E"
       TITLE="[Mono-list] Size of thread in Mono (65MB per thread ?)">inorton at gmail.com
       </A><BR>
    <I>Sat Dec 21 18:32:52 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="050580.html">[Mono-list] Size of thread in Mono (65MB per thread ?)
</A></li>
        <LI>Next message: <A HREF="050581.html">[Mono-list] Size of thread in Mono (65MB per thread ?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50583">[ date ]</a>
              <a href="thread.html#50583">[ thread ]</a>
              <a href="subject.html#50583">[ subject ]</a>
              <a href="author.html#50583">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What are you using to tell you that you are using 64mb?

It sounds like vss increase rather than actual ram allocation. How much
swap do you have?
On 20 Dec 2013 09:14, &quot;Nicolas Antoniazzi&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">nicolas at codingame.com</A>&gt; wrote:

&gt;<i> I tested the new version of Mono 3.2 using the sgen GC.
</I>&gt;<i> I still have the same problem: every new thread uses a bit more than 64MB
</I>&gt;<i> or RAM on Linux. So, in my virtual environment limited to 512MB of
</I>&gt;<i> (virtual) RAM, it crashes (stops silently with a return code equals to 1)
</I>&gt;<i> when I try to create my 6th thread.
</I>&gt;<i>
</I>&gt;<i> I tested the same program on Windows 7 with a MS .Net environment. I
</I>&gt;<i> started 1000 threads and my program only used 48MB of RAM. I did not try to
</I>&gt;<i> create more threads because I would have to create millions of thread to
</I>&gt;<i> each a problem.
</I>&gt;<i>
</I>&gt;<i> I am really not doing some strange operations, just create threads in a
</I>&gt;<i> loop, with a pause of 1 sec between each one to let me time to see how
</I>&gt;<i> munch memory is consumed.
</I>&gt;<i> Am I the only one who encounter this strange behavior with thread of 64MB
</I>&gt;<i> or is it considered as normal?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Nicolas Antoniazzi
</I>&gt;<i> CTO - CodinGame
</I>&gt;<i> <A HREF="http://www.codingame.com">http://www.codingame.com</A>
</I>&gt;<i> +33 (0)4 67 13 00 96
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2013/12/19 &quot;Andr&#233;s G. Aragoneses&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">knocte at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;&gt;<i> Try finding the limit on the MS.NET platform, to know how it dies in
</I>&gt;&gt;<i> .NET as opposed to Mono.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, try the new version 3.2.x of mono which comes with a new garbage
</I>&gt;&gt;<i> collector, and post new results.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 19/12/13 15:29, Nicolas Antoniazzi wrote:
</I>&gt;&gt;<i> &gt; I installed Visual Studio in a windows virtual machine.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On a standard .Net platform, the same program uses 16MB of memory at
</I>&gt;&gt;<i> &gt; initialization and adds approximately 20KB for each thread.
</I>&gt;&gt;<i> &gt; It looks normal to me since the main goal of threads are to be light.
</I>&gt;&gt;<i> &gt; It's like if threads were acting like a fork() for Mono.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; So, I'm still stuck with this problem at the moment :(
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; 2013/12/19 Nicolas Antoniazzi &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">nicolas at codingame.com</A>
</I>&gt;&gt;<i> &gt; &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">nicolas at codingame.com</A>&gt;&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     I tried with version 2.10.8 and 3.0.6. Both leads to the same
</I>&gt;&gt;<i> &gt;     behavior. (Maybe gaining few KB with 3.0.6)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     Unfortunately, I do not have .Net development environment to test.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     Nicolas Antoniazzi
</I>&gt;&gt;<i> &gt;     CTO - CodinGame
</I>&gt;&gt;<i> &gt;     <A HREF="http://www.codingame.com">http://www.codingame.com</A> &lt;<A HREF="http://www.codingame.com/">http://www.codingame.com/</A>&gt;
</I>&gt;&gt;<i> &gt;     +33 (0)4 67 13 00 96 &lt;tel:%2B33%20%280%294%2067%2013%2000%2096&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     2013/12/19 &quot;Andr&#233;s G. Aragoneses&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">knocte at gmail.com</A>
</I>&gt;&gt;<i> &gt;     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">knocte at gmail.com</A>&gt;&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         On 19/12/13 11:09, Nicolas Antoniazzi wrote:
</I>&gt;&gt;<i> &gt;         &gt; Hi,
</I>&gt;&gt;<i> &gt;         &gt;
</I>&gt;&gt;<i> &gt;         &gt; I am using Mono in a virtualized environment with 512MB of
</I>&gt;&gt;<i> RAM.
</I>&gt;&gt;<i> &gt;         &gt; I made a very simple program which starts 10 threads in a
</I>&gt;&gt;<i> loop and
</I>&gt;&gt;<i> &gt;         &gt; apparently, every time that I start a new thread,
</I>&gt;&gt;<i> &gt;         approximately 65MB of
</I>&gt;&gt;<i> &gt;         &gt; memory is used.
</I>&gt;&gt;<i> &gt;         &gt;
</I>&gt;&gt;<i> &gt;         &gt; In my case, I can run 5 threads, but for the 6th, the program
</I>&gt;&gt;<i> &gt;         crashes
</I>&gt;&gt;<i> &gt;         &gt; (without any exception). 150MB are already consumed without
</I>&gt;&gt;<i> &gt;         the use of
</I>&gt;&gt;<i> &gt;         &gt; any thread.
</I>&gt;&gt;<i> &gt;         &gt;
</I>&gt;&gt;<i> &gt;         &gt; Is it a normal behavior?
</I>&gt;&gt;<i> &gt;         &gt;
</I>&gt;&gt;<i> &gt;         &gt; Thanks!
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         What version of mono are you using?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         Have you tried running your program under the .NET framework, to
</I>&gt;&gt;<i> &gt;         compare?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         _______________________________________________
</I>&gt;&gt;<i> &gt;         Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;<i> &gt;         &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>&gt;
</I>&gt;&gt;<i> &gt;         <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20131221/10e827a8/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20131221/10e827a8/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="050580.html">[Mono-list] Size of thread in Mono (65MB per thread ?)
</A></li>
	<LI>Next message: <A HREF="050581.html">[Mono-list] Size of thread in Mono (65MB per thread ?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50583">[ date ]</a>
              <a href="thread.html#50583">[ thread ]</a>
              <a href="subject.html#50583">[ subject ]</a>
              <a href="author.html#50583">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
