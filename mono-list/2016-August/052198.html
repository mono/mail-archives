<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Detecting Mono Under Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.dot.net?Subject=Re%3A%20%5BMono-list%5D%20Detecting%20Mono%20Under%20Windows&In-Reply-To=%3C7D7C80B3-39D0-4682-945C-99C346381D98%40microsoft.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052197.html">
   <LINK REL="Next"  HREF="052199.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Detecting Mono Under Windows</H1>
    <B>Alexander Köplinger</B> 
    <A HREF="mailto:mono-list%40lists.dot.net?Subject=Re%3A%20%5BMono-list%5D%20Detecting%20Mono%20Under%20Windows&In-Reply-To=%3C7D7C80B3-39D0-4682-945C-99C346381D98%40microsoft.com%3E"
       TITLE="[Mono-list] Detecting Mono Under Windows">alkpli at microsoft.com
       </A><BR>
    <I>Fri Aug 26 20:27:24 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052197.html">[Mono-list] Detecting Mono Under Windows
</A></li>
        <LI>Next message (by thread): <A HREF="052199.html">[Mono-list] Detecting Mono Under Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52198">[ date ]</a>
              <a href="thread.html#52198">[ thread ]</a>
              <a href="subject.html#52198">[ subject ]</a>
              <a href="author.html#52198">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Charlie!

The new MSI based installers write the following registry keys since Mono 4.2:

HKLM\Software\Mono (or HKLM\Software\WOW6432Node\Mono depending on whether you use the x64 or x86 installer):
- Architecture
- Installed
- Version
- SdkInstallRoot
- FrameworkAssemblyDirectory
- MonoConfigDir
 
The MSI based installer was actually introduced in Mono 3.12, but it only wrote the &quot;Installed&quot; key back then. All these versions up till now install into C:\Program Files\Mono though so you could just look for that.
There can only be one version of Mono installed on the machine (x64/x86 can be installed side by side) with the new installer.

For the earlier .exe-based installers the Novell registry keys are still correct, though we had a quite long time where we didn’t produce Windows installers at all (I think from 3.0.10 – 3.12.0).

- Alex

PS: Regarding detecting Mono versions, please note that code like <A HREF="https://github.com/nunit/nunit/blob/d42d932d1db8fa169901d941c388497a7c3307ec/src/NUnitEngine/nunit.engine/RuntimeFramework.cs#L581">https://github.com/nunit/nunit/blob/d42d932d1db8fa169901d941c388497a7c3307ec/src/NUnitEngine/nunit.engine/RuntimeFramework.cs#L581</A> doesn't
make sense on modern Mono versions since you can’t run against the 2.0/3.5/4.0 class libraries or CLR version anymore. You'll always run against the latest* libraries and runtime, which was part of the reason for renaming the profile folders
to 2.0-api, 4.0-api and so on because we only keep them so you can still compile class libraries targeting these older profiles. They are reference assemblies with metadata only.

* which is sadly still called 4.5 on disk because too many apps hardcoded that path even though it contains ~4.6.1 .NET APIs right now


On 26/08/16 20:54, &quot;Mono-list on behalf of Charlie Poole&quot; &lt;<A HREF="http://lists.dot.net/mailman/listinfo/mono-list">mono-list-bounces at lists.dot.net</A> on behalf of <A HREF="http://lists.dot.net/mailman/listinfo/mono-list">charlie at nunit.com</A>&gt; wrote:

    Hi All,
    
    I'd like to fix NUnit so it detects all Mono installations under Windows.
    
    The old code, now broken, looks at the registry entry
    HKLM\SOFTWARE\Novell\Mono\DefaultCLR to find the default version and
    then check HKLM\SOFTWARE\Novel\Mono\&lt;version&gt; to find the install
    root.
    
    It looks as if this has been broken for a long time - I've only been
    using Mono on Linux myself and so didn't notice.
    
    I'd like to know what to check currently and what other settings may
    have been used over the years. Ideally, NUnit should find even a quite
    old installation if a new one has not replaced it.
    
    The alternative, of course, would be to enumerate all available
    versions, default to the newest and let the user select older ones if
    desired.
    
    Any advice will be appreciated.
    
    Charlie
    _______________________________________________
    Mono-list maillist  -  <A HREF="http://lists.dot.net/mailman/listinfo/mono-list">Mono-list at lists.dot.net</A>
    <A HREF="http://lists.dot.net/mailman/listinfo/mono-list">http://lists.dot.net/mailman/listinfo/mono-list</A>
    

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052197.html">[Mono-list] Detecting Mono Under Windows
</A></li>
	<LI>Next message (by thread): <A HREF="052199.html">[Mono-list] Detecting Mono Under Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52198">[ date ]</a>
              <a href="thread.html#52198">[ thread ]</a>
              <a href="subject.html#52198">[ subject ]</a>
              <a href="author.html#52198">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
