<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Class library developers: locking issues to keep inmind
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:serge%40wildwestsoftware.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001906.html">
   <LINK REL="Next"  HREF="001903.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Class library developers: locking issues to keep inmind
   </H1>
    <B>Serge
    </B> 
    <A HREF="mailto:serge%40wildwestsoftware.com"
       TITLE="[Mono-list] Class library developers: locking issues to keep inmind">serge@wildwestsoftware.com
       </A><BR>
    <I>Sun, 28 Oct 2001 20:20:31 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="001906.html">[Mono-list] Class library developers: locking issues to keep in
 mind
</A></li>
        <LI> Next message: <A HREF="001903.html">[Mono-list] Class library developers: locking issues to keep in
 mind
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1907">[ date ]</a>
              <a href="thread.html#1907">[ thread ]</a>
              <a href="subject.html#1907">[ subject ]</a>
              <a href="author.html#1907">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> I read about this on the specs, I do not remember where though.
</I>&gt;<i> And I am glad to report that MCS does use Beforefieldinit as specified
</I>&gt;<i> ;-)
</I>
Well, almost ;-)

If you have statement like this:
      private static object some_obj = new object ();
compiler will implicitly generate static constructor.

Currently the difference between CSC and MCS is the following:
For &quot;implicit&quot; static constructor CSC generates BeforeFieldInit;
If &quot;explicit&quot; static constructor is present CSC omits BeforeFieldInit (even
if you have static assignments outside of the constructor's body);

MCS, however, omits BeforeFieldInit in either case;
(I'm tested this with the latest CVS sources).

I can't find this particular situation in the specs, and in fact either case
is correct according to specs.
At the same time CSC behaviour seems logical too.

Oh, and in fact verifier happily ignores this difference ;-)

Also I'm not sure I understand how to use volatile from C#. It's not a part
of signature, but rather instruction prefix, so how to force compiler to
generate such instructions? It seems there is no such attribute in
CompilerServices.

Sergey







</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001906.html">[Mono-list] Class library developers: locking issues to keep in
 mind
</A></li>
	<LI> Next message: <A HREF="001903.html">[Mono-list] Class library developers: locking issues to keep in
 mind
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1907">[ date ]</a>
              <a href="thread.html#1907">[ thread ]</a>
              <a href="subject.html#1907">[ subject ]</a>
              <a href="author.html#1907">[ author ]</a>
         </LI>
       </UL>
</body></html>
