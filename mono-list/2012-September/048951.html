<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] WebRequest.DefaultWebProxy with credentials fails
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20WebRequest.DefaultWebProxy%20with%20credentials%20fails&In-Reply-To=%3CE3F83CB1185AF24EBF19FD93966BBFBD029F2B70F5%40MAILR012.mail.lan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="048945.html">
   <LINK REL="Next"  HREF="048954.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] WebRequest.DefaultWebProxy with credentials fails</H1>
    <B>Christian Gan</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20WebRequest.DefaultWebProxy%20with%20credentials%20fails&In-Reply-To=%3CE3F83CB1185AF24EBF19FD93966BBFBD029F2B70F5%40MAILR012.mail.lan%3E"
       TITLE="[Mono-list] WebRequest.DefaultWebProxy with credentials fails">christian.gan at librestream.com
       </A><BR>
    <I>Tue Sep 18 18:51:26 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="048945.html">[Mono-list] Compiling Farseer, third party libraries, in Mono.
</A></li>
        <LI>Next message: <A HREF="048954.html">[Mono-list] using MonoGHashTable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48951">[ date ]</a>
              <a href="thread.html#48951">[ thread ]</a>
              <a href="subject.html#48951">[ subject ]</a>
              <a href="author.html#48951">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Runtime:
    Mono 2.10.9 (tarball)
    GTK 2.24.10
    GTK# (2.12.0.0)
    Package version: 210090011
Apple Developer Tools:
     Xcode 4.3.2 (1177)
     Build 4E2002
Monotouch: 5.2.12

We're using a Web Reference to consume services from several of our servers.
The issue is that when we attempt to use
WebRequest.DefaultWebProxy.Credentials, the service calls fail to properly
authenticate to our proxy server (Squid 2.7.STABLE8).

A capture from Wireshark shows something like this:

1. Request: CONNECT ourserver.com:443 HTTP 1.0
2. Response: HTTP/1.1 407 Proxy Authentication Required (text/html)
  Proxy-Authenticate: Digest realm... etc.
  Connection: Close
3. Request: CONNECT ourserver.com:443 HTTP 1.0
  Proxy-Authorization: Digest username... etc.

The issue is that in the response (2), the squid server requests the current
TCP connection to be closed (and in fact, it also sends a FIN right after the
407), but the client sends the request with authentication (3) on the same TCP
connection instead of initiating a new one (which gets eventually RST by the
proxy server).

Our .NET version of the same above code running on Windows works as expected.

Anyone else seeing an issue with proxy authentication?  I've tested with both
digest and NTLM authentication.

<A HREF="https://bugzilla.xamarin.com/show_bug.cgi?id=7258">https://bugzilla.xamarin.com/show_bug.cgi?id=7258</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20120918/c5e6fb03/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20120918/c5e6fb03/attachment.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="048945.html">[Mono-list] Compiling Farseer, third party libraries, in Mono.
</A></li>
	<LI>Next message: <A HREF="048954.html">[Mono-list] using MonoGHashTable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48951">[ date ]</a>
              <a href="thread.html#48951">[ thread ]</a>
              <a href="subject.html#48951">[ subject ]</a>
              <a href="author.html#48951">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
