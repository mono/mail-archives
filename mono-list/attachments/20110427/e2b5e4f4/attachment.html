<tt>
Greetings&nbsp;all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;an&nbsp;SSL&nbsp;Server&nbsp;written&nbsp;for&nbsp;mono&nbsp;which&nbsp;needs&nbsp;to&nbsp;mutually&nbsp;authenticate&nbsp;with&nbsp;the&nbsp;clients&nbsp;that&nbsp;connect.&nbsp;As&nbsp;soon&nbsp;as&nbsp;a&nbsp;client&nbsp;connects&nbsp;I&nbsp;get:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;System.IO.IOException:&nbsp;The&nbsp;authentication&nbsp;or&nbsp;decryption&nbsp;has&nbsp;failed.&nbsp;---&amp;gt;&nbsp;Mono.Security.Protocol.Tls.TlsException:&nbsp;Server&nbsp;certificate&nbsp;Private&nbsp;Key&nbsp;unavailable.&lt;/div&gt;<br>
&lt;div&gt;  at&nbsp;Mono.Security.Protocol.Tls.Handshake.Server.TlsClientKeyExchange.ProcessAsTls1&nbsp;()&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0 &lt;/div&gt;&lt;div&gt;  at&nbsp;Mono.Security.Protocol.Tls.Handshake.HandshakeMessage.Process&nbsp;()&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0 &lt;/div&gt;<br>
&lt;div&gt;  at&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;Mono.Security.Protocol.Tls.Handshake.HandshakeMessage:Process&nbsp;()&lt;/div&gt;&lt;div&gt;  at&nbsp;Mono.Security.Protocol.Tls.ServerRecordProtocol.ProcessHandshakeMessage&nbsp;(Mono.Security.Protocol.Tls.TlsStream&nbsp;handMsg)&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0 &lt;/div&gt;<br>
&lt;div&gt;  at&nbsp;Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback&nbsp;(IAsyncResult&nbsp;asyncResult)&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0 &lt;/div&gt;&lt;div&gt;  ---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---&lt;/div&gt;&lt;div&gt;  at&nbsp;Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback&nbsp;(IAsyncResult&nbsp;asyncResult)&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0 &lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; I&nbsp;have&nbsp;been&nbsp;at&nbsp;this&nbsp;for&nbsp;a&nbsp;couple&nbsp;days&nbsp;and&nbsp;have&nbsp;read&nbsp;through &lt;a&nbsp;href=&quot;http://www.mono-project.com/Cryptography&quot;&gt;http://www.mono-project.com/Cryptography&lt;/a&gt;&nbsp;and &lt;a&nbsp;href=&quot;http://www.mono-project.com/FAQ:_Security&quot;&gt;http://www.mono-project.com/FAQ:_Security&lt;/a&gt;&nbsp;a&nbsp;dozen&nbsp;times. &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;my&nbsp;code:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;TcpClient&nbsp;tcpClient&nbsp;=&nbsp;this.tcpListener.AcceptTcpClient();&lt;/div&gt;&lt;div&gt;SslStream&nbsp;sslStream&nbsp;=&nbsp;new&nbsp;SslStream(tcpClient.GetStream(),&nbsp;true,&nbsp;new&nbsp;RemoteCertificateValidationCallback(Validator),&nbsp;new&nbsp;LocalCertificateSelectionCallback(SelectLocalCertificate));&lt;/div&gt;<br>
&lt;div&gt;X509Certificate2&nbsp;serverCert&nbsp;=&nbsp;new&nbsp;X509Certificate2(&amp;quot;root.cer&amp;quot;);&lt;/div&gt;&lt;div&gt;sslStream.AuthenticateAsServer(serverCert,&nbsp;true,&nbsp;SslProtocols.Tls,&nbsp;true);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;is&nbsp;failing&nbsp;during&nbsp;the&nbsp;RemoteCertificateValidationCallback,&nbsp;which&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;find&nbsp;the&nbsp;private&nbsp;key. &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;tried&nbsp;importing&nbsp;the&nbsp;p12&nbsp;with&nbsp;the&nbsp;private&nbsp;key&nbsp;every&nbsp;way&nbsp;i&nbsp;could&nbsp;google&nbsp;with&nbsp;no&nbsp;result. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;try&nbsp;to&nbsp;manually&nbsp;add&nbsp;the&nbsp;p12&nbsp;with&nbsp;X509Certificate2&nbsp;cert&nbsp;=&nbsp;new&nbsp;X509Certificate2(&amp;quot;foo.p12&amp;quot;,&amp;quot;pass&amp;quot;)&nbsp;inside&nbsp;the&nbsp;remote&nbsp;callback,&nbsp;it&nbsp;will&nbsp;load&nbsp;the&nbsp;file&nbsp;fine,&nbsp;but&nbsp;then&nbsp;I&nbsp;don&amp;#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do&nbsp;with&nbsp;it.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;i&nbsp;try&nbsp;to&nbsp;add&nbsp;it&nbsp;to&nbsp;the&nbsp;chain,&nbsp;(which&nbsp;is&nbsp;apparently&nbsp;not&nbsp;what&nbsp;I&nbsp;want&nbsp;to&nbsp;do)&nbsp;i&nbsp;get:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;System.IO.IOException:&nbsp;The&nbsp;authentication&nbsp;or&nbsp;decryption&nbsp;has&nbsp;failed.&nbsp;---&amp;gt;&nbsp;System.NullReferenceException:&nbsp;Object&nbsp;reference&nbsp;not&nbsp;set&nbsp;to&nbsp;an&nbsp;instance&nbsp;of&nbsp;an&nbsp;object&lt;/div&gt;<br>
&lt;div&gt;at&nbsp;Test.Validator&nbsp;(System.Object&nbsp;sender,&nbsp;System.Security.Cryptography.X509Certificates.X509Certificate&nbsp;certificate,&nbsp;System.Security.Cryptography.X509Certificates.X509Chain&nbsp;chain,&nbsp;SslPolicyErrors&nbsp;sslPolicyErrors)&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0 &lt;/div&gt;<br>
&lt;div&gt;at&nbsp;System.Net.Security.SslStream+&amp;lt;BeginAuthenticateAsServer&amp;gt;c__AnonStorey8.&amp;lt;&amp;gt;m__B&nbsp;(System.Security.Cryptography.X509Certificates.X509Certificate&nbsp;cert,&nbsp;System.Int32[]&nbsp;certErrors)&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0 &lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;box&nbsp;it&nbsp;is&nbsp;running&nbsp;on&nbsp;is&nbsp;an&nbsp;openSUSE&nbsp;11.3&nbsp;with&nbsp;Mono&nbsp;2.6.4&nbsp;(which&nbsp;probably&nbsp;doesn&amp;#39;t&nbsp;matter,&nbsp;but&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;give&nbsp;as&nbsp;much&nbsp;detail&nbsp;as&nbsp;possible).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;the&nbsp;exact&nbsp;opposite&nbsp;working&nbsp;as&nbsp;part&nbsp;of&nbsp;this&nbsp;server&nbsp;which&nbsp;makes&nbsp;an&nbsp;SSL/TLS&nbsp;connection&nbsp;to&nbsp;another&nbsp;server&nbsp;(AuthenticateAsClient)&nbsp;and&nbsp;it&nbsp;works&nbsp;great.&nbsp;There&nbsp;is&nbsp;just&nbsp;something&nbsp;in&nbsp;this&nbsp;process&nbsp;I&nbsp;am&nbsp;not&nbsp;getting...and&nbsp;it&nbsp;is&nbsp;probably&nbsp;really&nbsp;simple.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;made&nbsp;the&nbsp;certificate&nbsp;with&nbsp;makecert&nbsp;(as&nbsp;detailed&nbsp;in&nbsp;the&nbsp;links&nbsp;above),&nbsp;added&nbsp;it&nbsp;to&nbsp;the&nbsp;trust&nbsp;with&nbsp;certmgr&nbsp;(ditto),&nbsp;and&nbsp;am&nbsp;at&nbsp;a&nbsp;wall.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;help&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appreciated!&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Chuck&lt;/div&gt;<br>

</tt>
