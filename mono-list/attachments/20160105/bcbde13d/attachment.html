<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;After&nbsp;running&nbsp;a&nbsp;profiler&nbsp;on&nbsp;the&nbsp;test&nbsp;code,&nbsp;I&nbsp;noticed&nbsp;that&nbsp;most&nbsp;of&nbsp;the&nbsp;extra&nbsp;time&nbsp;is&nbsp;spent&nbsp;in&nbsp;this&nbsp;method:&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(128,0,0);background-color:rgb(238,238,238)&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(128,0,0);background-color:rgb(238,238,238)&quot;&gt;4319260&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(128,0,0);background-color:rgb(238,238,238)&quot;&gt;4319260&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(128,0,0);background-color:rgb(238,238,238)&quot;&gt;7579&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;wrapper&nbsp;managed&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;to&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,139);background-color:rgb(238,238,238)&quot;&gt;native&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;System&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;Threading&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;WaitHandle&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;WaitOne_internal&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;System&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;Threading&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;WaitHandle&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;intptr&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(43,145,175);background-color:rgb(238,238,238)&quot;&gt;int&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;bool&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;)&lt;/span&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,sans-serif;white-space:inherit;font-size:13px;margin:0px;padding:0px;border:0px;color:rgb(0,0,0);background-color:rgb(238,238,238)&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;When&nbsp;I&nbsp;examined&nbsp;the&nbsp;trace&nbsp;of&nbsp;the&nbsp;profile&nbsp;output,&nbsp;most&nbsp;of&nbsp;the&nbsp;stack&nbsp;traces&nbsp;had&nbsp;(rougly)&nbsp;the&nbsp;same&nbsp;number&nbsp;of&nbsp;calls,&nbsp;except&nbsp;for&nbsp;this&nbsp;one:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;System.Threading.ExecutionContext:Run&nbsp;(System.Threading.ExecutionContext,System.Threading.ContextCallback,object,bool)&lt;br&gt;System.Threading.ExecutionContext:RunInternal&nbsp;(System.Threading.ExecutionContext,System.Threading.ContextCallback,object,bool)&lt;br&gt;System.Threading.ThreadHelper:ThreadStart_Context&nbsp;(object)&lt;br&gt;System.Threading.Timer/Scheduler:SchedulerThread&nbsp;()&lt;br&gt;System.Threading.WaitHandle:WaitOne&nbsp;(int)&lt;br&gt;System.Threading.WaitHandle:WaitOne&nbsp;(int,bool)&lt;/font&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;251&nbsp;calls&nbsp;for&nbsp;the&nbsp;case&nbsp;with&nbsp;multiple&nbsp;AppDomains&nbsp;vs&nbsp;4581&nbsp;calls&nbsp;for&nbsp;the&nbsp;single&nbsp;AppDomain&nbsp;case.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Does&nbsp;anyone&nbsp;have&nbsp;any&nbsp;idea&nbsp;why&nbsp;this&nbsp;would&nbsp;be&nbsp;happening?&nbsp;Is&nbsp;this&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;Mono&nbsp;SOAP&nbsp;stack?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;River&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;4&nbsp;January&nbsp;2016&nbsp;at&nbsp;16:47,&nbsp;River&nbsp;Satya&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:river.satya@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;river.satya@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;p&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;1em;padding:0px;border:0px;clear:both;color:rgb(34,36,38);font-family:Arial,&#39;Helvetica&nbsp;Neue&#39;,Helvetica,sans-serif;line-height:19.5px&quot;&gt;A&nbsp;piece&nbsp;of&nbsp;code&nbsp;I&nbsp;inherited&nbsp;recently&nbsp;uses&nbsp;separate&nbsp;AppDomains&nbsp;to&nbsp;parallelise&nbsp;calls&nbsp;to&nbsp;a&nbsp;SOAP&nbsp;web&nbsp;service.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;1em;padding:0px;border:0px;clear:both;color:rgb(34,36,38);font-family:Arial,&#39;Helvetica&nbsp;Neue&#39;,Helvetica,sans-serif;line-height:19.5px&quot;&gt;We&nbsp;were&nbsp;seeing&nbsp;an&nbsp;intermittent&nbsp;bug&nbsp;in&nbsp;Mono&nbsp;which&nbsp;caused&nbsp;crashes&nbsp;when&nbsp;the&nbsp;AppDomains&nbsp;were&nbsp;unloaded,&nbsp;and&nbsp;since&nbsp;AppDomains&nbsp;seemed&nbsp;like&nbsp;overkill&nbsp;for&nbsp;the&nbsp;purposes&nbsp;of&nbsp;multithreading&nbsp;calls&nbsp;to&nbsp;the&nbsp;service,&nbsp;I&nbsp;removed&nbsp;them&nbsp;and&nbsp;simplified&nbsp;the&nbsp;code.&nbsp;All&nbsp;seemed&nbsp;to&nbsp;work&nbsp;fine,&nbsp;however,&nbsp;there&nbsp;was&nbsp;a&nbsp;drastic&nbsp;performance&nbsp;regression&nbsp;(around&nbsp;3x&nbsp;slower).&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;1em;padding:0px;border:0px;clear:both;color:rgb(34,36,38);font-family:Arial,&#39;Helvetica&nbsp;Neue&#39;,Helvetica,sans-serif;line-height:19.5px&quot;&gt;I&nbsp;put&nbsp;together&nbsp;a&nbsp;simplified&nbsp;chunk&nbsp;of&nbsp;code&nbsp;to&nbsp;reproduce&nbsp;the&nbsp;issue:&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;1em;padding:0px;border:0px;clear:both&quot;&gt;&lt;font&nbsp;color=&quot;#222426&quot;&nbsp;face=&quot;Arial,&nbsp;Helvetica&nbsp;Neue,&nbsp;Helvetica,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;line-height:19.5px&quot;&gt;&lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/34585272/massive-performance-slowdown-in-c-sharp-soap-client-when-one-appdomain-per-threa&quot;&nbsp;target=&quot;_blank&quot;&gt;http://stackoverflow.com/questions/34585272/massive-performance-slowdown-in-c-sharp-soap-client-when-one-appdomain-per-threa&lt;/a&gt;&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;1em;padding:0px;border:0px;clear:both&quot;&gt;Any&nbsp;insight&nbsp;appreciated!&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;1em;padding:0px;border:0px;clear:both&quot;&gt;Thanks,&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;1em;padding:0px;border:0px;clear:both&quot;&gt;River&lt;/p&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
