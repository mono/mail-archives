<tt>
&lt;p&gt;To&nbsp;be&nbsp;honest,&nbsp;the&nbsp;numbers&nbsp;mean&nbsp;nothing&nbsp;by&nbsp;themselves.&nbsp;Why&nbsp;are&nbsp;you&nbsp;surprised&nbsp;about&nbsp;the&nbsp;memory&nbsp;usage?&nbsp;Apparently&nbsp;there&amp;#39;s&nbsp;110mb&nbsp;of&nbsp;data&nbsp;being&nbsp;allocated&nbsp;by&nbsp;the&nbsp;streamwriter.&nbsp;This&nbsp;is&nbsp;because&nbsp;you&amp;#39;re&nbsp;creating&nbsp;thousands&nbsp;of&nbsp;streamwriters.&lt;/p&gt;<br>
<br>
&lt;p&gt;If&nbsp;you&nbsp;find&nbsp;the&nbsp;amount&nbsp;of&nbsp;memory&nbsp;being&nbsp;allocated&nbsp;(and&nbsp;released)&nbsp;by&nbsp;streamwriters&nbsp;to&nbsp;be&nbsp;excessive,&nbsp;you&nbsp;should&nbsp;rewrite&nbsp;your&nbsp;code&nbsp;so&nbsp;that&nbsp;you&nbsp;reuse&nbsp;them&nbsp;were&nbsp;appropriate&nbsp;instead&nbsp;of&nbsp;creating&nbsp;new&nbsp;ones.&nbsp;&lt;/p&gt;<br>
&lt;p&gt;Similar&nbsp;optimisations&nbsp;could&nbsp;potentially&nbsp;be&nbsp;applied&nbsp;to&nbsp;your&nbsp;usage&nbsp;of&nbsp;the&nbsp;Dictionary&nbsp;class.&nbsp;You&amp;#39;re&nbsp;allocating&nbsp;a&nbsp;lot&nbsp;of&nbsp;them.&nbsp;Would&nbsp;it&nbsp;be&nbsp;possible&nbsp;for&nbsp;you&nbsp;to&nbsp;call&nbsp;Clear&nbsp;on&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;then&nbsp;reuse&nbsp;it?&lt;/p&gt;<br>
&lt;p&gt;Alan&nbsp;&lt;/p&gt;<br>
&lt;p&gt;On&nbsp;31&nbsp;Aug&nbsp;2011&nbsp;16:51,&nbsp;&amp;quot;pjsmith&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:pjsmith@mtgsy.net&quot;&gt;pjsmith@mtgsy.net&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&nbsp;type=&quot;attribution&quot;&gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;My&nbsp;&lt;a&nbsp;href=&quot;http://vb.net&quot;&gt;vb.net&lt;/a&gt;&nbsp;app&nbsp;running&nbsp;under&nbsp;mono&nbsp;on&nbsp;linux(built&nbsp;under&nbsp;.net&nbsp;on&nbsp;windows)&nbsp;is&lt;br&gt;<br>
&amp;gt;&nbsp;using&nbsp;a&nbsp;lot&nbsp;of&nbsp;memory.&nbsp;&nbsp;I&nbsp;tried&nbsp;to&nbsp;use&nbsp;the&nbsp;profiler&nbsp;running&nbsp;on&nbsp;linux&nbsp;to&nbsp;see&lt;br&gt;&amp;gt;&nbsp;where&nbsp;this&nbsp;is&nbsp;all&nbsp;going,&nbsp;but&nbsp;having&nbsp;some&nbsp;problems&nbsp;interpreting&nbsp;exactly&nbsp;what&lt;br&gt;&amp;gt;&nbsp;I&nbsp;see.&nbsp;&nbsp;I&nbsp;read&nbsp;the&nbsp;profiler&nbsp;info&nbsp;on&nbsp;the&nbsp;mono&nbsp;site,&nbsp;but&nbsp;whilst&nbsp;it&nbsp;explains&lt;br&gt;<br>
&amp;gt;&nbsp;how&nbsp;to&nbsp;use&nbsp;it,&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;do&nbsp;much&nbsp;about&nbsp;telling&nbsp;how&nbsp;to&nbsp;interpret&nbsp;the&lt;br&gt;&amp;gt;&nbsp;results!&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;I&amp;#39;m&nbsp;seeing&nbsp;data&nbsp;like&nbsp;the&nbsp;following&nbsp;and&nbsp;am&nbsp;surprised&nbsp;at&nbsp;the&nbsp;memory&nbsp;usage.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;118830&nbsp;KB&nbsp;System.IO.StreamWriter::Initialize(Encoding,int)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;79194&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4948&nbsp;System.Byte[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;39635&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4948&nbsp;System.Char[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4944&nbsp;&nbsp;99&nbsp;%&nbsp;System.IO.StreamWriter::.ctor(string,bool,Encoding,int)&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;102769&nbsp;KB&lt;br&gt;&amp;gt;&nbsp;Mono.Globalization.Unicode.SortKeyBuffer::Initialize(CompareOptions,int,string,bool)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;102769&nbsp;KB&nbsp;&nbsp;3599832&nbsp;System.Byte[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;449979&nbsp;&nbsp;100&nbsp;%&lt;br&gt;&amp;gt;&nbsp;Mono.Globalization.Unicode.SimpleCollator::GetSortKey(string,int,int,CompareOptions)&lt;br&gt;<br>
&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;81311&nbsp;KB&nbsp;System.Collections.Generic.Dictionary`2::Resize()&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;31979&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;54578&nbsp;.Link[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16458&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;54598&nbsp;System.String[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16457&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;54595&nbsp;System.Int32[]&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16416&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;54578&nbsp;System.Object[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;54581&nbsp;&nbsp;99&nbsp;%&lt;br&gt;&amp;gt;&nbsp;System.Collections.Generic.Dictionary`2::set_Item(TKey,TValue)&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;60706&nbsp;KB&nbsp;System.String::ToCharArray()&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60706&nbsp;KB&nbsp;&nbsp;&nbsp;305281&nbsp;System.Char[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;283019&nbsp;&nbsp;92&nbsp;%&lt;br&gt;&amp;gt;&nbsp;Microsoft.VisualBasic.Strings::Replace(string,string,string,int,int,bool)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17182&nbsp;&nbsp;&nbsp;5&nbsp;%&lt;br&gt;&amp;gt;&nbsp;Microsoft.VisualBasic.Strings::Split(string,string,int,CompareMethod)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4969&nbsp;&nbsp;&nbsp;1&nbsp;%&nbsp;System.IO.TextWriter::.ctor()&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;60047&nbsp;KB&nbsp;System.Text.StringBuilder::.ctor(string,int,int,int,int)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60047&nbsp;KB&nbsp;&nbsp;&nbsp;294018&nbsp;System.String&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;294018&nbsp;&nbsp;100&nbsp;%&nbsp;System.Text.StringBuilder::.ctor(string,int,int,int)&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;56349&nbsp;KB&nbsp;System.String::Remove(int,int)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;56349&nbsp;KB&nbsp;&nbsp;&nbsp;217892&nbsp;System.String&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;217892&nbsp;&nbsp;100&nbsp;%&nbsp;ConsoleApplication1.Module1::GetRecords(string,soa)&lt;br&gt;<br>
&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;39647&nbsp;KB&nbsp;System.IO.FileStream::InitBuffer(int,bool)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;39647&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4953&nbsp;System.Byte[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4948&nbsp;&nbsp;99&nbsp;%&lt;br&gt;<br>
&amp;gt;&nbsp;System.IO.FileStream::.ctor(string,FileMode,FileAccess,FileShare,int,bool,FileOptions)&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;38670&nbsp;KB&lt;br&gt;&amp;gt;&nbsp;Mono.Globalization.Unicode.SimpleCollator::GetSortKey(string,int,int,CompareOptions)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38670&nbsp;KB&nbsp;&nbsp;&nbsp;449979&nbsp;Mono.Globalization.Unicode.SortKeyBuffer&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;449979&nbsp;&nbsp;100&nbsp;%&lt;br&gt;&amp;gt;&nbsp;Mono.Globalization.Unicode.SimpleCollator::GetSortKey(string,CompareOptions)&lt;br&gt;<br>
&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;32156&nbsp;KB&nbsp;System.String::ConcatInternal(string[],int)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32156&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;86981&nbsp;System.String&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;86981&nbsp;&nbsp;100&nbsp;%&nbsp;System.String::Concat(string[])&lt;br&gt;<br>
&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;29879&nbsp;KB&nbsp;System.String::SubstringUnchecked(int,int)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29879&nbsp;KB&nbsp;&nbsp;1394496&nbsp;System.String&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1715586&nbsp;&nbsp;77&nbsp;%&nbsp;System.String::Substring(int,int)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;449964&nbsp;&nbsp;20&nbsp;%&nbsp;System.String::Substring(int)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37896&nbsp;&nbsp;&nbsp;1&nbsp;%&nbsp;System.Text.StringBuilder::ToString()&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;27962&nbsp;KB&nbsp;System.String::CreateString(char,int)&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27962&nbsp;KB&nbsp;&nbsp;1211286&nbsp;System.String&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1211286&nbsp;&nbsp;100&nbsp;%&nbsp;System.String::.ctor(char,int)&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;27741&nbsp;KB&nbsp;maxmind.LookupService::init()&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27741&nbsp;KB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;System.Byte[]&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;100&nbsp;%&nbsp;maxmind.LookupService::.ctor(string,int)&lt;br&gt;&amp;gt;&nbsp;########################&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;25583&nbsp;KB&nbsp;System.Text.Encoding::GetBytes(string)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25583&nbsp;KB&nbsp;&nbsp;1433648&nbsp;System.Byte[]&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1421228&nbsp;&nbsp;99&nbsp;%&lt;br&gt;&amp;gt;&nbsp;MySql.Data.MySqlClient.MySqlPacket::WriteStringNoNull(string)&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;I&amp;#39;ve&nbsp;tried&nbsp;calling&nbsp;gc.collect&nbsp;(I&nbsp;know,&nbsp;bad),&nbsp;but&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;help&nbsp;much.&nbsp;&nbsp;Now&lt;br&gt;<br>
&amp;gt;&nbsp;experimenting&nbsp;with&nbsp;.dispose,&nbsp;but&nbsp;this&nbsp;is&nbsp;all&nbsp;managed&nbsp;code,&nbsp;so&nbsp;not&nbsp;sure&nbsp;any&lt;br&gt;&amp;gt;&nbsp;of&nbsp;this&nbsp;should&nbsp;really&nbsp;be&nbsp;needed?&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;Mono&nbsp;version&nbsp;is&nbsp;2.4.4&nbsp;and&nbsp;I&amp;#39;m&nbsp;running&nbsp;it&nbsp;under&nbsp;Ubuntu&nbsp;10.4.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;Does&nbsp;anyone&nbsp;have&nbsp;any&nbsp;suggestions&nbsp;or&nbsp;pointers&nbsp;to&nbsp;material&nbsp;where&nbsp;I&nbsp;can&nbsp;learn&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;bit&nbsp;more&nbsp;about&nbsp;this,&nbsp;or&nbsp;any&nbsp;suggestions&nbsp;for&nbsp;preserving&nbsp;memory&nbsp;when&nbsp;running&lt;br&gt;&amp;gt;&nbsp;apps&nbsp;under&nbsp;mono?&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;Thanks.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;--&lt;br&gt;&amp;gt;&nbsp;View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/newbie-understanding-profiler-data-tp3781405p3781405.html&quot;&gt;http://mono.1490590.n4.nabble.com/newbie-understanding-profiler-data-tp3781405p3781405.html&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Sent&nbsp;from&nbsp;the&nbsp;Mono&nbsp;-&nbsp;General&nbsp;mailing&nbsp;list&nbsp;archive&nbsp;at&nbsp;Nabble.com.&lt;br&gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;&amp;gt;&nbsp;Mono-list&nbsp;maillist&nbsp;&nbsp;-&nbsp;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-list@lists.ximian.com&quot;&gt;Mono-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-list&lt;/a&gt;&lt;br&gt;&lt;/p&gt;<br>

</tt>
