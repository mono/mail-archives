<tt>
Hi,&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Apr&nbsp;28,&nbsp;2009&nbsp;at&nbsp;10:08&nbsp;AM,&nbsp;David&nbsp;Henderson&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:dnadavewa@yahoo.com&quot;&gt;dnadavewa@yahoo.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
My&nbsp;apologies&nbsp;for&nbsp;a&nbsp;tardy&nbsp;reply.&nbsp; I&amp;#39;ll&nbsp;address&nbsp;all&nbsp;of&nbsp;the&nbsp;questions&nbsp;in&nbsp;this&nbsp;e-mail,&nbsp;rather&nbsp;than&nbsp;reply&nbsp;multiple&nbsp;times.&lt;br&gt;<br>
&lt;br&gt;<br>
1)&nbsp;I&nbsp;used&nbsp;file&nbsp;to&nbsp;determine&nbsp;that&nbsp;the&nbsp;.exe&nbsp;files&nbsp;were&nbsp;32bit.&nbsp; It&nbsp;is&nbsp;entirely&nbsp;possible&nbsp;that&nbsp;file&nbsp;returns&nbsp;32bit&nbsp;for&nbsp;all&nbsp;.exe,&nbsp;rather&nbsp;than&nbsp;examine&nbsp;the&nbsp;file.&lt;br&gt;<br>
2)&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;store&nbsp;char/string&nbsp;data&nbsp;as&nbsp;something&nbsp;smaller&nbsp;than&nbsp;UTF-16?&nbsp; The&nbsp;data&nbsp;are&nbsp;SNP&nbsp;genotypes,&nbsp;i.e.&nbsp;a&nbsp;single&nbsp;SNP&nbsp;genotype&nbsp;looks&nbsp;like&nbsp;A&nbsp;T&nbsp;and&nbsp;there&nbsp;are&nbsp;almost&nbsp;a&nbsp;million&nbsp;of&nbsp;these&nbsp;per&nbsp;individual.&nbsp; I&amp;#39;m&nbsp;thinking&nbsp;that&nbsp;what&nbsp;I&nbsp;need&nbsp;to&nbsp;do&nbsp;is&nbsp;record&nbsp;the&nbsp;genotype&nbsp;as&nbsp;bits,&nbsp;i.e.&nbsp;0&nbsp;or&nbsp;1,&nbsp;and&nbsp;relate&nbsp;that&nbsp;back&nbsp;to&nbsp;a&nbsp;translation&nbsp;class&nbsp;thet&nbsp;returns&nbsp;A&nbsp;or&nbsp;T&nbsp;when&nbsp;that&nbsp;SNP&nbsp;is&nbsp;queried.&nbsp; It&nbsp;would&nbsp;be&nbsp;simpler&nbsp;if&nbsp;I&nbsp;could&nbsp;store&nbsp;char/string&nbsp;data&nbsp;as&nbsp;something&nbsp;reasonably&nbsp;small.&lt;/blockquote&gt;<br>
&lt;div&gt;&lt;br&gt;Use&nbsp;the&nbsp;BitArray&nbsp;class.&nbsp;That&amp;#39;s&nbsp;exactly&nbsp;what&nbsp;it&amp;#39;s&nbsp;for.&nbsp;If&nbsp;it&amp;#39;s&nbsp;possible&nbsp;for&nbsp;you&nbsp;to&nbsp;store&nbsp;your&nbsp;genotype&nbsp;using&nbsp;bits&nbsp;as&nbsp;opposed&nbsp;to&nbsp;strings&nbsp;you&amp;#39;ll&nbsp;*vastly*&nbsp;reduce&nbsp;your&nbsp;memory&nbsp;requirements.&lt;br&gt;&lt;br&gt;Alan.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
3)&nbsp;What&nbsp;I&amp;#39;m&nbsp;currently&nbsp;doing&nbsp;is:&lt;br&gt;<br>
&nbsp; a)&nbsp;read&nbsp;in&nbsp;each&nbsp;line&nbsp;as&nbsp;a&nbsp;single&nbsp;string&nbsp;which&nbsp;is&nbsp;split&nbsp;based&nbsp;upon&nbsp;whitespace&lt;br&gt;<br>
&nbsp; b)&nbsp;input&nbsp;each&nbsp;SNP&nbsp;into&nbsp;a&nbsp;class&nbsp;which&nbsp;is&nbsp;stored&nbsp;in&nbsp;an&nbsp;ArrayList,&nbsp;or&nbsp;as&nbsp;a&nbsp;string&nbsp;array&nbsp;in&nbsp;a&nbsp;List&amp;lt;string&amp;gt;&nbsp;(I&amp;#39;ve&nbsp;implemented&nbsp;it&nbsp;both&nbsp;ways)&lt;br&gt;<br>
&nbsp; c)&nbsp;once&nbsp;the&nbsp;while&nbsp;file&nbsp;is&nbsp;read&nbsp;in,&nbsp;output&nbsp;each&nbsp;collection&nbsp;of&nbsp;SNPs&nbsp;by&nbsp;chromosome&nbsp;to&nbsp;a&nbsp;different&nbsp;file&nbsp;for&nbsp;processing&nbsp;by&nbsp;other&nbsp;software&lt;br&gt;<br>
&lt;br&gt;<br>
I&amp;#39;ve&nbsp;been&nbsp;able&nbsp;to&nbsp;get&nbsp;past&nbsp;my&nbsp;initial&nbsp;problem&nbsp;by&nbsp;re-compiling&nbsp;mono&nbsp;with&nbsp;the&nbsp;large&nbsp;heap&nbsp;size&nbsp;GC&nbsp;and&nbsp;when&nbsp;the&nbsp;entire&nbsp;data&nbsp;is&nbsp;read&nbsp;in,&nbsp;it&nbsp;takes&nbsp;up&nbsp;17GB&nbsp;RAM&nbsp;for&nbsp;a&nbsp;300MB&nbsp;file.&nbsp; I&nbsp;know&nbsp;I&amp;#39;m&nbsp;new&nbsp;to&nbsp;mono/C#,&nbsp;but&nbsp;I&amp;#39;ve&nbsp;been&nbsp;programming&nbsp;in&nbsp;C++&nbsp;for&nbsp;years&nbsp;and&nbsp;have&nbsp;written&nbsp;many&nbsp;commerical&nbsp;applications&nbsp;for&nbsp;large&nbsp;data&nbsp;and&nbsp;nothing&nbsp;I&amp;#39;ve&nbsp;written&nbsp;to&nbsp;date&nbsp;has&nbsp;been&nbsp;as&nbsp;memory&nbsp;hungry&nbsp;as&nbsp;this.&nbsp; I&amp;#39;m&nbsp;hoepful&nbsp;I&nbsp;can&nbsp;get&nbsp;some&nbsp;good&nbsp;suggestions&nbsp;on&nbsp;how&nbsp;to&nbsp;improve&nbsp;performance.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Thanks!!&lt;br&gt;<br>
&lt;br&gt;<br>
Dave&nbsp;H&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-----&nbsp;Original&nbsp;Message&nbsp;----&lt;br&gt;<br>
From:&nbsp;Jonathan&nbsp;Pryor&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jonpryor@vt.edu&quot;&gt;jonpryor@vt.edu&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
To:&nbsp;dnadavewa&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:dnadavewa@yahoo.com&quot;&gt;dnadavewa@yahoo.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
Cc:&nbsp;&lt;a&nbsp;href=&quot;mailto:mono-list@lists.ximian.com&quot;&gt;mono-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
Sent:&nbsp;Friday,&nbsp;April&nbsp;24,&nbsp;2009&nbsp;12:14:12&nbsp;PM&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[Mono-list]&nbsp; 64bit&nbsp;gmcs/mcs&nbsp;in&nbsp;SLES/openSuSE&nbsp;rpms?&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Thu,&nbsp;2009-04-23&nbsp;at&nbsp;14:20&nbsp;-0700,&nbsp;dnadavewa&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;working&nbsp;on&nbsp;a&nbsp;large&nbsp;data&nbsp;problem&nbsp;where&nbsp;I&amp;#39;m&nbsp;reading&nbsp;in&nbsp;data&nbsp;from&nbsp;text&nbsp;files&lt;br&gt;<br>
&amp;gt;&nbsp;with&nbsp;almost&nbsp;2&nbsp;million&nbsp;columns.&nbsp; In&nbsp;doing&nbsp;this,&nbsp;I&nbsp;can&nbsp;read&nbsp;in&nbsp;about&nbsp;25&nbsp;rows&lt;br&gt;<br>
&amp;gt;&nbsp;before&nbsp;Mono&nbsp;bombs&nbsp;out&nbsp;with&nbsp;an&nbsp;out&nbsp;of&nbsp;memory&nbsp;error.&lt;br&gt;<br>
&lt;br&gt;<br>
How&nbsp;are&nbsp;you&nbsp;reading&nbsp;in&nbsp;these&nbsp;lines?&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;What&nbsp;I&nbsp;found&nbsp;was&nbsp;the&nbsp;mono&nbsp;executable&nbsp;was&nbsp;indeed&nbsp;64&nbsp;bit,&nbsp;but&nbsp;gmcs.exe&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;mcs.exe&nbsp;were&nbsp;32&nbsp;bit.&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;Chris&nbsp;Howie&nbsp;mentioned,&nbsp;these&nbsp;are&nbsp;actually&nbsp;in&nbsp;platform-neutral&nbsp;IL,&nbsp;and&lt;br&gt;<br>
will&nbsp;be&nbsp;run&nbsp;using&nbsp;a&nbsp;64-bit&nbsp;address&nbsp;space&nbsp;when&nbsp;using&nbsp;`mono`.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;One&nbsp;other&nbsp;point,&nbsp;memory&nbsp;usage&nbsp;is&nbsp;horrible.&nbsp; I&nbsp;admit&nbsp;that&nbsp;I&amp;#39;m&nbsp;new&nbsp;to&nbsp;C#&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;mono,&nbsp;so&nbsp;my&nbsp;coding&nbsp;skills&nbsp;are&nbsp;not&nbsp;as&nbsp;good&nbsp;as&nbsp;others,&nbsp;but&nbsp;a&nbsp;300MB&nbsp;file&nbsp;should&lt;br&gt;<br>
&amp;gt;&nbsp;not&nbsp;use&nbsp;2GB&nbsp;RAM&nbsp;to&nbsp;read&nbsp;in&nbsp;1/8&nbsp;of&nbsp;the&nbsp;file.&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;depends&nbsp;~entirely&nbsp;on&nbsp;how&nbsp;you&amp;#39;re&nbsp;reading&nbsp;in&nbsp;the&nbsp;file.&lt;br&gt;<br>
&lt;br&gt;<br>
Also&nbsp;keep&nbsp;in&nbsp;mind&nbsp;that&nbsp;.NET&nbsp;strings&nbsp;are&nbsp;UTF-16,&nbsp;so&nbsp;if&nbsp;your&nbsp;input&nbsp;text&nbsp;is&lt;br&gt;<br>
ASCII,&nbsp;you&nbsp;will&nbsp;require&nbsp;twice&nbsp;as&nbsp;much&nbsp;RAM&nbsp;as&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;file,&nbsp;e.g.&lt;br&gt;<br>
600MB&nbsp;of&nbsp;RAM&nbsp;to&nbsp;store&nbsp;the&nbsp;entire&nbsp;file&nbsp;as&nbsp;a&nbsp;string.&nbsp; (Then&nbsp;there&nbsp;is&lt;br&gt;<br>
various&nbsp;object&nbsp;overhead&nbsp;considerations,&nbsp;but&nbsp;these&nbsp;are&nbsp;likely&nbsp;tiny&lt;br&gt;<br>
compared&nbsp;to&nbsp;the&nbsp;300MB&nbsp;you&amp;#39;re&nbsp;looking&nbsp;at.)&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;stopped&nbsp;using&nbsp;classes&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;store&nbsp;the&nbsp;data&nbsp;and&nbsp;went&nbsp;with&nbsp;List&amp;lt;string&amp;gt;&nbsp;and&nbsp;List&amp;lt;string[]&amp;gt;&nbsp;to&nbsp;read&nbsp;in&nbsp;this&lt;br&gt;<br>
&amp;gt;&nbsp;much&nbsp;data.&nbsp; Any&nbsp;comments&nbsp;on&nbsp;how&nbsp;I&nbsp;might&nbsp;improve&nbsp;this&nbsp;performance&nbsp;would&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;appreciated.&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;provide&nbsp;any&nbsp;comments&nbsp;we&amp;#39;d&nbsp;need&nbsp;to&nbsp;know&nbsp;more&nbsp;about&nbsp;what&nbsp;you&amp;#39;re&nbsp;trying&lt;br&gt;<br>
to&nbsp;do.&nbsp; For&nbsp;example,&nbsp;reading&nbsp;a&nbsp;300MB&nbsp;XML&nbsp;file&nbsp;using&nbsp;XmlDocument&nbsp;will&lt;br&gt;<br>
require&nbsp;*lots*&nbsp;of&nbsp;RAM,&nbsp;as&nbsp;in&nbsp;addition&nbsp;to&nbsp;the&nbsp;UTF-16&nbsp;string&nbsp;issue,&nbsp;each&lt;br&gt;<br>
element,&nbsp;attribute,&nbsp;etc.&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;separate&nbsp;objects,&nbsp;with&lt;br&gt;<br>
varying&nbsp;amounts&nbsp;of&nbsp;memory&nbsp;required.&nbsp; DOM&nbsp;would&nbsp;be&nbsp;something&nbsp;to&nbsp;avoid&lt;br&gt;<br>
here,&nbsp;while&nbsp;XmlReader&nbsp;would&nbsp;be&nbsp;much&nbsp;better.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;easiest&nbsp;question,&nbsp;though,&nbsp;is&nbsp;this:&nbsp;do&nbsp;you&nbsp;really&nbsp;need&nbsp;to&nbsp;keep&nbsp;the&lt;br&gt;<br>
entire&nbsp;file&nbsp;contents&nbsp;in&nbsp;memory&nbsp;all&nbsp;at&nbsp;once?&lt;br&gt;<br>
&lt;br&gt;<br>
Or&nbsp;can&nbsp;you&nbsp;instead&nbsp;process&nbsp;each&nbsp;line&nbsp;independently&nbsp;(or&nbsp;while&nbsp;caching&lt;br&gt;<br>
minimal&nbsp;data&nbsp;from&nbsp;one&nbsp;line&nbsp;to&nbsp;the&nbsp;next,&nbsp;so&nbsp;that&nbsp;the&nbsp;contents&nbsp;of&nbsp;previous&lt;br&gt;<br>
lines&nbsp;don&amp;#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;maintained).&nbsp; This&nbsp;would&nbsp;allow&nbsp;you&nbsp;to&nbsp;remove&nbsp;your&lt;br&gt;<br>
List&amp;lt;string&amp;gt;,&nbsp;and&nbsp;save&nbsp;a&nbsp;ton&nbsp;of&nbsp;memory.&lt;br&gt;<br>
&lt;br&gt;<br>
-&nbsp;Jon&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-list&nbsp;maillist&nbsp; -&nbsp; &lt;a&nbsp;href=&quot;mailto:Mono-list@lists.ximian.com&quot;&gt;Mono-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
