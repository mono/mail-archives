<tt>
Hello,&lt;br&gt;&lt;br&gt;maybe&nbsp;someone&nbsp;can&nbsp;help&nbsp;with&nbsp;this&nbsp;problem.&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;a&nbsp;c#&nbsp;application&nbsp;which&nbsp;is&nbsp;copying&nbsp;a&nbsp;lot&nbsp;of&nbsp;data&nbsp;from&nbsp;one&nbsp;sql-server&nbsp;to&nbsp;an&nbsp;other&nbsp;one&nbsp;-&nbsp;along&nbsp;with&nbsp;doing&nbsp;some&nbsp;re-structuring&nbsp;of&nbsp;data.&nbsp;So&nbsp;there&nbsp;are&nbsp;a&nbsp;lot&nbsp;of&nbsp;sql-statements&nbsp;and&nbsp;stored&nbsp;procedures&nbsp;invoked,&nbsp;transactions&nbsp;are&nbsp;used,&nbsp;too.&nbsp;&lt;br&gt;<br>
After&nbsp;a&nbsp;certain&nbsp;time&nbsp;i&nbsp;get&nbsp;the&nbsp;following&nbsp;exception:&lt;br&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Unhandled&nbsp;Exception:&nbsp;<br>
Mono.Data.Tds.Protocol.TdsInternalException:&nbsp;Server&nbsp;closed&nbsp;the&nbsp;connection.&nbsp;<br>
---&amp;gt;&nbsp;System.IO.IOException:&nbsp;Write&nbsp;failure&nbsp;---&amp;gt;&nbsp;<br>
System.Net.Sockets.SocketException:&nbsp;The&nbsp;socket&nbsp;has&nbsp;been&nbsp;shut&nbsp;down&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;System.Net.Sockets.Socket.Send&nbsp;(System.Byte[]&nbsp;buf,&nbsp;Int32&nbsp;<br>
offset,&nbsp;Int32&nbsp;size,&nbsp;SocketFlags&nbsp;flags)&nbsp;[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;System.Net.Sockets.NetworkStream.Write&nbsp;(System.Byte[]&nbsp;<br>
buffer,&nbsp;Int32&nbsp;offset,&nbsp;Int32&nbsp;size)&nbsp;[0x00000]&nbsp;---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;<br>
trace&nbsp;---&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;System.Net.Sockets.NetworkStream.Write&nbsp;(System.Byte[]&nbsp;<br>
buffer,&nbsp;Int32&nbsp;offset,&nbsp;Int32&nbsp;size)&nbsp;[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Mono.Data.Tds.Protocol.TdsComm.SendPhysicalPacket&nbsp;<br>
(Boolean&nbsp;isLastSegment)&nbsp;[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Mono.Data.Tds.Protocol.TdsComm.SendPacket&nbsp;()&nbsp;<br>
[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Mono.Data.Tds.Protocol.Tds.ExecuteQuery&nbsp;(System.String&nbsp;<br>
sql,&nbsp;Int32&nbsp;timeout,&nbsp;Boolean&nbsp;wantResults)&nbsp;[0x00000]&nbsp;---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;<br>
stack&nbsp;trace&nbsp;---&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Mono.Data.Tds.Protocol.Tds.ExecuteQuery&nbsp;(System.String&nbsp;<br>
sql,&nbsp;Int32&nbsp;timeout,&nbsp;Boolean&nbsp;wantResults)&nbsp;[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Mono.Data.Tds.Protocol.Tds70.Execute&nbsp;(System.String&nbsp;<br>
commandText,&nbsp;Mono.Data.Tds.TdsMetaParameterCollection&nbsp;parameters,&nbsp;Int32&nbsp;timeout,&nbsp;<br>
Boolean&nbsp;wantResults)&nbsp;[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Mono.Data.Tds.Protocol.Tds.Execute&nbsp;(System.String&nbsp;sql)&nbsp;<br>
[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;System.Data.SqlClient.SqlTransaction.Rollback&nbsp;<br>
(System.String&nbsp;transactionName)&nbsp;[0x00000]&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;System.Data.SqlClient.SqlTransaction.Rollback&nbsp;()&nbsp;<br>
[0x00000]&lt;/p&gt;It&nbsp;always&nbsp;happens&nbsp;at&nbsp;the&nbsp;same&nbsp;record&nbsp;-&nbsp;if&nbsp;i&nbsp;remove&nbsp;the&nbsp;record&nbsp;-&nbsp;it&nbsp;happens&nbsp;with&nbsp;the&nbsp;next&nbsp;...&nbsp;so&nbsp;it&nbsp;seems&nbsp;not&nbsp;to&nbsp;be&nbsp;related&nbsp;to&nbsp;the&nbsp;record&nbsp;itself,&nbsp;but&nbsp;more&nbsp;or&nbsp;less&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;already&nbsp;processed&nbsp;records.&nbsp;&lt;br&gt;<br>
&lt;br&gt;At&nbsp;the&nbsp;sql-server&nbsp;i&nbsp;see&nbsp;a&nbsp;message&nbsp;&amp;quot;invalid&nbsp;buffer&nbsp;from&nbsp;client,&nbsp;error&nbsp;17805,&nbsp;severity&nbsp;20,&nbsp;status&nbsp;3&amp;quot;.&lt;br&gt;&lt;br&gt;The&nbsp;code&nbsp;itself&nbsp;runs&nbsp;well&nbsp;under&nbsp;windows&nbsp;with&nbsp;.net&nbsp;...&nbsp;on&nbsp;linux&nbsp;(centos&nbsp;4.5)&nbsp;using&nbsp;mono&nbsp;1.4,&nbsp;1.5&nbsp;and&nbsp;1.9&nbsp;it&nbsp;crashes.&nbsp;The&nbsp;machine&nbsp;should&nbsp;have&nbsp;enough&nbsp;memory,&nbsp;etc.&nbsp;The&nbsp;code&nbsp;was&nbsp;compiled&nbsp;with&nbsp;visual&nbsp;studio&nbsp;2005&nbsp;-&nbsp;and&nbsp;then&nbsp;copied&nbsp;over&nbsp;to&nbsp;a&nbsp;linux&nbsp;machine.&lt;br&gt;<br>
&lt;br&gt;Does&nbsp;anyone&nbsp;have&nbsp;an&nbsp;idea&nbsp;what&nbsp;the&nbsp;reason&nbsp;can&nbsp;be&nbsp;-&nbsp;or&nbsp;how&nbsp;this&nbsp;can&nbsp;be&nbsp;solved?&lt;br&gt;&lt;br&gt;thank&nbsp;you&lt;br&gt;CH&lt;br&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;br&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;br&gt;<br>

</tt>
