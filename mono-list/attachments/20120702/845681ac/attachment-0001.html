<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;style&gt;<br>
&lt;!--<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri}<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0cm;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{color:blue;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{color:purple;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline}<br>
span.E-MailFormatvorlage17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:70.85pt&nbsp;70.85pt&nbsp;2.0cm&nbsp;70.85pt}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{}<br>
--&gt;<br>
&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;lang=&quot;DE-CH&quot;&nbsp;link=&quot;blue&quot;&nbsp;vlink=&quot;purple&quot;&gt;<br>
&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Hello&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Since&nbsp;the&nbsp;Flashplugin&nbsp;is&nbsp;not&nbsp;very&nbsp;stable&nbsp;and&nbsp;on&nbsp;top&nbsp;of&nbsp;that&nbsp;leaks&nbsp;memory&nbsp;in&nbsp;long&nbsp;term&nbsp;use&nbsp;we&nbsp;try&nbsp;to&nbsp;run&nbsp;this&nbsp;critical&nbsp;part&nbsp;in&nbsp;a&nbsp;seperate&nbsp;AppDomain.&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;While&nbsp;creating&nbsp;and&nbsp;interacting&nbsp;with&nbsp;this&nbsp;window&nbsp;works&nbsp;fine,&nbsp;unloading&nbsp;the&nbsp;updomain&nbsp;causes&nbsp;the&nbsp;whole&nbsp;app&nbsp;to&nbsp;crash.&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Since&nbsp;the&nbsp;unload&nbsp;works&nbsp;when&nbsp;i&nbsp;remove&nbsp;the&nbsp;Gtk.Window&nbsp;from&nbsp;the&nbsp;marshal&nbsp;object&nbsp;i&nbsp;can&nbsp;confirm&nbsp;this&nbsp;problem&nbsp;to&nbsp;be&nbsp;Gtk&nbsp;related&nbsp;(GTK&nbsp;Sharp)<br>
&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Run&nbsp;on&nbsp;Ubuntu&nbsp;11.4&nbsp;and&nbsp;12.4.&nbsp;This&nbsp;Bug&nbsp;seems&nbsp;to&nbsp;be&nbsp;known&nbsp;since&nbsp;2004.&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Running&nbsp;this&nbsp;sample&nbsp;every&nbsp;x&nbsp;seconds&nbsp;(loop)&nbsp;should&nbsp;just&nbsp;open&nbsp;a&nbsp;new&nbsp;window&nbsp;every&nbsp;x&nbsp;seconds&nbsp;while&nbsp;closing&nbsp;and&nbsp;destroying&nbsp;the&nbsp;other.&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Any&nbsp;idey&nbsp;how&nbsp;i&nbsp;could&nbsp;accomplish&nbsp;this?&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;What&nbsp;i&nbsp;do:&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;#################################################&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;#####&nbsp;Class&nbsp;to&nbsp;run&nbsp;in&nbsp;other&nbsp;AppDomain&nbsp;and&nbsp;ist&nbsp;proxy&nbsp;class&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;#################################################&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;public&nbsp;class&nbsp;Fanta&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;{&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;string&nbsp;s;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;//&nbsp;commenting&nbsp;this&nbsp;line&nbsp;out&nbsp;will&nbsp;cause&nbsp;the&nbsp;example&nbsp;to&nbsp;work!<br>
&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;Gtk.Window&nbsp;w&nbsp;=&nbsp;new&nbsp;Gtk.Window(Gtk.WindowType.Toplevel);&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;public&nbsp;Fanta(){&nbsp;s&nbsp;=&nbsp;&quot;blubb&quot;;&nbsp;}&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;public&nbsp;void&nbsp;echoS(){&nbsp;Console.WriteLine(&nbsp;s&nbsp;);}&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;}&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;public&nbsp;class&nbsp;FantaProxy&nbsp;:&nbsp;MarshalByRefObject&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;{&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;Fanta&nbsp;f&nbsp;=&nbsp;new&nbsp;Fanta();&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;public&nbsp;void&nbsp;echoS(){&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;f.GetType().InvokeMember(&quot;echoS&quot;,&nbsp;BindingFlags.InvokeMethod,&nbsp;null,&nbsp;f,&nbsp;null&nbsp;);&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;}&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;}&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;#################################################&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;#####&nbsp;Code&nbsp;which&nbsp;causes&nbsp;the&nbsp;app&nbsp;to&nbsp;exit&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;#################################################&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;//&nbsp;d&nbsp;is&nbsp;a&nbsp;gobal&nbsp;AppDomain&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;//&nbsp;fp&nbsp;is&nbsp;FantaProxy&nbsp;&nbsp;Type&nbsp;(also&nbsp;global)&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;d&nbsp;=&nbsp;AppDomain.CreateDomain(&nbsp;&quot;FantaD&quot;);&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;string&nbsp;currentAssemblyPath&nbsp;=&nbsp;Assembly.GetExecutingAssembly().Location;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;fp&nbsp;=&nbsp;d.CreateInstanceFromAndUnwrap(&nbsp;currentAssemblyPath,&nbsp;&quot;AppDomainTest.FantaProxy&quot;&nbsp;)&nbsp;as&nbsp;FantaProxy;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;fp.echoS();&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;AppDomain.Unload(&nbsp;d&nbsp;);&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif;&nbsp;font-size:8pt;&nbsp;color:rgb(132,132,132)&quot;&gt;Diese&nbsp;E-Mail&nbsp;und&nbsp;ihre&nbsp;Anh&auml;nge&nbsp;enthalten&nbsp;vertrauliche&nbsp;und/oder&nbsp;rechtlich&nbsp;gesch&uuml;tzte&nbsp;Informationen.&nbsp;Wenn&nbsp;Sie&nbsp;nicht&nbsp;der&nbsp;richtige&nbsp;Adressat&nbsp;sind&nbsp;oder&nbsp;diese&nbsp;E-Mail&nbsp;irrt&uuml;mlich<br>
&nbsp;erhalten&nbsp;haben,&nbsp;informieren&nbsp;Sie&nbsp;bitte&nbsp;sofort&nbsp;den&nbsp;Absender&nbsp;und&nbsp;vernichten&nbsp;Sie&nbsp;diese&nbsp;Mail&nbsp;inklusive&nbsp;Anh&auml;nge.&nbsp;Das&nbsp;unerlaubte&nbsp;Kopieren&nbsp;sowie&nbsp;die&nbsp;unbefugte&nbsp;Weitergabe&nbsp;der&nbsp;Inhalte&nbsp;dieser&nbsp;Mail&nbsp;ist&nbsp;nicht&nbsp;gestattet.<br>
&lt;br&gt;<br>
This&nbsp;e-mail&nbsp;and&nbsp;any&nbsp;attachments&nbsp;may&nbsp;contain&nbsp;confidential&nbsp;and/or&nbsp;privileged&nbsp;information.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient&nbsp;(or&nbsp;have&nbsp;received&nbsp;this&nbsp;e-mail&nbsp;in&nbsp;error)&nbsp;please&nbsp;notify&nbsp;the&nbsp;sender&nbsp;immediately&nbsp;and&nbsp;destroy&nbsp;this&nbsp;e-mail&nbsp;including&nbsp;the&nbsp;attachments.&nbsp;Any<br>
&nbsp;unauthorized&nbsp;copying,&nbsp;disclosure&nbsp;or&nbsp;distribution&nbsp;of&nbsp;the&nbsp;material&nbsp;in&nbsp;this&nbsp;e-mail&nbsp;is&nbsp;strictly&nbsp;forbidden.&lt;/span&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
