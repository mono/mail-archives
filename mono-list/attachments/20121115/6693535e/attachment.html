<tt>
Hi<br>
<br>
I've&nbsp;processed&nbsp;a&nbsp;XML&nbsp;file&nbsp;with&nbsp;XMLDocument(&quot;filename&quot;)&nbsp;under&nbsp;Windows&nbsp;7.&nbsp;After&nbsp;several&nbsp;seconds&nbsp;an&nbsp;error&nbsp;(Fatal&nbsp;error&nbsp;in&nbsp;gc:&nbsp;To&nbsp;many&nbsp;heap&nbsp;sections)&nbsp;occured.&nbsp;The&nbsp;XML&nbsp;file&nbsp;size&nbsp;is&nbsp;~130MB.<br>
So&nbsp;I&nbsp;changed&nbsp;the&nbsp;code&nbsp;to&nbsp;use&nbsp;XMLReader(&quot;filename&quot;)&nbsp;and&nbsp;counted&nbsp;the&nbsp;elments&nbsp;(5448&nbsp;elements&nbsp;named&nbsp;&quot;Artikel&quot;).<br>
The&nbsp;whole&nbsp;operation&nbsp;was&nbsp;done&nbsp;in&nbsp;~6&nbsp;sec.&nbsp;With&nbsp;MS.NET&nbsp;instead&nbsp;of&nbsp;Mono&nbsp;the&nbsp;operation&nbsp;was&nbsp;done&nbsp;in&nbsp;~1.3&nbsp;sec.&nbsp;As&nbsp;I&nbsp;started&nbsp;the&nbsp;program&nbsp;(with&nbsp;MS.NET)&nbsp;after&nbsp;a&nbsp;reboot,&nbsp;the&nbsp;operation&nbsp;was&nbsp;done&nbsp;in&nbsp;~4.8sec.&nbsp;But&nbsp;with&nbsp;the&nbsp;next&nbsp;execution&nbsp;of&nbsp;the&nbsp;program&nbsp;the&nbsp;execution&nbsp;time&nbsp;was&nbsp;again&nbsp;at&nbsp;~1.35&nbsp;sec.<br>
<br>
After&nbsp;some&nbsp;web&nbsp;search&nbsp;I&nbsp;found&nbsp;the&nbsp;FileOptions&nbsp;(0x20000000&nbsp;//&nbsp;FILE_FLAG_NO_BUFFERING).&nbsp;Using&nbsp;this&nbsp;option&nbsp;for&nbsp;a&nbsp;FileStream&nbsp;the&nbsp;execution&nbsp;time&nbsp;under&nbsp;MS.NET&nbsp;is&nbsp;now&nbsp;~5&nbsp;sec.&nbsp;I've&nbsp;tested&nbsp;other&nbsp;options&nbsp;but&nbsp;they&nbsp;have&nbsp;no&nbsp;effect&nbsp;for&nbsp;Mono.<br>
<br>
Code:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;int&nbsp;ProcessXMLReader(string&nbsp;filePath,&nbsp;bool&nbsp;useCache)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;articles&nbsp;=&nbsp;0;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;options&nbsp;=&nbsp;FileOptions.None;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(useCache&nbsp;==&nbsp;false)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options&nbsp;=&nbsp;(FileOptions)0x20000000;&nbsp;//&nbsp;FILE_FLAG_NO_BUFFERING<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;(var&nbsp;fStream&nbsp;=&nbsp;new&nbsp;FileStream(filePath,&nbsp;FileMode.Open,&nbsp;FileAccess.Read,&nbsp;FileShare.None,&nbsp;512,&nbsp;options))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;reader&nbsp;=&nbsp;XmlReader.Create(fStream);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(!reader.EOF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(reader.Read())<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(reader.NodeType&nbsp;==&nbsp;XmlNodeType.Element&nbsp;&amp;&amp;&nbsp;reader.LocalName&nbsp;==&nbsp;&quot;Artikel&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;articles++;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;articles;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;br/&gt;&lt;hr&nbsp;align=&quot;left&quot;&nbsp;width=&quot;300&quot;&nbsp;/&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/FileStream-performance-under-Windows-tp4657397.html&quot;&gt;FileStream&nbsp;performance&nbsp;under&nbsp;Windows&lt;/a&gt;&lt;br/&gt;<br>
Sent&nbsp;from&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/Mono-General-f1490591.html&quot;&gt;Mono&nbsp;-&nbsp;General&nbsp;mailing&nbsp;list&nbsp;archive&lt;/a&gt;&nbsp;at&nbsp;Nabble.com.&lt;br/&gt;
</tt>
