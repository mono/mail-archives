<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sat,&nbsp;Feb&nbsp;27,&nbsp;2010&nbsp;at&nbsp;8:43&nbsp;PM,&nbsp;James&nbsp;Mansion&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:james@mansionfamily.plus.com&quot;&gt;james@mansionfamily.plus.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;Rodrigo&nbsp;Kumpera&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
 The&nbsp;differences&nbsp;are&nbsp;in&nbsp;areas&nbsp;such&nbsp;as&nbsp;synchronization&nbsp;and&nbsp;thread-local&nbsp;access.&lt;br&gt;<br>
We&nbsp;can&nbsp;generate&nbsp;more&nbsp;efficient&nbsp;thread-local&nbsp;access&nbsp;code&nbsp;on&nbsp;linux&nbsp;than&nbsp;on&nbsp;windows,&lt;br&gt;<br>
for&nbsp;example.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>
Well,&nbsp;aside&nbsp;from&nbsp;whether&nbsp;it&nbsp;is&nbsp;necessary&nbsp;for&nbsp;the&nbsp;majority&nbsp;of&nbsp;allocations&nbsp;to&nbsp;use&lt;br&gt;<br>
synchronisation&nbsp;in&nbsp;a&nbsp;modern&nbsp;VM&nbsp;(which&nbsp;I&nbsp;doubt)&nbsp;I&nbsp;think&nbsp;there&nbsp;is&nbsp;little&nbsp;reason&lt;br&gt;<br>
why&nbsp;TLS&nbsp;should&nbsp;be&nbsp;materially&nbsp;slower&nbsp;-&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;have&nbsp;to&nbsp;use&nbsp;the&nbsp;raw&nbsp;OS&nbsp;facility&lt;br&gt;<br>
and&nbsp;can&nbsp;use&nbsp;something&nbsp;closer&nbsp;to&nbsp;what&nbsp;the&nbsp;compilers&nbsp;do&nbsp;with&nbsp;compiler&nbsp;TLS,&nbsp;after&lt;br&gt;<br>
all.&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;Maybe&nbsp;you&nbsp;should&nbsp;look&nbsp;into&nbsp;what&nbsp;mono&nbsp;does&nbsp;before&nbsp;you&nbsp;talk&nbsp;about&nbsp;it.&nbsp;Mono&nbsp;does&nbsp;generate&nbsp;the&nbsp;same&lt;br&gt;assembly&nbsp;as&nbsp;GCC&nbsp;does&nbsp;for&nbsp;TLS&nbsp;access&nbsp;on&nbsp;x86/amd64.&nbsp;It&nbsp;can&nbsp;generate&nbsp;similar&nbsp;code&nbsp;on&nbsp;windows&nbsp;if&nbsp;the&lt;br&gt;<br>
compiler&nbsp;support&nbsp;the&nbsp;__thread&nbsp;directive,&nbsp;which&nbsp;is&nbsp;not&nbsp;always&nbsp;available.&lt;br&gt;&lt;br&gt;And&nbsp;it&nbsp;has&nbsp;to&nbsp;use&nbsp;what&nbsp;the&nbsp;OS&nbsp;provides&nbsp;in&nbsp;some&nbsp;cases,&nbsp;such&nbsp;as&nbsp;OSX,&nbsp;because&nbsp;there&nbsp;is&nbsp;no&nbsp;ABI&nbsp;for&nbsp;TLS.&lt;br&gt;&lt;br&gt; &lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
Sure,&nbsp;but&nbsp;the&nbsp;code&nbsp;we&nbsp;were&nbsp;shown&nbsp;shouldn&amp;#39;t&nbsp;be&nbsp;doing&nbsp;native&nbsp;calls,&nbsp;and&nbsp;Mono&nbsp;has&nbsp;thread&lt;br&gt;<br>
local&nbsp;allocator&nbsp;support&nbsp;-&nbsp;and&nbsp;that&nbsp;certainly&nbsp;doesn&amp;#39;t&nbsp;have&nbsp;problems&nbsp;for&nbsp;the&nbsp;JVM&nbsp;on&lt;br&gt;<br>
Windows.&nbsp; Smells&nbsp;wrong&nbsp;to&nbsp;me.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;Mono&nbsp;only&nbsp;uses&nbsp;boehm&nbsp;thread&nbsp;local&nbsp;allocators&nbsp;under&nbsp;linux.&nbsp;And,&nbsp;as&nbsp;I&nbsp;mentioned&nbsp;before,&nbsp;this&nbsp;is&nbsp;because&lt;br&gt;mono&nbsp;is&nbsp;better&nbsp;optimized&nbsp;on&nbsp;linux&nbsp;-&nbsp;we&nbsp;spend&nbsp;considerably&nbsp;less&nbsp;time&nbsp;on&nbsp;the&nbsp;windows&nbsp;port&nbsp;than&nbsp;on&nbsp;linux.&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;<br>

</tt>
