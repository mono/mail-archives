<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.30.3&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
Hi&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;have&nbsp;a&nbsp;issue&nbsp;with&nbsp;the&nbsp;Response.WriteFile(string&nbsp;filename)&nbsp;in&nbsp;the&nbsp;HttpResponse,&nbsp;since&nbsp;I&nbsp;updated&nbsp;to&nbsp;2.10.1.&nbsp;I&nbsp;use&nbsp;to&nbsp;add&nbsp;a&nbsp;full&nbsp;rooted&nbsp;path&nbsp;to&nbsp;this&nbsp;method,&nbsp;without&nbsp;problems,&nbsp;but&nbsp;if&nbsp;I&nbsp;do&nbsp;that&nbsp;now,&nbsp;it&nbsp;will&nbsp;add&nbsp;my&nbsp;application&nbsp;path&nbsp;to&nbsp;it.&nbsp;Looking&nbsp;at&nbsp;the&nbsp;code,&nbsp;I&nbsp;see&nbsp;there&nbsp;is&nbsp;a&nbsp;GetNormalizedFileName,&nbsp;which&nbsp;checks&nbsp;nicely&nbsp;if&nbsp;its&nbsp;a&nbsp;windows&nbsp;path&nbsp;or&nbsp;an&nbsp;unc&nbsp;path,&nbsp;but&nbsp;it&nbsp;wont&nbsp;check&nbsp;if&nbsp;its&nbsp;a&nbsp;unix&nbsp;path.&nbsp;I&nbsp;guess&nbsp;this&nbsp;is&nbsp;not&nbsp;preferred&nbsp;behavior&nbsp;for&nbsp;Linux&nbsp;systems.&nbsp;&lt;BR&gt;<br>
&lt;BR&gt;<br>
This&nbsp;is&nbsp;what&nbsp;happens&nbsp;in&nbsp;my&nbsp;case:&nbsp;I&nbsp;call&nbsp;my&nbsp;download&nbsp;method&nbsp;with&nbsp;the&nbsp;following&nbsp;path:&lt;BR&gt;<br>
&lt;BR&gt;<br>
/home/willowmedia/wingsofdeath/wod_storage/55/1&lt;BR&gt;<br>
&lt;BR&gt;<br>
and&nbsp;then&nbsp;on&nbsp;Response.WriteFile()&nbsp;I&nbsp;get&nbsp;this&nbsp;exception:&lt;BR&gt;<br>
&lt;BR&gt;<br>
[02-03-2011&nbsp;11:48:25|7]&nbsp;ClientResponse.DownloadFile:Exception=Could&nbsp;not&nbsp;find&nbsp;file&nbsp;&amp;quot;&lt;I&gt;&lt;B&gt;/home/willowmedia/wingsofdeath/www/home/willowmedia/wingsofdeath/wod_storage/55/1&lt;/B&gt;&lt;/I&gt;&amp;quot;.&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;System.IO.FileInfo.get_Length&nbsp;()&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;System.IO.FileInfo:get_Length&nbsp;()&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;System.Web.HttpResponse.WriteFile&nbsp;(System.String&nbsp;filename,&nbsp;Boolean&nbsp;readIntoMemory)&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;System.Web.HttpResponse.WriteFile&nbsp;(System.String&nbsp;filename)&nbsp;[0x00000]&nbsp;in&nbsp;&amp;lt;filename&nbsp;unknown&amp;gt;:0&nbsp;&lt;BR&gt;<br>
&lt;BR&gt;<br>
/home/willowmedia/wingsofdeath/www&nbsp;is&nbsp;my&nbsp;application&nbsp;path&nbsp;in&nbsp;this&nbsp;case.&nbsp;My&nbsp;solution&nbsp;is&nbsp;to&nbsp;check&nbsp;if&nbsp;the&nbsp;file&nbsp;exists&nbsp;in&nbsp;the&nbsp;normalize&nbsp;method:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;string&nbsp;GetNormalizedFileName&nbsp;(string&nbsp;fn)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(String.IsNullOrEmpty&nbsp;(fn))&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;fn;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;I&gt;&lt;B&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(File.Exists(fn))&lt;/B&gt;&lt;/I&gt;&lt;BR&gt;<br>
&lt;I&gt;&lt;B&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;fn;&lt;/B&gt;&lt;/I&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;On&nbsp;Linux&nbsp;we&nbsp;don't&nbsp;change&nbsp;\&nbsp;to&nbsp;/&nbsp;since&nbsp;filenames&nbsp;with&nbsp;\&nbsp;are&nbsp;valid.&nbsp;We&nbsp;also&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;don't&nbsp;remove&nbsp;drive:&nbsp;designator&nbsp;for&nbsp;the&nbsp;same&nbsp;reason.&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;len&nbsp;=&nbsp;fn.Length;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(len&nbsp;&amp;gt;=&nbsp;3&nbsp;&amp;amp;&amp;amp;&nbsp;fn&nbsp;[1]&nbsp;==&nbsp;':'&nbsp;&amp;amp;&amp;amp;&nbsp;IsFileSystemDirSeparator&nbsp;(fn&nbsp;[2]))&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;Path.GetFullPath&nbsp;(fn);&nbsp;//&nbsp;drive-qualified&nbsp;absolute&nbsp;file&nbsp;path&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(len&nbsp;&amp;gt;=&nbsp;2&nbsp;&amp;amp;&amp;amp;&nbsp;IsFileSystemDirSeparator&nbsp;(fn&nbsp;[0])&nbsp;&amp;amp;&amp;amp;&nbsp;IsFileSystemDirSeparator&nbsp;(fn&nbsp;[1]))&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;Path.GetFullPath&nbsp;(fn);&nbsp;//&nbsp;UNC&nbsp;path&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;HttpContext&nbsp;ctx&nbsp;=&nbsp;context&nbsp;??&nbsp;HttpContext.Current;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;HttpRequest&nbsp;req&nbsp;=&nbsp;ctx&nbsp;!=&nbsp;null&nbsp;?&nbsp;ctx.Request&nbsp;:&nbsp;null;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(req&nbsp;!=&nbsp;null)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;req.MapPath&nbsp;(fn);&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;fn;&nbsp;//&nbsp;Or&nbsp;should&nbsp;we&nbsp;rather&nbsp;throw?&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;BR&gt;<br>
&lt;BR&gt;<br>
But&nbsp;I'm&nbsp;not&nbsp;sure&nbsp;if&nbsp;that&nbsp;would&nbsp;be&nbsp;a&nbsp;solution&nbsp;for&nbsp;everyone.&nbsp;If&nbsp;I&nbsp;would&nbsp;want&nbsp;to&nbsp;report&nbsp;a&nbsp;bug&nbsp;on&nbsp;it,&nbsp;in&nbsp;which&nbsp;product&nbsp;should&nbsp;this&nbsp;be&nbsp;added?&nbsp;'Mono:&nbsp;Class&nbsp;libraries'?&lt;BR&gt;<br>
&lt;BR&gt;<br>
Cheers&lt;BR&gt;<br>
&lt;BR&gt;<br>
Peter<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
