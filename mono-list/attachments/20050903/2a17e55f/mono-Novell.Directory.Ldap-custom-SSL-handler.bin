Index: Novell.Directory.Ldap/Connection.cs
===================================================================
--- Novell.Directory.Ldap/Connection.cs	(revision 49390)
+++ Novell.Directory.Ldap/Connection.cs	(working copy)
@@ -281,6 +281,17 @@
 			}
 			
 		}
+
+		/// <summary> 
+		/// Sets the SSL certificate validation handler
+		/// </summary>
+		internal CertificateValidationCallback SSLHandler
+		{
+			set 
+			{ 
+				sslHandler = value; 
+			}
+		}
 		
 		private System.Object writeSemaphore;
 		private int writeSemaphoreOwner = 0;
@@ -353,6 +364,9 @@
 		private static System.Object nameLock; // protect connNum
 		private static int connNum = 0;
 		
+		// SSL certificate validation handler
+		private CertificateValidationCallback sslHandler;
+
 		// These attributes can be retreived using the getProperty
 		// method in LdapConnection.  Future releases might require
 		// these to be local variables that can be modified using
@@ -701,7 +715,12 @@
 											host,
 											false,
 											Mono.Security.Protocol.Tls.SecurityProtocolType.Ssl3|Mono.Security.Protocol.Tls.SecurityProtocolType.Tls);
-						sslstream.ServerCertValidationDelegate += new CertificateValidationCallback(ServerCertificateValidation);
+						
+						if (sslHandler != null)
+							sslstream.ServerCertValidationDelegate += sslHandler;
+						else
+							sslstream.ServerCertValidationDelegate += new CertificateValidationCallback(ServerCertificateValidation);
+
 //						byte[] buffer = new byte[0];
 //						sslstream.Read(buffer, 0, buffer.Length);
 //						sslstream.doHandshake();												
Index: Novell.Directory.Ldap/LdapConnection.cs
===================================================================
--- Novell.Directory.Ldap/LdapConnection.cs	(revision 49390)
+++ Novell.Directory.Ldap/LdapConnection.cs	(working copy)
@@ -439,6 +439,16 @@
 			}
 			
 		}
+		/// <summary>Sets the handler for SSL certificate validation.
+	        /// </summary>
+        	virtual public CertificateValidationCallback SSLHandler
+        	{
+            		set 
+			{
+		                conn.SSLHandler = value;
+            		}
+            
+        	}
 		/// <summary> Return the Connection object associated with this LdapConnection
 		/// 
 		/// </summary>
Index: ChangeLog
===================================================================
--- ChangeLog	(revision 49390)
+++ ChangeLog	(working copy)
@@ -1,3 +1,10 @@
+2005-03-09  Loren Bandiera <lorenb@mmgsecurity.com>
+	* LdapConnection.cs: 
+		- Added new property for SSL certificate validation callback
+	* Connection.cs:
+		- Added new property for SSL certificate validation callback
+		- connect uses SSL handler if set; otherwise it defaults to Connection.ServerCertificateValidation ()
+
 2005-14-08  Boris Kirzner <borisk@mainsoft.com>
 	* LdapConnection.cs: 
 		- Values from app settings are not stored anymore in app domain.
