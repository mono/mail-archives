<tt>
Hi&nbsp;all,&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;having&nbsp;trouble&nbsp;coaxing&nbsp;Mono&nbsp;to&nbsp;connect&nbsp;to&nbsp;Google&nbsp;via&nbsp;SSL&nbsp;(specifically&nbsp;to&nbsp;do&nbsp;OpenID&nbsp;verification). &nbsp;Because&nbsp;this&nbsp;is&nbsp;a&nbsp;security&nbsp;protocol,&nbsp;I&nbsp;don&amp;#39;t&nbsp;want&nbsp;to&nbsp;implement&nbsp;the&nbsp;&amp;quot;always&nbsp;return&nbsp;true&amp;quot;&nbsp;certificate&nbsp;checking&nbsp;policy&nbsp;in&nbsp;my&nbsp;application. &nbsp;I&amp;#39;ve&nbsp;imported&nbsp;the&nbsp;Mozilla&nbsp;root&nbsp;certificates,&nbsp;and&nbsp;I&amp;#39;ve&nbsp;tried&nbsp;getting&nbsp;the&nbsp;certificate&nbsp;with&nbsp;certmgr&nbsp;-ssl,&nbsp;but&nbsp;there&nbsp;just&nbsp;seems&nbsp;to&nbsp;be&nbsp;something&nbsp;wrong&nbsp;with&nbsp;it&nbsp;that&nbsp;Mono&nbsp;doesn&amp;#39;t&nbsp;like.&lt;br&gt;<br>
&lt;br&gt;Running&nbsp;a0.exe&nbsp;(from&nbsp;&lt;a&nbsp;href=&quot;http://www.mono-project.com/UsingTrustedRootsRespectfully&quot;&gt;http://www.mono-project.com/UsingTrustedRootsRespectfully&lt;/a&gt;),&nbsp;which&nbsp;just&nbsp;creates&nbsp;a&nbsp;WebRequest,&nbsp;I&nbsp;get&nbsp;this&nbsp;result:&lt;br&gt;&lt;br&gt;user@host:~$&nbsp;mono&nbsp;a0.exe&nbsp;&lt;a&nbsp;href=&quot;https://www.google.com/accounts/o8/id&quot;&gt;https://www.google.com/accounts/o8/id&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;Unhandled&nbsp;Exception:&nbsp;System.Net.WebException:&nbsp;Error&nbsp;getting&nbsp;response&nbsp;stream&nbsp;(Write):&nbsp;SendFailure&nbsp;---&amp;gt;&nbsp;System.IO.IOException:&nbsp;The&nbsp;authentication&nbsp;or&nbsp;decryption&nbsp;has&nbsp;failed.&nbsp;---&amp;gt;&nbsp;Mono.Security.Protocol.Tls.TlsException:&nbsp;Invalid&nbsp;certificate&nbsp;received&nbsp;from&nbsp;server.&lt;br&gt;<br>
 &nbsp;at&nbsp;Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.validateCertificates&nbsp;(Mono.Security.X509.X509CertificateCollection&nbsp;certificates)&nbsp;[0x00000]&nbsp;&lt;br&gt; &nbsp;at&nbsp;Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.ProcessAsTls1&nbsp;()&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
 &nbsp;at&nbsp;Mono.Security.Protocol.Tls.Handshake.HandshakeMessage.Process&nbsp;()&nbsp;[0x00000]&nbsp;&lt;br&gt; &nbsp;at&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;Mono.Security.Protocol.Tls.Handshake.HandshakeMessage:Process&nbsp;()&lt;br&gt; &nbsp;at&nbsp;Mono.Security.Protocol.Tls.ClientRecordProtocol.ProcessHandshakeMessage&nbsp;(Mono.Security.Protocol.Tls.TlsStream&nbsp;handMsg)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
 &nbsp;at&nbsp;Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback&nbsp;(IAsyncResult&nbsp;asyncResult)&nbsp;[0x00000]&nbsp;&lt;br&gt; &nbsp;---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---&lt;br&gt; &nbsp;at&nbsp;Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback&nbsp;(IAsyncResult&nbsp;asyncResult)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
 &nbsp;---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---&lt;br&gt; &nbsp;at&nbsp;System.Net.HttpWebRequest.EndGetResponse&nbsp;(IAsyncResult&nbsp;asyncResult)&nbsp;[0x00000]&nbsp;&lt;br&gt; &nbsp;at&nbsp;System.Net.HttpWebRequest.GetResponse&nbsp;()&nbsp;[0x00000]&nbsp;&lt;br&gt; &nbsp;at&nbsp;Program.Main&nbsp;(System.String[]&nbsp;args)&nbsp;[0x00000]&nbsp;&lt;br&gt;<br>
 &lt;br&gt;&lt;br&gt;Running&nbsp;tlstest&nbsp;from&nbsp;the&nbsp;Security&nbsp;FAQ:&lt;br&gt;&lt;br&gt;user@host:~$&nbsp;mono&nbsp;tlstest.exe&nbsp;&lt;a&nbsp;href=&quot;https://www.google.com/&quot;&gt;https://www.google.com/&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://www.google.com/&quot;&gt;https://www.google.com/&lt;/a&gt;&lt;br&gt;CERTIFICATE:&lt;br&gt;<br>
   &nbsp;Format: &nbsp;X509&lt;br&gt;   &nbsp;Name: &nbsp;C=US,&nbsp;S=California,&nbsp;L=Mountain&nbsp;View,&nbsp;O=Google&nbsp;Inc,&nbsp;CN=&lt;a&nbsp;href=&quot;http://www.google.com&quot;&gt;www.google.com&lt;/a&gt;&lt;br&gt;   &nbsp;Issuing&nbsp;CA: &nbsp;C=US,&nbsp;O=Google&nbsp;Inc,&nbsp;CN=Google&nbsp;Internet&nbsp;Authority&lt;br&gt;   &nbsp;Key&nbsp;Algorithm: &nbsp;1.2.840.113549.1.1.1&lt;br&gt;<br>
   &nbsp;Serial&nbsp;Number: &nbsp;B30D000003009A1E6652&lt;br&gt;   &nbsp;Key&nbsp;Alogrithm&nbsp;Parameters: &nbsp;0500&lt;br&gt;   &nbsp;Public&nbsp;Key: &nbsp;30818902818100A5B4503FB81314B5E96F9A3E30DD06ECAA266EDCDE9E4ED29EEC6421E24EA10D3A221A7F15A51BAA110E49B454E66A258D10F631CE100E51B33CA0496BAE2AA463A3F8010BA89A8491CAF7690E4F367926ACD502F902FF850E5C98F23AAD62FBF7AE13914FA730F2CFCCF5698E5F80D3352A0CA5041698E8EDED99F9C9CAFE5F0203010001&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;   &nbsp;Valid&nbsp;From: &nbsp;11/12/2009&nbsp;12:36:10&nbsp;PM&lt;br&gt;   &nbsp;Valid&nbsp;Until:&nbsp;11/12/2010&nbsp;12:46:10&nbsp;PM&lt;br&gt;&lt;br&gt;Error&nbsp;#-2146762490:&nbsp;CERT_E_PURPOSE&nbsp;0x800B0106&lt;br&gt;Error&nbsp;#-2146762486:&nbsp;CERT_E_CHAINING&nbsp;0x800B010A&lt;br&gt;&lt;br&gt;&lt;br&gt;Importing&nbsp;with&nbsp;certmgr:&lt;br&gt;<br>
&lt;br&gt;$&nbsp;certmgr&nbsp;-ssl&nbsp;&lt;a&nbsp;href=&quot;https://www.google.com/&quot;&gt;https://www.google.com/&lt;/a&gt;&lt;br&gt;Mono&nbsp;Certificate&nbsp;Manager&nbsp;-&nbsp;version&nbsp;2.4.0.0&lt;br&gt;Manage&nbsp;X.509&nbsp;certificates&nbsp;and&nbsp;CRL&nbsp;from&nbsp;stores.&lt;br&gt;Copyright&nbsp;2002,&nbsp;2003&nbsp;Motus&nbsp;Technologies.&nbsp;Copyright&nbsp;2004-2008&nbsp;Novell.&nbsp;BSD&nbsp;licensed.&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt; X.509&nbsp;Certificate&nbsp;v3&lt;br&gt;  &nbsp;Issued&nbsp;from:&nbsp;C=US,&nbsp;O=Equifax,&nbsp;OU=Equifax&nbsp;Secure&nbsp;Certificate&nbsp;Authority&lt;br&gt;  &nbsp;Issued&nbsp;to:  &nbsp;C=US,&nbsp;O=Google&nbsp;Inc,&nbsp;CN=Google&nbsp;Internet&nbsp;Authority&lt;br&gt;  &nbsp;Valid&nbsp;from: &nbsp;6/8/2009&nbsp;9:43:27&nbsp;PM&lt;br&gt;  &nbsp;Valid&nbsp;until:&nbsp;6/7/2013&nbsp;8:43:27&nbsp;PM&lt;br&gt;<br>
  &nbsp;***&nbsp;WARNING:&nbsp;Certificate&nbsp;signature&nbsp;is&nbsp;INVALID&nbsp;***&lt;br&gt;&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;read&nbsp;&lt;a&nbsp;href=&quot;https://bugzilla.novell.com/show_bug.cgi?id=545015&quot;&gt;https://bugzilla.novell.com/show_bug.cgi?id=545015&lt;/a&gt;&nbsp;(CN&nbsp;not&nbsp;matching,&nbsp;being&nbsp;an&nbsp;error&nbsp;on&nbsp;Gmail). &nbsp;Running&nbsp;tlstest&nbsp;on&nbsp;&lt;a&nbsp;href=&quot;http://www.gmail.com&quot;&gt;www.gmail.com&lt;/a&gt;&nbsp;adds&nbsp;another&nbsp;error&nbsp;-&nbsp;Error&nbsp;#-2146762481:&nbsp;CERT_E_CN_NO_MATCH&nbsp;0x800B010F&nbsp;-&nbsp;which&nbsp;suggests&nbsp;that&nbsp;it&nbsp;might&nbsp;be&nbsp;separate&nbsp;from&nbsp;this&nbsp;issue. &nbsp;If&nbsp;not,&nbsp;I&nbsp;probably&nbsp;need&nbsp;a&nbsp;newer&nbsp;point-release&nbsp;of&nbsp;Mono&nbsp;2.4&nbsp;and&nbsp;would&nbsp;like&nbsp;to&nbsp;know&nbsp;which&nbsp;version&nbsp;this&nbsp;fix&nbsp;was&nbsp;backported&nbsp;to.&lt;br&gt;<br>
&lt;br&gt;If&nbsp;it&amp;#39;s&nbsp;as&nbsp;simple&nbsp;as&nbsp;importing&nbsp;an&nbsp;intermediate&nbsp;certificate,&nbsp;could&nbsp;someone&nbsp;please&nbsp;help&nbsp;me&nbsp;with&nbsp;identifying&nbsp;which? &nbsp;I&nbsp;have&nbsp;tried&nbsp;pulling&nbsp;down&nbsp;the&nbsp;certificates&nbsp;with&nbsp;openssl&nbsp;s_client,&nbsp;and&nbsp;importing&nbsp;them&nbsp;with&nbsp;certmgr&nbsp;-add&nbsp;-c&nbsp;Trust.&nbsp;&lt;br&gt;<br>
&lt;br&gt;Regards&lt;br&gt;Craig&nbsp;&lt;br&gt;<br>

</tt>
