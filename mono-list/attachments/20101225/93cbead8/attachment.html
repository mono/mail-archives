<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;23,&nbsp;2010&nbsp;at&nbsp;9:45&nbsp;AM,&nbsp;Jonathan&nbsp;Pryor&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jonpryor@vt.edu&quot;&gt;jonpryor@vt.edu&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;In&nbsp;theory,&nbsp;this&nbsp;is&nbsp;safe&nbsp;(safer,&nbsp;really,&nbsp;as&nbsp;you&nbsp;get&nbsp;more&nbsp;type&nbsp;checking).&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&nbsp;that&amp;#39;s&nbsp;exactly&nbsp;what&nbsp;I&nbsp;was&nbsp;looking&nbsp;for.&nbsp;Put&nbsp;differently,&nbsp;I&nbsp;was&nbsp;looking&nbsp;for&nbsp;confirmation&nbsp;that&nbsp;&amp;quot;unsafe&nbsp;FOO*&amp;quot;&nbsp;is&nbsp;treated&nbsp;as&nbsp;a&nbsp;value&nbsp;type&nbsp;just&nbsp;like&nbsp;IntPtr,&nbsp;so&nbsp;actual&nbsp;pointer&nbsp;contents&nbsp;will&nbsp;be&nbsp;left&nbsp;alone.&nbsp;It&nbsp;looks&nbsp;like&nbsp;this&nbsp;is&nbsp;the&nbsp;case. &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
In&nbsp;practice,&nbsp;it&amp;#39;s&nbsp;more&nbsp;iffy&nbsp;for&nbsp;&amp;quot;social&amp;quot;&nbsp;reasons:&nbsp;unsafe&nbsp;code&nbsp;requires&nbsp;&amp;#39;csc&nbsp;/unsafe&amp;#39;,&nbsp;and&nbsp;some&nbsp;places&nbsp;don&amp;#39;t&nbsp;like&nbsp;the&nbsp;&amp;#39;/unsafe&amp;#39;&nbsp;compiler&nbsp;flag.&nbsp; The&nbsp;/unsafe&amp;#39;&nbsp;flag&nbsp;also&nbsp;marks&nbsp;the&nbsp;assembly&nbsp;as&nbsp;untrusted,&nbsp;so&nbsp;in&nbsp;certain&nbsp;CAS&nbsp;contexts&nbsp;you&nbsp;won&amp;#39;t&nbsp;be&nbsp;able&nbsp;to&nbsp;use&nbsp;your&nbsp;assembly&nbsp;while&nbsp;you&nbsp;would&nbsp;be&nbsp;able&nbsp;to&nbsp;use&nbsp;the&nbsp;equivalent&nbsp;IntPtr&nbsp;code.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don&amp;#39;t&nbsp;understand.&nbsp;I&amp;#39;m&nbsp;asking&nbsp;this&nbsp;in&nbsp;the&nbsp;context&nbsp;of&nbsp;DllImport.&nbsp;Doesn&amp;#39;t&nbsp;using&nbsp;DllImport&nbsp;also&nbsp;require&nbsp;unsafe?&nbsp;I&nbsp;don&amp;#39;t&nbsp;see&nbsp;how&nbsp;it&nbsp;would&nbsp;be&nbsp;possible&nbsp;to&nbsp;DllImport&nbsp;using&nbsp;IntPtr&nbsp;without&nbsp;being&nbsp;&amp;quot;untrustable&amp;quot;.&nbsp;I&nbsp;could&nbsp;munge&nbsp;the&nbsp;IntPtr,&nbsp;call&nbsp;a&nbsp;DLLImported&nbsp;function&nbsp;and&nbsp;crash&nbsp;the&nbsp;machine. &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&amp;gt;&nbsp;At&nbsp;a&nbsp;deeper&nbsp;level,&nbsp;I&nbsp;wonder&nbsp;why&nbsp;Platform&nbsp;Invoke&nbsp;doesn&amp;#39;t&nbsp;advocate&nbsp;using&lt;br&gt;<br>
&amp;gt;&nbsp;something&nbsp;like&nbsp;this&nbsp;more&nbsp;often,&nbsp;because&nbsp;it&amp;#39;s&nbsp;alot&nbsp;safer&nbsp;than&nbsp;storing&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;passing&nbsp;everything&nbsp;around&nbsp;as&nbsp;IntPtr.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Then&nbsp;there&amp;#39;s&nbsp;the&nbsp;Common&nbsp;Language&nbsp;Subset&nbsp;(CLS)&nbsp;viewpoint:&nbsp;unsafe&nbsp;code&nbsp;is&nbsp;NOT&nbsp;part&nbsp;of&nbsp;the&nbsp;CLS,&nbsp;while&nbsp;IntPtr/etc.&nbsp;IS,&nbsp;so&nbsp;IntPtr&nbsp;is&nbsp;more&nbsp;&amp;quot;portable&amp;quot;&nbsp;across&nbsp;languages&nbsp;targeting&nbsp;.NET,&nbsp;and&nbsp;thus&nbsp;more&nbsp;&amp;quot;general.&amp;quot;&nbsp;Advocating&nbsp;IntPtr&nbsp;allows&nbsp;Microsoft&nbsp;to&nbsp;keep&nbsp;their&nbsp;documentation&nbsp;shorter&nbsp;and&nbsp;just&nbsp;write&nbsp;about&nbsp;the&nbsp;more&nbsp;general&nbsp;approach.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;see.&nbsp;If&nbsp;I&nbsp;export&nbsp;a&nbsp;CLS&nbsp;compliant&nbsp;interface&nbsp;with&nbsp;a&nbsp;C#&nbsp;module,&nbsp;while&nbsp;using&nbsp;unsafe-pointers&nbsp;internally&nbsp;as&nbsp;a&nbsp;private&nbsp;part&nbsp;of&nbsp;my&nbsp;C#&nbsp;DllImport&nbsp;code,&nbsp;then&nbsp;it&amp;#39;s&nbsp;still&nbsp;find&nbsp;WRT&nbsp;CLS&nbsp;right? &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;answers.&nbsp;This&nbsp;is&nbsp;all&nbsp;telling&nbsp;me&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;me&nbsp;to&nbsp;use&nbsp;IntPtr&nbsp;for&nbsp;DllImport&nbsp;module&nbsp;interfaces,&nbsp;as&nbsp;&amp;quot;unsafe&nbsp;struct&nbsp;pointers&amp;quot;&nbsp;are&nbsp;simply&nbsp;safer&nbsp;and&nbsp;better.&nbsp;Thanks! &lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
