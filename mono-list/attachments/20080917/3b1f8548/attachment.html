<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2008/9/17&nbsp;Jonathan&nbsp;Pryor&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jonpryor@vt.edu&quot;&nbsp;target=&quot;_blank&quot;&gt;jonpryor@vt.edu&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&gt;On&nbsp;Wed,&nbsp;2008-09-17&nbsp;at&nbsp;02:43&nbsp;+0100,&nbsp;Neil&nbsp;Munro&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;have&nbsp;an&nbsp;xml&nbsp;file&nbsp;that&nbsp;is&nbsp;my&nbsp;applications&nbsp;preferences,&nbsp;it&amp;#39;s&nbsp;an&nbsp;update&lt;br&gt;<br>
&amp;gt;&nbsp;tool,&nbsp;now&nbsp;this&nbsp;update&nbsp;tool&nbsp;can&nbsp;update&nbsp;from&nbsp;multiple&nbsp;sources.&nbsp;If&nbsp;no&lt;br&gt;<br>
&amp;gt;&nbsp;preferences&nbsp;file&nbsp;is&nbsp;found&nbsp;on&nbsp;first&nbsp;run,&nbsp;a&nbsp;default&nbsp;set&nbsp;are&nbsp;saved.&nbsp;Now&lt;br&gt;<br>
&amp;gt;&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;add&nbsp;a&nbsp;new&nbsp;update&nbsp;source&nbsp;to&nbsp;the&nbsp;xml&nbsp;file&nbsp;I&nbsp;need&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;place&nbsp;the&nbsp;&amp;lt;UpdateSource&amp;gt;blah&amp;lt;/UpdateSource&amp;gt;&nbsp;in&nbsp;the&nbsp;correct&nbsp;part&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;file,&nbsp;since&nbsp;the&nbsp;file&nbsp;holds&nbsp;ALL&nbsp;application&nbsp;preferences,&nbsp;I&nbsp;can&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;just&nbsp;dump&nbsp;a&nbsp;new&nbsp;source&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text&nbsp;file.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;guess&nbsp;my&nbsp;question&nbsp;is,&nbsp;what&amp;#39;s&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;solve&nbsp;this&nbsp;problem?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;As&nbsp;with&nbsp;many&nbsp;things,&nbsp;there&nbsp;are&nbsp;*several*&nbsp;ways&nbsp;to&nbsp;do&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;*&nbsp;System.Xml.XmlDocument:&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;a&nbsp;href=&quot;http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Provides&nbsp;a&nbsp;DOM&nbsp;oriented&nbsp;XML&nbsp;manipulation&nbsp;API.&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Pro:&nbsp;Somewhat&nbsp;easy&nbsp;to&nbsp;use.&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Con:&nbsp;Loads&nbsp;the&nbsp;entire&nbsp;document&nbsp;into&nbsp;memory,&nbsp;so&nbsp;not&nbsp;very&nbsp;useful&nbsp;for&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;large&nbsp;documents.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;This&nbsp;looks&nbsp;like&nbsp;the&nbsp;solution&nbsp;I&nbsp;am&nbsp;going&nbsp;to&nbsp;go&nbsp;for.&lt;br&gt;&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;*&nbsp;System.Xml.XmlReader&nbsp;&amp;amp;&nbsp;System.Xml.XmlWriter:&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;a&nbsp;href=&quot;http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;a&nbsp;href=&quot;http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Pro:&nbsp;Provides&nbsp;a&nbsp;&amp;quot;pull-model&amp;quot;&nbsp;API&nbsp;so&nbsp;that&nbsp;the&nbsp;entire&nbsp;document&nbsp;need&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;not&nbsp;be&nbsp;loaded&nbsp;at&nbsp;once.&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Con:&nbsp;Not&nbsp;as&nbsp;easy&nbsp;to&nbsp;use&nbsp;as&nbsp;XmlDocument.&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;*&nbsp;System.Xml.XPath.IXPathNavigable&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;a&nbsp;href=&quot;http://msdn.microsoft.com/en-us/library/system.xml.xpath.ixpathnavigable.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://msdn.microsoft.com/en-us/library/system.xml.xpath.ixpathnavigable.aspx&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Allows&nbsp;reading/writing&nbsp;of&nbsp;XML-like&nbsp;data&nbsp;w/o&nbsp;requiring&nbsp;XML,&nbsp;but&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;needs&nbsp;an&nbsp;actual&nbsp;implementation&nbsp;that&nbsp;supports&nbsp;reading/writing,&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;which&nbsp;XmlNode&nbsp;(and&nbsp;thus&nbsp;XmlDocument)&nbsp;do.&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;I&amp;#39;m&nbsp;probably&nbsp;missing&nbsp;a&nbsp;few...&lt;br&gt;<br>
&lt;br&gt;<br>
Unless&nbsp;you&amp;#39;re&nbsp;working&nbsp;with&nbsp;a&nbsp;large&nbsp;document&nbsp;(read:&nbsp;several&nbsp;MB&nbsp;and&lt;br&gt;<br>
larger),&nbsp;I&amp;#39;d&nbsp;suggest&nbsp;either&nbsp;XmlDocument&nbsp;or&nbsp;IXPathNavigable&nbsp;for&nbsp;starters.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;-&nbsp;Jon&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;So&nbsp;I&nbsp;have&nbsp;this:&lt;br&gt;&lt;br&gt;//&nbsp;Save&nbsp;it&nbsp;in&nbsp;the&nbsp;prefs.xml&nbsp;file.&lt;br&gt;XmlDocument&nbsp;xmlDoc&nbsp;=&nbsp;new&nbsp;XmlDocument(&nbsp;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;br&gt;xmlDoc.Load(&nbsp;sPath_To_Prefs_File&nbsp;);&nbsp;&lt;br&gt;&lt;br&gt;Now&nbsp;I&nbsp;know&nbsp;that&nbsp;the&nbsp;whole&nbsp;document&nbsp;is&nbsp;loaded&nbsp;into&nbsp;memory&nbsp;at&nbsp;this&nbsp;point,&nbsp;how&nbsp;would&nbsp;i&nbsp;traverse&nbsp;the&nbsp;document&nbsp;in&nbsp;memory&nbsp;to&nbsp;get&nbsp;to&nbsp;the&nbsp;&amp;lt;UpdateSource&amp;gt;&nbsp;section,&nbsp;read&nbsp;until&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;of&nbsp;that&nbsp;tag&nbsp;and&nbsp;add&nbsp;a&nbsp;new&nbsp;update&nbsp;source&nbsp;after&nbsp;the&nbsp;last&nbsp;one&nbsp;and&nbsp;before&nbsp;the&nbsp;next&nbsp;line?&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
