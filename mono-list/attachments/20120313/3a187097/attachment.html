<tt>
<br>
<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=Windows-1252&quot;&gt;<br>
<br>
<br>
&lt;div&gt;I&nbsp;run&nbsp;on&nbsp;2-10-8.&nbsp;What&nbsp;version&nbsp;do&nbsp;I&nbsp;need?&lt;/div&gt;<br>
&lt;div&gt;/mårten&lt;br&gt;<br>
&lt;br&gt;<br>
Skickat&nbsp;från&nbsp;min&nbsp;iPad&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
13&nbsp;mar&nbsp;2012&nbsp;kl.&nbsp;17:09&nbsp;skrev&nbsp;&quot;GonzaloP&nbsp;[via&nbsp;Mono]&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;/user/SendEmail.jtp?type=node&amp;node=4469498&amp;i=0&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;[hidden&nbsp;email]&lt;/a&gt;&gt;:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&lt;div&gt;On&nbsp;Fri,&nbsp;Mar&nbsp;9,&nbsp;2012&nbsp;at&nbsp;4:37&nbsp;AM,&nbsp;&lt;a&nbsp;href=&quot;/user/SendEmail.jtp?type=node&amp;node=4469464&amp;i=0&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;<br>
[hidden&nbsp;email]&lt;/a&gt;&nbsp;&lt;br&gt;<br>
&lt;&lt;a&nbsp;href=&quot;/user/SendEmail.jtp?type=node&amp;node=4469464&amp;i=1&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;[hidden&nbsp;email]&lt;/a&gt;&gt;&nbsp;wrote:<br>
&lt;div&nbsp;class=&quot;shrinkable-quote&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;created&nbsp;a&nbsp;client&nbsp;app&nbsp;that&nbsp;communicates&nbsp;with&nbsp;a&nbsp;web&nbsp;service&nbsp;that&nbsp;uses&nbsp;&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;Comet&nbsp;way&nbsp;of&nbsp;sending&nbsp;events&nbsp;to&nbsp;a&nbsp;client.&nbsp;To&nbsp;do&nbsp;that&nbsp;I&nbsp;start&nbsp;a&nbsp;&lt;br&gt;<br>
&gt;&nbsp;“long-living”&nbsp;HttpWebRequest&nbsp;to&nbsp;the&nbsp;server.&nbsp;The&nbsp;server&nbsp;communicates&nbsp;back&nbsp;to&nbsp;&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;client&nbsp;by&nbsp;sending&nbsp;chunked&nbsp;content&nbsp;(Transfer-Encoding:&nbsp;chunked).&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Individual&nbsp;events&nbsp;are&nbsp;then&nbsp;transferred&nbsp;in&nbsp;chunks.&nbsp;The&nbsp;problem&nbsp;for&nbsp;me&nbsp;here&nbsp;is&nbsp;&lt;br&gt;<br>
&gt;&nbsp;that&nbsp;Mono&nbsp;seems&nbsp;to&nbsp;wait&nbsp;for&nbsp;the&nbsp;connection&nbsp;to&nbsp;terminate&nbsp;or&nbsp;the&nbsp;timeout&nbsp;to&nbsp;&lt;br&gt;<br>
&gt;&nbsp;happen&nbsp;before&nbsp;sending&nbsp;the&nbsp;chunks&nbsp;back&nbsp;to&nbsp;the&nbsp;consumer&nbsp;of&nbsp;HttpWebRequest.&nbsp;&lt;br&gt;<br>
&gt;&nbsp;This&nbsp;is&nbsp;not&nbsp;the&nbsp;case&nbsp;in&nbsp;.Net.&nbsp;In&nbsp;.Net&nbsp;each&nbsp;chunk&nbsp;is&nbsp;reported&nbsp;back&nbsp;&lt;br&gt;<br>
&gt;&nbsp;individually&nbsp;when&nbsp;they&nbsp;arrive.&nbsp;&lt;br&gt;<br>
&gt;&nbsp;This&nbsp;is&nbsp;the&nbsp;pseudo&nbsp;code&nbsp;I’m&nbsp;using:&nbsp;&lt;br&gt;<br>
&gt;&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpWebRequest&nbsp;req&nbsp;=&nbsp;WebRequest.Create(&nbsp;URL…);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.BeginGetRequestStream(…);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stream&nbsp;=&nbsp;eventContext.WebRequest.EndGetRequestStream(…);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StreamWriter&nbsp;writer&nbsp;=&nbsp;new&nbsp;StreamWriter(stream);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.Write(data);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;6.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.Close();&nbsp;&lt;br&gt;<br>
&gt;&nbsp;7.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eventContext.RequestStream.Close();&nbsp;&lt;br&gt;<br>
&gt;&nbsp;8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eventContext.WebRequest.BeginGetResponse(…);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpWebResponse&nbsp;resp&nbsp;=&nbsp;(HttpWebResponse)&nbsp;&lt;br&gt;<br>
&gt;&nbsp;req.EndGetResponse(asynchronousResult);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseStream&nbsp;=&nbsp;resp.GetResponseStream();&nbsp;&lt;br&gt;<br>
&gt;&nbsp;11.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseStream.BeginRead(eventContext.Buffer,&nbsp;0,&nbsp;20000,&nbsp;new&nbsp;&lt;br&gt;<br>
&gt;&nbsp;AsyncCallback(DataReceived),&nbsp;eventContext);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;12.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;DataReceived&nbsp;I&nbsp;do&nbsp;responseStream.EndRead(asynchronousResult);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;13.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;After&nbsp;that&nbsp;I&nbsp;arm&nbsp;the&nbsp;read&nbsp;again&nbsp;with&nbsp;responseStream.BeginRead(…);&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;In&nbsp;.Net&nbsp;DataReceived&nbsp;is&nbsp;called&nbsp;on&nbsp;each&nbsp;packet.&nbsp;In&nbsp;Mono&nbsp;it’s&nbsp;called&nbsp;after&nbsp;30&nbsp;&lt;br&gt;<br>
&gt;&nbsp;seconds&nbsp;(probably&nbsp;the&nbsp;timeout).&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Is&nbsp;this&nbsp;the&nbsp;intended&nbsp;behavior&nbsp;with&nbsp;HttpWebRequest&nbsp;and&nbsp;chunked&nbsp;content?&nbsp;Is&nbsp;&lt;br&gt;<br>
&gt;&nbsp;there&nbsp;another&nbsp;recommended&nbsp;way&nbsp;of&nbsp;dealing&nbsp;Comet&nbsp;style&nbsp;web&nbsp;services?&nbsp;&lt;/div&gt;<br>
&lt;br&gt;<br>
For&nbsp;the&nbsp;record,&nbsp;this&nbsp;was&nbsp;a&nbsp;bug&nbsp;that&nbsp;is&nbsp;now&nbsp;fixed&nbsp;in&nbsp;the&nbsp;mono-2-10&nbsp;and&nbsp;&lt;br&gt;<br>
master&nbsp;branches.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
-Gonzalo&nbsp;&lt;br&gt;<br>
_______________________________________________&nbsp;&lt;br&gt;<br>
Mono-list&nbsp;maillist&nbsp;&nbsp;-&nbsp;&nbsp;&lt;a&nbsp;href=&quot;/user/SendEmail.jtp?type=node&amp;node=4469464&amp;i=2&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;[hidden&nbsp;email]&lt;/a&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-list&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;hr&nbsp;noshade=&quot;noshade&quot;&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#cccccc&quot;&gt;<br>
&lt;div&nbsp;style=&quot;color:#444;&nbsp;font:&nbsp;12px&nbsp;tahoma,geneva,helvetica,arial,sans-serif;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-weight:bold&quot;&gt;If&nbsp;you&nbsp;reply&nbsp;to&nbsp;this&nbsp;email,&nbsp;your&nbsp;message&nbsp;will&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;discussion&nbsp;below:&lt;/div&gt;<br>
&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/HttpWebRequest-differently-compared-to-HttpWebRequest-on-Net-tp4458958p4469464.html&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;http://mono.1490590.n4.nabble.com/HttpWebRequest-differently-compared-to-HttpWebRequest-on-Net-tp4458958p4469464.html&lt;/a&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:#666;&nbsp;font:&nbsp;11px&nbsp;tahoma,geneva,helvetica,arial,sans-serif;margin-top:.4em;line-height:1.5em&quot;&gt;<br>
To&nbsp;unsubscribe&nbsp;from&nbsp;HttpWebRequest&nbsp;differently&nbsp;compared&nbsp;to&nbsp;HttpWebRequest&nbsp;on&nbsp;.Net.,<br>
&lt;a&nbsp;href=&quot;&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;<br>
click&nbsp;here&lt;/a&gt;.&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;style=&quot;font:9px&nbsp;serif&quot;&nbsp;target=&quot;_top&quot;&nbsp;link=&quot;external&quot;&gt;NAML&lt;/a&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;br/&gt;&lt;hr&nbsp;align=&quot;left&quot;&nbsp;width=&quot;300&quot;&nbsp;/&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/HttpWebRequest-differently-compared-to-HttpWebRequest-on-Net-tp4458958p4469498.html&quot;&gt;Re:&nbsp;HttpWebRequest&nbsp;differently&nbsp;compared&nbsp;to&nbsp;HttpWebRequest&nbsp;on&nbsp;.Net.&lt;/a&gt;&lt;br/&gt;<br>
Sent&nbsp;from&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/Mono-General-f1490591.html&quot;&gt;Mono&nbsp;-&nbsp;General&nbsp;mailing&nbsp;list&nbsp;archive&lt;/a&gt;&nbsp;at&nbsp;Nabble.com.&lt;br/&gt;
</tt>
