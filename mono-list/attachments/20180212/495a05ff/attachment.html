<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charset=windows-1252&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;embed&nbsp;mono...&nbsp;and&nbsp;I&nbsp;ran&nbsp;into&nbsp;a&nbsp;problem:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;code:&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;TypeMethodDesc&nbsp;=&nbsp;mono_method_desc_new(&quot;Script:Main&quot;,&nbsp;0);&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;method&nbsp;=&nbsp;mono_method_desc_search_in_image(TypeMethodDesc,<br>
&nbsp;&nbsp;&nbsp;&nbsp;monoEngine-&gt;image);&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;returning&nbsp;a&nbsp;method&nbsp;on&nbsp;the&nbsp;cs&nbsp;code:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&gt;&lt;tt&gt;public&nbsp;class&nbsp;Script&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;{&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt; &nbsp;static&nbsp;public&nbsp;void&nbsp;Main&nbsp;()&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt; &nbsp;{&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;   &nbsp;ScriptEngine.report(&quot;--Main&nbsp;Called&nbsp;&quot;);&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt; &nbsp;}&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;}&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;returning&nbsp;a&nbsp;method&nbsp;on&nbsp;the&nbsp;code:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&gt;&lt;tt&gt;public&nbsp;class&nbsp;Script&lt;b&gt;2&lt;/b&gt;&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;static&nbsp;public&nbsp;void&nbsp;Main&nbsp;()&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;{&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;ScriptEngine.report(&quot;--Main&nbsp;Called&nbsp;&quot;);&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;}&lt;/tt&gt;&lt;tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;tt&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a&nbsp;question:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;know&nbsp;if&nbsp;mono_domain_unload&nbsp;was&nbsp;successful&nbsp;or&nbsp;not?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;am&nbsp;creating&nbsp;an&nbsp;app&nbsp;domain&nbsp;per&nbsp;script&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;recompile&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;reload&nbsp;the&nbsp;script&nbsp;at&nbsp;will...&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;do&nbsp;not&nbsp;detect&nbsp;an&nbsp;error,&nbsp;but&nbsp;the&nbsp;new&nbsp;script&nbsp;seems&nbsp;(not&nbsp;always&nbsp;at<br>
&nbsp;&nbsp;&nbsp;&nbsp;least)&nbsp;not&nbsp;to&nbsp;replace&nbsp;the&nbsp;old&nbsp;one...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Basically,&nbsp;I&nbsp;am&nbsp;doing:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&gt;&lt;tt&gt;res&nbsp;=&nbsp;mono_domain_set(rootDomain,&nbsp;FALSE);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;mono_domain_unload(monoEngine-&gt;domain);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;monoEngine-&gt;domain&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mono_domain_create_appdomain(&quot;ScriptEngine-sub&quot;,&nbsp;NULL);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;data&nbsp;=&nbsp;readFile(f,&nbsp;&amp;dataLen);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;fclose(f);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;monoEngine-&gt;image&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mono_image_open_from_data_with_name(data,&nbsp;dataLen,&nbsp;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;                                                         &nbsp;TRUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;copy&nbsp;data&nbsp;*/,&nbsp;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;                                                         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;status,&nbsp;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;                                                         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FALSE&nbsp;/*&nbsp;ref&nbsp;only&nbsp;*/,&nbsp;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;                                                         <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;monoEngine-&gt;fileName);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;free(data);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;if&nbsp;(status&nbsp;!=&nbsp;MONO_IMAGE_OK&nbsp;||&nbsp;monoEngine-&gt;image&nbsp;==&nbsp;NULL)&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;{&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;   &nbsp;return&nbsp;FALSE;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;}&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;   &nbsp;//&nbsp;load&nbsp;the&nbsp;assembly&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;monoEngine-&gt;assembly&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mono_assembly_load_from_full(monoEngine-&gt;image,&nbsp;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;                                                     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;monoEngine-&gt;fileName,&nbsp;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;                                                     <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;status,&nbsp;FALSE);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;if&nbsp;(status&nbsp;!=&nbsp;MONO_IMAGE_OK&nbsp;||&nbsp;monoEngine-&gt;assembly&nbsp;==<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL)&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;{&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;   &nbsp;mono_image_close(monoEngine-&gt;image);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;   &nbsp;return&nbsp;FALSE;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt; &nbsp;}&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;seem&nbsp;to&nbsp;work&nbsp;everytime.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Lastly,&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;compile&nbsp;cs&nbsp;source&nbsp;without&nbsp;launching&nbsp;a&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&gt;&lt;tt&gt;system(&quot;msc.code.cs&nbsp;-target:library&quot;);&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;thanks&nbsp;in&nbsp;advance&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Pierre&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
