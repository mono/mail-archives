<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&#39;m&nbsp;not&nbsp;sure&nbsp;if&nbsp;fontconfig&nbsp;is&nbsp;threadsafe&nbsp;and&nbsp;the&nbsp;finalizer&nbsp;thread&nbsp;is&nbsp;directly&nbsp;unreffing&nbsp;some&nbsp;fontconfig&nbsp;objects.&nbsp;This&nbsp;could&nbsp;easily&nbsp;be&nbsp;causing&nbsp;the&nbsp;corruption&nbsp;you&#39;re&nbsp;seeing&nbsp;if&nbsp;that&#39;s&nbsp;the&nbsp;case.&nbsp;Can&nbsp;you&nbsp;paste&nbsp;the&nbsp;full&nbsp;stacktrace&nbsp;of&nbsp;your&nbsp;crash&nbsp;(&lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;including&nbsp;all&nbsp;threads!)&lt;/span&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; in&nbsp;a&nbsp;pastebin,&nbsp;or&nbsp;attach&nbsp;it&nbsp;to&nbsp;your&nbsp;email&nbsp;in&nbsp;some&nbsp;way?&lt;/font&gt;&lt;div&gt;<br>
&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;Alan&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;8&nbsp;April&nbsp;2013&nbsp;08:42,&nbsp;Ian&nbsp;Norton&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:ian.norton-badrul@thales-esecurity.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ian.norton-badrul@thales-esecurity.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;I&#39;d&nbsp;be&nbsp;sure&nbsp;to&nbsp;check&nbsp;your&nbsp;struct&nbsp;packing&nbsp;and&nbsp;call&nbsp;conventions&nbsp;properly.&nbsp;And&lt;br&gt;<br>
perhaps&nbsp;be&nbsp;sure&nbsp;that&nbsp;you&nbsp;aren&#39;t&nbsp;passing&nbsp;in&nbsp;any&nbsp;&quot;ref&nbsp;System.String&quot;&nbsp;instead&nbsp;of&lt;br&gt;<br>
StringBuilders&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
Ian&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;Apr&nbsp;08,&nbsp;2013&nbsp;at&nbsp;04:21:32AM&nbsp;+0100,&nbsp;Danny&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hello,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;having&nbsp;a&nbsp;difficult&nbsp;time&nbsp;with&nbsp;an&nbsp;application&nbsp;I&nbsp;have&nbsp;written.&nbsp; I&lt;br&gt;<br>
&gt;&nbsp;recently&nbsp;made&nbsp;some&nbsp;changes&nbsp;and&nbsp;I&#39;m&nbsp;having&nbsp;a&nbsp;problem&nbsp;with&nbsp;it&nbsp;failing&nbsp;at&lt;br&gt;<br>
&gt;&nbsp;seemingly&nbsp;random&nbsp;times&nbsp;and&nbsp;locations&nbsp;(within&nbsp;the&nbsp;code),&nbsp;with&nbsp;sigsegv&lt;br&gt;<br>
&gt;&nbsp;errors.&nbsp; This&nbsp;is&nbsp;a&nbsp;multithreaded&nbsp;plugin-style&nbsp;daemon/service&nbsp;(can&nbsp;be&lt;br&gt;<br>
&gt;&nbsp;launched&nbsp;from&nbsp;CLI)&nbsp;and&nbsp;I&nbsp;recently&nbsp;added&nbsp;a&nbsp;new&nbsp;component&nbsp;to&nbsp;it&nbsp;to&nbsp;poll&nbsp;a&lt;br&gt;<br>
&gt;&nbsp;data&nbsp;acquisition&nbsp;board&nbsp;via&nbsp;USB&nbsp;using&nbsp;FTDI.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Almost&nbsp;all&nbsp;of&nbsp;our&nbsp;integrations&nbsp;like&nbsp;this&nbsp;use&nbsp;a&nbsp;shared&nbsp;library&nbsp;(or&nbsp;DLL&nbsp;on&lt;br&gt;<br>
&gt;&nbsp;Windows)&nbsp;and&nbsp;p/invoke&nbsp;to&nbsp;access&nbsp;hardware.&nbsp; I&nbsp;have&nbsp;done&nbsp;dozens&nbsp;of&nbsp;these&lt;br&gt;<br>
&gt;&nbsp;integrations&nbsp;over&nbsp;USB&nbsp;without&nbsp;a&nbsp;persistent&nbsp;issue&nbsp;like&nbsp;this.&nbsp; But&nbsp;still&lt;br&gt;<br>
&gt;&nbsp;at&nbsp;first&nbsp;I&nbsp;suspected&nbsp;this&nbsp;new&nbsp;component,&nbsp;as&nbsp;I&nbsp;had&nbsp;initially&nbsp;thought&nbsp;it&lt;br&gt;<br>
&gt;&nbsp;was&nbsp;trashing&nbsp;RAM&nbsp;because&nbsp;of&nbsp;the&nbsp;problems&nbsp;I&nbsp;had&nbsp;developing&nbsp;the&nbsp;shared&nbsp;library&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;However,&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;as&nbsp;I&nbsp;made&nbsp;this&nbsp;addition,&nbsp;I&nbsp;was&nbsp;also&nbsp;(somewhat)&lt;br&gt;<br>
&gt;&nbsp;forced&nbsp;to&nbsp;upgrade&nbsp;our&nbsp;base&nbsp;OS&nbsp;to&nbsp;the&nbsp;latest&nbsp;LTS&nbsp;Ubuntu&nbsp;12.04&nbsp;(was&nbsp;on&lt;br&gt;<br>
&gt;&nbsp;10.04).&nbsp; So&nbsp;unfortunately,&nbsp;I&nbsp;have&nbsp;more&nbsp;than&nbsp;one&nbsp;variable&nbsp;changing&nbsp;at&nbsp;a&lt;br&gt;<br>
&gt;&nbsp;time.&nbsp; So&nbsp;I&nbsp;confirmed,&nbsp;with&nbsp;a&nbsp;configuration&nbsp;that&nbsp;eliminates&nbsp;the&nbsp;newly&lt;br&gt;<br>
&gt;&nbsp;developed&nbsp;component,&nbsp;that&nbsp;this&nbsp;problem&nbsp;occurs&nbsp;without&nbsp;that&nbsp;running.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;That&#39;s&nbsp;good&nbsp;and&nbsp;bad,&nbsp;since&nbsp;now&nbsp;it&nbsp;seems&nbsp;likely&nbsp;that&nbsp;the&nbsp;offending&nbsp;code&lt;br&gt;<br>
&gt;&nbsp;is&nbsp;out&nbsp;of&nbsp;my&nbsp;control.&nbsp; I&nbsp;am&nbsp;hoping&nbsp;to&nbsp;get&nbsp;some&nbsp;information&nbsp;on&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;error(s)&nbsp;I&nbsp;was&nbsp;able&nbsp;to&nbsp;capture,&nbsp;or&nbsp;some&nbsp;advice&nbsp;on&nbsp;how&nbsp;to&nbsp;debug&nbsp;the&nbsp;root&lt;br&gt;<br>
&gt;&nbsp;cause&nbsp;of&nbsp;this&nbsp;problem.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;a&nbsp;couple&nbsp;of&nbsp;stack&nbsp;traces&nbsp;captured&nbsp;and&nbsp;I&#39;ll&nbsp;include&nbsp;what&nbsp;I&nbsp;believe&lt;br&gt;<br>
&gt;&nbsp;is&nbsp;the&nbsp;crucial&nbsp;part&nbsp;of&nbsp;one&nbsp;here.&nbsp; It&#39;s&nbsp;worth&nbsp;noting&nbsp;that&nbsp;not&nbsp;all&nbsp;of&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;stack&nbsp;traces&nbsp;are&nbsp;the&nbsp;same.&nbsp; It&#39;s&nbsp;also&nbsp;worth&nbsp;noting&nbsp;that&nbsp;I&nbsp;have&nbsp;seen&lt;br&gt;<br>
&gt;&nbsp;libgdiplus.so&nbsp;in&nbsp;other&nbsp;traces&nbsp;that&nbsp;I&nbsp;didn&#39;t&nbsp;get&nbsp;captured.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;tried&nbsp;setting&nbsp;up&nbsp;a&nbsp;10.04&nbsp;machine&nbsp;to&nbsp;test&nbsp;with,&nbsp;but&nbsp;one&nbsp;of&nbsp;our&nbsp;newer&lt;br&gt;<br>
&gt;&nbsp;dependencies&nbsp;(ServiceStack)&nbsp;introduced&nbsp;a&nbsp;class&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;default&nbsp;mono&nbsp;on&nbsp;that&nbsp;platform,&nbsp;giving&nbsp;a&nbsp;startup&nbsp;error&nbsp;trying&nbsp;to&nbsp;resolve&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;IgnoreDataMemberAttribute&nbsp;class.&nbsp; So&nbsp;I&nbsp;then&nbsp;got&nbsp;the&nbsp;latest&nbsp;mono&nbsp;set&lt;br&gt;<br>
&gt;&nbsp;up&nbsp;on&nbsp;that&nbsp;machine&nbsp;now,&nbsp;but&nbsp;fear&nbsp;that&nbsp;this&nbsp;will&nbsp;result&nbsp;in&nbsp;the&nbsp;same&nbsp;error&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;reporting&nbsp;(ie:&nbsp;I&nbsp;believe&nbsp;this&nbsp;to&nbsp;be&nbsp;a&nbsp;mono&nbsp;problem),&nbsp;since&nbsp;it&lt;br&gt;<br>
&gt;&nbsp;should&nbsp;be&nbsp;the&nbsp;same&nbsp;mono&nbsp;framework&nbsp;running&nbsp;there.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Any&nbsp;help&nbsp;is&nbsp;greatly&nbsp;appreciated.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;snip&nbsp;-&nbsp;a&nbsp;bunch&nbsp;of&nbsp;standard&nbsp;output&nbsp;msgs&nbsp;from&nbsp;the&nbsp;service&nbsp;/&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Stacktrace:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp; &nbsp; at&nbsp;(wrapper&nbsp;managed-to-native)&nbsp;System.Drawing.GDIPlus.GdipDeleteFont&lt;br&gt;<br>
&gt;&nbsp;(intptr)&nbsp;&lt;0xffffffff&gt;&lt;br&gt;<br>
&gt;&nbsp; &nbsp; at&nbsp;System.Drawing.Font.Dispose&nbsp;()&nbsp;&lt;0x0002b&gt;&lt;br&gt;<br>
&gt;&nbsp; &nbsp; at&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;System.Drawing.Font.Dispose&lt;br&gt;<br>
&gt;&nbsp;()&nbsp;&lt;0xffffffff&gt;&lt;br&gt;<br>
&gt;&nbsp; &nbsp; at&nbsp;System.Drawing.Font.Finalize&nbsp;()&nbsp;&lt;0x00013&gt;&lt;br&gt;<br>
&gt;&nbsp; &nbsp; at&nbsp;(wrapper&nbsp;runtime-invoke)&lt;br&gt;<br>
&gt;&nbsp;object.runtime_invoke_virtual_void__this__&nbsp;(object,intptr,intptr,intpt$&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Native&nbsp;stacktrace:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mono()&nbsp;[0x80e16fc]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mono()&nbsp;[0x81209fc]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mono()&nbsp;[0x806094d]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0xb770240c]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;/usr/lib/i386-linux-gnu/libfontconfig.so.1(FcCharSetDestroy+0x15)&lt;br&gt;<br>
&gt;&nbsp;[0xb4b1b9b5]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/i386-linux-gnu/libfontconfig.so.1(+0x17b43)&nbsp;[0xb4b29b43]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;/usr/lib/i386-linux-gnu/libfontconfig.so.1(FcPatternDestroy+0x82)&lt;br&gt;<br>
&gt;&nbsp;[0xb4b29e12]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/libgdiplus.so.0(GdipDeleteFontFamily+0x132)&nbsp;[0xb5004642]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/libgdiplus.so.0(GdipDeleteFont+0x2c)&nbsp;[0xb500510c]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0xaf711940]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0xaf7118cc]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0xaf711870]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0xaf7117ec]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0xb5cddf41]&lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mono()&nbsp;[0x8150107]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;snip&nbsp;-&nbsp;42&nbsp;thread&nbsp;stack&nbsp;details&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;=================================================================&lt;br&gt;<br>
&gt;&nbsp;Got&nbsp;a&nbsp;SIGSEGV&nbsp;while&nbsp;executing&nbsp;native&nbsp;code.&nbsp;This&nbsp;usually&nbsp;indicates&lt;br&gt;<br>
&gt;&nbsp;a&nbsp;fatal&nbsp;error&nbsp;in&nbsp;the&nbsp;mono&nbsp;runtime&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;native&nbsp;libraries&lt;br&gt;<br>
&gt;&nbsp;used&nbsp;by&nbsp;your&nbsp;application.&lt;br&gt;<br>
&gt;&nbsp;=================================================================&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Danny&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Mono-list&nbsp;maillist&nbsp; -&nbsp; &lt;a&nbsp;href=&quot;mailto:Mono-list@lists.ximian.com&quot;&gt;Mono-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-list&lt;/a&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-list&nbsp;maillist&nbsp; -&nbsp; &lt;a&nbsp;href=&quot;mailto:Mono-list@lists.ximian.com&quot;&gt;Mono-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
