<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.26.0&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
Hi&nbsp;Marek&lt;BR&gt;<br>
&lt;BR&gt;<br>
you&nbsp;are&nbsp;right,&nbsp;there&nbsp;were&nbsp;some&nbsp;projects&nbsp;at&nbsp;1.1.&nbsp;Yesterday&nbsp;I&nbsp;changed&nbsp;that,&nbsp;but&nbsp;I&nbsp;seemed&nbsp;not&nbsp;to&nbsp;have&nbsp;checked&nbsp;in&nbsp;my&nbsp;changes.&nbsp;I&nbsp;now&nbsp;am&nbsp;sure&nbsp;that&nbsp;all&nbsp;the&nbsp;controls&nbsp;(even&nbsp;NeatUpload)&nbsp;are&nbsp;compiled&nbsp;as&nbsp;2.0,&nbsp;but&nbsp;still&nbsp;the&nbsp;exception&nbsp;occures.&nbsp;Im&nbsp;sure&nbsp;that&nbsp;the&nbsp;exception&nbsp;is&nbsp;throw&nbsp;by&nbsp;the&nbsp;IsAbsolute&nbsp;method:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
public&nbsp;static&nbsp;bool&nbsp;IsAbsolute&nbsp;(string&nbsp;virtualPath)<br>
{<br>
&amp;nbsp;&nbsp;if&nbsp;(StrUtils.IsNullOrEmpty&nbsp;(virtualPath))<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throw&nbsp;new&nbsp;ArgumentNullException&nbsp;(&amp;quot;virtualPath&amp;quot;);<br>
<br>
&amp;nbsp;&nbsp;return&nbsp;(virtualPath&nbsp;[0]&nbsp;==&nbsp;'/'&nbsp;||&nbsp;virtualPath&nbsp;[0]&nbsp;==&nbsp;'\\');<br>
}<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;PRE&gt;<br>
<br>
when&nbsp;I&nbsp;print&nbsp;the&nbsp;value&nbsp;of&nbsp;virtualPath,&nbsp;it&nbsp;is&nbsp;indeed&nbsp;empty&nbsp;(but&nbsp;not&nbsp;null).&nbsp;If&nbsp;I&nbsp;just&nbsp;compile&nbsp;a&nbsp;control&nbsp;which&nbsp;was&nbsp;made&nbsp;for&nbsp;1.1&nbsp;as&nbsp;a&nbsp;2.0&nbsp;project,&nbsp;then&nbsp;things&nbsp;should&nbsp;be&nbsp;ok?&nbsp;The&nbsp;control&nbsp;that&nbsp;gives&nbsp;the&nbsp;exception&nbsp;is&nbsp;the&nbsp;neatupload&nbsp;inputcontrol&nbsp;which&nbsp;is&nbsp;derived&nbsp;from&nbsp;the&nbsp;FileContol,&nbsp;which&nbsp;comes&nbsp;from&nbsp;the&nbsp;System.Web.UI.WebControls.WebControl.&nbsp;I&nbsp;guess&nbsp;that&nbsp;should&nbsp;be&nbsp;no&nbsp;problem?<br>
<br>
&lt;I&gt;public&nbsp;abstract&nbsp;class&nbsp;FileControl&nbsp;:&nbsp;System.Web.UI.WebControls.WebControl,&nbsp;System.Web.UI.IPostBackD&lt;/I&gt;ataHandler<br>
<br>
Cheers<br>
<br>
Peter<br>
&lt;/PRE&gt;<br>
&lt;BR&gt;<br>
On&nbsp;Mon,&nbsp;2009-07-20&nbsp;at&nbsp;13:18&nbsp;+0200,&nbsp;Marek&nbsp;Habersack&nbsp;wrote:<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
Peter&nbsp;Hagen&nbsp;wrote:<br>
&amp;gt;&nbsp;Hi&nbsp;Gonzalo<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;I&nbsp;did&nbsp;some&nbsp;tests&nbsp;on&nbsp;./mcs/class/System.Web/System.Web.UI/Control.cs&nbsp;and&nbsp;<br>
&amp;gt;&nbsp;noticed&nbsp;if&nbsp;the&nbsp;TemplateSourceDirectory&nbsp;is&nbsp;empty,&nbsp;I&nbsp;get&nbsp;the&nbsp;crash.<br>
&amp;gt;&nbsp;<br>
[snip]<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;So,&nbsp;i&nbsp;added&nbsp;this&nbsp;line,&nbsp;which&nbsp;is&nbsp;probably&nbsp;not&nbsp;ok,&nbsp;but&nbsp;it&nbsp;works&nbsp;now.&nbsp;Im&nbsp;<br>
&amp;gt;&nbsp;not&nbsp;sure&nbsp;what&nbsp;the&nbsp;TemplateSourceDirectory&nbsp;should&nbsp;be&nbsp;in&nbsp;this&nbsp;case.&nbsp;Do&nbsp;you&nbsp;<br>
&amp;gt;&nbsp;have&nbsp;a&nbsp;suggestion?<br>
It&nbsp;should&nbsp;always&nbsp;be&nbsp;set&nbsp;to&nbsp;the&nbsp;virtual&nbsp;directory&nbsp;of&nbsp;the&nbsp;current&nbsp;control's&nbsp;parent.&nbsp;<br>
TemplateSourceDirectory&nbsp;can&nbsp;be&nbsp;empty&nbsp;only&nbsp;in&nbsp;those&nbsp;cases&nbsp;(2.0&nbsp;profile):<br>
<br>
1.&nbsp;this.TemplateControl&nbsp;is&nbsp;null&nbsp;and&nbsp;HttpContext.Current&nbsp;is&nbsp;null&nbsp;and&nbsp;the&nbsp;current&nbsp;control&nbsp;is&nbsp;not&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;TemplateControl<br>
2.&nbsp;current&nbsp;control&nbsp;is&nbsp;a&nbsp;TemplateControl&nbsp;and&nbsp;this.AppRelativeVirtualPath&nbsp;is&nbsp;null,&nbsp;which&nbsp;can&nbsp;happen<br>
&nbsp;&nbsp;&nbsp;&nbsp;only&nbsp;if&nbsp;AppRelativeVirtualPath&nbsp;is&nbsp;never&nbsp;initialized&nbsp;from&nbsp;code&nbsp;generated&nbsp;by&nbsp;ASP.NET&nbsp;compiler.<br>
3.&nbsp;We&nbsp;have&nbsp;a&nbsp;bug&nbsp;in&nbsp;2.0&nbsp;logic&nbsp;for&nbsp;Control.TemplateSourceDirectory<br>
<br>
My&nbsp;bet&nbsp;is&nbsp;on&nbsp;#2,&nbsp;which&nbsp;would&nbsp;mean&nbsp;that&nbsp;your&nbsp;application&nbsp;is&nbsp;incorrectly&nbsp;ported&nbsp;to&nbsp;2.0&nbsp;-&nbsp;make&nbsp;sure&nbsp;<br>
that&nbsp;you&nbsp;run&nbsp;it&nbsp;with&nbsp;the&nbsp;2.0&nbsp;runtime,&nbsp;that&nbsp;all&nbsp;your&nbsp;code-behind&nbsp;and&nbsp;referenced&nbsp;assemblies&nbsp;are&nbsp;<br>
compiled&nbsp;with&nbsp;the&nbsp;2.0&nbsp;compiler.&nbsp;It&nbsp;is&nbsp;possible&nbsp;that&nbsp;some&nbsp;of&nbsp;your&nbsp;controls&nbsp;use&nbsp;the&nbsp;1.1&nbsp;version&nbsp;of&nbsp;<br>
System.Web&nbsp;and&nbsp;thus&nbsp;hit&nbsp;the&nbsp;1.1&nbsp;path&nbsp;in&nbsp;Control.TemplateSourceDirectory.<br>
<br>
regards,<br>
<br>
marek<br>
<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;Cheers<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;Peter<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;On&nbsp;Mon,&nbsp;2009-07-20&nbsp;at&nbsp;00:02&nbsp;-0400,&nbsp;Gonzalo&nbsp;Paniagua&nbsp;Javier&nbsp;wrote:<br>
&amp;gt;&amp;gt;&nbsp;On&nbsp;Sun,&nbsp;2009-07-19&nbsp;at&nbsp;18:40&nbsp;+0200,&nbsp;Peter&nbsp;Hagen&nbsp;wrote:<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Hi&nbsp;Gonzalo<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;well,&nbsp;i&nbsp;have&nbsp;a&nbsp;bit&nbsp;a&nbsp;problem&nbsp;of&nbsp;recreating&nbsp;the&nbsp;bug&nbsp;in&nbsp;a&nbsp;new&nbsp;project.&nbsp;&nbsp;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;If&nbsp;i&nbsp;make&nbsp;a&nbsp;new&nbsp;project&nbsp;from&nbsp;MonoDevelop,&nbsp;it&nbsp;works&nbsp;as&nbsp;planned.&nbsp;But&nbsp;&nbsp;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;inside&nbsp;my&nbsp;project&nbsp;it&nbsp;doesn't.&nbsp;But&nbsp;this&nbsp;is&nbsp;originally&nbsp;a&nbsp;1.1&nbsp;&nbsp;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;application.&nbsp;Uploading&nbsp;the&nbsp;entire&nbsp;project&nbsp;isnt&nbsp;really&nbsp;an&nbsp;option.&nbsp;So,&nbsp;&nbsp;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;ill&nbsp;try&nbsp;to&nbsp;figure&nbsp;out&nbsp;more&nbsp;about&nbsp;the&nbsp;project&nbsp;first&nbsp;:s<br>
&amp;gt;&amp;gt;<br>
&amp;gt;&amp;gt;&nbsp;If&nbsp;you&nbsp;can&nbsp;build&nbsp;System.Web&nbsp;from&nbsp;sources,&nbsp;sprinkle&nbsp;a&nbsp;few<br>
&amp;gt;&amp;gt;&nbsp;Console.WriteLine()&nbsp;in&nbsp;&nbsp;Contorl.AppRelativeTemplateSourceDirectory&nbsp;and<br>
&amp;gt;&amp;gt;&nbsp;ToAppRelative.&nbsp;That&nbsp;will&nbsp;at&nbsp;least&nbsp;tell&nbsp;you&nbsp;where&nbsp;the&nbsp;'null'&nbsp;is&nbsp;used&nbsp;for<br>
&amp;gt;&amp;gt;&nbsp;the&nbsp;first&nbsp;time.<br>
&amp;gt;&amp;gt;<br>
&amp;gt;&amp;gt;&nbsp;-Gonzalo<br>
&amp;gt;&amp;gt;<br>
&amp;gt;&amp;gt;<br>
&amp;gt;&amp;gt;&nbsp;_______________________________________________<br>
&amp;gt;&amp;gt;&nbsp;Mono-list&nbsp;maillist&nbsp;&nbsp;-&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;mailto:Mono-list@lists.ximian.com&quot;&gt;Mono-list@lists.ximian.com&lt;/A&gt;&nbsp;&amp;lt;&lt;A&nbsp;HREF=&quot;mailto:Mono-list@lists.ximian.com&quot;&gt;mailto:Mono-list@lists.ximian.com&lt;/A&gt;&amp;gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;A&nbsp;HREF=&quot;http://lists.ximian.com/mailman/listinfo/mono-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-list&lt;/A&gt;<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;------------------------------------------------------------------------<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;_______________________________________________<br>
&amp;gt;&nbsp;Mono-list&nbsp;maillist&nbsp;&nbsp;-&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;mailto:Mono-list@lists.ximian.com&quot;&gt;Mono-list@lists.ximian.com&lt;/A&gt;<br>
&amp;gt;&nbsp;&lt;A&nbsp;HREF=&quot;http://lists.ximian.com/mailman/listinfo/mono-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-list&lt;/A&gt;<br>
<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
