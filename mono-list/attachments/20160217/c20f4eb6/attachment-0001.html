<tt>
&lt;span&nbsp;style=&quot;font-family:&nbsp;Tahoma,&nbsp;Geneva,&nbsp;Sans-Serif;&nbsp;font-size:&nbsp;14px&quot;&gt;&lt;div&gt;Have&nbsp;you&nbsp;tried&nbsp;checking&nbsp;out&nbsp;other&nbsp;project&nbsp;in&nbsp;GitHub&nbsp;or&nbsp;CodePlex?&nbsp;I've&nbsp;gotten&nbsp;some&nbsp;really&nbsp;good&nbsp;tips&nbsp;from&nbsp;reading&nbsp;other&nbsp;cross-platform&nbsp;code&nbsp;that&nbsp;deals&nbsp;with&nbsp;locking&nbsp;files.&nbsp;Just&nbsp;a&nbsp;suggestion.&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style=&quot;-webkit-touch-callout:&nbsp;none;&nbsp;-webkit-user-select:&nbsp;none;&nbsp;-khtml-user-select:&nbsp;none;-moz-user-select:&nbsp;none;-ms-user-select:&nbsp;none;-o-user-select:&nbsp;none;user-select:&nbsp;none;&quot;&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;hr&nbsp;align=&quot;center&quot;&nbsp;size=&quot;2&quot;&nbsp;width=&quot;100%&quot;&nbsp;/&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;tahoma,arial,sans-serif;&nbsp;font-size:&nbsp;10pt;&quot;&gt;&lt;b&gt;From&lt;/b&gt;:&nbsp;&quot;Edward&nbsp;Ned&nbsp;Harvey&nbsp;(mono)&quot;&nbsp;&lt;edward.harvey.mono@clevertrove.com&gt;&lt;br&nbsp;/&gt;<br>
&lt;b&gt;Sent&lt;/b&gt;:&nbsp;Wednesday,&nbsp;February&nbsp;17,&nbsp;2016&nbsp;9:46&nbsp;AM&lt;br&nbsp;/&gt;<br>
&lt;b&gt;To&lt;/b&gt;:&nbsp;&quot;shrimpywu&quot;&nbsp;&lt;shrimpywu@hotmail.com&gt;,&nbsp;&quot;mono-list@lists.ximian.com&quot;&nbsp;&lt;mono-list@lists.ximian.com&gt;&lt;br&nbsp;/&gt;<br>
&lt;b&gt;Subject&lt;/b&gt;:&nbsp;Re:&nbsp;[Mono-list]&nbsp;File&nbsp;Locking&lt;/span&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&gt;&nbsp;From:&nbsp;mono-list-bounces@lists.ximian.com&nbsp;[mailto:mono-list-&lt;br&nbsp;/&gt;<br>
&gt;&nbsp;bounces@lists.ximian.com]&nbsp;On&nbsp;Behalf&nbsp;Of&nbsp;shrimpywu&lt;br&nbsp;/&gt;<br>
&gt;&lt;br&nbsp;/&gt;<br>
&gt;&nbsp;i&nbsp;have&nbsp;the&nbsp;same&nbsp;issue.&nbsp;any&nbsp;solution?&lt;br&nbsp;/&gt;<br>
&lt;br&nbsp;/&gt;<br>
Kinda&nbsp;sorta.&nbsp;The&nbsp;underlying&nbsp;issue&nbsp;is&nbsp;that&nbsp;OSX,&nbsp;Linux,&nbsp;and&nbsp;Windows&nbsp;all&nbsp;have&nbsp;different&nbsp;underlying&nbsp;file&nbsp;locking&nbsp;constructs,&nbsp;and&nbsp;then&nbsp;of&nbsp;course,&nbsp;there's&nbsp;some&nbsp;variability&nbsp;about&nbsp;even&nbsp;*which*&nbsp;filesystem&nbsp;is&nbsp;being&nbsp;used.&nbsp;I&nbsp;didn't&nbsp;thoroughly&nbsp;figure&nbsp;out&nbsp;all&nbsp;the&nbsp;answers&nbsp;for&nbsp;every&nbsp;OS&nbsp;or&nbsp;filesystem,&nbsp;and&nbsp;I&nbsp;don't&nbsp;know&nbsp;under&nbsp;which&nbsp;situations&nbsp;this&nbsp;will&nbsp;be&nbsp;good&nbsp;enough,&nbsp;but&nbsp;this&nbsp;is&nbsp;what&nbsp;I&nbsp;ended&nbsp;up&nbsp;using,&nbsp;works&nbsp;under&nbsp;the&nbsp;conditions&nbsp;we&nbsp;needed&nbsp;it&nbsp;to&nbsp;work:&lt;br&nbsp;/&gt;<br>
&lt;br&nbsp;/&gt;<br>
using&nbsp;(var&nbsp;foo&nbsp;=&nbsp;new&nbsp;FileStream(filePath,&nbsp;FileMode.Open,&nbsp;FileAccess.ReadWrite,&nbsp;FileShare.None))&nbsp;{&nbsp;//&nbsp;must&nbsp;include&nbsp;Write&nbsp;access&nbsp;in&nbsp;order&nbsp;to&nbsp;lock&nbsp;file&lt;br&nbsp;/&gt;<br>
foo.Lock(0,&nbsp;0);&nbsp;//&nbsp;0,0&nbsp;has&nbsp;special&nbsp;meaning&nbsp;to&nbsp;lock&nbsp;entire&nbsp;file&nbsp;regardless&nbsp;of&nbsp;length&lt;br&nbsp;/&gt;<br>
}&lt;br&nbsp;/&gt;<br>
&lt;br&nbsp;/&gt;<br>
For&nbsp;windows,&nbsp;simply&nbsp;specifying&nbsp;the&nbsp;FileAccess&nbsp;and&nbsp;FileShare&nbsp;is&nbsp;good&nbsp;enough.&nbsp;For&nbsp;linux,&nbsp;at&nbsp;least&nbsp;ext4,&nbsp;files&nbsp;are&nbsp;concurrently&nbsp;readable&nbsp;regardless&nbsp;of&nbsp;what&nbsp;you&nbsp;specify&nbsp;for&nbsp;FileAccess&nbsp;and&nbsp;FileShare.&nbsp;The&nbsp;Lock()&nbsp;method&nbsp;does&nbsp;something&nbsp;of&nbsp;a&nbsp;soft-lock.&nbsp;It's&nbsp;not&nbsp;enforced&nbsp;by&nbsp;the&nbsp;OS,&nbsp;but&nbsp;at&nbsp;least&nbsp;all&nbsp;the&nbsp;situations&nbsp;we&nbsp;tried,&nbsp;other&nbsp;client&nbsp;apps&nbsp;honor&nbsp;the&nbsp;lock.&nbsp;Didn't&nbsp;look&nbsp;into&nbsp;it&nbsp;any&nbsp;deeper.&lt;br&nbsp;/&gt;<br>
_______________________________________________&lt;br&nbsp;/&gt;<br>
Mono-list&nbsp;maillist&nbsp;-&nbsp;Mono-list@lists.ximian.com&lt;br&nbsp;/&gt;<br>
http://lists.ximian.com/mailman/listinfo/mono-list&lt;br&nbsp;/&gt;<br>
&nbsp;&lt;/div&gt;&lt;/span&gt;<br>

</tt>
