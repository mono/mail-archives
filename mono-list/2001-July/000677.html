<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] PInvoke Conventions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:saurik%40saurik.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000674.html">
   <LINK REL="Next"  HREF="000679.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] PInvoke Conventions
   </H1>
    <B>Jay Freeman (saurik)
    </B> 
    <A HREF="mailto:saurik%40saurik.com"
       TITLE="[Mono-list] PInvoke Conventions">saurik@saurik.com
       </A><BR>
    <I>Tue, 17 Jul 2001 23:34:11 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="000674.html">[Mono-list] PInvoke Conventions
</A></li>
        <LI> Next message: <A HREF="000679.html">[Mono-list] PInvoke Conventions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#677">[ date ]</a>
              <a href="thread.html#677">[ thread ]</a>
              <a href="subject.html#677">[ subject ]</a>
              <a href="author.html#677">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Rhys:

Even easier than your SysInt marshalling it to just use the right data type
to begin with.  If you use the value type IntPtr the C# compiler is supposed
to compile that as &quot;native int&quot; (which is a valid datatype at the CLR
level), just as if you use Int32 the C# compiler compiles that as &quot;int&quot;; so
it isn't as if the code is working with a value type and doing strange
things with it at runtime.  That way you aren't hit with a marshalling cost
between the managed code that is treating it as one size and the PInvoke'd
call which is treating it as another.

Once again, that still doesn't help you with longs or shorts.

Sincerely,
Jay Freeman (saurik)
<A HREF="mailto:saurik@saurik.com">saurik@saurik.com</A>
----- Original Message -----
From: &quot;Rhys Weatherley&quot; &lt;<A HREF="mailto:rweather@zip.com.au">rweather@zip.com.au</A>&gt;
To: &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
Sent: Tuesday, July 17, 2001 9:02 PM
Subject: [Mono-list] PInvoke Conventions


&gt;<i> I've been investigating PInvoke support for Portable.NET,
</I>&gt;<i> and I've come across some icky issues that will probably
</I>&gt;<i> affect Mono's VM as well.
</I>&gt;<i>
</I>&gt;<i> In particular, because &quot;int&quot; and &quot;long&quot; have different types
</I>&gt;<i> on different CPU's, it is difficult to write PInvoke declarations
</I>&gt;<i> in C# that will work with all Unix libc's.  The result would
</I>&gt;<i> be libraries and applications that need to be compiled
</I>&gt;<i> separately for 32-bit and 64-bit systems.
</I>&gt;<i>
</I>&gt;<i> To avoid duplication of effort, I propose we come up with a
</I>&gt;<i> common way of solving these problems.  Towards that end,
</I>&gt;<i> I have placed the following document on my Web site that
</I>&gt;<i> describes how I think this can be resolved:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.southern-storm.com.au/pinvoke.html">http://www.southern-storm.com.au/pinvoke.html</A>
</I>&gt;<i>
</I>&gt;<i> Comments are welcome.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> Rhys.
</I>&gt;<i>
</I>&gt;<i> P.S. Thanks to the person who mentioned &quot;libffi&quot; as a way
</I>&gt;<i> of doing PInvoke.  That is a very nice library.
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000674.html">[Mono-list] PInvoke Conventions
</A></li>
	<LI> Next message: <A HREF="000679.html">[Mono-list] PInvoke Conventions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#677">[ date ]</a>
              <a href="thread.html#677">[ thread ]</a>
              <a href="subject.html#677">[ subject ]</a>
              <a href="author.html#677">[ author ]</a>
         </LI>
       </UL>
</body></html>
