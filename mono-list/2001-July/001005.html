<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] PInvoke Conventions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:935551%40ican.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001004.html">
   <LINK REL="Next"  HREF="001012.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] PInvoke Conventions
   </H1>
    <B>Richard Anthony Hein
    </B> 
    <A HREF="mailto:935551%40ican.net"
       TITLE="[Mono-list] PInvoke Conventions">935551@ican.net
       </A><BR>
    <I>Sun, 29 Jul 2001 23:59:23 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="001004.html">[Mono-list] PInvoke Conventions
</A></li>
        <LI> Next message: <A HREF="001012.html">[Mono-list] PInvoke Conventions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1005">[ date ]</a>
              <a href="thread.html#1005">[ thread ]</a>
              <a href="subject.html#1005">[ subject ]</a>
              <a href="author.html#1005">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the input; sounds like a simple enough explanation for a tricky
problem.  I guess MS doesn't have to worry about this, since they got
Portable.NET and Mono working on it. ;-)

The wrapper would only have to be compiled once, would it not?  Am I right
in thinking it acts as a layer between the .NET PE and the C\Unix APIs, and
therefore only needs to be compiled once on a particular platform?

If so, why is that considered a problem?  From the sounds of it the wrapper
option would make it possible for plenty of other groups to develop wrappers
for their platform, instead of putting all the responsibility on Mono to
have this VM that works well everywhere.  But I am just getting into this
stuff, so what do I know.

Regards,

Richard Anthony Hein


&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>]On
</I>&gt;<i> Behalf Of Fergus Henderson
</I>&gt;<i> Sent: July 29, 2001 11:24 PM
</I>&gt;<i> To: Richard Anthony Hein
</I>&gt;<i> Cc: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
</I>&gt;<i> Subject: Re: [Mono-list] PInvoke Conventions
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 29-Jul-2001, Richard Anthony Hein &lt;<A HREF="mailto:935551@ican.net">935551@ican.net</A>&gt; wrote:
</I>&gt;<i> &gt; I have been trying to follow this thread, but could someone
</I>&gt;<i> perhaps give
</I>&gt;<i> &gt; high-level explanation of the conflict?
</I>&gt;<i>
</I>&gt;<i> Sure.
</I>&gt;<i>
</I>&gt;<i> Many of the .NET APIs will need to be implemented using code
</I>&gt;<i> that calls C/Unix
</I>&gt;<i> APIs, such as stat().  The standard way of interfacing with
</I>&gt;<i> native code from
</I>&gt;<i> NET code is to use &quot;PInvoke&quot;.  However, there is a difficulty: many of
</I>&gt;<i> these APIs are defined in terms of types such as C's `long'
</I>&gt;<i> or `size_t'
</I>&gt;<i> or the Posix `struct stat' whose representation varies
</I>&gt;<i> depending on the
</I>&gt;<i> platform (architecture/OS/C compiler).  There's no *portable* way of
</I>&gt;<i> accessing those from .NET managed code.
</I>&gt;<i>
</I>&gt;<i> So, there are a couple of different approaches.
</I>&gt;<i> One possibility is to access such routines by writing a
</I>&gt;<i> wrapper, e.g. in C,
</I>&gt;<i> that provides the same functionality without using types with
</I>&gt;<i> a system-dependent
</I>&gt;<i> representation.  The wrapper can then be directly accessed
</I>&gt;<i> from portable
</I>&gt;<i> NET code.  The .NET code remains both source- and binary-portable;
</I>&gt;<i> the wrapper code is source-portable, but needs to be compiled
</I>&gt;<i> seperately for each target platform.  The drawback of this approach is
</I>&gt;<i> that you have to write a lot of cumbersome wrapper code.
</I>&gt;<i>
</I>&gt;<i> Another possibility is to extend the .NET VM with support for an
</I>&gt;<i> additional custom attribute, e.g. &quot;[PosixType]&quot;.  The VM would then
</I>&gt;<i> represent types tagged with this attribute in the same way that the
</I>&gt;<i> underlying system represents those types.  With this approach, no
</I>&gt;<i> wrapper code would be needed.  A drawback of this approach is that it
</I>&gt;<i> pushes quite a bit of complexity into the VM; the VM would
</I>&gt;<i> have to know
</I>&gt;<i> the native representation of all types annotated with this attribute.
</I>&gt;<i> Another drawback is that code using this extension might not work on
</I>&gt;<i> different VMs.
</I>&gt;<i>
</I>&gt;<i> There have also been some other suggestions, but those are
</I>&gt;<i> the two that
</I>&gt;<i> I think are the best.
</I>&gt;<i>
</I>&gt;<i> &gt; What is the problem implementing PInvoke
</I>&gt;<i>
</I>&gt;<i> There's no problem implementing PInvoke as specified in the ECMA
</I>&gt;<i> specs and/or MS documentation.  It's just that PInvoke by itself
</I>&gt;<i> doesn't solve all of the problems; in particular it doesn't solve
</I>&gt;<i> the problem of C types whose representation is different on different
</I>&gt;<i> systems.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Fergus Henderson &lt;<A HREF="mailto:fjh@cs.mu.oz.au">fjh@cs.mu.oz.au</A>&gt;  |  &quot;I have always known
</I>&gt;<i> that the pursuit
</I>&gt;<i> The University of Melbourne         |  of excellence is a
</I>&gt;<i> lethal habit&quot;
</I>&gt;<i> WWW: &lt;<A HREF="http://www.cs.mu.oz.au/~fjh">http://www.cs.mu.oz.au/~fjh</A>&gt;  |     -- the last words
</I>&gt;<i> of T. S. Garp.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001004.html">[Mono-list] PInvoke Conventions
</A></li>
	<LI> Next message: <A HREF="001012.html">[Mono-list] PInvoke Conventions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1005">[ date ]</a>
              <a href="thread.html#1005">[ thread ]</a>
              <a href="subject.html#1005">[ subject ]</a>
              <a href="author.html#1005">[ author ]</a>
         </LI>
       </UL>
</body></html>
