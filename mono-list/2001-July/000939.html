<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] PInvoke:TNG
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rweather%40zip.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000934.html">
   <LINK REL="Next"  HREF="000940.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] PInvoke:TNG
   </H1>
    <B>Rhys Weatherley
    </B> 
    <A HREF="mailto:rweather%40zip.com.au"
       TITLE="[Mono-list] PInvoke:TNG">rweather@zip.com.au
       </A><BR>
    <I>Fri, 27 Jul 2001 11:30:17 +1000</I>
    <P><UL>
        <LI> Previous message: <A HREF="000934.html">[Mono-list] PInvoke:TNG
</A></li>
        <LI> Next message: <A HREF="000940.html">[Mono-list] PInvoke:TNG
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#939">[ date ]</a>
              <a href="thread.html#939">[ thread ]</a>
              <a href="subject.html#939">[ subject ]</a>
              <a href="author.html#939">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Fergus Henderson wrote:

&gt;<i> The syntax is quite elegant, but you're pushing a lot of the complexity into
</I>&gt;<i> the VM engine.
</I>&gt;<i>
</I>&gt;<i> How exactly is the VM engine supposed to handle the [PosixType] custom attribute?
</I>&gt;<i> Is it supposed to have a hard-coded list of types and their layouts,
</I>
That's the assumption, yes, and it _is_ a drawback of this
approach.  Any other approach will need something equally
yucky.  Something somewhere needs to know how what the
real underlying type is.  Either the VM does it, or we #ifdef
the C# library to compile differently for platforms with
different type sizes.  The VM-based mechanism is the
&quot;least yucky&quot;.

&gt;<i> and to report an error if the type name doesn't match one of the types in
</I>&gt;<i> its hard-coded list?
</I>
There's two ways to handle this case: raise an error, or
make a guess.  In the definitions in my previous message,
the &quot;value&quot; field was declared as &quot;int&quot; for &quot;int_t&quot; and as
&quot;long&quot; for &quot;off_t&quot;.  This information could be used to guess
the native counterpart in the absence of other information.
For example, consider the following definition of &quot;size_t&quot;:

[PosixType]
public struct size_t
{
    private uint value;
    ... constructor and conversion operators ...
};

If the VM didn't know about &quot;size_t&quot;, it could guess
from the type of &quot;value&quot; that a &quot;native unsigned int&quot;
was intended.  It's another one of those &quot;least yucky&quot;
things.

I am becoming a little concerned though that the PInvoke
mechanism will involve a huge amount of code to
implement in any given VM.  This increases the chance
of error, and hence interoperability will be affected.

Cheers,

Rhys.




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000934.html">[Mono-list] PInvoke:TNG
</A></li>
	<LI> Next message: <A HREF="000940.html">[Mono-list] PInvoke:TNG
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#939">[ date ]</a>
              <a href="thread.html#939">[ thread ]</a>
              <a href="subject.html#939">[ subject ]</a>
              <a href="author.html#939">[ author ]</a>
         </LI>
       </UL>
</body></html>
