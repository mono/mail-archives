<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Int32.CompareTo() bug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:ndrochak%40gol.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002311.html">
   <LINK REL="Next"  HREF="002314.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Int32.CompareTo() bug
   </H1>
    <B>Nick Drochak
    </B> 
    <A HREF="mailto:ndrochak%40gol.com"
       TITLE="[Mono-list] Int32.CompareTo() bug">ndrochak@gol.com
       </A><BR>
    <I>Thu, 29 Nov 2001 00:13:20 +0900</I>
    <P><UL>
        <LI> Previous message: <A HREF="002311.html">[Mono-list] IntegerFormatter
</A></li>
        <LI> Next message: <A HREF="002314.html">[Mono-list] Int32.CompareTo() bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2312">[ date ]</a>
              <a href="thread.html#2312">[ thread ]</a>
              <a href="subject.html#2312">[ subject ]</a>
              <a href="author.html#2312">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Miguel,

Int32.CompareTo(object v) has a bug.  Your solution is to return the
difference (which seems obvious):
	return value - (int) v;

However, when value and/or v are close to (or equal) MaxValue and
MinValue respectively, the arithmetic causes the bits to roll over and
produce strange results. For example, try it with
MaxValue.CompareTo(MinValue).  Your method returns zero.

I struggled to come up with a solution to this but couldn't before I got
too tired, or because I was too tired...yeah, that's it.

Oh yeah, and bug #2.  The docs say that if v is null, CompareTo() should
return a value greater than zero.  It seems that you throw an exception.


Regards,
Nick D.

P.S. Thanks to Mario for writing the test that caught this.




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002311.html">[Mono-list] IntegerFormatter
</A></li>
	<LI> Next message: <A HREF="002314.html">[Mono-list] Int32.CompareTo() bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2312">[ date ]</a>
              <a href="thread.html#2312">[ thread ]</a>
              <a href="subject.html#2312">[ subject ]</a>
              <a href="author.html#2312">[ author ]</a>
         </LI>
       </UL>
</body></html>
