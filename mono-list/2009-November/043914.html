<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list]  mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20%20mono%202.4.2.3%20openoffice%203%20cli_uno_bridge%20broken%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043906.html">
   <LINK REL="Next"  HREF="043927.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list]  mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?</H1>
    <B>luckyluke222</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20%20mono%202.4.2.3%20openoffice%203%20cli_uno_bridge%20broken%3F&In-Reply-To="
       TITLE="[Mono-list]  mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?">f.meyer at seestream.com
       </A><BR>
    <I>Mon Nov 23 11:49:52 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="043906.html">[Mono-list] Mono 2.4.x on ARM (Qemu)
</A></li>
        <LI>Next message: <A HREF="043927.html">[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43914">[ date ]</a>
              <a href="thread.html#43914">[ thread ]</a>
              <a href="subject.html#43914">[ subject ]</a>
              <a href="author.html#43914">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

I'm desperatly trying to make the interop between C# and OpenOffice work on
Linux using mono. (My program does work on Windows).

Technical context:
- OpenSuse 11.1 mono VM that is downloadable from mono web site,
- installed (with YaST) Java, OpenOffice 3.0.0.9 as well as the
OpenOffice_org-mono packages (and all required dependencies)
- SpreadsheetSample from ooo-build

First I had to fix the SpreadsheetSample makefile to sucessfully build it
(--libs mono-ooo3 rather than --libs mono-ooo-3.0).

And then, when I ran the sample, I got an exception in the mono runtime
(pasted at the end of this post).
I searched in every possible places, found very few articles about this
interop and worse, even less that have less than around 1 year old! Does
anybody have sucesfully tried lately and would provide me with any valuable
hint? Would I have more chance with a news build of OpenOffice/OOO (and
possibly even mono 2.6?)

Thanks!

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">rupert at linux</A>:~/Desktop/Download/ooosample&gt; mono ./SpreadsheetSample.exe
Stacktrace:

  at (wrapper managed-to-native) uno.util.Bootstrap.native_bootstrap ()
&lt;0x00004&gt;
  at (wrapper managed-to-native) uno.util.Bootstrap.native_bootstrap ()
&lt;0xffffffff&gt;
  at uno.util.Bootstrap.bootstrap () &lt;0x0000d&gt;
  at SpreadsheetDocHelper.connect (string[]) &lt;0x00010&gt;
  at SpreadsheetDocHelper..ctor (string[]) &lt;0x00015&gt;
  at SpreadsheetSample..ctor (string[]) &lt;0x00013&gt;
  at SpreadsheetSample.Main (string[]) &lt;0x00032&gt;
  at (wrapper runtime-invoke) SpreadsheetSample.runtime_invoke_void_object
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;

Native stacktrace:

	mono [0x80cbfe4]
	mono [0x80f66bb]
	[0xffffe410]
	mono(mono_assembly_get_image+0x7) [0x816ced7]
	/usr/lib/ooo3/ure/lib/libcli_uno.so(uno_ext_getMapping+0x12d) [0xb4578c3a]
	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3 [0xb6bbe8a6]
	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3 [0xb6bbed96]
	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3(uno_getMapping+0xc9d) [0xb6bbfad5]
	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3(uno_getMappingByName+0x91)
[0xb6bbfba1]
	/usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so [0xb6c2af14]

/usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so(native_bootstrap+0x27)
[0xb6c2b070]
	[0xb71bb6b6]
	[0xb71bb5c6]
	[0xb71bb4f1]
	[0xb71bb45e]
	[0xb71bb434]
	[0xb71bb2cb]
	[0xb71bb203]
	mono(mono_runtime_exec_main+0xe5) [0x8113825]
	mono(mono_runtime_run_main+0x16b) [0x8113fcb]
	mono(mono_main+0x18fa) [0x80b388a]
	mono [0x805af21]
	/lib/libc.so.6(__libc_start_main+0xe5) [0xb75a0705]
	mono [0x805ae51]

Debug info from gdb:

(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
[New Thread 0xb557db90 (LWP 32440)]
[New Thread 0xb5dd2b90 (LWP 32437)]
[New Thread 0xb6dfdb90 (LWP 32411)]
[New Thread 0xb6e21b90 (LWP 32410)]
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
0xffffe430 in __kernel_vsyscall ()
  5 Thread 0xb6e21b90 (LWP 32410)  0xffffe430 in __kernel_vsyscall ()
  4 Thread 0xb6dfdb90 (LWP 32411)  0xffffe430 in __kernel_vsyscall ()
  3 Thread 0xb5dd2b90 (LWP 32437)  0xffffe430 in __kernel_vsyscall ()
  2 Thread 0xb557db90 (LWP 32440)  0xffffe430 in __kernel_vsyscall ()
* 1 Thread 0xb75556f0 (LWP 32409)  0xffffe430 in __kernel_vsyscall ()

Thread 5 (Thread 0xb6e21b90 (LWP 32410)):
#0  0xffffe430 in __kernel_vsyscall ()
#1  0xb771c3f6 in nanosleep () from /lib/libpthread.so.0
#2  0x081a91f8 in ?? ()
#3  0xb77151b5 in start_thread () from /lib/libpthread.so.0
#4  0xb765b3ae in clone () from /lib/libc.so.6

Thread 4 (Thread 0xb6dfdb90 (LWP 32411)):
#0  0xffffe430 in __kernel_vsyscall ()
#1  0xb771aef5 in sem_wait@@GLIBC_2.1 () from /lib/libpthread.so.0
#2  0x0812eed9 in ?? ()
#3  0x08153188 in ?? ()
#4  0x081c5d66 in ?? ()
#5  0x081e5aa5 in ?? ()
#6  0xb77151b5 in start_thread () from /lib/libpthread.so.0
#7  0xb765b3ae in clone () from /lib/libc.so.6

Thread 3 (Thread 0xb5dd2b90 (LWP 32437)):
#0  0xffffe430 in __kernel_vsyscall ()
#1  0xb7718c35 in pthread_cond_wait@@GLIBC_2.3.2 () from
/lib/libpthread.so.0
#2  0xb6be2e21 in osl_waitCondition () from
/usr/lib/ooo3/ure/lib/libuno_sal.so.3
#3  0xb558c7f0 in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
#4  0xb5581d5d in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
#5  0xb6be657f in ?? () from /usr/lib/ooo3/ure/lib/libuno_sal.so.3
#6  0xb77151b5 in start_thread () from /lib/libpthread.so.0
#7  0xb765b3ae in clone () from /lib/libc.so.6

Thread 2 (Thread 0xb557db90 (LWP 32440)):
#0  0xffffe430 in __kernel_vsyscall ()
#1  0xb771bef8 in recv () from /lib/libpthread.so.0
#2  0xb6bedb6c in osl_receivePipe () from
/usr/lib/ooo3/ure/lib/libuno_sal.so.3
#3  0xb6bedb9c in osl_readPipe () from /usr/lib/ooo3/ure/lib/libuno_sal.so.3
#4  0xb55c2159 in ?? () from /usr/lib/ooo3/ure/lib/connector.uno.so
#5  0xb55a5bd4 in ?? () from /usr/lib/ooo3/ure/lib/remotebridge.uno.so
#6  0xb558b74c in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
#7  0xb558890b in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
#8  0xb5581d5d in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
#9  0xb6be657f in ?? () from /usr/lib/ooo3/ure/lib/libuno_sal.so.3
#10 0xb77151b5 in start_thread () from /lib/libpthread.so.0
#11 0xb765b3ae in clone () from /lib/libc.so.6

Thread 1 (Thread 0xb75556f0 (LWP 32409)):
#0  0xffffe430 in __kernel_vsyscall ()
#1  0xb771bbbb in read () from /lib/libpthread.so.0
#2  0x080cc186 in ?? ()
#3  0x080f66bb in ?? ()
#4  &lt;signal handler called&gt;
#5  0x0816ced7 in mono_assembly_get_image ()
#6  0xb4578c3a in uno_ext_getMapping () from
/usr/lib/ooo3/ure/lib/libcli_uno.so
#7  0xb6bbe8a6 in ?? () from /usr/lib/ooo3/ure/lib/libuno_cppu.so.3
#8  0xb6bbed96 in ?? () from /usr/lib/ooo3/ure/lib/libuno_cppu.so.3
#9  0xb6bbfad5 in uno_getMapping () from
/usr/lib/ooo3/ure/lib/libuno_cppu.so.3
#10 0xb6bbfba1 in uno_getMappingByName () from
/usr/lib/ooo3/ure/lib/libuno_cppu.so.3
#11 0xb6c2af14 in ?? () from
/usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so
#12 0xb6c2b070 in native_bootstrap () from
/usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so
#13 0xb71bb6b6 in ?? ()
#14 0xb71bb5c6 in ?? ()
#15 0xb71bb4f1 in ?? ()
#16 0xb71bb45e in ?? ()
#17 0xb71bb434 in ?? ()
#18 0xb71bb2cb in ?? ()
#19 0xb71bb203 in ?? ()
#20 0x08113825 in mono_runtime_exec_main ()
#21 0x08113fcb in mono_runtime_run_main ()
#22 0x080b388a in mono_main ()
#23 0x0805af21 in ?? ()
#24 0xb75a0705 in __libc_start_main () from /lib/libc.so.6
#25 0x0805ae51 in ?? ()

=================================================================
Got a SIGSEGV while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries 
used by your application.
=================================================================

Aborted
-- 
View this message in context: <A HREF="http://old.nabble.com/mono-2.4.2.3-openoffice-3-cli_uno_bridge-broken--tp26443556p26443556.html">http://old.nabble.com/mono-2.4.2.3-openoffice-3-cli_uno_bridge-broken--tp26443556p26443556.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043906.html">[Mono-list] Mono 2.4.x on ARM (Qemu)
</A></li>
	<LI>Next message: <A HREF="043927.html">[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43914">[ date ]</a>
              <a href="thread.html#43914">[ thread ]</a>
              <a href="subject.html#43914">[ subject ]</a>
              <a href="author.html#43914">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
