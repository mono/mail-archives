<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20mono%202.4.2.3%20openoffice%203%20cli_uno_bridge%20broken%3F&In-Reply-To=1259181604.4513.256.camel%40erandi.site">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043927.html">
   <LINK REL="Next"  HREF="043936.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?</H1>
    <B>Michael Meeks</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20mono%202.4.2.3%20openoffice%203%20cli_uno_bridge%20broken%3F&In-Reply-To=1259181604.4513.256.camel%40erandi.site"
       TITLE="[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?">michael.meeks at novell.com
       </A><BR>
    <I>Thu Nov 26 04:50:13 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="043927.html">[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
</A></li>
        <LI>Next message: <A HREF="043936.html">[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43935">[ date ]</a>
              <a href="thread.html#43935">[ thread ]</a>
              <a href="subject.html#43935">[ subject ]</a>
              <a href="author.html#43935">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Luke,

On Wed, 2009-11-25 at 15:40 -0500, Miguel de Icaza wrote:
&gt;<i>     I have CCed Michael Meeks who works in our Open Office team,
</I>&gt;<i> perhaps he can shed some light as to what is needed.
</I>
	Thanks Miguel :-)

&gt;<i> &gt; I'm desperatly trying to make the interop between C# and OpenOffice work on
</I>&gt;<i> &gt; Linux using mono. (My program does work on Windows).
</I>
	Soo ... I guess the best person to poke is Petr Mladek, who packages
and tends to help debug this sort of problem more regularly than I :-)

	Petr - did this work in 11.1 ?

	Luke - have you tried the latest / unstable 3.x packages from the
update repos ?

<A HREF="http://download.opensuse.org/repositories/OpenOffice.org:/UNSTABLE/openSUSE_11.1/i586/">http://download.opensuse.org/repositories/OpenOffice.org:/UNSTABLE/openSUSE_11.1/i586/</A>

	it'd be good to debug/test there so we get this right in the next
release.

	Thanks,

		Michael.

&gt;<i> &gt; Technical context:
</I>&gt;<i> &gt; - OpenSuse 11.1 mono VM that is downloadable from mono web site,
</I>&gt;<i> &gt; - installed (with YaST) Java, OpenOffice 3.0.0.9 as well as the
</I>&gt;<i> &gt; OpenOffice_org-mono packages (and all required dependencies)
</I>&gt;<i> &gt; - SpreadsheetSample from ooo-build
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; First I had to fix the SpreadsheetSample makefile to sucessfully build it
</I>&gt;<i> &gt; (--libs mono-ooo3 rather than --libs mono-ooo-3.0).
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; And then, when I ran the sample, I got an exception in the mono runtime
</I>&gt;<i> &gt; (pasted at the end of this post).
</I>&gt;<i> &gt; I searched in every possible places, found very few articles about this
</I>&gt;<i> &gt; interop and worse, even less that have less than around 1 year old! Does
</I>&gt;<i> &gt; anybody have sucesfully tried lately and would provide me with any valuable
</I>&gt;<i> &gt; hint? Would I have more chance with a news build of OpenOffice/OOO (and
</I>&gt;<i> &gt; possibly even mono 2.6?)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thanks!
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">rupert at linux</A>:~/Desktop/Download/ooosample&gt; mono ./SpreadsheetSample.exe
</I>&gt;<i> &gt; Stacktrace:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   at (wrapper managed-to-native) uno.util.Bootstrap.native_bootstrap ()
</I>&gt;<i> &gt; &lt;0x00004&gt;
</I>&gt;<i> &gt;   at (wrapper managed-to-native) uno.util.Bootstrap.native_bootstrap ()
</I>&gt;<i> &gt; &lt;0xffffffff&gt;
</I>&gt;<i> &gt;   at uno.util.Bootstrap.bootstrap () &lt;0x0000d&gt;
</I>&gt;<i> &gt;   at SpreadsheetDocHelper.connect (string[]) &lt;0x00010&gt;
</I>&gt;<i> &gt;   at SpreadsheetDocHelper..ctor (string[]) &lt;0x00015&gt;
</I>&gt;<i> &gt;   at SpreadsheetSample..ctor (string[]) &lt;0x00013&gt;
</I>&gt;<i> &gt;   at SpreadsheetSample.Main (string[]) &lt;0x00032&gt;
</I>&gt;<i> &gt;   at (wrapper runtime-invoke) SpreadsheetSample.runtime_invoke_void_object
</I>&gt;<i> &gt; (object,intptr,intptr,intptr) &lt;0xffffffff&gt;
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Native stacktrace:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 	mono [0x80cbfe4]
</I>&gt;<i> &gt; 	mono [0x80f66bb]
</I>&gt;<i> &gt; 	[0xffffe410]
</I>&gt;<i> &gt; 	mono(mono_assembly_get_image+0x7) [0x816ced7]
</I>&gt;<i> &gt; 	/usr/lib/ooo3/ure/lib/libcli_uno.so(uno_ext_getMapping+0x12d) [0xb4578c3a]
</I>&gt;<i> &gt; 	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3 [0xb6bbe8a6]
</I>&gt;<i> &gt; 	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3 [0xb6bbed96]
</I>&gt;<i> &gt; 	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3(uno_getMapping+0xc9d) [0xb6bbfad5]
</I>&gt;<i> &gt; 	/usr/lib/ooo3/ure/lib/libuno_cppu.so.3(uno_getMappingByName+0x91)
</I>&gt;<i> &gt; [0xb6bbfba1]
</I>&gt;<i> &gt; 	/usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so [0xb6c2af14]
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; /usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so(native_bootstrap+0x27)
</I>&gt;<i> &gt; [0xb6c2b070]
</I>&gt;<i> &gt; 	[0xb71bb6b6]
</I>&gt;<i> &gt; 	[0xb71bb5c6]
</I>&gt;<i> &gt; 	[0xb71bb4f1]
</I>&gt;<i> &gt; 	[0xb71bb45e]
</I>&gt;<i> &gt; 	[0xb71bb434]
</I>&gt;<i> &gt; 	[0xb71bb2cb]
</I>&gt;<i> &gt; 	[0xb71bb203]
</I>&gt;<i> &gt; 	mono(mono_runtime_exec_main+0xe5) [0x8113825]
</I>&gt;<i> &gt; 	mono(mono_runtime_run_main+0x16b) [0x8113fcb]
</I>&gt;<i> &gt; 	mono(mono_main+0x18fa) [0x80b388a]
</I>&gt;<i> &gt; 	mono [0x805af21]
</I>&gt;<i> &gt; 	/lib/libc.so.6(__libc_start_main+0xe5) [0xb75a0705]
</I>&gt;<i> &gt; 	mono [0x805ae51]
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Debug info from gdb:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; [Thread debugging using libthread_db enabled]
</I>&gt;<i> &gt; [New Thread 0xb557db90 (LWP 32440)]
</I>&gt;<i> &gt; [New Thread 0xb5dd2b90 (LWP 32437)]
</I>&gt;<i> &gt; [New Thread 0xb6dfdb90 (LWP 32411)]
</I>&gt;<i> &gt; [New Thread 0xb6e21b90 (LWP 32410)]
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; (no debugging symbols found)
</I>&gt;<i> &gt; 0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt;   5 Thread 0xb6e21b90 (LWP 32410)  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt;   4 Thread 0xb6dfdb90 (LWP 32411)  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt;   3 Thread 0xb5dd2b90 (LWP 32437)  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt;   2 Thread 0xb557db90 (LWP 32440)  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt; * 1 Thread 0xb75556f0 (LWP 32409)  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thread 5 (Thread 0xb6e21b90 (LWP 32410)):
</I>&gt;<i> &gt; #0  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt; #1  0xb771c3f6 in nanosleep () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #2  0x081a91f8 in ?? ()
</I>&gt;<i> &gt; #3  0xb77151b5 in start_thread () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #4  0xb765b3ae in clone () from /lib/libc.so.6
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thread 4 (Thread 0xb6dfdb90 (LWP 32411)):
</I>&gt;<i> &gt; #0  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt; #1  0xb771aef5 in sem_wait@@GLIBC_2.1 () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #2  0x0812eed9 in ?? ()
</I>&gt;<i> &gt; #3  0x08153188 in ?? ()
</I>&gt;<i> &gt; #4  0x081c5d66 in ?? ()
</I>&gt;<i> &gt; #5  0x081e5aa5 in ?? ()
</I>&gt;<i> &gt; #6  0xb77151b5 in start_thread () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #7  0xb765b3ae in clone () from /lib/libc.so.6
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thread 3 (Thread 0xb5dd2b90 (LWP 32437)):
</I>&gt;<i> &gt; #0  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt; #1  0xb7718c35 in pthread_cond_wait@@GLIBC_2.3.2 () from
</I>&gt;<i> &gt; /lib/libpthread.so.0
</I>&gt;<i> &gt; #2  0xb6be2e21 in osl_waitCondition () from
</I>&gt;<i> &gt; /usr/lib/ooo3/ure/lib/libuno_sal.so.3
</I>&gt;<i> &gt; #3  0xb558c7f0 in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
</I>&gt;<i> &gt; #4  0xb5581d5d in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
</I>&gt;<i> &gt; #5  0xb6be657f in ?? () from /usr/lib/ooo3/ure/lib/libuno_sal.so.3
</I>&gt;<i> &gt; #6  0xb77151b5 in start_thread () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #7  0xb765b3ae in clone () from /lib/libc.so.6
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thread 2 (Thread 0xb557db90 (LWP 32440)):
</I>&gt;<i> &gt; #0  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt; #1  0xb771bef8 in recv () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #2  0xb6bedb6c in osl_receivePipe () from
</I>&gt;<i> &gt; /usr/lib/ooo3/ure/lib/libuno_sal.so.3
</I>&gt;<i> &gt; #3  0xb6bedb9c in osl_readPipe () from /usr/lib/ooo3/ure/lib/libuno_sal.so.3
</I>&gt;<i> &gt; #4  0xb55c2159 in ?? () from /usr/lib/ooo3/ure/lib/connector.uno.so
</I>&gt;<i> &gt; #5  0xb55a5bd4 in ?? () from /usr/lib/ooo3/ure/lib/remotebridge.uno.so
</I>&gt;<i> &gt; #6  0xb558b74c in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
</I>&gt;<i> &gt; #7  0xb558890b in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
</I>&gt;<i> &gt; #8  0xb5581d5d in ?? () from /usr/lib/ooo3/ure/lib/liburp_uno.so
</I>&gt;<i> &gt; #9  0xb6be657f in ?? () from /usr/lib/ooo3/ure/lib/libuno_sal.so.3
</I>&gt;<i> &gt; #10 0xb77151b5 in start_thread () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #11 0xb765b3ae in clone () from /lib/libc.so.6
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thread 1 (Thread 0xb75556f0 (LWP 32409)):
</I>&gt;<i> &gt; #0  0xffffe430 in __kernel_vsyscall ()
</I>&gt;<i> &gt; #1  0xb771bbbb in read () from /lib/libpthread.so.0
</I>&gt;<i> &gt; #2  0x080cc186 in ?? ()
</I>&gt;<i> &gt; #3  0x080f66bb in ?? ()
</I>&gt;<i> &gt; #4  &lt;signal handler called&gt;
</I>&gt;<i> &gt; #5  0x0816ced7 in mono_assembly_get_image ()
</I>&gt;<i> &gt; #6  0xb4578c3a in uno_ext_getMapping () from
</I>&gt;<i> &gt; /usr/lib/ooo3/ure/lib/libcli_uno.so
</I>&gt;<i> &gt; #7  0xb6bbe8a6 in ?? () from /usr/lib/ooo3/ure/lib/libuno_cppu.so.3
</I>&gt;<i> &gt; #8  0xb6bbed96 in ?? () from /usr/lib/ooo3/ure/lib/libuno_cppu.so.3
</I>&gt;<i> &gt; #9  0xb6bbfad5 in uno_getMapping () from
</I>&gt;<i> &gt; /usr/lib/ooo3/ure/lib/libuno_cppu.so.3
</I>&gt;<i> &gt; #10 0xb6bbfba1 in uno_getMappingByName () from
</I>&gt;<i> &gt; /usr/lib/ooo3/ure/lib/libuno_cppu.so.3
</I>&gt;<i> &gt; #11 0xb6c2af14 in ?? () from
</I>&gt;<i> &gt; /usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so
</I>&gt;<i> &gt; #12 0xb6c2b070 in native_bootstrap () from
</I>&gt;<i> &gt; /usr/lib/ooo3/basis-link/ure-link/lib/libcli_uno_glue.so
</I>&gt;<i> &gt; #13 0xb71bb6b6 in ?? ()
</I>&gt;<i> &gt; #14 0xb71bb5c6 in ?? ()
</I>&gt;<i> &gt; #15 0xb71bb4f1 in ?? ()
</I>&gt;<i> &gt; #16 0xb71bb45e in ?? ()
</I>&gt;<i> &gt; #17 0xb71bb434 in ?? ()
</I>&gt;<i> &gt; #18 0xb71bb2cb in ?? ()
</I>&gt;<i> &gt; #19 0xb71bb203 in ?? ()
</I>&gt;<i> &gt; #20 0x08113825 in mono_runtime_exec_main ()
</I>&gt;<i> &gt; #21 0x08113fcb in mono_runtime_run_main ()
</I>&gt;<i> &gt; #22 0x080b388a in mono_main ()
</I>&gt;<i> &gt; #23 0x0805af21 in ?? ()
</I>&gt;<i> &gt; #24 0xb75a0705 in __libc_start_main () from /lib/libc.so.6
</I>&gt;<i> &gt; #25 0x0805ae51 in ?? ()
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; =================================================================
</I>&gt;<i> &gt; Got a SIGSEGV while executing native code. This usually indicates
</I>&gt;<i> &gt; a fatal error in the mono runtime or one of the native libraries 
</I>&gt;<i> &gt; used by your application.
</I>&gt;<i> &gt; =================================================================
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Aborted
</I>&gt;<i> 
</I>-- 
 <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">michael.meeks at novell.com</A>  &lt;&gt;&lt;, Pseudo Engineer, itinerant idiot


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043927.html">[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
</A></li>
	<LI>Next message: <A HREF="043936.html">[Mono-list] mono 2.4.2.3 openoffice 3 cli_uno_bridge broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43935">[ date ]</a>
              <a href="thread.html#43935">[ thread ]</a>
              <a href="subject.html#43935">[ subject ]</a>
              <a href="author.html#43935">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
