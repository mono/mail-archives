<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] GetDirectories, glob, and high ACSII characters
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:efeingold%40mn.rr.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="012831.html">
   <LINK REL="Next"  HREF="012833.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] GetDirectories, glob, and high ACSII characters
   </H1>
    <B>Elan Feingold
    </B> 
    <A HREF="mailto:efeingold%40mn.rr.com"
       TITLE="[Mono-list] GetDirectories, glob, and high ACSII characters">efeingold@mn.rr.com
       </A><BR>
    <I>Mon, 10 Mar 2003 07:34:58 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="012831.html">[Mono-list] System.Web.Mail + UUEncoding = true
</A></li>
        <LI> Next message: <A HREF="012833.html">[Mono-list] Interesting Articles on Remoting and Security
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12832">[ date ]</a>
              <a href="thread.html#12832">[ thread ]</a>
              <a href="subject.html#12832">[ subject ]</a>
              <a href="author.html#12832">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0001_01C2E6D7.8D94EDE0
Content-Type: text/plain;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: 7bit

Hi,

 

Has anyone else noticed that the GetDirectories code (and probably file
listing code) doesn't return directories with &quot;foreign&quot; characters
(accented letters, etc.)?

 

I traced this down to the call to glob() which, when compiled in a test
C program, returns all the directories, but for some reason within Mono
doesn't.

 

Is this some locale related strangeness??????

 

Best regards,

 

-elan

 

        DirectoryInfo dirInfo = new DirectoryInfo(dir);

        DirectoryInfo[] subDirs = dirInfo.GetDirectories();

 

        foreach (DirectoryInfo subDir in subDirs)

        {

            Console.WriteLine(&quot;Directory is: {0}.&quot;,  subDir.Name);

        }

 

This code lists the offending directory in a small test program, but not
when embedded into the Mono source:

 

    glob_t globbuf;

    int i = 0;

    

    glob(&quot;/mnt/trove/Music/Blonde Redhead/*&quot;, 0, NULL, &amp;globbuf);

 

    printf(&quot;Matches: %d\n&quot;, globbuf.gl_pathc);

    for (i=0; i&lt;globbuf.gl_pathc; i++)

        printf(&quot; -&gt; '%s'\n&quot;, globbuf.gl_pathv[i]);


------=_NextPart_000_0001_01C2E6D7.8D94EDE0
Content-Type: text/html;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable

&lt;html&gt;

&lt;head&gt;
&lt;META HTTP-EQUIV=3D&quot;Content-Type&quot; CONTENT=3D&quot;text/html; =
charset=3Dus-ascii&quot;&gt;


&lt;meta name=3DGenerator content=3D&quot;Microsoft Word 10 (filtered)&quot;&gt;

&lt;style&gt;
&lt;!--
 /* Font Definitions */
 @font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:&quot;Times New Roman&quot;;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{font-family:Georgia;
	color:windowtext;
	font-weight:normal;
	font-style:normal;
	text-decoration:none none;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.Section1
	{page:Section1;}
--&gt;
&lt;/style&gt;

&lt;/head&gt;

&lt;body lang=3DEN-US link=3Dblue vlink=3Dpurple&gt;

&lt;div class=3DSection1&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;Hi,&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;Has anyone else noticed that the GetDirectories =
code (and probably
file listing code) doesn&amp;#8217;t return directories with =
&amp;#8220;foreign&amp;#8221;
characters (accented letters, etc.)?&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;I traced this down to the call to glob() which, =
when
compiled in a test C program, returns all the directories, but for some =
reason
within Mono doesn&amp;#8217;t.&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;Is this some locale related =
strangeness??????&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;Best regards,&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;-elan&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
DirectoryInfo dirInfo
=3D new DirectoryInfo(dir);&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
DirectoryInfo[]
subDirs =3D dirInfo.GetDirectories();&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach =
(DirectoryInfo
subDir in subDirs)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
{&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&amp;nbsp;
Console.WriteLine(&amp;quot;Directory is: {0}.&amp;quot;,&amp;nbsp; =
subDir.Name);&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
}&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;This code lists the offending directory in a small =
test
program, but not when embedded into the Mono source:&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; glob_t =
globbuf;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; int i =3D 0;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
glob(&amp;quot;/mnt/trove/Music/Blonde
Redhead/*&amp;quot;, 0, NULL, &amp;amp;globbuf);&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; printf(&amp;quot;Matches: =
%d\n&amp;quot;, globbuf.gl_pathc);&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (i=3D0; =
i&amp;lt;globbuf.gl_pathc; i++)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p class=3DMsoNormal&gt;&lt;font size=3D2 face=3DGeorgia&gt;&lt;span =
style=3D'font-size:10.0pt;
font-family:Georgia'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
printf(&amp;quot;
-&amp;gt; '%s'\n&amp;quot;, globbuf.gl_pathv[i]);&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;

------=_NextPart_000_0001_01C2E6D7.8D94EDE0--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="012831.html">[Mono-list] System.Web.Mail + UUEncoding = true
</A></li>
	<LI> Next message: <A HREF="012833.html">[Mono-list] Interesting Articles on Remoting and Security
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12832">[ date ]</a>
              <a href="thread.html#12832">[ thread ]</a>
              <a href="subject.html#12832">[ subject ]</a>
              <a href="author.html#12832">[ author ]</a>
         </LI>
       </UL>
</body></html>
