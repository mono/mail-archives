<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono and MAC OS X?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="013134.html">
   <LINK REL="Next"  HREF="013145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono and MAC OS X?
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] Mono and MAC OS X?">lupus@ximian.com
       </A><BR>
    <I>Wed, 26 Mar 2003 15:40:47 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="013134.html">[Mono-list] Mono and MAC OS X?
</A></li>
        <LI> Next message: <A HREF="013145.html">[Mono-list] Mono and MAC OS X?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13142">[ date ]</a>
              <a href="thread.html#13142">[ thread ]</a>
              <a href="subject.html#13142">[ subject ]</a>
              <a href="author.html#13142">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/25/03 Joe Shaw wrote:
&gt;<i> On Tue, 2003-03-25 at 11:08, Paolo Molaro wrote:
</I>&gt;<i> &gt; *) dllimport: we currently use GModule and the code in glib doesn't
</I>&gt;<i> &gt; handle shared libraries. Someone should investigate about using dlopen
</I>&gt;<i> &gt; in GModule or adding a wrapper in mono
</I>&gt;<i> 
</I>&gt;<i> The main problem here is that mono takes for granted heavily that in ELF
</I>&gt;<i> shared libraries and loadable modules are the same thing.  In Mach-O
</I>&gt;<i> this isn't the case, so you can't simply call dlopen() on a shared
</I>&gt;<i> library (-shared passed to the linker).  The module has to be built with
</I>&gt;<i> -bundle.
</I>
It's not mono per se, it's the CLR spec. We need to be able to load
symbols from shared libraries and GModule instead loads only bundles
(they happen to be the same thing as shared libs on most systems).

&gt;<i> Also, on OS X the dlopen() calls are compatibility wrappers around the
</I>&gt;<i> native dyld implementation, so using that instead of the dyld
</I>&gt;<i> implementation in glib2 won't help.
</I>
A quick google search got this:
  dlcompat for Darwin
  =========================
  
  This is dlcompat, a small library that emulates the dlopen()
  interface on top of Darwin's dyld API.
  
  Unlike finks older dlcompat, this dlcompat allows loading a &quot;.dylib&quot; 
  library (as long as the RTLD_LOCAL flag isn't passed to dlopen()). It can 
  be configured to yield a warning when trying to close it (dynamic 
  libraries cannot be unloaded).

The unload feature is not important, so it's a limitation we don't care
about. The RTLD_LOCAL issue is not a show-stopper either.
It would be better if glib had this feature, but:
*) I doubt it would be accepted (doesn't hurt to ask, though)
*) it would take many months for it to get deployed, anyway

So we need someone to track down this dlcompat library and add support
in the mono runtime to use it instead of gmodule. Any volunteers?
 
lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="013134.html">[Mono-list] Mono and MAC OS X?
</A></li>
	<LI> Next message: <A HREF="013145.html">[Mono-list] Mono and MAC OS X?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13142">[ date ]</a>
              <a href="thread.html#13142">[ thread ]</a>
              <a href="subject.html#13142">[ subject ]</a>
              <a href="author.html#13142">[ author ]</a>
         </LI>
       </UL>
</body></html>
