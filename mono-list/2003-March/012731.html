<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] COM / DCOM in Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="012729.html">
   <LINK REL="Next"  HREF="012726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] COM / DCOM in Mono
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] COM / DCOM in Mono">lupus@ximian.com
       </A><BR>
    <I>Wed, 5 Mar 2003 12:01:23 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="012729.html">[Mono-list] COM / DCOM in Mono
</A></li>
        <LI> Next message: <A HREF="012726.html">[Mono-list] need help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12731">[ date ]</a>
              <a href="thread.html#12731">[ thread ]</a>
              <a href="subject.html#12731">[ subject ]</a>
              <a href="author.html#12731">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/05/03 Eran Sandler wrote:
&gt;<i> Well, I'm currently investigating how implement DCOM on other systems. I
</I>&gt;<i> know it WAS implemented for UN*X and Linux by 3rd party companies but
</I>&gt;<i> they didn't release the code.
</I>&gt;<i> 
</I>&gt;<i> Working with DCOM shouldn't be that hard since I only need a proxy alive
</I>&gt;<i> and a way to marshal data to it (at first it can be other proxies or
</I>&gt;<i> simple data types.
</I>&gt;<i> 
</I>&gt;<i> It might give us what we want.
</I>
If I may suggest a course of action:
* start small, get the simple things working first
* that pretty much means starting the work on a windows system so
that you can use the standard COM libraries there and you can focus on
the mono side of the development
* create a simple void Ping() client or server (whichever is easier to
implement) and then figure out what kind of support is needed in the
runtime to either expose the server or call out to the client.

Creating a little tarball with the code and a makefile to compile it
with the ms runtime will be helpful as a start, to see what kind of
support is needed (and how the metadata looks like for the COM cliet or
server).

&gt;<i> Although I have a question. 
</I>&gt;<i> I will try to implement DCOM in C or C++ (I haven't decided yet), I
</I>&gt;<i> persume I need to use some form of Platform Invoke to call this code,
</I>&gt;<i> right?
</I>&gt;<i> 
</I>&gt;<i> Can you point me out to a place where P/Invoke was used so I can check
</I>&gt;<i> it out a bit?
</I>
Look into metadata/marshal.c, the mono_marshal_get_native_wrapper ()
function. Basically, when the JIT sees a call to a P/Invoke method m,
it calls:
	wrapper_method = mono_marshal_get_native_wrapper (m);

and wrapper method is called instead. The wrapper takes acre of the
need for marshaling values or different call conventions and so on.
I guess COM requires similar support.

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="012729.html">[Mono-list] COM / DCOM in Mono
</A></li>
	<LI> Next message: <A HREF="012726.html">[Mono-list] need help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12731">[ date ]</a>
              <a href="thread.html#12731">[ thread ]</a>
              <a href="subject.html#12731">[ subject ]</a>
              <a href="author.html#12731">[ author ]</a>
         </LI>
       </UL>
</body></html>
