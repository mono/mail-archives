<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Exceptions and error codes.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tum%40veridicus.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="013059.html">
   <LINK REL="Next"  HREF="013109.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Exceptions and error codes.
   </H1>
    <B>Thong (Tum) Nguyen
    </B> 
    <A HREF="mailto:tum%40veridicus.com"
       TITLE="[Mono-list] Exceptions and error codes.">tum@veridicus.com
       </A><BR>
    <I>Fri, 21 Mar 2003 09:33:09 +1200</I>
    <P><UL>
        <LI> Previous message: <A HREF="013059.html">[Mono-list] Exceptions and error codes.
</A></li>
        <LI> Next message: <A HREF="013109.html">[Mono-list] Exceptions and error codes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13060">[ date ]</a>
              <a href="thread.html#13060">[ thread ]</a>
              <a href="subject.html#13060">[ subject ]</a>
              <a href="author.html#13060">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A> [mailto:mono-list-
</I>&gt;<i> <A HREF="mailto:admin@lists.ximian.com">admin@lists.ximian.com</A>] On Behalf Of Piers Haken
</I>&gt;<i> Sent: Friday, 21 March 2003 8:59 a.m.
</I>&gt;<i> To: <A HREF="mailto:tum@veridicus.com">tum@veridicus.com</A>; <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>
</I>&gt;<i> Subject: RE: [Mono-list] Exceptions and error codes.
</I>&gt;<i> 
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: Thong Nguyen [mailto:<A HREF="mailto:tum@veridicus.com">tum@veridicus.com</A>]
</I>&gt;<i> &gt; Sent: Thursday, March 20, 2003 12:14 PM
</I>&gt;<i> &gt; To: <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>
</I>&gt;<i> &gt; Subject: [Mono-list] Exceptions and error codes.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hiya guys,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I recently read some recommendations on the GTK# mailing list
</I>&gt;<i> &gt; regarding the use of exceptions.
</I>&gt;<i> 
</I>&gt;<i> You make some good arguments, but I think most of it is irrelevant
</I>&gt;<i> since, in order to remain compatible with .NET, Mono must behave the
</I>&gt;<i> same way with respect to returning (or not) exceptions. The MSDN docs
</I>&gt;<i> describe exactly what exceptions/return codes File.Exists and
</I>File.Open
&gt;<i> should return, Mono should do the same (unless the docs are in error).
</I>A
&gt;<i> lot of work has already been done on this. You'll notice that many of
</I>&gt;<i> the test cases test whether or not the correct exception is being
</I>&gt;<i> returned.
</I>

Definitely.  I was more referring to our own class libraries (such as
GTK#).


&gt;<i> 
</I>&gt;<i> Of course, for new class libraries many of your arguments are valid.
</I>&gt;<i> Although I'd argue that the case for exceptions in .NET isn't as
</I>&gt;<i> clear-cut as you propose.
</I>&gt;<i> 
</I>&gt;<i> For example, since you're not required to declare the exceptions that
</I>a
&gt;<i> method throws, it's just as easy to miss handling an exception as it
</I>is
&gt;<i> to miss handling a return code.
</I>
That's true.  The issue of checked exceptions opens up another can of
worms that I'm not willing to open here ;-).

But remember, with exceptions you still have the security of knowing the
following statements won't execute.

&gt;<i> The argument that it's easy to forget to
</I>&gt;<i> handle a return code is purely subjective. I've been writing COM code
</I>in
&gt;<i> C++ since '95 and I've found that it's quite simple to get into the
</I>&gt;<i> habit of checking the result of every call and doing it in a way
</I>that's
&gt;<i> readable. 
</I>
Yes.  I've written a lot of COM code myself and have found that you do
get used to using the SUCCESS macro ;-).  It's just a pain when you want
to handle errors for a block of code in the same way -- which happens
very often.  In COM there is no choice; you *must* check and handle
every HRESULT.

&gt;<i> In fact I often find that code that explicitly checks return
</I>&gt;<i> codes for each call is easier to read than code that relies on catch
</I>&gt;<i> blocks, since you know exactly which error handling code is associated
</I>&gt;<i> with each call. Catch locks are fine if you want to apply the same
</I>&gt;<i> exception handling code to a whole bunch of code, but as soon as you
</I>&gt;<i> have to nest them they become unwieldy.
</I>&gt;<i> 
</I>&gt;<i> For example, compare:
</I>&gt;<i> 
</I>&gt;<i> try
</I>&gt;<i> {
</I>&gt;<i> 	DoSomething ();
</I>&gt;<i> 	try
</I>&gt;<i> 	{
</I>&gt;<i> 		DoSomethingElse ();
</I>&gt;<i> 		// some more code here...
</I>&gt;<i> 	}
</I>&gt;<i> 	catch (Exception e)
</I>&gt;<i> 	{
</I>&gt;<i> 		// handle exception in DoSomething ()
</I>&gt;<i> 	}
</I>&gt;<i> }
</I>&gt;<i> Catch (Exception e)
</I>&gt;<i> {
</I>&gt;<i> 	// handle exception in DoSomethingElse ()
</I>&gt;<i> }
</I>
Typically, if you design a good exception hierarchy the code is a lot
tidier:

try
{
  DoSomething();
  DoSomethingElse();
}
catch (DoSomethingException e )
{
}
catch (DoSomethingElseException e)
{
}

Or you if you want to handle both the same way:

try
{
  DoSomething();
  DoSomethingElse();
}
catch (DoException e)
{
  // catch(exception) is bad cause you can swallow things
  // like OutOfMemorryException
}

You can write code for the &quot;best case&quot; (e.g. no error) and handle the
errors in a pseudo declarative way (with exceptions).  I'm a sucker for
declarative languages.

&gt;<i> 
</I>&gt;<i> With
</I>&gt;<i> 
</I>&gt;<i> HRESULT hr;
</I>&gt;<i> if (FAILED (hr = DoSomething ()))
</I>&gt;<i> {
</I>&gt;<i> 	// handle error in DoSomething ()
</I>&gt;<i> }
</I>&gt;<i> else if (FAILED (hr = DoSomethingElse ()))
</I>&gt;<i> {
</I>&gt;<i> 	// handle error in DoSomethingElse ()
</I>&gt;<i> }
</I>&gt;<i> else
</I>&gt;<i> {
</I>&gt;<i> 	// some more code here...
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Or, if you don't need nested catch blocks:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> HRESULT hr;
</I>&gt;<i> if (FAILED (hr = DoSomething ()) ||
</I>&gt;<i>     FAILED (hr = DoSomethingElse ()))
</I>&gt;<i> {
</I>&gt;<i> 	// handle error
</I>&gt;<i> }
</I>&gt;<i> else
</I>&gt;<i> {
</I>&gt;<i> 	// some more code here...
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> Or, if you prefer your error handling to be at the end:
</I>&gt;<i> 
</I>&gt;<i> HRESULT hr;
</I>&gt;<i> if (SUCCEEDED (hr = DoSomething ()) &amp;&amp;
</I>&gt;<i>     SUCCEEDED (hr = DoSomethingElse ()))
</I>&gt;<i> {
</I>&gt;<i> 	// some more code here...
</I>&gt;<i> }
</I>&gt;<i> else
</I>&gt;<i> {
</I>&gt;<i> 	// handle error
</I>&gt;<i> }
</I>&gt;<i> 
</I>
The tidied try/catch looks nicer IMO :-).

What if you had 10 statements and they all should be handled the same
way?

Use this:

HRESULT hr;

if (SUCCEEDED (hr = DoSomething1()) &amp;&amp;
    SUCCEEDED (hr = DoSomething2()) &amp;&amp;
    SUCCEEDED (hr = DoSomething3()) &amp;&amp;
    SUCCEEDED (hr = DoSomething4()) &amp;&amp;
    SUCCEEDED (hr = DoSomething5()) &amp;&amp;
    SUCCEEDED (hr = DoSomething6()) &amp;&amp;
    SUCCEEDED (hr = DoSomething7()) &amp;&amp;
    SUCCEEDED (hr = DoSomething8()) &amp;&amp;
    SUCCEEDED (hr = DoSomething9()) &amp;&amp;
    SUCCEEDED (hr = DoSomething10()))
{
	// some more code here...
}
else
{
	// handle error
}

Or this:?

try
{
  DoSomething1();
  DoSomething2();
  DoSomething3();
  DoSomething4();
  DoSomething5();
  DoSomething6();
  DoSomething7();
  DoSomething8();
  DoSomething9();
  DoSomething10();
}
catch (DoException e)
{
}

All the best,

^Tum

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (<A HREF="http://www.grisoft.com">http://www.grisoft.com</A>).
Version: 6.0.461 / Virus Database: 260 - Release Date: 10/03/2003
 


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="013059.html">[Mono-list] Exceptions and error codes.
</A></li>
	<LI> Next message: <A HREF="013109.html">[Mono-list] Exceptions and error codes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13060">[ date ]</a>
              <a href="thread.html#13060">[ thread ]</a>
              <a href="subject.html#13060">[ subject ]</a>
              <a href="author.html#13060">[ author ]</a>
         </LI>
       </UL>
</body></html>
