<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] System.Net.Sockets.SocketException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tpsoftware%40users.sourceforge.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="013028.html">
   <LINK REL="Next"  HREF="013032.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] System.Net.Sockets.SocketException
   </H1>
    <B>Timothy Parez
    </B> 
    <A HREF="mailto:tpsoftware%40users.sourceforge.net"
       TITLE="[Mono-list] System.Net.Sockets.SocketException">tpsoftware@users.sourceforge.net
       </A><BR>
    <I>Wed, 19 Mar 2003 23:52:09 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="013028.html">[Mono-list] System.Net.Sockets.SocketException
</A></li>
        <LI> Next message: <A HREF="013032.html">[Mono-list] System.Net.Sockets.SocketException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13030">[ date ]</a>
              <a href="thread.html#13030">[ thread ]</a>
              <a href="subject.html#13030">[ subject ]</a>
              <a href="author.html#13030">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0005_01C2EE72.8DCF9830
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: quoted-printable

Update:

It seems that when I changed everything to ASCII instead of UTF7 =
everything works fine and there are no more socket exceptions. Although =
I don't get the link between the encoding and the socket exceptions, so =
it may be co=EFncidence.

Can someone verify this ?
  ----- Original Message -----=20
  From: Timothy Parez=20
  To: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>=20
  Sent: Wednesday, March 19, 2003 11:08 PM
  Subject: [Mono-list] System.Net.Sockets.SocketException


  Hi,

  I'm writing a set of class libs for .NET/Mono,
  except for the UTF7 Encoding in my other post, it should work fine.
  And it does on .NET, but not on Mono.

  I don't know where to start, but I'll try to explain.

  First of all I have a Base Class which amongst other members has the =
following function

   private void ExecuteQuery()
    {
     UdpClient client =3D new UdpClient();
     //Connect to the server and send the query data
     try
     {
      client.Connect(ip,port);
      client.Send(data,data.Length);
     }
     catch
     {
      client.Close();
      throw new Exceptions.InvalidHostException(&quot;Unknown host: &quot; + ip);
     }

     //Listen for a response - This is the client side
     IPEndPoint serverIPEndPoint =3D new IPEndPoint(IPAddress.Any,0);
    =20
     //Receive the response
     try
     {
      queryResponse =3D client.Receive(ref serverIPEndPoint);
     }
     catch (Exception e)
     {
      throw new Exceptions.ConnectionRefusedException(&quot;The connection =
was refused by the remote host: &quot; + ip + &quot;:&quot; + port.ToString() + &quot;\n&quot; + =
e.Message,e);
     }
     finally
     {
      client.Close();
     }
    }

  As you can see it sends a n array of bytes to the server and receives =
some in return.

  Then I have a derived class which has 2 important functions:

    public string RequestStatus()
    {
     //Create the byte[] array to send
     byte[] query =3D =
{0xFF,0xFF,0xFF,0xFF,0x67,0x65,0x74,0x73,0x74,0x61,0x74,0x75,0x73,0xA};
    =20
     //Create a new separator
     char separator =3D Convert.ToChar(10);

     //A statusRequest consists of both rules and players separated by =
char(10)
     string[] response =3D this.QueryToString(query).Split(separator);
    =20
     //Get the rules and players
     string rules =3D this.RulesToXml(response[0]);
     string players =3D this.PlayersToXml(response);
   =20
     return =
this.CreateXmlBody(&quot;Quake3&quot;,&quot;statusRequest&quot;,string.Concat(rules,players))=
;
    }

  And

    public string RequestInfo()
    {
     //Create the byte[] array to send
     byte[] query =3D =
{0xFF,0xFF,0xFF,0xFF,0x67,0x65,0x74,0x69,0x6E,0x66,0x6F,0xA};
    =20
     //Query the server and get the response in a string
     string response =3D this.QueryToString(query);
    =20
     //Create the default xml body and put the rules in it
     string returnValue =3D =
this.CreateXmlBody(&quot;Quake3&quot;,&quot;infoRequest&quot;,this.RulesToXml(response));

     //return the XML
     return returnValue;
    }

  As you can see there is almost no difference between them.
  Now they both run fine with the .NET runtime, but with the mono =
runtime the .RequestStatus() fails.

  When does it fail well when the QueryToString function is called,
  so if I run RequestInfo() the QueryToString function is called and it =
all works fine,
  if I run RequestStatus() the QueryToString function is called and it =
goes wrong.
  In my opinion the only difference so far is the array of bytes to be =
sent.

  Example:

  Let's say I use the following code for an application

  using System;
  using TPSoftware.Q3PlugsNet;
  using TPSoftware.Q3PlugsNet.Exceptions;

  class MainClass
  {
   public static void Main(string[] args)
   {
       =20
    //Create a new Q3Query
  =20
   // Q3Query quakeClient =3D new Q3Query(&quot;195.130.132.153&quot;,27961);
    Q3Query quakeClient =3D new Q3Query(&quot;195.130.132.155&quot;,27961);
   =20
    try
    {
     string info =3D quakeClient.RequestStatus();
     Console.WriteLine(info);
    }
    catch (Exception e)
    {
     Console.WriteLine(&quot;ERROR:&quot;);
     Console.WriteLine(&quot;\n&quot; + e.ToString());         =20
             =20
    }
    finally
    {
    Console.ReadLine();
    }
   }
  }

  Well then I get the following result with .NET runtime

  &lt;?xml version=3D&quot;1.0&quot; encoding=3D&quot;utf-7&quot; =
standalone=3D&quot;yes&quot;?&gt;&lt;Q3Plugs.NET&gt;&lt;Query type=3D
  &quot;statusRequest&quot; protocol=3D&quot;Quake3&quot;&gt;&lt;Server =
ipadress=3D&quot;195.130.132.155&quot; port=3D&quot;27961
  &quot; /&gt;&lt;Rules count=3D&quot;28&quot;&gt;&lt;rule =
name=3D&quot;capturelimit&quot;&gt;&lt;![CDATA[8]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;
  sv_floodProtect&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;sv_maxPing&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule
  &gt;&lt;rule name=3D&quot;sv_minPing&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;sv_maxRate&quot;&gt;&lt;![CDATA[15
  000]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;sv_punkbuster&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;sv_maxcl
  ients&quot;&gt;&lt;![CDATA[14]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;sv_hostname&quot;&gt;&lt;![CDATA[Telenet Q3A OSP CA
   Server]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;timelimit&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;fraglimi
  t&quot;&gt;&lt;![CDATA[25]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;dmflags&quot;&gt;&lt;![CDATA[8]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;ver
  sion&quot;&gt;&lt;![CDATA[Q3 1.32 linux-i386 Oct  7 2002]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;g_gametype&quot;&gt;&lt;
  ![CDATA[5]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;protocol&quot;&gt;&lt;![CDATA[68]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;mapnam
  e&quot;&gt;&lt;![CDATA[q3dm6]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;sv_privateClients&quot;&gt;&lt;![CDATA[2]]&gt;&lt;/rule&gt;&lt;r
  ule name=3D&quot;sv_allowDownload&quot;&gt;&lt;![CDATA[1]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;server_promode&quot;&gt;&lt;![C
  DATA[0]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;server_cq3&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;g_needpa
  ss&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;server_ospauth&quot;&gt;&lt;![CDATA[2]]&gt;&lt;/rule&gt;&lt;rule na
  me=3D&quot;gamename&quot;&gt;&lt;![CDATA[osp]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;gameversion&quot;&gt;&lt;![CDATA[OSP v1.03]
  ]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;Players_Red&quot;&gt;&lt;![CDATA[2 4 6 8 10 =
]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;Play
  ers_Blue&quot;&gt;&lt;![CDATA[1 3 5 7 9 ]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;Score_Red&quot;&gt;&lt;![CDATA[15]]&gt;&lt;/ru
  le&gt;&lt;rule name=3D&quot;Score_Blue&quot;&gt;&lt;![CDATA[17]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;Score_Time&quot;&gt;&lt;![CDATA
  [Round 33/49]]&gt;&lt;/rule&gt;&lt;/Rules&gt;&lt;Players count=3D&quot;10&quot;&gt;&lt;Player =
score=3D&quot;20&quot; ping=3D&quot;15&quot;&gt;&lt;
  ![CDATA[&quot;^5DA^4.^5Ch^7a^5o^7s&quot;]]&gt;&lt;/Player&gt;&lt;Player score=3D&quot;12&quot; =
ping=3D&quot;24&quot;&gt;&lt;![CDATA[
  &quot;UnnamedPlaye^1r&quot;]]&gt;&lt;/Player&gt;&lt;Player score=3D&quot;48&quot; =
ping=3D&quot;38&quot;&gt;&lt;![CDATA[&quot;^b^0*^n^7mnl
  ^b^0*&quot;]]&gt;&lt;/Player&gt;&lt;Player score=3D&quot;38&quot; =
ping=3D&quot;38&quot;&gt;&lt;![CDATA[&quot;^xffffff^9eHk^b^4*^n^0T
  ^9N^0T&quot;]]&gt;&lt;/Player&gt;&lt;Player score=3D&quot;80&quot; =
ping=3D&quot;25&quot;&gt;&lt;![CDATA[&quot;^5B^7osje^5R&quot;]]&gt;&lt;/Play
  er&gt;&lt;Player score=3D&quot;85&quot; =
ping=3D&quot;24&quot;&gt;&lt;![CDATA[&quot;^x00FF00^2911^xFFFFFF^0&gt;&gt;^7SaTo&quot;]]&gt;&lt;/P
  layer&gt;&lt;Player score=3D&quot;18&quot; =
ping=3D&quot;52&quot;&gt;&lt;![CDATA[&quot;^4jerome&quot;]]&gt;&lt;/Player&gt;&lt;Player score=3D
  &quot;96&quot; =
ping=3D&quot;41&quot;&gt;&lt;![CDATA[&quot;^x3366FF^7e^0C^7'.E^0mo^7Z&quot;]]&gt;&lt;/Player&gt;&lt;Player =
score=3D&quot;1
  1&quot; ping=3D&quot;16&quot;&gt;&lt;![CDATA[&quot;crypto&quot;]]&gt;&lt;/Player&gt;&lt;Player score=3D&quot;73&quot; =
ping=3D&quot;40&quot;&gt;&lt;![CDATA[
  &quot;^0fearl^33^0ss&quot;]]&gt;&lt;/Player&gt;&lt;/Players&gt;&lt;/Query&gt;&lt;/Q3Plugs.NET&gt;

  But I get the following with the mono runtime:

  Unhandled Exception: =
TPSoftware.Q3PlugsNet.Exceptions.ConnectionRefusedException
  : The connection was refused by the remote host: 195.130.132.155:27961
  Some sort of w32 error occurred ---&gt; =
System.Net.Sockets.SocketException: Some so
  rt of w32 error occurred
  in (unmanaged) 06 System.Net.Sockets.Socket:RecvFrom_internal =
(intptr,byte[],int
  ,int,System.Net.Sockets.SocketFlags,System.Net.SocketAddress&amp;)
  in &lt;0x00004&gt; 06 System.Net.Sockets.Socket:RecvFrom_internal =
(intptr,byte[],int,i
  nt,System.Net.Sockets.SocketFlags,System.Net.SocketAddress&amp;)
  in &lt;0x00155&gt; 00 System.Net.Sockets.Socket:ReceiveFrom =
(byte[],int,int,System.Net
  .Sockets.SocketFlags,System.Net.EndPoint&amp;)
  in &lt;0x00180&gt; 00 System.Net.Sockets.Socket:ReceiveFrom =
(byte[],int,int,System.Net
  .Sockets.SocketFlags,System.Net.EndPoint&amp;)
  in &lt;0x0002a&gt; 00 System.Net.Sockets.Socket:ReceiveFrom =
(byte[],System.Net.EndPoin
  t&amp;)
  in &lt;0x000af&gt; 00 System.Net.Sockets.UdpClient:Receive =
(System.Net.IPEndPoint&amp;)
  in &lt;0x0016b&gt; 00 TPSoftware.Q3PlugsNet.QueryBase:ExecuteQuery ()
  --- End of inner exception stack trace ---

  in &lt;0x002b4&gt; 00 TPSoftware.Q3PlugsNet.QueryBase:ExecuteQuery ()
  in &lt;0x0005b&gt; 01 System.MulticastDelegate:invoke_void ()


  However if I change the above code to:

  using System;
  using TPSoftware.Q3PlugsNet;
  using TPSoftware.Q3PlugsNet.Exceptions;

  class MainClass
  {
   public static void Main(string[] args)
   {
       =20
    //Create a new Q3Query
  =20
   // Q3Query quakeClient =3D new Q3Query(&quot;195.130.132.153&quot;,27961);
    Q3Query quakeClient =3D new Q3Query(&quot;195.130.132.155&quot;,27961);
   =20
    try
    {
     string info =3D quakeClient.RequestInfo(); // RequestInfo instead =
of RequestStatus !!!!!!!!
     Console.WriteLine(info);
    }
    catch (Exception e)
    {
     Console.WriteLine(&quot;ERROR:&quot;);
     Console.WriteLine(&quot;\n&quot; + e.ToString());         =20

             =20
    }
    finally
    {
    Console.ReadLine();
    }
   }
  }

  I get the following output with .NET

  &lt;?xml version=3D&quot;1.0&quot; encoding=3D&quot;utf-7&quot; =
standalone=3D&quot;yes&quot;?&gt;&lt;Q3Plugs.NET&gt;&lt;Query type=3D
  &quot;infoRequest&quot; protocol=3D&quot;Quake3&quot;&gt;&lt;Server ipadress=3D&quot;195.130.132.155&quot; =
port=3D&quot;27961&quot;
  /&gt;&lt;Rules count=3D&quot;9&quot;&gt;&lt;rule name=3D&quot;game&quot;&gt;&lt;![CDATA[osp]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;punkbuste
  r&quot;&gt;&lt;![CDATA[0]]&gt;&lt;/rule&gt;&lt;rule name=3D&quot;pure&quot;&gt;&lt;![CDATA[1]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;gametyp
  e&quot;&gt;&lt;![CDATA[5]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;sv_maxclients&quot;&gt;&lt;![CDATA[12]]&gt;&lt;/rule&gt;&lt;rule nam
  e=3D&quot;clients&quot;&gt;&lt;![CDATA[2]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;mapname&quot;&gt;&lt;![CDATA[q3dm6]]&gt;&lt;/rule&gt;&lt;ru
  le name=3D&quot;hostname&quot;&gt;&lt;![CDATA[Telenet Q3A OSP CA Server]]&gt;&lt;/rule&gt;&lt;rule =
name=3D&quot;proto
  col&quot;&gt;&lt;![CDATA[68]]&gt;&lt;/rule&gt;&lt;/Rules&gt;&lt;/Query&gt;&lt;/Q3Plugs.NET&gt;

  And the following output with mono (don't mind the encoding, that's =
another bug)

  ???xml version???1.0?? encoding???utf-7?? standalone???yes???? =
??Q3Plugs.NET? ??
  Query type???infoRequest?? protocol???Quake3??? ??Server =
ipadress???195.130.132.
  155?? port???27961?? /? ???Rules count????+BDJAAARO????? =
name?????+BDJAAARO???+E
  JwMQFQE+AFs-osp???+-???/rule???+QAA-rule =
name???????+BDJAAARO???+EJwMQFQE+AFs-0?
  ??+-???/rule???+QAA-rule =
name?????+BDJAAARO???+EJwMQFQE+AFs-1???+-???/rule???+QA
  A-rule name??????+BDJAAARO???+EJwMQFQE+AFs-5???+-???/rule???+QAA-rule =
name????+B
  G8AAA-maxclients???+AAAETEEl???+-AFs-12???+-???/rule???+QAA-rule =
name??????+BDJA
  AARO???+EJwMQFQE+AFs-2???+-???/rule???+QAA-rule =
name??????+BDJAAARO???+EJwMQFQE+
  AFs-q3dm6???+-???/rule???+QAA-rule =
name??????+BDJAAARO???+EJwMQFQE+AFs-Telenet Q
  3A OSP CA Server???+-???/rule???+QAA-rule =
name??????+BDJAAARO???+EJwMQFQE+AFs-68
  ???+-???/rule???+QAA-/Rules?????/Query? ??/Q3Plugs.NET?

  So this works fine (more or less) and doesn't throw any errors.

  So my question: Why does RequestStatus cause an error while =
RequestInfo does not.

  If you want to view the full sources of the library please visit:
  <A HREF="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/q3plugs/Q3Plugs.NET/">http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/q3plugs/Q3Plugs.NET/</A>

  Thnx,
  Timothy P.




  ---
  Outgoing mail is certified Virus Free.
  Checked by AVG anti-virus system (<A HREF="http://www.grisoft.com">http://www.grisoft.com</A>).
  Version: 6.0.463 / Virus Database: 262 - Release Date: 17/03/2003
------=_NextPart_000_0005_01C2EE72.8DCF9830
Content-Type: text/html;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: quoted-printable

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META http-equiv=3DContent-Type content=3D&quot;text/html; =
charset=3Diso-8859-1&quot;&gt;
&lt;META content=3D&quot;MSHTML 6.00.2800.1106&quot; name=3DGENERATOR&gt;
&lt;STYLE&gt;&lt;/STYLE&gt;
&lt;/HEAD&gt;
&lt;BODY bgColor=3D#ffffff&gt;
&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Update:&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;It seems that when I changed everything =
to ASCII=20
instead of UTF7 everything works fine and there are no more socket =
exceptions.=20
Although I don't get the link between the encoding and the socket =
exceptions, so=20
it may be co=EFncidence.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Can someone verify this ?&lt;/FONT&gt;&lt;/DIV&gt;
&lt;BLOCKQUOTE dir=3Dltr=20
style=3D&quot;PADDING-RIGHT: 0px; PADDING-LEFT: 5px; MARGIN-LEFT: 5px; =
BORDER-LEFT: #000000 2px solid; MARGIN-RIGHT: 0px&quot;&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;----- Original Message ----- &lt;/DIV&gt;
  &lt;DIV=20
  style=3D&quot;BACKGROUND: #e4e4e4; FONT: 10pt arial; font-color: =
black&quot;&gt;&lt;B&gt;From:&lt;/B&gt;=20
  &lt;A title=<A HREF="mailto:3Dtpsoftware@users.sourceforge.net">3Dtpsoftware@users.sourceforge.net</A>=20
  href=3D&quot;mailto:<A HREF="mailto:tpsoftware@users.sourceforge.net">tpsoftware@users.sourceforge.net</A>&quot;&gt;Timothy Parez&lt;/A&gt; =
&lt;/DIV&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;To:&lt;/B&gt; &lt;A =
title=<A HREF="mailto:3Dmono-list@ximian.com">3Dmono-list@ximian.com</A>=20
  href=3D&quot;mailto:<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&quot;&gt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&lt;/A&gt; &lt;/DIV&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Sent:&lt;/B&gt; Wednesday, March 19, 2003 =
11:08=20
  PM&lt;/DIV&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Subject:&lt;/B&gt; [Mono-list]=20
  System.Net.Sockets.SocketException&lt;/DIV&gt;
  &lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Hi,&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;I'm writing a set of class libs for=20
  .NET/Mono,&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;except for the UTF7 Encoding in my =
other post, it=20
  should work fine.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;And it does on .NET, but not on=20
Mono.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;I don't know where to start, but I'll =
try to=20
  explain.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;First of all I have a Base Class =
which amongst=20
  other members has the following function&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;nbsp;private void=20
  ExecuteQuery()&lt;BR&gt;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;UdpClient client =
=3D new=20
  UdpClient();&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//Connect to the server and send the =
query=20
  =
data&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;try&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;client.Connect(ip,port);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;client.Send(da=
ta,data.Length);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;catch&lt;BR&gt;&amp;nb=
sp;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;client.Close();&lt;BR&gt;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&amp;nbsp;throw=20
  new Exceptions.InvalidHostException(&quot;Unknown host: &quot; +=20
  ip);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//Listen for a =
response - This=20
  is the client side&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;IPEndPoint serverIPEndPoint =
=3D new=20
  =
IPEndPoint(IPAddress.Any,0);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;/=
/Receive=20
  the=20
  =
response&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;try&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;=
nbsp;&amp;nbsp;queryResponse=20
  =3D client.Receive(ref=20
  serverIPEndPoint);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;catch=20
  (Exception e)&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throw =
new=20
  Exceptions.ConnectionRefusedException(&quot;The connection was refused by =
the=20
  remote host: &quot; + ip + &quot;:&quot; + port.ToString() + &quot;\n&quot; +=20
  =
e.Message,e);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;finally&lt;BR&gt;&amp;nbs=
p;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;client.Close();&lt;BR&gt;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;As you can see it sends a n array of =
bytes to the=20
  server and receives some in return.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Then I have a derived class which has =
2 important=20
  functions:&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;nbsp;&amp;nbsp;public string=20
  RequestStatus()&lt;BR&gt;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//Create the =
byte[]=20
  array to send&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;byte[] query =3D=20
  =
{0xFF,0xFF,0xFF,0xFF,0x67,0x65,0x74,0x73,0x74,0x61,0x74,0x75,0x73,0xA};&lt;B=
R&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//Create=20
  a new separator&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;char separator =3D=20
  Convert.ToChar(10);&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//A statusRequest =
consists of=20
  both rules and players separated by =
char(10)&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;string[]=20
  response =3D=20
  =
this.QueryToString(query).Split(separator);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbs=
p;&amp;nbsp;&amp;nbsp;//Get=20
  the rules and players&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;string rules =3D=20
  this.RulesToXml(response[0]);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;string players =3D=20
  =
this.PlayersToXml(response);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;return =

  =
this.CreateXmlBody(&quot;Quake3&quot;,&quot;statusRequest&quot;,string.Concat(rules,players))=
;&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;And&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;nbsp;&amp;nbsp;public string=20
  RequestInfo()&lt;BR&gt;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//Create the =
byte[] array=20
  to send&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;byte[] query =3D=20
  =
{0xFF,0xFF,0xFF,0xFF,0x67,0x65,0x74,0x69,0x6E,0x66,0x6F,0xA};&lt;BR&gt;&amp;nbsp;&amp;n=
bsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//Query=20
  the server and get the response in a =
string&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;string=20
  response =3D=20
  =
this.QueryToString(query);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//C=
reate=20
  the default xml body and put the rules in =
it&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;string=20
  returnValue =3D=20
  =
this.CreateXmlBody(&quot;Quake3&quot;,&quot;infoRequest&quot;,this.RulesToXml(response));&lt;/FO=
NT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//return the=20
  XML&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;return =
returnValue;&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;As you can see there is almost no =
difference=20
  between them.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Now they both run fine with the .NET =
runtime, but=20
  with the mono runtime the .RequestStatus() fails.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;When does it fail well when the =
QueryToString=20
  function is called,&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;so if I run RequestInfo() the =
QueryToString=20
  function is called and it all works fine,&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;if I run RequestStatus() the =
QueryToString=20
  function is called and it goes wrong.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;In my opinion the only difference so =
far is the=20
  array of bytes to be sent.&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Example:&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Let's say I use the following code =
for an=20
  application&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;using System;&lt;BR&gt;using=20
  TPSoftware.Q3PlugsNet;&lt;BR&gt;using =
TPSoftware.Q3PlugsNet.Exceptions;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;class MainClass&lt;BR&gt;{&lt;BR&gt;&amp;nbsp;public =
static void=20
  Main(string[]=20
  =
args)&lt;BR&gt;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;/=
/Create=20
  a new Q3Query&lt;BR&gt;&amp;nbsp;&lt;BR&gt;&amp;nbsp;//&amp;nbsp;Q3Query quakeClient =3D new=20
  Q3Query(&quot;195.130.132.153&quot;,27961);&lt;BR&gt;&amp;nbsp;&amp;nbsp;Q3Query quakeClient =
=3D new=20
  =
Q3Query(&quot;195.130.132.155&quot;,27961);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;try&lt;BR&gt;&amp;=
nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;string=20
  info =3D=20
  =
quakeClient.RequestStatus();&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Console.WriteLine(info)=
;&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;&amp;nbsp;catch=20
  (Exception=20
  =
e)&lt;BR&gt;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Console.WriteLine(&quot;ERROR:&quot;);&lt;BR&gt;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;Console.WriteLine(&quot;\n&quot;=20
  + e.ToString());&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =

  &lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial=20
  =
size=3D2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;&amp;nbsp;finally&lt;BR&gt;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbs=
p;&amp;nbsp;Console.ReadLine();&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;}&lt;BR&gt;}&lt;BR&gt;&lt;/FONT&gt;&lt;/=
DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Well then I get the following result =
with .NET=20
  runtime&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;lt;?xml version=3D&quot;1.0&quot; =
encoding=3D&quot;utf-7&quot;=20
  standalone=3D&quot;yes&quot;?&amp;gt;&amp;lt;Q3Plugs.NET&amp;gt;&amp;lt;Query =
type=3D&lt;BR&gt;&quot;statusRequest&quot;=20
  protocol=3D&quot;Quake3&quot;&amp;gt;&amp;lt;Server ipadress=3D&quot;195.130.132.155&quot; =
port=3D&quot;27961&lt;BR&gt;&quot;=20
  /&amp;gt;&amp;lt;Rules count=3D&quot;28&quot;&amp;gt;&amp;lt;rule=20
  name=3D&quot;capturelimit&quot;&amp;gt;&amp;lt;![CDATA[8]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  =
name=3D&quot;&lt;BR&gt;sv_floodProtect&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule =

  name=3D&quot;sv_maxPing&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&lt;BR&gt;&amp;gt;&amp;lt;rule=20
  name=3D&quot;sv_minPing&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  =
name=3D&quot;sv_maxRate&quot;&amp;gt;&amp;lt;![CDATA[15&lt;BR&gt;000]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;sv_punkbuster&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  =
name=3D&quot;sv_maxcl&lt;BR&gt;ients&quot;&amp;gt;&amp;lt;![CDATA[14]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;sv_hostname&quot;&amp;gt;&amp;lt;![CDATA[Telenet Q3A OSP=20
  CA&lt;BR&gt;&amp;nbsp;Server]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;timelimit&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;fraglimi&lt;BR&gt;t&quot;&amp;gt;&amp;lt;![CDATA[25]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;dmflags&quot;&amp;gt;&amp;lt;![CDATA[8]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;ver&lt;BR&gt;sion&quot;&amp;gt;&amp;lt;![CDATA[Q3 1.32 linux-i386 Oct&amp;nbsp; 7=20
  2002]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;g_gametype&quot;&amp;gt;&amp;lt;&lt;BR&gt;![CDATA[5]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;protocol&quot;&amp;gt;&amp;lt;![CDATA[68]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;mapnam&lt;BR&gt;e&quot;&amp;gt;&amp;lt;![CDATA[q3dm6]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  =
name=3D&quot;sv_privateClients&quot;&amp;gt;&amp;lt;![CDATA[2]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;r&lt;BR&gt;ul=
e=20
  name=3D&quot;sv_allowDownload&quot;&amp;gt;&amp;lt;![CDATA[1]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  =
name=3D&quot;server_promode&quot;&amp;gt;&amp;lt;![C&lt;BR&gt;DATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;server_cq3&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;g_needpa&lt;BR&gt;ss&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;server_ospauth&quot;&amp;gt;&amp;lt;![CDATA[2]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  na&lt;BR&gt;me=3D&quot;gamename&quot;&amp;gt;&amp;lt;![CDATA[osp]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;gameversion&quot;&amp;gt;&amp;lt;![CDATA[OSP =
v1.03]&lt;BR&gt;]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;Players_Red&quot;&amp;gt;&amp;lt;![CDATA[2 4 6 8 10 =
]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;Play&lt;BR&gt;ers_Blue&quot;&amp;gt;&amp;lt;![CDATA[1 3 5 7 9 =
]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;Score_Red&quot;&amp;gt;&amp;lt;![CDATA[15]]&amp;gt;&amp;lt;/ru&lt;BR&gt;le&amp;gt;&amp;lt;rule=20
  name=3D&quot;Score_Blue&quot;&amp;gt;&amp;lt;![CDATA[17]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;Score_Time&quot;&amp;gt;&amp;lt;![CDATA&lt;BR&gt;[Round=20
  33/49]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;/Rules&amp;gt;&amp;lt;Players =
count=3D&quot;10&quot;&amp;gt;&amp;lt;Player=20
  score=3D&quot;20&quot;=20
  =
ping=3D&quot;15&quot;&amp;gt;&amp;lt;&lt;BR&gt;![CDATA[&quot;^5DA^4.^5Ch^7a^5o^7s&quot;]]&amp;gt;&amp;lt;/Player&amp;gt=
;&amp;lt;Player=20
  score=3D&quot;12&quot;=20
  =
ping=3D&quot;24&quot;&amp;gt;&amp;lt;![CDATA[&lt;BR&gt;&quot;UnnamedPlaye^1r&quot;]]&amp;gt;&amp;lt;/Player&amp;gt;&amp;lt;=
Player=20
  score=3D&quot;48&quot;=20
  =
ping=3D&quot;38&quot;&amp;gt;&amp;lt;![CDATA[&quot;^b^0*^n^7mnl&lt;BR&gt;^b^0*&quot;]]&amp;gt;&amp;lt;/Player&amp;gt;&amp;l=
t;Player=20
  score=3D&quot;38&quot;=20
  =
ping=3D&quot;38&quot;&amp;gt;&amp;lt;![CDATA[&quot;^xffffff^9eHk^b^4*^n^0T&lt;BR&gt;^9N^0T&quot;]]&amp;gt;&amp;lt;/=
Player&amp;gt;&amp;lt;Player=20
  score=3D&quot;80&quot;=20
  =
ping=3D&quot;25&quot;&amp;gt;&amp;lt;![CDATA[&quot;^5B^7osje^5R&quot;]]&amp;gt;&amp;lt;/Play&lt;BR&gt;er&amp;gt;&amp;lt;Pla=
yer=20
  score=3D&quot;85&quot;=20
  =
ping=3D&quot;24&quot;&amp;gt;&amp;lt;![CDATA[&quot;^x00FF00^2911^xFFFFFF^0&amp;gt;&amp;gt;^7SaTo&quot;]]&amp;gt;&amp;=
lt;/P&lt;BR&gt;layer&amp;gt;&amp;lt;Player=20
  score=3D&quot;18&quot; =
ping=3D&quot;52&quot;&amp;gt;&amp;lt;![CDATA[&quot;^4jerome&quot;]]&amp;gt;&amp;lt;/Player&amp;gt;&amp;lt;Player=20
  score=3D&lt;BR&gt;&quot;96&quot;=20
  =
ping=3D&quot;41&quot;&amp;gt;&amp;lt;![CDATA[&quot;^x3366FF^7e^0C^7'.E^0mo^7Z&quot;]]&amp;gt;&amp;lt;/Player&amp;=
gt;&amp;lt;Player=20
  score=3D&quot;1&lt;BR&gt;1&quot;=20
  ping=3D&quot;16&quot;&amp;gt;&amp;lt;![CDATA[&quot;crypto&quot;]]&amp;gt;&amp;lt;/Player&amp;gt;&amp;lt;Player =
score=3D&quot;73&quot;=20
  =
ping=3D&quot;40&quot;&amp;gt;&amp;lt;![CDATA[&lt;BR&gt;&quot;^0fearl^33^0ss&quot;]]&amp;gt;&amp;lt;/Player&amp;gt;&amp;lt;/=
Players&amp;gt;&amp;lt;/Query&amp;gt;&amp;lt;/Q3Plugs.NET&amp;gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;But I get the following with the mono =

  runtime:&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;Unhandled Exception:=20
  TPSoftware.Q3PlugsNet.Exceptions.ConnectionRefusedException&lt;BR&gt;: The=20
  connection was refused by the remote host: =
195.130.132.155:27961&lt;BR&gt;Some sort=20
  of w32 error occurred ---&amp;gt; System.Net.Sockets.SocketException: Some =

  so&lt;BR&gt;rt of w32 error occurred&lt;BR&gt;in (unmanaged) 06=20
  System.Net.Sockets.Socket:RecvFrom_internal=20
  =
(intptr,byte[],int&lt;BR&gt;,int,System.Net.Sockets.SocketFlags,System.Net.Sock=
etAddress&amp;amp;)&lt;BR&gt;in=20
  &amp;lt;0x00004&amp;gt; 06 System.Net.Sockets.Socket:RecvFrom_internal=20
  =
(intptr,byte[],int,i&lt;BR&gt;nt,System.Net.Sockets.SocketFlags,System.Net.Sock=
etAddress&amp;amp;)&lt;BR&gt;in=20
  &amp;lt;0x00155&amp;gt; 00 System.Net.Sockets.Socket:ReceiveFrom=20
  =
(byte[],int,int,System.Net&lt;BR&gt;.Sockets.SocketFlags,System.Net.EndPoint&amp;am=
p;)&lt;BR&gt;in=20
  &amp;lt;0x00180&amp;gt; 00 System.Net.Sockets.Socket:ReceiveFrom=20
  =
(byte[],int,int,System.Net&lt;BR&gt;.Sockets.SocketFlags,System.Net.EndPoint&amp;am=
p;)&lt;BR&gt;in=20
  &amp;lt;0x0002a&amp;gt; 00 System.Net.Sockets.Socket:ReceiveFrom=20
  (byte[],System.Net.EndPoin&lt;BR&gt;t&amp;amp;)&lt;BR&gt;in &amp;lt;0x000af&amp;gt; 00=20
  System.Net.Sockets.UdpClient:Receive =
(System.Net.IPEndPoint&amp;amp;)&lt;BR&gt;in=20
  &amp;lt;0x0016b&amp;gt; 00 TPSoftware.Q3PlugsNet.QueryBase:ExecuteQuery =
()&lt;BR&gt;--- End=20
  of inner exception stack trace ---&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;in &amp;lt;0x002b4&amp;gt; 00=20
  TPSoftware.Q3PlugsNet.QueryBase:ExecuteQuery ()&lt;BR&gt;in &amp;lt;0x0005b&amp;gt; =
01=20
  System.MulticastDelegate:invoke_void ()&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;However if I change the above code=20
  to:&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;using System;&lt;BR&gt;using=20
  TPSoftware.Q3PlugsNet;&lt;BR&gt;using =
TPSoftware.Q3PlugsNet.Exceptions;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;class MainClass&lt;BR&gt;{&lt;BR&gt;&amp;nbsp;public =
static void=20
  Main(string[]=20
  =
args)&lt;BR&gt;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;/=
/Create=20
  a new Q3Query&lt;BR&gt;&amp;nbsp;&lt;BR&gt;&amp;nbsp;//&amp;nbsp;Q3Query quakeClient =3D new=20
  Q3Query(&quot;195.130.132.153&quot;,27961);&lt;BR&gt;&amp;nbsp;&amp;nbsp;Q3Query quakeClient =
=3D new=20
  =
Q3Query(&quot;195.130.132.155&quot;,27961);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;try&lt;BR&gt;&amp;=
nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;string=20
  info =3D quakeClient.RequestInfo(); // RequestInfo instead of =
RequestStatus=20
  =
!!!!!!!!&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Console.WriteLine(info);&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;B=
R&gt;&amp;nbsp;&amp;nbsp;catch=20
  (Exception=20
  =
e)&lt;BR&gt;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Console.WriteLine(&quot;ERROR:&quot;);&lt;BR&gt;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;Console.WriteLine(&quot;\n&quot;=20
  + e.ToString());&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =

  &lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial=20
  =
size=3D2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs=
p;=20
  =
&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;&amp;nbsp;finally&lt;BR&gt;&amp;nbsp;&amp;nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;=
Console.ReadLine();&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;}&lt;BR&gt;}&lt;/DIV&gt;&lt;/FONT&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;nbsp;&lt;/DIV&gt;&lt;/FONT&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;I get the following output with =
.NET&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&amp;lt;?xml version=3D&quot;1.0&quot; =
encoding=3D&quot;utf-7&quot;=20
  standalone=3D&quot;yes&quot;?&amp;gt;&amp;lt;Q3Plugs.NET&amp;gt;&amp;lt;Query =
type=3D&lt;BR&gt;&quot;infoRequest&quot;=20
  protocol=3D&quot;Quake3&quot;&amp;gt;&amp;lt;Server ipadress=3D&quot;195.130.132.155&quot;=20
  port=3D&quot;27961&quot;&lt;BR&gt;/&amp;gt;&amp;lt;Rules count=3D&quot;9&quot;&amp;gt;&amp;lt;rule=20
  name=3D&quot;game&quot;&amp;gt;&amp;lt;![CDATA[osp]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;punkbuste&lt;BR&gt;r&quot;&amp;gt;&amp;lt;![CDATA[0]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;pure&quot;&amp;gt;&amp;lt;![CDATA[1]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;gametyp&lt;BR&gt;e&quot;&amp;gt;&amp;lt;![CDATA[5]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;sv_maxclients&quot;&amp;gt;&amp;lt;![CDATA[12]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  nam&lt;BR&gt;e=3D&quot;clients&quot;&amp;gt;&amp;lt;![CDATA[2]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  name=3D&quot;mapname&quot;&amp;gt;&amp;lt;![CDATA[q3dm6]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;ru&lt;BR&gt;le=20
  name=3D&quot;hostname&quot;&amp;gt;&amp;lt;![CDATA[Telenet Q3A OSP CA=20
  Server]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;rule=20
  =
name=3D&quot;proto&lt;BR&gt;col&quot;&amp;gt;&amp;lt;![CDATA[68]]&amp;gt;&amp;lt;/rule&amp;gt;&amp;lt;/Rules&amp;gt;&amp;=
lt;/Query&amp;gt;&amp;lt;/Q3Plugs.NET&amp;gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;And the following output with mono =
(don't mind=20
  the encoding, that's another bug)&lt;/FONT&gt;&lt;/DIV&gt;&lt;FONT face=3DArial =
size=3D2&gt;
  &lt;DIV&gt;&lt;BR&gt;???xml version???1.0?? encoding???utf-7?? =
standalone???yes????=20
  ??Q3Plugs.NET? ??&lt;BR&gt;Query type???infoRequest?? protocol???Quake3??? =
??Server=20
  ipadress???195.130.132.&lt;BR&gt;155?? port???27961?? /? ???Rules=20
  count????+BDJAAARO?????=20
  name?????+BDJAAARO???+E&lt;BR&gt;JwMQFQE+AFs-osp???+-???/rule???+QAA-rule=20
  name???????+BDJAAARO???+EJwMQFQE+AFs-0?&lt;BR&gt;??+-???/rule???+QAA-rule=20
  name?????+BDJAAARO???+EJwMQFQE+AFs-1???+-???/rule???+QA&lt;BR&gt;A-rule=20
  name??????+BDJAAARO???+EJwMQFQE+AFs-5???+-???/rule???+QAA-rule=20
  =
name????+B&lt;BR&gt;G8AAA-maxclients???+AAAETEEl???+-AFs-12???+-???/rule???+QAA=
-rule=20
  name??????+BDJA&lt;BR&gt;AARO???+EJwMQFQE+AFs-2???+-???/rule???+QAA-rule=20
  name??????+BDJAAARO???+EJwMQFQE+&lt;BR&gt;AFs-q3dm6???+-???/rule???+QAA-rule =

  name??????+BDJAAARO???+EJwMQFQE+AFs-Telenet Q&lt;BR&gt;3A OSP CA=20
  Server???+-???/rule???+QAA-rule=20
  =
name??????+BDJAAARO???+EJwMQFQE+AFs-68&lt;BR&gt;???+-???/rule???+QAA-/Rules????=
?/Query?=20
  ??/Q3Plugs.NET?&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;So this works fine (more or less) and doesn't throw any =
errors.&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;So my question: Why does RequestStatus cause an error while =
RequestInfo=20
  does not.&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;If you want to view the full sources of the library please =
visit:&lt;/DIV&gt;
  &lt;DIV&gt;&lt;A=20
  =
href=3D&quot;<A HREF="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/q3plugs/Q3Plugs.NE=">http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/q3plugs/Q3Plugs.NE=</A>
T/&quot;&gt;<A HREF="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/q3plugs/Q3Plugs.NET/</=">http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/q3plugs/Q3Plugs.NET/&lt;/=</A>
A&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;Thnx,&lt;/DIV&gt;
  &lt;DIV&gt;Timothy P.&lt;BR&gt;&lt;/DIV&gt;&lt;/FONT&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt;&lt;BR&gt;---&lt;BR&gt;Outgoing mail is certified =
Virus=20
  Free.&lt;BR&gt;Checked by AVG anti-virus system (&lt;A=20
  =
href=3D&quot;<A HREF="http://www.grisoft.com"">http://www.grisoft.com&quot;</A>&gt;<A HREF="http://www.grisoft.com</A">http://www.grisoft.com&lt;/A</A>&gt;).&lt;BR&gt;Version: =
6.0.463=20
  / Virus Database: 262 - Release Date:=20
17/03/2003&lt;/FONT&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;

------=_NextPart_000_0005_01C2EE72.8DCF9830--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="013028.html">[Mono-list] System.Net.Sockets.SocketException
</A></li>
	<LI> Next message: <A HREF="013032.html">[Mono-list] System.Net.Sockets.SocketException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13030">[ date ]</a>
              <a href="thread.html#13030">[ thread ]</a>
              <a href="subject.html#13030">[ subject ]</a>
              <a href="author.html#13030">[ author ]</a>
         </LI>
       </UL>
</body></html>
