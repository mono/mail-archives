<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Connecting to a database (VB)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Connecting%20to%20a%20database%20%28VB%29&In-Reply-To=204460.71545.qm%40web30806.mail.mud.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="046002.html">
   <LINK REL="Next"  HREF="046010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Connecting to a database (VB)</H1>
    <B>mabra at manfbraun.de</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Connecting%20to%20a%20database%20%28VB%29&In-Reply-To=204460.71545.qm%40web30806.mail.mud.yahoo.com"
       TITLE="[Mono-list] Connecting to a database (VB)">mabra at manfbraun.de
       </A><BR>
    <I>Mon Nov  1 13:17:20 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="046002.html">[Mono-list] Connecting to a database (VB)
</A></li>
        <LI>Next message: <A HREF="046010.html">[Mono-list] Connecting to a database (VB)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46005">[ date ]</a>
              <a href="thread.html#46005">[ thread ]</a>
              <a href="subject.html#46005">[ subject ]</a>
              <a href="author.html#46005">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello !

Sorry, I'll really NOT bother you, but I don't trust your statement.

I am administering Windows since the beginning and using and developing lots
of admin tools in C#. What NTLM gives you finally, is an access token,
containing different SIDs [your user, groups, rights etc.]. If it does not
contain a &quot;real&quot; domain, it is usually - on windows [even with SqlClient] so
far - able to authenticate to a windows's machine local domain. If your
computer is named &quot;X&quot;, you should be able to connect to &quot;X\myUser&quot; on this
local domain with &quot;Integrated Security&quot;.

If this is not working, I would feel bad about mono.
Or is there something, I think fundamentally wrong??
I do not have the time shortly, but I'll definitively setup
a XP-VM with mono to try this out later!

Naturally, as I wrote, specifying &quot;Integrated Security&quot; AND specifying
username and password WILL NEVER work [wether local domain nor real domain].

br++mabra


-----Original Message-----
From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A>] On Behalf Of Daniel Morgan
Sent: Monday, November 01, 2010 3:35 PM
To: mono-list; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">paul at all-the-johnsons.co.uk</A>
Subject: Re: [Mono-list] Connecting to a database (VB)

Mono's SqlClient supports Integrated Security (NTLM), but you must be on a
true windows domain.  A workgroup does not count. You also have to give your
windows domain user id and password.  On Mono's SqlClient, you have to give
your windows domain credentials because Mono is not integrated with your
Windows workstation, nor SQL Server, nor the Windows server where the SQL
Server instance is running.  

--- On Sun, 10/31/10, Paul F. Johnson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">paul at all-the-johnsons.co.uk</A>&gt; wrote:

&gt;<i> From: Paul F. Johnson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">paul at all-the-johnsons.co.uk</A>&gt;
</I>&gt;<i> Subject: [Mono-list] Connecting to a database (VB)
</I>&gt;<i> To: &quot;mono-list&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>&gt;
</I>&gt;<i> Date: Sunday, October 31, 2010, 11:16 AM
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I have set up a really simple MS SQL database and am trying
</I>&gt;<i> to connect
</I>&gt;<i> to it using VB.
</I>&gt;<i> 
</I>&gt;<i> Currently, my code looks like this
</I>&gt;<i> 
</I>&gt;<i> Dim connstr as String = &quot;Data
</I>&gt;<i> Source=localhost\SQLEXPRESS;&quot;+&quot;Initial
</I>&gt;<i> Catalog=&quot;Database1\Table1;&quot;+&quot;Integrated Security=SSPI;&quot;
</I>&gt;<i> Dim sql as String = Nothing
</I>&gt;<i> Dim tables as New ArrayList
</I>&gt;<i> Dim sqldata as new DataSet
</I>&gt;<i> Try
</I>&gt;<i> Dim connect as new SqlConnection(connstr)
</I>&gt;<i> connect.Open()
</I>&gt;<i> Dim sqlcomm as new SqlCommand(sql, connect)
</I>&gt;<i> sqlcomm.CommandText = &quot;Select Name where (Age &gt; 25 and
</I>&gt;<i> Hometown =
</I>&gt;<i> Liverpool);&quot;
</I>&gt;<i> Dim sqlad = new SqlDataAdapter
</I>&gt;<i> sqlad.SelectCommand = sqlcomm
</I>&gt;<i> For i = 0 to 3
</I>&gt;<i> &#160; sqlad.TableMappings.Add(&quot;Table&quot;,
</I>&gt;<i> tables(i).ToString())
</I>&gt;<i> Next
</I>&gt;<i> sqlad.Fill(sqldata)
</I>&gt;<i> connect.Close()
</I>&gt;<i> Catch ex as SqlException
</I>&gt;<i> WriteLine(&quot;Error &quot; + ex.Message.ToString())
</I>&gt;<i> End Try
</I>&gt;<i> 
</I>&gt;<i> Nothing amazing. The problem is the connection string -
</I>&gt;<i> I've googled
</I>&gt;<i> around and nothing seems to fit. The exception thrown is
</I>&gt;<i> that it can't
</I>&gt;<i> log in for user pb5\paul. If I add User Id=paul or User
</I>&gt;<i> Id=pb5\paul, it
</I>&gt;<i> still won't connect.
</I>&gt;<i> 
</I>&gt;<i> What is wrong?
</I>&gt;<i> 
</I>&gt;<i> TTFN
</I>&gt;<i> 
</I>&gt;<i> Paul
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Vertraue mir, ich weiss, was ich mache...
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist&#160; -&#160; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> 
</I>

      
_______________________________________________
Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="046002.html">[Mono-list] Connecting to a database (VB)
</A></li>
	<LI>Next message: <A HREF="046010.html">[Mono-list] Connecting to a database (VB)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46005">[ date ]</a>
              <a href="thread.html#46005">[ thread ]</a>
              <a href="subject.html#46005">[ subject ]</a>
              <a href="author.html#46005">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
