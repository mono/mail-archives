<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] passing MonoArray from c#
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20passing%20MonoArray%20from%20c%23&In-Reply-To=23349690.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042319.html">
   <LINK REL="Next"  HREF="042325.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] passing MonoArray from c#</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20passing%20MonoArray%20from%20c%23&In-Reply-To=23349690.post%40talk.nabble.com"
       TITLE="[Mono-list] passing MonoArray from c#">robertj at gmx.net
       </A><BR>
    <I>Sat May  2 17:36:25 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="042319.html">[Mono-list] passing MonoArray from c#
</A></li>
        <LI>Next message: <A HREF="042325.html">[Mono-list] passing MonoArray from c#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42320">[ date ]</a>
              <a href="thread.html#42320">[ thread ]</a>
              <a href="subject.html#42320">[ subject ]</a>
              <a href="author.html#42320">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>fozzie wrote:
&gt;<i> mMonoClass-&gt;invoke() is just looking up the method name then calling
</I>&gt;<i> mono_runtime_invoke(). Trace statements show that the Pack() method is
</I>&gt;<i> receiving the parameters correctly and returns. It gets the correct return
</I>&gt;<i> value for other c# methods, but they are returning scalars rather than
</I>&gt;<i> arrays.
</I>
Arrays are objects in mono. If your method is able to return
MonoObjects* then it will work with arrays just fine.

I guess your mMonoClass-&gt;invoke() is simply not checking
whether an exception has occurred. It's the last argument
to mono_runtime_invoke.

&gt;<i> There is another wrinkle in this - the call is crossing domain boundaries on
</I>&gt;<i> the c# side. There is an exception at runtime if the Link and Data
</I>&gt;<i> structures are not declared serializable.
</I>
Switch the domains (mono_domain_set()) before calling the
method but ensure that all objects passed as arguments are
originating from the correct domain.

If you cannot ensure this, then you must go over the remoting
stack. This is transparent even in embedding scenarios.
Of course, the classes must be either serializable or MBRs,
but at least you won't lose your mind.

&gt;<i> I think there may be too many moving pieces in this solution. Do you know of
</I>&gt;<i> an easier way to do this? Maybe i can pass a MonoArray** from the unmanaged
</I>&gt;<i> code, receive it as an [out] parameter on the c# side, fill it with Link
</I>&gt;<i> data, and return? I'm not sure how to do this, unfortunately. 
</I>
This won't save you the domain switch.

Robert

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042319.html">[Mono-list] passing MonoArray from c#
</A></li>
	<LI>Next message: <A HREF="042325.html">[Mono-list] passing MonoArray from c#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42320">[ date ]</a>
              <a href="thread.html#42320">[ thread ]</a>
              <a href="subject.html#42320">[ subject ]</a>
              <a href="author.html#42320">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
