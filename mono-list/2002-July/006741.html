<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] CS-Mail-API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:fejj%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="006740.html">
   <LINK REL="Next"  HREF="006743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] CS-Mail-API
   </H1>
    <B>Jeffrey Stedfast
    </B> 
    <A HREF="mailto:fejj%40ximian.com"
       TITLE="[Mono-list] CS-Mail-API">fejj@ximian.com
       </A><BR>
    <I>02 Jul 2002 23:21:45 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="006740.html">[Mono-list] Help with bug fixes
</A></li>
        <LI> Next message: <A HREF="006743.html">[Mono-list] Problem with while loop and Main returning void
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6741">[ date ]</a>
              <a href="thread.html#6741">[ thread ]</a>
              <a href="subject.html#6741">[ subject ]</a>
              <a href="author.html#6741">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

Sorry I didn't respond sooner.

First, is there a tool or something I can use to &quot;display&quot; this other
than a text editor? I'm just not used to reading APIs in XML format...
:<i>-)
</I>
Okay, now for some comments...

	&lt;enum name=&quot;AddressType&quot;&gt;
		&lt;member name=&quot;EmailAddress&quot;/&gt;
		&lt;member name=&quot;InternetAddress&quot;/&gt;
		&lt;member name=&quot;NewsAddress&quot;/&gt;
	&lt;/enum&gt;

What's an InternetAddress? Anyways, that's not my biggest concern -
which is that the classes don't seem to address addresses like:

MONO: <A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>, <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>;

These days you rarely ever see this, but at my last job I came accross
this quite a lot.

	&lt;enum name=&quot;MessageFlags&quot;&gt;
		&lt;member name=&quot;None&quot;/&gt;
		&lt;member name=&quot;Seen&quot;/&gt;
		&lt;member name=&quot;Answered&quot;/&gt;
		&lt;member name=&quot;Flagged&quot;/&gt;
		&lt;member name=&quot;Deleted&quot;/&gt;
		&lt;member name=&quot;Draft&quot;/&gt;
		&lt;member name=&quot;Recent&quot;/&gt;
		&lt;member name=&quot;UserDefined&quot;/&gt;
	&lt;/enum&gt;

This shouldn't be an enum since you can theoretically have more than a
single flag marked. For example, a message could be Seen and Answered.
We use a bit field in Camel to handle this.

	&lt;enum name=&quot;FolderType&quot;&gt;
		&lt;member name=&quot;Folders&quot;/&gt;
		&lt;member name=&quot;Message&quot;/&gt;
		&lt;member name=&quot;Both&quot;/&gt;
	&lt;/enum&gt;

This might be better as a bitfield too? It might be nicer if the names
were something more like CAN_HOLD_FOLDERS and CAN_HOLD_MESSAGES (I'm
partial to caps for enums but my point here is actually the clarity of
what the value means - myFolder.type == Folders just doesn't convey the
meaning the same way myFolder.type == CanHoldFolders).

The reason I suggest a bitfield for this is that it makes it easier to
do something like:

if (myFolder.type &amp; CAN_HOLD_FOLDERS) {
   scan_for_subfolders ();
}

sure, you can do it by doing:

if (myFolder.type == CAN_HOLD_FOLDERS || myFolder.type == CAN_HOLD_BOTH)
but it's more typing.

	&lt;enum name=&quot;MessageSortStyle&quot;&gt;
		&lt;member name=&quot;Default&quot;/&gt;
		&lt;member name=&quot;From&quot;/&gt;
		&lt;member name=&quot;Size&quot;/&gt;
		&lt;member name=&quot;Date&quot;/&gt;
		&lt;member name=&quot;Subject&quot;/&gt;
	&lt;/enum&gt;

there should probably be a way of extending this? In Evolution, we have
a lot more ways of sorting than just these (as do many mail clients).
Actually I'm not convinced that csMail should even worry about sorting.
This can be done at a higher level.

Same for FolderSortStyle.

	&lt;enum name=&quot;ProviderType&quot;&gt;
		&lt;member name=&quot;Store&quot;/&gt;
		&lt;member name=&quot;Transport&quot;/&gt;
	&lt;/enum&gt;

yet another bitfield probably? Example: NNTP is both a provider and a transport.

	&lt;enum name=&quot;ReciepientType&quot;&gt;

type-o :-)

In class ContentType what is ctor? Oh, constructor?
Just smack me :-)

Is ContentType::Equals() for matching exactly? In Evolution, we do:

header_content_type_is (content_type, &quot;text&quot;, &quot;*&quot;)

It doesn't use regex or anything complex like that, the rule is that if
the string is &quot;*&quot; then it's a wildcard else it's not. This is very
useful when traversing MIME parts looking for a text part for example
:<i>-)
</I>
In class EMailAddress, why do we care about 'host'? I can't think of a
reason why you wouldn't want to just refer to the entire addr-spec. I
guess it's no big deal though.

class EMailAddressList:

A good convenience function to have here would be to have a ToString
method that gave you the encoded address and one that gave you the
non-encoded (display version?) address.

Also, it seems that there is no way to get the entire EMailAddressList
as a single string? This would also be useful.

class Folder:

&lt;property name=&quot;Messages&quot; type=&quot;Message[]&quot; allow=&quot;get;&quot;/&gt;

this is gonna require a ton of memory for a folder of any considerable
size. I suggest having a method to instead just get a summary of
messages. Imagine:

class MessageInfo {
   string from;
   string to;
   string cc;
   string bcc;  /* is this even really needed?? */
   string subject;
   string message_id;
   string references;  /* needed for proper threading */
   DateType sent_date; /* date in Date: header */
   DateType rcvd_date; /* date received, if different from sent_date */
   Uint32 flags;       /* bitfield of Seen/Deleted/etc */

   ...
};

This will require much much less memory and would also be considerably
faster to &quot;load&quot; (especially in the IMAP case) since it will require so
much less I/O.

Oh, my bad... farther down you have a GetMessages() method that only
gets specific messages that you request. However, you still have no way
to get a summary like I suggested above for constructing a message-list
in a client application so I guess what I said above still applies.

	&lt;class name=&quot;FolderAddress&quot;&gt;

This class looks exactly the same as URLName, so this should probably be
scrapped.

&lt;class name=&quot;Message&quot;&gt;

Okay... most of my comments for this class are uncertain... the ideas
are just the way I'm used to doing things and not necessarily &quot;wrong&quot;.

For example, I don't think we really need Message::Flags (which also
means we won't need Message::IsSet()). But to get rid of the IsSet()
method, we'd need a method on the folder to get this info. You should
probably have a method for getting the MessageInfo based on a message or
a UID or an index.

A message's flags are really just metadata and not really part of the
message at all. Or at least that's my paradign.

Message::IsExpunged() sorta follows the same idea...why do we need this?
If we have an instance of the message, do we really care? I dunno,
perhaps it could be useful.

&lt;method name=&quot;SaveChanges&quot; type=&quot;abstract&quot;/&gt;

This method doesn't really make sense for spools, of course SaveChanges
could be implemented to delete the original message and append the new
form of the message to the end of the spool?

I don't think the message needs to reference the folder either, however
doing so could simplify things.

Anyways, that's all I can think of at the moment.

Jeff

On Thu, 2002-06-27 at 08:55, Gaurav Vaish wrote:
&gt;<i> Hello everybody,
</I>&gt;<i>  I have now released the first version (not draft) of the API.
</I>&gt;<i> 
</I>&gt;<i>  I would like some comments on it, especially from geeks of evolution/camel (if here) and ppl like AjayD.
</I>&gt;<i>  ;-)
</I>&gt;<i> 
</I>&gt;<i>  I am also attaching a copy of the same here.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Gaurav Vaish
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ____________________________________________________________
</I>&gt;<i> Win a first-class trip to New Orleans and vacation Elvis Style!.
</I>&gt;<i> Enter NOW!
</I>&gt;<i> <A HREF="http://r.lycos.com/r/sagel_mail/http://www.elvis.lycos.com/sweepstakes/">http://r.lycos.com/r/sagel_mail/http://www.elvis.lycos.com/sweepstakes/</A>
</I>-- 
Jeffrey Stedfast
Evolution Hacker - Ximian, Inc.
<A HREF="mailto:fejj@ximian.com">fejj@ximian.com</A>  - www.ximian.com



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="006740.html">[Mono-list] Help with bug fixes
</A></li>
	<LI> Next message: <A HREF="006743.html">[Mono-list] Problem with while loop and Main returning void
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6741">[ date ]</a>
              <a href="thread.html#6741">[ thread ]</a>
              <a href="subject.html#6741">[ subject ]</a>
              <a href="author.html#6741">[ author ]</a>
         </LI>
       </UL>
</body></html>
