<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Problem with while loop and Main returning void
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:AjayKumar.Dwivedi%40dresdner-bank.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="006882.html">
   <LINK REL="Next"  HREF="006751.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Problem with while loop and Main returning void
   </H1>
    <B>Dwivedi , Ajay Kumar
    </B> 
    <A HREF="mailto:AjayKumar.Dwivedi%40dresdner-bank.com"
       TITLE="[Mono-list] Problem with while loop and Main returning void">AjayKumar.Dwivedi@dresdner-bank.com
       </A><BR>
    <I>Wed, 3 Jul 2002 09:20:08 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="006882.html">[Mono-list] Windows.Forms, KDE
</A></li>
        <LI> Next message: <A HREF="006751.html">[Mono-list] Stoked about what you guys are doing.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6747">[ date ]</a>
              <a href="thread.html#6747">[ thread ]</a>
              <a href="subject.html#6747">[ subject ]</a>
              <a href="author.html#6747">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Surely a bug in both mcs and runtime.
	Firstly mcs did not generate the ret statement. The monodis of
the break.exe shows:
	IL_000f: br IL_0019
but there is no instruction at IL_0019. Looks like the ret instruction
is not generated although it is assumed to be there.

	The PE file is invalid since &quot;fall thru end of the method&quot; is
not allowed. This is the error reported by PEVerify on a custom assembled
exe where ret statement is replaced by nop.

	The runtime is also in error since it should throw an exception
which it finds the branch instruction is asking it to transfer control
to nonexisting location.

Ajay

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Leigh Dyer [mailto:<A HREF="mailto:leigh@eclinic.com.au">leigh@eclinic.com.au</A>]
</I>&gt;<i> Sent: Wednesday, July 03, 2002 12:00 PM
</I>&gt;<i> To: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
</I>&gt;<i> Subject: [Mono-list] Problem with while loop and Main returning void
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hey guys,
</I>&gt;<i> 
</I>&gt;<i> I think I've found a minor bug in either mcs or the runtime. I was
</I>&gt;<i> writing a small app that has just has a Main() and a small while(true)
</I>&gt;<i> loop, with a break condition inside it. However, when I 
</I>&gt;<i> compiled my app
</I>&gt;<i> with mcs and ran it with mono, after breaking out of the while(true)
</I>&gt;<i> loop my program kept running - it seems to just keep 
</I>&gt;<i> re-running Main().
</I>&gt;<i> Running with mint exits at the end of the first run, but with a
</I>&gt;<i> &quot;Trace/breakpoint trap&quot; message.
</I>&gt;<i> 
</I>&gt;<i> However, if I change my Main() so that it returns int instead of void,
</I>&gt;<i> and add a &quot;return 0;&quot; to the end, everything works as expected.
</I>&gt;<i> 
</I>&gt;<i> I tried to isolate the problem with a small test case, and while it
</I>&gt;<i> doesn't exhibit exactly the same behaviour, it still doesn't work as
</I>&gt;<i> expected with Main() returning void - mint segfaults and mono returns
</I>&gt;<i> the following error:
</I>&gt;<i> 
</I>&gt;<i> ** (process:18686): WARNING (recursed) **: unhandled exception
</I>&gt;<i> System.NullReferenceException: &quot;A null value was found where an object
</I>&gt;<i> instance was required&quot;
</I>&gt;<i> 
</I>&gt;<i> RESULT: -1
</I>&gt;<i> 
</I>&gt;<i> and then needs to be sent a ctrl-c.
</I>&gt;<i> 
</I>&gt;<i> I'm running the mono CVS debs from <A HREF="http://www.atoker.com/mono/">http://www.atoker.com/mono/</A> as of
</I>&gt;<i> yesterday on a Debian sid system.
</I>&gt;<i> 
</I>&gt;<i> I've attached both my small test case and the original app (it's very
</I>&gt;<i> small - all it does is iterate over the bytes of a text file 
</I>&gt;<i> looking for
</I>&gt;<i> non-ascii chars) - I hope they're of some use.
</I>&gt;<i> 
</I>&gt;<i> Thanks
</I>&gt;<i> Leigh
</I>&gt;<i> 
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="006882.html">[Mono-list] Windows.Forms, KDE
</A></li>
	<LI> Next message: <A HREF="006751.html">[Mono-list] Stoked about what you guys are doing.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6747">[ date ]</a>
              <a href="thread.html#6747">[ thread ]</a>
              <a href="subject.html#6747">[ subject ]</a>
              <a href="author.html#6747">[ author ]</a>
         </LI>
       </UL>
</body></html>
