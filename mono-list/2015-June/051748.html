<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Problem with mono and HtttpWebRequest (ssl)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Problem%20with%20mono%20and%20HtttpWebRequest%20%28ssl%29&In-Reply-To=%3CBN3PR0801MB11547387A48ED6757D9AD79CFAA70%40BN3PR0801MB1154.namprd08.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="051743.html">
   <LINK REL="Next"  HREF="051749.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Problem with mono and HtttpWebRequest (ssl)</H1>
    <B>Edward Ned Harvey (mono)</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Problem%20with%20mono%20and%20HtttpWebRequest%20%28ssl%29&In-Reply-To=%3CBN3PR0801MB11547387A48ED6757D9AD79CFAA70%40BN3PR0801MB1154.namprd08.prod.outlook.com%3E"
       TITLE="[Mono-list] Problem with mono and HtttpWebRequest (ssl)">edward.harvey.mono at clevertrove.com
       </A><BR>
    <I>Tue Jun 16 12:50:41 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="051743.html">[Mono-list] Problem with mono and HtttpWebRequest (ssl)
</A></li>
        <LI>Next message: <A HREF="051749.html">[Mono-list] Problem with mono and HtttpWebRequest (ssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51748">[ date ]</a>
              <a href="thread.html#51748">[ thread ]</a>
              <a href="subject.html#51748">[ subject ]</a>
              <a href="author.html#51748">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A> [mailto:mono-list-
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">bounces at lists.ximian.com</A>] On Behalf Of MkProc
</I>&gt;<i> 
</I>&gt;<i> but using my company&#8217;s site I always get exceptions like this:
</I>&gt;<i> 
</I>&gt;<i> System.Net.WebException: Error getting response stream (Write: The
</I>&gt;<i> authentication or decryption has failed.): SendFailure ---&gt;
</I>&gt;<i> System.IO.IOException: The authentication or decryption has failed. ---&gt;
</I>
Try using these guys on your company server, and see what they say. If you have a broken server SSL configuration, they'll expose it for you.
<A HREF="https://www.ssllabs.com/ssltest/index.html">https://www.ssllabs.com/ssltest/index.html</A> 

First of all, works for me. I tested on windows, mac (mono 3.12.1), and linux (centos 6, mono 3.4.1). I tested against my own company server.

My first suspicion, make sure your company server is correctly serving the intermediate cert, and that the company server is using a root which is trusted by the client. In Apache, the relevant directives are SSLCertificateFile, SSLCertificateChainFile, and SSLCACertificateFile

When you run mozroots, you only populate roots. Not intermediates. It just so happens, mono doesn't store intermediates, which requires the server to send the intermediate every time. The behavior on windows is different - Every time windows sees an intermediate cert, it stores it, and if any connection ever fails to deliver an intermediate, windows attempts to fix the broken chain by scanning cached intermediates. IMHO, this is bad behavior because Windows is covering up for a broken server configuration - but that's the way it is.

What kind of server are you running?

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="051743.html">[Mono-list] Problem with mono and HtttpWebRequest (ssl)
</A></li>
	<LI>Next message: <A HREF="051749.html">[Mono-list] Problem with mono and HtttpWebRequest (ssl)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51748">[ date ]</a>
              <a href="thread.html#51748">[ thread ]</a>
              <a href="subject.html#51748">[ subject ]</a>
              <a href="author.html#51748">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
