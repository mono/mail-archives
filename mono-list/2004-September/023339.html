<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Label stops updating during System.Timers.Timer callbacks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Jimmy%20Do%20%3Ccrispyleaves%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="023338.html">
   <LINK REL="Next"  HREF="023340.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Label stops updating during System.Timers.Timer callbacks
   </H1>
    <B>Jimmy Do
    </B> 
    <A HREF="mailto:Jimmy%20Do%20%3Ccrispyleaves%40gmail.com%3E"
       TITLE="[Mono-list] Label stops updating during System.Timers.Timer callbacks">Jimmy Do &lt;crispyleaves@gmail.com&gt;
       </A><BR>
    <I>Tue, 21 Sep 2004 08:53:17 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="023338.html">[Mono-list] i follow with assemblies problems...
</A></li>
        <LI> Next message: <A HREF="023340.html">[Mono-list] Problem with multiple web applications
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23339">[ date ]</a>
              <a href="thread.html#23339">[ thread ]</a>
              <a href="subject.html#23339">[ subject ]</a>
              <a href="author.html#23339">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everyone,

I was just experimenting with System.Timers.Timer in Mono and found
something strange happening. First, I created a window with a Label in
it. Then I setup a Timer to go off every second. In the
ElapsedEventHandler callback, I set the label's text equal to a
counter that I increment every time the callback is invoked. The
application works for a little bit and I see the label counting up
from 1, but the label eventually stops updating. Strangely, some debug
output with Console.WriteLine shows that the callback is still being
invoked.

The label usually stops updating after I *drag the parent window
around the screen*. After it stops updating, if you drag a second
window on top of the label and then move the window away, the label
will not redraw and you'll be left with an empty parent window.

Some info about my setup:
Mono 1.0.1
MonoDevelop 0.5
Fedora Core 2


Here's the code:

//////////////////////
// Main.cs
//////////////////////
using System;
using Gtk;

class TimerApp
{
	public static void Main(string[] args)
	{
		Application.Init();
		new TimerWindow();
		Application.Run();
	}
}


//////////////////////////////
// TimerWindow.cs
//////////////////////////////
using System;
using System.Timers;
using Gtk;

public class TimerWindow : Window
{
	
	public TimerWindow() : base(&quot;TimerWindow&quot;)
	{
		this.DeleteEvent += new DeleteEventHandler(OnWindowDelete);
		
		VBox vbox = new VBox();
		myCountLabel = new Label(&quot;-&quot;);
		
		vbox.PackStart(new Label(&quot;The number below will count up:&quot;));
		vbox.PackStart(myCountLabel);
		this.Add(vbox);


		myCounter = 0;
		
		Timer timer = new Timer();		
		timer.Interval = 500;
		timer.Elapsed += new ElapsedEventHandler(OnTimeElapsed);
		timer.Start();
		
						
		this.ShowAll();
	}
	
	private void OnWindowDelete(object o, DeleteEventArgs args)
	{
		Application.Quit();
		
	}
	
	private void OnTimeElapsed(object o, ElapsedEventArgs args)
	{
		myCounter++;
		myCountLabel.Text = myCounter.ToString();
		
		Console.WriteLine(myCounter.ToString());
	}
	
	private int myCounter;
	private Label myCountLabel;
}



Thanks for any help!

Jimmy

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="023338.html">[Mono-list] i follow with assemblies problems...
</A></li>
	<LI> Next message: <A HREF="023340.html">[Mono-list] Problem with multiple web applications
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23339">[ date ]</a>
              <a href="thread.html#23339">[ thread ]</a>
              <a href="subject.html#23339">[ subject ]</a>
              <a href="author.html#23339">[ author ]</a>
         </LI>
       </UL>
</body></html>
