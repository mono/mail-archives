<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] PKCS7 Mail
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20PKCS7%20Mail&In-Reply-To=B9E8CAB897D169409548B45B8AB864900186B149%40EMAIL02.pnl.gov">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036537.html">
   <LINK REL="Next"  HREF="036540.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] PKCS7 Mail</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20PKCS7%20Mail&In-Reply-To=B9E8CAB897D169409548B45B8AB864900186B149%40EMAIL02.pnl.gov"
       TITLE="[Mono-list] PKCS7 Mail">sebastien.pouliot at gmail.com
       </A><BR>
    <I>Tue Oct  9 13:26:03 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="036537.html">[Mono-list] PKCS7 Mail
</A></li>
        <LI>Next message: <A HREF="036540.html">[Mono-list] Mono compile success
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36538">[ date ]</a>
              <a href="thread.html#36538">[ thread ]</a>
              <a href="subject.html#36538">[ subject ]</a>
              <a href="author.html#36538">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Nathan,

On Tue, 2007-10-09 at 09:52 -0700, Trimble, Nathan G wrote:
&gt;<i> I need some advice for programmatically creating smime email.  I have
</I>&gt;<i> been trying to use MailMessage, EnvelopedCms, and X509Certificate2 under
</I>&gt;<i> .Net 2.0 to create an encrypted mail message.  I have a certificate from
</I>&gt;<i> my organization's pki in .p7c pkcs7 format.  When I try to create an
</I>&gt;<i> X509Certificate2 object using it I get an exception.  
</I>
hmm... I'm surprised since 2.0 supports many formats 

&gt;<i> It would appear
</I>&gt;<i> that format is not supported using this class.  
</I>
IIRC Windows uses p7c files as a structure than contains a collection of
certificates (and CRL). This is similar to the SPC format(*) used for
Authenticode (which is supported by mono).

(*) well SPC is a (very) small subset of PKCS#7

&gt;<i> I'm now looking at the
</I>&gt;<i> Mono.Security.X509 namespace.  Does anyone know if there is something in
</I>&gt;<i> Mono I could use to get a .p7c certificate imported into my program for
</I>&gt;<i> this purpose?  Thanks.
</I>
Quick answer: yes

Long answer: 

It depends. Mono.Security provides low-level API, down to ASN.1
decoding, so you can, in theory, decode anything (as long as you write
the source to do so).

Mono.Security contains some classes that can be useful (e.g. the SPC
decoding) and other PKCS#7 related code (mostly for Authenticode).
However it's not clear it they will work, as is, on you .p7c file.

&gt;<i> N8 Trimble
</I>&gt;<i> 509.375.6413
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">nathan.trimble at pnl.gov</A> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036537.html">[Mono-list] PKCS7 Mail
</A></li>
	<LI>Next message: <A HREF="036540.html">[Mono-list] Mono compile success
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36538">[ date ]</a>
              <a href="thread.html#36538">[ thread ]</a>
              <a href="subject.html#36538">[ subject ]</a>
              <a href="author.html#36538">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
