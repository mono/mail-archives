<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] SqlDBType.Money processed wrong with mono 2.6.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20SqlDBType.Money%20processed%20wrong%20with%20mono%202.6.4&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045297.html">
   <LINK REL="Next"  HREF="045299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] SqlDBType.Money processed wrong with mono 2.6.4</H1>
    <B>Josef Semmler</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20SqlDBType.Money%20processed%20wrong%20with%20mono%202.6.4&In-Reply-To="
       TITLE="[Mono-list] SqlDBType.Money processed wrong with mono 2.6.4">josef.semmler at gmail.com
       </A><BR>
    <I>Sun Jun 13 04:59:35 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="045297.html">[Mono-list] several mono-service, but always display same process name/command in 	ksysguard
</A></li>
        <LI>Next message: <A HREF="045299.html">[Mono-list] SqlDBType.Money processed wrong with mono 2.6.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45298">[ date ]</a>
              <a href="thread.html#45298">[ thread ]</a>
              <a href="subject.html#45298">[ subject ]</a>
              <a href="author.html#45298">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

i'm either doing someing stupid - or there is a bug with handling
SqlDBType.Money in mono 2.6.4 ... please help me.

I have a sqlserver 2005 -  in a table with an attribute &quot;Amount&quot; of type
&quot;Money&quot; i try to store different values, which are in the c# code
represented as &quot;decimal&quot; - for any reason, the values are stored completly
wrong.
Here is a sample code, which tries to store different values:

using System;
using System.Data;
using System.Data.SqlClient;

namespace TestDecimalBugWithMono
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                AddItem((decimal)12);
                AddItem((decimal)12.3);
                AddItem((decimal)12.34);
                AddItem((decimal)12.345);
                AddItem((decimal)12.3456);
                AddItem((decimal)12.34567);
                AddItem((decimal)12.345678);
           }
            catch (Exception ex)
            {
                Console.WriteLine(ex);
            }
        }

        static void AddItem(decimal amount)
        {
            string connectionString =
System.Configuration.ConfigurationManager.ConnectionStrings[&quot;testdata&quot;].ConnectionString;

            using (SqlConnection connection = new
SqlConnection(connectionString))
            {
                connection.Open();
                using (SqlCommand command = new SqlCommand(&quot;INSERT INTO
TestData (Amount) VALUES (@Amount)&quot;, connection))
                {
                    command.CommandType = CommandType.Text;

                    SqlParameter parm = new SqlParameter(&quot;@Amount&quot;,
SqlDbType.Money);
                    parm.Value = amount;

                    command.Parameters.Add(parm);

                    int numRecordsAffected = command.ExecuteNonQuery();
                    Console.WriteLine(&quot;Nb record added: {0}&quot;,
numRecordsAffected);
                }
            }
        }
    }
}
When i run the code with mono 2.6.4 the following values end up in the
database:

0,0012
0,0123
0,1234
1,2345
12,3456
123,4567
1234,5678

This happens when using mono 2.6.4 - mono 2.4 and windows .net seem to store
the values correctly ...

What am i missing? Is this a bug?

thanks
Josef
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20100613/b75a2b54/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20100613/b75a2b54/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045297.html">[Mono-list] several mono-service, but always display same process name/command in 	ksysguard
</A></li>
	<LI>Next message: <A HREF="045299.html">[Mono-list] SqlDBType.Money processed wrong with mono 2.6.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45298">[ date ]</a>
              <a href="thread.html#45298">[ thread ]</a>
              <a href="subject.html#45298">[ subject ]</a>
              <a href="author.html#45298">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
