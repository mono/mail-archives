<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] pthreads in mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20pthreads%20in%20mono&In-Reply-To=3d2f29dc0803280842x1b128398l71afcd37e9c6afa9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038114.html">
   <LINK REL="Next"  HREF="038077.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] pthreads in mono</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20pthreads%20in%20mono&In-Reply-To=3d2f29dc0803280842x1b128398l71afcd37e9c6afa9%40mail.gmail.com"
       TITLE="[Mono-list] pthreads in mono">lupus at ximian.com
       </A><BR>
    <I>Fri Mar 28 13:21:48 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="038114.html">[Mono-list] pthreads in mono
</A></li>
        <LI>Next message: <A HREF="038077.html">[Mono-list] Linux IP Networking Wrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38115">[ date ]</a>
              <a href="thread.html#38115">[ thread ]</a>
              <a href="subject.html#38115">[ subject ]</a>
              <a href="author.html#38115">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/28/08 Chris Howie wrote:
&gt;<i> Note that it's not that simple though.  The signature specifies a
</I>&gt;<i> pthread_t*, not a pthead_t**.  It wants a pointer to a structure that
</I>&gt;<i> will be filled in, not a pointer to a pointer (as is IntPtr&amp;).  The
</I>&gt;<i> code as writted above will certainly corrupt the memory next to the
</I>&gt;<i> location that the &quot;handler&quot; local is stored in, unless
</I>&gt;<i> sizeof(pthread_t) is &lt;= IntPtr.Size.
</I>
Sure and my code is correct and won't generate any memory corruption
because all the sane operating systems have pthread_t as an integer or a
pointer. You're free to look for an operating system where the above is
incorrect. When you have found it (you might need to write you own, as
even OSX got this bit right...) you will have to port mono to it first.

The reason the C++ code posted did a new pthread_t is possibly that by
default people like to waste memory and they allocated it on the heap.
It can be a simple local value as in my sample or a static/instance
field somewhere, as long as it is valid for when you need to remove the
callback it's fine.

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">lupus at ximian.com</A>                             Monkeys do it better
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038114.html">[Mono-list] pthreads in mono
</A></li>
	<LI>Next message: <A HREF="038077.html">[Mono-list] Linux IP Networking Wrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38115">[ date ]</a>
              <a href="thread.html#38115">[ thread ]</a>
              <a href="subject.html#38115">[ subject ]</a>
              <a href="author.html#38115">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
