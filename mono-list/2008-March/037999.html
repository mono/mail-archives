<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] C# script editor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20C%23%20script%20editor&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037998.html">
   <LINK REL="Next"  HREF="038013.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] C# script editor</H1>
    <B>Andrus Moor</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20C%23%20script%20editor&In-Reply-To="
       TITLE="[Mono-list] C# script editor">kobruleht2 at hot.ee
       </A><BR>
    <I>Tue Mar 11 12:23:32 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="037998.html">[Mono-list] ASP.NET Forms Authentication
</A></li>
        <LI>Next message: <A HREF="038013.html">[Mono-list] ASP Compilation Problems (Freebsd 6.3/Apache 2.2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37999">[ date ]</a>
              <a href="thread.html#37999">[ thread ]</a>
              <a href="subject.html#37999">[ subject ]</a>
              <a href="author.html#37999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm looking for a open source C# script editor to be embedded to MONO 2 
application.

I found SyntaxBox  in 
<A HREF="http://www.puzzleframework.com/wikiengine/WikiPageViewer.aspx?ID=90">http://www.puzzleframework.com/wikiengine/WikiPageViewer.aspx?ID=90</A>  (last 
link).

SyntaxBox uses DllImports in 3 files (NativeMethods.cs, AutoListForm.cs, 
InfoTipform.cs) , code shown below.

What to you think which is best way to solve this:

1. Change SyntaxBox source code not to use direct WinAPI calls when running 
under MONO.
Is it possible/reasonable to try it to port this MONO ?

2. Use Scincilla or FireBall Editorcontrol.

3. Create new implementation form scratch.

Andrus.


DllImport occurances:

NativeMethods.cs:

        [DllImport(&quot;uxtheme.dll&quot;, SetLastError = true, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern IntPtr OpenThemeData(IntPtr hwnd, 
[MarshalAs(UnmanagedType.LPWStr)] string pszClassList);

        [DllImport(&quot;uxtheme.dll&quot;, CharSet = CharSet.Auto, CallingConvention 
= CallingConvention.StdCall)]
        public static extern IntPtr CloseThemeData(IntPtr hTheme);

        [DllImport(&quot;uxtheme.dll&quot;, CharSet = CharSet.Auto, CallingConvention 
= CallingConvention.StdCall)]
        public static extern bool IsThemeActive();

        [DllImport(&quot;uxtheme.dll&quot;, CharSet = CharSet.Auto, CallingConvention 
= CallingConvention.StdCall)]
        public static extern int DrawThemeBackground(IntPtr hTheme, IntPtr 
hdc, int iPartId, int iStateId, ref APIRect rect, ref APIRect clipRect);

        [DllImport(&quot;uxtheme.dll&quot;, CharSet = CharSet.Auto, CallingConvention 
= CallingConvention.StdCall)]
        public static extern int DrawThemeText(IntPtr hTheme, IntPtr hdc, 
int iPartId, int iStateId, string pszText, int iCharCount, uint dwTextFlags, 
uint dwTextFlags2, [MarshalAs(UnmanagedType.Struct)] ref APIRect rect);

        [DllImport(&quot;uxtheme.dll&quot;, CharSet = CharSet.Auto, CallingConvention 
= CallingConvention.StdCall)]
        public static extern int GetThemeColor(IntPtr hTheme, int iPartId, 
int iStateId, int iPropId, out ulong color);


  [DllImport(&quot;imm32.dll&quot;)]
  public static extern IntPtr ImmGetDefaultIMEWnd(IntPtr hWnd);

  [DllImport(&quot;user32.dll&quot;)]
  public static extern int SendMessage(IntPtr hWnd, int msg, int wParam, 
COMPOSITIONFORM lParam);

  [DllImport(&quot;user32.dll&quot;)]
  public static extern int SendMessage(IntPtr hWnd, int msg, int wParam, 
LogFont lParam);

        [DllImport(&quot;user32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int DrawText(IntPtr hDC, string lpString, int 
nCount, ref APIRect Rect, int wFormat);

        public const int GWL_STYLE = -16;
        public const int WS_CHILD = 0x40000000;


        [DllImport(&quot;gdi32&quot;, SetLastError = true, CharSet = CharSet.Ansi, 
CallingConvention = CallingConvention.StdCall)]
        public static extern int EnumFontFamiliesEx(IntPtr hDC, 
[MarshalAs(UnmanagedType.LPStruct)] LogFont lf, FONTENUMPROC proc, Int64 
LParam, Int64 DW);

        [DllImport(&quot;shlwapi.dll&quot;, SetLastError = true)]
        public static extern int SHAutoComplete(IntPtr hWnd, UInt32 flags);

        [DllImport(&quot;user32.dll&quot;)]
        public static extern IntPtr GetDesktopWindow();

        [DllImport(&quot;user32.DLL&quot;)]
        public static extern IntPtr GetWindowRect(IntPtr hWND, ref APIRect 
Rect);

        [DllImport(&quot;user32.dll&quot;, EntryPoint = &quot;SendMessage&quot;)]
        public static extern int SendMessage(IntPtr hWND, int message, int 
WParam, int LParam);

        [DllImport(&quot;user32.dll&quot;)]
        public static extern bool ReleaseCapture();

        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern int SetWindowLong(IntPtr hWnd, int nIndex, int 
dwNewLong);

        [DllImport(&quot;gdi32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int SetBkColor(IntPtr hDC, int crColor);

        [DllImport(&quot;gdi32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int SetBkMode(IntPtr hDC, int Mode);

        [DllImport(&quot;user32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr ReleaseDC(IntPtr hWND, IntPtr hDC);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr DeleteDC(IntPtr hDC);


        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr GdiFlush();

        [DllImport(&quot;user32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr GetWindowDC(IntPtr hWND);

        [DllImport(&quot;user32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr GetDC(IntPtr hWND);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr CreateCompatibleBitmap(IntPtr hDC, int 
nWidth, int nHeight);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr CreateCompatibleDC(IntPtr hDC);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr SelectObject(IntPtr hDC, IntPtr 
hObject);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr DeleteObject(IntPtr hObject);

        [DllImport(&quot;gdi32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int GetTextColor(IntPtr hDC);

        [DllImport(&quot;gdi32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int SetTextColor(IntPtr hDC, int crColor);

        [DllImport(&quot;gdi32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int GetBkColor(IntPtr hDC);


        [DllImport(&quot;gdi32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int GetBkMode(IntPtr hDC);

        [DllImport(&quot;user32&quot;, SetLastError = false, CharSet = CharSet.Auto, 
CallingConvention = CallingConvention.StdCall)]
        public static extern int DrawFocusRect(IntPtr hDC, ref APIRect 
rect);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr CreateSolidBrush(int crColor);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern int Rectangle(IntPtr hDC, int left, int top, 
int right, int bottom);

        [DllImport(&quot;gdi32.DLL&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr CreateHatchBrush(int Style, int 
crColor);

        [DllImport(&quot;user32.DLL&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int TabbedTextOut(IntPtr hDC, int x, int y, 
string lpString, int nCount, int nTabPositions, ref int lpnTabStopPositions, 
int nTabOrigin);

        [DllImport(&quot;gdi32.dll&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern IntPtr BitBlt(IntPtr hDestDC, int x, int y, int 
nWidth, int nHeight, IntPtr hSrcDC, int xSrc, int ySrc, int dwRop);

        [DllImport(&quot;user32.dll&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int FillRect(IntPtr hDC, ref APIRect rect, 
IntPtr hBrush);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern int GetTextFace(IntPtr hDC, int nCount, string 
lpFacename);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern int GetTextMetrics(IntPtr hDC, ref 
GDITextMetric TextMetric);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Ansi, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr 
CreateFontIndirect([MarshalAs(UnmanagedType.LPStruct)]LogFont LogFont);

        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, SetLastError = 
false)]
        public static extern int GetTabbedTextExtent(IntPtr hDC, string 
lpString, int nCount, int nTabPositions, ref int lpnTabStopPositions);

        [DllImport(&quot;user32.dll&quot;, SetLastError = false, CharSet = 
CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int InvertRect(IntPtr hDC, ref APIRect rect);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr CreatePen(int nPenStyle, int nWidth, int 
crColor);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern int SetBrushOrgEx(IntPtr hDC, int x, int y, ref 
APIPoint p);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr CreatePatternBrush(IntPtr hBMP);

        [DllImport(&quot;User32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern int ShowWindow(IntPtr hWnd, short cmdShow);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr MoveToEx(IntPtr hDC, int x, int y, ref 
APIPoint lpPoint);

        [DllImport(&quot;gdi32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern IntPtr LineTo(IntPtr hDC, int x, int y);

        [DllImport(&quot;user32&quot;, CharSet = CharSet.Auto, CallingConvention = 
CallingConvention.StdCall)]
        public static extern UInt16 GetAsyncKeyState(int vKey);


AutoListForm.cs, InfoTipform.cs:

[DllImport(&quot;user32.dll&quot;, EntryPoint = &quot;SendMessage&quot;)]
private static extern
   int SendMessage(IntPtr hWnd, int message, int _data, int _id);



</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037998.html">[Mono-list] ASP.NET Forms Authentication
</A></li>
	<LI>Next message: <A HREF="038013.html">[Mono-list] ASP Compilation Problems (Freebsd 6.3/Apache 2.2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37999">[ date ]</a>
              <a href="thread.html#37999">[ thread ]</a>
              <a href="subject.html#37999">[ subject ]</a>
              <a href="author.html#37999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
