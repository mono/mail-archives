<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Fwd: Threading and IO problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Fwd%3A%20Threading%20and%20IO%20problem&In-Reply-To=3d2f29dc0803090447n2e6d7062u7e7c39c72b8e733a%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037982.html">
   <LINK REL="Next"  HREF="037986.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Fwd: Threading and IO problem</H1>
    <B>Yanko Hern&#225;ndez &#193;lvarez</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Fwd%3A%20Threading%20and%20IO%20problem&In-Reply-To=3d2f29dc0803090447n2e6d7062u7e7c39c72b8e733a%40mail.gmail.com"
       TITLE="[Mono-list] Fwd: Threading and IO problem">yhdezalvarez at gmail.com
       </A><BR>
    <I>Mon Mar 10 10:08:48 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="037982.html">[Mono-list] Fwd: Threading and IO problem
</A></li>
        <LI>Next message: <A HREF="037986.html">[Mono-list] configure mod-mono-server to handle multiple	streams to a single ip
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37985">[ date ]</a>
              <a href="thread.html#37985">[ thread ]</a>
              <a href="subject.html#37985">[ subject ]</a>
              <a href="author.html#37985">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt;  OTOH and as a curiosity: Is there any way to free memory directly (at
</I>&gt;<i> &gt;  CIL level I mean) without using the GC? for instance:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;    while ((Str = SR.ReadLine()) != null) ;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  with a little flow analisis we can determine Str isn't used after it
</I>&gt;<i> &gt;  is assigned. is there a way to deallocate it efficiently without
</I>&gt;<i> &gt;  waiting for the GC to collect memory?
</I>&gt;<i>
</I>&gt;<i>  This would also have to be determined for the ReadLine() method
</I>&gt;<i>  (making sure it doesn't stash a reference somewhere) as well as any
</I>&gt;<i>  methods that ReadLine() passes that string reference to (which may be
</I>&gt;<i>  none, but you get my point).
</I>
Yes, I know. When I asked about it I was thinking of a way for the JIT
to rely on the compiler to do this analysis, and don't waste JIT
compilation time on this matter. I mean, to successfully  implement
this, there must be a way to tell the runtime this object won't be
used in the future without it having to wait for the GC to extract
this knowledge from the live object references.

This would allow to:
* convey more information of the object usage to the runtime. The
runtime could use this information to detect incorrect programmer
assumptions (&quot;This object is of no use at this point, so the GC will
collect it..&quot;) about the program behavior (for instance in debug mode,
this could be treated as a hint). See for example bug
#357649(<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=357649">https://bugzilla.novell.com/show_bug.cgi?id=357649</A>). I assume
(from comment #3) the library programmer thought no one was using the
input stream at his point (when a &quot;Process&quot; object is finalized), so
let's close it. There is no way to assert this information (&quot;there is
no reference to this stream&quot;) to the runtime (at least I don't know
how to do it). Result: this particular error. This would also help to
detect unexpected &quot;... stashed references somewhere&quot; (memory leaks in
many cases ;-) which is a good thing I suppose.
* lessen the pressure on the GC (using some invocation switch to the
runtime) to treat these hints as deallocations.
* anything in between.

If the runtime doesn't help with this, this would only be possible at
JIT time (or at AOT compilation with a little extra support from the
mono runtime).

Well to much daydreaming for today, back to work

Best regards
      Yanko
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037982.html">[Mono-list] Fwd: Threading and IO problem
</A></li>
	<LI>Next message: <A HREF="037986.html">[Mono-list] configure mod-mono-server to handle multiple	streams to a single ip
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37985">[ date ]</a>
              <a href="thread.html#37985">[ thread ]</a>
              <a href="subject.html#37985">[ subject ]</a>
              <a href="author.html#37985">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
