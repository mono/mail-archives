<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Fwd:  Threading and IO problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Fwd%3A%20%20Threading%20and%20IO%20problem&In-Reply-To=a8051c180803070433j713c3309j73d480204105ac74%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037966.html">
   <LINK REL="Next"  HREF="037967.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Fwd:  Threading and IO problem</H1>
    <B>Jonathan Gagnon</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Fwd%3A%20%20Threading%20and%20IO%20problem&In-Reply-To=a8051c180803070433j713c3309j73d480204105ac74%40mail.gmail.com"
       TITLE="[Mono-list] Fwd:  Threading and IO problem">jonathan.gagnon at croesus.com
       </A><BR>
    <I>Fri Mar  7 08:26:32 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="037966.html">[Mono-list] Fwd:  Threading and IO problem
</A></li>
        <LI>Next message: <A HREF="037967.html">[Mono-list]  Threading and IO problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37971">[ date ]</a>
              <a href="thread.html#37971">[ thread ]</a>
              <a href="subject.html#37971">[ subject ]</a>
              <a href="author.html#37971">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

My guess is that your threads are waiting for the data to load from the
system memory to the processor cache.  If you do the same test with a small
file (one that would fit in the CPU cache), and read the file multiple
times, I'm pretty sure that the CPU usage would go up.

Jonathan

-----Message d'origine-----
De : <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A>] De la part de Yanko Hern&#225;ndez
&#193;lvarez
Envoy&#233; : Friday, March 07, 2008 7:34 AM
&#192; : <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>
Objet : [Mono-list] Fwd: Threading and IO problem

I sent this yesterday with the wrong sender address. Sorry

&gt;<i> &gt;  It is a Dell PowerEdge 2900 (2 xeon 5050, dual core, each core 
</I>&gt;<i> &gt; hyperthreaded)
</I> &gt;  That's only 4 real execution units.  You're getting the extra smidgeon
&gt;<i>  of performance that HT gives in the best case, but there just aren't 8  &gt;
</I>cores there.  Getting real quad core chips (Harpertown) will likely  &gt;  mean
you can get to full 8 core usage.

 Yes, I know I won't get the same processing power of 8 real  processors.
Nevertheless the OS should occupy the 8 logical processors  to the full
extent with no idle time. That isn't happening when I run  this program. But
it does happen when I do some other stuff, e.g. when  I'm compiling the
kernel with &quot;make -j8 ...&quot;. The problem seems to be  that the threads (for a
reason I don't know yet) block for little  periods of time. There are no
other runnable process interfering here,  because there is idle time left.

 There is no IOWAIT either, so the HDs are not the bottleneck (3 disks
 raid5 10Krpm). The file is cached on memory completely so there is no  HD
access (visually confirmed -the HDD LEDs almost doesn't blink  during the
program run-, besides the stats posted earlier showed it  too).

 Besides, the example I posted is not equivalent of the original  program
I'm developing. That program uses a shared object that feeds  the threads
10k lines at a time. With that scheme, the processor usage  was around
75-80%. This is another reason that makes me think the GC  is involved.

 Tomorrow (It's almost 5pm here in Cuba) I will try a different  approach
(instead of using threads, I will use processes to isolate  the GC effect to
one thread)


 &gt;  If you turn off HT in the BIOS (if such a thing is possible on a Dell)

 it is.

 see ya tomorrow. and thanks to all ;-)
_______________________________________________
Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037966.html">[Mono-list] Fwd:  Threading and IO problem
</A></li>
	<LI>Next message: <A HREF="037967.html">[Mono-list]  Threading and IO problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37971">[ date ]</a>
              <a href="thread.html#37971">[ thread ]</a>
              <a href="subject.html#37971">[ subject ]</a>
              <a href="author.html#37971">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
