<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] How to create C++ library and call it's functions from C# program?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:vguzev%40yandex.ru">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="018878.html">
   <LINK REL="Next"  HREF="018883.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] How to create C++ library and call it's functions from C# program?
   </H1>
    <B>Vadim B. Guzev
    </B> 
    <A HREF="mailto:vguzev%40yandex.ru"
       TITLE="[Mono-list] How to create C++ library and call it's functions from C# program?">vguzev@yandex.ru
       </A><BR>
    <I>Thu, 11 Mar 2004 23:25:18 +0300</I>
    <P><UL>
        <LI> Previous message: <A HREF="018878.html">[Mono-list] test
</A></li>
        <LI> Next message: <A HREF="018883.html">[Mono-list] How to create C++ library and call it's functions
 from C# program?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18879">[ date ]</a>
              <a href="thread.html#18879">[ thread ]</a>
              <a href="subject.html#18879">[ subject ]</a>
              <a href="author.html#18879">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>!


I'm trying to call some simple C++ functions from C# program.
Here's the sources I used:

8&lt;------------------------------------------------------------
[<A HREF="mailto:vadim@server">vadim@server</A> SCSI tests]$ cat FromCSharpToC.cs
using System;
using System.Runtime.InteropServices;

public class FromCSharpToC {
 [DllImport(&quot;libmylib.so&quot;, EntryPoint=&quot;print&quot;)]
 static extern void print (string src);

 public static void Main( string[] args ) {
  print(&quot;Hello world!&quot;);
 }
}

8&lt;------------------------------------------------------------

8&lt;------------------------------------------------------------
[<A HREF="mailto:vadim@server">vadim@server</A> SCSI tests]$ cat mylib.cpp
#include &lt;iostream.h&gt;

static void print( const char* line ) {
 cout &lt;&lt; line &lt;&lt; endl;
}

8&lt;------------------------------------------------------------

And here is a Makefile I used:
8&lt;------------------------------------------------------------
[<A HREF="mailto:vadim@server">vadim@server</A> SCSI tests]$ cat Makefile
all: o so exe


o:
        gcc -fpic -c mylib.cpp

so:
        gcc -shared -o libmylib.so mylib.o

exe:
        mcs FromCSharpToC.cs -o fromcsharptoc.exe

8&lt;------------------------------------------------------------

However, when I try to launch fromcsharptoc.exe it gives me the following:

8&lt;------------------------------------------------------------
[<A HREF="mailto:vadim@server">vadim@server</A> SCSI tests]$ make
gcc -fpic -c mylib.cpp
gcc -shared -o libmylib.so mylib.o
mcs FromCSharpToC.cs -o fromcsharptoc.exe
Compilation succeeded
[<A HREF="mailto:vadim@server">vadim@server</A> SCSI tests]$ mono fromcsharptoc.exe

** (fromcsharptoc.exe:26607): WARNING **: Failed to load library
./libmylib.so (libmylib.so): ./libmylib.so: undefined symbol:
__gxx_personality_v0

** (fromcsharptoc.exe:26607): WARNING **: Failed to load library
./libmylib.so (libmylib.so): ./libmylib.so: undefined symbol:
__gxx_personality_v0

Unhandled Exception: System.MissingMethodException: A missing method
exception has occurred.
in &lt;0x00042&gt; (wrapper managed-to-native) .FromCSharpToC:print (string)
in &lt;0x0000c&gt; .FromCSharpToC:Main (string[])

8&lt;------------------------------------------------------------

Where's a mistake? Maybe I compile C++ source in a wrong way? (I'm a newbie
in C++-programming).
Is there some good tutorials on this theme? (I couldn't find anything :( )


Best regards,
Vadim B. Guzev


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="018878.html">[Mono-list] test
</A></li>
	<LI> Next message: <A HREF="018883.html">[Mono-list] How to create C++ library and call it's functions
 from C# program?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18879">[ date ]</a>
              <a href="thread.html#18879">[ thread ]</a>
              <a href="subject.html#18879">[ subject ]</a>
              <a href="author.html#18879">[ author ]</a>
         </LI>
       </UL>
</body></html>
