<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] GLib.Idle.Add fixes ThradNotify - (&lt;unknown&gt;:14842): GLib-WARNING
 **: poll(2) failed due to: Invalid argument.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:moritz.angermann%40gmx.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="019142.html">
   <LINK REL="Next"  HREF="019144.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] GLib.Idle.Add fixes ThradNotify - (&lt;unknown&gt;:14842): GLib-WARNING
 **: poll(2) failed due to: Invalid argument.
   </H1>
    <B>Moritz Angermann
    </B> 
    <A HREF="mailto:moritz.angermann%40gmx.net"
       TITLE="[Mono-list] GLib.Idle.Add fixes ThradNotify - (&lt;unknown&gt;:14842): GLib-WARNING
 **: poll(2) failed due to: Invalid argument.">moritz.angermann@gmx.net
       </A><BR>
    <I>Sun, 21 Mar 2004 12:31:14 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="019142.html">[Mono-list] ThradNotify - (&lt;unknown&gt;:14842): GLib-WARNING **: poll(2) failed
 due to: Invalid argument.
</A></li>
        <LI> Next message: <A HREF="019144.html">[Mono-list] [ANN] Firebird ADO.NET Data Provider 1.5.2 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19143">[ date ]</a>
              <a href="thread.html#19143">[ thread ]</a>
              <a href="subject.html#19143">[ subject ]</a>
              <a href="author.html#19143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-6/VJAzTpXXjr4qlEv6MK
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

buzgub(@irc.gnome.org#mono) supposed
to use GLib.Idle.Add So I rewrote the part where ThreadNotify is
used (argumentedThreadNotify) to use GLib.Idle.Add and now it works
flawlessly. So I guess it's somewhere in the ThreadNotify...

I'm still using Mono 0.30.1 and Gtk# 0.17

::<i> ResourceFile: tnt.glade
</I>::<i> References: glade-sharp.dll, gtk-sharp.dll, glib-sharp.dll
</I>
kindest Regards,
 -mo
-- 
----------------  contact info  ----------------
Moritz Angermann       	<A HREF="mailto:moritz.angermann@gmx.net">moritz.angermann@gmx.net</A>
Liquid:Mint            	www.liquidmint.org
Mobile                 	+49 (0) 160 9197 5880
Home                   	+49 (0) 4322 75 12 66

--=-6/VJAzTpXXjr4qlEv6MK
Content-Disposition: attachment; filename=tnt.glade
Content-Type: text/xml; name=tnt.glade; charset=ISO-8859-15
Content-Transfer-Encoding: 7bit

&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd"">http://glade.gnome.org/glade-2.0.dtd&quot;</A>&gt;

&lt;glade-interface&gt;

&lt;widget class=&quot;GtkWindow&quot; id=&quot;win&quot;&gt;
  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;ThreadNotifyTest&lt;/property&gt;
  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
  &lt;signal name=&quot;delete_event&quot; handler=&quot;on_win_delete_event&quot; last_modification_time=&quot;Sun, 21 Mar 2004 10:28:04 GMT&quot;/&gt;

  &lt;child&gt;
    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox1&quot;&gt;
      &lt;property name=&quot;width_request&quot;&gt;120&lt;/property&gt;
      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;

      &lt;child&gt;
	&lt;widget class=&quot;GtkButton&quot; id=&quot;btnGo&quot;&gt;
	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
	  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
	  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Start&lt;/property&gt;
	  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
	  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
	  &lt;signal name=&quot;clicked&quot; handler=&quot;on_btnGo_clicked&quot; last_modification_time=&quot;Sun, 21 Mar 2004 10:05:19 GMT&quot;/&gt;
	&lt;/widget&gt;
	&lt;packing&gt;
	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
	  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
	&lt;/packing&gt;
      &lt;/child&gt;

      &lt;child&gt;
	&lt;widget class=&quot;GtkStatusbar&quot; id=&quot;sb&quot;&gt;
	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
	  &lt;property name=&quot;has_resize_grip&quot;&gt;False&lt;/property&gt;
	&lt;/widget&gt;
	&lt;packing&gt;
	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
	  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
	&lt;/packing&gt;
      &lt;/child&gt;
    &lt;/widget&gt;
  &lt;/child&gt;
&lt;/widget&gt;

&lt;/glade-interface&gt;

--=-6/VJAzTpXXjr4qlEv6MK
Content-Description: 
Content-Disposition: attachment; filename=Main.cs
Content-Type: text/x-csharp; charset=iso-8859-15
Content-Transfer-Encoding: 7bit

// created on 03/21/2004 at 11:04
using System;
using System.Collections;
using System.Threading;

using Glade;
using Gtk;

namespace myTests{
	// argumentedThreadNotify
	// -- littel bit modified ThreadNotify to take arguments
	//    and Queue them to get the correctly ordered Output. 
	class argumentedThreadNotify{
		Statusbar sb = null;
		Queue sbMsgQueue = new Queue( );
		
		public argumentedThreadNotify( ref Statusbar s )
		{
			this.sb = s;
		}
		
		// Statusbar Pair...
		public void state( string msg )
		{
			lock( this.sbMsgQueue )
				this.sbMsgQueue.Enqueue( msg );
			GLib.Idle.Add(
				new GLib.IdleHandler(
					this.updateStatusbar
				)
			);
			/*
			new ThreadNotify(
				new ReadyEvent(
					this.updateStatusbar
				)
			).WakeupMain( );
			*/
		}
		bool updateStatusbar( )
		{
			lock( this.sbMsgQueue )
				while( this.sbMsgQueue.Count &gt; 0 )
				{
					this.sb.Pop( 1 );
					this.sb.Push( 1, (string) this.sbMsgQueue.Dequeue( ) );
				}
			return true;
		}
	}
	// Thready... Go! Go! Go! --- nothing new here!
	class argumentedThread{
		int sleep = 0;
		int cycles = 0;
		argumentedThreadNotify atv = null;
		public argumentedThread( ref argumentedThreadNotify a, int s, int c )
		{
			this.atv = a;
			this.sleep = s;
			this.cycles = c;
		}
		public void Run( )
		{
			for( int i = 0; i &lt; this.cycles; i++ )
			{
				this.atv.state(  i.ToString( ) + &quot;/&quot; + this.cycles );
				Console.Out.WriteLine( i.ToString( ) + &quot;/&quot; + this.cycles );
				Thread.Sleep( this.sleep );
			}
		}
	}
	// not that Interesting -- application init, open Glade, call Thread on btnClick, Application.Quit.
	class gui{
		[Glade.Widget] Statusbar sb;
		argumentedThreadNotify atv = null;
		Thread runner = null;
		public gui( )
		{
			Application.Init( );
			Glade.XML gxml = new Glade.XML( null, &quot;tnt.glade&quot;, &quot;win&quot;, null );
			gxml.Autoconnect( this );
			Application.Run( );
		}
		void on_btnGo_clicked( object o, EventArgs args )
		{
			atv = new argumentedThreadNotify( ref sb );
			runner = new Thread(
				new ThreadStart(
					new argumentedThread(
						ref atv,	// argumentedThreadNotify
						10,		// ThreadSleep
						2000 	// Cycles
					).Run
				)
			);
			runner.Start( );
		}
		void on_win_delete_event( object o, EventArgs args )
		{
			runner.Abort( );
			Application.Quit( );
		}
	}
	// Main -- do nothing, but open a new gui!
	class ThreadNotifyTest{
		public static void Main( string[] args )
		{
			new gui( );
		}
	}
}
--=-6/VJAzTpXXjr4qlEv6MK--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="019142.html">[Mono-list] ThradNotify - (&lt;unknown&gt;:14842): GLib-WARNING **: poll(2) failed
 due to: Invalid argument.
</A></li>
	<LI> Next message: <A HREF="019144.html">[Mono-list] [ANN] Firebird ADO.NET Data Provider 1.5.2 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19143">[ date ]</a>
              <a href="thread.html#19143">[ thread ]</a>
              <a href="subject.html#19143">[ subject ]</a>
              <a href="author.html#19143">[ author ]</a>
         </LI>
       </UL>
</body></html>
