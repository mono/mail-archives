<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] SWF &amp; Winelib Q&amp;A
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:peter%40novonyx.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="019127.html">
   <LINK REL="Next"  HREF="019119.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] SWF &amp; Winelib Q&amp;A
   </H1>
    <B>Peter Dennis Bartok
    </B> 
    <A HREF="mailto:peter%40novonyx.com"
       TITLE="[Mono-list] SWF &amp; Winelib Q&amp;A">peter@novonyx.com
       </A><BR>
    <I>Fri, 19 Mar 2004 15:53:59 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="019127.html">[Mono-list] Hi everybody !
</A></li>
        <LI> Next message: <A HREF="019119.html">[Mono-list] Web Site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19117">[ date ]</a>
              <a href="thread.html#19117">[ thread ]</a>
              <a href="subject.html#19117">[ subject ]</a>
              <a href="author.html#19117">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Search your disk for libgdiplus.so and make sure you don't have 
duplicates. The libgdiplus that is being loaded by mono does not contain 
a particular function which usually points to an older library being 
used, despite the newer one also being installed.

If you have 'locate' on your system try 'locate libgdiplus' and post the 
results. That'll show us if you've got various versions of it installed.

Peter


Pedro Santos wrote:
&gt;<i> Hey! What about my question? :P Can someone help me? I have installed
</I>&gt;<i> everything again and still I ave the same problem compiling a simple SWF
</I>&gt;<i> application:
</I>&gt;<i> 
</I>&gt;<i> bash-2.05b$ mono h.exe
</I>&gt;<i> 
</I>&gt;<i> When you are running with a native NT directory specify
</I>&gt;<i> 'Profile=&lt;profiledirectory&gt;' or disable loading of Windows
</I>&gt;<i> registry (LoadWindowsRegistryFiles=N)
</I>&gt;<i>  
</I>&gt;<i> Unhandled Exception: System.EntryPointNotFoundException:
</I>&gt;<i> GdipCreateFontFamilyFromName
</I>&gt;<i> in &lt;0x00053&gt; (wrapper managed-to-native)
</I>&gt;<i> System.Drawing.GDIPlus:GdipCreateFontFamilyFromName
</I>&gt;<i> (string,intptr,intptr&amp;)
</I>&gt;<i> in &lt;0x0007c&gt; System.Drawing.FontFamily:.ctor
</I>&gt;<i> (string,System.Drawing.Text.FontCollection)
</I>&gt;<i> in &lt;0x00012&gt; System.Drawing.FontFamily:.ctor (string)
</I>&gt;<i> in &lt;0x00056&gt; (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.Drawing.FontFamily:.ctor (string)
</I>&gt;<i> in &lt;0x0005b&gt; System.Drawing.Font:.ctor
</I>&gt;<i> (string,single,System.Drawing.FontStyle,System.Drawing.GraphicsUnit,byte,bool)
</I>&gt;<i> in &lt;0x00028&gt; System.Drawing.Font:.ctor
</I>&gt;<i> (string,single,System.Drawing.FontStyle)
</I>&gt;<i> in &lt;0x00083&gt; (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.Drawing.Font:.ctor (string,single,System.Drawing.FontStyle)
</I>&gt;<i> in &lt;0x00039&gt; System.Drawing.Font:FromHfont (intptr)
</I>&gt;<i> in &lt;0x00018&gt; System.Windows.Forms.Control:get_DefaultFont ()
</I>&gt;<i> in &lt;0x00055&gt; System.Windows.Forms.Control:get_Font ()
</I>&gt;<i> in &lt;0x0002d&gt; System.Windows.Forms.Control:OnHandleCreated
</I>&gt;<i> (System.EventArgs)
</I>&gt;<i> in &lt;0x00026&gt; System.Windows.Forms.Form:OnHandleCreated
</I>&gt;<i> (System.EventArgs)
</I>&gt;<i> in &lt;0x0025a&gt; System.Windows.Forms.Control:CreateHandle ()
</I>&gt;<i> in &lt;0x0000a&gt; System.Windows.Forms.Form:CreateHandle ()
</I>&gt;<i> in &lt;0x00033&gt; System.Windows.Forms.Control:CreateControl ()
</I>&gt;<i> in &lt;0x0004f&gt; (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.Windows.Forms.Control:CreateControl ()
</I>&gt;<i> in &lt;0x00015&gt; System.Windows.Forms.Application:Run
</I>&gt;<i> (System.Windows.Forms.Form)
</I>&gt;<i> in &lt;0x00024&gt;
</I>&gt;<i> Microsoft.Samples.WinForms.Cs.SimpleHelloWorld.SimpleHelloWorld:Main
</I>&gt;<i> (string[])
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Fri, 2004-03-19 at 21:02, Peter Dennis Bartok wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i>Hi All,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I figured since there are quite a few questions regarding winelib that 
</I>&gt;&gt;<i>I'd write a little blurb on how things are connected. I tried to start 
</I>&gt;&gt;<i>it in FAQ form to allow later inclusion into the FAQ.
</I>&gt;&gt;<i>Let me know if it helps, if you have additional questions or if you 
</I>&gt;&gt;<i>notice something wrong/missing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>1. What dependencies does System.Windows.Forms (SWF) have?
</I>&gt;&gt;<i>2. When running a SWF application I get the 
</I>&gt;&gt;<i>System.DllNotFoundException:winelib.exe.so exception. What's wrong?
</I>&gt;&gt;<i>3. How can I verify that I've got winelib installed correctly?
</I>&gt;&gt;<i>4. When trying to run a SWF application I get the 
</I>&gt;&gt;<i>System.DllNotFoundException:user32.dll exception. What's wrong?
</I>&gt;&gt;<i>5. When running a SWF application I don't get the usual nice exception 
</I>&gt;&gt;<i>with stack and everything. What happened?
</I>&gt;&gt;<i>6. How does winelib work?
</I>&gt;&gt;<i>7. Why do I have to do those links from wine to the lib directory?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>1. What dependencies does System.Windows.Forms (SWF) have?
</I>&gt;&gt;<i>The following is the dependency tree:
</I>&gt;&gt;<i>-&gt; System.Windows.Forms
</I>&gt;&gt;<i>    -&gt; Winelib
</I>&gt;&gt;<i>       -&gt; Wine
</I>&gt;&gt;<i>    -&gt; System.Drawing
</I>&gt;&gt;<i>       -&gt; gdiplus
</I>&gt;&gt;<i>          -&gt; cairo
</I>&gt;&gt;<i>             -&gt; pixman
</I>&gt;&gt;<i>             -&gt; freetype
</I>&gt;&gt;<i>             -&gt; Xrender
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Unless you have *all* of these libraries working on your system, SWF 
</I>&gt;&gt;<i>will not operate (and in most cases even initialize).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>2. When running a SWF application I get the 
</I>&gt;&gt;<i>System.DllNotFoundException:winelib.exe.so exception. What's wrong?
</I>&gt;&gt;<i>Several possible causes:
</I>&gt;&gt;<i>- The winelib package is not installed
</I>&gt;&gt;<i>- Winelib is installed but wine is not
</I>&gt;&gt;<i>- winelib.exe.so is not in &lt;prefix&gt;/lib
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>3. How can I verify that I've got winelib installed correctly?
</I>&gt;&gt;<i>Winelib will be installed into the &lt;prefix&gt;/lib directory. &lt;prefix&gt; was 
</I>&gt;&gt;<i>chosen when the install packages was created. If you want to have 
</I>&gt;&gt;<i>winelib in another directory than the default where it was installed to, 
</I>&gt;&gt;<i>you must get the source packages and configure &amp; compile it for a 
</I>&gt;&gt;<i>different path.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>4. When trying to run a SWF application I get the 
</I>&gt;&gt;<i>System.DllNotFoundException:user32.dll exception. What's wrong?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>In order for SWF and winelib to operate properly you need to have 
</I>&gt;&gt;<i>symbolic links for the wine dlls in the &lt;prefix&gt;/lib directory. While 
</I>&gt;&gt;<i>the rpm should install those automatically as part of the postinstall 
</I>&gt;&gt;<i>script you can also manually create those with the following command:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>cd &lt;prefix&gt;/lib
</I>&gt;&gt;<i>for i in &lt;wine_dll_dir&gt;/*dll.so; do ln -s $i lib`basename $i`; done
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>&lt;prefix&gt; is the base directory where mono is installed under (ie. /usr 
</I>&gt;&gt;<i>or /usr/local) and &lt;wine_dll_dir&gt; is the directory where the wine dlls 
</I>&gt;&gt;<i>(user32.dll.so, gdi32.dll.so, etc) can be found (ie. /usr/lib/wine or 
</I>&gt;&gt;<i>/usr/local/lib/wine)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>5. When running a SWF application I don't get the usual nice exception 
</I>&gt;&gt;<i>with stack and everything. What happened?
</I>&gt;&gt;<i>This is a known issue, when initializing wine the mono exception handler 
</I>&gt;&gt;<i>is replaced with the wine exception handler. This will be fixed shortly.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>6. How does winelib work?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Winelib performs the same wine initialization as the command-line 'wine' 
</I>&gt;&gt;<i>application. As 'argument' it uses itself, effectively telling wine to 
</I>&gt;&gt;<i>rune winelib.exe.so. Before initializing, wine does a setjmp and when 
</I>&gt;&gt;<i>wine calls the winelib.exe.so WinMain function we perform a longjmp
</I>&gt;&gt;<i>back to right after the wine initialization code was called. This 
</I>&gt;&gt;<i>results in wine being initialized and control being back at the routine 
</I>&gt;&gt;<i>that got called from SWF.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>7. Why do I have to do those links from wine to the lib directory?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Currently mono is not using the LD_LIBRARY_PATH to find libraries, and 
</I>&gt;&gt;<i>also, mono has a particular naming format it expects libraries to have, 
</I>&gt;&gt;<i>all libraries have to start with 'lib', and the wine dlls don't conform. 
</I>&gt;&gt;<i>The symbolic links remedy this issue.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="019127.html">[Mono-list] Hi everybody !
</A></li>
	<LI> Next message: <A HREF="019119.html">[Mono-list] Web Site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19117">[ date ]</a>
              <a href="thread.html#19117">[ thread ]</a>
              <a href="subject.html#19117">[ subject ]</a>
              <a href="author.html#19117">[ author ]</a>
         </LI>
       </UL>
</body></html>
