<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Compilation Errors on DataSet Classes Generated byXSD.exe
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Tam%40SiuLung.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011886.html">
   <LINK REL="Next"  HREF="011929.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Compilation Errors on DataSet Classes Generated byXSD.exe
   </H1>
    <B>Alan Tam
    </B> 
    <A HREF="mailto:Tam%40SiuLung.com"
       TITLE="[Mono-list] Compilation Errors on DataSet Classes Generated byXSD.exe">Tam@SiuLung.com
       </A><BR>
    <I>Wed, 5 Feb 2003 23:19:28 +0800</I>
    <P><UL>
        <LI> Previous message: <A HREF="011886.html">[Mono-list] Compilation Errors on DataSet Classes Generated by
 XSD.exe
</A></li>
        <LI> Next message: <A HREF="011929.html">[Mono-list] Compilation Errors on DataSet Classes Generated byXSD.exe
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11923">[ date ]</a>
              <a href="thread.html#11923">[ thread ]</a>
              <a href="subject.html#11923">[ subject ]</a>
              <a href="author.html#11923">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0018_01C2CD6D.08144270
Content-Type: text/plain;
	charset=&quot;big5&quot;
Content-Transfer-Encoding: 7bit

Attached please find a patch for mcs/class/System.Data/System.Data/
and a new file for mcs/class/System/System.ComponentModel/

Suggested ChangeLog for mcs/class/System.Data/System.Data/:
Added framework for DataSet.Update
Implemented missing methods GetSchemaSerializable, GetSerializationData,
ReadXmlSerializable, ShouldSerializeRelations and ShouldSerializeTables for
DataSet
Implemented missing methods CreateInstance and GetRowType for DataTable

Suggested ChangeLog for mcs/class/System/System.ComponentModel/:
Implemented DesignerCategoryAttribute

Regards,
Alan

----- Original Message -----
From: &quot;Miguel de Icaza&quot; &lt;<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&gt;
To: &quot;Alan Tam&quot; &lt;<A HREF="mailto:Tam@SiuLung.com">Tam@SiuLung.com</A>&gt;
Cc: &quot;Mono-List&quot; &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
Sent: Wednesday, February 05, 2003 2:36 AM
Subject: Re: [Mono-list] Compilation Errors on DataSet Classes Generated
byXSD.exe


&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> &gt; I've tried to generate a class from XSD.exe by Microsoft and compile it in
</I>&gt;<i> &gt; Mono. There are many compilation errors and I have to at least patch it
</I>like
&gt;<i> &gt; this in order to make it work.
</I>&gt;<i>
</I>&gt;<i> Please post your patches in diff -u form, and also explain what the
</I>&gt;<i> patch does in a ChangeLog entry.
</I>&gt;<i>
</I>&gt;<i> Removing functionality is usually not a good idea.  It might be best to
</I>&gt;<i> just implement the missing classes.
</I>&gt;<i>
</I>&gt;<i> Miguel
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>
------=_NextPart_000_0018_01C2CD6D.08144270
Content-Type: application/octet-stream;
	name=&quot;System.Data.patch&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;System.Data.patch&quot;

Index: DataSet.cs=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /mono/mcs/class/System.Data/System.Data/DataSet.cs,v=0A=
retrieving revision 1.32=0A=
diff -u -r1.32 DataSet.cs=0A=
--- DataSet.cs	3 Feb 2003 19:04:16 -0000	1.32=0A=
+++ DataSet.cs	5 Feb 2003 15:01:59 -0000=0A=
@@ -40,6 +40,7 @@=0A=
 		// private DataTableRelationCollection relationCollection;=0A=
 		private PropertyCollection properties;=0A=
 		private DataViewManager defaultView;=0A=
+		private CultureInfo locale;=0A=
 		=0A=
 		#region Constructors=0A=
 =0A=
@@ -116,17 +117,60 @@=0A=
 		[DataCategory (&quot;Data&quot;)]=0A=
 		[DataSysDescription (&quot;Indicates a locale under which to compare =
strings within the DataSet.&quot;)]=0A=
 		public CultureInfo Locale {=0A=
-			[MonoTODO]=0A=
-			get { =0A=
-				throw new NotImplementedException ();=0A=
+			get {=0A=
+				return locale;=0A=
 			}=0A=
-			=0A=
-			[MonoTODO]=0A=
 			set {=0A=
-				throw new NotImplementedException ();=0A=
+				if (locale =3D=3D null || !locale.Equals(value)) {=0A=
+					// TODO: check if the new locale is valid=0A=
+					// TODO: update locale of all tables=0A=
+					locale =3D value;=0A=
+				}=0A=
 			}=0A=
 		}=0A=
 =0A=
+		[MonoTODO]=0A=
+		public void Merge (DataRow[] rows)=0A=
+		{=0A=
+			throw new NotImplementedException();=0A=
+		}=0A=
+		=0A=
+		[MonoTODO]=0A=
+		public void Merge (DataSet dataSet)=0A=
+		{=0A=
+			throw new NotImplementedException();=0A=
+		}=0A=
+		=0A=
+		[MonoTODO]=0A=
+		public void Merge (DataTable table)=0A=
+		{=0A=
+			throw new NotImplementedException();=0A=
+		}=0A=
+		=0A=
+		[MonoTODO]=0A=
+		public void Merge (DataSet dataSet, bool preserveChanges)=0A=
+		{=0A=
+			throw new NotImplementedException();=0A=
+		}=0A=
+		=0A=
+		[MonoTODO]=0A=
+		public void Merge (DataRow[] rows, bool preserveChanges, =
MissingSchemaAction missingSchemaAction)=0A=
+		{=0A=
+			throw new NotImplementedException();=0A=
+		}=0A=
+		=0A=
+		[MonoTODO]=0A=
+		public void Merge (DataSet dataSet, bool preserveChanges, =
MissingSchemaAction missingSchemaAction)=0A=
+		{=0A=
+			throw new NotImplementedException();=0A=
+		}=0A=
+		=0A=
+		[MonoTODO]=0A=
+		public void Merge (DataTable table, bool preserveChanges, =
MissingSchemaAction missingSchemaAction)=0A=
+		{=0A=
+			throw new NotImplementedException();=0A=
+		}=0A=
+		=0A=
 		[DataCategory (&quot;Data&quot;)]=0A=
 		[DataSysDescription (&quot;Indicates the XML uri namespace for the root =
element pointed at by this DataSet.&quot;)]=0A=
 		[DefaultValue (&quot;&quot;)]=0A=
@@ -554,6 +598,34 @@=0A=
 		}=0A=
 		#endregion=0A=
 		=0A=
+		#region Protected Methods=0A=
+		protected virtual void GetSerializationData(SerializationInfo info, =
StreamingContext context)=0A=
+		{=0A=
+			string s =3D info.GetValue (&quot;XmlDiffGram&quot;, typeof (String)) as =
String;=0A=
+			if (s !=3D null) ReadXmlSerializable (new XmlTextReader(new =
StringReader(s)));=0A=
+		}=0A=
+		=0A=
+		protected virtual System.Xml.Schema.XmlSchema GetSchemaSerializable()=0A=
+		{=0A=
+			return null; // FIXME=0A=
+		}=0A=
+		=0A=
+		protected virtual void ReadXmlSerializable(XmlReader reader)=0A=
+		{=0A=
+			ReadXml(reader, XmlReadMode.DiffGram); // FIXME=0A=
+		}=0A=
+		=0A=
+		protected virtual bool ShouldSerializeRelations ()=0A=
+		{=0A=
+			return true;=0A=
+		}=0A=
+		=0A=
+		protected virtual bool ShouldSerializeTables ()=0A=
+		{=0A=
+			return true;=0A=
+		}=0A=
+		#endregion=0A=
+=0A=
 		#region Private Xml Serialisation=0A=
 	=0A=
 		private void WriteTable( XmlWriter writer, DataTable table, =
XmlWriteMode mode )=0A=
Index: DataTable.cs=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /mono/mcs/class/System.Data/System.Data/DataTable.cs,v=0A=
retrieving revision 1.27=0A=
diff -u -r1.27 DataTable.cs=0A=
--- DataTable.cs	30 Jan 2003 16:24:39 -0000	1.27=0A=
+++ DataTable.cs	5 Feb 2003 15:02:00 -0000=0A=
@@ -555,9 +555,20 @@=0A=
 		/// and is not intended to be used directly from your code.=0A=
 		/// &lt;/summary&gt;=0A=
 		=0A=
-		//protected virtual Type GetRowType()=0A=
-		//{	=0A=
-		//}=0A=
+		protected virtual DataTable CreateInstance()=0A=
+		{=0A=
+                        return Activator.CreateInstance(this.GetType(), =
true) as DataTable;=0A=
+		}=0A=
+=0A=
+		/// &lt;summary&gt;=0A=
+		/// This member supports the .NET Framework infrastructure=0A=
+		/// and is not intended to be used directly from your code.=0A=
+		/// &lt;/summary&gt;=0A=
+		=0A=
+		protected virtual Type GetRowType()=0A=
+		{=0A=
+                        return typeof (DataRow);=0A=
+		}=0A=
 =0A=
 		/// &lt;summary&gt;=0A=
 		/// This member supports the .NET Framework infrastructure =0A=

------=_NextPart_000_0018_01C2CD6D.08144270
Content-Type: text/plain;
	name=&quot;DesignerCategoryAttribute.cs&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;DesignerCategoryAttribute.cs&quot;

//=0A=
// System.ComponentModel.DesignerCategoryAttribute.cs=0A=
//=0A=
// Author:=0A=
//   Alan Tam Siu Lung (<A HREF="mailto:Tam@SiuLung.com">Tam@SiuLung.com</A>)=0A=
//=0A=
=0A=
namespace System.ComponentModel {=0A=
=0A=
	/// &lt;summary&gt;=0A=
	///   Designer Attribute for classes.=0A=
	/// &lt;/summary&gt;=0A=
	=0A=
	/// &lt;remarks&gt;=0A=
	/// &lt;/remarks&gt;=0A=
	=0A=
	[AttributeUsage(AttributeTargets.Class)]=0A=
		public sealed class DesignerCategoryAttribute : Attribute=0A=
		{=0A=
			string category;=0A=
			public static readonly DesignerCategoryAttribute Component;=0A=
			public static readonly DesignerCategoryAttribute Form;=0A=
			public static readonly DesignerCategoryAttribute Generic;=0A=
			static readonly DesignerCategoryAttribute Default;=0A=
			=0A=
			public DesignerCategoryAttribute ()=0A=
			{=0A=
				this.category =3D &quot;&quot;;=0A=
			}=0A=
			=0A=
			public DesignerCategoryAttribute (string category)=0A=
			{=0A=
				this.category =3D category;=0A=
			}=0A=
			=0A=
			public override object TypeId {=0A=
				get {=0A=
					return GetType ();=0A=
				}=0A=
			}=0A=
			=0A=
			public string Category {=0A=
				get {=0A=
					return category;=0A=
				}=0A=
			}=0A=
			=0A=
			public override bool Equals (object obj)=0A=
			{=0A=
				if (!(obj is DesignerCategoryAttribute))=0A=
					return false;=0A=
				if (obj =3D=3D this)=0A=
					return true;=0A=
				return ((DesignerCategoryAttribute) obj).category =3D=3D category;=0A=
			}=0A=
			=0A=
			public override int GetHashCode ()=0A=
			{=0A=
				return category.GetHashCode ();=0A=
			}=0A=
			=0A=
			public override bool IsDefaultAttribute ()=0A=
			{=0A=
				return category =3D=3D DesignerCategoryAttribute.Default.Category; =
// FIXME=0A=
			}=0A=
		}=0A=
}=0A=

------=_NextPart_000_0018_01C2CD6D.08144270--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011886.html">[Mono-list] Compilation Errors on DataSet Classes Generated by
 XSD.exe
</A></li>
	<LI> Next message: <A HREF="011929.html">[Mono-list] Compilation Errors on DataSet Classes Generated byXSD.exe
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11923">[ date ]</a>
              <a href="thread.html#11923">[ thread ]</a>
              <a href="subject.html#11923">[ subject ]</a>
              <a href="author.html#11923">[ author ]</a>
         </LI>
       </UL>
</body></html>
