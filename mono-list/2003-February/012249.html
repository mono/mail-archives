<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mono performance on highly recursive functions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="012235.html">
   <LINK REL="Next"  HREF="012251.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mono performance on highly recursive functions
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] mono performance on highly recursive functions">lupus@ximian.com
       </A><BR>
    <I>Mon, 17 Feb 2003 12:06:14 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="012235.html">[Mono-list] mono performance on highly recursive functions
</A></li>
        <LI> Next message: <A HREF="012251.html">[Mono-list] mono performance on highly recursive functions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12249">[ date ]</a>
              <a href="thread.html#12249">[ thread ]</a>
              <a href="subject.html#12249">[ subject ]</a>
              <a href="author.html#12249">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/16/03 Marcus wrote:
&gt;<i> Yesterday Jeroen Frijters posted an array creation test, where mono did 
</I>&gt;<i> particularly badly. I am wondering if mono's uncharacteristically poor 
</I>&gt;<i> performance on that test is caused by a more general problem with highly 
</I>&gt;<i> recursive functions.
</I>
As I told you on IRC, the arraytest slowness (that has been fixed in
cvs) has nothing to do with the code generated by the JIT.

&gt;<i> One well-known test that features a great deal of recursion is Ackermann test. 
</I>&gt;<i> I've noticed for a while that mono runs the Ackermann test very slowly in 
</I>&gt;<i> comparison to other VMs. On most tests, mono does very well, frequently 
</I>&gt;<i> faster than Blackdown's JVM but slower than IBM's. In this case, mono takes 
</I>&gt;<i> 25 times as long as IBM's JVM and 6 times as long as Blackdown's. Perhaps 
</I>&gt;<i> this is an area that merits some investigation.
</I>
With the ackermann function, the number of calls increases exponentially
as you increase the initial starting values, so saying that it's 25
times slower doesn't mean much unless you also specify what values you
used for the test.
On my system, for example, running Ack(3, 9), mono is just 30-40% slower
than the IBM jdk 1.1.8. Using values bigger than 9 makes the IBM JVM
hang, so I couldn't test more than that with it. Since the number of
calls increases exponentially, I have no issue believing that if you got
a version of the JVM that completes the test, you'll get a factor even
more than 25 as you increase the initial values.
gcc will turn the recursion into a loop, I guess the IBM jvm does the
same and that is what gives the most speed benefit, so the issue is not
with recursion per-se, but just with recognizing when recursion can be
turned into a loop (tail-recursion elimination).
As an example, using recursive fibonacci of 41, mono is just 35% slower than
gcc -O3 -fomit-frame-pointer -march=pentium3 (and the new JIT, mini, is
23 % slower than gcc at the same test).
Detecting tail-recursion is easy and performing tail recursion
elimination should not be difficult in the new JIT, maybe one of these
days I'll have a look at doing it, but it's not an high priority
for me right now.

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="012235.html">[Mono-list] mono performance on highly recursive functions
</A></li>
	<LI> Next message: <A HREF="012251.html">[Mono-list] mono performance on highly recursive functions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12249">[ date ]</a>
              <a href="thread.html#12249">[ thread ]</a>
              <a href="subject.html#12249">[ subject ]</a>
              <a href="author.html#12249">[ author ]</a>
         </LI>
       </UL>
</body></html>
