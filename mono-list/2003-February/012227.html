<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono doesn't seem to like JSharp code in MSIL form.
 -&gt; BANG
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chris%40void.printf.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="012197.html">
   <LINK REL="Next"  HREF="012196.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono doesn't seem to like JSharp code in MSIL form.
 -&gt; BANG
   </H1>
    <B>Chris Ball
    </B> 
    <A HREF="mailto:chris%40void.printf.net"
       TITLE="[Mono-list] Mono doesn't seem to like JSharp code in MSIL form.
 -&gt; BANG">chris@void.printf.net
       </A><BR>
    <I>Sun, 16 Feb 2003 16:16:54 +0000</I>
    <P><UL>
        <LI> Previous message: <A HREF="012197.html">[Mono-list] Mono doesn't seem to like JSharp code in MSIL form. -&gt; BANG
</A></li>
        <LI> Next message: <A HREF="012196.html">[Mono-list] RE: [Ikvm-developers] ikvm under mono &amp;&amp; mauve tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12227">[ date ]</a>
              <a href="thread.html#12227">[ thread ]</a>
              <a href="subject.html#12227">[ subject ]</a>
              <a href="author.html#12227">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;<i> On 15 Feb 2003 21:20:22, Simon Waite &lt;<A HREF="mailto:simon@psionics.demon.co.uk">simon@psionics.demon.co.uk</A>&gt; said:
</I>
   &gt;&gt; I've been collecting reviews for my dissertation (which is a
   &gt;&gt; retarget of the Jikes Java compiler to output MSIL)

   &gt; Hows that dissertation going BTW ?

Great, thanks.  It's working on simple classes, and I'm concentrating on
OO model and class library mappings.  I've just finished giving a bunch
of talks on it; it's at the halfway stage, time-wise.  I've been meaning
to post an update for a while - to borrow from the talks, so far I've:

   - Created a complete set of opcode mappings.

   - Written methods for dereferencing Java's constant pool.  Java
     doesn't allow variable-length data in the code segment, so you
     end up with (simplified) bytecode like:

       method_info  name_index 5  descriptor_index 6
       3   ldc 15
       5   invokevirtual 20
       8   return

       ==
       15  CONSTANT_String_info: string_index: 16
       16  CONSTANT_Utf8_info: length: 11 Hello World
       20  CONSTANT_Methodref_info: class_index: 21
       21  CONSTANT_Class_info: name_index 22
       22  CONSTANT_Utf8_info: length: 19 java/io/PrintStream

     In constrast, MSIL inlines all of this:

       IL_0000: ldstr &quot;Hello World&quot;
       IL_0005: call void class [corlib]System.Console::WriteLine(string)
       IL_000a: ret

   - Kept track of local variables, etc.  The bytecode verification
     actually stops me from needing to do a lot of reporting and type
     checking, which is neat.

   - Class mappings.  A basic case'd be:

       System.out.println(&quot;a: &quot; + a + &quot; b: &quot; + b);
         .. to ..
       System.Console.Writeline(&quot;a: {0}, b: {1}&quot;, a, b);

     I've worked out a framework for these kind of transformations, but
     I can't see myself getting too near a full class library on my own;
     perhaps it'll get there when I release where I'm at so far (after
     the dissertation's handed in for marking in May); Jikes is under a
     GPL-like license, so if the IBM guys want to include MSIL as an
     official target (I've not crippled the capability to compile Java
     as well), that'd be a big step forward for OSS .NET, especially
     since it doesn't suffer from the J# limitation of JVM 1.1.4.

   - Test suite.  I've come up with a full regressive test suite for
     each section of the ECMA spec, and a corpus of Java code to be
     automatically compiled and assembled and run through mono to make 
     sure it's giving correct output.  As well as testing against the
     spec, there are some computational tests thrown in (Ackerman's 
     function, Sieve of Erathosthenes, Factorial, Quicksort, etc) -
     it'll be useful to see if any of my changes slow these down.
     I've knocked up a Perl/gtk2 frontend for the test suite, just 
     because having a black screen full of scrolling compiler output 
     isn't the best way to present your successes. ;-)

Right, I've written far too much already.  Apologies for the off-topic
post; in an attempt to make it more on-topic, I'd like to thank everyone
responsible for recent vast improvements to mono's ilasm - they've been
a great help.  :)

Cheers,

- Chris.
-- 
$a=&quot;printf.net&quot;;  Chris Ball | <A HREF="mailto:chris@void.">chris@void.</A>$a | www.$a | finger: chris@$a
|<i>  Q: How many OO Perl programmers does it take to change a light bulb?
</I>|<i>  A: HASH(0x870bf8)                     -- Tim Sweetman, on london-pm.
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="012197.html">[Mono-list] Mono doesn't seem to like JSharp code in MSIL form. -&gt; BANG
</A></li>
	<LI> Next message: <A HREF="012196.html">[Mono-list] RE: [Ikvm-developers] ikvm under mono &amp;&amp; mauve tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12227">[ date ]</a>
              <a href="thread.html#12227">[ thread ]</a>
              <a href="subject.html#12227">[ subject ]</a>
              <a href="author.html#12227">[ author ]</a>
         </LI>
       </UL>
</body></html>
