<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ikvm and Mono 0.20
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="012515.html">
   <LINK REL="Next"  HREF="012533.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ikvm and Mono 0.20
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] ikvm and Mono 0.20">lupus@ximian.com
       </A><BR>
    <I>Wed, 26 Feb 2003 17:16:22 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="012515.html">[Mono-list] ikvm and Mono 0.20
</A></li>
        <LI> Next message: <A HREF="012533.html">[Mono-list] ikvm and Mono 0.20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12526">[ date ]</a>
              <a href="thread.html#12526">[ thread ]</a>
              <a href="subject.html#12526">[ subject ]</a>
              <a href="author.html#12526">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/26/03 Varga Zoltan wrote:
&gt;<i> The problem is with the if (!cfg-&gt;share_code) statements in
</I>&gt;<i> the JIT,
</I>&gt;<i> which create some vtables at JIT compile time, instead of
</I>&gt;<i> creating it
</I>&gt;<i> the first time a static variable/method is accessed. 
</I>
Oh, ok, I guess we'll have to add calls to init the vtable
any time a static variable is used, possibly doing some of the same
tricks we use with method calls to reduce to the minimum the overhead
after the first call. I'll have to think about how best to integrate
this in the JIT, since I'd like to have an optimization pass remove the
calls if they are redundand.

&gt;<i> The --noinline flag
</I>&gt;<i> is only needed because of a bug at x86.brg:1699: this code
</I>&gt;<i> pushes the 
</I>&gt;<i> currently compiling method's image to the stack, instead of
</I>&gt;<i> the method 
</I>&gt;<i> to which the LDSTR belongs (the two are not necessarily
</I>&gt;<i> equal due to inlining).
</I>
Ok, this bug doesn't seem to be there in the new JIT.

&gt;<i> BTW, here is a testcase for the type initialization problem:
</I>
Thanks, I added it to the test suite.

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="012515.html">[Mono-list] ikvm and Mono 0.20
</A></li>
	<LI> Next message: <A HREF="012533.html">[Mono-list] ikvm and Mono 0.20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12526">[ date ]</a>
              <a href="thread.html#12526">[ thread ]</a>
              <a href="subject.html#12526">[ subject ]</a>
              <a href="author.html#12526">[ author ]</a>
         </LI>
       </UL>
</body></html>
