<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] detecting param object[] foo
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011962.html">
   <LINK REL="Next"  HREF="011966.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] detecting param object[] foo
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] detecting param object[] foo">lupus@ximian.com
       </A><BR>
    <I>Thu, 6 Feb 2003 16:03:01 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="011962.html">[Mono-list] detecting param object[] foo
</A></li>
        <LI> Next message: <A HREF="011966.html">[Mono-list] System.Design.dll and System.ServiceProcess.dll Stubs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11973">[ date ]</a>
              <a href="thread.html#11973">[ thread ]</a>
              <a href="subject.html#11973">[ subject ]</a>
              <a href="author.html#11973">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/06/03 Sterling Hughes wrote:
&gt;<i> I've been playing around with detecting var arg style parameters (when I
</I>&gt;<i> say that, I mean the C# equivalent, excuse a C programmer. :) For
</I>&gt;<i> example:
</I>&gt;<i> 
</I>&gt;<i> Console.WriteLine(string, param object[] foo)
</I>&gt;<i> 
</I>&gt;<i> On the internals level, from what I see that is mapped to a
</I>&gt;<i> MONO_TYPE_SZARRAY.  Are there any other distinguishing characteristics -
</I>&gt;<i> I know lupus (on irc) mentioned something about detecting a sentinel,
</I>&gt;<i> but I'm not sure exactly what that entails?  Are there any other
</I>
You asked about vararg, so I told you about the sentinel.
The 'params' modifier has nothing to do with vararg, though.

vararg is a CLR internal call convention, not accessible with standard
C# (though csc has some non-standard constructs for it) and it is
very similar to the C vararg stuff. In MonoMethodSignature we have the
sentinelpos field that specifies the first argument in the signature
that isn't a fixed argument.

The params keywork is, instead, a compiler thing: the number of
arguments is *fixed*, but one of the arguments is an array
and if the programmer passes items of the array, the compiler is
supposed to build an array under the hood and pass that.
The params keyword is stored in the metadata as a custom attribute for
the array paramenter: in C# you can access it with the standard
GetCustomAttributes() calls.
In the mono metadata API there is no specific call yet to do this,
but you can check what is involved in the metadata/reflection.c file
(function mono_reflection_get_custom_attrs).
If you file a bug report in bugzilla, I'll find the time to design and
implement an API to make the process easier from C code (unless, of
course, you want to contribute it:-).

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011962.html">[Mono-list] detecting param object[] foo
</A></li>
	<LI> Next message: <A HREF="011966.html">[Mono-list] System.Design.dll and System.ServiceProcess.dll Stubs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11973">[ date ]</a>
              <a href="thread.html#11973">[ thread ]</a>
              <a href="subject.html#11973">[ subject ]</a>
              <a href="author.html#11973">[ author ]</a>
         </LI>
       </UL>
</body></html>
