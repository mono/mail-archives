<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] XSP Binary File Upload Patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:brianlritchie%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011792.html">
   <LINK REL="Next"  HREF="011795.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] XSP Binary File Upload Patch
   </H1>
    <B>Brian Ritchie
    </B> 
    <A HREF="mailto:brianlritchie%40hotmail.com"
       TITLE="[Mono-list] XSP Binary File Upload Patch">brianlritchie@hotmail.com
       </A><BR>
    <I>Sun, 02 Feb 2003 14:47:10 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="011792.html">[Mono-list] type-reflector
</A></li>
        <LI> Next message: <A HREF="011795.html">[Mono-list] XSP Binary File Upload Patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11788">[ date ]</a>
              <a href="thread.html#11788">[ thread ]</a>
              <a href="subject.html#11788">[ subject ]</a>
              <a href="author.html#11788">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gonzalo/Simon,

I've been working with an application using the XSP Server.  It needs to 
support uploading of binary files.  XSP seems to support uploading of text 
files, but not binary.  After much research, I found a bug in the 
ReadEntityBody method.  It was using a TextReader to read the body of the 
post.  Here's a patch that allows XSP to handle binary uploads.  Please 
review and apply.

Thanks,
Brian


Replace this method in XSPWorkerRequest.cs:

public override int ReadEntityBody (byte [] buffer, int size)
{
	WebTrace.WriteLine (&quot;ReadEntityBody()&quot;);
	if (buffer == null || size == 0)
		return 0;

	BinaryReader reader=new BinaryReader(output);
	byte [] bytes = reader.ReadBytes(size);
	bytes.CopyTo(buffer,0);
	return bytes.Length;
}




_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*.  
<A HREF="http://join.msn.com/?page=features/virus">http://join.msn.com/?page=features/virus</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011792.html">[Mono-list] type-reflector
</A></li>
	<LI> Next message: <A HREF="011795.html">[Mono-list] XSP Binary File Upload Patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11788">[ date ]</a>
              <a href="thread.html#11788">[ thread ]</a>
              <a href="subject.html#11788">[ subject ]</a>
              <a href="author.html#11788">[ author ]</a>
         </LI>
       </UL>
</body></html>
