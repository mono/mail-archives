<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] DbDataAdapter.Fill patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rafaelteixeirabr%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="012507.html">
   <LINK REL="Next"  HREF="012514.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] DbDataAdapter.Fill patch
   </H1>
    <B>A Rafael D Teixeira
    </B> 
    <A HREF="mailto:rafaelteixeirabr%40hotmail.com"
       TITLE="[Mono-list] DbDataAdapter.Fill patch">rafaelteixeirabr@hotmail.com
       </A><BR>
    <I>Wed, 26 Feb 2003 07:49:52 -0300</I>
    <P><UL>
        <LI> Previous message: <A HREF="012507.html">[Mono-list] machine.config discovery on Windows
</A></li>
        <LI> Next message: <A HREF="012514.html">[Mono-list] ByValStr Marshaling bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12509">[ date ]</a>
              <a href="thread.html#12509">[ thread ]</a>
              <a href="subject.html#12509">[ subject ]</a>
              <a href="author.html#12509">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>From: Aleksey Demakov &lt;<A HREF="mailto:avd@openlinksw.com">avd@openlinksw.com</A>&gt;
</I>&gt;<i>To: Alan Tam &lt;<A HREF="mailto:Tam@SiuLung.com">Tam@SiuLung.com</A>&gt;
</I>&gt;<i>CC: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
</I>&gt;<i>Subject: Re: [Mono-list] DbDataAdapter.Fill patch
</I>&gt;<i>Date: Tue, 25 Feb 2003 15:24:56 +0600
</I>&gt;<i>
</I>&gt;<i>So what's wrong with it? I think that a DataAdapter at one time
</I>&gt;<i>should update only one table. It's absolutely wrong to iterate
</I>&gt;<i>through all the tables in the DataSet because the DataAdapter
</I>&gt;<i>contains only one set of update commands while different tables
</I>&gt;<i>require different commands.
</I>&gt;<i>
</I>&gt;<i>Regards,
</I>&gt;<i>Aleksey
</I>&gt;<i>
</I>&gt;<i>Alan Tam wrote:
</I>&gt;&gt;<i>The bottom half of the patch has been applied. Thank you.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>For the upper half, we may need more discussion. As far as I've observed, 
</I>&gt;&gt;<i>the
</I>&gt;&gt;<i>patch changes the code to simulate Microsoft behavior, which seems to be a
</I>&gt;&gt;<i>wrong behavior. I wonder if we should follow suit.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Regards,
</I>&gt;&gt;<i>Alan
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>----- Original Message -----
</I>&gt;&gt;<i>From: &quot;Aleksey Demakov&quot; &lt;<A HREF="mailto:avd@openlinksw.com">avd@openlinksw.com</A>&gt;
</I>&gt;&gt;<i>To: &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
</I>&gt;&gt;<i>Sent: Wednesday, January 22, 2003 4:37 AM
</I>&gt;&gt;<i>Subject: [Mono-list] DbDataAdapter.Fill patch
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Hi all,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I've found that the DbDataAdapter.Update (DataTable dataTable)
</I>&gt;&gt;&gt;<i>and Update (DataSet dataSet, string sourceTable) methods
</I>&gt;&gt;&gt;<i>iterate through all tables of the given dataSet and try
</I>&gt;&gt;&gt;<i>to update them with this DataAdapter. I believe that
</I>&gt;&gt;&gt;<i>this is incorrect.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>The dataSet can contain multiple DataTables which are
</I>&gt;&gt;&gt;<i>Filled using different DataAdapters with different
</I>&gt;&gt;&gt;<i>select/insert/delete/update commans. Consequently
</I>&gt;&gt;&gt;<i>one DataAdapter cannot be be able to perform all the
</I>&gt;&gt;&gt;<i>needed updates.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Unfortunately, the .NET docs are silent about this
</I>&gt;&gt;&gt;<i>issue. But I believe that DbDataAdapter.Update methods
</I>&gt;&gt;&gt;<i>should be symmetric to Fill methods. So as Fill (DataSet)
</I>&gt;&gt;&gt;<i>method fills only one DataSet table with default
</I>&gt;&gt;&gt;<i>name &quot;Table&quot;, the Update (DataSet) method should
</I>&gt;&gt;&gt;<i>only update default table. And Update (DataSet, string)
</I>&gt;&gt;&gt;<i>method should only update the specified table.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>The attached patch fixes also another problem.
</I>&gt;&gt;&gt;<i>The original code might pass a null DataTableMapping
</I>&gt;&gt;&gt;<i>value which is then used to create a RowUpdatingEventArgs
</I>&gt;&gt;&gt;<i>instance. So RowUpdatingEvent handler (for instance
</I>&gt;&gt;&gt;<i>CommandBuilder) could get null DataTableMapping which
</I>&gt;&gt;&gt;<i>might be unexpected. The patch makes sure that a non-null
</I>&gt;&gt;&gt;<i>DataTableMapping is passed.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Regards,
</I>&gt;&gt;&gt;<i>Aleksey
</I>&gt;&gt;&gt;<i>
</I>
I think nobody here has used VS.NET wizards, extensively. So let me share my 
experience...

The wizards simply won't allow anyone to make a DBAdapter updatable, if you 
bring it something more complex than a simple select from where it can find 
all the mappings automatically.

It's not that we can't make our implementation able to handle more general 
situations, but MS directs developers in that way and so they may have 
designed their classes to support ONLY that way of doing things, and 
compatibility is still a goal of this project, I think.

Show me MS classes doing that kind of multiple table updating, WITHOUT 
having to dynamically alter what the &quot;Initialize()&quot;-time code has set. 
Without that I think it's better to handle only single table updates.

Oh, yeah: It is an ugly picture seeing each of my Web Service components in 
design mode sporting some dozens of DataAdapters, but that is the way with 
MS Tools, and people from Windowsland, like me, will find it 'natural' and 
expect it to be so in Mono, too.

Best regards,

Rafael Teixeira
Brazilian Polymath
Mono, MonoQLE Hacker






_________________________________________________________________
Tired of spam? Get advanced junk mail protection with MSN 8. 
<A HREF="http://join.msn.com/?page=features/junkmail">http://join.msn.com/?page=features/junkmail</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="012507.html">[Mono-list] machine.config discovery on Windows
</A></li>
	<LI> Next message: <A HREF="012514.html">[Mono-list] ByValStr Marshaling bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12509">[ date ]</a>
              <a href="thread.html#12509">[ thread ]</a>
              <a href="subject.html#12509">[ subject ]</a>
              <a href="author.html#12509">[ author ]</a>
         </LI>
       </UL>
</body></html>
