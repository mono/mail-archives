<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] 64bit gmcs/mcs in SLES/openSuSE rpms?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%2064bit%20gmcs/mcs%20in%20SLES/openSuSE%20rpms%3F&In-Reply-To=1240600452.20813.7.camel%40lina">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042203.html">
   <LINK REL="Next"  HREF="042247.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] 64bit gmcs/mcs in SLES/openSuSE rpms?</H1>
    <B>David Henderson</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%2064bit%20gmcs/mcs%20in%20SLES/openSuSE%20rpms%3F&In-Reply-To=1240600452.20813.7.camel%40lina"
       TITLE="[Mono-list] 64bit gmcs/mcs in SLES/openSuSE rpms?">dnadavewa at yahoo.com
       </A><BR>
    <I>Tue Apr 28 05:08:44 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="042203.html">[Mono-list] 64bit gmcs/mcs in SLES/openSuSE rpms?
</A></li>
        <LI>Next message: <A HREF="042247.html">[Mono-list] 64bit gmcs/mcs in SLES/openSuSE rpms?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42246">[ date ]</a>
              <a href="thread.html#42246">[ thread ]</a>
              <a href="subject.html#42246">[ subject ]</a>
              <a href="author.html#42246">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
My apologies for a tardy reply.  I'll address all of the questions in this e-mail, rather than reply multiple times.

1) I used file to determine that the .exe files were 32bit.  It is entirely possible that file returns 32bit for all .exe, rather than examine the file.
2) Is there a way to store char/string data as something smaller than UTF-16?  The data are SNP genotypes, i.e. a single SNP genotype looks like A T and there are almost a million of these per individual.  I'm thinking that what I need to do is record the genotype as bits, i.e. 0 or 1, and relate that back to a translation class thet returns A or T when that SNP is queried.  It would be simpler if I could store char/string data as something reasonably small.
3) What I'm currently doing is:
  a) read in each line as a single string which is split based upon whitespace
  b) input each SNP into a class which is stored in an ArrayList, or as a string array in a List&lt;string&gt; (I've implemented it both ways)
  c) once the while file is read in, output each collection of SNPs by chromosome to a different file for processing by other software

I've been able to get past my initial problem by re-compiling mono with the large heap size GC and when the entire data is read in, it takes up 17GB RAM for a 300MB file.  I know I'm new to mono/C#, but I've been programming in C++ for years and have written many commerical applications for large data and nothing I've written to date has been as memory hungry as this.  I'm hoepful I can get some good suggestions on how to improve performance.

Thanks!!

Dave H



----- Original Message ----
From: Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">jonpryor at vt.edu</A>&gt;
To: dnadavewa &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">dnadavewa at yahoo.com</A>&gt;
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>
Sent: Friday, April 24, 2009 12:14:12 PM
Subject: Re: [Mono-list]  64bit gmcs/mcs in SLES/openSuSE rpms?

On Thu, 2009-04-23 at 14:20 -0700, dnadavewa wrote:
&gt;<i> I'm working on a large data problem where I'm reading in data from text files
</I>&gt;<i> with almost 2 million columns.  In doing this, I can read in about 25 rows
</I>&gt;<i> before Mono bombs out with an out of memory error.
</I>
How are you reading in these lines?

&gt;<i> What I found was the mono executable was indeed 64 bit, but gmcs.exe and
</I>&gt;<i> mcs.exe were 32 bit.
</I>
As Chris Howie mentioned, these are actually in platform-neutral IL, and
will be run using a 64-bit address space when using `mono`.

&gt;<i> One other point, memory usage is horrible.  I admit that I'm new to C# and
</I>&gt;<i> mono, so my coding skills are not as good as others, but a 300MB file should
</I>&gt;<i> not use 2GB RAM to read in 1/8 of the file.
</I>
That depends ~entirely on how you're reading in the file.

Also keep in mind that .NET strings are UTF-16, so if your input text is
ASCII, you will require twice as much RAM as the size of the file, e.g.
600MB of RAM to store the entire file as a string.  (Then there is
various object overhead considerations, but these are likely tiny
compared to the 300MB you're looking at.)

&gt;<i> I stopped using classes to
</I>&gt;<i> store the data and went with List&lt;string&gt; and List&lt;string[]&gt; to read in this
</I>&gt;<i> much data.  Any comments on how I might improve this performance would be
</I>&gt;<i> appreciated.
</I>
To provide any comments we'd need to know more about what you're trying
to do.  For example, reading a 300MB XML file using XmlDocument will
require *lots* of RAM, as in addition to the UTF-16 string issue, each
element, attribute, etc. will be represented as separate objects, with
varying amounts of memory required.  DOM would be something to avoid
here, while XmlReader would be much better.

The easiest question, though, is this: do you really need to keep the
entire file contents in memory all at once?

Or can you instead process each line independently (or while caching
minimal data from one line to the next, so that the contents of previous
lines don't need to be maintained).  This would allow you to remove your
List&lt;string&gt;, and save a ton of memory.

- Jon


      
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042203.html">[Mono-list] 64bit gmcs/mcs in SLES/openSuSE rpms?
</A></li>
	<LI>Next message: <A HREF="042247.html">[Mono-list] 64bit gmcs/mcs in SLES/openSuSE rpms?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42246">[ date ]</a>
              <a href="thread.html#42246">[ thread ]</a>
              <a href="subject.html#42246">[ subject ]</a>
              <a href="author.html#42246">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
