<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] IHttpHandler works fine under IIS but not Apache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20IHttpHandler%20works%20fine%20under%20IIS%20but%20not%20Apache&In-Reply-To=49D5DAEA.4090500%40comcast.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041984.html">
   <LINK REL="Next"  HREF="041982.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] IHttpHandler works fine under IIS but not Apache</H1>
    <B>Peter Hagen</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20IHttpHandler%20works%20fine%20under%20IIS%20but%20not%20Apache&In-Reply-To=49D5DAEA.4090500%40comcast.net"
       TITLE="[Mono-list] IHttpHandler works fine under IIS but not Apache">peter at wingsofdeath.nu
       </A><BR>
    <I>Fri Apr  3 06:00:34 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="041984.html">[Mono-list] IHttpHandler works fine under IIS but not Apache
</A></li>
        <LI>Next message: <A HREF="041982.html">[Mono-list] XSP Compilation Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41985">[ date ]</a>
              <a href="thread.html#41985">[ thread ]</a>
              <a href="subject.html#41985">[ subject ]</a>
              <a href="author.html#41985">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Mike

this can also be done by Apache. The easiest way is use mod-rewrite with 
apache. You could create a httphandler with handles these request. For 
example for the page of 'peter':

<A HREF="http://www.yourspace.com/page/peter">http://www.yourspace.com/page/peter</A>

But you want the request:

<A HREF="http://www.yourspace.com/peter">http://www.yourspace.com/peter</A>

With the mod-rewrites you can change the requested url to a different 
one. First add the mod-rewrite module to apache (rewrite.load). Then add 
a .htaccess file to the root of your site, with something like this:

RewriteEngine On
RewriteBase /
RewriteRule ^(.*) /page/$1

It uses regular expressions to find the match ^(.*) and rewrites the 
match to /page/$1. If the rewrite modules works, this should be your 
solution.

Good luck!

Cheers

Peter


Mike Christensen wrote:
&gt;<i> Cool!  I'll use this as well..
</I>&gt;<i> 
</I>&gt;<i> However, what if you wanted to build an app with a dynamic directory 
</I>&gt;<i> structure.  For example, you can create a user account called Peter on 
</I>&gt;<i> MySpace and then go to www.myspace.com/Peter.  However, I'm pretty sure 
</I>&gt;<i> they don't have a directory on the filesystem called Peter, nor an alias 
</I>&gt;<i> for Peter in their Apache config.
</I>&gt;<i> 
</I>&gt;<i> It would be nice to just disable this check, which is why I'm wondering 
</I>&gt;<i> whether this is Apache or mod_mono doing this.  IIS does not have this 
</I>&gt;<i> problem.
</I>&gt;<i> 
</I>&gt;<i> Thanks again!
</I>&gt;<i> Mike
</I>&gt;<i> 
</I>&gt;<i> Peter Hagen wrote:
</I>&gt;&gt;<i> Hi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I fixed this by using an alias. I added an alias in the site 
</I>&gt;&gt;<i> configuration, and added the alias path to the web.config:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Apache site config
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alias /test &quot;/some/real/path/to/my/site/www&quot;
</I>&gt;&gt;<i> &lt;Location /test&gt;
</I>&gt;&gt;<i>   SetHandler mono
</I>&gt;&gt;<i> &lt;/Location&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Web.config
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;configuration&gt;
</I>&gt;&gt;<i>   &lt;system.web&gt;
</I>&gt;&gt;<i>     &lt;httpHandlers&gt;
</I>&gt;&gt;<i>       &lt;add verb=&quot;*&quot; path=&quot;/test/*&quot; 
</I>&gt;&gt;<i> type=&quot;Willow.Cms.Common.WebServiceHandler, Willow.Cms.Common&quot; /&gt;
</I>&gt;&gt;<i>     &lt;/httpHandlers&gt;
</I>&gt;&gt;<i>   &lt;/system.web&gt;
</I>&gt;&gt;<i> &lt;/configuration&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> With this configuration you don't need to create the directory
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Peter
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Mike Christensen wrote:
</I>&gt;&gt;&gt;<i> This is already done.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> As I've stated in my email, this works for /Test.foo but not 
</I>&gt;&gt;&gt;<i> /Blah/Test.foo.  Apache requires the physical directory to exist on 
</I>&gt;&gt;&gt;<i> the filesystem, otherwise it returns a 404.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Ricardo Lopes wrote:
</I>&gt;&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> You have to tell apache to send requests to *.foo to mod-mono, check
</I>&gt;&gt;&gt;&gt;<i> your configuration.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> 2009/4/3 Mike Christensen &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">imaudi at comcast.net</A>&gt;:
</I>&gt;&gt;&gt;&gt;<i>  
</I>&gt;&gt;&gt;&gt;&gt;<i> Hi guys - I'm thinking this is most likely either an Apache 
</I>&gt;&gt;&gt;&gt;&gt;<i> limitation,
</I>&gt;&gt;&gt;&gt;&gt;<i> a configuration problem, or a bug in mod-mono.  I'm hoping it's the
</I>&gt;&gt;&gt;&gt;&gt;<i> latter so we can fix it :)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Let's say I have an IHttpHandler:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> public class Handler : IHttpHandler
</I>&gt;&gt;&gt;&gt;&gt;<i> {
</I>&gt;&gt;&gt;&gt;&gt;<i> //Stuff here that will blow your mind
</I>&gt;&gt;&gt;&gt;&gt;<i> }
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Now I register this in my web.config:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;httpHandlers&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>  &lt;add verb=&quot;*&quot; path=&quot;*.foo&quot; validate=&quot;false&quot; type=&quot;Handler&quot; /&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;/httpHandlers&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Good so far right?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> When I go to:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> /Test.foo
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> My handler will be invoked and it will do all sorts of great things 
</I>&gt;&gt;&gt;&gt;&gt;<i> that
</I>&gt;&gt;&gt;&gt;&gt;<i> you simply can't imagine, probably change the world and all.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> However if I do:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> /Blah/Test.foo
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Then Apache gives me a default 404 File not found error.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> If I go and create a blank directory on the file system called Blah,
</I>&gt;&gt;&gt;&gt;&gt;<i> things will then work again.  The point is, I do not want Apache or
</I>&gt;&gt;&gt;&gt;&gt;<i> anything else validating the filepath or directory structure.  Keep in
</I>&gt;&gt;&gt;&gt;&gt;<i> mind there's web apps such as SharePoint that allow you to provision
</I>&gt;&gt;&gt;&gt;&gt;<i> webs, subwebs, etc and these paths are completely resolved by HTTP
</I>&gt;&gt;&gt;&gt;&gt;<i> handlers and are totally independent of the filesystem.  Porting this
</I>&gt;&gt;&gt;&gt;&gt;<i> architecture over to Mono might cause problems.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> My question is what is actually to blame?  Is Apache verifying the
</I>&gt;&gt;&gt;&gt;&gt;<i> directory before passing the request off to mod_mono?  It obviously
</I>&gt;&gt;&gt;&gt;&gt;<i> doesn't validate the file itself since Test.foo doesn't exist anywhere
</I>&gt;&gt;&gt;&gt;&gt;<i> on the filesystem.  I kinda think so because it's an Apache 404 error
</I>&gt;&gt;&gt;&gt;&gt;<i> page I'm getting, which depresses me.  Also, this doesn't happen on 
</I>&gt;&gt;&gt;&gt;&gt;<i> xsp
</I>&gt;&gt;&gt;&gt;&gt;<i> so I blame Apache.  Anything I can do about this?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On my app, I can hack around it by creating the directories or maybe
</I>&gt;&gt;&gt;&gt;&gt;<i> doing some hacks with vdirs and stuff, but is there a way we can 
</I>&gt;&gt;&gt;&gt;&gt;<i> provide
</I>&gt;&gt;&gt;&gt;&gt;<i> a better experience?  Thanks!!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Mike
</I>&gt;&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>     
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;<i>
</I></PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041984.html">[Mono-list] IHttpHandler works fine under IIS but not Apache
</A></li>
	<LI>Next message: <A HREF="041982.html">[Mono-list] XSP Compilation Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41985">[ date ]</a>
              <a href="thread.html#41985">[ thread ]</a>
              <a href="subject.html#41985">[ subject ]</a>
              <a href="author.html#41985">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
