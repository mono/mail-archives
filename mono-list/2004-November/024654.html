<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Hi, and cookies problem.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gurrio%40yahoo.es">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="024672.html">
   <LINK REL="Next"  HREF="024638.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Hi, and cookies problem.
   </H1>
    <B>Gurrio
    </B> 
    <A HREF="mailto:gurrio%40yahoo.es"
       TITLE="[Mono-list] Hi, and cookies problem.">gurrio@yahoo.es
       </A><BR>
    <I>Sun, 28 Nov 2004 14:52:20 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="024672.html">[Mono-list] corlib regression failures
</A></li>
        <LI> Next message: <A HREF="024638.html">[Mono-list] Hi, and cookies problem.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24654">[ date ]</a>
              <a href="thread.html#24654">[ thread ]</a>
              <a href="subject.html#24654">[ subject ]</a>
              <a href="author.html#24654">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
 I'm new in the list. I've been trying with mono for the last months, but i've 
a problem.
 I've searched in google, c# forums webs, msdn, etc. but i'm not able to solve 
it.
 I want to login in to a web, that usese html forms, and https. This web has 
also a web certificate.
 When i run my program, the web returns me a cookie, but this cookie is not 
enough for continue donwloading more page contents.
 I've tried Firefox Live HTTP Headers extension, and using it, i can see that 
the server returns 3 diferent cookies.

 Can you help me? 
 I attach the code and firefox headers.


  Thanks in advance.

   Asier

//My code. It only returns one cookie.
using System.Net;
using System.IO;
using System.Text;
using System;
namespace Examples.System.Net.Cookies
{
    
    public class CookieExample
    {   
        public static void Main(string[] args)
        {   
            if (args == null || args.Length != 1)
            {
                Console.WriteLine(&quot;Specify the URL to receive the request.&quot;);
                Environment.Exit(1);
            }
            HttpWebRequest request = 
(HttpWebRequest)WebRequest.Create(&quot;<A HREF="https://apliweb.uned.es/ciberuned/index.asp"">https://apliweb.uned.es/ciberuned/index.asp&quot;</A>);
     string DatosUsuario =&quot;Login String&quot;; 

     byte[] datos = Encoding.Default.GetBytes(DatosUsuario); 
            request.Method = &quot;POST&quot;;
     request.UserAgent= &quot;Mozilla/5.0 (X11; U; Linux i686; es-ES; rv:1.6) 
Gecko/20040506 Firefox/0.8&quot;;
            request.Referer = &quot;<A HREF="https://apliweb.uned.es/ciberuned/index.asp";">https://apliweb.uned.es/ciberuned/index.asp&quot;;</A>
     request.ContentType = &quot;application/x-www-form-urlencoded&quot;; 
            request.ContentLength = datos.Length; 
   


            Stream sout = request.GetRequestStream(); 
            sout.Write(datos, 0, datos.Length); 
            sout.Flush(); 
            sout.Close(); 
     

            // Print the properties of each cookie.
              try
                {

                        request.CookieContainer = new CookieContainer ();
                        
                        HttpWebResponse response = (HttpWebResponse) 
request.GetResponse();

                        if (request.HaveResponse)
                        {
                                WebHeaderCollection headers = 
response.Headers;
                                
                                foreach(string header in headers.Keys)
                                {
                                        Console.WriteLine(&quot;{0}:{1}&quot;, header, 
headers[header]);
                                }
                                
                                Console.WriteLine(&quot;{0} Cookies found.&quot;, 
response.Cookies.Count);
                                foreach(Cookie c in response.Cookies)
                                Console.WriteLine(&quot;{0}: {1}&quot;, c.Name, 
c.Value);
                        }

                        response.Close();
                }
                catch (Exception ex)
                {
                        Console.WriteLine(&quot;Exception:\n{0}\n{1}&quot;, ex.Message, 
ex.StackTrace);
                }
        }
    }
}

//Firefox headers: It returns 3 cookies.
<A HREF="https://apliweb.uned.es/ciberuned/index.asp">https://apliweb.uned.es/ciberuned/index.asp</A> 
 
POST /ciberuned/index.asp HTTP/1.1 
Host: apliweb.uned.es 
User-Agent: Mozilla/5.0 (X11; U; Linux i686; es-ES; rv:1.6) Gecko/20040506 
Firefox/0.8 
Accept: 
text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,video/x-mng,image/png,image/jpeg,image/gif;q=0.2,*/*;q=0.1 
Accept-Language: es-es,es;q=0.5 
Accept-Encoding: gzip,deflate 
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7 
Keep-Alive: 300 
Connection: keep-alive 
Referer: <A HREF="https://apliweb.uned.es/ciberuned/index.asp">https://apliweb.uned.es/ciberuned/index.asp</A> 
Content-Type: application/x-www-form-urlencoded 
Content-Length: 49 
Login String

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="024672.html">[Mono-list] corlib regression failures
</A></li>
	<LI> Next message: <A HREF="024638.html">[Mono-list] Hi, and cookies problem.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24654">[ date ]</a>
              <a href="thread.html#24654">[ thread ]</a>
              <a href="subject.html#24654">[ subject ]</a>
              <a href="author.html#24654">[ author ]</a>
         </LI>
       </UL>
</body></html>
