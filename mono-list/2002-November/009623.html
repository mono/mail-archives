<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ADO.NET Provider Factory in CVS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:brianlritchie%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="009632.html">
   <LINK REL="Next"  HREF="009633.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ADO.NET Provider Factory in CVS
   </H1>
    <B>Brian Ritchie
    </B> 
    <A HREF="mailto:brianlritchie%40hotmail.com"
       TITLE="[Mono-list] ADO.NET Provider Factory in CVS">brianlritchie@hotmail.com
       </A><BR>
    <I>Tue, 12 Nov 2002 01:06:35 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="009632.html">[Mono-list] DbDataAdapter in ADO.NET Provider Factory
</A></li>
        <LI> Next message: <A HREF="009633.html">[Mono-list] ADO.NET Provider Factory in CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9623">[ date ]</a>
              <a href="thread.html#9623">[ thread ]</a>
              <a href="subject.html#9623">[ subject ]</a>
              <a href="author.html#9623">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've put the initial version of the ProviderFactory objects into CVS. This 
will give us a foundation for abstract data provider access within Mono.  It 
can also be used in the MS.NET framework.

The code is in CVS under /mcs/class/Mono.Data.  I've included build files, 
but haven't tied it into the main build process.


Here's a basic overview of the object model:

* ProviderFactory: used to create new Connections, DataAdapters, or 
Commands.  All objects are returned using the provider interfaces such as 
IDbCommand.
* DataTools: static methods for doing common tasks like filling a DataSet 
with the contents of a select statement.
* ProviderCollection: list of providers configured in the system.  Initially 
loaded from app.config, but can be modified at run-time.
* Provider: represents a given provider and holds information needed to 
create the types.
* ProviderSectionHandler: works behind the scenes to load the list of 
providers from the app.config into a ProviderCollection.

See /mcs/class/Mono.Data/app.config for sample configuration file.


Alrighty...now for some examples:

1) Using app.config to store your connection string:
&lt;appSettings&gt;
  &lt;add key=&quot;PubsConnStr&quot; value=&quot;factory=System.Data.SqlClient; 
server=speedy;database=pubs;uid=sa;pwd=&quot; /&gt;
&lt;/appSettings&gt;

IDbConnection 
conn=ProviderFactory.CreateConnectionFromConfig(&quot;PubsConnStr&quot;);

The factory attribute specifies which provider to use.  The factory 
attribute is parsed out, the object is created, and then the rest of the 
connection string is passed into the provider. The providers are defined in 
the app.config (or machine.config).


2) Creating a DataAdapter and filling a DataSet.

// Create Connection
IDbConnection conn =
ProviderFactory.CreateConnectionFromConfig(&quot;PubsConnStr&quot;);

// Select command
IDbCommand cmd=conn.CreateCommand();
cmd.Text=&quot;select * from author&quot;;

// Data Adapter
DataSet ds=new DataSet();
IDbDataAdapter adapter=ProviderFactory.CreateDataAdapter(cmd);
adapter.Fill(ds, &quot;Table1&quot;);


3) Creating a DataAdapter and filling a DataSet. The super lazy method for 
people like me. :-)

// Create Connection
IDbConnection conn =
ProviderFactory.CreateConnectionFromConfig(&quot;TdsPubsConnStr&quot;);

// Data Adapter
DataSet ds=DataTools.FillDataSet(conn, &quot;select * from author&quot;);


Well thats it for now.  I'll be adding a number of common tasks into the 
DataTools class, so send me your favorite data routines.

I'd guess I should get some sleep...too bad I can't sleep and code at the 
same time...hmmm...

Later,
Brian




_________________________________________________________________
MSN 8 with e-mail virus protection service: 2 months FREE* 
<A HREF="http://join.msn.com/?page=features/virus">http://join.msn.com/?page=features/virus</A>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="009632.html">[Mono-list] DbDataAdapter in ADO.NET Provider Factory
</A></li>
	<LI> Next message: <A HREF="009633.html">[Mono-list] ADO.NET Provider Factory in CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9623">[ date ]</a>
              <a href="thread.html#9623">[ thread ]</a>
              <a href="subject.html#9623">[ subject ]</a>
              <a href="author.html#9623">[ author ]</a>
         </LI>
       </UL>
</body></html>
