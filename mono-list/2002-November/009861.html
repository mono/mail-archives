<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Unable to  DllImporting libc.so
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:akeys%40post.cis.smu.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="009856.html">
   <LINK REL="Next"  HREF="009936.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Unable to  DllImporting libc.so
   </H1>
    <B>Adam Keys
    </B> 
    <A HREF="mailto:akeys%40post.cis.smu.edu"
       TITLE="[Mono-list] Unable to  DllImporting libc.so">akeys@post.cis.smu.edu
       </A><BR>
    <I>21 Nov 2002 20:40:54 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="009856.html">[Mono-list] Writing daemons in C# - SCM for Linux
</A></li>
        <LI> Next message: <A HREF="009936.html">[Mono-list] Unable to  DllImporting libc.so
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9861">[ date ]</a>
              <a href="thread.html#9861">[ thread ]</a>
              <a href="subject.html#9861">[ subject ]</a>
              <a href="author.html#9861">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-l6tmt4N3bZp+HIrGFhC1
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

I am trying to implement a POSIX wrapper and so I need to DllImport
libc.so.  Whenever I run my code[1] mono outputs the following:

** (process:18635): WARNING **: Failed to load library libc.so (libc.so)

I've tried setting MONO_PATH and LD_LIBRARY_PATH to /usr/lib but I am
still unable to load libc.so.  Copying libc.so to the working directory
doesn't seem to help either.

I've attached[2] strace output of running mono.  Any idea what's going
on here?  It looks like it fails to load ./libc.so and then tries
/usr/lib/libc.so, successfully opens the file but then fails on calls to
access(2).

[1] <A HREF="http://trmk.org/~adam/mono/Posix.cs">http://trmk.org/~adam/mono/Posix.cs</A>
[2] Full trace output at <A HREF="http://trmk.org/~adam/mono/strace.out">http://trmk.org/~adam/mono/strace.out</A>

Thanks,
-- 
AKK~
<A HREF="http://trmk.org/~adam/blog">http://trmk.org/~adam/blog</A>

--=-l6tmt4N3bZp+HIrGFhC1
Content-Disposition: attachment; filename=trace.txt
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; name=trace.txt; charset=ISO-8859-1

open(&quot;PosixTest.exe&quot;, O_RDONLY|O_LARGEFILE) =3D 6
brk(0x8230000)                          =3D 0x8230000
fstat64(6, {st_mode=3DS_IFREG|0644, st_size=3D2048, ...}) =3D 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0=
) =3D 0x40016000
read(6, &quot;MZ\0\0\4\0\0\0\4\0\0\0\377\377\0\0\270\0\0\0\0\0\0\0@\0&quot;..., 4096)=
 =3D 2048
mmap2(NULL, 4096, PROT_READ, MAP_PRIVATE, 6, 0) =3D 0x40017000
mmap2(NULL, 4096, PROT_READ, MAP_PRIVATE, 6, 0) =3D 0x40018000
_llseek(6, 0, [0], SEEK_SET)            =3D 0
read(6, &quot;MZ\0\0\4\0\0\0\4\0\0\0\377\377\0\0\270\0\0\0\0\0\0\0@\0&quot;..., 4096)=
 =3D 2048
mmap2(NULL, 4096, PROT_READ, MAP_PRIVATE, 6, 0) =3D 0x40019000
open(&quot;./Posix.dll&quot;, O_RDONLY|O_LARGEFILE) =3D 7
brk(0x8231000)                          =3D 0x8231000
fstat64(7, {st_mode=3DS_IFREG|0644, st_size=3D2048, ...}) =3D 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0=
) =3D 0x4001a000
read(7, &quot;MZ\0\0\4\0\0\0\4\0\0\0\377\377\0\0\270\0\0\0\0\0\0\0@\0&quot;..., 4096)=
 =3D 2048
mmap2(NULL, 4096, PROT_READ, MAP_PRIVATE, 7, 0) =3D 0x4001b000
mmap2(NULL, 4096, PROT_READ, MAP_PRIVATE, 7, 0) =3D 0x4001c000
_llseek(7, 0, [0], SEEK_SET)            =3D 0
read(7, &quot;MZ\0\0\4\0\0\0\4\0\0\0\377\377\0\0\270\0\0\0\0\0\0\0@\0&quot;..., 4096)=
 =3D 2048
mmap2(NULL, 4096, PROT_READ, MAP_PRIVATE, 7, 0) =3D 0x4001d000
open(&quot;./libc.so&quot;, O_RDONLY|O_LARGEFILE) =3D -1 ENOENT (No such file or dire=
ctory)
brk(0x8234000)                          =3D 0x8234000
getpid()                                =3D 18635
access(&quot;libc.so&quot;, F_OK)                 =3D -1 ENOENT (No such file or dire=
ctory)
stat64(&quot;libc.so&quot;, 0xbffff4e8)           =3D -1 ENOENT (No such file or dire=
ctory)
access(&quot;libc.so.so&quot;, F_OK)              =3D -1 ENOENT (No such file or dire=
ctory)
stat64(&quot;libc.so.so&quot;, 0xbffff4d8)        =3D -1 ENOENT (No such file or dire=
ctory)
access(&quot;libc.so.la&quot;, F_OK)              =3D -1 ENOENT (No such file or dire=
ctory)
stat64(&quot;libc.so.la&quot;, 0xbffff4d8)        =3D -1 ENOENT (No such file or dire=
ctory)
open(&quot;/usr/lib/libc.so&quot;, O_RDONLY)      =3D 8
read(8, &quot;/* GNU ld script\n   Use the shar&quot;..., 1024) =3D 178
close(8)                                =3D 0
access(&quot;libc.so&quot;, F_OK)                 =3D -1 ENOENT (No such file or dire=
ctory)
stat64(&quot;libc.so&quot;, 0xbffff4e8)           =3D -1 ENOENT (No such file or dire=
ctory)
access(&quot;libc.so.so&quot;, F_OK)              =3D -1 ENOENT (No such file or dire=
ctory)
stat64(&quot;libc.so.so&quot;, 0xbffff4d8)        =3D -1 ENOENT (No such file or dire=
ctory)
access(&quot;libc.so.la&quot;, F_OK)              =3D -1 ENOENT (No such file or dire=
ctory)
stat64(&quot;libc.so.la&quot;, 0xbffff4d8)        =3D -1 ENOENT (No such file or dire=
ctory)
open(&quot;/usr/lib/libc.so&quot;, O_RDONLY)      =3D 8
read(8, &quot;/* GNU ld script\n   Use the shar&quot;..., 1024) =3D 178
close(8)                                =3D 0
getpid()                                =3D 18635
brk(0x823c000)                          =3D 0x823c000
write(2, &quot;\n** (process:18635): WARNING **:&quot;..., 74) =3D 74

--=-l6tmt4N3bZp+HIrGFhC1--




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="009856.html">[Mono-list] Writing daemons in C# - SCM for Linux
</A></li>
	<LI> Next message: <A HREF="009936.html">[Mono-list] Unable to  DllImporting libc.so
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9861">[ date ]</a>
              <a href="thread.html#9861">[ thread ]</a>
              <a href="subject.html#9861">[ subject ]</a>
              <a href="author.html#9861">[ author ]</a>
         </LI>
       </UL>
</body></html>
