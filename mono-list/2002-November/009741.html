<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] MySql Data Types.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:danmorg%40sc.rr.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="009740.html">
   <LINK REL="Next"  HREF="009742.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] MySql Data Types.
   </H1>
    <B>Daniel Morgan
    </B> 
    <A HREF="mailto:danmorg%40sc.rr.com"
       TITLE="[Mono-list] MySql Data Types.">danmorg@sc.rr.com
       </A><BR>
    <I>Mon, 18 Nov 2002 08:43:59 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="009740.html">[Mono-list] SQL# For GTK# Screenshot using a GTK# TreeView
</A></li>
        <LI> Next message: <A HREF="009742.html">[Mono-list] MySql Data Types.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9741">[ date ]</a>
              <a href="thread.html#9741">[ thread ]</a>
              <a href="subject.html#9741">[ subject ]</a>
              <a href="author.html#9741">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ben,

The MySqlEnumFieldTypes enumeration was based on the enum enum_field_types
found in the mysql/include/mysql_com.h header file.  A lot of the technical
details came from the MySQL docs or their header files.

Take a look at the classes in System.Data.SqlTypes.
We can use the ideas in System.Data.SqlTypes to create MySQL type classes in
namespace Mono.Data.MySqlTypes.

Some examples of the MySqlType classes include:

MySqlType class MySQL type
=============== ==========
MySqlDateTime   datetime
MySqlString     varchar
MySqlTimestamp  timestamp
MySqlInt32      long

A new enumeration named MySqlType can be created for the MySQL types like
SqlDbType is for System.Data.SqlTypes.

The MySqlParameter, MySqlParameterCollection, and MySqlCommand classes would
be modified:
- to use the MySqlDbType enumeration in addition to the DbType enumeration
- to use the MySQL type classes in Mono.Data.MySqlTypes

By the way, once you contribute something to Mono and you are going to
continue contributing, you can get your own cvs account.

Daniel

-----Original Message-----
From: Ben Clewett [mailto:<A HREF="mailto:Ben@roadrunner.uk.com">Ben@roadrunner.uk.com</A>]
Sent: Monday, November 18, 2002 8:25 AM
To: Daniel Morgan
Subject: Re: [Mono-list] MySql Data Types.


Daniel,

I have not yet finnished testing, so I cannot validate anything.

The MySqlEnumFieldTypes are yours.  The 'U' extension for SQL:
&quot;UNSIGNED&quot; are not in any code, I just included them to be complete.
Thanks for the error with the TimeStamp, I'll correct that in my code.

SQL Server version 3.23.52.nt.  I am using the clinet .dll which came
with this complete instalation, and the Mono.Data.MySql from Friday's
nightly snapshot.

It didn't occure to me that there would be a data type change from ver 3
to 4.  I would hope that there is backward compatibility, something I'll
check when I have Ver 4.

I am impressed with your data conversions in MySqlTypes.cs, but it does
show the problem, with the three data types, (.NET, DbType and
MySqlEnumFieldTypes) which are all needed.  For instance, it's very
difficult to overload a function with .NET variables, where a DataTime
is used for two possible DbTypes, and three possible MySql types.  All
of which might be used if creating an SQL statement using then
MySqlParametersCollection.  There is also no bounds checking, for
instance, where an Int16 is used for both 'short' and 'tiny'.

I would be very intersted in a native MySql data type using .NET
variables as the actual storage.  Would it then be possible to 'typedef'
a .NET variable as a MySql type, including bounds checking, and
version-safe conversions?  Therefore allowing safe overloading and easy
coding for the .NET environment.

Such a class could also be inherited into a class containing Field Name
for SQL commands, and possible also a Field Comparison for 'where'
statments:  WhereField = MySqlClass(&quot;name&quot;, &quot;&gt;&quot;, &quot;value&quot;);

If there is anything I can do, please let me know.

Ben



&gt;<i> Ben,
</I>&gt;<i>
</I>&gt;<i> What version of MySQL server and what version of MySQL client are you
</I>&gt;<i> using?
</I>&gt;<i>
</I>&gt;<i> The MySQL provider is based on Production version 3.23.
</I>&gt;<i> Currently, the provider does not support Development version 4.
</I>&gt;<i>
</I>&gt;<i> In theory, it should be upwards compatible to version 4.
</I>&gt;<i>
</I>&gt;<i> Eventually, we would want the provider to support 3.23, 4.x, and future
</I>&gt;<i> versions...
</I>&gt;<i>
</I>&gt;<i> If what you provided is for MySQL version 4.x, are those
</I>&gt;<i> MySqlEnumFieldTypes
</I>&gt;<i> enumerations backwards compatible with version 3.23?
</I>&gt;<i>
</I>&gt;<i> If they are not, then we will have to create a separate MySQL type
</I>&gt;<i> conversion function for each particular version.  The provider already
</I>&gt;<i> gets
</I>&gt;<i> the version of the database in the MySqlConnection class as property
</I>&gt;<i> ServerVersion, so you could use this to determine which conversion
</I>&gt;<i> function
</I>&gt;<i> to use.
</I>&gt;<i>
</I>&gt;<i> I made a mistake on the MySQL timestamp; it should be mapped to a DateTime
</I>&gt;<i> instead of a String.
</I>&gt;<i>
</I>&gt;<i> Just like SqlClient for Microsoft SQL Server has database-specific type
</I>&gt;<i> classes at System.Data.SqlTypes which allows a DBNull for Int32 via
</I>&gt;<i> SqlInt32, a DBNull for String via SqlString, a DBNull for DateTime via
</I>&gt;<i> SqlDateTime, etc...   Maybe we should create MySqlTypes classes too.
</I>&gt;<i>
</I>&gt;<i> Daniel
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>]On
</I>&gt;<i> Behalf Of Ben Clewett
</I>&gt;<i> Sent: Monday, November 18, 2002 5:14 AM
</I>&gt;<i> To: <A HREF="mailto:tim@timcoleman.com">tim@timcoleman.com</A>; <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
</I>&gt;<i> Subject: [Mono-list] MySql Data Types.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks.  I have found the correct conversions in the existing code, below.
</I>&gt;<i>
</I>&gt;<i> As the MySql code does not use the SqlDbType, neither shall I.  This
</I>&gt;<i> appears to be a too small subset of values for MySql.
</I>&gt;<i>
</I>&gt;<i> If I then use this, the MySqlParameter is always going to work?
</I>&gt;<i>
</I>&gt;<i> --------------
</I>&gt;<i>
</I>&gt;<i> Correct DataType Conversion for use of MySql, from MySqlHelper.
</I>&gt;<i> (Systerm.Data.DbType equal or larger than MySql Types)
</I>&gt;<i>
</I>&gt;<i> MySqlEnumFieldTypes	System.Data.DbType
</I>&gt;<i>
</I>&gt;<i> FIELD_TYPE_DECIMAL	Decimal
</I>&gt;<i> FIELD_TYPE_TINY		Int16
</I>&gt;<i> FIELD_TYPE_SHORT	Int16
</I>&gt;<i> FIELD_TYPE_SHORT U	UInt16
</I>&gt;<i> FIELD_TYPE_LONG		Int64
</I>&gt;<i> FIELD_TYPE_LONG U	UInt64
</I>&gt;<i> FIELD_TYPE_FLOAT	Single
</I>&gt;<i> FIELD_TYPE_DOUBLE	Double
</I>&gt;<i> FIELD_TYPE_NULL		String
</I>&gt;<i> FIELD_TYPE_TIMESTAMP	String
</I>&gt;<i> FIELD_TYPE_LONGLONG	Int64
</I>&gt;<i> FIELD_TYPE_LONGLONG U	UInt64
</I>&gt;<i> FIELD_TYPE_INT24	Int64
</I>&gt;<i> FIELD_TYPE_INT24 U	UInt64
</I>&gt;<i> FIELD_TYPE_DATE		Date
</I>&gt;<i> FIELD_TYPE_TIME		Time
</I>&gt;<i> FIELD_TYPE_DATETIME	DateTime
</I>&gt;<i> FIELD_TYPE_YEAR		Int16
</I>&gt;<i> FIELD_TYPE_NEWDATE	Date
</I>&gt;<i> FIELD_TYPE_ENUM		Int32
</I>&gt;<i> FIELD_TYPE_SET		String
</I>&gt;<i> FIELD_TYPE_TINY_BLOB	Binary
</I>&gt;<i> FIELD_TYPE_MEDIUM_BLOB	Binary
</I>&gt;<i> FIELD_TYPE_LONG_BLOB	Binary
</I>&gt;<i> FIELD_TYPE_BLOB		Binary
</I>&gt;<i> FIELD_TYPE_VAR_STRING	String
</I>&gt;<i> FIELD_TYPE_STRING	String
</I>&gt;<i>
</I>&gt;<i> <A HREF="mailto:tim@timcoleman.com">tim@timcoleman.com</A> wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;Understand below that I only refer to SQL Server.  I don't know the
</I>&gt;<i> &gt;MySQL Mono.Data provider.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt;I am running into a problem with the Data Types.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;The MySqlParameterCollection used the data types 'DbType'.
</I>&gt;<i> &gt;&gt;In MySqlTypes there are the types MySqlEnumFieldTypes.
</I>&gt;<i> &gt;&gt;There is also the SqlDbType in System.Data, as included in your email
</I>&gt;<i> &gt;&gt;yesterday.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Ah, yes.  There are several different type enumerations.  If you
</I>&gt;<i> &gt;read the .NET Framework documentation closely, you may get an
</I>&gt;<i> &gt;understanding as to the difference between SqlDbType and DbType
</I>&gt;<i> &gt;in System.Data.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;SqlDbType is a set of data types used by SQL Server.  In fact,
</I>&gt;<i> &gt;most of these types are supported by SQL Server 7, with the exception
</I>&gt;<i> &gt;of SqlDbType.BigInt and SqlDbType.Variant, which are SQL Server 2000
</I>&gt;<i> &gt;types.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;But, then, what is DbType?  The way I see it, DbType is a more general
</I>&gt;<i> &gt;set of data types.  Most of these types will work with SQL Server,
</I>&gt;<i> &gt;but then, some of them won't.  For instance, DbType.UInt32 will not
</I>&gt;<i> &gt;work.  Go ahead and try to create a SqlParameter with this DbType.
</I>&gt;<i> &gt;You'll get an ArgumentException when you do.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;So, DbType is more abstract, and SqlDbType is specific to SQL Server.
</I>&gt;<i> &gt;Magically, with a SqlParameter, if you set the SqlDbType, it will
</I>&gt;<i> &gt;also set the corresponding DbType in the parameter and vice versa
</I>&gt;<i> &gt;(and, if you provide neither, both will be inferred from the type
</I>&gt;<i> &gt;of its value...I'm working on this at the moment).
</I>




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="009740.html">[Mono-list] SQL# For GTK# Screenshot using a GTK# TreeView
</A></li>
	<LI> Next message: <A HREF="009742.html">[Mono-list] MySql Data Types.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9741">[ date ]</a>
              <a href="thread.html#9741">[ thread ]</a>
              <a href="subject.html#9741">[ subject ]</a>
              <a href="author.html#9741">[ author ]</a>
         </LI>
       </UL>
</body></html>
