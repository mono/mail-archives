<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] The System.Windows.Forms build breakage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:fgonthier%40hermes.usherb.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <LINK REL="Previous"  HREF="009902.html">
   <LINK REL="Next"  HREF="009904.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] The System.Windows.Forms build breakage
   </H1>
    <B>François-Denis Gonthier
    </B> 
    <A HREF="mailto:fgonthier%40hermes.usherb.ca"
       TITLE="[Mono-list] The System.Windows.Forms build breakage">fgonthier@hermes.usherb.ca
       </A><BR>
    <I>Sun, 24 Nov 2002 19:03:29 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="009902.html">[Mono-list] The System.Windows.Forms build breakage
</A></li>
        <LI> Next message: <A HREF="009904.html">[Mono-list] Building from CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9903">[ date ]</a>
              <a href="thread.html#9903">[ thread ]</a>
              <a href="subject.html#9903">[ subject ]</a>
              <a href="author.html#9903">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0016_01C293EC.2CBE7740
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: 7bit

Here a patch.  I tried it with Dennis Hayes Visual Studio solution and with
Linux.

----- Original Message -----
From: &quot;Martin Baulig&quot; &lt;<A HREF="mailto:martin@gnome.org">martin@gnome.org</A>&gt;
To: &lt;<A HREF="mailto:mono-hackers-list@ximian.com">mono-hackers-list@ximian.com</A>&gt;
Cc: &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
Sent: Sunday, November 24, 2002 4:10 PM
Subject: [Mono-list] The System.Windows.Forms build breakage


&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> today I fixed a couple of mcs bugs which causes it to reject the invalid
</I>code in
&gt;<i> System.Windows.Forms.  When trying to build it with the latest mcs, you'll
</I>get
&gt;<i>
</I>&gt;<i> ====
</I>&gt;<i> System.Windows.Forms/NativeWindow.cs(69) error CS0117:
</I>`System.Windows.Forms.Win32' does not contain a definition for `WNDCLASS'
&gt;<i> System.Windows.Forms/NativeWindow.cs(193) error CS0117:
</I>`System.Windows.Forms.Win32' does not contain a definition for `WM_CREATE'
&gt;<i> System.Windows.Forms/NativeWindow.cs(222) error CS0117:
</I>`System.Windows.Forms.Win32' does not contain a definition for `WM_CREATE'
&gt;<i> System.Windows.Forms/NativeWindow.cs(226) error CS0117:
</I>`System.Windows.Forms.Win32' does not contain a definition for `WM_CREATE'
&gt;<i> System.Windows.Forms/Menu.cs(157) error CS0029: Cannot convert implicitly
</I>from `int' to `uint'
&gt;<i> System.Windows.Forms/Menu.cs(159) error CS0122: `MenuID' is inaccessible
</I>because of its protection level
&gt;<i> Compilation failed: 6 error(s), 0 warnings
</I>&gt;<i> ====
</I>&gt;<i>
</I>&gt;<i> For the moment, either use an older mcs to compile it or wait until the
</I>code in
&gt;<i> System.Windows.Forms has been fixed.
</I>&gt;<i>
</I>&gt;<i> On Windows, I get the same errors, so it's not a mcs bug:
</I>&gt;<i>
</I>&gt;<i> ====
</I>&gt;<i> $ NAnt
</I>&gt;<i> Buildfile:
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms.build
&gt;<i>
</I>&gt;<i> build:
</I>&gt;<i>       [csc] Compiling 341 files to
</I>\\townsville\martin\monocvs\mcs\class\lib\System.Windows.Forms.dll
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\CheckedListBox.cs(469,16): warning CS0108: The keyword new is required
on 'System.Windows.Forms.CheckedListBox.ObjectCollection' because it hides
inherited member 'System.Windows.Forms.ListBox.ObjectCollection'
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\ListBox.cs(574,16): (Location of symbol related to previous warning)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(69,11): error CS0234: The type or namespace name
'WNDCLASS' does not exist in the class or namespace
'System.Windows.Forms.Win32' (are you missing an assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(71,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(74,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(75,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(76,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(77,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(78,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(79,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(80,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(81,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(82,5): error CS0246: The type or namespace name
'wndClass' could not be found (are you missing a using directive or an
assembly reference?)
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(84,30): error CS0103: The
&gt;<i> name 'wndClass' does not exist in the class or namespace
</I>'System.Windows.Forms.NativeWindow'
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(193,17): error CS0117: 'System.Windows.Forms.Win32' does
not contain a definition for 'WM_CREATE'
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(222,15): error CS0117: 'System.Windows.Forms.Win32' does
not contain a definition for 'WM_CREATE'
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\NativeWindow.cs(226,15): error CS0117: 'System.Windows.Forms.Win32' does
not contain a definition for 'WM_CREATE'
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\Menu.cs(157,18): error CS0029: Cannot implicitly convert type 'int' to
'uint'
&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms\Menu.cs(159,18): error CS0122: 'System.Windows.Forms.MenuItem.MenuID' is
inaccessible due to its protection level
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> BUILD FAILED
</I>&gt;<i>
</I>\\townsville\martin\monocvs\mcs\class\System.Windows.Forms\System.Windows.Fo
rms.build:-1: Program error, see build log for details.
&gt;<i> Program error, see build log for details.
</I>&gt;<i> Try `NAnt -help' for more information.
</I>&gt;<i> =====
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Martin Baulig
</I>&gt;<i> <A HREF="mailto:martin@gnome.org">martin@gnome.org</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
------=_NextPart_000_0016_01C293EC.2CBE7740
Content-Type: application/octet-stream;
	name=&quot;swf.diff&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;swf.diff&quot;

? swf.diff=0A=
? class/Mono.Data.SybaseClient/.makefrag=0A=
? class/Mono.Data.SybaseClient/.response=0A=
? class/Mono.Data.SybaseClient/library-deps.stamp=0A=
? class/Mono.Data.Tds/.makefrag=0A=
? class/Mono.Data.Tds/.response=0A=
? class/Mono.Data.Tds/library-deps.stamp=0A=
? class/System.Windows.Forms/System.Windows.Forms/bin=0A=
? class/System.Windows.Forms/System.Windows.Forms/obj=0A=
? class/System.Windows.Forms/System.Windows.Forms.Design/bin=0A=
? class/System.Windows.Forms/System.Windows.Forms.Design/obj=0A=
Index: class/System.Windows.Forms/list.unix=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /mono/mcs/class/System.Windows.Forms/list.unix,v=0A=
retrieving revision 1.4=0A=
diff -u -r1.4 list.unix=0A=
--- class/System.Windows.Forms/list.unix	18 Nov 2002 07:05:57 -0000	1.4=0A=
+++ class/System.Windows.Forms/list.unix	25 Nov 2002 00:01:18 -0000=0A=
@@ -1,3 +1,9 @@=0A=
+System.Windows.Forms/win32Enums.cs=0A=
+System.Windows.Forms/win32Handles.cs=0A=
+System.Windows.Forms/win32Interfaces.cs=0A=
+System.Windows.Forms/win32RegistryUtil.cs=0A=
+System.Windows.Forms/win32Structs.cs=0A=
+System.Windows.Forms/win32functions.cs=0A=
 System.Resources/ResXResourceReader.cs=0A=
 System.Resources/ResXResourceWriter.cs=0A=
 System.Windows.Forms/AccessibleEvents.cs=0A=
@@ -314,12 +320,6 @@=0A=
 System.Windows.Forms/UserControl.cs=0A=
 System.Windows.Forms/View.cs=0A=
 System.Windows.Forms/VScrollBar.cs=0A=
-System.Windows.Forms/win32Enums.cs=0A=
-System.Windows.Forms/win32Handles.cs=0A=
-System.Windows.Forms/win32Interfaces.cs=0A=
-System.Windows.Forms/win32RegistryUtil.cs=0A=
-System.Windows.Forms/win32Structs.cs=0A=
-System.Windows.Forms/win32functions.cs=0A=
 System.Windows.Forms.Design/AnchorEditor.cs=0A=
 System.Windows.Forms.Design/AssemblyInfo.cs=0A=
 System.Windows.Forms.Design/AxImporter.cs=0A=
Index: class/System.Windows.Forms/System.Windows.Forms/Menu.cs=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: =
/mono/mcs/class/System.Windows.Forms/System.Windows.Forms/Menu.cs,v=0A=
retrieving revision 1.17=0A=
diff -u -r1.17 Menu.cs=0A=
--- class/System.Windows.Forms/System.Windows.Forms/Menu.cs	24 Nov 2002 =
04:31:26 -0000	1.17=0A=
+++ class/System.Windows.Forms/System.Windows.Forms/Menu.cs	25 Nov 2002 =
00:01:20 -0000=0A=
@@ -154,9 +154,9 @@=0A=
 			// FIXME: Pay attention, do not assign an id to a &quot;stranger&quot;=0A=
 			// If reusing IDs, get one from array first=0A=
 			if ( mi.MenuID_ =3D=3D INVALID_MENU_ID) {=0A=
-				mi.MenuID_ =3D MenuIDs_++;=0A=
+				mi.MenuID_ =3D (uint) MenuIDs_++;=0A=
 			}=0A=
-			return  (uint)mi.MenuID;=0A=
+			return  (uint) mi.MenuID_;=0A=
 		}=0A=
 =0A=
 		//inherited=0A=
Index: class/System.Windows.Forms/System.Windows.Forms/NativeWindow.cs=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: =
/mono/mcs/class/System.Windows.Forms/System.Windows.Forms/NativeWindow.cs=
,v=0A=
retrieving revision 1.10=0A=
diff -u -r1.10 NativeWindow.cs=0A=
--- class/System.Windows.Forms/System.Windows.Forms/NativeWindow.cs	24 =
Nov 2002 04:31:26 -0000	1.10=0A=
+++ class/System.Windows.Forms/System.Windows.Forms/NativeWindow.cs	25 =
Nov 2002 00:01:21 -0000=0A=
@@ -66,11 +66,11 @@=0A=
 =0A=
 			if (!registeredClass) {=0A=
 				Win32.WndProc wp =3D new Win32.WndProc (WndProc);=0A=
-				Win32.WNDCLASS wndClass =3D new Win32.WNDCLASS();=0A=
+				WNDCLASS wndClass =3D new WNDCLASS();=0A=
 =0A=
-				wndClass.style =3D (int) (Win32.CS_OWNDC |=0A=
-							Win32.CS_VREDRAW |=0A=
-							Win32.CS_HREDRAW);=0A=
+				wndClass.style =3D (int) (CS_.CS_OWNDC |=0A=
+							CS_.CS_VREDRAW |=0A=
+							CS_.CS_HREDRAW);=0A=
 				wndClass.lpfnWndProc =3D wp;=0A=
 				wndClass.cbClsExtra =3D 0;=0A=
 				wndClass.cbWndExtra =3D 0;=0A=
@@ -81,7 +81,7 @@=0A=
 				wndClass.lpszMenuName =3D &quot;&quot;;=0A=
 				wndClass.lpszClassName =3D &quot;mono_native_window&quot;;=0A=
 =0A=
-				if (Win32.RegisterClassA(wndClass) !=3D 0) {=0A=
+				if (Win32.RegisterClassA(ref wndClass) !=3D 0) {=0A=
 					registeredClass =3D true;=0A=
 				} else {=0A=
 					windowHandle =3D (IntPtr)0;=0A=
@@ -190,7 +190,7 @@=0A=
 =0A=
 		protected virtual void WndProc (ref Message m) =0A=
 		{=0A=
-			if (m.Msg =3D=3D Win32.WM_CREATE)=0A=
+			if (m.Msg =3D=3D (int) Msg.WM_CREATE)=0A=
 				Console.WriteLine (&quot;NW WndProc WM_CREATE&quot;);=0A=
 			DefWndProc (ref m);=0A=
 		}=0A=
@@ -219,11 +219,11 @@=0A=
 			message.LParam =3D lParam;=0A=
  			message.Result =3D (IntPtr) 0;=0A=
 =0A=
-			if (msg =3D=3D Win32.WM_CREATE)=0A=
+			if (msg =3D=3D (int) Msg.WM_CREATE)=0A=
 				Console.WriteLine (&quot;WM_CREATE (static)&quot;);=0A=
 =0A=
  			if (window !=3D null) {=0A=
-			if (msg =3D=3D Win32.WM_CREATE)=0A=
+			if (msg =3D=3D (int) Msg.WM_CREATE)=0A=
 				Console.WriteLine (&quot;WM_CREATE (static !=3D null)&quot;);=0A=
  				window.WndProc(ref message);=0A=
  			} else {=0A=
Index: =
class/System.Windows.Forms/System.Windows.Forms/System.Windows.Forms.cspr=
oj=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: =
/mono/mcs/class/System.Windows.Forms/System.Windows.Forms/System.Windows.=
Forms.csproj,v=0A=
retrieving revision 1.7=0A=
diff -u -r1.7 System.Windows.Forms.csproj=0A=
--- =
class/System.Windows.Forms/System.Windows.Forms/System.Windows.Forms.cspr=
oj	18 Nov 2002 04:46:33 -0000	1.7=0A=
+++ =
class/System.Windows.Forms/System.Windows.Forms/System.Windows.Forms.cspr=
oj	25 Nov 2002 00:01:26 -0000=0A=
@@ -92,6 +92,11 @@=0A=
                     AssemblyName =3D &quot;System.Drawing.Design&quot;
                     HintPath =3D =
&quot;..\..\..\..\..\WINNT\Microsoft.NET\Framework\v1.0.3705\System.Drawing.De=
sign.dll&quot;
                 /&gt;
+                &lt;Reference
+                    Name =3D &quot;System.Windows.Forms.Design&quot;
+                    Project =3D =
&quot;{A38C110F-63F4-4B53-A67E-9A46681C768E}&quot;
+                    Package =3D =
&quot;{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}&quot;
+                /&gt;
             &lt;/References&gt;
         &lt;/Build&gt;
         &lt;Files&gt;
@@ -1213,11 +1218,6 @@=0A=
                 /&gt;
                 &lt;File
                     RelPath =3D &quot;PropertySort.cs&quot;
-                    SubType =3D &quot;Code&quot;
-                    BuildAction =3D &quot;Compile&quot;
-                /&gt;
-                &lt;File
-                    RelPath =3D &quot;PropertyTab.cs&quot;
                     SubType =3D &quot;Code&quot;
                     BuildAction =3D &quot;Compile&quot;
                 /&gt;

------=_NextPart_000_0016_01C293EC.2CBE7740--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="009902.html">[Mono-list] The System.Windows.Forms build breakage
</A></li>
	<LI> Next message: <A HREF="009904.html">[Mono-list] Building from CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9903">[ date ]</a>
              <a href="thread.html#9903">[ thread ]</a>
              <a href="subject.html#9903">[ subject ]</a>
              <a href="author.html#9903">[ author ]</a>
         </LI>
       </UL>
</body></html>
