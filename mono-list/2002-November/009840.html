<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] GTK# Patch for TreeStore, ListStore, and TextIter
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:danmorg%40sc.rr.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="009837.html">
   <LINK REL="Next"  HREF="009843.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] GTK# Patch for TreeStore, ListStore, and TextIter
   </H1>
    <B>Daniel Morgan
    </B> 
    <A HREF="mailto:danmorg%40sc.rr.com"
       TITLE="[Mono-list] GTK# Patch for TreeStore, ListStore, and TextIter">danmorg@sc.rr.com
       </A><BR>
    <I>Wed, 20 Nov 2002 22:12:53 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="009837.html">[Mono-list] GTK# Patch for TreeStore, ListStore, and TextIter
</A></li>
        <LI> Next message: <A HREF="009843.html">[Mono-list] GTK# Patch for TreeStore, ListStore, and TextIter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9840">[ date ]</a>
              <a href="thread.html#9840">[ thread ]</a>
              <a href="subject.html#9840">[ subject ]</a>
              <a href="author.html#9840">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>SetColumnTypes should be an array like the GTK+ 2.0 API says:

gtk_list_store_set_column_types ()
void        gtk_list_store_set_column_types (GtkListStore *list_store,
                                             gint n_columns,
                                             GType *types);

This function is meant primarily for GObjects that inherit from
GtkListStore, and should only be used when constructing a new GtkListStore.
It will not function after a row has been added, or a method on the
GtkTreeModel interface is called.

list_store : A GtkListStore
n_columns : Number of columns for the list store
types : An array length n of GTypes

It does not mention var_args.

This is what I am trying to create with the Gtk.Metadata for
ListStore.SetColumnTypes:

		[DllImport (&quot;libgtk-win32-2.0-0.dll&quot;)]
		static extern void gtk_list_store_set_column_types (IntPtr raw,
						int n_columns, int[] types);

		public void SetColumnTypes(int[] types) {
			gtk_list_store_set_column_types (Handle, n_columns, types);
		}

This works for me in the DataGrid in SQL# For GTK#.

The var_args you are talking about are params in C#.

Moreover, I think it is correct for SetColumnTypes to use an array.

Mike Kestner said he would test this for me, all I had to do was supply a
patch for him.

-----Original Message-----
From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>]On
Behalf Of Kristian Rietveld
Sent: Wednesday, November 20, 2002 7:13 PM
To: Daniel Morgan
Cc: Mike Kestner; Mono-List
Subject: Re: [Mono-list] GTK# Patch for TreeStore, ListStore, and
TextIter


On Wed, 2002-11-20 at 20:56, Daniel Morgan wrote:
&gt;<i> Hey Mike,
</I>&gt;<i>
</I>&gt;<i> I have a patch for gtk-sharp/sources/Gtk.metadata.
</I>&gt;<i>
</I>&gt;<i> The patch has 3 fixes:
</I>&gt;<i>
</I>&gt;<i> 1. for TreeStore method SetColumnTypes, make the int types parameter an
</I>&gt;<i> array.
</I>&gt;<i> 2. for ListStore method SetColumnTypes, make the int types parameter an
</I>&gt;<i> array.
</I>&gt;<i> 3. for TextIter method ForwardSearch, make the TextIter parameters
</I>&gt;<i> match_start and
</I>&gt;<i>    match_end to be out.
</I>&gt;<i>
</I>&gt;<i> For 3., I'm sure there are other &quot;search&quot; methods that need fixing, but I
</I>&gt;<i> want to see how this fix works first.
</I>&gt;<i>
</I>&gt;<i> Are these okay?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Daniel
</I>&gt;<i> ----
</I>
Hello,

Miguel asked me to review your patch. My comments are below


&gt;<i> Index: Gtk.metadata
</I>&gt;<i> ===================================================================
</I>&gt;<i> RCS file: /cvs/public/gtk-sharp/sources/Gtk.metadata,v
</I>&gt;<i> retrieving revision 1.26
</I>&gt;<i> diff -u -r1.26 Gtk.metadata
</I>&gt;<i> --- Gtk.metadata	10 Nov 2002 10:03:51 -0000	1.26
</I>&gt;<i> +++ Gtk.metadata	20 Nov 2002 19:35:53 -0000
</I>&gt;<i> @@ -30,6 +30,25 @@
</I>&gt;<i>      &lt;/attribute&gt;
</I>&gt;<i>    &lt;/data&gt;
</I>&gt;<i>  &lt;/rule&gt;
</I>&gt;<i> +
</I>&gt;<i> +&lt;rule&gt;
</I>&gt;<i> +  &lt;class name=&quot;GtkTextIter&quot;&gt;
</I>&gt;<i> +    &lt;method&gt;ForwardSearch&lt;/method&gt;
</I>&gt;<i> +  &lt;/class&gt;
</I>&gt;<i> +  &lt;data&gt;
</I>&gt;<i> +    &lt;attribute target=&quot;param&quot;&gt;
</I>&gt;<i> +      &lt;filter level=&quot;name&quot;&gt;match_start&lt;/filter&gt;
</I>&gt;<i> +      &lt;name&gt;pass_as&lt;/name&gt;
</I>&gt;<i> +      &lt;value&gt;out&lt;/value&gt;
</I>&gt;<i> +    &lt;/attribute&gt;
</I>&gt;<i> +        &lt;attribute target=&quot;param&quot;&gt;
</I>&gt;<i> +      &lt;filter level=&quot;name&quot;&gt;match_end&lt;/filter&gt;
</I>&gt;<i> +      &lt;name&gt;pass_as&lt;/name&gt;
</I>&gt;<i> +      &lt;value&gt;out&lt;/value&gt;
</I>&gt;<i> +    &lt;/attribute&gt;
</I>&gt;<i> +  &lt;/data&gt;
</I>&gt;<i> +&lt;/rule&gt;
</I>&gt;<i> +
</I>
This fix looks fine, I think you immediately can also commit a likewise
fix for BackwardSearch. (and yes, there certainly are more textiter
methods which need fixing ...)

&gt;<i>  &lt;rule&gt;
</I>&gt;<i>    &lt;class name=&quot;GtkEditable&quot;&gt;
</I>&gt;<i>      &lt;method&gt;InsertText&lt;/method&gt;
</I>&gt;<i> @@ -59,6 +78,30 @@
</I>&gt;<i>      &lt;/attribute&gt;
</I>&gt;<i>    &lt;/data&gt;
</I>&gt;<i>  &lt;/rule&gt;
</I>&gt;<i> +&lt;rule&gt;
</I>&gt;<i> +  &lt;class name=&quot;GtkListStore&quot;&gt;
</I>&gt;<i> +    &lt;method&gt;SetColumnTypes&lt;/method&gt;
</I>&gt;<i> +  &lt;/class&gt;
</I>&gt;<i> +  &lt;data&gt;
</I>&gt;<i> +    &lt;attribute target=&quot;param&quot;&gt;
</I>&gt;<i> +      &lt;filter level=&quot;name&quot;&gt;types&lt;/filter&gt;
</I>&gt;<i> +      &lt;name&gt;array&lt;/name&gt;
</I>&gt;<i> +      &lt;value&gt;true&lt;/value&gt;
</I>&gt;<i> +  &lt;/data&gt;
</I>&gt;<i> +&lt;/rule&gt;
</I>&gt;<i> +
</I>&gt;<i> +&lt;rule&gt;
</I>&gt;<i> +  &lt;class name=&quot;GtktTreeStore&quot;&gt;
</I>                     ^
&gt;<i> +    &lt;method&gt;SetColumnTypes&lt;/method&gt;
</I>&gt;<i> +  &lt;/class&gt;
</I>&gt;<i> +  &lt;data&gt;
</I>&gt;<i> +    &lt;attribute target=&quot;param&quot;&gt;
</I>&gt;<i> +      &lt;filter level=&quot;name&quot;&gt;types&lt;/filter&gt;
</I>&gt;<i> +      &lt;name&gt;array&lt;/name&gt;
</I>&gt;<i> +      &lt;value&gt;true&lt;/value&gt;
</I>&gt;<i> +  &lt;/data&gt;
</I>&gt;<i> +&lt;/rule&gt;
</I>&gt;<i> +
</I>
I'm not sure about these. I'm feeling that they are wrong. I guess they
need the bit of var_arg magic like the {List,Tree}Store constructors
have.

A good way to test your changes to the metadata file is to regenerate
the autogenned sources and look how the generated functions look like.


regards,


	Kris


(I'm feeling that I'm not being clear. If so, please tell me and I will
try to rewrite this message :)

&gt;<i>  &lt;rule&gt;
</I>&gt;<i>    &lt;class name=&quot;GtkTreeModelSort&quot;&gt;
</I>&gt;<i>      &lt;method&gt;ConvertChildIterToIter&lt;/method&gt;
</I>

_______________________________________________
Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="009837.html">[Mono-list] GTK# Patch for TreeStore, ListStore, and TextIter
</A></li>
	<LI> Next message: <A HREF="009843.html">[Mono-list] GTK# Patch for TreeStore, ListStore, and TextIter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9840">[ date ]</a>
              <a href="thread.html#9840">[ thread ]</a>
              <a href="subject.html#9840">[ subject ]</a>
              <a href="author.html#9840">[ author ]</a>
         </LI>
       </UL>
</body></html>
