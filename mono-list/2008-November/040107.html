<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mod_mono process list
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20mod_mono%20process%20list&In-Reply-To=490EDB60.3060003%40occams.info">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="040101.html">
   <LINK REL="Next"  HREF="040102.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mod_mono process list</H1>
    <B>Ben Clewett</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20mod_mono%20process%20list&In-Reply-To=490EDB60.3060003%40occams.info"
       TITLE="[Mono-list] mod_mono process list">ben at roadrunner.uk.com
       </A><BR>
    <I>Mon Nov  3 08:59:36 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="040101.html">[Mono-list] mod_mono process list
</A></li>
        <LI>Next message: <A HREF="040102.html">[Mono-list] Looking for advice on accessing MySQL database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40107">[ date ]</a>
              <a href="thread.html#40107">[ thread ]</a>
              <a href="subject.html#40107">[ subject ]</a>
              <a href="author.html#40107">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Hi Joshua,

Joshua Tauberer wrote:
&gt;<i> Oh, maybe I misunderstood--- are you talking about seeing many Apache 
</I>&gt;<i> httpd processes or many mod-mono-server processes?
</I>
Yes this is what I mean, sorry to confuse.

&gt;&gt;<i> Therefore I have to obtain a list of what mod_mono is calling so I can trace our problem. 
</I>&gt;<i> ...
</I>&gt;&gt;<i> I may have to look at the mod_mono source code to try and get a result 
</I>&gt;&gt;<i> if non is available now!
</I>&gt;<i> 
</I>&gt;<i> What about the Apache server-status handler? It'll tell you what is 
</I>&gt;<i> being processed (as well as a bit of what was recently processed).
</I>
Thought about that, but rather get as close as possible to the problem. 
  It may just be that mod_mono can help/hinder this problem, so would be 
happier to work in this code space :)

&gt;<i> 
</I>&gt;<i> There's nothing doing it now in mod_mono. If you really need that and if 
</I>&gt;<i> you're up for it, there are two paths:
</I>&gt;<i> 
</I>&gt;<i> Store the active request URIs in mod_mono, by revising the shared memory 
</I>&gt;<i> dashboard struct so it has a fixed area to store that information.
</I>
This is my feeling.  I was thinking of a simple linked-list to store the 
URL.  As use POST method, would need headers as well:

typedef struct mono_live_process {
   int id;
   time_t start;
   const char *url;
   const char *header;
   char flag;  // p = process, w = wait etc...
   mono_live_process *next;
} mono_live_process;

Then manage this list with the lifetime of the process.

I have never allocated memory to shared memory.  Not sure if this is 
feasible, especially using a linked-list.  I guess I allocate a meg or 
so to shared, and allocate this buffer internally my self, being careful 
not to exceed the limit...

I also noted that there must be the 'wait' buffer somewhere for the 
waiting processes.  This must already have a similar structure.  I could 
replicate/expand this for my 'process' buffer.

Then just a option on the dash-board to dump the information...

Sound like the right sort of thing?

&gt;<i> 
</I>&gt;<i> Store the active request URIs in mod-mono-server and add a command so 
</I>&gt;<i> mod_mono can request the information from mod-mono-server. Doesn't have 
</I>&gt;<i> a fixed limitation on what it can store like the other way, but making 
</I>&gt;<i> the communication work is much harder.
</I>
I think that adding my own commands to the mod_mono protocol might be a 
road to disaster...  But I can see how this would work...

&gt;<i> 
</I>&gt;&gt;<i> (Which will also allow me to make an XML version of the mod_mono Control 
</I>&gt;&gt;<i> Panel for easier reading of the displayed metrics in 2.0.1...)
</I>&gt;<i> 
</I>&gt;<i> Can you just make the control panel xHTML and perhaps add some 
</I>&gt;<i> additional tags and attributes?
</I>
Yes, excelent idea.  Would work far better :)

Thanks,

Ben


&gt;<i> 
</I>&gt;<i> Josh
</I>&gt;<i> 
</I>&gt;&gt;<i> Thanks for the advise,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ben
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Joshua Tauberer wrote:
</I>&gt;&gt;&gt;<i> Ben Clewett wrote:
</I>&gt;&gt;&gt;&gt;<i> We are experiencing a scenario where the number of running processes 
</I>&gt;&gt;&gt;&gt;<i> under mod_mono will ramp up quite fast from near zero to 60 or 70, 
</I>&gt;&gt;&gt;&gt;<i> then return to zero some time soon afterwards.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> We suspect that we have something locking the processes, causing this 
</I>&gt;&gt;&gt;&gt;<i> behaviour, but can't find anything.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> It would be extremely useful if mod_mono or xsp daemon could be 
</I>&gt;&gt;&gt;&gt;<i> queried in order to list the currently running process, by the 
</I>&gt;&gt;&gt;&gt;<i> external URL called to mod_mono.  Or maybe this can be done in the 
</I>&gt;&gt;&gt;&gt;<i> webservice c# code?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Can any user suggest how this might be done?
</I>&gt;&gt;&gt;<i> What you're describing is probably mod_mono starting up new 
</I>&gt;&gt;&gt;<i> mod-mono-server instances when it finds that there's none running and 
</I>&gt;&gt;&gt;<i> an incoming request needs to be processed. Only one mod-mono-server 
</I>&gt;&gt;&gt;<i> handles all of the requests (unless it's configured otherwise), so you 
</I>&gt;&gt;&gt;<i> shouldn't see the number of mod-mono-servers increase according to the 
</I>&gt;&gt;&gt;<i> number of requests being processed. Except that mod_mono may start a 
</I>&gt;&gt;&gt;<i> new mod-mono-server for each incoming request until it finds one running.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I don't remember the details of how this works so I don't have 
</I>&gt;&gt;&gt;<i> suggestions off hand, though.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Josh
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *************************************************************************
</I>&gt;&gt;<i> This e-mail is confidential and may be legally privileged. It is intended
</I>&gt;&gt;<i> solely for the use of the individual(s) to whom it is addressed. Any
</I>&gt;&gt;<i> content in this message is not necessarily a view or statement from Road
</I>&gt;&gt;<i> Tech Computer Systems Limited but is that of the individual sender. If
</I>&gt;&gt;<i> you are not the intended recipient, be advised that you have received
</I>&gt;&gt;<i> this e-mail in error and that any use, dissemination, forwarding,
</I>&gt;&gt;<i> printing, or copying of this e-mail is strictly prohibited. We use
</I>&gt;&gt;<i> reasonable endeavours to virus scan all e-mails leaving the company but
</I>&gt;&gt;<i> no warranty is given that this e-mail and any attachments are virus free.
</I>&gt;&gt;<i> You should undertake your own virus checking. The right to monitor e-mail
</I>&gt;&gt;<i> communications through our networks is reserved by us
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Road Tech Computer Systems Ltd. Shenley Hall, Rectory Lane, Shenley,
</I>&gt;&gt;<i>  Radlett, Hertfordshire, WD7 9AN. - VAT Registration No GB 449 3582 17
</I>&gt;&gt;<i>  Registered in England No: 02017435, Registered Address: Charter Court, 
</I>&gt;&gt;<i>  Midland Road, Hemel Hempstead,  Hertfordshire, HP2 5GE. 
</I>&gt;&gt;<i> *************************************************************************
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> 
</I>

*************************************************************************
This e-mail is confidential and may be legally privileged. It is intended
solely for the use of the individual(s) to whom it is addressed. Any
content in this message is not necessarily a view or statement from Road
Tech Computer Systems Limited but is that of the individual sender. If
you are not the intended recipient, be advised that you have received
this e-mail in error and that any use, dissemination, forwarding,
printing, or copying of this e-mail is strictly prohibited. We use
reasonable endeavours to virus scan all e-mails leaving the company but
no warranty is given that this e-mail and any attachments are virus free.
You should undertake your own virus checking. The right to monitor e-mail
communications through our networks is reserved by us

  Road Tech Computer Systems Ltd. Shenley Hall, Rectory Lane, Shenley,
  Radlett, Hertfordshire, WD7 9AN. - VAT Registration No GB 449 3582 17
  Registered in England No: 02017435, Registered Address: Charter Court, 
  Midland Road, Hemel Hempstead,  Hertfordshire, HP2 5GE. 
*************************************************************************
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="040101.html">[Mono-list] mod_mono process list
</A></li>
	<LI>Next message: <A HREF="040102.html">[Mono-list] Looking for advice on accessing MySQL database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40107">[ date ]</a>
              <a href="thread.html#40107">[ thread ]</a>
              <a href="subject.html#40107">[ subject ]</a>
              <a href="author.html#40107">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
