<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono.Data.SqliteClient.SqliteSyntaxException:	database is locked
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Data.SqliteClient.SqliteSyntaxException%3A%0A%09database%20is%20locked&In-Reply-To=711aea6b0706190925y7fe4e331o5e9988f5439e9bd6%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035381.html">
   <LINK REL="Next"  HREF="035385.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono.Data.SqliteClient.SqliteSyntaxException:	database is locked</H1>
    <B>Manish Rai Jain</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Data.SqliteClient.SqliteSyntaxException%3A%0A%09database%20is%20locked&In-Reply-To=711aea6b0706190925y7fe4e331o5e9988f5439e9bd6%40mail.gmail.com"
       TITLE="[Mono-list] Mono.Data.SqliteClient.SqliteSyntaxException:	database is locked">manishrjain at gmail.com
       </A><BR>
    <I>Tue Jun 19 16:17:59 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035381.html">[Mono-list] Mono.Data.SqliteClient.SqliteSyntaxException:	database is locked
</A></li>
        <LI>Next message: <A HREF="035385.html">[Mono-list] =?GB2312?B?bGkgamVzc2Ugz+u4+sT6wcTM7A==?=
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35382">[ date ]</a>
              <a href="thread.html#35382">[ thread ]</a>
              <a href="subject.html#35382">[ subject ]</a>
              <a href="author.html#35382">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks a lot Kamil. The timeout trick worked :-). I guess I can keep my old
sqlite, its working great now.

-Manish


On 6/20/07, Kamil Skalski &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">kamil.skalski at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> &gt; I had opened up a single connection, and was doing updates/selects
</I>&gt;<i> through
</I>&gt;<i> &gt; that. I ended up with &quot;library sequence out of error&quot; exceptions. So, I
</I>&gt;<i>
</I>&gt;<i> I do this by caching one connection per thread.
</I>&gt;<i>
</I>&gt;<i> &gt; modified the code such that each query will open up new connection, and
</I>&gt;<i> then
</I>&gt;<i> &gt; run itself. So, &quot;library sequence&quot; exceptions went away, but got
</I>&gt;<i> overtaken
</I>&gt;<i> &gt; by &quot;database locked&quot; ones. So, to do synchronization at the application
</I>&gt;<i>
</I>&gt;<i> Try specifying the Timeout for the connection. I set it to 30seconds,
</I>&gt;<i> which is enough for my application. I don't know any other solution
</I>&gt;<i> for this issue - probably the best would be to set timeout to
</I>&gt;<i> infinite, which I will do by increasing the actual value when needed
</I>&gt;<i> ;)
</I>&gt;<i>
</I>&gt;<i> def conn = SqliteConnection
</I>&gt;<i> ($&quot;URI=<A HREF="file://$path,Version=3,busy_timeout=30000&quot;">file://$path,Version=3,busy_timeout=30000&quot;</A>);
</I>&gt;<i>
</I>&gt;<i> (this works with the old provider)
</I>&gt;<i>
</I>&gt;<i> &gt; level, I've set the C# locking mechanism to such that
</I>&gt;<i> &gt; 1. each table only runs one query at a time, and
</I>&gt;<i> &gt; 2. only one write query is being run at a time.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; However, all this has done is just to _reduce_ the number of database
</I>&gt;<i> locked
</I>&gt;<i>
</I>&gt;<i> I think you cannot even do concurrent reads or maybe there is some
</I>&gt;<i> place you missed in locking, I'm not sure.
</I>&gt;<i>
</I>&gt;<i> &gt; exceptions. I'm still getting them. Is there a way by which they can be
</I>&gt;<i> &gt; eliminated? Mono database page shows that we can use the new library
</I>&gt;<i> &gt; System.Data.Sqlite, which is version 3 and apparently doesn't have these
</I>&gt;<i> &gt; synchronization issues. However, I've been unable to find the .dll for
</I>&gt;<i> &gt; linux. Any help is appreciated.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> I think I found them at
</I>&gt;<i> <A HREF="http://www.go-mono.com/download-stable/sles-9-i586/">http://www.go-mono.com/download-stable/sles-9-i586/</A>  or maybe I just
</I>&gt;<i> compiled them from source... it's quite easy.
</I>&gt;<i> However I experienced a strange (dead) locking issues using the new
</I>&gt;<i> provider, which the same code works fine with old provider. I still
</I>&gt;<i> don't have time to investigate, but it would be great if somebody else
</I>&gt;<i> having concurrent app with sqlite tested it with new provider :D
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Kamil Skalski
</I>&gt;<i> <A HREF="http://nazgul.omega.pl">http://nazgul.omega.pl</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20070620/a8c62dde/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20070620/a8c62dde/attachment.html</A> 
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035381.html">[Mono-list] Mono.Data.SqliteClient.SqliteSyntaxException:	database is locked
</A></li>
	<LI>Next message: <A HREF="035385.html">[Mono-list] =?GB2312?B?bGkgamVzc2Ugz+u4+sT6wcTM7A==?=
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35382">[ date ]</a>
              <a href="thread.html#35382">[ thread ]</a>
              <a href="subject.html#35382">[ subject ]</a>
              <a href="author.html#35382">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
