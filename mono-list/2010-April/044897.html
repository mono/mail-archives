<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] WCF/JSON POST get error 415, expected content-type application/xml not application/json
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20WCF/JSON%20POST%20get%20error%20415%2C%0A%20expected%20content-type%20application/xml%20not%20application/json&In-Reply-To=hqd802%248ts%241%40dough.gmane.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="044895.html">
   <LINK REL="Next"  HREF="044901.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] WCF/JSON POST get error 415, expected content-type application/xml not application/json</H1>
    <B>Iain Mcleod</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20WCF/JSON%20POST%20get%20error%20415%2C%0A%20expected%20content-type%20application/xml%20not%20application/json&In-Reply-To=hqd802%248ts%241%40dough.gmane.org"
       TITLE="[Mono-list] WCF/JSON POST get error 415, expected content-type application/xml not application/json">mcleodia at gmail.com
       </A><BR>
    <I>Sat Apr 17 21:46:22 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="044895.html">[Mono-list] WCF/JSON POST get error 415, expected content-type application/xml not application/json
</A></li>
        <LI>Next message: <A HREF="044901.html">[Mono-list] WCF/JSON POST get error 415, expected content-type application/xml not application/json
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44897">[ date ]</a>
              <a href="thread.html#44897">[ thread ]</a>
              <a href="subject.html#44897">[ subject ]</a>
              <a href="author.html#44897">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Thanks for your response Robert.

Sorry, but that didn't quite fix my problem.  WebScriptEnablingBehavior also
worked - albeit with a slightly different json response format - when I
tried it in .NET, but I'm afraid I've tried every every possible combination
of WebHttpBehavior and WebScriptEnablingBehavior tonight and nothing has
worked for me in Mono.

WebScriptEnablingBehavior might have been a good workaround for what I still
believe is an issue with content type detection within WebHttpBehavior but
unfortunately, it brought up a new problem.
Brief explanation: I am also using an HttpListener to run a webserver to
serve my client side html/js.  (In otherwords, I serve my initial client
files from an HttpListener on one port and run my wcf services on another. 
My HttpListener also proxies for the wcf service requests to get around same
origin policy on the browser.)

However the really odd thing that I noticed is that when I use
WebScriptEnablingBehavior on my services ***even when running these on a
different port from the HttpListener webserver mentioned above*** it causes
the HttpListener (my webserver/json proxy server) to hang and fail to
process any requests at all.  No exceptions generated, just nothing getting
through at all on the call to BeginGetContext.  So my client cannot load its
files at all. That's really strange behaviour as I wouldn't have thought
that servers on a different port would have been able to interfere with each
other at all.
Again, this issue appears to be confined to Mono as it all works fine when I
run it in .NET.

(Sidenote: I had originally used a WebHttpBehavior to serve my client files
too, using a wcf service method with UriTemplate = &quot;*&quot; and return type
Stream.  However I discovered that mono appears - I believe - to be
serializing that Stream with datacontractserializer instead of writing back
the raw message contained withing the stream.  This is a separate issue, but
probably worth mentioning while I'm on the forums.)

Do you or anyone else have any other suggestions as to what I should do to
get json working?  
Getting rid of the HttpListener altogether and running everything through
wcf like I originally did would be my preferred choice, but I suspect the
Stream issue I mention above precludes that possibility.

If not, I'll have to fall back to POX or SOAP for my comms which would be
rather painful :(

Many thanks once again for your suggestion though.  It was definitely worth
a shot...

Regards
Iain

-- 
View this message in context: <A HREF="http://n4.nabble.com/WCF-JSON-POST-get-error-415-expected-content-type-application-xml-not-application-json-tp2013204p2014596.html">http://n4.nabble.com/WCF-JSON-POST-get-error-415-expected-content-type-application-xml-not-application-json-tp2013204p2014596.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="044895.html">[Mono-list] WCF/JSON POST get error 415, expected content-type application/xml not application/json
</A></li>
	<LI>Next message: <A HREF="044901.html">[Mono-list] WCF/JSON POST get error 415, expected content-type application/xml not application/json
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44897">[ date ]</a>
              <a href="thread.html#44897">[ thread ]</a>
              <a href="subject.html#44897">[ subject ]</a>
              <a href="author.html#44897">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
