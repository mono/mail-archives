<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Built-in Conditional Directives for various platforms #IF MONO, #IF WINDOWS_DOTNET, #IF MACOSX ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Built-in%20Conditional%20Directives%20for%20various%0A%20platforms%20%23IF%20MONO%2C%20%23IF%20WINDOWS_DOTNET%2C%20%23IF%20MACOSX%20%3F&In-Reply-To=4BB76E81.5000405%40googlemail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="044749.html">
   <LINK REL="Next"  HREF="044783.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Built-in Conditional Directives for various platforms #IF MONO, #IF WINDOWS_DOTNET, #IF MACOSX ?</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Built-in%20Conditional%20Directives%20for%20various%0A%20platforms%20%23IF%20MONO%2C%20%23IF%20WINDOWS_DOTNET%2C%20%23IF%20MACOSX%20%3F&In-Reply-To=4BB76E81.5000405%40googlemail.com"
       TITLE="[Mono-list] Built-in Conditional Directives for various platforms #IF MONO, #IF WINDOWS_DOTNET, #IF MACOSX ?">jonpryor at vt.edu
       </A><BR>
    <I>Sun Apr  4 16:25:46 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="044749.html">[Mono-list] Built-in Conditional Directives for various platforms #IF MONO, #IF WINDOWS_DOTNET, #IF MACOSX ?
</A></li>
        <LI>Next message: <A HREF="044783.html">[Mono-list] Built-in Conditional Directives for various platforms #IF MONO, #IF WINDOWS_DOTNET, #IF MACOSX ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44762">[ date ]</a>
              <a href="thread.html#44762">[ thread ]</a>
              <a href="subject.html#44762">[ subject ]</a>
              <a href="author.html#44762">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 2010-04-03 at 18:36 +0200, cimodev wrote:
&gt;<i> are there built-in conditional directives in MONO like
</I>
In general, compile-time conditionals are to be avoided, as it means you
have to recompile your code for each target platform.  Runtime checks
are consequently preferred.

That said...

&gt;<i> On Windows, i have to write &quot;using System.Data.SQlite&quot;, and on
</I>&gt;<i> MONO-based Systems i write &quot;using Mono.Data.Sqlite&quot;.
</I>&gt;<i> 
</I>&gt;<i> So, its not enough to check the platform within running code, but while
</I>&gt;<i> compile-time for using-declaratives.
</I>
The appropriate answer is: Don't Do That.

There are two possible approaches:

1. Build against ONLY Mono.Data.Sqlite.dll, and bundle
Mono.Data.Sqlite.dll and the Windows SQLITE3.DLL with your app.

On Unix, this will use the system-installed libsqlite3.so.0 shared
library with the Mono.Data.Sqlite ADO.NET provider bundled with your app
(or use the one in the GAC if the version number matches).

On Windows, this will use the Mono.Data.Sqlite.dll bundled with your app
and the SQLITE3.DLL bundled with your app.

2. Build against ONLY System.Data.SQLite.dll.

This is slightly trickier, as the &quot;default&quot; assembly is a mixed-mode
assembly that won't run under Mono.  However, they DO provide a
managed-only assembly for use with Mono:

        <A HREF="http://sourceforge.net/projects/sqlite-dotnet2/files/SQLite%20for%20ADO.NET%202.0/1.0.65.0/SQLite-1.0.65.0-managedonly-binaries.zip/download">http://sourceforge.net/projects/sqlite-dotnet2/files/SQLite%20for%20ADO.NET%202.0/1.0.65.0/SQLite-1.0.65.0-managedonly-binaries.zip/download</A>

(It's the &quot;SQLite-1.0.65.0-managedonly-binaries.zip&quot; link at the normal
download page.)

Thus, when creating an installer for Windows, you can bundle the
single-file mixed-mode System.Data.SQLite.dll assembly, or bundle the
managed-only System.Data.SQLite.dll and the native SQLITE3.DLL library.

When creating an installer for Linux, bundle the managed-only
System.Data.SQLite.dll assembly and a System.Data.SQLite.dll.config file
which remaps sqlite3 to e.g. libsqlite3.so.0 (assuming you want to use
the system-installed libsqlite3.so.0 shared library):

        &lt;configuration&gt;
          &lt;dllmap dll=&quot;sqlite3&quot; target=&quot;libsqlite3.so.0&quot; os=&quot;!windows&quot;/&gt;
        &lt;/configuration&gt;

(Though this might not be necessary, as /etc/mono/config may also
contain this remapping.  Try it and see.)

I'm reasonably sure that standardizing on one of the SQLite ADO.NET
providers will save you more pain than trying to deal with multiple
platform-specific builds. :-)

 - Jon


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="044749.html">[Mono-list] Built-in Conditional Directives for various platforms #IF MONO, #IF WINDOWS_DOTNET, #IF MACOSX ?
</A></li>
	<LI>Next message: <A HREF="044783.html">[Mono-list] Built-in Conditional Directives for various platforms #IF MONO, #IF WINDOWS_DOTNET, #IF MACOSX ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44762">[ date ]</a>
              <a href="thread.html#44762">[ thread ]</a>
              <a href="subject.html#44762">[ subject ]</a>
              <a href="author.html#44762">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
