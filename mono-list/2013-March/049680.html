<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Poor Mono performance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Poor%20Mono%20performance&In-Reply-To=%3CCALqYt1Jef4Yfypg%3Dk-%3D%2BVP73TxCPdYB1wFV3oVMveX-edW_fjg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="049679.html">
   <LINK REL="Next"  HREF="049675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Poor Mono performance</H1>
    <B>Drew DeVault</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Poor%20Mono%20performance&In-Reply-To=%3CCALqYt1Jef4Yfypg%3Dk-%3D%2BVP73TxCPdYB1wFV3oVMveX-edW_fjg%40mail.gmail.com%3E"
       TITLE="[Mono-list] Poor Mono performance">sircmpwn at gmail.com
       </A><BR>
    <I>Mon Mar 11 16:47:09 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="049679.html">[Mono-list] Poor Mono performance
</A></li>
        <LI>Next message: <A HREF="049675.html">[Mono-list] Poor Mono performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49680">[ date ]</a>
              <a href="thread.html#49680">[ thread ]</a>
              <a href="subject.html#49680">[ subject ]</a>
              <a href="author.html#49680">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I think this is important to address. The biggest grievance I have with
Mono (and that many I've spoken with have) is the poor performance. It
seems like most of this thread is just excusing away the poor performance,
but not trying to address it. It really is a problem.


On Mon, Mar 11, 2013 at 10:44 AM, Olajos, Imre &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">IOlajos at ballytech.com</A>&gt;wrote:

&gt;<i> Alan,
</I>&gt;<i>
</I>&gt;<i> So, I did try your suggestion and replaced List&lt;int&gt; with int[]. It did
</I>&gt;<i> improve the performance of the code, but as I suspected, it also improved
</I>&gt;<i> the performance in .NET, so the relative performance difference between the
</I>&gt;<i> two CLIs is still 80-90%:
</I>&gt;<i>
</I>&gt;<i> Windows .NET = 0.479 sec
</I>&gt;<i> Mono 3.0.6 with -O=unsafe option = 0.882 sec
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Imre
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Olajos, Imre
</I>&gt;<i> Sent: Monday, March 11, 2013 9:19 AM
</I>&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>
</I>&gt;<i> Subject: RE: [Mono-list] Poor Mono performance
</I>&gt;<i>
</I>&gt;<i> Alan,
</I>&gt;<i>
</I>&gt;<i> This is NOT just a benchmark - my actual code looks similar to this,
</I>&gt;<i> except it does a lot more things inside the body of the do-while loop.
</I>&gt;<i>
</I>&gt;<i> &gt; If you change it from a List&lt;T&gt; to a T[], the time taken to execute the
</I>&gt;<i> test is about half.
</I>&gt;<i>
</I>&gt;<i> I'm sure that's true (and I will try that), but what I'm more curious
</I>&gt;<i> about is why the big difference in the RELATIVE performance between .NET
</I>&gt;<i> and Mono? If I change my code to speed it up in Mono, I'm sure that'll
</I>&gt;<i> speed it up just as much in .NET, too - so, the relative performance of the
</I>&gt;<i> code will remain more or less the same between the two CLIs. Is there
</I>&gt;<i> anything I can do that would bring their relative performance difference
</I>&gt;<i> closer to each other (e.g. below 20-25%)?
</I>&gt;<i>
</I>&gt;<i> By the way:
</I>&gt;<i>
</I>&gt;<i> &gt; The majority of the time in this benchmark is spent doing array bounds
</I>&gt;<i> checking.
</I>&gt;<i>
</I>&gt;<i> I got the same poor performance from Mono with the -O=unsafe option, which
</I>&gt;<i> I thought turns off array bounds checking, too.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Imre
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Alan [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">alan.mcgovern at gmail.com</A>]
</I>&gt;<i> Sent: Monday, March 11, 2013 2:07 AM
</I>&gt;<i> To: Ian Norton
</I>&gt;<i> Cc: edward.harvey.mono; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>; Olajos, Imre
</I>&gt;<i> Subject: Re: [Mono-list] Poor Mono performance
</I>&gt;<i>
</I>&gt;<i> The majority of the time in this benchmark is spent doing array bounds
</I>&gt;<i> checking. If you change it from a List&lt;T&gt; to a T[], the time taken to
</I>&gt;<i> execute the test is about half. This is true on both frameworks. These
</I>&gt;<i> kinds of micro benchmarks never give an accurate picture of real world
</I>&gt;<i> performance, unless your application actually only iterates List&lt;T&gt; and
</I>&gt;<i> sums numbers.
</I>&gt;<i>
</I>&gt;<i> Mono also has different performance characteristics on Windows, Linux and
</I>&gt;<i> MacOS, even for testcases as simple as this.
</I>&gt;<i>
</I>&gt;<i> Alan
</I>&gt;<i>
</I>&gt;<i> On 11 March 2013 08:30, Ian Norton
</I>&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">ian.norton-badrul at thales-esecurity.com</A>&gt; wrote:
</I>&gt;<i> &gt; On Sun, Mar 10, 2013 at 02:19:55PM +0000, edward.harvey.mono wrote:
</I>&gt;<i> &gt;&gt; &gt; From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A> [mailto:mono-list-
</I>&gt;<i> &gt;&gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">bounces at lists.ximian.com</A>] On Behalf Of imreolajos
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Hi all!
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; SpeedTest.cs
</I>&gt;<i> &gt;&gt; &gt; &lt;<A HREF="http://mono.1490590.n4.nabble.com/file/n4658877/SpeedTest.cs">http://mono.1490590.n4.nabble.com/file/n4658877/SpeedTest.cs</A>&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Did you read that code?  All it does is a bunch of adds and multiplies.
</I>&gt;<i>  If that were *seriously* representing your workload, you would use C or
</I>&gt;<i> assembly.  The reason you code in .Net or mono is for the sake of high
</I>&gt;<i> level classes and stuff that make development faster than coding C++.  As
</I>&gt;<i> long as performance is good enough, you call it and end product.  If you
</I>&gt;<i> need to tweak performance more, you need to dig lower level into C/C++/asm.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; There are lots of times when, as a programmer, you have to accept some
</I>&gt;<i> performance sub-optimization with .Net or mono, just because the
</I>&gt;<i> pre-packaged class or whatever you're building on top of doesn't do
</I>&gt;<i> *exactly* what you want it to do.  That's the price you pay for using a
</I>&gt;<i> fully managed, high level, rapid development programming language and
</I>&gt;<i> framework.  For example, if you want a Queue that guarantees uniqueness...
</I>&gt;<i>  The standard queue doesn't guarantee uniqueness and the standard Hashset
</I>&gt;<i> doesn't guarantee order.  So you'd have to go find something else, or use a
</I>&gt;<i> combination of Queue &amp; Hashset, which is a sub-optimization caused by the
</I>&gt;<i> fact that the data structure available to you isn't precisely what you want.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; In any event - the comparison of performance between .Net and mono is a
</I>&gt;<i> valid thing to care about, if you have a valid test.  Here's what you
</I>&gt;<i> should focus on, if you care:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; The .Net framework and mono class library is a *huge* set of stuff.
</I>&gt;<i>  Microsoft has separate teams of developers for each category of stuff, and
</I>&gt;<i> mono pulls in code from hundreds or thousands of independent sources.
</I>&gt;<i>  Guess what that means?  Sometimes .Net will be faster, and sometimes mono
</I>&gt;<i> will be faster.  It depends on the specific class and version and OS (and
</I>&gt;<i> even cpu) that you're running on.  It depends specifically what you're
</I>&gt;<i> doing.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I don't have specifics, but here's a hypothetical:  You might find that
</I>&gt;<i> .Net 3.5 System.Drawing.Drawing2D.Blend running on windows 7 with an Intel
</I>&gt;<i> 64bit processor might perform half as well as with the AMD 64bit processor,
</I>&gt;<i> and mono 2.4 in centos might be 3x slower, but when you switch to mono 2.10
</I>&gt;<i> in fedora, it might be 2x faster than the fastest .Net, and when you try
</I>&gt;<i> .Net 4 or 4.5, they might have optimized it ...  You might find that one of
</I>&gt;<i> these things has a slower startup and a faster runtime ...  Thus making it
</I>&gt;<i> better for certain types of Blend operations, while being worse for other
</I>&gt;<i> datasets.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I know this one in particular:  General consensus on the Internet is
</I>&gt;<i> that  System.Security.Cryptography.AESManaged has a faster startup time and
</I>&gt;<i> slower runtime than System.Security.AESCryptoServiceProvider.  Even though
</I>&gt;<i> they both do the same thing, they're each optimized differently.  And guess
</I>&gt;<i> what, from one version of .Net to another version...  From one version of
</I>&gt;<i> mono to another ...  AESManaged performance will vary.  And the performance
</I>&gt;<i> depends on whether or not you have AES-NI instruction in your CPU (that
</I>&gt;<i> produces approx 10x performance difference) and it depends on which version
</I>&gt;<i> of .Net first included support for the AES-NI, and it depends which version
</I>&gt;<i> of mono first included support for AES-NI.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If you want to do a performance comparison, you need to find a job that
</I>&gt;<i> you actually care about, and hardware that you actually care about, and
</I>&gt;<i> test on that.  You cannot make any generalization and expect it to have any
</I>&gt;<i> validity, unless you *extremely* thoroughly benchmark all the different
</I>&gt;<i> variables ... Change the CPU's, the OS's, 32bit and 64bit, with and without
</I>&gt;<i> specialized hardware instruction sets, with and without certain Service
</I>&gt;<i> Packs and KB patches applied ... Run on windows, mac, linux, ... Nobody
</I>&gt;<i> does this much performance evaluation.  You cannot make a generalization.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Try doing greatest common divisor, mono tends to actually be faster than
</I>&gt;<i> c!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ian
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> &gt;&gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20130311/9e7f5a26/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20130311/9e7f5a26/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="049679.html">[Mono-list] Poor Mono performance
</A></li>
	<LI>Next message: <A HREF="049675.html">[Mono-list] Poor Mono performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49680">[ date ]</a>
              <a href="thread.html#49680">[ thread ]</a>
              <a href="subject.html#49680">[ subject ]</a>
              <a href="author.html#49680">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
