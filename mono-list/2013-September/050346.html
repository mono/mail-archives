<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] WCF via TCP is frightfully slow
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20WCF%20via%20TCP%20is%20frightfully%20slow&In-Reply-To=%3C1380564511396-4661001.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="050318.html">
   <LINK REL="Next"  HREF="050316.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] WCF via TCP is frightfully slow</H1>
    <B>mauzik</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20WCF%20via%20TCP%20is%20frightfully%20slow&In-Reply-To=%3C1380564511396-4661001.post%40n4.nabble.com%3E"
       TITLE="[Mono-list] WCF via TCP is frightfully slow">mauzik at centrum.cz
       </A><BR>
    <I>Mon Sep 30 18:08:31 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="050318.html">[Mono-list] WCF via TCP is frightfully slow
</A></li>
        <LI>Next message: <A HREF="050316.html">[Mono-list] Graphics.DrawImage(...) bug not fixed till 3 years :-((
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50346">[ date ]</a>
              <a href="thread.html#50346">[ thread ]</a>
              <a href="subject.html#50346">[ subject ]</a>
              <a href="author.html#50346">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, I did not give up use WCF on project. I tried profile application with
1000 receive requests and I have this part of result:

Method call summary
Total(ms) Self(ms)      Calls Method name
  167910       53       2000
System.ServiceModel.Channels.NetTcp.TcpDuplexSessionChannel:TryReceive
(System.TimeSpan,System.ServiceModel.Channels.Message&amp;)
  132676        0          1 (wrapper runtime-invoke)
&lt;Module&gt;:runtime_invoke_void_object (object,intptr,intptr,intptr)
  132676        8          1 Client.Program:Main (string[])
  131651       18       1002 (wrapper managed-to-native)
object:__icall_wrapper_mono_remoting_wrapper (intptr,intptr)
  131646        1       1000 (wrapper remoting-invoke)
Remote.Service.IPersonService:GetPerson ()
  131632        1       1002 (wrapper runtime-invoke)
&lt;Module&gt;:runtime_invoke_object_object_object_intptr&amp;_intptr&amp;
(object,intptr,intptr,intptr)
  131631       12       1002
System.Runtime.Remoting.Proxies.RealProxy:PrivateInvoke
(System.Runtime.Remoting.Proxies.RealProxy,System.Runtime.Remoting.Messaging.IMessage,System.Exception&amp;,object[]&amp;)
  131468        2       1002 System.ServiceModel.ClientRealProxy:Invoke
(System.Runtime.Remoting.Messaging.IMessage)
  131466       18       1002 System.ServiceModel.ClientRealProxy:DoInvoke
(System.Runtime.Remoting.Messaging.IMessage)
  131313        1       1000
System.ServiceModel.MonoInternal.ClientRuntimeChannel:Process
(System.Reflection.MethodBase,string,object[])
  131312       12       1000
System.ServiceModel.MonoInternal.ClientRuntimeChannel:DoProcess
(System.Reflection.MethodBase,string,object[])
  131183       10       1000
System.ServiceModel.MonoInternal.ClientRuntimeChannel:Request
(System.ServiceModel.Description.OperationDescription,object[])
  116290        7       1000 (wrapper runtime-invoke)
&lt;Module&gt;:runtime_invoke_bool__this___TimeSpan_intptr&amp;
(object,intptr,intptr,intptr)
  100804       17       2000 unknown method 0x9d5c97c
  100786   100786       2000 unknown method 0x9d5c9e4
   70224        7       6000
System.ServiceModel.Channels.MessageHeader:CreateHeader
(string,string,object,bool)
   70216        6       6000
System.ServiceModel.Channels.MessageHeader:CreateHeader
(string,string,object,bool,string)
   70210       14       6000
System.ServiceModel.Channels.MessageHeader:CreateHeader
(string,string,object,bool,string,bool)
   70136        7       6000
System.Runtime.Serialization.DataContractSerializer:.ctor (System.Type)
   70128       37       6000
System.Runtime.Serialization.DataContractSerializer:.ctor
(System.Type,System.Collections.Generic.IEnumerable`1&lt;System.Type&gt;)
   69490       35       7002
System.Runtime.Serialization.DataContractSerializer:PopulateTypes
(System.Collections.Generic.IEnumerable`1&lt;System.Type&gt;)
   69296       22       7002
System.Runtime.Serialization.DataContractSerializer:RegisterTypeAsKnown
(System.Type)
   68976        5       3000
System.ServiceModel.Channels.MessageHeader:CreateHeader
(string,string,object)
   68544       50      25797 System.Collections.ObjectModel.Collection`1:Add
(T)
   68533       22       1000
System.ServiceModel.MonoInternal.ClientRuntimeChannel:CreateRequest
(System.ServiceModel.Dispatcher.ClientOperation,object[])
   68475       38      25008
System.Runtime.Serialization.KnownTypeCollection:InsertItem
(int,System.Type)
   67898        6       3002
System.Runtime.Serialization.KnownTypeCollection:TryRegister (System.Type)
   67867       21       3002
System.Runtime.Serialization.KnownTypeCollection:DoTryRegister (System.Type)
   66993       29       1999
System.ServiceModel.Channels.NetTcp.TcpBinaryFrameManager:ReadSizedMessage
()
   65232       13       6008 System.IO.Stream:ReadByte ()
   65202       15       8008 System.Net.Sockets.NetworkStream:Read
(byte[],int,int)
   65181       14       8008 System.Net.Sockets.Socket:Receive
(byte[],int,int,System.Net.Sockets.SocketFlags)
   65161        9       8008 System.Net.Sockets.Socket:Receive_nochecks
(byte[],int,int,System.Net.Sockets.SocketFlags,System.Net.Sockets.SocketError&amp;)
   65151    65151       8008 (wrapper managed-to-native)
System.Net.Sockets.Socket:Receive_internal
(intptr,byte[],int,int,System.Net.Sockets.SocketFlags,int&amp;)
   61898        2       1000
System.ServiceModel.Channels.MessageHeaders:set_ReplyTo
(System.ServiceModel.EndpointAddress)

It is only interesting part of whole result. I do not understand why is
there unknown method (unknown method 0x9d5c9e4). This method consumes 100786
ms which is significant part of the total run of the application. Other
method with high time consumption is
ystem.Net.Sockets.Socket:Receive_internal
(intptr,byte[],int,int,System.Net.Sockets.SocketFlags,int&amp;). In my opinion
unknown method 0x9d5c9e4 is method from external shared library.

Does anyone know what could be the problem and how to solve this performance
issue? 



--
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/WCF-via-TCP-is-frightfully-slow-tp4660946p4661001.html">http://mono.1490590.n4.nabble.com/WCF-via-TCP-is-frightfully-slow-tp4660946p4661001.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="050318.html">[Mono-list] WCF via TCP is frightfully slow
</A></li>
	<LI>Next message: <A HREF="050316.html">[Mono-list] Graphics.DrawImage(...) bug not fixed till 3 years :-((
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50346">[ date ]</a>
              <a href="thread.html#50346">[ thread ]</a>
              <a href="subject.html#50346">[ subject ]</a>
              <a href="author.html#50346">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
