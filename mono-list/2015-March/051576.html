<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] soft debugger and embedded API (SOLVED)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20soft%20debugger%20and%20embedded%20API%20%28SOLVED%29&In-Reply-To=%3CE35DB567-2416-4476-9236-851417F40801%40mugginsoft.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="051574.html">
   <LINK REL="Next"  HREF="051575.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] soft debugger and embedded API (SOLVED)</H1>
    <B>Jonathan Mitchell</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20soft%20debugger%20and%20embedded%20API%20%28SOLVED%29&In-Reply-To=%3CE35DB567-2416-4476-9236-851417F40801%40mugginsoft.com%3E"
       TITLE="[Mono-list] soft debugger and embedded API (SOLVED)">jonathan at mugginsoft.com
       </A><BR>
    <I>Wed Mar 18 21:20:48 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="051574.html">[Mono-list] soft debugger and embedded API
</A></li>
        <LI>Next message: <A HREF="051575.html">[Mono-list] Contents of Mono-list digest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51576">[ date ]</a>
              <a href="thread.html#51576">[ thread ]</a>
              <a href="subject.html#51576">[ subject ]</a>
              <a href="author.html#51576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>After some more experimentation I seem to have this sorted:
Resequencing the setup code was key to getting the debuggee up and talking:

    mono_jit_parse_options(2, (char**)jit_options);
    mono_debug_init(MONO_DEBUG_FORMAT_MONO);
   _monoDomain = mono_jit_init_version(domainName, version);

To successful set breakpoints I also had to:

1. Run the app outside of Xcode so that its debugger signal handler did not conflict with the Mono soft debugger signal handler.
2. Disable my HockeyApp PLCrashReporter powered crash catcher. This uses an in process signal handle that also interferes with the soft debugger.

With these issues resolved I was able to run my OS X Obj-C app and debug the managed code on a Windows vm running under Fusion.

see <A HREF="https://github.com/ThesaurusSoftware/Dubrovnik/commit/4bf62fabbc6c9c5375bee1f31ed71897a2f13de7">https://github.com/ThesaurusSoftware/Dubrovnik/commit/4bf62fabbc6c9c5375bee1f31ed71897a2f13de7</A>

&gt;<i> On 18 Mar 2015, at 10:38, Jonathan Mitchell &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">jonathan at mugginsoft.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> HI
</I>&gt;<i> 
</I>&gt;<i> I am trying to connect via the soft debugger to an app that uses the embedded API.
</I>&gt;<i> 
</I>&gt;<i> The debuggee is on OS X, the debugger is on a windows machine VM at 192.168.1.72.
</I>&gt;<i> The debugee has .mdb files available that reference symbol source locations on the debugger.
</I>&gt;<i> 
</I>&gt;<i> I have been guided by the following so far:
</I>&gt;<i> <A HREF="http://www.jeffongames.com/2012/03/debugging-embedded-mono/">http://www.jeffongames.com/2012/03/debugging-embedded-mono/</A>
</I>&gt;<i> 
</I>&gt;<i> On the debug I do my setup like so prior to loading any app specific assemblies:
</I>&gt;<i> 
</I>&gt;<i>    _monoDomain = mono_jit_init_version(domainName, version);
</I>&gt;<i>    mono_debug_init(MONO_DEBUG_FORMAT_MONO);
</I>&gt;<i>    mono_debug_domain_create(_monoDomain);
</I>&gt;<i> 
</I>&gt;<i>    const char* jit_options[] = {
</I>&gt;<i>        &quot;--soft-breakpoints&quot;,
</I>&gt;<i>        &quot;--debugger-agent=transport=dt_socket,address=192.168.1.72:10000&quot;
</I>&gt;<i>    };
</I>&gt;<i> 
</I>&gt;<i>    mono_jit_parse_options(2, (char**)jit_options);
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I have configured Xamarin Studio to use the soft debugger and when it is listening I can telnet into 192.168.1.72:10000.
</I>&gt;<i> However I don&#8217;t get any sort of debug activity when I run the debugee with the debugger listening.
</I>&gt;<i> 
</I>&gt;<i> Any pointers would be appreciated.
</I>&gt;<i> 
</I>&gt;<i> Two points:
</I>&gt;<i> 
</I>&gt;<i> 1. The link above states : If the Mono client can't connect to the debugging server when it starts up, it will call exit, which is no good.
</I>&gt;<i> I don&#8217;t see this behaviour. The app runs whether the debug server is up or not.
</I>&gt;<i> 
</I>&gt;<i> 2. A source note for mono_debug_init at <A HREF="https://github.com/mono/mono/blob/adb9681393a8dfec2ca9c2e8c5a4ed72d663878d/mono/metadata/mono-debug.c#L121">https://github.com/mono/mono/blob/adb9681393a8dfec2ca9c2e8c5a4ed72d663878d/mono/metadata/mono-debug.c#L121</A>
</I>&gt;<i> says 
</I>&gt;<i> 
</I>&gt;<i> * This method must be called after loading corlib,
</I>&gt;<i> * but before opening the application's main assembly because we need to set some
</I>&gt;<i> * callbacks here.
</I>&gt;<i> 
</I>&gt;<i> Is the prior call to  mono_jit_init_version enough to satisfy the above condition?
</I>&gt;<i> 
</I>&gt;<i> Thanks
</I>&gt;<i> 
</I>&gt;<i> Jonathan
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="051574.html">[Mono-list] soft debugger and embedded API
</A></li>
	<LI>Next message: <A HREF="051575.html">[Mono-list] Contents of Mono-list digest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51576">[ date ]</a>
              <a href="thread.html#51576">[ thread ]</a>
              <a href="subject.html#51576">[ subject ]</a>
              <a href="author.html#51576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
