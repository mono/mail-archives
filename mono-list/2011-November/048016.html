<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono.Data.Sqlite.dll TypeLoadException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Data.Sqlite.dll%20TypeLoadException&In-Reply-To=CAC5vxh2xv6F_g64c0X%2BfJHm%3DufUe52_v9ebJENCKvDqqnyq5Tw%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="048014.html">
   <LINK REL="Next"  HREF="048017.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono.Data.Sqlite.dll TypeLoadException</H1>
    <B>Daniel Hughes</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Data.Sqlite.dll%20TypeLoadException&In-Reply-To=CAC5vxh2xv6F_g64c0X%2BfJHm%3DufUe52_v9ebJENCKvDqqnyq5Tw%40mail.gmail.com"
       TITLE="[Mono-list] Mono.Data.Sqlite.dll TypeLoadException">trampster at gmail.com
       </A><BR>
    <I>Mon Nov 21 21:22:11 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="048014.html">[Mono-list]  Mono.Data.Sqlite.dll TypeLoadException
</A></li>
        <LI>Next message: <A HREF="048017.html">[Mono-list] Mono.Data.Sqlite.dll TypeLoadException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48016">[ date ]</a>
              <a href="thread.html#48016">[ thread ]</a>
              <a href="subject.html#48016">[ subject ]</a>
              <a href="author.html#48016">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>After digging arround in the source code for Mono.Data.Sqlite it appears
that

SqliteConnectionHandle implements CriticalHandle which has the following
attribute:

[SecurityPermissionAttribute(SecurityAction.InheritanceDemand,
UnmanagedCode = true)]

This requires that the inheriting class (SqliteConnectionHandle) have the
same or more restrictive permissions. However SqliteConnectionHandle does
not specify any security permissions and so violates the contract.

This does not seem to be a problem when running on mono for linux only .net
for windows. (maybe mono does not implement these security checks)

The upshot of all this is that Mono.Data.Sqlite.dll v4.0.0.0 cannot be used
on .net until a fix is made (adding the SecurityPermissionAttribute).

I am happy to raise a bug and submit a patch (if that's the correct thing
to do) however I can't wait for the fix to be released so will have to ship
a custom build of Mono.Data.Sqlite.dll with a fix applied in Wide Margin
for windows.

Cheers,
Daniel


On Tue, Nov 22, 2011 at 1:02 PM, Daniel Hughes &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">trampster at gmail.com</A>&gt; wrote:

&gt;<i> When trying to use Mono.Data.Sqlite v4.0.0.0 from .net on windows I get
</I>&gt;<i> the following exception
</I>&gt;<i>
</I>&gt;<i> Unhandled Exception: System.TypeLoadException: Inheritance security rules
</I>&gt;<i> violated by type: 'Mono.Data.Sqlite.SqliteConnectionHandle'. Derived types
</I>&gt;<i> must either match the security accessibility of the base type or be less
</I>&gt;<i> accessible.
</I>&gt;<i>    at Mono.Data.Sqlite.SQLite3.Open(String strFilename,
</I>&gt;<i> SQLiteOpenFlagsEnum flags, Int32 maxPoolSize, Boolean usePool)
</I>&gt;<i>    at Mono.Data.Sqlite.SqliteConnection.Open()
</I>&gt;<i>
</I>&gt;<i> Any idea whats causing this? or what I can do to work around it?
</I>&gt;<i>
</I>&gt;<i> I've been using the 2.0 version of this assembly (which works fine)
</I>&gt;<i> until recently when I tried to update to .net 4.0 support.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Daniel
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20111122/3803b742/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20111122/3803b742/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="048014.html">[Mono-list]  Mono.Data.Sqlite.dll TypeLoadException
</A></li>
	<LI>Next message: <A HREF="048017.html">[Mono-list] Mono.Data.Sqlite.dll TypeLoadException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48016">[ date ]</a>
              <a href="thread.html#48016">[ thread ]</a>
              <a href="subject.html#48016">[ subject ]</a>
              <a href="author.html#48016">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
