<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Custom ITaks in MonoDevelop
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Custom%20ITaks%20in%20MonoDevelop&In-Reply-To=3f80.ef80292.39be86d7%40aol.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045759.html">
   <LINK REL="Next"  HREF="045760.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Custom ITaks in MonoDevelop</H1>
    <B>Michael Hutchinson</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Custom%20ITaks%20in%20MonoDevelop&In-Reply-To=3f80.ef80292.39be86d7%40aol.com"
       TITLE="[Mono-list] Custom ITaks in MonoDevelop">m.j.hutchinson at gmail.com
       </A><BR>
    <I>Sun Sep 12 21:17:20 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="045759.html">[Mono-list] Custom ITaks in MonoDevelop
</A></li>
        <LI>Next message: <A HREF="045760.html">[Mono-list] mono --runtime option list
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45761">[ date ]</a>
              <a href="thread.html#45761">[ thread ]</a>
              <a href="subject.html#45761">[ subject ]</a>
              <a href="author.html#45761">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Sep 12, 2010 at 3:41 PM,  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Krogerma at aol.com</A>&gt; wrote:
&gt;<i> Hello, Lists:
</I>&gt;<i>
</I>&gt;<i> I received some clarification from list members right after I submitted my
</I>&gt;<i> last E-mail. I got waylayed for a while, but now I'm back on it. Thanks to
</I>&gt;<i> the folks who helped me.
</I>&gt;<i>
</I>&gt;<i> The information I got indicated that xbuild had to be turned on within
</I>&gt;<i> MonoDevelop if any Custom Tasks need to be called. I've done this. I get a
</I>&gt;<i> couple of error messages:
</I>&gt;<i> &#160;&quot;Error initializing task Message:&#160; cannot cast from source type to
</I>&gt;<i> destination type&quot;
</I>&gt;<i> &#160;&quot;Error initializing task CreateItem:&#160; cannot cast from source type to
</I>&gt;<i> destination type&quot;.
</I>&gt;<i>
</I>&gt;<i> This occurs in a simple file that does not even have any custom tasks in it
</I>&gt;<i> (I actually commented them out in the .csproj file) that otherwise builds
</I>&gt;<i> fine without the xbuild switch turned on in MonoDevelop.
</I>&gt;<i>
</I>&gt;<i> I just upgraded to mono 2.6.7 to continue with this work. I'm using the
</I>&gt;<i> latest MonoDevelop, which I also downloaded at the same time.
</I>&gt;<i>
</I>&gt;<i> This seems to me like it might be an incorrect version of a dll somewhere.
</I>&gt;<i> Does anybody have any advice?
</I>&gt;<i>
</I>&gt;<i> A snippet from the bottom of my .csproj file is:
</I>&gt;<i> &#160; &lt;!-- This section is a very simple test to copy a file. --&gt;
</I>&gt;<i> &lt;!--&#160; &lt;PropertyGroup&gt;
</I>&gt;<i> &#160;&#160;&#160; &lt;FileToCopy&gt;TestClass1.txt&lt;/FileToCopy&gt;
</I>&gt;<i> &#160; &lt;/PropertyGroup&gt;
</I>&gt;<i> &#160; &lt;PropertyGroup&gt;
</I>&gt;<i> &#160;&#160;&#160; &lt;Dest&gt;bin\&lt;/Dest&gt;
</I>&gt;<i> &#160; &lt;/PropertyGroup&gt;
</I>&gt;<i> &#160; &lt;Target Name=&quot;AfterBuild&quot;&gt;
</I>&gt;<i> &#160;&#160;&#160; &lt;Copy SourceFiles=&quot;$(FileToCopy)&quot; DestinationFolder=&quot;$(Dest)&quot; /&gt;
</I>&gt;<i> &#160; &lt;/Target&gt; --&gt;
</I>&gt;<i>
</I>&gt;<i> I'm starting simple here - only using the ITasks that are provided from
</I>&gt;<i> Microsoft and seem to be provided in the Mono distribution, too. The
</I>&gt;<i> AfterBuild Target is in the Mono version of Microsoft.Common.Targets, so I'm
</I>&gt;<i> assuming it can be used the same way as in MSBuild.
</I>&gt;<i>
</I>&gt;<i> I'm including the solution file.
</I>&gt;<i>
</I>&gt;<i> If anyone can help us get this running, we'll submit my intern's report on
</I>&gt;<i> this to the community.
</I>&gt;<i>
</I>&gt;<i> What we are (eventually) trying to achieve is to perform builds across
</I>&gt;<i> Windows-VS, Windows-mono, Linux-mono and Mac-mono environments with the same
</I>&gt;<i> solution and project files. Our plan entails putting certain build-wide
</I>&gt;<i> variables into a configuration file that lives in the solution folder and
</I>&gt;<i> that will be accessed to determine platform-specific directories and other
</I>&gt;<i> platform-specific information.
</I>
Hi,

The problem is that the executable that MD uses to build MSBuild
projects references the MSBuild 2.0 assemblies, so if your tasks
reference the 3.5 assemblies, your tasks will not be able to be cast
to the 2.0 ITask interface and the build will fail.

This was fixed in MonoDevelop master about a week ago - MD uses Cecil
to rewrite the builder executable into versions for 3.5 and 4.0 APIs,
depending on the project's ToolsVersion. Note that this means the 4.0
ToolsVersion requires a runtime that supports 4.0, e.g. Mono 2.8.

-- 
Michael Hutchinson
<A HREF="http://mjhutchinson.com">http://mjhutchinson.com</A>
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045759.html">[Mono-list] Custom ITaks in MonoDevelop
</A></li>
	<LI>Next message: <A HREF="045760.html">[Mono-list] mono --runtime option list
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45761">[ date ]</a>
              <a href="thread.html#45761">[ thread ]</a>
              <a href="subject.html#45761">[ subject ]</a>
              <a href="author.html#45761">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
