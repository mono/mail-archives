<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Memory usage of mod_mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:markprins%40datacom.co.nz">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="025780.html">
   <LINK REL="Next"  HREF="025790.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Memory usage of mod_mono
   </H1>
    <B>Mark Prins (DSL AK)
    </B> 
    <A HREF="mailto:markprins%40datacom.co.nz"
       TITLE="[Mono-list] Memory usage of mod_mono">markprins@datacom.co.nz
       </A><BR>
    <I>Thu, 17 Feb 2005 08:55:28 +1300</I>
    <P><UL>
        <LI> Previous message: <A HREF="025780.html">[Mono-list] different behavior between .NET and Mono
</A></li>
        <LI> Next message: <A HREF="025790.html">[Mono-list] Memory usage of mod_mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25787">[ date ]</a>
              <a href="thread.html#25787">[ thread ]</a>
              <a href="subject.html#25787">[ subject ]</a>
              <a href="author.html#25787">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------_=_NextPart_001_01C51461.7694363A
Content-Type: text/plain;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable

&gt;<i> Hi,=20
</I>&gt;<i>=20
</I>&gt;<i> We've written a content management web application using mono,
</I>&gt;<i> mod_mono &amp; apache running on a slackware 10 (client's choice, not
</I>&gt;<i> ours) server. We've got two problems. The first is an intermittent
</I>&gt;<i> hang - whereby the mono processes are still running but no longer
</I>&gt;<i> serve requests. Killing all mono processes or restarting apache gets
</I>&gt;<i> the site responding again. We're still working on that one and have a
</I>&gt;<i> workaround in place, of more concern is the other problem: the site
</I>&gt;<i> just gobbles up memory until it uses all available and then,
</I>&gt;<i> particularly on the production box, the whole server falls over. We've
</I>&gt;<i> had to take the site off the production server now and are running a
</I>&gt;<i> static version of the site.
</I>&gt;<i>=20
</I>&gt;<i> My question is: is anyone running a busy site using mod_mono on
</I>&gt;<i> apache? Have they noticed memory usage issues? We're working with an
</I>&gt;<i> average of 50,000 hits a day on the production server, so it doesn't
</I>&gt;<i> take long for the server to fall over.
</I>&gt;<i>=20
</I>&gt;<i> I've tried a few different configurations, to try and narrow it down,
</I>&gt;<i> but all of these have problems:
</I>&gt;<i>=20
</I>&gt;<i> - Run the site on Red Hat Enterprise WS, with mono installed from
</I>&gt;<i> RPMs, apache ( 2.0.50 ) from source
</I>&gt;<i> - the site runs fine on windows, but that's not really relevant so I
</I>&gt;<i> won't mention it..
</I>&gt;<i> - Slackware 10 / mono 1.0.5 / mod_mono 1.0.5 / apache 2.0.52 (all
</I>&gt;<i> installed from source)
</I>&gt;<i> - Slackware 10 / mono 1.0.5 / mod_mono 1.0.5 / apache 2.0.50 (all
</I>&gt;<i> installed from source, three different machines)
</I>&gt;<i> - Slackware 10 / mono 1.1.3 / mod_mono 1.0.5 / apache 2.0.50 (all
</I>&gt;<i> installed from source)
</I>&gt;<i> - on Slackware 10 / mono 1.0.5 / mod_mono 1.0.5 / apache 2.0.50:
</I>&gt;<i> -- using an aspx page with only response.write in it
</I>&gt;<i> -- using an aspx page with no server-side code at all
</I>&gt;<i> -- adding GC.Collect() at various points in the code
</I>&gt;<i>=20
</I>&gt;<i> We've been building the app while several versions of mono have been
</I>&gt;<i> released - we started on 1.0.1, so I've also tested on:
</I>&gt;<i> - Slackware 10 / mono 1.0.2 / mod_mono 1.0.5 / apache 2.0.50 (from
</I>&gt;<i> source)
</I>&gt;<i> - Slackware 10 / mono 1.0.2 / mod_mono 1.0.2 / apache 2.0.50 (from
</I>&gt;<i> source)
</I>&gt;<i>=20
</I>&gt;<i> As well as the Red Hat distribution we've had a look at both debian
</I>&gt;<i> and Suse and have noticed memory leaking on them too. My concern isn't
</I>&gt;<i> so much that memory usage increases, it's that there is no limit to it
</I>&gt;<i> and that the mono processes don't restart when they've consumed a huge
</I>&gt;<i> amount of resource.
</I>&gt;<i> Basic configuration is something like this:
</I>&gt;<i>=20
</I>&gt;<i> Apache install: ./configure --prefix=3D/usr/local/apache2
</I>&gt;<i> --enable-rewrite --enable-headers --enable-expires
</I>&gt;<i> Mono: ./configure --with-apxs=3D/usr/local/apache2/bin/apxs
</I>&gt;<i> Mod_mono: ./configure
</I>&gt;<i> *** Httpd.conf changes: ***
</I>&gt;<i> LoadModule mono_module        modules/mod_mono.so
</I>&gt;<i> MonoRunXSP True
</I>&gt;<i> MonoUnixSocket /tmp/mod_mono_server
</I>&gt;<i> AddType application/x-asp-net .aspx .ashx .asmx .ascx .asax .config
</I>&gt;<i> .ascx
</I>&gt;<i> MonoApplications &quot;/:/web/http&quot;
</I>&gt;<i>=20
</I>&gt;<i> &lt;Directory &quot;/web/http&quot;&gt;
</I>&gt;<i> 	AddHandler mono .aspx .ascx .asax .ashx .config .cs .asmx .htm
</I>&gt;<i> 	&lt;FilesMatch &quot;\.(aspx|ascx|ashx|config|cs|asmx|htm)$&quot;&gt;=20
</I>&gt;<i> 		SetHandler mono
</I>&gt;<i> 	&lt;/FilesMatch&gt;
</I>&gt;<i> 	# This rather convoluted bit is because RequestHeader &amp; Header
</I>&gt;<i> won't return normal env vars=20
</I>&gt;<i> 	# and also won't just echo env vars
</I>&gt;<i> 	RewriteEngine ON
</I>&gt;<i> 	RewriteCond %{REQUEST_FILENAME} !-f
</I>&gt;<i> 	RewriteCond %{REQUEST_FILENAME} !-d
</I>&gt;<i> 	RewriteRule ^(.*) /404b.aspx [E=3DURI:%{REQUEST_URI}]
</I>&gt;<i> 	RequestHeader set URI %{REDIRECT_URI}e
</I>&gt;<i> 	Options FollowSymLinks ExecCGI=20
</I>&gt;<i> 	AllowOverride None
</I>&gt;<i> 	Order allow,deny
</I>&gt;<i> 	Allow from all
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i> *** End httpd.conf changes ***
</I>&gt;<i>=20
</I>&gt;<i> If I set a load generator on a simple aspx page served by a server
</I>&gt;<i> configured like this, the memory usage simply increases until
</I>&gt;<i> eventually the server gives up.
</I>&gt;<i> I've also tried using MonoMaxMemory and MonoMaxCPUTime but for me max
</I>&gt;<i> CPU time has no effect and max memory stops ASP.NET pages responding
</I>&gt;<i> once the limit is reached. I'd expected the mono processes to recycle,
</I>&gt;<i> avoiding any memory issues but whatever I do, the processes don't seem
</I>&gt;<i> to restart. Should they? I did see it happen once on one of the
</I>&gt;<i> earlier configurations when the GC was turned off ( I was testing
</I>&gt;<i> something.. ) but am unable to replicate now.
</I>&gt;<i>=20
</I>&gt;<i> Any advice appreciated. Even with these problems at the end of a long
</I>&gt;<i> project, I'm still keen to use mono for this and future projects -
</I>&gt;<i> it's a fine piece of work.
</I>&gt;<i> Thanks
</I>&gt;<i> Mark Prins
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>
------_=_NextPart_001_01C51461.7694363A
Content-Type: text/html;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META HTTP-EQUIV=3D&quot;Content-Type&quot; CONTENT=3D&quot;text/html; =
charset=3Dus-ascii&quot;&gt;
&lt;META NAME=3D&quot;Generator&quot; CONTENT=3D&quot;MS Exchange Server version =
6.5.7226.0&quot;&gt;
&lt;TITLE&gt;Memory usage of mod_mono&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;!-- Converted from text/rtf format --&gt;

&lt;P&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Hi, &lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;We've written a content =
management web application using mono, mod_mono &amp;amp; apache running on =
a slackware 10 (client's choice, not ours) server. We've got two =
problems. The first is an intermittent hang - whereby the mono processes =
are still running but no longer serve requests. Killing all mono =
processes or restarting apache gets the site responding again. We're =
still working on that one and have a workaround in place, of more =
concern is the other problem: the site just gobbles up memory until it =
uses all available and then, particularly on the production box, the =
whole server falls over. We've had to take the site off the production =
server now and are running a static version of the site.&lt;/FONT&gt;&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;My question is: is anyone =
running a busy site using mod_mono on apache? Have they noticed memory =
usage issues? We're working with an average of 50,000 hits a day on the =
production server, so it doesn't take long for the server to fall =
over.&lt;/FONT&gt;&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;I've tried a few different =
configurations, to try and narrow it down, but all of these have =
problems:&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;- Run the site on Red Hat =
Enterprise WS, with mono installed from RPMs, apache (&lt;SPAN =
LANG=3D&quot;en-nz&quot;&gt; 2.0.50 ) from source&lt;/SPAN&gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-nz&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;- the site =
runs fine on windows, but that's not really relevant so I won't mention =
it..&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-nz&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;-&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt; &lt;FONT SIZE=3D2 =
FACE=3D&quot;Trebuchet MS&quot;&gt;Slackware 10 / mono 1.0.5 / mod_mono 1.0.5 / =
apache 2.0.52 (all installed from source)&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-nz&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;-&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt; &lt;FONT SIZE=3D2 =
FACE=3D&quot;Trebuchet MS&quot;&gt;Slackware 10 / mono 1.0.5 / mod_mono 1.0.5 / =
apache 2.0.50 (all installed from source, three different =
machines)&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-nz&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;-&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt; &lt;FONT SIZE=3D2 =
FACE=3D&quot;Trebuchet MS&quot;&gt;Slackware 10 / mono 1.1.3 / mod_mono 1.0.5 / =
apache 2.0.50 (all installed from source)&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;- on =
Slackware 10 / mono 1.0.5 / mod_mono 1.0.5 / apache =
2.0.50:&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;-- using =
an aspx page with only response.write in it&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;-- using =
an aspx page with no server-side code at all&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;-- adding =
GC.Collect() at various points in the code&lt;/FONT&gt;&lt;/SPAN&gt;
&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;We've been =
building the app while several versions of mono have been released - we =
started on 1.0.1, so I've also tested on:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-nz&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;-&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt; &lt;FONT SIZE=3D2 =
FACE=3D&quot;Trebuchet MS&quot;&gt;Slackware 10 / mono 1.0.2 / mod_mono 1.0.5 / =
apache 2.0.50 (from source)&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-nz&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;-&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt; &lt;FONT SIZE=3D2 =
FACE=3D&quot;Trebuchet MS&quot;&gt;Slackware 10 / mono 1.0.2 / mod_mono 1.0.2 / =
apache 2.0.50 (from source)&lt;/FONT&gt;&lt;/SPAN&gt;
&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;As well as =
the Red Hat distribution we've had a look at both debian and Suse and =
have noticed memory leaking on them too. My concern isn't so much that =
memory usage increases, it's that there is no limit to it and that the =
mono processes don't restart when they've consumed a huge amount of =
resource.&lt;BR&gt;
Basic configuration is something like this:&lt;/FONT&gt;&lt;/SPAN&gt;
&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Apache =
install: ./configure --prefix=3D/usr/local/apache2 --enable-rewrite =
--enable-headers --enable-expires&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Mono: =
./configure --with-apxs=3D/usr/local/apache2/bin/apxs&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Mod_mono: =
./configure&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;*** =
Httpd.conf changes: ***&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;LoadModule =
mono_module&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
modules/mod_mono.so&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;MonoRunXSP =
True&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;MonoUnixSocket /tmp/mod_mono_server&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;AddType =
application/x-asp-net .aspx .ashx .asmx .ascx .asax .config =
.ascx&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;MonoApplications &amp;quot;/:/web/http&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;
&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;&amp;lt;Directory &amp;quot;/web/http&amp;quot;&amp;gt;&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;AddHandler mono .aspx .ascx .asax =
.ashx .config .cs .asmx .htm&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;&amp;lt;FilesMatch =
&amp;quot;\.(aspx|ascx|ashx|config|cs|asmx|htm)$&amp;quot;&amp;gt; &lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;FONT SIZE=3D2 =
FACE=3D&quot;Trebuchet MS&quot;&gt;SetHandler mono&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;&amp;lt;/FilesMatch&amp;gt;&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;# This rather convoluted bit is =
because RequestHeader &amp;amp; Header won't return normal env vars =
&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;# and also won't just echo env =
vars&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;RewriteEngine ON&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;RewriteCond %{REQUEST_FILENAME} =
!-f&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;RewriteCond %{REQUEST_FILENAME} =
!-d&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;RewriteRule ^(.*) /404b.aspx =
[E=3DURI:%{REQUEST_URI}]&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;RequestHeader set URI =
%{REDIRECT_URI}e&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Options FollowSymLinks ExecCGI =
&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;AllowOverride None&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Order allow,deny&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Allow from all&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;*** End =
httpd.conf changes ***&lt;/FONT&gt;&lt;/SPAN&gt;
&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;If I set a =
load generator on a simple aspx page served by a server configured like =
this, the memory usage simply increases until eventually the server =
gives up.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;I've also =
tried using MonoMaxMemory and MonoMaxCPUTime but for me max CPU time has =
no effect and max memory stops ASP.NET pages responding once the limit =
is reached. I'd expected the mono processes to recycle, avoiding any =
memory issues but whatever I do, the processes don&amp;#8217;t seem to =
restart. Should they? I did see it happen once on one of the earlier =
configurations when the GC was turned off ( I was testing something.. ) =
but am unable to replicate now.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Any advice =
appreciated. Even with these problems at the end of a long project, I'm =
still keen to use mono for this and future projects - it's a fine piece =
of work.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;

&lt;P&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet =
MS&quot;&gt;Thanks&lt;/FONT&gt;&lt;/SPAN&gt;

&lt;BR&gt;&lt;SPAN LANG=3D&quot;en-us&quot;&gt;&lt;FONT SIZE=3D2 FACE=3D&quot;Trebuchet MS&quot;&gt;Mark =
Prins&lt;/FONT&gt;&lt;/SPAN&gt;
&lt;/P&gt;
&lt;BR&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
------_=_NextPart_001_01C51461.7694363A--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="025780.html">[Mono-list] different behavior between .NET and Mono
</A></li>
	<LI> Next message: <A HREF="025790.html">[Mono-list] Memory usage of mod_mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25787">[ date ]</a>
              <a href="thread.html#25787">[ thread ]</a>
              <a href="subject.html#25787">[ subject ]</a>
              <a href="author.html#25787">[ author ]</a>
         </LI>
       </UL>
</body></html>
