<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] XSLT transform problems...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20XSLT%20transform%20problems...&In-Reply-To=1120934765.3320.16.camel%40fastdog">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027767.html">
   <LINK REL="Next"  HREF="027769.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] XSLT transform problems...</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20XSLT%20transform%20problems...&In-Reply-To=1120934765.3320.16.camel%40fastdog"
       TITLE="[Mono-list] XSLT transform problems...">atsushi at ximian.com
       </A><BR>
    <I>Sat Jul  9 15:30:37 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="027767.html">[Mono-list] XSLT transform problems...
</A></li>
        <LI>Next message: <A HREF="027769.html">[Mono-list] XSLT transform problems...Solved.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27768">[ date ]</a>
              <a href="thread.html#27768">[ thread ]</a>
              <a href="subject.html#27768">[ subject ]</a>
              <a href="author.html#27768">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Jae Stutzman wrote:
&gt;<i> I'm doing some XSLT transforms in ASP.NET and I'm seeing a difference in
</I>&gt;<i> behavior from MS.NET. It seems to have to do with multiple xml documents
</I>&gt;<i> using the document() function.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &lt;?xml version=&quot;1.0&quot;?&gt;
</I>&gt;<i> &lt;xsl:transform version=&quot;1.0&quot;
</I>&gt;<i> xmlns:xsl=&quot;<A HREF="http://www.w3.org/1999/XSL/Transform&quot;">http://www.w3.org/1999/XSL/Transform&quot;</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;xsl:output method=&quot;html&quot;/&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;xsl:variable name=&quot;currentUser&quot; select=&quot;root/user&quot;/&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;xsl:variable name=&quot;usersDoc&quot; select=&quot;document('users.xml')&quot;/&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;xsl:variable name=&quot;currentThemePark&quot;&gt;
</I>&gt;<i> 	&lt;xsl:for-each select=&quot;$usersDoc/userSettings/user&quot;&gt;
</I>&gt;<i> 		&lt;xsl:if test=&quot;id=currentUser&quot;&gt;
</I>&gt;<i> 			&lt;xsl:value-of select=&quot;favPark&quot;/&gt;
</I>&gt;<i> 		&lt;/xsl:if&gt;
</I>&gt;<i> 	&lt;/xsl:for-each&gt;
</I>&gt;<i> &lt;/xsl:variable&gt;	
</I>&gt;<i> ...
</I>&gt;<i> ...
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> My aspx file looks like this...
</I>&gt;<i> &lt;%@ Import Namespace=&quot;System.Xml&quot; %&gt;
</I>&gt;<i> &lt;%@ Import Namespace=&quot;System.Xml.Xsl&quot; %&gt;
</I>&gt;<i> &lt;%@ Import Namespace=&quot;System.Xml.XPath&quot; %&gt;
</I>&gt;<i> &lt;%@ Import Namespace=&quot;System.IO&quot; %&gt;
</I>&gt;<i> &lt;%@ Import Namespace=&quot;System.Text&quot; %&gt;
</I>&gt;<i> &lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;
</I>&gt;<i>    public void Page_Load(Object sender, EventArgs E) {		
</I>&gt;<i>    string xmlPath = Server.MapPath(&quot;main.xml&quot;);
</I>&gt;<i>    string xslPath = Server.MapPath(&quot;main.xsl&quot;); 
</I>&gt;<i>   
</I>&gt;<i>    FileStream fs = new FileStream(xmlPath,FileMode.Open,
</I>&gt;<i>                    FileAccess.Read);
</I>&gt;<i>    StreamReader reader = new StreamReader(fs,Encoding.UTF8);
</I>&gt;<i>    XmlTextReader xmlReader = new XmlTextReader(reader);
</I>&gt;<i> 	  
</I>&gt;<i>    //Instantiate the XPathDocument Class
</I>&gt;<i>    XPathDocument doc = new XPathDocument(xmlReader);
</I>&gt;<i> 
</I>&gt;<i>    //Instantiate the XslTransform Class
</I>&gt;<i>    XslTransform xslDoc = new XslTransform();
</I>&gt;<i>    xslDoc.Load(xslPath);
</I>&gt;<i>    xslDoc.Transform(doc,null,Response.Output);
</I>&gt;<i> 	
</I>&gt;<i>    //Close Readers
</I>&gt;<i>    reader.Close();
</I>&gt;<i>    xmlReader.Close();
</I>&gt;<i>  }
</I>&gt;<i> &lt;/script&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> When I include the currentThemePark variable I lose both variables when
</I>&gt;<i> I try to get the value-of them. Under MS ASP.NET this works fine.
</I>&gt;<i> 
</I>&gt;<i> This seems like a bug? Could be an XPath problem dealing with multiple
</I>&gt;<i> documents. Is there another way to accomplish this? I need to have
</I>&gt;<i> multiple XML documents.
</I>
If main.xml, main.xsl and users.xml (referenced in the stylesheet)
are really in the same directory, then it sounds like a bug (on
url resolution). It is XSLT problem (document() function is one
from XSLT spec). In such case please file it to bugzilla and I'll
fix it later.

For workaround you can pass the full path filename as a variable
(for document() argument) in XsltArgumentList argument for
XslTransform.Transform().

Atsushi Eno
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027767.html">[Mono-list] XSLT transform problems...
</A></li>
	<LI>Next message: <A HREF="027769.html">[Mono-list] XSLT transform problems...Solved.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27768">[ date ]</a>
              <a href="thread.html#27768">[ thread ]</a>
              <a href="subject.html#27768">[ subject ]</a>
              <a href="author.html#27768">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
