<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Running vs2005 beta 2 compiled code on mono...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Running%20vs2005%20beta%202%20compiled%20code%20on%20mono...&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027702.html">
   <LINK REL="Next"  HREF="027703.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Running vs2005 beta 2 compiled code on mono...</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Running%20vs2005%20beta%202%20compiled%20code%20on%20mono...&In-Reply-To="
       TITLE="[Mono-list] Running vs2005 beta 2 compiled code on mono...">kornelpal at hotmail.com
       </A><BR>
    <I>Fri Jul  1 19:12:24 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="027702.html">[Mono-list] Running vs2005 beta 2 compiled code on mono...
</A></li>
        <LI>Next message: <A HREF="027703.html">[Mono-list] Time out using Npgsql
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27707">[ date ]</a>
              <a href="thread.html#27707">[ thread ]</a>
              <a href="subject.html#27707">[ subject ]</a>
              <a href="author.html#27707">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> From: Alex Mohr
</I>&gt;<i> No -- that's what I get if I try to run C++ code compiled with VS2003 on
</I>&gt;<i> the mac, and that's what I expect since there's no /clr:pure flag in
</I>&gt;<i> 2003.
</I>&gt;<i> ...
</I>
I have tried /clr:pure. If seems to be promising but I don't recommend using
it. Just look at the resulting exe file using ildasm. It's full of imported
functions from CRT. /clr:pure only means that you cannot declare unmanaged
code but you can use it inline without P/Invoke.

So the resulting code is still not entirely managed.

Use /clr:safe instead. You have to be able to run it on Mono. It does not
allow unmanaged code to be referenced and the assembly will be pure
verifiable IL.

And I advice you to install Mono on the same Windows box you develop
applications because behaviour of Mono is very similar on Windows and other
operating systems so you can test it after each build. Of course if you want
to ensure Mac compatibility you have to test it on Mac as well.


&gt;<i> From: A Rafael D Teixeira
</I>&gt;<i> A /clr:pure program uses only managed code, and that is good but it:
</I>&gt;<i>
</I>&gt;<i> 1) Expects a very different mscorlib 2.0. So at least you need to run
</I>&gt;<i> the mono 2.0-compatible preview version, and I'm not sure all the needed
</I>&gt;<i> implementations are in place.
</I>&gt;<i> 2) It still has some dependency on a specific runtime library
</I>&gt;<i> Microsoft.VisualC.dll. That I'm quite sure we doesn't have much of it
</I>&gt;<i> implemented as needed for both profiles (1.X, 2.0).
</I>
None of them is correct.

/clr:pure assumes a different runtime (in fact a runtime with more features)
because the resulting assembly may contain (and actually contains a lot of
CRT references) inline references to unmanaged code and unverifiable
(unsafe) code. It uses mscorlib just as you use it in your own code so it
does not assume any special mscorlib features.

Microsoft.VisualC.dll contains no code at all. It contains some dummy
attributes to make C++ compiler for example able to distinguish between long
and int. Both long and int are Int32 in managed code and an attribute
specifies the C++ data type. This may be useful in overload matching. This
assembly is completly implemented by Mono.

But all of these attributes (the assembly contains nothing else) are marked
as obsolete because MS realized that these attributes are dummy and I think
the assembly will be removed in 2.0 RTM.

&gt;<i> Sure it looks like our runtime is having trouble to load a class
</I>&gt;<i> definition. It probably is a bug or some assumption that doesn't hold
</I>&gt;<i> for 2.0, please file a bug at <A HREF="http://bugzilla.ximian.com/enter_bug.cgi?">http://bugzilla.ximian.com/enter_bug.cgi?</A>
</I>&gt;<i> product=Mono%3A%20Runtime starting the description with &quot;[2.0] ...&quot;
</I>
I'm not sure whether we want to support assemblies generated by C++ compiler
using /clr:pure as they are platform and processor dependent but feel free
to submit a bug report if you want.

Korn&#233;l

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027702.html">[Mono-list] Running vs2005 beta 2 compiled code on mono...
</A></li>
	<LI>Next message: <A HREF="027703.html">[Mono-list] Time out using Npgsql
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27707">[ date ]</a>
              <a href="thread.html#27707">[ thread ]</a>
              <a href="subject.html#27707">[ subject ]</a>
              <a href="author.html#27707">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
