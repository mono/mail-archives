<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] XmlSchemaSet Problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20XmlSchemaSet%20Problem&In-Reply-To=4C426CB768E434438A624D0E81C8BA3717C73D%40exhnat2.nsw.hpa">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030620.html">
   <LINK REL="Next"  HREF="030611.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] XmlSchemaSet Problem</H1>
    <B>Kent Boogaart</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20XmlSchemaSet%20Problem&In-Reply-To=4C426CB768E434438A624D0E81C8BA3717C73D%40exhnat2.nsw.hpa"
       TITLE="[Mono-list] XmlSchemaSet Problem">kentcb at internode.on.net
       </A><BR>
    <I>Tue Feb  7 01:51:49 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="030620.html">[Mono-list] Re: Releasing Named Mutexes
</A></li>
        <LI>Next message: <A HREF="030611.html">[Mono-list] XmlSchemaSet Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30610">[ date ]</a>
              <a href="thread.html#30610">[ thread ]</a>
              <a href="subject.html#30610">[ subject ]</a>
              <a href="author.html#30610">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all, 

I've come across a problem with the XmlSchemaSet that presents itself on
mono, but not on MS .NET. Essentially, adding multiple schemas to the set
does not permit them to &quot;see eachother&quot; without imports / includes. I
believe this is a bug in mono, since the documentation for XmlSchemaSet
states:

&quot;Compiled schemas generate a single logical schema, a &#147;set&#148; of schemas. Any
imported schemas within a schema that are added to the set are directly
added to the set themselves. This means that all types are available to all
schemas.&quot;

Here is a simple repro for the problem. Works fine on MS.NET but yields an
error on mono:

-------------------------------------------------- 
using System; 
using System.Collections.Generic; 
using System.IO; 
using System.Text; 
using System.Xml; 
using System.Xml.Schema; 

namespace SchemaRepro 
{ 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; class Program 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; { 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; private const string schema1 = @&quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot;
encoding=&quot;&quot;utf-8&quot;&quot; ?&gt; 
&lt;xsd:schema id=&quot;&quot;Base.Schema&quot;&quot; elementFormDefault=&quot;&quot;qualified&quot;&quot;
xmlns:xsd=&quot;&quot;<A HREF="http://www.w3.org/2001/XMLSchema&quot;&quot;">http://www.w3.org/2001/XMLSchema&quot;&quot;</A>&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;xsd:complexType name=&quot;&quot;itemBase&quot;&quot; abstract=&quot;&quot;true&quot;&quot;&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;xsd:attribute name=&quot;&quot;id&quot;&quot; type=&quot;&quot;xsd:string&quot;&quot;
use=&quot;&quot;required&quot;&quot;/&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;xsd:attribute name=&quot;&quot;type&quot;&quot; type=&quot;&quot;xsd:string&quot;&quot;
use=&quot;&quot;required&quot;&quot;/&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/xsd:complexType&gt; 
&lt;/xsd:schema&gt; 
&quot;; 

&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; private const string schema2 = @&quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot;
encoding=&quot;&quot;utf-8&quot;&quot; ?&gt; 
&lt;xsd:schema id=&quot;&quot;Sub.Schema&quot;&quot; elementFormDefault=&quot;&quot;qualified&quot;&quot;
xmlns:xsd=&quot;&quot;<A HREF="http://www.w3.org/2001/XMLSchema&quot;&quot;">http://www.w3.org/2001/XMLSchema&quot;&quot;</A>&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;xsd:complexType name=&quot;&quot;item&quot;&quot;&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;xsd:complexContent&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;xsd:extension base=&quot;&quot;itemBase&quot;&quot;&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;xsd:attribute name=&quot;&quot;itemName&quot;&quot;
type=&quot;&quot;xsd:string&quot;&quot; use=&quot;&quot;required&quot;&quot;/&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/xsd:extension&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/xsd:complexContent&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/xsd:complexType&gt; 
&lt;/xsd:schema&gt; 
&quot;; 

&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; static void Main(string[] args) 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; { 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; XmlSchemaSet schemas = new XmlSchemaSet(); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; schemas.Add(XmlSchema.Read(new
StringReader(schema1), null)); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; schemas.Add(XmlSchema.Read(new
StringReader(schema2), null)); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; schemas.ValidationEventHandler +=
schemas_ValidationEventHandler; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; schemas.Compile(); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; Console.WriteLine(); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; Console.WriteLine(&quot;Press any key&quot;); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; Console.ReadKey(); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; } 

&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; static void schemas_ValidationEventHandler(object sender,
ValidationEventArgs e) 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; { 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; Console.WriteLine(&quot;Message: {0}&quot;, e.Message); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; Console.WriteLine(&quot;Severity: {0}&quot;, e.Severity); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; Console.WriteLine(&quot;Stack Trace: {0}&quot;,
e.Exception.StackTrace); 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; } 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; } 
} 
-------------------------------------------------- 

As you can see, schema2 attempts to extend a type defined in schema1 but is
unable to see that type when running on mono.

Thanks for any help, 
Kent 

</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030620.html">[Mono-list] Re: Releasing Named Mutexes
</A></li>
	<LI>Next message: <A HREF="030611.html">[Mono-list] XmlSchemaSet Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30610">[ date ]</a>
              <a href="thread.html#30610">[ thread ]</a>
              <a href="subject.html#30610">[ subject ]</a>
              <a href="author.html#30610">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
