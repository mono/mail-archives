<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] System.DllNotFoundException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:martin%40welch.eclipse.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="019488.html">
   <LINK REL="Next"  HREF="019478.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] System.DllNotFoundException
   </H1>
    <B>Martin Welch
    </B> 
    <A HREF="mailto:martin%40welch.eclipse.co.uk"
       TITLE="[Mono-list] System.DllNotFoundException">martin@welch.eclipse.co.uk
       </A><BR>
    <I>Thu, 8 Apr 2004 23:25:35 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="019488.html">[Mono-list] System.DllNotFoundException
</A></li>
        <LI> Next message: <A HREF="019478.html">[Mono-list] ASP.NET from CVS very difficult to use
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19489">[ date ]</a>
              <a href="thread.html#19489">[ thread ]</a>
              <a href="subject.html#19489">[ subject ]</a>
              <a href="author.html#19489">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0011_01C41DC0.CB8DA300
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: 7bit

I'm making progress.

My library foo.so comprises two cpp files that only contain extern &quot;C&quot;
functions.

If i build this library and PInvoke to it everything's ok.

If I then add another cpp file, this time with a class definition and
implementation then I get the System.DllNotFoundException, even if the class
isn't referenced by the extern &quot;C&quot; functions.

Take the cpp file out and it works again.

Is this making sense? What am I doing wrong?

Thanks,

Martin
  -----Original Message-----
  From: <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>
[mailto:<A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>]On Behalf Of Martin Welch
  Sent: 08 April 2004 19:40
  To: Mono-List
  Subject: [Mono-list] System.DllNotFoundException


  I have a simple c# app trying to PInvoke to a shared library on my
Mandrake 10 box using Mono-0.31.

  I assumed that mono would look in the current directory but it seems my
assumption is wrong since the so in question does exist.

  I'm even hardcoding the path in my DllImport attribute:

    [
    DllImport
    (
    &quot;/home/martin/source/foo&quot;,
    EntryPoint=&quot;MyFunc&quot;,
    CharSet=CharSet.Ansi,
    CallingConvention=CallingConvention.Cdecl
    )
    ]
    private static extern IntPtr MyFunc(int v,
[MarshalAs(UnmanagedType.LPArray, ArraySubType=UnmanagedType.LPStr)]
string[] a, string n);

  Please bear in mind that I'm not a very experienced linux user so in all
likelihood I've done something profoundly stupid or overlooked something
really obvious.

  Where does mono look for so's?

  Thanks,

  Martin

------=_NextPart_000_0011_01C41DC0.CB8DA300
Content-Type: text/html;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: quoted-printable

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;
&lt;HTML&gt;&lt;HEAD&gt;
&lt;META http-equiv=3DContent-Type content=3D&quot;text/html; =
charset=3Diso-8859-1&quot;&gt;
&lt;META content=3D&quot;MSHTML 6.00.2800.1400&quot; name=3DGENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN =
class=3D498461922-08042004&gt;I'm=20
making progress.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN =
class=3D498461922-08042004&gt;My=20
library foo.so comprises two cpp files that only contain extern &quot;C&quot;=20
functions.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN =
class=3D498461922-08042004&gt;If i=20
build this library and PInvoke to it everything's =
ok.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN =
class=3D498461922-08042004&gt;If I=20
then add another cpp file, this time with a class definition and =
implementation=20
then I get the System.DllNotFoundException, even if the class isn't =
referenced=20
by the extern &quot;C&quot; functions.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN =
class=3D498461922-08042004&gt;Take=20
the cpp file out and it works again.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN =
class=3D498461922-08042004&gt;Is=20
this making sense? What am I doing wrong?&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;Thanks,&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=3DVerdana color=3D#0000ff size=3D2&gt;&lt;SPAN=20
class=3D498461922-08042004&gt;Martin&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;BLOCKQUOTE dir=3Dltr style=3D&quot;MARGIN-RIGHT: 0px&quot;&gt;
  &lt;DIV class=3DOutlookMessageHeader dir=3Dltr align=3Dleft&gt;&lt;FONT =
face=3DTahoma=20
  size=3D2&gt;-----Original Message-----&lt;BR&gt;&lt;B&gt;From:&lt;/B&gt;=20
  <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>=20
  [mailto:<A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>]&lt;B&gt;On Behalf Of &lt;/B&gt;Martin=20
  Welch&lt;BR&gt;&lt;B&gt;Sent:&lt;/B&gt; 08 April 2004 19:40&lt;BR&gt;&lt;B&gt;To:&lt;/B&gt;=20
  Mono-List&lt;BR&gt;&lt;B&gt;Subject:&lt;/B&gt; [Mono-list]=20
  System.DllNotFoundException&lt;BR&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN class=3D128442718-08042004&gt;I =
have a simple=20
  c# app trying to PInvoke to a shared library on my Mandrake 10 box =
using=20
  Mono-0.31.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN class=3D128442718-08042004&gt;I =
assumed that=20
  mono would look in the current directory but it seems my assumption is =
wrong=20
  since the so in question does exist.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN =
class=3D128442718-08042004&gt;I'm even=20
  hardcoding the path in my DllImport attribute:&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN=20
  =
class=3D128442718-08042004&gt;&amp;nbsp;&amp;nbsp;[&lt;BR&gt;&amp;nbsp;&amp;nbsp;DllImport&lt;BR&gt;&amp;nbs=
p;&amp;nbsp;(&lt;BR&gt;&amp;nbsp;&amp;nbsp;&quot;/home/martin/source/foo&quot;,=20
  &lt;BR&gt;&amp;nbsp;&amp;nbsp;EntryPoint=3D&quot;MyFunc&quot;, =
&lt;BR&gt;&amp;nbsp;&amp;nbsp;CharSet=3DCharSet.Ansi,=20
  =
&lt;BR&gt;&amp;nbsp;&amp;nbsp;CallingConvention=3DCallingConvention.Cdecl&lt;BR&gt;&amp;nbsp;&amp;nbs=
p;)&lt;BR&gt;&amp;nbsp;&amp;nbsp;]&lt;BR&gt;&amp;nbsp;&amp;nbsp;private=20
  static extern IntPtr MyFunc(int v, [MarshalAs(UnmanagedType.LPArray,=20
  ArraySubType=3DUnmanagedType.LPStr)] string[] a, string=20
  n);&lt;BR&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN =
class=3D128442718-08042004&gt;Please bear in=20
  mind that I'm not a very experienced linux user so in all likelihood =
I've done=20
  something profoundly stupid or overlooked something really=20
  obvious.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN =
class=3D128442718-08042004&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;Where does mono look for so's?=20
  &lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN =
class=3D128442718-08042004&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN =
class=3D128442718-08042004&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;Thanks,&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN =
class=3D128442718-08042004&gt;&lt;SPAN=20
  class=3D128442718-08042004&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=3DVerdana size=3D2&gt;&lt;SPAN =
class=3D128442718-08042004&gt;&lt;SPAN=20
  =
class=3D128442718-08042004&gt;Martin&lt;/SPAN&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/SPAN&gt;&lt;/FONT&gt;=
&lt;/BODY&gt;&lt;/HTML&gt;

------=_NextPart_000_0011_01C41DC0.CB8DA300--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="019488.html">[Mono-list] System.DllNotFoundException
</A></li>
	<LI> Next message: <A HREF="019478.html">[Mono-list] ASP.NET from CVS very difficult to use
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19489">[ date ]</a>
              <a href="thread.html#19489">[ thread ]</a>
              <a href="subject.html#19489">[ subject ]</a>
              <a href="author.html#19489">[ author ]</a>
         </LI>
       </UL>
</body></html>
