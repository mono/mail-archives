<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] SgmlReader &quot;There was no XML start tag open&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:atsushi%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="019633.html">
   <LINK REL="Next"  HREF="019641.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] SgmlReader &quot;There was no XML start tag open&quot;
   </H1>
    <B>Atsushi Eno
    </B> 
    <A HREF="mailto:atsushi%40ximian.com"
       TITLE="[Mono-list] SgmlReader &quot;There was no XML start tag open&quot;">atsushi@ximian.com
       </A><BR>
    <I>Tue, 20 Apr 2004 01:22:14 +0900</I>
    <P><UL>
        <LI> Previous message: <A HREF="019633.html">[Mono-list] Use of mailing list for announcements
</A></li>
        <LI> Next message: <A HREF="019641.html">[Mono-list] Regex lockup in 0.31
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19634">[ date ]</a>
              <a href="thread.html#19634">[ thread ]</a>
              <a href="subject.html#19634">[ subject ]</a>
              <a href="author.html#19634">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Morten,

Sorry for the late reply.

I found a bug in SgmlReader.MoveToAttribute(int) that incorrectly
loses the correct location.

Comment out the line 732 of SgmlReader.cs:
           this.node.CurrentState = this.state;//save current state.

(The resetting of CurrentState should only be done in Read().)

I also found why Mono does not allow it. It is because the
implementation detail of XmlWriter.WriteNode(). In Mono, I use
WriteAttributes() to write the attributes of a element. When I
rewrote:

	WriteAttributes (reader, defattr);
	reader.MoveToElement ();

to:

	if (reader.HasAttributes) {
		for (int i = 0; i &lt; reader.AttributeCount; i++) {
			reader.MoveToAttribute (i);
			WriteAttribute (reader, defattr);
		}
		reader.MoveToElement ();
	}

It worked.

So probably MS.NET is implemented as such. I am wondering whether
I had better change the behavior and let developers implement
buggy XmlReader, or leave XmlWriter as is so that developers can
make sure if they can implement correct XmlReader.

Anyways, feel free to report Chris Lovett about this bug.

Thanks,
Atsushi Eno


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="019633.html">[Mono-list] Use of mailing list for announcements
</A></li>
	<LI> Next message: <A HREF="019641.html">[Mono-list] Regex lockup in 0.31
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19634">[ date ]</a>
              <a href="thread.html#19634">[ thread ]</a>
              <a href="subject.html#19634">[ subject ]</a>
              <a href="author.html#19634">[ author ]</a>
         </LI>
       </UL>
</body></html>
