<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mcs.exe problem compiling gtk-sharp
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jaak%40zd.com.pl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016389.html">
   <LINK REL="Next"  HREF="016354.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mcs.exe problem compiling gtk-sharp
   </H1>
    <B>Jaroslaw Kowalski
    </B> 
    <A HREF="mailto:jaak%40zd.com.pl"
       TITLE="[Mono-list] mcs.exe problem compiling gtk-sharp">jaak@zd.com.pl
       </A><BR>
    <I>Mon, 13 Oct 2003 19:55:13 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="016389.html">[Mono-list] RedHat 9 install problem
</A></li>
        <LI> Next message: <A HREF="016354.html">[Mono-list] mcs.exe problem compiling gtk-sharp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16353">[ date ]</a>
              <a href="thread.html#16353">[ thread ]</a>
              <a href="subject.html#16353">[ subject ]</a>
              <a href="author.html#16353">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0035_01C391C3.EABED110
Content-Type: text/plain;
	charset=&quot;iso-8859-2&quot;
Content-Transfer-Encoding: 7bit


I've recently updated mcs from AnonCVS and I have the following problem
compiling CVS gtk-sharp:

&quot;gtk-sharp/parser/gapi-fixup.cs&quot; (as it's quite small, I've attached a copy)

--------------
$ mcs gapi-fixup.cs

** (/opt/mono/bin/mcs.exe:28302): WARNING **: Missing method
DiscardBufferedData in assembly /opt/mono/bin/mcs.exe typeref index 69
System.NullReferenceException: A null value was found where an object
instance was required
in (unmanaged) Mono.CSharp.SeekableStreamReader:set_Position (int)
in &lt;0x0016e&gt; Mono.CSharp.Tokenizer:is_punct (char,bool&amp;)
in &lt;0x00349&gt; Mono.CSharp.Tokenizer:xtoken ()
in &lt;0x00017&gt; Mono.CSharp.Tokenizer:token ()
in &lt;0x002dc&gt; Mono.CSharp.CSharpParser:yyparse (Mono.CSharp.yyParser.yyInput)
in &lt;0x00079&gt; Mono.CSharp.CSharpParser:parse ()

gapi-fixup.cs(72) error CS8025: Parsing error
Compilation failed: 1 error(s), 0 warnings
--------------

The problematic lines are:

 XmlElement node = ((IHasXmlNode)api_iter.Current).GetNode () as XmlElement;
 node.SetAttribute (attr_name, attr_iter.Current.Value);

after I comment them out - it compiles fine but that's obviously not the
solution.

Is it my fault or a bug?

Jarek

------=_NextPart_000_0035_01C391C3.EABED110
Content-Type: text/plain;
	name=&quot;gapi-fixup.cs&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;gapi-fixup.cs&quot;

// GtkSharp.Parsing.gapi-fixup.cs - xml alteration engine.
//
// Author: Mike Kestner &lt;<A HREF="mailto:mkestner@speakeasy.net">mkestner@speakeasy.net</A>&gt;
//
// (c) 2003 Mike Kestner

namespace GtkSharp.Parsing {

	using System;
	using System.IO;
	using System.Xml;
	using System.Xml.XPath;

	public class Fixup  {

		public static int Main (string[] args)
		{
			if (args.Length !=3D 2) {
				Console.WriteLine (&quot;Usage: gapi-fixup --metadata=3D&lt;filename&gt; =
--api=3D&lt;filename&gt;&quot;);
				return 0;
			}

			string api_filename =3D &quot;&quot;;
			XmlDocument api_doc =3D new XmlDocument ();
			XmlDocument meta_doc =3D new XmlDocument ();

			foreach (string arg in args) {

				if (arg.StartsWith(&quot;--metadata=3D&quot;)) {

					string meta_filename =3D arg.Substring (11);

					try {
						Stream stream =3D File.OpenRead (meta_filename);
						meta_doc.Load (stream);
						stream.Close ();
					} catch (XmlException e) {
						Console.WriteLine (&quot;Invalid meta file.&quot;);
						Console.WriteLine (e);
						return 1;
					}

				} else if (arg.StartsWith (&quot;--api=3D&quot;)) {

					api_filename =3D arg.Substring (6);

					try {
						Stream stream =3D File.OpenRead (api_filename);
						api_doc.Load (stream);
						stream.Close ();
					} catch (XmlException e) {
						Console.WriteLine (&quot;Invalid api file.&quot;);
						Console.WriteLine (e);
						return 1;
					}

				} else {
					Console.WriteLine (&quot;Usage: gapi-fixup --metadata=3D&lt;filename&gt; =
--api=3D&lt;filename&gt;&quot;);
					return 1;
				}
			}

			XPathNavigator meta_nav =3D meta_doc.CreateNavigator ();
			XPathNavigator api_nav =3D api_doc.CreateNavigator ();

			XPathNodeIterator attr_iter =3D meta_nav.Select (&quot;//attr&quot;);
			while (attr_iter.MoveNext ()) {
				string path =3D attr_iter.Current.GetAttribute (&quot;path&quot;, &quot;&quot;);
				string attr_name =3D attr_iter.Current.GetAttribute (&quot;name&quot;, &quot;&quot;);
				XPathNodeIterator api_iter =3D api_nav.Select (path);
				while (api_iter.MoveNext ()) {
					XmlElement node =3D ((IHasXmlNode)api_iter.Current).GetNode() as =
XmlElement;
					node.SetAttribute (attr_name, attr_iter.Current.Value);
				}
			}

			Stream out_stream =3D File.OpenWrite (api_filename);
			api_doc.Save (out_stream);
			out_stream.Close ();
			return 0;
		}
	}
}

------=_NextPart_000_0035_01C391C3.EABED110--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016389.html">[Mono-list] RedHat 9 install problem
</A></li>
	<LI> Next message: <A HREF="016354.html">[Mono-list] mcs.exe problem compiling gtk-sharp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16353">[ date ]</a>
              <a href="thread.html#16353">[ thread ]</a>
              <a href="subject.html#16353">[ subject ]</a>
              <a href="author.html#16353">[ author ]</a>
         </LI>
       </UL>
</body></html>
