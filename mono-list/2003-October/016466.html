<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ASP.NET: DataGrid bug !?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tiago.lima%40vianw.pt">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016467.html">
   <LINK REL="Next"  HREF="016468.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ASP.NET: DataGrid bug !?
   </H1>
    <B>Tiago Lima
    </B> 
    <A HREF="mailto:tiago.lima%40vianw.pt"
       TITLE="[Mono-list] ASP.NET: DataGrid bug !?">tiago.lima@vianw.pt
       </A><BR>
    <I>Thu, 16 Oct 2003 16:19:32 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="016467.html">[Mono-list] ASP.NET: XSP Segmentation Fault with TEXTAREA web
 control
</A></li>
        <LI> Next message: <A HREF="016468.html">[Mono-list] ASP.NET: DataGrid bug !?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16466">[ date ]</a>
              <a href="thread.html#16466">[ thread ]</a>
              <a href="subject.html#16466">[ subject ]</a>
              <a href="author.html#16466">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0203_01C39401.4806CFF0
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: 7bit

Hi again,

Mono, I have a problem. :)

It appears that the DataGrid control doesn't do &quot;paging&quot; (or custom paging)
I guess...
Maybe I am doing something wrong, but can you check this ? perhaps in cvs is
corrected, no?
When clicking the &quot;table page number&quot; on the bottom of the datagrid table it
doesn't change the &quot;table page&quot; to the selected one...

In Suse8.2:
Using all latest RPMs!! NOT from cvs !!
    # mono --version
    Mono JIT compiler version 0.28, (C) 2002, 2003 Ximian, Inc.

    # mcs --version
    Mono C# compiler version 0.27.0.0

    XSP-0.6

Thanks in advance,
    Tiago Lima

------=_NextPart_000_0203_01C39401.4806CFF0
Content-Type: application/octet-stream;
	name=&quot;DataGridTest.aspx&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;DataGridTest.aspx&quot;

&lt;%@ Page Language=3D&quot;C#&quot; CodeBehind=3D&quot;DataGridTest.ascx.cs&quot; =
Inherits=3D&quot;DataGridTests.DataGridTester&quot; %&gt;

&lt;form method=3D&quot;post&quot; runat=3D&quot;server&quot;&gt;
	&lt;asp:DataGrid id=3D&quot;_dataGrid&quot;
				  AutoGenerateColumns=3D&quot;false&quot;
				  GridLines=3D&quot;Both&quot;
				  ShowHeader=3D&quot;true&quot;
				  BorderWidth=3D&quot;1px&quot;
				  PageSize=3D&quot;5&quot;
				  AllowPaging=3D&quot;True&quot;
				  AllowCustomPaging=3D&quot;True&quot;
				  CellPadding=3D&quot;3&quot;
				  runat=3D&quot;server&quot;&gt;
	=09
		&lt;HeaderStyle HorizontalAlign=3D&quot;Center&quot; BackColor=3D&quot;#dddddd&quot;&gt;
	    &lt;/HeaderStyle&gt;
	=09
		&lt;PagerStyle Mode=3D&quot;NumericPages&quot;
					HorizontalAlign=3D&quot;Right&quot;&gt;
		&lt;/PagerStyle&gt;
	=09
		&lt;Columns&gt;
			&lt;asp:BoundColumn DataField=3D&quot;ID&quot; Visible=3D&quot;false&quot; /&gt;
			&lt;asp:ButtonColumn ButtonType=3D&quot;PushButton&quot; CommandName=3D&quot;add&quot; =
HeaderText=3D&quot;Action&quot; Text=3D&quot;Add&quot; /&gt;
		&lt;/Columns&gt;
	=09
	&lt;/asp:DataGrid&gt;
&lt;/form&gt;

------=_NextPart_000_0203_01C39401.4806CFF0
Content-Type: application/octet-stream;
	name=&quot;DataGridTest.aspx.cs&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;DataGridTest.aspx.cs&quot;


using Npgsql;

using System;
using System.Data;
using System.Web.UI;
using System.Collections;
using System.Web.UI.WebControls;

namespace DataGridTests
{
	public class DataGridTester : Page
	{
		protected DataGrid _newsResourcesGrid;
	=09
		protected DataGrid _dataGrid;
		protected Image _image;
	=09
		protected long _intStartIndex;
		protected long _intEndIndex;
	=09
		private void Page_Load(object sender, EventArgs args)
		{
			if(!IsPostBack)
			{
				_dataGrid.VirtualItemCount =3D 12;
				BindDataGrid();
			}
		=09
			_dataGrid.ItemCommand +=3D new =
DataGridCommandEventHandler(OnItemCommand);
			_dataGrid.PageIndexChanged +=3D new =
DataGridPageChangedEventHandler(OnPageIndexChanged);
		}
		private void OnPageIndexChanged(object sender, =
DataGridPageChangedEventArgs args)
		{
			// Changes the page.
			_intStartIndex =3D (args.NewPageIndex * _dataGrid.PageSize);
			_dataGrid.CurrentPageIndex =3D args.NewPageIndex;
			BindDataGrid();
		}
		private void BindDataGrid()
		{
			_intEndIndex =3D _intStartIndex + _dataGrid.PageSize;
			NpgsqlConnection local =3D GetLocalConnection();
			local.Open();
		=09
			Npgsql.NpgsqlCommand command =3D new Npgsql.NpgsqlCommand(
				&quot;SELECT ID, IDTipo, descricao, recurso &quot; +
				&quot;FROM RecursoMultimedia &quot; +
				&quot;WHERE (ID &gt; :startIndex) AND (ID &lt;=3D :endIndex) &quot; +
				&quot;ORDER BY ID&quot;,
				local);
		=09
			NpgsqlParameter param1 =3D new NpgsqlParameter(&quot;startIndex&quot;, =
System.Data.DbType.Int64);
			param1.Value =3D _intStartIndex;
			NpgsqlParameter param2 =3D new NpgsqlParameter(&quot;endIndex&quot;, =
System.Data.DbType.Int64);
			param2.Value =3D _intEndIndex;
		=09
			command.Parameters.Add(param1);
			command.Parameters.Add(param2);
		=09
			NpgsqlDataAdapter adapter =3D new NpgsqlDataAdapter(command);
			DataSet dataSet =3D new DataSet();
			adapter.Fill(dataSet);
		=09
			_dataGrid.DataSource =3D dataSet;
			_dataGrid.DataBind();
		}
		private void OnItemCommand(object sender, DataGridCommandEventArgs e)
		{
			if (e.CommandName =3D=3D &quot;add&quot;)
			{
				DataGridItem item =3D e.Item;
				string id =3D item.Cells[0].Text;
				Controls.Add(new LiteralControl(&quot;ID =3D &quot; + id));
			}
		}
		private NpgsqlConnection GetLocalConnection()
		{
			return new NpgsqlConnection(&quot;Server=3D192.168.8.6;Port=3D5432;User =
Id=3Duser;Password=3D;Database=3Ddatabase;&quot;);
		}
	}
}

------=_NextPart_000_0203_01C39401.4806CFF0--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016467.html">[Mono-list] ASP.NET: XSP Segmentation Fault with TEXTAREA web
 control
</A></li>
	<LI> Next message: <A HREF="016468.html">[Mono-list] ASP.NET: DataGrid bug !?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16466">[ date ]</a>
              <a href="thread.html#16466">[ thread ]</a>
              <a href="subject.html#16466">[ subject ]</a>
              <a href="author.html#16466">[ author ]</a>
         </LI>
       </UL>
</body></html>
