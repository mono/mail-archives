<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Script Locations of WebUIValidation.js, SmartNav.js
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gvaish%40adobe.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016266.html">
   <LINK REL="Next"  HREF="016206.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Script Locations of WebUIValidation.js, SmartNav.js
   </H1>
    <B>Gaurav Vaish
    </B> 
    <A HREF="mailto:gvaish%40adobe.com"
       TITLE="[Mono-list] Script Locations of WebUIValidation.js, SmartNav.js">gvaish@adobe.com
       </A><BR>
    <I>Thu, 09 Oct 2003 11:03:53 +0530</I>
    <P><UL>
        <LI> Previous message: <A HREF="016266.html">[Mono-list] Surveys: Mono 1.0 and Mono Conference.
</A></li>
        <LI> Next message: <A HREF="016206.html">[Mono-list] Script Locations of WebUIValidation.js, SmartNav.js
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16205">[ date ]</a>
              <a href="thread.html#16205">[ thread ]</a>
              <a href="subject.html#16205">[ subject ]</a>
              <a href="author.html#16205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

--Boundary_(ID_NjPBUP0BsVTvcGDepWXTxw)
Content-type: text/plain; charset=iso-8859-1
Content-transfer-encoding: 7BIT

Hi,

    In the method
System.Web.UI.WebControls.BaseValidator::RegisterValidatorCommonScript()

    I need information about the location of the WebUIValidator.js file kept
in system_web subdirectories when ASP.Net is registered using
aspnet_regiis.exe (-i option).

    Now, there can be many versions of the ASP.Net installed and hence many
JS files - as I can see three such locations on my computer corresponding to
1.0.3755..0, 1.0.3705.288 and 1.1.4322.

    I get this information from a method in class
System.Web.UI.Utils::GetScriptLocation(HttpContext) - but at the final
implementation point, I don't have the exact version information.

===&gt;    How do I get this information of the version number?
===&gt;    More precisely, the location of the JS script file.

    For IIS / .Net, it's installed in
&lt;WWWROOT&gt;/aspnet_client/system_web/&lt;version&gt;/
        where &lt;WWWROOT&gt; generally corresponds to &quot;C:\Inetpub\wwwroot&quot;

    but for other implementations like on Apache (mod_mono) / XSP, the
installation path may differ or -- Gonazlo, are you using the same path for
the js file? The attachment contains this file... for 1.1.4322.


Cheers,
Gaurav
<A HREF="http://gvaish.virtualave.net">http://gvaish.virtualave.net</A>
--------------------------------

    [MonoTODO]
    internal static string GetScriptLocation(HttpContext context)
    {
        IDictionary dict = context.GetConfig(&quot;system.web/webControls&quot;);
        string loc = null;
        if(dict != null)
        {
            loc = dict[&quot;clientScriptsLocation&quot;] as string;
        }
        if(loc == null)
        {
            throw new HttpException(&quot;Missing_clientScriptsLocation&quot;);
        }
        if(loc.IndexOf(&quot;{0}&quot;) &gt; 0)
        {
            //FIXME: Version Number of the ASP.Net should come into play.
            //Like if ASP 1.0 and 1.1 both are installed, the script
            // locations are in /aspnet_client/system_web/1_0_3705_0/
            // and /aspnet_client/system_web/1_1_4322/
            // (these entries are from my machine
            // So, first I should get this Version Info from somewhere
            loc = String.Format(loc, &quot;system_web&quot;);
        }
        return loc;
    }


--Boundary_(ID_NjPBUP0BsVTvcGDepWXTxw)
Content-type: application/x-javascript; name=WebUIValidation.js
Content-transfer-encoding: quoted-printable
Content-disposition: attachment; filename=WebUIValidation.js

var Page_ValidationVer =3D &quot;125&quot;;
var Page_IsValid =3D true;
var Page_BlockSubmit =3D false;
function ValidatorUpdateDisplay(val) {
    if (typeof(val.display) =3D=3D &quot;string&quot;) {   =20
        if (val.display =3D=3D &quot;None&quot;) {
            return;
        }
        if (val.display =3D=3D &quot;Dynamic&quot;) {
            val.style.display =3D val.isvalid ? &quot;none&quot; : &quot;inline&quot;;
            return;
        }
    }
    val.style.visibility =3D val.isvalid ? &quot;hidden&quot; : &quot;visible&quot;;
}
function ValidatorUpdateIsValid() {
    var i;
    for (i =3D 0; i &lt; Page_Validators.length; i++) {
        if (!Page_Validators[i].isvalid) {
            Page_IsValid =3D false;
            return;
        }
   }
   Page_IsValid =3D true;
}
function ValidatorHookupControlID(controlID, val) {
    if (typeof(controlID) !=3D &quot;string&quot;) {
        return;
    }
    var ctrl =3D document.all[controlID];
    if (typeof(ctrl) !=3D &quot;undefined&quot;) {
        ValidatorHookupControl(ctrl, val);
    }
    else {
        val.isvalid =3D true;
        val.enabled =3D false;
    }
}
function ValidatorHookupControl(control, val) {
    if (typeof(control.tagName) =3D=3D &quot;undefined&quot; &amp;&amp; =
typeof(control.length) =3D=3D &quot;number&quot;) {
        var i;
        for (i =3D 0; i &lt; control.length; i++) {
            var inner =3D control[i];
            if (typeof(inner.value) =3D=3D &quot;string&quot;) {
                ValidatorHookupControl(inner, val);
            }=20
        }
        return;
    }
    else if (control.tagName !=3D &quot;INPUT&quot; &amp;&amp; control.tagName !=3D =
&quot;TEXTAREA&quot; &amp;&amp; control.tagName !=3D &quot;SELECT&quot;) {
        var i;
        for (i =3D 0; i &lt; control.children.length; i++) {
            ValidatorHookupControl(control.children[i], val);
        }
        return;
    }
    else {
        if (typeof(control.Validators) =3D=3D &quot;undefined&quot;) {
            control.Validators =3D new Array;
            var ev;
            if (control.type =3D=3D &quot;radio&quot;) {
                ev =3D control.onclick;
            } else {
                ev =3D control.onchange;
            }
            if (typeof(ev) =3D=3D &quot;function&quot; ) {           =20
                ev =3D ev.toString();
                ev =3D ev.substring(ev.indexOf(&quot;{&quot;) + 1, =
ev.lastIndexOf(&quot;}&quot;));
            }
            else {
                ev =3D &quot;&quot;;
            }
            var func =3D new Function(&quot;ValidatorOnChange(); &quot; + ev);
            if (control.type =3D=3D &quot;radio&quot;) {
                control.onclick =3D func;
            } else {           =20
                control.onchange =3D func;
            }
        }
        control.Validators[control.Validators.length] =3D val;
    }   =20
}
function ValidatorGetValue(id) {
    var control;
    control =3D document.all[id];
    if (typeof(control.value) =3D=3D &quot;string&quot;) {
        return control.value;
    }
    if (typeof(control.tagName) =3D=3D &quot;undefined&quot; &amp;&amp; =
typeof(control.length) =3D=3D &quot;number&quot;) {
        var j;
        for (j=3D0; j &lt; control.length; j++) {
            var inner =3D control[j];
            if (typeof(inner.value) =3D=3D &quot;string&quot; &amp;&amp; (inner.type !=3D =
&quot;radio&quot; || inner.status =3D=3D true)) {
                return inner.value;
            }
        }
    }
    else {
        return ValidatorGetValueRecursive(control);
    }
    return &quot;&quot;;
}
function ValidatorGetValueRecursive(control)
{
    if (typeof(control.value) =3D=3D &quot;string&quot; &amp;&amp; (control.type !=3D =
&quot;radio&quot; || control.status =3D=3D true)) {
        return control.value;
    }
    var i, val;
    for (i =3D 0; i&lt;control.children.length; i++) {
        val =3D ValidatorGetValueRecursive(control.children[i]);
        if (val !=3D &quot;&quot;) return val;
    }
    return &quot;&quot;;
}
function Page_ClientValidate() {
    var i;
    for (i =3D 0; i &lt; Page_Validators.length; i++) {
        ValidatorValidate(Page_Validators[i]);
    }
    ValidatorUpdateIsValid();   =20
    ValidationSummaryOnSubmit();
    Page_BlockSubmit =3D !Page_IsValid;
    return Page_IsValid;
}
function ValidatorCommonOnSubmit() {
    event.returnValue =3D !Page_BlockSubmit;
    Page_BlockSubmit =3D false;
}
function ValidatorEnable(val, enable) {
    val.enabled =3D (enable !=3D false);
    ValidatorValidate(val);
    ValidatorUpdateIsValid();
}
function ValidatorOnChange() {
    var vals =3D event.srcElement.Validators;
    var i;
    for (i =3D 0; i &lt; vals.length; i++) {
        ValidatorValidate(vals[i]);
    }
    ValidatorUpdateIsValid();   =20
}
function ValidatorValidate(val) {   =20
    val.isvalid =3D true;
    if (val.enabled !=3D false) {
        if (typeof(val.evaluationfunction) =3D=3D &quot;function&quot;) {
            val.isvalid =3D val.evaluationfunction(val);=20
        }
    }
    ValidatorUpdateDisplay(val);
}
function ValidatorOnLoad() {
    if (typeof(Page_Validators) =3D=3D &quot;undefined&quot;)
        return;
    var i, val;
    for (i =3D 0; i &lt; Page_Validators.length; i++) {
        val =3D Page_Validators[i];
        if (typeof(val.evaluationfunction) =3D=3D &quot;string&quot;) {
            eval(&quot;val.evaluationfunction =3D &quot; + val.evaluationfunction =
+ &quot;;&quot;);
        }
        if (typeof(val.isvalid) =3D=3D &quot;string&quot;) {
            if (val.isvalid =3D=3D &quot;False&quot;) {
                val.isvalid =3D false;                               =20
                Page_IsValid =3D false;
            }=20
            else {
                val.isvalid =3D true;
            }
        } else {
            val.isvalid =3D true;
        }
        if (typeof(val.enabled) =3D=3D &quot;string&quot;) {
            val.enabled =3D (val.enabled !=3D &quot;False&quot;);
        }
        ValidatorHookupControlID(val.controltovalidate, val);
        ValidatorHookupControlID(val.controlhookup, val);
    }
    Page_ValidationActive =3D true;
}
function ValidatorConvert(op, dataType, val) {
    function GetFullYear(year) {
        return (year + parseInt(val.century)) - ((year &lt; val.cutoffyear) =
? 0 : 100);
    }
    var num, cleanInput, m, exp;
    if (dataType =3D=3D &quot;Integer&quot;) {
        exp =3D /^\s*[-\+]?\d+\s*$/;
        if (op.match(exp) =3D=3D null)=20
            return null;
        num =3D parseInt(op, 10);
        return (isNaN(num) ? null : num);
    }
    else if(dataType =3D=3D &quot;Double&quot;) {
        exp =3D new RegExp(&quot;^\\s*([-\\+])?(\\d+)?(\\&quot; + val.decimalchar =
+ &quot;(\\d+))?\\s*$&quot;);
        m =3D op.match(exp);
        if (m =3D=3D null)
            return null;
        cleanInput =3D m[1] + (m[2].length&gt;0 ? m[2] : &quot;0&quot;) + &quot;.&quot; + m[4];
        num =3D parseFloat(cleanInput);
        return (isNaN(num) ? null : num);           =20
    }=20
    else if (dataType =3D=3D &quot;Currency&quot;) {
        exp =3D new RegExp(&quot;^\\s*([-\\+])?(((\\d+)\\&quot; + val.groupchar + =
&quot;)*)(\\d+)&quot;
                        + ((val.digits &gt; 0) ? &quot;(\\&quot; + val.decimalchar + =
&quot;(\\d{1,&quot; + val.digits + &quot;}))?&quot; : &quot;&quot;)
                        + &quot;\\s*$&quot;);
        m =3D op.match(exp);
        if (m =3D=3D null)
            return null;
        var intermed =3D m[2] + m[5] ;
        cleanInput =3D m[1] + intermed.replace(new RegExp(&quot;(\\&quot; + =
val.groupchar + &quot;)&quot;, &quot;g&quot;), &quot;&quot;) + ((val.digits &gt; 0) ? &quot;.&quot; + m[7] : 0);
        num =3D parseFloat(cleanInput);
        return (isNaN(num) ? null : num);           =20
    }
    else if (dataType =3D=3D &quot;Date&quot;) {
        var yearFirstExp =3D new =
RegExp(&quot;^\\s*((\\d{4})|(\\d{2}))([-./])(\\d{1,2})\\4(\\d{1,2})\\s*$&quot;);
        m =3D op.match(yearFirstExp);
        var day, month, year;
        if (m !=3D null &amp;&amp; (m[2].length =3D=3D 4 || val.dateorder =3D=3D =
&quot;ymd&quot;)) {
            day =3D m[6];
            month =3D m[5];
            year =3D (m[2].length =3D=3D 4) ? m[2] : =
GetFullYear(parseInt(m[3], 10))
        }
        else {
            if (val.dateorder =3D=3D &quot;ymd&quot;){
                return null;	=09
            }					=09
            var yearLastExp =3D new =
RegExp(&quot;^\\s*(\\d{1,2})([-./])(\\d{1,2})\\2((\\d{4})|(\\d{2}))\\s*$&quot;);
            m =3D op.match(yearLastExp);
            if (m =3D=3D null) {
                return null;
            }
            if (val.dateorder =3D=3D &quot;mdy&quot;) {
                day =3D m[3];
                month =3D m[1];
            }
            else {
                day =3D m[1];
                month =3D m[3];
            }
            year =3D (m[5].length =3D=3D 4) ? m[5] : =
GetFullYear(parseInt(m[6], 10))
        }
        month -=3D 1;
        var date =3D new Date(year, month, day);
        return (typeof(date) =3D=3D &quot;object&quot; &amp;&amp; year =3D=3D =
date.getFullYear() &amp;&amp; month =3D=3D date.getMonth() &amp;&amp; day =3D=3D =
date.getDate()) ? date.valueOf() : null;
    }
    else {
        return op.toString();
    }
}
function ValidatorCompare(operand1, operand2, operator, val) {
    var dataType =3D val.type;
    var op1, op2;
    if ((op1 =3D ValidatorConvert(operand1, dataType, val)) =3D=3D null)
        return false;   =20
    if (operator =3D=3D &quot;DataTypeCheck&quot;)
        return true;
    if ((op2 =3D ValidatorConvert(operand2, dataType, val)) =3D=3D null)
        return true;
    switch (operator) {
        case &quot;NotEqual&quot;:
            return (op1 !=3D op2);
        case &quot;GreaterThan&quot;:
            return (op1 &gt; op2);
        case &quot;GreaterThanEqual&quot;:
            return (op1 &gt;=3D op2);
        case &quot;LessThan&quot;:
            return (op1 &lt; op2);
        case &quot;LessThanEqual&quot;:
            return (op1 &lt;=3D op2);
        default:
            return (op1 =3D=3D op2);           =20
    }
}
function CompareValidatorEvaluateIsValid(val) {
    var value =3D ValidatorGetValue(val.controltovalidate);
    if (ValidatorTrim(value).length =3D=3D 0)
        return true;
    var compareTo =3D &quot;&quot;;
    if (null =3D=3D document.all[val.controltocompare]) {
        if (typeof(val.valuetocompare) =3D=3D &quot;string&quot;) {
            compareTo =3D val.valuetocompare;
        }
    }
    else {
        compareTo =3D ValidatorGetValue(val.controltocompare);
    }
    return ValidatorCompare(value, compareTo, val.operator, val);
}
function CustomValidatorEvaluateIsValid(val) {
    var value =3D &quot;&quot;;
    if (typeof(val.controltovalidate) =3D=3D &quot;string&quot;) {
        value =3D ValidatorGetValue(val.controltovalidate);
        if (ValidatorTrim(value).length =3D=3D 0)
            return true;
    }
    var args =3D { Value:value, IsValid:true };
    if (typeof(val.clientvalidationfunction) =3D=3D &quot;string&quot;) {
        eval(val.clientvalidationfunction + &quot;(val, args) ;&quot;);
    }       =20
    return args.IsValid;
}
function RegularExpressionValidatorEvaluateIsValid(val) {
    var value =3D ValidatorGetValue(val.controltovalidate);
    if (ValidatorTrim(value).length =3D=3D 0)
        return true;       =20
    var rx =3D new RegExp(val.validationexpression);
    var matches =3D rx.exec(value);
    return (matches !=3D null &amp;&amp; value =3D=3D matches[0]);
}
function ValidatorTrim(s) {
    var m =3D s.match(/^\s*(\S+(\s+\S+)*)\s*$/);
    return (m =3D=3D null) ? &quot;&quot; : m[1];
}
function RequiredFieldValidatorEvaluateIsValid(val) {
    return (ValidatorTrim(ValidatorGetValue(val.controltovalidate)) !=3D =
ValidatorTrim(val.initialvalue))
}
function RangeValidatorEvaluateIsValid(val) {
    var value =3D ValidatorGetValue(val.controltovalidate);
    if (ValidatorTrim(value).length =3D=3D 0)=20
        return true;
    return (ValidatorCompare(value, val.minimumvalue, =
&quot;GreaterThanEqual&quot;, val) &amp;&amp;
            ValidatorCompare(value, val.maximumvalue, &quot;LessThanEqual&quot;, =
val));
}
function ValidationSummaryOnSubmit() {
    if (typeof(Page_ValidationSummaries) =3D=3D &quot;undefined&quot;)=20
        return;
    var summary, sums, s;
    for (sums =3D 0; sums &lt; Page_ValidationSummaries.length; sums++) {
        summary =3D Page_ValidationSummaries[sums];
        summary.style.display =3D &quot;none&quot;;
        if (!Page_IsValid) {
            if (summary.showsummary !=3D &quot;False&quot;) {
                summary.style.display =3D &quot;&quot;;
                if (typeof(summary.displaymode) !=3D &quot;string&quot;) {
                    summary.displaymode =3D &quot;BulletList&quot;;
                }
                switch (summary.displaymode) {
                    case &quot;List&quot;:
                        headerSep =3D &quot;&lt;br&gt;&quot;;
                        first =3D &quot;&quot;;
                        pre =3D &quot;&quot;;
                        post =3D &quot;&lt;br&gt;&quot;;
                        final =3D &quot;&quot;;
                        break;
                    case &quot;BulletList&quot;:
                    default:=20
                        headerSep =3D &quot;&quot;;
                        first =3D &quot;&lt;ul&gt;&quot;;
                        pre =3D &quot;&lt;li&gt;&quot;;
                        post =3D &quot;&lt;/li&gt;&quot;;
                        final =3D &quot;&lt;/ul&gt;&quot;;
                        break;
                    case &quot;SingleParagraph&quot;:
                        headerSep =3D &quot; &quot;;
                        first =3D &quot;&quot;;
                        pre =3D &quot;&quot;;
                        post =3D &quot; &quot;;
                        final =3D &quot;&lt;br&gt;&quot;;
                        break;
                }
                s =3D &quot;&quot;;
                if (typeof(summary.headertext) =3D=3D &quot;string&quot;) {
                    s +=3D summary.headertext + headerSep;
                }
                s +=3D first;
                for (i=3D0; i&lt;Page_Validators.length; i++) {
                    if (!Page_Validators[i].isvalid &amp;&amp; =
typeof(Page_Validators[i].errormessage) =3D=3D &quot;string&quot;) {
                        s +=3D pre + Page_Validators[i].errormessage + =
post;
                    }
                }  =20
                s +=3D final;
                summary.innerHTML =3D s;=20
                window.scrollTo(0,0);
            }
            if (summary.showmessagebox =3D=3D &quot;True&quot;) {
                s =3D &quot;&quot;;
                if (typeof(summary.headertext) =3D=3D &quot;string&quot;) {
                    s +=3D summary.headertext + &quot;&lt;BR&gt;&quot;;
                }
                for (i=3D0; i&lt;Page_Validators.length; i++) {
                    if (!Page_Validators[i].isvalid &amp;&amp; =
typeof(Page_Validators[i].errormessage) =3D=3D &quot;string&quot;) {
                        switch (summary.displaymode) {
                            case &quot;List&quot;:
                                s +=3D Page_Validators[i].errormessage + =
&quot;&lt;BR&gt;&quot;;
                                break;
                            case &quot;BulletList&quot;:
                            default:=20
                                s +=3D &quot;  - &quot; + =
Page_Validators[i].errormessage + &quot;&lt;BR&gt;&quot;;
                                break;
                            case &quot;SingleParagraph&quot;:
                                s +=3D Page_Validators[i].errormessage + =
&quot; &quot;;
                                break;
                        }
                    }
                }
                span =3D document.createElement(&quot;SPAN&quot;);
                span.innerHTML =3D s;
                s =3D span.innerText;
                alert(s);
            }
        }
    }
}

--Boundary_(ID_NjPBUP0BsVTvcGDepWXTxw)--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016266.html">[Mono-list] Surveys: Mono 1.0 and Mono Conference.
</A></li>
	<LI> Next message: <A HREF="016206.html">[Mono-list] Script Locations of WebUIValidation.js, SmartNav.js
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16205">[ date ]</a>
              <a href="thread.html#16205">[ thread ]</a>
              <a href="subject.html#16205">[ subject ]</a>
              <a href="author.html#16205">[ author ]</a>
         </LI>
       </UL>
</body></html>
