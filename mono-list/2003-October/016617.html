<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Confused!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jonpryor%40vt.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016615.html">
   <LINK REL="Next"  HREF="016618.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Confused!
   </H1>
    <B>Jonathan Pryor
    </B> 
    <A HREF="mailto:jonpryor%40vt.edu"
       TITLE="[Mono-list] Confused!">jonpryor@vt.edu
       </A><BR>
    <I>Tue, 28 Oct 2003 22:08:36 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="016615.html">[Mono-list] Confused!
</A></li>
        <LI> Next message: <A HREF="016618.html">[Mono-list] RE: [Gtk-sharp-list] Gtk# 0.12 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16617">[ date ]</a>
              <a href="thread.html#16617">[ thread ]</a>
              <a href="subject.html#16617">[ subject ]</a>
              <a href="author.html#16617">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It's magic. :-)

CIL (.NET) executables use the &quot;standard&quot; PE (Portable Executable)
format that the rest of Windows uses.

To ensure that you can start a CIL program &quot;normally&quot; (for Windows
users), a trick is played.  The .EXE has an dependency on another
library (not a managed assembly, but a normal Windows DLL installed in
%WINDIR%\system32), and sets the program entry-point into a function
exported by this DLL (CorExeMain, or something).

The end result is that (again, on Windows) the OS loads the EXE, loads
all dependent libraries, which (indirectly) loads the .NET runtime, and
the .NET runtime takes over the process and starts JITing/executing the
CIL code.

In essence, the &quot;portable&quot; .EXE/.DLL format has some native X86 code to
ensure it works &quot;right&quot; on Windows.  Other platforms can (and do!)
easily ignore it.

Why's an MCS-generated program execute when Mono isn't installed? 
Because MCS generates programs with the same file header, so that they
can be executed under .NET.

The only way to keep from executing a program is to un-install both Mono
and .NET.

 - Jon

On Tue, 2003-10-28 at 17:50, Richard Thombs wrote:
&gt;<i> Well I thought of that, and although I still have it installed, it's
</I>&gt;<i> not mentioned in any of the environment variables like PATH etc.
</I>&gt;<i>  
</I>&gt;<i> Are the executables built using Microsoft's CSC somehow aware of the
</I>&gt;<i> path to Microsoft's mscorlib.dll?
</I>&gt;<i>  
</I>&gt;<i> R
</I>&gt;<i>         -----Original Message-----
</I>&gt;<i>         From: John BouAntoun [mailto:<A HREF="mailto:jbouantoun@rogen.com.au">jbouantoun@rogen.com.au</A>] 
</I>&gt;<i>         Sent: Tuesday, October 28, 2003 2:36 PM
</I>&gt;<i>         To: Richard Thombs; <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>
</I>&gt;<i>         Subject: RE: [Mono-list] Confused!
</I>&gt;<i>         
</I>&gt;<i>         
</I>&gt;<i>         Are you sure that you can uninstall the MS.Net framework after
</I>&gt;<i>         it's been installed?
</I>&gt;<i>          
</I>&gt;<i>         Doesn't it become part of windows?
</I>&gt;<i>                 -----Original Message-----
</I>&gt;<i>                 From: Richard Thombs [mailto:<A HREF="mailto:mono@stony.org">mono@stony.org</A>]
</I>&gt;<i>                 Sent: Wednesday, 29 October 2003 9:27 AM
</I>&gt;<i>                 To: <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>
</I>&gt;<i>                 Subject: [Mono-list] Confused!
</I>&gt;<i>                 
</I>&gt;<i>                 
</I>&gt;<i>                 I just built the mono and mcs trees from scratch under
</I>&gt;<i>                 cygwin. Initially I was having all trouble getting
</I>&gt;<i>                 some stuff to compile because I didn't have any
</I>&gt;<i>                 corlib.dll whatsoever. I solved that by using the .NET
</I>&gt;<i>                 SDK to compile and install it, so I should be happy,
</I>&gt;<i>                 right?
</I>&gt;<i>                  
</I>&gt;<i>                 Well nearly - while trying to repeat the entire build
</I>&gt;<i>                 process so that I can document it, I found that
</I>&gt;<i>                 despite removing every corlib.dll I can find, things
</I>&gt;<i>                 like 'mcs' are still able to execute. I'm confused
</I>&gt;<i>                 because I was expecting to get a missing library
</I>&gt;<i>                 error! I've even gone as far as rebooting so I can be
</I>&gt;<i>                 sure Cygwin isn't caching the DLL in some weird way.
</I>&gt;<i>                  
</I>&gt;<i>                 Am I being stupid or what? Did I imagine the initial
</I>&gt;<i>                 &quot;Can't find corlib.dll&quot; errors or what?
</I>&gt;<i>                  
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016615.html">[Mono-list] Confused!
</A></li>
	<LI> Next message: <A HREF="016618.html">[Mono-list] RE: [Gtk-sharp-list] Gtk# 0.12 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16617">[ date ]</a>
              <a href="thread.html#16617">[ thread ]</a>
              <a href="subject.html#16617">[ subject ]</a>
              <a href="author.html#16617">[ author ]</a>
         </LI>
       </UL>
</body></html>
