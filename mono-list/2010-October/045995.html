<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Connecting to a database (VB)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Connecting%20to%20a%20database%20%28VB%29&In-Reply-To=1288538211.12491.53.camel%40PB3.Linux">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045994.html">
   <LINK REL="Next"  HREF="045996.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Connecting to a database (VB)</H1>
    <B>Jonathan Pobst</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Connecting%20to%20a%20database%20%28VB%29&In-Reply-To=1288538211.12491.53.camel%40PB3.Linux"
       TITLE="[Mono-list] Connecting to a database (VB)">monkey at jpobst.com
       </A><BR>
    <I>Sun Oct 31 12:50:10 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="045994.html">[Mono-list] Connecting to a database (VB)
</A></li>
        <LI>Next message: <A HREF="045996.html">[Mono-list] Npgsql sample does not run, if manually compiled
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45995">[ date ]</a>
              <a href="thread.html#45995">[ thread ]</a>
              <a href="subject.html#45995">[ subject ]</a>
              <a href="author.html#45995">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am pretty sure Mono does not support integrated security (as it 
requires Active Directory).

You will need to put your SQL Server in mixed mode security, create the 
username and password in SQL that you want, and give the user 
permissions to the appropriate role/database/etc.

Jonathan


On 10/31/2010 10:16 AM, Paul F. Johnson wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I have set up a really simple MS SQL database and am trying to connect
</I>&gt;<i> to it using VB.
</I>&gt;<i>
</I>&gt;<i> Currently, my code looks like this
</I>&gt;<i>
</I>&gt;<i> Dim connstr as String = &quot;Data Source=localhost\SQLEXPRESS;&quot;+&quot;Initial
</I>&gt;<i> Catalog=&quot;Database1\Table1;&quot;+&quot;Integrated Security=SSPI;&quot;
</I>&gt;<i> Dim sql as String = Nothing
</I>&gt;<i> Dim tables as New ArrayList
</I>&gt;<i> Dim sqldata as new DataSet
</I>&gt;<i> Try
</I>&gt;<i> Dim connect as new SqlConnection(connstr)
</I>&gt;<i> connect.Open()
</I>&gt;<i> Dim sqlcomm as new SqlCommand(sql, connect)
</I>&gt;<i> sqlcomm.CommandText = &quot;Select Name where (Age&gt;  25 and Hometown =
</I>&gt;<i> Liverpool);&quot;
</I>&gt;<i> Dim sqlad = new SqlDataAdapter
</I>&gt;<i> sqlad.SelectCommand = sqlcomm
</I>&gt;<i> For i = 0 to 3
</I>&gt;<i>    sqlad.TableMappings.Add(&quot;Table&quot;, tables(i).ToString())
</I>&gt;<i> Next
</I>&gt;<i> sqlad.Fill(sqldata)
</I>&gt;<i> connect.Close()
</I>&gt;<i> Catch ex as SqlException
</I>&gt;<i> WriteLine(&quot;Error &quot; + ex.Message.ToString())
</I>&gt;<i> End Try
</I>&gt;<i>
</I>&gt;<i> Nothing amazing. The problem is the connection string - I've googled
</I>&gt;<i> around and nothing seems to fit. The exception thrown is that it can't
</I>&gt;<i> log in for user pb5\paul. If I add User Id=paul or User Id=pb5\paul, it
</I>&gt;<i> still won't connect.
</I>&gt;<i>
</I>&gt;<i> What is wrong?
</I>&gt;<i>
</I>&gt;<i> TTFN
</I>&gt;<i>
</I>&gt;<i> Paul
</I>&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045994.html">[Mono-list] Connecting to a database (VB)
</A></li>
	<LI>Next message: <A HREF="045996.html">[Mono-list] Npgsql sample does not run, if manually compiled
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45995">[ date ]</a>
              <a href="thread.html#45995">[ thread ]</a>
              <a href="subject.html#45995">[ subject ]</a>
              <a href="author.html#45995">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
