<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] numerical performance comparison [C++ vs JVM vs Mono]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20numerical%20performance%20comparison%20%5BC%2B%2B%20vs%20JVM%20vs%20Mono%5D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045831.html">
   <LINK REL="Next"  HREF="045836.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] numerical performance comparison [C++ vs JVM vs Mono]</H1>
    <B>Jonathan Shore</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20numerical%20performance%20comparison%20%5BC%2B%2B%20vs%20JVM%20vs%20Mono%5D&In-Reply-To="
       TITLE="[Mono-list] numerical performance comparison [C++ vs JVM vs Mono]">jonathan.shore at gmail.com
       </A><BR>
    <I>Mon Oct  4 10:43:18 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="045831.html">[Mono-list] Kickstart with Mono
</A></li>
        <LI>Next message: <A HREF="045836.html">[Mono-list] numerical performance comparison [C++ vs JVM vs Mono]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45834">[ date ]</a>
              <a href="thread.html#45834">[ thread ]</a>
              <a href="subject.html#45834">[ subject ]</a>
              <a href="author.html#45834">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I am looking forward to moving all of my code from Java / C++ to F# / C# in the very near future.   I took the nbody code from the language shootout and ran with 500 million iterations (much more than used in the shootout to provide a fair comparison) on ubuntu server on a core i7 920 box.

I used:

- C++ (g++ -O3 with various MMX related flags as done in the shootout)
- Java 7  -server
- Mono 2.4.4, compiling with -optimize:+

I had the following results in seconds:

1.  C++: 		98 seconds
2.  JVM:		126 seconds,  a 28% performance gap against C++
3.  Mono:	191 seconds,  a 50% performance gap with the JVM

Because the nbody problem uses sqrt for the euclidean distance in each loop, thought that maybe the discrepancy might be more related to the implementation of Sqrt().

I implemented a (very poor) numerical algorithm as a substitute for the sqrt() function in each implementation to provide an apples-to-apples comparison.    The new numbers became:

1.  C++:		517 seconds
2.  JVM:		527 seconds
3  Mono:		223 seconds (wow, a surprise here)

I noticed that the Mono runtime libraries use an internal implementation of Sqrt() that seems to resolve to an Op Code.   I am wondering, ultimately, what implementation this maps to?   Clearly the Sqrt implementation in Mono is 2x as slow (or access through the layers is 2x as slow) as the libc implementation.   

I do mostly numerical work, so concerned about sqrt as well as other fundamental functions in this regard.   Are these custom implementations in assembler for each arch?    Would it be reasonable to try to map these to the existing libc library when available?

Thanks

--
Jonathan Shore
Systematic Trading Group

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045831.html">[Mono-list] Kickstart with Mono
</A></li>
	<LI>Next message: <A HREF="045836.html">[Mono-list] numerical performance comparison [C++ vs JVM vs Mono]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45834">[ date ]</a>
              <a href="thread.html#45834">[ thread ]</a>
              <a href="subject.html#45834">[ subject ]</a>
              <a href="author.html#45834">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
