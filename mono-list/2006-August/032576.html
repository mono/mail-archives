<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Application installation on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Application%20installation%20on%20Windows&In-Reply-To=ed6n7i%24iip%241%40sea.gmane.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032573.html">
   <LINK REL="Next"  HREF="032578.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Application installation on Windows</H1>
    <B>Andreas F&#228;rber</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Application%20installation%20on%20Windows&In-Reply-To=ed6n7i%24iip%241%40sea.gmane.org"
       TITLE="[Mono-list] Application installation on Windows">andreas.faerber at web.de
       </A><BR>
    <I>Thu Aug 31 10:09:02 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="032573.html">[Mono-list] Application installation on Windows
</A></li>
        <LI>Next message: <A HREF="032578.html">[Mono-list] Application installation on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32576">[ date ]</a>
              <a href="thread.html#32576">[ thread ]</a>
              <a href="subject.html#32576">[ subject ]</a>
              <a href="author.html#32576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Robert,

Am 31.08.2006 um 15:12 schrieb Robert Jordan:

&gt;<i> That's quite easy:
</I>&gt;<i>
</I>&gt;<i> 1) lookup the string value
</I>&gt;<i>
</I>&gt;<i>     $version = HKLM_LOCAL_MACHINE\Software\Novell\Mono\DefaultCLR
</I>&gt;<i>
</I>&gt;<i> 2) lookup the string value
</I>&gt;<i>
</I>&gt;<i>      $monoprefix =
</I>&gt;<i>
</I>&gt;<i> HKLM_LOCAL_MACHINE\Software\Novell\Mono\$version\SdkInstallRoot
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 3) (optional) detect whether $mono-prefix\bin\mono.exe exists.
</I>&gt;<i>
</I>&gt;<i> If one of the steps above failed, Mono is not properly
</I>&gt;<i> installed or too old.
</I>
With this info it's really very easy! Thanks!
Someone should add it to the Wiki please.


&gt;&gt;<i> b) How should the shortcut be constructed? (assume Mono will be on
</I>&gt;&gt;<i> the user's path? or determine absolute Mono path somehow?)
</I>&gt;<i>
</I>&gt;<i> Usually the tool (1) which generates the MSI is able to create
</I>&gt;<i> icons almost automagically.
</I>&gt;<i>
</I>&gt;<i> The shortcut target is
</I>&gt;<i>
</I>&gt;<i> 	$monopath\bin\mono.exe
</I>&gt;<i>
</I>&gt;<i> The shortcut's command line
</I>&gt;<i>
</I>&gt;<i> 	$installdir\yourapp.exe
</I>&gt;<i>
</I>&gt;<i> The shortcut's icon
</I>&gt;<i>
</I>&gt;<i> 	$installdir\yourapp.exe
</I>
So in short we should use the absolute path as determined above. Okay!

&gt;<i> (1) I can't really recommend one, but have a look at WiX:
</I>&gt;<i>
</I>&gt;<i> 	<A HREF="http://wix.sourceforge.net/">http://wix.sourceforge.net/</A>
</I>&gt;<i>
</I>&gt;<i> Despite of its very misleading name (for Germans ;-),
</I>&gt;<i> it's a nice toolkit.
</I>
I have in fact been using WiX for my .NET installation packages and  
can definitely recommend it!

(Not sure though what you mean by creating icons almost  
automagically, it just specifies the icon to be displayed.)


&gt;&gt;<i> Another thing is that with Microsoft .NET there's a library
</I>&gt;&gt;<i> InstallUtilLib.dll that can be used as part of a Windows Installer
</I>&gt;&gt;<i> package to run managed Installer classes (e.g. for Firewall
</I>&gt;&gt;<i> configuration) - Installer classes are apparently not available in
</I>&gt;&gt;<i> Mono, no equivalent to InstallUtilLib provided and no workaround
</I>&gt;&gt;<i> published.
</I>&gt;<i>
</I>&gt;<i> This can't be provided, because this would require that
</I>&gt;<i> MS.NET is installed on the machine. Otherwise the MSI engine
</I>&gt;<i> won't be able to execute the custom actions implemented
</I>&gt;<i> by your assemblies.
</I>
Why would that be the case? A replacement would not require  
Microsoft .NET but rather Mono. So having determined that Mono is  
installed I should be able to run managed code using Mono either way!  
In that case it would in theory seem possible for the Mono Project to  
provide a native Windows DLL that loads Mono as outlined on the  
Embedding page, reflects on the assembly's classes and runs an  
Installer class.

A workaround might have been to invoke ...\mono.exe ... 
\MyInstallers.exe and run the Installers from the Main method, but  
that does not seem possible so that apparently I can't reuse  
Installer classes written for .NET at all and would have to duplicate  
the code as a standalone app to do the same using Mono? Is this for  
licensing reasons, or has nobody yet seen the need to implement the  
Installer classes in Mono?

Andreas
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032573.html">[Mono-list] Application installation on Windows
</A></li>
	<LI>Next message: <A HREF="032578.html">[Mono-list] Application installation on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32576">[ date ]</a>
              <a href="thread.html#32576">[ thread ]</a>
              <a href="subject.html#32576">[ subject ]</a>
              <a href="author.html#32576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
