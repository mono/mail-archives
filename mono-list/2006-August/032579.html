<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Application installation on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Application%20installation%20on%20Windows&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032578.html">
   <LINK REL="Next"  HREF="032560.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Application installation on Windows</H1>
    <B>Alexander.Nolting at Bertelsmann.de</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Application%20installation%20on%20Windows&In-Reply-To="
       TITLE="[Mono-list] Application installation on Windows">Alexander.Nolting at Bertelsmann.de
       </A><BR>
    <I>Thu Aug 31 11:56:08 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="032578.html">[Mono-list] Application installation on Windows
</A></li>
        <LI>Next message: <A HREF="032560.html">[Mono-list] Parameters &amp; SQLite
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32579">[ date ]</a>
              <a href="thread.html#32579">[ thread ]</a>
              <a href="subject.html#32579">[ subject ]</a>
              <a href="author.html#32579">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello Robert and also Andreas,

I took some thoughts since my question and I think you both on the right way. For is interesting to install a .NET app on a linux os. My idea is now to use wine and mono together, in fact using wine to handle the msi packages by installing windows installer under wine and then the needed apps. Then has to be a script in the msi which determines where mono in which version is installed and provide a bash script in the install folder of the msi, which also find out where mono is installed and starts the app in the right way (mono &lt;app&gt;|&lt;path with app&gt;).

regards
Alex



-----Urspr&#252;ngliche Nachricht-----
Von: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A> im Auftrag von Robert Jordan
Gesendet: Do 31.08.2006 15:12
An: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
Betreff: Re: [Mono-list] Application installation on Windows
 
Hi Andreas,

Andreas F&#228;rber wrote:
&gt;<i> I asked a similar question some time ago, and this issue is simply  
</I>&gt;<i> being ignored. The point is how to detect a Mono installation from a  
</I>&gt;<i> Windows Installer package. For Microsoft .NET this can be determined  
</I>&gt;<i> using the Windows Installer technology itself, and the shortcuts  
</I>&gt;<i> point directly to the .exe, the CLR being integrated into Windows.  
</I>&gt;<i> Both is impossible with Mono.
</I>&gt;<i> 
</I>&gt;<i> a) How does one determine whether Mono is installed somewhere on the  
</I>&gt;<i> system? (registry?)
</I>
That's quite easy:

1) lookup the string value

    $version = HKLM_LOCAL_MACHINE\Software\Novell\Mono\DefaultCLR

2) lookup the string value

     $monoprefix =

HKLM_LOCAL_MACHINE\Software\Novell\Mono\$version\SdkInstallRoot


3) (optional) detect whether $mono-prefix\bin\mono.exe exists.

If one of the steps above failed, Mono is not properly
installed or too old.


&gt;<i> b) How should the shortcut be constructed? (assume Mono will be on  
</I>&gt;<i> the user's path? or determine absolute Mono path somehow?)
</I>
Usually the tool (1) which generates the MSI is able to create
icons almost automagically.

The shortcut target is

	$monopath\bin\mono.exe

The shortcut's command line

	$installdir\yourapp.exe

The shortcut's icon

	$installdir\yourapp.exe


(1) I can't really recommend one, but have a look at WiX:

	<A HREF="http://wix.sourceforge.net/">http://wix.sourceforge.net/</A>

Despite of its very misleading name (for Germans ;-),
it's a nice toolkit.

&gt;<i> This lack of information is keeping me from providing a Mono version  
</I>&gt;<i> of my Windows software.
</I>&gt;<i> 
</I>&gt;<i> Another thing is that with Microsoft .NET there's a library  
</I>&gt;<i> InstallUtilLib.dll that can be used as part of a Windows Installer  
</I>&gt;<i> package to run managed Installer classes (e.g. for Firewall  
</I>&gt;<i> configuration) - Installer classes are apparently not available in  
</I>&gt;<i> Mono, no equivalent to InstallUtilLib provided and no workaround  
</I>&gt;<i> published.
</I>
This can't be provided, because this would require that
MS.NET is installed on the machine. Otherwise the MSI engine
won't be able to execute the custom actions implemented
by your assemblies.

Robert

_______________________________________________
Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20060831/dc3f80dc/attachment-0001.html">http://lists.ximian.com/pipermail/mono-list/attachments/20060831/dc3f80dc/attachment-0001.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032578.html">[Mono-list] Application installation on Windows
</A></li>
	<LI>Next message: <A HREF="032560.html">[Mono-list] Parameters &amp; SQLite
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32579">[ date ]</a>
              <a href="thread.html#32579">[ thread ]</a>
              <a href="subject.html#32579">[ subject ]</a>
              <a href="author.html#32579">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
