<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Application installation on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Application%20installation%20on%20Windows&In-Reply-To=C247AF26-95F8-474C-A04A-92613696F4CC%40web.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032570.html">
   <LINK REL="Next"  HREF="032576.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Application installation on Windows</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Application%20installation%20on%20Windows&In-Reply-To=C247AF26-95F8-474C-A04A-92613696F4CC%40web.de"
       TITLE="[Mono-list] Application installation on Windows">robertj at gmx.net
       </A><BR>
    <I>Thu Aug 31 09:12:18 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="032570.html">[Mono-list] Application installation on Windows
</A></li>
        <LI>Next message: <A HREF="032576.html">[Mono-list] Application installation on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32573">[ date ]</a>
              <a href="thread.html#32573">[ thread ]</a>
              <a href="subject.html#32573">[ subject ]</a>
              <a href="author.html#32573">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Andreas,

Andreas F&#228;rber wrote:
&gt;<i> I asked a similar question some time ago, and this issue is simply  
</I>&gt;<i> being ignored. The point is how to detect a Mono installation from a  
</I>&gt;<i> Windows Installer package. For Microsoft .NET this can be determined  
</I>&gt;<i> using the Windows Installer technology itself, and the shortcuts  
</I>&gt;<i> point directly to the .exe, the CLR being integrated into Windows.  
</I>&gt;<i> Both is impossible with Mono.
</I>&gt;<i> 
</I>&gt;<i> a) How does one determine whether Mono is installed somewhere on the  
</I>&gt;<i> system? (registry?)
</I>
That's quite easy:

1) lookup the string value

    $version = HKLM_LOCAL_MACHINE\Software\Novell\Mono\DefaultCLR

2) lookup the string value

     $monoprefix =

HKLM_LOCAL_MACHINE\Software\Novell\Mono\$version\SdkInstallRoot


3) (optional) detect whether $mono-prefix\bin\mono.exe exists.

If one of the steps above failed, Mono is not properly
installed or too old.


&gt;<i> b) How should the shortcut be constructed? (assume Mono will be on  
</I>&gt;<i> the user's path? or determine absolute Mono path somehow?)
</I>
Usually the tool (1) which generates the MSI is able to create
icons almost automagically.

The shortcut target is

	$monopath\bin\mono.exe

The shortcut's command line

	$installdir\yourapp.exe

The shortcut's icon

	$installdir\yourapp.exe


(1) I can't really recommend one, but have a look at WiX:

	<A HREF="http://wix.sourceforge.net/">http://wix.sourceforge.net/</A>

Despite of its very misleading name (for Germans ;-),
it's a nice toolkit.

&gt;<i> This lack of information is keeping me from providing a Mono version  
</I>&gt;<i> of my Windows software.
</I>&gt;<i> 
</I>&gt;<i> Another thing is that with Microsoft .NET there's a library  
</I>&gt;<i> InstallUtilLib.dll that can be used as part of a Windows Installer  
</I>&gt;<i> package to run managed Installer classes (e.g. for Firewall  
</I>&gt;<i> configuration) - Installer classes are apparently not available in  
</I>&gt;<i> Mono, no equivalent to InstallUtilLib provided and no workaround  
</I>&gt;<i> published.
</I>
This can't be provided, because this would require that
MS.NET is installed on the machine. Otherwise the MSI engine
won't be able to execute the custom actions implemented
by your assemblies.

Robert

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032570.html">[Mono-list] Application installation on Windows
</A></li>
	<LI>Next message: <A HREF="032576.html">[Mono-list] Application installation on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32573">[ date ]</a>
              <a href="thread.html#32573">[ thread ]</a>
              <a href="subject.html#32573">[ subject ]</a>
              <a href="author.html#32573">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
