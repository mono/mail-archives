<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Parameters &amp; SQLite
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Parameters%20%26%20SQLite&In-Reply-To=44F5F42D.9000606%40xmtp.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032561.html">
   <LINK REL="Next"  HREF="032581.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Parameters &amp; SQLite</H1>
    <B>Adam Tauno Williams</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Parameters%20%26%20SQLite&In-Reply-To=44F5F42D.9000606%40xmtp.net"
       TITLE="[Mono-list] Parameters &amp; SQLite">adam at morrison-ind.com
       </A><BR>
    <I>Thu Aug 31 06:45:50 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="032561.html">[Mono-list] Parameters &amp; SQLite
</A></li>
        <LI>Next message: <A HREF="032581.html">[Mono-list] Parameters &amp; SQLite
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32565">[ date ]</a>
              <a href="thread.html#32565">[ thread ]</a>
              <a href="subject.html#32565">[ subject ]</a>
              <a href="author.html#32565">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> It is my blog, but take a look anyway. 
</I>&gt;<i> <A HREF="http://little.xmtp.net/blog/2005/10/21/proper-data-abstraction-in-net-and-mono-applications/">http://little.xmtp.net/blog/2005/10/21/proper-data-abstraction-in-net-and-mono-applications/</A>
</I>&gt;<i> <A HREF="http://little.xmtp.net/blog/2005/11/22/more-proper-data-abstractions-in-net-and-mono-applications/">http://little.xmtp.net/blog/2005/11/22/more-proper-data-abstractions-in-net-and-mono-applications/</A>
</I>&gt;<i> The short answer is &quot;yes&quot; parameters are supported.  There are examples
</I>&gt;<i> at the above URLs.
</I>&gt;<i> A short example:
</I>&gt;<i> |IDbCommand idcSelect = conn.CreateCommand();
</I>&gt;<i> idcSelect.CommandText = &quot;select col from table where othercl=@someting&quot;;
</I>&gt;<i> ||IDataParameter param = idcSelect.CreateParameter();
</I>&gt;<i> Cmd.Parameters.Add(param);
</I>&gt;<i> param.ParameterName = &quot;@someting&quot;;
</I>&gt;<i> param.DbType = DbType.String;
</I>&gt;<i> param.Value = &quot;whatever something would equal&quot;;
</I>&gt;<i> The above is more geared to 1.1, since 2.0 has DbConnection and the
</I>&gt;<i> ADO2.0 db provider stuff.
</I>
Excellent!

I'm trying to create a routine that automatically stores a Hashtable (a
result from an expensive RPC) into a database as a cache.  Each key in
the Hashtable corresponds to a column in the table, which the key
entityName containing the name of the table.  The routine compiles fine
but then just hangs when ExecuteNonQuery is called.

------
IDbCommand command = connection.CreateCommand();
int count = 0;
string columnList = &quot;&quot;;
string valueList = &quot;&quot;;
foreach(string key in dictionary.Keys)
{
 IDataParameter	parameter;
  if (count &gt; 0)
  {
    columnList = columnList + &quot;, &quot;;
    valueList = valueList + &quot;, &quot;;
  }
  columnList = columnList + key;
  valueList = valueList + &quot;@&quot; + key;
  parameter = command.CreateParameter();
  command.Parameters.Add(parameter);
  if (dictionary[key].GetType().FullName == &quot;System.String&quot;)
  {
    parameter.ParameterName = &quot;@&quot; + key;
    parameter.DbType = DbType.String;
    parameter.Value = (string)dictionary[key];
  } else if (dictionary[key].GetType().FullName == &quot;System.Int32&quot;)
    {
      parameter.ParameterName = &quot;@&quot; + key;
      parameter.DbType = DbType.Int32;
      parameter.Value = (int)dictionary[key];
    } else if (dictionary[key].GetType().FullName == &quot;System.DateTime&quot;)
      {
        parameter.ParameterName = &quot;@&quot; + key;
        parameter.DbType = DbType.DateTime;
        parameter.Value = (DateTime)dictionary[key];
      } else throw new System.Exception(&quot;Unhandled type in response&quot;);
  count++;
}
command.CommandText = 
  &quot;INSERT INTO &quot; + (string)dictionary[&quot;entityName&quot;] +
  &quot;  (&quot; + columnList + &quot;) VALUES (&quot; + valueList + &quot;);&quot;;
Console.WriteLine(&quot;Dictionary.StoreHash: Executing non-query&quot;);
command.ExecuteNonQuery();
Console.WriteLine(&quot;Dictionary.StoreHash: Non-query complete&quot;);
command.Dispose();

----

I'd expect an error/exception,  the hang is confusing.

</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032561.html">[Mono-list] Parameters &amp; SQLite
</A></li>
	<LI>Next message: <A HREF="032581.html">[Mono-list] Parameters &amp; SQLite
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32565">[ date ]</a>
              <a href="thread.html#32565">[ thread ]</a>
              <a href="subject.html#32565">[ subject ]</a>
              <a href="author.html#32565">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
