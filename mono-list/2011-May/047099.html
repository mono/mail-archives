<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Trouble building with Microsoft dlls
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Trouble%20building%20with%20Microsoft%20dlls&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="047100.html">
   <LINK REL="Next"  HREF="047101.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Trouble building with Microsoft dlls</H1>
    <B>doal</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Trouble%20building%20with%20Microsoft%20dlls&In-Reply-To="
       TITLE="[Mono-list] Trouble building with Microsoft dlls">doal.miller at mir3.com
       </A><BR>
    <I>Tue May 24 20:49:27 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="047100.html">[Mono-list] DBLinq exits with message 'Abort Trap'
</A></li>
        <LI>Next message: <A HREF="047101.html">[Mono-list] Trouble building with Microsoft dlls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47099">[ date ]</a>
              <a href="thread.html#47099">[ thread ]</a>
              <a href="subject.html#47099">[ subject ]</a>
              <a href="author.html#47099">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm new to Mono so this is probably something simple or maybe I'm
misunderstanding what can be done. I'm developing on Linux in Java but we
just had a requirement to interface with MS Exchange Server so we wrote a
Transport Agent in C#. That agent gets plugged into Exchange so it is
obviously going to be run on Windows using .NET.

However since our entire product builds under ant on Linux we wanted to
build the Agent there also and then install it and run it on Windows,
Exchange Server. My first assumption is that this is possible.

I read up on NAnt and Mono and got a build of a trivial C# program working.
I then tried to build my Agent which uses the Microsoft dlls like
Microsoft.Exchange.Data.Common.dll, Microsoft.Exchange.Data.Transport.dll,
and a few others. When I look at their file types on Linux it says:
lib/Microsoft.Exchange.Data.Transport.dll: PE32 executable for MS Windows
(DLL) (console) Intel 80386 32-bit Mono/.Net assembly

So they seem to be .NET assembly files which is what Mono wants, right?

Yet when I try and build and I point the build to the dlls with the
following in my default.build file:
            &lt;references&gt;
                &lt;include name=&quot;lib/*.dll&quot; /&gt;
            &lt;/references&gt;

I get a these errors like this:
      [csc] Compiling 2 files to
'/home/doal/workspace-sts-2.6.0.RELEASE/Cure/ms-exchange/CureTransportAgent/bin/CureTransportAgent.dll'.
      [csc] ** (/usr/lib/mono/2.0/gmcs.exe:10018): WARNING **: The class
System.Web.Management.WebRequestErrorEvent could not be loaded, used in
System.Web, Version=2.0.0.0, Culture=neutral,
PublicKeyToken=b03f5f7f11d50a3a
      [csc] ** (/usr/lib/mono/2.0/gmcs.exe:10018): WARNING **: The class
System.Web.UI.IUpdatePanel could not be loaded, used in System.Web,
Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
      [csc] Unhandled Exception:
System.Reflection.ReflectionTypeLoadException: The classes in the module
cannot be loaded.
      [csc]   at (wrapper managed-to-native)
System.Reflection.Assembly:GetTypes (bool)
      [csc]   at System.Reflection.Assembly.GetTypes () [0x00000] 
      [csc]   at Mono.CSharp.RootNamespace.ComputeNamespaces
(System.Reflection.Assembly assembly) [0x00000] 
      [csc]   at Mono.CSharp.RootNamespace.ComputeNamespaces () [0x00000] 
      [csc]   at Mono.CSharp.Driver.LoadReferences () [0x00000] 
      [csc]   at Mono.CSharp.Driver.Compile () [0x00000] 
      [csc]   at Mono.CSharp.Driver.Main (System.String[] args) [0x00000] 

BUILD FAILED - 0 non-fatal error(s), 10 warning(s)

/home/doal/workspace-sts-2.6.0.RELEASE/Cure/ms-exchange/CureTransportAgent/default.build(14,10):
External Program Failed: /usr/lib/mono/2.0/gmcs.exe (return code was 1)

So, shouldn't I be able to build this? I saw one post saying to use the
apt-get version of nant but that's what I'm using. Any help would be greatly
appreciated. Thanks

--
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/Trouble-building-with-Microsoft-dlls-tp3548648p3548648.html">http://mono.1490590.n4.nabble.com/Trouble-building-with-Microsoft-dlls-tp3548648p3548648.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="047100.html">[Mono-list] DBLinq exits with message 'Abort Trap'
</A></li>
	<LI>Next message: <A HREF="047101.html">[Mono-list] Trouble building with Microsoft dlls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47099">[ date ]</a>
              <a href="thread.html#47099">[ thread ]</a>
              <a href="subject.html#47099">[ subject ]</a>
              <a href="author.html#47099">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
