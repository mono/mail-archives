<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Trouble building with Microsoft dlls
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Trouble%20building%20with%20Microsoft%20dlls&In-Reply-To=1306284567685-3548648.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="047099.html">
   <LINK REL="Next"  HREF="047103.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Trouble building with Microsoft dlls</H1>
    <B>Steve Lessard</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Trouble%20building%20with%20Microsoft%20dlls&In-Reply-To=1306284567685-3548648.post%40n4.nabble.com"
       TITLE="[Mono-list] Trouble building with Microsoft dlls">s_lessard at yahoo.com
       </A><BR>
    <I>Wed May 25 01:24:45 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="047099.html">[Mono-list] Trouble building with Microsoft dlls
</A></li>
        <LI>Next message: <A HREF="047103.html">[Mono-list] Trouble building with Microsoft dlls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47101">[ date ]</a>
              <a href="thread.html#47101">[ thread ]</a>
              <a href="subject.html#47101">[ subject ]</a>
              <a href="author.html#47101">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Are those Microsoft assemblies 64-bit or mixed-mode?

This blog might explain the problem.  

<A HREF="http://blogs.msdn.com/b/slessard/archive/2010/04/09/types-of-managed-code-assemblies.aspx">http://blogs.msdn.com/b/slessard/archive/2010/04/09/types-of-managed-code-assemblies.aspx</A>

-SteveL


On May 24, 2011, at 5:49 PM, doal &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">doal.miller at mir3.com</A>&gt; wrote:

&gt;<i> I'm new to Mono so this is probably something simple or maybe I'm
</I>&gt;<i> misunderstanding what can be done. I'm developing on Linux in Java but we
</I>&gt;<i> just had a requirement to interface with MS Exchange Server so we wrote a
</I>&gt;<i> Transport Agent in C#. That agent gets plugged into Exchange so it is
</I>&gt;<i> obviously going to be run on Windows using .NET.
</I>&gt;<i> 
</I>&gt;<i> However since our entire product builds under ant on Linux we wanted to
</I>&gt;<i> build the Agent there also and then install it and run it on Windows,
</I>&gt;<i> Exchange Server. My first assumption is that this is possible.
</I>&gt;<i> 
</I>&gt;<i> I read up on NAnt and Mono and got a build of a trivial C# program working.
</I>&gt;<i> I then tried to build my Agent which uses the Microsoft dlls like
</I>&gt;<i> Microsoft.Exchange.Data.Common.dll, Microsoft.Exchange.Data.Transport.dll,
</I>&gt;<i> and a few others. When I look at their file types on Linux it says:
</I>&gt;<i> lib/Microsoft.Exchange.Data.Transport.dll: PE32 executable for MS Windows
</I>&gt;<i> (DLL) (console) Intel 80386 32-bit Mono/.Net assembly
</I>&gt;<i> 
</I>&gt;<i> So they seem to be .NET assembly files which is what Mono wants, right?
</I>&gt;<i> 
</I>&gt;<i> Yet when I try and build and I point the build to the dlls with the
</I>&gt;<i> following in my default.build file:
</I>&gt;<i>            &lt;references&gt;
</I>&gt;<i>                &lt;include name=&quot;lib/*.dll&quot; /&gt;
</I>&gt;<i>            &lt;/references&gt;
</I>&gt;<i> 
</I>&gt;<i> I get a these errors like this:
</I>&gt;<i>      [csc] Compiling 2 files to
</I>&gt;<i> '/home/doal/workspace-sts-2.6.0.RELEASE/Cure/ms-exchange/CureTransportAgent/bin/CureTransportAgent.dll'.
</I>&gt;<i>      [csc] ** (/usr/lib/mono/2.0/gmcs.exe:10018): WARNING **: The class
</I>&gt;<i> System.Web.Management.WebRequestErrorEvent could not be loaded, used in
</I>&gt;<i> System.Web, Version=2.0.0.0, Culture=neutral,
</I>&gt;<i> PublicKeyToken=b03f5f7f11d50a3a
</I>&gt;<i>      [csc] ** (/usr/lib/mono/2.0/gmcs.exe:10018): WARNING **: The class
</I>&gt;<i> System.Web.UI.IUpdatePanel could not be loaded, used in System.Web,
</I>&gt;<i> Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
</I>&gt;<i>      [csc] Unhandled Exception:
</I>&gt;<i> System.Reflection.ReflectionTypeLoadException: The classes in the module
</I>&gt;<i> cannot be loaded.
</I>&gt;<i>      [csc]   at (wrapper managed-to-native)
</I>&gt;<i> System.Reflection.Assembly:GetTypes (bool)
</I>&gt;<i>      [csc]   at System.Reflection.Assembly.GetTypes () [0x00000] 
</I>&gt;<i>      [csc]   at Mono.CSharp.RootNamespace.ComputeNamespaces
</I>&gt;<i> (System.Reflection.Assembly assembly) [0x00000] 
</I>&gt;<i>      [csc]   at Mono.CSharp.RootNamespace.ComputeNamespaces () [0x00000] 
</I>&gt;<i>      [csc]   at Mono.CSharp.Driver.LoadReferences () [0x00000] 
</I>&gt;<i>      [csc]   at Mono.CSharp.Driver.Compile () [0x00000] 
</I>&gt;<i>      [csc]   at Mono.CSharp.Driver.Main (System.String[] args) [0x00000] 
</I>&gt;<i> 
</I>&gt;<i> BUILD FAILED - 0 non-fatal error(s), 10 warning(s)
</I>&gt;<i> 
</I>&gt;<i> /home/doal/workspace-sts-2.6.0.RELEASE/Cure/ms-exchange/CureTransportAgent/default.build(14,10):
</I>&gt;<i> External Program Failed: /usr/lib/mono/2.0/gmcs.exe (return code was 1)
</I>&gt;<i> 
</I>&gt;<i> So, shouldn't I be able to build this? I saw one post saying to use the
</I>&gt;<i> apt-get version of nant but that's what I'm using. Any help would be greatly
</I>&gt;<i> appreciated. Thanks
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/Trouble-building-with-Microsoft-dlls-tp3548648p3548648.html">http://mono.1490590.n4.nabble.com/Trouble-building-with-Microsoft-dlls-tp3548648p3548648.html</A>
</I>&gt;<i> Sent from the Mono - General mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="047099.html">[Mono-list] Trouble building with Microsoft dlls
</A></li>
	<LI>Next message: <A HREF="047103.html">[Mono-list] Trouble building with Microsoft dlls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47101">[ date ]</a>
              <a href="thread.html#47101">[ thread ]</a>
              <a href="subject.html#47101">[ subject ]</a>
              <a href="author.html#47101">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
