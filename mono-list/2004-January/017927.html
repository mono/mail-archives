<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Assembly.LoadFrom() - Assembly.CreateInstance()  - Activator.CreateInstanceFrom()  ---&gt; invalid cast
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jaak%40zd.com.pl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="017924.html">
   <LINK REL="Next"  HREF="017933.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Assembly.LoadFrom() - Assembly.CreateInstance()  - Activator.CreateInstanceFrom()  ---&gt; invalid cast
   </H1>
    <B>Jaroslaw Kowalski
    </B> 
    <A HREF="mailto:jaak%40zd.com.pl"
       TITLE="[Mono-list] Assembly.LoadFrom() - Assembly.CreateInstance()  - Activator.CreateInstanceFrom()  ---&gt; invalid cast">jaak@zd.com.pl
       </A><BR>
    <I>Mon, 26 Jan 2004 17:12:33 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="017924.html">[Mono-list] Assembly.LoadFrom() - Assembly.CreateInstance()  - Activator.CreateInstanceFrom()  ---&gt; invalid cast
</A></li>
        <LI> Next message: <A HREF="017933.html">[Mono-list] Assembly.LoadFrom() - Assembly.CreateInstance()
 - Activator.CreateInstanceFrom()  ---&gt; invalid cast
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17927">[ date ]</a>
              <a href="thread.html#17927">[ thread ]</a>
              <a href="subject.html#17927">[ subject ]</a>
              <a href="author.html#17927">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt; Type t = Type.GetType(&quot;System.Data.SqlClient.SqlConnection, System.Data,
</I>&gt;<i> &gt; Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;)
</I>
&gt;<i> I think it's way better to use something like:
</I>&gt;<i> Assembly a = Assembly.LoadWithPartialName (&quot;System.Data&quot;);
</I>&gt;<i> Type t = a.GetType (&quot;System.Data.SqlClient.SqlConnection&quot;);
</I>&gt;<i> ...
</I>&gt;<i> because I guess your code is going to break with the next (or different
</I>&gt;<i> versions) of the CLR where the exact same version may not be available.
</I>&gt;<i>
</I>
Actually this string is usually stored in a configuration file so there is
no problem for me.

BTW. .NET 1.1 supports a transparent assembly redirection for system
assemblies. i.e. when you ask for

Type.GetType(&quot;System.Data.SqlClient.SqlConnection, System.Data,
Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;)

you're gonna get the same thing as.

Type.GetType(&quot;System.Data.SqlClient.SqlConnection, System.Data,
Version=1.1.4322, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;)

instead because MS &quot;knows&quot; this latter type is backwards compatible (this
applies to all assemblies located in Microsoft.NET\Framework\v1.1.4322) .
This is a new behaviour introduced in .NET 1.1 to eliminate unneccessary
assembly redirections.

Note that .NET 1.0 behaves differently here (it will let you two
System.Data's from two CLR versions provided that they are in the GAC)

Does mono support this?

Jarek


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="017924.html">[Mono-list] Assembly.LoadFrom() - Assembly.CreateInstance()  - Activator.CreateInstanceFrom()  ---&gt; invalid cast
</A></li>
	<LI> Next message: <A HREF="017933.html">[Mono-list] Assembly.LoadFrom() - Assembly.CreateInstance()
 - Activator.CreateInstanceFrom()  ---&gt; invalid cast
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17927">[ date ]</a>
              <a href="thread.html#17927">[ thread ]</a>
              <a href="subject.html#17927">[ subject ]</a>
              <a href="author.html#17927">[ author ]</a>
         </LI>
       </UL>
</body></html>
