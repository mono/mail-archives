<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] System.DllNotFoundException: oci
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gilles.favier2605%40wanadoo.fr">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="026592.html">
   <LINK REL="Next"  HREF="026594.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] System.DllNotFoundException: oci
   </H1>
    <B>Gilles FAVIER
    </B> 
    <A HREF="mailto:gilles.favier2605%40wanadoo.fr"
       TITLE="[Mono-list] System.DllNotFoundException: oci">gilles.favier2605@wanadoo.fr
       </A><BR>
    <I>Tue, 12 Apr 2005 12:53:36 +0200 (CEST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="026592.html">[Mono-list] No compilation after upgrading
</A></li>
        <LI> Next message: <A HREF="026594.html">[Mono-list] System.DllNotFoundException: oci
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26591">[ date ]</a>
              <a href="thread.html#26591">[ thread ]</a>
              <a href="subject.html#26591">[ subject ]</a>
              <a href="author.html#26591">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everybody i am back with ASPX issues...

To make my problem very clear the explanation are not going to be so long but i will all my code below. I kept as many variable as default to simplify the explanation. If any other information is needed to understand my problem feel free to ask.

I am running Mono 1.0.6 (installed as root user)with all neede packages and i manage without any trouble to display the Mono Sample web pages.
I am on a Virtual Machine (ran with VMWARE) under RedHat Enterprise Server 3.0 and i have installed the Oracle Client 9.2.0.4 with all needed packages to get it to work. ( i can also : &quot;sqlplus XXX/<A HREF="mailto:XXX@XXX">XXX@XXX</A>&quot; and ask some SELECT * to my base)

1--
I can ping my base with &quot;tnsping&quot; as Oracle user. If i use the code detailed in test.cs and i compile it with the command line : (as a root user)
mcs test.cs /r:System.dll  /r:System.Data.dll  /r:System.Data.OracleClient.dll
and then as Oracle user i type :
mono test.exe
and i get the expected result.

2--
If i take the same code and i put it in webform (see all web code below) and then i run :
mcs /t:library /out:WebTest.dll -r:System -r:System.Data -r:System.Drawing -r:System.Web -r:System.Data.OracleClient AssemblyInfo.cs Default.aspx.cs Global.asax.cs
(I thank again the list for helping me on this last one and also Seb Pouliot)
then i copy paste everything in the right directory on .../doc/xsp/test and in Firefox i put : <A HREF="http://localhost/demo">http://localhost/demo</A> (with the configuration given in the INSTALL of mod_mono)
I see the first page and when i click on GO, i get the following error message : 

--------------- start ERROR MESSAGE -----------------------
Description: Error processing request.

Error Message: HTTP 500.

Stack Trace:

System.DllNotFoundException: oci
in &lt;0x00053&gt; (wrapper managed-to-native) OciNativeCalls:OCIEnvCreate (intptr&amp;,System.Data.OracleClient.Oci.OciEnvironmentMode,intptr,intptr,intptr,intptr,int,intptr)
in &lt;0x00020&gt; System.Data.OracleClient.Oci.OciCalls:OCIEnvCreate (intptr&amp;,System.Data.OracleClient.Oci.OciEnvironmentMode,intptr,intptr,intptr,intptr,int,intptr)
in &lt;0x0005d&gt; System.Data.OracleClient.Oci.OciEnvironmentHandle:.ctor (System.Data.OracleClient.Oci.OciEnvironmentMode)
in &lt;0x0003c&gt; System.Data.OracleClient.Oci.OciGlue:CreateConnection (System.Data.OracleClient.OracleConnectionInfo)
in &lt;0x0002b&gt; System.Data.OracleClient.OracleConnection:Open ()
in &lt;0x0004f&gt; (wrapper remoting-invoke-with-check) System.Data.OracleClient.OracleConnection:Open ()
in &lt;0x00094&gt; WebTest._Default:BTGO_Click (object,System.EventArgs)
in &lt;0x00069&gt; (wrapper delegate-invoke) System.MulticastDelegate:invoke_void_object_EventArgs (object,System.EventArgs)
in &lt;0x00081&gt; System.Web.UI.WebControls.Button:OnClick (System.EventArgs)
in &lt;0x00058&gt; System.Web.UI.WebControls.Button:System.Web.UI.IPostBackEventHandler.RaisePostBackEvent (string)
in &lt;0x00016&gt; System.Web.UI.Page:RaisePostBackEvent (System.Web.UI.IPostBackEventHandler,string)
in &lt;0x0003e&gt; System.Web.UI.Page:RaisePostBackEvents ()
in &lt;0x002c3&gt; System.Web.UI.Page:InternalProcessRequest ()
in &lt;0x000c2&gt; System.Web.UI.Page:ProcessRequest (System.Web.HttpContext)
in &lt;0x002eb&gt; ExecuteHandlerState:Execute ()
in &lt;0x00084&gt; StateMachine:ExecuteState (System.Web.HttpApplication/IStateHandler,bool&amp;)
--------------- END ERROR MESSAGE -----------------------

What is really weird is that if i take the WebTest.dll and i replace the one created by visual studio in my ../siteweb/bin directory ... IT WORKS... i have the expected answer of my query...
Which makes me think that according to 1-- i can connect to my base and my tnsnames.ora is good! and according to 2-- the dll created is working. 
Why isn't it working under Linux??



-----------------------------------------------------------------
--------------------- START CODE test.cs ----------------------

 using System;
 using System.Data;
 using System.Data.OracleClient;

 public class Test
 {
    public static void Main (string[] args)
    {
        string connectionString =
                                &quot;Data Source=XXXX;User ID=XXXXX;Password=XXXXX;&quot;;
                        OracleConnection dbcon = null;
                        dbcon = new OracleConnection (connectionString);
                        dbcon.Open ();
                        OracleCommand dbcmd = dbcon.CreateCommand ();
                        string sql = &quot;SELECT COUNT(*) AS COUNTER FROM T_USER&quot;;
                        dbcmd.CommandText = sql;
                        Console.WriteLine(sql);

                        OracleDataReader reader = dbcmd.ExecuteReader ();

                        while(reader.Read())
                        {
                        Console.WriteLine((string) reader[&quot;COUNTER&quot;].ToString());
                        }

                        reader.Close ();
                        reader = null;
                        dbcmd.Dispose ();
                        dbcmd = null;
                        dbcon.Close ();
                        dbcon = null;
    }
 }

------------------ END CODE test.cs------------------------


----------------- START CODE Defalut.aspx ------------------------
&lt;%@ Page language=&quot;c#&quot; Codebehind=&quot;Default.aspx.cs&quot; AutoEventWireup=&quot;false&quot; Inherits=&quot;WebTest._Default&quot; %&gt;
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot; &gt;
&lt;HTML&gt;
	&lt;HEAD&gt;
		&lt;title&gt;Default&lt;/title&gt;
		&lt;meta name=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio .NET 7.1&quot;&gt;
		&lt;meta name=&quot;CODE_LANGUAGE&quot; Content=&quot;C#&quot;&gt;
		&lt;meta name=&quot;vs_defaultClientScript&quot; content=&quot;JavaScript&quot;&gt;
		&lt;meta name=&quot;vs_targetSchema&quot; content=&quot;<A HREF="http://schemas.microsoft.com/intellisense/ie5"">http://schemas.microsoft.com/intellisense/ie5&quot;</A>&gt;
	&lt;/HEAD&gt;
	&lt;body&gt;
		&lt;form id=&quot;Form1&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;
			&lt;P&gt;
				&lt;asp:Label id=&quot;LBSQL&quot; runat=&quot;server&quot;&gt;Label&lt;/asp:Label&gt;&lt;BR&gt;
				&lt;asp:Button id=&quot;BTGO&quot; runat=&quot;server&quot; Text=&quot;GO &quot;&gt;&lt;/asp:Button&gt;&lt;/P&gt;
			&lt;P&gt;
				&lt;asp:Label id=&quot;LBResult&quot; runat=&quot;server&quot; BackColor=&quot;#FFFFC0&quot;&gt;Label&lt;/asp:Label&gt;&lt;/P&gt;
		&lt;/form&gt;
	&lt;/body&gt;
&lt;/HTML&gt;
----------------- END CODE Default.aspx ------------------------

----------------- START CODE Defalut.aspx.cs ------------------------
using System;
using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Web;
using System.Web.SessionState;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using System.Data.OracleClient;

namespace WebTest
{
	/// &lt;summary&gt;
	/// Summary description for _Default.
	/// &lt;/summary&gt;
	public class _Default : System.Web.UI.Page
	{
		protected System.Web.UI.WebControls.Button BTGO;
		protected System.Web.UI.WebControls.Label LBResult;
		protected System.Web.UI.WebControls.Label LBSQL;
	
		private void Page_Load(object sender, System.EventArgs e)
		{
			// Put user code to initialize the page here
		}

		#region Web Form Designer generated code
		override protected void OnInit(EventArgs e)
		{
			//
			// CODEGEN: This call is required by the ASP.NET Web Form Designer.
			//
			InitializeComponent();
			base.OnInit(e);
		}
		
		/// &lt;summary&gt;
		/// Required method for Designer support - do not modify
		/// the contents of this method with the code editor.
		/// &lt;/summary&gt;
		private void InitializeComponent()
		{    
			this.BTGO.Click += new System.EventHandler(this.BTGO_Click);
			this.Load += new System.EventHandler(this.Page_Load);

		}
		#endregion

		private void BTGO_Click(object sender, System.EventArgs e)
		{
			LBResult.Text = &quot;&quot;;
			LBSQL.Text =  &quot;SELECT COUNT(*) AS COUNTER FROM T_USER&quot;;

			string connectionString = 
				&quot;Data Source=XXXX;User ID=XXXXX;Password=XXXXX;&quot;;
			OracleConnection dbcon = null;
			dbcon = new OracleConnection (connectionString);
			dbcon.Open ();
			OracleCommand dbcmd = dbcon.CreateCommand ();
			string sql = LBSQL.Text;
			dbcmd.CommandText = sql;			
	
			OracleDataReader reader = dbcmd.ExecuteReader ();
			
			while(reader.Read()) 
			{
				LBResult.Text += (string) reader[&quot;COUNTER&quot;].ToString() + &quot;&lt;BR&gt;&quot;;
			}

			reader.Close ();
			reader = null;
			dbcmd.Dispose ();
			dbcmd = null;
			dbcon.Close ();
			dbcon = null;
		}
	}
}

----------------- END CODE Defalut.aspx.cs ------------------------

----------------- START CODE Global.asax------------------------
&lt;%@ Application Codebehind=&quot;Global.asax.cs&quot; Inherits=&quot;WebTest.Global&quot; %&gt;

----------------- END CODE Global.asax------------------------

----------------- START CODE Global.asax.cs ------------------------
using System;
using System.Collections;
using System.ComponentModel;
using System.Web;
using System.Web.SessionState;

namespace WebTest 
{
	/// &lt;summary&gt;
	/// Summary description for Global.
	/// &lt;/summary&gt;
	public class Global : System.Web.HttpApplication
	{
		/// &lt;summary&gt;
		/// Required designer variable.
		/// &lt;/summary&gt;
		private System.ComponentModel.IContainer components = null;

		public Global()
		{
			InitializeComponent();
		}	
		
		protected void Application_Start(Object sender, EventArgs e)
		{

		}
 
		protected void Session_Start(Object sender, EventArgs e)
		{

		}

		protected void Application_BeginRequest(Object sender, EventArgs e)
		{

		}

		protected void Application_EndRequest(Object sender, EventArgs e)
		{

		}

		protected void Application_AuthenticateRequest(Object sender, EventArgs e)
		{

		}

		protected void Application_Error(Object sender, EventArgs e)
		{

		}

		protected void Session_End(Object sender, EventArgs e)
		{

		}

		protected void Application_End(Object sender, EventArgs e)
		{

		}
			
		#region Web Form Designer generated code
		/// &lt;summary&gt;
		/// Required method for Designer support - do not modify
		/// the contents of this method with the code editor.
		/// &lt;/summary&gt;
		private void InitializeComponent()
		{    
			this.components = new System.ComponentModel.Container();
		}
		#endregion
	}
}


----------------- END CODE Global.asax.cs ------------------------

----------------- START CODE AssemblyInfo.cs ------------------------
using System.Reflection;
using System.Runtime.CompilerServices;


[assembly: AssemblyTitle(&quot;&quot;)]
[assembly: AssemblyDescription(&quot;&quot;)]
[assembly: AssemblyConfiguration(&quot;&quot;)]
[assembly: AssemblyCompany(&quot;&quot;)]
[assembly: AssemblyProduct(&quot;&quot;)]
[assembly: AssemblyCopyright(&quot;&quot;)]
[assembly: AssemblyTrademark(&quot;&quot;)]
[assembly: AssemblyCulture(&quot;&quot;)]		


[assembly: AssemblyVersion(&quot;1.0.*&quot;)]

[assembly: AssemblyDelaySign(false)]
[assembly: AssemblyKeyFile(&quot;&quot;)]
[assembly: AssemblyKeyName(&quot;&quot;)]

----------------- END CODE AssemblyInfo.cs ------------------------

----------------- START CODE Web.config ------------------------
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;configuration&gt;
    
  &lt;system.web&gt;

    &lt;!--  DYNAMIC DEBUG COMPILATION
          
    --&gt;
    &lt;compilation 
         defaultLanguage=&quot;c#&quot;
         debug=&quot;true&quot;
    /&gt;

    &lt;!--  CUSTOM ERROR MESSAGES
          
    --&gt;
    &lt;customErrors 
    mode=&quot;RemoteOnly&quot; 
    /&gt; 

    &lt;!--  AUTHENTICATION 
          
    --&gt;
    &lt;authentication mode=&quot;Windows&quot; /&gt; 

	&lt;!--  AUTHORIZATION 
          
    --&gt;

    &lt;authorization&gt;
        &lt;allow users=&quot;*&quot; /&gt; &lt;!-- Allow all users --&gt;
            &lt;!--  &lt;allow     users=&quot;[comma separated list of users]&quot;
                             roles=&quot;[comma separated list of roles]&quot;/&gt;
                  &lt;deny      users=&quot;[comma separated list of users]&quot;
                             roles=&quot;[comma separated list of roles]&quot;/&gt;
            --&gt;
    &lt;/authorization&gt;

    &lt;!--  APPLICATION-LEVEL TRACE LOGGING
          
    --&gt;
    &lt;trace
        enabled=&quot;false&quot;
        requestLimit=&quot;10&quot;
        pageOutput=&quot;false&quot;
        traceMode=&quot;SortByTime&quot;
		localOnly=&quot;true&quot;
    /&gt;

    &lt;!--  SESSION STATE SETTINGS
          
    --&gt;
    &lt;sessionState 
            mode=&quot;InProc&quot;
            stateConnectionString=&quot;tcpip=127.0.0.1:42424&quot;
            sqlConnectionString=&quot;data source=127.0.0.1;Trusted_Connection=yes&quot;
            cookieless=&quot;false&quot; 
            timeout=&quot;20&quot; 
    /&gt;

    &lt;!--  GLOBALIZATION

    --&gt;
    &lt;globalization 
            requestEncoding=&quot;utf-8&quot; 
            responseEncoding=&quot;utf-8&quot; 
   /&gt;
   
 &lt;/system.web&gt;

&lt;/configuration&gt;

----------------- END CODE Web.config ------------------------


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="026592.html">[Mono-list] No compilation after upgrading
</A></li>
	<LI> Next message: <A HREF="026594.html">[Mono-list] System.DllNotFoundException: oci
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26591">[ date ]</a>
              <a href="thread.html#26591">[ thread ]</a>
              <a href="subject.html#26591">[ subject ]</a>
              <a href="author.html#26591">[ author ]</a>
         </LI>
       </UL>
</body></html>
