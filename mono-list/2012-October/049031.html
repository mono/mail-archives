<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] NuGet struggles
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20NuGet%20struggles&In-Reply-To=%3Ck5ke2a%24euk%241%40ger.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="049025.html">
   <LINK REL="Next"  HREF="049032.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] NuGet struggles</H1>
    <B>Andres G. Aragoneses</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20NuGet%20struggles&In-Reply-To=%3Ck5ke2a%24euk%241%40ger.gmane.org%3E"
       TITLE="[Mono-list] NuGet struggles">knocte at gmail.com
       </A><BR>
    <I>Tue Oct 16 19:54:51 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="049025.html">[Mono-list] NuGet struggles
</A></li>
        <LI>Next message: <A HREF="049032.html">[Mono-list] NuGet struggles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49031">[ date ]</a>
              <a href="thread.html#49031">[ thread ]</a>
              <a href="subject.html#49031">[ subject ]</a>
              <a href="author.html#49031">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/10/12 11:55, Weeble wrote:
&gt;<i> I'm having trouble with NuGet on recent development versions of Mono.
</I>&gt;<i> It works fine on 2.11.1, but on 2.11.2 and 2.11.4 (I haven't tried
</I>&gt;<i> .3), when it tries to download several packages at once it will get
</I>&gt;<i> some of them, but then hang for about two minutes before timing out
</I>&gt;<i> with a message like this:
</I>&gt;<i>
</I>&gt;<i> WARNING: Could not connect to the feed specified at
</I>&gt;<i> '<A HREF="https://nuget.org/api/v2/">https://nuget.org/api/v2/</A>'. Please verify that the package source
</I>&gt;<i> (located in the Package Manager Settings) is valid and ensure your
</I>&gt;<i> network connectivity.
</I>&gt;<i> Unable to find version '0.3.1' of package 'Gate'.
</I>&gt;<i>
</I>&gt;<i> Under 2.11.1 it downloads all the packages in 20 seconds or so. It
</I>&gt;<i> certainly doesn't take close to the amount of time it takes for it to
</I>&gt;<i> time out with recent Mono versions. I've observed this on both a
</I>&gt;<i> 32-bit Linux VM with 4 CPUs (running on a Windows 7 host with a 4 core
</I>&gt;<i> hyperthreaded i7), and on a Mac Mini. It doesn't seem to happen when
</I>&gt;<i> fetching a small number of packages, but seems to become a certainty
</I>&gt;<i> when fetching around five or more. Which package will fail seems to be
</I>&gt;<i> unpredictable, probably because they are all downloaded in parallel.
</I>&gt;<i>
</I>&gt;<i> Here's a paste of a console session showing what I see:
</I>&gt;<i> <A HREF="http://pastebin.com/NeYedE9n">http://pastebin.com/NeYedE9n</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I built NuGet from source (using Visual Studio - I had problems with
</I>&gt;<i> its build files in Mono) and got it to print out the exception stack
</I>&gt;<i> trace that's causing it to fail. I'm not certain that it fails the
</I>&gt;<i> same way every time, but it does fail every time:
</I>&gt;<i>
</I>&gt;<i>   System.Net.WebException: The request timed out
</I>&gt;<i>    at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult)
</I>&gt;<i>    at System.Net.HttpWebRequest.GetResponse ()
</I>&gt;<i>    at System.Data.Services.Client.QueryResult.Execute ()
</I>&gt;<i>    --- End of inner exception stack trace ---
</I>&gt;<i>    at NuGet.DataServiceQueryWrapper`1[NuGet.IPackage].Execute[IEnumerable]
</I>&gt;<i> (System.Func`1 action)
</I>&gt;<i>    at NuGet.DataServiceQueryWrapper`1+&lt;GetAll&gt;d__7[NuGet.IPackage].MoveNext ()
</I>&gt;<i>    at System.Collections.Generic.List`1[NuGet.IPackage].AddEnumerable
</I>&gt;<i> (IEnumerable`1 enumerable)
</I>&gt;<i>    at System.Collections.Generic.List`1[NuGet.IPackage]..ctor
</I>&gt;<i> (IEnumerable`1 collection)
</I>&gt;<i>    at System.Linq.Enumerable.ToList[IPackage] (IEnumerable`1 source)
</I>&gt;<i>    at NuGet.PackageRepositoryExtensions.FindPackagesByIdCore
</I>&gt;<i> (IPackageRepository repository, System.String packageId)
</I>&gt;<i>    at NuGet.PackageRepositoryExtensions.FindPackagesById
</I>&gt;<i> (IPackageRepository repository, System.String packageId)
</I>&gt;<i>    at NuGet.PackageRepositoryExtensions.FindPackage (IPackageRepository
</I>&gt;<i> repository, System.String packageId, NuGet.Semanti
</I>&gt;<i> cVersion version, IPackageConstraintProvider constraintProvider,
</I>&gt;<i> Boolean allowPrereleaseVersions, Boolean allowUnlisted)
</I>&gt;<i>
</I>
It seems this issue only affects Windows platform so maybe this is why 
it is not given priority to be fixed (as you can use MS.NET in Windows). 
AFAIK it is being tracked here:

<A HREF="https://bugzilla.xamarin.com/show_bug.cgi?id=2992">https://bugzilla.xamarin.com/show_bug.cgi?id=2992</A>


&gt;<i> My questions:
</I>&gt;<i>
</I>&gt;<i> 1. Did anything change between 2.11.1 and 2.11.2 that might affect the
</I>&gt;<i> behaviour of HttpWebRequest or System.Data.Services, especially when
</I>&gt;<i> multiple threads are making simultaneous independent requests?
</I>&gt;<i> 2. Any suggestions for next steps to diagnose this?
</I>
There is a reduced test case attached to the bug linked above, so you 
could run a binary search of the exact commit between 2.11.1 and 2.11.2 
that caused it.


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="049025.html">[Mono-list] NuGet struggles
</A></li>
	<LI>Next message: <A HREF="049032.html">[Mono-list] NuGet struggles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49031">[ date ]</a>
              <a href="thread.html#49031">[ thread ]</a>
              <a href="subject.html#49031">[ subject ]</a>
              <a href="author.html#49031">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
