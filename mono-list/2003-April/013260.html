<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] How to get user's HOME directory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jaroslaw.kowalski%40atm.com.pl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="013288.html">
   <LINK REL="Next"  HREF="013271.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] How to get user's HOME directory
   </H1>
    <B>Jaroslaw Kowalski
    </B> 
    <A HREF="mailto:jaroslaw.kowalski%40atm.com.pl"
       TITLE="[Mono-list] How to get user's HOME directory">jaroslaw.kowalski@atm.com.pl
       </A><BR>
    <I>Fri, 4 Apr 2003 23:57:41 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="013288.html">[Mono-list] How to get user's HOME directory
</A></li>
        <LI> Next message: <A HREF="013271.html">[Mono-list] XSP test error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13260">[ date ]</a>
              <a href="thread.html#13260">[ thread ]</a>
              <a href="subject.html#13260">[ subject ]</a>
              <a href="author.html#13260">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All!

HOME doesn't exist on Windows, because it doesn't support a single home
directory concept (in user terms).

Instead you can have:

\Documents and Settings\All Users\Application Data - where application data
that is shared among users is stored
%USERPROFILE%\Application Data - where (roaming) application data other than
documents should be stored
%USERPROFILE%\Local Settings\Application Data - where (non-roaming)
application data other than documents should be stored
%USERPROFILE%\My Documents - where documents (*.doc, *.xsl) are generally
stored

and others.

You shouldn't rely on a HOME or any other environment variable, because
there are more reliable ways to determine this. Windows seems to make it
harder and harder to access environment variables setup with each new
version of OS, so we should expect it to be completely disabled sometime.

Under .NET, there's System.Environment.GetSpecialFolder(). Win32 shell api
also provides a function to do it.

You use it like this:

Console.WriteLine(Environment.GetFolderPath(System.Environment.SpecialFolder
.Personal));

which spits out current &quot;My Documents&quot; path.

Jarek

----- Original Message -----
From: &quot;Piers Haken&quot; &lt;<A HREF="mailto:piersh@friskit.com">piersh@friskit.com</A>&gt;
To: &quot;Stefan Saring&quot; &lt;<A HREF="mailto:stefan.saring@epost.de">stefan.saring@epost.de</A>&gt;; &quot;Marcus&quot;
&lt;<A HREF="mailto:mathpup@mylinuxisp.com">mathpup@mylinuxisp.com</A>&gt;
Cc: &lt;<A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>&gt;
Sent: Friday, April 04, 2003 11:22 PM
Subject: RE: [Mono-list] How to get user's HOME directory


&gt;<i> -----Original Message-----
</I>&gt;<i> From: Stefan Saring [mailto:<A HREF="mailto:stefan.saring@epost.de">stefan.saring@epost.de</A>]
</I>&gt;<i> Sent: Thursday, April 03, 2003 10:54 PM
</I>&gt;<i> To: Marcus
</I>&gt;<i> Cc: <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>
</I>&gt;<i> Subject: Re: [Mono-list] How to get user's HOME directory
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yes. On Windows2000 it's e.g. &quot;C:\Documents and
</I>&gt;<i> Settings\USERNAME\&quot;. This is the place where many
</I>&gt;<i> applications store their user settings and profiles (e.g. Mozilla).
</I>
This isn't necessarily true. Firstly the directory may not be on the
'C:' drive. Secondly, the string 'Documents and Settings' can be
localized. And thirdly the subdirectory may not be the same as the
username. If for any reason the directory exists (dual-boot,
domain/local) then windows setup will pick a new name. In general, you
shouldn't make assumptions about folder names in the user's profile, you
should use the Environment.SPecialFolder enumeration instead.

Piers.
_______________________________________________
Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="013288.html">[Mono-list] How to get user's HOME directory
</A></li>
	<LI> Next message: <A HREF="013271.html">[Mono-list] XSP test error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13260">[ date ]</a>
              <a href="thread.html#13260">[ thread ]</a>
              <a href="subject.html#13260">[ subject ]</a>
              <a href="author.html#13260">[ author ]</a>
         </LI>
       </UL>
</body></html>
