<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Help with ADO.NET Oracle client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:dsp%40rci.rutgers.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="013236.html">
   <LINK REL="Next"  HREF="013223.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Help with ADO.NET Oracle client
   </H1>
    <B>David Pickens
    </B> 
    <A HREF="mailto:dsp%40rci.rutgers.edu"
       TITLE="[Mono-list] Help with ADO.NET Oracle client">dsp@rci.rutgers.edu
       </A><BR>
    <I>Sun, 06 Apr 2003 23:21:41 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="013236.html">[Mono-list] Help with ADO.NET Oracle client
</A></li>
        <LI> Next message: <A HREF="013223.html">[Mono-list] Mono Survey IIA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13284">[ date ]</a>
              <a href="thread.html#13284">[ thread ]</a>
              <a href="subject.html#13284">[ subject ]</a>
              <a href="author.html#13284">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tim,

Thanks for the response.  After some more confusion, I decided to dig 
around in sqlsharp to see what it was doing (that I wasn't) to get the 
oracle client to work.  I discovered that it connects using something 
like the following:

                        conn.ConnectionString = connectionString;
                        try {
                                conn.Open();
                                if(conn.State == ConnectionState.Open)
                                        Console.WriteLine(&quot;Open was 
successfull\.&quot;);
                        }
 
Whereas the sample code from the website (go-mono.org) does:

       IDbConnection dbcon;
       dbcon = new OracleConnection (connectionString);
       dbcon.Open ();

As far as I can tell (which is to say, on my system) the above does not 
work, but changing it so that it sets dbcon.ConnectionString = 
connectionString *does* work.  I don't know if the website or the 
OracleConnection constructor is to blame (or if it's something on my 
system).

One problem down, now on to mod_mono:

You suggested missing environment variables may be to blame, so I 
whipped up an ASP.NET page to print the environment variables mod_mono 
sees from the System.Environment class, and snipping only the relevant 
lines, it shows the following:

PATH= 
/home/oracle/product/8.1.7/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/bin/X11:/usr/local/sbin:/usr/local/bin

ORACLE_HOME= /home/oracle/product/8.1.7

ORACLE_BASE= /home/oracle

LD_LIBRARY_PATH= /home/oracle/product/8.1.7/lib

ORACLE_SID= oracle

The environment seems OK.  I'm hoping that Tim or someone with mod_mono 
experience can tell me why it would have problems loading the oracle 
libraries in mod_mono, but not in a standalone app, given the above.  A 
parital stack trace follows...

System.MissingMethodException: A missing method exception has occurred.
in &lt;0x00046&gt; 06 System.Data.OracleClient.Oci.OciEnvironmentHandle:OCIEnvCreate (intptr&amp;,System.Data.OracleClient.Oci.OciEnvironmentMode,intptr,intptr,intptr,intptr,int,intptr)
in &lt;0x00063&gt; 00 System.Data.OracleClient.Oci.OciEnvironmentHandle:.ctor (System.Data.OracleClient.Oci.OciEnvironmentMode)
in &lt;0x0002c&gt; 00 System.Data.OracleClient.Oci.OciGlue:CreateConnection (System.Data.OracleClient.OracleConnectionInfo)
in &lt;0x0008e&gt; 00 System.Data.OracleClient.OracleConnection:Open ()


Thanks!

David


Tim Coleman wrote:

&gt;<i>On Tue, 2003-04-01 at 23:59, David Pickens wrote: 
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>Let me say first that I'm new to mono, and relatively new to C# (moving 
</I>&gt;&gt;<i>from C++), so the following problems could be a result of my 
</I>&gt;&gt;<i>inexperience, but I can't seem to get the sample code from go-mono.org 
</I>&gt;&gt;<i>to work, nor does my attempt in my own code to open the database 
</I>&gt;&gt;<i>connection work.  (However, using sqlsharp, /Provider Oracle, and a 
</I>&gt;&gt;<i>valid connection string *does* work on the system, and I do have oracle 
</I>&gt;&gt;<i>installed and working correctly on the system in question.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I've corrected the missing casting to strings in the demo code, but when 
</I>&gt;&gt;<i>it does compile successfully, and the connection string is valid I get:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Unhandled Exception: System.NullReferenceException: A null value was 
</I>&gt;&gt;<i>found where an object instance was required
</I>&gt;&gt;<i>in &lt;0x00018&gt; 00 System.Data.OracleClient.Oci.OciServerHandle:Attach ()
</I>&gt;&gt;<i>in &lt;0x00470&gt; 00 System.Data.OracleClient.Oci.OciGlue:CreateConnection 
</I>&gt;&gt;<i>(System.Data.OracleClient.OracleConnectionInfo)
</I>&gt;&gt;<i>in &lt;0x0008e&gt; 00 System.Data.OracleClient.OracleConnection:Open ()
</I>&gt;&gt;<i>in &lt;0x00095&gt; 00 .Test:Main (string[])
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>My own connection code, in an ASP.NET page used by mod_mono/apache2 returns:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>System.MissingMethodException: A missing method exception has occurred.
</I>&gt;&gt;<i>in &lt;0x00046&gt; 06 
</I>&gt;&gt;<i>System.Data.OracleClient.Oci.OciEnvironmentHandle:OCIEnvCreate 
</I>&gt;&gt;<i>(intptr&amp;,System.Data.OracleClient.Oci.OciEnvironmentMode,intptr,intptr,intptr,intptr,int,intptr)
</I>&gt;&gt;<i>in &lt;0x00063&gt; 00 System.Data.OracleClient.Oci.OciEnvironmentHandle:.ctor 
</I>&gt;&gt;<i>(System.Data.OracleClient.Oci.OciEnvironmentMode)
</I>&gt;&gt;<i>in &lt;0x0002c&gt; 00 System.Data.OracleClient.Oci.OciGlue:CreateConnection 
</I>&gt;&gt;<i>(System.Data.OracleClient.OracleConnectionInfo)
</I>&gt;&gt;<i>in &lt;0x0008e&gt; 00 System.Data.OracleClient.OracleConnection:Open ()
</I>&gt;&gt;<i>in &lt;0x00080&gt; 00 GSNB.GSNBDataAccess:.ctor ()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>The version of mono is 0.23 (debs).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Any help will be appreciated!
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>David,
</I>&gt;<i>
</I>&gt;<i>Since the Oracle provider *does* work for you with SQL#, and it seems in
</I>&gt;<i>the first example that the error is occuring in
</I>&gt;<i>OciServerHandle.Attach(), I think that there may be a problem with your
</I>&gt;<i>connection string.  If you could send me the details, perhaps I could
</I>&gt;<i>check it out.
</I>&gt;<i>
</I>&gt;<i>In the second example, it almost seems that it can't find the Oracle
</I>&gt;<i>client libraries that you have installed.  Not knowing much about
</I>&gt;<i>mod_mono, I can't really say why that may be, but you might want to
</I>&gt;<i>check out the LD_LIBRARY_PATH or somesuch for the apache user.
</I>&gt;<i>
</I>&gt;<i>Cheers,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="013236.html">[Mono-list] Help with ADO.NET Oracle client
</A></li>
	<LI> Next message: <A HREF="013223.html">[Mono-list] Mono Survey IIA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13284">[ date ]</a>
              <a href="thread.html#13284">[ thread ]</a>
              <a href="subject.html#13284">[ subject ]</a>
              <a href="author.html#13284">[ author ]</a>
         </LI>
       </UL>
</body></html>
