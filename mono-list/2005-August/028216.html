<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] HttpResponse.TransmitFile method
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20HttpResponse.TransmitFile%20method&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028215.html">
   <LINK REL="Next"  HREF="028217.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] HttpResponse.TransmitFile method</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20HttpResponse.TransmitFile%20method&In-Reply-To="
       TITLE="[Mono-list] HttpResponse.TransmitFile method">kornelpal at hotmail.com
       </A><BR>
    <I>Fri Aug 19 03:08:22 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="028215.html">[Mono-list] HttpResponse.TransmitFile method
</A></li>
        <LI>Next message: <A HREF="028217.html">[Mono-list] HttpResponse.TransmitFile method / Securing files
	other than *.aspx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28216">[ date ]</a>
              <a href="thread.html#28216">[ thread ]</a>
              <a href="subject.html#28216">[ subject ]</a>
              <a href="author.html#28216">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Response.TransmitFile
(<A HREF="http://msdn2.microsoft.com/library/12s31dhy(en-us,vs.80">http://msdn2.microsoft.com/library/12s31dhy(en-us,vs.80</A>).aspx) is supposed
to to high performance direct file to socket transmission. On Win32 using
TransmitFile API
(<A HREF="http://msdn.microsoft.com/library/en-us/winsock/winsock/transmitfile_2.asp">http://msdn.microsoft.com/library/en-us/winsock/winsock/transmitfile_2.asp</A>).
MS ASP.NET implements this through HSE_REQ_TRANSMIT_FILE IIS support
function
(<A HREF="http://msdn.microsoft.com/library/en-us/iissdk/html/d685131e-51bf-446c-b4bb-4770973460df.asp">http://msdn.microsoft.com/library/en-us/iissdk/html/d685131e-51bf-446c-b4bb-4770973460df.asp</A>).

Response.Redirect sends 301 response to the browser and Server.Transfer
executes another request URL that will be executed by the appropriate
handler specified in configuration.

As you can see Response.TransmitFile is no way related to these two methods.
Response.TransmitFile send a file in entiry body, Response.Redirect uses
client side redirect and Server.Transfer uses server side redirect limited
to ASP.NET.

If you want to protect *.zip, *.wmv and *.jpg using ASP.NET you should
configure Apache to handle these files using mod_mono.

Then you could use an authentication module or forms authentication and
StaticFileHandler (assigned to all files by default).

MS.NET StaticFileHandler supports Range and If-Range and caching as well.
These are not implemented in Mono.

StaticFileHandler uses Response.WriteFile but should be considered to use
Response.TransmitFile instead.

Response.TransmitFile is not implemented by Mono and should be implemented
in mod_mono in fact.

If you need the missing functionality you should implement it.

If you don't want to handle the request using ASP.NET then I think you can
only edit Apache configuaration files using an ASP.NET page to allow or
disallow download from a specific IP for example and then redirect user to a
different location protected using configuration file. I think this solution
should not be used.

Korn&#233;l

----- Original Message -----
From: &quot;Marc DM&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">m at phronein.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>&gt;
Sent: Friday, August 19, 2005 7:32 AM
Subject: Re: [Mono-list] HttpResponse.TransmitFile method


&gt;<i> Hey all,
</I>&gt;<i>
</I>&gt;<i> this issue has come back to bite me in the ass.
</I>&gt;<i>
</I>&gt;<i> Response.WriteFile works in Mono/Debian just like it does on Win2k/.NET
</I>&gt;<i>
</I>&gt;<i> It spools the file into RAM before feeding it out to the client.
</I>&gt;<i>
</I>&gt;<i> Response.TransmitFile is supposed to perform the same action as if you
</I>&gt;<i> use Response.Redirect or Server.Transfer without restarting the page
</I>&gt;<i> processing.
</I>&gt;<i>
</I>&gt;<i> Anyone have any ideas on how to protect *.zip, *.wmv and *.jpg files
</I>&gt;<i> behind an apache server with mono/mod_mono?
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i> MDM
</I>&gt;<i>
</I>&gt;<i> On Tue, 2005-06-14 at 15:54 -0700, Joe Audette wrote:
</I>&gt;&gt;<i> Why not use Response.WriteFile?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I use it in mono and it works great.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Joe
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --- Marc DM &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">m at phronein.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Would it be possible for a future release of mono to
</I>&gt;&gt;<i> &gt; include the
</I>&gt;&gt;<i> &gt; unpopular method of the HttpResponse object named
</I>&gt;&gt;<i> &gt; TransmitFile
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Microsoft implemented this method as a solution to
</I>&gt;&gt;<i> &gt; HttpResponse.BinaryWrite spooling the entire file
</I>&gt;&gt;<i> &gt; into RAM before
</I>&gt;&gt;<i> &gt; sending it to the web-user. (see KB article link
</I>&gt;&gt;<i> &gt; below)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I did a google search for &quot;mono
</I>&gt;&gt;<i> &gt; Request.TransmitFile&quot; (without the
</I>&gt;&gt;<i> &gt; quotes) and got 1 english result.
</I>&gt;&gt;<i> &gt; The method isn't documented in MSDN but I found this
</I>&gt;&gt;<i> &gt; on Microsoft's
</I>&gt;&gt;<i> &gt; site :
</I>&gt;&gt;<i> &gt; (from
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> <A HREF="http://support.microsoft.com/default.aspx?scid=kb;en-us;823409">http://support.microsoft.com/default.aspx?scid=kb;en-us;823409</A>)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; &gt; You can use the function instead of the
</I>&gt;&gt;<i> &gt; BinaryWrite function or
</I>&gt;&gt;<i> &gt; &gt; instead of other functions to send files to the
</I>&gt;&gt;<i> &gt; client. Also, this
</I>&gt;&gt;<i> &gt; &gt; function can be used regardless of the size of the
</I>&gt;&gt;<i> &gt; file that you want
</I>&gt;&gt;<i> &gt; &gt; to transmit.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I also found this blog entry explaining its
</I>&gt;&gt;<i> &gt; functionality (a bit)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> <A HREF="http://www.aaronweiker.com/PermaLink,guid,2e9e9d7f-4130-41f7-8104-171f3ece37d4.aspx">http://www.aaronweiker.com/PermaLink,guid,2e9e9d7f-4130-41f7-8104-171f3ece37d4.aspx</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I need this method to compile some code I'm moving
</I>&gt;&gt;<i> &gt; from .NET to mono.
</I>&gt;&gt;<i> &gt; I suspect that I'll have to find another way around
</I>&gt;&gt;<i> &gt; this one.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Has anybody got any ideas?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks in advance,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Marc DM
</I>&gt;&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> joe_audette [at] yahoo dotcom
</I>&gt;&gt;<i> <A HREF="http://www.joeaudette.com">http://www.joeaudette.com</A>
</I>&gt;&gt;<i> <A HREF="http://www.mojoportal.com">http://www.mojoportal.com</A>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028215.html">[Mono-list] HttpResponse.TransmitFile method
</A></li>
	<LI>Next message: <A HREF="028217.html">[Mono-list] HttpResponse.TransmitFile method / Securing files
	other than *.aspx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28216">[ date ]</a>
              <a href="thread.html#28216">[ thread ]</a>
              <a href="subject.html#28216">[ subject ]</a>
              <a href="author.html#28216">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
