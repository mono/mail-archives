<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Npgsql error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Npgsql%20error&In-Reply-To=002f01c5992e%2449439b80%242200a8c0%40jaakntb">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028046.html">
   <LINK REL="Next"  HREF="028053.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Npgsql error</H1>
    <B>Emil Emilov</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Npgsql%20error&In-Reply-To=002f01c5992e%2449439b80%242200a8c0%40jaakntb"
       TITLE="[Mono-list] Npgsql error">emil at emilov.de
       </A><BR>
    <I>Thu Aug  4 17:16:36 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="028046.html">[Mono-list] Npgsql error
</A></li>
        <LI>Next message: <A HREF="028053.html">[Mono-list] Npgsql error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28047">[ date ]</a>
              <a href="thread.html#28047">[ thread ]</a>
              <a href="subject.html#28047">[ subject ]</a>
              <a href="author.html#28047">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Cool, a question on that:
What happens if a exception occurs?
I meand close() gets called at the end of the using block, but does it get also called when an exception occurs (sort of finally)?
If yes, I'm changing my programming style :)
Another question, how would it look like if you had to catch an exception (i.e. to rollback a transaction)?

Thanx :)

Jaroslaw Kowalski wrote:
&gt;<i> Hi Emil,
</I>&gt;<i> 
</I>&gt;&gt;<i> Also another tip: you don't need to explicitly set connection etc. to 
</I>&gt;&gt;<i> null.
</I>&gt;&gt;<i> Cosider following improvement:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> IDbConnection dbcon;
</I>&gt;&gt;<i> IDbCommand dbcmd;
</I>&gt;&gt;<i> IDataReader reader;
</I>&gt;&gt;<i> try {
</I>&gt;<i> 
</I>&gt;<i> ...
</I>&gt;<i> 
</I>&gt;&gt;<i> } finally {
</I>&gt;&gt;<i>  // cleanup, even if error occurs, closing the reader is important 
</I>&gt;&gt;<i> because while it is open no other reader can be opened
</I>&gt;&gt;<i>  if (reader!=null) reader.Close();
</I>&gt;&gt;<i>  if (dbcmd!=null) dbcmd.Close();
</I>&gt;&gt;<i>  if (dbcon!=null) dbcon.Close();
</I>&gt;&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> A small tip: Your example is very java-ish. You could reduce the amount 
</I>&gt;<i> of code by using C# using() statement which provides automatic cleanup 
</I>&gt;<i> for connection, command and reader. I believe that the following is much 
</I>&gt;<i> more readable and saves a lot of typing:
</I>&gt;<i> 
</I>&gt;<i> =====
</I>&gt;<i> using (IDbConnection c = new NpgsqlConnection(&quot;connectionString&quot;))
</I>&gt;<i> {
</I>&gt;<i>    c.Open();
</I>&gt;<i>    using (IDbCommand cmd = c.CreateCommand())
</I>&gt;<i>    {
</I>&gt;<i>        cmd.CommandText = &quot;...&quot;;
</I>&gt;<i>        using (IDataReader reader = cmd.ExecuteReader();
</I>&gt;<i>        {
</I>&gt;<i>            while (reader.Read())
</I>&gt;<i>            {
</I>&gt;<i>            }
</I>&gt;<i>        }
</I>&gt;<i> }
</I>&gt;<i> ======
</I>
-- 
Emil R. Emilov
-----------------------------------------------------------------------
mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">emil at emilov.de</A>
<A HREF="http://www.emilov.de">http://www.emilov.de</A>
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028046.html">[Mono-list] Npgsql error
</A></li>
	<LI>Next message: <A HREF="028053.html">[Mono-list] Npgsql error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28047">[ date ]</a>
              <a href="thread.html#28047">[ thread ]</a>
              <a href="subject.html#28047">[ subject ]</a>
              <a href="author.html#28047">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
