<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] DllImport behaves different between .Net and Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DllImport%20behaves%20different%20between%20.Net%20and%20Mono&In-Reply-To=BEC97EDB521B0E428C5166E0223B7C1B1D9D39%40PA-EXCH03.vmware.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035799.html">
   <LINK REL="Next"  HREF="035792.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] DllImport behaves different between .Net and Mono</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DllImport%20behaves%20different%20between%20.Net%20and%20Mono&In-Reply-To=BEC97EDB521B0E428C5166E0223B7C1B1D9D39%40PA-EXCH03.vmware.com"
       TITLE="[Mono-list] DllImport behaves different between .Net and Mono">jonpryor at vt.edu
       </A><BR>
    <I>Fri Jul 27 13:50:49 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035799.html">[Mono-list] DllImport behaves different between .Net and Mono
</A></li>
        <LI>Next message: <A HREF="035792.html">[Mono-list] Where can I find/read roadmap information about mono	for ARM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35800">[ date ]</a>
              <a href="thread.html#35800">[ thread ]</a>
              <a href="subject.html#35800">[ subject ]</a>
              <a href="author.html#35800">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2007-07-27 at 10:24 -0700, Steven Schulze wrote:
&gt;<i> According to the link you provided, it says the DLL is searched like this:
</I>&gt;<i> 
</I>&gt;<i> 1) The directory from which the application loaded. 
</I>&gt;<i> 2) The current directory.
</I>&gt;<i> 3) ...
</I>&gt;<i> 
</I>&gt;<i> At least from my testing, neither of the first two cases work as stated.
</I>
The first case should work as stated.  The fundamental problem is this:

	rem .NET invocation:
	Path\To\YourAppName.exe

	rem Mono invocation
	mono Path\To\YourAppName.exe

In the former, YourAppName.exe is the application which loaded, so &quot;Path
\To&quot; is the directory that Win32 uses when looking for libraries.

For the latter case, *mono* is the application which is loaded, so
Mono's application directory is the directory that Win32 uses when
looking for libraries.

Oops.

Which is where the current working directory would come in...except that
you NEVER want to rely on the current working directory, because it will
change (based on where the user was when they start your app).  So even
if it worked, it's not a decent solution.

So you fall back to modifying %PATH%, etc., which is also ugly...

I thought Mono had a hack in place to load libraries from the assemblies
directory instead of just relying on LoadLibrary(), but I may be
mistaken.

In short, if Mono isn't properly finding the directory, what you'll
likely need to do (for now) is create a wrapper .cmd script file which
sets %PATH% to include the application's directory; this way Mono will
be able to LoadLibrary() your DLLs (as LoadLibrary() will find them).

 - Jon


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035799.html">[Mono-list] DllImport behaves different between .Net and Mono
</A></li>
	<LI>Next message: <A HREF="035792.html">[Mono-list] Where can I find/read roadmap information about mono	for ARM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35800">[ date ]</a>
              <a href="thread.html#35800">[ thread ]</a>
              <a href="subject.html#35800">[ subject ]</a>
              <a href="author.html#35800">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
