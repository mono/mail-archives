<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Need%20help%20with%20DllImport%20%28P/Invoke%29%20and%20UCS-4%0A%09unicode&In-Reply-To=1184556750.31671.47.camel%40erandi.dom">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035660.html">
   <LINK REL="Next"  HREF="035662.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode</H1>
    <B>Christian Heimes</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Need%20help%20with%20DllImport%20%28P/Invoke%29%20and%20UCS-4%0A%09unicode&In-Reply-To=1184556750.31671.47.camel%40erandi.dom"
       TITLE="[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode">lists at cheimes.de
       </A><BR>
    <I>Tue Jul 17 11:28:11 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035660.html">[Mono-list] Need help with DllImport (P/Invoke) and	UCS-4	unicode
</A></li>
        <LI>Next message: <A HREF="035662.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35661">[ date ]</a>
              <a href="thread.html#35661">[ thread ]</a>
              <a href="subject.html#35661">[ subject ]</a>
              <a href="author.html#35661">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Miguel de Icaza wrote:
&gt;<i> Sadly, you have to do it manually.
</I>&gt;<i> 
</I>&gt;<i> We brought this up a few times at ECMA and three or four times with
</I>&gt;<i> different people at Microsoft and we did not get very far.     The
</I>&gt;<i> solution is trivial, and we could implement it in Mono (expand the
</I>&gt;<i> CharSet definition to include UTF8, UCS4 explicit encodings), but it
</I>&gt;<i> would not be compatible with .NET, so we decided against doing it.
</I>
It's a shame that a product which is advertised cross platform
compatible doesn't implement or at least provide support for important
standards. IIRC Charset.Unicode is equal to Little Endian UCS-2. Charset
does neither take UTF-8 and UCS-4 nor Big Endian into account. :(

With the incredible help from both Jonathans I was able to adapt the
code to UCS-4. The custom marshaler for input works like a charm and I'm
going to test the output marshaling later.

Somebody should add some sample code to
<A HREF="http://www.mono-project.com/Interop_with_Native_Libraries#P.2FInvoke_Specification">http://www.mono-project.com/Interop_with_Native_Libraries#P.2FInvoke_Specification</A>
for the next poor developers.

By the way Mono works better than I had expected. I got PythonNet pretty
much running. I run into some problems with ref counting (Mono seems to
be more sensitive to bugs than .NET) and two unit tests related to
overloading and generics aren't passing but the rest works. Well done!

Christian

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035660.html">[Mono-list] Need help with DllImport (P/Invoke) and	UCS-4	unicode
</A></li>
	<LI>Next message: <A HREF="035662.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35661">[ date ]</a>
              <a href="thread.html#35661">[ thread ]</a>
              <a href="subject.html#35661">[ subject ]</a>
              <a href="author.html#35661">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
