<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Need%20help%20with%20DllImport%20%28P/Invoke%29%20and%20UCS-4%0A%09unicode&In-Reply-To=f7efqg%24a0o%241%40sea.gmane.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035627.html">
   <LINK REL="Next"  HREF="035629.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode</H1>
    <B>Jonathan Chambers</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Need%20help%20with%20DllImport%20%28P/Invoke%29%20and%20UCS-4%0A%09unicode&In-Reply-To=f7efqg%24a0o%241%40sea.gmane.org"
       TITLE="[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode">joncham at gmail.com
       </A><BR>
    <I>Sun Jul 15 22:24:40 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035627.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4 unicode
</A></li>
        <LI>Next message: <A HREF="035629.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35628">[ date ]</a>
              <a href="thread.html#35628">[ thread ]</a>
              <a href="subject.html#35628">[ subject ]</a>
              <a href="author.html#35628">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Christian,
     I had the same problem in a different setting. I use a custom
marshaller (<A HREF="http://msdn2.microsoft.com/en-us/library/d3cxf9f0.aspx">http://msdn2.microsoft.com/en-us/library/d3cxf9f0.aspx</A>) for
strings in all of my pinvokes. It's pretty straightforward setting up a
custom marshaller if you follow the link above. If you need more details let
me know.

Thanks,
Jonathan

On 7/15/07, Christian Heimes &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">lists at cheimes.de</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Hello!
</I>&gt;<i>
</I>&gt;<i> I'm working on PythonNet (<A HREF="http://pythonnet.sourceforge.net/">http://pythonnet.sourceforge.net/</A>). PythonNet
</I>&gt;<i> is an integration of the C library into .NET which allows a developer to
</I>&gt;<i> use .NET code inside Python or Python inside .NET. In the past few weeks
</I>&gt;<i> I've fixed a bunch of outstanding bugs and ported PythonNet to Python
</I>&gt;<i> 2.5. It works pretty well on Windows.
</I>&gt;<i>
</I>&gt;<i> However Linux with mono is a different story. Under Windows Python is
</I>&gt;<i> using a UCS-2 to store unicode but most Linux distributions (Debian,
</I>&gt;<i> Ubuntu and probably Redhat and SuSE) are compiling Python with UCS-4.
</I>&gt;<i> .NET supports only 2 byte unicode. My problem is perfectly explain at
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.mono-project.com/Interop_with_Native_Libraries#P.2FInvoke_Specification">http://www.mono-project.com/Interop_with_Native_Libraries#P.2FInvoke_Specification</A>
</I>&gt;<i>
</I>&gt;<i> One of the problematic function look like:
</I>&gt;<i>
</I>&gt;<i>     [DllImport(Runtime.dll, CallingConvention = CallingConvention.Cdecl,
</I>&gt;<i>            EntryPoint = &quot;PyUnicodeUCS4_FromUnicode&quot;,
</I>&gt;<i>            ExactSpelling = true, CharSet = CharSet.Unicode)]
</I>&gt;<i>     internal unsafe static extern IntPtr
</I>&gt;<i>     PyUnicode_FromUnicode(string s, int size);
</I>&gt;<i>
</I>&gt;<i> More functions can be found at
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://pythonnet.svn.sourceforge.net/svnroot/pythonnet/branches/clr-2.0-python-2.5-branch/src/runtime/runtime.cs">https://pythonnet.svn.sourceforge.net/svnroot/pythonnet/branches/clr-2.0-python-2.5-branch/src/runtime/runtime.cs</A>
</I>&gt;<i>
</I>&gt;<i> How should I solve the issue? Has Mono some generic solution for the
</I>&gt;<i> general issue of UCS-4 vs. UCS-2 unicode or do I have to convert the
</I>&gt;<i> stuff manually by wrapping every external method? If I have to convert
</I>&gt;<i> it manually is System.Text.Encoding.UTF32 the right module?
</I>&gt;<i>
</I>&gt;<i> Christian
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20070715/466e47e6/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20070715/466e47e6/attachment.html</A> 
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035627.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4 unicode
</A></li>
	<LI>Next message: <A HREF="035629.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35628">[ date ]</a>
              <a href="thread.html#35628">[ thread ]</a>
              <a href="subject.html#35628">[ subject ]</a>
              <a href="author.html#35628">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
