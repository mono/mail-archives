<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] DllImport behaves different between .Net and Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DllImport%20behaves%20different%20between%20.Net%20and%20Mono&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035790.html">
   <LINK REL="Next"  HREF="035794.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] DllImport behaves different between .Net and Mono</H1>
    <B>Steven Schulze</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DllImport%20behaves%20different%20between%20.Net%20and%20Mono&In-Reply-To="
       TITLE="[Mono-list] DllImport behaves different between .Net and Mono">sschulze at vmware.com
       </A><BR>
    <I>Fri Jul 27 11:27:13 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035790.html">[Mono-list] Embedding Mono and .Net 2.0 assemblies
</A></li>
        <LI>Next message: <A HREF="035794.html">[Mono-list] DllImport behaves different between .Net and Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35791">[ date ]</a>
              <a href="thread.html#35791">[ thread ]</a>
              <a href="subject.html#35791">[ subject ]</a>
              <a href="author.html#35791">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,
 
I am using DllImport to interop with a C DLL I wrote in order to communicate
with automation tools.  Note that this is only needed on Windows. All works
well but I have this one problem...
 
On .Net, the DLL is found if I just use the dll name by itself, not the full
path, something like: 
 
    [DllImport(@&quot;Foo.dll&quot;)]
    public static extern bool Bar(string text);
 
On Mono, the DLL is not found unless I hardcode the full path, something like
this:
 
    [DllImport(@&quot;C:\Program Files\MyApp\Foo.dll&quot;)]
    public static extern bool Bar(string text);
 
This presents a problem because I cannot make assumptions about where the app
will end up when it gets installed.  It seems a bad idea to hard code the
absolute path of anything at compile time.  How can I make Mono act like .Net
in this regard?  Once again, this part of the code will only get executed
when running on Windows.
 
Thanks in advance for any help with this!
 
Steven
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20070727/7e1914dc/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20070727/7e1914dc/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035790.html">[Mono-list] Embedding Mono and .Net 2.0 assemblies
</A></li>
	<LI>Next message: <A HREF="035794.html">[Mono-list] DllImport behaves different between .Net and Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35791">[ date ]</a>
              <a href="thread.html#35791">[ thread ]</a>
              <a href="subject.html#35791">[ subject ]</a>
              <a href="author.html#35791">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
