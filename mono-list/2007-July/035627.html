<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Need help with DllImport (P/Invoke) and UCS-4 unicode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Need%20help%20with%20DllImport%20%28P/Invoke%29%20and%20UCS-4%20unicode&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035639.html">
   <LINK REL="Next"  HREF="035628.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Need help with DllImport (P/Invoke) and UCS-4 unicode</H1>
    <B>Christian Heimes</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Need%20help%20with%20DllImport%20%28P/Invoke%29%20and%20UCS-4%20unicode&In-Reply-To="
       TITLE="[Mono-list] Need help with DllImport (P/Invoke) and UCS-4 unicode">lists at cheimes.de
       </A><BR>
    <I>Sun Jul 15 20:57:47 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035639.html">[Mono-list] TcpChannel constructor throws SocketException with	DHCP on Mac OS X
</A></li>
        <LI>Next message: <A HREF="035628.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35627">[ date ]</a>
              <a href="thread.html#35627">[ thread ]</a>
              <a href="subject.html#35627">[ subject ]</a>
              <a href="author.html#35627">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello!

I'm working on PythonNet (<A HREF="http://pythonnet.sourceforge.net/">http://pythonnet.sourceforge.net/</A>). PythonNet
is an integration of the C library into .NET which allows a developer to
use .NET code inside Python or Python inside .NET. In the past few weeks
I've fixed a bunch of outstanding bugs and ported PythonNet to Python
2.5. It works pretty well on Windows.

However Linux with mono is a different story. Under Windows Python is
using a UCS-2 to store unicode but most Linux distributions (Debian,
Ubuntu and probably Redhat and SuSE) are compiling Python with UCS-4.
.NET supports only 2 byte unicode. My problem is perfectly explain at
<A HREF="http://www.mono-project.com/Interop_with_Native_Libraries#P.2FInvoke_Specification">http://www.mono-project.com/Interop_with_Native_Libraries#P.2FInvoke_Specification</A>

One of the problematic function look like:

    [DllImport(Runtime.dll, CallingConvention = CallingConvention.Cdecl,
           EntryPoint = &quot;PyUnicodeUCS4_FromUnicode&quot;,
           ExactSpelling = true, CharSet = CharSet.Unicode)]
    internal unsafe static extern IntPtr
    PyUnicode_FromUnicode(string s, int size);

More functions can be found at
<A HREF="https://pythonnet.svn.sourceforge.net/svnroot/pythonnet/branches/clr-2.0-python-2.5-branch/src/runtime/runtime.cs">https://pythonnet.svn.sourceforge.net/svnroot/pythonnet/branches/clr-2.0-python-2.5-branch/src/runtime/runtime.cs</A>

How should I solve the issue? Has Mono some generic solution for the
general issue of UCS-4 vs. UCS-2 unicode or do I have to convert the
stuff manually by wrapping every external method? If I have to convert
it manually is System.Text.Encoding.UTF32 the right module?

Christian

</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035639.html">[Mono-list] TcpChannel constructor throws SocketException with	DHCP on Mac OS X
</A></li>
	<LI>Next message: <A HREF="035628.html">[Mono-list] Need help with DllImport (P/Invoke) and UCS-4	unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35627">[ date ]</a>
              <a href="thread.html#35627">[ thread ]</a>
              <a href="subject.html#35627">[ subject ]</a>
              <a href="author.html#35627">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
