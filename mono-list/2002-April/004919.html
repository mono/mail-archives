<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Update class status?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Gaurav.Vaish%40iitk.ac.in">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="004922.html">
   <LINK REL="Next"  HREF="004920.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Update class status?
   </H1>
    <B>Gaurav Vaish
    </B> 
    <A HREF="mailto:Gaurav.Vaish%40iitk.ac.in"
       TITLE="[Mono-list] Update class status?">Gaurav.Vaish@iitk.ac.in
       </A><BR>
    <I>Fri, 12 Apr 2002 00:41:39 +0530</I>
    <P><UL>
        <LI> Previous message: <A HREF="004922.html">[Mono-list] Update class status?
</A></li>
        <LI> Next message: <A HREF="004920.html">[Mono-list] Update class status?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4919">[ date ]</a>
              <a href="thread.html#4919">[ thread ]</a>
              <a href="subject.html#4919">[ subject ]</a>
              <a href="author.html#4919">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_003E_01C1E1BA.CED66BD0
Content-Type: multipart/alternative;
	boundary=&quot;----=_NextPart_001_003F_01C1E1BA.CED66BD0&quot;


------=_NextPart_001_003F_01C1E1BA.CED66BD0
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: quoted-printable

Update class status?HI,
    I made a small tool to do so for myself.
    If you need it, I am attaching it with this mail. But the input is =
assumed to be in a specific format. Once you read the initial comments =
in any of my commits (*.cs files), you can easily make out.

HIH

Cheers,
Gaurav Vaish
<A HREF="http://home.iitk.ac.in/student/gvaish">http://home.iitk.ac.in/student/gvaish</A>
<A HREF="http://calendar.yahoo.com/mastergaurav">http://calendar.yahoo.com/mastergaurav</A>
---------------------------------


  ----- Original Message -----=20
  From: Patrik Torstensson=20
  To: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>=20
  Sent: Thursday, April 11, 2002 23:15
  Subject: [Mono-list] Update class status?


  Hi all,=20

  Can I generate a new class status page by my self?=20

  - Patrik=20


------=_NextPart_001_003F_01C1E1BA.CED66BD0
Content-Type: text/html;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: quoted-printable

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;
&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Update class status?&lt;/TITLE&gt;
&lt;META content=3D&quot;text/html; charset=3Diso-8859-1&quot; =
http-equiv=3DContent-Type&gt;
&lt;META content=3D&quot;MSHTML 5.00.3018.900&quot; name=3DGENERATOR&gt;
&lt;STYLE&gt;&lt;/STYLE&gt;
&lt;/HEAD&gt;
&lt;BODY bgColor=3D#ffffff&gt;
&lt;DIV&gt;&lt;FONT size=3D2&gt;HI,&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=3D2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; I made a small tool to do so for=20
myself.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=3D2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; If you need it, I am attaching it =
with this=20
mail. But the input is assumed to be in a specific format. Once you read =
the=20
initial comments in any of my commits (*.cs files), you can easily make=20
out.&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT size=3D2&gt;HIH&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;BR&gt;Cheers,&lt;BR&gt;Gaurav Vaish&lt;BR&gt;&lt;A=20
href=3D&quot;<A HREF="http://home.iitk.ac.in/student/gvaish"">http://home.iitk.ac.in/student/gvaish&quot;</A>&gt;<A HREF="http://home.iitk.ac.in/stu=">http://home.iitk.ac.in/stu=</A>
dent/gvaish&lt;/A&gt;&lt;BR&gt;&lt;A=20
href=3D&quot;<A HREF="http://calendar.yahoo.com/mastergaurav"">http://calendar.yahoo.com/mastergaurav&quot;</A>&gt;<A HREF="http://calendar.yahoo.com=">http://calendar.yahoo.com=</A>
/mastergaurav&lt;/A&gt;&lt;BR&gt;---------------------------------&lt;/DIV&gt;
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;BLOCKQUOTE=20
style=3D&quot;BORDER-LEFT: #000000 2px solid; MARGIN-LEFT: 5px; MARGIN-RIGHT: =
0px; PADDING-LEFT: 5px; PADDING-RIGHT: 0px&quot;&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;----- Original Message ----- &lt;/DIV&gt;
  &lt;DIV=20
  style=3D&quot;BACKGROUND: #e4e4e4; FONT: 10pt arial; font-color: =
black&quot;&gt;&lt;B&gt;From:&lt;/B&gt;=20
  &lt;A href=3D&quot;mailto:<A HREF="mailto:totte@labs2.com">totte@labs2.com</A>&quot; title=<A HREF="mailto:3Dtotte@labs2.com">3Dtotte@labs2.com</A>&gt;Patrik =
Torstensson&lt;/A&gt;=20
  &lt;/DIV&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;To:&lt;/B&gt; &lt;A =
href=3D&quot;mailto:<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&quot;=20
  title=<A HREF="mailto:3Dmono-list@ximian.com">3Dmono-list@ximian.com</A>&gt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&lt;/A&gt; &lt;/DIV&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Sent:&lt;/B&gt; Thursday, April 11, 2002=20
23:15&lt;/DIV&gt;
  &lt;DIV style=3D&quot;FONT: 10pt arial&quot;&gt;&lt;B&gt;Subject:&lt;/B&gt; [Mono-list] Update =
class=20
  status?&lt;/DIV&gt;
  &lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;&lt;!-- Converted from text/rtf format --&gt;
  &lt;P&gt;&lt;FONT face=3DVerdana size=3D2&gt;Hi all,&lt;/FONT&gt; &lt;/P&gt;
  &lt;P&gt;&lt;FONT face=3DVerdana size=3D2&gt;Can I generate a new class status =
page by my=20
  self? &lt;/FONT&gt;&lt;/P&gt;
  &lt;P&gt;&lt;FONT face=3DVerdana size=3D2&gt;- Patrik&lt;/FONT&gt; =
&lt;/P&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;

------=_NextPart_001_003F_01C1E1BA.CED66BD0--

------=_NextPart_000_003E_01C1E1BA.CED66BD0
Content-Type: application/octet-stream;
	name=&quot;ClassElement.cs&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;ClassElement.cs&quot;

/*
 * Namespace: com.mastergaurav.utils
 * Class:     ClassElement
 *=20
 * Maintainer: <A HREF="mailto:mastergaurav@users.sourceforge.net">mastergaurav@users.sourceforge.net</A>
 * Name:       Gaurav Vaish
 * Status:     100%
 * Implementation: yes
 * Test-Suite: yes
 *=20
 * (C) Gaurav Vaish, 2001
 */

using System.IO;
using System;
using System.Collections;

namespace CSDOC.Utils
{
	public class ClassElement
	{
		private string className;
		private string lastActivity;
		private string implementation;
		private string testSuite;
		private string completion;
		private ArrayList maintainers;

		public const string LAST_ACT =3D &quot;last-activity&quot;;
		public const string IMPL     =3D &quot;implementation&quot;;
		public const string TS       =3D &quot;test-suite&quot;;
		public const string COMPL    =3D &quot;completion&quot;;
		public const string MAINTS   =3D &quot;maintainers&quot;;
		public const string MAINT    =3D &quot;maintainer&quot;;

		public bool IsAllSet()
		{
			return (className!=3Dnull &amp;&amp; maintainers!=3Dnull &amp;&amp; =
maintainers.Count&gt;0);
		}
	=09
		public string GetXmlData(string tab)
		{
			if(className!=3Dnull)
			{
				string retVal =3D tab + &quot;\t&lt;class name=3D\&quot;&quot;;
				retVal +=3D className;
				retVal +=3D &quot;\&quot;&gt;\n&quot;;
				retVal +=3D (tab + &quot;\t\t&lt;&quot; + LAST_ACT + &quot;&gt;&quot; + lastActivity + &quot;&lt;/&quot; + =
LAST_ACT + &quot;&gt;\n&quot;);
				retVal +=3D (tab + &quot;\t\t&lt;&quot; + IMPL + &quot;&gt;&quot; + implementation + &quot;&lt;/&quot; + =
IMPL + &quot;&gt;\n&quot;);
				retVal +=3D (tab + &quot;\t\t&lt;&quot; + TS + &quot;&gt;&quot; + testSuite + &quot;&lt;/&quot; + TS + =
&quot;&gt;\n&quot;);
				retVal +=3D (tab + &quot;\t\t&lt;&quot; + COMPL + &quot;&gt;&quot; + completion + &quot;&lt;/&quot; + COMPL =
+ &quot;&gt;\n&quot;);
				retVal +=3D (tab + &quot;\t\t&lt;&quot; + MAINTS + &quot;&gt;\n&quot;);
				for(int i=3D0; i &lt; maintainers.Count; i++)
				{
					retVal +=3D (tab + &quot;\t\t\t&lt;&quot; + MAINT + &quot;&gt;&quot;);
					retVal +=3D ((string)maintainers[i]);
					retVal +=3D (&quot;&lt;/&quot; + MAINT + &quot;&gt;\n&quot;);
				}
				retVal +=3D (tab + &quot;\t\t&lt;/&quot; + MAINTS + &quot;&gt;\n&quot;);
				retVal +=3D (tab + &quot;\t&lt;/class&gt;\n&quot;);
				return retVal;
			}
			return null;
		}

		public ClassElement(string className)
		{
			this.className =3D className;
			Initialize();
		}
	=09
		protected void Initialize()
		{
			lastActivity =3D String.Empty;
			implementation =3D &quot;yes&quot;;
			testSuite =3D &quot;no&quot;;
			completion =3D &quot;0%&quot;;
			maintainers =3D new ArrayList();
		}
	=09
		public string LastActivity
		{
			get
			{
				return lastActivity;
			}
			set
			{
				lastActivity =3D value;
			}
		}
	=09
		public string Implementation
		{
			get
			{
				return implementation;
			}
			set
			{
				implementation =3D value;
			}
		}
	=09
		public string TestSuite
		{
			get
			{
				return testSuite;
			}
			set
			{
				testSuite =3D value;
			}
		}
	=09
		public string Completion
		{
			get
			{
				return completion;
			}
			set
			{
				completion =3D value;
			}
		}
	=09
		public ArrayList Maintainers
		{
			get
			{
				return maintainers;
			}
			set
			{
				maintainers =3D value;
			}
		}
	=09
		public void AddMaintainer(string name)
		{
			maintainers.Add(name);
		}
	}
}

------=_NextPart_000_003E_01C1E1BA.CED66BD0
Content-Type: application/octet-stream;
	name=&quot;Status.cs&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;Status.cs&quot;

/**
 * Namespace: com.mastergaurav.utils
 * Class:     Status
 *=20
 * Maintainer: <A HREF="mailto:mastergaurav@users.sourceforge.net">mastergaurav@users.sourceforge.net</A>
 * Name:       Gaurav Vaish
 * Status:     100%
 * Implementation: yes
 * Test-Suite: yes
 *=20
 * (C) Gaurav Vaish, 2001
 */

using System.IO;
using System;
using System.Collections;

namespace CSDOC.Utils
{
	public class Status
	{
		private string baseDir;
		private string statusFile;
		bool isDir;
		FileAttributes attrs;		// attribute of the baseDir
		ArrayList filesToRead;		// files to read
		//ArrayList listOfElements;	// data to write
		ClassElement currElem;		// the one that is being processed
		string[] mths =3D {
			&quot;Jan&quot;,
			&quot;Feb&quot;,
			&quot;Mar&quot;,
			&quot;Apr&quot;,
			&quot;May&quot;,
			&quot;Jun&quot;,
			&quot;Jul&quot;,
			&quot;Aug&quot;,
			&quot;Sep&quot;,
			&quot;Oct&quot;,
			&quot;Nov&quot;,
			&quot;Dec&quot;
		};
	=09
		public Status(string baseDir, string statusFile)
		{
			this.baseDir =3D baseDir;
			if(baseDir=3D=3Dnull)
				return;
			try
			{
				attrs =3D File.GetAttributes(this.baseDir);
				isDir  =3D ((attrs &amp; FileAttributes.Directory) =3D=3D =
FileAttributes.Directory);
				this.statusFile =3D ((statusFile=3D=3DString.Empty || =
statusFile=3D=3Dnull) ? &quot;class.xml&quot; : statusFile);
			} catch(Exception e)
			{
				this.baseDir =3D null;
				this.isDir =3D false;
				System.Console.WriteLine(&quot;Execption: {0}&quot;, e.ToString());
				return;
			}
		}
	=09
		public ArrayList GetFilesToRead()
		{
			if(this.baseDir=3D=3Dnull)
				return null;
			if(isDir)
				return GetFilesToRead(this.baseDir);
			return null;
		}

		//returns the name of the file where the data is stored
		public void GenerateStatusFile()
		{
			//System.Console.WriteLine(&quot;Writing in the file: {0}&quot;, statusFile);
			filesToRead =3D GetFilesToRead();
			StreamWriter writer;
			try
			{
				Stream stream =3D new FileStream(statusFile, FileMode.Truncate, =
FileAccess.Write);
				writer =3D new StreamWriter(stream);
			} catch(FileNotFoundException e)
			{
				writer =3D File.CreateText(statusFile);
			}
			writer.Write(&quot;&lt;classes&gt;\n&quot;);
			for(int i=3D0; i &lt; filesToRead.Count; i++)
			{
				string fileName =3D (string)(filesToRead[i]);
				//System.Console.WriteLine(&quot;-----File: {0}-----&quot;, filesToRead[i]);
				currElem =3D ReadFromFile(fileName);
				//writer.Write(&quot;Alpha\r\n&quot;);
				if(currElem=3D=3Dnull)
					continue;
				writer.Write(currElem.GetXmlData(&quot;\t&quot;));
				writer.Write(&quot;\n&quot;);
				writer.Flush();
			}
			writer.Write(&quot;&lt;/classes&gt;&quot;);
			writer.Flush();
			writer.Close();
			//return statusFile;
		}
	=09
		private ClassElement ReadFromFile(string file)
		{
			Stream stream            =3D null;
			StreamReader reader      =3D null;
			ClassElement currElement =3D null;
			try
			{
				stream =3D new FileStream(file, FileMode.Open, FileAccess.Read);
				reader =3D new StreamReader(stream);
				if(reader.ReadLine().ToLower().IndexOf(&quot;exclude&quot;) &gt;=3D0)
				{
					System.Console.WriteLine(&quot;Excluding {0}&quot;, file);
					stream.Close();
					reader.Close();
					return null;
				}
				string data;
				string val;
				int filled =3D 0x00;			// xxxx|impl|t_suit|compl|maints|
				string className =3D GetFullClassName(file);
				string l_act =3D ConvertToString(File.GetLastWriteTime(file));
				currElement =3D new ClassElement(className);
				currElement.LastActivity =3D l_act;
				while((data=3Dreader.ReadLine())!=3Dnull)
				{
					int isUseful =3D ParseLine(data, out val);
					if((isUseful&lt;0) || ((filled &amp; isUseful)!=3D0x00))
						continue;
					switch(isUseful)
					{
						case 0x01:	// Maintainer
									string[] all =3D val.Split(new Char[] {','});
									foreach(string mtr in all)
									{
										currElement.AddMaintainer(mtr.Trim());
									}
									break;
						case 0x02:	// Completion
									currElement.Completion =3D val;
									break;
						case 0x04:	// Test-Suite
									currElement.TestSuite =3D val;
									break;
						case 0x08:	// Implementation
									currElement.Implementation =3D val;
									break;
						default:	break;
					}
					filled |=3D isUseful;
					if((filled &amp; 0x0F)=3D=3D0x0F)
					{
						break;
					}
				}
				stream.Close();
				reader.Close();
				if(currElement.IsAllSet())
					return currElement;
				else
					return null;
			}catch(Exception e)
			{
				System.Console.WriteLine(&quot;Exception: {0}&quot;, e.ToString());
			}
			if(stream!=3Dnull)
				stream.Close();
			if(reader!=3Dnull)
				reader.Close();
			return null;
		}
	=09
		private string GetFullClassName(string file)
		{
			file =3D file.Replace(&quot;\\&quot;,&quot;/&quot;);
			string nsDir =3D (Directory.GetParent(file)).ToString();			=
//namespace
			nsDir =3D nsDir.Replace(&quot;\\&quot;,&quot;/&quot;);
			string ns =3D nsDir.Substring(nsDir.LastIndexOf(&quot;/&quot;)+1);
			return (ns + &quot;.&quot; + file.Substring(file.LastIndexOf(&quot;/&quot;)+1, =
file.LastIndexOf(&quot;.&quot;) - file.LastIndexOf(&quot;/&quot;)-1));
		}
	=09
		private int ParseLine(string data, out string val)
		{
			string[] spData;
			spData =3D data.Split(new Char[] {':'});
			int retVal =3D -1;
			if(spData.Length&lt;2)
			{
				val =3D null;
				return -1;
			}
			spData[1] =3D spData[1].Trim();
			string temp =3D spData[0].ToLower().ToString();

			// xxxx|impl|t_suit|compl|maints|
			if(temp.IndexOf(&quot;maintainer&quot;)&gt;=3D0)
			{
				retVal =3D 0x01;
			}
			if(temp.IndexOf(&quot;status&quot;)&gt;=3D0 || temp.IndexOf(&quot;completion&quot;)&gt;=3D0)
			{
				retVal =3D 0x02;
			}
			if(temp.IndexOf(&quot;test-suite&quot;)&gt;=3D0)
			{
				retVal =3D 0x04;
			}
			if(temp.IndexOf(&quot;implementation&quot;)&gt;=3D0)
			{
				retVal =3D 0x08;
			}
			val =3D spData[1];
			return retVal;
		}
	=09
		// Output is of the form: MMM-dd-yyyy
		private string ConvertToString(DateTime day)
		{
			return (mths[day.Month-1] + &quot;-&quot; + ((day.Day &lt; 10) ? (&quot;0&quot; + =
day.Day.ToString()) : day.Day.ToString()) + &quot;-&quot; + day.Year);
		}
	=09
		private ArrayList GetFilesToRead(string dir)
		{
			string[] subDirs =3D Directory.GetDirectories(dir);
			string[] files =3D Directory.GetFiles(dir);
			ArrayList fList =3D new ArrayList();
		=09
			foreach(string sDir in subDirs)
			{
				// Don't go in the CVS files												=09
				if(!sDir.EndsWith(&quot;CVS&quot;) &amp;&amp; !sDir.EndsWith(&quot;Test&quot;))
				{
					ArrayList temp =3D GetFilesToRead(sDir);
					for(int i=3D0; i &lt; temp.Count; i++)
						fList.Add(temp[i]);
				}
			}
			// Collect only the *.cs files
			foreach(string file in files)
			{
				if(file.EndsWith(&quot;.cs&quot;))
				{
					fList.Add(file);
				}
			}
			return fList;
		}

		private bool IsDir(string dir)
		{
			return ((File.GetAttributes(dir) &amp; FileAttributes.Directory) =3D=3D =
FileAttributes.Directory);
		}
	=09
		public static void Main(string[] args)
		{
			if(args.Length&lt;1)
			{
				System.Console.WriteLine(&quot;Usage: Status &lt;dir-name&gt; =
[&lt;status-file&gt;]\n&quot;);
				return;
			}
		=09
			while(args[0].EndsWith(&quot;\\&quot;))
				args[0] =3D args[0].Substring(0, args[0].Length - 1);

			string stFile =3D (args.Length&gt;=3D2 ? args[1] : &quot;&quot;);
			Status stat =3D new Status(args[0], stFile);
			System.Console.WriteLine(&quot;Total Files: {0}&quot;, =
stat.GetFilesToRead().Count);
			stat.GenerateStatusFile();
		}
	}
}

------=_NextPart_000_003E_01C1E1BA.CED66BD0--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="004922.html">[Mono-list] Update class status?
</A></li>
	<LI> Next message: <A HREF="004920.html">[Mono-list] Update class status?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4919">[ date ]</a>
              <a href="thread.html#4919">[ thread ]</a>
              <a href="subject.html#4919">[ subject ]</a>
              <a href="author.html#4919">[ author ]</a>
         </LI>
       </UL>
</body></html>
