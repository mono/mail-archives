<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Re: unicode wrapper
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:serge%40wildwestsoftware.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="004795.html">
   <LINK REL="Next"  HREF="004768.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Re: unicode wrapper
   </H1>
    <B>Serge
    </B> 
    <A HREF="mailto:serge%40wildwestsoftware.com"
       TITLE="[Mono-list] Re: unicode wrapper">serge@wildwestsoftware.com
       </A><BR>
    <I>Sun, 7 Apr 2002 16:22:08 +0300</I>
    <P><UL>
        <LI> Previous message: <A HREF="004795.html">[Mono-list] Re: unicode wrapper
</A></li>
        <LI> Next message: <A HREF="004768.html">[Mono-list] RE: mcs error (getting there...)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4822">[ date ]</a>
              <a href="thread.html#4822">[ thread ]</a>
              <a href="subject.html#4822">[ subject ]</a>
              <a href="author.html#4822">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> MS recommends
</I>&gt;<i> that /NOD:kernel32.lib /NOD:user32.lib etc be placed
</I>
This is not really needed. Link just resolves symbol to the first library it
sees, that has it exported. So unicows just has to be the first in the list.
The recommendation is seems for IDE setup.
I don't know if nostdlib will help, after all you still have to add
kerner/user/etc., manually in this case, because not all required symbols
are overriden by unicows.
So it seems not different from placing -lunicows into the linker specs file.

&gt;<i> Are you linking unimono.dll with MS link?
</I>Yes. In fact I guess mono itself can be linked directly to MSLU using MS
link.

&gt;<i> I suspect that it's a makefile ld link command
</I>&gt;<i> line ordering problem
</I>I tried to place it in the specs file either, before any other lib. Nothing
happened, symbols still resolved against kernel lib.

&gt;<i> I read about this, the library code loads the unicode layer for
</I>&gt;<i> Win9x and ME systems, and calls the original unicode function
</I>&gt;<i> for NT/2k/XP systems.
</I>That's correct, that's why it's better to use it directly thus eliminating
any potential slow-downs on NT systems.
Otherwise, I'd say it would be better to provide two builds - Windows build
(with wrapper) and NT native build (no need in unicows).

Also one thing that has to do with Unicode.
P/Invoke resolves symbols depending on the underlying symbols.
If you have two functions in your DLL - FunA and FunW
and
[DllImport(&quot;mydll.dll&quot;)]
unsafe public static extern void Fun();

Fun will be resolved to FunA on 9x and to FunW on NT.
In some sense this is similar to what unicows does.
This is described in the docs, there is also something about how
stdcall-mangled names are resolved.
Perhaps internalcall is also supposed to have similar mechanism?

&gt;<i> I'll look into this
</I>That would be great.
Actually, I'm not very familiar with ld so as I said maybe I'm missing
something.


Sergey








</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="004795.html">[Mono-list] Re: unicode wrapper
</A></li>
	<LI> Next message: <A HREF="004768.html">[Mono-list] RE: mcs error (getting there...)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4822">[ date ]</a>
              <a href="thread.html#4822">[ thread ]</a>
              <a href="subject.html#4822">[ subject ]</a>
              <a href="author.html#4822">[ author ]</a>
         </LI>
       </UL>
</body></html>
