<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] my first c# program doesn't work :-(
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:candide%40urbanium.tv">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="005124.html">
   <LINK REL="Next"  HREF="005070.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] my first c# program doesn't work :-(
   </H1>
    <B>Candide Kemmler
    </B> 
    <A HREF="mailto:candide%40urbanium.tv"
       TITLE="[Mono-list] my first c# program doesn't work :-(">candide@urbanium.tv
       </A><BR>
    <I>Tue, 16 Apr 2002 22:45:21 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="005124.html">[Mono-list] patch for entry point bug
</A></li>
        <LI> Next message: <A HREF="005070.html">[Mono-list] my first c# program doesn't work :-(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5063">[ date ]</a>
              <a href="thread.html#5063">[ thread ]</a>
              <a href="subject.html#5063">[ subject ]</a>
              <a href="author.html#5063">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

To begin with, could somebody please tell me how to subscribe to this 
list ? I haven't found any hints about this on the go-mono website.

Have tried to make this incredibly simple program work, without success. 
No, sorry, this one works, but I had liked to have to threaded version 
run, which should if the commented part was enabled:

//        Connection con = new Connection ();
//        con.socket = s;
//        con.start ();

I keep having the following error:

Error..... #0: 0x0000b ldfld		in .Connection::handleConnection ()

Is it my fault or your fault, :-) ?

Apparently, everything collapses when trying to access the &quot;socket&quot; ivar 
in the Connection class...
Any help greatly appreciated.

Candide Kemmler


using System;
using System.Net;
using System.Net.Sockets;
using System.Threading;
using System.IO;

class WelcomeCSS
{
   public static void Main () {
     new WelcomeCSS ();
   }

   public WelcomeCSS () {
     try {
       IPAddress ipAd = IPAddress.Parse(&quot;127.0.0.1&quot;); //use local m/c IP
address, and use the same in the client

       /* Initializes the Listener */
       TcpListener myList=new TcpListener ( ipAd, 9705 );
       /* Start Listeneting at the specified port */
       myList.Start();
       Console.WriteLine(&quot;The server is running at port 9705...&quot;);
       Console.WriteLine(&quot;Waiting for a connection.....&quot;);

       while ( true ) {
         Socket s = myList.AcceptSocket ();
//        Connection con = new Connection ();
//        con.socket = s;
//        con.start ();
         handleConnection ( s );
       }
     } catch (Exception e) {
       Console.WriteLine(&quot;Error..... &quot; + e.StackTrace);
     }
   }

   public void handleConnection (Socket socket) {
     try {
       Console.WriteLine(&quot;Connection accepted&quot;);
       NetworkStream networkStream = new NetworkStream(socket);
       Console.WriteLine(&quot;Created NetworkStream&quot; );
       StreamWriter streamwriter = new StreamWriter(networkStream) ;
       Console.WriteLine(&quot;Created StreamWriter&quot;);
       StreamReader streamreader = new StreamReader(networkStream) ;
       Console.WriteLine(&quot;Created StreamReader&quot;);
       Console.WriteLine(&quot;created new buffer&quot;);
       if ( socket.Connected ) {
         byte [] b = new byte [24];
         int bytes_read = 0;
         while ( (bytes_read=socket.Receive ( b )) != -1 ) {
           Console.WriteLine ( &quot;haha, reading...&quot; );
           socket.Send ( b );
         }
       } else {
         Console.WriteLine ( &quot;Socket is null&quot; );
       }
     } catch (Exception e) {
       Console.WriteLine(&quot;Error..... &quot; + e.StackTrace);
     }
   }

}

   public class Connection {

     private Socket socket;

     public Connection () {
       socket = null;
     }

     public void start () {
       Thread handlerThread = new  Thread ( new  ThreadStart (
handleConnection ) );
       handlerThread.Start ();
     }

     public void handleConnection () {
       try {
         Console.WriteLine(&quot;Connection accepted&quot;);
         NetworkStream networkStream = new NetworkStream(socket);
         Console.WriteLine(&quot;Created NetworkStream&quot; );
         StreamWriter streamwriter = new StreamWriter(networkStream) ;
         Console.WriteLine(&quot;Created StreamWriter&quot;);
         StreamReader streamreader = new StreamReader(networkStream) ;
         Console.WriteLine(&quot;Created StreamReader&quot;);
         Console.WriteLine(&quot;created new buffer&quot;);
         if ( socket.Connected ) {
           Console.WriteLine ( &quot;Socket is not null&quot; );
           string s = streamreader.ReadLine ();
           Console.WriteLine ( &quot;server message: &quot; + s );

           streamwriter.WriteLine ( s );
           Console.WriteLine(&quot;\nSent Acknowledgement&quot;);

           /* clean up */
           socket.Close();
         } else {
           Console.WriteLine ( &quot;Socket is null&quot; );
         }
       } catch (Exception e) {
         Console.WriteLine(&quot;Error..... &quot; + e.StackTrace);
       }
     }
   }




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="005124.html">[Mono-list] patch for entry point bug
</A></li>
	<LI> Next message: <A HREF="005070.html">[Mono-list] my first c# program doesn't work :-(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5063">[ date ]</a>
              <a href="thread.html#5063">[ thread ]</a>
              <a href="subject.html#5063">[ subject ]</a>
              <a href="author.html#5063">[ author ]</a>
         </LI>
       </UL>
</body></html>
