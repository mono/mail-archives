<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] MBas compiled in VS.NET could not compile simple
 program
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jonpryor%40vt.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016000.html">
   <LINK REL="Next"  HREF="015998.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] MBas compiled in VS.NET could not compile simple
 program
   </H1>
    <B>Jonathan Pryor
    </B> 
    <A HREF="mailto:jonpryor%40vt.edu"
       TITLE="[Mono-list] MBas compiled in VS.NET could not compile simple
 program">jonpryor@vt.edu
       </A><BR>
    <I>Sat, 27 Sep 2003 01:05:37 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="016000.html">[Mono-list] MBas compiled in VS.NET could not compile simple program
</A></li>
        <LI> Next message: <A HREF="015998.html">[Mono-list] MBas compiled in VS.NET could not compile simple program
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16001">[ date ]</a>
              <a href="thread.html#16001">[ thread ]</a>
              <a href="subject.html#16001">[ subject ]</a>
              <a href="author.html#16001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Shall I point you to FAQ #62, under the Compatibility section?

	...

	Furthermore, a 100% .NET application must not contain 
	non-standard data streams in the assembly. For example, Visual 
	Studio .NET will insert a #- stream into assemblies built under 
	the &quot;Debug&quot; target. This stream contains debugging information 
	for use by Visual Studio .NET; however, this stream can not be 
	interpreted by Mono (unless you're willing to donate support).

Granted, the FAQ is ENORMOUS, so it's likely that not everybody reads
all of it, but it's somewhat depressing to go off and write such
wonderful entries and have them be ignored...  :-/

 - Jon

(The author/updater of several FAQs in the Compatibility section...)

On Fri, 2003-09-26 at 23:31, Simon Waite wrote:
&gt;<i> Mono barfs with
</I>&gt;<i> .... non-standard metadata heap #-.
</I>&gt;<i> on .NET generated assemblies created via incremental compiling,
</I>&gt;<i> as I remember from earlier comments Miguel states that this heap
</I>&gt;<i> is of a non-standard format, and isn't going to be supported by mono.
</I>&gt;<i> 
</I>&gt;<i> Website maintainers: Perhaps this should be in the FAQ ?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> 
</I>&gt;<i> Simon
</I>&gt;<i> 
</I>&gt;<i> ----- Original Message ----- 
</I>&gt;<i> From: &quot;Ondrej Krsko&quot; &lt;<A HREF="mailto:ondrej.krsko@zoznam.sk">ondrej.krsko@zoznam.sk</A>&gt;
</I>&gt;<i> To: &quot;Mono List&quot; &lt;<A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>&gt;
</I>&gt;<i> Cc: &quot;A Rafael D Teixeira&quot; &lt;<A HREF="mailto:rafaelteixeirabr@hotmail.com">rafaelteixeirabr@hotmail.com</A>&gt;
</I>&gt;<i> Sent: Friday, September 26, 2003 3:30 PM
</I>&gt;<i> Subject: Re: [Mono-list] MBas compiled in VS.NET could not compile simple
</I>&gt;<i> program
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; &gt; For now, you'll probably need to run mbas with mono runtime and
</I>&gt;<i> &gt; &gt; class-libraries, it seems like it is trying to use incompatible .NET
</I>&gt;<i> &gt; &gt; libraries.
</I>&gt;<i> &gt; &gt; try: Mono mbas.exe Module1.vb
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; After running mbas.exe with mono runtime this error message appears:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Assembly 'mbas.exe' has the non-standard metadata heap #-.
</I>&gt;<i> &gt; Recompile it correctly (without the /incremental switch or in Release
</I>&gt;<i> &gt; mode). cannot open assembly mbas.exe
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I assume this is a bug in mono.
</I>&gt;<i> &gt; I tried to compile also this simple program (with mbas compiled in
</I>&gt;<i> vs.net):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Module Module1
</I>&gt;<i> &gt;     Sub Main()
</I>&gt;<i> &gt;     End Sub
</I>&gt;<i> &gt; End Module
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; but mbas shows this error (reported in /mbas/attribute.cs):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Module1.vb(6) error BC0246: Could not find attribute
</I>&gt;<i> &gt; 'Microsoft.VisualBasic.CompilerServices.StandardModuleAttribute' (are you
</I>&gt;<i> &gt; missing a using directive or an assembly reference ?)
</I>&gt;<i> &gt; Compilation failed: 1 Error(s), 0 warnings
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Maybe a little hacking could solve this problem. I was trying to find
</I>&gt;<i> &gt; solution few days, but I gave up - I'm not too good in &quot;.NET inners&quot;.
</I>&gt;<i> &gt; Any idea could help me!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; BR,
</I>&gt;<i> &gt; Ondrej Krsko
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016000.html">[Mono-list] MBas compiled in VS.NET could not compile simple program
</A></li>
	<LI> Next message: <A HREF="015998.html">[Mono-list] MBas compiled in VS.NET could not compile simple program
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16001">[ date ]</a>
              <a href="thread.html#16001">[ thread ]</a>
              <a href="subject.html#16001">[ subject ]</a>
              <a href="author.html#16001">[ author ]</a>
         </LI>
       </UL>
</body></html>
