<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Question about RSACryptoServiceProvider...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:spouliot%40videotron.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015739.html">
   <LINK REL="Next"  HREF="015765.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Question about RSACryptoServiceProvider...
   </H1>
    <B>Sebastien Pouliot
    </B> 
    <A HREF="mailto:spouliot%40videotron.ca"
       TITLE="[Mono-list] Question about RSACryptoServiceProvider...">spouliot@videotron.ca
       </A><BR>
    <I>Sun, 07 Sep 2003 09:21:20 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="015739.html">[Mono-list] Question about RSACryptoServiceProvider...
</A></li>
        <LI> Next message: <A HREF="015765.html">[Mono-list] Help with ASP.NET on linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15743">[ date ]</a>
              <a href="thread.html#15743">[ thread ]</a>
              <a href="subject.html#15743">[ subject ]</a>
              <a href="author.html#15743">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gius,

&gt;<i> OK, so to use an existing public key to encrypt data, I should
</I>&gt;<i> write something like this, isn't it?
</I>&gt;<i>
</I>&gt;<i> RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();
</I>&gt;<i>
</I>&gt;<i> RSAParameters keyInfo = new RSAParameters();
</I>&gt;<i> keyInfo.Modulus = publicKey;
</I>&gt;<i> keyInfo.Exponent = {1, 0, 1}
</I>
Exponent may not always be 65537. You shouldn't hardcode this value inside
your application.
The two easiest ways would be to:
(a) serialize the keyInfo to/from disk - RSAParameters is [Serializable];
(b) keep the RSA keypair in XML (To/FromXml).

&gt;<i> rsa.ImportParameters(keyInfo);
</I>&gt;<i> rsa.Encrypt(data);
</I>
&gt;<i> That's clear to me... but how can I use an existing private
</I>&gt;<i> key do decrypt data? Which member of the RSAParameters
</I>&gt;<i> structure should I modify?
</I>
You need at least parameter D to decrypt.
But it's a lot faster when DP, DQ, InverseQ, P and Q are available because
Mono/MS can then use the CRT (Chinese Remainder Theorem) algorithm.

&gt;<i> This is my very last question... sorry for boring you!
</I>
No problem ;-)

Sebastien Pouliot
Security Architect, Motus Technologies, <A HREF="http://www.motus.com/">http://www.motus.com/</A>
work: <A HREF="mailto:spouliot@motus.com">spouliot@motus.com</A>
home: <A HREF="mailto:spouliot@videotron.ca">spouliot@videotron.ca</A>


-----Original Message-----
From: Giuseppe Greco [mailto:<A HREF="mailto:giuseppe.greco@agamura.com">giuseppe.greco@agamura.com</A>]
Sent: 6 septembre 2003 10:30
To: <A HREF="mailto:spouliot@videotron.ca">spouliot@videotron.ca</A>
Cc: Mono
Subject: RE: [Mono-list] Question about RSACryptoServiceProvider...


On Sat, 2003-09-06 at 15:30, Sebastien Pouliot wrote:
&gt;<i> Gius,
</I>&gt;<i>
</I>&gt;<i> &gt; If I've well understood, the following code generates the
</I>&gt;<i> &gt; public/private key pair:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();
</I>&gt;<i>
</I>&gt;<i> Right this will generate a new keypair with the default key size (normally
</I>&gt;<i> 1024 bits).
</I>&gt;<i>
</I>&gt;<i> &gt; Then, the following code retrieves the public key:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; RSAParamters publicKey = rsa.ExportParameters(false);
</I>&gt;<i>
</I>&gt;<i> Yes. This will return the public key.
</I>
OK, so to use an existing public key to encrypt data, I should
write something like this, isn't it?

RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();

RSAParameters keyInfo = new RSAParameters();
keyInfo.Modulus = publicKey;
keyInfo.Exponent = {1, 0, 1}

rsa.ImportParameters(keyInfo);
rsa.Encrypt(data);

That's clear to me... but how can I use an existing private
key do decrypt data? Which member of the RSAParameters
structure should I modify?

This is my very last question... sorry for boring you!

Thanks,
Gius_.

&gt;<i>
</I>&gt;<i> &gt; and the following code retrieves the private key:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; RSAParametes privateKey = rsa.ExportParamters(true);
</I>&gt;<i>
</I>&gt;<i> Not exactly. This returns the keypair - including the private key.
</I>&gt;<i>
</I>&gt;<i> &gt; Well, the question is: How does the Encrypt/Decrypt
</I>&gt;<i> &gt; method know which key to use?
</I>&gt;<i>
</I>&gt;<i> This is automatic (by design). Encrypt uses the public key. Decrypt
</I>requires
&gt;<i> the private key.
</I>&gt;<i>
</I>&gt;<i> &gt; In my specific case, sometime I need to Encrypt with
</I>&gt;<i> &gt; the private key and Decrypt with the public key, and
</I>&gt;<i> &gt; sometime I need to Encrypt with the public key and
</I>&gt;<i> &gt; Decrypt with the private key...
</I>&gt;<i>
</I>&gt;<i> Encrypting with the private key isn't (by design) supported in the .NET
</I>&gt;<i> framework (nor by Mono or me!).
</I>&gt;<i> While this is technically possible you wont find much support on most
</I>crypto
&gt;<i> librairies (there are very good reason for that).
</I>&gt;<i> Most time (98%) people comes up with such a idea when there is a flaw in
</I>&gt;<i> their (security) design and they are trying to fix it at the wrong end.
</I>&gt;<i>
</I>&gt;<i> If you REALLY need this (2%) then I suggest that you look at the
</I>&gt;<i> RSAManaged.cs file (in /mcs/class/corlib/Mono.Security.Cryptography/) and
</I>&gt;<i> implement your own &quot;InversedRSA&quot; class using the BigInteger classes
</I>&gt;<i> (available in /mcs/class/corlib/Mono.Math/).
</I>&gt;<i>
</I>&gt;<i> &gt; Could somebody explain me this point one time for ever?
</I>&gt;<i> &gt; I've give a look at the msdn documentation, but it is
</I>&gt;<i> &gt; a little bit unclear, since it doesn't explain this
</I>&gt;<i> &gt; issue.
</I>&gt;<i>
</I>&gt;<i> MSDN isn't the best source to learn about cryptography. The article are
</I>(a)
&gt;<i> very basic or (b) API that requires solid crypto knowledge (as there are
</I>not
&gt;<i> much warning about potential pitfalls).
</I>&gt;<i>
</I>&gt;<i> I suggest getting a good book on cryptography (like cryptography applied).
</I>&gt;<i> The RSA FAQ (<A HREF="http://www.rsasecurity.com/rsalabs/faq/index.html">http://www.rsasecurity.com/rsalabs/faq/index.html</A>) is also a
</I>&gt;<i> good source of information.
</I>&gt;<i>
</I>&gt;<i> Good luck,
</I>&gt;<i>
</I>&gt;<i> Sebastien Pouliot
</I>&gt;<i> Security Architect, Motus Technologies, <A HREF="http://www.motus.com/">http://www.motus.com/</A>
</I>&gt;<i> work: <A HREF="mailto:spouliot@motus.com">spouliot@motus.com</A>
</I>&gt;<i> home: <A HREF="mailto:spouliot@videotron.ca">spouliot@videotron.ca</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>
</I>&gt;<i> [mailto:<A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>]On Behalf Of Giuseppe Greco
</I>&gt;<i> Sent: 6 septembre 2003 02:05
</I>&gt;<i> To: Mono
</I>&gt;<i> Subject: [Mono-list] Question about RSACryptoServiceProvider...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I'm trying to understand how RSACryptoServiceProvider works.
</I>&gt;<i>
</I>&gt;<i> If I've well understood, the following code generates the
</I>&gt;<i> public/private key pair:
</I>&gt;<i>
</I>&gt;<i> RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();
</I>&gt;<i>
</I>&gt;<i> Then, the following code retrieves the public key:
</I>&gt;<i>
</I>&gt;<i> RSAParamters publicKey = rsa.ExportParameters(false);
</I>&gt;<i>
</I>&gt;<i> and the following code retrieves the private key:
</I>&gt;<i>
</I>&gt;<i> RSAParametes privateKey = rsa.ExportParamters(true);
</I>&gt;<i>
</I>&gt;<i> Well, the question is: How does the Encrypt/Decrypt
</I>&gt;<i> method know which key to use?
</I>&gt;<i>
</I>&gt;<i> In my specific case, sometime I need to Encrypt with
</I>&gt;<i> the private key and Decrypt with the public key, and
</I>&gt;<i> sometime I need to Encrypt with the public key and
</I>&gt;<i> Decrypt with the private key...
</I>&gt;<i>
</I>&gt;<i> Could somebody explain me this point one time for ever?
</I>&gt;<i> I've give a look at the msdn documentation, but it is
</I>&gt;<i> a little bit unclear, since it doesn't explain this
</I>&gt;<i> issue.
</I>&gt;<i>
</I>&gt;<i> Thanks a lot,
</I>&gt;<i> Gius_.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> ----------------------------------------
</I>&gt;<i> Giuseppe Greco
</I>&gt;<i>
</I>&gt;<i> ::agamura::
</I>&gt;<i>
</I>&gt;<i> phone:  +41 (0)91 604 67 65
</I>&gt;<i> mobile: +41 (0)76 390 60 32
</I>&gt;<i> email:  <A HREF="mailto:giuseppe.greco@agamura.com">giuseppe.greco@agamura.com</A>
</I>&gt;<i> web:    www.agamura.com
</I>&gt;<i> ----------------------------------------
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>--
----------------------------------------
Giuseppe Greco

::<i>agamura::
</I>
phone:  +41 (0)91 604 67 65
mobile: +41 (0)76 390 60 32
email:  <A HREF="mailto:giuseppe.greco@agamura.com">giuseppe.greco@agamura.com</A>
web:    www.agamura.com
----------------------------------------


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="015739.html">[Mono-list] Question about RSACryptoServiceProvider...
</A></li>
	<LI> Next message: <A HREF="015765.html">[Mono-list] Help with ASP.NET on linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15743">[ date ]</a>
              <a href="thread.html#15743">[ thread ]</a>
              <a href="subject.html#15743">[ subject ]</a>
              <a href="author.html#15743">[ author ]</a>
         </LI>
       </UL>
</body></html>
