<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] MBas compiled in VS.NET could not compile simple program
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rafaelteixeirabr%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016001.html">
   <LINK REL="Next"  HREF="015999.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] MBas compiled in VS.NET could not compile simple program
   </H1>
    <B>A Rafael D Teixeira
    </B> 
    <A HREF="mailto:rafaelteixeirabr%40hotmail.com"
       TITLE="[Mono-list] MBas compiled in VS.NET could not compile simple program">rafaelteixeirabr@hotmail.com
       </A><BR>
    <I>Fri, 26 Sep 2003 13:10:09 -0300</I>
    <P><UL>
        <LI> Previous message: <A HREF="016001.html">[Mono-list] MBas compiled in VS.NET could not compile simple
 program
</A></li>
        <LI> Next message: <A HREF="015999.html">[Mono-list] hi all...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15998">[ date ]</a>
              <a href="thread.html#15998">[ thread ]</a>
              <a href="subject.html#15998">[ subject ]</a>
              <a href="author.html#15998">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>From: &quot;Ondrej Krsko&quot; &lt;<A HREF="mailto:ondrej.krsko@zoznam.sk">ondrej.krsko@zoznam.sk</A>&gt;
</I>&gt;<i>
</I>&gt;<i> &gt; For now, you'll probably need to run mbas with mono runtime and
</I>&gt;<i> &gt; class-libraries, it seems like it is trying to use incompatible .NET
</I>&gt;<i> &gt; libraries.
</I>&gt;<i> &gt; try: Mono mbas.exe Module1.vb
</I>&gt;<i>
</I>&gt;<i>After running mbas.exe with mono runtime this error message appears:
</I>&gt;<i>
</I>&gt;<i>Assembly 'mbas.exe' has the non-standard metadata heap #-.
</I>&gt;<i>Recompile it correctly (without the /incremental switch or in Release
</I>&gt;<i>mode). cannot open assembly mbas.exe
</I>&gt;<i>
</I>&gt;<i>I assume this is a bug in mono.
</I>
No, it's a Microsoft undocumented non-compliance with their own standard, as 
proposed to and accepted by ECMA . Follow the given instructions: do a 
release build of mbas.

&gt;<i>I tried to compile also this simple program (with mbas compiled in vs.net):
</I>&gt;<i>
</I>&gt;<i>Module Module1
</I>&gt;<i>     Sub Main()
</I>&gt;<i>     End Sub
</I>&gt;<i>End Module
</I>&gt;<i>
</I>&gt;<i>but mbas shows this error (reported in /mbas/attribute.cs):
</I>&gt;<i>
</I>&gt;<i>Module1.vb(6) error BC0246: Could not find attribute
</I>&gt;<i>'Microsoft.VisualBasic.CompilerServices.StandardModuleAttribute' (are you
</I>&gt;<i>missing a using directive or an assembly reference ?)
</I>&gt;<i>Compilation failed: 1 Error(s), 0 warnings
</I>
well I can't reproduce it in linux:

[<A HREF="mailto:rafael@redhat9">rafael@redhat9</A> mbas]$ mono mbas.exe x.vb
Compilation succeeded
[<A HREF="mailto:rafael@redhat9">rafael@redhat9</A> mbas]$ mono x.exe
[<A HREF="mailto:rafael@redhat9">rafael@redhat9</A> mbas]$ cat x.vb
Module Module1
     Sub Main()
     End Sub
End Module

You'll have to wait for when later I can seat at my WinXP machine to see 
what happens...

&gt;<i>Maybe a little hacking could solve this problem. I was trying to find
</I>&gt;<i>solution few days, but I gave up - I'm not too good in &quot;.NET inners&quot;.
</I>&gt;<i>Any idea could help me!
</I>&gt;<i>
</I>&gt;<i>BR,
</I>&gt;<i>Ondrej Krsko
</I>
I'll return to you later...

Regards,

Rafael Teixeira
Brazilian Polymath
Mono Hacker since 16 Jul 2001

_________________________________________________________________
MSN Messenger: instale grátis e converse com seus amigos. 
<A HREF="http://messenger.msn.com.br">http://messenger.msn.com.br</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016001.html">[Mono-list] MBas compiled in VS.NET could not compile simple
 program
</A></li>
	<LI> Next message: <A HREF="015999.html">[Mono-list] hi all...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15998">[ date ]</a>
              <a href="thread.html#15998">[ thread ]</a>
              <a href="subject.html#15998">[ subject ]</a>
              <a href="author.html#15998">[ author ]</a>
         </LI>
       </UL>
</body></html>
