<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ICodeCompiler.CompileAssemblyFromSourceBatch failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20ICodeCompiler.CompileAssemblyFromSourceBatch%20failure&In-Reply-To=92fc6620806171840t7c143eb0j6cdb2989847f702f%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038864.html">
   <LINK REL="Next"  HREF="038866.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ICodeCompiler.CompileAssemblyFromSourceBatch failure</H1>
    <B>Carl Cerecke</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20ICodeCompiler.CompileAssemblyFromSourceBatch%20failure&In-Reply-To=92fc6620806171840t7c143eb0j6cdb2989847f702f%40mail.gmail.com"
       TITLE="[Mono-list] ICodeCompiler.CompileAssemblyFromSourceBatch failure">carl.cerecke at telogis.com
       </A><BR>
    <I>Tue Jun 17 23:38:18 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="038864.html">[Mono-list] ICodeCompiler.CompileAssemblyFromSourceBatch failure
</A></li>
        <LI>Next message: <A HREF="038866.html">[Mono-list] ICodeCompiler.CompileAssemblyFromSourceBatch failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38865">[ date ]</a>
              <a href="thread.html#38865">[ thread ]</a>
              <a href="subject.html#38865">[ subject ]</a>
              <a href="author.html#38865">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Some more info on this. Specifically, a couple of relevant stack traces:

Unhandled Exception: System.DllNotFoundException: libc
  at (wrapper managed-to-native)
System.CodeDom.Compiler.TempFileCollection:mkdir (string,uint)
  at System.CodeDom.Compiler.TempFileCollection.GetOwnTempDir () [0x00000]
  at System.CodeDom.Compiler.TempFileCollection.get_BasePath () [0x00000]
  at System.CodeDom.Compiler.TempFileCollection.AddExtension
(System.String fileExtension, Boolean keepFile) [0x00000]
  at System.CodeDom.Compiler.TempFileCollection.AddExtension
(System.String fileExtension) [0x00000]
  at Mono.CSharp.CSharpCodeCompiler.GetTempFileNameWithExtension
(System.CodeDom.Compiler.TempFileCollection temp_files, System.String
extension) [0x00000]
  at Mono.CSharp.CSharpCodeCompiler.CompileFromSourceBatch
(System.CodeDom.Compiler.CompilerParameters options, System.String[]
sources) [0x00000]
  at Mono.CSharp.CSharpCodeCompiler.CompileAssemblyFromSourceBatch
(System.CodeDom.Compiler.CompilerParameters options, System.String[]
sources) [0x00000]
  at Foo.App.Main (System.String[] args) [0x00000]

Unhandled Exception: System.IO.DirectoryNotFoundException: Directory
'/tmp/74ff0843' not found.
  at System.IO.Directory.GetFileSystemEntries (System.String path,
System.String pattern, FileAttributes mask, FileAttributes attrs)
[0x00000]
  at System.IO.Directory.GetDirectories (System.String path,
System.String pattern) [0x00000]
  at System.IO.Directory.GetDirectories (System.String path) [0x00000]
  at System.IO.Directory.RecursiveDelete (System.String path) [0x00000]
  at System.IO.Directory.Delete (System.String path, Boolean recurse) [0x00000]
  at System.CodeDom.Compiler.TempFileCollection.Delete () [0x00000]
  at Mono.CSharp.CSharpCodeCompiler.CompileAssemblyFromSourceBatch
(System.CodeDom.Compiler.CompilerParameters options, System.String[]
sources) [0x00000]
  at Foo.App.Main (System.String[] args) [0x00000]


No idea why libc isn't found. If it was really not there I'd have
other problems to worry about.

On Wed, Jun 18, 2008 at 1:40 PM, Carl Cerecke &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">carl.cerecke at telogis.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I have an unusual failure when calling
</I>&gt;<i> ICodeCompiler.CompileAssemblyFromSourceBatch. The compile works
</I>&gt;<i> correctly when called from a mono .exe, but does not when the same
</I>&gt;<i> .exe is called via the mono embedded calls.
</I>&gt;<i>
</I>&gt;<i> This works on the command-line:
</I>&gt;&gt;<i> mono mtest.exe
</I>&gt;<i>
</I>&gt;<i> This code (using mono embedded libs) fails (never gets to printf):
</I>&gt;<i> int main(int argc, char *argv[]) {
</I>&gt;<i>
</I>&gt;<i>    domain = mono_jit_init(&quot;mtest.exe&quot;);
</I>&gt;<i>    assembly = mono_domain_assembly_open (domain, &quot;mtest.exe&quot;);
</I>&gt;<i>    mono_jit_exec(domain, assembly, argc, argv);
</I>&gt;<i>    printf(&quot;Ran mtest.exe\n&quot;);
</I>&gt;<i>
</I>&gt;<i> The error message is:
</I>&gt;<i> Directory '/tmp/178d00f6' not found.
</I>&gt;<i>
</I>&gt;<i> The successful CLI execution yeilds the strace (different run,
</I>&gt;<i> different tmpfile):
</I>&gt;<i> ...
</I>&gt;<i> stat64(&quot;/tmp/437a94b0&quot;, 0xbf84c06c)     = -1 ENOENT (No such file or directory)
</I>&gt;<i> lstat64(&quot;/tmp/437a94b0&quot;, 0xbf84c06c)    = -1 ENOENT (No such file or directory)
</I>&gt;<i> access(&quot;/tmp&quot;, F_OK)                    = 0
</I>&gt;<i> mkdir(&quot;/tmp/437a94b0&quot;, 0700)            = 0
</I>&gt;<i> stat64(&quot;/tmp/437a94b0/4f5bba7d.tmp&quot;, 0xbf84bfc4) = -1 ENOENT (No such
</I>&gt;<i> file or directory)
</I>&gt;<i> lstat64(&quot;/tmp/437a94b0/4f5bba7d.tmp&quot;, 0xbf84bfc4) = -1 ENOENT (No such
</I>&gt;<i> file or directory)
</I>&gt;<i> access(&quot;/tmp/437a94b0&quot;, F_OK)           = 0
</I>&gt;<i> stat64(&quot;/tmp/437a94b0&quot;, {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0
</I>&gt;<i> lstat64(&quot;/tmp/437a94b0&quot;, {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0
</I>&gt;<i> stat64(&quot;/tmp/437a94b0/4f5bba7d.tmp&quot;, 0xbf84bfb0) = -1 ENOENT (No such
</I>&gt;<i> file or directory)
</I>&gt;<i> lstat64(&quot;/tmp/437a94b0/4f5bba7d.tmp&quot;, 0xbf84bfb0) = -1 ENOENT (No such
</I>&gt;<i> file or directory)
</I>&gt;<i> access(&quot;/tmp/437a94b0&quot;, F_OK)           = 0
</I>&gt;<i> open(&quot;/tmp/437a94b0/4f5bba7d.tmp&quot;, O_RDWR|O_CREAT|O_EXCL|O_LARGEFILE, 0644) = 16
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> but the strace from running the failed code never does anything with
</I>&gt;<i> /tmp after the access() sycall.
</I>&gt;<i>
</I>&gt;<i> The code that does the CompileAssemblyFromSourceBatch() is in a .dll
</I>&gt;<i> that mtest.exe loads.
</I>&gt;<i>
</I>&gt;<i> What am I missing in the init of mono that prevents it from compiling
</I>&gt;<i> source on the fly? Everything else that I've tried with embedded mono
</I>&gt;<i> seems to work OK.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Carl
</I>&gt;<i> --
</I>&gt;<i> Carl Cerecke, PhD
</I>&gt;<i> Senior Software Engineer
</I>&gt;<i>
</I>&gt;<i> Telogis, Intelligent Location Technology
</I>&gt;<i> Level 2, Building 2
</I>&gt;<i> 1 Show Place
</I>&gt;<i> Addington
</I>&gt;<i> CHRISTCHURCH
</I>&gt;<i> New Zealand
</I>&gt;<i>
</I>&gt;<i> Phone: +64 03 339 2825 ext 208
</I>&gt;<i> Fax: +64 03 339 4537
</I>&gt;<i> Email: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">carl.cerecke at telogis.com</A>
</I>&gt;<i>
</I>&gt;<i> This message (including any attachments) contains confidential
</I>&gt;<i> information intended for a specific individual and purpose, and is
</I>&gt;<i> protected by law. If you are not the intended recipient, you should
</I>&gt;<i> delete this message and are hereby notified that any disclosure,
</I>&gt;<i> copying, or distribution of this message, or the taking of any action
</I>&gt;<i> based on it, is strictly prohibited.
</I>&gt;<i>
</I>


-- 
Carl Cerecke, PhD
Senior Software Engineer

Telogis, Intelligent Location Technology
Level 2, Building 2
1 Show Place
Addington
CHRISTCHURCH
New Zealand

Phone: +64 03 339 2825 ext 208
Fax: +64 03 339 4537
Email: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">carl.cerecke at telogis.com</A>

This message (including any attachments) contains confidential
information intended for a specific individual and purpose, and is
protected by law. If you are not the intended recipient, you should
delete this message and are hereby notified that any disclosure,
copying, or distribution of this message, or the taking of any action
based on it, is strictly prohibited.
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038864.html">[Mono-list] ICodeCompiler.CompileAssemblyFromSourceBatch failure
</A></li>
	<LI>Next message: <A HREF="038866.html">[Mono-list] ICodeCompiler.CompileAssemblyFromSourceBatch failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38865">[ date ]</a>
              <a href="thread.html#38865">[ thread ]</a>
              <a href="subject.html#38865">[ subject ]</a>
              <a href="author.html#38865">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
