<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> A nice look for the Docs (was: Re: [Mono-list] Need help: writing a COM control.)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:groith%40tcrz.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="007659.html">
   <LINK REL="Next"  HREF="007661.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>A nice look for the Docs (was: Re: [Mono-list] Need help: writing a COM control.)
   </H1>
    <B>Guenther Roith
    </B> 
    <A HREF="mailto:groith%40tcrz.net"
       TITLE="A nice look for the Docs (was: Re: [Mono-list] Need help: writing a COM control.)">groith@tcrz.net
       </A><BR>
    <I>Sun, 11 Aug 2002 20:34:42 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="007659.html">[Mono-list] Need help: writing a COM control.
</A></li>
        <LI> Next message: <A HREF="007661.html">A nice look for the Docs (was: Re: [Mono-list] Need help: writing a COM control.)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7660">[ date ]</a>
              <a href="thread.html#7660">[ thread ]</a>
              <a href="subject.html#7660">[ subject ]</a>
              <a href="author.html#7660">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_000D_01C24176.8603AF50
Content-Type: text/plain;
	charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: 7bit

Hi, everybody!

Here is a quick &amp; dirty solution to stop the window-opening in Mozilla and
add a stylesheet to the MS docs.

After extracting the class libs and copying them to Linux, like described
before, copy the attached convert.php and style.php one directory level
higher than the html directory and run convert.php. That will take about 20
minutes.

Then run cpref_start.htm in Mozilla.

The docs are designed for use with stylesheets and style.css can be modified
to produce the original ms look &amp; feel.

Johannes


----- Original Message -----
From: &quot;Guenther Roith&quot; &lt;<A HREF="mailto:groith@tcrz.net">groith@tcrz.net</A>&gt;
To: &quot;Guenther Roith&quot; &lt;<A HREF="mailto:groith@tcrz.net">groith@tcrz.net</A>&gt;
Cc: &quot;mono-list&quot; &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
Sent: Sunday, August 11, 2002 8:04 PM
Subject: Re: [Mono-list] Need help: writing a COM control.


&gt;<i> So finally I'm finished with the class library.
</I>&gt;<i> I have now 39.279 Files, taking 242 MB.
</I>&gt;<i>
</I>&gt;<i> I'll take some time until mono has so much documentation itself...
</I>&gt;<i>
</I>&gt;<i> The start-file is cpref_start.htm and it looks ugly and a window pops up.
</I>&gt;<i>
</I>&gt;<i> There needs to be a css files created, that makes the thing look better
</I>and
&gt;<i> the non-html-tags (and the popup-window) must be removed perhaps trough
</I>&gt;<i> xslt.
</I>&gt;<i>
</I>&gt;<i> Here's a screenshot of the class lib doc in Mozilla.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.superin.formativ.net/mono/mozdoc.png">http://www.superin.formativ.net/mono/mozdoc.png</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Johannes
</I>&gt;<i>
</I>&gt;<i> ----- Original Message -----
</I>&gt;<i> From: &quot;Guenther Roith&quot; &lt;<A HREF="mailto:groith@tcrz.net">groith@tcrz.net</A>&gt;
</I>&gt;<i> To: &quot;Miguel de Icaza&quot; &lt;<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&gt;
</I>&gt;<i> Cc: &quot;mono-list&quot; &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
</I>&gt;<i> Sent: Sunday, August 11, 2002 7:23 PM
</I>&gt;<i> Subject: Re: [Mono-list] Need help: writing a COM control.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Hi!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I've also found some additional information on the IE COM API:
</I>&gt;<i> &gt;
</I>&gt;<i>
</I><A HREF="http://msdn.microsoft.com/library/default.asp?url=/workshop/browser/WebBrows">http://msdn.microsoft.com/library/default.asp?url=/workshop/browser/WebBrows</A>
&gt;<i> &gt; er/WebBrowser.asp
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As well as a vb script (stupid, I know, but the only example I found).
</I>&gt;<i> &gt; must be saved a something.vbs:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Dim MyIE
</I>&gt;<i> &gt; Set MyIE = CreateObject(&quot;InternetExplorer.Application&quot;)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; do while MyIE.Busy
</I>&gt;<i> &gt; loop
</I>&gt;<i> &gt; MyIE.Visible = 0
</I>&gt;<i> &gt; MyIE.Navigate &quot;<A HREF="http://www.go-mono.org"">http://www.go-mono.org&quot;</A>
</I>&gt;<i> &gt; MyIE.Silent = True
</I>&gt;<i> &gt; Do While MyIE.ReadyState&lt;&gt;4
</I>&gt;<i> &gt; Loop
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; MsgBox(MyIE.Document.Body.innerText)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; MeinIE.Quit
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Johannes
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ----- Original Message -----
</I>&gt;<i> &gt; From: &quot;Miguel de Icaza&quot; &lt;<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&gt;
</I>&gt;<i> &gt; To: &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
</I>&gt;<i> &gt; Sent: Sunday, August 11, 2002 1:11 PM
</I>&gt;<i> &gt; Subject: [Mono-list] Need help: writing a COM control.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Hello guys,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     I usually find myself traveling and without the desire to boot
</I>&gt;<i> &gt; &gt; VMware.  The only reason to start up VMWare is to read the online
</I>&gt;<i> &gt; &gt; documentation for the .NET Framework.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     Ideally, we would have our own documentation, but we do not have
</I>it
&gt;<i> &gt; &gt; yet.  So what I want to do is pull all the data from the existing
</I>&gt;<i> &gt; &gt; Microsoft implementation, and dump it into HTML that I can later view
</I>&gt;<i> &gt; &gt; from Linux when am traveling.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     I found that they have a control that handles the `ms-help:'
</I>prefix
&gt;<i> &gt; &gt; (indeed, the URL would work just fine under IE).  But the API is an
</I>&gt;<i> &gt; &gt; internal API, so it is not easy to figure out what arguments to pass
</I>to
&gt;<i> &gt; &gt; it.  Even with this, I was able to write a simple C# program that
</I>could
&gt;<i> &gt; &gt; load the index, and return a list of topics, but I was stopped there.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     Since the `ms-help:' happens to be some kind of handler that IE
</I>&gt;<i> &gt; &gt; uses, I wonder if it is possible to write a COM control that would
</I>allow
&gt;<i> &gt; &gt; me to pull the stream of data that would be rendered by the ms-help:
</I>&gt;<i> &gt; &gt; control.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;      Once this is done, I could safely write a little program to pull
</I>&gt;<i> &gt; &gt; all the data and copy it over to Linux to browse.  I know its
</I>possible,
&gt;<i> &gt; &gt; I just do not know enough COM to pull this out.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Miguel.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>
------=_NextPart_000_000D_01C24176.8603AF50
Content-Type: application/octet-stream;
	name=&quot;convert.php&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename=&quot;convert.php&quot;

&lt;?php
if ($handle =3D opendir('html/')) {
while (false !=3D=3D ($file =3D readdir($handle))) {=20
echo &quot;$file\n&quot;;
$filename=3D&quot;html/&quot;.$file;=20
$fd =3D fopen ($filename, &quot;r&quot;);
$tmp1=3Dfread($fd,filesize($filename));
fclose ($fd);

$tmp1=3Dstr_replace('&lt;SCRIPT =
SRC=3D&quot;ms-help:/../commoner/scripts/dtuelink.js&quot;&gt;&lt;/SCRIPT&gt;', '&lt;link =
REL=3DSTYLESHEET type=3DTEXT/CSS href=3D../style.css&gt;', $tmp1);

$fd =3D fopen ($filename, &quot;w&quot;);
fwrite($fd,$tmp1);
fclose ($fd);

    }


    closedir($handle);=20
}

?&gt;
------=_NextPart_000_000D_01C24176.8603AF50
Content-Type: text/css;
	name=&quot;style.css&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=&quot;style.css&quot;

   body { font-family: &quot;trebuchet ms&quot;, lucida, verdana, helvetica;}
------=_NextPart_000_000D_01C24176.8603AF50--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="007659.html">[Mono-list] Need help: writing a COM control.
</A></li>
	<LI> Next message: <A HREF="007661.html">A nice look for the Docs (was: Re: [Mono-list] Need help: writing a COM control.)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7660">[ date ]</a>
              <a href="thread.html#7660">[ thread ]</a>
              <a href="subject.html#7660">[ subject ]</a>
              <a href="author.html#7660">[ author ]</a>
         </LI>
       </UL>
</body></html>
