<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] solution for Thread::Abort()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jarek%40merkury.atm.lan">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="007618.html">
   <LINK REL="Next"  HREF="007628.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] solution for Thread::Abort()
   </H1>
    <B>Jaroslaw Kowalski
    </B> 
    <A HREF="mailto:jarek%40merkury.atm.lan"
       TITLE="[Mono-list] solution for Thread::Abort()">jarek@merkury.atm.lan
       </A><BR>
    <I>Thu, 8 Aug 2002 21:34:44 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="007618.html">[Mono-list] Re: solution for Thread::Abort()
</A></li>
        <LI> Next message: <A HREF="007628.html">[Mono-list] solution for Thread::Abort()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7622">[ date ]</a>
              <a href="thread.html#7622">[ thread ]</a>
              <a href="subject.html#7622">[ subject ]</a>
              <a href="author.html#7622">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2 stupid questions:

1. Can't you just do pthread_kill(thread, SIGSTOP) to suspend the
thread and pthread_kill(thread, SIGCONT) to resume?

2. Wine seems to be doing the threads right. Why don't you take their
code. It's GPL anyway... They seem to be using ptrace() api to modify the
thread context. I'm not sure if it works on anything but Linux (perhaps
not, but context operations aren't portable anyway).

Jarek

BTW. The idea of SuspendThread(), SetThreadContext(), ResumeThread() was
once proposed by Microsoft's Dr.GUI in MSDN Library column. So perhaps
this is the right way to do it.

On 8 Aug 2002, Dietmar Maurer wrote:

&gt;<i> One solution to implement Thread::Abort() would be to use pthreds_kill()
</I>&gt;<i> to raise a signal in thread to abort. The signal handler of that thread
</I>&gt;<i> can then impl. the Abort() functionality (realy abort - or catch the
</I>&gt;<i> exception (ResetAbort)).
</I>&gt;<i>
</I>&gt;<i> (Un)fortunately there are no signals on windows, and it is not possible
</I>&gt;<i> to do things like pthreds_kill() - at least I don't know how.
</I>&gt;<i>
</I>&gt;<i> Patrik pointed me to a possible solution on:
</I>&gt;<i>
</I>&gt;<i>         1. Suspend the Thread: SuspendThread ();
</I>&gt;<i>         2. get the thread context: GetThreadContext();
</I>&gt;<i>         3. modify the IP in the context, we can also store argumnets we
</I>&gt;<i>            want to pass in the context (in other registers).
</I>&gt;<i>         4. set the thread context: SetThreadContext();
</I>&gt;<i>         5. resume the thread: ResumeThread();
</I>&gt;<i>
</I>&gt;<i> After ResumeThread() that thread jumps to the modified IP, which is a
</I>&gt;<i> special exception handler. That handler can simple call
</I>&gt;<i> arch_handle_exception to do the work. We just need to implement those
</I>&gt;<i> function in io-layer, then we can use the same code on unix.
</I>&gt;<i>
</I>&gt;<i> The question is if its possible to implement a pthread based
</I>&gt;<i> ResumeThread() function which uses a modified context?
</I>&gt;<i>
</I>&gt;<i> - Dietmar
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="007618.html">[Mono-list] Re: solution for Thread::Abort()
</A></li>
	<LI> Next message: <A HREF="007628.html">[Mono-list] solution for Thread::Abort()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7622">[ date ]</a>
              <a href="thread.html#7622">[ thread ]</a>
              <a href="subject.html#7622">[ subject ]</a>
              <a href="author.html#7622">[ author ]</a>
         </LI>
       </UL>
</body></html>
