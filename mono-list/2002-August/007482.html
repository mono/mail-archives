<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Announce: A .NET assembly -&gt; native code generationtool (ala ngen for MONO)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Zoltan.2.Varga%40nokia.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="007486.html">
   <LINK REL="Next"  HREF="007490.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Announce: A .NET assembly -&gt; native code generationtool (ala ngen for MONO)
   </H1>
    <B>Zoltan.2.Varga@nokia.com
    </B> 
    <A HREF="mailto:Zoltan.2.Varga%40nokia.com"
       TITLE="[Mono-list] Announce: A .NET assembly -&gt; native code generationtool (ala ngen for MONO)">Zoltan.2.Varga@nokia.com
       </A><BR>
    <I>Thu, 1 Aug 2002 13:42:10 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="007486.html">[Mono-list] Combining Virtuoso and Mono
</A></li>
        <LI> Next message: <A HREF="007490.html">[Mono-list] Announce: A .NET assembly -&gt; native code generationtool (ala ngen for MONO)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7482">[ date ]</a>
              <a href="thread.html#7482">[ thread ]</a>
              <a href="subject.html#7482">[ subject ]</a>
              <a href="author.html#7482">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>					Hi,

&gt;<i> -----Original Message-----
</I>&gt;<i> From: ext Dietmar Maurer [mailto:<A HREF="mailto:dietmar@ximian.com">dietmar@ximian.com</A>]
</I>&gt;<i> Sent: 01. August 2002 7:56
</I>&gt;<i> To: Fergus Henderson
</I>&gt;<i> Cc: Miguel de Icaza; Varga Zoltan.2 (NMP/Budapest); Mono List
</I>&gt;<i> Subject: Re: [Mono-list] Announce: A .NET assembly -&gt; native code
</I>&gt;<i> generationtool (ala ngen for MONO)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Thu, 2002-08-01 at 04:39, Fergus Henderson wrote:
</I>&gt;<i> &gt; On 29-Jul-2002, Dietmar Maurer &lt;<A HREF="mailto:dietmar@ximian.com">dietmar@ximian.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; On Sun, 2002-07-28 at 06:03, Miguel de Icaza wrote:
</I>&gt;<i> &gt; &gt; &gt; Zoltan wrote:
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt;    The first version of my ngen clone for MONO is 
</I>&gt;<i> available at:
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; <A HREF="http://www.nexus.hu/vargaz2">http://www.nexus.hu/vargaz2</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Excellent.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; &gt; This announcement is of course really exciting.  I have 
</I>&gt;<i> only taken a
</I>&gt;<i> &gt; &gt; &gt; very superficial look so far at the code generator, but 
</I>&gt;<i> the approach is
</I>&gt;<i> &gt; &gt; &gt; a very interesting idea.  I will let Dietmar and Paolo 
</I>&gt;<i> comment further
</I>&gt;<i> &gt; &gt; &gt; on it.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I think this approach is a really good approach.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; &gt; What I wanted to look into was to use the JIT to 
</I>&gt;<i> generate code that
</I>&gt;<i> &gt; &gt; &gt; would end up in a library, basically reusing the JIT, 
</I>&gt;<i> but turning on all
</I>&gt;<i> &gt; &gt; &gt; the optimizations for this.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; This approach would also avoid much code duplication.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; This approach is what MS did.  This approach sucks.
</I>&gt;<i> &gt; You just won't get good performance that way.
</I>&gt;<i> 
</I>&gt;<i> Sure, but I also has some advantages. For example it works with
</I>&gt;<i> exceptions and garbage collection. I have no idea how we can 
</I>&gt;<i> include GC
</I>&gt;<i> support with the gcc approach.
</I>&gt;<i> 
</I>
A conservative garbage collector, like the Boehm collector can work with gcc code if the code is &quot;GC-safe&quot;, i.e. it always
keeps pointers to the beginning or interior of all live objects. An example of non-gc safe code is:
     a[i - 5] = 0;

When confronted with such code an optimizing compiler might decide to transform it to something like (a-5)[i], which means
there are no pointers left pointing to a, so it will be garbage collected. A relevant paper is here:

<A HREF="http://www.hpl.hp.com/personal/Hans_Boehm/gc/papers/pldi96.ps.gz">http://www.hpl.hp.com/personal/Hans_Boehm/gc/papers/pldi96.ps.gz</A>

Unfortunately, based on a web search on google about 'gcc gc-safe', it looks like the code generated by gcc is not always
gc-safe. It looks like the projects which use Boehm-GC like to live dangerously...
It might be possible to generated GC safe code based on the ideas of the above paper.

Of course, the gcc approach does not work at all with non-conservative collectors, since these like to know which registers/
memory locations contain pointers.

As a final remark, I throught (and still thinking about) writing a GCC front end for IL similar to gcj. My biggest problem
with this approach is that I would like to target the MONO runtime, and reuse MONO code in the front end. In contrast, gcj
is self contained: it includes its own runtime library (libgcj) and targets that.

											bye

												Zoltan



										bye

											Zoltan












      





&gt;<i> - Dietmar
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="007486.html">[Mono-list] Combining Virtuoso and Mono
</A></li>
	<LI> Next message: <A HREF="007490.html">[Mono-list] Announce: A .NET assembly -&gt; native code generationtool (ala ngen for MONO)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7482">[ date ]</a>
              <a href="thread.html#7482">[ thread ]</a>
              <a href="subject.html#7482">[ subject ]</a>
              <a href="author.html#7482">[ author ]</a>
         </LI>
       </UL>
</body></html>
