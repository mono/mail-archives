<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] AppDomain problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gonzalo%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="007733.html">
   <LINK REL="Next"  HREF="007783.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] AppDomain problems
   </H1>
    <B>Gonzalo Paniagua Javier
    </B> 
    <A HREF="mailto:gonzalo%40ximian.com"
       TITLE="[Mono-list] AppDomain problems">gonzalo@ximian.com
       </A><BR>
    <I>15 Aug 2002 03:16:20 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="007733.html">[Mono-list] AppDomain problems
</A></li>
        <LI> Next message: <A HREF="007783.html">[Mono-list] AppDomain problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7738">[ date ]</a>
              <a href="thread.html#7738">[ thread ]</a>
              <a href="subject.html#7738">[ subject ]</a>
              <a href="author.html#7738">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>El mié, 14-08-2002 a las 19:39, Dietmar Maurer escribió:
&gt;<i> I cant get the attached program to work on MS windows, even if security
</I>&gt;<i> is turned off with: CasPol -s off
</I>
I made it work without disabling security.

&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> using System;
</I>
using System.IO;

&gt;<i> using System.Security.Policy;
</I>&gt;<i> using System.Threading;
</I>&gt;<i> using System.Runtime.Serialization;
</I>&gt;<i> 
</I>&gt;<i> class Container {
</I>&gt;<i> 
</I>&gt;<i> 	[Serializable]
</I>&gt;<i> 	public struct c2 : ISerializable {
</I>&gt;<i> 		public int a;
</I>&gt;<i> 		public string s1;
</I>&gt;<i> 
</I>&gt;<i> 		private c2 (SerializationInfo info, StreamingContext context) {
</I>&gt;<i> 			a = info.GetInt32(&quot;a&quot;);
</I>&gt;<i> 			s1 = info.GetString(&quot;s1&quot;);
</I>&gt;<i> 			Console.WriteLine (&quot;SetObjectData called: &quot; + info.AssemblyName + &quot;,&quot; +
</I>&gt;<i> 					   info.FullTypeName + &quot; &quot; + s1 + &quot;, &quot; + a);
</I>&gt;<i> 		}
</I>&gt;<i> 
</I>&gt;<i> 		public void GetObjectData (SerializationInfo info, StreamingContext context) {
</I>&gt;<i> 			Console.WriteLine (&quot;GetObjectData called: &quot; + info.AssemblyName + &quot;,&quot; +
</I>&gt;<i> 					   info.FullTypeName + &quot; &quot; + s1 + &quot;, &quot; + a);
</I>&gt;<i> 			info.AddValue (&quot;a&quot;, a);
</I>&gt;<i> 			if (s1 != null)
</I>&gt;<i> 				info.AddValue (&quot;s1&quot;, s1);
</I>&gt;<i> 			else
</I>&gt;<i> 				info.AddValue (&quot;s1&quot;, &quot;(null)&quot;);
</I>&gt;<i> 		}
</I>&gt;<i> 	}
</I>&gt;<i> 	
</I>&gt;<i> 	[Serializable]
</I>&gt;<i> 	public class c1 {
</I>&gt;<i> 		public c1 () {
</I>&gt;<i> 			e1.a = 3;
</I>&gt;<i> 			e1.s1 = &quot;SS&quot;;
</I>&gt;<i> 		}
</I>&gt;<i> 		public int a = 1;
</I>&gt;<i> 		public int b = 2;
</I>&gt;<i> 		public string s1 = &quot;TEST1&quot;;
</I>&gt;<i> 		[NonSerialized] public string s2 = &quot;TEST2&quot;;
</I>&gt;<i> 		public c2 [] sa = new c2 [2];
</I>&gt;<i> 		public c2 e1;
</I>&gt;<i> 	}
</I>&gt;<i> 	
</I>&gt;<i> 	static int Main ()
</I>&gt;<i> 	{
</I>&gt;<i> 		AppDomainSetup setup = new AppDomainSetup ();
</I>&gt;<i> 		setup.ApplicationBase = &quot;.&quot;;
</I>
Changed to: setup.ApplicationBase = Directory.GetCurrentDirectory ();
&gt;<i> 
</I>&gt;<i> 		Console.WriteLine (AppDomain.CurrentDomain.FriendlyName);
</I>&gt;<i> 			
</I>&gt;<i> 		AppDomain newDomain = AppDomain.CreateDomain (&quot;NewDomain&quot;, new Evidence (), setup);
</I>
As Jaak pointed out, it would better to use: 

	new Evidence (AppDomain.CurrentDomain.Evidence);

as the second argument to CreateDomain, but it does not affect to the
behavior of the program (it also works with null as Evidence).

And that's all.

Of course, don't ask me why using the full path works and &quot;.&quot; does not
;-).

- Gonzalo




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="007733.html">[Mono-list] AppDomain problems
</A></li>
	<LI> Next message: <A HREF="007783.html">[Mono-list] AppDomain problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7738">[ date ]</a>
              <a href="thread.html#7738">[ thread ]</a>
              <a href="subject.html#7738">[ subject ]</a>
              <a href="author.html#7738">[ author ]</a>
         </LI>
       </UL>
</body></html>
