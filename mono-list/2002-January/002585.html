<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] compiler status on linux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002583.html">
   <LINK REL="Next"  HREF="002588.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] compiler status on linux
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] compiler status on linux">lupus@ximian.com
       </A><BR>
    <I>Sat, 5 Jan 2002 16:49:55 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="002583.html">[Mono-list] keeping corlib self-contained
</A></li>
        <LI> Next message: <A HREF="002588.html">[Mono-list] System.ResolveEventArgs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2585">[ date ]</a>
              <a href="thread.html#2585">[ thread ]</a>
              <a href="subject.html#2585">[ subject ]</a>
              <a href="author.html#2585">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So, many of the bits needed to make the compiler working on linux
are starting to fit together: mcs can compile some simple programs
(about 12 in mono/mono/tests compiled just now), though not all
generate correct code, yet.
You'll need the latest mono from cvs as well as the latest corlib.
You'll also need to run the compiler with the interpreter.

I use the included patch to mcs to add /usr/local/lib to the search path
for the compiler and avoid the GetFiles() call that is still
unimplemented in corlib (the other changes are to get stack traces in
the interp, instead of the user-friendly error messages:
who says that usability isn't debugging backtraces? :-).

Have fun!

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

Index: cs-parser.jay
===================================================================
RCS file: /cvs/public/mcs/mcs/cs-parser.jay,v
retrieving revision 1.126
diff -u -r1.126 cs-parser.jay
--- cs-parser.jay	2002/01/02 06:23:54	1.126
+++ cs-parser.jay	2002/01/05 11:39:25
@@ -3624,12 +3624,12 @@
 	StringBuilder value = new StringBuilder ();
 
 	global_errors = 0;
-	try {
+	//try {
 		if (yacc_verbose_flag)
 			yyparse (lexer, new yydebug.yyDebugSimple ());
 		else
 			yyparse (lexer);
-	} catch (Exception e){
+	//} catch (Exception e){
 		// Console.WriteLine (&quot;Fatal error: &quot; + name);
 		// Console.WriteLine (lexer.location);
 
@@ -3637,10 +3637,10 @@
 		// Please do not remove this, it is used during debugging
 		// of the grammar
 		//
-		Console.WriteLine (lexer.location + &quot;  : Parsing error &quot;);
+	/*	Console.WriteLine (lexer.location + &quot;  : Parsing error &quot;);
 		Console.WriteLine (e);
 		global_errors++;
-	}
+	}*/
 	
 	return global_errors;
 }
Index: driver.cs
===================================================================
RCS file: /cvs/public/mcs/mcs/driver.cs,v
retrieving revision 1.51
diff -u -r1.51 driver.cs
--- driver.cs	2002/01/02 16:20:37	1.51
+++ driver.cs	2002/01/05 11:39:26
@@ -105,24 +105,24 @@
 			Stream input;
 			int errors;
 
-			try {
+			//try {
 				input = File.OpenRead (input_file);
-			} catch {
+			/*} catch {
 				Report.Error (2001, &quot;Source file '&quot; + input_file + &quot;' could not be opened&quot;);
 				return 1;
-			}
+			}*/
 
 			parser = new CSharpParser (input_file, input, defines);
 			parser.yacc_verbose = yacc_verbose;
-			try {
+			//try {
 				errors = parser.parse ();
-			} catch (Exception ex) {
+			/*} catch (Exception ex) {
 				Console.WriteLine (ex);
 				Console.WriteLine (&quot;Compilation aborted&quot;);
 				return 1;
 			} finally {
 				input.Close ();
-			}
+			}*/
 			
 			return errors;
 		}
@@ -296,6 +296,7 @@
 			// path.
 			//
 			link_paths.Add (&quot;<A HREF="file:///C:/WINNT/Microsoft.NET/Framework/v1.0.2914"">file:///C:/WINNT/Microsoft.NET/Framework/v1.0.2914&quot;</A>);
+			link_paths.Add (&quot;/usr/local/lib&quot;);
 
 			int argc = args.Length;
 			for (i = 0; i &lt; argc; i++){
@@ -500,7 +501,8 @@
 				if (first_source == null)
 					first_source = arg;
 
-				string [] files = Directory.GetFiles (&quot;.&quot;, arg);
+				//string [] files = Directory.GetFiles (&quot;.&quot;, arg);
+				string [] files = {arg};
 				foreach (string f in files){
 					if (!f.ToLower ().EndsWith (&quot;.cs&quot;)){
 						error (&quot;Do not know how to compile &quot; + arg);


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002583.html">[Mono-list] keeping corlib self-contained
</A></li>
	<LI> Next message: <A HREF="002588.html">[Mono-list] System.ResolveEventArgs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2585">[ date ]</a>
              <a href="thread.html#2585">[ thread ]</a>
              <a href="subject.html#2585">[ subject ]</a>
              <a href="author.html#2585">[ author ]</a>
         </LI>
       </UL>
</body></html>
