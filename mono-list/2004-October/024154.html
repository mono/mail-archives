<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] DirectoryServices class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:nigel_benns%40rogers.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="024150.html">
   <LINK REL="Next"  HREF="024155.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] DirectoryServices class
   </H1>
    <B>Nigel Benns
    </B> 
    <A HREF="mailto:nigel_benns%40rogers.com"
       TITLE="[Mono-list] DirectoryServices class">nigel_benns@rogers.com
       </A><BR>
    <I>Fri, 29 Oct 2004 21:00:55 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="024150.html">[Mono-list] sqlite multiple row insertion
</A></li>
        <LI> Next message: <A HREF="024155.html">[Mono-list] runtime errors after building and attenpting to run latest cvs
 mono gtk apps
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24154">[ date ]</a>
              <a href="thread.html#24154">[ thread ]</a>
              <a href="subject.html#24154">[ subject ]</a>
              <a href="author.html#24154">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>------=_20041029210055_55139
Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
Content-Transfer-Encoding: 8bit

Ok that worked, but I caught an exception of &quot;Error:&quot;. Which is odd....

My code doesn't work though...

you specify mono AD Write.exe
<A HREF="ldap://localhost/cn=Manager,ou=People,o=Alexandria">ldap://localhost/cn=Manager,ou=People,o=Alexandria</A> description hello

basically the object you want to modify, the attribute to modify and
what to modify it too. The binding and password is in the code

It spits out the entry, changes it in the code, but does not commit.
For the sake of it I set my ACL in slapd.conf to access to * by * write
and it doesn't change anything.

It executes properly and everything... and the code is right off of MSDN
(go figure).

I'm going to try to update mono as well... (if Mandrake has a new
version), I'll get back to you on the status after I do that.

&gt;<i> Nigel Benns a écrit :
</I>&gt;&gt;<i> I've had quite a bit of success working with some test programs and
</I>&gt;&gt;<i> OpenLdap, but the only thing I cannot do is write to the directory
</I>&gt;&gt;<i> store.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> DirectoryEntry.CommitChanges() runs and exits ok, but doesn't seem to
</I>&gt;&gt;<i> really do anything. Then next time I run it, or read the directory in GQ
</I>&gt;&gt;<i> the entry is still exactly the same.
</I>&gt;<i>
</I>&gt;<i> CommitChanges() works fine for me from mono-1.0.0 to mono-1.1.1, and I
</I>&gt;<i> can write to OpenLDAP (2.0 and 2.1). Are you sure there is no exception
</I>&gt;<i> ? Maybe your binding is wrong, or you do not respect the LDAP schema...
</I>&gt;<i>
</I>&gt;<i> Attached is an example code of mine that creates a user entry. You could
</I>&gt;<i> also send me your code so I can test it.
</I>&gt;<i>
</I>&gt;&gt;<i> Right now I'm using Mono-1.0 with Linux Mandrake 10.1 (actually Cooker,
</I>&gt;&gt;<i> I'm going to redo my Laptop with 10.1 PowerPack now that its out)
</I>&gt;<i>
</I>&gt;<i> I use Mandrake 10.0 and Debian Sarge.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Arnaud Bienvenu
</I>&gt;<i> Makina Corpus
</I>&gt;<i>
</I>
------=_20041029210055_55139
Content-Type: text/x-csharp; name=&quot;AD Write.cs&quot;
Content-Transfer-Encoding: 8bit
Content-Disposition: attachment; filename=&quot;AD Write.cs&quot;

using System;
using System.DirectoryServices;

public class ADWrite {
    public static void Main(String[] args) {
        if ( args.Length!=3 ) {
            Console.WriteLine(&quot;Usage: &quot; + Environment.GetCommandLineArgs()[0] + &quot; &lt;ad_path&gt; &lt;property&gt; &lt;value&gt;&quot;);
            Console.WriteLine ();
            Console.WriteLine (&quot;Press Enter to continue...&quot;);
            Console.ReadLine();
            return;
        }

        DirectoryEntry objDirEnt = new DirectoryEntry(args[0],&quot;cn=Manager,ou=People, o=Alexandria&quot;, &quot;secret&quot;);
        Console.WriteLine(&quot;Name            = &quot; + objDirEnt.Name);
        Console.WriteLine(&quot;Path            = &quot; + objDirEnt.Path);
        Console.WriteLine(&quot;SchemaClassName = &quot; + objDirEnt.SchemaClassName);
        Console.WriteLine(args[1] + &quot; = &quot; + (objDirEnt.Properties[args[1]][0]).ToString());
        Console.WriteLine(&quot;... changing to &quot;);
        objDirEnt.Properties[args[1]][0] = args[2];
        objDirEnt.CommitChanges();
        Console.WriteLine(args[1] + &quot; = &quot; + (objDirEnt.Properties[args[1]][0]).ToString());
    }
}
------=_20041029210055_55139--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="024150.html">[Mono-list] sqlite multiple row insertion
</A></li>
	<LI> Next message: <A HREF="024155.html">[Mono-list] runtime errors after building and attenpting to run latest cvs
 mono gtk apps
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24154">[ date ]</a>
              <a href="thread.html#24154">[ thread ]</a>
              <a href="subject.html#24154">[ subject ]</a>
              <a href="author.html#24154">[ author ]</a>
         </LI>
       </UL>
</body></html>
