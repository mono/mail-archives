<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Problem with xml.Serialization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:robik%40mailbox.sk">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="023778.html">
   <LINK REL="Next"  HREF="023780.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Problem with xml.Serialization
   </H1>
    <B>RoBiK
    </B> 
    <A HREF="mailto:robik%40mailbox.sk"
       TITLE="[Mono-list] Problem with xml.Serialization">robik@mailbox.sk
       </A><BR>
    <I>Thu, 14 Oct 2004 15:42:51 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="023778.html">[Mono-list] Problem with xml.Serialization
</A></li>
        <LI> Next message: <A HREF="023780.html">[Mono-list] Problem with xml.Serialization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23779">[ date ]</a>
              <a href="thread.html#23779">[ thread ]</a>
              <a href="subject.html#23779">[ subject ]</a>
              <a href="author.html#23779">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As the error message says: The type gorganizer.Subject was not expected. Use
the XmlInclude or SoapInclude attribute to specify types that are not known
statically.
You are assinging an instance of type gorganizer.Subject to a &quot;obj&quot; variable
of type object. When the serializer tries to serialize this variable, it
finds that this is not an instance of type object but something it did not
expected. So either use the XmlInlude attribude to tell the serializer what
to expect, or rework your code to use another aproach.

Robert



-----Original Message-----
From: <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>
[mailto:<A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>] On Behalf Of Sergio Paracuellos
Sent: Donnerstag, 14. Oktober 2004 15:27
To: <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>
Subject: [Mono-list] Problem with xml.Serialization

Hi!

I'm doing an application and I need to serialize in xml a list of objects. I
get the following error:

Unhandled Exception: System.InvalidOperationException: The type
gorganizer.Subject was not expected. Use the XmlInclude or SoapInclude
attribute to specify types that are not known statically.
in &lt;0x001d0&gt;
System.Xml.Serialization.XmlSerializationWriter:WriteTypedPrimitive
(string,string,object,bool)
in &lt;0x00380&gt;
System.Xml.Serialization.XmlSerializationWriterInterpreter:WriteObject
(System.Xml.Serialization.XmlTypeMapping,object,string,string,bool,bool,bool
)
in &lt;0x00ca0&gt;
System.Xml.Serialization.XmlSerializationWriterInterpreter:WriteMemberElemen
t (System.Xml.Serialization.XmlTypeMapElementInfo,object)
in &lt;0x004f8&gt;
System.Xml.Serialization.XmlSerializationWriterInterpreter:WriteListContent
(System.Xml.Serialization.TypeData,System.Xml.Serialization.ListMap,object,S
ystem.Text.StringBuilder)
in &lt;0x0024c&gt;
System.Xml.Serialization.XmlSerializationWriterInterpreter:WriteListElement
(System.Xml.Serialization.XmlTypeMapping,object,string,string)
in &lt;0x0050c&gt;
System.Xml.Serialization.XmlSerializationWriterInterpreter:WriteObject
(System.Xml.Serialization.XmlTypeMapping,object,string,string,bool,bool,bool
)
in &lt;0x001c0&gt;
System.Xml.Serialization.XmlSerializationWriterInterpreter:WriteRoot
(object)
in &lt;0x000e0&gt; System.Xml.Serialization.XmlSerializer:Serialize
(object,System.Xml.Serialization.XmlSerializationWriter)
in &lt;0x00150&gt; System.Xml.Serialization.XmlSerializer:Serialize
(System.Xml.XmlWriter,object,System.Xml.Serialization.XmlSerializerNamespace
s)
in &lt;0x000a4&gt; System.Xml.Serialization.XmlSerializer:Serialize
(System.IO.Stream,object)
in &lt;0x000b4&gt; gorganizer.MainWindow:SaveDataToXml () in &lt;0x0002c&gt;
gorganizer.MainWindow:OnSaveClicked
(object,System.EventArgs)
in &lt;0x000bc&gt; (wrapper delegate-invoke)
System.MulticastDelegate:invoke_void_object_EventArgs
(object,System.EventArgs)
in &lt;0x001c8&gt; GtkSharp.voidObjectSignal:voidObjectCallback (intptr,int) in
&lt;0x00094&gt; (wrapper native-to-managed)
GtkSharp.voidObjectSignal:voidObjectCallback (intptr,int) in (unmanaged)
(wrapper managed-to-native) Gtk.Application:gtk_main () in &lt;0x00080&gt;
(wrapper managed-to-native) Gtk.Application:gtk_main () in &lt;0x00014&gt;
Gtk.Application:Run () in &lt;0x00044&gt; gorganizer.Gorganizer:Main ()

A resume of the code:

When I push save button:

 private void OnSaveClicked (object o, EventArgs args) {
     this.SaveDataToXml();
 }


private void SaveDataToXml () {
  using (FileStream fs = new FileStream(&quot;data.xml&quot;, FileMode.Create)) {
     XmlSerializer serializer = new XmlSerializer(typeof(SubjectList));
     serializer.Serialize(fs, mySubjectList);
  }
}

* SubjectList.cs:

using System;
using System.Collections;
using System.Xml.Serialization;

namespace gorganizer {

    public class SubjectList: ArrayList, IMyList {
        private object obj;
        private int length;

        //For Serialization
        public SubjectList (){}

        public Subject Obj {
            get {
                return ((Subject)obj);
            }
        }
 	
	public int Length () {
            return this.Count;
        }

        /*
         * Add an object to list if doesn't exists
         */
        public bool AddToList(object obj) {
            if (obj != null &amp;&amp; !this.Contains(obj)) {
                this.Add(obj);
                Console.WriteLine(&quot;Insertado&quot;);
                return true;
            }
            return false;
        }

        /*
         * Remove a object if it is in the list
         */
        public bool RemoveFromList(object obj) {
            if (this.Contains(obj) &amp;&amp; obj != null) {
                this.Remove(obj);
                Console.WriteLine(&quot;Eliminado&quot;);
                return true;
            }
            return false;
        }

 public void ListElements (ArrayList myList) {
            this.PrintValues(myList);
        }

        /* returns a Subject from specified name */
        public Subject getSubject (string name) {
            Subject aux = null;
            Subject s = null;
            IEnumerator i = this.GetEnumerator();
            while (i.MoveNext()) {
                if (i.Current is Subject) {
                    aux = (Subject) i.Current;
                    if (aux.Name.Equals(name)) {
                        s = aux;
                    }
                }
            }
            return s;
        }

        private void PrintValues (ArrayList myList) {
            IEnumerator myEnumerator = myList.GetEnumerator();
            while (myEnumerator.MoveNext())
                Console.WriteLine(myEnumerator.Current.ToString());
        }
    }
}

Subject.cs:

using System;
using System.Xml.Serialization;

namespace gorganizer {

    public class Subject {

        //Constructor
        public Subject () {
        }

        private string name;
        public string Name {
            get {
                return name;
            }
            set {
                name = value;
            }
        }

        private TimeTable theory;
        public TimeTable Theory {
            get {
                return theory;
            }
            set {
                theory = value;
            }
        }

        private string comment;
        public string Comment {
            get {
                return comment;
            }
            set {
                comment = value;
            }
        }

        public void DeleteFields () {
            name = null;
            theory = null;
            comment = null;
        }
    }
}

Any Idea of what it's happening?

Thanks to all,

Regards,

	Sergio Paracuellos


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="023778.html">[Mono-list] Problem with xml.Serialization
</A></li>
	<LI> Next message: <A HREF="023780.html">[Mono-list] Problem with xml.Serialization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23779">[ date ]</a>
              <a href="thread.html#23779">[ thread ]</a>
              <a href="subject.html#23779">[ subject ]</a>
              <a href="author.html#23779">[ author ]</a>
         </LI>
       </UL>
</body></html>
