<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] anyone got bDataAdapter.Fill Method work?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono%40b-lan.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="022095.html">
   <LINK REL="Next"  HREF="022098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] anyone got bDataAdapter.Fill Method work?
   </H1>
    <B>Dennis Boylan
    </B> 
    <A HREF="mailto:mono%40b-lan.com"
       TITLE="[Mono-list] anyone got bDataAdapter.Fill Method work?">mono@b-lan.com
       </A><BR>
    <I>Tue, 13 Jul 2004 14:20:42 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="022095.html">[Mono-list] Remaining S/390 JIT issues
</A></li>
        <LI> Next message: <A HREF="022098.html">[Mono-list] anyone got bDataAdapter.Fill Method work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22097">[ date ]</a>
              <a href="thread.html#22097">[ thread ]</a>
              <a href="subject.html#22097">[ subject ]</a>
              <a href="author.html#22097">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Jul 12, 2004 at 10:59:30PM -0600, S Umadevi wrote:
&gt;<i> Hi Denis/Igor
</I>&gt;<i> Does Test2 and Test3 below work?
</I>
Both Test2 and Test3 work.


&gt;<i> Also can you send me the the database table schema ( for the table you
</I>&gt;<i> are querying), along with the values in the  first row.
</I>
In the case of test2/3, the table does not have any data.  Pointing it to
the production database, I get test2 and test3 to return all 8 rows from
the database.

Here is the exerp of create script:
CREATE TABLE [dbo].[Network] (
        [Id] [int] IDENTITY (1, 1) NOT NULL ,
        [Version] [int] NOT NULL ,
        [Parent] [int] NOT NULL ,
        [Name] [nvarchar] (40) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
        [AddrType] [tinyint] NOT NULL ,
        [FitStyle] [tinyint] NOT NULL ,
        [NtwkType] [tinyint] NOT NULL ,
        [MinBorrow] [tinyint] NOT NULL ,
        [MaxBorrow] [tinyint] NOT NULL ,
        [ReuseDay] [int] NOT NULL ,
        [Note] [nvarchar] (255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
        [XId] [int] NULL
) ON [PRIMARY]
ALTER TABLE [dbo].[Network] WITH NOCHECK ADD
        CONSTRAINT [PK_Network] PRIMARY KEY  CLUSTERED
        (
                [Id]
        )  ON [PRIMARY]
 CREATE  UNIQUE  INDEX [IX_NtwkIdVer] ON [dbo].[Network]([Id], [Version]) ON [PRIMARY]
 CREATE  UNIQUE  INDEX [IX_ParentIdName] ON [dbo].[Network]([Parent], [Name]) ON [PRIMARY]
 CREATE  INDEX [IX_NtwkAddrType] ON [dbo].[Network]([AddrType]) ON [PRIMARY]
CREATE PROCEDURE [GetNtwkNEType]
        ( @AddrType     [tinyint])
 AS
Select * From [Network] Where [AddrType] != @AddrType
Order By Parent, Name

&gt;<i> 
</I>&gt;<i> Would also be useful if you can send the enitre stack trace of the
</I>&gt;<i> exception below..
</I>
Here is the complete trace:
Server error in '/' application
Description: Error processing request.

Error Message: HTTP 500.

Stack Trace:

System.Data.SqlClient.SqlException: Error converting data type nvarchar to tinyint.
in [0x00034] (at /tmp/snapshot/20040712/mcs/class/System.Data/System.Data.SqlClient/SqlConnection.cs:204) System.Data.SqlClient.SqlConnection:ErrorHandler (object,Mono.Data.Tds.Protocol.TdsInternalErrorMessageEventArgs)
in &lt;0x00069&gt; (wrapper delegate-invoke) System.MulticastDelegate:invoke_void_object_TdsInternalErrorMessageEventArgs (object,Mono.Data.Tds.Protocol.TdsInternalErrorMessageEventArgs)
in [0x00019] (at /tmp/snapshot/20040712/mcs/class/Mono.Data.Tds/Mono.Data.Tds.Protocol/Tds.cs:1076) Mono.Data.Tds.Protocol.Tds:OnTdsErrorMessage (Mono.Data.Tds.Protocol.TdsInternalErrorMessageEventArgs)
in &lt;0x00056&gt; (wrapper remoting-invoke-with-check) Mono.Data.Tds.Protocol.Tds:OnTdsErrorMessage (Mono.Data.Tds.Protocol.TdsInternalErrorMessageEventArgs)
in [0x000fe] (at /tmp/snapshot/20040712/mcs/class/Mono.Data.Tds/Mono.Data.Tds.Protocol/Tds.cs:1117) Mono.Data.Tds.Protocol.Tds:ProcessMessage (Mono.Data.Tds.Protocol.TdsPacketSubType)
in &lt;0x00052&gt; (wrapper remoting-invoke-with-check) Mono.Data.Tds.Protocol.Tds:ProcessMessage (Mono.Data.Tds.Protocol.TdsPacketSubType)
in [0x00130] (at /tmp/snapshot/20040712/mcs/class/Mono.Data.Tds/Mono.Data.Tds.Protocol/Tds.cs:1164) Mono.Data.Tds.Protocol.Tds:ProcessSubPacket ()
in [0x00017] (at /tmp/snapshot/20040712/mcs/class/Mono.Data.Tds/Mono.Data.Tds.Protocol/Tds.cs:278) Mono.Data.Tds.Protocol.Tds:NextResult ()
in [0x0003c] (at /tmp/snapshot/20040712/mcs/class/System.Data/System.Data.SqlClient/SqlDataReader.cs:832) System.Data.SqlClient.SqlDataReader:NextResult ()
in &lt;0x0005d&gt; (wrapper remoting-invoke-with-check) System.Data.SqlClient.SqlDataReader:NextResult ()
in [0x00076] (at /tmp/snapshot/20040712/mcs/class/System.Data/System.Data.SqlClient/SqlDataReader.cs:82) System.Data.SqlClient.SqlDataReader:.ctor (System.Data.SqlClient.SqlCommand)
in &lt;0x00056&gt; (wrapper remoting-invoke-with-check) System.Data.SqlClient.SqlDataReader:.ctor (System.Data.SqlClient.SqlCommand)
in [0x0002c] (at /tmp/snapshot/20040712/mcs/class/System.Data/System.Data.SqlClient/SqlCommand.cs:348) System.Data.SqlClient.SqlCommand:ExecuteReader (System.Data.CommandBehavior)
in &lt;0x00054&gt; (wrapper remoting-invoke-with-check) System.Data.SqlClient.SqlCommand:ExecuteReader (System.Data.CommandBehavior)
in [0x00002] (at /tmp/snapshot/20040712/mcs/class/System.Data/System.Data.SqlClient/SqlCommand.cs:421) System.Data.SqlClient.SqlCommand:System.Data.IDbCommand.ExecuteReader (System.Data.CommandBehavior)
in [0x00026] (at /tmp/snapshot/20040712/mcs/class/System.Data/System.Data.Common/DbDataAdapter.cs:247) System.Data.Common.DbDataAdapter:Fill (System.Data.DataTable,System.Data.IDbCommand,System.Data.CommandBehavior)
in [0x00015] (at /tmp/snapshot/20040712/mcs/class/System.Data/System.Data.Common/DbDataAdapter.cs:204) System.Data.Common.DbDataAdapter:Fill (System.Data.DataTable)
in &lt;0x00058&gt; (wrapper remoting-invoke-with-check) System.Data.Common.DbDataAdapter:Fill (System.Data.DataTable)
in [0x00092] (at /home/dennis/Dev/new/DbLayer/Network.cs:1070) IA.DbLayer.DBNetwork:GetDTNetwork (int)
in [0x00002] (at /home/dennis/Dev/new/DbLayer/Network.cs:1028) IA.DbLayer.DBNetwork:ToXmlFile (System.IO.TextWriter,int)
in [0x00009] (at /home/dennis/Dev/new/DbLayer/Network.cs:1023) IA.DbLayer.DBNetwork:GetNetworkXml (int)
in [0x00060] (at /home/dennis/Dev/new/DbLayer/DbXPage.cs:243) IA.DbLayer.XApi:GetNtwkXml (System.Web.HttpContext)
in [0x00006] (at /home/dennis/Dev/new/IPal/IPalPage.cs:104) IA.IPal.IPalPage:GetNtwkXml ()
in [0x00023] (at /home/dennis/Dev/new/IPal/Login.aspx.cs:354) IA.IPal.Login:StartPicker ()
in [0x00016] (at /home/dennis/Dev/new/IPal/Login.aspx.cs:343) IA.IPal.Login:RunDailyChore ()
in [0x00053] (at /home/dennis/Dev/new/IPal/Login.aspx.cs:164) IA.IPal.Login:Page_Load (object,System.EventArgs)
in &lt;0x00069&gt; (wrapper delegate-invoke) System.MulticastDelegate:invoke_void_object_EventArgs (object,System.EventArgs)
in [0x00030] (at /tmp/snapshot/20040712/mcs/class/System.Web/System.Web.UI/Control.cs:574) System.Web.UI.Control:OnLoad (System.EventArgs)
in [0x00056] (at /home/dennis/Dev/new/IPal/IPalPage.cs:351) IA.IPal.IPalPage:OnLoad (System.EventArgs)
in [0x00006] (at /tmp/snapshot/20040712/mcs/class/System.Web/System.Web.UI/Control.cs:809) System.Web.UI.Control:LoadRecursive ()
in [0x000b7] (at /tmp/snapshot/20040712/mcs/class/System.Web/System.Web.UI/Page.cs:747) System.Web.UI.Page:InternalProcessRequest ()
in [0x00052] (at /tmp/snapshot/20040712/mcs/class/System.Web/System.Web.UI/Page.cs:720) System.Web.UI.Page:ProcessRequest (System.Web.HttpContext)
in [0x00091] (at /tmp/snapshot/20040712/mcs/class/System.Web/System.Web/HttpApplication.cs:444) ExecuteHandlerState:Execute ()
in [0x0001e] (at /tmp/snapshot/20040712/mcs/class/System.Web/System.Web/HttpApplication.cs:708) StateMachine:ExecuteState (System.Web.HttpApplication/IStateHandler,bool&amp;)

- Dennis
&gt;<i> 
</I>&gt;<i> Regards
</I>&gt;<i> Uma
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt;&gt; Dennis Boylan &lt;<A HREF="mailto:mono@b-lan.com">mono@b-lan.com</A>&gt; 7/13/2004 2:52:28 AM &gt;&gt;&gt;
</I>&gt;<i> I'm trying to chase this down myself.  I've got a .NET application
</I>&gt;<i> which
</I>&gt;<i> runs fine under the Microsoft runtime, but I get a:
</I>&gt;<i> 
</I>&gt;<i> System.Data.SqlClient.SqlException: Error converting data type nvarchar
</I>&gt;<i> to tinyint.
</I>&gt;<i> 
</I>&gt;<i> while trying to run the same application under mono.
</I>&gt;<i> 
</I>&gt;<i> I thought it was fill as well because the traceback looks like this:
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00058&gt; (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.Data.Common.DbDataAdapter:Fill (System.Data.DataTable)
</I>&gt;<i> in [0x00092] (at /home/dennis/Dev/new/DbLayer/Network.cs:1070)
</I>&gt;<i> IA.DbLayer.DBNetwork:GetDTNetwork (int)
</I>&gt;<i> 
</I>&gt;<i> Where GetDTNetwork is trying to fill a DataTable with the values from
</I>&gt;<i> a
</I>&gt;<i> MS SQL database on a remote machine.  It is the last part of my
</I>&gt;<i> application
</I>&gt;<i> code before it gets lost in the weeds.
</I>&gt;<i> 
</I>&gt;<i> I thought it might be because the table was empty, so I wrote a little
</I>&gt;<i> standalone app to test it.  The standalone app works.
</I>&gt;<i> 
</I>&gt;<i> My first test was trying it without using my stored procedure.  It was
</I>&gt;<i> called test2.  The second uses a stored procedure like the application
</I>&gt;<i> normally does.  It was called test3.
</I>&gt;<i> 
</I>&gt;<i> These were my best approximations of what the code at the location was
</I>&gt;<i> trying to do.  The real code hides the type of database, so direct
</I>&gt;<i> examples
</I>&gt;<i> would not be all that useful.
</I>&gt;<i> 
</I>&gt;<i> Now, mind you, I'm trying this on the bleeding edge.
</I>&gt;<i> [<A HREF="mailto:dennis@Shuttle">dennis@Shuttle</A> test]$ mono -V
</I>&gt;<i> Mono JIT compiler version 1.0.20040712, (C) 2002-2004 Novell, Inc and
</I>&gt;<i> Contributors. www.go-mono.com 
</I>&gt;<i>         TLS:           __thread
</I>&gt;<i>         GC:            Included Boehm (with typed GC)
</I>&gt;<i>         SIGSEGV      : normal
</I>&gt;<i>         Globalization: ICU
</I>&gt;<i> 
</I>&gt;<i> - Dennis
</I>&gt;<i> 
</I>&gt;<i> -- test2.cs --
</I>&gt;<i> 
</I>&gt;<i>  using System;
</I>&gt;<i>  using System.Data;
</I>&gt;<i>  using System.Data.Common;
</I>&gt;<i>  using System.Data.SqlClient;
</I>&gt;<i> 
</I>&gt;<i>  public class Test
</I>&gt;<i>  {
</I>&gt;<i>      public static void Main(string[] args)
</I>&gt;<i>      {
</I>&gt;<i>         string connectionString =
</I>&gt;<i>               &quot;Address=hp,1434;&quot; +
</I>&gt;<i>               &quot;Database=Linux;&quot; +
</I>&gt;<i>               &quot;User ID=test;&quot; +
</I>&gt;<i>               &quot;Password=test;&quot;;
</I>&gt;<i>         IDbConnection dbcon;
</I>&gt;<i>         dbcon = new SqlConnection(connectionString);
</I>&gt;<i>         dbcon.Open();
</I>&gt;<i>         IDbCommand dbcmd = dbcon.CreateCommand();
</I>&gt;<i>         string sql = &quot;SELECT Name, Parent &quot; +
</I>&gt;<i> 	             &quot;FROM Network&quot;;
</I>&gt;<i>         dbcmd.CommandText = sql;
</I>&gt;<i>         DataTable dtNtwk = new DataTable(&quot;Network&quot;);
</I>&gt;<i>         DbDataAdapter dbAdptr = new SqlDataAdapter((SqlCommand)dbcmd);
</I>&gt;<i>         int iRows = dbAdptr.Fill(dtNtwk);
</I>&gt;<i> 	Console.WriteLine (&quot;Returned &quot; + iRows + &quot; rows&quot;);
</I>&gt;<i>         dbcon.Close();
</I>&gt;<i>         dbcon = null;
</I>&gt;<i>     }
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> -- test3.cs --
</I>&gt;<i>  using System;
</I>&gt;<i>  using System.Data;
</I>&gt;<i>  using System.Data.Common;
</I>&gt;<i>  using System.Data.SqlClient;
</I>&gt;<i> 
</I>&gt;<i>  public class Test
</I>&gt;<i>  {
</I>&gt;<i>      public static void Main(string[] args)
</I>&gt;<i>      {
</I>&gt;<i>         string connectionString =
</I>&gt;<i>               &quot;Address=hp,1434;&quot; +
</I>&gt;<i>               &quot;Database=Linux;&quot; +
</I>&gt;<i>               &quot;User ID=test;&quot; +
</I>&gt;<i>               &quot;Password=test;&quot;;
</I>&gt;<i>         IDbConnection dbcon;
</I>&gt;<i>         dbcon = new SqlConnection(connectionString);
</I>&gt;<i>         dbcon.Open();
</I>&gt;<i>         IDbCommand dbcmd = new SqlCommand(&quot;GetNtwkNEType&quot;,
</I>&gt;<i> (SqlConnection)dbcon);
</I>&gt;<i> 	dbcmd.CommandType = CommandType.StoredProcedure;
</I>&gt;<i> 	IDataParameter param =
</I>&gt;<i> ((SqlCommand)dbcmd).Parameters.Add(&quot;@AddrType&quot;, SqlDbType.TinyInt);
</I>&gt;<i> 	param.Direction = ParameterDirection.Input;
</I>&gt;<i> 	param.Value = 0;
</I>&gt;<i>         DataTable dtNtwk = new DataTable(&quot;Network&quot;);
</I>&gt;<i>         DbDataAdapter dbAdptr = new SqlDataAdapter((SqlCommand)dbcmd);
</I>&gt;<i>         int iRows = dbAdptr.Fill(dtNtwk);
</I>&gt;<i> 	Console.WriteLine (&quot;Returned &quot; + iRows + &quot; rows&quot;);
</I>&gt;<i>         dbcon.Close();
</I>&gt;<i>         dbcon = null;
</I>&gt;<i>     }
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Mon, Jul 12, 2004 at 08:40:05PM +0300, Igor Georgiev wrote:
</I>&gt;<i> &gt; anyone got DbDataAdapter.Fill Method work?
</I>&gt;<i> &gt; I need to deploy working .NET web application to apache/xsp/mono,
</I>&gt;<i> &gt; but unfortunately i always get an empty dataset :((
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; ExecuteScalar &amp; ExecuteReader works for me,  so as a last resort
</I>&gt;<i> &gt; i'll rewrite the data access components to fill dataset by hand :(((
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I think it's a bug so i submit a report,
</I>&gt;<i> &gt; but i'm very intersted does anyone get it work?
</I>&gt;<i> &gt; If yes pls notify me urgent because i have a deadline to do the work
</I>&gt;<i> .
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; ----- here is the copy of my bug report ----
</I>&gt;<i> &gt; odbcDataAdapter.Fill(DataSet) doesn't work for me
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Steps to reproduce the problem:
</I>&gt;<i> &gt; 1. create odbcDataAdapter that select something from database
</I>&gt;<i> &gt; 2. generate named/typed dataset /i'm using VS2003.NET /
</I>&gt;<i> &gt; 3. fill dataset
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Actual Results:
</I>&gt;<i> &gt; dataset is empty
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Expected Results:
</I>&gt;<i> &gt; Data in the dataset
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; How often does this happen? 
</I>&gt;<i> &gt; Always
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Additional Information:
</I>&gt;<i> &gt; Code work fine in .NET framework
</I>&gt;<i> &gt; -----
</I>&gt;<i> &gt; also i try public int Fill( DataTable dataTable); - same result :(((
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; ---
</I>&gt;<i> &gt; Outgoing mail is certified Virus Free.
</I>&gt;<i> &gt; Checked by AVG anti-virus system (<A HREF="http://www.grisoft.com">http://www.grisoft.com</A>).
</I>&gt;<i> &gt; Version: 6.0.718 / Virus Database: 474 - Release Date: 09.07.2004
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A> 
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A> 
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="022095.html">[Mono-list] Remaining S/390 JIT issues
</A></li>
	<LI> Next message: <A HREF="022098.html">[Mono-list] anyone got bDataAdapter.Fill Method work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22097">[ date ]</a>
              <a href="thread.html#22097">[ thread ]</a>
              <a href="subject.html#22097">[ subject ]</a>
              <a href="author.html#22097">[ author ]</a>
         </LI>
       </UL>
</body></html>
