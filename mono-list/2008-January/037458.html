<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Speed difference Windows - Linux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Speed%20difference%20Windows%20-%20Linux&In-Reply-To=117799f00801041058n62e62c83te4c0ee5f28c668b8%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037457.html">
   <LINK REL="Next"  HREF="037449.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Speed difference Windows - Linux</H1>
    <B>Alan McGovern</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Speed%20difference%20Windows%20-%20Linux&In-Reply-To=117799f00801041058n62e62c83te4c0ee5f28c668b8%40mail.gmail.com"
       TITLE="[Mono-list] Speed difference Windows - Linux">alan.mcgovern at gmail.com
       </A><BR>
    <I>Fri Jan  4 15:18:37 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="037457.html">[Mono-list] Speed difference Windows - Linux
</A></li>
        <LI>Next message: <A HREF="037449.html">[Mono-list] VS for dev, Linux for server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37458">[ date ]</a>
              <a href="thread.html#37458">[ thread ]</a>
              <a href="subject.html#37458">[ subject ]</a>
              <a href="author.html#37458">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok, i've found the main cause of the issue: The problem is that comparing
strings using the current culture (which is what the instance method of
string.Compare does) is incredibly slow.

To verify this, just change the code in 'DictionaryValue' to do it's
comparision using the StringComparer.Ordinal. Using
StringComparer.CurrentCulture results in the same slow behavior as the
instance method on string does.

Alan.

On Jan 4, 2008 6:58 PM, Alan McGovern &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">alan.mcgovern at gmail.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I really doubt that calling the Key, Value overload would give that much
</I>&gt;<i> of a slowdown. I'd believe a slowdown of 10%, or maybe 15%, but not 600%.
</I>&gt;<i> I'd say the slowdown is due to an inefficient algorithm as opposed to
</I>&gt;<i> anything else.
</I>&gt;<i>
</I>&gt;<i> Alan.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Jan 4, 2008 3:35 PM, Juraj Skripsky &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">js at hotfeet.ch</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I've filed a bug report for this:
</I>&gt;<i> &gt; <A HREF="https://bugzilla.novell.com/show_bug.cgi?id=351638">https://bugzilla.novell.com/show_bug.cgi?id=351638</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - Juraj
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Fri, 2008-01-04 at 16:10 +0100, Juraj Skripsky wrote:
</I>&gt;<i> &gt; &gt; I've found one potential problem in Array.Sort&lt;T&gt; (called by
</I>&gt;<i> &gt; &gt; List&lt;T&gt;.Sort) that could account for quite some slowdown.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; All of the following &quot;Sort&lt;T&gt;&quot; method overloads call a &quot;Sort&lt;TKey,
</I>&gt;<i> &gt; &gt; TValue&gt;&quot; overload with null as the values/items array to get their
</I>&gt;<i> &gt; work
</I>&gt;<i> &gt; &gt; done:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; public static void Sort&lt;T&gt; (T [] array)
</I>&gt;<i> &gt; &gt; public static void Sort&lt;T&gt; (T [] array, IComparer&lt;T&gt; comparer)
</I>&gt;<i> &gt; &gt; public static void Sort&lt;T&gt; (T [] array, int index, int length)
</I>&gt;<i> &gt; &gt; public static void Sort&lt;T&gt; (T [] array, int index, int length,
</I>&gt;<i> &gt; &gt; IComparer&lt;T&gt; comparer)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; This is suboptimal as those methods in turn use the swap&lt;K, V&gt; method
</I>&gt;<i> &gt; &gt; which needs to check (and then ignore) the values/items array.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; So we're push popping a lot of unnecessary nulls on and off the stack
</I>&gt;<i> &gt; &gt; and checking them. And as swap&lt;T&gt; is a lot smaller than swap&lt;K, V&gt; its
</I>&gt;<i> &gt; &gt; chances for being inlined by the JIT compiler are much higher.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; - Juraj
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20080104/354f422c/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20080104/354f422c/attachment.html</A> 
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037457.html">[Mono-list] Speed difference Windows - Linux
</A></li>
	<LI>Next message: <A HREF="037449.html">[Mono-list] VS for dev, Linux for server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37458">[ date ]</a>
              <a href="thread.html#37458">[ thread ]</a>
              <a href="subject.html#37458">[ subject ]</a>
              <a href="author.html#37458">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
