<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Invalid IL code error when using openxml sdk in mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Invalid%20IL%20code%20error%20when%20using%20openxml%20sdk%20in%20mono&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="047572.html">
   <LINK REL="Next"  HREF="047575.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Invalid IL code error when using openxml sdk in mono</H1>
    <B>Max</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Invalid%20IL%20code%20error%20when%20using%20openxml%20sdk%20in%20mono&In-Reply-To="
       TITLE="[Mono-list] Invalid IL code error when using openxml sdk in mono">nash12 at gmail.com
       </A><BR>
    <I>Thu Aug 11 11:20:01 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="047572.html">[Mono-list] Mono tools for VS2010 is crashing all the time
</A></li>
        <LI>Next message: <A HREF="047575.html">[Mono-list] Weirdness with System.Drawing on Mono/Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47574">[ date ]</a>
              <a href="thread.html#47574">[ thread ]</a>
              <a href="subject.html#47574">[ subject ]</a>
              <a href="author.html#47574">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello there,

I am trying to run a simple commandline application written in C# on
mono using the openxml sdk
(<A HREF="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=5124">http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=5124</A>).

Upon executing the .exe with

/opt/mono-2.10/bin/mono ParseWord.exe

I get this error:

Unhandled Exception: System.InvalidProgramException: Invalid IL code
in System.IO.Packaging.Package:Open
(string,System.IO.FileMode,System.IO.FileAccess,System.IO.FileShare):
method body is empty.

  at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.OpenCore
(System.String path, Boolean readWriteMode) [0x00000] in &lt;filename
unknown&gt;:0
  at DocumentFormat.OpenXml.Packaging.WordprocessingDocument.Open
(System.String path, Boolean isEditable,
DocumentFormat.OpenXml.Packaging.OpenSettings openSettings) [0x00000]
in &lt;filename unknown&gt;:0
  at DocumentFormat.OpenXml.Packaging.WordprocessingDocument.Open
(System.String path, Boolean isEditable) [0x00000] in &lt;filename
unknown&gt;:0
  at ParseWord.Program.Main (System.String[] args) [0x00000] in
&lt;filename unknown&gt;:0
[ERROR] FATAL UNHANDLED EXCEPTION: System.InvalidProgramException:
Invalid IL code in System.IO.Packaging.Package:Open
(string,System.IO.FileMode,System.IO.FileAccess,System.IO.FileShare):
method body is empty.

  at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.OpenCore
(System.String path, Boolean readWriteMode) [0x00000] in &lt;filename
unknown&gt;:0
  at DocumentFormat.OpenXml.Packaging.WordprocessingDocument.Open
(System.String path, Boolean isEditable,
DocumentFormat.OpenXml.Packaging.OpenSettings openSettings) [0x00000]
in &lt;filename unknown&gt;:0
  at DocumentFormat.OpenXml.Packaging.WordprocessingDocument.Open
(System.String path, Boolean isEditable) [0x00000] in &lt;filename
unknown&gt;:0
  at ParseWord.Program.Main (System.String[] args) [0x00000] in
&lt;filename unknown&gt;:0

Some code from my cli app:

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Wordprocessing;

namespace ParseWord
{
    class Program
    {
        static void Main(string[] args)
        {
            string docName = &quot;Test_2.docx&quot;;

            if (!File.Exists(docName))
            {
                return;
            }

            using (WordprocessingDocument wdDoc =
WordprocessingDocument.Open(docName, true))
            {
                ...
            }
        }
    }
}

Is there any workaround for this or is it just impossible to use the
openxml sdk on mono?

Thanks!
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="047572.html">[Mono-list] Mono tools for VS2010 is crashing all the time
</A></li>
	<LI>Next message: <A HREF="047575.html">[Mono-list] Weirdness with System.Drawing on Mono/Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47574">[ date ]</a>
              <a href="thread.html#47574">[ thread ]</a>
              <a href="subject.html#47574">[ subject ]</a>
              <a href="author.html#47574">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
