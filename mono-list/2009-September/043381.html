<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Novell LDAP (SSL) using .NET 2.0 on Windows	 Server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Novell%20LDAP%20%28SSL%29%20using%20.NET%202.0%20on%20Windows%09%20Server&In-Reply-To=25295744.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043382.html">
   <LINK REL="Next"  HREF="043384.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Novell LDAP (SSL) using .NET 2.0 on Windows	 Server</H1>
    <B>St&#233;phane Zanoni</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Novell%20LDAP%20%28SSL%29%20using%20.NET%202.0%20on%20Windows%09%20Server&In-Reply-To=25295744.post%40talk.nabble.com"
       TITLE="[Mono-list] Novell LDAP (SSL) using .NET 2.0 on Windows	 Server">Stephane at omni-ts.com
       </A><BR>
    <I>Fri Sep  4 10:57:05 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="043382.html">[Mono-list] Novell LDAP (SSL) using .NET 2.0 on Windows Server
</A></li>
        <LI>Next message: <A HREF="043384.html">[Mono-list] Novell LDAP (SSL) using .NET 2.0 on Windows	 Server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43381">[ date ]</a>
              <a href="thread.html#43381">[ thread ]</a>
              <a href="subject.html#43381">[ subject ]</a>
              <a href="author.html#43381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, Tom.
 
Here is a quick snippet...  As long as your looks like this and the
Mono.Security.dll is in the same directory as your DLL, you should be
fine.
 
var conn = new Novell.Directory.Ldap.LdapConnection();
conn.SecureSocketLayer = true;
conn.UserDefinedServerCertValidationDelegate += delegate { return true;
};
 
conn.Connect(&quot;192.168.0.1&quot;, 636);
 
conn.Bind(&quot;cn=admin,o=users&quot;, &quot;mysecret&quot;);
 
 
St&#233;phane 
 


&gt;&gt;&gt;<i> On 9/4/2009 at 08:46, stonefish &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">tom at stonefish.co.uk</A>&gt; wrote:
</I>

Hi,

(This is roughly the same message as was mistakenly on the ASP.NET
section,
but with the vital point that it's Novell LDAP, not MS LDAP!)

My client requires us to connect to their Novell LDAP system through
SSL
with the ASP.NET (2.0) application we have written, which is going to
run on
Windows 2003 Server through IIS6.  For the moment I am using a simple
console application to test my code - a lot easier and simpler that
uploading the rather large web application dlls each time.

&gt;<i>From everything I've read, it appears that Mono is the best solution
</I>to
this, but I'm having a great deal of difficulty getting it to work.

I have added the novell.directory.ldap.dll and mono.security.dll
references
to the console app, and included the dlls in &quot;installation&quot; directory
on the
server.
I have installed Mono (2.4.2.3) but not included the GTK part, as I
don't
believe it's necessary.
I have added the security certificate from the clients LDAP system into
the
Trust store using certmgr.

But when I attempt a secure bind to the Novell LDAP server, I receive a
91
Connect Error, with the IOException of &quot;The authentication or
decryption has
failed&quot; and TlsException of &quot;Invalid certificate received from
server&quot;.

What have I missed?
Am I trying to achieve the impossible... or have I missed a simple step
out? 
(Do I need to set an application setting or environment variable that
I'm
not aware of?)

Many thanks for any help,
Cheers,
Tom 
-- 
View this message in context:
<A HREF="http://www.nabble.com/Novell-LDAP-%28SSL%29-using-.NET-2.0-on-Windows-Server-tp25295744p25295744.html">http://www.nabble.com/Novell-LDAP-%28SSL%29-using-.NET-2.0-on-Windows-Server-tp25295744p25295744.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.

_______________________________________________
Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20090904/cd62bbdf/attachment-0001.html">http://lists.ximian.com/pipermail/mono-list/attachments/20090904/cd62bbdf/attachment-0001.html</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043382.html">[Mono-list] Novell LDAP (SSL) using .NET 2.0 on Windows Server
</A></li>
	<LI>Next message: <A HREF="043384.html">[Mono-list] Novell LDAP (SSL) using .NET 2.0 on Windows	 Server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43381">[ date ]</a>
              <a href="thread.html#43381">[ thread ]</a>
              <a href="subject.html#43381">[ subject ]</a>
              <a href="author.html#43381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
