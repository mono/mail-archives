<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] [PATCH] Makefile adjustments for non-Mini platforms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:horst%40reiterer.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="014692.html">
   <LINK REL="Next"  HREF="014694.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] [PATCH] Makefile adjustments for non-Mini platforms
   </H1>
    <B>Horst G. Reiterer
    </B> 
    <A HREF="mailto:horst%40reiterer.net"
       TITLE="[Mono-list] [PATCH] Makefile adjustments for non-Mini platforms">horst@reiterer.net
       </A><BR>
    <I>Sat, 28 Jun 2003 00:10:49 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="014692.html">[Mono-list] A big (MS created) flaw in DateTime that surfaces
 in Web Services
</A></li>
        <LI> Next message: <A HREF="014694.html">[Mono-list] [PATCH] Makefile adjustments for non-Mini platforms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14647">[ date ]</a>
              <a href="thread.html#14647">[ thread ]</a>
              <a href="subject.html#14647">[ subject ]</a>
              <a href="author.html#14647">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

the following patch fixes a build problem on platforms
not supported by Mini. On these, the execution of monoburg
fails because the burg definition source path is empty
causing monoburg to read the definition from standard
input which in turn causes the build process to &quot;hang&quot;.

IMHO, the cleanest solution to this problem (and possible
related problems in the future) is to skip the mini tree
on unsupported platforms (!JIT_SUPPORTED). The patch below
implements this strategy. Builds with the patch applied were
successful and seemed to produce a complete set of files...

Thanks in advance for applying!

    Horst


Index: mono/mono/Makefile.am
===================================================================
RCS file: /mono/mono/mono/Makefile.am,v
retrieving revision 1.25
diff -u -r1.25 Makefile.am
--- mono/mono/Makefile.am 27 May 2003 10:57:03 -0000 1.25
+++ mono/mono/Makefile.am 27 Jun 2003 21:24:01 -0000
@@ -1,8 +1,15 @@
+# only add jit-specific directories if needed
+if JIT_SUPPORTED
+    jitdirs = mini
+else
+    jitdirs =
+endif
+
 # the handles dir doesn't apply to windows
 if PLATFORM_WIN32
 SUBDIRS = utils io-layer monoburg os metadata cil dis \
- arch monograph interpreter mini tests benchmark
+ arch monograph interpreter ${jitdirs} tests benchmark
 else
 SUBDIRS = utils io-layer monoburg os metadata cil dis \
- arch monograph interpreter mini tests benchmark handles
+ arch monograph interpreter ${jitdirs} tests benchmark handles
 endif
Index: mono/mono/mini/Makefile.am
===================================================================
RCS file: /mono/mono/mono/mini/Makefile.am,v
retrieving revision 1.25
diff -u -r1.25 Makefile.am
--- mono/mono/mini/Makefile.am 18 Jun 2003 14:18:56 -0000 1.25
+++ mono/mono/mini/Makefile.am 27 Jun 2003 21:24:01 -0000
@@ -34,13 +34,11 @@

 libmono_la_LDFLAGS=-Wl,-version-script=$(srcdir)/ldscript

-if JIT_SUPPORTED
 bin_PROGRAMS = mono

 noinst_PROGRAMS = genmdesc

 lib_LTLIBRARIES = libmono.la
-endif

 mono_SOURCES = \
  main.c



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="014692.html">[Mono-list] A big (MS created) flaw in DateTime that surfaces
 in Web Services
</A></li>
	<LI> Next message: <A HREF="014694.html">[Mono-list] [PATCH] Makefile adjustments for non-Mini platforms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14647">[ date ]</a>
              <a href="thread.html#14647">[ thread ]</a>
              <a href="subject.html#14647">[ subject ]</a>
              <a href="author.html#14647">[ author ]</a>
         </LI>
       </UL>
</body></html>
