<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] remoting mono with MS' CLR?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:t-joec%40microsoft.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="014678.html">
   <LINK REL="Next"  HREF="014684.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] remoting mono with MS' CLR?
   </H1>
    <B>Joe Castro
    </B> 
    <A HREF="mailto:t-joec%40microsoft.com"
       TITLE="[Mono-list] remoting mono with MS' CLR?">t-joec@microsoft.com
       </A><BR>
    <I>Sun, 29 Jun 2003 19:51:44 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="014678.html">[Mono-list] Mod_mono and XHTML
</A></li>
        <LI> Next message: <A HREF="014684.html">[Mono-list] More Serialization Problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14683">[ date ]</a>
              <a href="thread.html#14683">[ thread ]</a>
              <a href="subject.html#14683">[ subject ]</a>
              <a href="author.html#14683">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Lluis, thanks for responding.  Sorry for the delayed writeback, I
haven't been able to get into my school account.
Below is posted the exact code I'm using in attempt to get this to work,
removing the hardcoded IP addresses I've been using for the server.
Please forgive the length, I wouldn't ask you to parse through my code
but I'm not sure how much more academic I can make the case except for
the WriteLines. There are four files, Client, Server, Remotable, and
ToPass.  I've played around with a few variations but to no avail :(
Fine on localhost, fine between Windows, problems with Windows to Linux.
Thanks for any help with this.
    -Joe

//Client.cs
using System;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Tcp;

namespace Joe.Remoting {
    public class Client {
        public static void Main() {
             Console.WriteLine( &quot;Starting the Client . . .&quot; );
             try {
                 Console.WriteLine( &quot;\tAttempting to open TcpChannel&quot;);
                 ChannelServices.RegisterChannel( new TcpChannel() );
                 Console.WriteLine( &quot;\tAttempting to get remote object&quot;
);
                 Remotable rref =3D (Remotable)Activator.GetObject(
                     typeof(Remotable),
                     &quot;<A HREF="tcp://xxx.xxx.xxx.xxx:8011/RemoteTesting"">tcp://xxx.xxx.xxx.xxx:8011/RemoteTesting&quot;</A> );
                 if( (object)rref =3D=3D null )
                     throw new Exception( &quot;Couldn't grab remote
reference&quot; );
                 else Console.WriteLine(&quot;\tGot reference, attempting to
assign to it&quot;);
                 //The above doesn't actually check that the object is
valid, it throws
                 //an exception when I try to access it, stating that
&quot;Connection
                 //refused if server's not open.  This is even how MSDN
documents
                 //how to do this, is there a better way to do this?
                 rref.Doer =3D new ToPass();
                 Console.WriteLine( &quot;\tAttempting to make a remote call&quot;
);
                 string ret =3D rref.ProxyDo(&quot;this&quot;,&quot;is&quot;,&quot;a&quot;,&quot;test&quot;);
                 if( ret =3D=3D null )
                     throw new Exception(&quot;IDoer.DoesSomething didn't
work&quot;);
                 Console.WriteLine( &quot;\tRemote call returned:\n\t\t{0}&quot;,
ret );
             } catch( Exception e ) {
                 Console.WriteLine( &quot;An exception occured:\n{0}&quot;, e );
             }
             Console.WriteLine( &quot;Finished running the Client.&quot; );
        }
    }  =20
}

//Server.cs
using System;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Tcp;

namespace Joe.Remoting {
    public class JoeServer {
        private const int Port =3D 8011;
        public static void Main() {
            Console.WriteLine( &quot;Starting the Server . . .&quot; );
            Console.WriteLine( &quot;\tAttempting to create TCP channel&quot; );
            try {
                ChannelServices.RegisterChannel( new TcpChannel(Port) );
                RemotingConfiguration.RegisterWellKnownServiceType(
                    new Remotable().GetType(),
                    //Type.GetType(&quot;Joe.Remoting.Remotable&quot;),//Doesn't
work?
                    &quot;RemoteTesting&quot;,
                    WellKnownObjectMode.Singleton );
                Console.WriteLine(&quot;\tServer is now listening on port
{0}&quot;,Port);
            } catch( Exception e ) {
                Console.WriteLine( &quot;An error has occured:\n\n{0}&quot;, e );
            }
            Console.WriteLine( &quot;Press enter to quit&quot; );
            Console.ReadLine();
        }
    }
}

//Remotable.cs
using System;
namespace Joe.Remoting {
    public interface IDoer {
        string DoesSomething( params object[] oary );
    }
    [Serializable]
    public class Remotable : MarshalByRefObject {
        private IDoer todo;
        public Remotable()
            : this( null )
        {}
        public Remotable( IDoer todo ){
            this.todo =3D todo;
        }
        public IDoer Doer {
            get { return todo; }
            set { todo =3D value; }
        }
        public string ProxyDo( params object[] oary ){
            return todo.DoesSomething( oary );
        }
    }
}
//ToPass.cs
using System;

namespace Joe.Remoting {
    [Serializable]
    public class ToPass : IDoer {
        public string DoesSomething( params object[] oary ){
            foreach( object o in oary )
                Console.WriteLine( o );
            return &quot;There were &quot; + oary.Length + &quot; elements passed.&quot;;
        }
    }
}

-----Original Message-----
From: Lluis Sanchez [mailto:<A HREF="mailto:lluis@ideary.com">lluis@ideary.com</A>]=20
Sent: Thursday, June 26, 2003 10:39 AM
To: <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>; <A HREF="mailto:joe@cs.ucsb.edu">joe@cs.ucsb.edu</A>
Subject: Re: [Mono-list] remoting mono with MS' CLR?

Hi,

&gt;<i> Hi, I was wondering if anyone had any experience using remoting
</I>through a
&gt;<i> TCP connection between Mono and Microsoft's implementation of the CLR?
</I>I
&gt;<i> have a sample program that works on mono when remoting to the local
</I>host
as
&gt;<i> well as when remoting between two windows machines, but between linux
</I>and
&gt;<i> windows it crashes, regardless of which is the server or client.  This
</I>is
&gt;<i> without using cygwin, which I can't use for this for various reasons.
</I>Is
&gt;<i> this supposed to be working at this point in Mono's development?  I
</I>just
&gt;<i> want to know if the error is on my end or should I try to find another
</I>route
&gt;<i> to try with this project.
</I>&gt;<i> Much thanks in advance for any help on this.
</I>&gt;<i> -Joe
</I>
The TcpChannel and the BinaryFormatter is (or should be) compatible with
MS.NET. However, some classes from the library may have a different
binary
representation, because they may have a different internal data
structure,
so for example you won't be able to exchange a Hastable object between
Mono
and MS.NET. It should not be a problem if you are using primitive types,
arrays or your own classes. In any case, could you post a test case?

- Lluis.

&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="014678.html">[Mono-list] Mod_mono and XHTML
</A></li>
	<LI> Next message: <A HREF="014684.html">[Mono-list] More Serialization Problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14683">[ date ]</a>
              <a href="thread.html#14683">[ thread ]</a>
              <a href="subject.html#14683">[ subject ]</a>
              <a href="author.html#14683">[ author ]</a>
         </LI>
       </UL>
</body></html>
