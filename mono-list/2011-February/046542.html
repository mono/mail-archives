<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Exception in apache (mod_mono) error logs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Exception%20in%20apache%20%28mod_mono%29%20error%20logs&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="046544.html">
   <LINK REL="Next"  HREF="046543.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Exception in apache (mod_mono) error logs</H1>
    <B>Tomi</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Exception%20in%20apache%20%28mod_mono%29%20error%20logs&In-Reply-To="
       TITLE="[Mono-list] Exception in apache (mod_mono) error logs">bosak.tomas at gmail.com
       </A><BR>
    <I>Thu Feb  3 05:53:35 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="046544.html">[Mono-list] reflector alternitives
</A></li>
        <LI>Next message: <A HREF="046543.html">[Mono-list] Messages in apache error log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46542">[ date ]</a>
              <a href="thread.html#46542">[ thread ]</a>
              <a href="subject.html#46542">[ subject ]</a>
              <a href="author.html#46542">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

    I'm running mono (with sgen), xsp and mod_mono (all three from
master branch Jan 18 21:07:17 2011) on Ubuntu server (11.04) VPS where
are hosted 4 ASP.NET MVC 1 and 2 based web applications
(MonoAutoApplication disabled). I can see from time to time (usually
once or twice a day) this kind of message in apache error.log file
which is caused by the same web application every time (MVC 2 based
with some XML functionality in it - I don't know much about it since
I'm not a developer of this application):

..
Stacktrace:

  at System.Web.UI.Page.ProcessException (System.Exception) &lt;0x00025&gt;
  at System.Web.UI.Page.ProcessRequest (System.Web.HttpContext) &lt;0x001a7&gt;
  at System.Web.Mvc.ViewPage.ProcessRequest (System.Web.HttpContext) &lt;0x00033&gt;
  at System.Web.Mvc.HttpHandlerUtil/ServerExecuteHttpHandlerWrapper/&lt;ProcessRequest&gt;c__AnonStorey50.&lt;&gt;m__7D
() &lt;0x00028&gt;
  at System.Web.Mvc.HttpHandlerUtil/ServerExecuteHttpHandlerWrapper/&lt;Wrap&gt;c__AnonStorey51.&lt;&gt;m__7E
() &lt;0x00014&gt;
  at System.Web.Mvc.HttpHandlerUtil/ServerExecuteHttpHandlerWrapper.Wrap&lt;TResult&gt;
(System.Func`1&lt;TResult&gt;) &lt;0x00027&gt;
  at System.Web.Mvc.HttpHandlerUtil/ServerExecuteHttpHandlerWrapper.Wrap
(System.Action) &lt;0x00067&gt;
  at System.Web.Mvc.HttpHandlerUtil/ServerExecuteHttpHandlerWrapper.ProcessRequest
(System.Web.HttpContext) &lt;0x0006f&gt;
  at System.Web.HttpServerUtility.Execute
(System.Web.IHttpHandler,System.IO.TextWriter,bool,string,string,bool,bool)
&lt;0x0043e&gt;
  at System.Web.HttpServerUtility.Execute
(System.Web.IHttpHandler,System.IO.TextWriter,bool) &lt;0x0006b&gt;
  at System.Web.HttpServerUtilityWrapper.Execute
(System.Web.IHttpHandler,System.IO.TextWriter,bool) &lt;0x00037&gt;
  at System.Web.Mvc.ViewPage.RenderView (System.Web.Mvc.ViewContext) &lt;0x001e9&gt;
  at System.Web.Mvc.WebFormView.RenderViewPage
(System.Web.Mvc.ViewContext,System.Web.Mvc.ViewPage) &lt;0x00082&gt;
  at System.Web.Mvc.WebFormView.Render
(System.Web.Mvc.ViewContext,System.IO.TextWriter) &lt;0x000af&gt;
  at System.Web.Mvc.ViewResultBase.ExecuteResult
(System.Web.Mvc.ControllerContext) &lt;0x00158&gt;
  at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult
(System.Web.Mvc.ControllerContext,System.Web.Mvc.ActionResult)
&lt;0x0001d&gt;
  at System.Web.Mvc.ControllerActionInvoker/&lt;InvokeActionResultWithFilters&gt;c__AnonStorey38.&lt;&gt;m__47
() &lt;0x00022&gt;
  at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter
(System.Web.Mvc.IResultFilter,System.Web.Mvc.ResultExecutingContext,System.Func`1&lt;System.Web.Mvc.ResultExecutedContext&gt;)
&lt;0x000c3&gt;
  at System.Web.Mvc.ControllerActionInvoker/&lt;InvokeActionResultWithFilters&gt;c__AnonStorey38/&lt;InvokeActionResultWithFilters&gt;c__AnonStorey39.&lt;&gt;m__4A
() &lt;0x0001f&gt;
  at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters
(System.Web.Mvc.ControllerContext,System.Collections.Generic.IList`1&lt;System.Web.Mvc.IResultFilter&gt;,System.Web.Mvc.ActionResult)
&lt;0x00151&gt;
  at System.Web.Mvc.ControllerActionInvoker.InvokeAction
(System.Web.Mvc.ControllerContext,string) &lt;0x00264&gt;
  at System.Web.Mvc.Controller.ExecuteCore () &lt;0x0006f&gt;
  at System.Web.Mvc.ControllerBase.Execute
(System.Web.Routing.RequestContext) &lt;0x00038&gt;
  at System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute
(System.Web.Routing.RequestContext) &lt;0x00015&gt;
  at System.Web.Mvc.MvcHandler/&lt;BeginProcessRequest&gt;c__AnonStorey5A.&lt;&gt;m__90
() &lt;0x0002e&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper/&lt;MakeVoidDelegate&gt;c__AnonStorey28.&lt;&gt;m__2A
() &lt;0x00015&gt;
  at (wrapper delegate-invoke) &lt;Module&gt;.invoke_AsyncVoid__this__ () &lt;0xffffffff&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper/&lt;BeginSynchronous&gt;c__AnonStorey2A`1&lt;System.Web.Mvc.Async.AsyncVoid&gt;.&lt;&gt;m__2D
(System.IAsyncResult) &lt;0x00015&gt;
  at (wrapper delegate-invoke)
&lt;Module&gt;.invoke_AsyncVoid__this___IAsyncResult (System.IAsyncResult)
&lt;0xffffffff&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper/WrappedAsyncResult`1&lt;System.Web.Mvc.Async.AsyncVoid&gt;.End
() &lt;0x00069&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper.End&lt;System.Web.Mvc.Async.AsyncVoid&gt;
(System.IAsyncResult,object) &lt;0x0001f&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper.End
(System.IAsyncResult,object) &lt;0x00013&gt;
  at System.Web.Mvc.MvcHandler.EndProcessRequest (System.IAsyncResult) &lt;0x0001b&gt;
  at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest
(System.IAsyncResult) &lt;0x00018&gt;
  at System.Web.HttpApplication.async_handler_complete_cb
(System.IAsyncResult) &lt;0x000fb&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper/WrappedAsyncResult`1&lt;System.Web.Mvc.Async.AsyncVoid&gt;.Begin
(System.AsyncCallback,object,int) &lt;0x000e7&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper.BeginSynchronous&lt;System.Web.Mvc.Async.AsyncVoid&gt;
(System.AsyncCallback,object,System.Func`1&lt;System.Web.Mvc.Async.AsyncVoid&gt;,object)
&lt;0x000f3&gt;
  at System.Web.Mvc.Async.AsyncResultWrapper.BeginSynchronous
(System.AsyncCallback,object,System.Action,object) &lt;0x00037&gt;
  at System.Web.Mvc.MvcHandler.BeginProcessRequest
(System.Web.HttpContextBase,System.AsyncCallback,object) &lt;0x0025f&gt;
  at System.Web.Mvc.MvcHandler.BeginProcessRequest
(System.Web.HttpContext,System.AsyncCallback,object) &lt;0x00053&gt;
  at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest
(System.Web.HttpContext,System.AsyncCallback,object) &lt;0x00023&gt;
  at System.Web.HttpApplication/&lt;Pipeline&gt;c__Iterator3.MoveNext () &lt;0x033d8&gt;
  at System.Web.HttpApplication.Tick () &lt;0x0003d&gt;
  at System.Web.HttpApplication.Start (object) &lt;0x00197&gt;
  at System.Web.HttpApplication.System.Web.IHttpHandler.ProcessRequest
(System.Web.HttpContext) &lt;0x0003b&gt;
  at System.Web.HttpRuntime.Process (System.Web.HttpWorkerRequest) &lt;0x00223&gt;
  at System.Web.HttpRuntime.RealProcessRequest (object) &lt;0x00097&gt;
  at System.Web.HttpRuntime.ProcessRequest
(System.Web.HttpWorkerRequest) &lt;0x0004b&gt;
  at Mono.WebServer.MonoWorkerRequest.ProcessRequest () &lt;0x00083&gt;
  at Mono.WebServer.BaseApplicationHost.ProcessRequest
(Mono.WebServer.MonoWorkerRequest) &lt;0x00083&gt;
  at Mono.WebServer.ModMonoApplicationHost.ProcessRequest
(int,string,string,string,string,string,int,string,int,string,string[],string[],object)
&lt;0x00523&gt;
  at (wrapper remoting-invoke-with-check)
Mono.WebServer.ModMonoApplicationHost.ProcessRequest
(int,string,string,string,string,string,int,string,int,string,string[],string[],object)
&lt;0xffffffff&gt;
  at Mono.WebServer.ModMonoWorker.InnerRun (object) &lt;0x0065f&gt;
  at Mono.WebServer.ModMonoWorker.Run (object) &lt;0x0002f&gt;
  at (wrapper runtime-invoke)
&lt;Module&gt;.runtime_invoke_void__this___object
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;

Native stacktrace:

	/usr/local/bin/mono() [0x491e71]
	/lib/libpthread.so.0(+0xfc80) [0x7fa4651b0c80]
	/lib/libc.so.6(gsignal+0x35) [0x7fa464e52b45]
	/lib/libc.so.6(abort+0x186) [0x7fa464e56496]
	/usr/local/bin/mono() [0x5d313c]
	/usr/local/bin/mono() [0x5d31f5]
	/usr/local/bin/mono() [0x5c92c9]
	/usr/local/bin/mono() [0x4ca4b4]
	/usr/local/bin/mono() [0x4199aa]
	/usr/local/bin/mono() [0x41b8fd]
	/usr/local/bin/mono() [0x41c82d]
	/usr/local/bin/mono() [0x41d0bd]
	/usr/local/bin/mono() [0x493a79]
	[0x41657bba]

Debug info from gdb:


=================================================================
Got a SIGABRT while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries
used by your application.
=================================================================

[Mon Jan 31 11:39:29 2011] [error] (104)Connection reset by peer:
read_data failed
[Mon Jan 31 11:39:29 2011] [error] Command stream corrupted, last command was -1
[Mon Jan 31 11:39:29 2011] [error] (70014)End of file found: read_data failed
[Mon Jan 31 11:39:29 2011] [error] Command stream corrupted, last command was 1
Listening on: /tmp/mod_mono_server_mywebsite
Root directory: /var/www/my.web.site
...

There were also these kind of messages:

...
[Mon Jan 31 11:38:27 2011] [alert] (11)Resource temporarily
unavailable: apr_thread_create: unable to create worker thread
[Mon Jan 31 11:38:27 2011] [emerg] (22)Invalid argument:
ap_queue_info_set_idle failed. Attempting to shutdown process
gracefully.
// now few hundreds of these:
[Mon Jan 31 11:38:27 2011] [crit] (22)Invalid argument: ap_queue_pop failed
// and then few tens of these:
[Mon Jan 31 11:38:29 2011] [alert] (11)Resource temporarily
unavailable: apr_thread_create: unable to create worker thread
// and then the same exception as stated earlier

I moved this web application from my older VPS instance, where was
stable installation of mono 2.4.something (with boehm) because it was
causing memory leaks, to current one with sgen GC (I suspected boehm
for those memory leaks). Today I found this application not properly
working when accessing it through browser (instead of browsing, the
download option popups) and only restart of apache set it back to
normal. This error log messages is probably the only clue I have since
I can't determine which parts of web application are causing these
problems. Any ideas what might be wrong? I can supply apache
configuration if it will help. Thanks for your time and help.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="046544.html">[Mono-list] reflector alternitives
</A></li>
	<LI>Next message: <A HREF="046543.html">[Mono-list] Messages in apache error log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46542">[ date ]</a>
              <a href="thread.html#46542">[ thread ]</a>
              <a href="subject.html#46542">[ subject ]</a>
              <a href="author.html#46542">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
