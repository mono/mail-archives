<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Profiling web app to find where memory is going
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Profiling%20web%20app%20to%20find%20where%20memory%20is%20going&In-Reply-To=1136938544.17419.10.camel%40lalo.micasa">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030247.html">
   <LINK REL="Next"  HREF="030305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Profiling web app to find where memory is going</H1>
    <B>Joshua Tauberer</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Profiling%20web%20app%20to%20find%20where%20memory%20is%20going&In-Reply-To=1136938544.17419.10.camel%40lalo.micasa"
       TITLE="[Mono-list] Profiling web app to find where memory is going">tauberer at for.net
       </A><BR>
    <I>Thu Jan 12 21:21:56 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="030247.html">[Mono-list] Profiling web app to find where memory is going
</A></li>
        <LI>Next message: <A HREF="030305.html">[Mono-list] Profiling web app to find where memory is going
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30299">[ date ]</a>
              <a href="thread.html#30299">[ thread ]</a>
              <a href="subject.html#30299">[ subject ]</a>
              <a href="author.html#30299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gonzalo Paniagua Javier wrote:
&gt;&gt;<i> So now I have a new problem: I can see tons of strings 
</I>&gt;&gt;<i> are being allocated by I18N.Common.ByteEncoding:GetString() and 
</I>&gt;<i> 
</I>&gt;<i> You have to figure out who is calling GetString().
</I>
Okay, ok. :)  But there are a bunch of callers and they're called in a 
bunch of places...

&gt;&gt;<i> MySql.Data.MySqlClient.MySqlDataReader:GetOrdinal(), but I don't know if 
</I>&gt;<i> [...]
</I>&gt;<i> 
</I>&gt;<i> GetOrdinal() is pretty heavy creating string instances and most of them
</I>&gt;<i> can be avoided (name.ToUpper() and fieldName[i].ToUpper() called on
</I>&gt;<i> every iteration!).
</I>
Yeah, that was easy enough to fix with:
String.Compare(name, fields[i].ColumnName, true,
System.Globalization.CultureInfo.InvariantCulture);

Atsushi Eno wrote:
 &gt; is that ByteEncoding related allocation a problem in ByteEncoding
 &gt; or in whatever calls ByteEncoding.GetString() ?

It's not a problem within ByteEncoding (&quot;afaics&quot; ... as far as I can see?).

I think I should be looking for objects that aren't being released by 
whatever had a reference to them, so that they're not being GC'ed and 
are building up.  So cutting down on raw allocations can't hurt, but 
unless the act of allocating can cause the heap to grow and grow, I 
think I'm looking at the wrong thing.  Well, I'm not going to have much 
time to work on this for a few weeks, so I guess in the meanwhile I'll 
think up a new strategy to figure this out.

Can we get a way for a profiler to see when objects are being 
deallocated, or to see total counts of objects by type?  (Is that what 
heap buddy did (for anyone reading this far), or did it just see 
allocations?)

-- 
- Joshua Tauberer

<A HREF="http://taubz.for.net">http://taubz.for.net</A>

** Nothing Unreal Exists **



</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030247.html">[Mono-list] Profiling web app to find where memory is going
</A></li>
	<LI>Next message: <A HREF="030305.html">[Mono-list] Profiling web app to find where memory is going
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30299">[ date ]</a>
              <a href="thread.html#30299">[ thread ]</a>
              <a href="subject.html#30299">[ subject ]</a>
              <a href="author.html#30299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
