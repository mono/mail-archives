<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] UTF8 Encoding of data in PKCS#7
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20UTF8%20Encoding%20of%20data%20in%20PKCS%237&In-Reply-To=22B92EF8DAABDA48879D5188A70FBEF602CFD3B0%40kmdex5.intern.kmd.dk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030359.html">
   <LINK REL="Next"  HREF="030365.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] UTF8 Encoding of data in PKCS#7</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20UTF8%20Encoding%20of%20data%20in%20PKCS%237&In-Reply-To=22B92EF8DAABDA48879D5188A70FBEF602CFD3B0%40kmdex5.intern.kmd.dk"
       TITLE="[Mono-list] UTF8 Encoding of data in PKCS#7">sebastien.pouliot at gmail.com
       </A><BR>
    <I>Wed Jan 18 12:04:31 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="030359.html">[Mono-list] UTF8 Encoding of data in PKCS#7
</A></li>
        <LI>Next message: <A HREF="030365.html">[Mono-list] Bug#: 77187
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30360">[ date ]</a>
              <a href="thread.html#30360">[ thread ]</a>
              <a href="subject.html#30360">[ subject ]</a>
              <a href="author.html#30360">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Kim,

On Wed, 2006-01-18 at 12:39 +0100, Hellan.Kim KHE wrote:
&gt;<i> If you got a string you want PKCS#7 sign or envelope, are you then
</I>&gt;<i> supposed to UTF8 encode it yourself before adding the data to the
</I>&gt;<i> relevant Mono classes, or is that handled internally by Mono?
</I>&gt;<i> 
</I>&gt;<i> I got a string where I can either choose:
</I>&gt;<i>   byte[] data = System.Text.Encoding.UTF8.GetBytes(myString);
</I>&gt;<i> or
</I>&gt;<i>   byte[] data = System.Text.Encoding.Default.GetBytes(myString);
</I>&gt;<i> 
</I>&gt;<i> The problem is compatibility with OpenSSL. If I choose to UTF8 encode it
</I>&gt;<i> (first choice), the text I extract using OpenSSL is not correct and it
</I>&gt;<i> still seems UTF8 encoded.
</I>
PKCS#7 is large, so &quot;data&quot; in PKCS#7 could be a lot of thing (i.e. I
think I know what you mean but I could be wrong).

One thing is sure, you're only providing that UTF8 bytes representing
the string (this is purely data and isn't valid ASN.1). If OpenSSL tries
to interpret this as (any kind of) a ASN.1 string it won't (and can't)
deduce the encoding.

Try creating the same PKCS#7 structure using OpenSSL, dump the ASN.1
content and compare it with Mono's. This may give you the hint you need.
-- 
Sebastien Pouliot  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sebastien at ximian.com</A>&gt;
Blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030359.html">[Mono-list] UTF8 Encoding of data in PKCS#7
</A></li>
	<LI>Next message: <A HREF="030365.html">[Mono-list] Bug#: 77187
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30360">[ date ]</a>
              <a href="thread.html#30360">[ thread ]</a>
              <a href="subject.html#30360">[ subject ]</a>
              <a href="author.html#30360">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
