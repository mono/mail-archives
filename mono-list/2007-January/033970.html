<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mono-service doesn't start my service - no errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20mono-service%20doesn%27t%20start%20my%20service%20-%20no%20errors&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033969.html">
   <LINK REL="Next"  HREF="033972.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mono-service doesn't start my service - no errors</H1>
    <B>jcmag</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20mono-service%20doesn%27t%20start%20my%20service%20-%20no%20errors&In-Reply-To="
       TITLE="[Mono-list] mono-service doesn't start my service - no errors">jcmag at yahoo.com
       </A><BR>
    <I>Sat Jan 20 15:36:57 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="033969.html">[Mono-list] Serialization problem between Mono and .NET
</A></li>
        <LI>Next message: <A HREF="033972.html">[Mono-list] Mono Programming Job
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33970">[ date ]</a>
              <a href="thread.html#33970">[ thread ]</a>
              <a href="subject.html#33970">[ subject ]</a>
              <a href="author.html#33970">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, 

I've developped a Service that works on Windows. I'm trying to use it on Linux (Ubuntu 6.10), with the following command:
bash mono-service MyHal.Service.exe

but my service doesn't seem to start. I have no error messages, except:
Jan 20 21:17:47 mylaptop mono: MyHal.Service.exe: Log file already exists: /tmp/MyHal.Service.exe.lock

(when I re-run the command several times)

Here is my main function:

    static class Program
    {
        static void error (string prefix, string format, params object [] args)
        {
            Mono.Unix.Native.Syscall.syslog (Mono.Unix.Native.SyslogLevel.LOG_ERR, String.Format (&quot;{0}: {1}&quot;, prefix, String.Format (format, args)));
        }
        
        static void Main()
        {
            error(&quot;Main1&quot;, &quot;Begin&quot;);
            ServiceBase.Run(new ServiceBase[] { new MyHal.Service.Service1() });
            error(&quot;Main1&quot;, &quot;End&quot;);
        }
    }

(in syslog I see only the &quot;Begin&quot; message)

and here is my service:

    public class Service1 : ServiceBase
    {
        private static readonly log4net.ILog _log = log4net.LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType);
        public const string MyServiceName = &quot;MyHal&quot;;
        
        static void error (string prefix, string format, params object [] args)
        {
            Mono.Unix.Native.Syscall.syslog (Mono.Unix.Native.SyslogLevel.LOG_ERR, String.Format (&quot;{0}: {1}&quot;, prefix, String.Format (format, args)));
        }
    
        static Service1()
        {
            error(&quot;Service1&quot;, &quot;static constructor!!!&quot;);
            Environment.CurrentDirectory = Path.GetDirectoryName(Assembly.GetEntryAssembly().Location);
        }
        
        public Service1()
        {
            InitializeComponent();
        }
        
        private void InitializeComponent()
        {
            this.ServiceName = MyServiceName;
        }
        
        protected override void Dispose(bool disposing)
        {
            base.Dispose(disposing);
        }
        
        protected override void OnStart(string[] args)
        {
            try
            {
                log4net.Config.XmlConfigurator.ConfigureAndWatch(new FileInfo(&quot;log4net.config&quot;));
                MyHal.Engine.Core.Instance.Init();

            }
            catch (Exception exc)
            {
                _log.Fatal(&quot;Exception : &quot; + exc.Message);
                throw;
            }
        }
        
        protected override void OnStop()
        {
            try
            {
                MyHal.Engine.Core.Instance.Shutdown();
            }
            catch (Exception exc)
            {
                _log.Fatal(&quot;Exception : &quot; + exc.Message);
                throw;
            }
        }
    }

(the &quot;static constructor!!!&quot; message doesn't appear in syslog)

I am a Linux beginner so I don't know what to do now.

I've also another question: after the call to mono-service, the service is installed on the machine and will be executed, or do we have to do something for that?

Thanks in advance

JC

-------------------- 
<A HREF="http://sourceforge.net/projects/myhal">http://sourceforge.net/projects/myhal</A>





 
____________________________________________________________________________________
Expecting? Get great news right away with email Auto-Check. 
Try the Yahoo! Mail Beta.
<A HREF="http://advision.webevents.yahoo.com/mailbeta/newmail_tools.html">http://advision.webevents.yahoo.com/mailbeta/newmail_tools.html</A> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20070120/79fdf207/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20070120/79fdf207/attachment.html</A> 
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033969.html">[Mono-list] Serialization problem between Mono and .NET
</A></li>
	<LI>Next message: <A HREF="033972.html">[Mono-list] Mono Programming Job
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33970">[ date ]</a>
              <a href="thread.html#33970">[ thread ]</a>
              <a href="subject.html#33970">[ subject ]</a>
              <a href="author.html#33970">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
