<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ASP.NET on Mac OS X
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:steve%40mudflapsoftware.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="018230.html">
   <LINK REL="Next"  HREF="018246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ASP.NET on Mac OS X
   </H1>
    <B>steve@mudflapsoftware.com
    </B> 
    <A HREF="mailto:steve%40mudflapsoftware.com"
       TITLE="[Mono-list] ASP.NET on Mac OS X">steve@mudflapsoftware.com
       </A><BR>
    <I>Sun, 8 Feb 2004 16:03:16 -0800</I>
    <P><UL>
        <LI> Previous message: <A HREF="018230.html">[Mono-list] ASP.NET on Mac OS X
</A></li>
        <LI> Next message: <A HREF="018246.html">[Mono-list] ASP.NET on Mac OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18234">[ date ]</a>
              <a href="thread.html#18234">[ thread ]</a>
              <a href="subject.html#18234">[ subject ]</a>
              <a href="author.html#18234">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The biggest problem is that the place the exception is thrown is in managed
code. System.IO doesn't natively provide support for the unique
identification of files, whether it be inode or whatever.

As a workaround, I patched the code to do the following.. (pseudo code)

if (web.config and Web.config exist)
{
    FileStream fs1 = File.OpenWrite(web.config)
    try
    {
        FileStream fs2 = File.OpenWrite(Web.config)
        fs2.close()
        return files_are_different;
    }
    catch(Exception ex)
    {
        return files_are_the_same;
    }
    fs1.close
}

This workaround should be a bit more robust and check the file contents as
well, as it is possible that an exclusive lock was placed on Web.config
before entering the inner try/catch.

I wasn't gonna submit the code as a patch because it is more of a workaround
than a 'perfect fix'.... but if someone wants the code, let me know.

----- Original Message ----- 
From: &quot;Jonathan LaCour&quot; &lt;<A HREF="mailto:panix-lists@skinnee.net">panix-lists@skinnee.net</A>&gt;
To: &quot;Dan Winship&quot; &lt;<A HREF="mailto:danw@ximian.com">danw@ximian.com</A>&gt;
Cc: &quot;Jackson Harper&quot; &lt;<A HREF="mailto:jackson@ximian.com">jackson@ximian.com</A>&gt;; &quot;mono-list&quot;
&lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
Sent: Sunday, February 08, 2004 9:52 AM
Subject: Re: [Mono-list] ASP.NET on Mac OS X


&gt;<i> On Feb 8, 2004, at 12:28 PM, Dan Winship wrote:
</I>&gt;<i> &gt; That's a property of the filesystem though, not the OS. OS X does let
</I>&gt;<i> &gt; you have UFS or case-sensitive HFS partitions (and OS X Server defaults
</I>&gt;<i> &gt; to using a case-sensitive filesystem).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If this were a POSIX C program, I'd say that you should stat() both
</I>&gt;<i> &gt; files and only throw the exception if they have the same st_ino. But I
</I>&gt;<i> &gt; don't know if you can translate that into C#/.Net.
</I>&gt;<i>
</I>&gt;<i> I didn't even think of that.  You are correct, knowing that you are on
</I>&gt;<i> Mac OS X actually doesn't fix the problem.  We need to manually check
</I>&gt;<i> to see if they are the same file.  My bug probably should be updated to
</I>&gt;<i> take this into account.
</I>&gt;<i>
</I>&gt;<i> I will dig around a bit in corlib to see if there is any way for us to
</I>&gt;<i> programmatically determine if the files are the same.
</I>&gt;<i>
</I>&gt;<i>   - Jon
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="018230.html">[Mono-list] ASP.NET on Mac OS X
</A></li>
	<LI> Next message: <A HREF="018246.html">[Mono-list] ASP.NET on Mac OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18234">[ date ]</a>
              <a href="thread.html#18234">[ thread ]</a>
              <a href="subject.html#18234">[ subject ]</a>
              <a href="author.html#18234">[ author ]</a>
         </LI>
       </UL>
</body></html>
