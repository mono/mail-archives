<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Porting UPnP Tools to MONO - Socket	&quot;ExclusiveAddressUse&quot; problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Porting%20UPnP%20Tools%20to%20MONO%20-%20Socket%0A%09%22ExclusiveAddressUse%22%20problem&In-Reply-To=1273529150092-2173013.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045104.html">
   <LINK REL="Next"  HREF="045111.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Porting UPnP Tools to MONO - Socket	&quot;ExclusiveAddressUse&quot; problem</H1>
    <B>Alan McGovern</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Porting%20UPnP%20Tools%20to%20MONO%20-%20Socket%0A%09%22ExclusiveAddressUse%22%20problem&In-Reply-To=1273529150092-2173013.post%40n4.nabble.com"
       TITLE="[Mono-list] Porting UPnP Tools to MONO - Socket	&quot;ExclusiveAddressUse&quot; problem">alan.mcgovern at gmail.com
       </A><BR>
    <I>Mon May 10 18:57:02 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="045104.html">[Mono-list] Porting UPnP Tools to MONO - Socket	&quot;ExclusiveAddressUse&quot; problem
</A></li>
        <LI>Next message: <A HREF="045111.html">[Mono-list] FIXED - Everything working now
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45105">[ date ]</a>
              <a href="thread.html#45105">[ thread ]</a>
              <a href="subject.html#45105">[ subject ]</a>
              <a href="author.html#45105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I don't think this is supported on linux, only on windows.

Alan.

On Mon, May 10, 2010 at 11:05 PM, Ylian &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">ysainthilaire at hotmail.com</A>&gt; wrote:
&gt;<i> Hi.
</I>&gt;<i>
</I>&gt;<i> I own the Developer Tools for UPnP Technologies, I widely used set of tools
</I>&gt;<i> for building and debugging UPnP related software. I have gotten many
</I>&gt;<i> requests to run the tools on MONO and have gotten rid of all the C/C++
</I>&gt;<i> native code and so far, it's working except for one problem:
</I>&gt;<i>
</I>&gt;<i> I need to bind to UDP port 1900 non-exclusively to receive SSDP multicast
</I>&gt;<i> traffic. I use Ubuntu 10.04, MONO 2.4.4 and I get a &quot;SocketException:
</I>&gt;<i> Protocol Option not supported&quot; when trying to set UdpClient's
</I>&gt;<i> ExclusiveAddressUse property. Are there any alternatives?
</I>&gt;<i>
</I>&gt;<i> I am also trying to find precedents for UPnP work on MONO. My multicast
</I>&gt;<i> socket setup code below (Apache 2.0 license).
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Ylian
</I>&gt;<i> opentools.homeip.net
</I>&gt;<i>
</I>&gt;<i> public class UPnPMulticastSniffer
</I>&gt;<i> {
</I>&gt;<i> public delegate void PacketHandler(object sender, string Packet, IPEndPoint
</I>&gt;<i> Local, IPEndPoint From);
</I>&gt;<i> public event PacketHandler OnPacket;
</I>&gt;<i> private UdpClient client = null;
</I>&gt;<i>
</I>&gt;<i> public UPnPMulticastSniffer(IPEndPoint local)
</I>&gt;<i> {
</I>&gt;<i> client = new UdpClient(local.AddressFamily);
</I>&gt;<i> client.ExclusiveAddressUse = false;
</I>&gt;<i> client.Client.SetSocketOption(SocketOptionLevel.Socket,
</I>&gt;<i> SocketOptionName.ExclusiveAddressUse, false);
</I>&gt;<i> client.Client.SetSocketOption(SocketOptionLevel.Socket,
</I>&gt;<i> SocketOptionName.ReuseAddress, true);
</I>&gt;<i> client.EnableBroadcast = true;
</I>&gt;<i> client.Client.Bind(local);
</I>&gt;<i> if (local.AddressFamily == AddressFamily.InterNetwork)
</I>&gt;<i> client.JoinMulticastGroup(IPAddress.Parse(&quot;239.255.255.250&quot;),
</I>&gt;<i> local.Address); if (local.AddressFamily == AddressFamily.InterNetworkV6)
</I>&gt;<i> client.JoinMulticastGroup((int)local.Address.ScopeId,
</I>&gt;<i> IPAddress.Parse(&quot;FF02::C&quot;)); client.BeginReceive(new
</I>&gt;<i> AsyncCallback(OnReceiveSink), null);
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> public void OnReceiveSink(IAsyncResult ar)
</I>&gt;<i> {
</I>&gt;<i> IPEndPoint ep = null;
</I>&gt;<i> byte[] buf = null;
</I>&gt;<i> try { buf = client.EndReceive(ar, ref ep); } catch (Exception) { }
</I>&gt;<i> if (buf != null &amp;&amp; OnPacket != null) OnPacket(this,
</I>&gt;<i> UTF8Encoding.UTF8.GetString(buf, 0,
</I>&gt;<i> buf.Length), (IPEndPoint)client.Client.LocalEndPoint, ep); try {
</I>&gt;<i> client.BeginReceive(new AsyncCallback(OnReceiveSink), null); } catch
</I>&gt;<i> (Exception) { }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> public void Dispose()
</I>&gt;<i> {
</I>&gt;<i> if (client == null) return;
</I>&gt;<i> client.Close();
</I>&gt;<i> client = null;
</I>&gt;<i> }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i> View this message in context: Porting UPnP Tools to MONO - Socket
</I>&gt;<i> &quot;ExclusiveAddressUse&quot; problem
</I>&gt;<i> Sent from the Mono - General mailing list archive at Nabble.com.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist &#160;- &#160;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045104.html">[Mono-list] Porting UPnP Tools to MONO - Socket	&quot;ExclusiveAddressUse&quot; problem
</A></li>
	<LI>Next message: <A HREF="045111.html">[Mono-list] FIXED - Everything working now
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45105">[ date ]</a>
              <a href="thread.html#45105">[ thread ]</a>
              <a href="subject.html#45105">[ subject ]</a>
              <a href="author.html#45105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
