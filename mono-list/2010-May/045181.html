<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Error when attempting to lock file
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Error%20when%20attempting%20to%20lock%20file&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045184.html">
   <LINK REL="Next"  HREF="045183.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Error when attempting to lock file</H1>
    <B>Rich Rattanni</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Error%20when%20attempting%20to%20lock%20file&In-Reply-To="
       TITLE="[Mono-list] Error when attempting to lock file">rattanni at gmail.com
       </A><BR>
    <I>Mon May 24 09:55:53 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="045184.html">[Mono-list] Generics and PostgreSQL
</A></li>
        <LI>Next message: <A HREF="045183.html">[Mono-list] Building Mono on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45181">[ date ]</a>
              <a href="thread.html#45181">[ thread ]</a>
              <a href="subject.html#45181">[ subject ]</a>
              <a href="author.html#45181">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I run the following code:
------- BEGIN CODE ------
using System;
using System.IO;
namespace fileipc
{
  class MainClass
  {
    public static void Main (string[] args)
    {
      FileStream fs = new FileStream(&quot;/var/tmp/ipc.txt&quot;,
FileMode.Open, FileAccess.Write, FileShare.Read);
      fs.Lock(0, Int64.MaxValue);
      fs.Unlock(0, Int64.MaxValue);
    }
  }
}
------- END CODE ------
On mono 2.4.2.3 and 2.6.3 running on Linux kernel 2.6.23.16 and get
the following error (output is from 2.6.3).

------ BEGIN ERROR -----
Unhandled Exception: System.IO.IOException: Lock violation on path
/var/tmp/ipc.txt
  at System.IO.FileStream.Lock (Int64 position, Int64 length)
[0x00000] in &lt;filename unknown&gt;:0
  at fileipc.MainClass.Main (System.String[] args) [0x00000] in
&lt;filename unknown&gt;:0
------ END ERROR -----
I have made sure that /var/tmp/ipc.txt exists first before executing
this program.

I have seen information from web searches suggesting there are issues
with FileStream.Lock(), but the information I am reading is sketchy at
best.  Could someone confirm if problems exist with file locking and
mono, and suggest any possible alternatives?

(I am wondering how the SQLite extension accomplishes file
locking...does my solution lay here?)
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045184.html">[Mono-list] Generics and PostgreSQL
</A></li>
	<LI>Next message: <A HREF="045183.html">[Mono-list] Building Mono on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45181">[ date ]</a>
              <a href="thread.html#45181">[ thread ]</a>
              <a href="subject.html#45181">[ subject ]</a>
              <a href="author.html#45181">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
