<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list]  Multiple threads slower than multiple processes?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20%20Multiple%20threads%20slower%20than%20multiple%20processes%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041520.html">
   <LINK REL="Next"  HREF="041593.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list]  Multiple threads slower than multiple processes?</H1>
    <B>SvenG</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20%20Multiple%20threads%20slower%20than%20multiple%20processes%3F&In-Reply-To="
       TITLE="[Mono-list]  Multiple threads slower than multiple processes?">sgroot at gmail.com
       </A><BR>
    <I>Tue Feb 24 03:32:51 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="041520.html">[Mono-list] Npgsql 2.0.3 released!
</A></li>
        <LI>Next message: <A HREF="041593.html">[Mono-list] Multiple threads slower than multiple processes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41592">[ date ]</a>
              <a href="thread.html#41592">[ thread ]</a>
              <a href="subject.html#41592">[ subject ]</a>
              <a href="author.html#41592">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I'm trying to research some threading issues. I've created a simple
application that does word count on a file. That application can create
multiple threads to do multiple word counts in parallel. There is no
communication between the threads; it's just running the exact same thing
multiple times at once.

I'm running that application against a randomly generated 2GB file. If I run
it with 1 thread, this takes about 205 seconds and I'm seeing 100% CPU
usage. If I run two instances of the application simultaneously on the same
system it takes 205 seconds for each, and I'm seeing 200% CPU (100% for each
process).

However, when I use two threads in the same process (which does exactly the
same thing as just running two instances of the application).It takes 290
seconds, a whopping 40% slower! CPU usage is only about 180%, 90% per
thread, and the CPU time consumed by each thread is also more than the CPU
time consumed by the single-thread process.

This strikes me as extremely weird, and is very worrying for what I'm using
Mono for. Is there anyone who can shed some more light on the situation?

Here's the program I'm using: 
<A HREF="http://www.nabble.com/file/p22177940/WordCountTest.cs">http://www.nabble.com/file/p22177940/WordCountTest.cs</A> WordCountTest.cs 

The system I'm testing this on has two Xeon E5410 quad core CPUs (so 8 cores
total in the system). It's running Debian, kernel 2.6.18-6-amd64. Mono 2.2,
compiled from the source tarball.

Any help would be immensely appreciated.
-- 
View this message in context: <A HREF="http://www.nabble.com/Multiple-threads-slower-than-multiple-processes--tp22177940p22177940.html">http://www.nabble.com/Multiple-threads-slower-than-multiple-processes--tp22177940p22177940.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041520.html">[Mono-list] Npgsql 2.0.3 released!
</A></li>
	<LI>Next message: <A HREF="041593.html">[Mono-list] Multiple threads slower than multiple processes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41592">[ date ]</a>
              <a href="thread.html#41592">[ thread ]</a>
              <a href="subject.html#41592">[ subject ]</a>
              <a href="author.html#41592">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
