<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list]  StoredProcedure Output Parameters System.Data.Odbc
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20%20StoredProcedure%20Output%20Parameters%20System.Data.Odbc&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041304.html">
   <LINK REL="Next"  HREF="041312.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list]  StoredProcedure Output Parameters System.Data.Odbc</H1>
    <B>Bartolomeo Nicolotti</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20%20StoredProcedure%20Output%20Parameters%20System.Data.Odbc&In-Reply-To="
       TITLE="[Mono-list]  StoredProcedure Output Parameters System.Data.Odbc">bnicolotti at siapcn.it
       </A><BR>
    <I>Fri Feb 13 09:43:04 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="041304.html">[Mono-list] Doubt on &quot;Console.ReadLine()&quot; !!!!!
</A></li>
        <LI>Next message: <A HREF="041312.html">[Mono-list] StoredProcedure Output Parameters System.Data.Odbc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41297">[ date ]</a>
              <a href="thread.html#41297">[ thread ]</a>
              <a href="subject.html#41297">[ subject ]</a>
              <a href="author.html#41297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

I'm trying unixodbc with System.Data.ODBC to access DB2 for iseries

I can do select, see this file 
<A HREF="http://www.nabble.com/file/p21997635/helloODBC.cs">http://www.nabble.com/file/p21997635/helloODBC.cs</A> helloODBC.cs , but I've
some problems with out parameters of stored procedueres.

With this file  <A HREF="http://www.nabble.com/file/p21997635/helloODBCCommand.cs">http://www.nabble.com/file/p21997635/helloODBCCommand.cs</A>
helloODBCCommand.cs  I get:

Hello, Dunkel
Eseguo:CALL QGPL.WBC022(9)
Eseguo:CALL GIANLUCA.PROVACS
System.Data.Odbc.OdbcException: ERROR [42000] [unixODBC][IBM][iSeries Access
ODBC Driver][DB2 UDB]SQL0104 - Token GIANLUCA non valido. Token validi: (
END GET SET CALL DROP FREE HOLD LOCK OPEN WITH ALTER.


It seems that setting the CommandType to StoredProcedure has no effect, as
one can also see from the source of mono (I've installed mono from source)

/home/siap/dwn/src/mono/mono-2.2/mcs/class/System.Data/System.Data.Odbc/OdbcCommand

the ExecuteNonQuery member function call ExecSQL that


private int ExecuteNonQuery (bool freeHandle)
                {
...
                        ExecSQL(CommandText);

ExecSQL is:

                private void ExecSQL (string sql)
                {
                        OdbcReturn ret;
                        if (! prepared &amp;&amp; Parameters.Count &lt;= 0) {

                                ReAllocStatment ();
                               
                                ret = libodbc.SQLExecDirect (hstmt, sql,
libodbc.SQL_NTS);
                                if ((ret != OdbcReturn.Success) &amp;&amp; (ret !=
OdbcReturn.SuccessWithInfo) &amp;&amp;
                                    (ret != OdbcReturn.NoData))
                                        throw connection.CreateOdbcException
(OdbcHandleType.Stmt, hstmt);
                                return;
                        }

                        if (!prepared)
                                Prepare();

                        BindParameters ();
                        ret = libodbc.SQLExecute (hstmt);
                        if (ret != OdbcReturn.Success &amp;&amp; ret !=
OdbcReturn.SuccessWithInfo)
                                throw connection.CreateOdbcException
(OdbcHandleType.Stmt, hstmt);
                }

Should I use prepared to BindParameters?

How can I get the output parameter of a Stored Procedure?

Many thanks

Best regards
-- 
View this message in context: <A HREF="http://www.nabble.com/StoredProcedure-Output-Parameters-System.Data.Odbc-tp21997635p21997635.html">http://www.nabble.com/StoredProcedure-Output-Parameters-System.Data.Odbc-tp21997635p21997635.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.

</PRE>


















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041304.html">[Mono-list] Doubt on &quot;Console.ReadLine()&quot; !!!!!
</A></li>
	<LI>Next message: <A HREF="041312.html">[Mono-list] StoredProcedure Output Parameters System.Data.Odbc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41297">[ date ]</a>
              <a href="thread.html#41297">[ thread ]</a>
              <a href="subject.html#41297">[ subject ]</a>
              <a href="author.html#41297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
