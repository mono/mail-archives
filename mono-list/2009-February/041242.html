<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Memory leak
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Memory%20leak&In-Reply-To=117799f00902070604g1e4a528agf8905ef18464bb9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041236.html">
   <LINK REL="Next"  HREF="041244.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Memory leak</H1>
    <B>Jon Harrop</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Memory%20leak&In-Reply-To=117799f00902070604g1e4a528agf8905ef18464bb9%40mail.gmail.com"
       TITLE="[Mono-list] Memory leak">jon at ffconsultancy.com
       </A><BR>
    <I>Sat Feb  7 10:10:46 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="041236.html">[Mono-list] Memory leak
</A></li>
        <LI>Next message: <A HREF="041244.html">[Mono-list] Memory leak
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41242">[ date ]</a>
              <a href="thread.html#41242">[ thread ]</a>
              <a href="subject.html#41242">[ subject ]</a>
              <a href="author.html#41242">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Saturday 07 February 2009 14:04:28 you wrote:
&gt;<i> If you compile the code without optimisations, it leaks indefinitely. If
</I>&gt;<i> you compile with optimisations, the compiler generated variable is being
</I>&gt;<i> optimised away and so it doesn't leak.
</I>
Can you clarify: are you referring to Mono/gmcs or .NET/VC# here?

&gt;<i> So, as was stated before and as is stated in the boehm docs, this issue is
</I>&gt;<i> *not* limited to conservative garbage collectors.
</I>
Yes. However, conveying bogus roots to the GC is most certainly a serious bug. 
Fortunately, it is easily fixed: just nullify reference types when liveness 
analysis proves they are no longer reachable.

In this case, I suspect Mono is leaving a pointer to an unreachable temporary 
in the stack frame of the &quot;Main&quot; function and the conservative scan has to 
assume that it is a genuine root. Unfortunately, that bogus root does not 
correspond to anything in the C# source code so the programmers only hope to 
avoid this bug is to randomly rewrite their code and hope that the compiler's 
rearrangements do not reintroduce the problem (e.g. by inlining).

-- 
Dr Jon Harrop, Flying Frog Consultancy Ltd.
<A HREF="http://www.ffconsultancy.com/?e">http://www.ffconsultancy.com/?e</A>
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041236.html">[Mono-list] Memory leak
</A></li>
	<LI>Next message: <A HREF="041244.html">[Mono-list] Memory leak
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41242">[ date ]</a>
              <a href="thread.html#41242">[ thread ]</a>
              <a href="subject.html#41242">[ subject ]</a>
              <a href="author.html#41242">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
