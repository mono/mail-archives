<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Can run mono once and only once ( Mono locks up when calling pthread_getattr_np ).
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Can%20run%20mono%20once%20and%20only%20once%20%28%20Mono%20locks%20up%0A%20when%20calling%20pthread_getattr_np%20%29.&In-Reply-To=79118B9FE8CE8E49B0D71964A79CB6470142A3CF%40dekomplm002.net.plm.eds.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039296.html">
   <LINK REL="Next"  HREF="039309.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Can run mono once and only once ( Mono locks up when calling pthread_getattr_np ).</H1>
    <B>simozzer</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Can%20run%20mono%20once%20and%20only%20once%20%28%20Mono%20locks%20up%0A%20when%20calling%20pthread_getattr_np%20%29.&In-Reply-To=79118B9FE8CE8E49B0D71964A79CB6470142A3CF%40dekomplm002.net.plm.eds.com"
       TITLE="[Mono-list] Can run mono once and only once ( Mono locks up when calling pthread_getattr_np ).">SimonMoscrop at hotmail.com
       </A><BR>
    <I>Mon Aug 18 06:19:03 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="039296.html">[Mono-list] Can run mono once and only once ( Mono locks up	when calling pthread_getattr_np ).
</A></li>
        <LI>Next message: <A HREF="039309.html">[Mono-list] Can run mono once and only once ( From strange to bizzare and beyond ).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39297">[ date ]</a>
              <a href="thread.html#39297">[ thread ]</a>
              <a href="subject.html#39297">[ subject ]</a>
              <a href="author.html#39297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
John,

Thanks for your reply. I'm afraid my lack of c, gdb and linux debugging
knowledge is letting me down here.

It appears that the attribute structure is allocated in the few lines just
before the lock occurs. At first glance it does not appear that the program
is trying to reuse the same structure on second run (it should be a new
instance?).

( code snippet from mono_thread_get_stack_bounds)
pthread_attr_t attr;
guint8 *current = (guint8*)&amp;attr;
pthread_attr_init(&amp;attr);
pthread_getattr_np(pthread_self(),&amp;attr);

I'm going to try rebooting and stepping through the first (succesfull) run
to see if I can trace what is happening with the attr structure on the first
run - unless you have any other suggestions?





&gt;<i> I've narrowed it down to a call in threads.c, line 766:
</I>&gt;<i> 
</I>&gt;<i> pthread_getattr_np(pthread_self(), &amp;attr).
</I>&gt;<i> 
</I>&gt;<i> I'm still no wiser though. Does anyone have any insight as to why this
</I>&gt;<i> call might be causing some kind of deadlock?
</I>
Look very carefully at what happens with that attribute resource
structure.
Is it getting re-used for the second call that causes the deadlock? How
is
it allocated? 

-- 
John Dallman
Parasolid Porting Engineer

Siemens PLM Software
46 Regent Street, Cambridge, CB2 1DP
United Kingdom
Tel: +44-1223-371554
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">john.dallman at siemens.com</A>
www.siemens.com/plm


-- 
View this message in context: <A HREF="http://www.nabble.com/Can-run-mono-once-and-only-once-%28EEE-PC%29--tp18821807p19028825.html">http://www.nabble.com/Can-run-mono-once-and-only-once-%28EEE-PC%29--tp18821807p19028825.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039296.html">[Mono-list] Can run mono once and only once ( Mono locks up	when calling pthread_getattr_np ).
</A></li>
	<LI>Next message: <A HREF="039309.html">[Mono-list] Can run mono once and only once ( From strange to bizzare and beyond ).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39297">[ date ]</a>
              <a href="thread.html#39297">[ thread ]</a>
              <a href="subject.html#39297">[ subject ]</a>
              <a href="author.html#39297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
