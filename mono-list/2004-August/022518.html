<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] question about regular expressions in Mono on
 Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tomar%40apricot.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="022517.html">
   <LINK REL="Next"  HREF="022520.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] question about regular expressions in Mono on
 Windows
   </H1>
    <B>Tomar
    </B> 
    <A HREF="mailto:tomar%40apricot.com"
       TITLE="[Mono-list] question about regular expressions in Mono on
 Windows">tomar@apricot.com
       </A><BR>
    <I>01 Aug 2004 01:56:57 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="022517.html">[Mono-list] [ANN] Expert Coder 0.4 released
</A></li>
        <LI> Next message: <A HREF="022520.html">[Mono-list] .NET 2.0 Classes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22518">[ date ]</a>
              <a href="thread.html#22518">[ thread ]</a>
              <a href="subject.html#22518">[ subject ]</a>
              <a href="author.html#22518">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-OTheJNEk7s7WMLSBXEfH
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable

Are you sure its a memory leak?  Since its managed memory, unless you
specifically dispose of objects or do some of the System.GC stuff or
give it a good reason too (like push memory usage to the limit) the
virtual machine has little reason to reclaim any memory.  Its an
&quot;expensive&quot; operation to walk the objects constantly looking for things
to release.  I'm not saying that the Regex object is error free or can't
be improved but allocating memory isn't out of the ordinary.

Just out of curiosity have you tried using &quot;csc&quot; and MS's .Net Framework
1.1 to see if it eats as much?

Tom Larsen

On Sat, 2004-07-31 at 08:35, Davy Brion wrote:
&gt;<i> about six weeks ago, i thought i found a memory leak in the Regular
</I>&gt;<i> Expressions part of Mono, and i mailed a testcase to the mono list but
</I>&gt;<i> Gonzalo said the problem didn't occur when he tried it.  This was around
</I>&gt;<i> the mono 1.0 beta2 timeframe iirc.
</I>&gt;<i>=20
</I>&gt;<i> On Linux, i don't have that problem anymore, but i've recently managed
</I>&gt;<i> to get my application working on Windows (with GTK#) but unfortunately
</I>&gt;<i> it is leaking a lot of memory on Windows.  I've tracked it down and it
</I>&gt;<i> turns out that it's because my application uses regular expressions on
</I>&gt;<i> strings a lot.  with a lot i mean like almost continiously actually.
</I>&gt;<i> If i comment out the line of code that checks for the regular
</I>&gt;<i> expression, the memory usage is normal.  If i let it execute the
</I>&gt;<i> regular expression, and comment out the stuff that should be executed
</I>&gt;<i> after that, i can already see the memory usage going up.  This only
</I>&gt;<i> happens on Windows, not on Linux.
</I>&gt;<i>=20
</I>&gt;<i> I've tried a lot of stuff to work around this problem, but i'm getting
</I>&gt;<i> pretty desperate to be honest.  I really have no clue what else i can
</I>&gt;<i> try to avoid this problem.
</I>&gt;<i>=20
</I>&gt;<i> the following testcase illustrates the problem on Windows:
</I>&gt;<i>=20
</I>&gt;<i> using System;
</I>&gt;<i> using System.Text;
</I>&gt;<i> using System.Text.RegularExpressions;
</I>&gt;<i> using System.Threading;
</I>&gt;<i>=20
</I>&gt;<i> class MainClass
</I>&gt;<i> {
</I>&gt;<i>        public static void Main(string[] args)
</I>&gt;<i>        {
</I>&gt;<i>                Match match;
</I>&gt;<i>                string strPattern =3D @&quot;\w \w \w \w \w: \d&quot;;
</I>&gt;<i>=20
</I>&gt;<i>                for (long i=3D0;i&lt;50000;i++)
</I>&gt;<i>                {
</I>&gt;<i>                        string strTest =3D &quot;This is a simple test: &quot; +
</I>&gt;<i> i.ToString() ;
</I>&gt;<i>                        match =3D Regex.Match(strTest,strPattern);
</I>&gt;<i>                        Console.WriteLine(i);
</I>&gt;<i>                        Thread.Sleep(10);
</I>&gt;<i>                }
</I>&gt;<i>        }
</I>&gt;<i> }
</I>&gt;<i>=20
</I>&gt;<i> if i run that on windows, and i watch the memory usage in the Task
</I>&gt;<i> Manager, the memory just keeps going up.  The longer it runs, the more
</I>&gt;<i> memory it uses.
</I>&gt;<i>=20
</I>&gt;<i> i'm using the combined mono/gtk# installer for windows if that makes
</I>&gt;<i> any difference.
</I>&gt;<i>=20
</I>&gt;<i> thanks
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>--=20
Tomar &lt;<A HREF="mailto:tomar@apricot.com">tomar@apricot.com</A>&gt;

--=-OTheJNEk7s7WMLSBXEfH
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: This is a digitally signed message part

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.7 (GNU/Linux)

iD8DBQBBDJQ5KaYNoZecAvQRAnQRAJ0S3OL/JVE8hHAlIRttJvN5Qhem+ACeJjz6
EHjzfvwVgQtX+kDoMl3IW6U=
=1ITq
-----END PGP SIGNATURE-----

--=-OTheJNEk7s7WMLSBXEfH--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="022517.html">[Mono-list] [ANN] Expert Coder 0.4 released
</A></li>
	<LI> Next message: <A HREF="022520.html">[Mono-list] .NET 2.0 Classes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22518">[ date ]</a>
              <a href="thread.html#22518">[ thread ]</a>
              <a href="subject.html#22518">[ subject ]</a>
              <a href="author.html#22518">[ author ]</a>
         </LI>
       </UL>
</body></html>
