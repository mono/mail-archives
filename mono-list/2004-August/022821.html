<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] inlining of methods using structs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rudi%40lambda-computing.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <LINK REL="Previous"  HREF="022819.html">
   <LINK REL="Next"  HREF="022808.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] inlining of methods using structs
   </H1>
    <B>Rüdiger Klaehn
    </B> 
    <A HREF="mailto:rudi%40lambda-computing.de"
       TITLE="[Mono-list] inlining of methods using structs">rudi@lambda-computing.de
       </A><BR>
    <I>Wed, 18 Aug 2004 19:34:58 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="022819.html">[Mono-list] inlining of methods using structs
</A></li>
        <LI> Next message: <A HREF="022808.html">[Mono-list] inlining of methods using structs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22821">[ date ]</a>
              <a href="thread.html#22821">[ thread ]</a>
              <a href="subject.html#22821">[ subject ]</a>
              <a href="author.html#22821">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tom Larsen wrote:

&gt;<i> &quot;Inlining&quot; is a function of the compiler. 
</I>
Inlining in .NET is a function of the JIT compiler that compiles the IL 
to native code. The compiler that compiles source code to IL code does 
not do any inlining.

&gt;<i> The runtime doesn't
</I>&gt;<i> particuarlly care whether the next operator is a call onto a function or
</I>&gt;<i> the function inline. 
</I> &gt;
But the processor does care because a call instruction is much more 
expensive than pretty much any other instruction. And inlining makes 
subsequent optimizations like common subexpression elimination or 
enregistration possible.

 &gt; The tradeoff is of course the classic &quot;speed vs
&gt;<i> space&quot;.  A commonly used function might incur less of a performance hit if
</I>&gt;<i> placed in line but you've increased the IL length of every function that
</I>&gt;<i> is now using the code inline.
</I>&gt;<i> 
</I>We are not talking about IL. The inlining happens when the IL is 
JIT-compiled to native code. So the only downside is a slightly larger 
native code. But in most situations with structs this would be worth it.

&gt;<i> You seem to be under the guise that &quot;structs&quot; are lightweight.  There is
</I>&gt;<i> noting about ECMA CLI specification that indicates this.  In fact
</I>&gt;<i> &quot;structs&quot; can be quite complex.  The one blessing of the way C# over Java
</I>&gt;<i> is this seperation of &quot;objects&quot; (classes) and &quot;data&quot; (structs) but nothing
</I>&gt;<i> ever indicates that objects are heavier or lighter than structs.  If
</I>&gt;<i> anything &quot;structs&quot; are harder to deal with because of box/unbox.
</I>&gt;<i> 
</I>Structs are allocated on the stack, so they need no GC. Additionally 
since they can not contain virtual methods they do not have a virtual 
method table and associated pointer. So structs *are* lightweight, at 
least compared to objects. Boxing and unboxing are only an issue if you 
want to treat your structs as objects, and not in normal usage. In the 
example I included the struct Complex is never boxed or unboxed.

best regards,

Rüdiger

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="022819.html">[Mono-list] inlining of methods using structs
</A></li>
	<LI> Next message: <A HREF="022808.html">[Mono-list] inlining of methods using structs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22821">[ date ]</a>
              <a href="thread.html#22821">[ thread ]</a>
              <a href="subject.html#22821">[ subject ]</a>
              <a href="author.html#22821">[ author ]</a>
         </LI>
       </UL>
</body></html>
