<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono.Unix.Magic libmagic wrapper
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Unix.Magic%20libmagic%20wrapper&In-Reply-To=1159006991.9163.8.camel%40melchior.magi">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032822.html">
   <LINK REL="Next"  HREF="032826.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono.Unix.Magic libmagic wrapper</H1>
    <B>Milosz Tanski</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Unix.Magic%20libmagic%20wrapper&In-Reply-To=1159006991.9163.8.camel%40melchior.magi"
       TITLE="[Mono-list] Mono.Unix.Magic libmagic wrapper">milosz at mindtouchsoftware.com
       </A><BR>
    <I>Sat Sep 23 10:59:00 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="032822.html">[Mono-list] Mono.Unix.Magic libmagic wrapper
</A></li>
        <LI>Next message: <A HREF="032826.html">[Mono-list] Mono.Unix.Magic libmagic wrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32823">[ date ]</a>
              <a href="thread.html#32823">[ thread ]</a>
              <a href="subject.html#32823">[ subject ]</a>
              <a href="author.html#32823">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jonathan,

As far windows is concerned, there exists a native port of file and the
associated library at <A HREF="http://gnuwin32.sourceforge.net/packages/file.htm">http://gnuwin32.sourceforge.net/packages/file.htm</A>
. However, it doesn't seam that too many people or projects use it. I
don't have steady access to a win32 dev box to give it a whirl. So I'm
sure what do with the name space now... although Mono.Unix have the warm
fuzzy feeling of correctness/content.

The class name of Magic can be defiantly confusing/entertaining for the
user who stumbles upon it for the first time. The other thing name that
comes to my mind is FileMagicDatabase.

I'm willing to write the documentation as soon as this is done, and I
figure out how to do it...

I've updated the bindings with the things you recommended, and I
integrated it with the build system. I haven't tackled your point #4
since I wasn't sure how to approach it exactly.

Jonathan Pryor wrote:
&gt;<i> On Fri, 2006-09-22 at 23:25 -0400, Milosz Tanski wrote:
</I>&gt;&gt;<i> I wrote a wrapper for the unix libmagic library since it's very handy
</I>&gt;&gt;<i> sometimes (and I'm using this wrapper in my app right now, so I figured
</I>&gt;&gt;<i> might as well submit it). Sorry that's it's not a diff, but I'd know
</I>&gt;&gt;<i> exactly how to integrate it with the class library build system.
</I>&gt;<i> 
</I>&gt;<i> I have a few questions/concerns/observations:
</I>&gt;<i> 
</I>&gt;<i> 1.  Can libmagic be used on Windows without the use of Cygwin?  I think
</I>&gt;<i> it can be, but I'm not entirely sure.  If it can be, I'm not sure that
</I>&gt;<i> Mono.Unix is the best place for it (deliberately ignoring the Mono.Unix
</I>&gt;<i> types which can work on Windows, Mono.Unix.Native.Stdlib &amp;
</I>&gt;<i> Mono.Unix.Native.StdioFileStream).  If libmagic can't work on Windows
</I>&gt;<i> without Cygwin, then Mono.Unix is probably a reasonable spot for it.
</I>&gt;<i> 
</I>&gt;<i> 2.  I'm not fond of the name &quot;Magic.&quot;  Yes, it's a `libmagic' wrapper,
</I>&gt;<i> but for those who don't know what `libmagic' is, it's not a very
</I>&gt;<i> informative name.  Considering that it's used by the file(1) command,
</I>&gt;<i> I'm sure some better name could be found.  Perhaps FileTypeInfo?
</I>&gt;<i> 
</I>&gt;<i> Of course, any name would need to be &quot;stand-alone&quot;-ish, and not be
</I>&gt;<i> easily confused with the existing UnixFileSystemInfo &amp; UnixFileInfo
</I>&gt;<i> types.
</I>&gt;<i> 3.  The Magic.Descrition property should be Magic.Description.
</I>&gt;<i> 
</I>&gt;<i> 4.  You should get libmagic to generate UTF-8 (it it doesn't do so by
</I>&gt;<i> default) and use UnixEncoding to do the UTF-8 -&gt; string conversion (in
</I>&gt;<i> case Mono's Marshal.PtrToStringAuto ever stops doing UTF-8, and there's
</I>&gt;<i> a bug open to investigate that).
</I>&gt;<i> 
</I>&gt;<i> 5.  If it does get into Mono.Unix, the magic_* methods taking a filename
</I>&gt;<i> should make use of the Mono.Unix.Native.FileNameMarshaler custom
</I>&gt;<i> marshaler for &quot;proper&quot; filename transfers (for when a filename contains
</I>&gt;<i> random binary data instead of being valid UTF-8).  See
</I>&gt;<i> Mono.Unix.Native.Syscall.
</I>&gt;<i> 
</I>&gt;<i> 6.  Documentation -- are you willing to write it? :-)
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Thank you for the file.
</I>&gt;<i> 
</I>&gt;<i>  - Jon
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: FileMagicDb.patch
Type: text/x-patch
Size: 7653 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20060923/69278949/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-list/attachments/20060923/69278949/attachment-0001.bin</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032822.html">[Mono-list] Mono.Unix.Magic libmagic wrapper
</A></li>
	<LI>Next message: <A HREF="032826.html">[Mono-list] Mono.Unix.Magic libmagic wrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32823">[ date ]</a>
              <a href="thread.html#32823">[ thread ]</a>
              <a href="subject.html#32823">[ subject ]</a>
              <a href="author.html#32823">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
