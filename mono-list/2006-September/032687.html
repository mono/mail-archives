<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] VBNC in Mono.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20VBNC%20in%20Mono.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032713.html">
   <LINK REL="Next"  HREF="032696.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] VBNC in Mono.</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20VBNC%20in%20Mono.&In-Reply-To="
       TITLE="[Mono-list] VBNC in Mono.">kornelpal at gmail.com
       </A><BR>
    <I>Sun Sep 10 10:32:38 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="032713.html">[Mono-list] VBNC in Mono.
</A></li>
        <LI>Next message: <A HREF="032696.html">[Mono-list] VBNC in Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32687">[ date ]</a>
              <a href="thread.html#32687">[ thread ]</a>
              <a href="subject.html#32687">[ subject ]</a>
              <a href="author.html#32687">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i>    Another area that could help would be to write a program that used
</I>&gt;<i> the COM API to consume a .pdb debugging file from .NET and convert it
</I>&gt;<i> into a .mdb that Mono can consume.
</I>&gt;<i>
</I>&gt;<i>    Alternatively, I believe there might be tools to do .pdb to ecma
</I>&gt;<i> debugging, and then we would need an ECMA debugging to Mono debugging
</I>&gt;<i> translator.
</I>
I think an easier solution is to generate mdb debug info using MS.NET SRE. 
The attached Compiler.diff implements this hack.

The current SymbolWriter needs some cleanup and in fact is not able to work 
with MS.NET.

I've done a lot of work on SymbolWriter to make it compatible with MS.NET. I 
think the modifications I've done eventually should go into 
Mono.CompilerServices.SymbolWriter.dll but that needs some cleanup and 
modifications in SRE as well.

The attached SymbolWriter.diff patches the SymbolWriter to be able to work 
with MS.NET. This modified Mono.CompilerServices.SymbolWriter.dll (profile 
2.0) should be compiled and referenced to vbnc.exe when compiling vbnc.

Note that there will be a resulting pdb file because it is generated from 
unmanaged code but it is not required.

To get source information:
1. Compile vbnc1.exe using MS.NET vbc.exe or Visual Studio 2005.
2. Compile vbnc2.exe using vbnc1.exe on the MS.NET runtime. (This version 
will generate mdb file.)
3. Compile vbnc3.exe using mono --debug vbnc2.exe on the Mono runtime. (This 
will print source information as well.)

According to my experienced source information is not always correct but is 
+/-1 line correct. This may be a bug in the Mono runtime as well.

Korn&#233;l 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SymbolWriter.diff
Type: application/octet-stream
Size: 9311 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20060910/a2e91a0b/attachment-0002.obj">http://lists.ximian.com/pipermail/mono-list/attachments/20060910/a2e91a0b/attachment-0002.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Compiler.diff
Type: application/octet-stream
Size: 1617 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20060910/a2e91a0b/attachment-0003.obj">http://lists.ximian.com/pipermail/mono-list/attachments/20060910/a2e91a0b/attachment-0003.obj</A> 
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032713.html">[Mono-list] VBNC in Mono.
</A></li>
	<LI>Next message: <A HREF="032696.html">[Mono-list] VBNC in Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32687">[ date ]</a>
              <a href="thread.html#32687">[ thread ]</a>
              <a href="subject.html#32687">[ subject ]</a>
              <a href="author.html#32687">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
