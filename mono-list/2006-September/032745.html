<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] VBNC in Mono.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20VBNC%20in%20Mono.&In-Reply-To=001901c6d6ba%2400393c90%240100a8c0%40kornelpal.hu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032747.html">
   <LINK REL="Next"  HREF="032746.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] VBNC in Mono.</H1>
    <B>Rafael Mizrahi</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20VBNC%20in%20Mono.&In-Reply-To=001901c6d6ba%2400393c90%240100a8c0%40kornelpal.hu"
       TITLE="[Mono-list] VBNC in Mono.">rafim at mainsoft.com
       </A><BR>
    <I>Wed Sep 13 01:56:07 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="032747.html">[Mono-list] VBNC in Mono.
</A></li>
        <LI>Next message: <A HREF="032746.html">[Mono-list] VBNC in Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32745">[ date ]</a>
              <a href="thread.html#32745">[ thread ]</a>
              <a href="subject.html#32745">[ subject ]</a>
              <a href="author.html#32745">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Korn&#233;l,

Help me understand, do you suggest that we will stop using CFoo functions inside CompilerServices ? 
I see that 
CStr CBool CLng CDbl changed into DirectCast
Convert.ToString changed into DirectCast
Value.ToString changed into DirectCast

If so, go ahead and commit, I have no problems with that rule.
But what is the reason for changing some of the .ToString into DirectCast ? 

Rafael

-----Original Message-----
From: Korn&#233;l P&#225;l [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">kornelpal at gmail.com</A>] 
Sent: Wednesday, September 13, 2006 1:23
To: Miguel de Icaza
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>; Rafael Mizrahi; Rolf Bjarne Kvinge
Subject: Re: [Mono-list] VBNC in Mono.

Hi,

Use &quot;VB.replace.bat 2&quot; then try to bootstrap vbnc on MS.NET.

For an example have a look at the attached vbrun.diff.

The bug I found when trying to compile vbnc was:
                Case TypeCode.Decimal
                    Return CDec(Value)

This results in a recursiong with Conversions.ToDecimal because CDec (and 
all the other CType conversions are done at runtime unless the type is known 
to the compiler as well. And anyway there is no use to do reinterpretation 
when the exact type is know. A simple unbox is enough.

But there are other bugs (and I guess a lot of them) in VB runtime for sure.

And I found a bug in vbnc as well that was possible because of a bug in 
System.Windows.Forms.:)

Korn&#233;l

----- Original Message ----- 
From: &quot;Miguel de Icaza&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">miguel at novell.com</A>&gt;
To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">kornelpal at gmail.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>&gt;
Sent: Wednesday, September 13, 2006 12:04 AM
Subject: Re: [Mono-list] VBNC in Mono.


&gt;<i> Hey!
</I>&gt;<i>
</I>&gt;&gt;<i> But it's unable to bootstrap itself on MS.NET using our VB runtime so the 
</I>&gt;&gt;<i> VB
</I>&gt;&gt;<i> runtime should be fixed as well before trying to fix vbnc on Mono.
</I>&gt;<i>
</I>&gt;<i> Do you have some details for me?
</I>&gt;<i>
</I>&gt;<i> This is a good observation, before we launch ourselves into a quest to
</I>&gt;<i> fix bugs on the Mono side (although we already fixed a known problem) 
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032747.html">[Mono-list] VBNC in Mono.
</A></li>
	<LI>Next message: <A HREF="032746.html">[Mono-list] VBNC in Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32745">[ date ]</a>
              <a href="thread.html#32745">[ thread ]</a>
              <a href="subject.html#32745">[ subject ]</a>
              <a href="author.html#32745">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
