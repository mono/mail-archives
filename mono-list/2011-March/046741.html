<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Difficulty%20with%20DllImport%20in%20mono%20-%0A%20config.AG_Config%20file%20is%20not%20in%20load-path.&In-Reply-To=4D84DAA8.9070801%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="046740.html">
   <LINK REL="Next"  HREF="046759.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.</H1>
    <B>STEVEN STAPLETON</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Difficulty%20with%20DllImport%20in%20mono%20-%0A%20config.AG_Config%20file%20is%20not%20in%20load-path.&In-Reply-To=4D84DAA8.9070801%40gmail.com"
       TITLE="[Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.">stapleton.41 at osu.edu
       </A><BR>
    <I>Sat Mar 19 13:27:47 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="046740.html">[Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.
</A></li>
        <LI>Next message: <A HREF="046759.html">[Mono-list] Difficulty with DllImport in mono -	config.AG_Config file is not in load-path.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46741">[ date ]</a>
              <a href="thread.html#46741">[ thread ]</a>
              <a href="subject.html#46741">[ subject ]</a>
              <a href="author.html#46741">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I don't mind sharing the wrapper code (I plan on BSD'ing it anyway). Should I put it on a web server for anyone to access, or should I attach it to a mail?

I am compiling it without the .dll extension - however VS2010 is adding it implicitly it seems - that's why I added the extra stuff to the .config file (see original mail). It works for the two functions that get called from ag_core up 
to that point (AG_InitCore, AG_GetError).

A quick example of the imports:
//does not work
[DllImport(&quot;ag_gui&quot;, EntryPoint=&quot;AG_InitGraphics&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
static public extern Int32 InitGraphics(string driver);
//works
[DllImport(&quot;ag_core&quot;, EntryPoint=&quot;AG_InitCore&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
static private extern Int32 AG_InitCore(string progname, Uint32 flags);
//works
[DllImport(&quot;ag_core&quot;, EntryPoint=&quot;AG_Getopt&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
static private extern Int32 AG_Getopt(Int32 argc, string[] argv, string fmt, out string v, out Int32 index);
//works
[DllImport(&quot;ag_core&quot;, EntryPoint=&quot;AG_GetError&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
static public extern string GetError();
 
 
 


Thanks,
-Jim Stapleton


----- Original Message -----
From: Danny &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">dgortonii at gmail.com</A>&gt;
Date: Saturday, March 19, 2011 4:39 pm
Subject: Re: [Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.
To: jims &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">stapleton.41 at osu.edu</A>&gt;
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>

&gt;<i> Without seeing your wrapper code, I'd guess that your DllImport 
</I>&gt;<i> statements include the file extension (.dll).&#160; To make the 
</I>&gt;<i> lookup work 
</I>&gt;<i> properly on Linux/Mono you either need to exclude the file 
</I>&gt;<i> extension 
</I>&gt;<i> (ie: just use 'ag_gui' - both .NET and Mono will resolve this 
</I>&gt;<i> correctly 
</I>&gt;<i> if the file is in a proper search path) so the native naming 
</I>&gt;<i> schemes can 
</I>&gt;<i> be used on the respective platforms, or use a DllMap in your 
</I>&gt;<i> config file 
</I>&gt;<i> to tell mono how to map ag_gui.dll (and others).
</I>&gt;<i> 
</I>&gt;<i> On 03/19/2011 11:55 AM, jims wrote:
</I>&gt;<i> &gt; Background, I am working on a C# wrapper for Agar ( 
</I>&gt;<i> <A HREF="http://libagar.org/">http://libagar.org/</A> ) in
</I>&gt;<i> &gt; Visual Studio express 2010. I have knocked the .NET framework 
</I>&gt;<i> target down to
</I>&gt;<i> &gt; 2.0 to improve platform compatibility, for users of older software.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; When I try to run the first demo, I get this error:
</I>&gt;<i> &gt; [<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sjss at elrond</A> ~/Desktop/Agar.NET_Demo]$ mono ./AgarDemo_Windows.exe
</I>&gt;<i> &gt; [DllNotFoundException:ag_gui.dll]The //config.AG_Config file 
</I>&gt;<i> is not in
</I>&gt;<i> &gt; load-path.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; verification it exists:
</I>&gt;<i> &gt; [<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sjss at elrond</A> ~/Desktop/Agar.NET_Demo]$ ls -l /usr/local/lib | 
</I>&gt;<i> grep -e
</I>&gt;<i> &gt; 'libag_.*.so'
</I>&gt;<i> &gt; lrwxr-xr-x&#160;&#160; 1 root&#160; 
</I>&gt;<i> wheel&#160;&#160;&#160;&#160;&#160;&#160;&#160; 17 Mar 18 15:39 
</I>&gt;<i> libag_core.so -&gt;
</I>&gt;<i> &gt; libag_core.so.1.4
</I>&gt;<i> &gt; -rw-r--r--&#160;&#160; 1 root&#160; wheel&#160;&#160;&#160; 
</I>&gt;<i> 299513 Mar 18 14:54 libag_core.so.1.4
</I>&gt;<i> &gt; lrwxr-xr-x&#160;&#160; 1 root&#160; 
</I>&gt;<i> wheel&#160;&#160;&#160;&#160;&#160;&#160;&#160; 16 Mar 18 15:39 
</I>&gt;<i> libag_dev.so -&gt;
</I>&gt;<i> &gt; libag_dev.so.1.4
</I>&gt;<i> &gt; -rw-r--r--&#160;&#160; 1 root&#160; 
</I>&gt;<i> wheel&#160;&#160;&#160;&#160; 70586 Mar 18 14:54 libag_dev.so.1.4
</I>&gt;<i> &gt; lrwxr-xr-x&#160;&#160; 1 root&#160; 
</I>&gt;<i> wheel&#160;&#160;&#160;&#160;&#160;&#160;&#160; 16 Mar 18 15:39 
</I>&gt;<i> libag_gui.so -&gt;
</I>&gt;<i> &gt; libag_gui.so.1.4
</I>&gt;<i> &gt; -rw-r--r--&#160;&#160; 1 root&#160; wheel&#160;&#160; 1246374 
</I>&gt;<i> Mar 18 14:54 libag_gui.so.1.4
</I>&gt;<i> &gt; lrwxr-xr-x&#160;&#160; 1 root&#160; 
</I>&gt;<i> wheel&#160;&#160;&#160;&#160;&#160;&#160;&#160; 17 Mar 18 15:39 
</I>&gt;<i> libag_math.so -&gt;
</I>&gt;<i> &gt; libag_math.so.1.4
</I>&gt;<i> &gt; -rw-r--r--&#160;&#160; 1 root&#160; wheel&#160;&#160;&#160; 
</I>&gt;<i> 328560 Mar 18 14:54 libag_math.so.1.4
</I>&gt;<i> &gt; lrwxr-xr-x&#160;&#160; 1 root&#160; 
</I>&gt;<i> wheel&#160;&#160;&#160;&#160;&#160;&#160;&#160; 15 Mar 18 15:39 
</I>&gt;<i> libag_rg.so -&gt;
</I>&gt;<i> &gt; libag_rg.so.1.4
</I>&gt;<i> &gt; -rw-r--r--&#160;&#160; 1 root&#160; wheel&#160;&#160;&#160; 
</I>&gt;<i> 255964 Mar 18 14:54 libag_rg.so.1.4
</I>&gt;<i> &gt; lrwxr-xr-x&#160;&#160; 1 root&#160; 
</I>&gt;<i> wheel&#160;&#160;&#160;&#160;&#160;&#160;&#160; 15 Mar 18 15:39 
</I>&gt;<i> libag_vg.so -&gt;
</I>&gt;<i> &gt; libag_vg.so.1.4
</I>&gt;<i> &gt; -rw-r--r--&#160;&#160; 1 root&#160; wheel&#160;&#160;&#160; 
</I>&gt;<i> 205641 Mar 18 14:54 libag_vg.so.1.4
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have installed Agar, FreeType and SDL on my machine, all the 
</I>&gt;<i> libs are in
</I>&gt;<i> &gt; /usr/local/lib, are in my libpath, and the directory has been 
</I>&gt;<i> ldconfig'ed&gt; for good measure after the first time I saw the error.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Since Visual Studio 2010 wants to add the '.dll' to the first 
</I>&gt;<i> argument of
</I>&gt;<i> &gt; the DllImport call, I have added the following to the&#160; 
</I>&gt;<i> section of the config
</I>&gt;<i> &gt; config of all of my .NET dlls/exes:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ag_core.so is loading properly, the error message is produced by:
</I>&gt;<i> &gt;&#160;&#160;&#160; 
</I>&gt;<i> System.Console.WriteLine(&quot;[&quot;+e.GetType().Name+&quot;:&quot;+e.Message+&quot;]&quot; +
</I>&gt;<i> &gt; Agar.GetError()+&quot;\n&quot;);
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The Agar.GetError() part is what I find interesting - that 
</I>&gt;<i> requires that
</I>&gt;<i> &gt; ag_core be called. I *believe* the &quot;//config.AG_Config file is 
</I>&gt;<i> not in
</I>&gt;<i> &gt; load-path.&quot; portion of the error is being set by an earlier 
</I>&gt;<i> portion of the
</I>&gt;<i> &gt; code in a manner that doesn't cause an exception or problem, 
</I>&gt;<i> as a warning.
</I>&gt;<i> &gt; Regardless, it shouldn't make &quot;ag_gui&quot; unlocatable.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any ideas what I should look into next?
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt; -Jim Stapleton
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; View this message in context: 
</I>&gt;<i> <A HREF="http://mono.1490590.n4.nabble.com/Difficulty-with-DllImport-in-">http://mono.1490590.n4.nabble.com/Difficulty-with-DllImport-in-</A>
</I>&gt;<i> mono-config-AG-Config-file-is-not-in-load-path-tp3389891p3389891.html
</I>&gt;<i> &gt; Sent from the Mono - General mailing list archive at Nabble.com.
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-list maillist&#160; -&#160; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> BEGIN-ANTISPAM-VOTING-LINKS
</I>&gt;<i> ------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> Teach CanIt if this mail (ID 1171312426) is spam:
</I>&gt;<i> Spam:&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
</I>&gt;<i> <A HREF="https://antispam.osu.edu/b.php?i=1171312426&amp;m=0e1a982f2ad2&amp;c=sNot">https://antispam.osu.edu/b.php?i=1171312426&amp;m=0e1a982f2ad2&amp;c=sNot</A> spam:&#160;&#160;&#160; <A HREF="https://antispam.osu.edu/b.php?i=1171312426&amp;m=0e1a982f2ad2&amp;c=n">https://antispam.osu.edu/b.php?i=1171312426&amp;m=0e1a982f2ad2&amp;c=n</A>
</I>&gt;<i> Forget vote: 
</I>&gt;<i> <A HREF="https://antispam.osu.edu/b.php?i=1171312426&amp;m=0e1a982f2ad2&amp;c=f---">https://antispam.osu.edu/b.php?i=1171312426&amp;m=0e1a982f2ad2&amp;c=f---</A>
</I>&gt;<i> ---------------------------------------------------
</I>&gt;<i> END-ANTISPAM-VOTING-LINKS
</I>&gt;<i> 
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20110319/688f1a23/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20110319/688f1a23/attachment.html</A> 
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="046740.html">[Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.
</A></li>
	<LI>Next message: <A HREF="046759.html">[Mono-list] Difficulty with DllImport in mono -	config.AG_Config file is not in load-path.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46741">[ date ]</a>
              <a href="thread.html#46741">[ thread ]</a>
              <a href="subject.html#46741">[ subject ]</a>
              <a href="author.html#46741">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
