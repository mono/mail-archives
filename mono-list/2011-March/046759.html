<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Difficulty with DllImport in mono -	config.AG_Config file is not in load-path.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Difficulty%20with%20DllImport%20in%20mono%20-%0A%09config.AG_Config%20file%20is%20not%20in%20load-path.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="046741.html">
   <LINK REL="Next"  HREF="046742.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Difficulty with DllImport in mono -	config.AG_Config file is not in load-path.</H1>
    <B>S James S Stapleton</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Difficulty%20with%20DllImport%20in%20mono%20-%0A%09config.AG_Config%20file%20is%20not%20in%20load-path.&In-Reply-To="
       TITLE="[Mono-list] Difficulty with DllImport in mono -	config.AG_Config file is not in load-path.">stapleton.41 at osu.edu
       </A><BR>
    <I>Tue Mar 22 09:18:09 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="046741.html">[Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.
</A></li>
        <LI>Next message: <A HREF="046742.html">[Mono-list] How do I Host a WCF Service using Mono, Apache2,	and GNU/Linux?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46759">[ date ]</a>
              <a href="thread.html#46759">[ thread ]</a>
              <a href="subject.html#46759">[ subject ]</a>
              <a href="author.html#46759">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I found my problem.

When I wrote some C code to open the .so, dlerror() is giving me an 'undefined symbol' error. Nothing to do with Mono at all.

Thanks,
-Jim Stapleton
  ----- Original Message ----- 
  From: STEVEN STAPLETON 
  To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A> 
  Sent: Saturday, March 19, 2011 1:27 PM
  Subject: Re: [Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.


  I don't mind sharing the wrapper code (I plan on BSD'ing it anyway). Should I put it on a web server for anyone to access, or should I attach it to a mail?

  I am compiling it without the .dll extension - however VS2010 is adding it implicitly it seems - that's why I added the extra stuff to the .config file (see original mail). It works for the two functions that get called from ag_core up 
  to that point (AG_InitCore, AG_GetError).

  A quick example of the imports:
  //does not work
  [DllImport(&quot;ag_gui&quot;, EntryPoint=&quot;AG_InitGraphics&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
  static public extern Int32 InitGraphics(string driver);
  //works
  [DllImport(&quot;ag_core&quot;, EntryPoint=&quot;AG_InitCore&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
  static private extern Int32 AG_InitCore(string progname, Uint32 flags);
  //works
  [DllImport(&quot;ag_core&quot;, EntryPoint=&quot;AG_Getopt&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
  static private extern Int32 AG_Getopt(Int32 argc, string[] argv, string fmt, out string v, out Int32 index);
  //works
  [DllImport(&quot;ag_core&quot;, EntryPoint=&quot;AG_GetError&quot;, ExactSpelling=true, CallingConvention=CallingConvention.Cdecl)]
  static public extern string GetError();





  Thanks,
  -Jim Stapleton


  ----- Original Message -----
  From: Danny &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">dgortonii at gmail.com</A>&gt;
  Date: Saturday, March 19, 2011 4:39 pm
  Subject: Re: [Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.
  To: jims &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">stapleton.41 at osu.edu</A>&gt;
  Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>

  &gt; Without seeing your wrapper code, I'd guess that your DllImport 
  &gt; statements include the file extension (.dll).  To make the 
  &gt; lookup work 
  &gt; properly on Linux/Mono you either need to exclude the file 
  &gt; extension 
  &gt; (ie: just use 'ag_gui' - both .NET and Mono will resolve this 
  &gt; correctly 
  &gt; if the file is in a proper search path) so the native naming 
  &gt; schemes can 
  &gt; be used on the respective platforms, or use a DllMap in your 
  &gt; config file 
  &gt; to tell mono how to map ag_gui.dll (and others).
  &gt; 
  &gt; On 03/19/2011 11:55 AM, jims wrote:
  &gt; &gt; Background, I am working on a C# wrapper for Agar ( 
  &gt; <A HREF="http://libagar.org/">http://libagar.org/</A> ) in
  &gt; &gt; Visual Studio express 2010. I have knocked the .NET framework 
  &gt; target down to
  &gt; &gt; 2.0 to improve platform compatibility, for users of older software.
  &gt; &gt;
  &gt; &gt; When I try to run the first demo, I get this error:
  &gt; &gt; [<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sjss at elrond</A> ~/Desktop/Agar.NET_Demo]$ mono ./AgarDemo_Windows.exe
  &gt; &gt; [DllNotFoundException:ag_gui.dll]The //config.AG_Config file 
  &gt; is not in
  &gt; &gt; load-path.
  &gt; &gt;
  &gt; &gt; verification it exists:
  &gt; &gt; [<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">sjss at elrond</A> ~/Desktop/Agar.NET_Demo]$ ls -l /usr/local/lib | 
  &gt; grep -e
  &gt; &gt; 'libag_.*.so'
  &gt; &gt; lrwxr-xr-x   1 root  
  &gt; wheel        17 Mar 18 15:39 
  &gt; libag_core.so -&gt;
  &gt; &gt; libag_core.so.1.4
  &gt; &gt; -rw-r--r--   1 root  wheel    
  &gt; 299513 Mar 18 14:54 libag_core.so.1.4
  &gt; &gt; lrwxr-xr-x   1 root  
  &gt; wheel        16 Mar 18 15:39 
  &gt; libag_dev.so -&gt;
  &gt; &gt; libag_dev.so.1.4
  &gt; &gt; -rw-r--r--   1 root  
  &gt; wheel     70586 Mar 18 14:54 libag_dev.so.1.4
  &gt; &gt; lrwxr-xr-x   1 root  
  &gt; wheel        16 Mar 18 15:39 
  &gt; libag_gui.so -&gt;
  &gt; &gt; libag_gui.so.1.4
  &gt; &gt; -rw-r--r--   1 root  wheel   1246374 
  &gt; Mar 18 14:54 libag_gui.so.1.4
  &gt; &gt; lrwxr-xr-x   1 root  
  &gt; wheel        17 Mar 18 15:39 
  &gt; libag_math.so -&gt;
  &gt; &gt; libag_math.so.1.4
  &gt; &gt; -rw-r--r--   1 root  wheel    
  &gt; 328560 Mar 18 14:54 libag_math.so.1.4
  &gt; &gt; lrwxr-xr-x   1 root  
  &gt; wheel        15 Mar 18 15:39 
  &gt; libag_rg.so -&gt;
  &gt; &gt; libag_rg.so.1.4
  &gt; &gt; -rw-r--r--   1 root  wheel    
  &gt; 255964 Mar 18 14:54 libag_rg.so.1.4
  &gt; &gt; lrwxr-xr-x   1 root  
  &gt; wheel        15 Mar 18 15:39 
  &gt; libag_vg.so -&gt;
  &gt; &gt; libag_vg.so.1.4
  &gt; &gt; -rw-r--r--   1 root  wheel    
  &gt; 205641 Mar 18 14:54 libag_vg.so.1.4
  &gt; &gt;
  &gt; &gt;
  &gt; &gt; I have installed Agar, FreeType and SDL on my machine, all the 
  &gt; libs are in
  &gt; &gt; /usr/local/lib, are in my libpath, and the directory has been 
  &gt; ldconfig'ed&gt; for good measure after the first time I saw the error.
  &gt; &gt;
  &gt; &gt; Since Visual Studio 2010 wants to add the '.dll' to the first 
  &gt; argument of
  &gt; &gt; the DllImport call, I have added the following to the  
  &gt; section of the config
  &gt; &gt; config of all of my .NET dlls/exes:
  &gt; &gt;
  &gt; &gt;
  &gt; &gt;
  &gt; &gt;
  &gt; &gt; ag_core.so is loading properly, the error message is produced by:
  &gt; &gt;    
  &gt; System.Console.WriteLine(&quot;[&quot;+e.GetType().Name+&quot;:&quot;+e.Message+&quot;]&quot; +
  &gt; &gt; Agar.GetError()+&quot;\n&quot;);
  &gt; &gt;
  &gt; &gt; The Agar.GetError() part is what I find interesting - that 
  &gt; requires that
  &gt; &gt; ag_core be called. I *believe* the &quot;//config.AG_Config file is 
  &gt; not in
  &gt; &gt; load-path.&quot; portion of the error is being set by an earlier 
  &gt; portion of the
  &gt; &gt; code in a manner that doesn't cause an exception or problem, 
  &gt; as a warning.
  &gt; &gt; Regardless, it shouldn't make &quot;ag_gui&quot; unlocatable.
  &gt; &gt;
  &gt; &gt;
  &gt; &gt; Any ideas what I should look into next?
  &gt; &gt; Thanks,
  &gt; &gt; -Jim Stapleton
  &gt; &gt;
  &gt; &gt; --
  &gt; &gt; View this message in context: 
  &gt; <A HREF="http://mono.1490590.n4.nabble.com/Difficulty-with-DllImport-in-">http://mono.1490590.n4.nabble.com/Difficulty-with-DllImport-in-</A>
  &gt; mono-config-AG-Config-file-is-not-in-load-path-tp3389891p3389891.html
  &gt; &gt; Sent from the Mono - General mailing list archive at Nabble.com.
  &gt; &gt; _______________________________________________
  &gt; &gt; Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
  &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
  &gt; &gt;
  &gt; 
  &gt; 
  &gt; -- 
  &gt; BEGIN-ANTISPAM-VOTING-LINKS
  &gt; ------------------------------------------------------
  &gt; 
  &gt; Teach CanIt if this mail (ID 1171312426) is spam:
  &gt; Spam:        
  &gt; about:blankNot spam:    about:blank
  &gt; Forget vote: 
  &gt; about:blank---
  &gt; ---------------------------------------------------
  &gt; END-ANTISPAM-VOTING-LINKS
  &gt; 

------------------------------------------------------------------------------

  Spam
  Not spam
  Forget previous vote



------------------------------------------------------------------------------


  _______________________________________________
  Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20110322/5c8b06bb/attachment-0001.html">http://lists.ximian.com/pipermail/mono-list/attachments/20110322/5c8b06bb/attachment-0001.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="046741.html">[Mono-list] Difficulty with DllImport in mono - config.AG_Config file is not in load-path.
</A></li>
	<LI>Next message: <A HREF="046742.html">[Mono-list] How do I Host a WCF Service using Mono, Apache2,	and GNU/Linux?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46759">[ date ]</a>
              <a href="thread.html#46759">[ thread ]</a>
              <a href="subject.html#46759">[ subject ]</a>
              <a href="author.html#46759">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
