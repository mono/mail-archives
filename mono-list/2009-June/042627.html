<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] High concurrency http requests with WebClient
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20High%20concurrency%20http%20requests%20with%20WebClient&In-Reply-To=h0bheu%24u1p%241%40ger.gmane.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042626.html">
   <LINK REL="Next"  HREF="042631.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] High concurrency http requests with WebClient</H1>
    <B>ledjon</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20High%20concurrency%20http%20requests%20with%20WebClient&In-Reply-To=h0bheu%24u1p%241%40ger.gmane.org"
       TITLE="[Mono-list] High concurrency http requests with WebClient">ledjon at ledjon.com
       </A><BR>
    <I>Fri Jun  5 13:04:25 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="042626.html">[Mono-list] High concurrency http requests with WebClient
</A></li>
        <LI>Next message: <A HREF="042631.html">[Mono-list] High concurrency http requests with WebClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42627">[ date ]</a>
              <a href="thread.html#42627">[ thread ]</a>
              <a href="subject.html#42627">[ subject ]</a>
              <a href="author.html#42627">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I'm not sure that's the problem. The threads themselves fire off just fine
(and work everything independently), but they all end up synchronizing on
WebClient requests even though the threads have nothing to do with one
another.

I can see by looking at the WebClient.cs source it specifically sets various
&quot;is_buys&quot; variables to prevent concurrent requests.  I'm just wondering why
it is so simplistic, and are there other &quot;more advanced&quot; classes that are
more &quot;thread independent&quot;?

- Jon


Robert Jordan wrote:
&gt;<i> 
</I>&gt;<i> ledjon wrote:
</I>&gt;&gt;<i> I've noticed something with mono (well, .net as well): If you write an
</I>&gt;&gt;<i> app
</I>&gt;&gt;<i> that create, say, 100 threads, and each thread fires off WebClient
</I>&gt;&gt;<i> requests,
</I>&gt;&gt;<i> they end up getting serialized and done in order instead of in parallel.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This seriously hurts the scalability of any application that might want
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> do a lot of web requests such as a web indexing service.  This service
</I>&gt;&gt;<i> needs
</I>&gt;&gt;<i> to be able to do a lot of work as one process (i.e., threads) but if
</I>&gt;&gt;<i> WebClient synchronizes across all the threads, then it is all for not.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Any thoughts or comments on how to get around this problem?
</I>&gt;<i> 
</I>&gt;<i> Try raising the number of threads in the thread pool.
</I>&gt;<i> 
</I>&gt;<i> See mono(1), environment var MONO_THREADS_PER_CPU.
</I>&gt;<i> 
</I>&gt;<i> Robert
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-- 
View this message in context: <A HREF="http://www.nabble.com/High-concurrency-http-requests-with-WebClient-tp23862474p23891979.html">http://www.nabble.com/High-concurrency-http-requests-with-WebClient-tp23862474p23891979.html</A>
Sent from the Mono - General mailing list archive at Nabble.com.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042626.html">[Mono-list] High concurrency http requests with WebClient
</A></li>
	<LI>Next message: <A HREF="042631.html">[Mono-list] High concurrency http requests with WebClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42627">[ date ]</a>
              <a href="thread.html#42627">[ thread ]</a>
              <a href="subject.html#42627">[ subject ]</a>
              <a href="author.html#42627">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
