<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] DynamicInvoke  calls causes exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DynamicInvoke%20%20calls%20causes%20exceptions&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042736.html">
   <LINK REL="Next"  HREF="042724.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] DynamicInvoke  calls causes exceptions</H1>
    <B>Andrus Moor</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DynamicInvoke%20%20calls%20causes%20exceptions&In-Reply-To="
       TITLE="[Mono-list] DynamicInvoke  calls causes exceptions">kobruleht2 at hot.ee
       </A><BR>
    <I>Tue Jun 16 08:24:01 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="042736.html">[Mono-list] Reset mono
</A></li>
        <LI>Next message: <A HREF="042724.html">[Mono-list] DynamicInvoke  calls causes exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42723">[ date ]</a>
              <a href="thread.html#42723">[ thread ]</a>
              <a href="subject.html#42723">[ subject ]</a>
              <a href="author.html#42723">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I tried to run VS web service in  Debian + Mono 2.4 + mod_mono
This web service uses DbLinq which makes a lot of
System.Delegate.DynamicInvoke() calls to convert npgsql
DataReader results to property values.

DynamicInvoke() calls cause randomly TargetParameterCountException or in
fewer cases InvalidCastException. Stack traces are below.

10 subsequent web service calls with same parameters will all never succeed. 
TargetParameterCountException is reproducible my making at most 10 calls.

How to debug of fix this ?

Andrus.

System.Reflection.TargetParameterCountException: parameters do not match
signature
  at System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags
invokeAttr, System.Reflection.Binder binder, System.Object[] parameters,
System.Globalization.CultureInfo culture) [0x000fc] in
/root/src/mcs/class/corlib/System.Reflection/MonoMethod.cs:185
  at System.Reflection.MethodBase.Invoke (System.Object obj, System.Object[]
parameters) [0x00000] in
/root/src/mcs/class/corlib/System.Reflection/MethodBase.cs:111
  at System.Delegate.DynamicInvokeImpl (System.Object[] args) [0x000ab] in
/root/src/mcs/class/corlib/System/Delegate.cs:439
  at System.MulticastDelegate.DynamicInvokeImpl (System.Object[] args)
[0x00018] in /root/src/mcs/class/corlib/System/MulticastDelegate.cs:71
  at System.Delegate.DynamicInvoke (System.Object[] args) [0x00000] in
/root/src/mcs/class/corlib/System/Delegate.cs:415
  at DbLinq.Data.Linq.Sugar.Expressions.InputParameterExpression.GetValue ()
[0x00002] in
I:\raamat\MyApp\dblinq\DbLinq\Data\Linq\Sugar\Expressions\InputParameterExpression.cs:58


In fewer cases InvalidCastException occurs:

System.InvalidCastException: Cannot cast from source type to destination
type.
  at System.Delegate.get_Method () [0x00000]
  at System.Delegate.DynamicInvokeImpl (System.Object[] args) [0x00000]
  at System.MulticastDelegate.DynamicInvokeImpl (System.Object[] args)
[0x00000]
  at System.Delegate.DynamicInvoke (System.Object[] args) [0x00000]
  at
DbLinq.Data.Linq.Sugar.Implementation.QueryRunner+&lt;EnumerateResult&gt;d__b.MoveNext
() [0x00000]
  at
DbLinq.Data.Linq.Sugar.Implementation.QueryRunner+&lt;ExecuteSelect&gt;d__0.MoveNext
() [0x00000]
  at
DbLinq.Data.Linq.DataContext+&lt;CreateExecuteQueryEnumerable&gt;d__d`1[Business.Datadict].MoveNext
() [0x00000]
  at System.Collections.Generic.List`1[Business.Datadict].AddEnumerable
(IEnumerable`1 enumerable) [0x00000]
  at System.Collections.Generic.List`1[Business.Datadict]..ctor
(IEnumerable`1 collection) [0x00000]
  at System.Linq.Enumerable.ToList[Datadict] (IEnumerable`1 source)
[0x00000]
  at Business.Database.ExecQuery[Datadict] (System.String command,
System.Type[] src, System.Object[] prm) [0x00000]
  at Business.Database.ExecQuery[Datadict,Datadict] (System.String command,
System.Object[] prm) [0x00000]
  at Business.EntityFactory.GetSpecialPropertyScript (System.String
entityName) [0x00000]
  at Business.EntityFactory.GetCustomEntityType (System.String entityName)
[0x00000]
  at Business.EntityFactory.Get (System.String entityName) [0x00000]
  at Business.EntityFactory.Create (System.String entityName) [0x00000]
  at Service.StockService.AddNewKuulutus (Service.UserCredentials&amp; header,
System.String headerEntity, Business.FormField[] headerFields,
Business.RidT[] rowFields) [0x00000] 

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042736.html">[Mono-list] Reset mono
</A></li>
	<LI>Next message: <A HREF="042724.html">[Mono-list] DynamicInvoke  calls causes exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42723">[ date ]</a>
              <a href="thread.html#42723">[ thread ]</a>
              <a href="subject.html#42723">[ subject ]</a>
              <a href="author.html#42723">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
