<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Bug (?) in SqliteDataReader
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Bug%20%28%3F%29%20in%20SqliteDataReader&In-Reply-To=446BA968.4070608%40for.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031666.html">
   <LINK REL="Next"  HREF="031684.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Bug (?) in SqliteDataReader</H1>
    <B>Jonathan Gilbert</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Bug%20%28%3F%29%20in%20SqliteDataReader&In-Reply-To=446BA968.4070608%40for.net"
       TITLE="[Mono-list] Bug (?) in SqliteDataReader">2a5gjx302 at sneakemail.com
       </A><BR>
    <I>Thu May 18 10:45:41 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="031666.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
        <LI>Next message: <A HREF="031684.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31671">[ date ]</a>
              <a href="thread.html#31671">[ thread ]</a>
              <a href="subject.html#31671">[ subject ]</a>
              <a href="author.html#31671">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At 06:53 PM 17/05/2006 -0400, Joshua Tauberer wrote:
&gt;<i>Nikki Locke wrote:
</I>&gt;&gt;<i> What about putting in some type checking when the data is _written_ to the 
</I>&gt;&gt;<i> database, instead? OK, it wouldn't stop exceptions being thrown if the
</I>data 
&gt;&gt;<i> was written by a some other app, but at least it would make things work 
</I>&gt;&gt;<i> consistently.
</I>&gt;<i>
</I>&gt;<i>I don't think there should be a database that can't be read using any
</I>&gt;<i>method, even if it wasn't created with Mono.Data.SqliteClient and even
</I>&gt;<i>if it has crazy nonuniform data in columns.
</I>
What about making SQLite type &quot;safety&quot; an optional feature, configured in
the connection string, so that when enabled, the GetSchemaTable method
returns the types asreported by SQLite, but by default (with a plain,
standard connection string) it returns all columns as 'String'? This is
especilaly attractive if there is some way to indicate this in the
connection string that other providers (e.g. Finisar) will simply ignore.
That way, if you know &amp; trust the database, you can enable the type
conversions, but with the knowledge that the database could be &quot;corrupt&quot;
w.r.t. the column types, resulting in exceptions that are outside of your
control. If you don't trust the database, then you can simply get strings
back and go from there :-)

A quick glance at Connection.cs in the Finisar source code
(<A HREF="http://tinyurl.com/nt4we">http://tinyurl.com/nt4we</A>) and the mono SqliteClient source code
(<A HREF="http://tinyurl.com/rrpcb">http://tinyurl.com/rrpcb</A>) shows that mono will simply ignore any
parameters in the connection string, as long as they're well-formed
(&quot;Name=Value&quot;), and while Finisar will complain about any parameter name it
doesn't know, it silently allows parameter *values* it doesn't know about.
Finisar has a parameter called &quot;Compatibility&quot;, so perhaps this could be
hijacked for this purpose:

string conn_str = &quot;Data
Source=dbfile;Version=3;Compatibility=use-field-types&quot;;

Of course, Mono.Data.SqliteClient uses &quot;URI&quot; in place of &quot;Data Source&quot;, but
perhaps &quot;Data Source&quot; could be added to Mono.Data.SqliteClient; then, the
above connection string would work just fine in both Finisar.Sqlite and
Mono.Data.SqliteClient :-)

Note that if a user wants one of the other Finisar &quot;Compatibility&quot; options,
they can simply include the &quot;Compatibility&quot; parameter more than once.

Another option -- not mutually exclusive -- might be to make any fields of
a record which fail to parse into DBNulls. Of course, this could only
properly be done on fields not marked as &quot;NOT NULL&quot;, but it would be a
useful alternative to throwing exceptions...

Jonathan Gilbert
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031666.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
	<LI>Next message: <A HREF="031684.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31671">[ date ]</a>
              <a href="thread.html#31671">[ thread ]</a>
              <a href="subject.html#31671">[ subject ]</a>
              <a href="author.html#31671">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
