<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Bug (?) in SqliteDataReader
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Bug%20%28%3F%29%20in%20SqliteDataReader&In-Reply-To=VA.000027e1.008d376d%40trumphurst.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031685.html">
   <LINK REL="Next"  HREF="031748.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Bug (?) in SqliteDataReader</H1>
    <B>Nikki Locke</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Bug%20%28%3F%29%20in%20SqliteDataReader&In-Reply-To=VA.000027e1.008d376d%40trumphurst.com"
       TITLE="[Mono-list] Bug (?) in SqliteDataReader">nikki at trumphurst.com
       </A><BR>
    <I>Fri May 19 10:00:26 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="031685.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
        <LI>Next message: <A HREF="031748.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31687">[ date ]</a>
              <a href="thread.html#31687">[ thread ]</a>
              <a href="subject.html#31687">[ subject ]</a>
              <a href="author.html#31687">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nikki Locke wrote:
&gt;<i> Joshua Tauberer wrote: 
</I>&gt;<i> &gt; I don't think there should be a database that can't be read using any 
</I>&gt;<i> &gt; method, even if it wasn't created with Mono.Data.SqliteClient and even 
</I>&gt;<i> &gt; if it has crazy nonuniform data in columns. 
</I>&gt;<i>  
</I>&gt;<i> Well, it is currently possible (actually, easy) to write a data row using the 
</I>&gt;<i> existing Mono.Data.SqliteClient library which cannot be read back! 
</I>
&gt;<i> Conclusion: 
</I>&gt;<i> The existing code does not satisfy your requirement. It does allow you to store 
</I>&gt;<i> and retrieve floating point numbers in DateTime fields, but not arbitrary 
</I>&gt;<i> strings. I don't see that is significantly better than only allowing parseable 
</I>&gt;<i> DateTimes in DateTime fields. 
</I>
I have been studying the code further.

In GetSchemaTable, you claim all the fields are strings.

However, in ReadpVm you go to some trouble to return the fields as other types.

This strikes me as inconsistent!

Having looked at the source, I see that the justification for treating integer 
values in DateTime columns as FileTimes is that is how they are treated in 
parameters. So I tried some code to insert a DateTime in a parameter. I used the 
following code...

    string sql = &quot;insert into tester (testdate) values (?)&quot;;
#if MONO
    using (IDbCommand ac = new SqliteCommand(sql, _connection)) {
#else
    using (IDbCommand ac = new SQLiteCommand(sql, _connection)) {
#endif
      IDbDataParameter param = ac.CreateParameter();
      param.DbType = DbType.DateTime;
      param.Value = DateTime.Parse(&quot;2006-05-11 11:45:00&quot;);
      ac.Parameters.Add(param);
      ac.ExecuteNonQuery();
    }

This adds a record OK, but the value seems to be blank! If I run this code in 
Mono, and then in .NET with Finisar, the .NET version shows the record as 
containing &quot;2006-05-11 11:45:00&quot;, but the Mono version shows nothing. I have tried 
&quot;select * from tester&quot; in sqlite3, and that also shows blank for the Mono-created 
database.

Do you have the Mono debugger working at all? Any hints how I can get it working?

-- 
Nikki Locke, Trumphurst Ltd.      PC &amp; Unix consultancy &amp; programming
<A HREF="http://www.trumphurst.com/">http://www.trumphurst.com/</A>


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031685.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
	<LI>Next message: <A HREF="031748.html">[Mono-list] Bug (?) in SqliteDataReader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31687">[ date ]</a>
              <a href="thread.html#31687">[ thread ]</a>
              <a href="subject.html#31687">[ subject ]</a>
              <a href="author.html#31687">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
