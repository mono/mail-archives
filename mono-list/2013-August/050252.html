<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] EF crashing in AssemblyName.ReferenceMatchesDefinition with is not implemented exception
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20EF%20crashing%20in%0A%20AssemblyName.ReferenceMatchesDefinition%20with%20is%20not%20implemented%20exception&In-Reply-To=%3CCAAqmy6N%3D%2BW4d3Zo8T5DW_1DrRTH%3Dccz2ZR7O8iUM9XzqHCW8yg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="050250.html">
   <LINK REL="Next"  HREF="050251.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] EF crashing in AssemblyName.ReferenceMatchesDefinition with is not implemented exception</H1>
    <B>Dave Curylo</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20EF%20crashing%20in%0A%20AssemblyName.ReferenceMatchesDefinition%20with%20is%20not%20implemented%20exception&In-Reply-To=%3CCAAqmy6N%3D%2BW4d3Zo8T5DW_1DrRTH%3Dccz2ZR7O8iUM9XzqHCW8yg%40mail.gmail.com%3E"
       TITLE="[Mono-list] EF crashing in AssemblyName.ReferenceMatchesDefinition with is not implemented exception">curylod at asme.org
       </A><BR>
    <I>Fri Aug 30 12:39:04 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="050250.html">[Mono-list] EF crashing in AssemblyName.ReferenceMatchesDefinition with is not implemented exception
</A></li>
        <LI>Next message: <A HREF="050251.html">[Mono-list] Mono for Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50252">[ date ]</a>
              <a href="thread.html#50252">[ thread ]</a>
              <a href="subject.html#50252">[ subject ]</a>
              <a href="author.html#50252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I agree that having this fixed privately will not help anyone and
eventually harm yourself in terms of maintenance challenges.

The right thing to do in this case is that if you have a potential solution
to the missing mono framework code, submit a pull request with it and if
you have some concerns about pitfalls in your implementation, start a
discussion in github with that pull request.  Mono developers will
likely review it, participate in the discussion, and before you know it the
code will make its way to master.

On Tuesday, August 27, 2013, Mark Lintner wrote:

&gt;<i>  Hi Abe,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That is probably not going to help anyone. This issue will be hit over and
</I>&gt;<i> over again in the distribution and really  needs to be addressed.  What
</I>&gt;<i> happens when you change code like this and keep a private build is that you
</I>&gt;<i> are either stuck at that version forever or you have to merge in your
</I>&gt;<i> private changes every time you update.  The size of that effort will grow
</I>&gt;<i> in time if you go down that route. Eventually it becomes impossible to
</I>&gt;<i> update and you lose the value of fixes that are added to the trunk. So I
</I>&gt;<i> was looking for people who were impacted by this, had a good grasp of the
</I>&gt;<i> issues such as determining if the assemblies are the same. If someone had
</I>&gt;<i> already fixed it, I would not have to otherwise I have to fix it and submit
</I>&gt;<i> it to the list for approval or suggestions.  I appreciate your suggestion.
</I>&gt;<i> It is easy to get it up and running, on the surface but is unmanageable
</I>&gt;<i> over any period of time. This is  a bug and we need to fix it.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>  ------------------------------
</I>&gt;<i> *From:* Abe Gillespie [<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">abe.gillespie at gmail.com</A> &lt;javascript:_e({}, 'cvml',
</I>&gt;<i> '<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">abe.gillespie at gmail.com</A>');&gt;]
</I>&gt;<i> *Sent:* Tuesday, August 27, 2013 7:25 AM
</I>&gt;<i> *To:* Mark Lintner
</I>&gt;<i> *Cc:* <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A> &lt;javascript:_e({}, 'cvml',
</I>&gt;<i> '<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list at lists.ximian.com</A>');&gt;
</I>&gt;<i> *Subject:* Re: [Mono-list] EF crashing in
</I>&gt;<i> AssemblyName.ReferenceMatchesDefinition with is not implemented exception
</I>&gt;<i>
</I>&gt;<i>  I know this isn't a particularly great option, but if this is a big
</I>&gt;<i> roadblock for you, you can always change the EF source and work-around the
</I>&gt;<i> issue with your own private version of EF. It should be pretty easy to
</I>&gt;<i> locate the offending code.
</I>&gt;<i>
</I>&gt;<i>  <A HREF="http://entityframework.codeplex.com/">http://entityframework.codeplex.com/</A>
</I>&gt;<i>
</I>&gt;<i> On Monday, August 26, 2013, mlgo wrote:
</I>&gt;<i>
</I>&gt;<i> Has anyone figured this out yet?. Either this is going to have to be
</I>&gt;<i> implemented or the Entity Framwork needs to avoid calling it. There is a
</I>&gt;<i> stacktrace at the bottom of this message.
</I>&gt;<i>
</I>&gt;<i> System.Reflection.AssemblyName.ReferenceMatchesDefinition is not
</I>&gt;<i> implemented. I guess developers have been working around this by comparing
</I>&gt;<i> the assembly fullnames. Since it is called directly by EntityFramework it
</I>&gt;<i> has to be implemented now. Unless EF should be changed to avoid this call.
</I>&gt;<i> This is something I have not researched either. If anyone would think that
</I>&gt;<i> EntityFramework should be changed to avoid making this call please add some
</I>&gt;<i> feedback.
</I>&gt;<i>
</I>&gt;<i> Has anyone done this implementation or are they working on it currently?. I
</I>&gt;<i> don't see any posts or bugs relating to it but I did find one reference to
</I>&gt;<i> the problem in the context of another product using mono.
</I>&gt;<i> Does the mono team plan to or want to implement it?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I have done some research on this method in dotnet. The implementation for
</I>&gt;<i> windows as documented by MSDN in this simple way &quot;The comparison depends
</I>&gt;<i> only on the simple assembly name. It ignores version, culture, and public
</I>&gt;<i> key token. &quot;.
</I>&gt;<i>
</I>&gt;<i> At a more fundamentally level the purpose of this method is to determine if
</I>&gt;<i> the 2 names resolve to the same assembly. I believe that the documentation
</I>&gt;<i> in dotnet used to read that way and referred to the loader. I suspect that
</I>&gt;<i> dotnet is still doing that as part of the implementation of this function.
</I>&gt;<i> If that approach were taken I'm not yet sure if it requires making windows
</I>&gt;<i> OS calls to do it or if it could be done with managed code. The point is if
</I>&gt;<i> it does need to be done and it needs to call os api's then the
</I>&gt;<i> implementation would need to be different for Linux. If it is called often.
</I>&gt;<i> If it involves loading an assembly using both of the names and then
</I>&gt;<i> determining whether it is the same assembly that seems slow and
</I>&gt;<i> inefficient.
</I>&gt;<i> I have not done any performance profiling on this call to find out often it
</I>&gt;<i> gets called.
</I>&gt;<i> I think I would want to cache the assemblies. Also memoize the assembly
</I>&gt;<i> names and their results. This would speed things up considerably.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm concerned this will need to be implemented differently on Linux?? Hence
</I>&gt;<i> it will have multiple implementations.
</I>&gt;<i>
</I>&gt;<i> Now that EF6 is in and people are using this becomes an immediate problem
</I>&gt;<i> as
</I>&gt;<i> it binds directly to the unimplemented function
</I>&gt;<i> AssemblyName.ReferenceMatchesDefinition. Here is the stack:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> System.NotImplementedException: The requested feature is not implemented.
</I>&gt;<i>
</I>&gt;<i>   at System.Reflection.AssemblyName.ReferenceMatchesDefinition
</I>&gt;<i> (System.Reflection.AssemblyName reference, System.Reflection.AssemblyName
</I>&gt;<i> definition) [0x0003a] in
</I>&gt;<i>
</I>&gt;<i> C:\cygwin\sources\mono\mcs\class\corlib\System.Reflection\AssemblyName.cs:328
</I>&gt;<i>
</I>&gt;<i>   at
</I>&gt;<i>
</I>&gt;<i> System.Data.Entity.Core.Metadata.Edm.DefaultAssemblyResolver.ResolveAssembly
</I>&gt;<i> (System.Reflection.AssemblyName referenceName) [0x00019] in
</I>&gt;<i>
</I>&gt;<i> C:\cygwin\sources\mono\external\entityframework\src\EntityFramework\Core\Metadata\Edm\DefaultAssemblyResolver.cs:30
</I>&gt;<i>
</I>&gt;<i>   at
</I>&gt;<i>
</I>&gt;<i> System.Data.Entity.Core.Metadata.Edm.DefaultAssemblyResolver.TryResolveAssemblyReference
</I>&gt;<i> (System.Reflection.AssemblyName refernceName, System.Reflection.Assembly&amp;
</I>&gt;<i> assembly) [0x00000] in
</I>&gt;<i>
</I>&gt;<i> C:\cygwin\sources\mono\external\entityframework\src\EntityFramework\Core\Metadata\Edm\DefaultAssemblyResolver.cs:14
</I>&gt;<i>
</I>&gt;<i>   at
</I>&gt;<i>
</I>&gt;<i> System.Data.Entity.Core.Metadata.Edm.MetadataArtifactLoaderCompositeResource.ResolveAssemblyName
</I>&gt;<i> (System.String assemblyName,
</I>&gt;<i> System.Data.Entity.Core.Metadata.Edm.MetadataArtifactAssemblyResolver
</I>&gt;<i> resolver) [0x00007] in
</I>&gt;<i>
</I>&gt;<i> C:\cygwin\sources\mono\external\entityframework\src\EntityFramework\Core\Metadata\Edm\MetadataArtifactLoaderCompositeResource.cs:272
</I>&gt;<i>
</I>&gt;<i>   at
</I>&gt;<i>
</I>&gt;<i> System.Data.Entity.Core.Metadata.Edm.MetadataArtifactLoaderCompositeResource.CreateResourceLoader
</I>&gt;<i> (System.String path, ExtensionCheck extensionCheck, System.String
</I>&gt;<i> validExtension, ICollection`1 uriRegistry,
</I>&gt;<i> System.Data.Entity.Core.Metadata.Edm.MetadataArtifactAssemblyResolver
</I>&gt;<i> resolver) [0x0004d] in
</I>&gt;<i> C:\cygwin\sources\mono\external\e
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20130830/6ecc0eb8/attachment-0001.html">http://lists.ximian.com/pipermail/mono-list/attachments/20130830/6ecc0eb8/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="050250.html">[Mono-list] EF crashing in AssemblyName.ReferenceMatchesDefinition with is not implemented exception
</A></li>
	<LI>Next message: <A HREF="050251.html">[Mono-list] Mono for Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50252">[ date ]</a>
              <a href="thread.html#50252">[ thread ]</a>
              <a href="subject.html#50252">[ subject ]</a>
              <a href="author.html#50252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
