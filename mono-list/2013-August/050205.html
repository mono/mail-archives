<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono 3.2.0 Asp.NET MVC Memory Leak
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Mono%203.2.0%20Asp.NET%20MVC%20Memory%20Leak&In-Reply-To=%3C520E1924.6030204%40jigsawdezign.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="050124.html">
   <LINK REL="Next"  HREF="050144.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono 3.2.0 Asp.NET MVC Memory Leak</H1>
    <B>James Wright</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Mono%203.2.0%20Asp.NET%20MVC%20Memory%20Leak&In-Reply-To=%3C520E1924.6030204%40jigsawdezign.com%3E"
       TITLE="[Mono-list] Mono 3.2.0 Asp.NET MVC Memory Leak">james.wright at jigsawdezign.com
       </A><BR>
    <I>Fri Aug 16 12:20:52 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="050124.html">[Mono-list] Mono 3.2.0 Asp.NET MVC Memory Leak
</A></li>
        <LI>Next message: <A HREF="050144.html">[Mono-list] How do I uninstall a partial install of 3.06 on ubuntu?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50205">[ date ]</a>
              <a href="thread.html#50205">[ thread ]</a>
              <a href="subject.html#50205">[ subject ]</a>
              <a href="author.html#50205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
    I was using an old version of XSP (2.10.2) which was located on the 
mono-project downloads page, however I have since built XSP from GitHub 
Master (Aug 11), and although the memory leak seems slightly better it 
isn't really fixed.

   Something that is confusing me is the memory usage stats reported by 
&quot;ps -AF&quot;, I'm don't think I understand how the RSS size is so much 
larger than SZ (see below)?

UID         apache
PID         15958
SZ           356709
RSS         816840
STIME    Aug11
TIME      01:06:01
CMD       /usr/bin/mono /usr/lib/mono/4.5/mod-mono-server4.exe 
--filename /tmp/mod_mono_serve....

  Is this memory usage normal, is there any easy way to help diagnose 
the leak?

Thanks,
James


On 01/08/2013 09:29, &quot;Andr&#233;s G. Aragoneses&quot; wrote:
&gt;<i> On 31/07/13 22:13, James Wright wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     I've recently upgraded our web server from Mono 2.10.8 to Mono 3.2.0
</I>&gt;&gt;<i> (built from source tarball), but I'm noticing a huge difference in
</I>&gt;&gt;<i> memory usage. The old version would startup our ASP.NET MVC 2 website
</I>&gt;&gt;<i> using ~100MB and over approximately two weeks grow to use around
</I>&gt;&gt;<i> 500-600MB. However, the latest version starts up using ~100MB but has
</I>&gt;&gt;<i> grown to use over 1GB+ in just two days under exactly the same load. I
</I>&gt;&gt;<i> might try switching to using the Boehm garbage collector to see if that
</I>&gt;&gt;<i> is any better.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Any advice on how to go about diagnosing where this leak is occurring
</I>&gt;&gt;<i> would be greatly appreciated!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Our stack is as follows; Amazon Linux x86-64, Apache 2.2, Mono 3.2.0,
</I>&gt;&gt;<i> mod_mono 2.10
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> And what version of xsp[1]?
</I>&gt;<i>
</I>&gt;<i> There have been some memory leak fixes[2] in master which are not in 
</I>&gt;<i> 3.2, so you might want to test with building your own mono.
</I>&gt;<i>
</I>&gt;<i> [1] <A HREF="https://github.com/mono/xsp/tree/master/src/Mono.WebServer.Apache">https://github.com/mono/xsp/tree/master/src/Mono.WebServer.Apache</A>
</I>&gt;<i> [2] 
</I>&gt;<i> <A HREF="https://github.com/mono/mono/commit/c931c463c24ef4f257dc6dc4dafdc2ac81b8a9d3">https://github.com/mono/mono/commit/c931c463c24ef4f257dc6dc4dafdc2ac81b8a9d3</A> 
</I>&gt;<i> and 
</I>&gt;<i> <A HREF="https://github.com/mono/mono/commit/76e8c8ba0f5dad4c154b9ab6dd969ef2eb0bec79">https://github.com/mono/mono/commit/76e8c8ba0f5dad4c154b9ab6dd969ef2eb0bec79</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="050124.html">[Mono-list] Mono 3.2.0 Asp.NET MVC Memory Leak
</A></li>
	<LI>Next message: <A HREF="050144.html">[Mono-list] How do I uninstall a partial install of 3.06 on ubuntu?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50205">[ date ]</a>
              <a href="thread.html#50205">[ thread ]</a>
              <a href="subject.html#50205">[ subject ]</a>
              <a href="author.html#50205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
