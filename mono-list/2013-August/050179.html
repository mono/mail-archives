<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Unit tests load a different configuration file	under mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Unit%20tests%20load%20a%20different%20configuration%20file%0A%09under%20mono&In-Reply-To=%3Cku4u8v%24lmr%241%40ger.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="050178.html">
   <LINK REL="Next"  HREF="050180.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Unit tests load a different configuration file	under mono</H1>
    <B>&quot;Andr&#233;s G. Aragoneses&quot;</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Unit%20tests%20load%20a%20different%20configuration%20file%0A%09under%20mono&In-Reply-To=%3Cku4u8v%24lmr%241%40ger.gmane.org%3E"
       TITLE="[Mono-list] Unit tests load a different configuration file	under mono">knocte at gmail.com
       </A><BR>
    <I>Sat Aug 10 08:40:06 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="050178.html">[Mono-list] Unit tests load a different configuration file	under mono
</A></li>
        <LI>Next message: <A HREF="050180.html">[Mono-list] Unit tests load a different configuration file	under mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50179">[ date ]</a>
              <a href="thread.html#50179">[ thread ]</a>
              <a href="subject.html#50179">[ subject ]</a>
              <a href="author.html#50179">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
This is not related to NUnit. This is exactly bug 11972 which I filed 
here some months ago: <A HREF="https://bugzilla.xamarin.com/show_bug.cgi?id=11972">https://bugzilla.xamarin.com/show_bug.cgi?id=11972</A>

The problem lies in the fact that whenever any code inside the 
System.Web assembly tries to read the configuration, it replaces the 
System.Configuration infrastructure to the one that is used when a 
ASP.NET app is run.

I have a patch that fixes it, which I proposed in a pull request: 
<A HREF="https://github.com/mono/mono/pull/725">https://github.com/mono/mono/pull/725</A> . However, some time later after I 
wrote the fix I realized it was based on false assumptions, and I 
haven't had yet the time to investigate more. Do you mind reading the 
pull request, subscribe to it, and help?

The approach I'm thinking now that may be correct would be replacing all 
config queries in System.Web that use WebConfigurationManager, to start 
using ConfigurationManager instead. But I haven't tested it yet.


On 10/08/13 03:25, Dave Curylo wrote:
&gt;<i> Thanks for the reply. I understand how to get the test framework to load
</I>&gt;<i> a config file, and the first test does just that. It succeeds on both
</I>&gt;<i> platforms.  The second test does the same exact thing, only it makes a
</I>&gt;<i> call to HttpUtility first, and this seems to trip up the
</I>&gt;<i> ConfigurationManager, but only under mono. Under MS .NET, both tests
</I>&gt;<i> succeed in loading the configuration and both pass, but under mono, the
</I>&gt;<i> first test passes and the second test fails because once a call is made
</I>&gt;<i> to HttpUtility, the ConnectionStrings are replaced with the defaults
</I>&gt;<i> from the ASP.NET &lt;<A HREF="http://ASP.NET">http://ASP.NET</A>&gt; stack.  This seems like very odd behavior.
</I>&gt;<i>
</I>&gt;<i> On Friday, August 9, 2013, Charlie Poole wrote:
</I>&gt;<i>
</I>&gt;<i>     Each test framework has it's own requirements for where a config
</I>&gt;<i>     file must be located and how it should be named in order to be
</I>&gt;<i>     loaded and used.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>

</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="050178.html">[Mono-list] Unit tests load a different configuration file	under mono
</A></li>
	<LI>Next message: <A HREF="050180.html">[Mono-list] Unit tests load a different configuration file	under mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50179">[ date ]</a>
              <a href="thread.html#50179">[ thread ]</a>
              <a href="subject.html#50179">[ subject ]</a>
              <a href="author.html#50179">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
