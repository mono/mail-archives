<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Moma Reports dir
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Moma%20Reports%20dir&In-Reply-To=1174961208.66901.1.camel%40localhost">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034740.html">
   <LINK REL="Next"  HREF="034795.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Moma Reports dir</H1>
    <B>Jonathan Pobst</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Moma%20Reports%20dir&In-Reply-To=1174961208.66901.1.camel%40localhost"
       TITLE="[Mono-list] Moma Reports dir">monkey at jpobst.com
       </A><BR>
    <I>Fri Mar 30 09:52:39 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="034740.html">[Mono-list] Moma Reports dir
</A></li>
        <LI>Next message: <A HREF="034795.html">[Mono-list] Moma Reports dir
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34794">[ date ]</a>
              <a href="thread.html#34794">[ thread ]</a>
              <a href="subject.html#34794">[ subject ]</a>
              <a href="author.html#34794">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Phillip!

This patch also uses the user's directory for the images and definition 
files.  I think those truly are global, and each user shouldn't have 
their own copy of them.  They should remain with the executable.

As for the reports, I'm not really sure how much of a difference there 
is.  If MoMA stored all the reports ever made, I think it would make 
sense to store them in the user's directory.  However, since it only 
stores the most recent report, its really more of a temporary directory 
than user storage of reports.  Since the user (in theory) doesn't access 
the report directly from the file system, it doesn't really matter where 
it is.

The other issue with making changes to MoMA is that I don't really 
release new versions of it.  Due to the definition update built-in to 
MoMA, no one needs to download a new version of MoMA, so they won't get 
any changes made.  When a new version of Mono is released, I do release 
a new MoMA that may include some small fixes and new definition files, 
but it is never announced for people to upgrade unless they are hitting 
bugs.

Having said all that, if people strongly feel reports should be stored 
in the user's directory, I'm not against it and can make the change.

Jon


Phillip N. wrote:
&gt;<i> Hi mono's..
</I>&gt;<i> 
</I>&gt;<i> Is it possible to make MoMa use the user's dir to save/work the Reports?
</I>&gt;<i> 
</I>&gt;<i> thanks!
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> Index: DefinitionDownloader.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- DefinitionDownloader.cs	(revision 75003)
</I>&gt;<i> +++ DefinitionDownloader.cs	(working copy)
</I>&gt;<i> @@ -19,7 +19,7 @@
</I>&gt;<i>  		{
</I>&gt;<i>  			InitializeComponent ();
</I>&gt;<i>  
</I>&gt;<i> -			image_directory = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Resources&quot;);
</I>&gt;<i> +			image_directory = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Resources&quot;);
</I>&gt;<i>  			LoadImages ();
</I>&gt;<i>  		}
</I>&gt;<i>  
</I>&gt;<i> @@ -44,7 +44,7 @@
</I>&gt;<i>  			Application.DoEvents ();
</I>&gt;<i>  			
</I>&gt;<i>  			try {
</I>&gt;<i> -				string definition_directory = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Definitions&quot;);
</I>&gt;<i> +				string definition_directory = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Definitions&quot;);
</I>&gt;<i>  				
</I>&gt;<i>  				if (!Directory.Exists (definition_directory))
</I>&gt;<i>  					Directory.CreateDirectory (definition_directory);
</I>&gt;<i> @@ -100,4 +100,4 @@
</I>&gt;<i>  			}
</I>&gt;<i>  		}
</I>&gt;<i>  	}
</I>&gt;<i> -}
</I>&gt;<i> \ No newline at end of file
</I>&gt;<i> +}
</I>&gt;<i> Index: MainForm.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- MainForm.cs	(revision 75003)
</I>&gt;<i> +++ MainForm.cs	(working copy)
</I>&gt;<i> @@ -25,7 +25,7 @@
</I>&gt;<i>  		{
</I>&gt;<i>  			InitializeComponent ();
</I>&gt;<i>  
</I>&gt;<i> -			image_directory = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Resources&quot;);
</I>&gt;<i> +			image_directory = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Resources&quot;);
</I>&gt;<i>  			LoadImages ();
</I>&gt;<i>  			
</I>&gt;<i>  			// Process.Start doesn't work on Unix, so we'll just hide the link
</I>&gt;<i> @@ -217,9 +217,9 @@
</I>&gt;<i>  			int pinvokecount = 0;
</I>&gt;<i>  			int missingcount = 0;
</I>&gt;<i>  
</I>&gt;<i> -			string todo_defs = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;monotodo.txt&quot;);
</I>&gt;<i> -			string nie_defs = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;exception.txt&quot;);
</I>&gt;<i> -			string missing_defs = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;missing.txt&quot;);
</I>&gt;<i> +			string todo_defs = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;monotodo.txt&quot;);
</I>&gt;<i> +			string nie_defs = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;exception.txt&quot;);
</I>&gt;<i> +			string missing_defs = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;missing.txt&quot;);
</I>&gt;<i>  
</I>&gt;<i>  			// Load the definition files
</I>&gt;<i>  			FileDefinition definitions = (FileDefinition)MonoVersionCombo.SelectedItem;
</I>&gt;<i> @@ -234,10 +234,10 @@
</I>&gt;<i>  				aa.ScanAssemblyForPInvokes ((string)lvi.Tag);
</I>&gt;<i>  
</I>&gt;<i>  			// Start the results reports
</I>&gt;<i> -			if (!Directory.Exists (Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Reports&quot;)))
</I>&gt;<i> -				Directory.CreateDirectory (Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Reports&quot;));
</I>&gt;<i> +			if (!Directory.Exists (Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Reports&quot;)))
</I>&gt;<i> +				Directory.CreateDirectory (Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Reports&quot;));
</I>&gt;<i>  
</I>&gt;<i> -			string output_path = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Reports&quot;);
</I>&gt;<i> +			string output_path = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Reports&quot;);
</I>&gt;<i>  			XhtmlTextWriter report = aa.BeginHtmlReport (new FileStream (Path.Combine (output_path, &quot;output.html&quot;), FileMode.Create));
</I>&gt;<i>  			StreamWriter submit_report = aa.BeginTextReport (new FileStream (Path.Combine (output_path, &quot;submit.txt&quot;), FileMode.Create));
</I>&gt;<i>  
</I>&gt;<i> @@ -326,7 +326,7 @@
</I>&gt;<i>  
</I>&gt;<i>  		private void ResultsDetailLink_LinkClicked (object sender, LinkLabelLinkClickedEventArgs e)
</I>&gt;<i>  		{
</I>&gt;<i> -			string report_file = Path.Combine (Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Reports&quot;), &quot;output.html&quot;);
</I>&gt;<i> +			string report_file = Path.Combine (Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Reports&quot;), &quot;output.html&quot;);
</I>&gt;<i>  
</I>&gt;<i>  			try {
</I>&gt;<i>  				System.Diagnostics.Process.Start (report_file);
</I>&gt;<i> @@ -343,7 +343,7 @@
</I>&gt;<i>  
</I>&gt;<i>  		private void ViewReportButton_Click (object sender, EventArgs e)
</I>&gt;<i>  		{
</I>&gt;<i> -			string report_file = Path.Combine (Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Reports&quot;), &quot;submit.txt&quot;);
</I>&gt;<i> +			string report_file = Path.Combine (Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Reports&quot;), &quot;submit.txt&quot;);
</I>&gt;<i>  			
</I>&gt;<i>  			try {	        
</I>&gt;<i>  				System.Diagnostics.Process.Start (report_file);	
</I>&gt;<i> @@ -356,7 +356,7 @@
</I>&gt;<i>  		private void SubmitReportButton_Click (object sender, EventArgs e)
</I>&gt;<i>  		{
</I>&gt;<i>  			SubmitReportButton.Enabled = false;
</I>&gt;<i> -			string output_path = Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Reports&quot;);
</I>&gt;<i> +			string output_path = Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Reports&quot;);
</I>&gt;<i>  			string file = Path.Combine (output_path, &quot;submit.txt&quot;);
</I>&gt;<i>  
</I>&gt;<i>  			try {
</I>&gt;<i> @@ -397,7 +397,7 @@
</I>&gt;<i>  		{
</I>&gt;<i>  			MonoVersionCombo.Items.Clear ();
</I>&gt;<i>  			
</I>&gt;<i> -			foreach (FileDefinition fd in DefinitionHandler.FindAvailableVersions (Path.Combine (Path.GetDirectoryName (Application.ExecutablePath), &quot;Definitions&quot;)))
</I>&gt;<i> +			foreach (FileDefinition fd in DefinitionHandler.FindAvailableVersions (Path.Combine (Path.GetDirectoryName (Application.LocalUserAppDataPath), &quot;Definitions&quot;)))
</I>&gt;<i>  				MonoVersionCombo.Items.Add (fd);
</I>&gt;<i>  
</I>&gt;<i>  			if (MonoVersionCombo.Items.Count &gt; 0)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034740.html">[Mono-list] Moma Reports dir
</A></li>
	<LI>Next message: <A HREF="034795.html">[Mono-list] Moma Reports dir
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34794">[ date ]</a>
              <a href="thread.html#34794">[ thread ]</a>
              <a href="subject.html#34794">[ subject ]</a>
              <a href="author.html#34794">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
