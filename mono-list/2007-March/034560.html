<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] DllNotFoundException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DllNotFoundException&In-Reply-To=1173709435.28828.1178995749%40webmail.messagingengine.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034551.html">
   <LINK REL="Next"  HREF="034552.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] DllNotFoundException</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20DllNotFoundException&In-Reply-To=1173709435.28828.1178995749%40webmail.messagingengine.com"
       TITLE="[Mono-list] DllNotFoundException">jonpryor at vt.edu
       </A><BR>
    <I>Tue Mar 13 06:49:11 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="034551.html">[Mono-list] DllNotFoundException
</A></li>
        <LI>Next message: <A HREF="034552.html">[Mono-list] Closures and Memoization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34560">[ date ]</a>
              <a href="thread.html#34560">[ thread ]</a>
              <a href="subject.html#34560">[ subject ]</a>
              <a href="author.html#34560">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2007-03-12 at 14:23 +0000, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">colin at breame.net</A> wrote:
&gt;<i> Using the DllImport attribute to import 'readline' out of libreadline I
</I>&gt;<i> get a DllNotFoundException.  This is what I do:
</I>&gt;<i> 
</I>&gt;<i>  $ gmcs test.cs  # see below
</I>&gt;<i>  $ mono test.exe
</I>&gt;<i>     Unhandled Exception: System.DllNotFoundException: libreadline.so.4
</I>&gt;<i>       at (wrapper managed-to-native) readline_t:readline (string)
</I>&gt;<i>       at readline_t.Main () [0x00000]
</I>&gt;<i>
</I>&gt;<i> My question is; what other things can go wrong loading a library that
</I>&gt;<i> can cause a DllNotFoundException using DllImport?
</I>
Mis-compiled libraries can do this, if e.g. libreadline.so required a
symbol from another library, but libreadline.so wasn't linked against
that library, you would get a DllNotFoundException.

To get additional information, run your app with the MONO_LOG_LEVEL and
MONO_LOG_MASK environment variables set:

	$ MONO_LOG_LEVEL=info MONO_LOG_MASK=dll mono test.exe

For reference, your program works correctly on my system (openSUSE 10.2)
when using libreadline.so.5.

The preferred approach (since library names may change between
platforms) would be to do:

	[DllImport (&quot;readline&quot;)]
	extern public static string readline(string prompt);

i.e. no version information within the DllImport library name, and then
provide a test.exe.config file that provides the actual library name:

	&lt;configuration&gt;
		&lt;dllmap dll=&quot;readline&quot; target=&quot;libreadline.so.5&quot;/&gt;
	&lt;/configuration&gt;

This allows the version to be easily changed, assuming that the library
ABI hasn't changed in an incompatible manner (as is the case here, as
both libreadline.so.4 and libreadline.so.5 include the `readline'
export).

 - Jon


</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034551.html">[Mono-list] DllNotFoundException
</A></li>
	<LI>Next message: <A HREF="034552.html">[Mono-list] Closures and Memoization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34560">[ date ]</a>
              <a href="thread.html#34560">[ thread ]</a>
              <a href="subject.html#34560">[ subject ]</a>
              <a href="author.html#34560">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
