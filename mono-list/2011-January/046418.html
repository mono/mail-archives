<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] RSA with SHA512 hash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20RSA%20with%20SHA512%20hash&In-Reply-To=1294653017620-3206847.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="046417.html">
   <LINK REL="Next"  HREF="046422.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] RSA with SHA512 hash</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20RSA%20with%20SHA512%20hash&In-Reply-To=1294653017620-3206847.post%40n4.nabble.com"
       TITLE="[Mono-list] RSA with SHA512 hash">sebastien.pouliot at gmail.com
       </A><BR>
    <I>Mon Jan 10 07:53:03 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="046417.html">[Mono-list] RSA with SHA512 hash
</A></li>
        <LI>Next message: <A HREF="046422.html">[Mono-list] RSA with SHA512 hash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46418">[ date ]</a>
              <a href="thread.html#46418">[ thread ]</a>
              <a href="subject.html#46418">[ subject ]</a>
              <a href="author.html#46418">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Jeremy,

This was not supported in earlier version of Windows. Most of MS .NET
cryptography is not managed and redirected to CryptoAPI, which features
varies by Windows versions (which means your code won't work on all
Windows versions out there).

In any case Mono can support this (all managed and no dependency on the
OS). Please fill a bug report on bugzilla.novell.com with a
self-contained test case and I'll look at it asap.

Thanks
Sebastien

On Mon, 2011-01-10 at 01:50 -0800, jeremy.poulter wrote:
&gt;<i> I have been developing an application that uses an SHA512 hash signed with a
</I>&gt;<i> RSA private key for a digital signature.
</I>&gt;<i> 
</I>&gt;<i> This is working fine on Windows under .Net but when I try this on Linux
</I>&gt;<i> under Mono I get the following exception;
</I>&gt;<i> 
</I>&gt;<i> System.NotSupportedException: 2.16.840.1.101.3.4.2.3 is an unsupported hash
</I>&gt;<i> algorithm for RSA signing
</I>&gt;<i>   at
</I>&gt;<i> System.Security.Cryptography.RSACryptoServiceProvider.GetHashNameFromOID
</I>&gt;<i> (System.String oid) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Security.Cryptography.RSACryptoServiceProvider.SignHash
</I>&gt;<i> (System.Byte[] rgbHash, System.String str) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at Oregan.Utilities.DigitalSignature.DigitalSignature.Sign (HashType
</I>&gt;<i> hashType, System.IO.Stream stream) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at Oregan.FilePackBuilder.FilePack.Save (System.String sPath,
</I>&gt;<i> Oregan.Utilities.DigitalSignature.DigitalSignature digitalSignature, Boolean
</I>&gt;<i> bPreserveName) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at Oregan.FilePackBuilder.FilePackViewer.filepackToolStripMenuItem1_Click
</I>&gt;<i> (System.Object sender, System.EventArgs e) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ToolStripItem.OnClick (System.EventArgs e)
</I>&gt;<i> [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ToolStripMenuItem.OnClick (System.EventArgs e)
</I>&gt;<i> [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ToolStripMenuItem.HandleClick (System.EventArgs e)
</I>&gt;<i> [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ToolStripItem.FireEvent (System.EventArgs e,
</I>&gt;<i> ToolStripItemEventType met) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.Windows.Forms.ToolStripItem:FireEvent
</I>&gt;<i> (System.EventArgs,System.Windows.Forms.ToolStripItemEventType)
</I>&gt;<i>   at System.Windows.Forms.ToolStrip.OnMouseUp
</I>&gt;<i> (System.Windows.Forms.MouseEventArgs mea) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ToolStripDropDown.OnMouseUp
</I>&gt;<i> (System.Windows.Forms.MouseEventArgs mea) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.Control.WmLButtonUp (System.Windows.Forms.Message&amp;
</I>&gt;<i> m) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.Control.WndProc (System.Windows.Forms.Message&amp; m)
</I>&gt;<i> [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ScrollableControl.WndProc
</I>&gt;<i> (System.Windows.Forms.Message&amp; m) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ToolStrip.WndProc (System.Windows.Forms.Message&amp;
</I>&gt;<i> m) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.ToolStripDropDown.WndProc
</I>&gt;<i> (System.Windows.Forms.Message&amp; m) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.Control+ControlWindowTarget.OnMessage
</I>&gt;<i> (System.Windows.Forms.Message&amp; m) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.Control+ControlNativeWindow.WndProc
</I>&gt;<i> (System.Windows.Forms.Message&amp; m) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i>   at System.Windows.Forms.NativeWindow.WndProc (IntPtr hWnd, Msg msg, IntPtr
</I>&gt;<i> wParam, IntPtr lParam) [0x00000] in &lt;filename unknown&gt;:0 
</I>&gt;<i> 
</I>&gt;<i> FYI the code I used is;
</I>&gt;<i> 
</I>&gt;<i>     public byte[] Sign(HashType hashType, Stream stream)
</I>&gt;<i>     {
</I>&gt;<i>       switch (hashType)
</I>&gt;<i>       {
</I>&gt;<i>         case HashType.MD5:
</I>&gt;<i>         {
</I>&gt;<i>           MD5 md5 = new MD5CryptoServiceProvider();
</I>&gt;<i>           byte[] hash = md5.ComputeHash(stream);
</I>&gt;<i> 
</I>&gt;<i>           return key.SignHash(hash, CryptoConfig.MapNameToOID(&quot;MD5&quot;));
</I>&gt;<i>         }
</I>&gt;<i>         case HashType.SHA512:
</I>&gt;<i>         {
</I>&gt;<i>           SHA512 shaM = new SHA512Managed();
</I>&gt;<i>           byte[] hash = shaM.ComputeHash(stream);
</I>&gt;<i> 
</I>&gt;<i>           return key.SignHash(hash, CryptoConfig.MapNameToOID(&quot;SHA512&quot;));
</I>&gt;<i>         }
</I>&gt;<i>       }
</I>&gt;<i> 
</I>&gt;<i>       return null;
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i> Any feedback is appreciated.
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> 
</I>&gt;<i> Jeremy
</I>&gt;<i> 
</I>

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="046417.html">[Mono-list] RSA with SHA512 hash
</A></li>
	<LI>Next message: <A HREF="046422.html">[Mono-list] RSA with SHA512 hash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46418">[ date ]</a>
              <a href="thread.html#46418">[ thread ]</a>
              <a href="subject.html#46418">[ subject ]</a>
              <a href="author.html#46418">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
