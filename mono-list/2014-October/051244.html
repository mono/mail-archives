<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Trouble establishing client authenticated ssl connection to ActiveMQ using NMS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Trouble%20establishing%20client%20authenticated%20ssl%0A%20connection%20to%20ActiveMQ%20using%20NMS&In-Reply-To=%3C51616C8220FD35478623BFBF8B081AFA01F137A7%40PDXMB03.tripwire.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="051243.html">
   <LINK REL="Next"  HREF="051245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Trouble establishing client authenticated ssl connection to ActiveMQ using NMS</H1>
    <B>Brian Cole</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Trouble%20establishing%20client%20authenticated%20ssl%0A%20connection%20to%20ActiveMQ%20using%20NMS&In-Reply-To=%3C51616C8220FD35478623BFBF8B081AFA01F137A7%40PDXMB03.tripwire.com%3E"
       TITLE="[Mono-list] Trouble establishing client authenticated ssl connection to ActiveMQ using NMS">bcole at tripwire.com
       </A><BR>
    <I>Thu Oct  2 21:54:19 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="051243.html">[Mono-list] Help! Stuck in solution screen
</A></li>
        <LI>Next message: <A HREF="051245.html">[Mono-list] Trouble establishing client authenticated ssl connection to ActiveMQ using NMS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51244">[ date ]</a>
              <a href="thread.html#51244">[ thread ]</a>
              <a href="subject.html#51244">[ subject ]</a>
              <a href="author.html#51244">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am new to this list so I apologize if this post is off topic.

I am a .Net engineer working on a windows application. I am experimenting with getting our code running on Mono to expose some of our services to teams working on non-windows platforms. We use ActiveMQ for messaging and our windows application connects to ActiveMQ using the Apache.NMS.ActiveMQ library. I am trying to create a client authenticated ssl connection to ActiveMQ. The connection string I am using is

activemq:<A HREF="ssl://ActiveMQServer:61616?transport.UseLogging=true&amp;amp;transport.clientCertSubject=CN%3DMonoCert">ssl://ActiveMQServer:61616?transport.UseLogging=true&amp;transport.clientCertSubject=CN%3DMonoCert</A>

The cert named in the connection string was created locally on the box using OpenSSL and imported to the My trust store using certmgr. I have this same cert imported into the Personal folder on my windows box and the very same code with the same connection string running on windows successfully creates the connection. When I attempt to create the connection with Mono the following exception occurs

Apache.NMS.NMSException: Could not connect to broker URL: <A HREF="ssl://ActiveMQServer:61616/?transport.uselogging=true&amp;transport.clientcertsubject=CN=MonoCert.">ssl://ActiveMQServer:61616/?transport.uselogging=true&amp;transport.clientcertsubject=CN=MonoCert.</A> Reason: The authentication or decryption has failed. ---&gt; System.IO.IOException: The authentication or decryption has failed. ---&gt; System.IO.IOException: The authentication or decryption has failed. ---&gt; Mono.Security.Protocol.Tls.TlsException: The authentication or decryption has failed.
  at Mono.Security.Protocol.Tls.RecordProtocol.ProcessAlert (AlertLevel alertLevel, AlertDescription alertDesc) [0x00000] in &lt;filename unknown&gt;:0
  at Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback (IAsyncResult asyncResult) [0x00000] in &lt;filename unknown&gt;:0
  --- End of inner exception stack trace ---
  at Mono.Security.Protocol.Tls.SslClientStream.EndNegotiateHandshake (IAsyncResult result) [0x00000] in &lt;filename unknown&gt;:0
  at Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback (IAsyncResult asyncResult) [0x00000] in &lt;filename unknown&gt;:0
  --- End of inner exception stack trace ---
  at Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback (IAsyncResult asyncResult) [0x00000] in &lt;filename unknown&gt;:0
  --- End of inner exception stack trace ---
  at Apache.NMS.ActiveMQ.ConnectionFactory.CreateActiveMQConnection (System.String userName, System.String password) [0x00000] in &lt;filename unknown&gt;:0
  at Apache.NMS.ActiveMQ.ConnectionFactory.CreateActiveMQConnection () [0x00000] in &lt;filename unknown&gt;:0
  at Apache.NMS.ActiveMQ.ConnectionFactory.CreateConnection () [0x00000] in &lt;filename unknown&gt;:0
  at Apache.NMS.NMSConnectionFactory.CreateConnection () [0x00000] in &lt;filename unknown&gt;:0
  at Tlc.ComponentInfrastructure.ActiveMQManager.StartActiveMQ () [0x00000] in &lt;filename unknown&gt;:0

I would really appreciate some suggestions on how to fix this problem,

Thanks a lot
Brian Cole
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-list/attachments/20141002/159f59d0/attachment.html">http://lists.ximian.com/pipermail/mono-list/attachments/20141002/159f59d0/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="051243.html">[Mono-list] Help! Stuck in solution screen
</A></li>
	<LI>Next message: <A HREF="051245.html">[Mono-list] Trouble establishing client authenticated ssl connection to ActiveMQ using NMS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51244">[ date ]</a>
              <a href="thread.html#51244">[ thread ]</a>
              <a href="subject.html#51244">[ subject ]</a>
              <a href="author.html#51244">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
