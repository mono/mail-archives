<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono-list Digest, Vol 28, Issue 14
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono-list%20Digest%2C%20Vol%2028%2C%20Issue%2014&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035957.html">
   <LINK REL="Next"  HREF="035924.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono-list Digest, Vol 28, Issue 14</H1>
    <B>Ashish Goyal</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono-list%20Digest%2C%20Vol%2028%2C%20Issue%2014&In-Reply-To="
       TITLE="[Mono-list] Mono-list Digest, Vol 28, Issue 14">agoyal at transitchicago.com
       </A><BR>
    <I>Fri Aug 10 11:37:07 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035957.html">[Mono-list] C# AVI player
</A></li>
        <LI>Next message: <A HREF="035924.html">[Mono-list] Mono-list Digest, Vol 28, Issue 14
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35921">[ date ]</a>
              <a href="thread.html#35921">[ thread ]</a>
              <a href="subject.html#35921">[ subject ]</a>
              <a href="author.html#35921">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Rolf,

I am using apache integrated with mono 2.0. I am loading my SUN One asp
pages thru' browser.

Following is an example of  my source code:

&lt;!-- %@LANGUAGE=&quot;VBSCRIPT&quot;%--&gt;
&lt;!--#include file=&quot;Connections/cpc1.asp&quot; --&gt;
&lt;%
Sub arrow()
  If ((rail_current_month.Fields.Item(&quot;CHANGE&quot;).Value)&lt;0) Then %&gt; &lt;img
src=&quot;images/down_arrow.gif&quot; width=&quot;7&quot; height=&quot;7&quot;&gt;&lt;%
    Else If ((rail_current_month.Fields.Item(&quot;CHANGE&quot;).Value)&gt;=0) Then %&gt;
&lt;img src=&quot;images/up_arrow.gif&quot; width=&quot;7&quot; height=&quot;
7&quot;&gt;&lt;%
    Else If ((rail_current_month.Fields.Item(&quot;CHANGE&quot;).Value)=0.00) Then %&gt;
&amp;nbsp;&lt;%
         Else %&gt;&amp;nbsp;&lt;%
    End If
    End If
    End If
End Sub

Sub arrow2()
  If ((rail_current_month.Fields.Item(&quot;CHANGE2&quot;).Value)&lt;=-0.01) Then %&gt; &lt;img
src=&quot;images/down_arrow.gif&quot; width=&quot;7&quot; height=&quot;
7&quot;&gt;&lt;%
    Else If ((rail_current_month.Fields.Item(&quot;CHANGE2&quot;).Value)&gt;=0.01) Then
%&gt; &lt;img src=&quot;images/up_arrow.gif&quot; width=&quot;7&quot; heig
ht=&quot;7&quot;&gt;&lt;%
    Else If ((rail_current_month.Fields.Item(&quot;CHANGE2&quot;).Value)=0.00) Then %&gt;
&amp;nbsp;&lt;%
         Else %&gt;&amp;nbsp;&lt;%
    End If
    End If
    End If
End Sub

Dim rail_current_month
Dim rail_current_month_numRows

Set rail_current_month = Server.CreateObject(&quot;ADODB.Recordset&quot;)
rail_current_month.ActiveConnection = MM_cpc1_STRING
rail_current_month.Source = &quot;select * from rail_current_month&quot;
rail_current_month.CursorType = 0
rail_current_month.CursorLocation = 2
rail_current_month.LockType = 1
rail_current_month.Open()

rail_current_month_numRows = 0
%&gt;
&lt;%
' *** Go To Record and Move To Record: create strings for maintaining URL
and Form parameters

' create the list of parameters which should not be maintained
MM_removeList = &quot;&amp;index=&quot;
If (MM_paramName &lt;&gt; &quot;&quot;) Then MM_removeList = MM_removeList &amp; &quot;&amp;&quot; &amp;
MM_paramName &amp; &quot;=&quot;
MM_keepURL=&quot;&quot;:MM_keepForm=&quot;&quot;:MM_keepBoth=&quot;&quot;:MM_keepNone=&quot;&quot;

' add the URL parameters to the MM_keepURL string
For Each Item In Request.QueryString
  NextItem = &quot;&amp;&quot; &amp; Item &amp; &quot;=&quot;
  If (InStr(1,MM_removeList,NextItem,1) = 0) Then
    MM_keepURL = MM_keepURL &amp; NextItem &amp;
Server.URLencode(Request.QueryString(Item))
  End If
Next

' add the Form variables to the MM_keepForm string
For Each Item In Request.Form
  NextItem = &quot;&amp;&quot; &amp; Item &amp; &quot;=&quot;
  If (InStr(1,MM_removeList,NextItem,1) = 0) Then
    MM_keepForm = MM_keepForm &amp; NextItem &amp;
Server.URLencode(Request.Form(Item))
  End If
Next

' create the Form + URL string and remove the intial '&amp;' from each of the
strings
MM_keepBoth = MM_keepURL &amp; MM_keepForm
if (MM_keepBoth &lt;&gt; &quot;&quot;) Then MM_keepBoth = Right(MM_keepBoth,
Len(MM_keepBoth) - 1)
if (MM_keepURL &lt;&gt; &quot;&quot;)  Then MM_keepURL  = Right(MM_keepURL,
Len(MM_keepURL) - 1)
if (MM_keepForm &lt;&gt; &quot;&quot;) Then MM_keepForm = Right(MM_keepForm,
Len(MM_keepForm) - 1)

' a utility function used for adding additional parameters to these strings
Function MM_joinChar(firstItem)
  If (firstItem &lt;&gt; &quot;&quot;) Then
    MM_joinChar = &quot;&amp;&quot;
  Else
    MM_joinChar = &quot;&quot;
  End If
End Function
%&gt;
&lt;%
Dim Repeat1__numRows
Dim Repeat1__index

Repeat1__numRows = -1
Repeat1__index = 0
rail_current_month_numRows = rail_current_month_numRows + Repeat1__numRows
%&gt;
&lt;%
Dim daysapart
Dim daysapart_numRows

Set daysapart = Server.CreateObject(&quot;ADODB.Recordset&quot;)
daysapart.ActiveConnection = MM_cpc1_STRING
daysapart.Source = &quot;select * from rail_current_daysapart&quot;
daysapart.CursorType = 0
daysapart.CursorLocation = 2
daysapart.LockType = 1
daysapart.Open()

daysapart_numRows = 0
%&gt;
&lt;!-- Begin rail_current_month --&gt;
&lt;% If Not rail_current_month.EOF Or Not rail_current_month.BOF Then %&gt;
&lt;div align=&quot;center&quot;&gt;
  &lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; class=&quot;menuborder&quot;
width=&quot;100%&quot;&gt;
    &lt;tr&gt;
      &lt;td background=&quot;images/title_bg.jpg&quot;&gt;&lt;img
src=&quot;images/left_curve.gif&quot;&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;&lt;b&gt;Current
        Rail Ridership&lt;/b&gt;&lt;/font&gt; &lt;font class=&quot;navigation&quot;
color=&quot;#FFFFFF&quot;&gt;(&lt;%=(daysapart.Fields.Item(&quot;RAIL_CURR_SDATE&quot;).Va
lue)%&gt; to
&lt;%=(daysapart.Fields.Item(&quot;RAIL_CURR_EDATE&quot;).Value)%&gt;)&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs
p;&amp;nbsp;&lt;a href=&quot;rides/danryan.asp&quot;&gt;&lt;
font color=&quot;#FFAAAA&quot;&gt;Dan
        Ryan Effects&lt;/font&gt;&lt;/a&gt;&lt;/font&gt;&lt;/td&gt;
      &lt;td width=3
                background=&quot;images/new/topright2.gif&quot;&gt;&lt;img
                  height=0
                  src=&quot;images/new/spacer.gif&quot;
                width=3&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
  &lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; class=&quot;main_nav&quot;&gt;
    &lt;tr height=&quot;20&quot;&gt;
      &lt;td width=&quot;8&quot;&gt;&lt;/td&gt;
      &lt;td width=&quot;*&quot; class=&quot;navigation&quot;&gt;Shows current month only, not the
latest
        official month &lt;em&gt;&lt;br&gt;
        &lt;/em&gt;&lt;/td&gt;
      &lt;td width=3
                background=&quot;images/new/right.gif&quot;&gt;&lt;img
                  height=0
                  src=&quot;images/new/spacer.gif&quot;
                width=3&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
  &lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; class=&quot;main_table&quot;&gt;
    &lt;tr height=&quot;20&quot;&gt;
      &lt;td&gt;&lt;table cellspacing=1 cellpadding=1 width=&quot;430&quot; align=center
border=0&gt;
          &lt;tr&gt;
            &lt;td align=&quot;left&quot; valign=&quot;bottom&quot; bgcolor=&quot;#FFFFFF&quot;
class=&quot;navigation&quot;&gt;&lt;strong&gt;Day&lt;br&gt;
              Types&lt;/strong&gt; (&lt;a href=&quot;#&quot; onMouseOver=&quot;doTooltip(event,
officialTip)&quot; onMouseOut=&quot;hideTip()&quot;&gt;+&lt;/a&gt;)&lt;/td&gt;
            &lt;td align=&quot;right&quot; valign=&quot;bottom&quot; bgcolor=&quot;#FFFFFF&quot;
class=&quot;navigation&quot;&gt;&lt;strong&gt;This
              Year&lt;/strong&gt;&lt;/td&gt;
            &lt;td align=&quot;right&quot; valign=&quot;bottom&quot; bgcolor=&quot;#FFFFFF&quot;
class=&quot;navigation&quot;&gt;&lt;strong&gt;Last
              Year*&lt;/strong&gt;&lt;/td&gt;
            &lt;td align=&quot;right&quot; valign=&quot;bottom&quot; bgcolor=&quot;#FFFFFF&quot;
class=&quot;navigation&quot;&gt;&lt;strong&gt;Change&lt;/strong&gt;&lt;/td&gt;
            &lt;td colspan=&quot;2&quot; align=&quot;right&quot; valign=&quot;bottom&quot;
class=&quot;navigation&quot;&gt;&lt;strong&gt;&lt;em&gt;Last
              Year&lt;br&gt;
              Entire Month&lt;/em&gt;&lt;/strong&gt;&lt;/td&gt;
          &lt;/tr&gt;
          &lt;%
While ((Repeat1__numRows &lt;&gt; 0) AND (NOT rail_current_month.EOF))
%&gt;
          &lt;tr&lt;%
                bgImage = 0
        RecordCounter = RecordCounter + 1
        If RecordCounter Mod 2 = 1 Then
                bgImage = &quot;background=images/t_bg.jpg&quot;
                ELSE
                bgImage = &quot;background=&quot;
        End If
        %&gt;&gt;
            &lt;%
        dayType = rail_current_month.Fields.Item(&quot;DAY&quot;).Value
        IF dayType = &quot;Weekdays&quot; THEN
        dayType = &quot;&lt;a
href=<A HREF="http://planning/rail_sys_rolling_averages.asp?daytype=W&amp;VTF=12">http://planning/rail_sys_rolling_averages.asp?daytype=W&amp;VTF=12</A>&gt;Wkday&lt;/a
&gt;<i>&quot;
</I>        ELSE
        IF dayType = &quot;Saturdays&quot; THEN dayType = &quot;&lt;a
href=<A HREF="http://planning/rail_sys_rolling_averages.asp?daytype=A&amp;VTF=12">http://planning/rail_sys_rolling_averages.asp?daytype=A&amp;VTF=12</A>&gt;Sat
&lt;/a&gt;&quot; END IF
        IF dayType = &quot;Sunday/Holidays&quot; THEN dayType = &quot;&lt;a
href=<A HREF="http://planning/rail_sys_rolling_averages.asp?daytype=U&amp;VTF=">http://planning/rail_sys_rolling_averages.asp?daytype=U&amp;VTF=</A>
12&gt;Sun/Hol&lt;/a&gt;&quot; END IF
        END IF
    %&gt;
            &lt;td align=&quot;left&quot; class=&quot;navigation&quot;
&lt;%=bgImage%&gt;&gt;&lt;%=dayType%&gt;&lt;/td&gt;
            &lt;td align=&quot;right&quot; class=&quot;navigation&quot;
&lt;%=bgImage%&gt;&gt;&lt;%=FormatNumber((rail_current_month.Fields.Item(&quot;THISYEAR&quot;).V
alue), 0, -2, -2, -2)%&gt;&lt;/td&gt;
            &lt;td align=&quot;right&quot; class=&quot;navigation&quot;
&lt;%=bgImage%&gt;&gt;&lt;%=FormatNumber((rail_current_month.Fields.Item(&quot;LASTYEAR&quot;).V
alue), 0, -2, -2, -2)%&gt;&lt;/td&gt;
            &lt;td align=&quot;right&quot; class=&quot;navigation&quot;
&lt;%=bgImage%&gt;&gt;&lt;%=FormatPercent((rail_current_month.Fields.Item(&quot;CHANGE&quot;).Va
lue))%&gt;&lt;% call arrow() %&gt;&lt;/td&gt;
            &lt;td align=&quot;right&quot; bgcolor=&quot;#f8f8f8&quot; class=&quot;navigation&quot;
&lt;%=bgImage%&gt;&gt;&lt;em&gt;&lt;%=FormatNumber((rail_current_month.Fie
lds.Item(&quot;LASTYEAR2&quot;).Value), 0, -2, -2, -2)%&gt;&lt;/em&gt;&lt;/td&gt;
            &lt;td align=&quot;right&quot; bgcolor=&quot;#f8f8f8&quot; class=&quot;navigation&quot;
&lt;%=bgImage%&gt;&gt;&lt;em&gt;&lt;%=FormatPercent((rail_current_month.Fi
elds.Item(&quot;CHANGE2&quot;).Value))%&gt;&lt;/em&gt;&lt;% call arrow2() %&gt;&lt;/td&gt;
          &lt;/tr&gt;
          &lt;%
  Repeat1__index=Repeat1__index+1
  Repeat1__numRows=Repeat1__numRows-1
  rail_current_month.MoveNext()
Wend
%&gt;
          &lt;tr&gt;
            &lt;td colspan=6 class=&quot;navigation&quot;&gt;&amp;nbsp;&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td colspan=6 class=&quot;navigation&quot;&gt;Figures are station entries
only; rail-to-rail transfers are not included.&lt;br&gt;
&lt;em&gt;*Last Year is an average through
              the same number of days as This Year &lt;br&gt;
              &amp;nbsp;All monthly totals are adjusted for calendar
differences&lt;/em&gt;&lt;/td&gt;
          &lt;/tr&gt;
        &lt;/table&gt;&lt;/td&gt;
      &lt;td width=3
                background=&quot;images/new/right.gif&quot;&gt;&lt;img
                  height=0
                  src=&quot;images/new/spacer.gif&quot;
                width=3&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
  &lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; bgcolor=&quot;#FFFFFF&quot;&gt;
    &lt;tr&gt;
      &lt;td width=14&gt;&lt;img height=3
                  src=&quot;images/new/bottomleft.gif&quot;
                  width=14&gt;&lt;/td&gt;
      &lt;td width=100%
                background=&quot;images/new/bottom.gif&quot;&gt;&lt;img
                  height=3
                  src=&quot;images/new/spacer.gif&quot;
                width=0&gt;&lt;/td&gt;
      &lt;td width=3&gt;&lt;img height=3
                  src=&quot;images/new/bottomright.gif&quot;
                  width=3&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;% End If%&gt;
&lt;!-- End rail_current_month --&gt;
&lt;%
rail_current_month.Close()
Set rail_current_month = Nothing
daysapart.Close()
Set daysapart = Nothing
%&gt;


Ashish


</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035957.html">[Mono-list] C# AVI player
</A></li>
	<LI>Next message: <A HREF="035924.html">[Mono-list] Mono-list Digest, Vol 28, Issue 14
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35921">[ date ]</a>
              <a href="thread.html#35921">[ thread ]</a>
              <a href="subject.html#35921">[ subject ]</a>
              <a href="author.html#35921">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
