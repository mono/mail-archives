<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Oracle/OCI Thread Abort?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Oracle/OCI%20Thread%20Abort%3F&In-Reply-To=11955212.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035848.html">
   <LINK REL="Next"  HREF="035847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Oracle/OCI Thread Abort?</H1>
    <B>Daniel Morgan</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Oracle/OCI%20Thread%20Abort%3F&In-Reply-To=11955212.post%40talk.nabble.com"
       TITLE="[Mono-list] Oracle/OCI Thread Abort?">monodanmorg at yahoo.com
       </A><BR>
    <I>Thu Aug  2 12:31:28 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="035848.html">[Mono-list] Oracle/OCI Thread Abort?
</A></li>
        <LI>Next message: <A HREF="035847.html">[Mono-list] Is mono suitable for building an XML-RPC Sever?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35858">[ date ]</a>
              <a href="thread.html#35858">[ thread ]</a>
              <a href="subject.html#35858">[ subject ]</a>
              <a href="author.html#35858">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I don't know the answer to OCI.  However, I do know
the Oracle provider is NOT thread-safe.

Is the oracle client provider in microsoft .net
framework thread-safe?

If yes, any recommendations on how to make the
provider thread-safe?  


--- cabes &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">jason at jasoncable.com</A>&gt; wrote:

&gt;<i> 
</I>&gt;<i> Greetings!  I'm running mono 1.2.4 that was compiled
</I>&gt;<i> from source on OpenSuSE
</I>&gt;<i> 10.2.  I have the Oracle Instant Client version
</I>&gt;<i> 10.2.0.3.  I am getting the
</I>&gt;<i> following exceptions after calling several stored
</I>&gt;<i> procedures in Oracle.  It
</I>&gt;<i> will get thrown after 10 or so sproc calls.  I'm
</I>&gt;<i> thinking it might be an
</I>&gt;<i> issue with OCI not being thread-safe.  I've tried
</I>&gt;<i> with connection pooling on
</I>&gt;<i> and off with the same result.  I'm running this from
</I>&gt;<i> a console app.  I'd
</I>&gt;<i> appreciate any ideas.
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Jason
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> WITH CONN. POOLING:
</I>&gt;<i> 
</I>&gt;<i> trying to GetStatementHandle
</I>&gt;<i> connectionState=Open
</I>&gt;<i> connectionString=Data Source=FOO;User
</I>&gt;<i> Id=BAR;Pooling=true;Min Pool
</I>&gt;<i> Size=10;Max Pool Size=50;Connection Lifetime=20;;
</I>&gt;<i> connected=True
</I>&gt;<i> 
</I>&gt;<i> Unhandled Exception:
</I>&gt;<i> TrueBaseline.DataAccess.DAL.Facades.DALException:
</I>&gt;<i> Unable to derive parameters. ---&gt; System.Exception:
</I>&gt;<i> Could not allocate new
</I>&gt;<i> OCI Handle of type Statement
</I>&gt;<i>   at System.Data.OracleClient.Oci.OciHandle.Allocate
</I>&gt;<i> (OciHandleType type)
</I>&gt;<i> [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>System.Data.OracleClient.OracleCommand.GetStatementHandle
&gt;<i> () [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>System.Data.OracleClient.OracleCommand.ExecuteNonQuery
&gt;<i> () [0x00000]
</I>&gt;<i>   at (wrapper remoting-invoke-with-check)
</I>&gt;<i>
</I>System.Data.OracleClient.OracleCommand:ExecuteNonQuery
&gt;<i> ()
</I>&gt;<i>   at
</I>&gt;<i> System.Data.OracleClient.OracleCommand.ResolveName
</I>&gt;<i> (System.String
</I>&gt;<i> nameToResolve, System.String&amp; schema, System.String&amp;
</I>&gt;<i> part1, System.String&amp;
</I>&gt;<i> part2, System.String&amp; dblink) [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>System.Data.OracleClient.OracleCommand.DeriveParametersFromStoredProcedure
&gt;<i> (System.String sproc_name) [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>System.Data.OracleClient.OracleCommand.DeriveParameters
&gt;<i> () [0x00000]
</I>&gt;<i>   at (wrapper remoting-invoke-with-check)
</I>&gt;<i>
</I>System.Data.OracleClient.OracleCommand:DeriveParameters
&gt;<i> ()
</I>&gt;<i>   at
</I>&gt;<i>
</I>System.Data.OracleClient.OracleCommandBuilder.DeriveParameters
&gt;<i> (System.Data.OracleClient.OracleCommand command)
</I>&gt;<i> [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>TrueBaseline.DataAccess.DAL.Facades.OracleClient.Command.set_CommandType
&gt;<i> (CommandType value) [0x00000] --- End of inner
</I>&gt;<i> exception stack trace ---
</I>&gt;<i> 
</I>&gt;<i>   at
</I>&gt;<i>
</I>TrueBaseline.DataAccess.DAL.Facades.OracleClient.Command.set_CommandType
&gt;<i> (CommandType value) [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>TrueBaseline.DataAccess.DataApplicationBlock.TrueOmf.DataAccessLayer.OracleClient.StoredProcedureProvider.GetCommandWrapper
&gt;<i> (IDatabase database, System.String commandName,
</I>&gt;<i> Boolean useStoredProcedure)
</I>&gt;<i> [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>TrueBaseline.DataAccess.DataApplicationBlock.TrueOmf.DataAccessLayer.OracleClient.OracleEventMessageFunctionalObjectMethodMapProviderBase.GetBySolutionDomainIDName
&gt;<i> (ITransactionManager transactionManager, Guid
</I>&gt;<i> solutionDomainID,
</I>&gt;<i> System.String name, Int32 start, Int32 pageLength,
</I>&gt;<i> System.Int32&amp; count)
</I>&gt;<i> [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>TrueBaseline.DataAccess.DataApplicationBlock.TrueOmf.DataAccessLayer.Bases.EventMessageFunctionalObjectMethodMapProviderBaseCore.GetBySolutionDomainIDName
&gt;<i> (Guid solutionDomainID, System.String name, Int32
</I>&gt;<i> start, Int32 pageLength,
</I>&gt;<i> System.Int32&amp; count) [0x00000]
</I>&gt;<i>   at
</I>&gt;<i>
</I>TrueBaseline.DataAccess.DataApplicationBlock.TrueOmf.DataAccessLayer.Bases.EventMessageFunctionalObjectMethodMapProviderBaseCore.GetBySolutionDomainIDName
&gt;<i> (Guid solutionDomainID, System.String name)
</I>&gt;<i> [0x00000]
</I>&gt;<i>   at testoracle.MainClass.Main (System.String[]
</I>&gt;<i> args) [0x00000]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> WITHOUT CONN POOLING:
</I>&gt;<i> 
</I>&gt;<i> trying to GetStatementHandle
</I>&gt;<i> connectionState=Open
</I>&gt;<i> connectionString=Data Source=FOO;User
</I>&gt;<i> Id=BAR;Pooling=false;Connection
</I>&gt;<i> Lifetime=20;;
</I>&gt;<i> connected=True  mono [0x8156dbf]
</I>&gt;<i>         mono [0x8120e48]
</I>&gt;<i>         [0xb7eef440]
</I>&gt;<i>         /usr/lib/libclntsh.so(OCIErrorGet+0xa1)
</I>&gt;<i> [0xb65407fb]
</I>&gt;<i>         [0xb167822f]
</I>&gt;<i>         [0xb16781c5]
</I>&gt;<i>         [0xb167807c]
</I>&gt;<i>         [0xb1677fd2]
</I>&gt;<i>         [0xb1677ed9]
</I>&gt;<i>         [0xb1677c38]
</I>&gt;<i>         [0xb197958c]
</I>&gt;<i>         [0xb1979531]
</I>&gt;<i>         [0xb1677b91]
</I>&gt;<i>         [0xb17873e9]
</I>&gt;<i>         [0xb197c45b]
</I>&gt;<i>         mono [0x816c965]
</I>&gt;<i>         mono [0x8111541]
</I>&gt;<i>         mono [0x816cb19]
</I>&gt;<i>         mono [0x80eb040]
</I>&gt;<i>         mono [0x8100b02]
</I>&gt;<i>         mono [0x8113d35]
</I>&gt;<i>         /lib/libpthread.so.0 [0xb7e15112]
</I>&gt;<i>         /lib/libc.so.6(clone+0x5e) [0xb7d7b2ee]
</I>&gt;<i> 
</I>&gt;<i> got StatementHandle
</I>&gt;<i> hasRows=True
</I>&gt;<i> parameter count: 3
</I>&gt;<i> 
</I>&gt;<i> Debug info from gdb:
</I>&gt;<i> 
</I>&gt;<i> Using host libthread_db library
</I>&gt;<i> &quot;/lib/libthread_db.so.1&quot;.
</I>&gt;<i> [Thread debugging using libthread_db enabled]
</I>&gt;<i> [New Thread -1211385120 (LWP 9900)]
</I>&gt;<i> [New Thread -1219863664 (LWP 9902)]
</I>&gt;<i> [New Thread -1219781744 (LWP 9901)]
</I>&gt;<i> 0xb7eef410 in ?? ()
</I>&gt;<i>   3 Thread -1219781744 (LWP 9901)  0xb7eef410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   2 Thread -1219863664 (LWP 9902)  0xb7eef410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   1 Thread -1211385120 (LWP 9900)  0xb7eef410 in ??
</I>&gt;<i> ()
</I>&gt;<i> 
</I>&gt;<i> Thread 3 (Thread -1219781744 (LWP 9901)):
</I>&gt;<i> #0  0xb7eef410 in ?? ()
</I>&gt;<i> #1  0xb74b93a8 in ?? ()
</I>&gt;<i> #2  0x081f8ff4 in ?? ()
</I>&gt;<i> #3  0x00000000 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Thread 2 (Thread -1219863664 (LWP 9902)):
</I>&gt;<i> #0  0xb7eef410 in ?? ()
</I>&gt;<i> #1  0xb74a4338 in ?? ()
</I>&gt;<i> #2  0x00000000 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Thread 1 (Thread -1211385120 (LWP 9900)):
</I>&gt;<i> #0  0xb7eef410 in ?? ()
</I>&gt;<i> #1  0xbfe91d38 in ?? ()
</I>&gt;<i> #2  0x00000810 in ?? ()
</I>&gt;<i> #3  0x0873a5c6 in ?? ()
</I>&gt;<i> #4  0xb7e1c02b in __read_nocancel () from
</I>&gt;<i> /lib/libpthread.so.0
</I>&gt;<i> #5  0xb676080f in snttread () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #6  0xb675dce1 in nttrd () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #7  0xb66b0bc0 in nsprecv () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #8  0xb66b4c8b in nsrdr () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #9  0xb66943ee in nsdo () from /usr/lib/libclntsh.so
</I>&gt;<i> #10 0xb6693e97 in nsbrecv () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #11 0xb66c8567 in nioqrc () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #12 0xb67eacbf in ttcdrv () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #13 0xb66cfbc8 in nioqwa () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #14 0xb653b618 in upirtrc () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #15 0xb64b05f6 in kpurcsc () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #16 0xb64648b8 in kpuexecv8 () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #17 0xb6466ec4 in kpuexec () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #18 0xb65401b6 in OCIStmtExecute () from
</I>&gt;<i> /usr/lib/libclntsh.so
</I>&gt;<i> #19 0xb1ad2f8a in ?? ()
</I>&gt;<i> #20 0x087178b0 in ?? ()
</I>&gt;<i> #21 0x0872d354 in ?? ()
</I>&gt;<i> #22 0x08716c44 in ?? ()
</I>&gt;<i> #23 0x00000000 in ?? ()
</I>&gt;<i> #0  0xb7eef410 in ?? ()
</I>&gt;<i> 
</I>=== message truncated ===



       
____________________________________________________________________________________
Pinpoint customers who are looking for what you sell. 
<A HREF="http://searchmarketing.yahoo.com/">http://searchmarketing.yahoo.com/</A>
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035848.html">[Mono-list] Oracle/OCI Thread Abort?
</A></li>
	<LI>Next message: <A HREF="035847.html">[Mono-list] Is mono suitable for building an XML-RPC Sever?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35858">[ date ]</a>
              <a href="thread.html#35858">[ thread ]</a>
              <a href="subject.html#35858">[ subject ]</a>
              <a href="author.html#35858">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
