<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] on connecting to Sybase
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wzfg%40singtel.com.sg">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011295.html">
   <LINK REL="Next"  HREF="011320.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] on connecting to Sybase
   </H1>
    <B>wzfg
    </B> 
    <A HREF="mailto:wzfg%40singtel.com.sg"
       TITLE="[Mono-list] on connecting to Sybase">wzfg@singtel.com.sg
       </A><BR>
    <I>Fri, 17 Jan 2003 08:37:00 +0800</I>
    <P><UL>
        <LI> Previous message: <A HREF="011295.html">[Mono-list] on connecting to Sybase
</A></li>
        <LI> Next message: <A HREF="011320.html">[Mono-list] XSP Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11321">[ date ]</a>
              <a href="thread.html#11321">[ thread ]</a>
              <a href="subject.html#11321">[ subject ]</a>
              <a href="author.html#11321">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>After I changed to:

string constr =
    &quot;server=10.34.7.41;&quot;
    +&quot;user id=rbsdbo;&quot;
    +&quot;password=rbsdbo;&quot;
    +&quot;database=ccb;&quot;;

Then I got different exception  as following:

D:\exdir\mono&gt;monooledb

Unhandled Exception: System.Net.Sockets.SocketException: No connection could
be
made because the target machine actively refused it
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at Mono.Data.Tds.Protocol.TdsComm..ctor(String dataSource, Int32 port,
Int32
packetSize, Int32 timeout, TdsVersion tdsVersion)
   at Mono.Data.Tds.Protocol.Tds..ctor(String dataSource, Int32 port, Int32
pack
etSize, Int32 timeout, TdsVersion tdsVersion)
   at Mono.Data.Tds.Protocol.Tds50..ctor(String server, Int32 port, Int32
packet
Size, Int32 timeout)
   at Mono.Data.SybaseClient.SybaseConnectionPool.AllocateConnection()
   at Mono.Data.SybaseClient.SybaseConnection.Open()
   at Sample.Main()

So I think I should wait the new release.
Thanks a lot.

----- Original Message -----
From: &quot;Daniel Morgan&quot; &lt;<A HREF="mailto:danmorg@sc.rr.com">danmorg@sc.rr.com</A>&gt;
To: &quot;Rodrigo Moya&quot; &lt;<A HREF="mailto:rodrigo@ximian.com">rodrigo@ximian.com</A>&gt;; &quot;wzfg&quot; &lt;<A HREF="mailto:wzfg@singtel.com.sg">wzfg@singtel.com.sg</A>&gt;
Cc: &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
Sent: Friday, January 17, 2003 2:06 AM
Subject: RE: [Mono-list] on connecting to Sybase


None of Mono's data providers has ability for trusted_connections.
So, the connection string is wrong.  The port defaults to 1533.  I couldn't
find a way to set the port.

Maybe, you can set up your Sybase server to listen on 1533.  Or, you could
modify Mono.Data.SybaseClient source file SybaseConnection.cs to set the
port.  I'm sure Tim will take patches.

Anyways, try this connection string:

string constr =
    &quot;server=10.34.7.41;&quot;
    +&quot;user id=rbsdbo;&quot;
    +&quot;password=rbsdbo;&quot;
    +&quot;database=ccb;&quot;;

-----Original Message-----
From: <A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A> [mailto:<A HREF="mailto:mono-list-admin@ximian.com">mono-list-admin@ximian.com</A>]On
Behalf Of Rodrigo Moya
Sent: Thursday, January 16, 2003 9:25 AM
To: wzfg
Cc: <A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>
Subject: Re: [Mono-list] on connecting to Sybase


On Thu, 2003-01-16 at 08:53, wzfg wrote:
&gt;<i> Hi, Rodrigo Moya,
</I>&gt;<i> I am sorry for bothering you again.
</I>&gt;<i> I still can not connect the Sybase and hope your help.
</I>&gt;<i>
</I>&gt;<i> The scoure codes is as following:
</I>&gt;<i>
</I>&gt;<i> using System;
</I>&gt;<i> using System.Data;
</I>&gt;<i> using Mono.Data.SybaseClient;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> class Sample
</I>&gt;<i> {
</I>&gt;<i>   public static void Main()
</I>&gt;<i>   {
</I>&gt;<i>    string constr =
</I>&gt;<i>         &quot;server=10.34.7.41:5510;Trusted_Connection=true;&quot;
</I>&gt;<i>         +&quot;user id=rbsdbo;&quot;
</I>&gt;<i>         +&quot;password=rbsdbo;&quot;
</I>&gt;<i>         +&quot;database=ccb;&quot;
</I>&gt;<i>         +&quot;Provider=ADO.NET Provider;&quot;    //I don't know the provider's
</I>name.
&gt;<i>         ;
</I>&gt;<i>     SybaseConnection myConn = new SybaseConnection(constr);
</I>&gt;<i>
</I>&gt;<i>  SybaseCommand catCMD = new SybaseCommand(&quot;SELECT err_code,err_msg FROM
</I>&gt;<i> my_errmsg &quot;, myConn);
</I>&gt;<i>
</I>&gt;<i>     myConn.Open();
</I>&gt;<i>
</I>&gt;<i>  SybaseDataReader myReader = catCMD.ExecuteReader();
</I>&gt;<i>  try{
</I>&gt;<i>
</I>&gt;<i>       while(myReader.Read()){
</I>&gt;<i>          Console.WriteLine(&quot;\t{0}\t{1}&quot;, myReader.GetInt32(0),
</I>&gt;<i> myReader.GetString(1));
</I>&gt;<i>       }
</I>&gt;<i>  }finally{
</I>&gt;<i>       myReader.Close();
</I>&gt;<i>       myConn.Close();
</I>&gt;<i>      }
</I>&gt;<i>
</I>&gt;<i>   }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> Then I compile as following(No errors, just have 1 warnings):
</I>&gt;<i>
</I>&gt;<i> C:\exdir\mono&gt;mcs -lib:C:\mono-0.17\install\lib -debug+  -r:System.dll -r
</I>&gt;<i> :System.Data.dll -r:Mono.Data.SybaseClient.dll -out:monooledb.exe
</I>&gt;<i> monooledb.cs
</I>&gt;<i>
</I>&gt;<i> You can run mcs with 'monomcs' on .NET, instead of mono, too.
</I>&gt;<i>
</I>&gt;<i> ï»¿Internal() warning CS-0018: Cannot find any symbol writer
</I>&gt;<i> Compilation succeeded - 1 warning(s)
</I>&gt;<i>
</I>&gt;<i> Then run:
</I>&gt;<i> C:\exdir\mono&gt;monooledb
</I>&gt;<i>
</I>&gt;<i> Unhandled Exception: System.Net.Sockets.SocketException: No such host is
</I>&gt;<i> known
</I>&gt;<i>    at System.Net.Dns.GetHostByName(String hostName)
</I>&gt;<i>
</I>just guessing, but could it be that it is using the port number as part
of the hostname, and that's why it can't connect? I'm not sure if the
connection string is ok or not for the Sybase provider, so maybe Tim can
tell you if it's so or not.

cheers
--
Rodrigo Moya &lt;<A HREF="mailto:rodrigo@ximian.com">rodrigo@ximian.com</A>&gt;


_______________________________________________
Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011295.html">[Mono-list] on connecting to Sybase
</A></li>
	<LI> Next message: <A HREF="011320.html">[Mono-list] XSP Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11321">[ date ]</a>
              <a href="thread.html#11321">[ thread ]</a>
              <a href="subject.html#11321">[ subject ]</a>
              <a href="author.html#11321">[ author ]</a>
         </LI>
       </UL>
</body></html>
