<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Automatic Binding of Variables to Parameters in
 ADO.NET
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gonzalo%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011630.html">
   <LINK REL="Next"  HREF="011631.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Automatic Binding of Variables to Parameters in
 ADO.NET
   </H1>
    <B>Gonzalo Paniagua Javier
    </B> 
    <A HREF="mailto:gonzalo%40ximian.com"
       TITLE="[Mono-list] Automatic Binding of Variables to Parameters in
 ADO.NET">gonzalo@ximian.com
       </A><BR>
    <I>27 Jan 2003 14:47:09 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="011630.html">[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
</A></li>
        <LI> Next message: <A HREF="011631.html">[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11634">[ date ]</a>
              <a href="thread.html#11634">[ thread ]</a>
              <a href="subject.html#11634">[ subject ]</a>
              <a href="author.html#11634">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You can have the struct like:
public struct MyStruct
{
  [SQLInputValue]
  public int someNumber;
  [SQLOutputValue]
  public double someMonetaryValue;
  [SQlOutputValue]
  public DateTime someDataTime;
  [SqlOutputValue]
  public bool someBoolean;
}

SqlxxxValue also has a couple of constructors more, taking 1 and 2
strings.

public SqlxxxValue () (default value for columnName and fieldName is the
name of the field in the struct)

public SqlxxxValue (string columnName) (default value for fieldName is
either columnName or the name of the field in the struct at your
election)

public SqlxxxValue (string columnName, string fieldName)


Then in GetData you can substitute all occurrences of
MyStruct:field_name for all SqlInputValues.

Now, the pseudo-code for GetData:

public MyStruct GetData (IDbConnection dbconn, MyStruct input_st)
{
	1. Substitute all the :field_name by their values in input_st
	2. Substitute all output parameters using the provider's specific
syntax for output parameters and map them to the SqlOutputValues field
names.
	3. Retrieve the row and for each output column that has a mapping,
store the result in the struct field whose columnName matches.

	4. Voilà
}


Hope this helps.

Cheers.

-Gonzalo



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011630.html">[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
</A></li>
	<LI> Next message: <A HREF="011631.html">[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11634">[ date ]</a>
              <a href="thread.html#11634">[ thread ]</a>
              <a href="subject.html#11634">[ subject ]</a>
              <a href="author.html#11634">[ author ]</a>
         </LI>
       </UL>
</body></html>
