<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Performance / array access
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:piersh%40friskit.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011417.html">
   <LINK REL="Next"  HREF="011418.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Performance / array access
   </H1>
    <B>Piers Haken
    </B> 
    <A HREF="mailto:piersh%40friskit.com"
       TITLE="[Mono-list] Performance / array access">piersh@friskit.com
       </A><BR>
    <I>Sun, 19 Jan 2003 13:29:31 -0800</I>
    <P><UL>
        <LI> Previous message: <A HREF="011417.html">[Mono-list] Unable to compile the runtime
</A></li>
        <LI> Next message: <A HREF="011418.html">[Mono-list] The Mono Debugger 0.2.0 &quot;Boston&quot; has been released :-)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11416">[ date ]</a>
              <a href="thread.html#11416">[ thread ]</a>
              <a href="subject.html#11416">[ subject ]</a>
              <a href="author.html#11416">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------_=_NextPart_001_01C2C001.DACA076E
Content-Type: text/plain;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable

Also significant optimizations that MS does here are frame-pointer
omission and passing params in registers.

Tom, can you try your tests on MS with the following change: ?

-             for(int i=3D0; i&lt; size; i++)
---
+             for(int i=3D0; i&lt; array.Length; i++)

Piers.

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Tom Fransen [mailto:<A HREF="mailto:t.fransen@mailned.nl">t.fransen@mailned.nl</A>]=20
</I>&gt;<i> Sent: Sunday, January 19, 2003 8:02 AM
</I>&gt;<i> To: Mitchell Skinner
</I>&gt;<i> Cc: <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> Subject: RE: [Mono-list] Performance / array access
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> Hello all,
</I>&gt;<i>=20
</I>&gt;<i> Mitch, to come back on the issue of bound checking. I looked=20
</I>&gt;<i> further into the problem and my first conclusion was wrong.=20
</I>&gt;<i> Piers already stated that he did not expect that the MS=20
</I>&gt;<i> compiler would be able to optimize all these check out of the loop.
</I>&gt;<i>=20
</I>&gt;<i> I again started looking into the assembly code and although=20
</I>&gt;<i> I'm not a assembly programmer (it has been too long since I=20
</I>&gt;<i> done some 6502/Z80 :-) I think the performance difference=20
</I>&gt;<i> (&gt;2) comes from the optimization performered by the MS JIT=20
</I>&gt;<i> compiler (I am using version 1.0 of the SDK).
</I>&gt;<i>=20
</I>&gt;<i> The MS JIT seems to be better at allocating processor=20
</I>&gt;<i> registers to certain variables resulting in much faster code.=20
</I>&gt;<i> The execution speed of the Mono code is in the same order as=20
</I>&gt;<i> the unoptimized code generated by the MS JIT compiler (for=20
</I>&gt;<i> tight loops accessing arrays). In case of my bubble sorting=20
</I>&gt;<i> algorithm this results in a speed difference of a factor 3. I=20
</I>&gt;<i> have made other tests like applying matrix multiplications on=20
</I>&gt;<i> a 2-dimensional array (to simulate an image processing=20
</I>&gt;<i> operation) and also here Mono lacks behind. I haven't sorted=20
</I>&gt;<i> this out but my first guess is that its again the register=20
</I>&gt;<i> optimization that makes the difference.
</I>&gt;<i>=20
</I>&gt;<i> For the code snippets below both the MS and Mono code is given:
</I>&gt;<i>=20
</I>&gt;<i>        private void TestMethod(int size)
</I>&gt;<i>         {
</I>&gt;<i>             array =3D new int[size];
</I>&gt;<i>             for(int i=3D0; i&lt; size; i++)
</I>&gt;<i>             {
</I>&gt;<i>                 array[i] =3D size - i;
</I>&gt;<i>             }
</I>&gt;<i>             Console.WriteLine(&quot;Done&quot; );
</I>&gt;<i>             string s =3D Console.ReadLine();
</I>&gt;<i>         }
</I>&gt;<i>=20
</I>&gt;<i>  The MS JIT generates the following code. Note that
</I>&gt;<i>  I first run the program and latter when the program reads
</I>&gt;<i>  from the console attach the debugger. If I run the program=20
</I>&gt;<i> from  the MS development environment the JIT seems to=20
</I>&gt;<i> generate unoptimized  code so I need this trick.
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i>  MS Code generated by the JIT unoptimized=20
</I>&gt;<i> =
</I>=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i>         private void TestMethod(int size)
</I>&gt;<i>         {
</I>&gt;<i>             array =3D new int[size];
</I>&gt;<i> 00000000  push        ebp
</I>&gt;<i> 00000001  mov         ebp,esp
</I>&gt;<i> 00000003  sub         esp,14h
</I>&gt;<i> 00000006  push        edi
</I>&gt;<i> 00000007  push        esi
</I>&gt;<i> 00000008  push        ebx
</I>&gt;<i> 00000009  mov         ebx,ecx
</I>&gt;<i> 0000000b  mov         esi,edx
</I>&gt;<i> 0000000d  xor         edi,edi
</I>&gt;<i> 0000000f  mov         dword ptr [ebp-10h],0
</I>&gt;<i> 00000016  test        esi,80000000h
</I>&gt;<i> 0000001c  je          00000025
</I>&gt;<i> 0000001e  xor         ecx,ecx
</I>&gt;<i> 00000020  call        763A2CFF
</I>&gt;<i> 00000025  mov         edx,esi
</I>&gt;<i> 00000027  mov         ecx,2DE6B3Ah
</I>&gt;<i> 0000002c  call        FD4A2040
</I>&gt;<i> 00000031  lea         edx,[ebx+4]
</I>&gt;<i> 00000034  call        76479768
</I>&gt;<i>             for(int i=3D0; i&lt; size; i++)
</I>&gt;<i> 00000039  xor         edi,edi
</I>&gt;<i> 0000003b  nop
</I>&gt;<i> 0000003c  jmp         00000056
</I>&gt;<i>                 array[i] =3D size - i;
</I>&gt;<i> 0000003e  mov         eax,dword ptr [ebx+4]    &lt;=3D=3D=3D=3D Start=20
</I>&gt;<i> loop, fetch the
</I>&gt;<i> size of the array
</I>&gt;<i> 00000041  cmp         edi,dword ptr [eax+4]    &lt;=3D=3D=3D=3D Check if=20
</I>&gt;<i> within bounds
</I>&gt;<i> 00000044  jb          0000004D
</I>&gt;<i> 00000046  xor         ecx,ecx
</I>&gt;<i> 00000048  call        762EED87 		       &lt;=3D=3D=3D=3D=20
</I>&gt;<i> Trigger exception
</I>&gt;<i> 0000004d  mov         edx,esi 	   	       &lt;=3D=3D=3D=3D=20
</I>&gt;<i> esi contain variable size
</I>&gt;<i> 0000004f  sub         edx,edi
</I>&gt;<i> 00000051  mov         dword ptr [eax+edi*4+8],edx
</I>&gt;<i>             for(int i=3D0; i&lt; size; i++)
</I>&gt;<i> 00000055  inc         edi  		       &lt;=3D=3D=3D=3D edi=20
</I>&gt;<i> contain variable i
</I>&gt;<i> 00000056  cmp         edi,esi
</I>&gt;<i> 00000058  jl          0000003E                 &lt;=3D=3D=3D=3D Jump to=20
</I>&gt;<i> start of for
</I>&gt;<i> loop
</I>&gt;<i>             Console.WriteLine(&quot;Done&quot; );
</I>&gt;<i> 0000005a  mov         ecx,dword ptr ds:[01C40178h]
</I>&gt;<i> 00000060  call        76AA3250
</I>&gt;<i>             string s =3D Console.ReadLine();
</I>&gt;<i> 00000065  call        76AA2F10
</I>&gt;<i> 0000006a  mov         dword ptr [ebp-14h],eax
</I>&gt;<i> 0000006d  mov         eax,dword ptr [ebp-14h]
</I>&gt;<i> 00000070  mov         dword ptr [ebp-10h],eax
</I>&gt;<i>         }
</I>&gt;<i> 00000073  nop
</I>&gt;<i> 00000074  pop         ebx
</I>&gt;<i> 00000075  pop         esi
</I>&gt;<i> 00000076  pop         edi
</I>&gt;<i> 00000077  mov         esp,ebp
</I>&gt;<i> 00000079  pop         ebp
</I>&gt;<i> 0000007a  ret
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> MS Code generated by the JIT optimized=20
</I>&gt;<i> =
</I>=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i>         private void TestMethod(int size)
</I>&gt;<i>         {
</I>&gt;<i>             array =3D new int[size];
</I>&gt;<i> 00000000  push        edi
</I>&gt;<i> 00000001  push        esi
</I>&gt;<i> 00000002  mov         edi,ecx
</I>&gt;<i> 00000004  mov         esi,edx
</I>&gt;<i> 00000006  test        esi,80000000h
</I>&gt;<i> 0000000c  jne         0000005C
</I>&gt;<i> 0000000e  mov         edx,esi
</I>&gt;<i> 00000010  mov         ecx,2DE6A22h
</I>&gt;<i> 00000015  call        FD5B2098
</I>&gt;<i> 0000001a  lea         edx,[edi+4]
</I>&gt;<i> 0000001d  call        765897C0
</I>&gt;<i>             for(int i=3D0; i&lt; size; i++)
</I>&gt;<i> 00000022  xor         ecx,ecx
</I>&gt;<i> 00000024  cmp         esi,0
</I>&gt;<i> 00000027  jle         00000040
</I>&gt;<i> 00000029  mov         edx,dword ptr [edi+4]
</I>&gt;<i> 0000002c  mov         edi,dword ptr [edx+4]
</I>&gt;<i>                 array[i] =3D size - i;
</I>&gt;<i> 0000002f  cmp         ecx,edi				&lt;=3D=3D=3D=20
</I>&gt;<i> start of loop
</I>&gt;<i> 00000031  jae         00000064 			=09
</I>&gt;<i> &lt;=3D=3D=3D index out of bounds
</I>&gt;<i> 00000033  mov         eax,esi                           &lt;=3D=3D=3D=20
</I>&gt;<i> esi contain
</I>&gt;<i> variable size
</I>&gt;<i> 00000035  sub         eax,ecx
</I>&gt;<i> 00000037  mov         dword ptr [edx+ecx*4+8],eax
</I>&gt;<i>             for(int i=3D0; i&lt; size; i++)
</I>&gt;<i> 0000003b  inc         ecx  				&lt;=3D=3D=3D=3D=20
</I>&gt;<i> ecx contain variable i
</I>&gt;<i> 0000003c  cmp         ecx,esi
</I>&gt;<i> 0000003e  jl          0000002F 			=09
</I>&gt;<i> &lt;=3D=3D=3D=3D jump to start of for loop
</I>&gt;<i>             Console.WriteLine(&quot;Done&quot; );
</I>&gt;<i> 00000040  mov         ecx,dword ptr ds:[01C4086Ch]
</I>&gt;<i> 00000046  mov         edx,dword ptr ds:[01C40110h]
</I>&gt;<i> 0000004c  mov         eax,dword ptr [ecx]
</I>&gt;<i> 0000004e  call        dword ptr [eax+000000D8h]
</I>&gt;<i>             string s =3D Console.ReadLine();
</I>&gt;<i> 00000054  call        76BB2F68
</I>&gt;<i> 00000059  pop         esi
</I>&gt;<i>         }
</I>&gt;<i> 0000005a  pop         edi
</I>&gt;<i> 0000005b  ret
</I>&gt;<i> 0000005c  xor         ecx,ecx
</I>&gt;<i> 0000005e  call        764B2D57
</I>&gt;<i> 00000063  int         3
</I>&gt;<i> 00000064  xor         ecx,ecx 			=09
</I>&gt;<i> &lt;=3D=3D=3D=3D Exception
</I>&gt;<i> 00000066  call        763FEDDF
</I>&gt;<i> 0000006b  int         3
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> The Mono (0.18) JIT generates the following code (--dump-asm)=20
</I>&gt;<i> =
</I>=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
&gt;<i>=20
</I>&gt;<i> Disassembly of section .text:
</I>&gt;<i>=20
</I>&gt;<i> 00000000 &lt;SpeedBenchmarks.BubbleSort_TestMethod&gt;:
</I>&gt;<i>    0:	55                   	push   %ebp
</I>&gt;<i>    1:	8b ec                	mov    %esp,%ebp
</I>&gt;<i>    3:	53                   	push   %ebx
</I>&gt;<i>    4:	56                   	push   %esi
</I>&gt;<i>    5:	83 ec 28             	sub    $0x28,%esp
</I>&gt;<i>    8:	c7 45 d8 00 00 00 00 	movl   $0x0,0xffffffd8(%ebp)
</I>&gt;<i>    f:	8b 45 08             	mov    0x8(%ebp),%eax
</I>&gt;<i>   12:	05 08 00 00 00       	add    $0x8,%eax
</I>&gt;<i>   17:	83 38 00             	cmpl   $0x0,(%eax)
</I>&gt;<i>   1a:	8b 4d 0c             	mov    0xc(%ebp),%ecx
</I>&gt;<i>   1d:	50                   	push   %eax
</I>&gt;<i>   1e:	51                   	push   %ecx
</I>&gt;<i>   1f:	52                   	push   %edx
</I>&gt;<i>   20:	51                   	push   %ecx
</I>&gt;<i>   21:	68 54 7e 18 08       	push   $0x8187e54
</I>&gt;<i>   26:	e8 b5 c2 e4 ff       	call   ffe4c2e0
</I>&gt;<i> &lt;SpeedBenchmarks.BubbleSort_TestMethod+0xffe4c2e0&gt;
</I>&gt;<i>   2b:	83 c4 08             	add    $0x8,%esp
</I>&gt;<i>   2e:	5a                   	pop    %edx
</I>&gt;<i>   2f:	59                   	pop    %ecx
</I>&gt;<i>   30:	8b c8                	mov    %eax,%ecx
</I>&gt;<i>   32:	58                   	pop    %eax
</I>&gt;<i>   33:	89 08                	mov    %ecx,(%eax)
</I>&gt;<i>   35:	be 00 00 00 00       	mov    $0x0,%esi
</I>&gt;<i> &lt;=3D=3D=3D esi contain variable i
</I>&gt;<i>   3a:	e9 29 00 00 00       	jmp    68
</I>&gt;<i> &lt;SpeedBenchmarks.BubbleSort_TestMethod+0x68&gt;
</I>&gt;<i>   3f:	8b 45 08             	mov    0x8(%ebp),%eax
</I>&gt;<i> &lt;=3D=3D=3D start loop
</I>&gt;<i>   42:	8b 40 08             	mov    0x8(%eax),%eax
</I>&gt;<i> \
</I>&gt;<i>   45:	8b ce                	mov    %esi,%ecx
</I>&gt;<i> |
</I>&gt;<i>   47:	3b 48 0c             	cmp    0xc(%eax),%ecx
</I>&gt;<i> | Bounds check
</I>&gt;<i>   4a:	72 0a                	jb     56
</I>&gt;<i> &lt;SpeedBenchmarks.BubbleSort_TestMethod+0x56&gt;/
</I>&gt;<i>   4c:	68 e1 26 11 08       	push   $0x81126e1
</I>&gt;<i>   51:	e8 ce 56 ed ff       	call   ffed5724
</I>&gt;<i> &lt;SpeedBenchmarks.BubbleSort_TestMethod+0xffed5724&gt; &lt;=3D=3D=3D=20
</I>&gt;<i> Generate exception
</I>&gt;<i>   56:	8d 44 88 10          	lea    0x10(%eax,%ecx,4),%eax
</I>&gt;<i>   5a:	8b 4d 0c             	mov    0xc(%ebp),%ecx
</I>&gt;<i> &lt;=3D=3D retrieve size
</I>&gt;<i>   5d:	2b ce                	sub    %esi,%ecx
</I>&gt;<i>   5f:	89 08                	mov    %ecx,(%eax)
</I>&gt;<i>   61:	8b c6                	mov    %esi,%eax
</I>&gt;<i> &lt;=3D=3D=3D move i to eax
</I>&gt;<i>   63:	40                   	inc    %eax		=09
</I>&gt;<i> 			&lt;=3D=3D=3D i++
</I>&gt;<i>   64:	8b d8                	mov    %eax,%ebx
</I>&gt;<i> &lt;=3D=3D=3D (detour??)
</I>&gt;<i>   66:	8b f3                	mov    %ebx,%esi
</I>&gt;<i> &lt;=3D=3D=3D move i back to esi
</I>&gt;<i>   68:	8b 45 0c             	mov    0xc(%ebp),%eax
</I>&gt;<i> &lt;=3D=3D=3D retrieve size
</I>&gt;<i>   6b:	3b f0                	cmp    %eax,%esi
</I>&gt;<i> &lt;=3D=3D=3D check if i &lt; size
</I>&gt;<i>   6d:	0f 8c cc ff ff ff    	jl     3f
</I>&gt;<i> &lt;SpeedBenchmarks.BubbleSort_TestMethod+0x3f&gt;  &lt;=3D=3D=3D end loop
</I>&gt;<i>   73:	68 38 da 16 08       	push   $0x816da38
</I>&gt;<i>   78:	8b 05 78 df 16 08    	mov    0x816df78,%eax
</I>&gt;<i>   7e:	50                   	push   %eax
</I>&gt;<i>   7f:	83 38 00             	cmpl   $0x0,(%eax)
</I>&gt;<i>   82:	8b 00                	mov    (%eax),%eax
</I>&gt;<i>   84:	ff 90 a0 00 00 00    	call   *0xa0(%eax)
</I>&gt;<i>   8a:	83 c4 08             	add    $0x8,%esp
</I>&gt;<i>   8d:	8b 05 78 df 16 08    	mov    0x816df78,%eax
</I>&gt;<i>   93:	50                   	push   %eax
</I>&gt;<i>   94:	83 38 00             	cmpl   $0x0,(%eax)
</I>&gt;<i>   97:	8b 00                	mov    (%eax),%eax
</I>&gt;<i>   99:	ff 90 c0 00 00 00    	call   *0xc0(%eax)
</I>&gt;<i>   9f:	83 c4 04             	add    $0x4,%esp
</I>&gt;<i>   a2:	8b 05 80 df 16 08    	mov    0x816df80,%eax
</I>&gt;<i>   a8:	50                   	push   %eax
</I>&gt;<i>   a9:	83 38 00             	cmpl   $0x0,(%eax)
</I>&gt;<i>   ac:	8b 00                	mov    (%eax),%eax
</I>&gt;<i>   ae:	ff 90 7c 00 00 00    	call   *0x7c(%eax)
</I>&gt;<i>   b4:	83 c4 04             	add    $0x4,%esp
</I>&gt;<i>   b7:	8b f0                	mov    %eax,%esi
</I>&gt;<i>   b9:	8b de                	mov    %esi,%ebx
</I>&gt;<i>   bb:	8d 65 f8             	lea    0xfffffff8(%ebp),%esp
</I>&gt;<i>   be:	5e                   	pop    %esi
</I>&gt;<i>   bf:	5b                   	pop    %ebx
</I>&gt;<i>   c0:	c9                   	leave
</I>&gt;<i>   c1:	c3                   	ret
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Mitchell Skinner [mailto:<A HREF="mailto:mitchskin@attbi.com">mitchskin@attbi.com</A>]
</I>&gt;<i> Sent: Wednesday, January 15, 2003 12:42 AM
</I>&gt;<i> To: Tom Fransen
</I>&gt;<i> Cc: <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> Subject: RE: [Mono-list] Performance / array access
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> Hello,
</I>&gt;<i>=20
</I>&gt;<i> The runtime inserts array bounds checks to prevent things=20
</I>&gt;<i> like buffer overflows.  So the following code:
</I>&gt;<i>    int len =3D array.Length;
</I>&gt;<i>    for (int i =3D 0; i &lt; len; ++i)
</I>&gt;<i>       sum +=3D array [i];
</I>&gt;<i> becomes something like:
</I>&gt;<i>    int len =3D array.Length;
</I>&gt;<i>    for (int i =3D 0; i &lt; len; ++i) {
</I>&gt;<i>       if (i &gt;=3D array.Length) throw new Exception; //forgot which
</I>&gt;<i>       sum +=3D array [i];
</I>&gt;<i>    }
</I>&gt;<i>=20
</I>&gt;<i> In the fast case, the MS JIT is smart enough to analyze the=20
</I>&gt;<i> following code and figure out that &quot;i&quot; will not go out of the=20
</I>&gt;<i> bounds of the array (because i starts at zero and stays below=20
</I>&gt;<i> array.Length):
</I>&gt;<i>    for (int i =3D 0; i &lt; array.Length; ++i)
</I>&gt;<i>       sum +=3D array [i];
</I>&gt;<i>=20
</I>&gt;<i> If the for loop isn't set up exactly like that, I don't think=20
</I>&gt;<i> the MS JIT is able to eliminate the bounds check (unless=20
</I>&gt;<i> perhaps there are constants involved).  Is the code you have=20
</I>&gt;<i> below (comparing i with a &quot;size&quot; variable) the exact code you=20
</I>&gt;<i> tested?  If &quot;size&quot; is not a constant, I would be suprised to=20
</I>&gt;<i> find that there was a major difference between MS and mono.
</I>&gt;<i>=20
</I>&gt;<i> Are you using the MS 1.0 release or the 1.1 release?
</I>&gt;<i>=20
</I>&gt;<i> Mitch
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> On Tue, 2003-01-14 at 13:38, Tom Fransen wrote:
</I>&gt;<i> &gt; Piers,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; can you spend a few more words on this. Why is the second=20
</I>&gt;<i> case slower?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Furthermore if I use a simple loop to fill an array the
</I>&gt;<i> &gt; speed difference is a factor 3. I have a bubble sort method that I=20
</I>&gt;<i> &gt; execute a larger number of times. On Mono it takes 19=20
</I>&gt;<i> seconds on the=20
</I>&gt;<i> &gt; MS stuff ~6 seconds. This is a big difference. So why I am losing a=20
</I>&gt;<i> &gt; factor 3 on the following loop.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                 // Fill aray worst case, all elements need=20
</I>&gt;<i> to be swapped
</I>&gt;<i> &gt;                 for(int i=3D0; i&lt; size; i++)
</I>&gt;<i> &gt;                 {
</I>&gt;<i> &gt;                     array[i] =3D size - i;
</I>&gt;<i> &gt;                 }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I am testing with some small benchmarks, but real=20
</I>&gt;<i> applications (e.g.=20
</I>&gt;<i> &gt; an
</I>&gt;<i> MP3
</I>&gt;<i> &gt; decoder)
</I>&gt;<i> &gt; often use tables stored in arrays to do certain calculations. So=20
</I>&gt;<i> &gt; although the benchmark maybe syntetic certain application=20
</I>&gt;<i> will suffer=20
</I>&gt;<i> &gt; from these penalties.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; regards,
</I>&gt;<i> &gt; Tom
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: Miguel de Icaza [mailto:<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>]
</I>&gt;<i> &gt; Sent: Monday, January 13, 2003 3:22 AM
</I>&gt;<i> &gt; To: Piers Haken
</I>&gt;<i> &gt; Cc: Tom Fransen; <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> &gt; Subject: RE: [Mono-list] Performance / array access
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Yeah, Microsoft's JIT lifts invariant bounds-checks. But=20
</I>&gt;<i> I believe=20
</I>&gt;<i> &gt; &gt; it's pretty limited.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; For example, the check is removed in the following case:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;   for (int i =3D 0; i &lt; array.Length; ++i)
</I>&gt;<i> &gt; &gt;     sum +=3D array [i];
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; But not here:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;   int len =3D array.Length;
</I>&gt;<i> &gt; &gt;   for (int i =3D 0; i &lt; len; ++i)
</I>&gt;<i> &gt; &gt;     sum +=3D array [i];
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; So the first case is (counter-intuitively) faster than the second.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I don't believe Mono's JIT makes this optimization. Maybe the new=20
</I>&gt;<i> &gt; &gt; JIT will ;-)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This is a very good observation.  Because it seems that this=20
</I>&gt;<i> &gt; particular kind of loop is detected by the JIT engine.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Array-bounds-check elimination is something we want to do=20
</I>&gt;<i> with the new=20
</I>&gt;<i> &gt; JIT, but it is not implemented at this point.  The new JIT=20
</I>&gt;<i> features a=20
</I>&gt;<i> &gt; new intermediate representation that simplifies=20
</I>&gt;<i> implementing this sort=20
</I>&gt;<i> &gt; of thing, but it is still on its bootstrapping phases of life.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Miguel
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>=20
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> --
</I>&gt;<i> Mitchell Skinner &lt;<A HREF="mailto:mitchskin@attbi.com">mitchskin@attbi.com</A>&gt;
</I>&gt;<i>=20
</I>&gt;<i>=20
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>=20
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>=20
</I>
------_=_NextPart_001_01C2C001.DACA076E
Content-Type: text/html;
	charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META HTTP-EQUIV=3D&quot;Content-Type&quot; CONTENT=3D&quot;text/html; =
charset=3Dus-ascii&quot;&gt;
&lt;META NAME=3D&quot;Generator&quot; CONTENT=3D&quot;MS Exchange Server version =
6.0.4417.0&quot;&gt;
&lt;TITLE&gt;RE: [Mono-list] Performance / array access&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;!-- Converted from text/plain format --&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;Also significant optimizations that MS does here are =
frame-pointer omission and passing params in registers.&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;Tom, can you try your tests on MS with the following =
change: ?&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT =
SIZE=3D2&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp; for(int i=3D0; i&amp;lt; size; i++)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;---&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
sp;&amp;nbsp; for(int i=3D0; i&amp;lt; array.Length; i++)&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;Piers.&lt;/FONT&gt;
&lt;/P&gt;

&lt;P&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; -----Original Message-----&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; From: Tom Fransen [&lt;A =
HREF=3D&quot;mailto:<A HREF="mailto:t.fransen@mailned.nl">t.fransen@mailned.nl</A>&quot;&gt;mailto:<A HREF="mailto:t.fransen@mailned.nl">t.fransen@mailned.nl</A>&lt;/A&gt;] =
&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Sent: Sunday, January 19, 2003 8:02 AM&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; To: Mitchell Skinner&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Cc: <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Subject: RE: [Mono-list] Performance / array =
access&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Hello all,&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Mitch, to come back on the issue of bound =
checking. I looked &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; further into the problem and my first conclusion =
was wrong. &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Piers already stated that he did not expect that =
the MS &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; compiler would be able to optimize all these =
check out of the loop.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; I again started looking into the assembly code =
and although &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; I'm not a assembly programmer (it has been too =
long since I &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; done some 6502/Z80 :-) I think the performance =
difference &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; (&amp;gt;2) comes from the optimization performered =
by the MS JIT &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; compiler (I am using version 1.0 of the =
SDK).&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; The MS JIT seems to be better at allocating =
processor &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; registers to certain variables resulting in much =
faster code. &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; The execution speed of the Mono code is in the =
same order as &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; the unoptimized code generated by the MS JIT =
compiler (for &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; tight loops accessing arrays). In case of my =
bubble sorting &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; algorithm this results in a speed difference of =
a factor 3. I &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; have made other tests like applying matrix =
multiplications on &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; a 2-dimensional array (to simulate an image =
processing &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; operation) and also here Mono lacks behind. I =
haven't sorted &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; this out but my first guess is that its again =
the register &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; optimization that makes the difference.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; For the code snippets below both the MS and Mono =
code is given:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
private void TestMethod(int size)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
{&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; array =3D new int[size];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; for(int i=3D0; i&amp;lt; size; i++)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; {&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; array[i] =3D size - i;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; }&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; Console.WriteLine(&amp;quot;Done&amp;quot; );&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; string s =3D Console.ReadLine();&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
}&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp; The MS JIT generates the following code. =
Note that&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp; I first run the program and latter when =
the program reads&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp; from the console attach the debugger. If I =
run the program &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; from&amp;nbsp; the MS development environment the =
JIT seems to &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; generate unoptimized&amp;nbsp; code so I need this =
trick.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp; MS Code generated by the JIT unoptimized =
&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
private void TestMethod(int size)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
{&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; array =3D new int[size];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000000&amp;nbsp; =
push&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ebp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000001&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ebp,esp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000003&amp;nbsp; =
sub&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esp,14h&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000006&amp;nbsp; =
push&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000007&amp;nbsp; =
push&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000008&amp;nbsp; =
push&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ebx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000009&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ebx,ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000000b&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi,edx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000000d&amp;nbsp; =
xor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi,edi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000000f&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dword ptr =
[ebp-10h],0&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000016&amp;nbsp; =
test&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi,80000000h&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000001c&amp;nbsp; =
je&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 00000025&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000001e&amp;nbsp; =
xor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000020&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 763A2CFF&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000025&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000027&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,2DE6B3Ah&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000002c&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FD4A2040&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000031&amp;nbsp; =
lea&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,[ebx+4]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000034&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 76479768&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; for(int i=3D0; i&amp;lt; size; i++)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000039&amp;nbsp; =
xor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi,edi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000003b&amp;nbsp; nop&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000003c&amp;nbsp; =
jmp&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 00000056&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; array[i] =3D size - i;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000003e&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; eax,dword ptr =
[ebx+4]&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D=3D Start &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; loop, fetch the&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; size of the array&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000041&amp;nbsp; =
cmp&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi,dword ptr =
[eax+4]&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D=3D Check if &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; within bounds&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000044&amp;nbsp; =
jb&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0000004D&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000046&amp;nbsp; =
xor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000048&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 762EED87 =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D=3D &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Trigger exception&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000004d&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,esi =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;lt;=3D=3D=3D=3D &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; esi contain variable size&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000004f&amp;nbsp; =
sub&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,edi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000051&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dword ptr =
[eax+edi*4+8],edx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; for(int i=3D0; i&amp;lt; size; i++)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000055&amp;nbsp; =
inc&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi&amp;nbsp; =
&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D=3D edi &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; contain variable i&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000056&amp;nbsp; =
cmp&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi,esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000058&amp;nbsp; =
jl&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
0000003E&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D=3D Jump to &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; start of for&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; loop&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; Console.WriteLine(&amp;quot;Done&amp;quot; );&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000005a&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,dword ptr =
ds:[01C40178h]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000060&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 76AA3250&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; string s =3D Console.ReadLine();&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000065&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 76AA2F10&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000006a&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dword ptr =
[ebp-14h],eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000006d&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; eax,dword ptr =
[ebp-14h]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000070&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dword ptr =
[ebp-10h],eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
}&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000073&amp;nbsp; nop&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000074&amp;nbsp; =
pop&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ebx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000075&amp;nbsp; =
pop&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000076&amp;nbsp; =
pop&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000077&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esp,ebp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000079&amp;nbsp; =
pop&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ebp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000007a&amp;nbsp; ret&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; MS Code generated by the JIT optimized &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
private void TestMethod(int size)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
{&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; array =3D new int[size];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000000&amp;nbsp; =
push&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000001&amp;nbsp; =
push&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000002&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi,ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000004&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi,edx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000006&amp;nbsp; =
test&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi,80000000h&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000000c&amp;nbsp; =
jne&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0000005C&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000000e&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000010&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,2DE6A22h&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000015&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; FD5B2098&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000001a&amp;nbsp; =
lea&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,[edi+4]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000001d&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 765897C0&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; for(int i=3D0; i&amp;lt; size; i++)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000022&amp;nbsp; =
xor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000024&amp;nbsp; =
cmp&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi,0&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000027&amp;nbsp; =
jle&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 00000040&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000029&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,dword ptr =
[edi+4]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000002c&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi,dword ptr =
[edx+4]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; array[i] =3D size - i;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000002f&amp;nbsp; =
cmp&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,edi =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; start of loop&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000031&amp;nbsp; =
jae&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 00000064 =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D index out of bounds&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000033&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
eax,esi&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;=
nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; esi contain&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; variable size&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000035&amp;nbsp; =
sub&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; eax,ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000037&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dword ptr =
[edx+ecx*4+8],eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; for(int i=3D0; i&amp;lt; size; i++)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000003b&amp;nbsp; =
inc&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx&amp;nbsp; =
&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D=3D &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; ecx contain variable i&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000003c&amp;nbsp; =
cmp&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000003e&amp;nbsp; =
jl&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0000002F =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D=3D jump to start of for =
loop&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; Console.WriteLine(&amp;quot;Done&amp;quot; );&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000040&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,dword ptr =
ds:[01C4086Ch]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000046&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edx,dword ptr =
ds:[01C40110h]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000004c&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; eax,dword ptr =
[ecx]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000004e&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dword ptr =
[eax+000000D8h]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT =
SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;=
&amp;nbsp;&amp;nbsp; string s =3D Console.ReadLine();&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000054&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 76BB2F68&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000059&amp;nbsp; =
pop&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
}&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000005a&amp;nbsp; =
pop&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; edi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000005b&amp;nbsp; ret&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000005c&amp;nbsp; =
xor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000005e&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 764B2D57&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000063&amp;nbsp; =
int&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 3&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000064&amp;nbsp; =
xor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ecx,ecx =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D=3D Exception&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000066&amp;nbsp; =
call&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 763FEDDF&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 0000006b&amp;nbsp; =
int&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 3&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; The Mono (0.18) JIT generates the following code =
(--dump-asm) &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Disassembly of section .text:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; 00000000 =
&amp;lt;SpeedBenchmarks.BubbleSort_TestMethod&amp;gt;:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0: =
55&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%ebp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1: 8b =
ec&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %esp,%ebp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; 3: =
53&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%ebx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; 4: =
56&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; 5: 83 ec =
28&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; sub&amp;nbsp;&amp;nbsp;&amp;nbsp; $0x28,%esp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; 8: c7 45 d8 00 00 00 00 =
&amp;nbsp;&amp;nbsp; movl&amp;nbsp;&amp;nbsp; $0x0,0xffffffd8(%ebp)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; f: 8b 45 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; 0x8(%ebp),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 12: 05 08 00 00 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; =
add&amp;nbsp;&amp;nbsp;&amp;nbsp; $0x8,%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 17: 83 38 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; cmpl&amp;nbsp;&amp;nbsp; $0x0,(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 1a: 8b 4d =
0c&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; 0xc(%ebp),%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 1d: =
50&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 1e: =
51&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 1f: =
52&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%edx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 20: =
51&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 21: 68 54 7e 18 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
$0x8187e54&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 26: e8 b5 c2 e4 =
ff&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; call&amp;nbsp;&amp;nbsp; =
ffe4c2e0&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;lt;SpeedBenchmarks.BubbleSort_TestMethod+0xffe4c2e0&amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 2b: 83 c4 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; add&amp;nbsp;&amp;nbsp;&amp;nbsp; $0x8,%esp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 2e: =
5a&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; pop&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%edx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 2f: =
59&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; pop&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 30: 8b =
c8&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %eax,%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 32: =
58&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; pop&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 33: 89 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%ecx,(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 35: be 00 00 00 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; =
mov&amp;nbsp;&amp;nbsp;&amp;nbsp; $0x0,%esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D esi contain variable i&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 3a: e9 29 00 00 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; =
jmp&amp;nbsp;&amp;nbsp;&amp;nbsp; 68&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;lt;SpeedBenchmarks.BubbleSort_TestMethod+0x68&amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 3f: 8b 45 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; 0x8(%ebp),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D start loop&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 42: 8b 40 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; 0x8(%eax),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; \&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 45: 8b =
ce&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %esi,%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; |&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 47: 3b 48 =
0c&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; cmp&amp;nbsp;&amp;nbsp;&amp;nbsp; 0xc(%eax),%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; | Bounds check&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 4a: 72 =
0a&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; jb&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 56&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;lt;SpeedBenchmarks.BubbleSort_TestMethod+0x56&amp;gt;/&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 4c: 68 e1 26 11 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
$0x81126e1&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 51: e8 ce 56 ed =
ff&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; call&amp;nbsp;&amp;nbsp; =
ffed5724&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;lt;SpeedBenchmarks.BubbleSort_TestMethod+0xffed5724&amp;gt; &amp;lt;=3D=3D=3D =
&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Generate exception&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 56: 8d 44 88 =
10&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; =
lea&amp;nbsp;&amp;nbsp;&amp;nbsp; 0x10(%eax,%ecx,4),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 5a: 8b 4d =
0c&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; 0xc(%ebp),%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D retrieve size&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 5d: 2b =
ce&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; sub&amp;nbsp;&amp;nbsp;&amp;nbsp; %esi,%ecx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 5f: 89 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%ecx,(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 61: 8b =
c6&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %esi,%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D move i to eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 63: =
40&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; inc&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%eax&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; =
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;lt;=3D=3D=3D i++&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 64: 8b =
d8&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %eax,%ebx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D (detour??)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 66: 8b =
f3&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %ebx,%esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D move i back to esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 68: 8b 45 =
0c&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; 0xc(%ebp),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D retrieve size&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 6b: 3b =
f0&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; cmp&amp;nbsp;&amp;nbsp;&amp;nbsp; %eax,%esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;lt;=3D=3D=3D check if i &amp;lt; size&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 6d: 0f 8c cc ff ff =
ff&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; jl&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 3f&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;lt;SpeedBenchmarks.BubbleSort_TestMethod+0x3f&amp;gt;&amp;nbsp; &amp;lt;=3D=3D=3D =
end loop&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 73: 68 38 da 16 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
$0x816da38&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 78: 8b 05 78 df 16 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
0x816df78,%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 7e: =
50&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 7f: 83 38 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; cmpl&amp;nbsp;&amp;nbsp; $0x0,(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 82: 8b =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
(%eax),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 84: ff 90 a0 00 00 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; call&amp;nbsp;&amp;nbsp; *0xa0(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 8a: 83 c4 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; add&amp;nbsp;&amp;nbsp;&amp;nbsp; $0x8,%esp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 8d: 8b 05 78 df 16 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
0x816df78,%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 93: =
50&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 94: 83 38 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; cmpl&amp;nbsp;&amp;nbsp; $0x0,(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 97: 8b =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
(%eax),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 99: ff 90 c0 00 00 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; call&amp;nbsp;&amp;nbsp; *0xc0(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; 9f: 83 c4 =
04&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; add&amp;nbsp;&amp;nbsp;&amp;nbsp; $0x4,%esp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; a2: 8b 05 80 df 16 =
08&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
0x816df80,%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; a8: =
50&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; push&amp;nbsp;&amp;nbsp; =
%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; a9: 83 38 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; cmpl&amp;nbsp;&amp;nbsp; $0x0,(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; ac: 8b =
00&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; =
(%eax),%eax&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; ae: ff 90 7c 00 00 =
00&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; call&amp;nbsp;&amp;nbsp; *0x7c(%eax)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; b4: 83 c4 =
04&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; add&amp;nbsp;&amp;nbsp;&amp;nbsp; $0x4,%esp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; b7: 8b =
f0&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %eax,%esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; b9: 8b =
de&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; mov&amp;nbsp;&amp;nbsp;&amp;nbsp; %esi,%ebx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; bb: 8d 65 =
f8&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
; &amp;nbsp;&amp;nbsp; lea&amp;nbsp;&amp;nbsp;&amp;nbsp; 0xfffffff8(%ebp),%esp&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; be: =
5e&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; pop&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%esi&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; bf: =
5b&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; pop&amp;nbsp;&amp;nbsp;&amp;nbsp; =
%ebx&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; c0: =
c9&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; leave&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp; c1: =
c3&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp=
;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; ret&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; -----Original Message-----&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; From: Mitchell Skinner [&lt;A =
HREF=3D&quot;mailto:<A HREF="mailto:mitchskin@attbi.com">mitchskin@attbi.com</A>&quot;&gt;mailto:<A HREF="mailto:mitchskin@attbi.com">mitchskin@attbi.com</A>&lt;/A&gt;]&lt;/FONT=
&gt;<i>
</I>
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Sent: Wednesday, January 15, 2003 12:42 =
AM&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; To: Tom Fransen&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Cc: <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Subject: RE: [Mono-list] Performance / array =
access&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Hello,&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; The runtime inserts array bounds checks to =
prevent things &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; like buffer overflows.&amp;nbsp; So the following =
code:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; int len =3D =
array.Length;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (int i =3D 0; i &amp;lt; len; =
++i)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sum +=3D =
array [i];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; becomes something like:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; int len =3D =
array.Length;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (int i =3D 0; i &amp;lt; len; =
++i) {&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (i =
&amp;gt;<i>=3D array.Length) throw new Exception; //forgot which&lt;/FONT&gt;
</I>
&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sum +=3D =
array [i];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; In the fast case, the MS JIT is smart enough to =
analyze the &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; following code and figure out that &amp;quot;i&amp;quot; =
will not go out of the &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; bounds of the array (because i starts at zero =
and stays below &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; array.Length):&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; for (int i =3D 0; i &amp;lt; =
array.Length; ++i)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sum +=3D =
array [i];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; If the for loop isn't set up exactly like that, =
I don't think &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; the MS JIT is able to eliminate the bounds check =
(unless &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; perhaps there are constants involved).&amp;nbsp; Is =
the code you have &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; below (comparing i with a &amp;quot;size&amp;quot; =
variable) the exact code you &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; tested?&amp;nbsp; If &amp;quot;size&amp;quot; is not a =
constant, I would be suprised to &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; find that there was a major difference between =
MS and mono.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Are you using the MS 1.0 release or the 1.1 =
release?&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Mitch&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; On Tue, 2003-01-14 at 13:38, Tom Fransen =
wrote:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Piers,&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; can you spend a few more words on this. Why =
is the second &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; case slower?&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Furthermore if I use a simple loop to fill =
an array the&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; speed difference is a factor 3. I have a =
bubble sort method that I &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; execute a larger number of times. On Mono =
it takes 19 &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; seconds on the &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; MS stuff ~6 seconds. This is a big =
difference. So why I am losing a &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; factor 3 on the following loop.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;gt;<i>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
</I>sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // Fill aray worst case, all elements need =
&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; to be swapped&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;gt;<i>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
</I>sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; for(int i=3D0; i&amp;lt; size; i++)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;gt;<i>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
</I>sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;gt;<i>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
</I>sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; array[i] =3D size - =
i;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
&amp;gt;<i>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nb=
</I>sp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; I am testing with some small benchmarks, =
but real &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; applications (e.g. &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; an&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; MP3&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; decoder)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; often use tables stored in arrays to do =
certain calculations. So &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; although the benchmark maybe syntetic =
certain application &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; will suffer &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; from these penalties.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; regards,&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Tom&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; -----Original Message-----&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; From: Miguel de Icaza [&lt;A =
HREF=3D&quot;mailto:<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&quot;&gt;mailto:<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&lt;/A&gt;]&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Sent: Monday, January 13, 2003 3:22 =
AM&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; To: Piers Haken&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Cc: Tom Fransen; =
<A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Subject: RE: [Mono-list] Performance / =
array access&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Hello,&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt; Yeah, Microsoft's JIT lifts invariant =
bounds-checks. But &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; I believe &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt; it's pretty limited.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt; For example, the check is removed in =
the following case:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&amp;nbsp;&amp;nbsp; for (int i =3D 0; i &amp;lt; =
array.Length; ++i)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sum +=3D array =
[i];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt; But not here:&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&amp;nbsp;&amp;nbsp; int len =3D =
array.Length;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&amp;nbsp;&amp;nbsp; for (int i =3D 0; i &amp;lt; =
len; ++i)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; sum +=3D array =
[i];&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt; So the first case is =
(counter-intuitively) faster than the second.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt; I don't believe Mono's JIT makes this =
optimization. Maybe the new &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &amp;gt; JIT will ;-)&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; This is a very good observation.&amp;nbsp; =
Because it seems that this &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; particular kind of loop is detected by the =
JIT engine.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Array-bounds-check elimination is something =
we want to do &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; with the new &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; JIT, but it is not implemented at this =
point.&amp;nbsp; The new JIT &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; features a &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; new intermediate representation that =
simplifies &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; implementing this sort &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; of thing, but it is still on its =
bootstrapping phases of life.&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Miguel&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; =
_______________________________________________&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; Mono-list maillist&amp;nbsp; -&amp;nbsp; =
<A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A> &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &amp;gt; &lt;A =
HREF=3D&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list"">http://lists.ximian.com/mailman/listinfo/mono-list&quot;</A>&gt;<A HREF="http://lists.=">http://lists.=</A>
ximian.com/mailman/listinfo/mono-list&lt;/A&gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; --&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Mitchell Skinner =
&amp;lt;<A HREF="mailto:mitchskin@attbi.com">mitchskin@attbi.com</A>&amp;gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; =
_______________________________________________&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; Mono-list maillist&amp;nbsp; -&amp;nbsp; =
<A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A> &lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;A =
HREF=3D&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list"">http://lists.ximian.com/mailman/listinfo/mono-list&quot;</A>&gt;<A HREF="http://lists.=">http://lists.=</A>
ximian.com/mailman/listinfo/mono-list&lt;/A&gt;&lt;/FONT&gt;

&lt;BR&gt;&lt;FONT SIZE=3D2&gt;&amp;gt; &lt;/FONT&gt;
&lt;/P&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
------_=_NextPart_001_01C2C001.DACA076E--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011417.html">[Mono-list] Unable to compile the runtime
</A></li>
	<LI> Next message: <A HREF="011418.html">[Mono-list] The Mono Debugger 0.2.0 &quot;Boston&quot; has been released :-)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11416">[ date ]</a>
              <a href="thread.html#11416">[ thread ]</a>
              <a href="subject.html#11416">[ subject ]</a>
              <a href="author.html#11416">[ author ]</a>
         </LI>
       </UL>
</body></html>
