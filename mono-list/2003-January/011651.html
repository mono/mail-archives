<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] mBas
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:marco.ridoni%40virgilio.it">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011670.html">
   <LINK REL="Next"  HREF="011652.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] mBas
   </H1>
    <B>Marco Ridoni
    </B> 
    <A HREF="mailto:marco.ridoni%40virgilio.it"
       TITLE="[Mono-list] mBas">marco.ridoni@virgilio.it
       </A><BR>
    <I>Mon, 27 Jan 2003 20:11:09 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="011670.html">[Mono-list] Re: [Gtk-sharp-list] gtk_set_label HELP!
</A></li>
        <LI> Next message: <A HREF="011652.html">[Mono-list] CS0246
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11651">[ date ]</a>
              <a href="thread.html#11651">[ thread ]</a>
              <a href="subject.html#11651">[ subject ]</a>
              <a href="author.html#11651">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have added support for attributes to mBas (beside other fixes).  The
following code compiles and runs fine. The area which needs more attention
is array declaration and access, as you can see yourself from the apparently
weird access method used to retrieve an Annotation object - calls like
'MyAnnotation = tc_type.GetCustomAttributes(False)(0)' wouldn't work mainly
because the grammar still fails to recognize them. I'm currently working on
this.

Marco Ridoni
<A HREF="mailto:marco.ridoni@virgilio.it">marco.ridoni@virgilio.it</A>

P.S. I just realized I forgot to remove some code which generates debug
output while compiling. I wil take care of it ASAP

=========================

Imports System
Imports System.Reflection


&lt;AttributeUsage(AttributeTargets.All, Inherited:=True, AllowMultiple:=True)&gt;
_
Public Class Annotation
    Inherits System.Attribute

    Protected strAuthor As String
    Protected strComment As String

    Public Sub New(ByVal Author As String, ByVal Comment As String)
        strAuthor = Author
        strComment = Comment
    End Sub

    Public Property Author() As String
        Get
            Author = strAuthor
        End Get

        Set(Value As String)
            strAuthor = CStr(Value)
        End Set
    End Property

    Public Property Comment() As String
        Get
            Return strComment
        End Get
        Set(Value As String)
            strComment = CStr(Value)
        End Set
    End Property

End Class

&lt;Annotation(&quot;mr&quot;, &quot;This is a test&quot;)&gt; _
Public Class TestClass

 Public Sub New(a As integer,b As integer,c As integer)

 End Sub

 Public Sub SayWhoYouAre()

 End Sub
End Class

Module Test


Dim tc As TestClass

Public Sub Main()
 Dim tc_type As Type
 Dim MyAnnotation As Annotation
 Dim obj(2) As Object

 tc = New TestClass(2,3,4)
 tc_type = tc.GetType()
 obj = tc_type.GetCustomAttributes(False)
 MyAnnotation = CType (obj(0), Annotation)

 Console.WriteLine(&quot;Author is '&quot; &amp; MyAnnotation.Author &amp; &quot;'&quot;)
 Console.WriteLine(&quot;Comment is '&quot; &amp; MyAnnotation.Comment &amp; &quot;'&quot;)
End Sub

End Module



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011670.html">[Mono-list] Re: [Gtk-sharp-list] gtk_set_label HELP!
</A></li>
	<LI> Next message: <A HREF="011652.html">[Mono-list] CS0246
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11651">[ date ]</a>
              <a href="thread.html#11651">[ thread ]</a>
              <a href="subject.html#11651">[ subject ]</a>
              <a href="author.html#11651">[ author ]</a>
         </LI>
       </UL>
</body></html>
