<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Using-alias patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tauberer%40for.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011106.html">
   <LINK REL="Next"  HREF="011110.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Using-alias patch
   </H1>
    <B>Joshua Tauberer
    </B> 
    <A HREF="mailto:tauberer%40for.net"
       TITLE="[Mono-list] Using-alias patch">tauberer@for.net
       </A><BR>
    <I>Fri, 10 Jan 2003 12:22:26 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="011106.html">[Mono-list] Compile error - cannot find type 'Form'
</A></li>
        <LI> Next message: <A HREF="011110.html">[Mono-list] Compile error - cannot find type 'Form'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11109">[ date ]</a>
              <a href="thread.html#11109">[ thread ]</a>
              <a href="subject.html#11109">[ subject ]</a>
              <a href="author.html#11109">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.
--------------080405070306060504040502
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit

The attached patch should fix two problems with using-alias.  (I don't 
have CVS access...)

The one that caught my attention was:
	using A = Some.Other.Class;
	...
	A[] x;

	which fails to resolve A[]

And <A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=35567">http://bugzilla.ximian.com/show_bug.cgi?id=35567</A>
	using A = Some.Namespace;
	...
	A.SomeClass[] x;

	which has the same problem but for a different reason

The patch affects mcs/mcs/namespace.cs

Ooo, my first ever patch to an open source project.

Thanks to whoever commits it, if it's okay.

-- 
- Joshua Tauberer

<A HREF="http://taubz.for.net">http://taubz.for.net</A>

** Nothing Unreal Exists **



--------------080405070306060504040502
Content-Type: text/plain;
 name=&quot;arrayspatch&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;arrayspatch&quot;

Index: namespace.cs
===================================================================
RCS file: /mono/mcs/mcs/namespace.cs,v
retrieving revision 1.15
diff -u -p -r1.15 namespace.cs
--- namespace.cs        13 Dec 2002 09:46:54 -0000      1.15
+++ namespace.cs        10 Jan 2003 16:15:34 -0000
@@ -133,12 +133,33 @@ namespace Mono.CSharp {
                {
                        string value = null;

+                       string aliaspostpend = &quot;&quot;;
+                       string lookupname = alias;
+
+                       // Do an alias check on only the part of the name before the first dot,
+                       // if there is a dot and the dot isn't at the start of the name.
+                       int x = lookupname.IndexOf(&quot;.&quot;);
+                       if (x &gt; 0) {
+                               aliaspostpend = lookupname.Substring(x);
+                               lookupname = lookupname.Substring(0, x);
+                       } else {
+                               // Strip off trailing []s for alias lookup
+                               while (lookupname.EndsWith(&quot;[]&quot;)) {
+                                       aliaspostpend += &quot;[]&quot;;
+                                       lookupname = lookupname.Substring(0, lookupname.Length-2);
+                               }
+                       }
+
                        // System.Console.WriteLine (&quot;Lookup &quot; + alias + &quot; in &quot; + name);

                        if (aliases != null)
-                               value = (string) (aliases [alias]);
+                               value = (string) (aliases [lookupname]);
                        if (value == null &amp;&amp; Parent != null)
-                               value = Parent.LookupAlias (alias);
+                               value = Parent.LookupAlias (lookupname);
+
+                       // Add back whatever we chopped off
+                       if (value != null)
+                               value += aliaspostpend;

                        return value;
                }

--------------080405070306060504040502--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011106.html">[Mono-list] Compile error - cannot find type 'Form'
</A></li>
	<LI> Next message: <A HREF="011110.html">[Mono-list] Compile error - cannot find type 'Form'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11109">[ date ]</a>
              <a href="thread.html#11109">[ thread ]</a>
              <a href="subject.html#11109">[ subject ]</a>
              <a href="author.html#11109">[ author ]</a>
         </LI>
       </UL>
</body></html>
