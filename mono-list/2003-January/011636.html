<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rykr%40bellsouth.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011635.html">
   <LINK REL="Next"  HREF="011637.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
   </H1>
    <B>Reggie Burnett
    </B> 
    <A HREF="mailto:rykr%40bellsouth.net"
       TITLE="[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET">rykr@bellsouth.net
       </A><BR>
    <I>Mon, 27 Jan 2003 07:59:47 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="011635.html">[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
</A></li>
        <LI> Next message: <A HREF="011637.html">[Mono-list] Automatic Binding of Variables to Parameters in
 ADO.NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11636">[ date ]</a>
              <a href="thread.html#11636">[ thread ]</a>
              <a href="subject.html#11636">[ subject ]</a>
              <a href="author.html#11636">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes this is what I have heard as well.  I have used XML schema and xsd
many times to construct a &quot;struct&quot; of data out of a database.  I agree
it is the proper way to implement this.

Reggie

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A> [mailto:mono-list-
</I>&gt;<i> <A HREF="mailto:admin@lists.ximian.com">admin@lists.ximian.com</A>] On Behalf Of Adam Treat
</I>&gt;<i> Sent: Monday, January 27, 2003 7:54 AM
</I>&gt;<i> To: Daniel Morgan; Piers Haken; Mono-List
</I>&gt;<i> Subject: RE: [Mono-list] Automatic Binding of Variables to Parameters
</I>in
&gt;<i> ADO.NET
</I>&gt;<i> 
</I>&gt;<i> I imagine this is an ideal problem for Microsoft's new XML
</I>language/tool.
&gt;<i> AFAIK, rumor has it the
</I>&gt;<i> new XML language was created to simplify the mapping between SQL
</I>database
&gt;<i> applications and
</I>&gt;<i> strongly typed XML representations.
</I>&gt;<i> 
</I>&gt;<i> --- Daniel Morgan &lt;<A HREF="mailto:danmorg@sc.rr.com">danmorg@sc.rr.com</A>&gt; wrote:
</I>&gt;<i> &gt; RE: [Mono-list] Automatic Binding of Variables to Parameters in
</I>&gt;<i> ADO.NETMaybe
</I>&gt;<i> &gt; that's what we need then - for someone to start working on the
</I>xsd.exe
&gt;<i> tool
</I>&gt;<i> &gt; for creating type-safe DataSets.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What would be involved in creating this tool?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any takers?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: Piers Haken [mailto:<A HREF="mailto:piersh@friskit.com">piersh@friskit.com</A>]
</I>&gt;<i> &gt; Sent: Monday, January 27, 2003 8:46 AM
</I>&gt;<i> &gt; To: Daniel Morgan; Mono-List
</I>&gt;<i> &gt; Subject: RE: [Mono-list] Automatic Binding of Variables to
</I>Parameters in
&gt;<i> &gt; ADO.NET
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   Microsoft ships a tool called xsd.exe that generates type-safe
</I>&gt;<i> DataSets
</I>&gt;<i> &gt; that do basically this. You give it an XML Schma for your table and
</I>it
&gt;<i> &gt; generates a source file for a class that drives from DataSet but
</I>which
&gt;<i> has
</I>&gt;<i> &gt; typesafe accessors and events. It might be a little heavy-handed for
</I>&gt;<i> what
</I>&gt;<i> &gt; you want, though.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   Piers.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   &gt; -----Original Message-----
</I>&gt;<i> &gt;   &gt; From: Daniel Morgan [mailto:<A HREF="mailto:danmorg@sc.rr.com">danmorg@sc.rr.com</A>]
</I>&gt;<i> &gt;   &gt; Sent: Monday, January 27, 2003 4:52 AM
</I>&gt;<i> &gt;   &gt; To: Mono-List
</I>&gt;<i> &gt;   &gt; Subject: [Mono-list] Automatic Binding of Variables to
</I>&gt;<i> &gt;   &gt; Parameters in ADO.NET
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; Hello,
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; How could I automatically bind variables as paramters in SQL,
</I>&gt;<i> &gt;   &gt; execute the SQL, and get the results automatically.  Would
</I>&gt;<i> &gt;   &gt; this involve creating new attributes to handle this.  I know
</I>&gt;<i> &gt;   &gt; Glade# uses attributes to bind variables.
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; Let's say we have a database table SOMETABLE with the following
</I>&gt;<i> data:
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; ANUM AMONEYVALUE ADATETIME           ABOOLEAN AVALUE
</I>&gt;<i> &gt;   &gt; ==== =========== =================== ======== ======
</I>&gt;<i> &gt;   &gt; 5    152.32      2002-12-31 12:34:56 False    9
</I>&gt;<i> &gt;   &gt; 6    36.45       2001-01-23 05:12:23 True     8
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; Here is a struct that will contain the returned values.
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; public struct MyStruct
</I>&gt;<i> &gt;   &gt; {
</I>&gt;<i> &gt;   &gt;   int someNumber;
</I>&gt;<i> &gt;   &gt;   double someMonetaryValue;
</I>&gt;<i> &gt;   &gt;   DateTime someDataTime;
</I>&gt;<i> &gt;   &gt;   bool someBoolean;
</I>&gt;<i> &gt;   &gt; }
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; Here is the sample code that demonstrates what I am asking.
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; [SomeMagicMethodParameterDataBind(&quot;someValue&quot;]
</I>&gt;<i> &gt;   &gt; public MyStruct GetData (IDbConnection dbcon, int someValue)
</I>&gt;<i> &gt;   &gt; {
</I>&gt;<i> &gt;   &gt;       [SomeMagicDataBind(&quot;mystruct&quot;]
</I>&gt;<i> &gt;   &gt;       MyStruct mystruct;
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt;       string sql =
</I>&gt;<i> &gt;   &gt;          &quot;SELECT aNum, aMoneyValue, &quot; +
</I>&gt;<i> &gt;   &gt;          &quot;       aDateTime, aBoolean &quot; +
</I>&gt;<i> &gt;   &gt;          &quot;FROM sometable &quot; +
</I>&gt;<i> &gt;   &gt;          &quot;WHERE :someValue &quot; +
</I>&gt;<i> &gt;   &gt;          &quot;INTO mystruct.someNumber, mystruct.someMonetaryValue,
</I>&quot; +
&gt;<i> &gt;   &gt;          &quot;     mystruct.someDateTime, mystruct.someBoolean&quot;;
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt;      SomeMagicalClass magic = new SomeMagicalClass(dbcon, sql);
</I>&gt;<i> &gt;   &gt;      magic.ExecuteSQL();
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt;      return mystruct;
</I>&gt;<i> &gt;   &gt; }
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; If I call GetData() with someValue set to 9, I should get a
</I>&gt;<i> &gt;   &gt; MyStruct struct that has the following resuls:
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; MyStrcut mystruct = GetData(dbcon, 9);
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; // expected results
</I>&gt;<i> &gt;   &gt; mystruct.someNumber = 5
</I>&gt;<i> &gt;   &gt; mystruct.someMonetaryValue = 152.32
</I>&gt;<i> &gt;   &gt; mystruct.someDateTime = &quot;2002-12-31 12:34:56&quot;
</I>&gt;<i> &gt;   &gt; mystruct.someBoolean = false
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; This is what I am interested in having.  Now, how do I get
</I>&gt;<i> &gt;   &gt; this?  I'm sure I would need to use reflection heavily and
</I>&gt;<i> &gt;   &gt; attributes. There would be parsing of SQL for parameters,
</I>&gt;<i> &gt;   &gt; create parameters based on the parameters in the SQL, update
</I>&gt;<i> &gt;   &gt; the parameters with information from variables currently in
</I>&gt;<i> &gt;   &gt; scope that match the name of the parameter, set the value of
</I>&gt;<i> &gt;   &gt; any input or input/output parameters from the variable that
</I>&gt;<i> &gt;   &gt; have been bounded earlier, execute the SQL, set the values of
</I>&gt;<i> &gt;   &gt; any return, output, or input/output variables based on the
</I>&gt;<i> &gt;   &gt; results in the parameters.
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; Any ideas?
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; If you ever used RAD programming languages like Delphi,
</I>&gt;<i> &gt;   &gt; Centura/Gupta SQL Windows, PowerBuilder, or Visual Basic, you
</I>&gt;<i> &gt;   &gt; would understand how powerful this can be for database
</I>applications.
&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; Thanks Daniel
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;   &gt; _______________________________________________
</I>&gt;<i> &gt;   &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> &gt;   &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i> &gt;   &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> __________________________________________________
</I>&gt;<i> Do you Yahoo!?
</I>&gt;<i> Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
</I>&gt;<i> <A HREF="http://mailplus.yahoo.com">http://mailplus.yahoo.com</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011635.html">[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
</A></li>
	<LI> Next message: <A HREF="011637.html">[Mono-list] Automatic Binding of Variables to Parameters in
 ADO.NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11636">[ date ]</a>
              <a href="thread.html#11636">[ thread ]</a>
              <a href="subject.html#11636">[ subject ]</a>
              <a href="author.html#11636">[ author ]</a>
         </LI>
       </UL>
</body></html>
