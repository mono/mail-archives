<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rafaelteixeirabr%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011652.html">
   <LINK REL="Next"  HREF="011653.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET
   </H1>
    <B>A Rafael D Teixeira
    </B> 
    <A HREF="mailto:rafaelteixeirabr%40hotmail.com"
       TITLE="[Mono-list] Automatic Binding of Variables to Parameters in ADO.NET">rafaelteixeirabr@hotmail.com
       </A><BR>
    <I>Mon, 27 Jan 2003 18:30:46 -0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="011652.html">[Mono-list] CS0246
</A></li>
        <LI> Next message: <A HREF="011653.html">[Mono-list] Remoting status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11655">[ date ]</a>
              <a href="thread.html#11655">[ thread ]</a>
              <a href="subject.html#11655">[ subject ]</a>
              <a href="author.html#11655">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>RE: [Mono-list] Automatic Binding of Variables to Parameters in 
</I>&gt;<i>ADO.NETMaybe
</I>&gt;<i>that's what we need then - for someone to start working on the xsd.exe tool
</I>&gt;<i>for creating type-safe DataSets.
</I>&gt;<i>
</I>&gt;<i>What would be involved in creating this tool?
</I>
XSD is, in truth, four tools in one.

Because it converts:
- schema to classes (source-form)
- classes (binary-form) to schema
- schema to typed-datasets (source form) (that is what Piers was talking 
about)
- xml to schemas

Probably it´s better to split it in phases, and not trying to have the full 
tool as the first deliverable...

BTW, Datasets implement an interface IBindingList or something like that, 
I'm not sure. This interface serves as an enumerator of bindable fields for 
SWF/ASP.NET controls. We should look at those for glade too. Any class 
derived from Component that implements such interface is bindable to 
SWF/ASP.NET controls, even if not ADO.NET based...

Happy Hackings,

Rafael Teixeira
Brazilian Polymath
Mono, MonoQLE Hacker



&gt;<i>From: &quot;Daniel Morgan&quot; &lt;<A HREF="mailto:danmorg@sc.rr.com">danmorg@sc.rr.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>Any takers?
</I>&gt;<i>
</I>&gt;<i>-----Original Message-----
</I>&gt;<i>From: Piers Haken [mailto:<A HREF="mailto:piersh@friskit.com">piersh@friskit.com</A>]
</I>&gt;<i>Sent: Monday, January 27, 2003 8:46 AM
</I>&gt;<i>To: Daniel Morgan; Mono-List
</I>&gt;<i>Subject: RE: [Mono-list] Automatic Binding of Variables to Parameters in
</I>&gt;<i>ADO.NET
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>   Microsoft ships a tool called xsd.exe that generates type-safe DataSets
</I>&gt;<i>that do basically this. You give it an XML Schma for your table and it
</I>&gt;<i>generates a source file for a class that drives from DataSet but which has
</I>&gt;<i>typesafe accessors and events. It might be a little heavy-handed for what
</I>&gt;<i>you want, though.
</I>&gt;<i>
</I>&gt;<i>   Piers.
</I>&gt;<i>
</I>&gt;<i>   &gt; -----Original Message-----
</I>&gt;<i>   &gt; From: Daniel Morgan [mailto:<A HREF="mailto:danmorg@sc.rr.com">danmorg@sc.rr.com</A>]
</I>&gt;<i>   &gt; Sent: Monday, January 27, 2003 4:52 AM
</I>&gt;<i>   &gt; To: Mono-List
</I>&gt;<i>   &gt; Subject: [Mono-list] Automatic Binding of Variables to
</I>&gt;<i>   &gt; Parameters in ADO.NET
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; Hello,
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; How could I automatically bind variables as paramters in SQL,
</I>&gt;<i>   &gt; execute the SQL, and get the results automatically.  Would
</I>&gt;<i>   &gt; this involve creating new attributes to handle this.  I know
</I>&gt;<i>   &gt; Glade# uses attributes to bind variables.
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; Let's say we have a database table SOMETABLE with the following data:
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; ANUM AMONEYVALUE ADATETIME           ABOOLEAN AVALUE
</I>&gt;<i>   &gt; ==== =========== =================== ======== ======
</I>&gt;<i>   &gt; 5    152.32      2002-12-31 12:34:56 False    9
</I>&gt;<i>   &gt; 6    36.45       2001-01-23 05:12:23 True     8
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; Here is a struct that will contain the returned values.
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; public struct MyStruct
</I>&gt;<i>   &gt; {
</I>&gt;<i>   &gt;   int someNumber;
</I>&gt;<i>   &gt;   double someMonetaryValue;
</I>&gt;<i>   &gt;   DateTime someDataTime;
</I>&gt;<i>   &gt;   bool someBoolean;
</I>&gt;<i>   &gt; }
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; Here is the sample code that demonstrates what I am asking.
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; [SomeMagicMethodParameterDataBind(&quot;someValue&quot;]
</I>&gt;<i>   &gt; public MyStruct GetData (IDbConnection dbcon, int someValue)
</I>&gt;<i>   &gt; {
</I>&gt;<i>   &gt;       [SomeMagicDataBind(&quot;mystruct&quot;]
</I>&gt;<i>   &gt;       MyStruct mystruct;
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt;       string sql =
</I>&gt;<i>   &gt;          &quot;SELECT aNum, aMoneyValue, &quot; +
</I>&gt;<i>   &gt;          &quot;       aDateTime, aBoolean &quot; +
</I>&gt;<i>   &gt;          &quot;FROM sometable &quot; +
</I>&gt;<i>   &gt;          &quot;WHERE :someValue &quot; +
</I>&gt;<i>   &gt;          &quot;INTO mystruct.someNumber, mystruct.someMonetaryValue, &quot; +
</I>&gt;<i>   &gt;          &quot;     mystruct.someDateTime, mystruct.someBoolean&quot;;
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt;      SomeMagicalClass magic = new SomeMagicalClass(dbcon, sql);
</I>&gt;<i>   &gt;      magic.ExecuteSQL();
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt;      return mystruct;
</I>&gt;<i>   &gt; }
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; If I call GetData() with someValue set to 9, I should get a
</I>&gt;<i>   &gt; MyStruct struct that has the following resuls:
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; MyStrcut mystruct = GetData(dbcon, 9);
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; // expected results
</I>&gt;<i>   &gt; mystruct.someNumber = 5
</I>&gt;<i>   &gt; mystruct.someMonetaryValue = 152.32
</I>&gt;<i>   &gt; mystruct.someDateTime = &quot;2002-12-31 12:34:56&quot;
</I>&gt;<i>   &gt; mystruct.someBoolean = false
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; This is what I am interested in having.  Now, how do I get
</I>&gt;<i>   &gt; this?  I'm sure I would need to use reflection heavily and
</I>&gt;<i>   &gt; attributes. There would be parsing of SQL for parameters,
</I>&gt;<i>   &gt; create parameters based on the parameters in the SQL, update
</I>&gt;<i>   &gt; the parameters with information from variables currently in
</I>&gt;<i>   &gt; scope that match the name of the parameter, set the value of
</I>&gt;<i>   &gt; any input or input/output parameters from the variable that
</I>&gt;<i>   &gt; have been bounded earlier, execute the SQL, set the values of
</I>&gt;<i>   &gt; any return, output, or input/output variables based on the
</I>&gt;<i>   &gt; results in the parameters.
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; Any ideas?
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; If you ever used RAD programming languages like Delphi,
</I>&gt;<i>   &gt; Centura/Gupta SQL Windows, PowerBuilder, or Visual Basic, you
</I>&gt;<i>   &gt; would understand how powerful this can be for database applications.
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; Thanks Daniel
</I>&gt;<i>   &gt;
</I>&gt;<i>   &gt; _______________________________________________
</I>&gt;<i>   &gt; Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i>   &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>   &gt;
</I>&gt;<i>
</I>
_________________________________________________________________
Protect your PC - get McAfee.com VirusScan Online 
<A HREF="http://clinic.mcafee.com/clinic/ibuy/campaign.asp?cid=3963">http://clinic.mcafee.com/clinic/ibuy/campaign.asp?cid=3963</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011652.html">[Mono-list] CS0246
</A></li>
	<LI> Next message: <A HREF="011653.html">[Mono-list] Remoting status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11655">[ date ]</a>
              <a href="thread.html#11655">[ thread ]</a>
              <a href="subject.html#11655">[ subject ]</a>
              <a href="author.html#11655">[ author ]</a>
         </LI>
       </UL>
</body></html>
