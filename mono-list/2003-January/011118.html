<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Managed C++ assemblies and Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jasonw%40develop.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011032.html">
   <LINK REL="Next"  HREF="011122.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Managed C++ assemblies and Mono
   </H1>
    <B>Jason Whittington
    </B> 
    <A HREF="mailto:jasonw%40develop.com"
       TITLE="[Mono-list] Managed C++ assemblies and Mono">jasonw@develop.com
       </A><BR>
    <I>Fri, 10 Jan 2003 13:30:29 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="011032.html">[Mono-list] Managed C++ assemblies and Mono
</A></li>
        <LI> Next message: <A HREF="011122.html">[Mono-list] Managed C++ assemblies and Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11118">[ date ]</a>
              <a href="thread.html#11118">[ thread ]</a>
              <a href="subject.html#11118">[ subject ]</a>
              <a href="author.html#11118">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> I would agree that for a native C interface (e.g., GTK+), that would
</I>be
&gt;<i> better.  From what I have seen of P/Invoke, however, it seems
</I>undesirable
&gt;<i> for use with a C++ API due to all the static methods.  
</I>
There's really no other practical way to do interop. This is due to a
weakness in C++, not a weakness in .NET.  C++ was written with
source-code compatibility in mind, not binary compatibility.  As a
result, C++ compilers are free to handle virtual dispatch and name
mangling however they like, making binary interop infeasible. 

As for your desire that things be more OO in nature, get over it :).
P/Invoke is actually way nicer to work with than, say, JNI.  Similar
issues.

&gt;<i>  What it really
</I>&gt;<i> comes down to is that I want to write a class in C# that implements an
</I>&gt;<i> interface defined in unmanaged C++.  An instance of the C# class would
</I>be
&gt;<i> passed through to unmanaged C++ code.  There are a lot of details
</I>&gt;<i> involved with this, but the inherent object-oriented nature does not
</I>seem
&gt;<i> to lend itself well to the structure of P/Invoke-style code.
</I>
Easier to say than to actually do. For this to work the runtime and the
C++ compiler would have to agree on a tightly-specified binary interface
contract. This has been done before; it was called COM (XPCOM on
Linux)[1]. COM interop is even more complex than P/Invoke, especially
when you start passing interface references around instead of flat data
structures.  Lifetime management and managed/unmanaged interaction turns
into a horrible sticky quagmire. Check out Adam Nathan's book[2] or Sam
Gentile's website [3] for more discussion.

Jason

[1]See Chapter 1 of &quot;Essential COM&quot; &quot;COM as a better C++&quot;

[2] &quot;.NET and COM: The Complete Interopability guide&quot;
<A HREF="http://www.amazon.com/exec/obidos/tg/detail/-/0672321432/qid=1042230082/">http://www.amazon.com/exec/obidos/tg/detail/-/0672321432/qid=1042230082/</A>
sr=8-5/ref=sr_8_5/104-6049141-7111136?v=glance&amp;s=books&amp;n=507846

[3] <A HREF="http://radio.weblogs.com/0105852/">http://radio.weblogs.com/0105852/</A>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011032.html">[Mono-list] Managed C++ assemblies and Mono
</A></li>
	<LI> Next message: <A HREF="011122.html">[Mono-list] Managed C++ assemblies and Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11118">[ date ]</a>
              <a href="thread.html#11118">[ thread ]</a>
              <a href="subject.html#11118">[ subject ]</a>
              <a href="author.html#11118">[ author ]</a>
         </LI>
       </UL>
</body></html>
