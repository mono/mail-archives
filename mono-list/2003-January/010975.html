<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Enum declaration; Conflicts and Blame for Interoperability Problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="010973.html">
   <LINK REL="Next"  HREF="010976.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Enum declaration; Conflicts and Blame for Interoperability Problems
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] Enum declaration; Conflicts and Blame for Interoperability Problems">lupus@ximian.com
       </A><BR>
    <I>Tue, 7 Jan 2003 15:10:28 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="010973.html">[Mono-list] Enum declaration; Conflicts and Blame for Interoperability Problems
</A></li>
        <LI> Next message: <A HREF="010976.html">[DotGNU]Re: [Mono-list] Enum declaration; Conflicts and Blame for Interoperability Problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10975">[ date ]</a>
              <a href="thread.html#10975">[ thread ]</a>
              <a href="subject.html#10975">[ subject ]</a>
              <a href="author.html#10975">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/07/03 Jeroen Frijters wrote:
&gt;<i> &gt; The underlying issue, though, is that with the 
</I>&gt;<i> &gt; Reflection.Emit API it's not possible to create enums as
</I>&gt;<i> &gt; produced by csc. Once portable.net
</I>&gt;<i> &gt; will implement Reflection.Emit, it'll have to support this 
</I>&gt;<i> &gt; stuff anyway, just like the MS runtime does.
</I>&gt;<i> 
</I>&gt;<i> ... I would argue that MS's EnumBuilder.DefineLiteral is broken. It would be
</I>&gt;<i> best if it allowed both using the underlying type as well as the enum type,
</I>&gt;<i> but the current behavior as the only option is *not* acceptable (given that
</I>&gt;<i> it is not CLS compliant).
</I>
I don't know off-hand what DefineLiteral accepts. The issue is that you
can't use EnumBuilder in all cases, so mcs doesn't use it and it
'constructs' the enum type by hand. The reason is that an API
is missing (though it's documented): TypeBuilder.DefineNestedEnum().

So the process is to create a TypeBuilder and then DefineField()
as needed. The value of the enum is set with FieldBuilder.SetConstant().
I think SetConstant() accepts values of the underlying type of the enum,
but it can't accept constants of the type itself, because that would
imply calling CreateType() on the enum type (and hence it wouldn't be
possible anymore to create fields in it and set their value with
SetConstant).

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="010973.html">[Mono-list] Enum declaration; Conflicts and Blame for Interoperability Problems
</A></li>
	<LI> Next message: <A HREF="010976.html">[DotGNU]Re: [Mono-list] Enum declaration; Conflicts and Blame for Interoperability Problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10975">[ date ]</a>
              <a href="thread.html#10975">[ thread ]</a>
              <a href="subject.html#10975">[ subject ]</a>
              <a href="author.html#10975">[ author ]</a>
         </LI>
       </UL>
</body></html>
