<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Premake now on SourceForge
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jason%40379.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="011326.html">
   <LINK REL="Next"  HREF="011328.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Premake now on SourceForge
   </H1>
    <B>J. Perkins
    </B> 
    <A HREF="mailto:jason%40379.com"
       TITLE="[Mono-list] Premake now on SourceForge">jason@379.com
       </A><BR>
    <I>17 Jan 2003 08:50:12 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="011326.html">[Mono-list] XSP Error !!!!
</A></li>
        <LI> Next message: <A HREF="011328.html">[Mono-list] Qtsharp and RH8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11327">[ date ]</a>
              <a href="thread.html#11327">[ thread ]</a>
              <a href="subject.html#11327">[ subject ]</a>
              <a href="author.html#11327">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 2003-01-16 at 21:44, Miguel de Icaza wrote:
&gt;<i>    It might be useful if you posted a small summary of how to build
</I>&gt;<i> these pre-make files, because the project looks interesting, but am sure
</I>&gt;<i> others would like to see a small overview on the list.
</I>
There is a short example on the website (<A HREF="http://premake.sf.net/">http://premake.sf.net/</A>), as
well as a complete list of the supported XML tags. But I'll try to give
a quick overview here.

(Actually, this turned out to be pretty long, hey I got on a roll...)

You set up your project in a similar fashion to MSVS: a &quot;project&quot; file
that lists the parts you need to build (like a .dsw/.sln file), and then
&quot;packages&quot; that describe each individual binary target (like the
.dsp/.csproj files).

I am currently playing around with a .NET wrapper for wxWindows. For
this project I have three parts: a DLL written in C which wraps the
wxWin C++ library, a C# library that exposes this API as .NET objects,
and finally a C# executable that tests the whole thing out. It look like
this:

  wx.NET/
    Samples/
      Minimal/
        Minimal.cs
    Src/
      wx.NET/
        Application.cs
        Frame.cs
        Object.cs
        Window.cs
      wx-C/
        application.cxx
        build_environ.h
        frame.cxx
        object.cxx
        window.cxx

At the top level of the project, I create a file called &quot;project.xml&quot;
(you can change the name, but premake looks for this by default) that
looks like this:

  &lt;project&gt;
    &lt;name&gt;wx.NET&lt;/name&gt;
    &lt;bindir&gt;Bin&lt;/bindir&gt;
    &lt;uses&gt;Src/wx-C&lt;/uses&gt;
    &lt;uses&gt;Src/wx.NET&lt;/uses&gt;
    &lt;uses&gt;Samples/Minimal&lt;/uses&gt;
  &lt;/project&gt;

That's pretty easy. The &lt;name&gt; gets used as a file name for the MSVS
workspace/solution file. &lt;bindir&gt; specifies where the compiled binaries
should go (wx.NET/Bin). And then a list of the packages to build.

In Samples/Minimal I create a file called &quot;package.xml&quot; that's just as
short:

  &lt;package&gt;
    &lt;name&gt;Minimal&lt;/name&gt;
    &lt;language&gt;c#&lt;/language&gt;
    &lt;type&gt;winexe&lt;/type&gt;
    &lt;target&gt;minimal&lt;/target&gt;
    &lt;link&gt;System.Drawing&lt;/link&gt;
    &lt;link&gt;wx.NET&lt;/link&gt;
    &lt;file&gt;Minimal.cs&lt;/file&gt;
  &lt;/package&gt;

Again, &lt;name&gt; is used as a file name. Language and type are obvious.
&lt;target&gt; specifies the target filename (minimal.exe) and can include
subdirectories. &lt;link&gt; lists referenced assemblies or dependent
packages. If &lt;link&gt; uses the name of a sibling package, premake will
automatically figure out the right filename to reference and set up the
proper dependencies in the build script. Finally, &lt;file&gt; lists all of
the source files to build.

The Src/wx.NET package.xml file looks very similar, but now I am
building a library:

  &lt;package&gt;
    &lt;name&gt;wx.NET&lt;/name&gt;
    &lt;language&gt;c#&lt;/language&gt;
    &lt;type&gt;library&lt;/type&gt;
    &lt;link&gt;System.Drawing&lt;/link&gt;
    &lt;link&gt;wx-C&lt;/link&gt;
    &lt;file&gt;Application.cs&lt;/file&gt;
    &lt;file&gt;Frame.cs&lt;/file&gt;
    &lt;file&gt;Object.cs&lt;/file&gt;
    &lt;file&gt;Window.cs&lt;/file&gt;
  &lt;/package&gt;

I list wx-C, an unmanaged C DLL, in the list of links. In this case,
premake will just set up the proper dependency in the build script, it
won't actually tell the C# compiler to reference it.

The wx-C/package.xml if kind of long because of all the wxWin settings,
so I'll just do a subset here:

  &lt;package&gt;
    &lt;name&gt;wx-C&lt;/name&gt;
    &lt;language&gt;c++&lt;/language&gt;
    &lt;type&gt;dll&lt;/type&gt;

    &lt;build-flag&gt;no-64bit-checks&lt;/build-flag&gt;

    &lt;linux&gt;
      &lt;build-option&gt;`wx-config --cflags`&lt;/build-option&gt;
      &lt;link-option&gt;`wx-config --libs`&lt;/link-option&gt;
    &lt;/linux&gt;

    &lt;windows&gt;
      &lt;define&gt;WIN32&lt;/define&gt;
      &lt;define&gt;wxUSE_GUI=1&lt;/define&gt;
      &lt;link&gt;comctl32&lt;/link&gt;
      &lt;debug&gt;
        &lt;define&gt;_DEBUG&lt;/define&gt;
        &lt;define&gt;WXDEBUG=1&lt;/define&gt;
        &lt;link&gt;wxmswd&lt;/link&gt;
      &lt;/debug&gt;
      &lt;release&gt;
        &lt;define&gt;NDEBUG&lt;/define&gt;
        &lt;link&gt;wxmsw&lt;/link&gt;
      &lt;/release&gt;
    &lt;/windows&gt;

    &lt;file&gt;build_environ.h&lt;/file&gt;
    &lt;file&gt;application.cxx&lt;/file&gt;
  &lt;/package&gt;

Alright, quickly: &lt;build-flag&gt; is for compiler flags, it gets translated
to the proper command line flags for the platform's compiler.
&lt;build-option&gt; just sticks the enclosed text onto the compiler command
line and assumes that you know what you're doing. &lt;link-option&gt; is the
same for the linker. &lt;linux&gt; and &lt;windows&gt; enclose platform specific
build settings. &lt;debug&gt; and &lt;release&gt; allow different settings for those
builds. &lt;define&gt; sets preprocessor symbols. 

There you go. To make the build scripts, you cd to the top directory and
type one of 'premake -gnu', 'premake -vs6', or 'premake -vs7'. The
command 'premake --clean' removes all build scripts, intermediate files,
and binaries.
  
Sorry for the long post, hope it was helpful.

Jason
379





</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="011326.html">[Mono-list] XSP Error !!!!
</A></li>
	<LI> Next message: <A HREF="011328.html">[Mono-list] Qtsharp and RH8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11327">[ date ]</a>
              <a href="thread.html#11327">[ thread ]</a>
              <a href="subject.html#11327">[ subject ]</a>
              <a href="author.html#11327">[ author ]</a>
         </LI>
       </UL>
</body></html>
