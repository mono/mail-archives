<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] System.Xml bug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jarek%40atm.com.pl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="009276.html">
   <LINK REL="Next"  HREF="009278.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] System.Xml bug
   </H1>
    <B>Jaroslaw Kowalski
    </B> 
    <A HREF="mailto:jarek%40atm.com.pl"
       TITLE="[Mono-list] System.Xml bug">jarek@atm.com.pl
       </A><BR>
    <I>Sat, 26 Oct 2002 23:11:01 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="009276.html">[Mono-list] Mono on GNU-Darwin
</A></li>
        <LI> Next message: <A HREF="009278.html">[Mono-list] System.Xml bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9277">[ date ]</a>
              <a href="thread.html#9277">[ thread ]</a>
              <a href="subject.html#9277">[ subject ]</a>
              <a href="author.html#9277">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

------=_NextPart_000_0015_01C27D44.F39806B0
Content-Type: text/plain;
	charset=&quot;iso-8859-2&quot;
Content-Transfer-Encoding: 7bit

Hi all!

Looks like there's been some regression in System.Xml classes:
Consider the (kind of trivial) code in xmlbug.cs (attached) and test.xml
(also attached)

On .NET it runs ok. On Mono, it produces:
========
Unhandled Exception: System.InvalidOperationException: The requested
operation cannot be performed
in &lt;0x000b1&gt; 00 System.Xml.XmlDocumentNavigator:get_NodeType ()
in &lt;0x00020&gt; 00 System.Xml.XPath.NodeNameTest:Match
(System.Xml.Xsl.XsltContext,System.Xml.XPath.XPathNavigator)
in &lt;0x00034&gt; 00 System.Xml.XPath.AxisIterator:MoveNext ()
in &lt;0x0001a&gt; 00 System.Xml.XPath.SlashIterator:MoveNext ()
in &lt;0x0010e&gt; 00 System.Xml.XmlNode:SelectNodes
(string,System.Xml.XmlNamespaceManager)
in &lt;0x0006d&gt; 00 .Bug1:Main (string[])
========

I found that the problem is related to innocent '&lt;?xml version=&quot;1.0&quot; ?&gt;' at
the top of 'test.xml'. If I remove it, everything is OK.
I'm 100% sure that it used to work properly on mono but is broken for some
time now.

Regards,

Jarek

------=_NextPart_000_0015_01C27D44.F39806B0
Content-Type: text/plain;
	name=&quot;xmlbug.cs&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=&quot;xmlbug.cs&quot;

using System;
using System.Xml;

public class Bug1
{
	public static void Main(string[] args)
	{
		XmlDocument doc = new XmlDocument();

		doc.Load(&quot;test.xml&quot;);

		foreach (XmlElement el in doc.SelectNodes(&quot;xxx/yyy&quot;))
		{
			Console.WriteLine(el.InnerXml);
		}
	}
};
------=_NextPart_000_0015_01C27D44.F39806B0
Content-Type: text/xml;
	name=&quot;test.xml&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=&quot;test.xml&quot;

&lt;?xml version=&quot;1.0&quot; ?&gt;
&lt;xxx&gt;
    &lt;yyy&gt;item1&lt;/yyy&gt;
    &lt;yyy&gt;item2&lt;/yyy&gt;
    &lt;yyy&gt;item3&lt;/yyy&gt;
    &lt;yyy&gt;item4&lt;/yyy&gt;
&lt;/xxx&gt;

------=_NextPart_000_0015_01C27D44.F39806B0--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="009276.html">[Mono-list] Mono on GNU-Darwin
</A></li>
	<LI> Next message: <A HREF="009278.html">[Mono-list] System.Xml bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9277">[ date ]</a>
              <a href="thread.html#9277">[ thread ]</a>
              <a href="subject.html#9277">[ subject ]</a>
              <a href="author.html#9277">[ author ]</a>
         </LI>
       </UL>
</body></html>
