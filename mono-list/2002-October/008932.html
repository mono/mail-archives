<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ODBC.NET Provider on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:danmorg%40sc.rr.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="009226.html">
   <LINK REL="Next"  HREF="008937.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ODBC.NET Provider on Windows
   </H1>
    <B>Daniel Morgan
    </B> 
    <A HREF="mailto:danmorg%40sc.rr.com"
       TITLE="[Mono-list] ODBC.NET Provider on Windows">danmorg@sc.rr.com
       </A><BR>
    <I>Fri, 11 Oct 2002 03:49:46 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="009226.html">[Mono-list] Help needed with XSLT transformations
 (documentation browser)
</A></li>
        <LI> Next message: <A HREF="008937.html">[Mono-list] ODBC.NET Provider on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8932">[ date ]</a>
              <a href="thread.html#8932">[ thread ]</a>
              <a href="subject.html#8932">[ subject ]</a>
              <a href="author.html#8932">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Rodrigo and Brian

I have tried to get the Odbc.net provider to use Microsoft Window's native
ODBC library which is odbc32.dll by changing the DllImport from &quot;libodbc&quot; to
&quot;odbc32&quot;.  The library apparently loads,
but I don't know what the errors are for.

Any ideas?

This is the results I got:

<A HREF="mailto:DanielMorgan@DANPC">DanielMorgan@DANPC</A> ~/mono/mcs/class/System.Data/Test
$ mono OdbcTest.exe
ERROR: SQLAllocHandle: &lt;528285696&gt;
ERROR: SQLSetEnvAttr: &lt;528285696&gt;
ODBCInit Complete.
ERROR: SQLAllocHandle(hdbc): &lt;528285696&gt;
ERROR: SQLConnect: &lt;65535&gt;
ERROR: SQLAlloc(Prepare): &lt;528351231&gt;
ERROR: SQLPrepare: &lt;528351230&gt;
ERROR: SQLExecute: &lt;528351230&gt;
ERROR: SQLCancel: &lt;528351230&gt;

Unhandled Exception: System.NotImplementedException: The requested feature
is no
t yet implemented
in &lt;0x0002b&gt; 00 System.Data.Odbc.OdbcCommand:Dispose (bool)
in &lt;0x00015&gt; 00 System.ComponentModel.Component:Dispose ()
in &lt;0x00174&gt; 00 Test.OdbcTest.OdbcTest:Main (string[])

I have a ODBC.net test named OdbcTest.cs that works on Windows XP
using .NET 1.1 Beta, but not Mono:

using System;
using System.Data;
using System.Data.Odbc;

namespace Test.OdbcTest
{
	class OdbcTest
	{
		[STAThread]
		static void Main(string[] args)
		{
			OdbcConnection dbcon = new OdbcConnection();
			// connection string to a Microsoft SQL Server 2000 database
			dbcon.ConnectionString =
				&quot;DRIVER={SQL Server};&quot; +
				&quot;SERVER=(local);&quot; +
				&quot;Trusted_connection=true;&quot; +
				&quot;DATABASE=pubs;&quot;;

			dbcon.Open();

			OdbcCommand dbcmd = new OdbcCommand();
			dbcmd.Connection = dbcon;
			dbcmd.CommandType = CommandType.Text;
			dbcmd.CommandText = &quot;SELECT lname FROM employee&quot;;

			OdbcDataReader reader;
			reader = (OdbcDataReader) dbcmd.ExecuteReader();

			while(reader.Read()) {
				Console.WriteLine(&quot;Last Name: &quot; + reader[0].ToString());
			}
			reader.Close();
			dbcmd.Dispose();
			dbcon.Close();
		}
	}
}




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="009226.html">[Mono-list] Help needed with XSLT transformations
 (documentation browser)
</A></li>
	<LI> Next message: <A HREF="008937.html">[Mono-list] ODBC.NET Provider on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8932">[ date ]</a>
              <a href="thread.html#8932">[ thread ]</a>
              <a href="subject.html#8932">[ subject ]</a>
              <a href="author.html#8932">[ author ]</a>
         </LI>
       </UL>
</body></html>
