<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] ODBC.NET Provider on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:brianlritchie%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="008932.html">
   <LINK REL="Next"  HREF="008945.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] ODBC.NET Provider on Windows
   </H1>
    <B>Brian Ritchie
    </B> 
    <A HREF="mailto:brianlritchie%40hotmail.com"
       TITLE="[Mono-list] ODBC.NET Provider on Windows">brianlritchie@hotmail.com
       </A><BR>
    <I>Fri, 11 Oct 2002 09:17:17 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="008932.html">[Mono-list] ODBC.NET Provider on Windows
</A></li>
        <LI> Next message: <A HREF="008945.html">[Mono-list] ODBC.NET Provider on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8937">[ date ]</a>
              <a href="thread.html#8937">[ thread ]</a>
              <a href="subject.html#8937">[ subject ]</a>
              <a href="author.html#8937">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Guys,

I'm able to duplicate the problem.  The very first call into odbc32 is
failing.  It is a pretty basic call...it only allocates the first handle.
So, it appears to be some sort of interop problem with the dll.  I'm still
checking into it.  Let me know if you have any thoughts.

Brian

----- Original Message -----
From: &quot;Daniel Morgan&quot; &lt;<A HREF="mailto:danmorg@sc.rr.com">danmorg@sc.rr.com</A>&gt;
To: &quot;Mono-List&quot; &lt;<A HREF="mailto:mono-list@ximian.com">mono-list@ximian.com</A>&gt;
Sent: Friday, October 11, 2002 3:49 AM
Subject: [Mono-list] ODBC.NET Provider on Windows


&gt;<i> Rodrigo and Brian
</I>&gt;<i>
</I>&gt;<i> I have tried to get the Odbc.net provider to use Microsoft Window's native
</I>&gt;<i> ODBC library which is odbc32.dll by changing the DllImport from &quot;libodbc&quot;
</I>to
&gt;<i> &quot;odbc32&quot;.  The library apparently loads,
</I>&gt;<i> but I don't know what the errors are for.
</I>&gt;<i>
</I>&gt;<i> Any ideas?
</I>&gt;<i>
</I>&gt;<i> This is the results I got:
</I>&gt;<i>
</I>&gt;<i> <A HREF="mailto:DanielMorgan@DANPC">DanielMorgan@DANPC</A> ~/mono/mcs/class/System.Data/Test
</I>&gt;<i> $ mono OdbcTest.exe
</I>&gt;<i> ERROR: SQLAllocHandle: &lt;528285696&gt;
</I>&gt;<i> ERROR: SQLSetEnvAttr: &lt;528285696&gt;
</I>&gt;<i> ODBCInit Complete.
</I>&gt;<i> ERROR: SQLAllocHandle(hdbc): &lt;528285696&gt;
</I>&gt;<i> ERROR: SQLConnect: &lt;65535&gt;
</I>&gt;<i> ERROR: SQLAlloc(Prepare): &lt;528351231&gt;
</I>&gt;<i> ERROR: SQLPrepare: &lt;528351230&gt;
</I>&gt;<i> ERROR: SQLExecute: &lt;528351230&gt;
</I>&gt;<i> ERROR: SQLCancel: &lt;528351230&gt;
</I>&gt;<i>
</I>&gt;<i> Unhandled Exception: System.NotImplementedException: The requested feature
</I>&gt;<i> is no
</I>&gt;<i> t yet implemented
</I>&gt;<i> in &lt;0x0002b&gt; 00 System.Data.Odbc.OdbcCommand:Dispose (bool)
</I>&gt;<i> in &lt;0x00015&gt; 00 System.ComponentModel.Component:Dispose ()
</I>&gt;<i> in &lt;0x00174&gt; 00 Test.OdbcTest.OdbcTest:Main (string[])
</I>&gt;<i>
</I>&gt;<i> I have a ODBC.net test named OdbcTest.cs that works on Windows XP
</I>&gt;<i> using .NET 1.1 Beta, but not Mono:
</I>&gt;<i>
</I>&gt;<i> using System;
</I>&gt;<i> using System.Data;
</I>&gt;<i> using System.Data.Odbc;
</I>&gt;<i>
</I>&gt;<i> namespace Test.OdbcTest
</I>&gt;<i> {
</I>&gt;<i> class OdbcTest
</I>&gt;<i> {
</I>&gt;<i> [STAThread]
</I>&gt;<i> static void Main(string[] args)
</I>&gt;<i> {
</I>&gt;<i> OdbcConnection dbcon = new OdbcConnection();
</I>&gt;<i> // connection string to a Microsoft SQL Server 2000 database
</I>&gt;<i> dbcon.ConnectionString =
</I>&gt;<i> &quot;DRIVER={SQL Server};&quot; +
</I>&gt;<i> &quot;SERVER=(local);&quot; +
</I>&gt;<i> &quot;Trusted_connection=true;&quot; +
</I>&gt;<i> &quot;DATABASE=pubs;&quot;;
</I>&gt;<i>
</I>&gt;<i> dbcon.Open();
</I>&gt;<i>
</I>&gt;<i> OdbcCommand dbcmd = new OdbcCommand();
</I>&gt;<i> dbcmd.Connection = dbcon;
</I>&gt;<i> dbcmd.CommandType = CommandType.Text;
</I>&gt;<i> dbcmd.CommandText = &quot;SELECT lname FROM employee&quot;;
</I>&gt;<i>
</I>&gt;<i> OdbcDataReader reader;
</I>&gt;<i> reader = (OdbcDataReader) dbcmd.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i> while(reader.Read()) {
</I>&gt;<i> Console.WriteLine(&quot;Last Name: &quot; + reader[0].ToString());
</I>&gt;<i> }
</I>&gt;<i> reader.Close();
</I>&gt;<i> dbcmd.Dispose();
</I>&gt;<i> dbcon.Close();
</I>&gt;<i> }
</I>&gt;<i> }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@ximian.com">Mono-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="008932.html">[Mono-list] ODBC.NET Provider on Windows
</A></li>
	<LI> Next message: <A HREF="008945.html">[Mono-list] ODBC.NET Provider on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8937">[ date ]</a>
              <a href="thread.html#8937">[ thread ]</a>
              <a href="subject.html#8937">[ subject ]</a>
              <a href="author.html#8937">[ author ]</a>
         </LI>
       </UL>
</body></html>
