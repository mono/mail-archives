<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] How to set parameters for RSACryptoServiceProvider
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:spouliot%40videotron.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016726.html">
   <LINK REL="Next"  HREF="016705.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] How to set parameters for RSACryptoServiceProvider
   </H1>
    <B>Sebastien Pouliot
    </B> 
    <A HREF="mailto:spouliot%40videotron.ca"
       TITLE="[Mono-list] How to set parameters for RSACryptoServiceProvider">spouliot@videotron.ca
       </A><BR>
    <I>Tue, 04 Nov 2003 20:18:01 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="016726.html">[Mono-list] How to set parameters for RSACryptoServiceProvider
</A></li>
        <LI> Next message: <A HREF="016705.html">[Mono-list] Compiling from Source || Segmentation Fault
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16752">[ date ]</a>
              <a href="thread.html#16752">[ thread ]</a>
              <a href="subject.html#16752">[ subject ]</a>
              <a href="author.html#16752">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.

--Boundary_(ID_LzvAhUKPp3QMqpeVM/Qxsw)
Content-type: text/plain; charset=us-ascii
Content-transfer-encoding: 7BIT

MessageGoran,

Are you having this problem with Mono or the MS framework ?

I ask because right now my mono setup doesn't work :-( but I'm able to
duplicate the bug on the MS framework (anyway your VB code can only work
under Windows and IIRC the exception message &quot;Bad Key&quot; is only shown in
Windows).

Anyway at first look it seems that MS requires the full parameters for
importing a private key - with no (known) good reason. This isn't (supposed
to be) the case for Mono - you can have a look at
/mcs/class/corlib/Mono.Security/RSAManaged.cs. Please fill a bug into
bugzilla if this doesn't work on Mono
(<A HREF="http://bugzilla.ximian.com/enter_bug.cgi?product=Mono%2FClass%20Libraries">http://bugzilla.ximian.com/enter_bug.cgi?product=Mono%2FClass%20Libraries</A>).

As for solution for the MS framework:

a.    Report the bug to Microsoft (this is a long term solution but if you
don't complain it won't get fixed);
b.    Keep all exported parameters for the private key (easy solution,
faster decryption but requires extra space);
c.    Recalculate the other parameters (time consuming);
d.    Use Mono's RSAManaged implementation (on both Windows and Mono's)

Sebastien Pouliot
Security Architect, Motus Technologies, <A HREF="http://www.motus.com">http://www.motus.com</A>
work: <A HREF="mailto:spouliot@motus.com">spouliot@motus.com</A>
home: <A HREF="mailto:spouliot@videotron.ca">spouliot@videotron.ca</A>
blog: <A HREF="http://pages.infinit.net/ctech/poupou.html">http://pages.infinit.net/ctech/poupou.html</A>


  -----Original Message-----
  From: <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>
[mailto:<A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>]On Behalf Of Goran Milenkovic
  Sent: 3 novembre 2003 08:56
  To: '<A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>'
  Subject: [Mono-list] How to set parameters for RSACryptoServiceProvider


  The following VB.NET example should generate the new key pair, store
generated values localy, then encrypt the test string using public key and
decrypt it using private key. However, it works only if all parameters
(P,Q,DP,DQ,InverseQ &amp; D) are given for the decryption, but not if only D is
given. That means that for simple decryption private key is not enough, but
also all of the other parameters ??

  If you change boolean value OnlyD to True, assuming that only D should be
enough for decryption, then it works. Otherwise, an exception occurs (&quot;Bad
Key&quot;). Is there any solution for this ?



  '-----------------------------

  Dim OnlyD As Boolean = False

  Dim TestResult1() As Byte

  Dim TestResult2() As Byte

  '---Generate the key pair and export all of it's parameters into the
RSAParams1

  Dim RSAParams1 As RSAParameters = New RSAParameters

  Dim RSAObj1 As RSACryptoServiceProvider = New RSACryptoServiceProvider

  RSAParams1 = RSAObj1.ExportParameters(True)

  '---Get all parameters into local variables

  Dim myModulus As Byte() = RSAParams1.Modulus

  Dim myExponent As Byte() = RSAParams1.Exponent

  Dim myPrivateKey As Byte() = RSAParams1.D

  Dim myP As Byte() = RSAParams1.P

  Dim myQ As Byte() = RSAParams1.Q

  Dim myDP As Byte() = RSAParams1.DP

  Dim myDQ As Byte() = RSAParams1.DQ

  Dim myIQ As Byte() = RSAParams1.InverseQ

  '---Create new RSACryproProvider

  Dim RSAParams2 As RSAParameters = New RSAParameters

  Dim RSAObj2 As RSACryptoServiceProvider = New RSACryptoServiceProvider

  '---Set the public key

  RSAParams2.Modulus = myModulus

  RSAParams2.Exponent = myExponent

  RSAObj2.ImportParameters(RSAParams2)

  '---Encrypt with public key

  TestResult1 = RSAObj2.Encrypt(Encoding.ASCII.GetBytes(&quot;TEST&quot;), False)

  MsgBox(&quot;Encrypted&quot;)

  '---Now set the private key

  RSAParams2.D = myPrivateKey

  If (Not OnlyD) Then

      RSAParams2.P = myP

      RSAParams2.Q = myQ

      RSAParams2.DP = myDP

      RSAParams2.DQ = myDQ

      RSAParams2.InverseQ = myIQ

  End If

  RSAObj2.ImportParameters(RSAParams2)


  '---Decrypt with private key

  TestResult2 = RSAObj2.Decrypt(TestResult1, False)

  MsgBox(&quot;Decrypted. Original string is: &quot; &amp;
Encoding.ASCII.GetString(TestResult2))

  '-----------------------------



  Many Thanks,

  Goran

  <A HREF="mailto:gmilenkovic@irdetoaccess.com">gmilenkovic@irdetoaccess.com</A>


  This e-mail and any attachments are CONFIDENTIAL and intended solely for
the use of the individual(s) to whom it is addressed. It can contain
proprietary confidential information and/or be subject to legal privilege
and/or subject to a non-disclosure Agreement. Unauthorized use, disclosure
or copying is strictly prohibited. If you are not the/an addressee and are
in possession of this e-mail, please notify us immediately.




--Boundary_(ID_LzvAhUKPp3QMqpeVM/Qxsw)
Content-type: text/html; charset=us-ascii
Content-transfer-encoding: 7BIT

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;
&lt;HTML xmlns:o = 
&quot;urn:schemas-microsoft-com:office:office&quot;&gt;&lt;HEAD&gt;&lt;TITLE&gt;Message&lt;/TITLE&gt;
&lt;META http-equiv=Content-Type content=&quot;text/html; charset=US-ASCII&quot;&gt;
&lt;META content=&quot;MSHTML 6.00.2800.1264&quot; name=GENERATOR&gt;&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;DIV&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;Goran,&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN class=609205300-05112003&gt;Are 
you having this problem with Mono or the MS framework ?&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN class=609205300-05112003&gt;I ask 
because r&lt;/SPAN&gt;&lt;/FONT&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;ight now my mono setup doesn't work :-( but I'm able to 
duplicate the bug on the MS framework (anyway your VB code can only work under 
Windows and IIRC the exception message &quot;Bad Key&quot; is only shown in 
Windows).&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;FONT&gt;&lt;SPAN 
class=609205300-05112003&gt;Anyway at first look it seems that MS requires the full 
parameters for importing a private key - with no (known) good reason. 
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT 
size=2&gt;&lt;FONT&gt;&lt;SPAN class=609205300-05112003&gt;This isn't (supposed to be) the case 
for Mono - you can have a look at 
/mcs/class/corlib/Mono.Security/RSAManaged.cs&lt;/SPAN&gt;&lt;/FONT&gt;.&lt;SPAN 
class=609205300-05112003&gt; Please fill a bug into bugzilla if this doesn't work 
on Mono (&lt;A 
href=&quot;<A HREF="http://bugzilla.ximian.com/enter_bug.cgi?product=Mono%2FClass%20Libraries"">http://bugzilla.ximian.com/enter_bug.cgi?product=Mono%2FClass%20Libraries&quot;</A>&gt;<A HREF="http://bugzilla.ximian.com/enter_bug.cgi?product=Mono%2FClass%20Libraries</A">http://bugzilla.ximian.com/enter_bug.cgi?product=Mono%2FClass%20Libraries&lt;/A</A>&gt;).&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;As for solution for the MS 
framework:&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;a.&amp;nbsp;&amp;nbsp;&amp;nbsp; Report the bug to Microsoft (this 
is a long term solution but if you don't complain it won't get 
fixed);&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;b.&amp;nbsp;&amp;nbsp;&amp;nbsp; Keep all exported parameters for 
the private key (easy solution, faster decryption but requires extra 
space);&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;c.&amp;nbsp;&amp;nbsp;&amp;nbsp; Recalculate the other parameters 
(time consuming);&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial&gt;&lt;FONT color=#0000ff&gt;&lt;FONT size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;d.&amp;nbsp;&amp;nbsp;&amp;nbsp; Use Mono's RSAManaged 
implementation (on both Windows and Mono's)&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;
&lt;DIV&gt;&lt;FONT face=Arial color=#0000ff size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;FONT face=Arial color=#0000ff 
size=2&gt;&lt;SPAN class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;FONT face=Arial 
color=#0000ff size=2&gt;&lt;SPAN class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;FONT 
face=Arial color=#0000ff size=2&gt;&lt;SPAN 
class=609205300-05112003&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
&lt;P&gt;&lt;FONT size=2&gt;Sebastien Pouliot&lt;BR&gt;Security Architect, Motus Technologies, &lt;A 
href=&quot;<A HREF="http://www.motus.com/"">http://www.motus.com/&quot;</A> target=_blank&gt;<A HREF="http://www.motus.com</A">http://www.motus.com&lt;/A</A>&gt;&lt;BR&gt;work: 
<A HREF="mailto:spouliot@motus.com">spouliot@motus.com</A>&lt;BR&gt;home: <A HREF="mailto:spouliot@videotron.ca">spouliot@videotron.ca</A>&lt;BR&gt;blog: &lt;A 
href=&quot;<A HREF="http://pages.infinit.net/ctech/poupou.html"">http://pages.infinit.net/ctech/poupou.html&quot;</A> 
target=_blank&gt;<A HREF="http://pages.infinit.net/ctech/poupou.html</A">http://pages.infinit.net/ctech/poupou.html&lt;/A</A>&gt;&lt;BR&gt;&amp;nbsp;&lt;/FONT&gt; 
&lt;/P&gt;
&lt;BLOCKQUOTE dir=ltr style=&quot;MARGIN-RIGHT: 0px&quot;&gt;
  &lt;DIV class=OutlookMessageHeader dir=ltr align=left&gt;&lt;FONT face=Tahoma 
  size=2&gt;-----Original Message-----&lt;BR&gt;&lt;B&gt;From:&lt;/B&gt; 
  <A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A> 
  [mailto:<A HREF="mailto:mono-list-admin@lists.ximian.com">mono-list-admin@lists.ximian.com</A>]&lt;B&gt;On Behalf Of &lt;/B&gt;Goran 
  Milenkovic&lt;BR&gt;&lt;B&gt;Sent:&lt;/B&gt; 3 novembre 2003 08:56&lt;BR&gt;&lt;B&gt;To:&lt;/B&gt; 
  '<A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>'&lt;BR&gt;&lt;B&gt;Subject:&lt;/B&gt; [Mono-list] How to set 
  parameters for RSACryptoServiceProvider&lt;BR&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=Arial&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  style=&quot;mso-spacerun: yes&quot;&gt;&lt;SPAN class=910164013-03112003&gt;The following 
  VB.NET&amp;nbsp;example should generate the new key pair, store generated values 
  localy, then encrypt the test string using public&amp;nbsp;key and decrypt it 
  using private key. However, it works only if all parameters 
  (P,Q,DP,DQ,InverseQ &amp;amp; D) are given for the decryption, but not if only D 
  is given. That means that for simple decryption private key is not enough, but 
  also all of the other parameters ?? &lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  style=&quot;mso-spacerun: yes&quot;&gt;&lt;SPAN class=910164013-03112003&gt;If you change boolean 
  value OnlyD to True, assuming that only D should be enough for decryption, 
  then it works. Otherwise, an exception occurs (&quot;Bad Key&quot;). Is there any 
  solution for this ?&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  style=&quot;mso-spacerun: yes&quot;&gt;&lt;SPAN 
  class=910164013-03112003&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  style=&quot;mso-spacerun: yes&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  style=&quot;mso-spacerun: yes&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;&lt;SPAN 
  class=910164013-03112003&gt;--------------------------&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/P&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim OnlyD As Boolean = 
  False&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim TestResult1() As 
  Byte&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim TestResult2() As 
  Byte&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;Generate the key pair and export all of 
  it's parameters into the RSAParams1&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim RSAParams1 As 
  RSAParameters = New RSAParameters&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim RSAObj1 As 
  RSACryptoServiceProvider = New RSACryptoServiceProvider&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;RSAParams1 = 
  RSAObj1.ExportParameters(True)&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;Get all parameters into local 
  variables&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myModulus As Byte() = 
  RSAParams1.Modulus&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myExponent As Byte() = 
  RSAParams1.Exponent&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myPrivateKey As Byte() 
  = RSAParams1.D&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myP As Byte() = 
  RSAParams1.P&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myQ As Byte() = 
  RSAParams1.Q&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myDP As Byte() = 
  RSAParams1.DP&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myDQ As Byte() = 
  RSAParams1.DQ&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim myIQ As Byte() = 
  RSAParams1.InverseQ&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;Create new 
  RSACryproProvider&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim RSAParams2 As 
  RSAParameters = New RSAParameters&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;Dim RSAObj2 As 
  RSACryptoServiceProvider = New RSACryptoServiceProvider&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;Set the public key&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;RSAParams2.Modulus = 
  myModulus&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;RSAParams2.Exponent = 
  myExponent&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;RSAObj2.ImportParameters(RSAParams2)&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;Encrypt with public 
  key&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;TestResult1 = 
  RSAObj2.Encrypt(Encoding.ASCII.GetBytes(&quot;TEST&quot;), False)&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;MsgBox(&quot;Encrypted&quot;)&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;Now set the private 
  key&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;RSAParams2.D = 
  myPrivateKey&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;If (Not OnlyD) 
  Then&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  class=910164013-03112003&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/SPAN&gt;RSAParams2.P = 
  myP&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  class=910164013-03112003&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/SPAN&gt;RSAParams2.Q = 
  myQ&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  class=910164013-03112003&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/SPAN&gt;RSAParams2.DP = 
  myDP&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  class=910164013-03112003&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/SPAN&gt;RSAParams2.DQ = 
  myDQ&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  class=910164013-03112003&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/SPAN&gt;RSAParams2.InverseQ = 
  myIQ&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;End 
  If&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;RSAObj2.ImportParameters(RSAParams2)&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;Decrypt with private 
  key&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;TestResult2 = 
  RSAObj2.Decrypt(TestResult1, False)&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;MsgBox(&quot;Decrypted. 
  Original string is: &quot; &amp;amp; 
  Encoding.ASCII.GetString(TestResult2))&lt;/SPAN&gt;&lt;/P&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;'&lt;SPAN 
  class=910164013-03112003&gt;---&lt;/SPAN&gt;&lt;SPAN 
  class=910164013-03112003&gt;--------------------------&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/P&gt;&lt;/SPAN&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;SPAN 
  class=910164013-03112003&gt;&lt;FONT face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;o:p&gt;&lt;SPAN 
  class=910164013-03112003&gt;Many Thanks,&lt;/SPAN&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;o:p&gt;&lt;SPAN 
  class=910164013-03112003&gt;Goran&lt;/SPAN&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal style=&quot;MARGIN: 0in 0in 0pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'&quot;&gt;&lt;o:p&gt;&lt;SPAN 
  class=910164013-03112003&gt;&lt;A 
  href=&quot;mailto:<A HREF="mailto:gmilenkovic@irdetoaccess.com">gmilenkovic@irdetoaccess.com</A>&quot;&gt;<A HREF="mailto:gmilenkovic@irdetoaccess.com">gmilenkovic@irdetoaccess.com</A>&lt;/A&gt;&lt;/SPAN&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;&lt;/FONT&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=Arial size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;
  &lt;DIV align=left&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 7pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-family: Verdana&quot;&gt;
  &lt;P class=MsoNormal 
  style=&quot;MARGIN: 0in 0in 0pt; mso-layout-grid-align: none; tab-stops: 62.35pt 85.05pt 153.1pt 175.75pt 243.8pt 266.5pt 334.55pt 357.2pt 425.25pt&quot;&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 8pt; COLOR: red; FONT-FAMILY: Verdana; mso-bidi-font-family: Verdana&quot;&gt;This 
  e-mail and any attachments are CONFIDENTIAL and intended solely for the use of 
  the individual(s) to whom it&lt;/SPAN&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: Arial&quot;&gt; i&lt;/SPAN&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 8pt; COLOR: red; FONT-FAMILY: Verdana; mso-bidi-font-family: Verdana&quot;&gt;s 
  addressed. It can contain proprietary confidential information and/or be 
  subject to legal privilege and/or subject to a non-disclosure Agreement. 
  Unauthorized use, disclosure or copying is strictly prohibited. If you are not 
  the/an addressee and are in possession of this e-mail, please notify us 
  immediately.&lt;o:p&gt;&lt;/o:p&gt;&lt;/SPAN&gt;&lt;/P&gt;
  &lt;P class=MsoNormal 
  style=&quot;MARGIN: 0in 0in 0pt; mso-layout-grid-align: none; mso-pagination: none&quot;&gt;&lt;FONT 
  face=Arial color=#000000 size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN 
  style=&quot;FONT-SIZE: 8pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-family: Verdana&quot;&gt;&lt;FONT 
  face=Verdana color=#ff0000 size=1&gt;&lt;FONT face=Arial color=#000000 
  size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/P&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;
  &lt;DIV&gt;&lt;FONT face=Arial size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;

--Boundary_(ID_LzvAhUKPp3QMqpeVM/Qxsw)--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016726.html">[Mono-list] How to set parameters for RSACryptoServiceProvider
</A></li>
	<LI> Next message: <A HREF="016705.html">[Mono-list] Compiling from Source || Segmentation Fault
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16752">[ date ]</a>
              <a href="thread.html#16752">[ thread ]</a>
              <a href="subject.html#16752">[ subject ]</a>
              <a href="author.html#16752">[ author ]</a>
         </LI>
       </UL>
</body></html>
