<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] MySQL / Firebird
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:sijmen_mulder%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="017018.html">
   <LINK REL="Next"  HREF="017020.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] MySQL / Firebird
   </H1>
    <B>Sijmen Mulder
    </B> 
    <A HREF="mailto:sijmen_mulder%40hotmail.com"
       TITLE="[Mono-list] MySQL / Firebird">sijmen_mulder@hotmail.com
       </A><BR>
    <I>Thu, 20 Nov 2003 20:25:19 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="017018.html">[Mono-list] Initial release of SAX API for C#
</A></li>
        <LI> Next message: <A HREF="017020.html">[Mono-list] mod_mono - Apache 1.3? I have 2.0!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17019">[ date ]</a>
              <a href="thread.html#17019">[ thread ]</a>
              <a href="subject.html#17019">[ subject ]</a>
              <a href="author.html#17019">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you for that explanation (which is very usefull), but things are not 
working correctly over here:

<A HREF="mailto:sijmen@sijmen">sijmen@sijmen</A> sql $ mcs /r:ByteFX.Data.dll test.cs
test.cs(5) error CS0246: Cannot find type `MySqlConnection'
test.cs(1) error CS0246: The namespace `ByteFX.Data.MySqlClient' can not be 
found (missing assembly reference?)
Compilation failed: 2 error(s), 0 warnings

<A HREF="mailto:sijmen@sijmen">sijmen@sijmen</A> sql $ mcs --version
Mono C# compiler version 0.28.0.0

--
Sijmen Mulder

&gt;<i>From: &quot;Michael J. Ryan&quot; &lt;<A HREF="mailto:tracker1_lists@theroughnecks.com">tracker1_lists@theroughnecks.com</A>&gt;
</I>&gt;<i>To: Sijmen Mulder &lt;<A HREF="mailto:sijmen_mulder@hotmail.com">sijmen_mulder@hotmail.com</A>&gt;
</I>&gt;<i>CC: <A HREF="mailto:mono-list@lists.ximian.com">mono-list@lists.ximian.com</A>
</I>&gt;<i>Subject: Re: [Mono-list] MySQL / Firebird
</I>&gt;<i>Date: Wed, 19 Nov 2003 13:23:53 -0700
</I>&gt;<i>
</I>&gt;<i>Replace ... System.Data.SqlClient.* with ByteFX.Data.MySqlClient.*
</I>&gt;<i>Replace .... *.Sql* with *.MySql*
</I>&gt;<i>
</I>&gt;<i>there ya go...  it is an ADO.Net provider, works about 85% the same, I
</I>&gt;<i>find that I have to manually do some type conversion, since 99% of my 
</I>&gt;<i>queries
</I>&gt;<i>are returned as a System.Data.DataTable, then from there into my own native
</I>&gt;<i>objects...
</I>&gt;<i>
</I>&gt;<i>See attached... Rename the MyCompany.MyProject.MyData as appropriate...
</I>&gt;<i>Use the docs for System.Data.SqlClient
</I>&gt;<i>
</I>&gt;<i>Query example:
</I>&gt;<i>DataTable t = DB.Query(&quot;SELECT column1,column2 FROM MyTable;&quot;);
</I>&gt;<i>//you can use foreach, or other methods of access, this is what I use.
</I>&gt;<i>//  usually using an id, or feeding it to a class()
</I>&gt;<i>for (int i=0; i&lt;t.Rows.Length; i++) {
</I>&gt;<i>	string column1 = DB.ToString(t.Rows[i][0]);
</I>&gt;<i>	int column2 = DB.ToInt(t.Rows[i][1]);
</I>&gt;<i>	Response.Write(String.Format(&quot;{0} - {1}&quot;,column1,column2);
</I>&gt;<i>}
</I>&gt;<i>
</I>&gt;<i>Insert/Update Example:
</I>&gt;<i>string SQL = &quot;INSERT INTO Table (column1,column2) VALUES ({0},{1});&quot;
</I>&gt;<i>DB.Exec( String.Format( SQL, DB.ToData(column1), DB.ToData(column2) ) );
</I>&gt;<i>
</I>&gt;<i>the .ToData() is overloaded, and will wrap '' around strings, dates, and
</I>&gt;<i>guid's as appropriate, I like System.Guid as a key field, generate them
</I>&gt;<i>in .Net, and store them as a CHAR(36) ...
</I>&gt;<i>
</I>&gt;<i>I hope this is helpfull...  the connection string is stored in web.config
</I>&gt;<i>
</I>&gt;<i>most of what I do can be done in either .Exec(string) or .Query(string)
</I>&gt;<i>Exec returns the int from the native execution, Query returns a DataTable,
</I>&gt;<i>the methods are static, meaning you don't initialize it first... also,
</I>&gt;<i>the connection is isolated for late-bind, early-release methodology.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Sijmen Mulder wrote:
</I>&gt;&gt;<i>Great! It's shipped with mono!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>But now I am looking for documentation on it (not SQL itself ofcourse 
</I>&gt;&gt;<i>;-]).
</I>&gt;&gt;<i>Any idea where I can find it? I already did a few searches, without too 
</I>&gt;&gt;<i>much results...
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>Michael J. Ryan - tracker1(at)theroughnecks(dot)com - www.theroughnecks.net
</I>&gt;<i>icq: 4935386  -  AIM/AOL: azTracker1  -  Y!: azTracker1  -  MSN/Win: 
</I>&gt;<i>(email)
</I>&gt;<i>using System;
</I>&gt;<i>using System.Collections;
</I>&gt;<i>using System.Data;
</I>&gt;<i>using ByteFX.Data.MySqlClient;
</I>&gt;<i>using MyCompany.MyProject.MyData;
</I>&gt;<i>
</I>&gt;<i>namespace MyCompany.MyProject.MyData {
</I>&gt;<i>	public class DB {
</I>&gt;<i>		private DB() {} //Not instantiable
</I>&gt;<i>
</I>&gt;<i>		private static void OpenDB(MySqlConnection conDB) {
</I>&gt;<i>			Context.Trace.Write(&quot;AzTravelCenter.Common.Data&quot;,&quot;OpenDB&quot;);
</I>&gt;<i>
</I>&gt;<i>			conDB.ConnectionString = 
</I>&gt;<i>System.Configuration.ConfigurationSettings.AppSettings[&quot;MySiteConn&quot;];
</I>&gt;<i>			conDB.Open();
</I>&gt;<i>		} //OpenDB
</I>&gt;<i>
</I>&gt;<i>		private static void OpenReadDB(MySqlConnection conDB) {
</I>&gt;<i>			Context.Trace.Write(&quot;AzTravelCenter.Common.Data&quot;,&quot;OpenReadDB&quot;);
</I>&gt;<i>
</I>&gt;<i>//can use a random read db, for clustered MySql Servers.. :D
</I>&gt;<i>//			string strReadConn = &quot;MySiteReadConn&quot; + (new 
</I>&gt;<i>Random()).Next(1).ToString();
</I>&gt;<i>
</I>&gt;<i>//single connection string for db reads
</I>&gt;<i>			string strReadConn = &quot;MySiteReadConn&quot;
</I>&gt;<i>
</I>&gt;<i>			conDB.ConnectionString = 
</I>&gt;<i>System.Configuration.ConfigurationSettings.AppSettings[strReadConn];
</I>&gt;<i>			conDB.Open();
</I>&gt;<i>		} //OpenReadDB
</I>&gt;<i>
</I>&gt;<i>		private static void CloseDB(MySqlConnection conDB) {
</I>&gt;<i>			Context.Trace.Write(&quot;AzTravelCenter.Common.Data&quot;,&quot;CloseDB&quot;);
</I>&gt;<i>
</I>&gt;<i>			conDB.Close();
</I>&gt;<i>			conDB = null;
</I>&gt;<i>		} //CloseDB
</I>&gt;<i>
</I>&gt;<i>		public static string ToData(decimal subject) {
</I>&gt;<i>			if (object.Equals(subject,null))
</I>&gt;<i>				return &quot;NULL&quot;;
</I>&gt;<i>			else
</I>&gt;<i>				return String.Format(&quot;{0:0.0000}&quot;,subject);
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static string ToData(int subject) {
</I>&gt;<i>			if (object.Equals(subject,null))
</I>&gt;<i>				return &quot;NULL&quot;;
</I>&gt;<i>			else
</I>&gt;<i>				return subject.ToString();
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static string ToData(string subject) {
</I>&gt;<i>			if (object.Equals(subject,null))
</I>&gt;<i>				return &quot;NULL&quot;;
</I>&gt;<i>			else
</I>&gt;<i>				return &quot;'&quot; + subject.Replace(&quot;'&quot;,&quot;''&quot;) + &quot;'&quot;;
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static string ToData(bool subject) {
</I>&gt;<i>			return (subject)?&quot;'1'&quot;:&quot;'0'&quot;;
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static string ToData(Guid subject) {
</I>&gt;<i>			if (subject == new Guid())
</I>&gt;<i>				return &quot;NULL&quot;;
</I>&gt;<i>			else
</I>&gt;<i>				return &quot;'&quot; + subject.ToString() + &quot;'&quot;;
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static string ToData(DateTime subject) {
</I>&gt;<i>			if (object.Equals(subject,null))
</I>&gt;<i>				return &quot;NULL&quot;;
</I>&gt;<i>			else
</I>&gt;<i>				return string.Format(&quot;{0:yyyy-MM-dd HH:mm:ss}&quot;,subject);
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static Guid ToGuid(Object subject) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return new Guid();
</I>&gt;<i>			else
</I>&gt;<i>				return new Guid(subject.ToString());
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static String ToString(Object subject) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return &quot;&quot;;
</I>&gt;<i>			else
</I>&gt;<i>				return subject.ToString();
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static int ToInt(Object subject) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return 0;
</I>&gt;<i>			else
</I>&gt;<i>				return int.Parse(subject.ToString());
</I>&gt;<i>		}
</I>&gt;<i>		public static int ToInt(Object subject, int Default) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return Default;
</I>&gt;<i>			else
</I>&gt;<i>				return int.Parse(subject.ToString());
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static decimal ToDecimal(Object subject) {
</I>&gt;<i>			return ToDecimal(subject, (decimal)0);
</I>&gt;<i>		}
</I>&gt;<i>		public static decimal ToDecimal(Object subject, decimal Default) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return Default;
</I>&gt;<i>			else
</I>&gt;<i>				return decimal.Parse(subject.ToString());
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static DateTime ToDateTime(Object subject) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return DateTime.MinValue;
</I>&gt;<i>			else
</I>&gt;<i>				return DateTime.Parse(subject.ToString());
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static DateTime ToDateTime(Object subject, DateTime Default) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return Default;
</I>&gt;<i>			else
</I>&gt;<i>				return DateTime.Parse(subject.ToString());
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>		public static bool ToBool(Object subject) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return false;
</I>&gt;<i>			else
</I>&gt;<i>				return (subject.ToString() == &quot;1&quot;);
</I>&gt;<i>		}
</I>&gt;<i>		public static bool ToBool(Object subject, bool Default) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return Default;
</I>&gt;<i>			else
</I>&gt;<i>				return (subject.ToString() == &quot;1&quot;);
</I>&gt;<i>		}
</I>&gt;<i>		public static Object NotNull(Object subject, Object Default) {
</I>&gt;<i>			if (DBNull.Value.Equals(subject))
</I>&gt;<i>				return Default;
</I>&gt;<i>			else
</I>&gt;<i>				return subject;
</I>&gt;<i>		} //NotNull
</I>&gt;<i>
</I>&gt;<i>		public static DataTable Query(string strSQL) {
</I>&gt;<i>			Context.Trace.Write(&quot;AzTravelCenter.Common.Data&quot;,string.Format(&quot;Begin 
</I>&gt;<i>DTBL_Query({0})&quot;,strSQL));
</I>&gt;<i>
</I>&gt;<i>			MySqlConnection conDB = new MySqlConnection();
</I>&gt;<i>			DataTable dtblResult = new DataTable(&quot;entity_info&quot;);
</I>&gt;<i>			MySqlDataAdapter dadEntityInfo = new MySqlDataAdapter(strSQL,conDB);
</I>&gt;<i>
</I>&gt;<i>			OpenReadDB(conDB); //Open Database Connection
</I>&gt;<i>				dadEntityInfo.Fill(dtblResult); //Fill the datatable with the results
</I>&gt;<i>			CloseDB(conDB); //Close Database Connection
</I>&gt;<i>
</I>&gt;<i>			Context.Trace.Write(&quot;AzTravelCenter.Common.Data&quot;,string.Format(&quot;End 
</I>&gt;<i>DTBL_Query({0}) (results:{1})&quot;,strSQL,dtblResult.Rows.Count));
</I>&gt;<i>			return dtblResult;
</I>&gt;<i>		} // Query
</I>&gt;<i>
</I>&gt;<i>		public static int Exec(string strSQL) {
</I>&gt;<i>			int intRet;
</I>&gt;<i>			MySqlConnection conDB  = new MySqlConnection();
</I>&gt;<i>			MySqlCommand cmdQuery = new MySqlCommand(strSQL, conDB);
</I>&gt;<i>			OpenDB(conDB);
</I>&gt;<i>				intRet = cmdQuery.ExecuteNonQuery();
</I>&gt;<i>			CloseDB(conDB);
</I>&gt;<i>
</I>&gt;<i>			return intRet;
</I>&gt;<i>		} //Exec
</I>&gt;<i>
</I>&gt;<i>	} //DB class
</I>&gt;<i>} //MyCompany.MyProject.MyData
</I>
_________________________________________________________________
MSN Zoeken helpt je om de gekste dingen te vinden! <A HREF="http://search.msn.nl">http://search.msn.nl</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="017018.html">[Mono-list] Initial release of SAX API for C#
</A></li>
	<LI> Next message: <A HREF="017020.html">[Mono-list] mod_mono - Apache 1.3? I have 2.0!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17019">[ date ]</a>
              <a href="thread.html#17019">[ thread ]</a>
              <a href="subject.html#17019">[ subject ]</a>
              <a href="author.html#17019">[ author ]</a>
         </LI>
       </UL>
</body></html>
