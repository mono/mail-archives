<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Building mono on Win32 with ICU
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gkodinov%40openlinksw.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="016722.html">
   <LINK REL="Next"  HREF="016723.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Building mono on Win32 with ICU
   </H1>
    <B>George Kodinov
    </B> 
    <A HREF="mailto:gkodinov%40openlinksw.co.uk"
       TITLE="[Mono-list] Building mono on Win32 with ICU">gkodinov@openlinksw.co.uk
       </A><BR>
    <I>Tue, 04 Nov 2003 14:34:00 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="016722.html">[Mono-list] Building mono on Win32 with ICU
</A></li>
        <LI> Next message: <A HREF="016723.html">[Mono-list] Error Links on Mono-Homepage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16731">[ date ]</a>
              <a href="thread.html#16731">[ thread ]</a>
              <a href="subject.html#16731">[ subject ]</a>
              <a href="author.html#16731">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.
--------------040505050400040509030602
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi again,

I've managed to fool mono on win32 to compile w/ ICU the following way :

- I've got the latest ICU Win32 binary from 
(<A HREF="ftp://www-126.ibm.com/pub/icu/2.6.1/icu-2.6.1-Win32_msvc6.zip">ftp://www-126.ibm.com/pub/icu/2.6.1/icu-2.6.1-Win32_msvc6.zip</A>).

- I've got the latest ICU source from 
(<A HREF="ftp://www-126.ibm.com/pub/icu/2.6.1/icu-2.6.1.zip">ftp://www-126.ibm.com/pub/icu/2.6.1/icu-2.6.1.zip</A>).

- Installed the binary zip at c:\icu

- Unsing the ICU's 'configure' script I've produced a proto icu-config 
for CygWin

- Changed the names and the location of the ICU libraries from their 
cygwin names to the Win32 native names. This way I got the attached 
icu-config.

- Copied the so produced icu-config to c:\icu\bin and added c:\icu\bin 
to the PATH

- run the mono-build-win32.sh - it detected and compiled the ICU support 
just fine.

For anybody interested I'm attaching the modified icu-config. Just get 
the Win32 binary achive, unzip it to c:\icu, add the icu-config to 
c:\icu\bin and add the c:\icu\bin to your PATH.

It proves handy to copy the three ICU dlls referenced (icudt26l.dll, 
icuuc26.dll and icuin26.dll) to install\lib (next to the glib dlls) so 
you can safely remove the icu installation.

Best Regards,
George Kodinov

George Kodinov wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I've noted that the Win32 build script is not adding the ICU to the mix.
</I>&gt;<i> Does anyone have some experience on building Mono with ICU on windows ?
</I>&gt;<i> Does it worth trying at all ?
</I>&gt;<i>
</I>&gt;<i> Best Regards,
</I>&gt;<i> George Kodinov
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-list maillist  -  <A HREF="mailto:Mono-list@lists.ximian.com">Mono-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">http://lists.ximian.com/mailman/listinfo/mono-list</A>
</I>

--------------040505050400040509030602
Content-Type: text/plain;
 name=&quot;icu-config&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;icu-config&quot;

#!/bin/sh
## -*-sh-*-
#set -x
# BEGIN of icu-config-top
#******************************************************************************
#   Copyright (C) 1999-2002, International Business Machines
#   Corporation and others.  All Rights Reserved.
# $Revision: 1.1 $
#******************************************************************************
# This script is designed to aid configuration of ICU.
# rpath links a library search path right into the binaries.


### END of icu-config-top

## Zero out prefix.
execprefix=
prefix=


loaddefs()
{

# Following from ./config/mh-cygwin
# Generated automatically from Makefile.inc.in by configure.
## -*-makefile-*-
#******************************************************************************
#   Copyright (C) 1999-2003, International Business Machines
#   Corporation and others.  All Rights Reserved.
# $Revision: 1.35 $
#******************************************************************************
# This Makefile.inc is designed to be included into projects which make use
# of the ICU.

# CONTENTS OF THIS FILE
# 1). Base configuration information and linkage
# 2). Variables giving access to ICU tools
# 3). Host information
# 4). Compiler flags and settings 
# 5). Data Packaging directives
# 6). Include of platform make fragment (mh-* file)

##################################################################
#
#       *1*  base configuration information and linkage
#
##################################################################
# The PREFIX is the base of where ICU is installed.
# Inside this directory you should find  bin, lib, include/unicode, 
# etc.  If ICU is not installed in this directory, you must change the
# following line.  There should exist ${prefix}/include/unicode/utypes.h
# for example.
default_prefix=&quot;c:/icu&quot;
if [ &quot;x${prefix}&quot; = &quot;x&quot; ]; then prefix=&quot;$default_prefix&quot;; fi
exec_prefix=&quot;${prefix}&quot;
libdir=&quot;${exec_prefix}/bin&quot;
libexecdir=&quot;${exec_prefix}/libexec&quot;
bindir=&quot;${exec_prefix}/bin&quot;
datadir=&quot;${prefix}/share&quot;
sbindir=&quot;${exec_prefix}/sbin&quot;

# about the ICU version
VERSION=&quot;2.6.1&quot;
UNICODE_VERSION=&quot;4&quot;

# The prefix for ICU libraries, normally 'icu'
ICUPREFIX=&quot;icu&quot;
PACKAGE=&quot;icu&quot;
LIBICU=&quot;${ICUPREFIX}&quot;

# Suffix at the end of libraries. Usually empty.
ICULIBSUFFIX=&quot;26&quot;
# ICULIBSUFFIX_VERSION  is non-empty if it is to contain a library
# version. For example, if it is 21, it means libraries are named
# libicuuc21.so for example.

# rpath links a library search path right into the binaries.
## mh-files MUST NOT override RPATHLDFLAGS unless they provide
## equivalent '#SH#' lines for icu-config fixup
default_ENABLE_RPATH=&quot;NO&quot;
if [ &quot;x${ENABLE_RPATH}&quot; = &quot;x&quot; ]; then ENABLE_RPATH=&quot;$default_ENABLE_RPATH&quot;; fi
RPATHLDFLAGS=&quot;${LD_RPATH}${LD_RPATH_PRE}${libdir}&quot;

# icu-config version of above 'if':
case &quot;$ENABLE_RPATH&quot; in 
[yY]*)
	ENABLE_RPATH=YES
	RPATHLDFLAGS=&quot;${LD_RPATH}${LD_RPATH_PRE}${libdir}&quot;
	;;

[nN]*)
	ENABLE_RPATH=NO
	RPATHLDFLAGS=&quot;&quot;
	;;

*)
	echo $0: Unknown --enable-rpath value ${ENABLE_RPATH} 1&gt;&amp;2
	exit 3
	;;
esac

### To link your application with ICU:
# 1. use LDFLAGS, CFLAGS, etc from above
# 2. link with ${ICULIBS}
# 3. optionally, add one or more of:
#    - ${ICULIBS_I18N}    - i18n library, formatting, etc.
#    - ${ICULIBS_LAYOUT}  - ICU layout library. 
#    - ${ICULIBS_USTDIO}  - ICU stdio equivalent library

ICULIBS_COMMON=&quot;-l${ICUPREFIX}uc${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_DATA=&quot;-l${ICUPREFIX}dt${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}l&quot;
ICULIBS_I18N=&quot;-l${ICUPREFIX}in${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_TOOLUTIL=&quot;-l${ICUPREFIX}toolutil${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_CTESTFW=&quot;-l${ICUPREFIX}ctestfw${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_USTDIO=&quot;-licuio${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_OBSOLETE=&quot;-l${ICUPREFIX}obsolete${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_LAYOUT=&quot;-l${ICUPREFIX}le${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_LAYOUTEX=&quot;-l${ICUPREFIX}lx${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}&quot;
ICULIBS_BASE=&quot;${LIBS} -L${libdir}&quot;

# for icu-config to test with
ICULIBS_COMMON_LIB_NAME=&quot;${LIBICU}uc${ICULIBSUFFIX}${ICULIBSUFFIX_VERSION}.${SO}&quot;

# ICULIBS is the set of libraries your application should link
# with usually. Many applications will want to add ${ICULIBS_I18N} as well. 
ICULIBS=&quot;${ICULIBS_BASE} ${ICULIBS_I18N} ${ICULIBS_COMMON} ${ICULIBS_DATA} &quot;
#ICULIBS=&quot;${ICULIBS_BASE} ${ICULIBS_COMMON} ${ICULIBS_DATA} &quot;

##################################################################
#
#       *2*  access to ICU tools
#
##################################################################
# Environment variable to set a runtime search path
#   (Overridden when necessary in -mh files)
LDLIBRARYPATH_ENVVAR=&quot;LD_LIBRARY_PATH&quot;

# Access to important ICU tools.
# Use as follows:  ${INVOKE} ${GENRB} arguments .. 
INVOKE=&quot;${LDLIBRARYPATH_ENVVAR}=${libdir}:$$${LDLIBRARYPATH_ENVVAR} ${LEAK_CHECKER}&quot;
GENCCODE=&quot;${sbindir}/genccode&quot;
GENCMN=&quot;${sbindir}/gencmn&quot;
GENRB=&quot;${bindir}/genrb&quot;
PKGDATA=&quot;${bindir}/pkgdata&quot;

##################################################################
#
#       *3*  Information about the host
#
##################################################################

# Information about the host that 'configure' was run on.
host=&quot;i686-pc-cygwin&quot;
host_alias=&quot;i686-pc-cygwin&quot;
host_cpu=&quot;i686&quot;
host_vendor=&quot;pc&quot;
host_os=&quot;cygwin&quot;
# Our platform canonical name (as determined by configure)
# this is a #define value (i.e. U_XXXX or XXXX)
platform=&quot;U_CYGWIN&quot;

##################################################################
#
#       *4*  compiler flags and misc. options
#
##################################################################
AIX_SHLIB=&quot;makeC++SharedLib_r&quot;
AR=&quot;/usr/bin/ar&quot;
CC=&quot;gcc -mno-cygwin&quot;
CFLAGS=&quot;-g ${THREADSCFLAGS} &quot;
CPP=&quot;cpp -P -C&quot;
CPPFLAGS=&quot;${THREADSCPPFLAGS} ${LIBCPPFLAGS} -I${prefix}/include&quot;
CXX=&quot;c++ -mno-cygwin&quot;
CXXFLAGS=&quot;-g ${THREADSCXXFLAGS} &quot;
DEFAULT_MODE=&quot;dll&quot;
DEFS=&quot;-DHAVE_CONFIG_H &quot;
FFLAGS=&quot;&quot;
INSTALL=&quot;/usr/bin/install -c&quot;
INSTALL_DATA=&quot;${INSTALL} -m 644&quot;
INSTALL_PROGRAM=&quot;${INSTALL}&quot;
INSTALL_SCRIPT=&quot;${INSTALL_PROGRAM}&quot;
LDFLAGS=&quot;${RPATHLDFLAGS}&quot;
LIBS=&quot;-lpthread -lm  &quot;
LIB_M=&quot;&quot;
LIB_VERSION=&quot;26.1&quot;
LIB_VERSION_MAJOR=&quot;26&quot;
MKINSTALLDIRS=&quot;${SHELL} ${pkgdatadir}/mkinstalldirs&quot;
RANLIB=&quot;ranlib&quot;
RMV=&quot;rm -rf&quot;
SHELL=&quot;/bin/sh&quot;
SHLIB_c=&quot;${CC} ${DEFS} ${CPPFLAGS} ${CFLAGS} ${LDFLAGS} -shared&quot;
SHLIB_cc=&quot;${CXX} ${DEFS} ${CPPFLAGS} ${CXXFLAGS} ${LDFLAGS} -shared&quot;
U_IS_BIG_ENDIAN=&quot;0&quot;
includedir=&quot;${prefix}/include&quot;
infodir=&quot;${prefix}/info&quot;
ld_rpath_suf=&quot;&quot;
localstatedir=&quot;${prefix}/var&quot;
mandir=&quot;${prefix}/man&quot;
oldincludedir=&quot;/usr/include&quot;
program_transform_name=&quot;s,x,x,&quot;
sharedstatedir=&quot;${prefix}/com&quot;
sysconfdir=&quot;${prefix}/etc&quot;
INSTALL_L=&quot;${INSTALL_DATA}&quot;

##################################################################
#
#       *5* packaging options and directories
#
##################################################################

pkgdatadir=&quot;${datadir}/${PACKAGE}${ICULIBSUFFIX}/${VERSION}&quot;
pkglibdir=&quot;${libdir}/${PACKAGE}${ICULIBSUFFIX}/${VERSION}&quot;

# The basename of the ICU data file (i.e. icudt21b )
ICUDATA_NAME=&quot;icudt26l&quot;

# Defaults for pkgdata's mode and directories
# The default data dir changes depending on what packaging mode 
# is being used
PKGDATA_MODE=&quot;dll&quot;
ICUDATA_DIR=&quot;${pkgdatadir}&quot;
ICUPKGDATA_DIR=&quot;${ICUDATA_DIR}&quot;
ICUDATA_DIR=&quot;${pkgdatadir}&quot;
ICUPKGDATA_DIR=&quot;${libdir}&quot;
ICUDATA_DIR=&quot;${pkglibdir}&quot;
ICUPKGDATA_DIR=&quot;${ICUDATA_DIR}&quot;

##################################################################
#
#       *6* Inclusion of platform make fragment (mh-* file)
#
##################################################################
# The mh- file (&quot;make fragment&quot;) for the platform is included here. 
# It may override the above settings.
# It is put last so that the mh-file can override anything.

## -*-makefile-*-
## Cygwin-specific setup
## Copyright (c) 2001-2003, International Business Machines Corporation and
## others. All Rights Reserved.
##
## $Id: mh-cygwin,v 1.13 2003/08/08 23:53:43 grhoten-oss Exp $

## Commands to generate dependency files
GEN_DEPS_c=&quot;${CC} -E -MM ${DEFS} ${CPPFLAGS}&quot;
GEN_DEPS_cc=&quot;${CXX} -E -MM ${DEFS} ${CPPFLAGS}&quot;

## Flags for position independent code
SHAREDLIBCFLAGS=&quot;&quot;
SHAREDLIBCXXFLAGS=&quot;&quot;
SHAREDLIBCPPFLAGS=&quot;-DPIC&quot;

## Additional flags when building libraries and with threads
LIBCPPFLAGS=&quot;-D_REENTRANT&quot;
THREADSCPPFLAGS=&quot;-D_REENTRANT&quot;

## Commands to make a shared library
SHLIB_c=&quot;${CC} ${DEFS} ${CPPFLAGS} ${CFLAGS} ${LDFLAGS} -shared&quot;
SHLIB_cc=&quot;${CXX} ${DEFS} ${CPPFLAGS} ${CXXFLAGS} ${LDFLAGS} -shared&quot;

## Compiler switch to embed a runtime search path
LD_RPATH=&quot;&quot;
LD_RPATH_PRE=&quot;-Wl,-rpath,&quot;

## Compiler switch to embed a library name
LD_SONAME=&quot;-Wl,-soname -Wl,${MIDDLE_SO_TARGET}&quot;

## Shared object suffix
SO=&quot;dll&quot;
## Non-shared intermediate object suffix
STATIC_O=&quot;o&quot;
#LIBICU = ${ICUPREFIX}

## Link commands to link to ICU libs
LIBICUDT=&quot;-L${top_builddir}/stubdata/ -l${ICUPREFIX}data${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;
LIBICUUC=&quot;-L${top_builddir}/common/ -l${ICUPREFIX}uc${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;
LIBICUI18N=&quot;-L${top_builddir}/i18n/ -l${ICUPREFIX}i18n${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;
LIBICULE=&quot;-L${top_builddir}/layout/ -l${ICUPREFIX}le${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;
LIBICULX=&quot;-L${top_builddir}/layoutex/ -l${ICUPREFIX}lx${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;
LIBCTESTFW=&quot;-L${top_builddir}/tools/ctestfw/ -l${ICUPREFIX}ctestfw${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;
LIBICUTOOLUTIL=&quot;-L${top_builddir}/tools/toolutil/ -l${ICUPREFIX}toolutil${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;
LIBUSTDIO=&quot;-L${top_builddir}/extra/ustdio/ -l${ICUPREFIX}io${ICULIBSUFFIX}${SO_TARGET_VERSION_MAJOR}&quot;

## Compilation rules

## Dependency rules

## Versioned target for a shared library.
## FINAL_SO_TARGET=  ${basename $(SO_TARGET})${SO_TARGET_VERSION}${ICULIBSUFFIX}.${SO}
## MIDDLE_SO_TARGET= ${basename $(SO_TARGET})${SO_TARGET_VERSION_MAJOR}${ICULIBSUFFIX}.${SO}

## Versioned libraries rules

##  Bind internal references

# LDflags that pkgdata will use
BIR_LDFLAGS=&quot;-Wl,-Bsymbolic&quot;

# CPPflags for genccode/gencmn
BIR_CPPFLAGS=&quot;-DU_HAVE_BIND_INTERNAL_REFERENCES&quot;

# Dependencies [i.e. map files] for the final library
BIR_DEPS=&quot;&quot;

# Environment variable to set a runtime search path
LDLIBRARYPATH_ENVVAR=&quot;PATH&quot;

## End Cygwin-specific setup

## -*-sh-*-
## BEGIN of icu-config-bottom. $Revision: 1.9 $
## Copyright (c) 2002-2003, International Business Machines Corporation and
## others. All Rights Reserved.

ICUUC_FILE=${libdir}/${ICULIBS_COMMON_LIB_NAME}
    
#  echo ENABLE RPATH $ENABLE_RPATH and RPATHLDFLAGS=${RPATH_LDFLAGS}
if [ &quot;x$PKGDATA_MODE&quot; = &quot;x&quot; ]; then
    PKGDATA_MODE=dll
fi

}

## The actual code of icu-config goes here.

ME=`basename $0`

allflags()
{
    echo &quot;  --bindir               Print binary directory path (bin)&quot;
    echo &quot;  --cc                   Print C compiler used [CC]&quot;
    echo &quot;  --cflags               Print C compiler flags [CFLAGS]&quot;
    echo &quot;  --cflags-dynamic       Print additional C flags for&quot;
    echo &quot;                             building shared libraries.&quot;
    echo &quot;  --cppflags             Print C Preprocessor flags [CPPFLAGS]&quot;
    echo &quot;  --cppflags-dynamic     Print additional C Preprocessor flags for&quot;
    echo &quot;                             building shared libraries.&quot;
    echo &quot;  --cppflags-searchpath  Print only -I include directives  (-Iinclude)&quot;
    echo &quot;  --cxx                  Print C++ compiler used [CXX]&quot;
    echo &quot;  --cxxflags             Print C++ compiler flags [CXXFLAGS]&quot;
    echo &quot;  --cxxflags-dynamic     Print additional C++ flags for&quot;
    echo &quot;                             building shared libraries.&quot;
    echo &quot;  --detect-prefix        Attempt to detect prefix based on PATH&quot;
    echo &quot;  --exec-prefix          Print prefix for executables (/bin)&quot;
    echo &quot;  --exists               Return with 0 status if ICU exists else fail&quot;
    echo &quot;  --help, -?, --usage    Print this message&quot;
    echo &quot;  --icudata              Print shortname of ICU data file (icudt21l)&quot;
    echo &quot;  --icudata-install-dir  Print path to install data to - use as --install option to pkgdata(1)&quot;
    echo &quot;  --icudata-mode         Print default ICU pkgdata mode (dll) - use as --mode option to pkgdata(1).&quot;
    echo &quot;  --icudatadir           Print path to packaged archive data. Can set as [ICU_DATA]&quot;
    echo &quot;  --invoke               Print commands to invoke an ICU program&quot;
    echo &quot;  --invoke=&lt;prog&gt;        Print commands to invoke an ICU program named &lt;prog&gt; (ex: genrb)&quot; 
    echo &quot;  --ldflags              Print -L search path and -l libraries to link with ICU [LDFLAGS].  This is for the data, uc (common), and i18n libraries only.  &quot;
    echo &quot;  --ldflags-layout       Print ICU layout engine link directive. Use in addition to --ldflags&quot;
    echo &quot;  --ldflags-libsonly     Same as --ldflags, but only the -l directives&quot;
    echo &quot;  --ldflags-searchpath   Print only -L (search path) directive&quot;
    echo &quot;  --ldflags-system       Print only system libs ICU links with (-lpthread, -lm)&quot;
    echo &quot;  --ldflags-ustdio       Print ICU ustdio link directive. Use in addition to --ldflags &quot;
    echo &quot;  --ldflags-obsolete     Print ICU obsolete link directive. Use in addition to --ldflags. (requires icuapps/obsolete to be built and installed.) &quot;
    echo &quot;  --mandir               Print manpage (man) path&quot;
    echo &quot;  --prefix               Print PREFIX to icu install (/usr/local)&quot;
    echo &quot;  --prefix=XXX           Set prefix to XXX for remainder of command&quot;
    echo &quot;  --sbindir              Print system binary path (sbin) &quot;
    echo &quot;  --shared-datadir       Print shared data (share) path. This is NOT the ICU data dir.&quot;
    echo &quot;  --shlib-c              Print the command to compile and build C shared libraries with ICU&quot;
    echo &quot;  --shlib-cc             Print the command to compile and build C++ shared libraries with ICU&quot;
    echo &quot;  --sysconfdir           Print system config (etc) path&quot;
    echo &quot;  --unicode-version      Print version of Unicode data used in ICU ($UNICODE_VERSION)&quot;
    echo &quot;  --version              Print ICU version ($VERSION)&quot;
    echo &quot;  --incfile              Print path to Makefile.inc (for -O option of pkgdata)&quot;
}

## Print the normal usage message
shortusage()
{
    echo &quot;usage: ${ME} &quot; `allflags | cut -c-25 | sed -e 's%.*%[ &amp; ]%'`
}


usage()
{
    echo &quot;${ME}: icu-config: ICU configuration helper script&quot;
    echo
    echo &quot;The most commonly used options will be --cflags, --cxxflags, --cppflags, and --ldflags.&quot;
    echo 'Example (in make):   CPFLAGS=$(shell icu-config --cppflags)'
    echo '                     LDFLAGS=$(shell icu-config --ldflags)'
    echo &quot;                     (etc)..&quot;
    echo
    echo &quot;Usage:&quot;
    allflags

    echo 
    echo &quot; [Brackets] show MAKE variable equivalents,  (parenthesis) show example output&quot;
    echo
    echo &quot;Copyright (c) 2002, International Business Machines Corporation and others. All Rights Reserved.&quot;
}

## Check the sanity of current variables
sanity()
{
    if [ ! -f ${ICUUC_FILE} ];
    then
	echo &quot;### $ME: Can't find ${ICUUC_FILE} - ICU prefix is wrong.&quot;  1&gt;&amp;2
	echo &quot;###      Try the --prefix= or --exec-prefix= options &quot; 1&gt;&amp;2
	echo &quot;###      or --detect-prefix&quot;
	echo &quot;### $ME: Exitting.&quot; 1&gt;&amp;2
	exit 2
    fi
}

## Main starts here.

if [ $# -lt 1 ]; then
    shortusage
    exit 1
fi


# Load our variables from autoconf
# ALWAYS load twice because of dependencies
loaddefs
loaddefs
sanity

while [ $# -gt 0 ];
do
    arg=&quot;$1&quot;
    var=`echo $arg | sed -e 's/^[^=]*=//'`
#    echo &quot;### processing $arg&quot; 1&gt;&amp;2
    case &quot;$arg&quot; in

        # undocumented.
	--debug)
	    set -x
	    ;;

        --so)
            echo $SO
            ;;

	--bindir)
	    echo $bindir
	    ;;

	--libdir)
	    echo $libdir
	    ;;

	--exists)
	    sanity
	    ;;

	--sbindir)
	    echo $sbindir
	    ;;

	--invoke=*)
	    QUOT=&quot;'&quot;
            CMD=&quot;${var}&quot;

            # If it's not a locally executable command (1st choice) then 
            # search for it in the ICU directories. 
            if [ ! -x ${CMD} ]; then
                if [ -x ${bindir}/${var} ]; then
                    CMD=&quot;${bindir}/${var}&quot;
                fi
                if [ -x ${sbindir}/${var} ]; then
                    CMD=&quot;${sbindir}/${var}&quot;
                fi
            fi

	    echo &quot;env ${QUOT}${LDLIBRARYPATH_ENVVAR}=${libdir}:&quot;'${'&quot;${LDLIBRARYPATH_ENVVAR}&quot;'}'${QUOT} ${CMD}
	    ;;

	--invoke)
	    QUOT=&quot;'&quot;
	    echo &quot;env ${QUOT}${LDLIBRARYPATH_ENVVAR}=${libdir}:&quot;'${'&quot;${LDLIBRARYPATH_ENVVAR}&quot;'}'${QUOT}
	    ;;

	--cflags)
	    echo $CFLAGS
	    ;;
	    
	--cc)
	    echo $CC
	    ;;
	    
	--cxx)
	    echo $CXX
	    ;;

	--cxxflags)
	    echo $CXXFLAGS
	    ;;

	--cppflags)
	    # Don't echo the -I. - it's unneeded.
	    echo $CPPFLAGS | sed -e 's/-I. //'
	    ;;

	--cppflags-searchpath)
	    echo -I${prefix}/include
	    ;;

	--cppflags-dynamic)
	    echo $SHAREDLIBCPPFLAGS
	    ;;

	--cxxflags-dynamic)
	    echo $SHAREDLIBCXXFLAGS
	    ;;

	--cflags-dynamic)
	    echo $SHAREDLIBCFLAGS
	    ;;

	--ldflags-system)
	    echo $LIBS
	    ;;

	--ldflags)
	    echo $LDFLAGS $ICULIBS $LIBS 
# $RPATH_LDFLAGS
	    ;;

	--ldflags-libsonly)
	    echo $ICULIBS_I18N $ICULIBS_COMMON $ICULIBS_DATA 
	    ;;

	--ldflags-ustdio)
	    echo $ICULIBS_USTDIO
	    ;;

	--ldflags-obsolete)
	    echo $ICULIBS_OBSOLETE
	    ;;

	--ldflags-toolutil)
	    echo $ICULIBS_TOOLUTIL
	    ;;

	--ldflags-layout)
	    echo $ICULIBS_LAYOUT $ICULIBS_LAYOUTEX
	    ;;

	--ldflags-searchpath)
	    echo -L${libdir}
	    ;;

	--detect-prefix)
	    HERE=`echo $0 | sed -e &quot;s/$ME//g&quot;`
	    if [ -f $HERE/../lib/${ICULIBS_COMMON_LIB_NAME} ]; then
		prefix=$HERE/..
		echo &quot;## Using --prefix=${prefix}&quot; 1&gt;&amp;2
	    fi
	    loaddefs
	    loaddefs
	    sanity
	    ;;

	--exec-prefix)
	    echo $exec_prefix
	    ;;

	--prefix)
	    echo $prefix
	    ;;

	--prefix=*)
	    prefix=$var
	    loaddefs
	    loaddefs
	    sanity
	    ;;

	--sysconfdir)
	    echo $sysconfdir
	    ;;

	--mandir)
	    echo $mandir
	    ;;

	--shared-datadir)
	    echo $datadir
	    ;;

        --incfile)
	    echo $pkglibdir/Makefile.inc
	    ;;

	--icudata)
	    echo $ICUDATA_NAME
	    ;;

	--icudata-mode)
	    echo $PKGDATA_MODE
	    ;;

	--icudata-install-dir)
	    case &quot;$PKGDATA_MODE&quot; in
		
		common)
		    echo &quot;$pkgdatadir&quot;
		    ;;

		dll)
		    echo &quot;$libdir&quot;
		    ;;

		*)
		    echo &quot;## ${ME} Unknown pkgdata mode $PKGDATA_MODE&quot; 1&gt;&amp;2
		    exit 4
		    ;;
	    esac
	    ;;
	    
	--icudatadir)
	    echo $pkgdatadir
	    ;;

	--shlib-c)
	    echo $SHLIB_c
	    ;;

	--shlib-cc)
	    echo $SHLIB_cc
	    ;;

	--version)
            echo $VERSION
            ;;

        --unicode-version)
            echo $UNICODE_VERSION
            ;;

	--help)
	    usage
	    exit 0
	    ;;

	--usage)
	    usage
	    exit 0
	    ;;

#	--enable-rpath=*)
#	    ENABLE_RPATH=$var
#	    loaddefs
#	    ;;

	-?)
	    usage
	    exit 0
	    ;;

        *)
	    echo ${ME}: ERROR Unknown Option $arg 1&gt;&amp;2
            echo 1&gt;&amp;2
            shortusage 1&gt;&amp;2
	    echo &quot;### $ME: Exitting.&quot; 1&gt;&amp;2
            exit 1;
            ;;
    esac
    shift
done

# Check once before we quit (will check last used prefix)
sanity
## END of icu-config-bottom

exit 0

# Rebuilt on Tue Nov 4 12:14:40 FLEST 2003

--------------040505050400040509030602--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="016722.html">[Mono-list] Building mono on Win32 with ICU
</A></li>
	<LI> Next message: <A HREF="016723.html">[Mono-list] Error Links on Mono-Homepage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16731">[ date ]</a>
              <a href="thread.html#16731">[ thread ]</a>
              <a href="subject.html#16731">[ subject ]</a>
              <a href="author.html#16731">[ author ]</a>
         </LI>
       </UL>
</body></html>
