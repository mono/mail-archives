<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Using xsp2 with mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Using%20xsp2%20with%20mono&In-Reply-To=46EB0662.7040609%40occams.info">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036279.html">
   <LINK REL="Next"  HREF="036282.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Using xsp2 with mono</H1>
    <B>Jorge Bastos</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Using%20xsp2%20with%20mono&In-Reply-To=46EB0662.7040609%40occams.info"
       TITLE="[Mono-list] Using xsp2 with mono">mysql.jorge at decimal.pt
       </A><BR>
    <I>Fri Sep 14 18:25:03 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="036279.html">[Mono-list] Using xsp2 with mono
</A></li>
        <LI>Next message: <A HREF="036282.html">[Mono-list] Using xsp2 with mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36280">[ date ]</a>
              <a href="thread.html#36280">[ thread ]</a>
              <a href="subject.html#36280">[ subject ]</a>
              <a href="author.html#36280">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Understood and got it working,
But I have one doubt.
With this, in this specific virtualhost, I have 2 listening mono's, one for
1.0 profile and other for 2.0, but pointed to the virtualhost root dir.
I tried to configure 2 virtualhost's, and I have two process's, so I guess
I'll have one per each virtualhost configured for 2.0 profile? That the way
it is?


###### this is the global one
www-data   564  0.0  1.3  22032  7200 ?        Ssl  23:11   0:00
/usr/local/bin/mono /usr/local/lib/mono/1.0/mod-mono-server.exe --filename
/tmp/mod_mono_server_global --nonstop --master
www-data   566  0.4  3.9  45920 20636 ?        Ssl  23:11   0:01
/usr/local/bin/mono 

###### this if for my first virtualhost
/usr/local/lib/mono/2.0/mod-mono-server2.exe --filename
/tmp/mod_mono_server_vhost1 --applications /:/home/alojamento/vhost1/
--nonstop

###### this if for my secund virtualhost
/usr/local/lib/mono/2.0/mod-mono-server2.exe --filename
/tmp/mod_mono_server_vhost2 --applications /:/home/alojamento/vhost2/
--nonstop


Another thing is, mod_mono still's giving error when
restarting/stop/starting apache:

[Fri Sep 14 23:20:35 2007] [warn] (22)Invalid argument: Failed to destroy
the '/tmp/mod_mono_dashboard_XXGLOBAL_1' shared memory dashboard
[Fri Sep 14 23:20:35 2007] [warn] (22)Invalid argument: Failed to destroy
the '/tmp/mod_mono_dashboard_vhost1' shared memory dashboard
[Fri Sep 14 23:20:35 2007] [warn] (22)Invalid argument: Failed to destroy
the '/tmp/mod_mono_dashboard_vhost2' shared memory dashboard


I belive this is a mod_mono bug?
Ah, I'm using apache 2.2.6, can be some compability bug for this new
version?




-----Original Message-----
From: Joshua Tauberer [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">jit at occams.info</A>] 
Sent: sexta-feira, 14 de Setembro de 2007 23:09
To: Jorge Bastos
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
Subject: Re: [Mono-list] Using xsp2 with mono

The problem is probably that when using autohosting, directives in 
VirtualHosts are (iirc) pretty much ignored. Obviously, you can't have 
just one VirtualHost use ASP.NET 2.0 if more than one are all running 
through one mod-mono-server process, which is (iirc) how autohosting 
normally works.

If you put the MonoServerPath directive outside of vhosts (exactly the 
opposite of part of my first suggestion!), I'd expect it to work (and 
apply to all vhosts).

If you can't have it apply to all vhosts, for those vhosts that you want 
2.0, inside the vhost config, you will have to turn off autohosting and 
configure the application explicitly. At least, that's what I do for 
each of my vhosts anyway. See the wiki page 
(<A HREF="http://www.mono-project.com/Mod_mono">http://www.mono-project.com/Mod_mono</A>) for more on that.

-- 
- Josh Tauberer

<A HREF="http://razor.occams.info">http://razor.occams.info</A>

&quot;Yields falsehood when preceded by its quotation!  Yields
falsehood when preceded by its quotation!&quot; Achilles to
Tortoise (in &quot;G&#246;del, Escher, Bach&quot; by Douglas Hofstadter)


Jorge Bastos wrote:
&gt;<i> Ok i don't see a way to get it working for a certein virtualhost.
</I>&gt;<i> If I change /usr/local/bin/mod-mono-server from:
</I>&gt;<i> 
</I>&gt;<i> #!/bin/sh
</I>&gt;<i> exec /usr/local/bin/mono $MONO_OPTIONS
</I>&gt;<i> &quot;/usr/local/lib/mono/1.0/mod-mono-server
</I>&gt;<i> .exe&quot; &quot;$@&quot;
</I>&gt;<i> 
</I>&gt;<i> To 
</I>&gt;<i> 
</I>&gt;<i> #!/bin/sh
</I>&gt;<i> exec /usr/local/bin/mono $MONO_OPTIONS
</I>&gt;<i> &quot;/usr/local/lib/mono/2.0/mod-mono-server2
</I>&gt;<i> .exe&quot; &quot;$@&quot;
</I>&gt;<i> 
</I>&gt;<i> And this way it works, but now I have all virtualhosts's using 2.0
</I>profile.
&gt;<i> 
</I>&gt;<i> Should it work just with:
</I>&gt;<i> 
</I>&gt;<i> MonoServerPath default /usr/local/bin/mod-mono-server2
</I>&gt;<i> Or
</I>&gt;<i> MonoServerPath /usr/local/bin/mod-mono-server2
</I>&gt;<i> 
</I>&gt;<i> ?
</I>&gt;<i> 
</I>&gt;<i> With this on the apache virtualhost conf, I get on error.log:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Fri Sep 14 22:39:09 2007] [error] Not running mod-mono-server.exe because
</I>&gt;<i> no MonoApplications, MonoApplicationsConfigFile or
</I>MonoApplicationConfigDir
&gt;<i> specified.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A>
</I>&gt;<i> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">mono-list-bounces at lists.ximian.com</A>] On Behalf Of Jorge Bastos
</I>&gt;<i> Sent: sexta-feira, 14 de Setembro de 2007 13:54
</I>&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> Subject: Re: [Mono-list] Using xsp2 with mono
</I>&gt;<i> 
</I>&gt;<i> Yap Path is correct.
</I>&gt;<i> It the test i'm doing works even with that error.
</I>&gt;<i> But without that directive in the vhost conf, apache doesn't throw any
</I>&gt;<i> error.
</I>&gt;<i> With the code below, and this directive, the browser still's show me this:
</I>&gt;<i> 
</I>&gt;<i> ---
</I>&gt;<i> Compilation of Visual Basic code is not supported for v1.0/v1.1
</I>assemblies,
&gt;<i> please use the v2.0 assemblies. - If this is a web application, use
</I>&gt;<i> xsp2/mod_mono_server2 instead of xsp/mono_mono_server (see
</I>&gt;<i> <A HREF="http://www.mono-project.com/Mod_mono#ASP.NET_2_apps_do_not_work">http://www.mono-project.com/Mod_mono#ASP.NET_2_apps_do_not_work</A>). - If
</I>this
&gt;<i> is a desktop application, use gmcs to compile your application instead of
</I>&gt;<i> mcs.
</I>&gt;<i> ---
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Test code:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ---
</I>&gt;<i> &lt;%@ Page Language=&quot;vb&quot; %&gt;
</I>&gt;<i> &lt;script  runat=&quot;server&quot;&gt;
</I>&gt;<i> Sub choose_image(Sender As Object, e As EventArgs)
</I>&gt;<i>    image1.Src = select1.Value
</I>&gt;<i> End Sub
</I>&gt;<i> &lt;/script&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;html&gt;
</I>&gt;<i> &lt;body&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;form runat=&quot;server&quot;&gt;
</I>&gt;<i> &lt;select id=&quot;select1&quot; runat=&quot;server&quot;&gt;
</I>&gt;<i>    &lt;option value=&quot;smiley.gif&quot;&gt;Smiley&lt;/option&gt;
</I>&gt;<i>    &lt;option value=&quot;angry.gif&quot;&gt;Angry&lt;/option&gt;
</I>&gt;<i>    &lt;option
</I>&gt;<i>
</I>value=&quot;<A HREF="http://spe.atdmt.com/b/NMMRTYRBMPRO/FY07_FF_SCE_JointLaunch_120x240_d">http://spe.atdmt.com/b/NMMRTYRBMPRO/FY07_FF_SCE_JointLaunch_120x240_d</A>
&gt;<i> ownload_now_0503.gif&quot;&gt;Stickman&lt;/option&gt;
</I>&gt;<i> &lt;/select&gt;
</I>&gt;<i> &lt;input type=&quot;submit&quot; runat=&quot;server&quot; value=&quot;Display image&quot;
</I>&gt;<i> OnServerClick=&quot;choose_image&quot;&gt;
</I>&gt;<i> &lt;br /&gt;&lt;br /&gt;
</I>&gt;<i> &lt;img id=&quot;image1&quot; src=&quot;smiley.gif&quot; runat=&quot;server&quot; width=&quot;32&quot; height=&quot;32&quot; /&gt;
</I>&gt;<i> &lt;/form&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;/body&gt;
</I>&gt;<i> &lt;/html&gt;
</I>&gt;<i> ---
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Joshua Tauberer [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">jit at occams.info</A>] 
</I>&gt;<i> Sent: sexta-feira, 14 de Setembro de 2007 12:44
</I>&gt;<i> To: Jorge Bastos
</I>&gt;<i> Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-list">Mono-list at lists.ximian.com</A>
</I>&gt;<i> Subject: Re: [Mono-list] Using xsp2 with mono
</I>&gt;<i> 
</I>&gt;<i> Jorge Bastos wrote:
</I>&gt;&gt;<i> Guys, to configure a virtualhost to use mod-mono-server2, it's enougth:
</I>&gt;&gt;<i>  
</I>&gt;&gt;<i> &quot;MonoServerPath /usr/local/bin/mod-mono-server2&quot; ?
</I>&gt;&gt;<i>  
</I>&gt;&gt;<i> When i add this and restart apache i get:
</I>&gt;&gt;<i>  
</I>&gt;&gt;<i> Restarting web server: apache2[Thu Sep 13 23:31:48 2007] [crit] (17)File 
</I>&gt;&gt;<i> exists: Failed to create shared memory segment for backend 'XXGLOBAL'
</I>&gt;&gt;<i> [Thu Sep 13 23:31:58 2007] [crit] (17)File exists: Failed to create 
</I>&gt;&gt;<i> shared memory segment for backend 'XXGLOBAL'
</I>&gt;<i> 
</I>&gt;<i> The error message is (should be) unrelated to the MonoServerPath 
</I>&gt;<i> directive. (And provided the path is correct and you placed it in the 
</I>&gt;<i> VirtualHost block, that directive should be enough, yes.)
</I>&gt;<i> 
</I>

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036279.html">[Mono-list] Using xsp2 with mono
</A></li>
	<LI>Next message: <A HREF="036282.html">[Mono-list] Using xsp2 with mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36280">[ date ]</a>
              <a href="thread.html#36280">[ thread ]</a>
              <a href="subject.html#36280">[ subject ]</a>
              <a href="author.html#36280">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
