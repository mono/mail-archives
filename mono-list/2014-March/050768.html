<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Exception in WinForms cleanup - ToolStripMenuItem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Exception%20in%20WinForms%20cleanup%20-%20ToolStripMenuItem&In-Reply-To=%3CD4ECF9D3FC0F48F8AF8E326CC907055D%40DVDMANDT5%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="050699.html">
   <LINK REL="Next"  HREF="050710.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Exception in WinForms cleanup - ToolStripMenuItem</H1>
    <B>David Lindstr&#246;m</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-list%5D%20Exception%20in%20WinForms%20cleanup%20-%20ToolStripMenuItem&In-Reply-To=%3CD4ECF9D3FC0F48F8AF8E326CC907055D%40DVDMANDT5%3E"
       TITLE="[Mono-list] Exception in WinForms cleanup - ToolStripMenuItem">david.lindstrom at percepio.se
       </A><BR>
    <I>Tue Mar  4 11:17:50 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="050699.html">[Mono-list] Embedded API: identifier encoding.
</A></li>
        <LI>Next message: <A HREF="050710.html">[Mono-list] Call C# mono from python linux?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50768">[ date ]</a>
              <a href="thread.html#50768">[ thread ]</a>
              <a href="subject.html#50768">[ subject ]</a>
              <a href="author.html#50768">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, I'm having problems with exceptions being thrown on garbage collection 
of ToolStripMenuItem. This is with the Mono version included with OpenSUSE 
13.1 so it's slightly behind (3.0.7), but highly likely to be used by 
customers.

Due to the error being thrown in the GC stage I can't catch it and I get no 
real info as to what ToolStripMenuItem is being collected. The application 
is a rather large application that is being ported from Windows/.NET to 
Linux/Mono and there's a rather large amount of dynamic menus so it's 
difficult to track down. Has anyone seen this before? Any ideas on what 
would cause this?

Here is a stack trace:

Unhandled Exception:
System.ArgumentException: A null reference or invalid value was found [GDI+ 
status: InvalidParameter]
  at System.Drawing.GDIPlus.CheckStatus (Status status) [0x00000] in 
&lt;filename unknown&gt;:0
  at System.Drawing.Graphics.GdipMeasureString (IntPtr graphics, 
System.String text, System.Drawing.Font font, System.Drawing.RectangleF&amp; 
layoutRect, IntPtr stringFormat) [0x00000] in &lt;filename unknown&gt;:0
  at System.Drawing.Graphics.MeasureString (System.String text, 
System.Drawing.Font font, Int32 width, System.Drawing.StringFormat format) 
[0x00000] in &lt;filename unknown&gt;:0
  at (wrapper remoting-invoke-with-check) 
System.Drawing.Graphics:MeasureString 
(string,System.Drawing.Font,int,System.Drawing.StringFormat)
  at System.Windows.Forms.TextRenderer.MeasureTextInternal (IDeviceContext 
dc, System.String text, System.Drawing.Font font, Size proposedSize, 
TextFormatFlags flags, Boolean useMeasureString) [0x00000] in &lt;filename 
unknown&gt;:0
  at System.Windows.Forms.TextRenderer.MeasureText (System.String text, 
System.Drawing.Font font) [0x00000] in &lt;filename unknown&gt;:0
  at System.Windows.Forms.ToolStripMenuItem.CalculatePreferredSize (Size 
constrainingSize) [0x00000] in &lt;filename unknown&gt;:0
  at System.Windows.Forms.ToolStripItem.GetPreferredSize (Size 
constrainingSize) [0x00000] in &lt;filename unknown&gt;:0
  at System.Windows.Forms.ToolStripDropDownMenu.OnLayout 
(System.Windows.Forms.LayoutEventArgs e) [0x00000] in &lt;filename unknown&gt;:0
  at System.Windows.Forms.Control.PerformLayout 
(System.Windows.Forms.Control affectedControl, System.String 
affectedProperty) [0x00000] in &lt;filename unknown&gt;:0
  at System.Windows.Forms.Control.PerformLayout () [0x00000] in &lt;filename 
unknown&gt;:0
  at (wrapper remoting-invoke-with-check) 
System.Windows.Forms.Control:PerformLayout ()
  at System.Windows.Forms.ToolStripItem.OnParentChanged 
(System.Windows.Forms.ToolStrip oldParent, System.Windows.Forms.ToolStrip 
newParent) [0x00000] in &lt;filename unknown&gt;:0
  at System.Windows.Forms.ToolStripItem.set_Parent 
(System.Windows.Forms.ToolStrip value) [0x00000] in &lt;filename unknown&gt;:0
  at (wrapper remoting-invoke-with-check) 
System.Windows.Forms.ToolStripItem:set_Parent 
(System.Windows.Forms.ToolStrip)
  at System.Windows.Forms.ToolStripItemCollection.Remove 
(System.Windows.Forms.ToolStripItem value) [0x00000] in &lt;filename unknown&gt;:0
  at System.Windows.Forms.ToolStripItem.Dispose (Boolean disposing) 
[0x00000] in &lt;filename unknown&gt;:0
  at System.ComponentModel.Component.Finalize () [0x00000] in &lt;filename 
unknown&gt;:0

Mvh
David Lindstr&#246;m 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="050699.html">[Mono-list] Embedded API: identifier encoding.
</A></li>
	<LI>Next message: <A HREF="050710.html">[Mono-list] Call C# mono from python linux?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50768">[ date ]</a>
              <a href="thread.html#50768">[ thread ]</a>
              <a href="subject.html#50768">[ subject ]</a>
              <a href="author.html#50768">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
