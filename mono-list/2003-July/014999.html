<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] build Mono statically linked?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="014894.html">
   <LINK REL="Next"  HREF="014898.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] build Mono statically linked?
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Mono-list] build Mono statically linked?">lupus@ximian.com
       </A><BR>
    <I>Tue, 15 Jul 2003 15:34:09 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="014894.html">[Mono-list] build Mono statically linked?
</A></li>
        <LI> Next message: <A HREF="014898.html">[Mono-list] error of remoting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14999">[ date ]</a>
              <a href="thread.html#14999">[ thread ]</a>
              <a href="subject.html#14999">[ subject ]</a>
              <a href="author.html#14999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--C7zPtVaVf+AK4Oqc
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

On 07/09/03 Carl Potter wrote:
&gt;<i> I've got Mono-0.25 and am trying to build it statically.
</I>&gt;<i> 
</I>&gt;<i> So far I've tried both putting CFLAGS=-static in my environment as well as
</I>&gt;<i> doing this with configure:
</I>&gt;<i> 
</I>&gt;<i> ./configure --enable-static --prefix=/my/special/place
</I>
It's not easy to build a static mono, especially since Martin added
the included libgc in the build process. If you take the included libgc
out of the picture, you can use the attached patch to create a monos
static binary. I don't know a better way to do it using libtool (if it
exists at all). The other solution is to do a little cut&amp;paste
of the command used to build the final executable and change the
references to the .la files with references to the .a static libraries
created by configure --enable-static.

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better

--C7zPtVaVf+AK4Oqc
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename=&quot;makefile-monos.diff&quot;

Index: Makefile.am
===================================================================
RCS file: /cvs/public/mono/mono/mini/Makefile.am,v
retrieving revision 1.22
diff -u -p -r1.22 Makefile.am
--- Makefile.am	28 May 2003 09:33:15 -0000	1.22
+++ Makefile.am	9 Jun 2003 17:05:51 -0000
@@ -25,13 +25,14 @@ endif
 
 # hack for automake to have the same source file in a library and a bin
 genmdesc_CFLAGS = $(AM_CFLAGS)
+monos_CFLAGS = $(AM_CFLAGS)
 
 regtests=basic.exe arrays.exe basic-float.exe basic-long.exe objects.exe basic-calls.exe iltests.exe exceptions.exe bench.exe
 
 libmono_la_LDFLAGS=-Wl,-version-script=$(srcdir)/ldscript
 
 if JIT_SUPPORTED
-bin_PROGRAMS = mono
+bin_PROGRAMS = mono monos
 
 noinst_PROGRAMS = genmdesc
 
@@ -46,6 +47,11 @@ mono_LDADD = \
 	$(GLIB_LIBS)		\
 	$(GMODULE_LIBS) -lm
 
+monos_LDADD = \
+	$(libs)	\
+	$(GLIB_LIBS)		\
+	$(GMODULE_LIBS) -lm
+
 mono_LDFLAGS = \
 	-export-dynamic
 
@@ -96,12 +102,16 @@ if X86
 libmono_la_SOURCES = \
 	$(common_sources) $(x86_sources)
 
+monos_SOURCES = main.c $(common_sources) $(x86_sources)
+
 BURGSRC= $(common_BURGSRC) $(srcdir)/inssel-x86.brg
 endif
 
 if POWERPC
 libmono_la_SOURCES = \
 	$(common_sources) $(ppc_sources)
+
+monos_SOURCES = main.c $(common_sources) $(ppc_sources)
 
 BURGSRC= $(common_BURGSRC) $(srcdir)/inssel-ppc.brg
 endif

--C7zPtVaVf+AK4Oqc--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="014894.html">[Mono-list] build Mono statically linked?
</A></li>
	<LI> Next message: <A HREF="014898.html">[Mono-list] error of remoting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14999">[ date ]</a>
              <a href="thread.html#14999">[ thread ]</a>
              <a href="subject.html#14999">[ subject ]</a>
              <a href="author.html#14999">[ author ]</a>
         </LI>
       </UL>
</body></html>
