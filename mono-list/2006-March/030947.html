<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] Mono.Unix.Native.Syscall.readlink memory corruption
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Unix.Native.Syscall.readlink%20memory%20corruption&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030946.html">
   <LINK REL="Next"  HREF="030948.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] Mono.Unix.Native.Syscall.readlink memory corruption</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20Mono.Unix.Native.Syscall.readlink%20memory%20corruption&In-Reply-To="
       TITLE="[Mono-list] Mono.Unix.Native.Syscall.readlink memory corruption">kornelpal at hotmail.com
       </A><BR>
    <I>Tue Mar 14 06:51:42 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="030946.html">[Mono-list] Mono.Unix.Native.Syscall.readlink memory corruption
</A></li>
        <LI>Next message: <A HREF="030948.html">[Mono-list] Mono.Unix.Native.Syscall.readlink memory corruption
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30947">[ date ]</a>
              <a href="thread.html#30947">[ thread ]</a>
              <a href="subject.html#30947">[ subject ]</a>
              <a href="author.html#30947">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> As in the C world we known MAX_PATH, might it not be better to change the
</I>&gt;<i> semantics of the call so that it returns the path?
</I>
I agree that the function itself should handle the problem of allocating
sufficient buffer, freeing the buffer and simply return the path.

&gt;<i> On a related note:  if a C function mallocs some memory and returns a
</I>&gt;<i> pointer
</I>&gt;<i> to that memory, does p/invoke free the memory once marshalling is
</I>&gt;<i> complete?
</I>
No. There is simply no way to automatically determine whether it should be
freed and there is even less chance to determine how (using what function)
it should be freed.

If you want to do so you have to use an IntPtr that you can free manually.
Note that you can alternatively use a custom marshaler but you have to do
the same with a more complex and probably more proper design.

Korn&#233;l

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030946.html">[Mono-list] Mono.Unix.Native.Syscall.readlink memory corruption
</A></li>
	<LI>Next message: <A HREF="030948.html">[Mono-list] Mono.Unix.Native.Syscall.readlink memory corruption
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30947">[ date ]</a>
              <a href="thread.html#30947">[ thread ]</a>
              <a href="subject.html#30947">[ subject ]</a>
              <a href="author.html#30947">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
