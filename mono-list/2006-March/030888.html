<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] executing a tool from within c#
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20executing%20a%20tool%20from%20within%20c%23&In-Reply-To=17128.1141898647%40www051.gmx.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030887.html">
   <LINK REL="Next"  HREF="030889.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] executing a tool from within c#</H1>
    <B>Colin JN Breame</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20executing%20a%20tool%20from%20within%20c%23&In-Reply-To=17128.1141898647%40www051.gmx.net"
       TITLE="[Mono-list] executing a tool from within c#">colin at breame.net
       </A><BR>
    <I>Thu Mar  9 05:20:20 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="030887.html">[Mono-list] executing a tool from within c#
</A></li>
        <LI>Next message: <A HREF="030889.html">[Mono-list] executing a tool from within c#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30888">[ date ]</a>
              <a href="thread.html#30888">[ thread ]</a>
              <a href="subject.html#30888">[ subject ]</a>
              <a href="author.html#30888">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thursday 09 March 2006 10:04, Malte Dreschert wrote:
&gt;<i> Sorry,
</I>&gt;<i> I forgot to put a headline on top.
</I>&gt;<i>
</I>&gt;<i> So again: How can I execute a program from within a mono/c# application.
</I>&gt;<i>
</I>&gt;<i> Thanks you and so long.
</I>
Malte,

I use something along the lines of what is below.

However, I pretty sure that execute_capture_output can cause deadlocks within 
the running application. &#160;This is due to the ordering of the lines:

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;string output = p.StandardError.ReadToEnd();
&#160; &#160; &#160; &#160; output += p.StandardOutput.ReadToEnd();

The application can deadlock because it is blocked writting to its' stdout 
which is not read from until its' stderr is closed (which will never happen 
because it is blocked).

Although this is a known issue I'm not sure there is a way around it and 
no-one has suggested a solution. &#160;Anyhow, this works for the most part.

Colin

---

using System.Diagnostics;
string output = p.StandardError.ReadToEnd();
&#160; &#160; &#160; &#160; output += p.StandardOutput.ReadToEnd();
namespace colib {
&#160; public class process_t {
&#160; &#160; public static string execute_capture_output(string cmd_line,
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; out int exit_code) {
&#160; &#160; &#160; using (Process p = new Process()) {
&#160; &#160; &#160; &#160; int i = cmd_line.IndexOf(' ');
&#160; &#160; &#160; &#160; if (i == -1) {
&#160; &#160; &#160; &#160; &#160; p.StartInfo.FileName = cmd_line;
&#160; &#160; &#160; &#160; } else {
&#160; &#160; &#160; &#160; &#160; p.StartInfo.FileName = l_t.left(cmd_line, i);
&#160; &#160; &#160; &#160; &#160; p.StartInfo.Arguments = l_t.right(cmd_line, -i-1);
&#160; &#160; &#160; &#160; }

&#160; &#160; &#160; &#160; p.StartInfo.UseShellExecute = false;
&#160; &#160; &#160; &#160; p.StartInfo.RedirectStandardOutput = true;
&#160; &#160; &#160; &#160; p.StartInfo.RedirectStandardError = true;
&#160; &#160; &#160; &#160; p.Start();
&#160; &#160; &#160; &#160; string output = p.StandardError.ReadToEnd();
&#160; &#160; &#160; &#160; output += p.StandardOutput.ReadToEnd();

&#160; &#160; &#160; &#160; p.WaitForExit();
&#160; &#160; &#160; &#160; exit_code = p.ExitCode;

&#160; &#160; &#160; &#160; return output;
&#160; &#160; &#160; }
&#160; &#160; }

&#160; &#160; public static int execute(string path) {
&#160; &#160; &#160; Process p = new Process();
&#160; &#160; &#160; int i = path.IndexOf(' ');
&#160; &#160; &#160; if (i == -1) {
&#160; &#160; &#160; &#160; log_t.info(path);
&#160; &#160; &#160; &#160; p.StartInfo.FileName = path;
&#160; &#160; &#160; } else {
&#160; &#160; &#160; &#160; p.StartInfo.FileName = l_t.left(path, i);
&#160; &#160; &#160; &#160; p.StartInfo.Arguments = l_t.right(path, -i-1);
&#160; &#160; &#160; }

&#160; &#160; &#160; p.StartInfo.UseShellExecute = false;
&#160; &#160; &#160; p.Start();
&#160; &#160; &#160; p.WaitForExit();
&#160; &#160; &#160; int exit_code = p.ExitCode;
&#160; &#160; &#160; p.Close();
&#160; &#160; &#160; return exit_code;
&#160; &#160; }
&#160; }
}
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030887.html">[Mono-list] executing a tool from within c#
</A></li>
	<LI>Next message: <A HREF="030889.html">[Mono-list] executing a tool from within c#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30888">[ date ]</a>
              <a href="thread.html#30888">[ thread ]</a>
              <a href="subject.html#30888">[ subject ]</a>
              <a href="author.html#30888">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
