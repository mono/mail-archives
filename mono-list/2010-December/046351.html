<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-list] using 'unsafe struct *' instead of IntPtr with PInvoke..
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20using%20%27unsafe%20struct%20%2A%27%20instead%20of%20IntPtr%20with%0A%20PInvoke..&In-Reply-To=1293060906842-3161427.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="046340.html">
   <LINK REL="Next"  HREF="046355.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-list] using 'unsafe struct *' instead of IntPtr with PInvoke..</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-list%40lists.ximian.com?Subject=%5BMono-list%5D%20using%20%27unsafe%20struct%20%2A%27%20instead%20of%20IntPtr%20with%0A%20PInvoke..&In-Reply-To=1293060906842-3161427.post%40n4.nabble.com"
       TITLE="[Mono-list] using 'unsafe struct *' instead of IntPtr with PInvoke..">jonpryor at vt.edu
       </A><BR>
    <I>Thu Dec 23 12:45:35 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="046340.html">[Mono-list] using 'unsafe struct *' instead of IntPtr with PInvoke..
</A></li>
        <LI>Next message: <A HREF="046355.html">[Mono-list] using 'unsafe struct *' instead of IntPtr with	PInvoke..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46351">[ date ]</a>
              <a href="thread.html#46351">[ thread ]</a>
              <a href="subject.html#46351">[ subject ]</a>
              <a href="author.html#46351">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Dec 22, 2010, at 6:35 PM, jeske wrote:
&gt;<i> Is there anything wrong with this pattern?
</I>
That depends on how you define &quot;wrong.&quot; :-)

In theory, this is safe (safer, really, as you get more type checking).

In practice, it's more iffy for &quot;social&quot; reasons: unsafe code requires 'csc /unsafe', and some places don't like the '/unsafe' compiler flag.  The /unsafe' flag also marks the assembly as untrusted, so in certain CAS contexts you won't be able to use your assembly while you would be able to use the equivalent IntPtr code.

&gt;<i> At a deeper level, I wonder why Platform Invoke doesn't advocate using
</I>&gt;<i> something like this more often, because it's alot safer than storing and
</I>&gt;<i> passing everything around as IntPtr. 
</I>
Then there's the Common Language Subset (CLS) viewpoint: unsafe code is NOT part of the CLS, while IntPtr/etc. IS, so IntPtr is more &quot;portable&quot; across languages targeting .NET, and thus more &quot;general.&quot; Advocating IntPtr allows Microsoft to keep their documentation shorter and just write about the more general approach.

 - Jon

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="046340.html">[Mono-list] using 'unsafe struct *' instead of IntPtr with PInvoke..
</A></li>
	<LI>Next message: <A HREF="046355.html">[Mono-list] using 'unsafe struct *' instead of IntPtr with	PInvoke..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46351">[ date ]</a>
              <a href="thread.html#46351">[ thread ]</a>
              <a href="subject.html#46351">[ subject ]</a>
              <a href="author.html#46351">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-list">More information about the Mono-list
mailing list</a><br>
</body></html>
