<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] VB6 and the future cont
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20VB6%20and%20the%20future%20cont&In-Reply-To=dd99b8c80608231747y3db2927eyc061a23ff52ef4a7%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000554.html">
   <LINK REL="Next"  HREF="000556.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] VB6 and the future cont</H1>
    <B>Robert S Conley</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20VB6%20and%20the%20future%20cont&In-Reply-To=dd99b8c80608231747y3db2927eyc061a23ff52ef4a7%40mail.gmail.com"
       TITLE="[mono-vb] VB6 and the future cont">robertsconley at gmail.com
       </A><BR>
    <I>Wed Aug 23 23:17:52 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000554.html">[mono-vb] VB6 and the future cont
</A></li>
        <LI>Next message: <A HREF="000556.html">[mono-vb] Why are Modules in VB runtime declared as Classes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#555">[ date ]</a>
              <a href="thread.html#555">[ thread ]</a>
              <a href="subject.html#555">[ subject ]</a>
              <a href="author.html#555">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Rafael Teixeira wrote:

&gt;<i> VB6 syntax is somewhat easy to compile into a .NET assembly, the
</I>&gt;<i> really trick part is that VB is too tied with COM, so it isn't always
</I>&gt;<i> possible to guarantee things will work.
</I>&gt;<i>
</I>I agree that Visual BASIC forms and controls could prove impossible to 
compile. But my application also has a dozen ActiveX DLLs that are just 
code with little reliance on COM other than then the fact they are in 
ActiveX DLLs. I manually transferred a few of the simpler projects to 
.NET and they work much as they do in the ActiveX version,


&gt;<i> I've written lots of code in VB6 and know how hard it is to make it
</I>&gt;<i> work without third-party controls and some custom C++/ATL components,
</I>&gt;<i> and both would pose real problems to compile and to run outside
</I>&gt;<i> Windows and even on .NET.
</I>&gt;<i>
</I>I am not trying to be argumentative, but the problem I run into this. In 
the Visual Basic 6 world you got a lot of people who use VB6 with a 
database front end with crystal report as their report engine. Then you 
have a group that is probably just as large that used VB6 for a variety 
of apps that are made of mostly forms interacting with each other. Then 
have vertical market guys like me which are a small minority. In general 
we avoid dependence on 3rd party control like the plague, and have a 
huge amount of code wrapped up in ActiveX Dlls. While the last two 
groups are hurt, the third group has the best chance of benefiting from 
a VB6 .NET complier.

Because the vertical market guys are such a small part of the VB6 market 
we can't get Microsoft to hear us. C/C++ on the other hand has a higher 
portion of people making standalong apps so they get the hybrid 
compliers that allow to keep their old code going and mixing in .NET 
stuff when they want too. I don't if that true but it the only thing 
that make sense given the behavior of the managers I communicated with.

&gt;<i> Mono doesn't support COM, yet, and will support it only in Windows,
</I>&gt;<i> but that may not stop you as maybe what you really want is just to
</I>&gt;<i> compile then with a vbnc-derivative and run them in plain MS
</I>&gt;<i> .NET/Windows.
</I>&gt;<i>
</I>So we are all on the same page. Our lowest level DLL is called 
ViconUtility. everything in our problem depends on it but it depends on 
nothing else. I want to be able to compile that and get a .NET assembly. 
Test it using the same tests we use for VB6 and verify it is ok. Note 
this not through COM Interop but our tests compiled with the 
vbnc-derivative. With that work we go on to the next DLL. ViconObjects 
which has our data structures. We compile that but the reference to 
ViconUtility will no longer be through COM but through the .NET way of 
references. From my manual tests this will work. Then I can run my 
ViconObject tests. Then I add the Shapes Library, the File Import/Export 
Library, the Report Library and so on.

Finally I have a version of our software running that has everything but 
the forms. Now the way our software works is that Form do nothing other 
than pass and receive messages through an Interface. We did this a 
couple of years ago so that we can have automated UI testing. By the 
time I reach this point I am ready to pick a form package (Winform, Gtk, 
or whatever) and start building forms and having them implement the UI 
interfaces.

But without that VB6 to .NET compilier it takes me too long to reliably 
convert even the Utility DLL
&gt;<i> Even so I believe that the old components will tie things down: for
</I>&gt;<i> instance, the current COM-Interop infrastructure may not be
</I>&gt;<i> appropriate for the task, as you already pointed some limitations it
</I>&gt;<i> imposes. Also dealing with .frm files, are surely to  bring some hard
</I>&gt;<i> to deal problems, as they don't map very well to SWF (and even less
</I>&gt;<i> with WPF/Avalon).
</I>&gt;<i>
</I>I hear you, but I can implement nearly all of the Gang Of Four Design 
Patterns in VB6. So for people who are not as well factored as our 
company's application they can re-factor their original app in VB6 using 
automated testing to the point where a vbnc VB6 complier can get 
everything but the forms. It will take longer but each step can be 
tested to be correct, including the vb6 to .net step. But without that 
VB6 complier we can't do it. The translator wizard chokes on every piece 
of non-trivial code.

I done three conversion in the 20 years, in every conversion. there was 
a phase where I was re-working original code, and testing. Because the 
change was easier to port while performing the same function. With a 
vbnc based VB6 complier then I can do this process a lot more reliably.
&gt;<i> For me, all the thousands of lines of VB6 code I wrote have been in
</I>&gt;<i> the care of other hands for the last 5 years, and since I've started
</I>&gt;<i> all new projects natively in Mono/.NET using C# and some in Java, so I
</I>&gt;<i> really doesn't feel the pressing need for a VB6 compiler, but I
</I>&gt;<i> sympathize with you, as my first attempt to migrate those hundreds of
</I>&gt;<i> VB6 classes and/or forms to VB.NET with the VS.NET wizard,
</I>&gt;<i> 5-and-a-half years ago, generated something I could only call garbage.
</I>&gt;<i>
</I>Some of us don't have the option of handing it off to other people and 
starting again. We can't replace this software. At some point we have to 
update to the current platform. I am trying to minimize the cost of 
doing so, put putting us in a situation where we are not solely 
dependent on Microsoft again.

Thanks
Rob Conley
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000554.html">[mono-vb] VB6 and the future cont
</A></li>
	<LI>Next message: <A HREF="000556.html">[mono-vb] Why are Modules in VB runtime declared as Classes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#555">[ date ]</a>
              <a href="thread.html#555">[ thread ]</a>
              <a href="subject.html#555">[ subject ]</a>
              <a href="author.html#555">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
