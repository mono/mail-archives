<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] Creating instance of VB assembly in native linux c	application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20Creating%20instance%20of%20VB%20assembly%20in%20native%20linux%20c%0A%09application&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000525.html">
   <LINK REL="Next"  HREF="000526.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] Creating instance of VB assembly in native linux c	application</H1>
    <B>Alex Sisson</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20Creating%20instance%20of%20VB%20assembly%20in%20native%20linux%20c%0A%09application&In-Reply-To="
       TITLE="[mono-vb] Creating instance of VB assembly in native linux c	application">alexs at callview.com
       </A><BR>
    <I>Mon Aug 14 09:24:01 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000525.html">[mono-vb] Creating instance of VB assembly in native linux c	application
</A></li>
        <LI>Next message: <A HREF="000526.html">[mono-vb] Creating instance of VB assembly in native linux c	application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#529">[ date ]</a>
              <a href="thread.html#529">[ thread ]</a>
              <a href="subject.html#529">[ subject ]</a>
              <a href="author.html#529">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

Thanks for the reply.

Was checking the refences in the VS object browser and noticed that the VB DLL namespace was shown
as VBDLL.SWAN   (VBDLL is the project, SWAN was my namespace), where as in the C# DLL the name space
was just shown as SWAN.

I was calling mono_class_from_name with the name_space parameter as SWAN - changing this to VBDLL.SWAN for the
vb dll made it work.

This seems a little inconsistent, so not sure if VS is doing something wrong by prefixing the project to the namespace for VB assemblies.

Anyway, cheers
Alex


-----Original Message-----
From: Rafael Teixeira [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">monoman at gmail.com</A>]
Sent: 14 August 2006 13:59
To: Alex Sisson
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">mono-vb at lists.ximian.com</A>
Subject: Re: [mono-vb] Creating instance of VB assembly in native linux
c application


Never heard of someone trying to call VB.NET assembly from C by embedding Mono.

Have you tried to call the methods from C# instead of from C?

Also, check that you didn't compile them with incremental linking
(default on debug builds) as it puts an undocumented segment within
the assembly, that prevents Mono from loading the assembly.

Possible culprits, if both tests above pass OK:
++ vbc (the compiler that VS.NET calls) may generate assemblies with
some undocumented characteristic, that Mono doesn't know how to deal
(if such we wan't to know to implement it)
++ some support code in mono's implementation
Microsoft.VisualBasic.dll, doesn't work as needed (doesn't seem to be
it, but alas)

Could you open a bugzilla case with details, and a short VB.NET
assembly that causes the problem (the snippet of code that do your
embedded calling)?

Thanks,

On 8/14/06, alexs &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">alexs at callview.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I'm investigating mono so that we can avoid rewriting VB.NET assemblies  for
</I>&gt;<i> a possible linux port of our software...
</I>&gt;<i>
</I>&gt;<i> I have created a simple VB.NET assembly with static and instance methods and
</I>&gt;<i> compile is in Visual Studio. On Linux in c, I can load the assembly, and
</I>&gt;<i> invoke the static methods no problems. But when I try and create an
</I>&gt;<i> instance, it fails - well, &quot;mono_class_from_name&quot; is what fails (I'm using
</I>&gt;<i> the right namespace and class name!)...
</I>&gt;<i>
</I>&gt;<i> If I recreate the  assembly in C# with the same methods, and compile again
</I>&gt;<i> on VS, I can create an instance of it no problems in linux, and can call an
</I>&gt;<i> instance method.
</I>&gt;<i>
</I>&gt;<i> Does anyone have an ideas as to why this could be?
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i> Alex
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://www.nabble.com/Creating-instance-of-VB-assembly-in-native-linux-c-application-tf2102633.html#a5794595">http://www.nabble.com/Creating-instance-of-VB-assembly-in-native-linux-c-application-tf2102633.html#a5794595</A>
</I>&gt;<i> Sent from the Mono - VB forum at Nabble.com.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-vb mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">Mono-vb at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>&gt;<i>
</I>

-- 
Rafael &quot;Monoman&quot; Teixeira
---------------------------------------
&quot;The reasonable man adapts himself to the world; the unreasonable one
persists in trying to adapt the world to himself. Therefore all
progress depends on the unreasonable man.&quot; George Bernard Shaw


This message has been scanned for viruses by MailController - www.MailController.altohiway.com
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000525.html">[mono-vb] Creating instance of VB assembly in native linux c	application
</A></li>
	<LI>Next message: <A HREF="000526.html">[mono-vb] Creating instance of VB assembly in native linux c	application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#529">[ date ]</a>
              <a href="thread.html#529">[ thread ]</a>
              <a href="subject.html#529">[ subject ]</a>
              <a href="author.html#529">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
