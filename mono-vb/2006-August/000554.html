<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] VB6 and the future cont
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20VB6%20and%20the%20future%20cont&In-Reply-To=78471b000608231204k521ccbe4j6e2a9a698390e6a0%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000553.html">
   <LINK REL="Next"  HREF="000555.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] VB6 and the future cont</H1>
    <B>Rafael Teixeira</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20VB6%20and%20the%20future%20cont&In-Reply-To=78471b000608231204k521ccbe4j6e2a9a698390e6a0%40mail.gmail.com"
       TITLE="[mono-vb] VB6 and the future cont">monoman at gmail.com
       </A><BR>
    <I>Wed Aug 23 20:47:56 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000553.html">[mono-vb] VB6 and the future cont
</A></li>
        <LI>Next message: <A HREF="000555.html">[mono-vb] VB6 and the future cont
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#554">[ date ]</a>
              <a href="thread.html#554">[ thread ]</a>
              <a href="subject.html#554">[ subject ]</a>
              <a href="author.html#554">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Rob,

VB6 syntax is somewhat easy to compile into a .NET assembly, the
really trick part is that VB is too tied with COM, so it isn't always
possible to guarantee things will work.

I've written lots of code in VB6 and know how hard it is to make it
work without third-party controls and some custom C++/ATL components,
and both would pose real problems to compile and to run outside
Windows and even on .NET.

Mono doesn't support COM, yet, and will support it only in Windows,
but that may not stop you as maybe what you really want is just to
compile then with a vbnc-derivative and run them in plain MS
.NET/Windows.

Even so I believe that the old components will tie things down: for
instance, the current COM-Interop infrastructure may not be
appropriate for the task, as you already pointed some limitations it
imposes. Also dealing with .frm files, are surely to  bring some hard
to deal problems, as they don't map very well to SWF (and even less
with WPF/Avalon).

In other words, reversing some MS decisions to support managed VB6
apps, may mean to duplicate lots of .NET functionality to match more
properly what VBRUN6 and lots of standard and third-party OCXs
present.

For me, all the thousands of lines of VB6 code I wrote have been in
the care of other hands for the last 5 years, and since I've started
all new projects natively in Mono/.NET using C# and some in Java, so I
really doesn't feel the pressing need for a VB6 compiler, but I
sympathize with you, as my first attempt to migrate those hundreds of
VB6 classes and/or forms to VB.NET with the VS.NET wizard,
5-and-a-half years ago, generated something I could only call garbage.

Good luck,

On 8/23/06, Rob Conley &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">robertsconley at gmail.com</A>&gt; wrote:
&gt;<i> Sorry for that the last message got sent accidentally
</I>&gt;<i> ----------
</I>&gt;<i> This paided off when we made the transition from VB3 to VB6. Along with the
</I>&gt;<i> upgrade to 32-bit Windows we took advantage of the object-oriented features
</I>&gt;<i> turn our application to using Model-View-Presentation to allow more
</I>&gt;<i> flexiability in adding features for specific customers. Because the core
</I>&gt;<i> langauge did not change between VB3 and VB6 our testing suite was very easy
</I>&gt;<i> to implement as a lot of older testing code just transfered right over.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://martinfowler.com/eaaDev/PassiveScreen.html">http://martinfowler.com/eaaDev/PassiveScreen.html</A>
</I>&gt;<i> <A HREF="http://martinfowler.com/eaaDev/PresentationModel.html">http://martinfowler.com/eaaDev/PresentationModel.html</A>
</I>&gt;<i>
</I>&gt;<i> As a result we had a piece of software that was well designed for any future
</I>&gt;<i> changes in Visual Basic.
</I>&gt;<i>
</I>&gt;<i> However with VB.NET Microsoft made this upgrade more like Rocky Mountain
</I>&gt;<i> BASIC to VB3 than VB3 to VB6. At first myself and my staff kinda of said
</I>&gt;<i> &quot;Well if that what it take to get all the new stuff.&quot; We schelduled the
</I>&gt;<i> upgrade for later rather than sooner but planned on doing it.
</I>&gt;<i>
</I>&gt;<i> Then F# came out of Microsoft Research, then RUBY.NET, then we learned more
</I>&gt;<i> about how .NET really compilied to IL, and how VB.NET and
</I>&gt;<i> Microsoft.VisualBasic.dll worked together. By the end of two years we
</I>&gt;<i> decided that Microsoft really blew it and with all the annoucement about
</I>&gt;<i> changes to the form engine for future versions of .NET (Avalon) we lost
</I>&gt;<i> confidence that Microsoft will maintain a stable langauge platform. I signed
</I>&gt;<i> the petition, exchanged emails with Microsoft Managers but they simpily
</I>&gt;<i> don't get it.
</I>&gt;<i>
</I>&gt;<i> Examples I can give is that Integer compile to Int32 and Longs compile to
</I>&gt;<i> Int64. While trival on the surface when you have a lot of math and binary
</I>&gt;<i> routines it is important. Plus the history of BASIC is that Integer and Long
</I>&gt;<i> definition doesn't change unlike the C/C++ world. You will find this 90% of
</I>&gt;<i> the BASIC dialect out there even in those BASIC that spanned the old
</I>&gt;<i> 8-bit/16-bit transition. In 8-bit Microsoft Basic a integer was 16-bit. More
</I>&gt;<i> serious is the lack of compatibility objects that emulate the graphic and
</I>&gt;<i> printing commands of VB6. Another is the fact you can't implement a COM
</I>&gt;<i> interface with properties unless all the parameters of the properties on the
</I>&gt;<i> COM interface are declared ByVal instead ByRef.
</I>&gt;<i>
</I>&gt;<i> In addition to our main development trunk, I maintain a conversion project
</I>&gt;<i> that has been worked on sproadically since the first version VB.NET. So my
</I>&gt;<i> experience with the problems of vb6 to vb.net is not the result of a few
</I>&gt;<i> days of work. We haven't pushed further because converting tests to pinpoint
</I>&gt;<i> the difference has been daunting and we are not sure whether problems are
</I>&gt;<i> because of change in the test or in the code. The real killer is that
</I>&gt;<i> management realizes that .NET doesn't bring enough to the table to derail
</I>&gt;<i> our main development in order to get a .net version out.
</I>&gt;<i>
</I>&gt;<i> There is a bunch of other vb6 developer who are similarily fustrated.
</I>&gt;<i> Anybody who used vb6 for a serious application for anything but a database
</I>&gt;<i> front end that uses crystal reports has been hammered by this.
</I>&gt;<i>
</I>&gt;<i>  I think that vbnc can be used as a basis for a .NET compilier that can
</I>&gt;<i> create valid assemblies and exes from vb6 code. I am not a compilier whiz
</I>&gt;<i> or I would plunge in myself. I can learn with some help. I want to let you
</I>&gt;<i> all know that this problem exist and the MONO vbnc could be the way out of
</I>&gt;<i> this mess for all vb6 developers. Granted I realize that we can't get the
</I>&gt;<i> vb6 IDE back with this but if we can just compile our .vbp project files
</I>&gt;<i> into a valid .NET assembly then we can plan for a rational conversion
</I>&gt;<i> upgrade.
</I>&gt;<i>
</I>&gt;<i> Rob Conley
</I>&gt;<i> Plasma Automation
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-vb mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">Mono-vb at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Rafael &quot;Monoman&quot; Teixeira
---------------------------------------
&quot;The reasonable man adapts himself to the world; the unreasonable one
persists in trying to adapt the world to himself. Therefore all
progress depends on the unreasonable man.&quot; George Bernard Shaw
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000553.html">[mono-vb] VB6 and the future cont
</A></li>
	<LI>Next message: <A HREF="000555.html">[mono-vb] VB6 and the future cont
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#554">[ date ]</a>
              <a href="thread.html#554">[ thread ]</a>
              <a href="subject.html#554">[ subject ]</a>
              <a href="author.html#554">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
