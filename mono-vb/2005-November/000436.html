<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] Simple VB app generate Error BC0000
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20Simple%20VB%20app%20generate%20Error%20BC0000&In-Reply-To=fe66c02a0511011845k9ead78cxf3ec321cdc0ce6ad%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000435.html">
   <LINK REL="Next"  HREF="000437.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] Simple VB app generate Error BC0000</H1>
    <B>A Rafael D Teixeira</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20Simple%20VB%20app%20generate%20Error%20BC0000&In-Reply-To=fe66c02a0511011845k9ead78cxf3ec321cdc0ce6ad%40mail.gmail.com"
       TITLE="[mono-vb] Simple VB app generate Error BC0000">rafael.teixeirabr at terra.com.br
       </A><BR>
    <I>Wed Nov  2 08:39:24 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000435.html">[mono-vb] Simple VB app generate Error BC0000
</A></li>
        <LI>Next message: <A HREF="000437.html">[mono-vb] &quot;#Region&quot;s supported?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#436">[ date ]</a>
              <a href="thread.html#436">[ thread ]</a>
              <a href="subject.html#436">[ subject ]</a>
              <a href="author.html#436">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>HI Kevin thanks for spotting this:

I've commited a patch for the error to be less drastic and hiding the
real cause:

2005-11-02  Rafael Teixeira &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">rafaelteixeirabr at hotmail.com</A>&gt;
        * typemanager.cs: avoiding some Null Pointer Exceptions in
GetPertinentStandardModules

==================================
Would you like to continue (Y)es/(N)o/(E)dit Message:  y
Comitting...
Sending        mbas/ChangeLog
Sending        mbas/typemanager.cs
Transmitting file data ..
Committed revision 52474.


The problem is that mbas is not finding Microsoft.VisualBasic.dll to
automatically reference. mbas looks for it in the same directory
mbas.exe is.

To reproduce your problem I've run this way in directory mbas (sources)
after my latest patch:

mono --debug mbas.exe /t:exe /out:editor-mono.exe editor.vb
MonoBASIC Compiler  0.96.2.0 - (c)2002, 2003, 2004, 2005 Rafael Teixeira
--------
THIS IS AN ALPHA SOFTWARE.
--------
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.LongType.FromString' could not
be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.IntegerType.FromString' could
not be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.SingleType.FromString' could not
be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.LongType.FromString' could not
be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.IntegerType.FromString' could
not be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.DoubleType.FromString' could not
be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.DecimalType.FromString' could
not be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.CharArrayType.FromString' could
not be found in 'Editor'error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.CharType.FromString' could not
be found in 'Editor'
error BC30451: The name
'Microsoft.VisualBasic.CompilerServices.BooleanType.FromString' could
not be found in 'Editor'
Compilation failed: 10 Error(s), 0 warnings

What pinpoints that MS.VB.DLL not being found is the real problem, to
make it sure I've tried referencing it explicitly:

mono --debug mbas.exe /t:exe /out:editor-mono.exe editor.vb -
r:../class/lib/default/Microsoft.VisualBasic.dll
MonoBASIC Compiler  0.96.2.0 - (c)2002, 2003, 2004, 2005 Rafael Teixeira
--------
THIS IS AN ALPHA SOFTWARE.
--------

** (mbas.exe:7475): WARNING **: Symbol
file /home/rafael/source/cli/mcs/class/lib/default/Microsoft.VisualBasic.dll.mdb has incorrect version (expected 39, got 38)
Compilation succeeded

It worked as expected (don't bother with that warning for now).

So make sure you've installed all things correctly: MS.VB.DLL MUST be in
the same as mbas.exe and Mono.GetOptions.dll, all the three non-core
parts of mbas.

Regards,


On Tue, 2005-11-01 at 18:45 -0800, Kevin Thompson wrote:
&gt;<i> i ran:
</I>&gt;<i> 
</I>&gt;<i> mbas /t:exe /out:editor-mono.exe editor.vb 
</I>&gt;<i> 
</I>&gt;<i> ===============editor.vb=====================
</I>&gt;<i> Imports System
</I>&gt;<i> 
</I>&gt;<i> Public Class Editor
</I>&gt;<i>     Public Shared Sub Main()
</I>&gt;<i>       System.Console.WriteLine(&quot;Test App1&quot;)
</I>&gt;<i>     End Sub
</I>&gt;<i> End Class
</I>&gt;<i> 
</I>&gt;<i> ==========================================
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I get compilation error:
</I>&gt;<i> 
</I>&gt;<i> MonoBASIC Compiler  0.96.2.0 - (c)2002, 2003, 2004, 2005 Rafael
</I>&gt;<i> Teixeira
</I>&gt;<i> --------
</I>&gt;<i> THIS IS AN ALPHA SOFTWARE.
</I>&gt;<i> --------
</I>&gt;<i> error BC0000: Exception: System.NullReferenceException: Object
</I>&gt;<i> reference not set to an instance of an object
</I>&gt;<i> in &lt;0x00138&gt; Mono.MonoBASIC.TypeManager:GetPertinentStandardModules
</I>&gt;<i> (System.String[] namespaces)
</I>&gt;<i> in &lt;0x0045a&gt; Mono.MonoBASIC.SimpleName:SimpleNameResolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec, Mono.MonoBASIC.Expression right_side,
</I>&gt;<i> Boolean allow_static)
</I>&gt;<i> in &lt;0x00011&gt; Mono.MonoBASIC.SimpleName:DoResolveAllowStatic
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec)
</I>&gt;<i> in &lt;0x0015b&gt; Mono.MonoBASIC.Expression:Resolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec, ResolveFlags flags)
</I>&gt;<i> in &lt;0x00092&gt; Mono.MonoBASIC.MemberAccess:DoResolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec, Mono.MonoBASIC.Expression right_side,
</I>&gt;<i> ResolveFlags flags)
</I>&gt;<i> in &lt;0x00011&gt; Mono.MonoBASIC.MemberAccess:DoResolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec)
</I>&gt;<i> in &lt;0x0016b&gt; Mono.MonoBASIC.Expression:Resolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec, ResolveFlags flags)
</I>&gt;<i> in &lt;0x00092&gt; Mono.MonoBASIC.MemberAccess:DoResolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec, Mono.MonoBASIC.Expression right_side,
</I>&gt;<i> ResolveFlags flags)
</I>&gt;<i> in &lt;0x00011&gt; Mono.MonoBASIC.MemberAccess:DoResolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec)
</I>&gt;<i> in &lt;0x0016b&gt; Mono.MonoBASIC.Expression:Resolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec, ResolveFlags flags)
</I>&gt;<i> in &lt;0x0019f&gt; Mono.MonoBASIC.Invocation:DoResolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec)
</I>&gt;<i> in &lt;0x0016b&gt; Mono.MonoBASIC.Expression:Resolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec, ResolveFlags flags)
</I>&gt;<i> in &lt;0x0000f&gt; Mono.MonoBASIC.Expression:Resolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec)
</I>&gt;<i> in &lt;0x0001d&gt; Mono.MonoBASIC.StatementExpression:Resolve
</I>&gt;<i> (Mono.MonoBASIC.EmitContext ec)
</I>&gt;<i> in &lt;0x001ad&gt; Mono.MonoBASIC.Block:Resolve (Mono.MonoBASIC.EmitContext
</I>&gt;<i> ec)
</I>&gt;<i> in &lt;0x000c1&gt; Mono.MonoBASIC.EmitContext:EmitTopBlock
</I>&gt;<i> (Mono.MonoBASIC.Block block, System.String bname,
</I>&gt;<i> Mono.MonoBASIC.InternalParameters ip, Location loc)
</I>&gt;<i> in &lt;0x00465&gt; Mono.MonoBASIC.MethodData:Emit
</I>&gt;<i> (Mono.MonoBASIC.TypeContainer parent, Mono.MonoBASIC.Block block,
</I>&gt;<i> System.Object kind)
</I>&gt;<i> in &lt;0x0002e&gt; Mono.MonoBASIC.Method:Emit (Mono.MonoBASIC.TypeContainer
</I>&gt;<i> parent)
</I>&gt;<i> in &lt;0x00239&gt; Mono.MonoBASIC.TypeContainer:Emit ()
</I>&gt;<i> in &lt;0x00303&gt; Mono.MonoBASIC.RootContext:EmitCode ()
</I>&gt;<i> in &lt;0x0001d&gt; Mono.Languages.Driver:EmitCode ()
</I>&gt;<i> in (wrapper delegate-invoke) System.MulticastDelegate:invoke_bool ()
</I>&gt;<i> in &lt;0x000df&gt; Mono.Languages.Driver:Execute (System.String[] args)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Same thing compiles fine under .net 1.1
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Am I doing something wrong?
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Kevin 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ______________________________________________________________________
</I>&gt;<i> E-mail classificado pelo Identificador de Spam Inteligente.
</I>&gt;<i> Para alterar a categoria classificada, visite o Terra Mail 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ______________________________________________________________________
</I>&gt;<i> Esta mensagem foi verificada pelo E-mail Protegido Terra.
</I>&gt;<i> Scan engine: McAfee VirusScan / Atualizado em 01/11/2005 / Vers&#227;o:
</I>&gt;<i> 4.4.00/4617
</I>&gt;<i> Proteja o seu e-mail Terra: <A HREF="http://mail.terra.com.br/">http://mail.terra.com.br/</A> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-vb mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">Mono-vb at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000435.html">[mono-vb] Simple VB app generate Error BC0000
</A></li>
	<LI>Next message: <A HREF="000437.html">[mono-vb] &quot;#Region&quot;s supported?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#436">[ date ]</a>
              <a href="thread.html#436">[ thread ]</a>
              <a href="subject.html#436">[ subject ]</a>
              <a href="author.html#436">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
