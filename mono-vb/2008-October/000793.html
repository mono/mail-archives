<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] CLI program compiled with VS08 does't run under Mono 1.9.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20CLI%20program%20compiled%20with%20VS08%20does%27t%20run%20under%20Mono%201.9.1&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000783.html">
   <LINK REL="Next"  HREF="000794.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] CLI program compiled with VS08 does't run under Mono 1.9.1</H1>
    <B>Paebbels</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20CLI%20program%20compiled%20with%20VS08%20does%27t%20run%20under%20Mono%201.9.1&In-Reply-To="
       TITLE="[mono-vb] CLI program compiled with VS08 does't run under Mono 1.9.1">Paebbels at gmail.com
       </A><BR>
    <I>Sun Oct 26 11:47:13 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000783.html">[mono-vb] GridView/Npgsql, sorting &amp; paging does not work
</A></li>
        <LI>Next message: <A HREF="000794.html">[mono-vb] CLI program compiled with VS08 does't run under Mono	1.9.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#793">[ date ]</a>
              <a href="thread.html#793">[ thread ]</a>
              <a href="subject.html#793">[ subject ]</a>
              <a href="author.html#793">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello,

I have written a CLI programm in VisualBasic with VisualStudio 2008.

options and modifications to the standard VB-cli template:
- destination framework version 2.0
- removed unused dependencies
- removed Microsoft.VisualBasic Namespace
- commented all &lt; ***VisualBasic ***&gt; attributes
- commented all source code related to the My-Namespace from code-generator

then I compiled my project with VS und copied it with WinSCP to Linux:
- Debian
- Mono 1.9.1 with libmono-microsoft8.0-cil

Error when starting $ mono ./LookupTableEditor.exe -i

----------
** (./LookupTableEditor.exe:13487): WARNING **: The following assembly
referenced from /root/ewms/lte/LookupTableEditor.exe could not be loaded:
     Assembly:   Microsoft.VisualBasic    (assemblyref_index=1)
     Version:    8.0.0.0
     Public Key: b03f5f7f11d50a3a
The assembly was not found in the Global Assembly Cache, a path listed in
the MONO_PATH environment variable, or in the location of the executing
assembly (/root/ewms/lte/).

** (./LookupTableEditor.exe:13487): WARNING **: Could not load file or
assembly 'Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral,
PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies.

** (./LookupTableEditor.exe:13487): WARNING **: Missing method
ConditionalCompareObjectNotEqual in assembly
/root/ewms/lte/LookupTableEditor.exe, type
Microsoft.VisualBasic.CompilerServices.Operators

Unhandled Exception: System.IO.FileNotFoundException: Could not load file or
assembly 'Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral,
PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies.
File name: 'Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral,
PublicKeyToken=b03f5f7f11d50a3a'
----------

i know that mono is searching for Microsoft.VisualBasic but I removed every
dependency I could find :(

monodis ./LookupTableEditor.exe has this output:

----------
.assembly extern mscorlib
{
  .ver 2:0:0:0
  .publickeytoken = (B7 7A 5C 56 19 34 E0 89 ) // .z\V.4..
}
.assembly extern Microsoft.VisualBasic
{
  .ver 8:0:0:0
  .publickeytoken = (B0 3F 5F 7F 11 D5 0A 3A ) // .?_....:
}

[...]
.namespace LookupTableEditor.My
{
  .class private auto ansi MyApplication
        extends
[Microsoft.VisualBasic]Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase
  {
    .custom instance void class
[System]System.ComponentModel.EditorBrowsableAttribute::'.ctor'(valuetype
[System]System.ComponentModel.EditorBrowsableState) =  (01 00 01 00 00 00 00
00 ) // ........

    .custom instance void class
[System]System.CodeDom.Compiler.GeneratedCodeAttribute::'.ctor'(string,
string) =  (
                01 00 0A 4D 79 54 65 6D 70 6C 61 74 65 07 38 2E   //
...MyTemplate.8.
                30 2E 30 2E 30 00 00                            ) // 0.0.0..
[...]
----------



is it posible to totally remove this &quot;My&quot; Namespace from VB-projects?
-- 
View this message in context: <A HREF="http://www.nabble.com/CLI-program-compiled-with-VS08-does%27t-run-under-Mono-1.9.1-tp20174907p20174907.html">http://www.nabble.com/CLI-program-compiled-with-VS08-does%27t-run-under-Mono-1.9.1-tp20174907p20174907.html</A>
Sent from the Mono - VB mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000783.html">[mono-vb] GridView/Npgsql, sorting &amp; paging does not work
</A></li>
	<LI>Next message: <A HREF="000794.html">[mono-vb] CLI program compiled with VS08 does't run under Mono	1.9.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#793">[ date ]</a>
              <a href="thread.html#793">[ thread ]</a>
              <a href="subject.html#793">[ subject ]</a>
              <a href="author.html#793">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
