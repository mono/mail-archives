<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] CLI program compiled with VS08 does't run under Mono 1.9.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20CLI%20program%20compiled%20with%20VS08%20does%27t%20run%20under%20Mono%0A%201.9.1&In-Reply-To=006b01c93812%24cb833430%2462899c90%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000795.html">
   <LINK REL="Next"  HREF="000801.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] CLI program compiled with VS08 does't run under Mono 1.9.1</H1>
    <B>Paebbels</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20CLI%20program%20compiled%20with%20VS08%20does%27t%20run%20under%20Mono%0A%201.9.1&In-Reply-To=006b01c93812%24cb833430%2462899c90%24%40com"
       TITLE="[mono-vb] CLI program compiled with VS08 does't run under Mono 1.9.1">Paebbels at gmail.com
       </A><BR>
    <I>Mon Oct 27 16:55:27 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000795.html">[mono-vb] CLI program compiled with VS08 does't run under Mono	1.9.1
</A></li>
        <LI>Next message: <A HREF="000801.html">[mono-vb] CLI program compiled with VS08 does't run under Mono	1.9.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#796">[ date ]</a>
              <a href="thread.html#796">[ thread ]</a>
              <a href="subject.html#796">[ subject ]</a>
              <a href="author.html#796">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Rolf Bjarne Kvinge-2 wrote:
&gt;<i> 
</I>&gt;<i> [...] 
</I>&gt;<i> 
</I>&gt;<i> It's not possible to remove the Microsoft.VisualBasic reference when
</I>&gt;<i> compiling in VS 2008 [1].
</I>&gt;<i> 
</I>&gt;<i> In any case you don't have to, mono includes Microsoft.VisualBasic.dll,
</I>&gt;<i> though it is not installed by default. The package you need to install is
</I>&gt;<i> named 'mono-basic' in openSuse, I think it's called
</I>&gt;<i> libmono-microsoft-visualbasic8.0-cil in Debian (according to this page at
</I>&gt;<i> least: <A HREF="http://packages.debian.org/source/sid/mono-basic">http://packages.debian.org/source/sid/mono-basic</A>)
</I>&gt;<i> 
</I>&gt;&gt;<i> is it posible to totally remove this &quot;My&quot; Namespace from VB-projects?
</I>&gt;<i> 
</I>&gt;<i> Yes. Define _MYTYPE=\&quot;Empty\&quot;. Also see:
</I>&gt;<i> <A HREF="http://msdn.microsoft.com/en-us/library/ms233781.aspx">http://msdn.microsoft.com/en-us/library/ms233781.aspx</A>
</I>&gt;<i> 
</I>&gt;<i> Rolf
</I>&gt;<i> 
</I>&gt;<i> [1]. It is possible to remove the Microsoft.VisualBasic.dll reference when
</I>&gt;<i> compiling from the command line, using passing '-vbruntime-' to the
</I>&gt;<i> compiler. Also see: <A HREF="http://msdn.microsoft.com/en-us/library/bb531259.aspx">http://msdn.microsoft.com/en-us/library/bb531259.aspx</A>
</I>&gt;<i>  
</I>&gt;<i> [...]
</I>&gt;<i> 
</I>
thanks for your post and your links

now I wrote 2 scripts for Windows:

build.cmd:
----------
vbc @build.rsp
----------


build.rsp:
----------
# Compiler-Options
/target:exe
#/main:MainModule
/rootnamespace:LookupTableEditor
/out:pn-lte.exe
/noconfig
/nostdlib
/vbruntime-
/platform:anycpu
/optimize+
/optionexplicit+
/optioncompare:binary
/optioninfer+
#/verbose
/bugreport:bugreport.log
/define:_MYTYPE=&quot;Empty&quot;

# References
/libpath:&quot;C:\Windows\Microsoft.NET\Framework\v2.0.50727&quot;
/reference:mscorlib.dll,System.dll,

# Files
*.vb
----------

now I have the same errors on windows, but with more details :)

bugreport.log
----------
[...]
### Compiler output
E:\EWMS\Studies\LookupTableEditor\CLIArgumentParser.vb(158) : error BC35000:
Requested operation is not available because the runtime library function
'Microsoft.VisualBasic.CompilerServices.Operators.CompareString' is not
defined.

                If value &lt;&gt; _UnSetValue Then
                   ~~~~~~~~~~~~~~~~~~~~     
### User description
### User suggested correct behavior
----------

I know that string comparisions are not as easy as integer comparisions, but
why do they define an Compare Operator / Method in the VisualBasic namespace
their should be an Compare Operator in mscorlib.dll or System.dll as well,
shouldn't it?

(C# needs this too *g*)


I have found &quot;libmono-microsoft-visualbasic8.0-cil&quot;, but it's only for
sid...
Compiling from source shows some errors:

----------
ewms:~/vbnc/mono-basic-2.0# make
make[1]: Entering directory `/root/vbnc/mono-basic-2.0/build'
make all-local
make[2]: Entering directory `/root/vbnc/mono-basic-2.0/build'
make[2]: Leaving directory `/root/vbnc/mono-basic-2.0/build'
make[1]: Leaving directory `/root/vbnc/mono-basic-2.0/build'
make[1]: Entering directory `/root/vbnc/mono-basic-2.0/class'
make all-local
make[2]: Entering directory `/root/vbnc/mono-basic-2.0/class'
make[2]: Leaving directory `/root/vbnc/mono-basic-2.0/class'
make[1]: Leaving directory `/root/vbnc/mono-basic-2.0/class'
make[1]: Entering directory `/root/vbnc/mono-basic-2.0/tools'
make[2]: Entering directory `/root/vbnc/mono-basic-2.0/tools/extract-source'
make all-local
make[3]: Entering directory `/root/vbnc/mono-basic-2.0/tools/extract-source'
MONO_PATH=&quot;../../class/lib/bootstrap:$MONO_PATH&quot; mono  --debug 
../../class/lib/                                                                                                                              
bootstrap/vbnc.exe    -debug -r:System.Xml.dll -noconfig
-define:_MYTYPE=\&quot;Empty                                                                                                                              
\&quot; -target:exe -out:extract-source.exe   @extract-source.exe.sources
Visual Basic.Net Compiler version 0.0.0.5904
Copyright (C) 2004-2008 Rolf Bjarne Kvinge. All rights reserved.



** (../../class/lib/bootstrap/vbnc.exe:19307): WARNING **: The following
assembl                                                                                                                              
y referenced from
/root/vbnc/mono-basic-2.0/class/lib/bootstrap/Microsoft.Visual                                                                                                                              
Basic.dll could not be loaded:
     Assembly:   System.Windows.Forms    (assemblyref_index=2)
     Version:    2.0.0.0
     Public Key: b77a5c561934e089
The assembly was not found in the Global Assembly Cache, a path listed in
the MO                                                                                                                              
NO_PATH environment variable, or in the location of the executing assembly
(/roo                                                                                                                              
t/vbnc/mono-basic-2.0/class/lib/bootstrap).


** (../../class/lib/bootstrap/vbnc.exe:19307): WARNING **: Could not load
file o                                                                                                                              
r assembly 'System.Windows.Forms, Version=2.0.0.0, Culture=neutral,
PublicKeyTok                                                                                                                              
en=b77a5c561934e089' or one of its dependencies.

** (../../class/lib/bootstrap/vbnc.exe:19307): WARNING **: Could not load
file o                                                                                                                              
r assembly 'System.Windows.Forms, Version=2.0.0.0, Culture=neutral,
PublicKeyTok                                                                                                                              
en=b77a5c561934e089' or one of its dependencies.

** (../../class/lib/bootstrap/vbnc.exe:19307): WARNING **: Could not load
file o                                                                                                                              
r assembly 'System.Windows.Forms, Version=2.0.0.0, Culture=neutral,
PublicKeyTok                                                                                                                              
en=b77a5c561934e089' or one of its dependencies.
Error : VBNC99999: Unexpected error: Could not load file or assembly
'System.Win                                                                                                                              
dows.Forms, Version=2.0.0.0, Culture=neutral,
PublicKeyToken=b77a5c561934e089' o                                                                                                                              
r one of its dependencies.
  at (wrapper managed-to-native) System.Reflection.Assembly:GetTypes (bool)
  at System.Reflection.Assembly.GetTypes () [0x00000]
  at vbnc.TypeManager.LoadReferencedTypes () [0x00000]
  at vbnc.TypeManager.LoadReferenced () [0x00000]
  at vbnc.Compiler.Compile () [0x00000]
Compilation took 00:00:00.8375950
make[3]: *** [extract-source.exe] Error 255
make[3]: Leaving directory `/root/vbnc/mono-basic-2.0/tools/extract-source'
make[2]: *** [do-all] Error 2
make[2]: Leaving directory `/root/vbnc/mono-basic-2.0/tools/extract-source'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/root/vbnc/mono-basic-2.0/tools'
make: *** [all-recursive] Error 1
----------


If I see it right: make uses vbnc to build some files, but vbnc requires
some nonexisting files ?

-- 
View this message in context: <A HREF="http://www.nabble.com/CLI-program-compiled-with-VS08-does%27t-run-under-Mono-1.9.1-tp20174907p20196231.html">http://www.nabble.com/CLI-program-compiled-with-VS08-does%27t-run-under-Mono-1.9.1-tp20174907p20196231.html</A>
Sent from the Mono - VB mailing list archive at Nabble.com.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000795.html">[mono-vb] CLI program compiled with VS08 does't run under Mono	1.9.1
</A></li>
	<LI>Next message: <A HREF="000801.html">[mono-vb] CLI program compiled with VS08 does't run under Mono	1.9.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#796">[ date ]</a>
              <a href="thread.html#796">[ thread ]</a>
              <a href="subject.html#796">[ subject ]</a>
              <a href="author.html#796">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
