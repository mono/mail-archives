<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] A .net vb program is crashing without vb
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20A%20.net%20vb%20program%20is%20crashing%20without%20vb&In-Reply-To=18045589.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000747.html">
   <LINK REL="Next"  HREF="000749.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] A .net vb program is crashing without vb</H1>
    <B>Andy Hume</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20A%20.net%20vb%20program%20is%20crashing%20without%20vb&In-Reply-To=18045589.post%40talk.nabble.com"
       TITLE="[mono-vb] A .net vb program is crashing without vb">andyhume32 at yahoo.co.uk
       </A><BR>
    <I>Sun Jun 22 15:12:57 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000747.html">[mono-vb]  A .net vb program is crashing without vb
</A></li>
        <LI>Next message: <A HREF="000749.html">[mono-vb] A .net vb program is crashing without vb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#748">[ date ]</a>
              <a href="thread.html#748">[ thread ]</a>
              <a href="subject.html#748">[ subject ]</a>
              <a href="author.html#748">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>


jfreak53 wrote:
&gt;<i> 
</I>&gt;<i> I am running ubuntu 8.04 hardy edition on an amd 64 laptop.  I'm trying to
</I>&gt;<i> run a program that was made for the school that I work at to enter grades,
</I>&gt;<i> this program is run from the server.  I can find the file alright and it
</I>&gt;<i> starts running but these are the errors that I get, then it exits and does
</I>&gt;<i> nothing.
</I>&gt;<i> 
</I>&gt;<i> This is running the program with wine:
</I>&gt;<i> 
</I>&gt;<i> preloader: Warning: failed to reserve range 00000000-60000000
</I>&gt;<i> preloader: Warning: failed to reserve range 00000000-60000000
</I>&gt;<i> err:dosmem:setup_dos_mem Cannot use first megabyte for DOS address space,
</I>&gt;<i> please report
</I>&gt;<i> preloader: Warning: failed to reserve range 00000000-60000000
</I>&gt;<i> err:dosmem:setup_dos_mem Cannot use first megabyte for DOS address space,
</I>&gt;<i> please report
</I>&gt;<i> preloader: Warning: failed to reserve range 00000000-60000000
</I>&gt;<i> err:dosmem:setup_dos_mem Cannot use first megabyte for DOS address space,
</I>&gt;<i> please report
</I>&gt;<i> err:dosmem:setup_dos_mem Cannot use first megabyte for DOS address space,
</I>&gt;<i> please report
</I>&gt;<i> preloader: Warning: failed to reserve range 00000000-60000000
</I>&gt;<i> err:dosmem:setup_dos_mem Cannot use first megabyte for DOS address space,
</I>&gt;<i> please report
</I>&gt;<i> preloader: Warning: failed to reserve range 00000000-60000000
</I>&gt;<i> err:dosmem:setup_dos_mem Cannot use first megabyte for DOS address space,
</I>&gt;<i> please report
</I>&gt;<i> fixme:win:EnumDisplayDevicesW ((null),0,0x7f32e310,0x00000000), stub!
</I>&gt;<i> fixme:win:SetLayeredWindowAttributes ((nil),0x00000000,255,2): stub!
</I>&gt;<i> fixme:win:GetLayeredWindowAttributes
</I>&gt;<i> ((nil),0x7f32f930,0x7f32f913,0x7f32f914): stub!
</I>&gt;<i> fixme:win:SetLayeredWindowAttributes (0x1002e,0x00000000,0,2): stub!
</I>&gt;<i> 
</I>&gt;<i> ** (MSSchool.exe:24): WARNING **: string marshalling conversion 34 not
</I>&gt;<i> implemented
</I>&gt;<i> 
</I>&gt;<i> Unhandled Exception: System.NotImplementedException: string marshalling
</I>&gt;<i> conversion 34 not implemented
</I>&gt;<i> at MSSchool.frmLogin.frmLogin_Load (object,System.EventArgs) &lt;0x00175&gt;
</I>&gt;<i> at System.Windows.Forms.Form.OnLoad (System.EventArgs) &lt;0x00059&gt;
</I>&gt;<i> [...]
</I>&gt;<i> 
</I>
This is a problem with a P/Invoke call, the app is using a form of P/Invoke
marshalling that Mono apparently does not support -- don't think there's
been a change since
<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/2008-April/027391.html">http://lists.ximian.com/pipermail/mono-devel-list/2008-April/027391.html</A>  If
you have access to the sources and recompile then its likely easily fixed...

(I presume that the earlier error messages are from wine).



jfreak53 wrote:
&gt;<i> 
</I>&gt;<i> and this is the error I get when I run it straight with mono:
</I>&gt;<i> 
</I>&gt;<i> ** (msschool.exe:6431): WARNING **: The following assembly referenced from
</I>&gt;<i> /mnt/msschool.exe could not be loaded:
</I>&gt;<i>      Assembly:   Microsoft.VisualBasic    (assemblyref_index=1)
</I>&gt;<i>      Version:    8.0.0.0
</I>&gt;<i>      Public Key: b03f5f7f11d50a3a
</I>&gt;<i> The assembly was not found in the Global Assembly Cache, a path listed in
</I>&gt;<i> the MONO_PATH environment variable, or in the location of the executing
</I>&gt;<i> assembly (/mnt/).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ** (msschool.exe:6431): WARNING **: Could not load file or assembly
</I>&gt;<i> 'Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral,
</I>&gt;<i> PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies.
</I>&gt;<i> The entry point method could not be loaded
</I>&gt;<i> 
</I>
So, that means you don't have a mono-basic package installed.  I don't know
about package support for ubuntu.  The other thread just now is searching
for debian support too...

However if the application is P/Invoke-ing to native Windows API calls then
its perhaps not likely to work on Mono on Linux anyway.  Download the Moma
tool and see what it reports, <A HREF="http://www.mono-project.com/Moma">http://www.mono-project.com/Moma</A>

Andy
-- 
View this message in context: <A HREF="http://www.nabble.com/A-.net-vb-program-is-crashing-without-vb-tp18045589p18057961.html">http://www.nabble.com/A-.net-vb-program-is-crashing-without-vb-tp18045589p18057961.html</A>
Sent from the Mono - VB mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000747.html">[mono-vb]  A .net vb program is crashing without vb
</A></li>
	<LI>Next message: <A HREF="000749.html">[mono-vb] A .net vb program is crashing without vb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#748">[ date ]</a>
              <a href="thread.html#748">[ thread ]</a>
              <a href="subject.html#748">[ subject ]</a>
              <a href="author.html#748">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
