<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] If Else, When  in VB ASP.NET
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:kjambunathan%40novell.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000307.html">
   <LINK REL="Next"  HREF="000305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] If Else, When  in VB ASP.NET
   </H1>
    <B>Jambunathan Jambunathan
    </B> 
    <A HREF="mailto:kjambunathan%40novell.com"
       TITLE="[mono-vb] If Else, When  in VB ASP.NET">kjambunathan@novell.com
       </A><BR>
    <I>Wed, 13 Oct 2004 00:30:30 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="000307.html">[mono-vb] If Else, When in VB ASP.NET (cont)
</A></li>
        <LI> Next message: <A HREF="000305.html">[mono-vb] If Else, When in VB ASP.NET (cont)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#304">[ date ]</a>
              <a href="thread.html#304">[ thread ]</a>
              <a href="subject.html#304">[ subject ]</a>
              <a href="author.html#304">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tue

The Catch, When clause is not as yet implemented. I think 
you may have  to recode it without When clause.

Also as an aside, a cursory examination of how MS 
implementation suggests that they are implemented through 
a &quot;user-filtered handler  that runs user-specified  code to 
determine whether the exception should be handled by the 
associated  handler or should be passed to the next protected 
block. &quot;

The documentation also suggests that 

&quot;Each language implements these exception handlers according 
to its specifications. For example, Visual Basic .NET provides 
access to the user-filtered handler through a variable comparison 
(using the When keyword) in the catch statement; 
C# does not implement the user-filtered handler.&quot;

What this statement implies is that when we  can't just rip off 
the equivalent code from mcs and plug it in to mbas to give you 
a workable solution right away. 

So if you want to stick to this construct you may have to wait
when we get to work on that. I assure you the wait wouldn't be too
long.
(Btw, our wait times are measured in units of months ;-))

Hey, I appreciate your mail.

Regards,
Jambunathan K.


&gt;&gt;&gt;<i> &quot;Tue Doan Nguyen&quot; &lt;<A HREF="mailto:minhtue@saigonnet.vn">minhtue@saigonnet.vn</A>&gt; 10/13/04 10:22 AM &gt;&gt;&gt;
</I>Hi Jambunathan,

This is some other errors that I face when i try to compile .vb file.
Please
give me a favour !

This is a code snippet that use &quot;When &quot; keyword

Try

thisId = Request.QueryString(&quot;id&quot;)

Catch ex As Exception When 1=1

Response.Redirect(&quot;thread.aspx&quot;)

End Try

----------------------------

ERROR MESSAGE:

syntax error, got token `WHEN', expecting AND ANDALSO DEFAULT END EOL
EVENT
FRIE
ND FUNCTION IMPLEMENTS IS MOD MUSTINHERIT NOTINHERITABLE NOTOVERRIDABLE
OR
ORELS
E OVERLOADS OVERRIDABLE OVERRIDES PRIVATE PROPERTY PROTECTED PUBLIC
READONLY
SHA
DOWS SHARED STEP SUB THEN TO WRITEONLY XOR OPEN_PARENS OPEN_BRACE
CLOSE_BRACE CL
OSE_PARENS DOT COMMA COLON PLUS MINUS ASSIGN OP_LT OP_GT STAR DIV
OP_EXP
OP_IDIV
 OP_CONCAT OP_LE OP_GE OP_NE OP_SHIFT_LEFT OP_SHIFT_RIGHT
reply.aspx.vb(32,25) error BC29999: Parsing error
Compilation failed: 1 Error(s), 0 warnings

----------------------------------------------------

And any &quot;If  Else&quot; leads to the ERROR:

syntax error, got token `ELSE', expecting AND ANDALSO EOL IS MOD OR
ORELSE
STEP
THEN TO XOR OPEN_PARENS CLOSE_BRACE CLOSE_PARENS DOT COMMA COLON PLUS
MINUS
ASSI
GN OP_LT OP_GT STAR DIV OP_EXP OP_IDIV OP_CONCAT OP_LE OP_GE OP_NE
OP_SHIFT_LEFT
 OP_SHIFT_RIGHT
topicAdd.aspx.vb(51,45) error BC29999: Parsing error
Compilation failed: 1 Error(s), 0 warnings



Thanks

BIB



----- Original Message -----

From: &quot;Jambunathan Jambunathan&quot; &lt;<A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>&gt;
To: &lt;<A HREF="mailto:minhtue@saigonnet.vn">minhtue@saigonnet.vn</A>&gt;
Cc: &lt;<A HREF="mailto:mono-vb@lists.ximian.com">mono-vb@lists.ximian.com</A>&gt;
Sent: Tuesday, October 12, 2004 12:39 PM
Subject: Re: AW: [mono-vb] Inherits in VB ASP.NET


&gt;<i> Hello
</I>&gt;<i>
</I>&gt;<i> As the implementation of &quot;:&quot; is not yet complete, you can,
</I>&gt;<i> for now, use an &quot;actual end of line&quot; instead of &quot;:&quot; as the
</I>&gt;<i> terminator.
</I>&gt;<i>
</I>&gt;<i> So replace,
</I>&gt;<i>
</I>&gt;<i> Public Class viewAllRecords : Inherits System.Web.UI.Page
</I>&gt;<i>
</I>&gt;<i> with
</I>&gt;<i>  Public Class viewAllRecords
</I>&gt;<i>                         Inherits System.Web.UI.Page
</I>&gt;<i>
</I>&gt;<i> I have made a note of this scenario in mbas test cases.
</I>&gt;<i>
</I>&gt;<i> I appreciate you taking time to report this.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Jambunathan K.
</I>&gt;<i>
</I>&gt;<i> &gt;&gt;&gt; &quot;Tue Doan Nguyen&quot; &lt;<A HREF="mailto:minhtue@saigonnet.vn">minhtue@saigonnet.vn</A>&gt; 10/11/04 9:38 PM &gt;&gt;&gt;
</I>&gt;<i> THIS IS THE CODE SNIPPET
</I>&gt;<i> -----------------
</I>&gt;<i> Imports System
</I>&gt;<i>
</I>&gt;<i> Imports System.Data
</I>&gt;<i>
</I>&gt;<i> Imports System.Data.OleDB
</I>&gt;<i>
</I>&gt;<i> Imports System.Configuration
</I>&gt;<i>
</I>&gt;<i> Imports System.Web.UI.WebControls
</I>&gt;<i>
</I>&gt;<i> Imports System.Web.UI.HtmlControls
</I>&gt;<i>
</I>&gt;<i> Imports dotForumIncludes
</I>&gt;<i>
</I>&gt;<i> Namespace dotForumClientTopic
</I>&gt;<i>
</I>&gt;<i> Public Class viewAllRecords : Inherits System.Web.UI.Page
</I>&gt;<i>
</I>&gt;<i> Public myIncludes As New includeFunctions
</I>&gt;<i>
</I>&gt;<i> Protected dotForumDisplay As System.Web.UI.WebControls.DataGrid
</I>&gt;<i>
</I>&gt;<i> Protected messageCenter As
</I>&gt;<i> System.Web.UI.HtmlControls.HtmlGenericControl
</I>&gt;<i>
</I>&gt;<i> Protected threadLink As
</I>System.Web.UI.HtmlControls.HtmlGenericControl
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Public pageTitle As String = &quot; .: ITCN Asp.Net Forum 2004 :. &quot;
</I>&gt;<i>
</I>&gt;<i> Public pageDesc As String = &quot;ITCN Asp.Net Forum 2004&quot;
</I>&gt;<i>
</I>&gt;<i> Public pageKeys As String = &quot;.net, asp.net, asp, visual basic,
</I>&gt;<i> microsoft,
</I>&gt;<i> itcn, programming, server, clr, net, discussion, forum, discussion
</I>&gt;<i> board,
</I>&gt;<i> free, source code, open source&quot;
</I>&gt;<i>
</I>&gt;<i> Sub Page_Load(sender as Object, e as EventArgs)
</I>&gt;<i>
</I>&gt;<i> If Not Page.IsPostBack then
</I>&gt;<i>
</I>&gt;<i> bindData()
</I>&gt;<i>
</I>&gt;<i> End If
</I>&gt;<i>
</I>&gt;<i> End Sub
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Sub bindData()
</I>&gt;<i>
</I>&gt;<i> Dim myConnection as New
</I>&gt;<i>
</I>oleDBConnection(&quot;Provider=SQLOLEDB;server=localhost;uid=sa;pwd=;database=For
&gt;<i> um200412&quot;)
</I>&gt;<i>
</I>&gt;<i> Dim myCommand as New oleDBCommand(&quot;SELECT bcId, Left(bcTitle, 100)
</I>As
&gt;<i> bcTitle, bcDesc, bcOrder, bcLastUpdate, bcLock FROM forumTopics
</I>ORDER
&gt;<i> BY
</I>&gt;<i> bcOrder, bcLastUpdate DESC&quot;, myConnection)
</I>&gt;<i>
</I>&gt;<i> Dim myDA as New oleDBDataAdapter()
</I>&gt;<i>
</I>&gt;<i> myDA.SelectCommand = myCommand
</I>&gt;<i>
</I>&gt;<i> Dim myDS as New DataSet()
</I>&gt;<i>
</I>&gt;<i> myDA.Fill(myDS)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> dotForumDisplay.DataSource = myDS
</I>&gt;<i>
</I>&gt;<i> dotForumDisplay.DataBind()
</I>&gt;<i>
</I>&gt;<i> '### CHANGE THE FOLDER IMAGE BASED ON ATTRIBUTES
</I>&gt;<i>
</I>&gt;<i> Dim gridrow As DataGridItem
</I>&gt;<i>
</I>&gt;<i> Dim folderString As String
</I>&gt;<i>
</I>&gt;<i> Dim folderAltString As String
</I>&gt;<i>
</I>&gt;<i> Dim thisDate As Date
</I>&gt;<i>
</I>&gt;<i> Dim currentDate As Date = Microsoft.VisualBasic.Format(DateTime.Now,
</I>&gt;<i> &quot;MM-d-yyyy&quot;)
</I>&gt;<i>
</I>&gt;<i> For Each gridrow In dotForumDisplay.Items
</I>&gt;<i>
</I>&gt;<i> If CType(gridrow.FindControl(&quot;bcLock&quot;), HtmlInputHidden).Value = &quot;y&quot;
</I>&gt;<i> Then
</I>&gt;<i>
</I>&gt;<i> folderString = &quot;gfx/forum/folder_locked&quot;
</I>&gt;<i>
</I>&gt;<i> folderAltString = &quot;, Locked&quot;
</I>&gt;<i>
</I>&gt;<i> Else
</I>&gt;<i>
</I>&gt;<i> folderString = &quot;gfx/forum/folder&quot;
</I>&gt;<i>
</I>&gt;<i> folderAltString = &quot;&quot;
</I>&gt;<i>
</I>&gt;<i> End If
</I>&gt;<i>
</I>&gt;<i> thisDate = CType(gridrow.FindControl(&quot;bcLastUpdate&quot;),
</I>&gt;<i> HtmlInputHidden).Value
</I>&gt;<i>
</I>&gt;<i> If Microsoft.VisualBasic.Format(thisDate, &quot;MM-d-yyyy&quot;) = currentDate
</I>&gt;<i> Then
</I>&gt;<i>
</I>&gt;<i> folderString = folderString &amp; &quot;_new.gif&quot;
</I>&gt;<i>
</I>&gt;<i> folderAltString = folderAltString &amp; &quot;, New Activity&quot;
</I>&gt;<i>
</I>&gt;<i> Else
</I>&gt;<i>
</I>&gt;<i> folderString = folderString &amp; &quot;.gif&quot;
</I>&gt;<i>
</I>&gt;<i> End If
</I>&gt;<i>
</I>&gt;<i> CType(gridrow.FindControl(&quot;folderImage&quot;), Image).ImageUrl =
</I>&gt;<i> folderString
</I>&gt;<i>
</I>&gt;<i> CType(gridrow.FindControl(&quot;folderImage&quot;), Image).AlternateText =
</I>&gt;<i> CType(gridrow.FindControl(&quot;bcTitle&quot;), HyperLink).Text &amp;
</I>&gt;<i> folderAltString
</I>&gt;<i>
</I>&gt;<i> Next
</I>&gt;<i>
</I>&gt;<i> '### DISABLE NEXT/PREV IF LESS THAN dotForumDisplay.PageSize
</I>&gt;<i>
</I>&gt;<i> If myDS.Tables(0).Rows.Count &lt; dotForumDisplay.PageSize Then
</I>&gt;<i> dotForumDisplay.PagerStyle.Visible = False
</I>&gt;<i>
</I>&gt;<i> End Sub
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Sub dotForumDisplay_Paged(sender as Object , e as
</I>&gt;<i> DataGridPageChangedEventArgs)
</I>&gt;<i>
</I>&gt;<i> dotForumDisplay.CurrentPageIndex = e.NewPageIndex
</I>&gt;<i>
</I>&gt;<i> bindData()
</I>&gt;<i>
</I>&gt;<i> End Sub
</I>&gt;<i>
</I>&gt;<i> End Class
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> End Namespace
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> AND  THIS IS THE ERROR MESSAGE
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --------
</I>&gt;<i> MonoBASIC: THIS IS STILL ALPHA AND UNSUPPORTED SOFTWARE, USE AT YOUR
</I>&gt;<i> OWN
</I>&gt;<i> RISK.
</I>&gt;<i> --------
</I>&gt;<i> syntax error, got token `COLON', expecting EOL
</I>&gt;<i> forum.aspx.vb(11,26) error BC29999: Parsing error
</I>&gt;<i> Compilation failed: 1 Error(s), 0 warnings
</I>&gt;<i>
</I>&gt;<i> ------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> IF I CLEAR THE COLON &quot;:&quot;, THE ERROR BECOMES:
</I>&gt;<i>
</I>&gt;<i> --------
</I>&gt;<i> MonoBASIC: THIS IS STILL ALPHA AND UNSUPPORTED SOFTWARE, USE AT YOUR
</I>&gt;<i> OWN
</I>&gt;<i> RISK.
</I>&gt;<i> --------
</I>&gt;<i> syntax error, got token `INHERITS', expecting EOL
</I>&gt;<i> forum.aspx.vb(11,33) error BC29999: Parsing error
</I>&gt;<i> Compilation failed: 1 Error(s), 0 warnings
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000307.html">[mono-vb] If Else, When in VB ASP.NET (cont)
</A></li>
	<LI> Next message: <A HREF="000305.html">[mono-vb] If Else, When in VB ASP.NET (cont)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#304">[ date ]</a>
              <a href="thread.html#304">[ thread ]</a>
              <a href="subject.html#304">[ subject ]</a>
              <a href="author.html#304">[ author ]</a>
         </LI>
       </UL>
</body></html>
