<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] Err Object &amp; Err Numbers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rafaelteixeirabr%40hotmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000150.html">
   <LINK REL="Next"  HREF="000152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] Err Object &amp; Err Numbers
   </H1>
    <B>A Rafael D Teixeira
    </B> 
    <A HREF="mailto:rafaelteixeirabr%40hotmail.com"
       TITLE="[mono-vb] Err Object &amp; Err Numbers">rafaelteixeirabr@hotmail.com
       </A><BR>
    <I>Tue, 29 Jun 2004 15:53:18 -0300</I>
    <P><UL>
        <LI> Previous message: <A HREF="000150.html">[mono-vb] Err Object &amp; Err Numbers
</A></li>
        <LI> Next message: <A HREF="000152.html">AW: [mono-vb] Err Object &amp; Err Numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#151">[ date ]</a>
              <a href="thread.html#151">[ thread ]</a>
              <a href="subject.html#151">[ subject ]</a>
              <a href="author.html#151">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jambunathan,

Well I did not follow it: It isn't resolved.

More: We need to make it into nunit tests for the corresponding parts in 
MS.VB.DLL, and also compiler test sources to guarantee compatible behaviour.

Maybe you are suggesting to open a series of more specific bug cases, to 
match smaller units of work. That is acceptable.

Just to say what we are after...

Refining the test code that Jochen has put there to something like:

&lt;snip&gt;
    Private Sub ThrowIt(ByVal exc As Exception)
        Try
            Throw exc
        Catch ex As Exception
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrDescr= &quot; &amp; 
Err.Description)
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrNo= &quot; &amp; Err.Number)
            WriteLine(&quot;Exception= &quot; &amp; ex.ToString())
            WriteLine(&quot;-------------------------&quot;)
        End Try
    End Sub

    Private Sub ErrorIt(errornum as Integer)
        Try
            Err.Raise(errornum)
        Catch ex As Exception
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrDescr= &quot; &amp; 
Err.Description)
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrNo= &quot; &amp; Err.Number)
            WriteLine(&quot;Exception= &quot; &amp; ex.ToString())
            WriteLine(&quot;-------------------------&quot;)
        End Try
    End Sub

    Private Sub ErrObjTests()
        ThrowIt(New ArgumentOutOfRangeException(&quot;blah&quot;))  ' --&gt; No. 5
        ThrowIt(New OverflowException)    ' --&gt; No. 6 default description
        ThrowIt(New OverflowException(&quot;blah&quot;))  ' --&gt; No. 6
        ThrowIt(New Exception(&quot;WhatIsIt?&quot;))  ' --&gt; No. 5
        ErrorIt(4)
        ErrorIt(5)
        ErrorIt(6)
    End Sub
&lt;/snip&gt;

I got the following results:
&lt;results&gt;
ErrDescr= Specified argument was out of the range of valid values.
Parameter name: blah
ErrNo= 5
Exception= System.ArgumentOutOfRangeException: Specified argument was out of 
the range of valid values.
Parameter name: blah
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in 
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr= Arithmetic operation resulted in an overflow.
ErrNo= 6
Exception= System.OverflowException: Arithmetic operation resulted in an 
overflow.
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in 
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr= blah
ErrNo= 6
Exception= System.OverflowException: blah
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in 
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr= WhatIsIt?
ErrNo= 5
Exception= System.Exception: WhatIsIt?
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in 
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr= Application-defined or object-defined error.
ErrNo= 4
Exception= System.Exception: Application-defined or object-defined error.
   at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, 
Object Description, Object HelpFile, Object HelpContext)
   at WindowsApplication1.Form1.ErrorIt(Int32 errornum) in 
C:\Dev\WindowsApplication1\Form1.vb:line 138
-------------------------
ErrDescr= Procedure call or argument is not valid.
ErrNo= 5
Exception= System.ArgumentException: Procedure call or argument is not 
valid.
   at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, 
Object Description, Object HelpFile, Object HelpContext)
   at WindowsApplication1.Form1.ErrorIt(Int32 errornum) in 
C:\Dev\WindowsApplication1\Form1.vb:line 138
-------------------------
ErrDescr= Overflow.
ErrNo= 6
Exception= System.OverflowException: Overflow.
   at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, 
Object Description, Object HelpFile, Object HelpContext)
   at WindowsApplication1.Form1.ErrorIt(Int32 errornum) in 
C:\Dev\WindowsApplication1\Form1.vb:line 138
-------------------------
&lt;/results&gt;

Well I don't think mbas compiles this right yet. See, VB.NET compiler need 
to add some extra code in catch blocks to make the exception available in 
Err, vbc does this inside ThrowIt catch block

    IL_0009:  dup
    IL_000a:  call       void 
[Microsoft.VisualBasic]Microsoft.VisualBasic.CompilerServices.ProjectData::SetProjectError(class 
[mscorlib]System.Exception)


So even if this same program when compiled with vbc and run in mono using 
our MS.VB.DLL, won't say the right things, because I'm not sure if the 
Microsoft.VisualBasic.CompilerServices.ProjectData::SetProjectError method 
is correctly implemented and interacts with the implemented ErrObject in the 
proper way (I don't have access to a mono environment and/or source where I 
am for the next hours so I can't check it for correctness myself).

So as it stands, please prove me wrong or reopen or decompose the bug case.

Also we aren't even scratching the whole mess as &quot;On Error&quot; processing isn't 
being tackled yet. Think of the ill-conceived but common pattern among VB 
developers &quot;On Error Resume Next / do something / check Err if needed (after 
the fact) / ... similar statements like the last two (n-times)&quot;

Thanks,


Rafael &quot;Monoman&quot; Teixeira
Mono Hacker since 16 Jul 2001 - <A HREF="http://www.go-mono.org/">http://www.go-mono.org/</A>
MonoBrasil Founding Member - Membro Fundador do MonoBrasil 
<A HREF="http://monobrasil.softwarelivre.org">http://monobrasil.softwarelivre.org</A>
English Blog: <A HREF="http://monoblog.blogspot.com/">http://monoblog.blogspot.com/</A>
Brazilian Portuguese Blog: <A HREF="http://monoblog.weblogger.terra.com.br/">http://monoblog.weblogger.terra.com.br/</A>

&gt;<i>From: &quot;Jambunathan Jambunathan&quot; &lt;<A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>&gt;
</I>&gt;<i>To: &lt;<A HREF="mailto:mono-vb@lists.ximian.com">mono-vb@lists.ximian.com</A>&gt;
</I>&gt;<i>Subject: [mono-vb] Err Object &amp; Err Numbers
</I>&gt;<i>Date: Tue, 29 Jun 2004 09:07:41 -0600
</I>&gt;<i>
</I>&gt;<i>Rafael/Jochen
</I>&gt;<i>
</I>&gt;<i>I am marking the following
</I>&gt;<i>bug:<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=52064">http://bugzilla.ximian.com/show_bug.cgi?id=52064</A> as resolved.
</I>&gt;<i>Will appreciate your comments/feedback.
</I>&gt;<i>
</I>&gt;<i>Regards,
</I>&gt;<i>Jambunathan K.
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-vb mailing list
</I>&gt;<i><A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>
_________________________________________________________________
MSN Messenger: instale grátis e converse com seus amigos. 
<A HREF="http://messenger.msn.com.br">http://messenger.msn.com.br</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000150.html">[mono-vb] Err Object &amp; Err Numbers
</A></li>
	<LI> Next message: <A HREF="000152.html">AW: [mono-vb] Err Object &amp; Err Numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#151">[ date ]</a>
              <a href="thread.html#151">[ thread ]</a>
              <a href="subject.html#151">[ subject ]</a>
              <a href="author.html#151">[ author ]</a>
         </LI>
       </UL>
</body></html>
