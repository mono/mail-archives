<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> AW: [mono-vb] Err Object &amp; Err Numbers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jwezel%40compumaster.de">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000151.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>AW: [mono-vb] Err Object &amp; Err Numbers
   </H1>
    <B>Jochen Wezel
    </B> 
    <A HREF="mailto:jwezel%40compumaster.de"
       TITLE="AW: [mono-vb] Err Object &amp; Err Numbers">jwezel@compumaster.de
       </A><BR>
    <I>Wed, 30 Jun 2004 09:12:15 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000151.html">[mono-vb] Err Object &amp; Err Numbers
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#152">[ date ]</a>
              <a href="thread.html#152">[ thread ]</a>
              <a href="subject.html#152">[ subject ]</a>
              <a href="author.html#152">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Let's do that...=20


-----Urspr=FCngliche Nachricht-----
Von: <A HREF="mailto:mono-vb-admin@lists.ximian.com">mono-vb-admin@lists.ximian.com</A> =
[mailto:<A HREF="mailto:mono-vb-admin@lists.ximian.com">mono-vb-admin@lists.ximian.com</A>] Im Auftrag von A Rafael D =
Teixeira
Gesendet: Dienstag, 29. Juni 2004 20:53
An: <A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>
Cc: <A HREF="mailto:mono-vb@lists.ximian.com">mono-vb@lists.ximian.com</A>
Betreff: RE: [mono-vb] Err Object &amp; Err Numbers

Hi Jambunathan,

Well I did not follow it: It isn't resolved.

More: We need to make it into nunit tests for the corresponding parts in =
MS.VB.DLL, and also compiler test sources to guarantee compatible =
behaviour.

Maybe you are suggesting to open a series of more specific bug cases, to =
match smaller units of work. That is acceptable.

Just to say what we are after...

Refining the test code that Jochen has put there to something like:

&lt;snip&gt;
    Private Sub ThrowIt(ByVal exc As Exception)
        Try
            Throw exc
        Catch ex As Exception
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrDescr=3D &quot; &amp;
Err.Description)
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrNo=3D &quot; &amp; Err.Number)
            WriteLine(&quot;Exception=3D &quot; &amp; ex.ToString())
            WriteLine(&quot;-------------------------&quot;)
        End Try
    End Sub

    Private Sub ErrorIt(errornum as Integer)
        Try
            Err.Raise(errornum)
        Catch ex As Exception
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrDescr=3D &quot; &amp;
Err.Description)
            If Err.Number &lt;&gt; 0 Then WriteLine(&quot;ErrNo=3D &quot; &amp; Err.Number)
            WriteLine(&quot;Exception=3D &quot; &amp; ex.ToString())
            WriteLine(&quot;-------------------------&quot;)
        End Try
    End Sub

    Private Sub ErrObjTests()
        ThrowIt(New ArgumentOutOfRangeException(&quot;blah&quot;))  ' --&gt; No. 5
        ThrowIt(New OverflowException)    ' --&gt; No. 6 default =
description
        ThrowIt(New OverflowException(&quot;blah&quot;))  ' --&gt; No. 6
        ThrowIt(New Exception(&quot;WhatIsIt?&quot;))  ' --&gt; No. 5
        ErrorIt(4)
        ErrorIt(5)
        ErrorIt(6)
    End Sub
&lt;/snip&gt;

I got the following results:
&lt;results&gt;
ErrDescr=3D Specified argument was out of the range of valid values.
Parameter name: blah
ErrNo=3D 5
Exception=3D System.ArgumentOutOfRangeException: Specified argument was =
out of the range of valid values.
Parameter name: blah
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in =
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr=3D Arithmetic operation resulted in an overflow.
ErrNo=3D 6
Exception=3D System.OverflowException: Arithmetic operation resulted in =
an overflow.
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in =
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr=3D blah
ErrNo=3D 6
Exception=3D System.OverflowException: blah
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in =
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr=3D WhatIsIt?
ErrNo=3D 5
Exception=3D System.Exception: WhatIsIt?
   at WindowsApplication1.Form1.ThrowIt(Exception exc) in =
C:\Dev\WindowsApplication1\Form1.vb:line 127
-------------------------
ErrDescr=3D Application-defined or object-defined error.
ErrNo=3D 4
Exception=3D System.Exception: Application-defined or object-defined =
error.
   at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, =
Object Description, Object HelpFile, Object HelpContext)
   at WindowsApplication1.Form1.ErrorIt(Int32 errornum) in =
C:\Dev\WindowsApplication1\Form1.vb:line 138
-------------------------
ErrDescr=3D Procedure call or argument is not valid.
ErrNo=3D 5
Exception=3D System.ArgumentException: Procedure call or argument is not =
valid.
   at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, =
Object Description, Object HelpFile, Object HelpContext)
   at WindowsApplication1.Form1.ErrorIt(Int32 errornum) in =
C:\Dev\WindowsApplication1\Form1.vb:line 138
-------------------------
ErrDescr=3D Overflow.
ErrNo=3D 6
Exception=3D System.OverflowException: Overflow.
   at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, =
Object Description, Object HelpFile, Object HelpContext)
   at WindowsApplication1.Form1.ErrorIt(Int32 errornum) in =
C:\Dev\WindowsApplication1\Form1.vb:line 138
-------------------------
&lt;/results&gt;

Well I don't think mbas compiles this right yet. See, VB.NET compiler =
need to add some extra code in catch blocks to make the exception =
available in Err, vbc does this inside ThrowIt catch block

    IL_0009:  dup
    IL_000a:  call       void=20
[Microsoft.VisualBasic]Microsoft.VisualBasic.CompilerServices.ProjectData=
::<i>SetProjectError(class
</I>[mscorlib]System.Exception)


So even if this same program when compiled with vbc and run in mono =
using=20
our MS.VB.DLL, won't say the right things, because I'm not sure if the=20
Microsoft.VisualBasic.CompilerServices.ProjectData::SetProjectError =
method=20
is correctly implemented and interacts with the implemented ErrObject in =
the=20
proper way (I don't have access to a mono environment and/or source =
where I=20
am for the next hours so I can't check it for correctness myself).

So as it stands, please prove me wrong or reopen or decompose the bug =
case.

Also we aren't even scratching the whole mess as &quot;On Error&quot; processing =
isn't=20
being tackled yet. Think of the ill-conceived but common pattern among =
VB=20
developers &quot;On Error Resume Next / do something / check Err if needed =
(after=20
the fact) / ... similar statements like the last two (n-times)&quot;

Thanks,


Rafael &quot;Monoman&quot; Teixeira
Mono Hacker since 16 Jul 2001 - <A HREF="http://www.go-mono.org/">http://www.go-mono.org/</A>
MonoBrasil Founding Member - Membro Fundador do MonoBrasil=20
<A HREF="http://monobrasil.softwarelivre.org">http://monobrasil.softwarelivre.org</A>
English Blog: <A HREF="http://monoblog.blogspot.com/">http://monoblog.blogspot.com/</A>
Brazilian Portuguese Blog: <A HREF="http://monoblog.weblogger.terra.com.br/">http://monoblog.weblogger.terra.com.br/</A>

&gt;<i>From: &quot;Jambunathan Jambunathan&quot; &lt;<A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>&gt;
</I>&gt;<i>To: &lt;<A HREF="mailto:mono-vb@lists.ximian.com">mono-vb@lists.ximian.com</A>&gt;
</I>&gt;<i>Subject: [mono-vb] Err Object &amp; Err Numbers
</I>&gt;<i>Date: Tue, 29 Jun 2004 09:07:41 -0600
</I>&gt;<i>
</I>&gt;<i>Rafael/Jochen
</I>&gt;<i>
</I>&gt;<i>I am marking the following
</I>&gt;<i>bug:<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=3D52064">http://bugzilla.ximian.com/show_bug.cgi?id=3D52064</A> as resolved.
</I>&gt;<i>Will appreciate your comments/feedback.
</I>&gt;<i>
</I>&gt;<i>Regards,
</I>&gt;<i>Jambunathan K.
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-vb mailing list
</I>&gt;<i><A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>
_________________________________________________________________
MSN Messenger: instale grtis e converse com seus amigos.=20
<A HREF="http://messenger.msn.com.br">http://messenger.msn.com.br</A>

_______________________________________________
Mono-vb mailing list
<A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000151.html">[mono-vb] Err Object &amp; Err Numbers
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#152">[ date ]</a>
              <a href="thread.html#152">[ thread ]</a>
              <a href="subject.html#152">[ subject ]</a>
              <a href="author.html#152">[ author ]</a>
         </LI>
       </UL>
</body></html>
