<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] VBNC on zlinux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20VBNC%20on%20zlinux&In-Reply-To=038383EE283F5D4ABEDD7432A3CA78590222FA68%40APSW0629EVS.ms.ds.uhc.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000714.html">
   <LINK REL="Next"  HREF="000717.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] VBNC on zlinux</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20VBNC%20on%20zlinux&In-Reply-To=038383EE283F5D4ABEDD7432A3CA78590222FA68%40APSW0629EVS.ms.ds.uhc.com"
       TITLE="[mono-vb] VBNC on zlinux">rolflists at ya.com
       </A><BR>
    <I>Fri Apr 18 05:59:52 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000714.html">[mono-vb] VBNC on zlinux
</A></li>
        <LI>Next message: <A HREF="000717.html">[mono-vb] VBNC on zlinux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#716">[ date ]</a>
              <a href="thread.html#716">[ thread ]</a>
              <a href="subject.html#716">[ subject ]</a>
              <a href="author.html#716">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have made a minor change in vbnc which might work around this issue.

 

You can download a new rpm here:
<A HREF="http://mono.ximian.com/monobuild/snapshot/snapshot_packages/noarch/mono-basi">http://mono.ximian.com/monobuild/snapshot/snapshot_packages/noarch/mono-basi</A>
c/101099/mono-basic-101099-0.novell.noarch.rpm

 

Or sources:
<A HREF="http://mono.ximian.com/monobuild/snapshot/snapshot_sources/mono-basic/mono-b">http://mono.ximian.com/monobuild/snapshot/snapshot_sources/mono-basic/mono-b</A>
asic-101099.tar.bz2

 

Though given that I don't have access to these systems, I haven't tested the
work-around.

 

Rolf

 

From: Barnett, James K [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">jim_barnett at uhc.com</A>] 
Sent: jueves, 17 de abril de 2008 21:44
To: Rolf Bjarne Kvinge; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">mono-vb at lists.ximian.com</A>
Cc: Timreck, Emily K
Subject: RE: [mono-vb] VBNC on zlinux

 

It looks like it is a match.   Here is the output from the test, and it
matches the bug exactly.

 

mfwl8041:/EMSASP/Emily # gmcs test.cs &amp;&amp; mono test.exe
Sending: something

 

Unhandled Exception: System.NullReferenceException: Object reference not set
to an instance of an object
  at C.Test (System.Object a, System.Object b, System.Object c,
System.Object d, Token Name, System.Object e) [0x00000]
  at C.Test () [0x00000]
  at C.Main () [0x00000]

I'd gladly work with you on this.   If need be,  I could build a 31bit
system to run this, but the direction is supposed to be 64bit.

But, we do what we have to do.

 

Thanks Rolf,   let me know what you think.

 

Jim.

 

  _____  

From: Rolf Bjarne Kvinge [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">rolflists at ya.com</A>] 
Sent: Thursday, April 17, 2008 2:13 PM
To: Barnett, James K; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">mono-vb at lists.ximian.com</A>
Subject: RE: [mono-vb] VBNC on zlinux

Hi James,

 

This looks like a known mono problem, there's already a bug filed for this:
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=324807">https://bugzilla.novell.com/show_bug.cgi?id=324807</A> 

 

Could you try the last sample in that bug report and see if it's the same
issue?

 

Rolf

 

From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">mono-vb-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">mono-vb-bounces at lists.ximian.com</A>] On Behalf Of Barnett, James K
Sent: jueves, 17 de abril de 2008 17:57
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">mono-vb at lists.ximian.com</A>
Subject: [mono-vb] VBNC on zlinux

 

Hello,

 

I am trying to move some asp.net pages from windows to linux on the
mainframe.

 

We are running Sles 9.3 in 64bit mode under z/VM 5.3 on an IBM z/10.

 

I downloaded and compiled mono 1.9 and so far everything seems to work well,
except when I try to

display VB.net files.    I get a VBNC Crash.    I suspected there might be
some problems with

my code,  so I set up the simplest example I could find,  (hello world) and
still get the same error.

 

It displays fine,  if I use straight html or language=&quot;C#&quot;  but if I change
it to language=&quot;VB&quot;  I get the following:

 


Compilation Error


Description: Error compiling a resource required to service this request.
Review your source file and modify it to fix this error. 

Error message: 

(0,0) : error VBNC_CRASH: Visual Basic.Net Compiler version 0.0.0.5851
Copyright (C) 2004-2007 Rolf Bjarne Kvinge. All rights reserved.


Already added type: _Default
/tmp/wwwrun-temp-aspnet-0/432466b2/12288f73.0.vb (12,18) : Warning
VBNC99998: Option Strict Off will probably fail.
Error : VBNC99999: vbnc crashed nearby this location in the source code.
Error : VBNC99999: Unexpected error: Object reference not set to an instance
of an object
at vbnc.ClassDeclaration.Init (vbnc.Attributes CustomAttributes, Modifiers
Modifiers, vbnc.TypeDeclaration DeclaringType, vbnc.MemberDeclarations
Members, Token Name, vbnc.TypeParameters TypeParameters,
vbnc.NonArrayTypeName Inherits, vbnc.TypeImplementsClauses
TypeImplementsClauses) [0x00000] 
at vbnc.Parser.ParseClassDeclaration (vbnc.ParsedObject Parent,
vbnc.Attributes Attributes, System.String Namespace) [0x00000] 
at vbnc.Parser.ParseTypeDeclaration (vbnc.ParsedObject Parent,
vbnc.Attributes Attributes, System.String Namespace) [0x00000] 
at vbnc.Parser.ParseAssemblyMembers (vbnc.AssemblyDeclaration Parent,
System.String RootNamespace, vbnc.MemberDeclarations declarations) [0x00000]

at vbnc.Parser.ParseAssemblyDeclaration (System.String RootNamespace,
vbnc.AssemblyDeclaration assembly) [0x00000] 
at vbnc.Parser.Parse (System.String RootNamespace, vbnc.AssemblyDeclaration
assembly) [0x00000] 
at vbnc.Compiler.Compile_Parse () [0x00000] 
Compilation took 00:00:02.2681430

File name: /EMSASP/Emily/hello1.aspx

Source File: 


Line 1:
'---------------------------------------------------------------------------
---
Line 2: ' &lt;autogenerated&gt;
Line 3: '     This code was generated by a tool.
Line 4: '     Mono Runtime Version: 2.0.50727.42
Line 5: '
Line 6: '     Changes to this file may cause incorrect behavior and will be
lost if 
Line 7: '     the code is regenerated.
Line 8: ' &lt;/autogenerated&gt;
Line 9:
'---------------------------------------------------------------------------
---
Line 10: 
Line 11: Option Explicit On
Line 12: Option Strict Off
Line 13: 
Line 14: Imports System
Line 15: Imports System.Collections
Line 16: Imports System.Collections.Specialized
Line 17: Imports System.Configuration
Line 18: Imports System.Text
Line 19: Imports System.Text.RegularExpressions
Line 20: Imports System.Web
Line 21: Imports System.Web.Caching
Line 22: Imports System.Web.SessionState
Line 23: Imports System.Web.Security
Line 24: Imports System.Web.Profile
Line 25: Imports System.Web.UI
Line 26: Imports System.Web.UI.WebControls
Line 27: Imports System.Web.UI.WebControls.WebParts
Line 28: Imports System.Web.UI.HtmlControls
Line 29: 
Line 30: Namespace ASP
Line 31:     
Line 32:     Public Class hello1_aspx
Line 33:         Inherits System.Web.UI.Page
Line 34:         Implements System.Web.SessionState.IRequiresSessionState
Line 35:         
Line 36:         Private Shared __initialized As Boolean = false
Line 37:         
Line 38:         Private Shared __autoHandlers As Integer
Line 39:         
Line 40:         Public Sub New()
Line 41:             MyBase.New
Line 42:             CType(Me, System.Web.UI.Page).AppRelativeVirtualPath =
&quot;~/test2/hello1.aspx&quot;
Line 43:             If (ASP.hello1_aspx.__initialized = false) Then
Line 44:                 ASP.hello1_aspx.__initialized = true
Line 45:             End If
Line 46:         End Sub
Line 47:         
Line 48:         &lt;System.Obsolete()&gt;  _
Line 49:         Protected Overrides Property AutoHandlers() As Integer
Line 50:             Get
Line 51:                 Return ASP.hello1_aspx.__autoHandlers
Line 52:             End Get
Line 53:             Set
Line 54:                 ASP.hello1_aspx.__autoHandlers = Value
Line 55:             End Set
Line 56:         End Property
Line 57:         
Line 58:         Protected ReadOnly Property ApplicationInstance() As
System.Web.HttpApplication
Line 59:             Get
Line 60:                 Return CType(Me.Context.ApplicationInstance,
System.Web.HttpApplication)
Line 61:             End Get
Line 62:         End Property
Line 63:         
Line 64:         Protected ReadOnly Property Profile() As
System.Web.Profile.DefaultProfile
Line 65:             Get
Line 66:                 Return CType(Me.Context.Profile,
System.Web.Profile.DefaultProfile)
Line 67:             End Get
Line 68:         End Property
Line 69:         
Line 70:         Private Sub __RenderTree(ByVal __output As
System.Web.UI.HtmlTextWriter, ByVal parameterContainer As
System.Web.UI.Control)
Line 71:
__output.Write(&quot;&lt;html&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;&quot;&lt;head&gt;&quot;&amp;Microsoft.Vi
sualBasic.ChrW(10)&amp;&quot;&lt;title&gt;ASP.NET Hello
World&lt;/title&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;&quot;&lt;/head&gt;&quot;&amp;Microsoft.VisualBasi
c.ChrW(10)&amp;&quot;&lt;body
bgcolor=&quot;&quot;#FFFFFF&quot;&quot;&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.C
hrW(10)&amp;&quot;&lt;p&gt;&quot;)
Line 72:             __output.Write( &quot;Hello World!&quot; )
Line 73:
__output.Write(&quot;&lt;/p&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;Microsoft.VisualBasic.C
hrW(10)&amp;&quot;&lt;/body&gt;&quot;&amp;Microsoft.VisualBasic.ChrW(10)&amp;&quot;&lt;/html&gt;&quot;&amp;Microsoft.VisualB
asic.ChrW(10))
Line 74:         End Sub
Line 75:         
Line 76:         Private Sub __BuildControlTree(ByVal __ctrl As hello1_aspx)
Line 77:             Me.InitializeCulture()
Line 78:             __ctrl.SetRenderMethodDelegate(AddressOf
Me.__RenderTree)
Line 79:         End Sub
Line 80:         
Line 81:         Protected Overrides Sub FrameworkInitialize()
Line 82:             MyBase.FrameworkInitialize()
Line 83:             Me.TraceModeValue = System.Web.TraceMode.SortByTime
Line 84:             Me.Request.ValidateInput()
Line 85:             Me.__BuildControlTree(Me)
Line 86:         End Sub
Line 87:         
Line 88:         Public Overrides Function GetTypeHashCode() As Integer
Line 89:             Return 2117760274
Line 90:         End Function
Line 91:     End Class
Line 92: End Namespace

 

Jim Barnett

United Health Technologies

Mainframe Systems

763-744-3066

email: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">jim_barnett at uhc.com</A>

 



This e-mail, including attachments, may include confidential and/or 
proprietary information, and may be used only by the person or entity to 
which it is addressed. If the reader of this e-mail is not the intended 
recipient or his or her authorized agent, the reader is hereby notified 
that any dissemination, distribution or copying of this e-mail is 
prohibited. If you have received this e-mail in error, please notify the 
sender by replying to this message and delete this e-mail immediately.



This e-mail, including attachments, may include confidential and/or 
proprietary information, and may be used only by the person or entity to 
which it is addressed. If the reader of this e-mail is not the intended 
recipient or his or her authorized agent, the reader is hereby notified 
that any dissemination, distribution or copying of this e-mail is 
prohibited. If you have received this e-mail in error, please notify the 
sender by replying to this message and delete this e-mail immediately.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-vb/attachments/20080418/7f59ae6b/attachment-0001.html">http://lists.ximian.com/pipermail/mono-vb/attachments/20080418/7f59ae6b/attachment-0001.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000714.html">[mono-vb] VBNC on zlinux
</A></li>
	<LI>Next message: <A HREF="000717.html">[mono-vb] VBNC on zlinux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#716">[ date ]</a>
              <a href="thread.html#716">[ thread ]</a>
              <a href="subject.html#716">[ subject ]</a>
              <a href="author.html#716">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
