<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] FileSystem.FileOpen
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20FileSystem.FileOpen&In-Reply-To=23597752.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000967.html">
   <LINK REL="Next"  HREF="000972.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] FileSystem.FileOpen</H1>
    <B>Klaus Siebke</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20FileSystem.FileOpen&In-Reply-To=23597752.post%40talk.nabble.com"
       TITLE="[mono-vb] FileSystem.FileOpen">ksiebke at web.de
       </A><BR>
    <I>Tue May 19 06:30:26 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000967.html">[mono-vb] FileSystem.FileOpen
</A></li>
        <LI>Next message: <A HREF="000972.html">[mono-vb] FileSystem.FileOpen
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#971">[ date ]</a>
              <a href="thread.html#971">[ thread ]</a>
              <a href="subject.html#971">[ subject ]</a>
              <a href="author.html#971">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

of course, there is a workaround: use the state of the art
FileStream/StreamReader syntax instead of FileSystem.FileOpen:

Private Sub mnuFileOpentT_Click(ByVal sender As System.Object, ByVal e As
System.EventArgs) Handles mnuFileOpentT.Click 
    Dim FileName As String 
    Dim FileNr, fLen As Integer 
    cdlg1.CheckFileExists = True 
    If cdlg1.ShowDialog = Windows.Forms.DialogResult.OK Then 
      Try 
        FileName = cdlg1.FileName 
' (del) FileNr = FileSystem.FreeFile 
        fLen = CInt(FileSystem.FileLen(FileName)) 
        
' (del) FileSystem.FileOpen(FileNr, FileName, OpenMode.Input,
OpenAccess.Read, OpenShare.Shared) 
' (new):
        Dim fs As New FileStream(FileName, _
                      FileMode.Open, _
                      FileAccess.Read, _
                      FileShare.ReadWrite)
        Dim sr As New StreamReader(fs)
        Dim myChar(256) as char

' (del) txtImport.Text = FileSystem.InputString(FileNr, fLen) 
' (new):
        sr.read(myChar, 0, flen)
        txtImport.Text = Cstr(myChar)
        sr.close
        fs.close
         
      Catch ex As Exception 
#If Linux Then 
        LinuxErr(ex, &quot;_frmImportText.mnuFileOpenT_Click&quot;) 
#Else 
        Throw New ApplicationException(&quot;_frmImportText.mnuFileOpenT_Click
Error&quot;, ex) 
#End If 
      Finally 
        Try 
' (del)   FileSystem.FileClose(FileNr) 
        Catch 
        End Try 
      End Try 
      'FileNr = modFileFunc.Fileopener(FileName, modFileFunc.READFILE,
False) 
      'txtImport.Text = InputString(FileNr, CInt(FileLen(FileName))) 
      'FileClose(FileNr) 
    End If 

  End Sub


I use FileStream/StreamReader in my Mono VB applications and they run
smoothly.

//Klaus


Andy Hume wrote:
&gt;<i> 
</I>&gt;<i> The cause of this is reported as bug 504791  &quot;NRE in FileSystem.FileOpen
</I>&gt;<i> due to compiler problem&quot;
</I>&gt;<i> (<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=504791">https://bugzilla.novell.com/show_bug.cgi?id=504791</A>)
</I>&gt;<i> 
</I>&gt;<i> A bug in the Mono VB compiler generates bad code in the Mono VB-Runtime
</I>&gt;<i> library which causes the NullRefEx.  So it's not something that's in your
</I>&gt;<i> program's code and I can't immediately see a simple workaround -- well
</I>&gt;<i> apart from changing to .NET's native System.IO classes.  Maybe Rolf can
</I>&gt;<i> suggest another workaround...
</I>&gt;<i> 
</I>&gt;<i> Andy
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-- 
View this message in context: <A HREF="http://www.nabble.com/FileSystem.FileOpen-tp23565338p23613502.html">http://www.nabble.com/FileSystem.FileOpen-tp23565338p23613502.html</A>
Sent from the Mono - VB mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000967.html">[mono-vb] FileSystem.FileOpen
</A></li>
	<LI>Next message: <A HREF="000972.html">[mono-vb] FileSystem.FileOpen
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#971">[ date ]</a>
              <a href="thread.html#971">[ thread ]</a>
              <a href="subject.html#971">[ subject ]</a>
              <a href="author.html#971">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
