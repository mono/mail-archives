<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] MS.VB.Compilerservices
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Rob.Tillie%40Student.tUL.EDU">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000188.html">
   <LINK REL="Next"  HREF="000190.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] MS.VB.Compilerservices
   </H1>
    <B>Rob.Tillie@Student.tUL.EDU
    </B> 
    <A HREF="mailto:Rob.Tillie%40Student.tUL.EDU"
       TITLE="[mono-vb] MS.VB.Compilerservices">Rob.Tillie@Student.tUL.EDU
       </A><BR>
    <I>Tue, 20 Jul 2004 21:18:47 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000188.html">[mono-vb] Tests
</A></li>
        <LI> Next message: <A HREF="000190.html">[mono-vb] Tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#189">[ date ]</a>
              <a href="thread.html#189">[ thread ]</a>
              <a href="subject.html#189">[ subject ]</a>
              <a href="author.html#189">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This message is in MIME format. Since your mail reader does not understand
this format, some or all of this message may not be legible.

------_=_NextPart_000_01C46E8E.617B52E0
Content-Type: text/plain

Hey Jambunathan,

I solved the bug but I cannot reach bugzilla at the moment, could you plz
close it?

The problem was that 'createZeroForCompare' returned an integer for type
Boolean. But Boolean.CompareTo(integer) is not allowed (I tested this on
MS.NET). Now 'createZeroForCompare' returns a default Boolean (false).

Greetz,
-- Rob.

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="mailto:Rob.Tillie@Student.tUL.EDU">Rob.Tillie@Student.tUL.EDU</A> [mailto:<A HREF="mailto:Rob.Tillie@Student.tUL.EDU">Rob.Tillie@Student.tUL.EDU</A>]
</I>&gt;<i> Sent: Tuesday, July 20, 2004 8:14 PM
</I>&gt;<i> To: <A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>; <A HREF="mailto:mono-vb@lists.ximian.com">mono-vb@lists.ximian.com</A>
</I>&gt;<i> Subject: RE: [mono-vb] MS.VB.Compilerservices
</I>&gt;<i> 
</I>&gt;<i> I'll take it...
</I>&gt;<i> 
</I>&gt;<i> Greetz,
</I>&gt;<i> -- Rob.
</I>&gt;<i> 
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: Jambunathan Jambunathan [mailto:<A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>]
</I>&gt;<i> &gt; Sent: Tuesday, July 20, 2004 8:09 AM
</I>&gt;<i> &gt; To: <A HREF="mailto:mono-vb@lists.ximian.com">mono-vb@lists.ximian.com</A>
</I>&gt;<i> &gt; Subject: Re: [mono-vb] MS.VB.Compilerservices
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On second thoughts ...
</I>&gt;<i> &gt; ObjTst typically gets generated for the If statements by MS's vbc.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Here is a simple test case that reproduces the bug. Compile this
</I>&gt;<i> &gt; source
</I>&gt;<i> &gt; aginst vbc and execute the MS's exe against mono.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Imports System
</I>&gt;<i> &gt; Module M
</I>&gt;<i> &gt; 	Sub Main
</I>&gt;<i> &gt; 		Dim B as Boolean = true
</I>&gt;<i> &gt; 		Dim O1 as Object = B
</I>&gt;<i> &gt; 		Dim O2 as Object = Nothing
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 		If O1 = O2 Then
</I>&gt;<i> &gt; 			Console.WriteLine(&quot;Equal&quot;)
</I>&gt;<i> &gt; 		Else
</I>&gt;<i> &gt; 			Console.WriteLine(&quot;Not Equal&quot;)
</I>&gt;<i> &gt; 		End If
</I>&gt;<i> &gt; 	End Sub
</I>&gt;<i> &gt; End Module
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have opened a bug in bugzilla
</I>&gt;<i> &gt; <A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=61749.">http://bugzilla.ximian.com/show_bug.cgi?id=61749.</A>
</I>&gt;<i> &gt; Btw, any takers for fixing this bug ? Joao, Rob  ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Could you please confirm that this is the scenario with you as well ?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt; Jambunathan K.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;&gt;&gt; &quot;Jambunathan Jambunathan&quot; &lt;<A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>&gt; 7/20/2004
</I>&gt;<i> &gt; 11:02:07 AM &gt;&gt;&gt;
</I>&gt;<i> &gt; &gt; Unfortunality, I cannot resolve where the problem starts in my code
</I>&gt;<i> &gt; &gt; since there is not direct call the ObjectType :(
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Howabout doing a &quot;mono --debug whatever.exe&quot;. That way you should be
</I>&gt;<i> &gt; able to catch the line numbers.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt; Jambunathan K.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;&gt;&gt; &quot;Jochen Wezel&quot; &lt;<A HREF="mailto:jwezel@compumaster.de">jwezel@compumaster.de</A>&gt; 7/20/2004 12:53:15 AM &gt;&gt;&gt;
</I>&gt;<i> &gt; Hi Jambunathan!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Here is a small bug I can report today:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Stack Trace: System.ArgumentException: Object is not a Boolean.
</I>&gt;<i> &gt; in &lt;0x0007c&gt; System.Boolean:CompareTo (object)
</I>&gt;<i> &gt; in &lt;0x001b6&gt; Microsoft.VisualBasic.CompilerServices.ObjectType:ObjTst
</I>&gt;<i> &gt; (object,object,bool)
</I>&gt;<i> &gt; in &lt;0x000e4&gt;
</I>&gt;<i> &gt; CompuMaster.camm.WebManager.WMSystem:InitializeEnvironment
</I>&gt;<i> &gt; ()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Unfortunality, I cannot resolve where the problem starts in my code
</I>&gt;<i> &gt; since there is not direct call the ObjectType :(
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards
</I>&gt;<i> &gt; Jochen
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Here the complete error:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Server error in '/' application
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------------------------------------------------------------------------
</I>&gt;<i> &gt; --------
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Description: Error processing request.
</I>&gt;<i> &gt; Error Message: HTTP 500.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Stack Trace: System.ArgumentException: Object is not a Boolean.
</I>&gt;<i> &gt; in &lt;0x0007c&gt; System.Boolean:CompareTo (object)
</I>&gt;<i> &gt; in &lt;0x001b6&gt; Microsoft.VisualBasic.CompilerServices.ObjectType:ObjTst
</I>&gt;<i> &gt; (object,object,bool)
</I>&gt;<i> &gt; in &lt;0x000e4&gt;
</I>&gt;<i> &gt; CompuMaster.camm.WebManager.WMSystem:InitializeEnvironment
</I>&gt;<i> &gt; ()
</I>&gt;<i> &gt; in &lt;0x0001a&gt;
</I>&gt;<i> &gt; CompuMaster.camm.WebManager.WMSystem:set_CurrentServerIdentString
</I>&gt;<i> &gt; (string)
</I>&gt;<i> &gt; in &lt;0x000d7&gt; ASP.cammWebManager_ascx:SetupAdditionalConfiguration ()
</I>&gt;<i> &gt; in &lt;0x0000e&gt; ASP.cammWebManager_ascx:LoadConfiguration ()
</I>&gt;<i> &gt; in &lt;0x00026&gt;
</I>&gt;<i> &gt; CompuMaster.camm.WebManager.Controls.cammWebManager:System_Init ()
</I>&gt;<i> &gt; in &lt;0x0000e&gt;
</I>&gt;<i> &gt; CompuMaster.camm.WebManager.Controls.cammWebManager:OnWebManagerInit
</I>&gt;<i> &gt; (object,System.EventArgs)
</I>&gt;<i> &gt; in &lt;0x00069&gt; (wrapper delegate-invoke)
</I>&gt;<i> &gt; System.MulticastDelegate:invoke_void_object_EventArgs
</I>&gt;<i> &gt; (object,System.EventArgs)
</I>&gt;<i> &gt; in &lt;0x00086&gt; System.Web.UI.Control:OnInit (System.EventArgs)
</I>&gt;<i> &gt; in &lt;0x0003a&gt; System.Web.UI.UserControl:OnInit (System.EventArgs)
</I>&gt;<i> &gt; in &lt;0x00273&gt; System.Web.UI.Control:InitRecursive
</I>&gt;<i> &gt; (System.Web.UI.Control)
</I>&gt;<i> &gt; in &lt;0x00185&gt; System.Web.UI.Control:InitRecursive
</I>&gt;<i> &gt; (System.Web.UI.Control)
</I>&gt;<i> &gt; in &lt;0x00060&gt; System.Web.UI.Page:InternalProcessRequest ()
</I>&gt;<i> &gt; in &lt;0x000c2&gt; System.Web.UI.Page:ProcessRequest
</I>&gt;<i> &gt; (System.Web.HttpContext)
</I>&gt;<i> &gt; in &lt;0x00359&gt; System.Web.HttpServerUtility:Execute
</I>&gt;<i> &gt; (string,System.IO.TextWriter,bool)
</I>&gt;<i> &gt; in &lt;0x000bb&gt; System.Web.HttpServerUtility:Transfer (string,bool)
</I>&gt;<i> &gt; in &lt;0x00016&gt; System.Web.HttpServerUtility:Transfer (string)
</I>&gt;<i> &gt; in &lt;0x00028&gt; ASP.index_aspx:__RenderTree
</I>&gt;<i> &gt; (System.Web.UI.HtmlTextWriter,System.Web.UI.Control)
</I>&gt;<i> &gt; in &lt;0x00069&gt; (wrapper delegate-invoke)
</I>&gt;<i> &gt; System.MulticastDelegate:invoke_void_HtmlTextWriter_Control
</I>&gt;<i> &gt; (System.Web.UI.HtmlTextWriter,System.Web.UI.Control)
</I>&gt;<i> &gt; in &lt;0x00048&gt; System.Web.UI.Control:RenderChildren
</I>&gt;<i> &gt; (System.Web.UI.HtmlTextWriter)
</I>&gt;<i> &gt; in &lt;0x00011&gt; System.Web.UI.Control:Render
</I>&gt;<i> &gt; (System.Web.UI.HtmlTextWriter)
</I>&gt;<i> &gt; in &lt;0x0001c&gt; System.Web.UI.Control:RenderControl
</I>&gt;<i> &gt; (System.Web.UI.HtmlTextWriter)
</I>&gt;<i> &gt; in &lt;0x00429&gt; System.Web.UI.Page:InternalProcessRequest ()
</I>&gt;<i> &gt; in &lt;0x000c2&gt; System.Web.UI.Page:ProcessRequest
</I>&gt;<i> &gt; (System.Web.HttpContext)
</I>&gt;<i> &gt; in &lt;0x002f3&gt; ExecuteHandlerState:Execute ()
</I>&gt;<i> &gt; in &lt;0x00084&gt; StateMachine:ExecuteState
</I>&gt;<i> &gt; (System.Web.HttpApplication/IStateHandler,bool&amp;)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-vb mailing list
</I>&gt;<i> &gt; <A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-vb mailing list
</I>&gt;<i> &gt; <A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-vb mailing list
</I>&gt;<i> &gt; <A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-vb mailing list
</I>&gt;<i> <A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb">http://lists.ximian.com/mailman/listinfo/mono-vb</A>
</I>

------_=_NextPart_000_01C46E8E.617B52E0
Content-Type: application/octet-stream;
	name=&quot;MSVB_61749.patch&quot;
Content-Disposition: attachment;
	filename=&quot;MSVB_61749.patch&quot;

Index: class/Microsoft.VisualBasic/Microsoft.VisualBasic/Microsoft.VisualBasic.CompilerServices/ObjectType.cs
===================================================================
RCS file: /mono/mcs/class/Microsoft.VisualBasic/Microsoft.VisualBasic/Microsoft.VisualBasic.CompilerServices/ObjectType.cs,v
retrieving revision 1.8
diff -u -r1.8 ObjectType.cs
--- class/Microsoft.VisualBasic/Microsoft.VisualBasic/Microsoft.VisualBasic.CompilerServices/ObjectType.cs	24 Jun 2004 14:06:50 -0000	1.8
+++ class/Microsoft.VisualBasic/Microsoft.VisualBasic/Microsoft.VisualBasic.CompilerServices/ObjectType.cs	20 Jul 2004 19:13:29 -0000
@@ -1686,7 +1688,7 @@
 		private static object createZeroForCompare(TypeCode tc) {
 			switch(tc) {
 				case TypeCode.Boolean:
-					return (int)0;
+					return false;
 				case TypeCode.Char:
 					return (char)0;
 				case TypeCode.Byte:

------_=_NextPart_000_01C46E8E.617B52E0--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000188.html">[mono-vb] Tests
</A></li>
	<LI> Next message: <A HREF="000190.html">[mono-vb] Tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#189">[ date ]</a>
              <a href="thread.html#189">[ thread ]</a>
              <a href="subject.html#189">[ subject ]</a>
              <a href="author.html#189">[ author ]</a>
         </LI>
       </UL>
</body></html>
