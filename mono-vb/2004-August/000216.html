<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> AW: [mono-vb] Re: [Mono-patches] mcs/mbas
 ChangeLog,1.148,1.149 mb-parser.jay,1.105,1.106
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:kjambunathan%40novell.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000215.html">
   <LINK REL="Next"  HREF="000218.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>AW: [mono-vb] Re: [Mono-patches] mcs/mbas
 ChangeLog,1.148,1.149 mb-parser.jay,1.105,1.106
   </H1>
    <B>Jambunathan Jambunathan
    </B> 
    <A HREF="mailto:kjambunathan%40novell.com"
       TITLE="AW: [mono-vb] Re: [Mono-patches] mcs/mbas
 ChangeLog,1.148,1.149 mb-parser.jay,1.105,1.106">kjambunathan@novell.com
       </A><BR>
    <I>Mon, 02 Aug 2004 06:36:14 -0600</I>
    <P><UL>
        <LI> Previous message: <A HREF="000215.html">AW: [mono-vb] Re: [Mono-patches] mcs/mbas ChangeLog,1.148,1.149 mb-parser.jay,1.105,1.106
</A></li>
        <LI> Next message: <A HREF="000218.html">[mono-vb] Patch for mbas for ByRef parameters from a DLL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#216">[ date ]</a>
              <a href="thread.html#216">[ thread ]</a>
              <a href="subject.html#216">[ subject ]</a>
              <a href="author.html#216">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jochen

&gt;<i> I just see, vbc.exe compiles both line with and without &quot;Then&quot;...
</I>
Not surprising. That's what the VB.NET spec says. Btw, mbas=20
compiles it fine as well ;-)

Regards,
Jambunathan K.

&gt;&gt;&gt;<i> &quot;Jochen Wezel&quot; &lt;<A HREF="mailto:jwezel@compumaster.de">jwezel@compumaster.de</A>&gt; 8/2/2004 6:00:02 PM &gt;&gt;&gt;
</I>Hi you both!

Wouldn't you write &quot;#If True Then&quot; (notice the additional word &quot;Then&quot;)?

I just see, vbc.exe compiles both line with and without &quot;Then&quot;...
VS.NET automatically adds the word &quot;Then&quot; if it's missing.

CU
Jochen

-----Urspr=FCngliche Nachricht-----
Von: <A HREF="mailto:mono-vb-admin@lists.ximian.com">mono-vb-admin@lists.ximian.com</A> [mailto:<A HREF="mailto:mono-vb-admin@lists.ximian.com">mono-vb-admin@lists.ximian.com</A>]=
 Im Auftrag von Jambunathan Jambunathan
Gesendet: Montag, 2. August 2004 14:18
An: <A HREF="mailto:rafael@mono-cvs.ximian.com">rafael@mono-cvs.ximian.com</A>=20
Cc: <A HREF="mailto:mono-vb@lists.ximian.com">mono-vb@lists.ximian.com</A>=20
Betreff: [mono-vb] Re: [Mono-patches] mcs/mbas ChangeLog,1.148,1.149 =
mb-parser.jay,1.105,1.106

Rafael

Thanks for submitting this patch. Just a small comment:

Subsequent to my pre-processor changes, EOL should no more be used. =
Instead logical_end_of_line should be used. Adhering to this would ensure =
that that the pre-processor statements can follow any EOL.

For example,

With rules as defined currently, the following sample fails to compile.

Imports System

Module Test
    Sub Main()
        100:
        #If True
              Console.WriteLine(&quot;Hello World&quot;)
       #End If
    End Sub
End Module

Regards,
Jambunathan K.

&gt;&gt;&gt;<i> Rafael Teixeira &lt;<A HREF="mailto:rafael@mono-cvs.ximian.com">rafael@mono-cvs.ximian.com</A>&gt; 8/1/2004 6:54:14 PM &gt;&gt;&gt;
</I>Update of /cvs/public/mcs/mbas
In directory mono-cvs.ximian.com:/tmp/cvs-serv12894

Modified Files:
	ChangeLog mb-parser.jay
Log Message:
2004/08/01  Rafael Teixeira &lt;<A HREF="mailto:rafaelteixeirabr@hotmail.com">rafaelteixeirabr@hotmail.com</A>&gt;
	* mb-parser.jay : Revised patch from Jo=C3=A3o Viegas for the =
labeled_statement accepting integer literals as labels


Index: ChangeLog
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
RCS file: /cvs/public/mcs/mbas/ChangeLog,v
retrieving revision 1.148
retrieving revision 1.149
diff -u -d -r1.148 -r1.149
--- ChangeLog	30 Jul 2004 14:43:41 -0000	1.148
+++ ChangeLog	1 Aug 2004 13:24:11 -0000	1.149
@@ -1,3 +1,6 @@
+2004/08/01  Rafael Teixeira &lt;<A HREF="mailto:rafaelteixeirabr@hotmail.com">rafaelteixeirabr@hotmail.com</A>&gt;
+	* mb-parser.jay : Revised patch from Jo=C3=A3o Viegas for the =
labeled_statement accepting integer literals as labels
+
 2004-07-30  Jambunathan K  &lt;<A HREF="mailto:kjambunathan@novell.com">kjambunathan@novell.com</A>&gt;
 	* mb-parser.jay: Oops. Reversed unintended checkin.
 	* mb-tokenizer.cs: Added comment in Tokenizer()=20

Index: mb-parser.jay
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
RCS file: /cvs/public/mcs/mbas/mb-parser.jay,v
retrieving revision 1.105
retrieving revision 1.106
diff -u -d -r1.105 -r1.106
--- mb-parser.jay	30 Jul 2004 14:43:41 -0000	1.105
+++ mb-parser.jay	1 Aug 2004 13:24:11 -0000	1.106
@@ -2302,9 +2302,21 @@
 		$$ =3D $2;
 	  }
 	;
+label_name
+	: identifier
+	| LITERAL_INTEGER
+	{
+		$$ =3D $1.ToString();
+	}
+	;
+
+opt_linebreak
+	: /* empty */
+	| EOL
+	;
=20
 labeled_statement
-	: identifier COLON end_of_stmt=20
+	: label_name COLON opt_linebreak=20
 	  {
 		LabeledStatement labeled =3D new LabeledStatement =
((string) $1, lexer.Location);
=20
@@ -2443,7 +2455,7 @@
 	;
 	       =20
 goto_statement
-	: GOTO identifier =20
+	: GOTO label_name =20
 	  {
 		$$ =3D new Goto (current_block, (string) $2, lexer.Location=
);
 	  }

_______________________________________________
Mono-patches maillist  -  <A HREF="mailto:Mono-patches@ximian.com">Mono-patches@ximian.com</A>=20
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-patches">http://lists.ximian.com/mailman/listinfo/mono-patches</A>

_______________________________________________
Mono-vb mailing list
<A HREF="mailto:Mono-vb@lists.ximian.com">Mono-vb@lists.ximian.com</A>=20
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-vb=20">http://lists.ximian.com/mailman/listinfo/mono-vb=20</A>




</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000215.html">AW: [mono-vb] Re: [Mono-patches] mcs/mbas ChangeLog,1.148,1.149 mb-parser.jay,1.105,1.106
</A></li>
	<LI> Next message: <A HREF="000218.html">[mono-vb] Patch for mbas for ByRef parameters from a DLL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#216">[ date ]</a>
              <a href="thread.html#216">[ thread ]</a>
              <a href="subject.html#216">[ subject ]</a>
              <a href="author.html#216">[ author ]</a>
         </LI>
       </UL>
</body></html>
