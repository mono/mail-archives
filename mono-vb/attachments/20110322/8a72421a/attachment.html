<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#ffffff&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;make&nbsp;a&nbsp;long&nbsp;mail&nbsp;short,&nbsp;that's&nbsp;incorrect.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;When&nbsp;you&nbsp;look&nbsp;at&nbsp;xvkbd-3.0,&nbsp;focus&nbsp;a&nbsp;window&nbsp;and&nbsp;simulate&nbsp;alt+f4,&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;closes,&nbsp;and&nbsp;with&nbsp;simulated&nbsp;alt&nbsp;+&nbsp;tab,&nbsp;it&nbsp;switches&nbsp;windows.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Looking&nbsp;at&nbsp;its&nbsp;sources,&nbsp;it's&nbsp;not&nbsp;working&nbsp;with&nbsp;XSendEvent&nbsp;there<br>
&nbsp;&nbsp;&nbsp;&nbsp;however,&nbsp;it&nbsp;uses&nbsp;some&nbsp;magic&nbsp;in&nbsp;libxtst,&nbsp;which&nbsp;however,&nbsp;just&nbsp;all<br>
&nbsp;&nbsp;&nbsp;&nbsp;comes&nbsp;back&nbsp;to&nbsp;some&nbsp;wrapping&nbsp;around&nbsp;base&nbsp;X11&nbsp;calls.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;didn't&nbsp;look&nbsp;any&nbsp;closer&nbsp;at&nbsp;it,&nbsp;as&nbsp;I&nbsp;don't&nbsp;deem&nbsp;ALT+TAB&nbsp;and&nbsp;ALT+F4<br>
&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;important&nbsp;in&nbsp;respect&nbsp;to&nbsp;SendKeys.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Sending&nbsp;key&nbsp;combinations&nbsp;+&nbsp;key&nbsp;modifiers&nbsp;(ALT/CTRL)&nbsp;to&nbsp;other<br>
&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;however,&nbsp;is.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thus&nbsp;I&nbsp;attached&nbsp;fixme.c,&nbsp;a&nbsp;basic&nbsp;key&nbsp;dispatch&nbsp;implementation&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;Linux/X11&nbsp;in&nbsp;C&nbsp;using&nbsp;XSendEvent.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;It's&nbsp;probably&nbsp;still&nbsp;a&nbsp;bit&nbsp;buggy,&nbsp;especially&nbsp;in&nbsp;respect&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;UNICODE&quot;/KeyboardInternationalization&nbsp;(not&nbsp;really&nbsp;important&nbsp;in&nbsp;this<br>
&nbsp;&nbsp;&nbsp;&nbsp;respect&nbsp;IMHO).&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I'll&nbsp;probably&nbsp;port&nbsp;it&nbsp;to&nbsp;CS&nbsp;next&nbsp;weekend.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;it&nbsp;also&nbsp;contains&nbsp;an&nbsp;AppActivate&nbsp;implementation&nbsp;for&nbsp;Linux&nbsp;!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(It&nbsp;doesn't&nbsp;yet&nbsp;switch&nbsp;to&nbsp;the&nbsp;appropriate&nbsp;workspace,&nbsp;but&nbsp;fixing&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;rather&nbsp;simple,&nbsp;but&nbsp;unfortunately&nbsp;time-consuming,&nbsp;and&nbsp;as&nbsp;I&nbsp;don't<br>
&nbsp;&nbsp;&nbsp;&nbsp;need&nbsp;it,&nbsp;I&nbsp;have&nbsp;just&nbsp;commented&nbsp;that&nbsp;part&nbsp;out&nbsp;for&nbsp;now)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;AppActivate&nbsp;for&nbsp;Windows&nbsp;is&nbsp;simple,&nbsp;just&nbsp;pinvoke&nbsp;SetActiveWindow.&lt;span<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;color:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman';&nbsp;font-style:&nbsp;normal;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:&nbsp;medium;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;style=&quot;font-family:&nbsp;'Segoe&nbsp;UI',Verdana,Arial;&nbsp;font-size:&nbsp;13px;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;&quot;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;don't&nbsp;have&nbsp;a&nbsp;Mac,&nbsp;but&nbsp;the&nbsp;simplest&nbsp;way&nbsp;to&nbsp;activate&nbsp;a&nbsp;window&nbsp;there<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;found&nbsp;to&nbsp;be&nbsp;so&nbsp;easy&nbsp;I&nbsp;can&nbsp;implement&nbsp;it&nbsp;blindly:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;[System.Runtime.InteropServices.DllImport(&quot;libc&quot;,&nbsp;EntryPoint&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;system&quot;)]<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;internal&nbsp;extern&nbsp;static&nbsp;int&nbsp;system(string&nbsp;strCommand);&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;in&nbsp;the&nbsp;below&nbsp;C&nbsp;snippet,&nbsp;one&nbsp;would&nbsp;still&nbsp;need&nbsp;to&nbsp;check&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;malicious&nbsp;\n\r&nbsp;or&nbsp;semicolons&nbsp;when&nbsp;the&nbsp;application&nbsp;title&nbsp;is&nbsp;being<br>
&nbsp;&nbsp;&nbsp;&nbsp;supplied&nbsp;as&nbsp;parameter.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;#include&nbsp;&amp;lt;stdio.h&amp;gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;#include&nbsp;&amp;lt;stdlib.h&amp;gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;main(int&nbsp;argc,&nbsp;char*&nbsp;argv[])&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://stackoverflow.com/questions/3313332/bringing-another-apps-window-to-front-on-mac-in-c&quot;&gt;http://stackoverflow.com/questions/3313332/bringing-another-apps-window-to-front-on-mac-in-c&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;system(&quot;osascript&nbsp;-e&nbsp;\&quot;tell&nbsp;application&nbsp;\\\&quot;Address&nbsp;Book\\\&quot;&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;activate\&quot;&quot;);&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;EXIT_SUCCESS;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;03/17/2011&nbsp;03:19&nbsp;AM,&nbsp;Jonathan&nbsp;Pryor&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:3B7711D7-C723-464F-B123-985D40051B1A@vt.edu&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;Now,&nbsp;what&nbsp;does&nbsp;X11&nbsp;provide?&nbsp;A&nbsp;cursory&nbsp;glance&nbsp;shows<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSendEvent:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:3B7711D7-C723-464F-B123-985D40051B1A@vt.edu&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://tronche.com/gui/x/xlib/event-handling/XSendEvent.html&quot;&gt;http://tronche.com/gui/x/xlib/event-handling/XSendEvent.html&lt;/a&gt;<br>
<br>
This&nbsp;allows&nbsp;passing&nbsp;an&nbsp;XEvent,&nbsp;such&nbsp;as&nbsp;an&nbsp;XKeyEvent,&nbsp;to&nbsp;a&nbsp;given&nbsp;window.<br>
<br>
Problem:&nbsp;In&nbsp;Windows,&nbsp;it's&nbsp;the&nbsp;operating&nbsp;system&nbsp;which&nbsp;handles&nbsp;the&nbsp;input,&nbsp;which&nbsp;thus&nbsp;allows&nbsp;OS&nbsp;&quot;capturing&quot;&nbsp;of&nbsp;Alt+Tab&nbsp;so&nbsp;that&nbsp;the&nbsp;active&nbsp;application&nbsp;is&nbsp;switched.&nbsp;In&nbsp;X11,&nbsp;XSendEvent()&nbsp;requires&nbsp;that&nbsp;you&nbsp;explicitly&nbsp;specify&nbsp;both&nbsp;the&nbsp;Display&nbsp;and&nbsp;Window&nbsp;that&nbsp;the&nbsp;event&nbsp;is&nbsp;being&nbsp;passed&nbsp;to.&nbsp;Consequently,&nbsp;there&nbsp;is&nbsp;NO&nbsp;MECHANISM&nbsp;to&nbsp;have&nbsp;Alt+Tab&nbsp;&quot;captured&quot;&nbsp;by&nbsp;the&nbsp;OS&nbsp;and&nbsp;thus&nbsp;change&nbsp;windows&nbsp;(even&nbsp;if&nbsp;Alt+Tab&nbsp;_will_&nbsp;change&nbsp;windows&nbsp;when&nbsp;typed&nbsp;via&nbsp;the&nbsp;keyboard).&nbsp;This&nbsp;is&nbsp;because&nbsp;the&nbsp;WIndow&nbsp;Manager&nbsp;is&nbsp;grabbing&nbsp;Alt+Tab,&nbsp;but&nbsp;the&nbsp;Window&nbsp;Manager&nbsp;is&nbsp;a&nbsp;completely&nbsp;separate&nbsp;process,&nbsp;and&nbsp;there's&nbsp;not&nbsp;necessarily&nbsp;an&nbsp;easy&nbsp;way&nbsp;to&nbsp;grab&nbsp;the&nbsp;Display+Window&nbsp;for&nbsp;the&nbsp;Window&nbsp;Manager&nbsp;(which&nbsp;might&nbsp;not&nbsp;have&nbsp;a&nbsp;Window&nbsp;to&nbsp;begin&nbsp;with).<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
