<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-vb] vbnc and external dll
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20vbnc%20and%20external%20dll&In-Reply-To=4961E0C2.9090701%40eucentre.it">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000859.html">
   <LINK REL="Next"  HREF="000861.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-vb] vbnc and external dll</H1>
    <B>Andy Hume</B> 
    <A HREF="mailto:mono-vb%40lists.ximian.com?Subject=%5Bmono-vb%5D%20vbnc%20and%20external%20dll&In-Reply-To=4961E0C2.9090701%40eucentre.it"
       TITLE="[mono-vb] vbnc and external dll">andyhume32 at yahoo.co.uk
       </A><BR>
    <I>Fri Jan 16 11:12:24 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000859.html">[mono-vb] vbnc and external dll
</A></li>
        <LI>Next message: <A HREF="000861.html">[mono-vb] vbnc and external dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#860">[ date ]</a>
              <a href="thread.html#860">[ thread ]</a>
              <a href="subject.html#860">[ subject ]</a>
              <a href="author.html#860">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Matteo Lanati wrote:
&gt;<i> 
</I>&gt;<i> I'm trying to run vb8 code under Linux originally developed with Visual
</I>&gt;<i> Studio Express 2008. I'm using the most recent Mono 2.0 version
</I>&gt;<i> available in Debian testing repositories and the latest vbnc from SVN
</I>&gt;<i> (122295). The problem is that I have to use Fortran functions made
</I>&gt;<i> available by a dll library. The declaration of the function
</I>&gt;<i> 
</I>&gt;<i> 
</I>Firstly, you might not need to recompile on Linux at all.  .NET creates
platform independent IL code and thus it will run on MSFT's CLR or Mono's. 
Just use the same Assembly(s) on Linux and see how it goes.  Presumably
you've recompiled the native fortran code. :-)

If you do need to make changes, you can do the changes on the source code on
the Windows box and recompile there.  I always aim to have one assembly that
works on any platform (well excepting NETCF).


Matteo Lanati wrote:
&gt;<i> 
</I>&gt;<i> Public Declare Sub ProdottoMMfor Lib &quot;matrixfor.dll&quot; (ByRef N As
</I>&gt;<i> Integer, ByRef M As Integer, ByRef L As Integer, ByRef A As Double,
</I>&gt;<i> ByRef B As Double, ByRef c As Double)
</I>&gt;<i> 
</I>&gt;<i> is ok, but when I insert the code to use ProdottoMMfor function, vbnc
</I>&gt;<i> complains that &quot;You've encountered something in the compiler which is
</I>&gt;<i> not implemented. Please file a bug ... &quot;
</I>&gt;<i> Is there a solution to my problem or a workaround to use functions from
</I>&gt;<i> a shared library? I have the source code of the dll, I can recompile it
</I>&gt;<i> Any suggestion is appreciated.
</I>&gt;<i> 
</I>
Rolf, creater of the vbnc compiler will likely be here soon to tell us for
sure. :-)  And then a bug report at bugzilla will be wanted, see
<A HREF="http://www.mono-project.com/Bugs">http://www.mono-project.com/Bugs</A>

If you want to recompile using vbnc, then a workaround may be to convert the
Declare statement to a standard &lt;DllImport(....)&gt; definition.  There might
be more likelyhood of the compiler accepting that.

Andy
-- 
View this message in context: <A HREF="http://www.nabble.com/vbnc-and-external-dll-tp21501945p21502762.html">http://www.nabble.com/vbnc-and-external-dll-tp21501945p21502762.html</A>
Sent from the Mono - VB mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000859.html">[mono-vb] vbnc and external dll
</A></li>
	<LI>Next message: <A HREF="000861.html">[mono-vb] vbnc and external dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#860">[ date ]</a>
              <a href="thread.html#860">[ thread ]</a>
              <a href="subject.html#860">[ subject ]</a>
              <a href="author.html#860">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vb">More information about the Mono-vb
mailing list</a><br>
</body></html>
