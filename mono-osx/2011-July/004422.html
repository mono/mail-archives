<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] [MonoMac] Add a toolbar programatically
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20%5BMonoMac%5D%20Add%20a%20toolbar%20programatically&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004423.html">
   <LINK REL="Next"  HREF="004424.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] [MonoMac] Add a toolbar programatically</H1>
    <B>Alain Bocherens</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20%5BMonoMac%5D%20Add%20a%20toolbar%20programatically&In-Reply-To="
       TITLE="[Mono-osx] [MonoMac] Add a toolbar programatically">alain at slide-effect.com
       </A><BR>
    <I>Thu Jul  7 05:15:38 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004423.html">[Mono-osx] SqliteConnection inside NSAutoreleasePool
</A></li>
        <LI>Next message: <A HREF="004424.html">[Mono-osx] [MonoMac] Add a toolbar programatically
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4422">[ date ]</a>
              <a href="thread.html#4422">[ thread ]</a>
              <a href="subject.html#4422">[ subject ]</a>
              <a href="author.html#4422">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi guys,

I am trying to add programatically a toolbar to a window using Monomac. 
I don't want to use IB because i am trying to have almost the same code 
on windows and mac.

My code is based on one of the first version of monomac.windows.forms 
wrapper (<A HREF="https://github.com/mcneel/MonoMac.Windows.Form">https://github.com/mcneel/MonoMac.Windows.Form</A>).

Anyway, I tried to add a toolbar to a simple window. The toolbar is 
displayed (but really small) and it display no buttons. If I use the 
customize option I can see the button palette and even drag and drop 
toolbar button on the toolbar (the green (+) symbol appear) but no 
button are added to the toolbar.

Here is a screenshot of what I mean:
<A HREF="http://www.slide-effect.com/tmp/toolbar-mac.png">http://www.slide-effect.com/tmp/toolbar-mac.png</A>

  Here follow a snippet of my code:

The toolbar class I wrote:
-----------------------------------------------
using System;
using MonoMac.AppKit;
using MonoMac.ObjCRuntime;
using MonoMac.Foundation;
using System.Drawing;
namespace SEForms.Forms
{

     [MonoMac.Foundation.Register(&quot;Toolbar&quot;)]
     public partial class Toolbar : NSToolbar
     {
         public Toolbar () : base()
         {
             this.WillInsertItem += myinsertItems;
             this.AllowedItemIdentifiers += mytoolbarItems;
             this.DefaultItemIdentifiers += mytoolbarItems;
             this.SelectableItemIdentifiers += mytoolbarItems;

             this.DisplayMode = NSToolbarDisplayMode.IconAndLabel;
             this.Visible = true;
             this.AllowsUserCustomization = true;
             this.ValidateVisibleItems();
         }

         public MonoMac.AppKit.NSToolbarItem myinsertItems 
(MonoMac.AppKit.NSToolbar toolbar, string itemIdentifier, bool 
willBeInserted)
         {
             if(itemIdentifier==&quot;test_tralala&quot;)
             {
                 NSToolbarItem item = new NSToolbarItem(&quot;test_tralala&quot;);
                 item.ToolTip = &quot;ich bin ein Berliner&quot;;
                 item.Label = &quot;Test Tralala!&quot;;
                 item.PaletteLabel = &quot;Test Tralala!&quot;;
                 NSImage img = new NSImage(&quot;/Library/Application 
Support/Apple/iChat Icons/Flowers/Ixia.gif&quot;);
                 item.Image = img;
                 item.Target = this;
                 item.Enabled = true;
                 return item;
             }
             else
             {
                 return null;
             }
         }

         public string[] mytoolbarItems (MonoMac.AppKit.NSToolbar toolbar)
         {
             string[] v = new string[8];
             v[0] = NSToolbarSeparatorItemIdentifier;
             v[1] = NSToolbarSpaceItemIdentifier;
             v[2] = NSToolbarFlexibleSpaceItemIdentifier;
             v[3] = NSToolbarShowColorsItemIdentifier;
             v[4] = NSToolbarShowFontsItemIdentifier;
             v[5] = NSToolbarCustomizeToolbarItemIdentifier;
             v[6] = NSToolbarPrintItemIdentifier;
             v[7] = &quot;test_tralala&quot;;
             return v;
         }



     }
}
-----------------------------------------------


In my NSView:
-----------------------------------------------
Toolbar toolbar = new Toolbar();
this.Toolbar = toolbar;
-----------------------------------------------

You can find the full project here: 
<A HREF="http://www.slide-effect.com/tmp/SEForms.zip">http://www.slide-effect.com/tmp/SEForms.zip</A>

Any idea how to make it work?

thanks.

-- 
Alain Bocherens

Slide Effect :: Create Amazing Presentations
<A HREF="http://www.slide-effect.com">http://www.slide-effect.com</A>
Banner Effect :: Flash Banners Made Simple.
<A HREF="http://www.banner-effect.com">http://www.banner-effect.com</A>

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004423.html">[Mono-osx] SqliteConnection inside NSAutoreleasePool
</A></li>
	<LI>Next message: <A HREF="004424.html">[Mono-osx] [MonoMac] Add a toolbar programatically
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4422">[ date ]</a>
              <a href="thread.html#4422">[ thread ]</a>
              <a href="subject.html#4422">[ subject ]</a>
              <a href="author.html#4422">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
