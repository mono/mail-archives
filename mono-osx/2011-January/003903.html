<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] [MonoMac] MM Add-in templates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20%5BMonoMac%5D%20MM%20Add-in%20templates&In-Reply-To=4D43C638.9080804%40pt.lu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003892.html">
   <LINK REL="Next"  HREF="003804.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] [MonoMac] MM Add-in templates</H1>
    <B>Michael Hutchinson</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20%5BMonoMac%5D%20MM%20Add-in%20templates&In-Reply-To=4D43C638.9080804%40pt.lu"
       TITLE="[Mono-osx] [MonoMac] MM Add-in templates">m.j.hutchinson at gmail.com
       </A><BR>
    <I>Mon Jan 31 14:05:43 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003892.html">[Mono-osx] [MonoMac] MM Add-in templates
</A></li>
        <LI>Next message: <A HREF="003804.html">[Mono-osx] [MonoMac] Test for list rejection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3903">[ date ]</a>
              <a href="thread.html#3903">[ thread ]</a>
              <a href="subject.html#3903">[ subject ]</a>
              <a href="author.html#3903">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Jan 29, 2011 at 2:48 AM, kjpou &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-osx">kjpou at pt.lu</A>&gt; wrote:
&gt;<i> Michael
</I>&gt;<i>
</I>&gt;<i> See below the responses.
</I>&gt;<i>
</I>&gt;<i> On 1/28/11 8:03 PM, Michael Hutchinson wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I see, so you are defining the class in the nib file, not just using
</I>&gt;&gt;<i> it. There are two problems with this:
</I>&gt;&gt;<i> * you cannot use your custom view in more than one nib file, since the
</I>&gt;&gt;<i> register will be generated in both vases.
</I>&gt;&gt;<i> * the C# namespace of the nib's designer class and the the custom view
</I>&gt;&gt;<i> will have to match.
</I>&gt;&gt;<i> * the class is partial across two locations with no intuitive
</I>&gt;&gt;<i> relationship.
</I>&gt;<i>
</I>&gt;<i> Yes that is correct. &#160;Also for my short samples it was a lot easier to do it
</I>&gt;<i> that way.
</I>&gt;<i>
</I>&gt;&gt;<i> The &quot;correct&quot; solution to this is nonpartial class with register
</I>&gt;&gt;<i> attribute, but in order to work completely smoothly it would
</I>&gt;&gt;<i> necessitate two nontrivial features:
</I>&gt;&gt;<i> * have MD synch classes defined in C# code into the nib files.
</I>&gt;<i>
</I>&gt;<i> This would be more Apple'ish for people coming over to MM from Obj-c. &#160;I
</I>&gt;<i> personally do not see a problem with the way it is implemented now.
</I>&gt;<i> &#160;Actually I kind of like it. &#160;It is not as automated as XCode but I
</I>&gt;<i> personally feel more in control. &#160;The only thing I see is the namespace
</I>&gt;<i> problem. &#160;I have not done a large project yet with MM so am limited here.
</I>&gt;<i>
</I>&gt;&gt;<i> * have the MD code generator use the project type database to resolve
</I>&gt;&gt;<i> obj-c types to types registered in C# in the project and libraries,
</I>&gt;&gt;<i> not just MonoMac.dll (I have some proof of concept code for this if
</I>&gt;&gt;<i> anyone else want to take it on).
</I>&gt;&gt;<i>
</I>&gt;<i> That could be as well.
</I>&gt;<i>
</I>&gt;<i> The problem I see with it is that once you start adding outlets and actions
</I>&gt;<i> on a custom NSView from IB they automatically get registered in the
</I>&gt;<i> designer. &#160;For example a custom NSView called MyBackView &#160;I did not define
</I>&gt;<i> the MyBackView as a subclass of NSView in the Nib file just changed the type
</I>&gt;<i> to be MyBackView. &#160;The following is what is generated in the designer class.
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;// Should subclass MonoMac.Foundation.NSObject
</I>&gt;<i> &#160; &#160;[MonoMac.Foundation.Register(&quot;MyBackView&quot;)]
</I>&gt;<i> &#160; &#160;public partial class MyBackView {
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;private global::MonoMac.AppKit.NSButton __mt_myButton;
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;private global::MonoMac.AppKit.NSTextField __mt_myLabel;
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;#pragma warning disable 0169
</I>&gt;<i> &#160; &#160; &#160; &#160;[MonoMac.Foundation.Export(&quot;buttonAction:&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160;partial void buttonAction (MonoMac.AppKit.NSButton sender);
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;[MonoMac.Foundation.Export(&quot;myButtonAction:&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160;partial void myButtonAction (MonoMac.AppKit.NSButton sender);
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;[MonoMac.Foundation.Connect(&quot;myButton&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160;private global::MonoMac.AppKit.NSButton myButton {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;get {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;this.__mt_myButton =
</I>&gt;<i> ((global::MonoMac.AppKit.NSButton)(this.GetNativeField(&quot;myButton&quot;)));
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;return this.__mt_myButton;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;set {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;this.__mt_myButton = value;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;this.SetNativeField(&quot;myButton&quot;, value);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i> &#160; &#160; &#160; &#160;}
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;[MonoMac.Foundation.Connect(&quot;myLabel&quot;)]
</I>&gt;<i> &#160; &#160; &#160; &#160;private global::MonoMac.AppKit.NSTextField myLabel {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;get {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;this.__mt_myLabel =
</I>&gt;<i> ((global::MonoMac.AppKit.NSTextField)(this.GetNativeField(&quot;myLabel&quot;)));
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;return this.__mt_myLabel;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;set {
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;this.__mt_myLabel = value;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;this.SetNativeField(&quot;myLabel&quot;, value);
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;}
</I>&gt;<i> &#160; &#160; &#160; &#160;}
</I>&gt;<i> &#160; &#160;}
</I>&gt;<i>
</I>&gt;<i> When you say non trivial in my opinion it is going to take a rethink of the
</I>&gt;<i> whole process. &#160;I do not know how it is all glued together so am not able to
</I>&gt;<i> see the whole picture.
</I>&gt;<i>
</I>&gt;<i> When we start going outside of IB we are going to have to start doing all of
</I>&gt;<i> this in code by hand.
</I>&gt;<i>
</I>&gt;<i> An option could be have two different templates. &#160;One for use cases such as
</I>&gt;<i> this and another for when you want to create a non partial class to be used
</I>&gt;<i> programatically. &#160;Would that be confusing for developers? &#160;Maybe maybe not.
</I>
The thing I have a problem with is that the class is effectively
defined by a nib and the nib's designer code file, yet its other part
is kept completely separate from them. It would be *much* better if it
were grouped under the nib file.

Maybe you could add a context menu command to nib files that would
offer to add a partial class file for any classes defined in the nib
that did not already have non-designer parts. This would be a much
more solid approach IMO, and not very hard to implement.

-- 
Michael Hutchinson
<A HREF="http://mjhutchinson.com">http://mjhutchinson.com</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003892.html">[Mono-osx] [MonoMac] MM Add-in templates
</A></li>
	<LI>Next message: <A HREF="003804.html">[Mono-osx] [MonoMac] Test for list rejection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3903">[ date ]</a>
              <a href="thread.html#3903">[ thread ]</a>
              <a href="subject.html#3903">[ subject ]</a>
              <a href="author.html#3903">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
