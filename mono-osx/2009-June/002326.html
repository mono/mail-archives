<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] Building libgdiplus on OS X
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Building%20libgdiplus%20on%20OS%20X&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002328.html">
   <LINK REL="Next"  HREF="002327.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] Building libgdiplus on OS X</H1>
    <B>Alex Shulgin</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Building%20libgdiplus%20on%20OS%20X&In-Reply-To="
       TITLE="[Mono-osx] Building libgdiplus on OS X">alexander.shulgin at yessoftware.com
       </A><BR>
    <I>Mon Jun  1 08:53:18 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002328.html">[Mono-osx] [BUMP] Re: [Mono-dev] Alpha blending in libgdiplus (call for testers)
</A></li>
        <LI>Next message: <A HREF="002327.html">[Mono-osx] Building libgdiplus on OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2326">[ date ]</a>
              <a href="thread.html#2326">[ thread ]</a>
              <a href="subject.html#2326">[ subject ]</a>
              <a href="author.html#2326">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I had to built libgdiplus on OS X recently and must admit that this was 
quite an experience.

So I'd love to see clear instructions from developers how is one 
supposed to do that.  Also, if someone is trying to build it now or 
later this might save him some time.

Here's the summary of what finally worked for me:

* Install mono-2.4 framework.

* Download &amp; unpack libgdiplus-2.4.tar.bz2.

* Hide mono's cairo pkgconfig file to force the use of internal cairo 
version:

$ ( cd 
/Library/Frameworks/Mono.framework/Versions/Current/lib/pkgconfig; sudo 
mv cairo.pc cairo.pc~ )

* Run the script below:

--8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;--
#!/bin/sh
MONO_PREFIX=/Library/Frameworks/Mono.framework/Versions/Current
TMP_PKG_CONFIG_PREFIX=~/tmp/build/pkgconfig

mkdir -p $TMP_PKG_CONFIG_PREFIX

# Mac OS doesn't come with a fontconfig.pc ... generate one
#  (libgdiplus supports using fontconfig-config, but mac also doesn't 
ship with that)
cat &lt;&lt;EOF &gt; $TMP_PKG_CONFIG_PREFIX/fontconfig.pc
prefix=/usr/X11R6
exec_prefix=\${prefix}
libdir=/usr/X11R6/lib
includedir=\${prefix}/include

Name: Fontconfig
Description: Font configuration and customization library
Version: 2.3.94
Libs: -L\${libdir} -lfontconfig -lexpat
Cflags: -I\${includedir}
EOF

# fake freetype2.pc files for Apple's libs
cat &lt;&lt;EOF &gt; $TMP_PKG_CONFIG_PREFIX/freetype2.pc
prefix=/usr/X11R6
exec_prefix=\${prefix}
libdir=/usr/X11R6/lib
includedir=\${prefix}/include

Name: FreeType 2
Description: A free, high-quality, and portable font engine.
Version: 9.16.3
Requires:
Libs: -L\${libdir} -lfreetype -lz
Cflags: -I\${includedir}/freetype2 -I\${includedir}
EOF

export 
PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/X11R6/lib/pkgconfig:/usr/lib/pkgconfig:$TMP_PKG_CONFIG_PREFIX

export C_INCLUDE_PATH=$MONO_PREFIX/include:$C_INCLUDE_PATH
export LIBRARY_PATH=$MONO_PREFIX/lib:$LIBRARY_PATH

./configure --prefix=$MONO_PREFIX || exit 1
make
--8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;----8&lt;--


As one can see this is far from simple ./configure; make; make install.

In fact I had to bury relatively deep into mono SVN release module to 
find out a hack is used to link with OS X freetype2 and fontconfig libs: 
<A HREF="http://anonsvn.mono-project.com/viewvc/trunk/release/packaging/defs/libgdiplus?view=markup">http://anonsvn.mono-project.com/viewvc/trunk/release/packaging/defs/libgdiplus?view=markup</A> 


Also, C_INCLUDE_PATH and LIBRARY_PATH should be pointed to include and 
lib directories in the current installed version of mono or you'll need 
to download and compile jpeg, png, gif &amp; tiff libraries, etc.; or type 
in some monster like xxx_CFLAGS=... xxx_LIBS=... yyy_CFLAGS=... ./configure.

I've also tried to build libgdiplus from trunk, but couldn't get past 
configure step.

Yes, autogen.sh provided in trunk has --with-cairo=internal option (so I 
don't need to hide installed cairo.pc), but configure fails at random 
places while trying to locate dependencies (BASE_DEPENDENCIES, GTK, 
etc.).  Setting ACLOCAL_PATH to current mono installation didn't help me 
with this problem.

So above is currently the best build method I've come up with.  And it 
took me days to find out all this--not very nice indeed.

Have I missed something obvious?  Are everybody who try to build 
libgdiplus on OS X supposed to stumble upon such enormous set of problems?..

--
Regards,
Alex
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002328.html">[Mono-osx] [BUMP] Re: [Mono-dev] Alpha blending in libgdiplus (call for testers)
</A></li>
	<LI>Next message: <A HREF="002327.html">[Mono-osx] Building libgdiplus on OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2326">[ date ]</a>
              <a href="thread.html#2326">[ thread ]</a>
              <a href="subject.html#2326">[ subject ]</a>
              <a href="author.html#2326">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
