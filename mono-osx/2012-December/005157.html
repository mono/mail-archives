<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] MonoMac CurrentCulture
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=Re%3A%20%5BMono-osx%5D%20MonoMac%20CurrentCulture&In-Reply-To=%3CCAAftrZwb1j_dKeKrP5dN60VueZttTj%2B%3Db27CUPUvSDViOxvghA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005156.html">
   <LINK REL="Next"  HREF="005159.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] MonoMac CurrentCulture</H1>
    <B>Johan Hammar</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=Re%3A%20%5BMono-osx%5D%20MonoMac%20CurrentCulture&In-Reply-To=%3CCAAftrZwb1j_dKeKrP5dN60VueZttTj%2B%3Db27CUPUvSDViOxvghA%40mail.gmail.com%3E"
       TITLE="[Mono-osx] MonoMac CurrentCulture">johanhmr at gmail.com
       </A><BR>
    <I>Mon Dec 17 21:16:00 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="005156.html">[Mono-osx] Mono installs, but doesn't appear
</A></li>
        <LI>Next message: <A HREF="005159.html">[Mono-osx] secure html file in app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5157">[ date ]</a>
              <a href="thread.html#5157">[ thread ]</a>
              <a href="subject.html#5157">[ subject ]</a>
              <a href="author.html#5157">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am adding support for multiple languages in my MonoMac application
(english and swedish). Some of my resources are based on resx-files,
hence Thread.CurrentThread.CurrentUICulture determines which language is
used for these resources.

I was expecting Thread.CurrentThread.CurrentUICulture to be automatically
set up to the appropriate culture based on the user preferred language
(i.,e NSLocale.PreferredLanguages) or fall back to the neutral culture if
not supported. However Thread.CurrentThread.CurrentUICulture does always
seem to be set to the same culture regardless of user preferred language.

I currently have the created the following workaround (see code below) to
programmatically setup CurrentCulture and CurrentUICulture. The most
annoying part about it is that Thread.CurrentThread.CurrentCulture (used
for number formatting etc) does not accept a neutral culture (e.g, &quot;sv&quot;),
if it did we could have mapped directly
from NSBundle.MainBundle.PreferredLocalizations[0] to a CultureInfo
instance.

- However I would appreciate if anyone got a better solution to setup the
current culture based on the user preferred language and the culture
supported by the included resource files (i.e, resx).
- Also I would like to know what is determining the
default Thread.CurrentThread.CurrentUICulture ?

string[] preferredLocalizations =
NSBundle.MainBundle.PreferredLocalizations; //Since we also use lproj
directories for XIB internationalization we can get the most appropriate
neutral language from here.

string preferredLocalization = preferredLocalizations[0];

string cultureName = &quot;en-US&quot;;

if (preferredLocalization.Equals(&quot;sv&quot;)) {

  cultureName = &quot;sv-SE&quot;;

 }

 CultureInfo culturInfo = new CultureInfo(cultureName);

Thread.CurrentThread.CurrentCulture = culturInfo;   //CurrentCulture does
not accept a neutral culture e.g, &quot;sv&quot;, when specifying a neutral culture
an exception is thrown with the message:&quot;Culture 'sv' is a neutral culture.
It cannot be used in formatting and parsing and therefore cannot be set as
the thread&quot;, hence we workaround this by setting it to en-US or sv-SE in
the if statement above.

 Thread.CurrentThread.CurrentUICulture = culturInfo; //CurrentUICulture
accepts a neutral culture, but CurrentCulture does not, hence the if
statement above.

Any input would be appreciated

Best Regards,

Johan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-osx/attachments/20121217/148c73f1/attachment.html">http://lists.ximian.com/pipermail/mono-osx/attachments/20121217/148c73f1/attachment.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005156.html">[Mono-osx] Mono installs, but doesn't appear
</A></li>
	<LI>Next message: <A HREF="005159.html">[Mono-osx] secure html file in app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5157">[ date ]</a>
              <a href="thread.html#5157">[ thread ]</a>
              <a href="subject.html#5157">[ subject ]</a>
              <a href="author.html#5157">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
