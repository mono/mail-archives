<tt>
Hi&nbsp;Eugeny,&lt;br&gt;&lt;br&gt;One&nbsp;other&nbsp;thing...&lt;br&gt;&lt;br&gt;I&nbsp;was&nbsp;taking&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;code&nbsp;and&nbsp;it&nbsp;doesnt&nbsp;look&nbsp;like&nbsp;HeaderAnalyzer&nbsp;is&nbsp;used&nbsp;anymore.&amp;nbsp;&nbsp;It&amp;#39;s&nbsp;looking&nbsp;like&nbsp;you&nbsp;extract&nbsp;all&nbsp;the&nbsp;method&nbsp;and&nbsp;property&nbsp;information&nbsp;from&nbsp;the&nbsp;Objective-C&nbsp;runtime&nbsp;itself.&amp;nbsp;&nbsp;Is&nbsp;that&nbsp;true?&lt;br&gt;<br>
&lt;br&gt;the&nbsp;HeaderAnalyzer.Analyze(..)&nbsp;method&nbsp;is&nbsp;commented&nbsp;out&nbsp;in&nbsp;ProfileBuilder.&amp;nbsp;&nbsp;Also&nbsp;this&nbsp;means&nbsp;that&nbsp;NObjectiveAST&nbsp;seems&nbsp;like&nbsp;it&amp;#39;s&nbsp;not&nbsp;being&nbsp;used.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Martin&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Feb&nbsp;9,&nbsp;2009&nbsp;at&nbsp;6:39&nbsp;AM,&nbsp;Eugeny&nbsp;Grishul&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:eugeny.grishul@gmail.com&quot;&gt;eugeny.grishul@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
Hi,&lt;br&gt;<br>
Thanks&nbsp;for&nbsp;deep&nbsp;code&nbsp;review&nbsp;=)&lt;br&gt;<br>
&lt;br&gt;<br>
Weaver&nbsp;pros&nbsp;and&nbsp;cons:&lt;br&gt;<br>
1)&nbsp;without&nbsp;inheritance&nbsp;proxy&nbsp;assemblies&nbsp;will&nbsp;be&nbsp;about&nbsp;60M&nbsp;due&nbsp;to&nbsp;duplicated&lt;br&gt;<br>
methods&lt;br&gt;<br>
2)&nbsp;it&nbsp;will&nbsp;be&nbsp;used&nbsp;for&nbsp;Objective-C&nbsp;property&nbsp;accessors&nbsp;for&nbsp;same&nbsp;goal&lt;br&gt;<br>
&lt;br&gt;<br>
Cons:&lt;br&gt;<br>
1)&nbsp;code&nbsp;produced&nbsp;by&nbsp;weaver&nbsp;is&nbsp;not&nbsp;verifiable.&nbsp;By&nbsp;spec&nbsp;CLI&nbsp;itself&nbsp;does&nbsp;not&lt;br&gt;<br>
allow&nbsp;for&nbsp;value&nbsp;type&nbsp;inheritance:&lt;br&gt;<br>
&lt;br&gt;<br>
8.9.7.&lt;br&gt;<br>
...&lt;br&gt;<br>
3.&nbsp;A&nbsp;value&nbsp;type&nbsp;does&nbsp;not&nbsp;inherit;&nbsp;rather&nbsp;the&nbsp;base&nbsp;type&nbsp;specified&nbsp;in&nbsp;the&lt;br&gt;<br>
class&nbsp;definition&nbsp;defines&nbsp;the&lt;br&gt;<br>
base&nbsp;type&nbsp;of&nbsp;the&nbsp;boxed&nbsp;type.&lt;br&gt;<br>
4.&nbsp;The&nbsp;base&nbsp;type&nbsp;of&nbsp;a&nbsp;boxed&nbsp;type&nbsp;shall&nbsp;not&nbsp;have&nbsp;any&nbsp;fields.&lt;br&gt;<br>
&lt;br&gt;<br>
8.9.10.&lt;br&gt;<br>
In&nbsp;their&nbsp;unboxed&nbsp;form&nbsp;value&nbsp;types&nbsp;do&nbsp;not&nbsp;inherit&nbsp;from&nbsp;any&nbsp;type.&nbsp;Boxed&nbsp;value&lt;br&gt;<br>
types&nbsp;shall&nbsp;inherit&nbsp;directly&nbsp;from&lt;br&gt;<br>
System.ValueType&nbsp;unless&nbsp;they&nbsp;are&nbsp;enumerations,&nbsp;in&nbsp;which&nbsp;case,&nbsp;they&nbsp;shall&lt;br&gt;<br>
inherit&nbsp;from&nbsp;System.Enum.&nbsp;Boxed&lt;br&gt;<br>
value&nbsp;types&nbsp;shall&nbsp;be&nbsp;sealed.&lt;br&gt;<br>
&lt;br&gt;<br>
My&nbsp;approach&nbsp;is&nbsp;a&nbsp;violation&nbsp;of&nbsp;the&nbsp;spec.&nbsp;If&nbsp;you&nbsp;run&nbsp;&amp;quot;peverify&amp;quot;&nbsp;on&nbsp;the&lt;br&gt;<br>
assembly&nbsp;with&nbsp;one&nbsp;value&nbsp;type&nbsp;inheriting&nbsp;from&nbsp;another,&nbsp;it&nbsp;will&nbsp;tell&nbsp;you&nbsp;as&lt;br&gt;<br>
much&nbsp;=)&nbsp;If&nbsp;mono&nbsp;won&amp;#39;t&nbsp;support&nbsp;value-type&nbsp;inheritace&nbsp;in&nbsp;future&nbsp;it&nbsp;will&nbsp;be&nbsp;bug&lt;br&gt;<br>
in&nbsp;ther&nbsp;JIT&nbsp;coz&nbsp;CLR&nbsp;implementation&nbsp;actually&nbsp;ALLOWS&nbsp;it.&lt;br&gt;<br>
2)&nbsp;Current&nbsp;Mono&nbsp;VES&nbsp;implementation&nbsp;have&nbsp;a&nbsp;bug&nbsp;related&nbsp;ot&nbsp;value&nbsp;type&lt;br&gt;<br>
inheritance&nbsp;and&nbsp;to&nbsp;workaround&nbsp;it&nbsp;don&amp;#39;t&nbsp;allow&nbsp;objc&nbsp;proxies&nbsp;to&nbsp;be&nbsp;boxed.&lt;br&gt;<br>
Following&nbsp;code&nbsp;will&nbsp;crash&nbsp;JIT:&lt;br&gt;<br>
&lt;br&gt;<br>
public&nbsp;void&nbsp;ButtonPressed(&nbsp;NSButton&nbsp;sender&nbsp;)&lt;br&gt;<br>
{&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Console.WriteLine(&nbsp;&amp;quot;Pressed&nbsp;{0}&amp;quot;,&nbsp;sender&nbsp;);&lt;br&gt;<br>
...&lt;br&gt;<br>
...&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;workaround:&lt;br&gt;<br>
public&nbsp;void&nbsp;ButtonPressed(&nbsp;NSButton&nbsp;sender&nbsp;)&lt;br&gt;<br>
{&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Console.WriteLine(&nbsp;&amp;quot;Pressed&nbsp;{0}&amp;quot;,&nbsp;sender.ToString()&nbsp;);&lt;br&gt;<br>
...&lt;br&gt;<br>
...&lt;br&gt;<br>
&lt;br&gt;<br>
About&nbsp;NObjectiveAST&nbsp;-&nbsp;it&nbsp;works&nbsp;like&nbsp;NRefactory&nbsp;and&nbsp;able&nbsp;to&nbsp;parse&nbsp;and&nbsp;save&lt;br&gt;<br>
AST&nbsp;tree&nbsp;to&nbsp;file.&nbsp;But&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;extend&nbsp;interoping&nbsp;abilities&nbsp;of&lt;br&gt;<br>
resulting&nbsp;code&nbsp;then&nbsp;you&nbsp;should&nbsp;modify&nbsp;HeaderAnalyzer&nbsp;(&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://code.google.com/p/nobjective/source/browse/trunk/ProxyGenerator/HeaderAnalyzer.cs&quot;&nbsp;target=&quot;_blank&quot;&gt;http://code.google.com/p/nobjective/source/browse/trunk/ProxyGenerator/HeaderAnalyzer.cs&lt;/a&gt;&lt;br&gt;<br>
)&nbsp;which&nbsp;is&nbsp;not&nbsp;part&nbsp;of&nbsp;NObjectiveAST.&nbsp;The&nbsp;goal&nbsp;of&nbsp;mine&nbsp;bridge&nbsp;is&nbsp;Objective-C&lt;br&gt;<br>
interop&nbsp;so&nbsp;I&amp;#39;ll&nbsp;not&nbsp;plan&nbsp;to&nbsp;add&nbsp;support&nbsp;for&nbsp;automatical&nbsp;P/Invoke&lt;br&gt;<br>
generation..&nbsp;My&nbsp;friend&amp;#39;s&nbsp;dimpoma&nbsp;thesis&nbsp;is&nbsp;related&nbsp;with&nbsp;automatical&nbsp;P/Invoke&lt;br&gt;<br>
generation&nbsp;(he&nbsp;will&nbsp;use&nbsp;NObjectiveAST&nbsp;and&nbsp;test&nbsp;his&nbsp;work&nbsp;on&nbsp;creating&nbsp;Qt&lt;br&gt;<br>
bindings&nbsp;with&nbsp;full&nbsp;code&nbsp;coverage)&nbsp;and&nbsp;may&nbsp;be&nbsp;after&nbsp;5&nbsp;months&nbsp;of&nbsp;his&nbsp;work&nbsp;we&lt;br&gt;<br>
will&nbsp;see&nbsp;brialliant&nbsp;project..or&nbsp;not&nbsp;=)&nbsp;Anyway&nbsp;you&nbsp;can&nbsp;make&nbsp;patch&nbsp;and&nbsp;help&nbsp;to&lt;br&gt;<br>
improve&nbsp;project&nbsp;=)&lt;br&gt;<br>
&lt;br&gt;<br>
WBR,&lt;br&gt;<br>
Eugeny&nbsp;Grishul&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Martin&nbsp;Smith-8&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Hello,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;was&nbsp;looking&nbsp;at&nbsp;the&nbsp;NObjective&nbsp;source&nbsp;code,&nbsp;and&nbsp;noticed&nbsp;that&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;basically&lt;br&gt;<br>
&amp;gt;&nbsp;all&nbsp;the&nbsp;proxies&nbsp;are&nbsp;generated&nbsp;as&nbsp;structs.&nbsp;&amp;nbsp;The&nbsp;compiled&nbsp;assembly&nbsp;then&nbsp;gets&lt;br&gt;<br>
&amp;gt;&nbsp;passed&nbsp;to&nbsp;a&nbsp;code&nbsp;weaver&nbsp;which&nbsp;fills&nbsp;in&nbsp;the&nbsp;Objective-C&nbsp;class&nbsp;inheritance&lt;br&gt;<br>
&amp;gt;&nbsp;structure.&nbsp;The&nbsp;code&nbsp;weaver&nbsp;basically&nbsp;uses&nbsp;Mono.Cecil&nbsp;to&nbsp;make&nbsp;structs&lt;br&gt;<br>
&amp;gt;&nbsp;support&lt;br&gt;<br>
&amp;gt;&nbsp;inheritance.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;guess&nbsp;this&nbsp;works,&nbsp;but&nbsp;the&nbsp;thing&nbsp;I&amp;#39;m&nbsp;wondering&nbsp;is:&nbsp;is&nbsp;it&nbsp;safe&nbsp;te&nbsp;rely&nbsp;on&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;mono&nbsp;runtime&nbsp;can&nbsp;actually&nbsp;support&nbsp;inheritance&nbsp;for&nbsp;value&lt;br&gt;<br>
&amp;gt;&nbsp;types?&nbsp;&amp;nbsp;Is&nbsp;this&nbsp;something&nbsp;that&amp;#39;s&nbsp;supposed&nbsp;to&nbsp;be&nbsp;supported&nbsp;by&nbsp;the&nbsp;CLI&nbsp;but&lt;br&gt;<br>
&amp;gt;&nbsp;just&nbsp;isnt&nbsp;supported&nbsp;by&nbsp;C#?&nbsp;&amp;nbsp;I&amp;#39;m&nbsp;assuming&nbsp;that&nbsp;there&nbsp;would&nbsp;be&nbsp;some&nbsp;serious&lt;br&gt;<br>
&amp;gt;&nbsp;issues&nbsp;if&nbsp;all&nbsp;the&nbsp;proxies&nbsp;weren&amp;#39;t&nbsp;the&nbsp;same&nbsp;size&nbsp;(i.e.&nbsp;with&nbsp;only&nbsp;an&nbsp;IntPtr&lt;br&gt;<br>
&amp;gt;&nbsp;as&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;instance&nbsp;data).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;At&nbsp;any&nbsp;rate,&nbsp;cheers&nbsp;Eugeny.&nbsp;&amp;nbsp;You&amp;#39;ve&nbsp;created&nbsp;a&nbsp;pretty&nbsp;impressive&nbsp;layer&lt;br&gt;<br>
&amp;gt;&nbsp;here.&lt;br&gt;<br>
&amp;gt;&nbsp;Have&nbsp;you&nbsp;thought&nbsp;about&nbsp;extending&nbsp;NObjectiveAST&nbsp;to&nbsp;suport&nbsp;interoping&nbsp;some&lt;br&gt;<br>
&amp;gt;&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;C-based&nbsp;functions&nbsp;(for&nbsp;example,&nbsp;NSMakeRect,&nbsp;or&nbsp;the&nbsp;CGContext*&lt;br&gt;<br>
&amp;gt;&nbsp;methods).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Thanks&nbsp;again&nbsp;Eugeny&nbsp;for&nbsp;such&nbsp;great&nbsp;code!&lt;br&gt;<br>
&amp;gt;&nbsp;Martin&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;Mono-osx&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-osx@lists.ximian.com&quot;&gt;Mono-osx@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-osx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-osx&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://www.nabble.com/NObjective-and-Inheritance-tp21882576p21914042.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.nabble.com/NObjective-and-Inheritance-tp21882576p21914042.html&lt;/a&gt;&lt;br&gt;<br>
Sent&nbsp;from&nbsp;the&nbsp;Mono&nbsp;-&nbsp;OSX&nbsp;mailing&nbsp;list&nbsp;archive&nbsp;at&nbsp;Nabble.com.&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-osx&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-osx@lists.ximian.com&quot;&gt;Mono-osx@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-osx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-osx&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
