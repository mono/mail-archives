<tt>
I&amp;#39;m&nbsp;working&nbsp;on&nbsp;bindings&nbsp;for&nbsp;the&nbsp;CoreMIDI&nbsp;framework&nbsp;and&nbsp;I&amp;#39;m&nbsp;struggling&nbsp;to&nbsp;find&nbsp;the&nbsp;best&nbsp;design&nbsp;for&nbsp;wrapping&nbsp;the&nbsp;MidiPacketList&nbsp;and&nbsp;MidiPacket&nbsp;structs&nbsp;with&nbsp;managed&nbsp;objects.&lt;br&gt;&lt;br&gt;I&nbsp;want&nbsp;to&nbsp;implement&nbsp;the&nbsp;INativeObject&nbsp;and&nbsp;IDisposable&nbsp;interfaces&nbsp;on&nbsp;my&nbsp;wrappers&nbsp;for&nbsp;consistency&nbsp;and&nbsp;to&nbsp;support&nbsp;passing&nbsp;the&nbsp;wrapped&nbsp;objects&nbsp;to&nbsp;Objective-C&nbsp;code,&nbsp;but&nbsp;these&nbsp;structs&nbsp;are&nbsp;not&nbsp;reference-counted&nbsp;like&nbsp;many&nbsp;of&nbsp;the&nbsp;other&nbsp;things&nbsp;wrapped&nbsp;with&nbsp;INativeObject&nbsp;in&nbsp;MonoMac.&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;One&nbsp;of&nbsp;my&nbsp;primary&nbsp;concerns&nbsp;is&nbsp;the&nbsp;following&nbsp;scenario:&nbsp;&lt;br&gt;&lt;br&gt;In&nbsp;response&nbsp;to&nbsp;a&nbsp;MIDI&nbsp;device&nbsp;event,&nbsp;a&nbsp;managed&nbsp;callback&nbsp;in&nbsp;the&nbsp;MonoMac.CoreMidi&nbsp;code&nbsp;will&nbsp;be&nbsp;called&nbsp;from&nbsp;unmanaged&nbsp;code&nbsp;with&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;MidiPacketList&nbsp;struct&nbsp;as&nbsp;a&nbsp;parameter.&nbsp;That&nbsp;callback&nbsp;will&nbsp;raise&nbsp;an&nbsp;event&nbsp;for&nbsp;consumption&nbsp;by&nbsp;client&nbsp;code&nbsp;(i.e.&nbsp;code&nbsp;written&nbsp;by&nbsp;developers&nbsp;using&nbsp;MonoMac&nbsp;and&nbsp;not&nbsp;wanting&nbsp;to&nbsp;worry&nbsp;about&nbsp;memory&nbsp;allocation&nbsp;issues).&nbsp;I&nbsp;want&nbsp;to&nbsp;include&nbsp;the&nbsp;managed-code-wrapped&nbsp;MidiPacketList&nbsp;as&nbsp;a&nbsp;property&nbsp;of&nbsp;the&nbsp;event.&nbsp;But&nbsp;if&nbsp;I&nbsp;just&nbsp;wrapped&nbsp;the&nbsp;native&nbsp;object&nbsp;without&nbsp;copying&nbsp;it,&nbsp;it&nbsp;will&nbsp;probably&nbsp;be&nbsp;freed&nbsp;after&nbsp;the&nbsp;event&nbsp;has&nbsp;fired,&nbsp;leaving&nbsp;any&nbsp;references&nbsp;the&nbsp;client&nbsp;code&nbsp;might&nbsp;have&nbsp;to&nbsp;the&nbsp;MidiPacketList&nbsp;with&nbsp;a&nbsp;pointer&nbsp;to&nbsp;freed&nbsp;memory.&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;These&nbsp;are&nbsp;the&nbsp;solutions&nbsp;I&amp;#39;m&nbsp;considering:&lt;br&gt;&lt;br&gt;1.&nbsp;Allocate&nbsp;some&nbsp;unmanaged&nbsp;memory&nbsp;with&nbsp;AllocHGlobal,&nbsp;copy&nbsp;the&nbsp;packet&nbsp;list&nbsp;there,&nbsp;and&nbsp;then&nbsp;set&nbsp;the&nbsp;INativeObject.Handle&nbsp;to&nbsp;point&nbsp;to&nbsp;the&nbsp;copy&nbsp;rather&nbsp;than&nbsp;the&nbsp;original.&nbsp;Clean&nbsp;up&nbsp;the&nbsp;memory&nbsp;later&nbsp;when&nbsp;Dispose&nbsp;is&nbsp;called.&lt;br&gt;<br>
&lt;br&gt;2.&nbsp;Just&nbsp;don&amp;#39;t&nbsp;worry&nbsp;about&nbsp;maintaining&nbsp;native&nbsp;objects&nbsp;in&nbsp;this&nbsp;case&nbsp;at&nbsp;all.&nbsp;Decode&nbsp;the&nbsp;MidiPacketList&nbsp;to&nbsp;managed&nbsp;objects&nbsp;and&nbsp;move&nbsp;on&nbsp;with&nbsp;life.&lt;br&gt;&lt;br&gt;Thoughts?&lt;br&gt;&lt;br&gt;<br>

</tt>
