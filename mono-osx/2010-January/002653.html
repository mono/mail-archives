<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] Beginner - Very Simple P/Invoke Example?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Beginner%20-%20Very%20Simple%20P/Invoke%20Example%3F&In-Reply-To=aec34c771001040040n66b1382el1135c6716bf17931%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002652.html">
   <LINK REL="Next"  HREF="002654.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] Beginner - Very Simple P/Invoke Example?</H1>
    <B>Duane Wandless</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Beginner%20-%20Very%20Simple%20P/Invoke%20Example%3F&In-Reply-To=aec34c771001040040n66b1382el1135c6716bf17931%40mail.gmail.com"
       TITLE="[Mono-osx] Beginner - Very Simple P/Invoke Example?">duane at wandless.net
       </A><BR>
    <I>Mon Jan  4 10:42:11 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002652.html">[Mono-osx] Beginner - Very Simple P/Invoke Example?
</A></li>
        <LI>Next message: <A HREF="002654.html">[Mono-osx] Beginner - Very Simple P/Invoke Example?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2653">[ date ]</a>
              <a href="thread.html#2653">[ thread ]</a>
              <a href="subject.html#2653">[ subject ]</a>
              <a href="author.html#2653">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I recommend the dllmap approach when embedding.  I could not get any of the
environment variables to be correctly set and read at runtime.  I'd set it
during the app load routine, init mono and mono would fail to find the
library.  If I set the environment variable prior to launching the app mono
could find the library.  Using the dllmap I'm able to set at runtime where
my dylib is located, which is within the app itself.

Duane

On Mon, Jan 4, 2010 at 3:40 AM, Michael Hutchinson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-osx">m.j.hutchinson at gmail.com</A>
&gt;<i> wrote:
</I>
&gt;<i> On Sun, Jan 3, 2010 at 5:15 PM, cannyshammy &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-osx">mike.cann at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Im new to Mono development tho I have done a fair bit of XNA stuff. For
</I>&gt;<i> this
</I>&gt;<i> &gt; current project however I need to catch system-wide input events so I
</I>&gt;<i> need
</I>&gt;<i> &gt; some native code for that.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Im trying to get a very simple P/Invoke example working on OSX. My C
</I>&gt;<i> looks
</I>&gt;<i> &gt; like:
</I>&gt;<i> &lt;snip&gt;
</I>&gt;<i> &gt; But it throws me the following error:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Unhandled Exception: System.DllNotFoundException: libXCodeMono.dylib
</I>&gt;<i> &gt;  at (wrapper managed-to-native) SimpleMacMonoHook.MacHook:myMethod (int)
</I>&gt;<i> &gt;  at SimpleMacMonoHook.MacHook..ctor () [0x00006] in
</I>&gt;<i>
</I>&gt;<i> My guess would be that when loading dynamic libraries, MacOS isn't
</I>&gt;<i> looking in the directory your program's in. Try setting
</I>&gt;<i> DYLD_FALLBACK_LIBRARY_PATH to your program's directory in your launch
</I>&gt;<i> script.
</I>&gt;<i>
</I>&gt;<i> AFAIK the &quot;done thing&quot; for library paths on Mac is to use absolute
</I>&gt;<i> paths, with some variables - the following explains this:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://developer.apple.com/mac/library/documentation/Darwin/Reference/ManPages/man1/dyld.1.html">http://developer.apple.com/mac/library/documentation/Darwin/Reference/ManPages/man1/dyld.1.html</A>
</I>&gt;<i>
</I>&gt;<i> With Mono, I'd use dllmaps and DYLD_FALLBACK_LIBRARY_PATH.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Michael Hutchinson
</I>&gt;<i> <A HREF="http://mjhutchinson.com">http://mjhutchinson.com</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-osx mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-osx">Mono-osx at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-osx">http://lists.ximian.com/mailman/listinfo/mono-osx</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-osx/attachments/20100104/1a5818d7/attachment.html">http://lists.ximian.com/pipermail/mono-osx/attachments/20100104/1a5818d7/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002652.html">[Mono-osx] Beginner - Very Simple P/Invoke Example?
</A></li>
	<LI>Next message: <A HREF="002654.html">[Mono-osx] Beginner - Very Simple P/Invoke Example?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2653">[ date ]</a>
              <a href="thread.html#2653">[ thread ]</a>
              <a href="subject.html#2653">[ subject ]</a>
              <a href="author.html#2653">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
