<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] Outline view drag and drop
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Outline%20view%20drag%20and%20drop&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004552.html">
   <LINK REL="Next"  HREF="004556.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] Outline view drag and drop</H1>
    <B>Arakun</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Outline%20view%20drag%20and%20drop&In-Reply-To="
       TITLE="[Mono-osx] Outline view drag and drop">hugo.forss at gmail.com
       </A><BR>
    <I>Sun Sep 11 06:49:36 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004552.html">[Mono-osx] Mono App on OSX the Embeds Flash
</A></li>
        <LI>Next message: <A HREF="004556.html">[Mono-osx] MonoDevelop exits with code 255
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4553">[ date ]</a>
              <a href="thread.html#4553">[ thread ]</a>
              <a href="subject.html#4553">[ subject ]</a>
              <a href="author.html#4553">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I'm trying to add drag and drop to an outline view so that you can rearrange
its nodes. The OutlineViewWriteItemstoPasteboard is causing me a lot of
headache though. I'm handed an array containing the object(s) being dragged,
however I there's no way of extracting the objects other than in the form of
an IntPtr. The proper way would be to use NSKeyedArchiver to add the objects
to the pasteboard but the nodes I'm using are just wrappers for
non-NSObjects (plus it would just move the problem to the
ValidateDrop/AcceptDrop methods). Since all of the drag and drop is done
within the same view it seems a lot easier to just store a reference to the
item being dragged in a variable.

One of the big problems with the IntPtr is that I can see no way of finding
out the type of the object. Each layer of my tree structure uses a different
subclass of NSTreeNode. Back when I was trying to use the NSTreeController
and Cocoa Bindings the nodes would get wrapped up in another layer of
NSTreeNode objects. Then I could simply do something like this:

IntPtr ptr = items.ValueAt(0); /// where items is the NSArray/
NSTreeNode node = new NSTreeNode(ptr);
NSTreeNode myNode = node.RepresentedObject;
Type t = myNode.GetType();

if (t == typeof(MyTreeNode))
{
	MyTreeNode typecastNode = (MyTreeNode)myNode;
	// Do something
}

Since then I've changed into using the NSOutlineViewDataSource protocol
instead. I'm not sure whether I'm supposed to ever be using &quot;new
NSTreeNode(IntPtr)&quot;. Using it on one of my subclasses seems to convert the
original object into just an NSTreeNode which messes up the code since I can
no longer call my own custom methods. This is where I'm stuck &#8211; I need to
figure out exactly what object I'm dealing with and its type.

Regards,
&#8212; Hugo

--
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/Outline-view-drag-and-drop-tp3804994p3804994.html">http://mono.1490590.n4.nabble.com/Outline-view-drag-and-drop-tp3804994p3804994.html</A>
Sent from the Mono - OSX mailing list archive at Nabble.com.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004552.html">[Mono-osx] Mono App on OSX the Embeds Flash
</A></li>
	<LI>Next message: <A HREF="004556.html">[Mono-osx] MonoDevelop exits with code 255
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4553">[ date ]</a>
              <a href="thread.html#4553">[ thread ]</a>
              <a href="subject.html#4553">[ subject ]</a>
              <a href="author.html#4553">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
