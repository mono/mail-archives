<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] P/invoking the OS X speech API?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20P/invoking%20the%20OS%20X%20speech%20API%3F&In-Reply-To=52BB91E9-B560-4A7C-98EB-911A9D827161%40thewordnerd.info">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000457.html">
   <LINK REL="Next"  HREF="000460.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] P/invoking the OS X speech API?</H1>
    <B>kangaroo</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20P/invoking%20the%20OS%20X%20speech%20API%3F&In-Reply-To=52BB91E9-B560-4A7C-98EB-911A9D827161%40thewordnerd.info"
       TITLE="[Mono-osx] P/invoking the OS X speech API?">grompf at sublimeintervention.com
       </A><BR>
    <I>Wed Feb 22 00:51:25 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000457.html">[Mono-osx] P/invoking the OS X speech API?
</A></li>
        <LI>Next message: <A HREF="000460.html">[Mono-osx] P/invoking the OS X speech API?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#458">[ date ]</a>
              <a href="thread.html#458">[ thread ]</a>
              <a href="subject.html#458">[ subject ]</a>
              <a href="author.html#458">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nolan,

   It appears your problem is misunderstanding the C code (at least  
from my quick glance);

SpeechChannel is a pointer to SpeechChannelRecord; meaning that the  
SpeechChannel* expected in NewSpeechChannel is in fact a  
SpeechChannelRecord** which you have collapsed to the structure.

I'm also concerned about where the popuplation of the SpeechChannel  
is happening; I assume it is happening in native land in which case  
you probably want to use IntPtr and just pass the IntPtr around as  
needed rather than dealing with the structure.  There is no point in  
bringing in that data if you dont need to.

-kangaroo

On 21-Feb-06, at 11:05 PM, Nolan Darilek wrote:

&gt;<i> using System;
</I>&gt;<i> using System.Runtime.InteropServices;
</I>&gt;<i>
</I>&gt;<i> namespace Meridian.Tts.Osx {
</I>&gt;<i>
</I>&gt;<i> 	[StructLayout(LayoutKind.Sequential)]
</I>&gt;<i> 	struct SpeechChannel {
</I>&gt;<i> 		[MarshalAs(UnmanagedType.ByValArray, SizeConst=1)]
</I>&gt;<i> 				long[] data;
</I>&gt;<i> 	}
</I>&gt;<i>
</I>&gt;<i> 	public class Channel {
</I>&gt;<i>
</I>&gt;<i> 		private SpeechChannel _id;
</I>&gt;<i>
</I>&gt;<i> 		protected const string _applicationServicesPath = &quot;/System/ 
</I>&gt;<i> Library/Frameworks/ApplicationServices.framework/Versions/Current/ 
</I>&gt;<i> ApplicationServices&quot;;
</I>&gt;<i>
</I>&gt;<i> 		[DllImport(_applicationServicesPath)]
</I>&gt;<i> 		private static extern short NewSpeechChannel(IntPtr voice, ref  
</I>&gt;<i> SpeechChannel channel);
</I>&gt;<i>
</I>&gt;<i> 		[DllImport(_applicationServicesPath)]
</I>&gt;<i> 		private static extern short SpeakText(SpeechChannel channel,  
</I>&gt;<i> String text, long length);
</I>&gt;<i>
</I>&gt;<i> 	public Channel() {
</I>&gt;<i> 	short rc = NewSpeechChannel((IntPtr)null, ref _id);
</I>&gt;<i> 		Console.WriteLine(rc);
</I>&gt;<i> 		Speak(&quot;Hello, world.&quot;);
</I>&gt;<i> 	}
</I>&gt;<i>
</I>&gt;<i> 	public bool Speak(String text) {
</I>&gt;<i> 		short rc = SpeakText(_id, text, (long)text.Length);
</I>&gt;<i> 		return (rc == 0);
</I>&gt;<i> 	}
</I>&gt;<i>
</I>&gt;<i> 	}
</I>&gt;<i> }
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-osx/attachments/20060222/7b409e33/attachment-0001.html">http://lists.ximian.com/pipermail/mono-osx/attachments/20060222/7b409e33/attachment-0001.html</A>
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000457.html">[Mono-osx] P/invoking the OS X speech API?
</A></li>
	<LI>Next message: <A HREF="000460.html">[Mono-osx] P/invoking the OS X speech API?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#458">[ date ]</a>
              <a href="thread.html#458">[ thread ]</a>
              <a href="subject.html#458">[ subject ]</a>
              <a href="author.html#458">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
