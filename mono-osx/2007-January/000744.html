<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-osx] Statics and Singletons with Dumbarton [Solved with	patch]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Statics%20and%20Singletons%20with%20Dumbarton%20%5BSolved%20with%0A%09patch%5D&In-Reply-To=58E9612C-9E52-422E-840D-E9F806F34521%40web.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000743.html">
   <LINK REL="Next"  HREF="000746.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-osx] Statics and Singletons with Dumbarton [Solved with	patch]</H1>
    <B>R. Tyler Ballance</B> 
    <A HREF="mailto:mono-osx%40lists.ximian.com?Subject=%5BMono-osx%5D%20Statics%20and%20Singletons%20with%20Dumbarton%20%5BSolved%20with%0A%09patch%5D&In-Reply-To=58E9612C-9E52-422E-840D-E9F806F34521%40web.de"
       TITLE="[Mono-osx] Statics and Singletons with Dumbarton [Solved with	patch]">tyler at bleepconsulting.com
       </A><BR>
    <I>Tue Jan  2 07:32:32 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000743.html">[Mono-osx] Statics and Singletons with Dumbarton
</A></li>
        <LI>Next message: <A HREF="000746.html">[Mono-osx] Statics and Singletons with Dumbarton [Solved with	patch]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#744">[ date ]</a>
              <a href="thread.html#744">[ thread ]</a>
              <a href="subject.html#744">[ subject ]</a>
              <a href="author.html#744">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jan 2, 2007, at 5:34 AM, Andreas F&#228;rber wrote:

&gt;<i> No idea, I don't use Dumbarton in my Cocoa app. But even when using  
</I>&gt;<i> Dumbarton you can use the embedding functions of Mono directly like  
</I>&gt;<i> Dumbarton as a wrapper does internally, or if it's missing in  
</I>&gt;<i> Dumbarton patch it in.
</I>&gt;<i> The initWithMonoObject:NULL above will not lead to success as Mono  
</I>&gt;<i> cannot retrieve a MonoClass* from a NULL reference. Logically I  
</I>&gt;<i> would expect such ObjC messages at a class wrapper, say result =  
</I>&gt;<i> [myClass staticProperty(&quot;MyProperty&quot;)];
</I>
Taking all of this into consideration I have another patch that I  
have tested with my singleton method, and some other miscellaneous  
static properties being bridged between Dumbarton and Cocoa.

This patch adds the following methods to DBMonoObjectRepresentation:

+ (MonoObject *)invokeStaticMethod:(const char *)methodName  
withNumArgs:(int)numArgs varArgList:(va_list)va_args;
+ (MonoObject *)invokeStaticMethod:(const char *)methodName  
withNumArgs:(int)numArgs, ...;
+ (MonoObject *)getStaticProperty:(const char *)propertyName;
+ (void)setStaticProperty:(const char *)propertyName valueObject: 
(MonoObject *)valueObject;


In the singleton example I cited earlier, the following code will  
properly funnel singleton instantiation through the Instance property  
in C#:

+ (SingletonObject *)sharedObject
{
	@synchronized(self)
	{
		if (instance == nil)
		{
			MonoObject *obj = [SingletonObject getStaticProperty:&quot;Instance&quot;];
			instance = [[self alloc] initWithMonoObject:obj];
		}
	}
	return instance;
}

Then elsewhere in my code I can call static methods like:
[SingletonObject testPrint]; // test static method to print something  
via Console.WriteLine

I'm using Dumbarton with this patch incorporated thus far without any  
problems. My DBMonoObjectRepresentation follows the Cocoa singleton  
pattern, as the actual Mono object it represents follows the C#  
singleton pattern.

Thanks for the help Andreas!

Allan (or whomever it may concern) let me know if I need to fix  
anything or change some patches to allow this to be committed to  
subversion. I was wondering if I should just be using  
DBMonoClassRepresentation, but the examples use  
DBMonoObjectRepresentation, so I have assumed that it is the &quot;defacto  
standard&quot; for bridging C#-&gt;Cocoa objects


Cheers

&#65532;
R. Tyler Ballance: Custom Mac and Linux Development at bleep. consulting
contact: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-osx">tyler at bleepconsulting.com</A> | jabber: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-osx">tyler at jabber.geekisp.com</A>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-osx/attachments/20070102/45a23676/attachment.html">http://lists.ximian.com/pipermail/mono-osx/attachments/20070102/45a23676/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: DBMonoObjectRepresentation.patch
Type: application/octet-stream
Size: 2372 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-osx/attachments/20070102/45a23676/attachment.obj">http://lists.ximian.com/pipermail/mono-osx/attachments/20070102/45a23676/attachment.obj</A> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-osx/attachments/20070102/45a23676/attachment-0001.html">http://lists.ximian.com/pipermail/mono-osx/attachments/20070102/45a23676/attachment-0001.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000743.html">[Mono-osx] Statics and Singletons with Dumbarton
</A></li>
	<LI>Next message: <A HREF="000746.html">[Mono-osx] Statics and Singletons with Dumbarton [Solved with	patch]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#744">[ date ]</a>
              <a href="thread.html#744">[ thread ]</a>
              <a href="subject.html#744">[ subject ]</a>
              <a href="author.html#744">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-osx">More information about the Mono-osx
mailing list</a><br>
</body></html>
