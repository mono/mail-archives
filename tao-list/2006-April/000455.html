<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Tao-list] Import CAD model or other type of 3D model to
	Tao.OpenGL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tao-list%40lists.ximian.com?Subject=%5BTao-list%5D%20Import%20CAD%20model%20or%20other%20type%20of%203D%20model%20to%0A%09Tao.OpenGL&In-Reply-To=1159fdb00604232156j752dac55s23fcd918ec506717%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000453.html">
   <LINK REL="Next"  HREF="000456.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tao-list] Import CAD model or other type of 3D model to
	Tao.OpenGL</H1>
    <B>Audrius Sadauskas</B> 
    <A HREF="mailto:tao-list%40lists.ximian.com?Subject=%5BTao-list%5D%20Import%20CAD%20model%20or%20other%20type%20of%203D%20model%20to%0A%09Tao.OpenGL&In-Reply-To=1159fdb00604232156j752dac55s23fcd918ec506717%40mail.gmail.com"
       TITLE="[Tao-list] Import CAD model or other type of 3D model to
	Tao.OpenGL">awmlist at gmail.com
       </A><BR>
    <I>Wed Apr 26 13:57:57 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000453.html">[Tao-list] Import CAD model or other type of 3D model to Tao.OpenGL
</A></li>
        <LI>Next message: <A HREF="000456.html">[Tao-list] Tao.ode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#455">[ date ]</a>
              <a href="thread.html#455">[ thread ]</a>
              <a href="subject.html#455">[ subject ]</a>
              <a href="author.html#455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jessy,
some time ago i needed something similar and the only solution i found
- to write my own parser for *.obj format (3d max can detinitely
export in such format). There is one limitation though - one obj file
can only contain one object (if it is a problem you should just change
some of the code youself). I hope it helps.

using System.IO;
namespace OBJLoader
{
public static class Loader
{
public class VERTEX
{
public float x, y, z;
}

public class TEXTCOORDS
{
public float u, v;
}

public class TRIANGLE
{
public TRIANGLE()
{
vertex = new VERTEX[3];
}

public VERTEX[] vertex;
}

public class NORMAL
{
public NORMAL()
{
vertex = new VERTEX[3];
}

public VERTEX[] vertex;
}

public class TEXTURE
{
public TEXTURE()
{
vertex = new TEXTCOORDS[3];
}

public TEXTCOORDS[] vertex;
}

public class OBJECT3D
{
public int nTriangles;
public TRIANGLE[] triangle;
public NORMAL[] normal;
public TEXTURE[] texture;
}

//-------------------------------------------------------
public static OBJECT3D LoadObject(string FileName)
{
OBJECT3D obj = new OBJECT3D();
VERTEX[] vert = null;
VERTEX[] normal = null;
TEXTCOORDS[] texture = null;

int value, iVertex, iNormal, iTexture, iFace, tmp, iVertexCount, iTextCount;
iFace = iVertex = iNormal = iTexture = iVertexCount = iTextCount = 0;

int fv1, fv11, fv111, fv2, fv22, fv222, fv3, fv33, fv333;
string[] str;

TextReader file = File.OpenText(FileName);
string line;
while ((line = file.ReadLine()) != null)
{
str = line.Split(new char[] {' '},
System.StringSplitOptions.RemoveEmptyEntries);
if (str.Length &gt; 2)
{
if ((str[0] == &quot;#&quot;) &amp;&amp; (int.TryParse(str[1], out value)))
{
switch (str[2][0])
{
case 'v':
iVertexCount = value;
vert = new VERTEX[iVertexCount];
normal = new VERTEX[iVertexCount];
break;
case 't':
iTextCount = value;
texture = new TEXTCOORDS[iTextCount];
break;
case 'f':
obj.nTriangles = value;
obj.triangle = new TRIANGLE[value];
obj.normal = new NORMAL[value];
obj.texture = new TEXTURE[value];
break;
}
}
}
}


file.Close();
file = File.OpenText(FileName);

System.Globalization.NumberFormatInfo nfi = new
System.Globalization.NumberFormatInfo();
nfi.CurrencyDecimalSeparator = &quot;.&quot;;
while ((line = file.ReadLine()) != null)
{
str = line.Split(new char[] { ' ' },
System.StringSplitOptions.RemoveEmptyEntries);
if ((str.Length == 4) &amp;&amp; (str[0] == &quot;v&quot;) &amp;&amp; (iVertex &lt; iVertexCount))
{
vert[iVertex] = new VERTEX();
vert[iVertex].x = float.Parse(str[1], nfi);
vert[iVertex].y = float.Parse(str[2], nfi);
vert[iVertex].z = float.Parse(str[3], nfi);
iVertex++;
}
else if ((str.Length &gt; 0) &amp;&amp; (str[0] == &quot;vt&quot;) &amp;&amp; (iTexture &lt; iTextCount))
{
texture[iTexture] = new TEXTCOORDS();
texture[iTexture].u = float.Parse(str[1], nfi);
texture[iTexture].v = float.Parse(str[2], nfi);
iTexture++;
}
else if ((str.Length &gt; 0) &amp;&amp; (str[0] == &quot;vn&quot;) &amp;&amp; (iNormal &lt; iVertexCount))
{
normal[iNormal] = new VERTEX();
normal[iNormal].x = float.Parse(str[1], nfi);
normal[iNormal].y = float.Parse(str[2], nfi);
normal[iNormal].z = float.Parse(str[3], nfi);
iNormal++;
}
else if ((str.Length == 4) &amp;&amp; (str[0] == &quot;f&quot;))
{
string[] str1 = str[1].Split('/');
string[] str2 = str[2].Split('/');
string[] str3 = str[3].Split('/');
if ((str1.Length &gt; 1) &amp;&amp; (str2.Length &gt; 1) &amp;&amp; (str3.Length &gt; 1))
{

fv1 = System.Math.Abs(int.Parse(str1[0]));
if (int.TryParse(str1[1], out fv11))
{
fv11 = System.Math.Abs(fv11);
}
else
{
fv11 = -1;
}
if (str1.Length &gt; 2)
{
fv111 = System.Math.Abs(int.Parse(str1[2]));
}
else
{
fv111 = -1;
}

fv2 = System.Math.Abs(int.Parse(str2[0]));
if (int.TryParse(str2[1], out fv22))
{
fv22 = System.Math.Abs(fv22);
}
else
{
fv22 = -1;
}
if (str2.Length &gt; 2)
{
fv222 = System.Math.Abs(int.Parse(str2[2]));
}
else
{
fv222 = -1;
}

fv3 = System.Math.Abs(int.Parse(str3[0]));
if (int.TryParse(str3[1], out fv33))
{
fv33 = System.Math.Abs(fv33);
}
else
{
fv33 = -1;
}
if (str2.Length &gt; 2)
{
fv333 = System.Math.Abs(int.Parse(str3[2]));
}
else
{
fv333 = -1;
}

obj.triangle[iFace] = new TRIANGLE();
obj.texture[iFace] = new TEXTURE();
obj.normal[iFace] = new NORMAL();

for (int i = 0; i &lt; 3; i++ )
{
obj.triangle[iFace].vertex[i] = new VERTEX();
obj.texture[iFace].vertex[i] = new TEXTCOORDS();
obj.normal[iFace].vertex[i] = new VERTEX();
}

tmp = fv1 - 1;
obj.triangle[iFace].vertex[0].x = vert[tmp].x;
obj.triangle[iFace].vertex[0].y = vert[tmp].y;
obj.triangle[iFace].vertex[0].z = vert[tmp].z;

if (fv11 != -1)
{
tmp = fv11 - 1;
obj.texture[iFace].vertex[0].u = texture[tmp].u;
obj.texture[iFace].vertex[0].v = texture[tmp].v;
}
if (fv111 != -1)
{
tmp = fv111 - 1;
obj.normal[iFace].vertex[0].x = normal[tmp].x;
obj.normal[iFace].vertex[0].y = normal[tmp].y;
obj.normal[iFace].vertex[0].z = normal[tmp].z;
}

tmp = fv2 - 1;
obj.triangle[iFace].vertex[1].x = vert[tmp].x;
obj.triangle[iFace].vertex[1].y = vert[tmp].y;
obj.triangle[iFace].vertex[1].z = vert[tmp].z;

if (fv22 != -1)
{
tmp = fv22 - 1;
obj.texture[iFace].vertex[1].u = texture[tmp].u;
obj.texture[iFace].vertex[1].v = texture[tmp].v;
}
if (fv222 != -1)
{
tmp = fv222 - 1;
obj.normal[iFace].vertex[1].x = normal[tmp].x;
obj.normal[iFace].vertex[1].y = normal[tmp].y;
obj.normal[iFace].vertex[1].z = normal[tmp].z;
}

tmp = fv3 - 1;
obj.triangle[iFace].vertex[2].x = vert[tmp].x;
obj.triangle[iFace].vertex[2].y = vert[tmp].y;
obj.triangle[iFace].vertex[2].z = vert[tmp].z;

if (fv33 != -1)
{
tmp = fv33 - 1;
obj.texture[iFace].vertex[2].u = texture[tmp].u;
obj.texture[iFace].vertex[2].v = texture[tmp].v;
}
if (fv333 != -1)
{
tmp = fv333 - 1;
obj.normal[iFace].vertex[2].x = normal[tmp].x;
obj.normal[iFace].vertex[2].y = normal[tmp].y;
obj.normal[iFace].vertex[2].z = normal[tmp].z;
}

iFace++;
}
}
}
file.Close();
return obj;
}
}
}


2006/4/24, Jessy Kang &lt;<A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">jessy.kang at gmail.com</A>&gt;:
&gt;<i> Dear All
</I>&gt;<i> Is there any good way to import cad model or other type of 3d model
</I>&gt;<i> (such as VRML or 3d studion max) to Tao.OpenGL codes?
</I>&gt;<i> I had hard time to find a good solution for this importing problem.
</I>&gt;<i> Jessy
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Tao-list mailing list
</I>&gt;<i> <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">Tao-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">http://galactus.ximian.com/mailman/listinfo/tao-list</A>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000453.html">[Tao-list] Import CAD model or other type of 3D model to Tao.OpenGL
</A></li>
	<LI>Next message: <A HREF="000456.html">[Tao-list] Tao.ode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#455">[ date ]</a>
              <a href="thread.html#455">[ thread ]</a>
              <a href="subject.html#455">[ subject ]</a>
              <a href="author.html#455">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://galactus.ximian.com/mailman/listinfo/tao-list">More information about the Tao-list
mailing list</a><br>
</body></html>
