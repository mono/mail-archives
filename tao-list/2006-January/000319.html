<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Tao-list] RE: Stereo Support
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tao-list%40lists.ximian.com?Subject=%5BTao-list%5D%20RE%3A%20Stereo%20Support&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000318.html">
   <LINK REL="Next"  HREF="000320.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tao-list] RE: Stereo Support</H1>
    <B>Gardner, Kelley</B> 
    <A HREF="mailto:tao-list%40lists.ximian.com?Subject=%5BTao-list%5D%20RE%3A%20Stereo%20Support&In-Reply-To="
       TITLE="[Tao-list] RE: Stereo Support">Kelley.Gardner at joslin.harvard.edu
       </A><BR>
    <I>Thu Jan 12 15:14:06 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000318.html">[Tao-list] RE: Stereo Support
</A></li>
        <LI>Next message: <A HREF="000320.html">[Tao-list] Tao.PhysFs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#319">[ date ]</a>
              <a href="thread.html#319">[ thread ]</a>
              <a href="subject.html#319">[ subject ]</a>
              <a href="author.html#319">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I originally tried a single buffer with the same results. However you
are also right that since I'm drawing to the front buffers they should
just show up. In fact an image *does* display, its just not in stereo.
Plus the emitter does not come on (always a tell-tale sign). I will try
wglSwapLayerBuffers anyway.

I have the prototype I originally wrote 6 years ago in VB6 using the
vbogl.tlb type library that I'm running side-by-side with this. It
actually uses SetPixelFormat and then GetPixelFormat to make sure
PFD_STEREO is set. This is still working as expected. However I made the
move to Glut for the .NET prototype, so perhaps the problem is there. Or
perhaps I will try SetPixelFormat again, although I as noted originally
the Tao documentation says that PFD_STEREO is not supported...

Anyway, thanks for the suggestions

_k


W. Kelley Gardner
Associate Director of Technology
Joslin Vision Network
Joslin Diabetes Center

Email: <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">kelley.gardner at joslin.harvard.edu</A>

-----Original Message-----
From: Eric Zeitler [mailto:<A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">ezeitler at psl.nmsu.edu</A>] 
Sent: Thursday, January 12, 2006 2:58 PM
To: Gardner, Kelley
Cc: <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">tao-list at lists.ximian.com</A>
Subject: Re: [Tao-list] RE: Stereo Support

Since you're using double-buffering, you need to do a
wglSwapLayerBuffers(hdc, WGL_SWAP_MAIN_PLANE);  to get the front and
back planes to swap (you are rendering to the front buffer though so it
should just show up).  If you can get a double-buffered regular OpenGL
window to draw, it should be a matter of rendering once to the left then
right buffers as your code has.  One additional thing to check is
whether the PFD you are requesting is actually supported, some
combinations of settings are not possible depending on the hardware and
driver revision.  I've seen some early nVidia driver revisions balk at
granting 24-bit depth-buffer without an 8-bit stencil-buffer since it
had to have a packed 32-bit buffer with the GeForce 2, though they now
will just pad it automatically.

Gardner, Kelley wrote:
&gt;<i> thanks for replying...
</I>&gt;<i>
</I>&gt;<i> first off, sorry for posting that question to list three times...I was
</I>
&gt;<i> getting a response from the list server (something about spam bounce) 
</I>&gt;<i> that lead me to believe the post was not getting through...
</I>&gt;<i>
</I>&gt;<i> Anyway, I first posted my question to see whether or not stereo was 
</I>&gt;<i> indeed &quot;supported&quot; (I guess exposed is the more proper word). I've 
</I>&gt;<i> since gone on and implement a simply example using glutInitDisplayMode
</I>
&gt;<i> as opposed to SetPixelFormat as I've done previously. Unfortunately 
</I>&gt;<i> this did not work, but I'm not through looking at it just yet.
</I>&gt;<i>
</I>&gt;<i> You mention using Wgl extensions to switch buffers. Currently I'm just
</I>
&gt;<i> using glDrawBuffer as I did before. Is there something I should be 
</I>&gt;<i> using instead?
</I>&gt;<i>
</I>&gt;<i> I've attached my small VB.NET prototype. Perhaps someone will see 
</I>&gt;<i> something...
</I>&gt;<i>
</I>&gt;<i> rgds,
</I>&gt;<i> _kelley
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> W. Kelley Gardner
</I>&gt;<i> Associate Director of Technology
</I>&gt;<i> Joslin Vision Network
</I>&gt;<i> Joslin Diabetes Center
</I>&gt;<i>
</I>&gt;<i> Email: <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">kelley.gardner at joslin.harvard.edu</A>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Eric Zeitler [mailto:<A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">ezeitler at psl.nmsu.edu</A>]
</I>&gt;<i> Sent: Thursday, January 12, 2006 1:14 PM
</I>&gt;<i> To: Gardner, Kelley
</I>&gt;<i> Cc: <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">tao-list at lists.ximian.com</A>
</I>&gt;<i> Subject: Re: [Tao-list] RE: Stereo Support
</I>&gt;<i>
</I>&gt;<i> I have seen three of your posts, perhaps no one knows anything about 
</I>&gt;<i> stereo viewing in OpenGL.  From looking over some documents about 
</I>&gt;<i> stereo support and the Tao sources it seems Tao has bindings for the 
</I>&gt;<i> Gdi components required to set up a PFD that support stereo, and the 
</I>&gt;<i> Wgl extensions to switch between the left anf right buffers.  Maybe 
</I>&gt;<i> you can clarify the issue you are having or is it just that the 
</I>&gt;<i> documentation says it's not supported?
</I>&gt;<i>
</I>&gt;<i> Gardner, Kelley wrote:
</I>&gt;<i>   
</I>&gt;&gt;<i> this is my third attempt to post to this list...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _k
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;&gt;<i>     
</I>&gt;&gt;&gt;<i> _____________________________________________ 
</I>&gt;&gt;&gt;<i> From: 	Gardner, Kelley  
</I>&gt;&gt;&gt;<i> Sent:	Monday, January 09, 2006 4:03 PM
</I>&gt;&gt;&gt;<i> To:	'<A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">tao-list at lists.ximian.com</A>'
</I>&gt;&gt;&gt;<i> Subject:	Stereo Support
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> (It would appear my last post was bounced as Spam? trying again...)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hi - I note in the documentation that the current implementation of 
</I>&gt;&gt;&gt;<i> Tao does not support PFD_STEREO. I am trying to re-implement in .NET
</I>
&gt;&gt;&gt;<i> a simple stereo medical image viewer originally written (believe it 
</I>&gt;&gt;&gt;<i> or
</I>&gt;&gt;&gt;<i> not) in VB6. It would appear OpenGL is still the only way to do
</I>this.
&gt;&gt;&gt;<i> Is there a chance of implementing this feature in Tao in the near 
</I>&gt;&gt;&gt;<i> future? Any guidance is very much appreciated...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> rgds,
</I>&gt;&gt;&gt;<i> _kelley
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> W. Kelley Gardner
</I>&gt;&gt;&gt;<i> Associate Director of Technology
</I>&gt;&gt;&gt;<i> Joslin Vision Network
</I>&gt;&gt;&gt;<i> Joslin Diabetes Center
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Email: <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">kelley.gardner at joslin.harvard.edu</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;&gt;<i>       
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Tao-list mailing list
</I>&gt;&gt;<i> <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">Tao-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://galactus.ximian.com/mailman/listinfo/tao-list">http://galactus.ximian.com/mailman/listinfo/tao-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i>   
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i> --
</I>&gt;<i>
</I>&gt;<i> Imports System.Drawing
</I>&gt;<i> Imports System.Drawing.Imaging
</I>&gt;<i> Imports System.Runtime.InteropServices Imports Tao.OpenGl Imports 
</I>&gt;<i> Tao.FreeGlut
</I>&gt;<i>
</I>&gt;<i> Module Module1
</I>&gt;<i>
</I>&gt;<i>     Private m_oLeftBitmap As New Bitmap(&quot;c:\nvd_left.jpg&quot;)
</I>&gt;<i>     Private m_oRightBitmap As New Bitmap(&quot;c:\nvd_right.jpg&quot;)
</I>&gt;<i>     Private m_aLeftbyPixels() As Byte
</I>&gt;<i>     Private m_aRightbyPixels() As Byte
</I>&gt;<i>
</I>&gt;<i>     Public Sub Main()
</I>&gt;<i>
</I>&gt;<i>         Dim oRectBounds As Rectangle
</I>&gt;<i>         Dim oBitmapData As BitmapData
</I>&gt;<i>         Dim iTotalSize As Integer
</I>&gt;<i>
</I>&gt;<i>         oRectBounds = New Rectangle(0, 0, m_oLeftBitmap.Width,
</I>m_oLeftBitmap.Height)
&gt;<i>         oBitmapData = m_oLeftBitmap.LockBits(oRectBounds,
</I>Imaging.ImageLockMode.ReadWrite, Imaging.PixelFormat.Format24bppRgb)
&gt;<i>         iTotalSize = oBitmapData.Stride * oBitmapData.Height
</I>&gt;<i>         ReDim m_aLeftbyPixels(iTotalSize)
</I>&gt;<i>         Marshal.Copy(oBitmapData.Scan0, m_aLeftbyPixels, 0, 
</I>&gt;<i> iTotalSize)
</I>&gt;<i>
</I>&gt;<i>         oRectBounds = New Rectangle(0, 0, m_oRightBitmap.Width,
</I>m_oRightBitmap.Height)
&gt;<i>         oBitmapData = m_oRightBitmap.LockBits(oRectBounds,
</I>Imaging.ImageLockMode.ReadWrite, Imaging.PixelFormat.Format24bppRgb)
&gt;<i>         iTotalSize = oBitmapData.Stride * oBitmapData.Height
</I>&gt;<i>         ReDim m_aRightbyPixels(iTotalSize)
</I>&gt;<i>         Marshal.Copy(oBitmapData.Scan0, m_aRightbyPixels, 0, 
</I>&gt;<i> iTotalSize)
</I>&gt;<i>
</I>&gt;<i>         Glut.glutInit()
</I>&gt;<i>         Glut.glutInitDisplayMode(Glut.GLUT_DOUBLE Or Glut.GLUT_RGB Or
</I>Glut.GLUT_DEPTH Or Glut.GLUT_STEREO)
&gt;<i>         Glut.glutInitWindowSize(640, 480)
</I>&gt;<i>         'Glut.glutInitWindowPosition(1920, 200)
</I>&gt;<i>         Glut.glutCreateWindow(&quot;StereoViewer.NET&quot;)
</I>&gt;<i>         Glut.glutDisplayFunc(New Glut.DisplayCallback(AddressOf
</I>Display))
&gt;<i>         'Glut.glutFullScreen()
</I>&gt;<i>         Glut.glutMainLoop()
</I>&gt;<i>
</I>&gt;<i>     End Sub
</I>&gt;<i>
</I>&gt;<i>     Private Sub Display()
</I>&gt;<i>
</I>&gt;<i>         Dim PixelZoom As Single
</I>&gt;<i>         Dim ViewPort(3) As Integer
</I>&gt;<i>
</I>&gt;<i>         Gl.glGetIntegerv(Gl.GL_VIEWPORT, ViewPort)
</I>&gt;<i>
</I>&gt;<i>         Gl.glDrawBuffer(Gl.GL_FRONT_LEFT)
</I>&gt;<i>         Gl.glClearColor(0, 0, 0, 0)
</I>&gt;<i>         Gl.glClear(Gl.GL_COLOR_BUFFER_BIT)
</I>&gt;<i>         If (ViewPort(2) / m_oLeftBitmap.Width) &gt;= (ViewPort(3) /
</I>m_oLeftBitmap.Height) Then
&gt;<i>             PixelZoom = ViewPort(3) / m_oLeftBitmap.Height
</I>&gt;<i>         Else
</I>&gt;<i>             PixelZoom = ViewPort(2) / m_oLeftBitmap.Width
</I>&gt;<i>         End If
</I>&gt;<i>         Gl.glPixelZoom(PixelZoom, PixelZoom)
</I>&gt;<i>         Gl.glDrawPixels(m_oLeftBitmap.Width, m_oLeftBitmap.Height,
</I>Gl.GL_BGR_EXT, Gl.GL_UNSIGNED_BYTE, m_aLeftbyPixels)
&gt;<i>         Gl.glFlush()
</I>&gt;<i>
</I>&gt;<i>         Gl.glDrawBuffer(Gl.GL_FRONT_RIGHT)
</I>&gt;<i>         Gl.glClearColor(0, 0, 0, 0)
</I>&gt;<i>         Gl.glClear(Gl.GL_COLOR_BUFFER_BIT)
</I>&gt;<i>         If (ViewPort(2) / m_oRightBitmap.Width) &gt;= (ViewPort(3) /
</I>m_oRightBitmap.Height) Then
&gt;<i>             PixelZoom = ViewPort(3) / m_oRightBitmap.Height
</I>&gt;<i>         Else
</I>&gt;<i>             PixelZoom = ViewPort(2) / m_oRightBitmap.Width
</I>&gt;<i>         End If
</I>&gt;<i>         Gl.glPixelZoom(PixelZoom, PixelZoom)
</I>&gt;<i>         Gl.glDrawPixels(m_oRightBitmap.Width, m_oRightBitmap.Height,
</I>Gl.GL_BGR_EXT, Gl.GL_UNSIGNED_BYTE, m_aRightbyPixels)
&gt;<i>         Gl.glFlush()
</I>&gt;<i>
</I>&gt;<i>     End Sub
</I>&gt;<i>
</I>&gt;<i> End Module
</I>&gt;<i>   
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000318.html">[Tao-list] RE: Stereo Support
</A></li>
	<LI>Next message: <A HREF="000320.html">[Tao-list] Tao.PhysFs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#319">[ date ]</a>
              <a href="thread.html#319">[ thread ]</a>
              <a href="subject.html#319">[ subject ]</a>
              <a href="author.html#319">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://galactus.ximian.com/mailman/listinfo/tao-list">More information about the Tao-list
mailing list</a><br>
</body></html>
