<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Tao-list] SOLUTION to glSelectBuffer sometimes returns empty
	buffer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tao-list%40lists.ximian.com?Subject=%5BTao-list%5D%20SOLUTION%20to%20glSelectBuffer%20sometimes%20returns%20empty%0A%09buffer&In-Reply-To=837db430603050646g1ffe6b37k18f7e002b0868575%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000381.html">
   <LINK REL="Next"  HREF="000382.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tao-list] SOLUTION to glSelectBuffer sometimes returns empty
	buffer</H1>
    <B>renexxl</B> 
    <A HREF="mailto:tao-list%40lists.ximian.com?Subject=%5BTao-list%5D%20SOLUTION%20to%20glSelectBuffer%20sometimes%20returns%20empty%0A%09buffer&In-Reply-To=837db430603050646g1ffe6b37k18f7e002b0868575%40mail.gmail.com"
       TITLE="[Tao-list] SOLUTION to glSelectBuffer sometimes returns empty
	buffer">renexxl at renderguru.com
       </A><BR>
    <I>Tue Mar 14 03:36:04 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000381.html">[Tao-list] SOLUTION to glSelectBuffer sometimes returns empty buffer
</A></li>
        <LI>Next message: <A HREF="000382.html">[Tao-list] I've found a bug - please confirm it
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#395">[ date ]</a>
              <a href="thread.html#395">[ thread ]</a>
              <a href="subject.html#395">[ subject ]</a>
              <a href="author.html#395">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Hugh!

I had the same problem and use the following solution.

The problem occurs cause the managed array is moved on the garbage collected
heap by the
garbage collector. So you have to assert that this case does not happen. I
use the class GCHandle from namespace System.Runtime.InteropServices that is
able to pin a managed object.

int size = ...;
int[] buffer = new int[size];
GCHandle handle = GCHandle.Alloc(buffer, GCHandleType.Pinned);
Gl.glSelectBuffer(size, buffer);
...
int hits = Gl.glRenderMode(Gl.GL_RENDER);
handle.Free();

It is important to call the method Free() when the array is no longer needed
by OpenGL cause the handle also prevents that the buffer is garbage
collected. Not calling Free() will cause a memory leak!
After calling Free() you can use the buffer on the managed side but not on
the unmanaged side (OpenGL) anymore.

- Rene
--
View this message in context: <A HREF="http://www.nabble.com/SOLUTION-to-glSelectBuffer-sometimes-returns-empty-buffer-t1228476.html#a3392839">http://www.nabble.com/SOLUTION-to-glSelectBuffer-sometimes-returns-empty-buffer-t1228476.html#a3392839</A>
Sent from the Mono - TAO forum at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000381.html">[Tao-list] SOLUTION to glSelectBuffer sometimes returns empty buffer
</A></li>
	<LI>Next message: <A HREF="000382.html">[Tao-list] I've found a bug - please confirm it
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#395">[ date ]</a>
              <a href="thread.html#395">[ thread ]</a>
              <a href="subject.html#395">[ subject ]</a>
              <a href="author.html#395">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://galactus.ximian.com/mailman/listinfo/tao-list">More information about the Tao-list
mailing list</a><br>
</body></html>
