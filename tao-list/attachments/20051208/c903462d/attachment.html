<tt>
Hi&nbsp;there!&lt;br&gt;<br>
&lt;br&gt;<br>
I'm&nbsp;fairly&nbsp;new&nbsp;to&nbsp;Tao,&nbsp;and&nbsp;am&nbsp;using&nbsp;it&nbsp;primarily&nbsp;for&nbsp;the&nbsp;Sdl&nbsp;wrapper.&nbsp;I'm&nbsp;in&nbsp;C#.&lt;br&gt;<br>
&lt;br&gt;<br>
Now&nbsp;I&nbsp;want&nbsp;to&nbsp;load&nbsp;images&nbsp;into&nbsp;Sdl's&nbsp;surfaces.&nbsp;I'm&nbsp;using&nbsp;.gif&nbsp;for&nbsp;my<br>
pixel-animation&nbsp;based&nbsp;game,&nbsp;so&nbsp;that&nbsp;format&nbsp;is&nbsp;preferable&nbsp;from&nbsp;my&nbsp;side,<br>
and&nbsp;also&nbsp;I'd&nbsp;like&nbsp;to&nbsp;read&nbsp;them&nbsp;from&nbsp;memory&nbsp;(I'm&nbsp;using&nbsp;binary&nbsp;archive<br>
files&nbsp;instead&nbsp;of&nbsp;the&nbsp;file&nbsp;system.).&nbsp;All&nbsp;8-bits.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;method&nbsp;I've&nbsp;come&nbsp;up&nbsp;with&nbsp;so&nbsp;far&nbsp;is&nbsp;quite&nbsp;complicated,&nbsp;and&nbsp;as&nbsp;you<br>
might&nbsp;image&nbsp;after&nbsp;reading&nbsp;this,&nbsp;quite&nbsp;slow.&nbsp;The&nbsp;reason&nbsp;for&nbsp;the<br>
complication&nbsp;is&nbsp;because&nbsp;I&nbsp;want&nbsp;to&nbsp;avoid&nbsp;unsafe&nbsp;code&nbsp;sections.&nbsp;Also,&nbsp;I<br>
don't&nbsp;exactly&nbsp;know&nbsp;how&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;of&nbsp;C#&nbsp;work,&nbsp;and&nbsp;how&nbsp;I<br>
make&nbsp;sure&nbsp;sdl&nbsp;doesn't&nbsp;garble&nbsp;up&nbsp;when&nbsp;I&nbsp;throw&nbsp;in&nbsp;an&nbsp;IntPtr&nbsp;(or&nbsp;that<br>
pointer's&nbsp;heap&nbsp;space&nbsp;being&nbsp;reclaimed&nbsp;by&nbsp;the&nbsp;GC).&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;bear&nbsp;with&nbsp;me&nbsp;---&lt;br&gt;<br>
&lt;br&gt;<br>
1.&nbsp;To&nbsp;begin&nbsp;with,&nbsp;I&nbsp;have&nbsp;the&nbsp;.gif&nbsp;file&nbsp;loaded&nbsp;into&nbsp;a&nbsp;byte[]&nbsp;called&nbsp;'bytes'.&nbsp;Nothing&nbsp;strange&nbsp;here,&nbsp;and&nbsp;it's&nbsp;fast.&lt;br&gt;<br>
&lt;br&gt;<br>
2.&nbsp;I&nbsp;use&nbsp;Tao.DevIL&nbsp;to&nbsp;decode&nbsp;'bytes'&nbsp;to&nbsp;image&nbsp;number&nbsp;1.&nbsp;This&nbsp;is&nbsp;fast&nbsp;too.&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Il.ilBindImage(1);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Il.ilLoadL(Il.IL_GIF,&nbsp;bytes,&nbsp;bytes.Length);&lt;br&gt;<br>
&lt;br&gt;<br>
3.&nbsp;Find&nbsp;out&nbsp;the&nbsp;bitmap&nbsp;dimensions&nbsp;via&nbsp;DevIL:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;w&nbsp;=&nbsp;Il.ilGetInteger(Il.IL_IMAGE_WIDTH);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;h&nbsp;=&nbsp;Il.ilGetInteger(Il.IL_IMAGE_HEIGHT);&lt;br&gt;<br>
&lt;br&gt;<br>
4.&nbsp;Gain&nbsp;access&nbsp;to&nbsp;the&nbsp;pixels&nbsp;of&nbsp;the&nbsp;read-in&nbsp;bitmap&nbsp;via&nbsp;DevIL's&nbsp;(an&nbsp;IntPtr)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;IntPtr&nbsp;pixels&nbsp;=&nbsp;Il.ilGetData();&lt;br&gt;<br>
&lt;br&gt;<br>
5.&nbsp;In&nbsp;order&nbsp;to&nbsp;gain&nbsp;access&nbsp;to&nbsp;the&nbsp;actual&nbsp;8-bit&nbsp;bytes&nbsp;of&nbsp;the&nbsp;bitmap,&nbsp;I&nbsp;copy&nbsp;the&lt;br&gt;<br>
&amp;nbsp;&nbsp;actual&nbsp;bytes&nbsp;in&nbsp;'pixels'&nbsp;to&nbsp;another&nbsp;byte[]&nbsp;called&nbsp;'pixelarray'&nbsp;via&nbsp;C#'s&nbsp;Marshalling&nbsp;copy&nbsp;function.&lt;br&gt;<br>
&amp;nbsp;&nbsp;This&nbsp;should&nbsp;be&nbsp;reasonably&nbsp;fast&nbsp;too,&nbsp;given&nbsp;the&nbsp;built-in&nbsp;marshalling&nbsp;functions&nbsp;are&nbsp;fast,&nbsp;which&lt;br&gt;<br>
&amp;nbsp;&nbsp;they&nbsp;really&nbsp;should&nbsp;be.&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;byte[]&nbsp;pixelarray&nbsp;=&nbsp;new&nbsp;byte[w*h];&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Marshal.Copy(pixels,&nbsp;pixelarray,&nbsp;0,&nbsp;w*h);&lt;br&gt;<br>
&lt;br&gt;<br>
6.&nbsp;Now&nbsp;I'm&nbsp;ready&nbsp;to&nbsp;create&nbsp;the&nbsp;Sdl&nbsp;surface.&nbsp;Since&nbsp;I&nbsp;don't&nbsp;wanna&nbsp;hack&nbsp;around&nbsp;with&nbsp;byte*&nbsp;I&nbsp;simply&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;use&nbsp;Sdl's&nbsp;FillRect&nbsp;to&nbsp;blit&nbsp;the&nbsp;bytes&nbsp;of&nbsp;the&nbsp;loaded&nbsp;bitmap&nbsp;to&nbsp;the&nbsp;sdl&nbsp;surface:&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;IntPtr&nbsp;surface&nbsp;=&nbsp;Sdl.SDL_CreateRGBSurface(Sdl.SDL_SWSURFACE,&nbsp;w,&nbsp;h,&nbsp;8,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Sdl.SDL_Rect&nbsp;r&nbsp;=&nbsp;new&nbsp;Sdl.SDL_Rect(0,&nbsp;0,&nbsp;1,&nbsp;1);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;(short&nbsp;y&nbsp;=&nbsp;0;&nbsp;y&nbsp;&amp;lt;&nbsp;h;&nbsp;y++)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;(short&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&amp;lt;&nbsp;w;&nbsp;x++)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;r.x&nbsp;=&nbsp;x;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;r.y&nbsp;=&nbsp;y;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Sdl.SDL_FillRect(surface,&nbsp;ref&nbsp;r,&nbsp;pixelarray[w&nbsp;*&nbsp;y&nbsp;+&nbsp;x]);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;step&nbsp;is&nbsp;HORRIBLY&nbsp;slow&nbsp;-&nbsp;something&nbsp;like&nbsp;5&nbsp;seconds&nbsp;on&nbsp;my&nbsp;1.5GHz&nbsp;Pentium&nbsp;4.&lt;br&gt;<br>
&lt;br&gt;<br>
So,&nbsp;is&nbsp;there&nbsp;a&nbsp;faster&nbsp;way&nbsp;to&nbsp;load&nbsp;binar-embedded&nbsp;.gifs&nbsp;without&nbsp;using<br>
'unsafe'?&nbsp;May&nbsp;I&nbsp;safely&nbsp;assume&nbsp;using&nbsp;SDL_CreateRGBSurfaceFrom()&nbsp;will<br>
work&nbsp;with&nbsp;the&nbsp;IntPtr&nbsp;returned&nbsp;from&nbsp;DevIL,&nbsp;as&nbsp;long&nbsp;as&nbsp;I&nbsp;don't&nbsp;delete&nbsp;the<br>
DevIL&nbsp;bitmap?&lt;br&gt;<br>
&lt;br&gt;<br>
/Olof&lt;br&gt;<br>
&lt;br&gt;<br>

</tt>
