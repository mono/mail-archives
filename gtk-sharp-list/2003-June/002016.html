<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Rewriting Clipboard Manager in .NET
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:spamfrommailing%40freax.org">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002006.html">
   <LINK REL="Next"  HREF="002007.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Rewriting Clipboard Manager in .NET
   </H1>
    <B>Philip Van Hoof
    </B> 
    <A HREF="mailto:spamfrommailing%40freax.org"
       TITLE="[Gtk-sharp-list] Rewriting Clipboard Manager in .NET">spamfrommailing@freax.org
       </A><BR>
    <I>08 Jun 2003 12:05:05 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="002006.html">[Gtk-sharp-list] Rewriting Clipboard Manager in .NET
</A></li>
        <LI> Next message: <A HREF="002007.html">[Gtk-sharp-list] wird extra line
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2016">[ date ]</a>
              <a href="thread.html#2016">[ thread ]</a>
              <a href="subject.html#2016">[ subject ]</a>
              <a href="author.html#2016">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Bleh, looks like this is going to be a lot more difficult :-\

Almost &quot;nothing&quot; of Gtk.Clipboard works the way it should work 


I also don't how I can receive the &quot;TARGETS&quot; target and then for each
target extract the target-Atom out of the SelectionData.Data. In C I
could make a cast but mono tells me that it cannot cast nor find the
size of an unmanaged type.



Example:

The &quot;most&quot; simple version of getting the clipboard ...

public override void CollectCurrent ()
{
	this.clipboard = Clipboard.Get (Atom.Intern(&quot;CLIPBOARD&quot;, false));
	SelectionData clipboardtargets = this.clipboard.WaitForContents
		(Atom.Intern (&quot;COMPOUND_TEXT&quot;, false));
	System.Console.WriteLine(clipboardtargets.Data);

}

Gives this :

(./Bin/ClipboardManagerDaemon.exe:12136): Gtk-CRITICAL **: file
gtkclipboard.c: line 877 (gtk_clipboard_wait_for_contents): assertion
`clipboard != NULL' failed
 
Unhandled Exception: System.ArgumentNullException: Argument cannot be
null
Parameter name: src
in (unmanaged) /usr/lib/libmono.so.0(mono_raise_exception+0x20)
[0x400a51b6]
in (unmanaged) /usr/lib/libmono.so.0 [0x400babce]
in &lt;0x00014&gt; 00 System.Runtime.InteropServices.Marshal:Copy
(intptr,byte[],int,int)
in &lt;0x0003e&gt; 00 Gtk.SelectionData:get_Data ()
in &lt;0x000a6&gt; 00
Clipboard.Manager.Daemon.DefaultClipboardManager:CollectCurrent ()
in &lt;0x00047&gt; 00 Clipboard.Manager.Daemon.Daemon:.ctor ()
in &lt;0x00025&gt; 00 Clipboard.Manager.Daemon.Daemon:Main (string[])
 

So IMHO there is still &quot;a lot&quot; work to do :( 



There are also no Atom types like GDK_CLIPBOARD, GDK_PRIMARY .. so I
have to create each using Atom.Intern(&quot;CLIPBOARD&quot;, false) ... but I can
live with that :-\


bleh


-- 
Philip Van Hoof, Software Developer @ Cronos
home: me at freax dot org
work: Philip dot VanHoof at cronos dot be
<A HREF="http://www.freax.be,">http://www.freax.be,</A> <A HREF="http://www.freax.eu.org">http://www.freax.eu.org</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002006.html">[Gtk-sharp-list] Rewriting Clipboard Manager in .NET
</A></li>
	<LI> Next message: <A HREF="002007.html">[Gtk-sharp-list] wird extra line
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2016">[ date ]</a>
              <a href="thread.html#2016">[ thread ]</a>
              <a href="subject.html#2016">[ subject ]</a>
              <a href="author.html#2016">[ author ]</a>
         </LI>
       </UL>
</body></html>
