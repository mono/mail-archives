<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] IDisposable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:manyoso%40yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000293.html">
   <LINK REL="Next"  HREF="000295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] IDisposable
   </H1>
    <B>adam treat
    </B> 
    <A HREF="mailto:manyoso%40yahoo.com"
       TITLE="[Gtk-sharp-list] IDisposable">manyoso@yahoo.com
       </A><BR>
    <I>Wed, 4 Sep 2002 10:51:15 -0700 (PDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="000293.html">[Gtk-sharp-list] IDisposable
</A></li>
        <LI> Next message: <A HREF="000295.html">[Gtk-sharp-list] IDisposable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#294">[ date ]</a>
              <a href="thread.html#294">[ thread ]</a>
              <a href="subject.html#294">[ subject ]</a>
              <a href="author.html#294">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok, we tried to have the Dispose method unregister the objects in the hash, but there was a
problem with Monitor locking and the GC:

  ~Pixbuf ()
  {
    Dispose ();
  }

  Dispose ()
  {
    UnregisterObject ();
  }

This should work, but when the program thread tries to access the hash for introspection and the
GC also tries to access the hash, the program freezes, regardless whether it is lock()ed in both
threads.

--- Miguel de Icaza &lt;<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&gt; wrote:
&gt;<i> 
</I>&gt;<i> &gt; Right, but Dispose will never be called if the object is in the hash ;-)
</I>&gt;<i> 
</I>&gt;<i> Dispose is called by users of IDisposable, manually.
</I>&gt;<i> 
</I>&gt;<i> So I do things like:
</I>&gt;<i> 
</I>&gt;<i> 	Pixbuf p = new Pixbuf (&quot;a.png&quot;);
</I>&gt;<i> 	p.RenderToDrawable (...);
</I>&gt;<i> 	p.Dispose ();
</I>&gt;<i> 
</I>&gt;<i> You are thinking about ~Pixbuf () which is indeed never called if you
</I>&gt;<i> are not stored in a WeakReference
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Miguel
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Gtk-sharp-list maillist  -  <A HREF="mailto:Gtk-sharp-list@ximian.com">Gtk-sharp-list@ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">http://lists.ximian.com/mailman/listinfo/gtk-sharp-list</A>
</I>

__________________________________________________
Do You Yahoo!?
Yahoo! Finance - Get real-time stock quotes
<A HREF="http://finance.yahoo.com">http://finance.yahoo.com</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000293.html">[Gtk-sharp-list] IDisposable
</A></li>
	<LI> Next message: <A HREF="000295.html">[Gtk-sharp-list] IDisposable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#294">[ date ]</a>
              <a href="thread.html#294">[ thread ]</a>
              <a href="subject.html#294">[ subject ]</a>
              <a href="author.html#294">[ author ]</a>
         </LI>
       </UL>
</body></html>
