<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Versioning and Unstable Gtk#
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Versioning%20and%20Unstable%20Gtk%23&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006142.html">
   <LINK REL="Next"  HREF="006139.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Versioning and Unstable Gtk#</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Versioning%20and%20Unstable%20Gtk%23&In-Reply-To="
       TITLE="[Gtk-sharp-list] Versioning and Unstable Gtk#">bmaurer at ximian.com
       </A><BR>
    <I>Sun Jul 10 21:31:45 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="006142.html">[Gtk-sharp-list] gtk-sharp2 documentation
</A></li>
        <LI>Next message: <A HREF="006139.html">[Gtk-sharp-list] Versioning and Unstable Gtk#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6138">[ date ]</a>
              <a href="thread.html#6138">[ thread ]</a>
              <a href="subject.html#6138">[ subject ]</a>
              <a href="author.html#6138">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey guys,

I've been working with tseng, our fearless Ubuntu packager on packaging
Gtk# 2 apps. It looks like we are pretty clearly not going to be api
frozen soon enough to make it a good idea to ship Gtk# 2 in the GAC.

So, I suggested that we include a pre-release gtk# in the private bin
path for gtk# 2 apps (muine and monodevelop). However, when I was
thinking about this, I realized we had a little problem.

As documented on <A HREF="http://tinyurl.com/3y73k,">http://tinyurl.com/3y73k,</A> the runtime loads assemblies
from the GAC before it does private path probing. This is done for
performance reasons (it is more likely that code gets shared between
processes. Also, for non-gac'd strong named assemblies, the entire file
has to be read from disk to check the signature. With that gac this is
done at install time).

Right now, we ship pre-release gtk# assemblies with versions 2.4.0.0.
So, if somebody installs an ubuntu with Gtk# 2 (a pre release) in md's
private bin path, and later (after we release gtk# 2), installs the
final .dll files into the gac, when monodevelop is launched, the
final .dll files will be found by the runtime. However, these may have
api differences, and thus break MD.

I can think of three ways to make this situation not break:

1. Use different version numbers for pre-releases
--------------------------------------------------

In this solution, the .dll version of Gtk# would change on each
pre-release. Thus, the MD that is installed with ubuntu would bind to
2.3.4.0 (eg). When the user installs 2.4.0.0 in the gac, the older
assembly will still be loaded by the runtime.

For the final release, and all subsequent stable releases, the .dll
would have the version 2.4.0.0

Pros:
      * Easy for packagers (they just move the files into the bin path)
      * Makes packages of applications that depend on unstable gtk# less
        likely to break (because the rpm will code a dependency to the
        exact gtk# version and refuse to upgrade to newer pre-releases)

Cons:
      * Small pain for people working from svn: multiple copies of gtk#
        will get installed in their GAC.

2. Use a different version number for each release
---------------------------------------------------

Same as above, except that we continue the policy through stable
releases. We will have assemblies 2.4.1.0, 2.4.2.0

We would use publisher policies to make sure that no matter what stable
version of gtk# a program was built on, it would run on all others.

Pros:
      * In theory, would allow parallel installation of stable gtk#
        versions. Also, makes it easy for an application to demand a
        specific version of gtk#.

Cons:
      * Makes rpm dependencies a bit of a pain (the automated script
        that searches for dependencies would probably have trouble with
        this).

3. Force people shipping unstable versions of gtk# to rename the
assembly
-----------------------------------------------------------------

Probably the easiest way for a packager to do this would be to sign gtk#
with a different key. In the eyes of the runtime, this would mean that
the gtk#'s we ship would not match the library the application was
looking for. Thus it would use the one on the private path.

Pros:
      * Easy for us (no effort involved)

Cons:
      * Harder for packagers (they have to build custom gtk# versions)
      * Annoying for plugins (any MD plugin would have to compile with
        the custom gtk#)
      * Doesn't allow us to take advantage of the configuration options
        offered by the runtime

-- Ben

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006142.html">[Gtk-sharp-list] gtk-sharp2 documentation
</A></li>
	<LI>Next message: <A HREF="006139.html">[Gtk-sharp-list] Versioning and Unstable Gtk#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6138">[ date ]</a>
              <a href="thread.html#6138">[ thread ]</a>
              <a href="subject.html#6138">[ subject ]</a>
              <a href="author.html#6138">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
