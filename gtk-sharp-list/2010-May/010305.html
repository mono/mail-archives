<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] CallingConvention.Cdecl is not on	every	DllImport's in Gtk#
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20CallingConvention.Cdecl%20is%20not%20on%0A%09every%09DllImport%27s%20in%20Gtk%23&In-Reply-To=4BFC2EA6.4090405%40gmx.at">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010304.html">
   <LINK REL="Next"  HREF="010306.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] CallingConvention.Cdecl is not on	every	DllImport's in Gtk#</H1>
    <B>Christian Hoff</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20CallingConvention.Cdecl%20is%20not%20on%0A%09every%09DllImport%27s%20in%20Gtk%23&In-Reply-To=4BFC2EA6.4090405%40gmx.at"
       TITLE="[Gtk-sharp-list] CallingConvention.Cdecl is not on	every	DllImport's in Gtk#">Christian_Hoff at gmx.net
       </A><BR>
    <I>Wed May 26 15:27:26 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010304.html">[Gtk-sharp-list] CallingConvention.Cdecl is not on every DllImport's in Gtk#
</A></li>
        <LI>Next message: <A HREF="010306.html">[Gtk-sharp-list] Ubuntu: Warning: The reference 'atk-sharp, Version=2.12.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f' is not valid for the target framework of the project.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10305">[ date ]</a>
              <a href="thread.html#10305">[ thread ]</a>
              <a href="subject.html#10305">[ subject ]</a>
              <a href="author.html#10305">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-------- Original message --------
&gt;<i> Date: Tue, 25 May 2010 22:10:14 +0200
</I>&gt;<i> From: Ulrich Buchgraber &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">ulrich.b at gmx.at</A>&gt;
</I>&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">gtk-sharp-list at lists.ximian.com</A>
</I>&gt;<i> Betreff: [Gtk-sharp-list] CallingConvention.Cdecl is not on every	DllImport\'s in Gtk#
</I>
&gt;<i> Why are there not all [DllImport()]'s in the Gtk# sources flagged with
</I>&gt;<i> theCallingConvention.Cdecl attribute?
</I>
Originally we specified the Cdecl calling convention only for callbacks. After 2.12 we added the attribute also for all DllImports.

The default StdCall works just fine when calling native code via DllImports with the exception that it produces a memory leak since the caller(Gtk#) is expected to free the stack, which it does not do because .net assumes StdCall and therefore that Gtk+ will clean the stack.

We used a regular expression to add the Cdecl attribute back then, so either the RegEx was wrong and did not catch all the dll imports or the import has been added afterwards and the Cdecl attribute has simply been forgotten.
&gt;<i> 
</I>&gt;<i> For example the dll import of the function
</I>&gt;<i> &quot;g_spawn_async_with_pipes_utf8()&quot; ingtk-sharp/glib/Spawn.cs in line 146 (current SVN trunk).
</I>&gt;<i> 
</I>&gt;<i> And there are really many dll imports where the CallingConvention.Cdecl
</I>&gt;<i> flagis missing.
</I>
Could you please file a bug report (www.mono-project.com/Bugs) for this? Of course, we would also very much appreciate a patch as we are somewhat short-handed and it is unlikely that we will have the time to fix this soon :-).
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> KR, Ulrich
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Gtk-sharp-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">Gtk-sharp-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">http://lists.ximian.com/mailman/listinfo/gtk-sharp-list</A>
</I>
-- 
GRATIS f&#252;r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
Jetzt freischalten unter <A HREF="http://portal.gmx.net/de/go/maxdome01">http://portal.gmx.net/de/go/maxdome01</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010304.html">[Gtk-sharp-list] CallingConvention.Cdecl is not on every DllImport's in Gtk#
</A></li>
	<LI>Next message: <A HREF="010306.html">[Gtk-sharp-list] Ubuntu: Warning: The reference 'atk-sharp, Version=2.12.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f' is not valid for the target framework of the project.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10305">[ date ]</a>
              <a href="thread.html#10305">[ thread ]</a>
              <a href="subject.html#10305">[ subject ]</a>
              <a href="author.html#10305">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
