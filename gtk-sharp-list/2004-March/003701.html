<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] conditionally compile docs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jluke%40users.sourceforge.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003700.html">
   <LINK REL="Next"  HREF="003721.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] conditionally compile docs
   </H1>
    <B>John Luke
    </B> 
    <A HREF="mailto:jluke%40users.sourceforge.net"
       TITLE="[Gtk-sharp-list] conditionally compile docs">jluke@users.sourceforge.net
       </A><BR>
    <I>Wed, 24 Mar 2004 15:30:37 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="003700.html">[Gtk-sharp-list] Re: 2.8 Platform Bindings - invitation
</A></li>
        <LI> Next message: <A HREF="003721.html">[Gtk-sharp-list] conditionally compile docs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3701">[ date ]</a>
              <a href="thread.html#3701">[ thread ]</a>
              <a href="subject.html#3701">[ subject ]</a>
              <a href="author.html#3701">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-090vqotbuNdGYoMHbziA
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hello,
	Attached is a patch to conditionally compile and install the docs if
you already have monodoc installed.  Ok to commit?

--=-090vqotbuNdGYoMHbziA
Content-Disposition: attachment; filename=monodoc.diff
Content-Type: text/x-diff; name=monodoc.diff; charset=UTF-8
Content-Transfer-Encoding: 7bit

? monodoc.diff
Index: ChangeLog
===================================================================
RCS file: /cvs/public/gtk-sharp/ChangeLog,v
retrieving revision 1.710
diff -u -r1.710 ChangeLog
--- ChangeLog	24 Mar 2004 19:38:29 -0000	1.710
+++ ChangeLog	24 Mar 2004 19:57:35 -0000
@@ -2,6 +2,12 @@
 
 	* samples/gconf/Makefile.am:
 	changes SOURCES to FILES to make automake 1.8 happy
+	* configure.in: check for 'monodoc' in path and conditionally
+	set ENABLE_MONODOC, output doc/Makefile
+	* Makefile.am: add doc to SUBDIRS
+	* doc/Makefile.am: conditionally build and install docs base on
+	ENABLE_MONODOC conditional, use monodoc --assemble and --update
+	* doc/makefile: move to Makefile.am
 
 2003-03-24  Jorn Baayen  &lt;<A HREF="mailto:jorn@nl.linux.org">jorn@nl.linux.org</A>&gt;
 
Index: Makefile.am
===================================================================
RCS file: /cvs/public/gtk-sharp/Makefile.am,v
retrieving revision 1.1
diff -u -r1.1 Makefile.am
--- Makefile.am	12 Mar 2004 21:18:05 -0000	1.1
+++ Makefile.am	24 Mar 2004 19:57:35 -0000
@@ -1,4 +1,4 @@
-SUBDIRS = sources generator parser glib pango atk gdk gtk glade art gnome gda gnomedb gtkhtml gconf rsvg vte sample
+SUBDIRS = sources generator parser glib pango atk gdk gtk glade art gnome gda gnomedb gtkhtml gconf rsvg vte sample doc
 
 pkgconfigdir = $(libdir)/pkgconfig
 pkgconfig_DATA = gtk-sharp.pc
Index: configure.in
===================================================================
RCS file: /cvs/public/gtk-sharp/configure.in,v
retrieving revision 1.50
diff -u -r1.50 configure.in
--- configure.in	22 Mar 2004 06:23:07 -0000	1.50
+++ configure.in	24 Mar 2004 19:57:35 -0000
@@ -150,6 +150,13 @@
 AC_SUBST(BASE_DEPENDENCIES_CFLAGS)
 AC_SUBST(BASE_DEPENDENCIES_LIBS)
 
+AC_PATH_PROG(MONODOC, monodoc, no)
+if test &quot;x$MONODOC&quot; = &quot;xno&quot; ; then
+enable_monodoc=&quot;no&quot;
+else
+enable_monodoc=&quot;yes&quot;
+fi
+
 AM_CONDITIONAL(ENABLE_LIBART, test &quot;x$enable_libart&quot; = &quot;xyes&quot;)
 AM_CONDITIONAL(ENABLE_GNOME, test &quot;x$enable_gnome&quot; = &quot;xyes&quot;)
 AM_CONDITIONAL(ENABLE_GLADE, test &quot;x$enable_glade&quot; = &quot;xyes&quot;)
@@ -158,6 +165,7 @@
 AM_CONDITIONAL(ENABLE_RSVG, test &quot;x$enable_rsvg&quot; = &quot;xyes&quot;)
 AM_CONDITIONAL(ENABLE_GTKHTML, test &quot;x$enable_gtkhtml&quot; = &quot;xyes&quot;)
 AM_CONDITIONAL(ENABLE_VTE, test &quot;x$enable_vte&quot; = &quot;xyes&quot;)
+AM_CONDITIONAL(ENABLE_MONODOC, test &quot;x$enable_monodoc&quot; = &quot;xyes&quot;)
 
 
 AC_SUBST(CFLAGS)
@@ -168,6 +176,7 @@
 parser/GAPI/Makefile
 generator/Makefile
 generator/gapi-codegen
+doc/Makefile
 glib/Makefile
 glib/glue/Makefile
 pango/Makefile
@@ -227,4 +236,3 @@
 echo &quot;            autogen.sh to include them in the build.&quot;
 echo &quot;&quot;
 echo &quot;---&quot;
-
Index: doc/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/doc/.cvsignore,v
retrieving revision 1.2
diff -u -r1.2 .cvsignore
--- doc/.cvsignore	6 Aug 2003 11:28:39 -0000	1.2
+++ doc/.cvsignore	24 Mar 2004 19:57:35 -0000
@@ -1,3 +1,5 @@
 gtk-sharp-docs.zip
 gtk-sharp-docs.tree
 tmp
+Makefile
+Makefile.in
Index: doc/Makefile.am
===================================================================
RCS file: doc/Makefile.am
diff -N doc/Makefile.am
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ doc/Makefile.am	24 Mar 2004 19:57:35 -0000
@@ -0,0 +1,26 @@
+ASSEMBLER = monodoc --assemble
+UPDATER = monodoc --update
+DIRS = glib pango atk gdk gtk glade art gnome gda gnomedb gconf/GConf gconf/GConf.PropertyEditors rsvg gtkhtml
+
+if ENABLE_MONODOC
+
+all: gtk-sharp-docs.zip gtk-sharp-docs.tree
+
+gtk-sharp-docs.zip gtk-sharp-docs.tree: en/*/*.xml en/*.xml
+	$(ASSEMBLER) --ecma en -o gtk-sharp-docs
+
+update:
+	for i in $(DIRS); do                    		\
+		$(UPDATER) ../$$i/*.dll -o ./en -f || exit 1;	\
+        done
+
+install-data-local: gtk-sharp-docs.zip gtk-sharp-docs.tree 
+	install -m 644 gtk-sharp-docs.zip gtk-sharp-docs.tree `monodoc --get-sourcesdir`
+	install -m 644 gtk-sharp-docs.source `monodoc --get-sourcesdir`
+
+endif
+
+CLEANFILES = gtk-sharp-docs.zip gtk-sharp-docs.tree
+
+EXTRA_DIST = gtk-sharp-docs.source
+
Index: doc/makefile
===================================================================
RCS file: doc/makefile
diff -N doc/makefile
--- doc/makefile	28 Oct 2003 00:47:57 -0000	1.24
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,26 +0,0 @@
-prefix=/usr
-BROWSER=../../monodoc/browser/browser.exe
-ASSEMBLER=../../monodoc/browser/assembler.exe
-UPDATER=../../monodoc/generator/updater.exe
-DIRS=glib pango atk gdk gtk glade art gnome gda gnomedb gconf/GConf gconf/GConf.PropertyEditors rsvg gtkhtml
-
-all: gtk-sharp-docs.zip gtk-sharp-docs.tree
-
-b:
-	mono --debug $(BROWSER)
-
-gtk-sharp-docs.zip gtk-sharp-docs.tree: en/*/*.xml en/*.xml
-	mono $(ASSEMBLER) --ecma en -o gtk-sharp-docs
-
-update:
-	for i in $(DIRS); do                    		\
-		mono --debug $(UPDATER) ../$$i/*.dll -o ./en -f || exit 1;	\
-        done
-
-install: gtk-sharp-docs.zip gtk-sharp-docs.tree 
-	install -m 644 gtk-sharp-docs.zip gtk-sharp-docs.tree `monodoc --get-sourcesdir`
-	install -m 644 gtk-sharp-docs.source `monodoc --get-sourcesdir`
-
-clean:
-	rm -f *.tree
-	rm -f *zip

--=-090vqotbuNdGYoMHbziA--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003700.html">[Gtk-sharp-list] Re: 2.8 Platform Bindings - invitation
</A></li>
	<LI> Next message: <A HREF="003721.html">[Gtk-sharp-list] conditionally compile docs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3701">[ date ]</a>
              <a href="thread.html#3701">[ thread ]</a>
              <a href="subject.html#3701">[ subject ]</a>
              <a href="author.html#3701">[ author ]</a>
         </LI>
       </UL>
</body></html>
