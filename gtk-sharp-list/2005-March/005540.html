<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] System.InvalidCastException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:paulo.pires%40vodafone.pt">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="005539.html">
   <LINK REL="Next"  HREF="005541.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] System.InvalidCastException
   </H1>
    <B>Paulo Pires
    </B> 
    <A HREF="mailto:paulo.pires%40vodafone.pt"
       TITLE="[Gtk-sharp-list] System.InvalidCastException">paulo.pires@vodafone.pt
       </A><BR>
    <I>Tue, 15 Mar 2005 14:43:37 +0000</I>
    <P><UL>
        <LI> Previous message: <A HREF="005539.html">[Gtk-sharp-list] list and parameters
</A></li>
        <LI> Next message: <A HREF="005541.html">[Gtk-sharp-list] System.InvalidCastException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5540">[ date ]</a>
              <a href="thread.html#5540">[ thread ]</a>
              <a href="subject.html#5540">[ subject ]</a>
              <a href="author.html#5540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi list

this seems odd!

I'm still working around my Canvas, and what I couldn't do with
CanvasWidget, I'm doing with CanvasGroup. So, I've created an object,
wdgSemaphore, which derives from Gnome.CanvasGroup. So far, so good.

The problem appears when I handle my Canvas.CanvasEvent with the
following code:
&lt;code&gt;

private void OnCanvasEvent(object o, Gnome.CanvasEventArgs args)
	{
		Gdk.EventButton ev = new Gdk.EventButton (args.Event.Handle);
		
		Globals.LogLn(&quot;Type -&gt; &quot; + o.GetType());
		
		//Gnome.CanvasGroup item = (Gnome.CanvasGroup) o;
		wdgSemaphore item = (wdgSemaphore) o;
		
		Globals.LogLn(&quot;-&gt; &quot; + ev.Type);
		
		switch (ev.Type)
		{
			case Gdk.EventType.ButtonPress:
				if (ev.Button == 1) {
					remember_x = ev.X;
					remember_y = ev.Y;
				} else if (ev.Button == 3) {
					// destroy item and subsequent semaphore
					WorldToUI.RemoveSemaphore(item);
				}
				break;
				
			case Gdk.EventType.MotionNotify:
				Gdk.ModifierType state = (Gdk.ModifierType) ev.State;
				if ((state &amp; Gdk.ModifierType.Button1Mask) != 0)
				{
					double new_x = ev.X, new_y = ev.Y;
					item.Move (new_x - remember_x, new_y - remember_y);
					remember_x = new_x;
					remember_y = new_y;
				}
				break;
				
			case Gdk.EventType.EnterNotify:
				break;
				
			case Gdk.EventType.LeaveNotify:
				break;
		}
	}

&lt;/code&gt;

That Global.LogLn, is outputting the type of o and then the
Gdk.Event.Type, and here it follows:

(...)

Type -&gt; TrafficMan.wdgSemaphore
-&gt; MotionNotify
Type -&gt; TrafficMan.wdgSemaphore
-&gt; MotionNotify
Type -&gt; TrafficMan.wdgSemaphore
-&gt; MotionNotify
Type -&gt; TrafficMan.wdgSemaphore
-&gt; LeaveNotify
Type -&gt; Gnome.CanvasGroup

Unhandled Exception: System.InvalidCastException: Cannot cast from
source type to destination type.

(...)

What the hell is going on so that the type is changed on the Event?!

Hugs
Paulo Pires


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="005539.html">[Gtk-sharp-list] list and parameters
</A></li>
	<LI> Next message: <A HREF="005541.html">[Gtk-sharp-list] System.InvalidCastException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5540">[ date ]</a>
              <a href="thread.html#5540">[ thread ]</a>
              <a href="subject.html#5540">[ subject ]</a>
              <a href="author.html#5540">[ author ]</a>
         </LI>
       </UL>
</body></html>
