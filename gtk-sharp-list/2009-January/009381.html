<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Widget Background Color 'anomaly',	and request 	for further reading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Widget%20Background%20Color%20%27anomaly%27%2C%0A%09and%20request%20%09for%20further%20reading&In-Reply-To=49788EC8.7030906%40controlspecials.demon.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009376.html">
   <LINK REL="Next"  HREF="009382.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Widget Background Color 'anomaly',	and request 	for further reading</H1>
    <B>Michael Hutchinson</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Widget%20Background%20Color%20%27anomaly%27%2C%0A%09and%20request%20%09for%20further%20reading&In-Reply-To=49788EC8.7030906%40controlspecials.demon.co.uk"
       TITLE="[Gtk-sharp-list] Widget Background Color 'anomaly',	and request 	for further reading">m.j.hutchinson at gmail.com
       </A><BR>
    <I>Fri Jan 23 18:15:58 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="009376.html">[Gtk-sharp-list] Widget Background Color 'anomaly',	and request for further reading
</A></li>
        <LI>Next message: <A HREF="009382.html">[Gtk-sharp-list] Widget Background Color 'anomaly', and request 	for further reading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9381">[ date ]</a>
              <a href="thread.html#9381">[ thread ]</a>
              <a href="subject.html#9381">[ subject ]</a>
              <a href="author.html#9381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jan 22, 2009 at 10:20 AM, Hywel Thomas
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">hywel at controlspecials.demon.co.uk</A>&gt; wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I'm struggling to understand just which Background color Widgets are
</I>&gt;<i> drawn with, and how to get the current Background correctly.  In the
</I>&gt;<i> following example (taken roughly from the Gtk Example on the Mono site)
</I>&gt;<i> I need to save the current Background color of the Drawing Area, use a
</I>&gt;<i> specific value (black), then restore the original, eg
</I>&gt;<i>
</I>&gt;<i> ...(unnecessary code removed)....
</I>&gt;<i>
</I>&gt;<i> ColourExample()
</I>&gt;<i>     {
</I>&gt;<i>         win = new Window (&quot;Background Colour Example&quot;);
</I>&gt;<i>         win.SetDefaultSize (400, 300);
</I>&gt;<i>         win.BorderWidth = 24;  // to show parent's color clearly
</I>&gt;<i>
</I>&gt;<i>         da = new DrawingArea();
</I>&gt;<i>         da.ExposeEvent += OnExposed;
</I>&gt;<i>         win.Add (da);
</I>&gt;<i>
</I>&gt;<i>         Gdk.Color bg = da.Style.Backgrounds[(int)StateType.Normal]; // A
</I>&gt;<i>
</I>&gt;<i>        da.ModifyBg (StateType.Normal, new Gdk.Color(0,0,0));   // B
</I>&gt;<i>
</I>&gt;<i>        //da.ModifyBg(StateType.Normal, bg);    //  C
</I>&gt;<i>
</I>&gt;<i>        //win.ModifyBg(StateType.Normal, bg);   //  D
</I>&gt;<i>
</I>&gt;<i>        win.ShowAll ();
</I>&gt;<i>     }
</I>&gt;<i>     void OnExposed (object o, ExposeEventArgs args) {
</I>&gt;<i>         da.GdkWindow.DrawLine(da.Style.BaseGC(StateType.Normal),
</I>&gt;<i> 0, 0,                   352, 252);
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i> At line A I read the current Background color (or so I thought...), at
</I>&gt;<i> line B set up the new one, and let the ExposeEvent draw a line.This
</I>&gt;<i> works, with the set background color.  However, if I uncomment line C,
</I>&gt;<i> so that the original background is restored before drawing the line, I
</I>&gt;<i> see that the background is NOT the same as the parent's background. Line
</I>&gt;<i> A is obviously not the correct call to read the correct background, but
</I>&gt;<i> the documentation appears to suggest that this is the way.  If I also
</I>&gt;<i> uncomment line D, so that the parent's background is set to the same
</I>&gt;<i> value bg, both appear the same, but it is not the color that the window
</I>&gt;<i> and widget are originally drawn with. I can also get it to work if I use
</I>&gt;<i> a call to set the default background ( da.ModifyBg(StateType.Normal) ),
</I>&gt;<i> but I'd really like to be able to read this somehow.
</I>&gt;<i>
</I>&gt;<i> The other 'obvious' property for the widget Background is write-only
</I>&gt;<i> (why?) so this also won't read back the current value!
</I>&gt;<i>
</I>&gt;<i> I'd be grateful for any enlightenment, or references that I can follow
</I>&gt;<i> up, as I seem to have exhausted most avenues so far.
</I>
I took a look in the GTK+ docs, and I concur with your reading of the
Backgrounds array. However, from poking around in the GTK source, it
seems that widgets have a &quot;modifier style&quot; that has flags to indicate
which colours should override the base style. Unless you're using
these flags correctly, things may not work as you intend. The Modify*
methods handle correctly setting and unsetting all this for you, but I
don't see an obvious supported way to *read* the colour.

<A HREF="http://library.gnome.org/devel/gtk/stable/GtkWidget.html#gtk-widget-get-modifier-style">http://library.gnome.org/devel/gtk/stable/GtkWidget.html#gtk-widget-get-modifier-style</A>
<A HREF="http://svn.gnome.org/viewvc/gtk%2B/trunk/gtk/gtkwidget.c?view=markup">http://svn.gnome.org/viewvc/gtk%2B/trunk/gtk/gtkwidget.c?view=markup</A>

For advanced details like this, you'll probably have more luck on the
GTK+ lists.

-- 
Michael Hutchinson
<A HREF="http://mjhutchinson.com">http://mjhutchinson.com</A>
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009376.html">[Gtk-sharp-list] Widget Background Color 'anomaly',	and request for further reading
</A></li>
	<LI>Next message: <A HREF="009382.html">[Gtk-sharp-list] Widget Background Color 'anomaly', and request 	for further reading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9381">[ date ]</a>
              <a href="thread.html#9381">[ thread ]</a>
              <a href="subject.html#9381">[ subject ]</a>
              <a href="author.html#9381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
