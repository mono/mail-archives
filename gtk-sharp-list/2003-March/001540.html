<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] [patch] API fixes/bugs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gnome%40fonicmonkey.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001535.html">
   <LINK REL="Next"  HREF="001541.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] [patch] API fixes/bugs
   </H1>
    <B>Lee Mallabone
    </B> 
    <A HREF="mailto:gnome%40fonicmonkey.net"
       TITLE="[Gtk-sharp-list] [patch] API fixes/bugs">gnome@fonicmonkey.net
       </A><BR>
    <I>28 Mar 2003 08:08:17 +0000</I>
    <P><UL>
        <LI> Previous message: <A HREF="001535.html">[Gtk-sharp-list] (Newbie) Problem while trying gtksharp
</A></li>
        <LI> Next message: <A HREF="001541.html">[Gtk-sharp-list] Entry/Viewport tweaks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1540">[ date ]</a>
              <a href="thread.html#1540">[ thread ]</a>
              <a href="subject.html#1540">[ subject ]</a>
              <a href="author.html#1540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-gi4n5BVbfM00Gna7L4/n
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hi all,

I've been trying to fix API problems with Gtk#. I thought I'd start with
the bug report I made; #38660.

I've attached a patch that fixes a bug with GetLabelAlign() in 'Frame'
and most of the reported 'Widget' bugs.

However, there are strange things going on with 'ref' parameters. In
Widget.Intersect(), the parameters are marked as 'ref' in the native C
function, and also as 'ref' *inside* the implementation of Intersect().

However, on the actual C# method signature of Widget.Intersect(), there
are no 'ref' parameters. Would I be right in thinking this is a bug?
(Widget.SizeRequest also exhibits this behaviour).

Regards,

Lee.


--=-gi4n5BVbfM00Gna7L4/n
Content-Disposition: attachment; filename=Widget_Frame.diff
Content-Type: text/x-patch; name=Widget_Frame.diff; charset=ANSI_X3.4-1968
Content-Transfer-Encoding: 7bit

Index: sources/Gtk.metadata
===================================================================
RCS file: /cvs/public/gtk-sharp/sources/Gtk.metadata,v
retrieving revision 1.47
diff -u -r1.47 Gtk.metadata
--- sources/Gtk.metadata	27 Mar 2003 19:15:04 -0000	1.47
+++ sources/Gtk.metadata	28 Mar 2003 08:11:18 -0000
@@ -3,6 +3,18 @@
 
 &lt;!-- out parameters --&gt;
 &lt;rule&gt;
+  &lt;class name=&quot;GtkFrame&quot;&gt;
+    &lt;method&gt;GetLabelAlign&lt;/method&gt;
+  &lt;/class&gt;
+  &lt;data&gt;
+    &lt;attribute target=&quot;param&quot;&gt;
+	  &lt;filter level=&quot;type&quot;&gt;gfloat*&lt;/filter&gt;
+	  &lt;name&gt;pass_as&lt;/name&gt;
+	  &lt;value&gt;out&lt;/value&gt;
+	&lt;/attribute&gt;
+  &lt;/data&gt;
+&lt;/rule&gt;
+&lt;rule&gt;
   &lt;class name=&quot;GtkTextBuffer&quot;&gt;
     &lt;method&gt;GetIterAtLineOffset&lt;/method&gt;
     &lt;method&gt;GetIterAtLineIndex&lt;/method&gt;
@@ -279,7 +291,81 @@
     &lt;/attribute&gt;
   &lt;/data&gt;
 &lt;/rule&gt;
-
+&lt;rule&gt;
+  &lt;class name=&quot;GtkWidget&quot;&gt;
+    &lt;method&gt;GetPointer&lt;/method&gt;
+  &lt;/class&gt;
+  &lt;data&gt;
+    &lt;attribute target=&quot;param&quot;&gt;
+	  &lt;filter level=&quot;type&quot;&gt;gint*&lt;/filter&gt;
+	  &lt;name&gt;pass_as&lt;/name&gt;
+	  &lt;value&gt;out&lt;/value&gt;
+	&lt;/attribute&gt;
+  &lt;/data&gt;
+&lt;/rule&gt;
+&lt;rule&gt;
+  &lt;class name=&quot;GtkWidget&quot;&gt;
+	&lt;method&gt;TranslateCoordinates&lt;/method&gt;
+  &lt;/class&gt;
+  &lt;data&gt;
+    &lt;attribute target=&quot;param&quot;&gt;
+	  &lt;filter level=&quot;name&quot;&gt;dest_x&lt;/filter&gt;
+	  &lt;name&gt;pass_as&lt;/name&gt;
+	  &lt;value&gt;out&lt;/value&gt;
+	&lt;/attribute&gt;
+  &lt;/data&gt;
+&lt;/rule&gt;
+&lt;rule&gt;
+  &lt;class name=&quot;GtkWidget&quot;&gt;
+	&lt;method&gt;TranslateCoordinates&lt;/method&gt;
+  &lt;/class&gt;
+  &lt;data&gt;
+    &lt;attribute target=&quot;param&quot;&gt;
+	  &lt;filter level=&quot;name&quot;&gt;dest_y&lt;/filter&gt;
+	  &lt;name&gt;pass_as&lt;/name&gt;
+	  &lt;value&gt;out&lt;/value&gt;
+	&lt;/attribute&gt;
+  &lt;/data&gt;
+&lt;/rule&gt;
+&lt;rule&gt;
+  &lt;class name=&quot;GtkWidget&quot;&gt;
+    &lt;method&gt;Path&lt;/method&gt;
+    &lt;method&gt;ClassPath&lt;/method&gt;
+  &lt;/class&gt;
+  &lt;data&gt;
+    &lt;attribute target=&quot;param&quot;&gt;
+	  &lt;filter name=&quot;type&quot;&gt;guint*&lt;/filter&gt;
+	  &lt;name&gt;pass_as&lt;/name&gt;
+	  &lt;value&gt;out&lt;/value&gt;
+	&lt;/attribute&gt;
+  &lt;/data&gt;
+&lt;/rule&gt;
+&lt;rule&gt;
+  &lt;class name=&quot;GtkWidget&quot;&gt;
+    &lt;method&gt;Path&lt;/method&gt;
+    &lt;method&gt;ClassPath&lt;/method&gt;
+  &lt;/class&gt;
+  &lt;data&gt;
+    &lt;attribute target=&quot;param&quot;&gt;
+	  &lt;filter name=&quot;type&quot;&gt;gchar**&lt;/filter&gt;
+	  &lt;name&gt;pass_as&lt;/name&gt;
+	  &lt;value&gt;out&lt;/value&gt;
+	&lt;/attribute&gt;
+  &lt;/data&gt;
+&lt;/rule&gt;
+&lt;rule&gt;
+  &lt;class name=&quot;GtkWidget&quot;&gt;
+    &lt;method&gt;StyleGetProperty&lt;/method&gt;
+  &lt;/class&gt;
+  &lt;data&gt;
+    &lt;attribute target=&quot;param&quot;&gt;
+	  &lt;filter level=&quot;name&quot;&gt;value&lt;/filter&gt;
+	  &lt;name&gt;pass_as&lt;/name&gt;
+	  &lt;value&gt;out&lt;/value&gt;
+	&lt;/attribute&gt;
+  &lt;/data&gt;
+&lt;/rule&gt;
+	
 
 &lt;!-- variable arguments --&gt;
 &lt;rule&gt;
Index: api/gtk-api.xml
===================================================================
RCS file: /cvs/public/gtk-sharp/api/gtk-api.xml,v
retrieving revision 1.29
diff -u -r1.29 gtk-api.xml
--- api/gtk-api.xml	27 Mar 2003 19:15:04 -0000	1.29
+++ api/gtk-api.xml	28 Mar 2003 08:11:23 -0000
@@ -3083,8 +3083,8 @@
       &lt;method name=&quot;GetLabelAlign&quot; cname=&quot;gtk_frame_get_label_align&quot;&gt;
         &lt;return-type type=&quot;void&quot;/&gt;
         &lt;parameters&gt;
-          &lt;parameter type=&quot;gfloat*&quot; name=&quot;xalign&quot;/&gt;
-          &lt;parameter type=&quot;gfloat*&quot; name=&quot;yalign&quot;/&gt;
+          &lt;parameter type=&quot;gfloat*&quot; name=&quot;xalign&quot; pass_as=&quot;out&quot;/&gt;
+          &lt;parameter type=&quot;gfloat*&quot; name=&quot;yalign&quot; pass_as=&quot;out&quot;/&gt;
         &lt;/parameters&gt;
       &lt;/method&gt;
       &lt;method name=&quot;GetLabelWidget&quot; cname=&quot;gtk_frame_get_label_widget&quot;&gt;
@@ -9306,9 +9306,9 @@
       &lt;method name=&quot;ClassPath&quot; cname=&quot;gtk_widget_class_path&quot;&gt;
         &lt;return-type type=&quot;void&quot;/&gt;
         &lt;parameters&gt;
-          &lt;parameter type=&quot;guint*&quot; name=&quot;path_length&quot;/&gt;
-          &lt;parameter type=&quot;gchar**&quot; name=&quot;path&quot;/&gt;
-          &lt;parameter type=&quot;gchar**&quot; name=&quot;path_reversed&quot;/&gt;
+          &lt;parameter type=&quot;guint*&quot; name=&quot;path_length&quot; pass_as=&quot;out&quot;/&gt;
+          &lt;parameter type=&quot;gchar**&quot; name=&quot;path&quot; pass_as=&quot;out&quot;/&gt;
+          &lt;parameter type=&quot;gchar**&quot; name=&quot;path_reversed&quot; pass_as=&quot;out&quot;/&gt;
         &lt;/parameters&gt;
       &lt;/method&gt;
       &lt;method name=&quot;CreatePangoContext&quot; cname=&quot;gtk_widget_create_pango_context&quot;&gt;
@@ -9404,8 +9404,8 @@
       &lt;method name=&quot;GetPointer&quot; cname=&quot;gtk_widget_get_pointer&quot;&gt;
         &lt;return-type type=&quot;void&quot;/&gt;
         &lt;parameters&gt;
-          &lt;parameter type=&quot;gint*&quot; name=&quot;x&quot;/&gt;
-          &lt;parameter type=&quot;gint*&quot; name=&quot;y&quot;/&gt;
+          &lt;parameter type=&quot;gint*&quot; name=&quot;x&quot; pass_as=&quot;out&quot;/&gt;
+          &lt;parameter type=&quot;gint*&quot; name=&quot;y&quot; pass_as=&quot;out&quot;/&gt;
         &lt;/parameters&gt;
       &lt;/method&gt;
       &lt;method name=&quot;GetSettings&quot; cname=&quot;gtk_widget_get_settings&quot;&gt;
@@ -9523,9 +9523,9 @@
       &lt;method name=&quot;Path&quot; cname=&quot;gtk_widget_path&quot;&gt;
         &lt;return-type type=&quot;void&quot;/&gt;
         &lt;parameters&gt;
-          &lt;parameter type=&quot;guint*&quot; name=&quot;path_length&quot;/&gt;
-          &lt;parameter type=&quot;gchar**&quot; name=&quot;path&quot;/&gt;
-          &lt;parameter type=&quot;gchar**&quot; name=&quot;path_reversed&quot;/&gt;
+          &lt;parameter type=&quot;guint*&quot; name=&quot;path_length&quot; pass_as=&quot;out&quot;/&gt;
+          &lt;parameter type=&quot;gchar**&quot; name=&quot;path&quot; pass_as=&quot;out&quot;/&gt;
+          &lt;parameter type=&quot;gchar**&quot; name=&quot;path_reversed&quot; pass_as=&quot;out&quot;/&gt;
         &lt;/parameters&gt;
       &lt;/method&gt;
       &lt;method name=&quot;PopColormap&quot; cname=&quot;gtk_widget_pop_colormap&quot; shared=&quot;true&quot;&gt;
@@ -9767,7 +9767,7 @@
         &lt;return-type type=&quot;void&quot;/&gt;
         &lt;parameters&gt;
           &lt;parameter type=&quot;const-gchar*&quot; name=&quot;property_name&quot;/&gt;
-          &lt;parameter type=&quot;GValue*&quot; name=&quot;value&quot;/&gt;
+          &lt;parameter type=&quot;GValue*&quot; name=&quot;value&quot; pass_as=&quot;out&quot;/&gt;
         &lt;/parameters&gt;
       &lt;/method&gt;
       &lt;method name=&quot;StyleGetValist&quot; cname=&quot;gtk_widget_style_get_valist&quot;&gt;
@@ -9786,8 +9786,8 @@
           &lt;parameter type=&quot;GtkWidget*&quot; name=&quot;dest_widget&quot;/&gt;
           &lt;parameter type=&quot;gint&quot; name=&quot;src_x&quot;/&gt;
           &lt;parameter type=&quot;gint&quot; name=&quot;src_y&quot;/&gt;
-          &lt;parameter type=&quot;gint*&quot; name=&quot;dest_x&quot;/&gt;
-          &lt;parameter type=&quot;gint*&quot; name=&quot;dest_y&quot;/&gt;
+          &lt;parameter type=&quot;gint*&quot; name=&quot;dest_x&quot; pass_as=&quot;out&quot;/&gt;
+          &lt;parameter type=&quot;gint*&quot; name=&quot;dest_y&quot; pass_as=&quot;out&quot;/&gt;
         &lt;/parameters&gt;
       &lt;/method&gt;
       &lt;method name=&quot;Unmap&quot; cname=&quot;gtk_widget_unmap&quot;&gt;

--=-gi4n5BVbfM00Gna7L4/n--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001535.html">[Gtk-sharp-list] (Newbie) Problem while trying gtksharp
</A></li>
	<LI> Next message: <A HREF="001541.html">[Gtk-sharp-list] Entry/Viewport tweaks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1540">[ date ]</a>
              <a href="thread.html#1540">[ thread ]</a>
              <a href="subject.html#1540">[ subject ]</a>
              <a href="author.html#1540">[ author ]</a>
         </LI>
       </UL>
</body></html>
