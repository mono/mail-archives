<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Custom CellRenderer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Custom%20CellRenderer&In-Reply-To=AANLkTi%3DuS1sZ3T9mfs-TEpAyWUCa02cMZCFN3KJenQCg%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="010629.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Custom CellRenderer</H1>
    <B>Nicholas Frechette</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Custom%20CellRenderer&In-Reply-To=AANLkTi%3DuS1sZ3T9mfs-TEpAyWUCa02cMZCFN3KJenQCg%40mail.gmail.com"
       TITLE="[Gtk-sharp-list] Custom CellRenderer">zeno490 at gmail.com
       </A><BR>
    <I>Tue Feb  1 10:44:24 EST 2011</I>
    <P><UL>
        
        <LI>Next message: <A HREF="010629.html">[Gtk-sharp-list] Issues with Drag and Drop from TreeView on Mac and	Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10628">[ date ]</a>
              <a href="thread.html#10628">[ thread ]</a>
              <a href="subject.html#10628">[ subject ]</a>
              <a href="author.html#10628">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>To further clarify what I am attempting to do and why it isn't working:
I am attempting to have 1 column in a tree view use multiple cellrenderers
but mostly only show one at a time per row (one of: toggle, text, combo,
spin).
To achieve this, I thought of two ways to accomplish this:
1- Implement a custom cellrenderer and forward every call to the one
sub-renderer desired
2- Have all cellrenderers packed into the column and only have 1 visible at
a time

In attempting 1, I discovered that, unlike the C++ bindings, the C# bindings
do not have the same behavior.
For example, on a CellRenderer, the Activate function in gtk# is not marked
virtual. So, while it is exposed and you can call it fine, the function
itself will never be called by the library when a cell would activate. It
appears that the C++ library only calls a certain number of functions into
C# and Activate isn't one of them. This is also the case for properties.
While exposed in C# as properties and allows setting them and retrieving
them from the C# side, under the hood, the C++ library never calls those
properties and as such nothing fancy can be done with them (and thus they
cannot be overridden). This somewhat breaks the assumptions one makes
looking at the documentation/API.

Am I understanding this correctly? Is 2 the only option to accomplish this?

Nicholas

On Sun, Jan 30, 2011 at 12:17 PM, Nicholas Frechette &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">zeno490 at gmail.com</A>&gt;wrote:

&gt;<i> Hi,
</I>&gt;<i> I am attempting something similar to the following:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://kapo-cpp.blogspot.com/2008/05/different-cellrenderers-on-same-column.html">http://kapo-cpp.blogspot.com/2008/05/different-cellrenderers-on-same-column.html</A>
</I>&gt;<i>
</I>&gt;<i> To achieve the same behavior with gtk#, I created a proxy interface as he
</I>&gt;<i> does to expose the protected render method required. I then created a
</I>&gt;<i> version of each cell renderer that inherits the interface and the renderer
</I>&gt;<i> desired (ie: CellRendererComboProxy) that forwards all the calls to the base
</I>&gt;<i> class.
</I>&gt;<i>
</I>&gt;<i> I then have a simple converter cell renderer that takes a key as a property
</I>&gt;<i> and forwards all the method calls to the proper cell renderer afterwards.
</I>&gt;<i> This appears to work fine for rendering static data. I can see the spin
</I>&gt;<i> button value, the checkbox marked, etc.
</I>&gt;<i> However, I cannot edit any of the values. The StartEditing function never
</I>&gt;<i> appears to be called, nor the Activate function.
</I>&gt;<i> I do set my cellrenderers to be activatable and editable but no luck. I
</I>&gt;<i> even attempted to override all the properties in cellrenderer in my
</I>&gt;<i> converter to forward the property calls to the correct cellrenderer without
</I>&gt;<i> further luck.
</I>&gt;<i>
</I>&gt;<i> I did run into the following problem though:
</I>&gt;<i> System.Reflection.TargetInvocationException: Exception has been thrown by
</I>&gt;<i> the target of an invocation. ---&gt; System.InvalidOperationException:
</I>&gt;<i> GLib.PropertyAttribute cannot be applied to property Mode of type
</I>&gt;<i> CellRendererConverter because the return type of the property is not
</I>&gt;<i> supported
</I>&gt;<i>   at GLib.Object.AddProperties (GType gtype, System.Type t) [0x00000] in
</I>&gt;<i> &lt;filename unknown&gt;:0
</I>&gt;<i>   at GLib.Object.RegisterGType (System.Type t) [0x00000] in &lt;filename
</I>&gt;<i> unknown&gt;:0
</I>&gt;<i>
</I>&gt;<i> With the following code in my custom cell renderer:
</I>&gt;<i> [GLib.Property(&quot;mode&quot;)]
</I>&gt;<i> public new CellRendererMode Mode { get; set; } // Impl not shown, problem
</I>&gt;<i> still occurs without 'new' here
</I>&gt;<i>
</I>&gt;<i> Strangely enough, the same code in the gtk# cellrenderer appears to work
</I>&gt;<i> fine.
</I>&gt;<i>
</I>&gt;<i> Is there a better way to achieve a treeview in which I can display 2
</I>&gt;<i> columns and edit values of various types in the second? (Much like a
</I>&gt;<i> property grid)
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Nicholas
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20110201/3db4bcbe/attachment.html">http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20110201/3db4bcbe/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="010629.html">[Gtk-sharp-list] Issues with Drag and Drop from TreeView on Mac and	Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10628">[ date ]</a>
              <a href="thread.html#10628">[ thread ]</a>
              <a href="subject.html#10628">[ subject ]</a>
              <a href="author.html#10628">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
