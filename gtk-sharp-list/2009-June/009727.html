<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] TreeView.Vadjustment.PageSize not updated
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20TreeView.Vadjustment.PageSize%20not%20updated&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009722.html">
   <LINK REL="Next"  HREF="009730.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] TreeView.Vadjustment.PageSize not updated</H1>
    <B>Philip Wobst</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20TreeView.Vadjustment.PageSize%20not%20updated&In-Reply-To="
       TITLE="[Gtk-sharp-list] TreeView.Vadjustment.PageSize not updated">philip.wobst at aastra.com
       </A><BR>
    <I>Fri Jun 26 06:06:13 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="009722.html">[Gtk-sharp-list] TextTag
</A></li>
        <LI>Next message: <A HREF="009730.html">[Gtk-sharp-list] Drag&amp;Drop Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9727">[ date ]</a>
              <a href="thread.html#9727">[ thread ]</a>
              <a href="subject.html#9727">[ subject ]</a>
              <a href="author.html#9727">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,
 
in my application the user can load different treeviews - since the
application runs on a touchscreen I do not want to use scrollbars and
have page-up and page-down buttons instead. However, all data regarding
the Vadjustment is not updated when I load the treeview. When I do
select the page-down button the information is available for scrolling.
I have created a sample app with the same behaviour. The first table is
loaded into the VBox and the Vadjustment information is shown -
navigation via the scroll up and down button is possible and shows the
Vadjustment information before the scroll event. When the table is
refreshed using the Refresh table button no Vadjustment information is
available any more. However, if you now select the scroll down button
the information is available!?
 
Is there something I forgot after refreshing? 
 
I am using Mono 2.4 and have tested on Windows and Linux.
 
Thanks,
 
Philip
 
This is the code:
 
using System;
 
public class TreeViewExample
{
    // Gtk objects
    Gtk.Window Window;
    Gtk.VBox Container;
    Gtk.TreeView tree;
 
 
 public static void Main ()
 {
  Gtk.Application.Init ();
  new TreeViewExample ();
  Gtk.Application.Run ();
 }
 
 public TreeViewExample ()
 {
    try {
        Window = new Gtk.Window (&quot;TreeView Example&quot;);
        Window.SetSizeRequest (800,400);
 
        Container = new Gtk.VBox(false, 0);
        Window.Add(Container);
 
        Gtk.Button btnDwon = new Gtk.Button(&quot;Scroll down&quot;);
        btnDwon.Clicked += new EventHandler(btn_ScrollDown);
        Container.PackStart(btnDwon, false, true, 2);
        
        Gtk.Button btnUp = new Gtk.Button(&quot;Scroll up&quot;);
        btnUp.Clicked += new EventHandler(btn_ScrollUp);
        Container.PackStart(btnUp, false, true, 2);
        
        Gtk.Button btnRefresh = new Gtk.Button(&quot;Refresh Table&quot;);
        btnRefresh.Clicked += new EventHandler(btnRefresh_Clicked);
        Container.PackStart(btnRefresh, false, true, 2);
        
        tree = GetTree();
 
        Container.PackStart(tree, true, true, 0);
        Container.ShowAll();
        
        Window.ShowAll ();
 
        ShowTreeInfo(&quot;Main&quot;);
 
    } catch (Exception ex) {
        Console.WriteLine(ex.Message);
        throw ex;
    }
}
 
    Gtk.TreeView GetTree()
    {
        Gtk.TreeView tree = new Gtk.TreeView();
        Gtk.ListStore berichtListStore = new
Gtk.ListStore(typeof(string), typeof(string), typeof(string));
        tree.AppendColumn(&quot;#&quot;, new Gtk.CellRendererText(), &quot;text&quot;, 0);
        tree.AppendColumn(&quot;Name&quot;, new Gtk.CellRendererText(), &quot;text&quot;,
1);
        tree.AppendColumn(&quot;Fruit&quot;, new Gtk.CellRendererText(), &quot;text&quot;,
2);
 
        for (int i = 0; i &lt; 40; i++)
        {
            berichtListStore.AppendValues(i.ToString(),&quot;Rupert&quot;, &quot;Yellow
bananas&quot;);
        }
 
        tree.Model = berichtListStore;
        return tree;
    }
 
    void ShowTreeInfo(string msg)
    {
        Gtk.Adjustment adj = tree.Vadjustment;
        Console.WriteLine(&quot;Message: {0}\n\t adj.PageSize:\t\t{1}\n\t
adj.Value:\t\t{2}\n\t adj.PageIncrement:\t{3}\n\t adj.Upper:\t\t{4}&quot;
                , msg, adj.PageSize.ToString(), adj.Value.ToString(),
adj.PageIncrement.ToString(), adj.Upper.ToString());
    }
 
    void btnRefresh_Clicked(object sender, EventArgs e)
    {
        tree = GetTree();
 
        Container.Remove(Container.Children[3]);
        Container.PackStart(tree, true, true, 0);
        Container.ShowAll();
        ShowTreeInfo(&quot;btnRefresh_Clicked&quot;);
    }
 
    void btn_ScrollUp(object sender, EventArgs e)
    {
        ShowTreeInfo(&quot;before btn_ScrollUp&quot;);
        if ((tree.Vadjustment.Value - tree.Vadjustment.PageIncrement) &gt;
tree.Vadjustment.Lower)
            tree.Vadjustment.Value -= tree.Vadjustment.PageIncrement;
        else
        {
            tree.Vadjustment.Value = tree.Vadjustment.Lower;
        }
    }
 
    void btn_ScrollDown(object sender, EventArgs e)
    {
        ShowTreeInfo(&quot;before btn_ScrollDown&quot;);        
        if ((tree.Vadjustment.Value + tree.Vadjustment.PageIncrement) &lt;
tree.Vadjustment.Upper)
            tree.Vadjustment.Value += tree.Vadjustment.PageIncrement;
    }
 
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20090626/e4ca7fdb/attachment.html">http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20090626/e4ca7fdb/attachment.html</A> 
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009722.html">[Gtk-sharp-list] TextTag
</A></li>
	<LI>Next message: <A HREF="009730.html">[Gtk-sharp-list] Drag&amp;Drop Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9727">[ date ]</a>
              <a href="thread.html#9727">[ thread ]</a>
              <a href="subject.html#9727">[ subject ]</a>
              <a href="author.html#9727">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
