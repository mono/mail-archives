<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] gnome canvas line / polygon
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:max.stekelenburg%40planet.nl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001752.html">
   <LINK REL="Next"  HREF="001654.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] gnome canvas line / polygon
   </H1>
    <B>Max Stekelenburg
    </B> 
    <A HREF="mailto:max.stekelenburg%40planet.nl"
       TITLE="[Gtk-sharp-list] gnome canvas line / polygon">max.stekelenburg@planet.nl
       </A><BR>
    <I>Mon, 14 Apr 2003 06:27:17 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="001752.html">[Gtk-sharp-list] Console window
</A></li>
        <LI> Next message: <A HREF="001654.html">[Gtk-sharp-list] GtkLabel and ColSpan
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1656">[ date ]</a>
              <a href="thread.html#1656">[ thread ]</a>
              <a href="subject.html#1656">[ subject ]</a>
              <a href="author.html#1656">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--Boundary_(ID_5MvZ6r3tm5DMemtjfNXaAw)
Content-type: text/plain
Content-transfer-encoding: 7BIT

On Sat, 2003-04-12 at 20:48, Miguel de Icaza wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> &gt; I seem to unable to figure out how to get a line or a polygon in the
</I>&gt;<i> &gt; canvas. CanvasRect,CanvasEllipse and CanvasText work fine.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I tried using just gnome# e.g:
</I>&gt;<i> 
</I>&gt;<i> Could you please post a complete sample, so we can try to debug it?
</I>&gt;<i> 
</I>&gt;<i> Miguel
</I>Ok here is an example of a line based on points, a poly on points and a
poly on pathdef (which works).
You probably need to stretch the window a little to see the poly based
on pathdef.
Also there is a trial to get it working by instantiating the points
through dll calls but some versions did not compile or resulted in
assertions. None did work.


--Boundary_(ID_5MvZ6r3tm5DMemtjfNXaAw)
Content-type: text/plain; name=test.cs; charset=ANSI_X3.4-1968
Content-transfer-encoding: 7BIT
Content-disposition: attachment; filename=test.cs

namespace GtkSamples {
	using Gnome;
	using Gtk;
	using Gdk;
	using GtkSharp;
	using System;
	using System.Collections;
	using System.ComponentModel;
	using System.Reflection;
	using System.Runtime.InteropServices;
	class test {
		static void Window_Delete (object obj, DeleteEventArgs args)
		{
			SignalArgs sa = (SignalArgs) args;
			Application.Quit ();
			sa.RetVal = true;
		}
		static Canvas canvas;
		public static int Main (string[] args)
		{
			Application.Init ();
			Gtk.Window win = new Gtk.Window (&quot;Canvas example&quot;);
			win.DeleteEvent += new DeleteEventHandler (Window_Delete);
			VBox vbox = new VBox (false, 0);
			canvas = new Canvas ();
			ScrolledWindow sw=new ScrolledWindow();
			sw.Add(canvas);
			win.Add (sw);
			win.ShowAll ();

			CanvasLine line = new CanvasLine(canvas.Root());
			line.FillColor=&quot;green&quot;;
			line.ArrowShapeA=6.0;
			line.ArrowShapeB=6.0;
			line.ArrowShapeC=6.0;
			line.WidthUnits=3.0;
			line.LastArrowhead=true;
			line.FirstArrowhead=true;
			double [] pts={65,5,85,45};
			line.Points=CanvasPoints.New(pts);
			
			CanvasPolygon poly=new CanvasPolygon(canvas.Root());
			double [] pts2={95,5,95,45,115,45};
			poly.Points=CanvasPoints.New(pts2);
			poly.FillColor=&quot;red&quot;;
			poly.WidthUnits=3.0;
			poly.OutlineColor=&quot;green&quot;;
			
			CanvasPolygon poly2=new CanvasPolygon(canvas.Root());
			CanvasPathDef cpd=new CanvasPathDef();
			cpd.MoveTo(145,45);
			cpd.LineTo(125,5);
			poly2.PathDef=cpd;
			poly2.FillColor=&quot;red&quot;;
			poly2.WidthUnits=3.0;
			poly2.OutlineColor=&quot;green&quot;;
			Application.Run ();
			
			/*
			*/
			return 0;
		}
		[DllImport(&quot;gnomecanvas-2&quot;)]
		static extern IntPtr gnome_canvas_points_new(int num_points);
		[DllImport(&quot;gnomecanvas-2&quot;)]
		static extern IntPtr gnome_canvas_item_new(IntPtr group, uint type,IntPtr null_terminator);
		[DllImport(&quot;gnomecanvas-2&quot;)]
		static extern uint gnome_canvas_polygon_get_type();
		[DllImport(&quot;libgobject-2.0-0.dll&quot;)]
		static extern void g_object_set_property(IntPtr obj,string name,IntPtr val);
		[DllImport(&quot;gtksharpglue&quot;)]
		static extern System.IntPtr gtksharp_gnome_canvas_points_new_from_array(uint num_points,double[] coords);
		static extern System.IntPtr gtksharp_value_create(uint type);
		[DllImport(&quot;libgobject-2.0-0.dll&quot;)]
		static extern void g_value_set_pointer(IntPtr val,IntPtr data);
		static void addpoly(){
			/*
			IntPtr points=gnome_canvas_points_new(3);
			unsafe {
			points-&gt;coords[0]= 5.0;
			points-&gt;coords[1]= 5.0;
			points-&gt;coords[2]= 10.0;
			points-&gt;coords[3]= 10.0;
			points-&gt;coords[4]= 5.0;
			points-&gt;coords[5]= 10.0;
			}
			*/
			double[] coords={5.0,5.0,40.0,40.0,5.0,40.0};
			IntPtr points=gtksharp_gnome_canvas_points_new_from_array((uint) coords.Length/2,coords);
			System.Console.WriteLine(&quot;1 {0}&quot;,points);
			IntPtr item=gnome_canvas_item_new(canvas.Root().Handle,gnome_canvas_polygon_get_type(),IntPtr.Zero);
			System.Console.WriteLine(&quot;2&quot;);
			//g_object_set_property(item,&quot;points&quot;,points);//is not GObject
			//g_object_set_property(item,&quot;points&quot;,new GLib.Value(points,IntPtr.Zero).Handle);
			//IntPtr val=gtksharp_value_create(18&lt;&lt;2);
			GLib.Value v=new GLib.Value(points,&quot;GnomeCanvasPoints&quot;);
			//g_value_set_pointer(val,points);
			//g_object_set_property(item,&quot;points&quot;,val);//is not GObject
			System.Console.WriteLine(&quot;3&quot;);
			g_object_set_property(item,&quot;fill_color&quot;,new GLib.Value(&quot;tan&quot;).Handle);
			System.Console.WriteLine(&quot;1&quot;);
			g_object_set_property(item,&quot;outline_color&quot;,new GLib.Value(&quot;black&quot;).Handle);
			System.Console.WriteLine(&quot;1&quot;);
			g_object_set_property(item,&quot;width_units&quot;,new GLib.Value(3.0).Handle);
			System.Console.WriteLine(&quot;1&quot;);
			//setup_item(item);
			//gnome_canvas_points_unref(points);
		}
	}
}


--Boundary_(ID_5MvZ6r3tm5DMemtjfNXaAw)--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001752.html">[Gtk-sharp-list] Console window
</A></li>
	<LI> Next message: <A HREF="001654.html">[Gtk-sharp-list] GtkLabel and ColSpan
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1656">[ date ]</a>
              <a href="thread.html#1656">[ thread ]</a>
              <a href="subject.html#1656">[ subject ]</a>
              <a href="author.html#1656">[ author ]</a>
         </LI>
       </UL>
</body></html>
