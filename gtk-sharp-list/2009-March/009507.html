<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Windows theme not applied
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Windows%20theme%20not%20applied&In-Reply-To=22543841.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009506.html">
   <LINK REL="Next"  HREF="009508.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Windows theme not applied</H1>
    <B>Peter Johanson</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Windows%20theme%20not%20applied&In-Reply-To=22543841.post%40talk.nabble.com"
       TITLE="[Gtk-sharp-list] Windows theme not applied">peter at peterjohanson.com
       </A><BR>
    <I>Tue Mar 17 11:25:44 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="009506.html">[Gtk-sharp-list] Windows theme not applied
</A></li>
        <LI>Next message: <A HREF="009508.html">[Gtk-sharp-list] Windows theme not applied
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9507">[ date ]</a>
              <a href="thread.html#9507">[ thread ]</a>
              <a href="subject.html#9507">[ subject ]</a>
              <a href="author.html#9507">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I recently solved this by putting the following snippet of SWF before
any of the Gtk# initialization stuff:

Forms.Application.EnableVisualStyles ();
Forms.Application.DoEvents ();

This ensured that on the Windows level, the visual style stuff was
enabled properly, which was then picked up by the WIMP theme properly.

Why this is necessary, and why this works without the above code for
*some* applications is *beyond* me, but my only guess is some codepaths
touching Windows API before WIMP is initialized, and others only after?

See if the above helps?

-pete

On Tue, Mar 17, 2009 at 12:55:30AM -0700, Jupe wrote:
&gt;<i> 
</I>&gt;<i> Another confirmation here. Tried all the 2.12 installers. Problem on XP and
</I>&gt;<i> Vista. But not when starting from visual studio.
</I>&gt;<i> Running the same app from bin/Debug does show the problem. Strange. 
</I>&gt;<i> I tried to narrow it down:
</I>&gt;<i> 
</I>&gt;<i> Tried all possible solution you all mentioned, But nothing works in my
</I>&gt;<i> situation.
</I>&gt;<i> 
</I>&gt;<i> I copied gtk-wimp 0.7.0 over the installer and the problem disappeared.
</I>&gt;<i> But the menu's where not drawn correctly where selected/hovered.
</I>&gt;<i> 
</I>&gt;<i> It seems like a problem with detecting if wimp can use the windows theming
</I>&gt;<i> api.
</I>&gt;<i> The strange thing is that it is working within Visual Studio. Enviroment?
</I>&gt;<i> 
</I>&gt;<i> Tomboy is working correctly and that uses the exact same gtk-sharp
</I>&gt;<i> installation.
</I>&gt;<i> Looked through the sourcecode but could not directly find a difference to my
</I>&gt;<i> code.
</I>&gt;<i> Maybe the developers from Tomboy know more?
</I>&gt;<i> 
</I>&gt;<i> Did someone already found a solution?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> View this message in context: <A HREF="http://www.nabble.com/Windows-theme-not-applied-tp20758097p22543841.html">http://www.nabble.com/Windows-theme-not-applied-tp20758097p22543841.html</A>
</I>&gt;<i> Sent from the Mono - Gtk# mailing list archive at Nabble.com.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Gtk-sharp-list maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">Gtk-sharp-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">http://lists.ximian.com/mailman/listinfo/gtk-sharp-list</A>
</I>&gt;<i> 
</I>
-- 

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009506.html">[Gtk-sharp-list] Windows theme not applied
</A></li>
	<LI>Next message: <A HREF="009508.html">[Gtk-sharp-list] Windows theme not applied
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9507">[ date ]</a>
              <a href="thread.html#9507">[ thread ]</a>
              <a href="subject.html#9507">[ subject ]</a>
              <a href="author.html#9507">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
