<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] GTK# Window Display Issue Outside of Main.cs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=Re%3A%20%5BGtk-sharp-list%5D%20GTK%23%20Window%20Display%20Issue%20Outside%20of%20Main.cs&In-Reply-To=%3Ck7cbdp%242j4%241%40ger.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011148.html">
   <LINK REL="Next"  HREF="011150.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] GTK# Window Display Issue Outside of Main.cs</H1>
    <B>Andres G. Aragoneses</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=Re%3A%20%5BGtk-sharp-list%5D%20GTK%23%20Window%20Display%20Issue%20Outside%20of%20Main.cs&In-Reply-To=%3Ck7cbdp%242j4%241%40ger.gmane.org%3E"
       TITLE="[Gtk-sharp-list] GTK# Window Display Issue Outside of Main.cs">knocte at gmail.com
       </A><BR>
    <I>Wed Nov  7 00:53:15 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011148.html">[Gtk-sharp-list] GTK# Window Display Issue Outside of Main.cs
</A></li>
        <LI>Next message: <A HREF="011150.html">[Gtk-sharp-list] GTK# Window Display Issue Outside of Main.cs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11149">[ date ]</a>
              <a href="thread.html#11149">[ thread ]</a>
              <a href="subject.html#11149">[ subject ]</a>
              <a href="author.html#11149">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>And a good tool to fix what just Joe brought up is:

<A HREF="https://github.com/slluis/gui-thread-check">https://github.com/slluis/gui-thread-check</A>

This tool will, furthermore, be bundled by default in the next 2.99.1 
release (so one more incentive to upgrade ).

On 06/11/12 22:37, Joe Dluzen wrote:
&gt;<i> Though I haven't run your code, my first guess would be threading
</I>&gt;<i> issues. As with practically all GUI toolkits, components are not only
</I>&gt;<i> not threadsafe, but code doing anything with the components must be
</I>&gt;<i> invoked on the same thread, please see here:
</I>&gt;<i> <A HREF="http://www.mono-project.com/Responsive_Applications">http://www.mono-project.com/Responsive_Applications</A>
</I>&gt;<i>
</I>&gt;<i> In the code you have not posted, is anything started on new threads, or
</I>&gt;<i> on the threadpool? If so, you'd need to Invoke() any and all update code
</I>&gt;<i> to the GUI thread. All speculation right now, sorry.
</I>&gt;<i>
</I>&gt;<i> Joe
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Tue, Nov 6, 2012 at 2:36 PM, Johnnie Odom &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">jodom at escambia.k12.fl.us</A>
</I>&gt;<i> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">jodom at escambia.k12.fl.us</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     Hello Everyone,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     This is my first day on the mailing list, and as it is I have a
</I>&gt;<i>     question regarding some odd behavior I am encountering.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     I am writing an application on OS X 10.8 using C#, Mono 2.10.9 and
</I>&gt;<i>     MonoDevelop 3.0.4 (including the Designer views) that makes some
</I>&gt;<i>     simple changes to LDAP. As part of it, I decided to get fancy with
</I>&gt;<i>     GTK#. All is going well, except for one behavior.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     I have created a window class to display a progress bar and stop
</I>&gt;<i>     button. I have further created a function in this class to update
</I>&gt;<i>     the progress bar with a fraction and text message. In my code, I
</I>&gt;<i>     create a new instance of this window class when real work is
</I>&gt;<i>     happening in another class, and then populate it after every ten
</I>&gt;<i>     iterations of a foreach loop.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     My problem is that when the window is created FROM THE CLASS DOING
</I>&gt;<i>     REAL WORK, it displays neither the progress bar widget, nor the
</I>&gt;<i>     button. It displays only the window title and then white space
</I>&gt;<i>     below. Only this window displays this behavior -- several other
</I>&gt;<i>     windows that I create over the course of the application all display
</I>&gt;<i>     appropriately.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     If I instead create the progress bar window in Main.cs and call
</I>&gt;<i>     Show(), it will display just fine. I can even call the function to
</I>&gt;<i>     set its status from Main.cs and it will display correctly.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     I have tried creating the window in Main.cs and passing it to the
</I>&gt;<i>     class that does the real work later. I have tried creating it in
</I>&gt;<i>     other classes besides the one that does the work. In all cases the
</I>&gt;<i>     behavior is the same -- if the window is created and used solely in
</I>&gt;<i>     Main.cs it will display fine, but if it it ever invoked or created
</I>&gt;<i>     from anywhere else (whether or not it is created in another class or
</I>&gt;<i>     in Main.cs) it will display incorrectly.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     I have taken to using the debugger and break points to isolate the
</I>&gt;<i>     behavior. If I set a breakpoint immediately after the window is
</I>&gt;<i>     created, it is still blank -- that is, I do not think it is a case
</I>&gt;<i>     that the window is just not keeping pace with any updates I am
</I>&gt;<i>     sending. I have also compared the various values of the window
</I>&gt;<i>     objects and attributes when it is displayed (created and used solely
</I>&gt;<i>     in Main.cs) and when it is not (displayed in any other class) and
</I>&gt;<i>     they seem to be identical.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     So, I am at a loss, and I would appreciate any advice you might give.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     I can send any code you think would prove useful, but for now I am
</I>&gt;<i>     sending you the class where I am trying to call the window, and the
</I>&gt;<i>     contents of the window's code-behind.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     Thank you for any guidance you can give.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     Johnnie Odom
</I>&gt;<i>
</I>&gt;<i>     Network Services
</I>&gt;<i>
</I>&gt;<i>     School District of Escambia County
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     ****************
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     The function from the calling class:
</I>&gt;<i>
</I>&gt;<i>     public string radiazerMain(string radiazerGroup, string
</I>&gt;<i>     radiazerProfile){
</I>&gt;<i>
</I>&gt;<i>     Progression MarathonBar = new Progression();
</I>&gt;<i>
</I>&gt;<i>     MarathonBar.Show();
</I>&gt;<i>
</I>&gt;<i>     string monologger = &quot;&quot;;
</I>&gt;<i>
</I>&gt;<i>     string lastLine = &quot;Radiazer completed current run.&quot; +
</I>&gt;<i>     Environment.NewLine;
</I>&gt;<i>
</I>&gt;<i>     Array usersToModify = getGroupMembers(radiazerGroup);
</I>&gt;<i>
</I>&gt;<i>     string[] radiusAttribs = new
</I>&gt;<i>     string[]{&quot;dialupAccess&quot;,&quot;radiusArapFeatures&quot;,&quot;radiusArapSecurity&quot;,&quot;radiusArapZoneAccess&quot;,&quot;radiusAuthType&quot;,&quot;radiusCallbackId&quot;,&quot;radiusCallbackNumber&quot;,&quot;radiusCalledStationId&quot;,&quot;radiusCallingStationId&quot;,&quot;radiusCheckItem&quot;,&quot;radiusClass&quot;,&quot;radiusClientIPAddress&quot;,&quot;radiusExpiration&quot;,&quot;radiusFilterId&quot;,&quot;radiusFramedAppleTalkLink&quot;,&quot;radiusFramedAppleTalkNetwork&quot;,&quot;radiusFramedAppleTalkZone&quot;,&quot;radiusFramedCompression&quot;,&quot;radiusFramedIPAddress&quot;,&quot;radiusFramedIPNetmask&quot;,&quot;radiusFramedIPXNetwork&quot;,&quot;radiusFramedMTU&quot;,&quot;radiusFramedProtocol&quot;,&quot;radiusFramedRoute&quot;,&quot;radiusFramedRouting&quot;,&quot;radiusGroupName&quot;,&quot;radiusHint&quot;,&quot;radiusHuntgroupName&quot;,&quot;radiusIdleTimeout&quot;,&quot;radiusLoginIPHost&quot;,&quot;radiusLoginLATGroup&quot;,&quot;radiusLoginLATNode&quot;,&quot;radiusLoginLATPort&quot;,&quot;radiusLoginLATService&quot;,&quot;radiusLoginService&quot;,&quot;radiusLoginTCPPort&quot;,&quot;radiusLoginTime&quot;,&quot;radiusPasswordRetry&quot;,&quot;radiusPortLimit&quot;,&quot;radiusProfileDn&quot;,&quot;radiusPrompt&quot;,&quot;radiusProxyToRealm&quot;,&quot;radiusRealm&quot;,&quot;radiusReplicateToRealm&quot;,&quot;radiusReplyItem&quot;,&quot;radiusServiceType&quot;,&quot;radiusSessionTimeout&quot;,
</I>&quot;radiusSimultaneousUse&quot;,&quot;radiusStripUserName&quot;,&quot;radiusTerminationAction&quot;,&quot;radiusTunnelAssignmentId&quot;,&quot;radiusTunnelClientEndpoint&quot;,&quot;radiusTunnelMediumType&quot;,&quot;radiusTunnelPassword&quot;,&quot;radiusTunnelPreference&quot;,&quot;radiusTunnelPrivateGroupId&quot;,&quot;radiusTunnelServerEndpoint&quot;,&quot;radiusTunnelType&quot;,&quot;radiusUserCategory&quot;,&quot;radiusVSA&quot;};
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     LdapAttributeSet profileTemplate =
</I>&gt;<i>     LdapAttributeSetFiltered(radiazerProfile, radiusAttribs);
</I>&gt;<i>
</I>&gt;<i>     profileTemplate.Add(new LdapAttribute(&quot;radiusProfileDn&quot;,
</I>&gt;<i>     radiazerProfile));
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     int totalUsersCount = usersToModify.Length;
</I>&gt;<i>
</I>&gt;<i>     int currentUserCount = 0;
</I>&gt;<i>
</I>&gt;<i>     int errorCount = 0;
</I>&gt;<i>
</I>&gt;<i>     MarathonBar.Show();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     foreach(string userToModify in usersToModify){
</I>&gt;<i>
</I>&gt;<i>     currentUserCount++;
</I>&gt;<i>
</I>&gt;<i>     try{
</I>&gt;<i>
</I>&gt;<i>     monologger = monologger + radiazeModifyUser(userToModify,
</I>&gt;<i>     profileTemplate);
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     catch(LdapException LdapFailure){
</I>&gt;<i>
</I>&gt;<i>     monologger = monologger + &quot;User &quot; + userToModify + &quot; failed. Error
</I>&gt;<i>     is &quot; + LdapFailure.ToString() + Environment.NewLine;
</I>&gt;<i>
</I>&gt;<i>     errorCount++;
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     if(((currentUserCount % 10) == 0) || ((totalUsersCount -
</I>&gt;<i>     currentUserCount) &lt; 10)){
</I>&gt;<i>
</I>&gt;<i>     MarathonBar.setProgress(((double)currentUserCount /
</I>&gt;<i>     totalUsersCount), totalUsersCount , currentUserCount, errorCount,
</I>&gt;<i>     userToModify);
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     if(MarathonBar.cancelFromUser){
</I>&gt;<i>
</I>&gt;<i>     lastLine = &quot;Radiazer cancelled by user.&quot; + Environment.NewLine;
</I>&gt;<i>
</I>&gt;<i>     break;
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     MarathonBar.Destroy();
</I>&gt;<i>
</I>&gt;<i>     monologger = monologger + lastLine;
</I>&gt;<i>
</I>&gt;<i>     return monologger;
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     *************
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     The Code-Behind:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     using System;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     namespace Radiazer2
</I>&gt;<i>
</I>&gt;<i>     {
</I>&gt;<i>
</I>&gt;<i>     public partial class Progression : Gtk.Window
</I>&gt;<i>
</I>&gt;<i>     {
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     public bool cancelFromUser = false;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     public Progression () :
</I>&gt;<i>
</I>&gt;<i>     base(Gtk.WindowType.Toplevel)
</I>&gt;<i>
</I>&gt;<i>     {
</I>&gt;<i>
</I>&gt;<i>     this.Build ();
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     public void setProgress(double fractionOfProgress, int totalUnits,
</I>&gt;<i>     int finishedUnits, int errorUnits, string finishedUser){
</I>&gt;<i>
</I>&gt;<i>     this.progressIndicator.Fraction = fractionOfProgress;
</I>&gt;<i>
</I>&gt;<i>     this.progressIndicator.Text = &quot;Completed &quot; + finishedUnits + &quot; of &quot;
</I>&gt;<i>     + totalUnits + &quot; with &quot; + errorUnits + &quot; errors. Current user is &quot; +
</I>&gt;<i>     finishedUser + &quot;.&quot;;
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     protected void OnStopUserClicked (object sender, EventArgs e)
</I>&gt;<i>
</I>&gt;<i>     {
</I>&gt;<i>
</I>&gt;<i>     cancelFromUser = true;
</I>&gt;<i>
</I>&gt;<i>     }
</I>&gt;<i>
</I>


</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011148.html">[Gtk-sharp-list] GTK# Window Display Issue Outside of Main.cs
</A></li>
	<LI>Next message: <A HREF="011150.html">[Gtk-sharp-list] GTK# Window Display Issue Outside of Main.cs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11149">[ date ]</a>
              <a href="thread.html#11149">[ thread ]</a>
              <a href="subject.html#11149">[ subject ]</a>
              <a href="author.html#11149">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
