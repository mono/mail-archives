<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] patch: gapi.pl allows renaming of enum and	enum
 members
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:aleksey%40aleksey.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002338.html">
   <LINK REL="Next"  HREF="002359.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] patch: gapi.pl allows renaming of enum and	enum
 members
   </H1>
    <B>Aleksey Sanin
    </B> 
    <A HREF="mailto:aleksey%40aleksey.com"
       TITLE="[Gtk-sharp-list] patch: gapi.pl allows renaming of enum and	enum
 members">aleksey@aleksey.com
       </A><BR>
    <I>Tue, 26 Aug 2003 22:00:16 -0700</I>
    <P><UL>
        <LI> Previous message: <A HREF="002338.html">[Gtk-sharp-list] patch: gapi.pl allows renaming of enum and
 enum members
</A></li>
        <LI> Next message: <A HREF="002359.html">[Gtk-sharp-list] patch: gapi.pl allows renaming of enum
 and	enum members
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2341">[ date ]</a>
              <a href="thread.html#2341">[ thread ]</a>
              <a href="subject.html#2341">[ subject ]</a>
              <a href="author.html#2341">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.
--------------060807090801030403020103
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit



&gt;<i>I've made some comments below.  Can you rework the patch to incorporate
</I>&gt;<i>the comments and verify that it still works for your libzvt binding? 
</I>&gt;<i>
</I>Done. See attached file. My wrapper still works after trivial renaming 
enum--&gt;class :)

&gt;<i>Also, please check out the guidelines on go-mono.org for obtaining a cvs
</I>&gt;<i>account.  
</I>&gt;<i>
</I>Thanks. I'll send a message to Miguel tonight.


Thanks for review!
Aleksey


--------------060807090801030403020103
Content-Type: text/plain;
 name=&quot;gapi.diff&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;gapi.diff&quot;

Index: ChangeLog
===================================================================
RCS file: /mono/gtk-sharp/ChangeLog,v
retrieving revision 1.451
diff -u -r1.451 ChangeLog
--- ChangeLog	27 Aug 2003 02:26:04 -0000	1.451
+++ ChangeLog	27 Aug 2003 04:48:31 -0000
@@ -1,3 +1,8 @@
+2003-08-26 Aleksey Sanin &lt;<A HREF="mailto:aleksey@aleksey.com">aleksey@aleksey.com</A>&gt;
+
+	* parser/GAPI/Metadata.pm: enable enums processing using
+	&lt;class/&gt; element syntax
+
 2003-08-26  John Luke  &lt;<A HREF="mailto:jluke@cfl.rr.com">jluke@cfl.rr.com</A>&gt;
 
 	* gtk/ThreadNotify.cs: mark dllimported methods private
Index: parser/GAPI/Metadata.pm
===================================================================
RCS file: /mono/gtk-sharp/parser/GAPI/Metadata.pm,v
retrieving revision 1.12
diff -u -r1.12 Metadata.pm
--- parser/GAPI/Metadata.pm	11 Jul 2003 02:00:12 -0000	1.12
+++ parser/GAPI/Metadata.pm	27 Aug 2003 04:48:31 -0000
@@ -25,18 +25,18 @@
 	my ($node, $classes) = @_;
 	my %methods = ();
 	my %signals = ();
-	my %properties = ();
+	my %members = ();
 	my @attrs = $node-&gt;attributes;
 	my $class_name = $attrs[0]-&gt;value;
-	${$classes}{$class_name} = [\%methods, \%signals, \%properties];
+	${$classes}{$class_name} = [\%methods, \%signals, \%members];
 
 	for ($method_node = $node-&gt;firstChild; $method_node != undef; $method_node = $method_node-&gt;nextSibling ()) {
 		if ($method_node-&gt;nodeName eq &quot;method&quot; or $method_node-&gt;nodeName eq &quot;constructor&quot;) {
 			$methods{$method_node-&gt;firstChild-&gt;nodeValue} = 1;
 		} elsif ($method_node-&gt;nodeName eq &quot;signal&quot;) {
 			$signals{$method_node-&gt;firstChild-&gt;nodeValue} = 1;
-		} elsif ($method_node-&gt;nodeName eq &quot;property&quot;) {
-			$properties{$method_node-&gt;firstChild-&gt;nodeValue} = 1;
+		} elsif ($method_node-&gt;nodeName eq &quot;property&quot; or $method_node-&gt;nodeName eq &quot;member&quot;) {
+			$members{$method_node-&gt;firstChild-&gt;nodeValue} = 1;
 		}	
 	}
 }
@@ -182,7 +182,7 @@
 	foreach $rule (@{$self-&gt;{rules}}) {
 		my ($classes_ref, $data_list_ref) = @$rule;
 		for ($node = $ns_node-&gt;firstChild; $node; $node = $node-&gt;nextSibling ()) {
-			next if not ($node-&gt;nodeName eq &quot;object&quot; or $node-&gt;nodeName eq &quot;interface&quot; or $node-&gt;nodeName eq &quot;struct&quot; or $node-&gt;nodeName eq &quot;boxed&quot; or $node-&gt;nodeName eq &quot;callback&quot; or $node-&gt;nodeName eq &quot;class&quot;);
+			next if not ($node-&gt;nodeName eq &quot;object&quot; or $node-&gt;nodeName eq &quot;interface&quot; or $node-&gt;nodeName eq &quot;struct&quot; or $node-&gt;nodeName eq &quot;boxed&quot; or $node-&gt;nodeName eq &quot;callback&quot; or $node-&gt;nodeName eq &quot;class&quot; or $node-&gt;nodeName eq &quot;enum&quot;);
 			my $class, $methods_ref, $attr;
 			foreach $attr ($node-&gt;attributes) {
 				if ($attr-&gt;name eq &quot;cname&quot;) {
@@ -194,13 +194,13 @@
 			my %classes = %$classes_ref;
 			$methods_ref = $classes{$class}[0];
 			$signals_ref = $classes{$class}[1];
-			$properties_ref = $classes{$class}[2];
+			$members_ref = $classes{$class}[2];
 
 			if ({%$classes_ref}-&gt;{$class}) {
 			    addClassData ($doc, $node, $class, $data_list_ref);
 			}
 
-			next if not ($methods_ref or $signals_ref or $properties_ref);
+			next if not ($methods_ref or $signals_ref or $members_ref);
 
 			for ($method_node = $node-&gt;firstChild; $method_node; $method_node = $method_node-&gt;nextSibling ()) {
 				next if not ($method_node-&gt;nodeName eq &quot;method&quot; or $method_node-&gt;nodeName eq &quot;constructor&quot;);
@@ -230,26 +230,24 @@
 				fixupParams ($signal_node, $data_list_ref);
 			}
 
-			for ($property_node = $node-&gt;firstChild; $property_node; $property_node = $property_node-&gt;nextSibling ()) {
-				next if $property_node-&gt;nodeName ne &quot;property&quot;;
-				my $property;
-				foreach $attr ($property_node-&gt;attributes) {
+			for ($member_node = $node-&gt;firstChild; $member_node; $member_node = $member_node-&gt;nextSibling ()) {
+				next if $member_node-&gt;nodeName ne &quot;property&quot; and $member_node-&gt;nodeName ne &quot;member&quot;;
+				my $member;
+				foreach $attr ($member_node-&gt;attributes) {
 					if ($attr-&gt;name eq &quot;name&quot;) {
-						$property = $attr-&gt;value;
+						$member = $attr-&gt;value;
 						last;
 					}
 				}
-				next if not ${$properties_ref}{$property};
+				next if not ${$members_ref}{$member};
 
 				foreach $data (@$data_list_ref) {
-					if ($$data[1] eq &quot;property&quot;) {
-						$property_node-&gt;setAttribute ($$data[5], $$data[6]);
+					if ($$data[1] eq &quot;property&quot; or $$data[1] eq &quot;member&quot;) {
+						$member_node-&gt;setAttribute ($$data[5], $$data[6]);
 						next;
 					}
 				}
-
 			}
-
 		}
 	}
 }

--------------060807090801030403020103--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002338.html">[Gtk-sharp-list] patch: gapi.pl allows renaming of enum and
 enum members
</A></li>
	<LI> Next message: <A HREF="002359.html">[Gtk-sharp-list] patch: gapi.pl allows renaming of enum
 and	enum members
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2341">[ date ]</a>
              <a href="thread.html#2341">[ thread ]</a>
              <a href="subject.html#2341">[ subject ]</a>
              <a href="author.html#2341">[ author ]</a>
         </LI>
       </UL>
</body></html>
