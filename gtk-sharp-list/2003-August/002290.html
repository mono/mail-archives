<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Gtk# - Glade#. Problems, a newbie is starting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:eureko%40grmexico.com.mx">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002287.html">
   <LINK REL="Next"  HREF="002291.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Gtk# - Glade#. Problems, a newbie is starting
   </H1>
    <B>Gustavo Ramos
    </B> 
    <A HREF="mailto:eureko%40grmexico.com.mx"
       TITLE="[Gtk-sharp-list] Gtk# - Glade#. Problems, a newbie is starting">eureko@grmexico.com.mx
       </A><BR>
    <I>Wed, 20 Aug 2003 02:53:16 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="002287.html">[Gtk-sharp-list] Gtk# - Glade#. Problems, a newbie is starting
</A></li>
        <LI> Next message: <A HREF="002291.html">[Gtk-sharp-list] problems with gconf list type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2290">[ date ]</a>
              <a href="thread.html#2290">[ thread ]</a>
              <a href="subject.html#2290">[ subject ]</a>
              <a href="author.html#2290">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>See answers below...

&gt;<i> class MainWindow
</I>&gt;<i> 	{
</I>&gt;<i> 		int retValLogin = -1;
</I>&gt;<i> 		[Glade.Widget(&quot;wndMain&quot;)]
</I>&gt;<i> 		Gtk.Window wndMain;
</I>&gt;<i>   		static void Main()
</I>&gt;<i> 			{
</I>&gt;<i> 				Appliction.Init();
</I>&gt;<i> 				Glade.XML gXML = new
</I>&gt;<i> Glade.XML(null, &quot;file.glade&quot;, &quot;wndMain&quot;, null);
</I>&gt;<i> 				gXML.Autoconnect(this);
</I>&gt;<i> 				Application.Run();
</I>&gt;<i> 			}
</I>&gt;<i>
</I>&gt;<i> 		public void on_mnuLogin_clicked(System.Object
</I>&gt;<i> Sender, EventArgs args)
</I>&gt;<i> 			{
</I>&gt;<i> 				Login x = new Login(ref retValLogin);
</I>&gt;<i> 				x.Show();
</I>&gt;<i> 				Console.WriteLine(&quot;This is executed
</I>&gt;<i> inmediatly after the Show method.&quot;);
</I>&gt;<i> 			}
</I>&gt;<i> 	}
</I>&gt;<i>
</I>&gt;<i> class Login()
</I>&gt;<i>    {
</I>&gt;<i> 		[Glade.Widget(&quot;wndLogin&quot;)]
</I>&gt;<i> 		Gtk.Window wndLogin;
</I>&gt;<i> 		int ret;
</I>&gt;<i> 		public Login(ref int retval)
</I>&gt;<i> 		{
</I>&gt;<i> 			ret = retval;
</I>&gt;<i> 		}
</I>&gt;<i> 		public void Show()
</I>&gt;<i> 		{
</I>&gt;<i> 			Glade.XML gLogin = new Glade.XML(null,
</I>&gt;<i> &quot;file.glade&quot;, &quot;wndLogin&quot;, null);
</I>&gt;<i> 			gLogin.Autoconnect(this);
</I>&gt;<i>
</I>&gt;<i> 		}
</I>&gt;<i> 		public void on_btnLogin_clicked(System.Object
</I>&gt;<i> Sender, EventArgs args)
</I>&gt;<i> 		{
</I>&gt;<i> 			ret = 1;
</I>&gt;<i> 			wndLogin.Destroy();
</I>&gt;<i> 		}
</I>&gt;<i> 		public void on_btnLogin_clicked(System.Object
</I>&gt;<i> Sender, EventArgs args)
</I>&gt;<i> 		{
</I>&gt;<i> 			ret = 0;
</I>&gt;<i> 			wndLogin.Destroy();
</I>&gt;<i> 		}
</I>&gt;<i>    }
</I>
&gt;<i> The problem of this code is that i must to give reference variables to
</I>&gt;<i> return value to class MainWindow from Login class.
</I>&gt;<i> I do this beacause when i call Method Show, the program &quot;flow&quot;
</I>&gt;<i> does not go
</I>&gt;<i> with the method. It means that execute the show
</I>&gt;<i> method and return the flow control, and execute the next code in caller
</I>&gt;<i> code.
</I>&gt;<i> It Is this correct? it is &quot;the&quot; way to do this?
</I>
I would love to use wnd.ShowDialog() instead .Show(). That way, the control
would return only when the dialog has been closed, and you should be able to
access public members of the dialog. Somewhat like
public void on_mnuLogin_clicked(System.Object Sender, EventArgs args)
{
	Login x = new Login();
	x.ShowDialog();
	Console.WriteLine(&quot;The value on the Login window is {0}.&quot;,
		x.MyValue.ToString());
}
...but that isn't the case, I don't know if that is possible. I'll read
about it tomorrow.

&gt;<i> It Is this the only way to return values? beacause i must return
</I>&gt;<i> the value  when the BtnLogin is clicked.
</I>
No, you can use events for dealing return values of non-modal windows. See
the
sample below (note that i am not very familiar with glade, gladelib and
friends, so, I've left the glade things almost as you has posted it). For
this to work, we need: a special EventArgs class that will return the value
we want to know (LoginEventArgs); a public delegate that &quot;declares&quot; the
signature of the event-consumer function (LoginEventHandler); a public event
inside the Login class (OnLogin); a client event-subscriber function
(OnLoginAttempt); and some event-publisher code (the code inside
on_btnLogin_clicked).

class App
{
	public static void Main()
	{
		Application.Init();
		// init and autoconnect things here

	}

	public void on_mnuLogin_clicked(System.Object Sender, EventArgs args)
	{
		Login x = new Login(0); // Default value = 0
		x.OnLogin += new LoginEventHandler(OnLoginAttempt);
		x.Show();
	}

	public void OnLoginAttempt(object sender, LoginEventArgs e)
	{
		Console.WriteLine(&quot;The value sent by the Login window is {0}.&quot;,
			e.ReturnValue.ToString());
	}
}

public class LoginEventArgs : EventArgs
{
	int retVal;
	public LoginEventArgs(int returnValue)
	{
		retVal = returnValue;
	}
	public int ReturnValue
	{
		get { return retVal; }
	}
}

public delegate LoginEventHandler(object sender, LoginEventArgs e);
class Login()
{
	[Glade.Widget(&quot;wndLogin&quot;)]
	Gtk.Window wndLogin;
	int ret;
	public Login(int defaultValue)
	{
		ret = defaultValue;
	}
	public void Show()
	{
		Glade.XML gLogin = new Glade.XML(null,
			&quot;file.glade&quot;, &quot;wndLogin&quot;, null);
		gLogin.Autoconnect(this);
	}
	public event LoginEventHandler OnLogin;
	public void on_btnLogin_clicked(System.Object Sender, EventArgs args)
	{
		ret = 1;
		if ( OnLogin != null )
		{
			LoginEventArgs lea = new LoginEventArgs(ret);
			OnLogin(lea);
		}
		wndLogin.Destroy();
	}

	// why this function is declared twice? Note that i changed slightly the
name
	public void on_btnLogin_clicked2(System.Object Sender, EventArgs args)
	{
		ret = 0;
		if ( OnLogin != null )
		{
			LoginEventArgs lea = new LoginEventArgs(ret);
			OnLogin(lea);
		}		wndLogin.Destroy();
	}
	public void on_btnCancel_clicked(object sender, EventArgs e)
	{
		wndLogin.Destroy();
	}
}

&gt;<i> It is the way to show windows creating an instance of Glade.XML?
</I>
I'm not sure


&gt;<i> What does Application.Init and Application.Run? (This is Off-Topic, but i
</I>&gt;<i> dont know to)
</I>
Please post other message with that question, it will be easier to find
later.


&gt;<i> I'm doing to much questions? :P (do not response this)
</I>
Yes. Oops! It is already responded :-)


&gt;<i> And I have other problemas. When i do a window in Glade, with a NoteBook
</I>&gt;<i> (control) inside (2 Panels) and
</I>&gt;<i> I run this window in my applicacion I have some Warning error, and the
</I>&gt;<i> window show without the NoteBook Control.
</I>
I had similar problems when creating all the controls manually, but luckily
solved that. I'm not sure how to fine-tune the properties assignment with
glade. My mistake was:
this.Add(textView) instead of this.scrollableWindow.Add(textView)


&gt;<i> The same problem with Default Button in a window, It give me some Warning
</I>&gt;<i> Advice and no default button is set.
</I>
In glade don't set any widget as default. After autoconnecting, set the
desiredControl.CanDefault property to true, and later, do a call to
desiredControl.GrabDefault()


&gt;<i> An at last the same problem with Sensitive Property (set in glade
</I>&gt;<i> interfase) in a button that is inside of a toolbar.
</I>
/// TODO: I have to learn at least two words about the Sensitive property
:<i>-)
</I>

&gt;<i> Wath kind of error are this? are bugs? i must report them? someone have
</I>&gt;<i> tested this thinks?
</I>
Please report the glade# issues using bugzilla.ximian.com, so the bug are
attacked when a developer think: What's next? (and it won't be forgiven).


&gt;<i>
</I>&gt;<i> It will be very helpfull some information, (im thinking in kill
</I>&gt;<i> myself for
</I>&gt;<i> this problem :P ) And THANKS TO ALL.
</I>
I don't have a spoon nearby me for you :-)


A last word: Please DONT expect me to answer always. Today the answer is
just because yesterday I've learnt a lot on gtk#

Other last word: Please post just one question per message, in the simplest
form.

Best Regards,
Gustavo, Mexico



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002287.html">[Gtk-sharp-list] Gtk# - Glade#. Problems, a newbie is starting
</A></li>
	<LI> Next message: <A HREF="002291.html">[Gtk-sharp-list] problems with gconf list type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2290">[ date ]</a>
              <a href="thread.html#2290">[ thread ]</a>
              <a href="subject.html#2290">[ subject ]</a>
              <a href="author.html#2290">[ author ]</a>
         </LI>
       </UL>
</body></html>
