<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] printing multiple pages with Gtk#
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20printing%20multiple%20pages%20with%20Gtk%23&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008518.html">
   <LINK REL="Next"  HREF="008520.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] printing multiple pages with Gtk#</H1>
    <B>Jestin Stoffel</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20printing%20multiple%20pages%20with%20Gtk%23&In-Reply-To="
       TITLE="[Gtk-sharp-list] printing multiple pages with Gtk#">jestin.stoffel at gmail.com
       </A><BR>
    <I>Sat Mar 22 23:02:40 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008518.html">[Gtk-sharp-list] Menu Item
</A></li>
        <LI>Next message: <A HREF="008520.html">[Gtk-sharp-list] printing multiple pages with Gtk#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8519">[ date ]</a>
              <a href="thread.html#8519">[ thread ]</a>
              <a href="subject.html#8519">[ subject ]</a>
              <a href="author.html#8519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>About a month ago there was some discussion about printing in gtk-sharp,
and I have recently had a need to give it a try.  One of my problems is
that I want to print the content of a widget that will most likely have
multiple pages.  To set the number of pages, I need to reference my
Gtk.PrintOperation object from my BeginPrintHandler (as the Gtk
documentation suggests).  The problem is, that my object is out of
scope.  Here's an example:

protected virtual void OnPrintButtonClicked (object sender,
System.EventArgs e)
{
	Gtk.PrintOperation Op = new PrintOperation();

	Op.Unit = Gtk.Unit.Pixel;
	Op.BeginPrint += new BeginPrintHandler(OnBeginPrint);
	Op.DrawPage += new DrawPageHandler(OnDrawPage);
	
	Res = Op.Run(Gtk.PrintOperationAction.PrintDialog, this);
}

public void OnBeginPrint(object sender, Gtk.BeginPrintArgs Args)
{
	int nSize = SomeSizeCalculationFunction();
		
	int nPages = nSize / (int)Args.Context.Height;
		
	if(nSize % Args.Context.Height &gt; 0)
	{
		nPages++;
	}
	
	Op.NPages = nPages; // OUT OF SCOPE
}

This can be easily solved by making Op global, but isn't there a way to
include Op in the Gtk.BeginPrintArgs object?  Right now the only thing
it contains is the PrintContext, which is also needed, but is only one
factor in the page count calculation.

This isn't a problem in C, because the parameters passed to a BeginPrint
signal handler include the PrintOperation pointer.  I just thought that
maybe the C# handler should match.

--Jestin

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008518.html">[Gtk-sharp-list] Menu Item
</A></li>
	<LI>Next message: <A HREF="008520.html">[Gtk-sharp-list] printing multiple pages with Gtk#
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8519">[ date ]</a>
              <a href="thread.html#8519">[ thread ]</a>
              <a href="subject.html#8519">[ subject ]</a>
              <a href="author.html#8519">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
