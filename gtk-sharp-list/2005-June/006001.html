<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Problem when desensitizing button
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Problem%20when%20desensitizing%20button&In-Reply-To=1119012620.7918.151.camel%40twelve-monkeys.boston.ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005997.html">
   <LINK REL="Next"  HREF="005998.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Problem when desensitizing button</H1>
    <B>Alexandros Frantzis</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Problem%20when%20desensitizing%20button&In-Reply-To=1119012620.7918.151.camel%40twelve-monkeys.boston.ximian.com"
       TITLE="[Gtk-sharp-list] Problem when desensitizing button">alfius at freemail.gr
       </A><BR>
    <I>Fri Jun 17 11:57:38 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="005997.html">[Gtk-sharp-list] Problem when desensitizing button
</A></li>
        <LI>Next message: <A HREF="005998.html">[Gtk-sharp-list] No   Atk.Global.AddGlobalEventListener ??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6001">[ date ]</a>
              <a href="thread.html#6001">[ thread ]</a>
              <a href="subject.html#6001">[ subject ]</a>
              <a href="author.html#6001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2005-06-17 at 08:50 -0400, Dan Winship wrote:
&gt;<i> On Fri, 2005-06-17 at 13:26 +0300, Alexandros Frantzis wrote:
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; after clicking on a Gtk.Button, I desensitize it so that I can't click
</I>&gt;<i> &gt; it again until an (asynchronous) operation finishes. The problem is that
</I>&gt;<i> &gt; when the operation finishes and I make the button sensitive again, the
</I>&gt;<i> &gt; button can't be clicked immediately! I must first move the mouse cursor
</I>&gt;<i> &gt; outside the button and then in again before I am able to click.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Is there way around this?
</I>&gt;<i> 
</I>&gt;<i> No, this is an old gtk bug
</I>&gt;<i> (<A HREF="http://bugzilla.gnome.org/show_bug.cgi?id=56070">http://bugzilla.gnome.org/show_bug.cgi?id=56070</A>). It's not easy to fix
</I>&gt;<i> the way that gtk currently works.
</I>&gt;<i> 
</I>
After I playing around a bit, I have found a quick and dirty way to make
the button act as expected: hide and immediately show the button after
making it sensitive. I don't know the amount of overhead this incurs but
I think its small enough for normal buttons and usage. At least I can
have correct button behaviour until the bug gets fixed in gtk+ (if
ever).

The whole thing can be done manually right after setting
button.Sensitive to true, or in a StateChanged handler as in the example
below. 

I hope this is useful,
Alexandros

---- Code Start ----
using System;
using Gtk;

class ButtonTest
{
	Window win;
	Button button;
	
	public static void Main(string[] args)
	{
		Application.Init();
		new ButtonTest();
		Application.Run();	
	}

	public ButtonTest()
	{
		win = new Window(&quot;Button Test&quot;);
		win.DeleteEvent += OnWindowDeleteEvent;
		
		button=new Button(&quot;Click me&quot;);
		button.Clicked += OnButtonClicked;
		button.StateChanged += OnButtonStateChanged;
		
		win.Add(button);
		win.ShowAll();
	}

	void OnButtonClicked(object o, EventArgs args)
	{
		button.Sensitive = false;
		Console.WriteLine(&quot;Click!&quot;);
		
		GLib.Timeout.Add(1000, OnTimeoutExpired);
	}
	
	bool OnTimeoutExpired()
	{
		button.Sensitive = true;
				
		return false;
	}
	
	void OnButtonStateChanged(object o, StateChangedArgs args)
	{
		StateType prevState = args.PreviousState;
		
		if (prevState == StateType.Insensitive
		    &amp;&amp; button.State == StateType.Normal) {
			button.Visible=false;
			button.Visible=true;
		}
	}
	
	void OnWindowDeleteEvent(object o, EventArgs args)
	{
		Application.Quit();
	}

}
---- Code End ----

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005997.html">[Gtk-sharp-list] Problem when desensitizing button
</A></li>
	<LI>Next message: <A HREF="005998.html">[Gtk-sharp-list] No   Atk.Global.AddGlobalEventListener ??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6001">[ date ]</a>
              <a href="thread.html#6001">[ thread ]</a>
              <a href="subject.html#6001">[ subject ]</a>
              <a href="author.html#6001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
