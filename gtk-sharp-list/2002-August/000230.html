<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] LibGlade
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lupus%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000229.html">
   <LINK REL="Next"  HREF="000231.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] LibGlade
   </H1>
    <B>Paolo Molaro
    </B> 
    <A HREF="mailto:lupus%40ximian.com"
       TITLE="[Gtk-sharp-list] LibGlade">lupus@ximian.com
       </A><BR>
    <I>Sat, 17 Aug 2002 15:41:35 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000229.html">[Gtk-sharp-list] LibGlade
</A></li>
        <LI> Next message: <A HREF="000231.html">[Gtk-sharp-list] LibGlade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#230">[ date ]</a>
              <a href="thread.html#230">[ thread ]</a>
              <a href="subject.html#230">[ subject ]</a>
              <a href="author.html#230">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/16/02 Mike Kestner wrote:
&gt;<i> If you look at glib/SList.cs, it is currently a subclass of ArrayList,
</I>&gt;<i> although it will most likely just be an implementor of IList in the end.
</I>&gt;<i> Taking this approach allows us to put all the marshaling logic inside
</I>&gt;<i> the type itself instead of having to generate a lot of ugly code all
</I>&gt;<i> through the binding to accomplish the marshaling from an ArrayList. As
</I>&gt;<i> long as the type exposes the IList interface, I don't see what your
</I>&gt;<i> issue is.  It can be used just like an ArrayList. It's a hand wrapped
</I>
My issue is with:
	public class SList 
	[...]
	public SList (IntPtr raw)

If the type is made internal and exposed only as an IList reference
I would have no problems.

&gt;<i> &gt; The same goes for other internal details of the Gtk+ C API, like, the
</I>&gt;<i> &gt; use of IntPtr.Zero should be never required to write a Gtk# program, it
</I>&gt;<i> &gt; just doesn't belong to a C# interface. Also, eliminating it will give
</I>&gt;<i> &gt; us some chance of using Gtk# in untrusted code.
</I>&gt;<i> 
</I>&gt;<i> This is mostly a non issue already.  Null handling has been added that
</I>&gt;<i> maps null parameters to IntPtr.Zero for marshaling.  As new parameters
</I>&gt;<i> are discovered, we are marking them null-ok in the XML.
</I>
That is only one of the issues. Look at this:

	public Object (IntPtr raw) (in glib/Object.cs)

What happens if I pass an arbitrary value in there?
I'm just raising the issue: do we want to be able to make untrusted code
that uses Gtk safely? I think it's a worthwhile target.
I don't have a solution, I didn't look at the binding design, but I
think we should take it into account (and the above entry point makes
it impossible to run safely untrusted code that uses Gtk#).

&gt;<i> &gt; Well, I have also a third: C# won't be the only language to use the
</I>&gt;<i> &gt; binding to Gtk. I would be nice to have the binding be a thin wrapper of
</I>&gt;<i> &gt; the C API and have Gtk# on top of that to provide the C#-way of doing
</I>&gt;<i> &gt; things, while other languages will be able to reuse the binding to
</I>&gt;<i> &gt; implement the interface to their language as best as it suits _that_
</I>&gt;<i> &gt; language.
</I>&gt;<i> 
</I>&gt;<i> I don't know if this is a signal handling troll, or what exactly your
</I>&gt;<i> point here is.  :)  There is nothing C# specific that we are doing.  We
</I>&gt;<i> are generating a set of IL classes that correspond to the paradigms set
</I>&gt;<i> forth in the BCL.  It is up to the language implementor to interact with
</I>&gt;<i> these classes in a manner stylistically correct for that language.
</I>
Exactly. The binding is made to match the BCL rules (i.e. the C#
paradigms), instead of following the Gtk API and exposing a
BCL-conforming interface based on that.

From a purely hypothetical point of view: I'm porting jpython to run on
the mono CLR and I want to be able to run existing python gtk programs.
Of course it would be very silly to write a new binding to libgtk that
follows the (established) python way of doing the binding (usually a
thin wrapper on the C API).
With the current gtk# binding, the call chain for the python code:

	win.show_all ()

will look like:

	win.show_all ()
	-&gt; win.ShowAll ();
	   -&gt; gtk_widget_show_all (IntPtr raw);

Now, there are three issues with that:
1) an extra method call (minor, I know, but why impose it?)
2) mapping name issue: the python binding needs to map its
method names based on the C API to the almost arbitrary BCL-compatible
name (when it would be enough to just s/gtk_widget_//)
3) it would not be enough to make gtk_widget_show_all() public, because
of the IntPtr type that is exposed (again, I think exposing methods that
take IntPtr is dangerous and I would limit it also in the internals of
the binding).

So, my suggestion is to have the binding expose a thin wrapper over the
C API and have the C# side of it provide the BCL-conforming method
names, permitting other languages to reuse their existing mapping of the
Gtk+ API without adding an extra layer that maps to the BCL-accepted names
(the imposed layer is a slight overhead at runtime, but a big wall to climb to
have an existing binding work within the CLR).

lupus

-- 
-----------------------------------------------------------------
<A HREF="mailto:lupus@debian.org">lupus@debian.org</A>                                     debian/rules
<A HREF="mailto:lupus@ximian.com">lupus@ximian.com</A>                             Monkeys do it better


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000229.html">[Gtk-sharp-list] LibGlade
</A></li>
	<LI> Next message: <A HREF="000231.html">[Gtk-sharp-list] LibGlade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#230">[ date ]</a>
              <a href="thread.html#230">[ thread ]</a>
              <a href="subject.html#230">[ subject ]</a>
              <a href="author.html#230">[ author ]</a>
         </LI>
       </UL>
</body></html>
