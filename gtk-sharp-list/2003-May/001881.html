<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] GConf wrapping
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:pbaena%40uol.com.ar">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001875.html">
   <LINK REL="Next"  HREF="001854.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] GConf wrapping
   </H1>
    <B>Pablo Baena
    </B> 
    <A HREF="mailto:pbaena%40uol.com.ar"
       TITLE="[Gtk-sharp-list] GConf wrapping">pbaena@uol.com.ar
       </A><BR>
    <I>12 May 2003 06:48:33 +0000</I>
    <P><UL>
        <LI> Previous message: <A HREF="001875.html">[Gtk-sharp-list] GConf wrapping
</A></li>
        <LI> Next message: <A HREF="001854.html">[Gtk-sharp-list] problem with Gnome.About
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1881">[ date ]</a>
              <a href="thread.html#1881">[ thread ]</a>
              <a href="subject.html#1881">[ subject ]</a>
              <a href="author.html#1881">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-nwjqIeM6BK56rsFCl8tZ
Content-Type: multipart/related; type=&quot;multipart/alternative&quot;; boundary=&quot;=-L3dwK4nlFvMCjQrRtxmJ&quot;


--=-L3dwK4nlFvMCjQrRtxmJ
Content-Type: multipart/alternative; boundary=&quot;=-GYmCY2ypMZ8fc3Zjb7pa&quot;


--=-GYmCY2ypMZ8fc3Zjb7pa
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Attached is the documentation to GConf#. I tried to make it as easy to
understand as possible, and provided some introduction to GConf to
first-starters like me. :)

Sorry for not sending a diff, but I cannot check out all the
MonkeyGuide. Right now I have an sporadic connection to the Internet,
that I have to administer as if it were a telephone call to Japan.

This is suppossed to be complementary of Rachel Hestilow's
documentation, to be put before her documentation of the GConf# binding.

On Sun, 2003-05-11 at 00:55, Miguel de Icaza wrote:

&gt;<i> Hello!
</I>&gt;<i> 
</I>&gt;<i> &gt; Remember my old GeSettings little project to replace GConf?. Well,
</I>&gt;<i> &gt; after some enlightenment by somebody I realized I could use GConf to
</I>&gt;<i> &gt; do the same thing without creating a schema. Because my first contact
</I>&gt;<i> &gt; with GConf was with GConf#, I thought it was mandatory to create and
</I>&gt;<i> &gt; install a schema and that's why all my whining was about.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thank god I realized this before creating my own settings daemon!!! :)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I'll contribute some documentation for GConf# to warn future users of
</I>&gt;<i> &gt; this, and to point them to my little library that makes using GConf#
</I>&gt;<i> &gt; easier, as soon as I get an Internet connection (I'm phoneless for a
</I>&gt;<i> &gt; while) and could commit my code to my CVS repository. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; At least this will be one less thing to learn when people start using
</I>&gt;<i> &gt; Gtk#.
</I>&gt;<i> 
</I>&gt;<i> Would you be interested in helping to the GNOME.NET tutorial?  That
</I>&gt;<i> seems like a good place to start.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Gtk-sharp-list maillist  -  <A HREF="mailto:Gtk-sharp-list@lists.ximian.com">Gtk-sharp-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">http://lists.ximian.com/mailman/listinfo/gtk-sharp-list</A>
</I>
-- 
Pablo Baena &lt;<A HREF="mailto:pbaena@uol.com.ar">pbaena@uol.com.ar</A>&gt;

--=-GYmCY2ypMZ8fc3Zjb7pa
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: 7bit

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 TRANSITIONAL//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
  &lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; CHARSET=UTF-8&quot;&gt;
  &lt;META NAME=&quot;GENERATOR&quot; CONTENT=&quot;GtkHTML/1.1.10&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
Attached is the documentation to GConf#. I tried to make it as easy to understand as possible, and provided some introduction to GConf to first-starters like me. &lt;IMG SRC=&quot;cid:<A HREF="mailto:1052721581.28294.2.camel@hal">1052721581.28294.2.camel@hal</A>&quot; ALIGN=&quot;middle&quot; ALT=&quot;:)&quot; BORDER=&quot;0&quot;&gt;&lt;BR&gt;
&lt;BR&gt;
Sorry for not sending a diff, but I cannot check out all the MonkeyGuide. Right now I have an sporadic connection to the Internet, that I have to administer as if it were a telephone call to Japan.&lt;BR&gt;
&lt;BR&gt;
This is suppossed to be complementary of Rachel Hestilow's documentation, to be put before her documentation of the GConf# binding.&lt;BR&gt;
&lt;BR&gt;
On Sun, 2003-05-11 at 00:55, Miguel de Icaza wrote:
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#737373&quot; SIZE=&quot;3&quot;&gt;&lt;I&gt;Hello!

&amp;gt;<i> Remember my old GeSettings little project to replace GConf?. Well,
</I>&amp;gt;<i> after some enlightenment by somebody I realized I could use GConf to
</I>&amp;gt;<i> do the same thing without creating a schema. Because my first contact
</I>&amp;gt;<i> with GConf was with GConf#, I thought it was mandatory to create and
</I>&amp;gt;<i> install a schema and that's why all my whining was about.
</I>&amp;gt;<i> 
</I>&amp;gt;<i> Thank god I realized this before creating my own settings daemon!!! :)
</I>&amp;gt;<i> 
</I>&amp;gt;<i> I'll contribute some documentation for GConf# to warn future users of
</I>&amp;gt;<i> this, and to point them to my little library that makes using GConf#
</I>&amp;gt;<i> easier, as soon as I get an Internet connection (I'm phoneless for a
</I>&amp;gt;<i> while) and could commit my code to my CVS repository. 
</I>&amp;gt;<i> 
</I>&amp;gt;<i> At least this will be one less thing to learn when people start using
</I>&amp;gt;<i> Gtk#.
</I>
Would you be interested in helping to the GNOME.NET tutorial?  That
seems like a good place to start.
_______________________________________________
Gtk-sharp-list maillist  -  <A HREF="mailto:Gtk-sharp-list@lists.ximian.com">Gtk-sharp-list@lists.ximian.com</A>&lt;/FONT&gt;
&lt;A HREF=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list"">http://lists.ximian.com/mailman/listinfo/gtk-sharp-list&quot;</A>&gt;&lt;FONT SIZE=&quot;3&quot;&gt;<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list</I">http://lists.ximian.com/mailman/listinfo/gtk-sharp-list&lt;/I</A>&gt;&lt;/FONT&gt;&lt;/A&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;PRE&gt;&lt;TABLE CELLSPACING=&quot;0&quot; CELLPADDING=&quot;0&quot; WIDTH=&quot;100%&quot;&gt;
&lt;TR&gt;
&lt;TD&gt;
-- &lt;BR&gt;
Pablo Baena &amp;lt;&lt;A HREF=&quot;mailto:<A HREF="mailto:pbaena@uol.com.ar">pbaena@uol.com.ar</A>&quot;&gt;<A HREF="mailto:pbaena@uol.com.ar">pbaena@uol.com.ar</A>&lt;/A&gt;&amp;gt;
&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;/PRE&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

--=-GYmCY2ypMZ8fc3Zjb7pa--

--=-L3dwK4nlFvMCjQrRtxmJ
Content-ID: &lt;<A HREF="mailto:1052721581.28294.2.camel@hal">1052721581.28294.2.camel@hal</A>&gt;
Content-Disposition: attachment; filename=smiley-3.png
Content-Type: image/png; name=smiley-3.png
Content-Transfer-Encoding: base64

iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC+klEQVR42n2TbUjVdxTHP/+H69Xd
a2VWlFe69rzthZJUoxeNOWoFGxEhYRRFmZSVW2u9ab2KejWE1qDNBkEQhS82VoiaZkVPmoWaKNM5
mA+opbd771//997//T/+epHBarEPHA6Hc84XDnwP/JcwcBS4AVgzcR04ONN7C+md+pcPCz44dPLA
arZs/gg1UABuGkvvp7X1Iad+itE/YtUAle8TuH26sujzqq/LkJQsnOQQVmIASVJQMhehZORiJwc5
d76FH2pf3gY2Aigzy7+eObqmtOqbXbjGGHZqCM+eQpJ9AHhWFCc5CAjWf1KAkppc+qg3vRCol4Fw
0aqcisOVW3HTE7hmBElSKD/5GFkNMhH1KDvegST78CwNSfZxeM88VuYrh4CwAuxqvxL6MnPuWiy9
H1kNUPH9fZofDKPpHn8/z+Z6Yw8JK5stX5VhRO6h+OfiV3WaHxtPVKAwmF+KqXUDMkgqZ0+UoKcE
P57/GXOqh46ODqrPXUQfufb6YOGxJOQD2CaHQnnlAJ4zDXggHBYvK6ap6Rau+RIz1k7djd+YHrqM
pXUC4KQnWTRPAdiuRqNRkFQG/omRNJOsKVQw408xtS4QDsI10AaqEY6O8Fzq70fJy3XI8gsA5HTa
rBdOkvwFKj39EWrr/sJzEnj29OvsphGugfBsLlwbZnjcYN36LxiLuADtMtCUetFAcE4ee8s+pbHV
YtOemwhHx3MSaPEY3X9OUnqsk5a2OMeP7KC3t4u+3gRALUC4cEW2eN62Q4ze3SAiz74TDxvOiI+X
BcTsoCoyfJKYn6OKmrMbxGRnlXhyJSSqv80Vq0KSAFa+ceKl0wcK9lfsW42TGsE/pxhfcDmKfz6e
FUPg4iRH6Ov6g9EJh1t341xusWuAyn9b+c7BrbklJ8oDZGTOQpL9ePY08SmDpCEwbcHwuE370yku
Nlj3gM/e90yXliyU9+8sCVJYlEUgU8IwBZruMThm83uzxsAYV4Hd/A9h4BjQBthAFOgDLgDF7w6/
ArI6YJ0eTQeGAAAAAElFTkSuQmCC

--=-L3dwK4nlFvMCjQrRtxmJ--

--=-nwjqIeM6BK56rsFCl8tZ
Content-Disposition: attachment; filename=gconf_tutorial.html
Content-Type: text/html; name=gconf_tutorial.html; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

&lt;h1&gt;GConf# tutorial&lt;/h1&gt;

&lt;h2&gt;GConf introduction&lt;/h2&gt;

&lt;p&gt;GConf is a system for storing configuration information and maintaining
it across application sessions, much like the Windows registry but more 
powerful. The complete documentation for the underlying technology is 
&lt;a href=&quot;<A HREF="http://developer.gnome.org/doc/API/gconf/index.html"">http://developer.gnome.org/doc/API/gconf/index.html&quot;</A>&gt;here&lt;/a&gt;, but
as we Mono users are very high-level people (at the programming level, at 
least), I'll show you a quick and simple example of how to use it.&lt;/p&gt;

&lt;h2&gt;The GConf# binding&lt;/h2&gt;

&lt;p&gt;In this example, we just create a Mono program that stores and retrieves
a value from GConf.&lt;/p&gt;

&lt;pre&gt;
using System;
class GConfExample
{
	static GConf.Client gconfClient = new GConf.Client ();

	public static void Main ()
	{
		string key = &quot;/apps/monoapps/myAppName/mySetting&quot;;
		try
		{
			string val = (string) gconfClient.Get (key);
			Console.WriteLine (&quot;The value is: '{0}'&quot;, val);
		}
		catch (GConf.NoSuchKeyException)
		{
			Console.WriteLine (&quot;The value is not set. Setting it for the next time.&quot;);
			gconfClient.Set (key, &quot;Value&quot;);	
		}
	}
}
&lt;/pre&gt;

&lt;p&gt;Remember to add a reference to gconf-sharp.dll in the Mono C# compiler 
command line. If you don't have it installed, remember that GConf#
is part of the Gtk# bindings, although it can be in a separated package
(GConf doesn't depend on Gtk).&lt;/p&gt;

&lt;p&gt;The 'key' used in the example, is a slash-separated path similar
to the ones used in the UNIX filesystem. Each slash denotes a level
in the GConf namespace. We use the apps/monoapps/ sub-level only 
to organize the tree in an orderly fashion. 
If you have the gconf-editor program installed, you can run it and
look for the key yourself in the tree structure. You'll see it stored
with the value we put it, so the next time you run the program,
it will retrieve the stored value.&lt;/p&gt;

&lt;p&gt;There is a nifty feature of GConf that lets you notify your program
whenever a key's value is changed, either in your program or externally
(i.e. via gconf-editor). You only have to attach a GConf.NotifyEventHandler
delegate to a key, this way:&lt;/p&gt;
&lt;code&gt;
gconfClient.AddNotify (key, new GConf.NotifyEventHandler(function));
&lt;/code&gt;
&lt;p&gt;
This is very important for graphic interfaces, as it is a good practice
to make the application react instantly to preference changes.&lt;/p&gt;

&lt;h2&gt;A quicker way&lt;/h2&gt;

&lt;p&gt;The above example is perfect for a single setting, but what
if our application needs to store more settings, and we want 
to provide default values for some of our preferences
for when they aren't set. Or even more, we want to store data
types other than only strings. You have three options: 

&lt;ul&gt;
&lt;li&gt;to repeat the above example for all the settings, which is monkey 
labour&lt;/li&gt;
&lt;li&gt;to use a &lt;i&gt;schema&lt;/i&gt;, which is explained below but it's just too
much work&lt;/li&gt;
&lt;li&gt;use a little library I created for automating this, in which
Mono does what it is meant to, the monkey labour!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I'll explain the latter option so that you can see how Mono can 
turn some things that were very complicated into very easy ones. 
This is an example of the use of my library.&lt;/p&gt;

&lt;pre&gt;
using System;

interface IMySettings 
{
	[GeSettings.Property (&quot;myMonoApp&quot;, 10)]
	int SomeNumber
	{
		get; 
		set;
	}
	event GConf.NotifyEventHandler SomeNumberChanged;

	[GeSettings.Property (&quot;myMonoApp&quot;, 1.4)]
	double SomeDoubleNumber
	{
		get; 
		set;
	}
}

class GConfExample2
{
	public static void Main ()
	{
		IMySettings mySettings = (IMySettings) 
			GeSettings.Builder.Build (typeof(IMySettings));

		mySettings.SomeNumberChanged += 
			new GConf.NotifyEventHandler (OnSomeNumberChanged);

		Console.WriteLine (&quot;Value of 'SomeNumber': {0}&quot;, 
				mySettings.SomeNumber);

		Console.WriteLine (&quot;Value of 'SomeDoubleNumber': {0}&quot;, 
				mySettings.SomeDoubleNumber);

		mySettings.SomeNumber = 14;
		mySettings.SomeDoubleNumber = 3.1;
	}

	static void OnSomeNumberChanged (object o, GConf.NotifyEventArgs a)
	{
		Console.WriteLine (&quot;SomeNumber changed&quot;);
	}
}
&lt;/pre&gt;


&lt;p&gt;To compile this example you'll have to reference gconf-sharp.dll and
ge_settings_gconf.dll. You can get the latter &lt;a 
href=&quot;<A HREF="http://gnomencoder.sourceforge.net/index.html#GeSettings"">http://gnomencoder.sourceforge.net/index.html#GeSettings&quot;</A>&gt;here&lt;/a&gt;. 
&lt;/p&gt;

&lt;p&gt;What have we just done? Well, first we defined an interface with a few
properties. All the properties have a GeSettings.Property attribute
that indicates the name of the app and the default value.
If you define an event of type GConf.NotifyEventHandler with the same of
the property plus 'Changed', the delegates connected to this event will be
triggered whenever GConf notify a change of the property value.
&lt;br&gt;
Then we passed the interface as the argument of a function that returns
an implementation of that interface. This implementation uses GConf
transparently, thus whenever we set or get the property, it will use 
GConf to retrieve or store the setting on disk.
&lt;/p&gt;

&lt;p&gt;

&lt;p&gt;Notice that we just used int and double data types transparently. This
is because of Mono facilities to serialize primitives to strings. Just
check before setting the value, that it is a valid one to the wanted type,
otherwise you'll get a crash with FormatException.&lt;/p&gt;

&lt;p&gt;And there is more! With another class I created (it is apart so one
doesn't have to depend on Gtk# for other uses), one can do this:&lt;/p&gt;

&lt;pre&gt;

interface IMySettings 
{
	[GeSettings.Property (&quot;GnoMencoder&quot;,
				&quot;/dev/cdroms/cdrom0&quot;,
				WidgetName = &quot;dvddevice_entry&quot;)]
	string DVDDevice
	{
		get;
		set;
	}
}
&lt;/pre&gt;

&lt;p&gt;And, with this function:&lt;br&gt;
&lt;pre&gt;	IMySettings mySettings = (IMySettings) &lt;br&gt;		GeSettings.&lt;span
 style=&quot;font-weight: bold;&quot;&gt;Glade&lt;/span&gt;Builder.Build (typeof(IMySettings), &lt;span
 style=&quot;font-weight: bold;&quot;&gt;gxml&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;/pre&gt;
you'll have the property associated with the widget on the glade
resource, which will update the GConf value on any changes to the widget 
and display any external modifications (it is not advisable to use this 
if you're using other types but string as it is very easy to get wrong 
format exceptions all the time if you don't check the input)&lt;/p&gt;

&lt;p&gt;
With this we avoided all the steps involved in creating and using
a schema, that are:
&lt;br&gt;
&lt;ul&gt;
  &lt;li&gt;create a GConf schema (learn how to make one)&lt;/li&gt;
  &lt;li&gt;run gconf-schemagen over it to create the class&lt;/li&gt;
  &lt;li&gt;you have to learn where to install the schema on different systems&lt;br&gt;
  &lt;/li&gt;
  &lt;li&gt;have root priviledges to install the schema&lt;/li&gt;
  &lt;li&gt;and even more steps if you want to connect a gconf key to a widget&lt;br&gt;
  &lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;h2&gt;But, what is a GConf schema?&lt;/h2&gt;

&lt;p&gt;From &lt;a href=&quot;<A HREF="http://developer.gnome.org/doc/API/gconf/x42.html"">http://developer.gnome.org/doc/API/gconf/x42.html&quot;</A>&gt;the
documentation&lt;/a&gt;:
&quot;A schema describes some configuration key. Its primary purpose is to provide documentation about the key to system administrators manipulating the GConf database. Secondarily, schemas contain a good default value for the key; GConf will automatically return this value when a key is unset. Schemas also include the name of the application that created a key (useful when trying to clean old junk out of the database, for example)&quot;.&lt;p&gt;

&lt;p&gt;&quot;But...&quot; --I hear you say. &quot;I don't care about manipulating a GConf 
database. I only want to store some settings and be done with it&quot;. That's
exactly why I created the above mentioned utility library, to escape
from this burden. Now, we cannot presume that nobody is going to need
to create schemas, so next is an explanation on how to utilize schemas
and the utilities that GConf# provides to deal with them.&lt;/p&gt;

--=-nwjqIeM6BK56rsFCl8tZ--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001875.html">[Gtk-sharp-list] GConf wrapping
</A></li>
	<LI> Next message: <A HREF="001854.html">[Gtk-sharp-list] problem with Gnome.About
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1881">[ date ]</a>
              <a href="thread.html#1881">[ thread ]</a>
              <a href="subject.html#1881">[ subject ]</a>
              <a href="author.html#1881">[ author ]</a>
         </LI>
       </UL>
</body></html>
