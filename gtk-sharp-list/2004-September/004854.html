<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Draging text/uri from external app to widget
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:boo%40youfuckingbitch.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="004852.html">
   <LINK REL="Next"  HREF="004853.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Draging text/uri from external app to widget
   </H1>
    <B>ub
    </B> 
    <A HREF="mailto:boo%40youfuckingbitch.com"
       TITLE="[Gtk-sharp-list] Draging text/uri from external app to widget">boo@youfuckingbitch.com
       </A><BR>
    <I>Mon, 20 Sep 2004 09:23:16 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="004852.html">[Gtk-sharp-list] Draging text/uri from external app to widget
</A></li>
        <LI> Next message: <A HREF="004853.html">[Gtk-sharp-list] Notification area example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4854">[ date ]</a>
              <a href="thread.html#4854">[ thread ]</a>
              <a href="subject.html#4854">[ subject ]</a>
              <a href="author.html#4854">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>ok, i got it now :-)
i translated the tutorial from <A HREF="http://scentric.net/tutorial/sec-dnd.htm">http://scentric.net/tutorial/sec-dnd.htm</A> 
, which seems to do exactly what i want, and it even works ;)
here is my test-source, just in case anyone got the same problem:

using System;
using Gtk;

public class MyWindow : Window {
    enum bla{
      TARGET_STRING,
      TARGET_URL
    };
    static Gtk.TargetEntry[] targetentries =
    {
        new TargetEntry (&quot;STRING&quot;,        0, (uint) bla.TARGET_STRING ),
           new TargetEntry (&quot;text/plain&quot;,    0, (uint) bla.TARGET_STRING ),
           new TargetEntry (&quot;text/uri-list&quot;, 0, (uint) bla.TARGET_URL 
),             
      };

   
    public MyWindow () : base (&quot;MyWindow&quot;)
    {
        this.SetDefaultSize (400, 300);
        this.DeleteEvent += new DeleteEventHandler (OnMyWindowDelete);
        this.ShowAll ();
          Gtk.Drag.DestSet(this, Gtk.DestDefaults.All, targetentries, 
Gdk.DragAction.Copy|Gdk.DragAction.Move|Gdk.DragAction.Link);
          this.DragDataReceived += new DragDataReceivedHandler(on_drop);
    }
   
    void on_drop (object o, DragDataReceivedArgs args)
    {
        Console.WriteLine(System.Text.Encoding.UTF8.GetString 
(args.SelectionData.Data));
    }
   
    void OnMyWindowDelete (object o, DeleteEventArgs args)
    {
        Application.Quit ();
    }
}

ub wrote:

&gt;<i> hi list!
</I>&gt;<i> i am trying to drag some link from firefox/konq into my gui, but i 
</I>&gt;<i> dont seem to get it to work.i am messing around with this stuff all 
</I>&gt;<i> day; ok so here's what i've tried:
</I>&gt;<i>
</I>&gt;<i> textview1.DragDataReceived += new DragDataReceivedHandler (on_drop);
</I>&gt;<i>
</I>&gt;<i> void on_drop(object o, DragDataReceivedArgs args){
</I>&gt;<i>    Console.WriteLine(&quot;stuff got dropped&quot;);
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> also tried that with DragDataDrop, DragEnd, kinda every Drag* handler, 
</I>&gt;<i> on almost every widget in the gui, but on_drop() never fired. i 
</I>&gt;<i> figured i'd need to add Drag.DestSet method.  i downloaded f-spot 
</I>&gt;<i> source (<A HREF="http://www.gnome.org/projects/f-spot/">http://www.gnome.org/projects/f-spot/</A>) where it seems to work 
</I>&gt;<i> (kinda), so i added
</I>&gt;<i>
</I>&gt;<i> private static TargetEntry [] icon_source_target_table = new 
</I>&gt;<i> TargetEntry [] {
</I>&gt;<i>        new TargetEntry (&quot;application/x-fspot-photos&quot;, 0, (uint) 
</I>&gt;<i> TargetType.PhotoList),        new TargetEntry (&quot;text/uri-list&quot;, 0, 
</I>&gt;<i> (uint) TargetType.UriList),  //i really have no clue what this does
</I>&gt;<i>    };
</I>&gt;<i> // TargetTypeis an enum containing some lists, they dont get used 
</I>&gt;<i> before a handler is called, still tried to add/modify them - didnt help.
</I>&gt;<i> Gtk.Drag.DestSet (textview, DestDefaults.All, icon_dest_target_table,
</I>&gt;<i>                  DragAction.Copy | DragAction.Move); //copy/paste from 
</I>&gt;<i> MainWindow.cs - f-spot-0.0.2
</I>&gt;<i>
</I>&gt;<i> again i tried almost every possible constelation of widget - drag*, 
</I>&gt;<i> but no luck. now im kinda fed up with bruteforcing (this is very 
</I>&gt;<i> frustrating by now) ;(
</I>&gt;<i> btw, yes - i read the tutorial at gtk.org and the mono documentation, 
</I>&gt;<i> but i still have no clue how to do a simple drop operation. would be 
</I>&gt;<i> nice if someone could explain how i get a widget to except drops from 
</I>&gt;<i> an external app (any help is appreciated).
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Ulrich
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Gtk-sharp-list maillist  -  <A HREF="mailto:Gtk-sharp-list@lists.ximian.com">Gtk-sharp-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">http://lists.ximian.com/mailman/listinfo/gtk-sharp-list</A>
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="004852.html">[Gtk-sharp-list] Draging text/uri from external app to widget
</A></li>
	<LI> Next message: <A HREF="004853.html">[Gtk-sharp-list] Notification area example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4854">[ date ]</a>
              <a href="thread.html#4854">[ thread ]</a>
              <a href="subject.html#4854">[ subject ]</a>
              <a href="author.html#4854">[ author ]</a>
         </LI>
       </UL>
</body></html>
