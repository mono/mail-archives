<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] New (stupid) application :)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:yakeen%40sannyas-on.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <LINK REL="Previous"  HREF="002823.html">
   <LINK REL="Next"  HREF="002815.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] New (stupid) application :)
   </H1>
    <B>David Makovský (Yakeen)
    </B> 
    <A HREF="mailto:yakeen%40sannyas-on.net"
       TITLE="[Gtk-sharp-list] New (stupid) application :)">yakeen@sannyas-on.net
       </A><BR>
    <I>Wed, 12 Nov 2003 18:50:41 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="002823.html">[Gtk-sharp-list] New (stupid) application :)
</A></li>
        <LI> Next message: <A HREF="002815.html">[Gtk-sharp-list] GTK c# examples
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2812">[ date ]</a>
              <a href="thread.html#2812">[ thread ]</a>
              <a href="subject.html#2812">[ subject ]</a>
              <a href="author.html#2812">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-1Yjr8zimj87H5SnTZrub
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi Philip and all


V =C3=9At, 11. 11. 2003 v 16:23, Philip Van Hoof p=C3=AD=C5=A1e:=20

&gt;<i> Hi there,
</I>&gt;<i>=20
</I>&gt;<i> Two weeks ago two friends on mine asked me whether I could learn them
</I>&gt;<i> about C# and Gtk-Sharp. During the same time I was reading the website
</I>&gt;<i> of Fedora which claimed that there was not a dhcpd.conf GUI available
</I>&gt;<i> yet. So I decided to teach them gtk-sharp by real-life example: I let
</I>&gt;<i> them build (with my help of course) a SharpDhcpdConf GUI :)
</I>&gt;<i>=20
</I>&gt;<i> I've finished a dhcpd.conf parser and made a glade-2 file. They
</I>&gt;<i> connected the events and some widgets and thats where the project is at
</I>&gt;<i> this moment. We have now plans to finish it to something that is
</I>&gt;<i> actually usefull.
</I>

Sounds good and useful


&gt;<i> Because the project is for educational purposes (and, perhaps, for
</I>&gt;<i> actual use later) I want it to be as perfect as possible. So far the
</I>&gt;<i> build procedure its as perfect as I can get it. It would be great if
</I>&gt;<i> other people, with better knowledge of stuff like autoconf than me,
</I>&gt;<i> could take a look at it. Perhaps create patches and help me and those
</I>&gt;<i> friends of mine to create a complete gtk-sharp application.
</I>&gt;<i>=20
</I>&gt;<i> With complete I mean:=20
</I>&gt;<i> - Multi languages support (po)
</I>

As You already readed you know that there is System.Resources
I don't know where I found it but I'm using it. Originaly it comes from
Gonzalo Paniagua Javier (<A HREF="mailto:gonzalo@ximian.com">gonzalo@ximian.com</A>)


namespace MyClass{

	using System;
	using System.Collections;
	using System.Reflection;
	using System.Resources;

	public class ResMan {
	=09
		public static string ResourceName =3D &quot;strings&quot;;
		public static Assembly Assembly =3D typeof (ResMan).Assembly;
				static ResourceManager rm;
		static Hashtable mangled;
		static char [] invalidChars =3D new Char [] {'=3D', ' '};

		private ResMan () {}
	=09
		static ResourceManager RM {
			get {
				if (rm =3D=3D null)
					rm =3D new ResourceManager (ResourceName, Assembly);

				return rm;
			}
		}

		static string _ (string key) {
			return GetString (key);
		}

		static string GetMangled (string key) {
			if (mangled =3D=3D null)
				mangled =3D new Hashtable ();

			if (mangled.Contains (key))
				return (string) mangled [key];

			string k =3D key.Replace ('=3D', '_');
			k =3D k.Replace (' ', '_');
			mangled [key] =3D k;
			return k;
		}
	=09
		public static string GetString (string key) {=09
			if (key =3D=3D null)
				throw new ArgumentNullException (&quot;key&quot;);

			if (key =3D=3D &quot;&quot;)
				throw new ArgumentException (&quot;Empty key&quot;, &quot;key&quot;);

			string k =3D key;
			if (k.IndexOfAny (invalidChars) !=3D -1)
				k =3D GetMangled (k);

			string result =3D RM.GetString (k);
			if (result =3D=3D null) {
				Console.Error.WriteLine (&quot;ResMan: Warning: no value for '{0}'&quot;, k);
				result =3D key;
			}

			return result;
		}
	}
}

you have to use ResMan._(&quot;...&quot;);
or you have to use in all your classes you want to define:

static string _ (string key) {
	return ResMan.GetString (key);
}

There is a perl script....

#!/usr/bin/perl
my $fname =3D $ARGV[0];
my $linenum =3D 0;

while (&lt;ARGV&gt;) {
	if ($fname !=3D $ARGV) {
		$linenum =3D 1;
		$fname =3D $ARGV;
	} else {
		$linenum++;
	}
=09
	if (/_\(&quot;.*&quot;\)/) {
		@array =3D split (&quot;\&quot;&quot;, $_);
		$k =3D $array[1];
		$v =3D $k;
		$k =3D~ s/ /_/g;
		$k =3D~ s/=3D/_/g;
	=09
		print &quot;# $ARGV: $linenum\n&quot;;
		print &quot;$k =3D $v\n\n&quot;;
	}
}

should be more inteligent for numbering lines, but I don't understand
perl so much
And in your build script you use

MONORESGEN=3D/usr/bin/monoresgen
./getstrings.pl *.cs &gt; resources/strings.txt #you can have others like stri=
ngs.de.txt strings.cs.txt ....

$(MONORESGEN) $&lt; || (echo -e &quot;\nERROR: cannot convert resources&quot; &amp;&amp; exit
1)=20

/resource:resources/strings.txt #to your build line

As a read somewhere monoresgen shoud be able to convert to .po format
(it's very similar)
Hope this help to lot people, cause I was serching for it long time


&gt;<i> - A correct build procedure with automake/autogen/autoconf
</I>

Yes I know, I'm using makefile this but should be interesting see NAnt
solution.


&gt;<i> - The right files in CVS, the right files in .cvsignore
</I>&gt;<i> - The correct programming methods for
</I>&gt;<i>   - Glade-Sharp
</I>

that's easy to understand and learn from examples
nice and clear solution


&gt;<i>   - OO techniques and GUI programming with Gtk-Sharp
</I>&gt;<i>   - HIG correct
</I>

read HIG doc, but it's good to look to some glade files of  GNOME 2.4
progs to see how they are doing it with glade
I recommend it to you, that's was good combination for me to understand
it (hope;)


&gt;<i> Basically I want this application to be as correct as humanly possible
</I>&gt;<i> and I want it to be like a sample application for Gtk-Sharp projects. So
</I>&gt;<i> that I can use it to teach people how to actually correctly prepare and
</I>&gt;<i> create Gtk-Sharp projects succesfully.
</I>&gt;<i> <A HREF="http://cvs.freax.be/cgi-bin/cvsweb/SharpDhcpdConf/">http://cvs.freax.be/cgi-bin/cvsweb/SharpDhcpdConf/</A>
</I>&gt;<i>=20
</I>&gt;<i> On the URL you can find information about how to checkout the sources as
</I>&gt;<i> anonymous user from the CVS. If you want me to create a writable
</I>&gt;<i> account, then first send me some patches as prove that you are actually
</I>&gt;<i> going to use it professionally :-), and not to add a bulkload of warez
</I>&gt;<i> on my cvs repos.
</I>

Kind Regards=20


--=20
David Makovsk=C3=BD (Yakeen) &lt;<A HREF="mailto:yakeen@sannyas-on.net">yakeen@sannyas-on.net</A>&gt;

--=-1Yjr8zimj87H5SnTZrub
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: 7bit

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 TRANSITIONAL//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
  &lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; CHARSET=UTF-8&quot;&gt;
  &lt;META NAME=&quot;GENERATOR&quot; CONTENT=&quot;GtkHTML/3.0.9&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;PRE&gt;Hi Philip and all&lt;/PRE&gt;
&lt;BR&gt;
V &amp;#218;t, 11. 11. 2003 v 16:23, Philip Van Hoof p&amp;#237;&amp;#353;e: 
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#555050&quot;&gt;&lt;I&gt;Hi there,

Two weeks ago two friends on mine asked me whether I could learn them
about C# and Gtk-Sharp. During the same time I was reading the website
of Fedora which claimed that there was not a dhcpd.conf GUI available
yet. So I decided to teach them gtk-sharp by real-life example: I let
them build (with my help of course) a SharpDhcpdConf GUI :)

I've finished a dhcpd.conf parser and made a glade-2 file. They
connected the events and some widgets and thats where the project is at
this moment. We have now plans to finish it to something that is
actually usefull.&lt;/I&gt;&lt;/FONT&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;BR&gt;
Sounds good and useful&lt;BR&gt;
&lt;BR&gt;
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#555050&quot;&gt;&lt;I&gt;Because the project is for educational purposes (and, perhaps, for
actual use later) I want it to be as perfect as possible. So far the
build procedure its as perfect as I can get it. It would be great if
other people, with better knowledge of stuff like autoconf than me,
could take a look at it. Perhaps create patches and help me and those
friends of mine to create a complete gtk-sharp application.

With complete I mean: 
- Multi languages support (po)&lt;/I&gt;&lt;/FONT&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;BR&gt;
As You already readed you know that there is System.Resources&lt;BR&gt;
I don't know where I found it but I'm using it. Originaly it comes from Gonzalo Paniagua Javier (&lt;A HREF=&quot;mailto:<A HREF="mailto:gonzalo@ximian.com">gonzalo@ximian.com</A>&quot;&gt;&lt;U&gt;<A HREF="mailto:gonzalo@ximian.com">gonzalo@ximian.com</A>&lt;/U&gt;&lt;/A&gt;)&lt;BR&gt;
&lt;BR&gt;
&lt;PRE&gt;namespace MyClass{

	using System;
	using System.Collections;
	using System.Reflection;
	using System.Resources;

	public class ResMan {
		
		public static string ResourceName = &amp;quot;strings&amp;quot;;
		public static Assembly Assembly = typeof (ResMan).Assembly;
				static ResourceManager rm;
		static Hashtable mangled;
		static char [] invalidChars = new Char [] {'=', ' '};

		private ResMan () {}
		
		static ResourceManager RM {
			get {
				if (rm == null)
					rm = new ResourceManager (ResourceName, Assembly);

				return rm;
			}
		}

		static string _ (string key) {
			return GetString (key);
		}

		static string GetMangled (string key) {
			if (mangled == null)
				mangled = new Hashtable ();

			if (mangled.Contains (key))
				return (string) mangled [key];

			string k = key.Replace ('=', '_');
			k = k.Replace (' ', '_');
			mangled [key] = k;
			return k;
		}
		
		public static string GetString (string key) {	
			if (key == null)
				throw new ArgumentNullException (&amp;quot;key&amp;quot;);

			if (key == &amp;quot;&amp;quot;)
				throw new ArgumentException (&amp;quot;Empty key&amp;quot;, &amp;quot;key&amp;quot;);

			string k = key;
			if (k.IndexOfAny (invalidChars) != -1)
				k = GetMangled (k);

			string result = RM.GetString (k);
			if (result == null) {
				Console.Error.WriteLine (&amp;quot;ResMan: Warning: no value for '{0}'&amp;quot;, k);
				result = key;
			}

			return result;
		}
	}
}

you have to use ResMan._(&amp;quot;...&amp;quot;);
or you have to use in all your classes you want to define:

static string _ (string key) {
	return ResMan.GetString (key);
}&lt;/PRE&gt;
&lt;B&gt;There is a perl script....&lt;/B&gt;
&lt;PRE&gt;#!/usr/bin/perl
my $fname = $ARGV[0];
my $linenum = 0;

while (&amp;lt;ARGV&amp;gt;) {
	if ($fname != $ARGV) {
		$linenum = 1;
		$fname = $ARGV;
	} else {
		$linenum++;
	}
	
	if (/_\(&amp;quot;.*&amp;quot;\)/) {
		@array = split (&amp;quot;\&amp;quot;&amp;quot;, $_);
		$k = $array[1];
		$v = $k;
		$k =~ s/ /_/g;
		$k =~ s/=/_/g;
		
		print &amp;quot;# $ARGV: $linenum\n&amp;quot;;
		print &amp;quot;$k = $v\n\n&amp;quot;;
	}
}&lt;/PRE&gt;
should be more inteligent for numbering lines, but I don't understand perl so much&lt;BR&gt;
&lt;B&gt;And in your build script you use&lt;/B&gt;
&lt;PRE&gt;MONORESGEN=/usr/bin/monoresgen
./getstrings.pl *.cs &amp;gt; resources/strings.txt #you can have others like strings.de.txt strings.cs.txt ....&lt;/PRE&gt;
$(MONORESGEN) $&amp;lt; || (echo -e &amp;quot;\nERROR: cannot convert resources&amp;quot; &amp;amp;&amp;amp; exit 1) 
&lt;PRE&gt;/resource:resources/strings.txt #to your build line&lt;/PRE&gt;
As a read somewhere monoresgen shoud be able to convert to .po format (it's very similar)&lt;BR&gt;
Hope this help to lot people, cause I was serching for it long time&lt;BR&gt;
&lt;BR&gt;
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#555050&quot;&gt;&lt;I&gt;- A correct build procedure with automake/autogen/autoconf&lt;/I&gt;&lt;/FONT&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;BR&gt;
Yes I know, I'm using makefile this but should be interesting see NAnt solution.&lt;BR&gt;
&lt;BR&gt;
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#555050&quot;&gt;&lt;I&gt;- The right files in CVS, the right files in .cvsignore
- The correct programming methods for
&amp;nbsp; - Glade-Sharp&lt;/I&gt;&lt;/FONT&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;BR&gt;
that's easy to understand and learn from examples&lt;BR&gt;
nice and clear solution&lt;BR&gt;
&lt;BR&gt;
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#555050&quot;&gt;&lt;I&gt;  - OO techniques and GUI programming with Gtk-Sharp
&amp;nbsp; - HIG correct&lt;/I&gt;&lt;/FONT&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;BR&gt;
read HIG doc, but it's good to look to some glade files of&amp;nbsp; GNOME 2.4 progs to see how they are doing it with glade&lt;BR&gt;
I recommend it to you, that's was good combination for me to understand it (hope;)&lt;BR&gt;
&lt;BR&gt;
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#555050&quot;&gt;&lt;I&gt;Basically I want this application to be as correct as humanly possible
and I want it to be like a sample application for Gtk-Sharp projects. So
that I can use it to teach people how to actually correctly prepare and
create Gtk-Sharp projects succesfully.&lt;/FONT&gt;
&lt;A HREF=&quot;<A HREF="http://cvs.freax.be/cgi-bin/cvsweb/SharpDhcpdConf/"">http://cvs.freax.be/cgi-bin/cvsweb/SharpDhcpdConf/&quot;</A>&gt;&lt;U&gt;<A HREF="http://cvs.freax.be/cgi-bin/cvsweb/SharpDhcpdConf/</U">http://cvs.freax.be/cgi-bin/cvsweb/SharpDhcpdConf/&lt;/U</A>&gt;&lt;/A&gt;
&lt;FONT COLOR=&quot;#555050&quot;&gt;
On the URL you can find information about how to checkout the sources as
anonymous user from the CVS. If you want me to create a writable
account, then first send me some patches as prove that you are actually
going to use it professionally :-), and not to add a bulkload of warez
on my cvs repos.&lt;/I&gt;&lt;/FONT&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;BR&gt;
Kind Regards 
&lt;PRE&gt;&lt;TABLE CELLSPACING=&quot;0&quot; CELLPADDING=&quot;0&quot; WIDTH=&quot;100%&quot;&gt;
&lt;TR&gt;
&lt;/TR&gt;
&lt;TR&gt;
&lt;/TR&gt;
&lt;TR&gt;
&lt;TD&gt;
&lt;BR&gt;
-- &lt;BR&gt;
David Makovsk&amp;#253; (Yakeen) &amp;lt;&lt;A HREF=&quot;mailto:<A HREF="mailto:yakeen@sannyas-on.net">yakeen@sannyas-on.net</A>&quot;&gt;&lt;U&gt;<A HREF="mailto:yakeen@sannyas-on.net">yakeen@sannyas-on.net</A>&lt;/U&gt;&lt;/A&gt;&amp;gt;
&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;/PRE&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

--=-1Yjr8zimj87H5SnTZrub--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002823.html">[Gtk-sharp-list] New (stupid) application :)
</A></li>
	<LI> Next message: <A HREF="002815.html">[Gtk-sharp-list] GTK c# examples
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2812">[ date ]</a>
              <a href="thread.html#2812">[ thread ]</a>
              <a href="subject.html#2812">[ subject ]</a>
              <a href="author.html#2812">[ author ]</a>
         </LI>
       </UL>
</body></html>
