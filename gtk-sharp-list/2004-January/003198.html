<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] AccelKey and Widget.AddAccelerator
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:jluke%40users.sourceforge.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003194.html">
   <LINK REL="Next"  HREF="003260.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] AccelKey and Widget.AddAccelerator
   </H1>
    <B>John Luke
    </B> 
    <A HREF="mailto:jluke%40users.sourceforge.net"
       TITLE="[Gtk-sharp-list] AccelKey and Widget.AddAccelerator">jluke@users.sourceforge.net
       </A><BR>
    <I>Fri, 16 Jan 2004 22:41:16 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="003194.html">[Gtk-sharp-list] Testing GTK# code?
</A></li>
        <LI> Next message: <A HREF="003260.html">[Gtk-sharp-list] AccelKey and Widget.AddAccelerator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3198">[ date ]</a>
              <a href="thread.html#3198">[ thread ]</a>
              <a href="subject.html#3198">[ subject ]</a>
              <a href="author.html#3198">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-KUS6z/JxRel0o49LSIND
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hello,
	Attached is a patch that does the following:
	1. sets the type of the Gtk.AccelKey fields to Gdk.Key, Gdk.
ModifierType, Gtk.AccelFlags, and adds a custom constructor with those
args. (For some reason the Gdk.Key field is not generated so I added it
to the custom file)
	2. Add an overload for Gtk.Widget.AddAccelerator that uses Gtk.AccelKey
since it now contains some of the other info.
	3. Removes the previous change to the original Gtk.AddAccelerator
method.

--=-KUS6z/JxRel0o49LSIND
Content-Disposition: attachment; filename=accelkey.diff
Content-Type: text/x-diff; name=accelkey.diff; charset=UTF-8
Content-Transfer-Encoding: 7bit

? accelkey.diff
? button.diff
? dialog.diff
? gdk_key.diff
? radiobutton.diff
? test.diff
? widget_gtkaccelkey.diff
Index: AccelKey.custom
===================================================================
RCS file: AccelKey.custom
diff -N AccelKey.custom
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ AccelKey.custom	17 Jan 2004 02:57:41 -0000
@@ -0,0 +1,8 @@
+public Gdk.Key Key;
+
+public AccelKey (Gdk.Key key, Gdk.ModifierType mods, Gtk.AccelFlags flags)
+{
+	this.Key = key;
+	this.accel_mods = mods;
+	this.accel_flags = flags;
+}
Index: Gtk.metadata
===================================================================
RCS file: /cvs/public/gtk-sharp/gtk/Gtk.metadata,v
retrieving revision 1.23
diff -u -r1.23 Gtk.metadata
--- Gtk.metadata	9 Jan 2004 20:52:27 -0000	1.23
+++ Gtk.metadata	17 Jan 2004 02:57:41 -0000
@@ -1,5 +1,8 @@
 &lt;?xml version=&quot;1.0&quot;?&gt;
 &lt;metadata&gt;
+  &lt;attr path=&quot;/api/namespace/struct[@cname='GtkAccelKey']/field[@cname='accel_key']&quot; name=&quot;type&quot;&gt;GdkKey&lt;/attr&gt;
+  &lt;attr path=&quot;/api/namespace/struct[@cname='GtkAccelKey']/field[@cname='accel_mods']&quot; name=&quot;type&quot;&gt;GdkModifierType&lt;/attr&gt;
+  &lt;attr path=&quot;/api/namespace/struct[@cname='GtkAccelKey']/field[@cname='accel_flags']&quot; name=&quot;type&quot;&gt;GtkAccelFlags&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/boxed[@cname='GtkBorder']&quot; name=&quot;hidden&quot;&gt;1&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/boxed[@cname='GtkIconSet']/method[@name='GetSizes']&quot; name=&quot;hidden&quot;&gt;1&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/boxed[@cname='GtkSelectionData']&quot; name=&quot;opaque&quot;&gt;1&lt;/attr&gt;
@@ -259,7 +262,6 @@
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkWidget']/signal[@name='SizeRequest']&quot; name=&quot;name&quot;&gt;SizeRequested&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkWidget']/signal[@name='Unmap']&quot; name=&quot;name&quot;&gt;Unmapped&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkWidget']/signal[@name='Unrealize']&quot; name=&quot;name&quot;&gt;Unrealized&lt;/attr&gt;
-  &lt;attr path=&quot;/api/namespace/object[@cname='GtkWidget']/method[@name='AddAccelerator']/parameters/parameter[@name='accel_key']&quot; name=&quot;type&quot;&gt;GtkAccelKey&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkWindow']/method[@name='GetDefaultSize']/*/*[@type='gint*']&quot; name=&quot;pass_as&quot;&gt;out&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkWindow']/method[@name='GetPosition']/*/*[@type='gint*']&quot; name=&quot;pass_as&quot;&gt;out&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkWindow']/method[@name='GetSize']/*/*[@type='gint*']&quot; name=&quot;pass_as&quot;&gt;out&lt;/attr&gt;
Index: Widget.custom
===================================================================
RCS file: /cvs/public/gtk-sharp/gtk/Widget.custom,v
retrieving revision 1.4
diff -u -r1.4 Widget.custom
--- Widget.custom	23 Jul 2003 17:19:21 -0000	1.4
+++ Widget.custom	17 Jan 2004 02:57:41 -0000
@@ -44,3 +44,8 @@
 	}
 }
 
+public void AddAccelerator (string accel_signal, AccelGroup accel_group, AccelKey accel_key)
+{
+	this.AddAccelerator (accel_signal, accel_group, (uint) accel_key.Key, accel_key.accel_mods, accel_key.accel_flags);
+
+}
Index: gtk-api.xml
===================================================================
RCS file: /cvs/public/gtk-sharp/gtk/gtk-api.xml,v
retrieving revision 1.31
diff -u -r1.31 gtk-api.xml
--- gtk-api.xml	9 Jan 2004 20:52:27 -0000	1.31
+++ gtk-api.xml	17 Jan 2004 02:57:43 -0000
@@ -9893,7 +9893,7 @@
         &lt;parameters&gt;
           &lt;parameter type=&quot;const-gchar*&quot; name=&quot;accel_signal&quot; /&gt;
           &lt;parameter type=&quot;GtkAccelGroup*&quot; name=&quot;accel_group&quot; /&gt;
-          &lt;parameter name=&quot;accel_key&quot; type=&quot;GtkAccelKey&quot; /&gt;
+          &lt;parameter type=&quot;guint&quot; name=&quot;accel_key&quot; /&gt;
           &lt;parameter type=&quot;GdkModifierType&quot; name=&quot;accel_mods&quot; /&gt;
           &lt;parameter type=&quot;GtkAccelFlags&quot; name=&quot;accel_flags&quot; /&gt;
         &lt;/parameters&gt;
@@ -10970,9 +10970,9 @@
       &lt;field cname=&quot;accel_path_quark&quot; type=&quot;GQuark&quot; /&gt;
     &lt;/struct&gt;
     &lt;struct name=&quot;AccelKey&quot; cname=&quot;GtkAccelKey&quot;&gt;
-      &lt;field cname=&quot;accel_key&quot; type=&quot;guint&quot; /&gt;
+      &lt;field cname=&quot;accel_key&quot; type=&quot;GdkKey&quot; /&gt;
       &lt;field cname=&quot;accel_mods&quot; type=&quot;GdkModifierType&quot; /&gt;
-      &lt;field cname=&quot;accel_flags&quot; bits=&quot;16&quot; type=&quot;guint&quot; /&gt;
+      &lt;field cname=&quot;accel_flags&quot; bits=&quot;16&quot; type=&quot;GtkAccelFlags&quot; /&gt;
     &lt;/struct&gt;
     &lt;alias name=&quot;Allocation&quot; cname=&quot;GtkAllocation&quot; type=&quot;GdkRectangle&quot; /&gt;
     &lt;struct name=&quot;Arg&quot; cname=&quot;GtkArg&quot; opaque=&quot;true&quot;&gt;

--=-KUS6z/JxRel0o49LSIND--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003194.html">[Gtk-sharp-list] Testing GTK# code?
</A></li>
	<LI> Next message: <A HREF="003260.html">[Gtk-sharp-list] AccelKey and Widget.AddAccelerator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3198">[ date ]</a>
              <a href="thread.html#3198">[ thread ]</a>
              <a href="subject.html#3198">[ subject ]</a>
              <a href="author.html#3198">[ author ]</a>
         </LI>
       </UL>
</body></html>
