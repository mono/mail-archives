<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Howto use WaitForTargets
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Howto%20use%20WaitForTargets&In-Reply-To=1151685390.5113.34.camel%40localhost">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="007258.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Howto use WaitForTargets</H1>
    <B>einKI.ml</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Howto%20use%20WaitForTargets&In-Reply-To=1151685390.5113.34.camel%40localhost"
       TITLE="[Gtk-sharp-list] Howto use WaitForTargets">einKI.ml at gmx.net
       </A><BR>
    <I>Sat Jul  1 13:28:37 EDT 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="007258.html">[Gtk-sharp-list] How to highlight the first
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7257">[ date ]</a>
              <a href="thread.html#7257">[ thread ]</a>
              <a href="subject.html#7257">[ subject ]</a>
              <a href="author.html#7257">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi


&gt;<i> I tried to get all targets the clipboard currently supports through the
</I>&gt;<i> WaitForTargets Method.
</I>&gt;<i> 
</I>&gt;<i> public bool WaitForTargets (Gdk.Atom targets, out int n_targets)
</I>&gt;<i> 
</I>&gt;<i> I am sursprised why it only takes a Gdk.Atom as parameter instead of a
</I>&gt;<i> Gdk.Atom[] like the function form the C-API (GdkAtom**).
</I>I now used PInvoke to get my own method. But I would still be interested
if anyone can tell me how to use the Gtk# Method.

If somebody want to use my method the code is here
It is not tested but should work on Windows and AMD64 too.

class ClipboardUtil
{
	public static string[] GetTargets(Gtk.Clipboard cp)
	{
		int count;
		IntPtr ptr;
		string[] ret;
		
		gtk_clipboard_wait_for_targets(cp.Handle,out ptr,out count);
		if(count &lt;=0)  return new string[0];
		ret = new string[count];
		
		unsafe {
			byte* p = (byte*)ptr.ToPointer();
			int i=0;
			
			while(count-- &gt; 0)
			{
				ret[i] = gdk_atom_name(new IntPtr(*p));
				p+=IntPtr.Size;
				i++;
			}
		}
		
		return ret;
	}
	
	#region PInvoke
		#if WIN32
			[DllImport(&quot;libgtk-win32-2.0.so&quot;)]
			extern static bool gtk_clipboard_wait_for_targets(IntPtr cp,out
IntPtr atoms,out int numbers);
	
			[DllImport(&quot;libgdk-win32-2.0.so&quot;)]
			extern static string gdk_atom_name (int ptr);
		#else
			[DllImport(&quot;libgtk-x11-2.0.so&quot;)]
			extern static bool gtk_clipboard_wait_for_targets(IntPtr cp,out
IntPtr atoms,out int numbers);
	
			[DllImport(&quot;libgdk-x11-2.0.so&quot;)]
			extern static string gdk_atom_name (IntPtr ptr);
		#endif
	#endregion
}

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="007258.html">[Gtk-sharp-list] How to highlight the first
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7257">[ date ]</a>
              <a href="thread.html#7257">[ thread ]</a>
              <a href="subject.html#7257">[ subject ]</a>
              <a href="author.html#7257">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
