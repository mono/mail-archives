<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20TreeModelAdapter%20hangs%20with%0A%20my%09TreeModelImplementor%20class&In-Reply-To=1267958763914-1583443.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010132.html">
   <LINK REL="Next"  HREF="010136.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class</H1>
    <B>Christian Hoff</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20TreeModelAdapter%20hangs%20with%0A%20my%09TreeModelImplementor%20class&In-Reply-To=1267958763914-1583443.post%40n4.nabble.com"
       TITLE="[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class">christian_hoff at gmx.net
       </A><BR>
    <I>Sun Mar  7 08:57:15 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010132.html">[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class
</A></li>
        <LI>Next message: <A HREF="010136.html">[Gtk-sharp-list] TreeModelAdapter hangs with	my	TreeModelImplementor class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10134">[ date ]</a>
              <a href="thread.html#10134">[ thread ]</a>
              <a href="subject.html#10134">[ subject ]</a>
              <a href="author.html#10134">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have already written such a TreeModel years ago and later revamped it 
to handle all lists implementing the IList interface(Collections, 
DataView, ..) with the appropriate columns (see attached file). I hope 
this helps :-) .

Still I would like to see something like this into Gtk# trunk as this is 
in my opinion one of the essential features that the binding is still 
lacking. I don't want know how many people transfer the elements of .NET 
ILists into a Gtk.ListView. I will talk to Mike (the Gtk# maintainer) 
again and see what we can do. IMO, such a tree model would be a really 
nice addition for Gtk# 3.0.


Christian

b0rg wrote:
&gt;<i> Hi 
</I>&gt;<i>
</I>&gt;<i> This is my first post here. I'm moving from VS2005 to MonoDevelop and I try
</I>&gt;<i> to make some controls based on GTK#, that are more familiar with that I used
</I>&gt;<i> to work with. But I have very little experience with GTK.
</I>&gt;<i>
</I>&gt;<i> I've been looking around in various posts on how to make a custom adapter
</I>&gt;<i> for a TreeView (in fact using a System.Data.Dataview) so I implement a
</I>&gt;<i> TreeModelImplementor with this:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://n4.nabble.com/file/n1583443/GDataViewStore.cs">http://n4.nabble.com/file/n1583443/GDataViewStore.cs</A> GDataViewStore.cs 
</I>&gt;<i>
</I>&gt;<i> and I use this class with this:
</I>&gt;<i>
</I>&gt;<i> this.myTreeView.Model = new TreeModelAdapter(new
</I>&gt;<i> GDataViewStore(this.dView));
</I>&gt;<i>
</I>&gt;<i> Everything works unexpectedly well if dataview has rows, but if dView is
</I>&gt;<i> empty (dView.Count==0) it hangs until it is killed by OOM killer. It seems
</I>&gt;<i> that IterNext is called forever.
</I>&gt;<i>
</I>&gt;<i> If I change IterNext and check that there are no rows in dataview with this:
</I>&gt;<i>
</I>&gt;<i> 		public bool IterNext (ref Gtk.TreeIter iter)
</I>&gt;<i> 		{
</I>&gt;<i> 			if(dview.Count == 0) return false; // If dataview is empty, there is
</I>&gt;<i> nothing next
</I>&gt;<i> 			int rowindex = GetRowByIter(iter);
</I>&gt;<i> 			if(rowindex == dview.Count - 1) 
</I>&gt;<i> 				return false;
</I>&gt;<i> 			else {
</I>&gt;<i> 				iter = GetIterByRow(rowindex + 1);
</I>&gt;<i> 				return true;
</I>&gt;<i> 			}
</I>&gt;<i> 		}
</I>&gt;<i>
</I>&gt;<i> I get a 
</I>&gt;<i> Gtk-CRITICAL **: file /build/buildd/gtk+2.0-2.18.3/gtk/gtktreeview.c: line
</I>&gt;<i> 5944 (validate_visible_area): assertion `has_next' failed.
</I>&gt;<i> There is a disparity between the internal view of the GtkTreeView,
</I>&gt;<i> and the GtkTreeModel.  This generally means that the model has changed
</I>&gt;<i> without letting the view know.  Any display from now on is likely to
</I>&gt;<i> be incorrect.
</I>&gt;<i>
</I>&gt;<i> and an out of range exception in GetValue.
</I>&gt;<i>
</I>&gt;<i> Is there a right way to do this?
</I>&gt;<i>
</I>&gt;<i> Forgive my long post, I would appreciate your assistance.
</I>&gt;<i>
</I>&gt;<i> Thanks 
</I>&gt;<i>   
</I>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: IListStore.cs
Type: text/x-csharp
Size: 10238 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20100307/61f0db06/attachment-0001.bin">http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20100307/61f0db06/attachment-0001.bin</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010132.html">[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class
</A></li>
	<LI>Next message: <A HREF="010136.html">[Gtk-sharp-list] TreeModelAdapter hangs with	my	TreeModelImplementor class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10134">[ date ]</a>
              <a href="thread.html#10134">[ thread ]</a>
              <a href="subject.html#10134">[ subject ]</a>
              <a href="author.html#10134">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
