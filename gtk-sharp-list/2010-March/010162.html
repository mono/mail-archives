<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] A text view widget with a transparent background,	and some other pure 	evil.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20A%20text%20view%20widget%20with%20a%20transparent%20background%2C%0A%09and%20some%20other%20pure%20%09evil.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010166.html">
   <LINK REL="Next"  HREF="010163.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] A text view widget with a transparent background,	and some other pure 	evil.</H1>
    <B>Greg Lowe</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20A%20text%20view%20widget%20with%20a%20transparent%20background%2C%0A%09and%20some%20other%20pure%20%09evil.&In-Reply-To="
       TITLE="[Gtk-sharp-list] A text view widget with a transparent background,	and some other pure 	evil.">greg at vis.net.nz
       </A><BR>
    <I>Sun Mar 21 04:52:49 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010166.html">[Gtk-sharp-list] A widget to SIMPLY show styled text
</A></li>
        <LI>Next message: <A HREF="010163.html">[Gtk-sharp-list] A text view widget with a transparent background, and some other pure 	evil.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10162">[ date ]</a>
              <a href="thread.html#10162">[ thread ]</a>
              <a href="subject.html#10162">[ subject ]</a>
              <a href="author.html#10162">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,

I'm experimenting with a way to implement a simple text tool for a GTK
painting application.

What I've got so far is an custom container widget which uses cairo to paint
the background on expose. When the user clicks on the container widget, a
text view widget is added on top and given keyboard focus.

When the text entry is completed, it's drawn to a cairo image surface, and
the text view widget is destroyed.

This works pretty well. The one caveat, is that the text view must have a
solid background colour. Ideally, I'd like to be able to give it a
transparent background. And that's when it starts to get tricky.

I'd like to be able to do something like:

    text_view.ModifyBase (StateType.Normal, new Gdk.Color (r,g,b,_alpha_))

But the problem is that Gdk.Color doesn't support alpha.

I understand it is possible to use alpha compositing for child widgets. From
what I've read, I think I need to get the rgba colour map from the GDK
screen, and then set it on the widget. But then I also need to pass in an
alpha value for the text view's background colour, at which point I'm stuck.

So now, dear reader, you've made it this far, and it's time for the
questions...

 - Is it currently possible to set the alpha channel of the text view
widget's background colour, or make the background completely transparent?

 - Or, is there a better way to achieve the same effect?

 - If not, are there any plans to add a function that does this to GTK (and
GtkSharp)? Is that likely to happen within the next year or so?

 - If there isn't a solution at the moment, are there any good workarounds?

(For example, I could potentially use &quot;pure evil&quot; [1], and skip alpha
compositing all together, just i.e. re-render the background. Actually I
tried this in GTK#, and not only did my demo app crash, but it also took
MonoDevelop down with it. And I thought the pure evil bit was just a joke.
[1] <A HREF="http://dannipenguin.livejournal.com/283590.html">http://dannipenguin.livejournal.com/283590.html</A> )

Anyways, thanks for your time, and hopefully someone out there has cracked
this nut already... would love to hear from you!

Cheers,
Greg.


Here's the source code for my text tool demo:

<A HREF="http://github.com/xxgreg/code-examples/blob/master/gtksharp-text-tool-example/TextToolTest/ScalableTextToolExample.cs">http://github.com/xxgreg/code-examples/blob/master/gtksharp-text-tool-example/TextToolTest/ScalableTextToolExample.cs</A>


Here's some other links that I looked at while working on this:

<A HREF="http://www.go-mono.com/docs/index.aspx?link=P:Gdk.Screen.RgbaColormap">http://www.go-mono.com/docs/index.aspx?link=P:Gdk.Screen.RgbaColormap</A>
<A HREF="http://www.go-mono.com/docs/index.aspx?link=P:Gtk.Widget.Colormap">http://www.go-mono.com/docs/index.aspx?link=P:Gtk.Widget.Colormap</A>

<A HREF="http://library.gnome.org/devel/gtk/stable/GtkWidget.html#gtk-widget-set-colormap">http://library.gnome.org/devel/gtk/stable/GtkWidget.html#gtk-widget-set-colormap</A>
<A HREF="http://library.gnome.org/devel/gdk/stable/GdkScreen.html#gdk-screen-get-rgba-colormap">http://library.gnome.org/devel/gdk/stable/GdkScreen.html#gdk-screen-get-rgba-colormap</A>


And a related thread on the Pinta list:

<A HREF="http://groups.google.com/group/pinta/browse_thread/thread/ceb7c9d1076825f6">http://groups.google.com/group/pinta/browse_thread/thread/ceb7c9d1076825f6</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20100321/e800da6d/attachment-0001.html">http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20100321/e800da6d/attachment-0001.html</A> 
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010166.html">[Gtk-sharp-list] A widget to SIMPLY show styled text
</A></li>
	<LI>Next message: <A HREF="010163.html">[Gtk-sharp-list] A text view widget with a transparent background, and some other pure 	evil.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10162">[ date ]</a>
              <a href="thread.html#10162">[ thread ]</a>
              <a href="subject.html#10162">[ subject ]</a>
              <a href="author.html#10162">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
