<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20TreeModelAdapter%20hangs%20with%20my%0A%09TreeModelImplementor%20class&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010128.html">
   <LINK REL="Next"  HREF="010132.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class</H1>
    <B>b0rg</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20TreeModelAdapter%20hangs%20with%20my%0A%09TreeModelImplementor%20class&In-Reply-To="
       TITLE="[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class">j.smirlis at gmail.com
       </A><BR>
    <I>Sun Mar  7 05:46:03 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010128.html">[Gtk-sharp-list] Set cursor with edit = true not working?
</A></li>
        <LI>Next message: <A HREF="010132.html">[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10131">[ date ]</a>
              <a href="thread.html#10131">[ thread ]</a>
              <a href="subject.html#10131">[ subject ]</a>
              <a href="author.html#10131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi 

This is my first post here. I'm moving from VS2005 to MonoDevelop and I try
to make some controls based on GTK#, that are more familiar with that I used
to work with. But I have very little experience with GTK.

I've been looking around in various posts on how to make a custom adapter
for a TreeView (in fact using a System.Data.Dataview) so I implement a
TreeModelImplementor with this:

<A HREF="http://n4.nabble.com/file/n1583443/GDataViewStore.cs">http://n4.nabble.com/file/n1583443/GDataViewStore.cs</A> GDataViewStore.cs 

and I use this class with this:

this.myTreeView.Model = new TreeModelAdapter(new
GDataViewStore(this.dView));

Everything works unexpectedly well if dataview has rows, but if dView is
empty (dView.Count==0) it hangs until it is killed by OOM killer. It seems
that IterNext is called forever.

If I change IterNext and check that there are no rows in dataview with this:

		public bool IterNext (ref Gtk.TreeIter iter)
		{
			if(dview.Count == 0) return false; // If dataview is empty, there is
nothing next
			int rowindex = GetRowByIter(iter);
			if(rowindex == dview.Count - 1) 
				return false;
			else {
				iter = GetIterByRow(rowindex + 1);
				return true;
			}
		}

I get a 
Gtk-CRITICAL **: file /build/buildd/gtk+2.0-2.18.3/gtk/gtktreeview.c: line
5944 (validate_visible_area): assertion `has_next' failed.
There is a disparity between the internal view of the GtkTreeView,
and the GtkTreeModel.  This generally means that the model has changed
without letting the view know.  Any display from now on is likely to
be incorrect.

and an out of range exception in GetValue.

Is there a right way to do this?

Forgive my long post, I would appreciate your assistance.

Thanks 
-- 
View this message in context: <A HREF="http://n4.nabble.com/TreeModelAdapter-hangs-with-my-TreeModelImplementor-class-tp1583443p1583443.html">http://n4.nabble.com/TreeModelAdapter-hangs-with-my-TreeModelImplementor-class-tp1583443p1583443.html</A>
Sent from the Mono - Gtk# mailing list archive at Nabble.com.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010128.html">[Gtk-sharp-list] Set cursor with edit = true not working?
</A></li>
	<LI>Next message: <A HREF="010132.html">[Gtk-sharp-list] TreeModelAdapter hangs with my	TreeModelImplementor class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10131">[ date ]</a>
              <a href="thread.html#10131">[ thread ]</a>
              <a href="subject.html#10131">[ subject ]</a>
              <a href="author.html#10131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
