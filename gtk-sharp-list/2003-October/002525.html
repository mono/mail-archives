<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] enums not generated for gnomeprintui
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mwh%40sysrq.dk">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002523.html">
   <LINK REL="Next"  HREF="002532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] enums not generated for gnomeprintui
   </H1>
    <B>Martin Willemoes Hansen
    </B> 
    <A HREF="mailto:mwh%40sysrq.dk"
       TITLE="[Gtk-sharp-list] enums not generated for gnomeprintui">mwh@sysrq.dk
       </A><BR>
    <I>Wed, 01 Oct 2003 22:16:05 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="002523.html">[Gtk-sharp-list] Stuck in gtk-demo port from c to c#
</A></li>
        <LI> Next message: <A HREF="002532.html">[Gtk-sharp-list] enums not generated for gnomeprintui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2525">[ date ]</a>
              <a href="thread.html#2525">[ thread ]</a>
              <a href="subject.html#2525">[ subject ]</a>
              <a href="author.html#2525">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-1CUEaI9ukz+3URg0+IuH
Content-Type: multipart/alternative; boundary=&quot;=-R60ycC8AjiejIHvfwsGZ&quot;


--=-R60ycC8AjiejIHvfwsGZ
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

On Sun, 2003-09-28 at 02:12, Mike Kestner wrote:

&gt;<i> On Thu, 2003-09-25 at 13:12 +0200, Martin Willemoes Hansen wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; I noticed that they are on the form enum foobar { ... }; but
</I>&gt;<i> &gt; if I change them to have the form typedef enum { ... } foobar; 
</I>&gt;<i> &gt; they will be parsed correctly.
</I>&gt;<i> 
</I>&gt;<i> The parser regexes can easily be changed to handle this. You can either
</I>&gt;<i> file the bug or take a look at the enum regex in gapi2xml.pl if you want
</I>&gt;<i> to try to fix it yourself.
</I>

I made a patch, using regexes to catch this enum style.

Okay to commit?

-- 
Martin Willemoes Hansen

--------------------------------------------------------
E-Mail	<A HREF="mailto:mwh@sysrq.dk">mwh@sysrq.dk</A>	Website	mwh.sysrq.dk
IRC     MWH, freenode.net
--------------------------------------------------------               


--=-R60ycC8AjiejIHvfwsGZ
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: 7bit

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 TRANSITIONAL//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
  &lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; CHARSET=UTF-8&quot;&gt;
  &lt;META NAME=&quot;GENERATOR&quot; CONTENT=&quot;GtkHTML/3.0.9&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
On Sun, 2003-09-28 at 02:12, Mike Kestner wrote:
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;&lt;FONT COLOR=&quot;#737373&quot;&gt;&lt;I&gt;On Thu, 2003-09-25 at 13:12 +0200, Martin Willemoes Hansen wrote:

&amp;gt;<i> I noticed that they are on the form enum foobar { ... }; but
</I>&amp;gt;<i> if I change them to have the form typedef enum { ... } foobar; 
</I>&amp;gt;<i> they will be parsed correctly.
</I>
The parser regexes can easily be changed to handle this. You can either
file the bug or take a look at the enum regex in gapi2xml.pl if you want
to try to fix it yourself.&lt;/I&gt;&lt;/FONT&gt;&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;BR&gt;
I made a patch, using regexes to catch this enum style.&lt;BR&gt;
&lt;BR&gt;
Okay to commit?
&lt;PRE&gt;&lt;TABLE CELLSPACING=&quot;0&quot; CELLPADDING=&quot;0&quot; WIDTH=&quot;100%&quot;&gt;
&lt;TR&gt;
&lt;TD&gt;
&lt;PRE&gt;-- 
Martin Willemoes Hansen

--------------------------------------------------------
E-Mail	<A HREF="mailto:mwh@sysrq.dk">mwh@sysrq.dk</A>	Website	mwh.sysrq.dk
IRC     MWH, freenode.net
--------------------------------------------------------               
&lt;/PRE&gt;
&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;/PRE&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

--=-R60ycC8AjiejIHvfwsGZ--

--=-1CUEaI9ukz+3URg0+IuH
Content-Disposition: attachment; filename=ByPassingOfEnumStyle.diff
Content-Type: text/x-patch; name=ByPassingOfEnumStyle.diff; charset=iso-8859-1
Content-Transfer-Encoding: 7bit

? ByPassingOfEnumStyle.diff
Index: ChangeLog
===================================================================
RCS file: /cvs/public/gtk-sharp/ChangeLog,v
retrieving revision 1.477
diff -u -r1.477 ChangeLog
--- ChangeLog	29 Sep 2003 11:05:28 -0000	1.477
+++ ChangeLog	1 Oct 2003 20:27:34 -0000
@@ -1,3 +1,10 @@
+2003-10-01  Martin Willemoes Hansen  &lt;<A HREF="mailto:mwh@sysrq.dk">mwh@sysrq.dk</A>&gt;
+
+	* parser/gapi2xml.pl: Fixed bypassing of this kind of enum style:
+	  enum Foobar { ... };
+	* api/gnome-api.xml: Added enums of the above style, also corrects the library
+	  used by gnomeprint.
+
 2003-09-29  Martin Willemoes Hansen  &lt;<A HREF="mailto:mwh@sysrq.dk">mwh@sysrq.dk</A>&gt;
 
 	* sources/Gnome.metadata: Use const-gchar* instead of const-guchar*, 
Index: api/gnome-api.xml
===================================================================
RCS file: /cvs/public/gtk-sharp/api/gnome-api.xml,v
retrieving revision 1.15
diff -u -r1.15 gnome-api.xml
--- api/gnome-api.xml	29 Sep 2003 11:05:30 -0000	1.15
+++ api/gnome-api.xml	1 Oct 2003 20:27:37 -0000
@@ -6259,6 +6259,26 @@
     &lt;/class&gt;
   &lt;/namespace&gt;
   &lt;namespace name=&quot;Gnome&quot; library=&quot;gnomeprintui-2-2&quot;&gt;
+    &lt;enum name=&quot;PaperSelectorFlags&quot; cname=&quot;GnomePaperSelectorFlags&quot; type=&quot;enum&quot;&gt;
+      &lt;member cname=&quot;GNOME_PAPER_SELECTOR_MARGINS&quot; name=&quot;Margins&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PAPER_SELECTOR_FEED_ORIENTATION&quot; name=&quot;FeedOrientation&quot;/&gt;
+    &lt;/enum&gt;
+    &lt;enum name=&quot;PrintButtons&quot; cname=&quot;GnomePrintButtons&quot; type=&quot;enum&quot;&gt;
+      &lt;member cname=&quot;GNOME_PRINT_DIALOG_RESPONSE_PRINT&quot; name=&quot;Print&quot; value=&quot;1&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PRINT_DIALOG_RESPONSE_PREVIEW&quot; name=&quot;Preview&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PRINT_DIALOG_RESPONSE_CANCEL&quot; name=&quot;Cancel&quot;/&gt;
+    &lt;/enum&gt;
+    &lt;enum name=&quot;PrintDialogFlags&quot; cname=&quot;GnomePrintDialogFlags&quot; type=&quot;enum&quot;&gt;
+      &lt;member cname=&quot;GNOME_PRINT_DIALOG_RANGE&quot; name=&quot;Range&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PRINT_DIALOG_COPIES&quot; name=&quot;Copies&quot;/&gt;
+    &lt;/enum&gt;
+    &lt;enum name=&quot;PrintDialogRangeFlags&quot; cname=&quot;GnomePrintDialogRangeFlags&quot; type=&quot;enum&quot;&gt;
+      &lt;member cname=&quot;GNOME_PRINT_RANGE_CURRENT&quot; name=&quot;Current&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PRINT_RANGE_ALL&quot; name=&quot;All&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PRINT_RANGE_RANGE&quot; name=&quot;Range&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PRINT_RANGE_SELECTION&quot; name=&quot;Selection&quot;/&gt;
+      &lt;member cname=&quot;GNOME_PRINT_RANGE_SELECTION_UNSENSITIVE&quot; name=&quot;SelectionUnsensitive&quot;/&gt;
+    &lt;/enum&gt;
     &lt;enum name=&quot;PrintRangeType&quot; cname=&quot;GnomePrintRangeType&quot; type=&quot;enum&quot;&gt;
       &lt;member cname=&quot;GNOME_PRINT_RANGETYPE_NONE&quot; name=&quot;None&quot;/&gt;
       &lt;member cname=&quot;GNOME_PRINT_RANGETYPE_CUSTOM&quot; name=&quot;Custom&quot;/&gt;
@@ -6578,7 +6598,7 @@
     &lt;/object&gt;
     &lt;struct name=&quot;CanvasHacktextPriv&quot; cname=&quot;GnomeCanvasHacktextPriv&quot; opaque=&quot;true&quot;/&gt;
   &lt;/namespace&gt;
-  &lt;namespace name=&quot;Gnome&quot; library=&quot;gnomeprintui-2.2&quot;&gt;
+  &lt;namespace name=&quot;Gnome&quot; library=&quot;gnomeprintui-2-2&quot;&gt;
     &lt;object name=&quot;GPAOptionMenu&quot; cname=&quot;GPAOptionMenu&quot; parent=&quot;GPAWidget&quot;&gt;
       &lt;field cname=&quot;menu&quot; type=&quot;GtkWidget*&quot;/&gt;
       &lt;field cname=&quot;node&quot; type=&quot;GPANode*&quot;/&gt;
Index: parser/gapi2xml.pl
===================================================================
RCS file: /cvs/public/gtk-sharp/parser/gapi2xml.pl,v
retrieving revision 1.40
diff -u -r1.40 gapi2xml.pl
--- parser/gapi2xml.pl	15 Jul 2003 05:52:08 -0000	1.40
+++ parser/gapi2xml.pl	1 Oct 2003 20:27:41 -0000
@@ -69,6 +69,18 @@
 		$edef =~ /}\s*(\w+);/;
 		$ename = $1;
 		$edefs{$ename} = $edef;
+        } elsif ($line =~ /^enum/) {
+                $line =~ /\s(\w+)\s+{/;
+		$ename = $1;
+                $edef = &quot;typedef enum {\n&quot;;
+                while ($line = &lt;STDIN&gt;) {
+			$edef .= $line;
+			last if ($line =~ /};/);
+                }
+                $edef =~ s/;\n/ $ename;\n/g;
+		$edef =~ s/\n\s*//g;
+		$edef =~ s|/\*.*?\*/||g;
+		$edefs{$ename} = $edef;
 	} elsif ($line =~ /typedef\s+\w+\s*\**\s*\(\*\s*(\w+)\)\s*\(/) {
 		$fname = $1;
 		$fdef = &quot;&quot;;

--=-1CUEaI9ukz+3URg0+IuH--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002523.html">[Gtk-sharp-list] Stuck in gtk-demo port from c to c#
</A></li>
	<LI> Next message: <A HREF="002532.html">[Gtk-sharp-list] enums not generated for gnomeprintui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2525">[ date ]</a>
              <a href="thread.html#2525">[ thread ]</a>
              <a href="subject.html#2525">[ subject ]</a>
              <a href="author.html#2525">[ author ]</a>
         </LI>
       </UL>
</body></html>
