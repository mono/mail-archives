<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] API decentralization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mwh%40sysrq.dk">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002561.html">
   <LINK REL="Next"  HREF="002563.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] API decentralization
   </H1>
    <B>Martin Willemoes Hansen
    </B> 
    <A HREF="mailto:mwh%40sysrq.dk"
       TITLE="[Gtk-sharp-list] API decentralization">mwh@sysrq.dk
       </A><BR>
    <I>Thu, 09 Oct 2003 23:22:06 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="002561.html">[Gtk-sharp-list] Makefile.in patches
</A></li>
        <LI> Next message: <A HREF="002563.html">[Gtk-sharp-list] gnome-vfs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2562">[ date ]</a>
              <a href="thread.html#2562">[ thread ]</a>
              <a href="subject.html#2562">[ subject ]</a>
              <a href="author.html#2562">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-6z8rjBzA5ZeJOshF6TDQ
Content-Type: multipart/alternative; boundary=&quot;=-j/7mIkWf1AXIt/raaVTt&quot;


--=-j/7mIkWf1AXIt/raaVTt
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hi!

I moved the api stuff to each assembly dir.

Okay to commit?
-- 
Martin Willemoes Hansen

--------------------------------------------------------
E-Mail	<A HREF="mailto:mwh@sysrq.dk">mwh@sysrq.dk</A>	Website	mwh.sysrq.dk
IRC     MWH, freenode.net
--------------------------------------------------------               


--=-j/7mIkWf1AXIt/raaVTt
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: 7bit

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 TRANSITIONAL//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
  &lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; CHARSET=UTF-8&quot;&gt;
  &lt;META NAME=&quot;GENERATOR&quot; CONTENT=&quot;GtkHTML/3.0.9&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
Hi!&lt;BR&gt;
&lt;BR&gt;
I moved the api stuff to each assembly dir.&lt;BR&gt;
&lt;BR&gt;
Okay to commit?&lt;BR&gt;
&lt;TABLE CELLSPACING=&quot;0&quot; CELLPADDING=&quot;0&quot; WIDTH=&quot;100%&quot;&gt;
&lt;TR&gt;
&lt;TD&gt;
&lt;PRE&gt;-- 
Martin Willemoes Hansen

--------------------------------------------------------
E-Mail	<A HREF="mailto:mwh@sysrq.dk">mwh@sysrq.dk</A>	Website	mwh.sysrq.dk
IRC     MWH, freenode.net
--------------------------------------------------------               
&lt;/PRE&gt;
&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

--=-j/7mIkWf1AXIt/raaVTt--

--=-6z8rjBzA5ZeJOshF6TDQ
Content-Disposition: attachment; filename=APIdecentralized.diff
Content-Type: text/x-patch; name=APIdecentralized.diff; charset=iso-8859-1
Content-Transfer-Encoding: 7bit

Index: Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/Makefile.in,v
retrieving revision 1.3
diff -u -r1.3 Makefile.in
--- Makefile.in	7 Oct 2003 05:52:22 -0000	1.3
+++ Makefile.in	9 Oct 2003 21:17:43 -0000
@@ -1,6 +1,6 @@
 NATIVE_DIRS = glue parser
 
-DIRS=generator api glib pango atk gdk gtk glade art gnome gtkhtml gda gnomedb gconf rsvg sample
+DIRS=generator glib pango atk gdk gtk glade art gnome gtkhtml gda gnomedb gconf rsvg sample
 ROOT=/cygdrive/$(subst \,/,$(subst :\,/,$(SYSTEMROOT)))
 CSC=$(ROOT)/microsoft.net/framework/v1.0.3705/csc.exe
 MCS=mcs
Index: configure.in
===================================================================
RCS file: /cvs/public/gtk-sharp/configure.in,v
retrieving revision 1.35
diff -u -r1.35 configure.in
--- configure.in	7 Oct 2003 05:52:22 -0000	1.35
+++ configure.in	9 Oct 2003 21:17:43 -0000
@@ -111,7 +111,6 @@
 glue/Makefile
 parser/Makefile
 generator/Makefile
-api/Makefile
 glib/Makefile
 pango/Makefile
 atk/Makefile
Index: api/.cvsignore
===================================================================
RCS file: api/.cvsignore
diff -N api/.cvsignore
--- api/.cvsignore	27 Feb 2003 05:16:47 -0000	1.2
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,6 +0,0 @@
-*.dll
-*.exe
-generated
-generated-stamp
-Makefile
-
Index: api/Makefile.in
===================================================================
RCS file: api/Makefile.in
diff -N api/Makefile.in
--- api/Makefile.in	7 Oct 2003 05:52:22 -0000	1.10
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,33 +0,0 @@
-APIS = \
-	atk-api.xml \
-	pango-api.xml \
-	gdk-api.xml \
-	gdk-symbols.xml \
-	gtk-api.xml \
-	gtk-symbols.xml \
-	glade-api.xml \
-	art-api.xml \
-	gnome-api.xml \
-	gda-api.xml \
-	gst-api.xml \
-	gnomedb-api.xml \
-	rsvg-api.xml \
-
-
-RUNTIME=mono 
-
-all: generated-stamp
-
-generated-stamp: $(APIS) ../generator/gapi_codegen.exe
-	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) &amp;&amp; touch generated-stamp
-
-clean:
-	rm -f generated-stamp
-
-prefix=@prefix@
-DESTDIR=
-apidir=$(DESTDIR)$(prefix)/share/gapi
-
-install: all
-	../mkinstalldirs $(apidir) &amp;&amp; \
-	cp $(APIS) $(apidir)

Index: art/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/art/.cvsignore,v
retrieving revision 1.1
diff -u -r1.1 .cvsignore
--- art/.cvsignore	16 Aug 2002 05:00:30 -0000	1.1
+++ art/.cvsignore	9 Oct 2003 21:17:43 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: art/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/art/Makefile.in,v
retrieving revision 1.6
diff -u -r1.6 Makefile.in
--- art/Makefile.in	8 Oct 2003 22:13:35 -0000	1.6
+++ art/Makefile.in	9 Oct 2003 21:17:43 -0000
@@ -1,22 +1,39 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           art-api.xml
 
-all: linux
+INCLUDE_APIS = 	../atk/atk-api.xml 	\
+		../pango/pango-api.xml 	\
+		../gdk/gdk-api.xml 	\
+		../gdk/gdk-symbols.xml
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /r:../pango/pango-sharp.dll /r:../atk/atk-sharp.dll /r:../gdk/gdk-sharp.dll /r:../gdk/gdk-imaging-sharp.dll /out:art-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=art-sharp.dll
 
-linux: art-sharp.dll
+all: $(ASSEMBLY)
 
-art-sharp.dll: generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -r System.Drawing -L ../glib -L ../pango -L ../atk -L ../gdk -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -r gdk-sharp.dll -o art-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=art-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r System.Drawing -r ../glib/glib-sharp.dll 		\
+	-r ../pango/pango-sharp.dll -r ../atk/atk-sharp.dll 	\
+	-r ../gdk/gdk-sharp.dll -o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
+
 install: all
-	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
-	cp art-sharp.dll $(DESTDIR)$(prefix)/lib
+	../mkinstalldirs $(libdir) &amp;&amp; 	\
+	cp $(APIS) $(apidir) &amp;&amp; 	\
+	cp $(ASSEMBLY) $(libdir)

Index: atk/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/atk/.cvsignore,v
retrieving revision 1.3
diff -u -r1.3 .cvsignore
--- atk/.cvsignore	21 Jun 2002 12:29:03 -0000	1.3
+++ atk/.cvsignore	9 Oct 2003 21:17:43 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: atk/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/atk/Makefile.in,v
retrieving revision 1.10
diff -u -r1.10 Makefile.in
--- atk/Makefile.in	8 Oct 2003 22:13:35 -0000	1.10
+++ atk/Makefile.in	9 Oct 2003 21:17:43 -0000
@@ -1,22 +1,34 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           atk-api.xml
 
-all: linux
+INCLUDE_APIS = 	../pango/pango-api.xml
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /r:../pango/pango-sharp.dll /out:atk-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=atk-sharp.dll
 
-linux: atk-sharp.dll
+all: $(ASSEMBLY)
 
-atk-sharp.dll: generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -L ../glib -L ../pango -r glib-sharp.dll -r pango-sharp.dll -o atk-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=art-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r ../glib/glib-sharp.dll -r ../pango/pango-sharp.dll 	\
+	-o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
-install: all
-	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
-	cp atk-sharp.dll $(DESTDIR)$(prefix)/lib
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
 
+install: all
+	../mkinstalldirs $(libdir) &amp;&amp; 	\
+	cp $(APIS) $(apidir) &amp;&amp; 	\
+	cp $(ASSEMBLY) $(libdir)

Index: gda/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/gda/.cvsignore,v
retrieving revision 1.1
diff -u -r1.1 .cvsignore
--- gda/.cvsignore	1 Sep 2002 10:29:39 -0000	1.1
+++ gda/.cvsignore	9 Oct 2003 21:17:44 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: gda/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/gda/Makefile.in,v
retrieving revision 1.6
diff -u -r1.6 Makefile.in
--- gda/Makefile.in	8 Oct 2003 22:13:36 -0000	1.6
+++ gda/Makefile.in	9 Oct 2003 21:17:44 -0000
@@ -1,22 +1,34 @@
+APIS=           gda-api.xml
+
+RUNTIME=mono
 MCS=mcs
-DESTDIR=
-prefix=@prefix@
+ASSEMBLY=gda-sharp.dll
 
<A HREF="mailto:-@ENABLE_GDA_TRUE">-@ENABLE_GDA_TRUE</A>@ all: linux
<A HREF="mailto:+@ENABLE_GDA_TRUE">+@ENABLE_GDA_TRUE</A>@ all: $(ASSEMBLY)
 @ENABLE_GDA_FALSE@ all: 
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /out:gda-sharp.dll /recurse:*.cs
-
-linux: gda-sharp.dll
+all: $(ASSEMBLY)
 
-gda-sharp.dll: Application.cs generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -L ../glib -r glib-sharp.dll -o gda-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe 		\
+	--generate $(APIS) --outdir=generated --customdir=.	\
+	--assembly-name=gda-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): generated-stamp *.cs
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r ../glib/glib-sharp.dll -o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
+
 install: all
<A HREF="mailto:-@ENABLE_GDA_TRUE">-@ENABLE_GDA_TRUE</A>@	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
<A HREF="mailto:-@ENABLE_GDA_TRUE">-@ENABLE_GDA_TRUE</A>@	cp gda-sharp.dll $(DESTDIR)$(prefix)/lib
<A HREF="mailto:+@ENABLE_GDA_TRUE">+@ENABLE_GDA_TRUE</A>@	../mkinstalldirs $(libdir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GDA_TRUE">+@ENABLE_GDA_TRUE</A>@	cp $(APIS) $(apidir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GDA_TRUE">+@ENABLE_GDA_TRUE</A>@	cp $(ASSEMBLY) $(libdir)

Index: gdk/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/gdk/.cvsignore,v
retrieving revision 1.4
diff -u -r1.4 .cvsignore
--- gdk/.cvsignore	21 Jun 2002 12:29:03 -0000	1.4
+++ gdk/.cvsignore	9 Oct 2003 21:17:44 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: gdk/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/gdk/Makefile.in,v
retrieving revision 1.12
diff -u -r1.12 Makefile.in
--- gdk/Makefile.in	8 Oct 2003 22:13:36 -0000	1.12
+++ gdk/Makefile.in	9 Oct 2003 21:17:44 -0000
@@ -1,22 +1,38 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           gdk-api.xml gdk-symbols.xml
 
-all: linux
+INCLUDE_APIS = 	../atk/atk-api.xml 	\
+		../pango/pango-api.xml
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /r:../pango/pango-sharp.dll /r:../atk/atk-sharp.dll /out:gdk-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=gdk-sharp.dll
 
-linux: gdk-sharp.dll
+all: $(ASSEMBLY)
 
-gdk-sharp.dll: *.cs generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -r System.Drawing -L ../glib -L ../pango -L ../atk -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -o gdk-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) *.custom ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=gdk-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r System.Drawing -r ../glib/glib-sharp.dll 		\
+	-r ../pango/pango-sharp.dll -r ../atk/atk-sharp.dll 	\
+	-o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
-install: all
-	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
-	cp gdk-sharp.dll $(DESTDIR)$(prefix)/lib
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
 
+install: all
+	../mkinstalldirs $(libdir) &amp;&amp;	\
+	for i in $(APIS); do		\
+		cp $$i $(apidir);	\
+	done &amp;&amp;				\
+	cp $(ASSEMBLY) $(libdir)

Index: gdk/gdk-symbols.xml
===================================================================
RCS file: gdk/gdk-symbols.xml
diff -N gdk/gdk-symbols.xml
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ gdk/gdk-symbols.xml	9 Oct 2003 21:17:45 -0000
@@ -0,0 +1,5 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
+&lt;api&gt;
+  &lt;symbol type=&quot;manual&quot; cname=&quot;GdkEvent&quot; name=&quot;Gdk.Event&quot;/&gt;
+&lt;/api&gt;
+
Index: glade/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/glade/.cvsignore,v
retrieving revision 1.1
diff -u -r1.1 .cvsignore
--- glade/.cvsignore	16 Aug 2002 05:00:31 -0000	1.1
+++ glade/.cvsignore	9 Oct 2003 21:17:45 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: glade/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/glade/Makefile.in,v
retrieving revision 1.6
diff -u -r1.6 Makefile.in
--- glade/Makefile.in	8 Oct 2003 22:13:36 -0000	1.6
+++ glade/Makefile.in	9 Oct 2003 21:17:45 -0000
@@ -1,22 +1,42 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           glade-api.xml
 
<A HREF="mailto:-@ENABLE_GLADE_TRUE">-@ENABLE_GLADE_TRUE</A>@ all: linux
<A HREF="mailto:-@ENABLE_GLADE_FALSE">-@ENABLE_GLADE_FALSE</A>@ all: 
+INCLUDE_APIS = 	../atk/atk-api.xml 	\
+		../pango/pango-api.xml 	\
+		../gdk/gdk-api.xml 	\
+		../gdk/gdk-symbols.xml	\
+		../gtk/gtk-api.xml	\
+		../gtk/gtk-symbols.xml
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /r:../pango/pango-sharp.dll /r:../atk/atk-sharp.dll /r:../gdk/gdk-sharp.dll /r:../gtk/gtk-sharp.dll /out:glade-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=glade-sharp.dll
 
-linux: glade-sharp.dll
<A HREF="mailto:+@ENABLE_GLADE_TRUE">+@ENABLE_GLADE_TRUE</A>@ all: $(ASSEMBLY)
<A HREF="mailto:+@ENABLE_GLADE_FALSE">+@ENABLE_GLADE_FALSE</A>@ all: 
 
-glade-sharp.dll: *.cs generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -r System.Drawing -L ../glib -L ../pango -L ../atk -L ../gdk -L ../gtk -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -r gdk-sharp.dll -r gtk-sharp.dll -o glade-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) *.custom ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=art-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r System.Drawing -r ../glib/glib-sharp.dll 		\
+	-r ../pango/pango-sharp.dll -r ../atk/atk-sharp.dll	\
+	-r ../gdk/gdk-sharp.dll -r ../gtk/gtk-sharp.dll 	\
+	-o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
+
 install: all
<A HREF="mailto:-@ENABLE_GLADE_TRUE">-@ENABLE_GLADE_TRUE</A>@	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
<A HREF="mailto:-@ENABLE_GLADE_TRUE">-@ENABLE_GLADE_TRUE</A>@	cp glade-sharp.dll $(DESTDIR)$(prefix)/lib
<A HREF="mailto:+@ENABLE_GLADE_TRUE">+@ENABLE_GLADE_TRUE</A>@	../mkinstalldirs $(libdir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GLADE_TRUE">+@ENABLE_GLADE_TRUE</A>@	cp $(APIS) $(apidir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GLADE_TRUE">+@ENABLE_GLADE_TRUE</A>@	cp $(ASSEMBLY) $(libdir)

Index: gnome/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/gnome/.cvsignore,v
retrieving revision 1.1
diff -u -r1.1 .cvsignore
--- gnome/.cvsignore	4 Aug 2002 18:54:11 -0000	1.1
+++ gnome/.cvsignore	9 Oct 2003 21:17:45 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: gnome/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/gnome/Makefile.in,v
retrieving revision 1.10
diff -u -r1.10 Makefile.in
--- gnome/Makefile.in	8 Oct 2003 22:13:37 -0000	1.10
+++ gnome/Makefile.in	9 Oct 2003 21:17:45 -0000
@@ -1,23 +1,43 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           gnome-api.xml
 
<A HREF="mailto:-@ENABLE_GNOME_TRUE">-@ENABLE_GNOME_TRUE</A>@ all: linux
<A HREF="mailto:-@ENABLE_GNOME_FALSE">-@ENABLE_GNOME_FALSE</A>@ all: 
+INCLUDE_APIS = 	../atk/atk-api.xml 	\
+		../pango/pango-api.xml 	\
+		../art/art-api.xml	\
+		../gdk/gdk-api.xml 	\
+		../gdk/gdk-symbols.xml	\
+		../gtk/gtk-api.xml	\
+		../gtk/gtk-symbols.xml
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /r:../pango/pango-sharp.dll /r:../atk/atk-sharp.dll /r:../gdk/gdk-sharp.dll /r:../gtk/gtk-sharp.dll /out:gnome-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=gnome-sharp.dll
 
-linux: gnome-sharp.dll
<A HREF="mailto:+@ENABLE_GNOME_TRUE">+@ENABLE_GNOME_TRUE</A>@ all: $(ASSEMBLY)
<A HREF="mailto:+@ENABLE_GNOME_FALSE">+@ENABLE_GNOME_FALSE</A>@ all: 
 
-gnome-sharp.dll: generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -r System.Drawing -L ../glib -L ../pango -L ../atk -L ../art -L ../gdk -L ../gtk -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -r art-sharp.dll -r gdk-sharp.dll -r gtk-sharp.dll -o gnome-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) *.custom ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=gnome-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r System.Drawing -r ../glib/glib-sharp.dll 		\
+	-r ../pango/pango-sharp.dll -r ../atk/atk-sharp.dll 	\
+	-r ../art/art-sharp.dll -r ../gdk/gdk-sharp.dll 	\
+	-r ../gtk/gtk-sharp.dll -o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
-install: all
<A HREF="mailto:-@ENABLE_GNOME_TRUE">-@ENABLE_GNOME_TRUE</A>@	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
<A HREF="mailto:-@ENABLE_GNOME_TRUE">-@ENABLE_GNOME_TRUE</A>@	cp gnome-sharp.dll $(DESTDIR)$(prefix)/lib
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
 
+install: all
<A HREF="mailto:+@ENABLE_GNOME_TRUE">+@ENABLE_GNOME_TRUE</A>@	../mkinstalldirs $(libdir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GNOME_TRUE">+@ENABLE_GNOME_TRUE</A>@	cp $(APIS) $(apidir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GNOME_TRUE">+@ENABLE_GNOME_TRUE</A>@	cp $(ASSEMBLY) $(libdir)

Index: gnomedb/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/gnomedb/.cvsignore,v
retrieving revision 1.1
diff -u -r1.1 .cvsignore
--- gnomedb/.cvsignore	11 Sep 2002 09:43:17 -0000	1.1
+++ gnomedb/.cvsignore	9 Oct 2003 21:17:51 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: gnomedb/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/gnomedb/Makefile.in,v
retrieving revision 1.6
diff -u -r1.6 Makefile.in
--- gnomedb/Makefile.in	8 Oct 2003 22:13:44 -0000	1.6
+++ gnomedb/Makefile.in	9 Oct 2003 21:17:51 -0000
@@ -1,22 +1,46 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           gnomedb-api.xml
 
<A HREF="mailto:-@ENABLE_GNOMEDB_TRUE">-@ENABLE_GNOMEDB_TRUE</A>@ all: linux
<A HREF="mailto:-@ENABLE_GNOMEDB_FALSE">-@ENABLE_GNOMEDB_FALSE</A>@ all: 
+INCLUDE_APIS = 	../atk/atk-api.xml 	\
+		../pango/pango-api.xml 	\
+		../art/art-api.xml	\
+		../gdk/gdk-api.xml 	\
+		../gdk/gdk-symbols.xml	\
+		../gtk/gtk-api.xml	\
+		../gtk/gtk-symbols.xml	\
+		../gnome/gnome-api.xml	\
+		../gda/gda-api.xml
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /r:../pango/pango-sharp.dll /r:../atk/atk-sharp.dll /r:../art/art-sharp.dll /r:../gdk/gdk-sharp.dll /r:../gtk/gtk-sharp.dll /r:../gnome/gnome-sharp.dll /r:../gda/gda-sharp.dll /out:gnomedb-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=gnomedb-sharp.dll
 
-linux: gnomedb-sharp.dll
<A HREF="mailto:+@ENABLE_GNOMEDB_TRUE">+@ENABLE_GNOMEDB_TRUE</A>@ all: $(ASSEMBLY)
<A HREF="mailto:+@ENABLE_GNOMEDB_FALSE">+@ENABLE_GNOMEDB_FALSE</A>@ all: 
 
-gnomedb-sharp.dll: Application.cs generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -L ../glib -L ../pango -L ../atk -L ../art -L ../gdk -L ../gtk -L ../gnome -L ../gda -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -r art-sharp.dll -r gdk-sharp.dll -r gtk-sharp.dll -r gnome-sharp.dll -r gda-sharp.dll -o gnomedb-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=gnomedb-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r ../glib/glib-sharp.dll -r ../pango/pango-sharp.dll 	\
+	-r ../atk/atk-sharp.dll -r ../art/art-sharp.dll 	\
+	-r ../gdk/gdk-sharp.dll -r ../gtk/gtk-sharp.dll 	\
+	-r ../gnome/gnome-sharp.dll -r ../gda/gda-sharp.dll 	\
+	-o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
+
 install: all
<A HREF="mailto:-@ENABLE_GNOMEDB_TRUE">-@ENABLE_GNOMEDB_TRUE</A>@	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
<A HREF="mailto:-@ENABLE_GNOMEDB_TRUE">-@ENABLE_GNOMEDB_TRUE</A>@	cp gnomedb-sharp.dll $(DESTDIR)$(prefix)/lib
<A HREF="mailto:+@ENABLE_GNOMEDB_TRUE">+@ENABLE_GNOMEDB_TRUE</A>@	../mkinstalldirs $(libdir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GNOMEDB_TRUE">+@ENABLE_GNOMEDB_TRUE</A>@	cp $(APIS) $(apidir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_GNOMEDB_TRUE">+@ENABLE_GNOMEDB_TRUE</A>@	cp $(ASSEMBLY) $(libdir)

Index: gst/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/gst/.cvsignore,v
retrieving revision 1.1
diff -u -r1.1 .cvsignore
--- gst/.cvsignore	3 Nov 2002 22:03:42 -0000	1.1
+++ gst/.cvsignore	9 Oct 2003 21:17:51 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: gst/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/gst/Makefile.in,v
retrieving revision 1.4
diff -u -r1.4 Makefile.in
--- gst/Makefile.in	8 Oct 2003 22:13:46 -0000	1.4
+++ gst/Makefile.in	9 Oct 2003 21:17:51 -0000
@@ -1,22 +1,33 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           gst-api.xml
 
-all: linux
-
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /out:gst-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=gst-sharp.dll
 
-linux: gst-sharp.dll
+all: $(ASSEMBLY)
 
-gst-sharp.dll: *.cs
-	$(MCS) --unsafe --target library -L ../glib -r glib-sharp.dll -o gst-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--outdir=generated --customdir=. --assembly-name=gst-sharp 	\
+	&amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe --target library \
+	-r glib-sharp.dll -o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
+
 install: all
-	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
-	cp gst-sharp.dll $(DESTDIR)$(prefix)/lib || exit 1
+	../mkinstalldirs $(libdir) &amp;&amp; 	\
+	cp $(APIS) $(apidir) &amp;&amp; 	\
+	cp $(ASSEMBLY) $(libdir)
+
 

Index: gtk/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/gtk/.cvsignore,v
retrieving revision 1.5
diff -u -r1.5 .cvsignore
--- gtk/.cvsignore	21 Jun 2002 12:29:04 -0000	1.5
+++ gtk/.cvsignore	9 Oct 2003 21:17:51 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: gtk/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/gtk/Makefile.in,v
retrieving revision 1.14
diff -u -r1.14 Makefile.in
--- gtk/Makefile.in	8 Oct 2003 22:13:47 -0000	1.14
+++ gtk/Makefile.in	9 Oct 2003 21:17:51 -0000
@@ -1,22 +1,40 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           gtk-api.xml gtk-symbols.xml
 
-all: linux
+INCLUDE_APIS = 	../atk/atk-api.xml 	\
+		../pango/pango-api.xml 	\
+		../gdk/gdk-api.xml 	\
+		../gdk/gdk-symbols.xml
 
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /r:../pango/pango-sharp.dll /r:../atk/atk-sharp.dll /r:../gdk/gdk-sharp.dll /r:../gdk/gdk-imaging-sharp.dll /out:gtk-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=gtk-sharp.dll
 
-linux: gtk-sharp.dll
+all: $(ASSEMBLY)
 
-gtk-sharp.dll: *.cs generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -r System.Drawing -L ../glib -L ../pango -L ../atk -L ../gdk -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -r gdk-sharp.dll -o gtk-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) *.custom ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=gtk-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r System.Drawing -r ../glib/glib-sharp.dll 		\
+	-r ../pango/pango-sharp.dll -r ../atk/atk-sharp.dll	\
+	-r ../gdk/gdk-sharp.dll -o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
-install: all
-	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
-	cp gtk-sharp.dll $(DESTDIR)$(prefix)/lib
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
 
+install: all
+	../mkinstalldirs $(libdir) &amp;&amp;		\
+	for i in $(APIS); do                    \
+		cp $$i $(apidir) || true;       \
+	done &amp;&amp; 				\
+	cp $(ASSEMBLY) $(libdir)

Index: gtk/gtk-symbols.xml
===================================================================
RCS file: gtk/gtk-symbols.xml
diff -N gtk/gtk-symbols.xml
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ gtk/gtk-symbols.xml	9 Oct 2003 21:17:53 -0000
@@ -0,0 +1,5 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
+&lt;api&gt;
+  &lt;symbol type=&quot;simple&quot; cname=&quot;GtkType&quot; name=&quot;uint&quot;/&gt;
+&lt;/api&gt;
+
Index: gtkhtml/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/gtkhtml/.cvsignore,v
retrieving revision 1.2
diff -u -r1.2 .cvsignore
--- gtkhtml/.cvsignore	7 Oct 2003 16:19:51 -0000	1.2
+++ gtkhtml/.cvsignore	9 Oct 2003 21:17:53 -0000
@@ -1,4 +1,4 @@
-gtkhtml-sharp.dll
+*.dll
 generated
 generated-stamp
 Makefile
Index: gtkhtml/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/gtkhtml/Makefile.in,v
retrieving revision 1.4
diff -u -r1.4 Makefile.in
--- gtkhtml/Makefile.in	7 Oct 2003 17:11:19 -0000	1.4
+++ gtkhtml/Makefile.in	9 Oct 2003 21:17:53 -0000
@@ -1,25 +1,34 @@
-INCLUDE_APIS = \
-	../api/atk-api.xml \
-	../api/pango-api.xml \
-	../api/gdk-api.xml \
-	../api/gdk-symbols.xml \
-	../api/gtk-symbols.xml \
-	../api/gtk-api.xml \
-	../api/gnome-api.xml
+APIS=           gtkhtml-api.xml
+
+INCLUDE_APIS = 	../atk/atk-api.xml	\
+		../pango/pango-api.xml 	\
+		../gdk/gdk-api.xml 	\
+		../gdk/gdk-symbols.xml 	\
+		../gtk/gtk-symbols.xml 	\
+		../gtk/gtk-api.xml 	\
+		../gnome/gnome-api.xml
 
 RUNTIME=mono 
+MCS=mcs
+ASSEMBLY=gtkhtml-sharp.dll
 
-all: gtkhtml-sharp.dll
+all: $(ASSEMBLY)
 
 generated-stamp: gtkhtml-api.xml *.custom ../generator/gapi_codegen.exe
-	$(RUNTIME) ../generator/gapi_codegen.exe --generate gtkhtml-api.xml --include $(INCLUDE_APIS) --outdir=generated --customdir=. --assembly-name=gtkhtml-sharp &amp;&amp; touch generated-stamp
-
-gtkhtml-sharp.dll: generated-stamp
-	 $(MCS) --unsafe -nowarn:0660,0661 --target library -L ../glib -L ../pango -L ../atk -L ../gdk -L ../gtk -L ../art -L ../gnome -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -r gdk-sharp.dll -r gtk-sharp.dll -r art-sharp.dll -r gnome-sharp.dll -o gtkhtml-sharp.dll --recurse '*.cs'
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS)	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=. 	\
+	--assembly-name=gtkhtml-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): generated-stamp
+	 $(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r ../glib/glib-sharp.dll -r ../pango/pango-sharp.dll 	\
+	-r ../atk/atk-sharp.dll -r ../gdk/gdk-sharp.dll 	\
+	-r ../gtk/gtk-sharp.dll -r ../art/art-sharp.dll 	\
+	-r ../gnome/gnome-sharp.dll -o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
 	rm -f generated-stamp
-	rm -f gtkhtml-sharp.dll
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
 prefix=@prefix@
@@ -29,5 +38,5 @@
 
 install: all
 	../mkinstalldirs $(apidir) &amp;&amp; \
-	cp gtkhtml-api.xml $(apidir) &amp;&amp; \
-	cp gtkhtml-sharp.dll $(libdir)
+	cp $(APIS) $(apidir) &amp;&amp; \
+	cp $(ASSEMBLY) $(libdir)
Index: pango/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/pango/.cvsignore,v
retrieving revision 1.4
diff -u -r1.4 .cvsignore
--- pango/.cvsignore	21 Jun 2002 12:29:04 -0000	1.4
+++ pango/.cvsignore	9 Oct 2003 21:17:53 -0000
@@ -1,6 +1,5 @@
 *.dll
-*.exe
-*.xml
 generated
+generated-stamp
 Makefile
 
Index: pango/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/pango/Makefile.in,v
retrieving revision 1.11
diff -u -r1.11 Makefile.in
--- pango/Makefile.in	8 Oct 2003 22:13:47 -0000	1.11
+++ pango/Makefile.in	9 Oct 2003 21:17:53 -0000
@@ -1,22 +1,32 @@
-MCS=mcs
-DESTDIR=
-prefix=@prefix@
+APIS=           pango-api.xml
 
-all: linux
-
-windows:
-	$(CSC) /unsafe /target:library /r:../glib/glib-sharp.dll /out:pango-sharp.dll /recurse:*.cs
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=pango-sharp.dll
 
-linux: pango-sharp.dll
+all: $(ASSEMBLY)
 
-pango-sharp.dll: generated/*.cs
-	$(MCS) --unsafe -nowarn:0660,0661 --target library -L ../glib -r glib-sharp.dll -r System.Drawing -o pango-sharp.dll --recurse '*.cs'
+generated-stamp: $(APIS) *.custom ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--outdir=generated --customdir=. --assembly-name=pango-sharp 	\
+	&amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r System.Drawing -r glib-sharp.dll 			\
+	-o $(ASSEMBLY) --recurse '*.cs'
 
 clean:
-	rm -f *.dll
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
-install: all
-	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
-	cp pango-sharp.dll $(DESTDIR)$(prefix)/lib
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
 
+install: all
+	../mkinstalldirs $(libdir) &amp;&amp; 	\
+	cp $(APIS) $(apidir) &amp;&amp; 	\
+	cp $(ASSEMBLY) $(libdir)

Index: rsvg/.cvsignore
===================================================================
RCS file: /cvs/public/gtk-sharp/rsvg/.cvsignore,v
retrieving revision 1.1
diff -u -r1.1 .cvsignore
--- rsvg/.cvsignore	27 Feb 2003 05:16:47 -0000	1.1
+++ rsvg/.cvsignore	9 Oct 2003 21:17:53 -0000
@@ -1,4 +1,5 @@
 *.dll
 generated
+generated-stamp
 Makefile
 
Index: rsvg/Makefile.in
===================================================================
RCS file: /cvs/public/gtk-sharp/rsvg/Makefile.in,v
retrieving revision 1.5
diff -u -r1.5 Makefile.in
--- rsvg/Makefile.in	8 Oct 2003 22:13:47 -0000	1.5
+++ rsvg/Makefile.in	9 Oct 2003 21:17:53 -0000
@@ -1,39 +1,43 @@
-COMPILER=mcs
-OUTPUT=rsvg-sharp.dll
-prefix=@prefix@
-
<A HREF="mailto:-@ENABLE_RSVG_TRUE">-@ENABLE_RSVG_TRUE</A>@ all: linux
<A HREF="mailto:-@ENABLE_RSVG_FALSE">-@ENABLE_RSVG_FALSE</A>@ all:
-
-linux: $(OUTPUT)
-
-$(OUTPUT): *.cs generated/*.cs
-	$(COMPILER) \
-	    --unsafe\
-            -nowarn:0660,0661 \
-	    --target library \
-	    -r ../glib/glib-sharp.dll \
-	    -r ../pango/pango-sharp.dll \
-	    -r ../atk/atk-sharp.dll \
-	    -r ../gdk/gdk-sharp.dll \
-	    -r ../gtk/gtk-sharp.dll \
-	    -r ../art/art-sharp.dll \
-	    -o $(OUTPUT) \
-	    --recurse '*.cs'
-
+APIS=           rsvg-api.xml
 
+INCLUDE_APIS = 	../atk/atk-api.xml 	\
+		../pango/pango-api.xml 	\
+		../gdk/gdk-api.xml 	\
+		../gdk/gdk-symbols.xml	\
+		../gtk/gtk-api.xml	\
+		../gtk/gtk-symbols.xml	\
+		../art/art-api.xml
+
+RUNTIME=mono
+MCS=mcs
+ASSEMBLY=rsvg-sharp.dll
 
-clean: clean-dll clean-generated
-
-clean-dll:
-	rm -f *.dll
<A HREF="mailto:+@ENABLE_RSVG_TRUE">+@ENABLE_RSVG_TRUE</A>@ all: $(ASSEMBLY)
<A HREF="mailto:+@ENABLE_RSVG_FALSE">+@ENABLE_RSVG_FALSE</A>@ all:
 
-clean-generated:	
+generated-stamp: $(APIS) ../generator/gapi_codegen.exe
+	$(RUNTIME) ../generator/gapi_codegen.exe --generate $(APIS) 	\
+	--include $(INCLUDE_APIS) --outdir=generated --customdir=.	\
+	--assembly-name=rsvg-sharp &amp;&amp; touch generated-stamp
+
+$(ASSEMBLY): *.cs generated-stamp
+	$(MCS) --unsafe -nowarn:0660,0661 --target library 	\
+	-r ../glib/glib-sharp.dll -r ../pango/pango-sharp.dll 	\
+	-r ../atk/atk-sharp.dll -r ../gdk/gdk-sharp.dll 	\
+	-r ../gtk/gtk-sharp.dll -r ../art/art-sharp.dll 	\
+	-o $(ASSEMBLY) --recurse '*.cs'
+
+clean:
+	rm -f generated-stamp
+	rm -f $(ASSEMBLY)
 	rm -rf generated
 
-
+prefix=/usr
+DESTDIR=
+apidir=$(DESTDIR)$(prefix)/share/gapi
+libdir=$(DESTDIR)$(prefix)/lib
 
 install: all
<A HREF="mailto:-@ENABLE_RSVG_TRUE">-@ENABLE_RSVG_TRUE</A>@	../mkinstalldirs $(DESTDIR)$(prefix)/lib &amp;&amp; \
<A HREF="mailto:-@ENABLE_RSVG_TRUE">-@ENABLE_RSVG_TRUE</A>@	cp $(OUTPUT) $(DESTDIR)$(prefix)/lib
-
<A HREF="mailto:+@ENABLE_RSVG_TRUE">+@ENABLE_RSVG_TRUE</A>@	../mkinstalldirs $(libdir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_RSVG_TRUE">+@ENABLE_RSVG_TRUE</A>@	cp $(APIS) $(apidir) &amp;&amp; 	\
<A HREF="mailto:+@ENABLE_RSVG_TRUE">+@ENABLE_RSVG_TRUE</A>@	cp $(ASSEMBLY) $(libdir)

Index: sources/gtk-sharp-sources.xml
===================================================================
RCS file: /cvs/public/gtk-sharp/sources/gtk-sharp-sources.xml,v
retrieving revision 1.2
diff -u -r1.2 gtk-sharp-sources.xml
--- sources/gtk-sharp-sources.xml	7 Oct 2003 05:52:23 -0000	1.2
+++ sources/gtk-sharp-sources.xml	9 Oct 2003 21:17:53 -0000
@@ -1,19 +1,19 @@
 &lt;gapi-parser-input&gt;
-  &lt;api filename=&quot;../api/atk-api.xml&quot;&gt;
+  &lt;api filename=&quot;../atk/atk-api.xml&quot;&gt;
     &lt;library name=&quot;libatk-1.0-0.dll&quot;&gt;
       &lt;namespace name=&quot;Atk&quot;&gt;
         &lt;dir&gt;atk-1.2.4/atk&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/pango-api.xml&quot;&gt;
+  &lt;api filename=&quot;../pango/pango-api.xml&quot;&gt;
     &lt;library name=&quot;libpango-1.0-0.dll&quot;&gt;
       &lt;namespace name=&quot;Pango&quot;&gt;
         &lt;dir&gt;pango-1.2.3/pango&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/gdk-api.xml&quot;&gt;
+  &lt;api filename=&quot;../gdk/gdk-api.xml&quot;&gt;
     &lt;library name=&quot;libgdk-win32-2.0-0.dll&quot;&gt;
       &lt;namespace name=&quot;Gdk&quot;&gt;
         &lt;dir&gt;gtk+-2.2.2/gdk&lt;/dir&gt;
@@ -25,14 +25,14 @@
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/gtk-api.xml&quot;&gt;
+  &lt;api filename=&quot;../gtk/gtk-api.xml&quot;&gt;
     &lt;library name=&quot;libgtk-win32-2.0-0.dll&quot;&gt;
       &lt;namespace name=&quot;Gtk&quot;&gt;
         &lt;dir&gt;gtk+-2.2.2/gtk&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/gnome-api.xml&quot;&gt;
+  &lt;api filename=&quot;../gnome/gnome-api.xml&quot;&gt;
     &lt;library name=&quot;gnome-2&quot;&gt;
       &lt;namespace name=&quot;Gnome&quot;&gt;
         &lt;dir&gt;libgnome-2.2.3/libgnome&lt;/dir&gt;
@@ -67,42 +67,42 @@
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/glade-api.xml&quot;&gt;
+  &lt;api filename=&quot;../glade/glade-api.xml&quot;&gt;
     &lt;library name=&quot;libglade-2.0-0.dll&quot;&gt;
       &lt;namespace name=&quot;Glade&quot;&gt;
         &lt;dir&gt;libglade-2.0.0/glade&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/art-api.xml&quot;&gt;
+  &lt;api filename=&quot;../art/art-api.xml&quot;&gt;
     &lt;library name=&quot;art_lgpl&quot;&gt;
       &lt;namespace name=&quot;Art&quot;&gt;
         &lt;dir&gt;libart_lgpl-2.3.10&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/gda-api.xml&quot;&gt;
+  &lt;api filename=&quot;../gda/gda-api.xml&quot;&gt;
     &lt;library name=&quot;gda-2&quot;&gt;
       &lt;namespace name=&quot;Gda&quot;&gt;
         &lt;dir&gt;libgda-1.0.0/libgda&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/gnomedb-api.xml&quot;&gt;
+  &lt;api filename=&quot;../gnomedb/gnomedb-api.xml&quot;&gt;
     &lt;library name=&quot;gnomedb-2&quot;&gt;
       &lt;namespace name=&quot;GnomeDb&quot;&gt;
         &lt;dir&gt;libgnomedb-1.0.0/libgnomedb&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/gst-api.xml&quot;&gt;
+  &lt;api filename=&quot;../gst/gst-api.xml&quot;&gt;
     &lt;library name=&quot;gstreamer&quot;&gt;
       &lt;namespace name=&quot;Gst&quot;&gt;
         &lt;dir&gt;gstreamer-0.4.2/gst&lt;/dir&gt;
       &lt;/namespace&gt;
     &lt;/library&gt;
   &lt;/api&gt;
-  &lt;api filename=&quot;../api/rsvg-api.xml&quot;&gt;
+  &lt;api filename=&quot;../rsvg/rsvg-api.xml&quot;&gt;
     &lt;library name=&quot;rsvg-2&quot;&gt;
       &lt;namespace name=&quot;Rsvg&quot;&gt;
         &lt;dir&gt;librsvg-2.2.5&lt;/dir&gt;

--=-6z8rjBzA5ZeJOshF6TDQ--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002561.html">[Gtk-sharp-list] Makefile.in patches
</A></li>
	<LI> Next message: <A HREF="002563.html">[Gtk-sharp-list] gnome-vfs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2562">[ date ]</a>
              <a href="thread.html#2562">[ thread ]</a>
              <a href="subject.html#2562">[ subject ]</a>
              <a href="author.html#2562">[ author ]</a>
         </LI>
       </UL>
</body></html>
