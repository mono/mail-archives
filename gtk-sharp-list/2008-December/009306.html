<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] How much metafiles are really supported in Mono?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20How%20much%20metafiles%20are%20really%20supported%20in%20Mono%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009296.html">
   <LINK REL="Next"  HREF="009308.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] How much metafiles are really supported in Mono?</H1>
    <B>romeok</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20How%20much%20metafiles%20are%20really%20supported%20in%20Mono%3F&In-Reply-To="
       TITLE="[Gtk-sharp-list] How much metafiles are really supported in Mono?">romeok at rosvet.com
       </A><BR>
    <I>Mon Dec 29 05:50:27 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="009296.html">[Gtk-sharp-list] Newbie compilation question.
</A></li>
        <LI>Next message: <A HREF="009308.html">[Gtk-sharp-list] How much metafiles are really supported in	Mono?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9306">[ date ]</a>
              <a href="thread.html#9306">[ thread ]</a>
              <a href="subject.html#9306">[ subject ]</a>
              <a href="author.html#9306">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
We are developers of Aspose.Words, it is a .NET component for
programmatically working with documents, conversions, report generation in
popular word processing formats.

&gt;<i>From time to time we test Aspose.Words with Mono and we state that
</I>Aspose.Words can run on Mono and there is interest from our customers for
that.

One of the features we have is conversion from DOC/OOXML/RTF to HTML.
Microsoft Word documents can contain EMF or WMF metafiles, but when saving
to HTML we normally render them to a raster image and save in a more
suitable format, such as PNG (because metafiles are not really welcome in
HTML).

To convert a metafile to a raster image on .NET we just use
Graphics.DrawImage that plays a metafile on a graphics object of a desired
size and resolution and then we just save to PNG.

I read somewhere that in Mono 2.0 metafiles are somewhat supported and can
be rendered to graphics. However, upon trying to do that I always get an
exception stating something in Graphics.DrawImage is not supported.

Upon inspection of the code I can see the following piece in image.c in
libgiplus:

	if (image-&gt;type == ImageTypeBitmap) {		if (gdip_is_an_indexed_pixelformat
(image-&gt;active_bitmap-&gt;pixel_format)) {
			GpStatus status = OutOfMemory;
			GpBitmap *rgb_bitmap = gdip_convert_indexed_to_rgb (image);
			if (rgb_bitmap) {
				status = GdipDrawImageRectRect (graphics, rgb_bitmap,
					dstx, dsty, dstwidth, dstheight,
					srcx, srcy, srcwidth, srcheight,
					srcUnit, imageAttributes, callback, callbackData);
				GdipDisposeImage (rgb_bitmap);
			}

			return status;
		}
	} else {
		/* metafile support */
		return NotImplemented;
	}


The highlighted code really looks like a bug in Mono to me. If you state
that metafiles can be rendered, then this code contradicts that statement.

So what is the state of metafile rendering and is it going to improve?

-- 
View this message in context: <A HREF="http://www.nabble.com/How-much-metafiles-are-really-supported-in-Mono--tp21201556p21201556.html">http://www.nabble.com/How-much-metafiles-are-really-supported-in-Mono--tp21201556p21201556.html</A>
Sent from the Mono - Gtk# mailing list archive at Nabble.com.

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009296.html">[Gtk-sharp-list] Newbie compilation question.
</A></li>
	<LI>Next message: <A HREF="009308.html">[Gtk-sharp-list] How much metafiles are really supported in	Mono?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9306">[ date ]</a>
              <a href="thread.html#9306">[ thread ]</a>
              <a href="subject.html#9306">[ subject ]</a>
              <a href="author.html#9306">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
