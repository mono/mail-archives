<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] TextTag.Weight property fix
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rodo%40matfyz.cz">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002986.html">
   <LINK REL="Next"  HREF="002988.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] TextTag.Weight property fix
   </H1>
    <B>Radek Doulik
    </B> 
    <A HREF="mailto:rodo%40matfyz.cz"
       TITLE="[Gtk-sharp-list] TextTag.Weight property fix">rodo@matfyz.cz
       </A><BR>
    <I>Fri, 12 Dec 2003 17:39:19 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="002986.html">[Gtk-sharp-list] am i need gtk?
</A></li>
        <LI> Next message: <A HREF="002988.html">[Gtk-sharp-list] TextTag.Weight property fix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2987">[ date ]</a>
              <a href="thread.html#2987">[ thread ]</a>
              <a href="subject.html#2987">[ subject ]</a>
              <a href="author.html#2987">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-vOhyn33L7NW8xSPDq+m9
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

attached patch fixes TextTag.Weight property, the custom file is needed
as well

cheers
Radek


--=-vOhyn33L7NW8xSPDq+m9
Content-Disposition: attachment; filename=text-tag-weight.fix
Content-Type: text/x-patch; name=text-tag-weight.fix; charset=ISO-8859-2
Content-Transfer-Encoding: 7bit

Index: ChangeLog
===================================================================
RCS file: /cvs/public/gtk-sharp/ChangeLog,v
retrieving revision 1.585
diff -u -p -r1.585 ChangeLog
--- ChangeLog	10 Dec 2003 22:56:49 -0000	1.585
+++ ChangeLog	12 Dec 2003 16:21:41 -0000
@@ -1,3 +1,14 @@
+2003-12-12  Radek Doulik  &lt;<A HREF="mailto:rodo@ximian.com">rodo@ximian.com</A>&gt;
+
+	* gtk/Gtk.metadata: hide TextTag.Weight property and implement it
+	in TextTag.custom. TextTag Weight property in gtk is of type int,
+	but we want it to be Pango.Weight enum
+
+2003-12-10  Radek Doulik  &lt;<A HREF="mailto:rodo@ximian.com">rodo@ximian.com</A>&gt;
+
+	* glue/program.c (get_default): moved check after strspec is set
+	so we don't check uninitialized value
+
 2003-12-10  Mike Kestner  &lt;<A HREF="mailto:mkestner@ximian.com">mkestner@ximian.com</A>&gt;
 
 	* generator/CallbackGen.cs : kill ref_owned generation
Index: glue/program.c
===================================================================
RCS file: /cvs/public/gtk-sharp/glue/program.c,v
retrieving revision 1.4
diff -u -p -r1.4 program.c
--- glue/program.c	22 Mar 2003 17:37:43 -0000	1.4
+++ glue/program.c	12 Dec 2003 16:21:43 -0000
@@ -24,9 +24,9 @@ get_default (GObjectClass *klass, const 
 	gchar *ret;
 
 	g_return_val_if_fail (spec != NULL, NULL);
+	strspec = G_PARAM_SPEC_STRING (spec);
 	g_return_val_if_fail (strspec != NULL, NULL);
 	
-	strspec = G_PARAM_SPEC_STRING (spec);
 	ret = g_strdup (strspec-&gt;default_value);
 	//g_param_spec_unref (spec);
 	
Index: gtk/Gtk.metadata
===================================================================
RCS file: /cvs/public/gtk-sharp/gtk/Gtk.metadata,v
retrieving revision 1.15
diff -u -p -r1.15 Gtk.metadata
--- gtk/Gtk.metadata	3 Dec 2003 23:08:14 -0000	1.15
+++ gtk/Gtk.metadata	12 Dec 2003 16:21:43 -0000
@@ -178,7 +178,7 @@
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkTextLayout']/method[@name='GetIterAtLine']/*/*[@type='GtkTextIter*']&quot; name=&quot;pass_as&quot;&gt;out&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkText']/signal[@name='SetScrollAdjustments']&quot; name=&quot;name&quot;&gt;ScrollAdjustmentsSet&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkTextTag']/method[@name='Event']&quot; name=&quot;name&quot;&gt;ProcessEvent&lt;/attr&gt;
-  &lt;attr path=&quot;/api/namespace/object[@cname='GtkTextTag']/property[@name='Weight']&quot; name=&quot;type&quot;&gt;PangoWeight&lt;/attr&gt;
+  &lt;attr path=&quot;/api/namespace/object[@cname='GtkTextTag']/property[@name='Weight']&quot; name=&quot;hidden&quot;&gt;1&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkTextTag']/signal[@name='Event']&quot; name=&quot;name&quot;&gt;TextEvent&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkTextView']/method[@name='GetIterAtLocation']/*/*[@type='GtkTextIter*']&quot; name=&quot;pass_as&quot;&gt;out&lt;/attr&gt;
   &lt;attr path=&quot;/api/namespace/object[@cname='GtkTextView']/method[@name='GetLineAtY']/*/*[@type='GtkTextIter*']&quot; name=&quot;pass_as&quot;&gt;out&lt;/attr&gt;
Index: gtk/gtk-api.xml
===================================================================
RCS file: /cvs/public/gtk-sharp/gtk/gtk-api.xml,v
retrieving revision 1.23
diff -u -p -r1.23 gtk-api.xml
--- gtk/gtk-api.xml	3 Dec 2003 23:08:14 -0000	1.23
+++ gtk/gtk-api.xml	12 Dec 2003 16:21:49 -0000
@@ -7292,7 +7292,7 @@
       &lt;property name=&quot;Family&quot; cname=&quot;family&quot; type=&quot;gchar*&quot; readable=&quot;true&quot; writeable=&quot;true&quot; /&gt;
       &lt;property name=&quot;Style&quot; cname=&quot;style&quot; type=&quot;PangoStyle&quot; readable=&quot;true&quot; writeable=&quot;true&quot; /&gt;
       &lt;property name=&quot;Variant&quot; cname=&quot;variant&quot; type=&quot;PangoVariant&quot; readable=&quot;true&quot; writeable=&quot;true&quot; /&gt;
-      &lt;property name=&quot;Weight&quot; cname=&quot;weight&quot; readable=&quot;true&quot; writeable=&quot;true&quot; type=&quot;PangoWeight&quot; /&gt;
+      &lt;property name=&quot;Weight&quot; cname=&quot;weight&quot; readable=&quot;true&quot; writeable=&quot;true&quot; type=&quot;PangoWeight&quot; hidden=&quot;1&quot; /&gt;
       &lt;property name=&quot;Stretch&quot; cname=&quot;stretch&quot; type=&quot;PangoStretch&quot; readable=&quot;true&quot; writeable=&quot;true&quot; /&gt;
       &lt;property name=&quot;Size&quot; cname=&quot;size&quot; type=&quot;gint&quot; readable=&quot;true&quot; writeable=&quot;true&quot; /&gt;
       &lt;property name=&quot;Scale&quot; cname=&quot;scale&quot; type=&quot;gdouble&quot; readable=&quot;true&quot; writeable=&quot;true&quot; /&gt;
Index: sample/GtkDemo/DemoTextView.cs
===================================================================
RCS file: /cvs/public/gtk-sharp/sample/GtkDemo/DemoTextView.cs,v
retrieving revision 1.3
diff -u -p -r1.3 DemoTextView.cs
--- sample/GtkDemo/DemoTextView.cs	20 Nov 2003 01:07:35 -0000	1.3
+++ sample/GtkDemo/DemoTextView.cs	12 Dec 2003 16:21:49 -0000
@@ -132,7 +132,7 @@ namespace GtkDemo
 		 */
 
 			TextTag tag  = new TextTag(&quot;heading&quot;);
-			tag.FontDesc.Weight = Pango.Weight.Bold;
+			tag.Weight = Pango.Weight.Bold;
 			tag.Size = (int) Pango.Scale.PangoScale * 15;
 			buffer.TagTable.Add(tag);
 
@@ -141,7 +141,7 @@ namespace GtkDemo
 			buffer.TagTable.Add(tag);
 
 			tag  = new TextTag(&quot;bold&quot;);
-			tag.FontDesc.Weight = Pango.Weight.Bold;
+			tag.Weight = Pango.Weight.Bold;
 			buffer.TagTable.Add(tag);
 
 			tag  = new TextTag(&quot;big&quot;);

--=-vOhyn33L7NW8xSPDq+m9
Content-Disposition: attachment; filename=TextTag.custom
Content-Type: text/plain; name=TextTag.custom; charset=ISO-8859-2
Content-Transfer-Encoding: 7bit

		//
		// Gtk.TextTag.custom - Gtk TextTag class customizations
		//
		// Author: Radek Doulik  (<A HREF="mailto:rodo@ximian.com">rodo@ximian.com</A>)
		//
		// Copyright (C) 2002 Ximian, Inc. 
		//
		// This code is inserted after the automatically generated code.
		//
		
		public Pango.Weight Weight {
			get {
				GLib.Value val = new GLib.Value ();
				GetProperty (&quot;weight&quot;, val);
				Pango.Weight ret = (Pango.Weight) (int) val;
				return ret;
			}
			set {
				SetProperty (&quot;weight&quot;, new GLib.Value ((int) value));
			}
		}
--=-vOhyn33L7NW8xSPDq+m9--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002986.html">[Gtk-sharp-list] am i need gtk?
</A></li>
	<LI> Next message: <A HREF="002988.html">[Gtk-sharp-list] TextTag.Weight property fix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2987">[ date ]</a>
              <a href="thread.html#2987">[ thread ]</a>
              <a href="subject.html#2987">[ subject ]</a>
              <a href="author.html#2987">[ author ]</a>
         </LI>
       </UL>
</body></html>
