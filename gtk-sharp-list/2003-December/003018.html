<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] ExposeEvent Feedback  ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:dkor%40media.mit.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="003016.html">
   <LINK REL="Next"  HREF="003019.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] ExposeEvent Feedback  ?
   </H1>
    <B>Daniel Kornhauser
    </B> 
    <A HREF="mailto:dkor%40media.mit.edu"
       TITLE="[Gtk-sharp-list] ExposeEvent Feedback  ?">dkor@media.mit.edu
       </A><BR>
    <I>Wed, 17 Dec 2003 17:52:29 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="003016.html">[Gtk-sharp-list] ExposeEvent Feedback  ?
</A></li>
        <LI> Next message: <A HREF="003019.html">[Gtk-sharp-list] ExposeEvent Feedback  ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3018">[ date ]</a>
              <a href="thread.html#3018">[ thread ]</a>
              <a href="subject.html#3018">[ subject ]</a>
              <a href="author.html#3018">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-4grzcLkOTT4woD7M00Sb
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Here is the full source. I still have to clean up the code

But I commented above the line that &quot;bugs&quot; me with
// THIS IS RE-EMITING THE SIGNAL

						Daniel.

On Wed, 2003-12-17 at 18:33, Miguel de Icaza wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> &gt; I'm trying to resize an image when my window is resized. But when I'm in
</I>&gt;<i> &gt; a ExposeEvent handler, doing
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; viewDisplay.Pixbuf = scaled_image;
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; throws another ExposeEvent witch leaves me continually throwing
</I>&gt;<i> &gt; ExposeEvent.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; What I'm I doing wrong ?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Should I use another Event type ?
</I>&gt;<i> 
</I>&gt;<i> Hard to tell what is going on there without the full source.
</I>
--=-4grzcLkOTT4woD7M00Sb
Content-Disposition: attachment; filename=viewbyexample.glade
Content-Type: application/x-glade; name=viewbyexample.glade
Content-Transfer-Encoding: 7bit

&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd"">http://glade.gnome.org/glade-2.0.dtd&quot;</A>&gt;

&lt;glade-interface&gt;

&lt;widget class=&quot;GtkWindow&quot; id=&quot;window1&quot;&gt;
  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;window1&lt;/property&gt;
  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
  &lt;signal name=&quot;delete_event&quot; handler=&quot;WindowDelete&quot; last_modification_time=&quot;Tue, 16 Dec 2003 05:58:55 GMT&quot;/&gt;

  &lt;child&gt;
    &lt;widget class=&quot;GtkHPaned&quot; id=&quot;hpaned1&quot;&gt;
      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;

      &lt;child&gt;
	&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox1&quot;&gt;
	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;

	  &lt;child&gt;
	    &lt;widget class=&quot;GtkMenuBar&quot; id=&quot;menubar1&quot;&gt;
	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;

	      &lt;child&gt;
		&lt;widget class=&quot;GtkMenuItem&quot; id=&quot;menuitem4&quot;&gt;
		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_File&lt;/property&gt;
		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;

		  &lt;child&gt;
		    &lt;widget class=&quot;GtkMenu&quot; id=&quot;menuitem4_menu&quot;&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;new1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-new&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;open1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-open&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;save1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-save&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;save_as1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-save-as&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkMenuItem&quot; id=&quot;separatormenuitem1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;quit1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-quit&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;
		    &lt;/widget&gt;
		  &lt;/child&gt;
		&lt;/widget&gt;
	      &lt;/child&gt;

	      &lt;child&gt;
		&lt;widget class=&quot;GtkMenuItem&quot; id=&quot;menuitem5&quot;&gt;
		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Edit&lt;/property&gt;
		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;

		  &lt;child&gt;
		    &lt;widget class=&quot;GtkMenu&quot; id=&quot;menuitem5_menu&quot;&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;cut1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-cut&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;copy1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-copy&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;paste1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-paste&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;delete1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot;&gt;gtk-delete&lt;/property&gt;
			  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;
		    &lt;/widget&gt;
		  &lt;/child&gt;
		&lt;/widget&gt;
	      &lt;/child&gt;

	      &lt;child&gt;
		&lt;widget class=&quot;GtkMenuItem&quot; id=&quot;menuitem6&quot;&gt;
		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_View&lt;/property&gt;
		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
		&lt;/widget&gt;
	      &lt;/child&gt;

	      &lt;child&gt;
		&lt;widget class=&quot;GtkMenuItem&quot; id=&quot;menuitem7&quot;&gt;
		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Help&lt;/property&gt;
		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;

		  &lt;child&gt;
		    &lt;widget class=&quot;GtkMenu&quot; id=&quot;menuitem7_menu&quot;&gt;

		      &lt;child&gt;
			&lt;widget class=&quot;GtkMenuItem&quot; id=&quot;about1&quot;&gt;
			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_About&lt;/property&gt;
			  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
			&lt;/widget&gt;
		      &lt;/child&gt;
		    &lt;/widget&gt;
		  &lt;/child&gt;
		&lt;/widget&gt;
	      &lt;/child&gt;
	    &lt;/widget&gt;
	    &lt;packing&gt;
	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
	    &lt;/packing&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;widget class=&quot;GtkHandleBox&quot; id=&quot;handlebox1&quot;&gt;
	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
	      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
	      &lt;property name=&quot;handle_position&quot;&gt;GTK_POS_LEFT&lt;/property&gt;
	      &lt;property name=&quot;snap_edge&quot;&gt;GTK_POS_TOP&lt;/property&gt;

	      &lt;child&gt;
		&lt;widget class=&quot;GtkToolbar&quot; id=&quot;toolbar1&quot;&gt;
		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
		  &lt;property name=&quot;orientation&quot;&gt;GTK_ORIENTATION_HORIZONTAL&lt;/property&gt;
		  &lt;property name=&quot;toolbar_style&quot;&gt;GTK_TOOLBAR_ICONS&lt;/property&gt;
		  &lt;property name=&quot;tooltips&quot;&gt;True&lt;/property&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;

		  &lt;child&gt;
		    &lt;placeholder/&gt;
		  &lt;/child&gt;
		&lt;/widget&gt;
	      &lt;/child&gt;
	    &lt;/widget&gt;
	    &lt;packing&gt;
	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
	    &lt;/packing&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;placeholder/&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;placeholder/&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;placeholder/&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;placeholder/&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;placeholder/&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;placeholder/&gt;
	  &lt;/child&gt;

	  &lt;child&gt;
	    &lt;widget class=&quot;GtkScrolledWindow&quot; id=&quot;scrolledwindow1&quot;&gt;
	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
	      &lt;property name=&quot;hscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
	      &lt;property name=&quot;vscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
	      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_NONE&lt;/property&gt;
	      &lt;property name=&quot;window_placement&quot;&gt;GTK_CORNER_TOP_LEFT&lt;/property&gt;

	      &lt;child&gt;
		&lt;placeholder/&gt;
	      &lt;/child&gt;
	    &lt;/widget&gt;
	    &lt;packing&gt;
	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
	    &lt;/packing&gt;
	  &lt;/child&gt;
	&lt;/widget&gt;
	&lt;packing&gt;
	  &lt;property name=&quot;shrink&quot;&gt;True&lt;/property&gt;
	  &lt;property name=&quot;resize&quot;&gt;False&lt;/property&gt;
	&lt;/packing&gt;
      &lt;/child&gt;

      &lt;child&gt;
	&lt;placeholder/&gt;
      &lt;/child&gt;
    &lt;/widget&gt;
  &lt;/child&gt;
&lt;/widget&gt;

&lt;/glade-interface&gt;

--=-4grzcLkOTT4woD7M00Sb
Content-Disposition: attachment; filename=ViewByExample.cs
Content-Type: text/plain; name=ViewByExample.cs; charset=
Content-Transfer-Encoding: 7bit

// Monopad.cs - A Simple Viewer  Example
//
// Author: Daniel Kornhauser
//
// (c) 2003 Daniel Kornhauser


using System;
using Gdk;
using Gtk;
using Glade;
using GtkSharp;
using System.Collections;
using System.IO;

public class Viewer
{
	public static void Main (string[] args)
	{
		new Viewer (args);
	}
	
	[Glade.Widget] Gtk.Window window;
	[Glade.Widget] VBox vbox1;
	[Glade.Widget] HPaned hpaned1;
	[Glade.Widget] ScrolledWindow scrolledwindow1;
	
	public Viewer (string[] args) 
	{
		Application.Init ();

		Glade.XML gxml = new Glade.XML (&quot;viewbyexample.glade&quot;, &quot;window1&quot;, null);
		gxml.Autoconnect (this);

		ArrayList images = new PixbufList ();

		ImageView imageView = new ImageView(images);
		hpaned1.Add2(imageView);

		ListStore thumbnailStore = new ThumbnailStore (images);
		ThumbnailView thumbnailView = new ThumbnailView (thumbnailStore, 
				                                 imageView);
		thumbnailView.ShowAll();
		scrolledwindow1.Add (thumbnailView);

		Application.Run ();	

	}		

	private void WindowDelete (object o, DeleteEventArgs args)
	{
		Application.Quit ();	
	}

}			

public class ImageView : ScrolledWindow
{
	public Gtk.Image viewDisplay;
	public ArrayList images;
	public Viewport viewport;
	public int pos;

	public ImageView (ArrayList images) 
	{
		this.images = images;

		Viewport viewport = new Viewport();
		this.Add(viewport);
		this.viewport = viewport;
		this.viewDisplay = new Gtk.Image ();
		this.viewDisplay.ExposeEvent += new ExposeEventHandler (ResizePixbuf);
		viewport.Add(viewDisplay);
		this.ShowAll();

	}
	public void ResizePixbuf (object obj, ExposeEventArgs args)
	{
		Gdk.EventExpose ev = args.Event;
		Gdk.Rectangle area = ev.area;
		Console.WriteLine (&quot;area&quot; , area.ToString());
	     	int image_width, image_height;
		int available_width = this.Allocation.width;
		int available_height = this.Allocation.height;
			Console.WriteLine(&quot;width {0}  height {1}&quot;,
					available_width.ToString(),
				        available_height.ToString());
		PixbufUtils.Fit ((Pixbuf) images[pos], 
				available_width,
				available_height, false,
				out image_width, out image_height);
		Pixbuf pixbuf = (Pixbuf) images[pos];
		Pixbuf scaled_image = pixbuf.ScaleSimple (
			                         image_width, image_height,
						 Gdk.InterpType.Bilinear); 
		viewDisplay.Pixbuf = scaled_image;		

	}

	public void LoadPixbuf (int pos)
	{
		int image_width, image_height;
		int available_width = this.Allocation.width;
		int available_height = this.Allocation.height;
		this.pos = pos;
			Console.WriteLine(&quot;width {0}  height {1}&quot;,
					available_width.ToString(),
				        available_height.ToString());
		PixbufUtils.Fit ((Pixbuf) images[pos], 
				available_width,
				available_height, false,
				out image_width, out image_height);
		Pixbuf pixbuf = (Pixbuf) images[pos];
		Pixbuf scaled_image = pixbuf.ScaleSimple (
			                         image_width, image_height,
						 Gdk.InterpType.Bilinear); 
		// THIS IS RE-EMITING THE SIGNAL
		viewDisplay.Pixbuf = scaled_image;		
	}

}


public class ThumbnailView : TreeView
{
	ImageView imageView;
	public ThumbnailView (ListStore thumbnailStore,
			      ImageView imageView) 
		: base (thumbnailStore)
	{
		this.imageView = imageView;
		Gtk.CellRendererPixbuf rendererPixbuf = new Gtk.CellRendererPixbuf();
		this.Selection.Changed += new EventHandler (OnTreeChanged);
		TreeViewColumn  column = new TreeViewColumn(null, rendererPixbuf, &quot;pixbuf&quot;, 0);
		this.AppendColumn(column);
		//this.Selection.SelectPath(new TreePath(&quot;0&quot;));
	}


	private void OnTreeChanged (object o, EventArgs args)
	{

		TreeIter iter;
		TreeModel model;

		if (this.Selection.GetSelected (out model, out iter)){
			TreePath path;
			path = this.Model.GetPath (iter);
			imageView.LoadPixbuf (path.Indices[0]);
		}
	}
}

public class ThumbnailStore : ListStore
{
	public ThumbnailStore (ArrayList images) : base (typeof(Pixbuf))
	{
		foreach (object image in images) {
			Console.WriteLine(image);
			Pixbuf pixbuf = (Pixbuf) image;
			pixbuf = pixbuf.ScaleSimple (64, 64, InterpType.Bilinear);
			this.AppendValues(pixbuf);}
	}
}

public class PixbufList : ArrayList
{
	public  PixbufList ()
	{

		DirectoryInfo dir_info = new DirectoryInfo (&quot;.&quot;);

		if (dir_info.Exists == false)
			throw new DirectoryNotFoundException (&quot;.&quot; + &quot; does not exist.&quot;);

		FileInfo [] files = dir_info.GetFiles ();

		foreach (FileInfo fi in files) {
			if (!fi.Name.EndsWith (&quot;png&quot;) &amp;&amp;
					!fi.Name.EndsWith (&quot;jpg&quot;) &amp;&amp;
					!fi.Name.EndsWith (&quot;jpeg&quot;) &amp;&amp;
					!fi.Name.EndsWith (&quot;gif&quot;))
				continue;
			else {
				string filename = String.Format (&quot;{0}/{1}&quot;, fi.DirectoryName, fi.Name);
				Pixbuf pixbuf = new Pixbuf (filename);
				this.Add (pixbuf);
			}
		}
	}

}


class PixbufUtils {

	public static int GetSize (Pixbuf pixbuf)
	{
		return Math.Max (pixbuf.Width, pixbuf.Height);
	}

	public static int ComputeScaledWidth (Pixbuf pixbuf, int size)
	{
		int orig_width = (int) pixbuf.Width;
		int orig_height = (int) pixbuf.Height;

		if (orig_width &gt; orig_height)
			return size;
		else
			return (int) Math.Round ((int) size * ((double) orig_width / (double) orig_height));
	}

	public static int ComputeScaledHeight (Pixbuf pixbuf, int size)
	{
		int orig_width = (int) pixbuf.Width;
		int orig_height = (int) pixbuf.Height;

		if (orig_width &gt; orig_height)
			return (int) Math.Round ((int) size * ((double) orig_height / (double) orig_width));
		else
			return size;
	}

	public static void Fit (Pixbuf pixbuf,
			int dest_width, int dest_height,
			bool upscale_smaller,
			out int fit_width, out int fit_height)
	{
		if (pixbuf.Width == 0 || pixbuf.Height == 0) {
			fit_width = 0;
			fit_height = 0;
			return;
		}

		if (pixbuf.Width &lt;= dest_width &amp;&amp; pixbuf.Height &lt;= dest_height &amp;&amp; ! upscale_smaller) {
			fit_width = pixbuf.Width;
			fit_height = pixbuf.Height;
			return;
		}

		fit_width = dest_width;
		fit_height = (int) Math.Round ((double) (pixbuf.Height * fit_width) / pixbuf.Width);

		if (fit_height &gt; dest_height) {
			fit_height = dest_height;
			fit_width = (int) Math.Round ((double) (pixbuf.Width * fit_height) / pixbuf.Height);
		}
	}

}


--=-4grzcLkOTT4woD7M00Sb--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="003016.html">[Gtk-sharp-list] ExposeEvent Feedback  ?
</A></li>
	<LI> Next message: <A HREF="003019.html">[Gtk-sharp-list] ExposeEvent Feedback  ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3018">[ date ]</a>
              <a href="thread.html#3018">[ thread ]</a>
              <a href="subject.html#3018">[ subject ]</a>
              <a href="author.html#3018">[ author ]</a>
         </LI>
       </UL>
</body></html>
