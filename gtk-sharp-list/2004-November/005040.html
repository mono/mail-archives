<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] TreeCellDataFunc problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:Freon%20%3Cfreongrr%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   
   
   <LINK REL="Next"  HREF="005056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] TreeCellDataFunc problem
   </H1>
    <B>Freon
    </B> 
    <A HREF="mailto:Freon%20%3Cfreongrr%40gmail.com%3E"
       TITLE="[Gtk-sharp-list] TreeCellDataFunc problem">Freon &lt;freongrr@gmail.com&gt;
       </A><BR>
    <I>Mon, 1 Nov 2004 15:09:57 +0100</I>
    <P><UL>
        
        <LI> Next message: <A HREF="005056.html">[Gtk-sharp-list] Re: TreeCellDataFunc problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5040">[ date ]</a>
              <a href="thread.html#5040">[ thread ]</a>
              <a href="subject.html#5040">[ subject ]</a>
              <a href="author.html#5040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I've been trying to get custom formatting in a TreeView using
TreeCellDataFunc, but to no avail.
Everything works fine when defining the tree or when the delegate
testDataFunc() is executed, but it crashes on ShowAll() with the
following error message:

Error :    at Gtk.Widget.gtk_widget_show_all(IntPtr raw)
   at Gtk.Widget.ShowAll()
   at TreeViewTest.Main(String[] args) in
c:\mono\prj\bugtreeview\main.cs:line 35

(&lt;unknown&gt;:3692): Gtk-CRITICAL **: file gtkmain.c: line 1187
(gtk_main_quit): assertion `main_loops != NULL' failed

Here is the test file I use:
(btw, I'm running WindowsXP with mono 1.0.2)

-----------------------------------------------------------

using System;
using System.Collections;
using Gtk;

public class TreeViewTest
{
    public static void Main(string[] args)
    {
        try 
        {
            Application.Init();

            Window win = new Window(&quot;TreeView Test&quot;);
            win.DeleteEvent += new DeleteEventHandler(OnWindowDeleteEvent);
            win.SetDefaultSize(400,250);

            ScrolledWindow sw = new ScrolledWindow();
            win.Add(sw);

            TreeStore store = new TreeStore( typeof (string) );

            for (int i=0; i &lt; 5; i++) 
            {
                TreeIter iter = store.AppendValues(&quot;Line &quot; + i);
            }

            TreeView tv = new TreeView();
            tv.Model = store;
            tv.HeadersVisible = true;

            tv.AppendColumn(&quot;Test&quot;, new CellRendererText(), new
TreeCellDataFunc(testDataFunc) );

            sw.Add(tv);
            sw.Show();
            win.ShowAll();
            Application.Run();
        } 
        catch(Exception e)
        {
            Console.WriteLine( &quot;Error : &quot; + e.StackTrace );
            Application.Quit();
        }
    }

    private static void testDataFunc (
        TreeViewColumn column,
        CellRenderer renderer,
        TreeModel model,
        TreeIter iter)
    {
        try
        {
            string text = model.GetValue(iter, 0) as string;
            (renderer as CellRendererText).Text = text.ToUpper();
        }
        catch (Exception e)
        {
            Console.WriteLine( &quot;error : &quot; + e.ToString() );
        }
    }

    public static void OnWindowDeleteEvent(object o, DeleteEventArgs args) 
    {
        Application.Quit();
        args.RetVal = true;
    }
}

-----------------------

Thanks in advance :)

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI> Next message: <A HREF="005056.html">[Gtk-sharp-list] Re: TreeCellDataFunc problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5040">[ date ]</a>
              <a href="thread.html#5040">[ thread ]</a>
              <a href="subject.html#5040">[ subject ]</a>
              <a href="author.html#5040">[ author ]</a>
         </LI>
       </UL>
</body></html>
