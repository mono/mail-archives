<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] More complete Gtk.Bin program
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:miguel%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="002177.html">
   <LINK REL="Next"  HREF="002166.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] More complete Gtk.Bin program
   </H1>
    <B>Miguel de Icaza
    </B> 
    <A HREF="mailto:miguel%40ximian.com"
       TITLE="[Gtk-sharp-list] More complete Gtk.Bin program">miguel@ximian.com
       </A><BR>
    <I>14 Jul 2003 22:21:50 -0400</I>
    <P><UL>
        <LI> Previous message: <A HREF="002177.html">[Gtk-sharp-list] Abstract classes.
</A></li>
        <LI> Next message: <A HREF="002166.html">[Gtk-sharp-list] Gtk+ 2.2 support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2165">[ date ]</a>
              <a href="thread.html#2165">[ thread ]</a>
              <a href="subject.html#2165">[ subject ]</a>
              <a href="author.html#2165">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey guys,

   Just for the record, this sample implements size negotiation (kind of
broken, since Widge.SizeRequest has the wrong signature, and is the
method we should be using).

   As you can see, in general, using Gtk.Bin is not a good idea if you
only want to write a simple composite widget.  Use Table, a Box or a
Fixed instead.

using System;
using Gtk;
using GtkSharp;

//
// A simple Bin class: a simple container that adds padding.
//
class MyPadder : Bin {
	int pad = 50;
	static GLib.Type type;
	Widget child;
	
	static MyPadder ()
	{
	        //
	        // Register the type on the static constructor, so it is
		// available on the instance constructors
		//
		type = RegisterGType (typeof (MyPadder));
	}
	
	public MyPadder () : base (type)
	{
		// To track our child widget.
		Added += new AddedHandler (MyAdded);

		// Participate in size negotiation
		SizeRequested += new SizeRequestedHandler (OnSizeRequested);
		SizeAllocated += new SizeAllocatedHandler (OnSizeAllocated);
	}

	//
	// Invoked to query our size
	//
	void OnSizeRequested (object o, SizeRequestedArgs args)
	{
		if (child != null){
			int width = args.Requisition.width;
			int height = args.Requisition.height;
			
			child.GetSizeRequest (out width, out height);
			if (width == -1 || height == -1)
				width = height = 80;
			SetSizeRequest (width + pad * 2, height + pad * 2);
		} 
		
	}

	//
	// Invoked to propagate our size
	//
	void OnSizeAllocated (object o, SizeAllocatedArgs args)
	{
		if (child != null){
			Gdk.Rectangle mine = args.Allocation;
			Gdk.Rectangle his = mine;

			his.x += pad;
			his.y += pad;
			his.width -= pad * 2;
			his.height -= pad * 2;
			child.SizeAllocate (his);
		}
	}

	//
	// Public property of the Padding widget
	//
	public int Pad {
		get {
			return pad;
		}

		set {
			pad = value;
			QueueResize ();
		}
	}

	void MyAdded (object o, AddedArgs args)
	{
		child = args.Widget;
	}
}

class Y {
	static void Main ()
	{
		Application.Init ();

		Window w = new Window (&quot;Hello&quot;);
		MyPadder x = new MyPadder ();
		x.Pad = 100;
		Button b = new Button (&quot;Hola&quot;);
		w.Add (x);
		x.Add (b);

		w.ShowAll ();
		
		Application.Run ();
	}
}
-- 
Miguel de Icaza &lt;<A HREF="mailto:miguel@ximian.com">miguel@ximian.com</A>&gt;

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="002177.html">[Gtk-sharp-list] Abstract classes.
</A></li>
	<LI> Next message: <A HREF="002166.html">[Gtk-sharp-list] Gtk+ 2.2 support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2165">[ date ]</a>
              <a href="thread.html#2165">[ thread ]</a>
              <a href="subject.html#2165">[ subject ]</a>
              <a href="author.html#2165">[ author ]</a>
         </LI>
       </UL>
</body></html>
