<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.28.3&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
I'm&nbsp;trying&nbsp;to&nbsp;execute&nbsp;a&nbsp;SQL&nbsp;statement&nbsp;against&nbsp;a&nbsp;SQLite&nbsp;database&nbsp;with&nbsp;parameters&nbsp;instead&nbsp;of&nbsp;embedding&nbsp;the&nbsp;parameter&nbsp;values&nbsp;directly&nbsp;into&nbsp;the&nbsp;SQL&nbsp;command&nbsp;text&nbsp;(not&nbsp;using&nbsp;parameters).&amp;nbsp;&nbsp;I&nbsp;know&nbsp;my&nbsp;database&nbsp;is&nbsp;not&nbsp;read&nbsp;only&nbsp;because&nbsp;I&nbsp;can&nbsp;do&nbsp;an&nbsp;insert&nbsp;without&nbsp;the&nbsp;parameters.&amp;nbsp;&nbsp;When&nbsp;I&nbsp;use&nbsp;the&nbsp;parameters,&nbsp;though,&nbsp;I&nbsp;get&nbsp;the&nbsp;error&nbsp;below:&amp;nbsp;&nbsp;I've&nbsp;attached&nbsp;a&nbsp;snippet&nbsp;of&nbsp;the&nbsp;insert&nbsp;code.&amp;nbsp;&nbsp;If&nbsp;you&nbsp;know&nbsp;what&nbsp;I'm&nbsp;doing&nbsp;wrong,&nbsp;I&nbsp;would&nbsp;greatly&nbsp;appreciate&nbsp;a&nbsp;tip.&amp;nbsp;&nbsp;Thanks.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Aaron&lt;BR&gt;<br>
&lt;BR&gt;<br>
Exception&nbsp;in&nbsp;Gtk#&nbsp;callback&nbsp;delegate&lt;BR&gt;<br>
&amp;nbsp;&nbsp;Note:&nbsp;Applications&nbsp;can&nbsp;use&nbsp;GLib.ExceptionManager.UnhandledException&nbsp;to&nbsp;handle&nbsp;the&nbsp;exception.&lt;BR&gt;<br>
System.Reflection.TargetInvocationException:&nbsp;Exception&nbsp;has&nbsp;been&nbsp;thrown&nbsp;by&nbsp;the&nbsp;target&nbsp;of&nbsp;an&nbsp;invocation.&nbsp;---&amp;gt;&nbsp;Mono.Data.SqliteClient.SqliteExecutionException:&nbsp;SQL&nbsp;logic&nbsp;error&nbsp;or&nbsp;missing&nbsp;database&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;Mono.Data.SqliteClient.SqliteCommand.ExecuteStatement&nbsp;(IntPtr&nbsp;pStmt,&nbsp;System.Int32&amp;amp;&nbsp;cols,&nbsp;System.IntPtr&amp;amp;&nbsp;pazValue,&nbsp;System.IntPtr&amp;amp;&nbsp;pazColName)&nbsp;[0x0001f]&nbsp;in&nbsp;/build/buildd/mono-2.6.7/mcs/class/Mono.Data.SqliteClient/Mono.Data.SqliteClient/SqliteCommand.cs:385&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;Mono.Data.SqliteClient.SqliteCommand.ExecuteStatement&nbsp;(IntPtr&nbsp;pStmt)&nbsp;[0x00000]&nbsp;in&nbsp;/build/buildd/mono-2.6.7/mcs/class/Mono.Data.SqliteClient/Mono.Data.SqliteClient/SqliteCommand.cs:374&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;Mono.Data.SqliteClient.SqliteCommand.ExecuteReader&nbsp;(CommandBehavior&nbsp;behavior,&nbsp;Boolean&nbsp;want_results,&nbsp;System.Int32&amp;amp;&nbsp;rows_affected)&nbsp;[0x000c3]&nbsp;in&nbsp;/build/buildd/mono-2.6.7/mcs/class/Mono.Data.SqliteClient/Mono.Data.SqliteClient/SqliteCommand.cs:613&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;Mono.Data.SqliteClient.SqliteCommand.ExecuteNonQuery&nbsp;()&nbsp;[0x00000]&nbsp;in&nbsp;/build/buildd/mono-2.6.7/mcs/class/Mono.Data.SqliteClient/Mono.Data.SqliteClient/SqliteCommand.cs:501&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;Foodle.SQLiteCommon.ScanHistoryGateway.InsertRecord&nbsp;(Foodle.SQLiteCommon.ScanHistory&nbsp;recScanHistory)&nbsp;[0x0018e]&nbsp;in&nbsp;/home/aaron/Foodle/GTK#/SQLiteCommon/ScanHistoryGateway.cs:231&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;MainWindow.ProcessFoodleScan&nbsp;(System.String&nbsp;sUPCCode)&nbsp;[0x00080]&nbsp;in&nbsp;/home/aaron/Foodle/GTK#/KitchenApp/KitchenApp/MainWindow.cs:1097&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;MainWindow.OnKeyReleaseEvent&nbsp;(System.Object&nbsp;o,&nbsp;Gtk.KeyReleaseEventArgs&nbsp;args)&nbsp;[0x00160]&nbsp;in&nbsp;/home/aaron/Foodle/GTK#/KitchenApp/KitchenApp/MainWindow.cs:1030&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;(wrapper&nbsp;managed-to-native)&nbsp;System.Reflection.MonoMethod:InternalInvoke&nbsp;(object,object[],System.Exception&amp;amp;)&lt;BR&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;System.Reflection.MonoMethod.Invoke&nbsp;(System.Object&nbsp;obj,&nbsp;BindingFlags&nbsp;invokeAttr,&nbsp;System.Reflection.Binder&nbsp;binder,&nbsp;System.Object[]&nbsp;parameters,&nbsp;System.Globalization.CultureInfo&nbsp;culture)&nbsp;[0x000d0]&nbsp;in&nbsp;/build/buildd/mono-2.6.7/mcs/class/corlib/System.Reflection/MonoMethod.cs:213&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
public&nbsp;int&nbsp;InsertRecord(ScanHistory&nbsp;recScanHistory)&lt;BR&gt;<br>
{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;iScanHistoryId&nbsp;=&nbsp;GetNextTableId();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;try&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(this.Connection.State&nbsp;!=&nbsp;System.Data.ConnectionState.Open)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;this.Connection.Open();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;IDbCommand&nbsp;objDbCommand&nbsp;=&nbsp;this.Connection.CreateCommand();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;select&nbsp;the&nbsp;data&nbsp;from&nbsp;the&nbsp;db&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;StringBuilder&nbsp;stbSQL&nbsp;=&nbsp;new&nbsp;StringBuilder();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;stbSQL.AppendLine(&amp;quot;INSERT&nbsp;INTO&nbsp;ScanHistory&nbsp;&amp;quot;);&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;stbSQL.AppendLine(&amp;quot;(ScanHistoryId,&nbsp;UPCCode,&nbsp;ScanDate,&nbsp;ItemId,&nbsp;Quantity,&nbsp;Note)&nbsp;&amp;quot;);&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;stbSQL.AppendLine(&amp;quot;VALUES&nbsp;(:ScanHistoryId,&nbsp;:UPCCode,&nbsp;:ScanDate,&nbsp;:ItemId,&nbsp;:Quantity,&nbsp;:Note);&nbsp;&amp;quot;);&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.CommandText&nbsp;=&nbsp;stbSQL.ToString();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;assign&nbsp;the&nbsp;parameters&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;ScanHistoryId&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:ScanHistoryId&amp;quot;,&nbsp;recScanHistory.ScanHistoryId));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;UPCCode&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:UPCCode&amp;quot;,&nbsp;recScanHistory.UPCCode));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;ScanDate&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:ScanDate&amp;quot;,&nbsp;recScanHistory.ScanDate));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;ItemId&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(recScanHistory.ItemId&nbsp;&amp;gt;&nbsp;0)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:ItemId&amp;quot;,&nbsp;recScanHistory.ItemId));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:ItemId&amp;quot;,&nbsp;DBNull.Value));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;Quantity&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:Quantity&amp;quot;,&nbsp;recScanHistory.Quantity));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;Note&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(recScanHistory.Note&nbsp;!=&nbsp;&amp;quot;&amp;quot;&amp;nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;recScanHistory.Note&nbsp;!=&nbsp;null)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:Note&amp;quot;,&nbsp;recScanHistory.Note));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Parameters.Add(new&nbsp;SqliteParameter(&amp;quot;:Note&amp;quot;,&nbsp;DBNull.Value));&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Prepare();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;execute&nbsp;the&nbsp;insert&nbsp;statement&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;iRowsAffected&nbsp;=&nbsp;objDbCommand.ExecuteNonQuery();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(iRowsAffected&nbsp;==&nbsp;0)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;iScanHistoryId&nbsp;=&nbsp;0;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;clean&nbsp;up&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand.Dispose();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;objDbCommand&nbsp;=&nbsp;null;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;stbSQL&nbsp;=&nbsp;null;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;}&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;finally&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;close&nbsp;the&nbsp;connection&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(this.Connection.State&nbsp;!=&nbsp;ConnectionState.Closed)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;this.Connection.Close();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;}&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;iScanHistoryId;&lt;BR&gt;<br>
}&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
