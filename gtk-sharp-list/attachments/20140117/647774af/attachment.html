<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;p&gt;&lt;span&nbsp;id=&quot;result_box&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Can&nbsp;someone&nbsp;please&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;tell&nbsp;me&nbsp;why&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;the&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;code&nbsp;below&nbsp;with&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;doing&nbsp;well&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;in&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Windows&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;but&nbsp;not&nbsp;in&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Linux?&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;In&nbsp;linux&nbsp;generate&nbsp;the&nbsp;error&nbsp;&quot;Message&nbsp;could&nbsp;not&nbsp;be&nbsp;sent.&quot;!!!.&nbsp;but&nbsp;not&nbsp;give&nbsp;me&nbsp;more&nbsp;details.&lt;/p&gt;&lt;p&gt;&lt;span&nbsp;id=&quot;result_box&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;First&nbsp;I&nbsp;thought&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;the&nbsp;problem&nbsp;was&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;the&nbsp;attachment,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;tried&nbsp;to&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;remove&nbsp;these&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;lines&nbsp;of&nbsp;code&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;but&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;the&nbsp;problem&nbsp;persists&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&nbsp;id=&quot;result_box&quot;&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;from&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;already&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;thank&nbsp;you&nbsp;very&nbsp;much.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Saludos&nbsp;y&nbsp;muchas&nbsp;gracias!!.&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;public&nbsp;class&nbsp;enviar_email<br>
&lt;br&gt;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;Window&nbsp;ventana;<br>
&lt;br&gt;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;public&nbsp;enviar_email(string[]&nbsp;para,&nbsp;string[]&nbsp;cc,&nbsp;string[]&nbsp;cco,<br>
&lt;br&gt;   &nbsp;   &nbsp;                   &nbsp;string&nbsp;asunto,&nbsp;string&nbsp;mensaje,&nbsp;string&nbsp;caminoAdjunto,<br>
&lt;br&gt;   &nbsp;   &nbsp;                   &nbsp;string&nbsp;tipoDeDato,&nbsp;out&nbsp;bool&nbsp;enviadoOK)<br>
&lt;br&gt;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;//determino&nbsp;los&nbsp;datos&nbsp;del&nbsp;usuario<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;DataTableReader&nbsp;reader&nbsp;=&nbsp;new&nbsp;DataTableReader(MainWindow.tablaUsuarioActual);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;reader.Read();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;uint&nbsp;IdUsuario&nbsp;= &nbsp;uint.Parse(reader[&quot;IdUsuario&quot;].ToString());<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;string&nbsp;email_rtte&nbsp;=&nbsp;reader[&quot;email&quot;].ToString();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;string&nbsp;usuario_casilla&nbsp;=&nbsp;reader[&quot;usuarioEmail&quot;].ToString();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;string&nbsp;contraseña_casilla&nbsp;=&nbsp;reader[&quot;contraseniaEmail&quot;].ToString();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;string&nbsp;servidorSMTP&nbsp;=&nbsp;reader[&quot;servidor_salida&quot;].ToString();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;string&nbsp;servidorAutentic&nbsp;=&nbsp;reader[&quot;servidor_autenticacion&quot;].ToString();<br>
&lt;br&gt;   &nbsp;   &nbsp;       &nbsp;   &nbsp;    &nbsp;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;//verifico&nbsp;que&nbsp;existan&nbsp;los&nbsp;datos&nbsp;de&nbsp;usuario&nbsp;p/poder&nbsp;enviar<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;if(email_rtte.Length&nbsp;==&nbsp;0&nbsp;|&nbsp;usuario_casilla.Length&nbsp;==&nbsp;0&nbsp;|&nbsp;contraseña_casilla.Length&nbsp;==&nbsp;0<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;  &nbsp;|&nbsp;servidorSMTP.Length&nbsp;==&nbsp;0&nbsp;|&nbsp;servidorAutentic.Length&nbsp;==&nbsp;0)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   <br>
&nbsp;   &nbsp;   &nbsp;   &nbsp;muestraDialogo&nbsp;msjErrorEmail&nbsp;=&nbsp;new&nbsp;muestraDialogo(&quot;Falta&nbsp;<br>
configuración&quot;,&nbsp;&quot;Los&nbsp;datos&nbsp;de&nbsp;configuración&nbsp;necesarios&nbsp;para&nbsp;enviar&quot;&nbsp;+<br>
&lt;br&gt;   <br>
&nbsp;   &nbsp;   &nbsp;   &nbsp;                                                 &nbsp;&quot;\ncorreo<br>
&nbsp;electrónico&nbsp;no&nbsp;estan&nbsp;completos.&nbsp;Diríjase&nbsp;a&nbsp;&#39;Configuración-Usuarios&#39;&quot;&nbsp;+<br>
&lt;br&gt;   <br>
&nbsp;   &nbsp;   &nbsp;   &nbsp;                                                 &nbsp;&quot;\npara&nbsp;<br>
completar&nbsp;los&nbsp;datos&nbsp;faltantes.&quot;,&nbsp;MessageType.Warning);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;enviadoOK&nbsp;=&nbsp;false;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;return;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;MailMessage&nbsp;mailMensaje&nbsp;=&nbsp;new&nbsp;MailMessage();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;mailMensaje.From&nbsp;=&nbsp;new&nbsp;MailAddress(email_rtte);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;if(para[0]!=&nbsp;&quot;vacio&quot;)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;foreach(string&nbsp;Para&nbsp;in&nbsp;para&nbsp;)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;MailAddress&nbsp;mailAddressPara&nbsp;=&nbsp;new&nbsp;MailAddress(Para);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;mailMensaje.To.Add(mailAddressPara);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;if(cc.Length&nbsp;!=&nbsp;0)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;foreach(string&nbsp;conCopia&nbsp;in&nbsp;cc&nbsp;)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;if(conCopia&nbsp;==&nbsp;&quot;&quot;)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;break;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;MailAddress&nbsp;mailAddressCC&nbsp;=&nbsp;new&nbsp;MailAddress(conCopia);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;mailMensaje.CC.Add(mailAddressCC);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;if(cco.Length&nbsp;!=&nbsp;0)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;foreach(string&nbsp;conCopiaOculta&nbsp;in&nbsp;cco&nbsp;)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;if(conCopiaOculta&nbsp;==&nbsp;&quot;&quot;)<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;break;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;MailAddress&nbsp;mailAddressCCO&nbsp;=&nbsp;new&nbsp;MailAddress(conCopiaOculta);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;mailMensaje.Bcc.Add(mailAddressCCO);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;//aislo&nbsp;el&nbsp;nombre&nbsp;del&nbsp;adjunto&nbsp;del&nbsp;camino&nbsp;pasado&nbsp;a&nbsp;la&nbsp;clase<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;char&nbsp;caracterSeparador&nbsp;=&nbsp;(MainWindow.separadorDir.ToCharArray())[0];<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;int&nbsp;indiceFinal&nbsp;=&nbsp;caminoAdjunto.LastIndexOf(caracterSeparador);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;string&nbsp;nombreArchivo&nbsp;=&nbsp;caminoAdjunto.Substring(indiceFinal+1,&nbsp;caminoAdjunto.Length-(indiceFinal+1));<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;    &nbsp;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;mailMensaje.Subject&nbsp;=&nbsp;asunto;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;Attachment&nbsp;adjunto&nbsp;=&nbsp;new&nbsp;Attachment(caminoAdjunto);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;mailMensaje.Attachments.Add(adjunto);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;//con&nbsp;la&nbsp;linea&nbsp;siguiente&nbsp;configuro&nbsp;la&nbsp;opcion&nbsp;de&nbsp;la&nbsp;confirmacion&nbsp;de&nbsp;lectura<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;//y&nbsp;a&nbsp;que&nbsp;direccion&nbsp;debera&nbsp;enviar&nbsp;dicha&nbsp;confirmacion<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;mailMensaje.Headers.Add(&quot;Disposition-Notification-To&quot;,&nbsp;usuario_casilla);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;SmtpClient&nbsp;cliente&nbsp;=&nbsp;new&nbsp;SmtpClient(servidorAutentic,&nbsp;25);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;cliente.Credentials&nbsp;=&nbsp;new&nbsp;System.Net.NetworkCredential(usuario_casilla,&nbsp;contraseña_casilla);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp; <br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;try<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cliente.Send(mailMensaje);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;catch&nbsp;(SmtpException&nbsp;ex) <br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;{<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;muestraDialogo&nbsp;dialogoError&nbsp;=&nbsp;new&nbsp;muestraDialogo(&quot;Error&nbsp;en&nbsp;envío&nbsp;de&nbsp;e-mail&quot;,<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;                                                &nbsp;&quot;Hubo&nbsp;un&nbsp;error&nbsp;en&nbsp;el&nbsp;intento&nbsp;de&nbsp;envío&nbsp;&quot;&nbsp;+<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;                                                &nbsp;&quot;del&nbsp;correo&nbsp;electronico.&quot;&nbsp;+<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;                                                &nbsp;&quot;\nPor&nbsp;favor&nbsp;pongase&nbsp;en&nbsp;contacto&nbsp;con&nbsp;el&nbsp;administrador&quot;&nbsp;+<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;                                                &nbsp;&quot;\ndel&nbsp;sistema&nbsp;y&nbsp;comentele&nbsp;del&nbsp;error&nbsp;recibido.&quot;&nbsp;+<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;                                                &nbsp;&quot;\nMensaje&nbsp;del&nbsp;error:&nbsp;&quot;&nbsp;+&nbsp;ex.Message,<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;                                                &nbsp;MessageType.Error);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;enviadoOK&nbsp;=&nbsp;false;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;mailMensaje.Dispose();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;bool&nbsp;eliminado;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;EliminarArchivo&nbsp;eliminarFile&nbsp;=&nbsp;new&nbsp;EliminarArchivo(caminoAdjunto,&nbsp;out&nbsp;eliminado);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;return;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}<br>
&lt;br&gt; &lt;br&gt;   &nbsp;   &nbsp;   &nbsp;MessageDialog&nbsp;dialogo&nbsp;=&nbsp;new&nbsp;MessageDialog(ventana,DialogFlags.Modal,&nbsp;MessageType.Info,<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;                                         &nbsp;ButtonsType.Ok,&nbsp;&quot;El&nbsp;correo&nbsp;se&nbsp;envió&nbsp;satisfactoriamente.&quot;);<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;dialogo.UseMarkup&nbsp;=&nbsp;true;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;dialogo.Title&nbsp;=&nbsp;&quot;&lt;b&gt;Informe&nbsp;de&nbsp;envío&lt;/b&gt;&quot;;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;dialogo.WindowPosition&nbsp;=&nbsp;WindowPosition.Center;<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;dialogo.Run();<br>
&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;dialogo.Hide();&lt;/p&gt;}&lt;/div&gt;<br>

</tt>
