using System;
using Gtk;

public class SampleTreeView : TreeView {
	
	public SampleTreeView() {
		
		TreeViewColumn treeViewColumn = new TreeViewColumn();
		treeViewColumn.Title = "Column 1";
		
		CellRendererText cellRendererText = new CellRendererText();
		treeViewColumn.PackStart(cellRendererText, false);
		treeViewColumn.AddAttribute(cellRendererText, "text", 0);
		
		this.AppendColumn(treeViewColumn);
		
		this.Model = new TreeStore(typeof(string));
		
		TreeIter group1TreeIter = ((TreeStore)this.Model).AppendValues("Group 1");
		TreeIter group2TreeIter = ((TreeStore)this.Model).AppendValues("Group 2");
		
		((TreeStore)this.Model).AppendValues(group1TreeIter, "Item 4");
		((TreeStore)this.Model).AppendValues(group1TreeIter, "Item 3");
		((TreeStore)this.Model).AppendValues(group1TreeIter, "Item 2");
		((TreeStore)this.Model).AppendValues(group2TreeIter, "Item 1");
		((TreeStore)this.Model).AppendValues(group2TreeIter, "Item 5");
		
		this.ExpandAll();
		
		this.Reorderable = true;
		
		// Drag and drop is working when those two lines are commented
		//((TreeStore) this.Model).DefaultSortFunc = SortFunc;
		//((TreeStore) this.Model).SetSortColumnId(-1, SortType.Ascending);
	}

	int SortFunc(TreeModel model, TreeIter iterA, TreeIter iterB){
		return String.Compare(
			(string) model.GetValue(iterA, 0),
			(string) model.GetValue(iterB, 0)
		);
	}
	
}
