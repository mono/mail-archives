<tt>
<br>
&nbsp;<br>
I&nbsp;seem&nbsp;to&nbsp;be&nbsp;getting&nbsp;a&nbsp;weird&nbsp;allocation&nbsp;of&nbsp;uints&nbsp;when&nbsp;using&nbsp;Gtk.Application.Invoke<br>
&nbsp;<br>
If&nbsp;i&nbsp;run&nbsp;the&nbsp;following&nbsp;code&nbsp;through&nbsp;heap-buddy:<br>
&lt;pre&gt;&lt;code&gt;<br>
using&nbsp;System;<br>
using&nbsp;Gtk;<br>
using&nbsp;System.Threading;<br>
&nbsp;<br>
public&nbsp;class&nbsp;MainWindow&nbsp;:&nbsp;Gtk.Window<br>
{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspGtk.Label&nbsp;Label1;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppublic&nbsp;MainWindow()&nbsp;:&nbsp;base&nbsp;(&quot;Test&quot;)<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspthis.DeleteEvent&nbsp;+=&nbsp;new&nbsp;DeleteEventHandler(OnDeleteEvent);<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspLabel1&nbsp;=&nbsp;new&nbsp;Gtk.Label(&quot;&quot;);<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspthis.Add(Label1);<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspthis.ShowAll();<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspThread&nbsp;x&nbsp;=&nbsp;new&nbsp;Thread(new&nbsp;ThreadStart(test));<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspx.IsBackground&nbsp;=&nbsp;true;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspx.Start();<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp}<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspint&nbsp;ctr&nbsp;=&nbsp;0;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspvoid&nbsp;test()<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspwhile(true)<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspGtk.Application.Invoke(&nbsp;delegate&nbsp;{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspctr++;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspLabel1.Text&nbsp;=&nbsp;ctr.ToString();<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp});<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspThread.Sleep(10);<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp}<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp}<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspprotected&nbsp;void&nbsp;OnDeleteEvent(&nbsp;object&nbsp;sender,&nbsp;DeleteEventArgs&nbsp;e)<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspApplication.Quit();<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspe.RetVal&nbsp;=&nbsp;true;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp}<br>
}<br>
&lt;/code&gt;&lt;/pre&gt;<br>
&nbsp;<br>
I'll&nbsp;get&nbsp;a&nbsp;lot&nbsp;of&nbsp;uints&nbsp;allocated&nbsp;on&nbsp;the&nbsp;heap.&nbsp;Most&nbsp;seem&nbsp;to&nbsp;be&nbsp;cleaned&nbsp;up&nbsp;by&nbsp;the&nbsp;garbage&nbsp;collection,&nbsp;but&nbsp;still&nbsp;it&nbsp;doesnt&nbsp;seem&nbsp;quite&nbsp;right.&nbsp;Here&nbsp;is&nbsp;the&nbsp;output&nbsp;from&nbsp;heap-buddy,&nbsp;after&nbsp;running&nbsp;for&nbsp;about&nbsp;5&nbsp;seconds:<br>
<br>
&lt;pre&gt;&lt;code&gt;$&nbsp;heap-buddy&nbsp;types&nbsp;10&nbsp;sorted&nbsp;by&nbsp;count<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;Total&nbsp;AvSz&nbsp;AvAge&nbsp;&nbsp;BT#<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint&nbsp;557439&nbsp;&nbsp;6.4M&nbsp;12.0&nbsp;&nbsp;&nbsp;0.0&nbsp;18337<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;18558&nbsp;&nbsp;863k&nbsp;47.6&nbsp;&nbsp;&nbsp;0.6&nbsp;18418<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;&nbsp;18400&nbsp;&nbsp;357k&nbsp;19.9&nbsp;&nbsp;&nbsp;0.0&nbsp;18400<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLib.TimeoutHandler&nbsp;&nbsp;18392&nbsp;&nbsp;718k&nbsp;40.0&nbsp;&nbsp;&nbsp;0.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4<br>
&nbsp;&nbsp;&nbsp;GLib.Timeout/TimeoutProxy&nbsp;&nbsp;&nbsp;9196&nbsp;&nbsp;143k&nbsp;16.0&nbsp;&nbsp;&nbsp;0.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.EventHandler&nbsp;&nbsp;&nbsp;9196&nbsp;&nbsp;359k&nbsp;40.0&nbsp;&nbsp;&nbsp;0.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;Gtk.Application/InvokeCB&nbsp;&nbsp;&nbsp;9195&nbsp;&nbsp;179k&nbsp;20.0&nbsp;&nbsp;&nbsp;0.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object[]&nbsp;&nbsp;&nbsp;9186&nbsp;&nbsp;717k&nbsp;80.0&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;9186<br>
System.Collections.ArrayList&nbsp;&nbsp;&nbsp;9182&nbsp;&nbsp;179k&nbsp;20.0&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;9182<br>
&nbsp;&nbsp;&nbsp;System.Text.StringBuilder&nbsp;&nbsp;&nbsp;9179&nbsp;&nbsp;215k&nbsp;24.0&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;9179<br>
&lt;/code&gt;&lt;/pre&gt;<br>
<br>
Is&nbsp;this&nbsp;a&nbsp;bug,&nbsp;or&nbsp;am&nbsp;I&nbsp;just&nbsp;doing&nbsp;something&nbsp;very&nbsp;wrong.&nbsp;That&nbsp;just&nbsp;seems&nbsp;like&nbsp;a&nbsp;LOT&nbsp;of&nbsp;uints.<br>
<br>
This&nbsp;is&nbsp;basically&nbsp;a&nbsp;stub&nbsp;from&nbsp;another&nbsp;Gtk#&nbsp;program&nbsp;I'm&nbsp;working&nbsp;on&nbsp;that&nbsp;is&nbsp;fairly&nbsp;thread&nbsp;intestive.&nbsp;I&nbsp;don't&nbsp;remember&nbsp;seeing&nbsp;this&nbsp;kind&nbsp;of&nbsp;behavior&nbsp;before&nbsp;1.2.&nbsp;I&nbsp;am&nbsp;running&nbsp;mono&nbsp;1.2.2,&nbsp;on&nbsp;Fedora&nbsp;Core&nbsp;5.<br>
<br>
Any&nbsp;help&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appriciated.&nbsp;Thanks<br>
&lt;br&gt;&lt;hr&nbsp;align=&quot;left&quot;&nbsp;width=&quot;300&quot;&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://www.nabble.com/Gtk.Application.Invoke-%2B-anonymous-delegates--%3D%3D-lots-of-uints--tf2781599.html#a7760598&quot;&gt;Gtk.Application.Invoke&nbsp;+&nbsp;anonymous&nbsp;delegates&nbsp;&nbsp;==&nbsp;lots&nbsp;of&nbsp;uints?&lt;/a&gt;&lt;br&gt;<br>
Sent&nbsp;from&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://www.nabble.com/Mono---Gtk--f1373.html&quot;&gt;Mono&nbsp;-&nbsp;Gtk#&lt;/a&gt;&nbsp;mailing&nbsp;list&nbsp;archive&nbsp;at&nbsp;Nabble.com.&lt;br&gt;<br>

</tt>
