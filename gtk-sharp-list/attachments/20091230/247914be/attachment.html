<tt>
It&nbsp;is&nbsp;marked&nbsp;as&nbsp;obsolete&nbsp;(at&nbsp;least&nbsp;it&nbsp;is&nbsp;in&nbsp;whatever&nbsp;version&nbsp;I&amp;#39;m&nbsp;using&nbsp;on&nbsp;Linux),&nbsp;but&nbsp;from&nbsp;the&nbsp;code&nbsp;you&nbsp;linked&nbsp;to&nbsp;it&nbsp;simply&nbsp;calls&nbsp;the&nbsp;valid&nbsp;constructor&nbsp;anyway,&nbsp;so&nbsp;it&nbsp;should&nbsp;do&nbsp;the&nbsp;exact&nbsp;same&nbsp;thing.&lt;br&gt;&lt;br&gt;Plus,&nbsp;it&nbsp;does&nbsp;work&nbsp;initially.&nbsp;It&nbsp;takes&nbsp;a&nbsp;couple&nbsp;seconds&nbsp;to&nbsp;fail,&nbsp;but&nbsp;before&nbsp;that,&nbsp;it&nbsp;renders&nbsp;exactly&nbsp;the&nbsp;way&nbsp;it&nbsp;should.&lt;br&gt;<br>
&lt;br&gt;I&amp;#39;ve&nbsp;become&nbsp;convinced&nbsp;that&nbsp;I&amp;#39;m&nbsp;running&nbsp;different&nbsp;versions&nbsp;of&nbsp;Mono.Cairo.&nbsp;I&nbsp;know&nbsp;the&nbsp;one&nbsp;on&nbsp;Windows&nbsp;says&nbsp;it&amp;#39;s&nbsp;2.0.0.0&nbsp;and&nbsp;it&nbsp;comes&nbsp;from&nbsp;the&nbsp;latest&nbsp;version&nbsp;of&nbsp;the&nbsp;Gtk#&nbsp;installer.&nbsp;I&amp;#39;ll&nbsp;have&nbsp;to&nbsp;verify&nbsp;what&nbsp;version&nbsp;I&amp;#39;m&nbsp;using&nbsp;at&nbsp;home&nbsp;on&nbsp;Linux,&nbsp;but&nbsp;I&amp;#39;m&nbsp;almost&nbsp;positive&nbsp;it&amp;#39;s&nbsp;2.0.0.0&nbsp;as&nbsp;well.&lt;br&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Dec&nbsp;29,&nbsp;2009&nbsp;at&nbsp;9:45&nbsp;PM,&nbsp;Michael&nbsp;Hutchinson&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:m.j.hutchinson@gmail.com&quot;&gt;m.j.hutchinson@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;Tue,&nbsp;Dec&nbsp;29,&nbsp;2009&nbsp;at&nbsp;9:20&nbsp;AM,&nbsp;Andy&nbsp;Selvig&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ajselvig@gmail.com&quot;&gt;ajselvig@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hi-&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;First&nbsp;of&nbsp;all,&nbsp;this&nbsp;is&nbsp;a&nbsp;Mono.Cairo&nbsp;question&nbsp;and&nbsp;I&amp;#39;ve&nbsp;noticed&nbsp;there&amp;#39;s&nbsp;a&nbsp;lot&lt;br&gt;<br>
&amp;gt;&nbsp;of&nbsp;experience&nbsp;with&nbsp;it&nbsp;on&nbsp;this&nbsp;list,&nbsp;but&nbsp;if&nbsp;there&amp;#39;s&nbsp;a&nbsp;better&nbsp;place&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;discuss,&nbsp;please&nbsp;let&nbsp;me&nbsp;know.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;ve&nbsp;working&nbsp;on&nbsp;a&nbsp;project&nbsp;using&nbsp;Mono.Cairo.&nbsp;Most&nbsp;of&nbsp;my&nbsp;recent&nbsp;development&lt;br&gt;<br>
&amp;gt;&nbsp;has&nbsp;been&nbsp;on&nbsp;Linux&nbsp;and&nbsp;everything&nbsp;is&nbsp;working&nbsp;well.&nbsp;However,&nbsp;I&nbsp;recently&nbsp;tried&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;run&nbsp;the&nbsp;project&nbsp;on&nbsp;Windows&nbsp;and&nbsp;I&nbsp;keep&nbsp;getting&nbsp;access&nbsp;violations&nbsp;from&lt;br&gt;<br>
&amp;gt;&nbsp;Cairo&nbsp;calls:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;quot;Attempted&nbsp;to&nbsp;read&nbsp;or&nbsp;write&nbsp;protected&nbsp;memory.&nbsp;This&nbsp;is&nbsp;often&nbsp;an&nbsp;indication&lt;br&gt;<br>
&amp;gt;&nbsp;that&nbsp;other&nbsp;memory&nbsp;is&nbsp;corrupt.&amp;quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;part&nbsp;of&nbsp;the&nbsp;code&nbsp;this&nbsp;seems&nbsp;to&nbsp;be&nbsp;happening&nbsp;in&nbsp;is&nbsp;when&nbsp;I&nbsp;create&nbsp;a&nbsp;Cairo&lt;br&gt;<br>
&amp;gt;&nbsp;image&nbsp;surface&nbsp;and&nbsp;render&nbsp;to&nbsp;it.&nbsp;It&nbsp;looks&nbsp;something&nbsp;like&nbsp;this:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;           &nbsp;//&nbsp;remake&nbsp;the&nbsp;image&nbsp;surface,&nbsp;if&nbsp;needed&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;if&nbsp;(surface&nbsp;==&nbsp;null&nbsp;||&nbsp;surface.Width&nbsp;!=&nbsp;IntWidth&nbsp;||&lt;br&gt;<br>
&amp;gt;&nbsp;surface.Height&nbsp;!=&nbsp;IntHeight)&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;imageData&nbsp;=&nbsp;new&nbsp;byte[IntWidth&nbsp;*&nbsp;IntHeight&nbsp;*&nbsp;4];&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;surface&nbsp;=&nbsp;new&nbsp;ImageSurface(&nbsp;ref&nbsp;imageData,&nbsp;Format.ARGB32,&lt;br&gt;<br>
&amp;gt;&nbsp;IntWidth,&nbsp;IntHeight,&nbsp;4&nbsp;*&nbsp;IntWidth);&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;}&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;//&nbsp;render&nbsp;the&nbsp;control&nbsp;to&nbsp;the&nbsp;surface&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;using&nbsp;(Context&nbsp;cr&nbsp;=&nbsp;new&nbsp;Context(surface))&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Operator&nbsp;=&nbsp;Operator.Source;&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Color&nbsp;=&nbsp;new&nbsp;Cairo.Color(1,&nbsp;1,&nbsp;1,&nbsp;0);&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Paint();&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Operator&nbsp;=&nbsp;Operator.Over;&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.MoveTo(0,0);&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;RenderCairo(new&nbsp;RenderContext(cr,&lt;br&gt;<br>
&amp;gt;&nbsp;DecoratorService.Get(viewport)));&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;   &nbsp;surface.Flush();&lt;br&gt;<br>
&amp;gt;&nbsp;   &nbsp;   &nbsp;   &nbsp;};&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;This&nbsp;happens&nbsp;every&nbsp;render&nbsp;cycle&nbsp;and&nbsp;then&nbsp;the&nbsp;image&nbsp;data&nbsp;from&nbsp;the&nbsp;surface&lt;br&gt;<br>
&amp;gt;&nbsp;gets&nbsp;copied&nbsp;to&nbsp;an&nbsp;OpenGL&nbsp;texture&nbsp;and&nbsp;rendered&nbsp;to&nbsp;the&nbsp;screen.&nbsp;So,&nbsp;there&amp;#39;s&nbsp;no&lt;br&gt;<br>
&amp;gt;&nbsp;direct&nbsp;Gtk#&nbsp;involved,&nbsp;but&nbsp;I&nbsp;run&nbsp;it&nbsp;inside&nbsp;a&nbsp;Gtk#&nbsp;app&nbsp;on&nbsp;Linux&nbsp;and&nbsp;a&nbsp;WPF&nbsp;app&lt;br&gt;<br>
&amp;gt;&nbsp;on&nbsp;Windows&nbsp;(both&nbsp;using&nbsp;the&nbsp;Tao&nbsp;OpenGL&nbsp;bindings).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;access&nbsp;violations&nbsp;seem&nbsp;to&nbsp;happen&nbsp;randomly,&nbsp;but&nbsp;generally&nbsp;within&nbsp;a&nbsp;couple&lt;br&gt;<br>
&amp;gt;&nbsp;seconds&nbsp;of&nbsp;interacting&nbsp;with&nbsp;the&nbsp;app.&nbsp;It&nbsp;happens&nbsp;on&nbsp;either&nbsp;the&nbsp;cr.Paint()&lt;br&gt;<br>
&amp;gt;&nbsp;call&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;cr.Operator&nbsp;calls.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;One&nbsp;thing&nbsp;that&nbsp;I&nbsp;had&nbsp;to&nbsp;change&nbsp;to&nbsp;get&nbsp;it&nbsp;to&nbsp;compile&nbsp;on&nbsp;Windows&nbsp;is&nbsp;adding&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;ref&nbsp;to&nbsp;the&nbsp;image&nbsp;data&nbsp;argument&nbsp;in&nbsp;the&nbsp;ImageSurface&nbsp;constructor.&nbsp;It&nbsp;compiles&lt;br&gt;<br>
&amp;gt;&nbsp;and&nbsp;runs&nbsp;fine&nbsp;without&nbsp;it&nbsp;on&nbsp;Linux,&nbsp;but&nbsp;not&nbsp;on&nbsp;Windows.&nbsp;I&amp;#39;m&nbsp;not&nbsp;even&nbsp;sure&nbsp;how&lt;br&gt;<br>
&amp;gt;&nbsp;this&nbsp;could&nbsp;be&nbsp;as&nbsp;I&amp;#39;m&nbsp;using&nbsp;the&nbsp;same&nbsp;version&nbsp;of&nbsp;Mono.Cairo&nbsp;(2.0.0).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Anyway,&nbsp;I&amp;#39;m&nbsp;at&nbsp;a&nbsp;bit&nbsp;of&nbsp;a&nbsp;loss&nbsp;as&nbsp;to&nbsp;how&nbsp;to&nbsp;debug&nbsp;this&nbsp;issue.&nbsp;Obviously&nbsp;some&lt;br&gt;<br>
&amp;gt;&nbsp;memory&nbsp;(the&nbsp;image&nbsp;data&nbsp;buffer?)&nbsp;is&nbsp;being&nbsp;moved&nbsp;or&nbsp;freed&nbsp;unintentionally&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;then&nbsp;accessed&nbsp;later,&nbsp;but&nbsp;I&nbsp;just&nbsp;don&amp;#39;t&nbsp;see&nbsp;why&nbsp;that&nbsp;would&nbsp;be,&nbsp;especially&lt;br&gt;<br>
&amp;gt;&nbsp;since&nbsp;it&nbsp;works&nbsp;wonderfully&nbsp;on&nbsp;Linux.&nbsp;Any&nbsp;help&nbsp;would&nbsp;be&nbsp;appreciated.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;The&nbsp;&amp;quot;ref&amp;quot;&nbsp;version&nbsp;of&nbsp;the&nbsp;ctor&nbsp;is&nbsp;obsolete:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/Mono.Cairo/Mono.Cairo/ImageSurface.cs&quot;&nbsp;target=&quot;_blank&quot;&gt;http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/Mono.Cairo/Mono.Cairo/ImageSurface.cs&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Because&nbsp;the&nbsp;obsoleted&nbsp;version&nbsp;does&nbsp;nothing,&nbsp;that&nbsp;means&nbsp;that&nbsp;the&lt;br&gt;<br>
ImageSurface&amp;#39;s&nbsp;&amp;quot;surface&amp;quot;&nbsp;pointer&nbsp;is&nbsp;zero,&nbsp;so&nbsp;code&nbsp;that&nbsp;dereferences&nbsp;it&lt;br&gt;<br>
will&nbsp;explode.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
Michael&nbsp;Hutchinson&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://mjhutchinson.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://mjhutchinson.com&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
