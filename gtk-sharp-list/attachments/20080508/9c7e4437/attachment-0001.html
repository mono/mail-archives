<tt>
Hi&nbsp;everyone,&nbsp;I&amp;#39;m&nbsp;having&nbsp;an&nbsp;issue&nbsp;parsing&nbsp;.desktop&nbsp;files,&nbsp;I&amp;#39;m&nbsp;not&nbsp;exactly&nbsp;sure&nbsp;how&nbsp;to&nbsp;open&nbsp;the&nbsp;file&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;write&nbsp;back&nbsp;to&nbsp;it.&nbsp;At&nbsp;the&nbsp;moment&nbsp;I&nbsp;can&nbsp;read&nbsp;the&nbsp;file&nbsp;fine,&nbsp;getting&nbsp;any&nbsp;data&nbsp;I&nbsp;want&nbsp;out&nbsp;of&nbsp;it,&nbsp;but&nbsp;I&nbsp;can&amp;#39;t&nbsp;make&nbsp;changes.&nbsp;When&nbsp;I&nbsp;try&nbsp;to&nbsp;save,&nbsp;I&nbsp;get&nbsp;an&nbsp;exception.&nbsp;I&amp;#39;ve&nbsp;included&nbsp;the&nbsp;relevant&nbsp;code&nbsp;snippets,&nbsp;and&nbsp;the&nbsp;exception&nbsp;it&nbsp;throws.&nbsp;Thanks&nbsp;for&nbsp;any&nbsp;help&nbsp;guys.&lt;br&gt;<br>
&lt;br&gt;[CODE]&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;...&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ditem&nbsp;=&nbsp;OpenDesktopFile&nbsp;(desktop_file);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(auto_start_chk.Active)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.Error.WriteLine&nbsp;(&amp;quot;ENABLED&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ditem.SetBoolean&nbsp;(&amp;quot;X-GNOME-Autostart-enabled&amp;quot;,true);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ditem.Save(desktop_file,true);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.Error.WriteLine&nbsp;(&amp;quot;DISABLED&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ditem.SetBoolean&nbsp;(&amp;quot;X-GNOME-Autostart-enabled&amp;quot;,false);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ditem.Save(desktop_file,true);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;...&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;DesktopItem&nbsp;OpenDesktopFile&nbsp;(string&nbsp;desktopFile)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;DesktopItem&nbsp;item;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;IntPtr&nbsp;desktopFileP;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;desktopFileP&nbsp;=&nbsp;gnome_desktop_item_new_from_file&nbsp;(&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;desktopFile,&nbsp;0,&nbsp;IntPtr.Zero);&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(desktopFileP&nbsp;==&nbsp;IntPtr.Zero)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throw&nbsp;new&nbsp;FileNotFoundException&nbsp;(desktopFile);&lt;br&gt;<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;item&nbsp;=&nbsp;new&nbsp;DesktopItem&nbsp;(desktopFileP);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;We&nbsp;may&nbsp;need&nbsp;to&nbsp;call&nbsp;this&nbsp;depending&nbsp;on&nbsp;how&nbsp;DesktopItem&nbsp;works.&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;gnome_desktop_item_unref&nbsp;(desktopFileP);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;item;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[DllImport&nbsp;(&amp;quot;libgnome-desktop-2.so.2&amp;quot;)]&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;extern&nbsp;IntPtr&nbsp;gnome_desktop_item_new_from_file&nbsp;(string&nbsp;file,&nbsp;int&nbsp;flags,&nbsp;IntPtr&nbsp;error);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[DllImport&nbsp;(&amp;quot;libgnome-desktop-2.so.2&amp;quot;)]&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;extern&nbsp;void&nbsp;gnome_desktop_item_unref&nbsp;(IntPtr&nbsp;item);&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;[/CODE]&lt;br&gt;&lt;br&gt;[EXCEPTION]&lt;br&gt;&lt;br&gt;Exception&nbsp;in&nbsp;Gtk#&nbsp;callback&nbsp;delegate&lt;br&gt;&amp;nbsp;&nbsp;Note:&nbsp;Applications&nbsp;can&nbsp;use&nbsp;GLib.ExceptionManager.UnhandledException&nbsp;to&nbsp;handle&nbsp;the&nbsp;exception.&lt;br&gt;<br>
GLib.GException:&nbsp;Operation&nbsp;not&nbsp;supported&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Gnome.DesktopItem.Save&nbsp;(System.String&nbsp;under,&nbsp;Boolean&nbsp;force)&nbsp;[0x00000]&nbsp;&lt;br&gt;&amp;nbsp;&nbsp;at&nbsp;Do.UI.SettingsWindow.OnAutoStartChkClicked&nbsp;(System.Object&nbsp;sender,&nbsp;System.EventArgs&nbsp;e)&nbsp;[0x001d4]&nbsp;in&nbsp;/home/alex/Do/Do/src/Do.UI/SettingsWindow.cs:188&nbsp;&lt;br&gt;<br>
&amp;nbsp;&nbsp;at&nbsp;GLib.Signal.voidObjectCallback&nbsp;(IntPtr&nbsp;handle,&nbsp;IntPtr&nbsp;data)&nbsp;[0x00000]&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;GLib.ExceptionManager.RaiseUnhandledException(System.Exception&nbsp;e,&nbsp;Boolean&nbsp;is_terminal)&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;GLib.Signal.voidObjectCallback(IntPtr&nbsp;handle,&nbsp;IntPtr&nbsp;data)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;GLib.Signal.voidObjectCallback(IntPtr&nbsp;,&nbsp;IntPtr&nbsp;)&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;Gtk.Application.gtk_main()&lt;a&nbsp;href=&quot;/&quot;&gt;&lt;/a&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;Gtk.Application.gtk_main()&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;Gtk.Application.Run()&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;Do.Do.Main(System.String[]&nbsp;args)&nbsp;in&nbsp;/home/alex/Do/Do/src/Do.cs:line&nbsp;78&lt;br&gt;<br>
&lt;br&gt;[/EXCEPTION]&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;tried&nbsp;not&nbsp;dereferencing&nbsp;the&nbsp;pointer,&nbsp;the&nbsp;same&nbsp;exception&nbsp;is&nbsp;thrown.&nbsp;I&amp;#39;ve&nbsp;also&nbsp;tried&nbsp;opening&nbsp;the&nbsp;Desktop&nbsp;item&nbsp;like&lt;br&gt;item&nbsp;=&nbsp;new&nbsp;DesktopItem&nbsp;(desktopFile,DesktopItemLoadFlags.OnlyIfExists);&lt;br&gt;<br>
It&nbsp;throws&nbsp;the&nbsp;exception&nbsp;here:&nbsp;&lt;a&nbsp;href=&quot;http://www.paste2.org/p/26450&quot;&gt;http://www.paste2.org/p/26450&lt;/a&gt;.&nbsp;&lt;br&gt;Thanks&nbsp;for&nbsp;any&nbsp;help&nbsp;people,&nbsp;I&nbsp;really&nbsp;appreciate&nbsp;it.&lt;br&gt;--&nbsp;&lt;br&gt;--Alex&nbsp;Launi<br>

</tt>
