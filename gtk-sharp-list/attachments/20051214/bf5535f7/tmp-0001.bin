Index: generator/FieldBase.cs
===================================================================
--- generator/FieldBase.cs	(revisi贸n: 54370)
+++ generator/FieldBase.cs	(copia de trabajo)
@@ -195,7 +195,7 @@
 					sw.WriteLine (indent + "\t\t\t*raw_ptr = value;");
 				} else {
 					sw.WriteLine (indent + "\t\t\t" + table.GetMarshalReturnType (CType) + "* raw_ptr = (" + table.GetMarshalReturnType (CType) + "*)(((byte*)" + container_type.CallByName () + ") + " + offsetName + ");");
-					sw.WriteLine (indent + "\t\t\t*raw_ptr = " + table.CallByName (ctype, "value") + ";");
+					sw.WriteLine (indent + "\t\t\t*raw_ptr = " + table.ToNativeReturn (ctype, "value") + ";");
 				}
 				sw.WriteLine (indent + "\t\t}");
 				sw.WriteLine (indent + "\t}");
Index: generator/StructField.cs
===================================================================
--- generator/StructField.cs	(revisi贸n: 54370)
+++ generator/StructField.cs	(copia de trabajo)
@@ -133,7 +133,7 @@
 				sw.WriteLine (indent + "private {0} {1};", CSType, Name);
 				sw.WriteLine ();
 				if (Access != "private") {
-					sw.WriteLine (indent + Access + " " + wrapped + " " + wrapped_name + " {");
+					sw.WriteLine (indent + Access + " " + wrapped + " " + StudlyName + " {");
 					sw.WriteLine (indent + "\tget { return " + table.FromNativeReturn (CType, Name) + "; }");
 					sw.WriteLine (indent + "}");
 				}
Index: generator/ManualGen.cs
===================================================================
--- generator/ManualGen.cs	(revisi贸n: 54370)
+++ generator/ManualGen.cs	(copia de trabajo)
@@ -46,7 +46,7 @@
 
 		public override string CallByName (string var_name)
 		{
-			return var_name + " == null ? IntPtr.Zero : " + var_name + ".Handle";
+			return "(" + var_name + " == null ? IntPtr.Zero : " + var_name + ".Handle)";
 		}
 		
 		public override string FromNative(string var)
Index: ChangeLog
===================================================================
--- ChangeLog	(revisi贸n: 54370)
+++ ChangeLog	(copia de trabajo)
@@ -1,3 +1,11 @@
+2005-12-14 Lluis Sanchez Gual <lluis@novell.com>
+
+	* generator/FieldBase.cs: Properly convert marshalled value 
+	to native value.
+	* generator/StructField.cs: Don't use the C name as field name.
+	* generator/ManualGen.cs: Add brackets to the result of CallByName,
+	since it can cause problems in some contexts.
+
 2005-12-13  Mike Kestner  <mkestner@novell.com>
 
 	* sources/Makefile.am : move to stable gtk 2.8 versions.
