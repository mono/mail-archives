<tt>
Hi-&lt;br&gt;&lt;br&gt;First&nbsp;of&nbsp;all,&nbsp;this&nbsp;is&nbsp;a&nbsp;Mono.Cairo&nbsp;question&nbsp;and&nbsp;I&amp;#39;ve&nbsp;noticed&nbsp;there&amp;#39;s&nbsp;a&nbsp;lot&nbsp;of&nbsp;experience&nbsp;with&nbsp;it&nbsp;on&nbsp;this&nbsp;list,&nbsp;but&nbsp;if&nbsp;there&amp;#39;s&nbsp;a&nbsp;better&nbsp;place&nbsp;to&nbsp;discuss,&nbsp;please&nbsp;let&nbsp;me&nbsp;know.&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;working&nbsp;on&nbsp;a&nbsp;project&nbsp;using&nbsp;Mono.Cairo.&nbsp;Most&nbsp;of&nbsp;my&nbsp;recent&nbsp;development&nbsp;has&nbsp;been&nbsp;on&nbsp;Linux&nbsp;and&nbsp;everything&nbsp;is&nbsp;working&nbsp;well.&nbsp;However,&nbsp;I&nbsp;recently&nbsp;tried&nbsp;to&nbsp;run&nbsp;the&nbsp;project&nbsp;on&nbsp;Windows&nbsp;and&nbsp;I&nbsp;keep&nbsp;getting&nbsp;access&nbsp;violations&nbsp;from&nbsp;Cairo&nbsp;calls:&lt;br&gt;<br>
&lt;br&gt;&amp;quot;Attempted&nbsp;to&nbsp;read&nbsp;or&nbsp;write&nbsp;protected&nbsp;memory.&nbsp;This&nbsp;is&nbsp;often&nbsp;an&nbsp;indication&nbsp;that&nbsp;other&nbsp;memory&nbsp;is&nbsp;corrupt.&amp;quot;&lt;br&gt;&lt;br&gt;The&nbsp;part&nbsp;of&nbsp;the&nbsp;code&nbsp;this&nbsp;seems&nbsp;to&nbsp;be&nbsp;happening&nbsp;in&nbsp;is&nbsp;when&nbsp;I&nbsp;create&nbsp;a&nbsp;Cairo&nbsp;image&nbsp;surface&nbsp;and&nbsp;render&nbsp;to&nbsp;it.&nbsp;It&nbsp;looks&nbsp;something&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;           &nbsp;//&nbsp;remake&nbsp;the&nbsp;image&nbsp;surface,&nbsp;if&nbsp;needed&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;if&nbsp;(surface&nbsp;==&nbsp;null&nbsp;||&nbsp;surface.Width&nbsp;!=&nbsp;IntWidth&nbsp;||&nbsp;surface.Height&nbsp;!=&nbsp;IntHeight)&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;{&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;imageData&nbsp;=&nbsp;new&nbsp;byte[IntWidth&nbsp;*&nbsp;IntHeight&nbsp;*&nbsp;4];&lt;br&gt;<br>
   &nbsp;   &nbsp;   &nbsp;   &nbsp;surface&nbsp;=&nbsp;new&nbsp;ImageSurface(&nbsp;ref&nbsp;imageData,&nbsp;Format.ARGB32,&nbsp;IntWidth,&nbsp;IntHeight,&nbsp;4&nbsp;*&nbsp;IntWidth);&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;//&nbsp;render&nbsp;the&nbsp;control&nbsp;to&nbsp;the&nbsp;surface&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;using&nbsp;(Context&nbsp;cr&nbsp;=&nbsp;new&nbsp;Context(surface))&lt;br&gt;<br>
   &nbsp;   &nbsp;   &nbsp;{&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Operator&nbsp;=&nbsp;Operator.Source;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Color&nbsp;=&nbsp;new&nbsp;Cairo.Color(1,&nbsp;1,&nbsp;1,&nbsp;0);&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Paint();&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.Operator&nbsp;=&nbsp;Operator.Over;&lt;br&gt;<br>
   &nbsp;   &nbsp;   &nbsp;   &nbsp;cr.MoveTo(0,0);&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;RenderCairo(new&nbsp;RenderContext(cr,&nbsp;DecoratorService.Get(viewport)));&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;surface.Flush();&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;};&lt;br&gt;&lt;br&gt;This&nbsp;happens&nbsp;every&nbsp;render&nbsp;cycle&nbsp;and&nbsp;then&nbsp;the&nbsp;image&nbsp;data&nbsp;from&nbsp;the&nbsp;surface&nbsp;gets&nbsp;copied&nbsp;to&nbsp;an&nbsp;OpenGL&nbsp;texture&nbsp;and&nbsp;rendered&nbsp;to&nbsp;the&nbsp;screen.&nbsp;So,&nbsp;there&amp;#39;s&nbsp;no&nbsp;direct&nbsp;Gtk#&nbsp;involved,&nbsp;but&nbsp;I&nbsp;run&nbsp;it&nbsp;inside&nbsp;a&nbsp;Gtk#&nbsp;app&nbsp;on&nbsp;Linux&nbsp;and&nbsp;a&nbsp;WPF&nbsp;app&nbsp;on&nbsp;Windows&nbsp;(both&nbsp;using&nbsp;the&nbsp;Tao&nbsp;OpenGL&nbsp;bindings).&lt;br&gt;<br>
&lt;br&gt;The&nbsp;access&nbsp;violations&nbsp;seem&nbsp;to&nbsp;happen&nbsp;randomly,&nbsp;but&nbsp;generally&nbsp;within&nbsp;a&nbsp;couple&nbsp;seconds&nbsp;of&nbsp;interacting&nbsp;with&nbsp;the&nbsp;app.&nbsp;It&nbsp;happens&nbsp;on&nbsp;either&nbsp;the&nbsp;cr.Paint()&nbsp;call&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;cr.Operator&nbsp;calls.&nbsp;&lt;br&gt;&lt;br&gt;One&nbsp;thing&nbsp;that&nbsp;I&nbsp;had&nbsp;to&nbsp;change&nbsp;to&nbsp;get&nbsp;it&nbsp;to&nbsp;compile&nbsp;on&nbsp;Windows&nbsp;is&nbsp;adding&nbsp;a&nbsp;ref&nbsp;to&nbsp;the&nbsp;image&nbsp;data&nbsp;argument&nbsp;in&nbsp;the&nbsp;ImageSurface&nbsp;constructor.&nbsp;It&nbsp;compiles&nbsp;and&nbsp;runs&nbsp;fine&nbsp;without&nbsp;it&nbsp;on&nbsp;Linux,&nbsp;but&nbsp;not&nbsp;on&nbsp;Windows.&nbsp;I&amp;#39;m&nbsp;not&nbsp;even&nbsp;sure&nbsp;how&nbsp;this&nbsp;could&nbsp;be&nbsp;as&nbsp;I&amp;#39;m&nbsp;using&nbsp;the&nbsp;same&nbsp;version&nbsp;of&nbsp;Mono.Cairo&nbsp;(2.0.0).&lt;br&gt;<br>
&lt;br&gt;Anyway,&nbsp;I&amp;#39;m&nbsp;at&nbsp;a&nbsp;bit&nbsp;of&nbsp;a&nbsp;loss&nbsp;as&nbsp;to&nbsp;how&nbsp;to&nbsp;debug&nbsp;this&nbsp;issue.&nbsp;Obviously&nbsp;some&nbsp;memory&nbsp;(the&nbsp;image&nbsp;data&nbsp;buffer?)&nbsp;is&nbsp;being&nbsp;moved&nbsp;or&nbsp;freed&nbsp;unintentionally&nbsp;and&nbsp;then&nbsp;accessed&nbsp;later,&nbsp;but&nbsp;I&nbsp;just&nbsp;don&amp;#39;t&nbsp;see&nbsp;why&nbsp;that&nbsp;would&nbsp;be,&nbsp;especially&nbsp;since&nbsp;it&nbsp;works&nbsp;wonderfully&nbsp;on&nbsp;Linux.&nbsp;Any&nbsp;help&nbsp;would&nbsp;be&nbsp;appreciated.&lt;br&gt;<br>
&lt;br&gt;Thanks.&lt;br&gt;&lt;br&gt;-Andy&lt;br&gt;<br>

</tt>
