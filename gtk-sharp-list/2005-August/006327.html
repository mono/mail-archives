<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] Problems with TreeView
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Problems%20with%20TreeView&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006326.html">
   <LINK REL="Next"  HREF="006339.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] Problems with TreeView</H1>
    <B>Andr&#233; Kuntze</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20Problems%20with%20TreeView&In-Reply-To="
       TITLE="[Gtk-sharp-list] Problems with TreeView">vision.mail at gmx.net
       </A><BR>
    <I>Mon Aug 15 14:35:08 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="006326.html">[Gtk-sharp-list] [OT][Newbie][Maybe crazy]: use embedded gecko# to
	convert HTML to PDF
</A></li>
        <LI>Next message: <A HREF="006339.html">[Gtk-sharp-list] Problems with TreeView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6327">[ date ]</a>
              <a href="thread.html#6327">[ thread ]</a>
              <a href="subject.html#6327">[ subject ]</a>
              <a href="author.html#6327">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everybody,

i am trying to do the following in mono using c# and gtk#: Having a
simple two column list with word and numbers. When you edit one field in
any column, write the new text into the edited field.

This must sound so newbish but i am struggeling with this a few hours
now and so i decided to ask some people in the know. Til now i got this:

** SNIP: CODE STARTS HERE


/*
*	Filename:	TreeViewTryOut.cs
*	Date:		15.08.2005
*
*	Description:	This program is a TryOut for the editable
*			TreeView - widget.
*			The rows in the TreeView are editable and should
*			take the new value, when entered.
*/

using System;
using Gtk;

class MainClass{
	
	// Make the variable store visible to the whole class to use it
	// in the code for the Edited event
	ListStore store;
	
	public static void Main(string [] args){
		Application.Init();

		// Definition of my window, which contains the editable
		// Two - Column - List
		Window window = new Window (&quot;TreeView&quot;);
		window.DeleteEvent += Window_Deleted;

		VBox vertBox = new VBox();
		vertBox.BorderWidth = 6;

		window.Add(vertBox);


		// Definition of my TreeView
		TreeView treeView = new TreeView();
		treeView.HeadersVisible = true;

		vertBox.Add(treeView);


		// Definition of the colums
		TreeViewColumn column = new TreeViewColumn();
		column.Title = &quot;Word&quot;;
		CellRendererText colText = new CellRendererText();

		// Here i add the editable flag and the Edited event
		colText.Editable = true;
		colText.Edited += Word_Edited;
		column.PackStart (colText, true);
		column.AddAttribute (colText, &quot;text&quot;, 0);
		treeView.AppendColumn (column);

		column = new TreeViewColumn();
		column.Title = &quot;Page&quot;;
		colText = new CellRendererText();

		// Here i add the editable flag and the Edited event
		colText.Editable = true;
		colText.Edited += Word_Edited;
		column.PackStart (colText, true);
		column.AddAttribute (colText, &quot;text&quot;, 1);
		treeView.AppendColumn (column);


		// Definition of the field types
		ListStore store = new ListStore (typeof (string), typeof
			(string));
		treeView.Model = store;


		// Putting stuff in the list
		TreeIter iterator = new TreeIter();
		iterator = store.AppendValues(&quot;ChangeMe&quot;, &quot;1&quot;);


		// Show the not working stuff :-/
		window.ShowAll();
		Application.Run();
	}


	// My not working code, when a field is edited
	static void Word_Edited (object o, EditedArgs e){
		// When edited get me the current field
		TreeIter iterator;
		TreePath path = new TreePath(e.Path);

		// Try to write the new entry to the field and start
		// to crash awfully when using static
		store.GetIter(out iterator, path);
		store.SetValue(iterator, 0, e.NewText);
	}


	static void Window_Deleted (object o, DeleteEventArgs e){
		Application.Quit();
	}
}

** SNIP: CODE ENDS HERE



which gives me a crying compiler like this:

** SNIP: STARTS CRYING HERE

<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">andre at gremLin</A>:~/programming/mono/IndexTool$ mcs -pkg:gtk-sharp
TreeViewTryOut.csTreeViewTryOut.cs(27) error CS0103: The name `v' could
not be found in `MainClass'
TreeViewTryOut.cs(67) warning CS0219: The variable 'iterator' is
assigned but its value is never used
TreeViewTryOut.cs(84) error CS0120: An object reference is required for
the non-static field `store'
TreeViewTryOut.cs(85) error CS0120: An object reference is required for
the non-static field `store'
TreeViewTryOut.cs(15) warning CS0169: The private field
'MainClass.store' is never used
Compilation failed: 3 error(s), 2 warnings

** SNIP: STOPS CRYING HERE


I think the problem so far is, that my store variable is used in Main
which is static. But when i make store static and edit some entry the
program crashes hard like:


** SNIP: BAD CRASH STARTS HERE

<A HREF="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">andre at gremLin</A>:~/programming/mono/IndexTool$ mono TreeViewTryOut.exe

Unhandled Exception: System.Reflection.TargetInvocationException:
Exception has been thrown by the target of an invocation. ---&gt;
System.NullReferenceException: Object reference not set to an instance
of an object
in &lt;0x0004d&gt; MainClass:Word_Edited (System.Object o, Gtk.EditedArgs e)
in &lt;0x00000&gt; &lt;unknown method&gt;
in (wrapper managed-to-native)
System.Reflection.MonoMethod:InternalInvoke (object,object[])
in &lt;0x0006f&gt; System.Reflection.MonoMethod:Invoke (System.Object obj,
BindingFlags invokeAttr, System.Reflection.Binder binder,
System.Object[] parameters, System.Globalization.CultureInfo culture)---
End of inner exception stack trace ---

in &lt;0x00104&gt; System.Reflection.MonoMethod:Invoke (System.Object obj,
BindingFlags invokeAttr, System.Reflection.Binder binder,
System.Object[] parameters, System.Globalization.CultureInfo culture)
in &lt;0x00017&gt; System.Reflection.MethodBase:Invoke (System.Object obj,
System.Object[] parameters)
in &lt;0x000b3&gt; System.Delegate:DynamicInvokeImpl (System.Object[] args)
in &lt;0x00028&gt; System.MulticastDelegate:DynamicInvokeImpl (System.Object[]
args)
in &lt;0x0000e&gt; System.Delegate:DynamicInvoke (System.Object[] args)
in &lt;0x00147&gt;
GtkSharp.voidObjectstringstringSignal:voidObjectstringstringCallback
(IntPtr arg0, System.String arg1, System.String arg2, Int32 key)
in (wrapper native-to-managed)
GtkSharp.voidObjectstringstringSignal:voidObjectstringstringCallback
(intptr,intptr,intptr,int)
in &lt;0x00000&gt; &lt;unknown method&gt;
in (wrapper managed-to-native) Gtk.Application:gtk_main ()
in &lt;0x00007&gt; Gtk.Application:Run ()
in &lt;0x00370&gt; MainClass:Main (System.String[] args)

** SNIP: BAD CRASH ENDS HERE


Any ideas? I am justing starting with mono and gtk# and so far i like it
a lot but i have so much to learn before stopping to ask newbie
questions :-/

I hope this big post is somehow easy to read. I edited a bit in
evolution so it was more readable for me. Hope that didn't kill the
formating information.

Please help and Greetings
Andr&#233;

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006326.html">[Gtk-sharp-list] [OT][Newbie][Maybe crazy]: use embedded gecko# to
	convert HTML to PDF
</A></li>
	<LI>Next message: <A HREF="006339.html">[Gtk-sharp-list] Problems with TreeView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6327">[ date ]</a>
              <a href="thread.html#6327">[ thread ]</a>
              <a href="subject.html#6327">[ subject ]</a>
              <a href="author.html#6327">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
