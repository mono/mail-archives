<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] [PATCH] small change in the glib DateTime to
	time_t marshaller
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20%5BPATCH%5D%20small%20change%20in%20the%20glib%20DateTime%20to%0A%09time_t%20marshaller&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006346.html">
   <LINK REL="Next"  HREF="006364.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] [PATCH] small change in the glib DateTime to
	time_t marshaller</H1>
    <B>Chris Rivera</B> 
    <A HREF="mailto:gtk-sharp-list%40lists.ximian.com?Subject=%5BGtk-sharp-list%5D%20%5BPATCH%5D%20small%20change%20in%20the%20glib%20DateTime%20to%0A%09time_t%20marshaller&In-Reply-To="
       TITLE="[Gtk-sharp-list] [PATCH] small change in the glib DateTime to
	time_t marshaller">crivera at novell.com
       </A><BR>
    <I>Wed Aug 17 15:23:26 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="006346.html">[Gtk-sharp-list] NodeStore and lazy loading
</A></li>
        <LI>Next message: <A HREF="006364.html">[Gtk-sharp-list] Transparent Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6359">[ date ]</a>
              <a href="thread.html#6359">[ thread ]</a>
              <a href="subject.html#6359">[ subject ]</a>
              <a href="author.html#6359">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Howdy folks,

The DateTime to time_t marshaller creates a DateTime instance set to
midnight of January 1, 1970 and subtracts that from the DateTime
instance passed into the marshaller to obtain the time_t.  The DateTime
instance passed to DateTimeTotime_t() should be in the caller's local
time zone.  However, the epoch DateTime instance is not.  DateTime (int,
int, int, int, int, int) does not take into account the local time zone.
Thus, the resulting time_t is off by the UTC offset of the caller.

I thought that maybe you were required to convert the DateTime instance
to UTC before passing it to the marshaller until I saw that the epoch
instance in the marshaller was named local_epoch.

This patch ensures that both the DateTime instance passed into the
marshaller and the epoch instance are in UTC before doing the
subtraction.

Please CC me on any responses as I am not subscribed to the list.

Chris
-------------- next part --------------
A non-text attachment was scrubbed...
Name: GLib-fix-DateTime-marshaller.patch
Type: text/x-patch
Size: 987 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20050817/8273c71e/GLib-fix-DateTime-marshaller.bin">http://lists.ximian.com/pipermail/gtk-sharp-list/attachments/20050817/8273c71e/GLib-fix-DateTime-marshaller.bin</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006346.html">[Gtk-sharp-list] NodeStore and lazy loading
</A></li>
	<LI>Next message: <A HREF="006364.html">[Gtk-sharp-list] Transparent Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6359">[ date ]</a>
              <a href="thread.html#6359">[ thread ]</a>
              <a href="subject.html#6359">[ subject ]</a>
              <a href="author.html#6359">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/gtk-sharp-list">More information about the Gtk-sharp-list
mailing list</a><br>
</body></html>
