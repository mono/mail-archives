<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] bug: Removing event handlers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gnome%40fonicmonkey.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000900.html">
   <LINK REL="Next"  HREF="000888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] bug: Removing event handlers
   </H1>
    <B>Lee Mallabone
    </B> 
    <A HREF="mailto:gnome%40fonicmonkey.net"
       TITLE="[Gtk-sharp-list] bug: Removing event handlers">gnome@fonicmonkey.net
       </A><BR>
    <I>05 Feb 2003 09:40:57 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="000900.html">[Gtk-sharp-list] Gnome# Hello World
</A></li>
        <LI> Next message: <A HREF="000888.html">[Gtk-sharp-list] bug: Removing event handlers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#887">[ date ]</a>
              <a href="thread.html#887">[ thread ]</a>
              <a href="subject.html#887">[ subject ]</a>
              <a href="author.html#887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-CDpMCrvalU42j7ffHWfX
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Greetings,

I've found what I think is a bug with removing event handlers in
Gtk#/mono.

When I use:

button.Clicked -= new EventHandler(handler1);

the handler is not actually removed, and still receives events from the
button.

I've attached a small test case that demonstrates this behaviour - after
switching event handlers on a button, both the old and the new handlers
are fired rather than just the new handler.

Could anyone please comment on whether they can reproduce this? I'm
using RedHat 8.0 with mono 0.19 and Gtk# 0.7.

I've opened a bug on bugzilla.ximian.com to track this, (bug #37635),
but thought I'd post here in case there's some magic quick fix I'm just
not seeing. :)

Regards,

-- 
Lee Mallabone &lt;<A HREF="mailto:gnome@fonicmonkey.net">gnome@fonicmonkey.net</A>&gt;

--=-CDpMCrvalU42j7ffHWfX
Content-Disposition: attachment; filename=eventtest.cs
Content-Type: text/plain; name=eventtest.cs; charset=ANSI_X3.4-1968
Content-Transfer-Encoding: 7bit

using System;
using Gtk;

public class eventtest : Window
{
 private Button testButton;
 
 public eventtest(): base (&quot;event test&quot;)
 {
  	// Make a button for the test event handlers
  	testButton = new Button(&quot;Test button&quot;);
	testButton.Clicked += new EventHandler(TestHandler1);
	
	// Make a button to change event handlers on the other button
	Button eventSwitcher = new Button(&quot;Change event handler&quot;);
	eventSwitcher.Clicked += new EventHandler(EventSwitcher);
	
	// Add the buttons to the window
	HBox box = new HBox(true, 5);
	box.PackStart(testButton);
	box.PackStart(eventSwitcher);
	Add(box);
 }

 ////////// Event handlers /////////
 
 private void TestHandler1(object sender, EventArgs args)
 {
  	Console.WriteLine(&quot;event handled with handler 1!&quot;);
 }
 
 private void TestHandler2(object sender, EventArgs args)
 {
  	Console.WriteLine(&quot;event handled with handler 2!&quot;);
 }

 private void EventSwitcher(object sender, EventArgs args)
 {	
	testButton.Clicked -= new EventHandler(TestHandler1);
	testButton.Clicked += new EventHandler(TestHandler2);
 }

 // Initialisation
 
 public static int Main(string[] args)
 {
  	Application.Init();
	
  	new eventtest().ShowAll();
	Application.Run();
	return 0;
 }
}

--=-CDpMCrvalU42j7ffHWfX--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000900.html">[Gtk-sharp-list] Gnome# Hello World
</A></li>
	<LI> Next message: <A HREF="000888.html">[Gtk-sharp-list] bug: Removing event handlers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#887">[ date ]</a>
              <a href="thread.html#887">[ thread ]</a>
              <a href="subject.html#887">[ subject ]</a>
              <a href="author.html#887">[ author ]</a>
         </LI>
       </UL>
</body></html>
