<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Gtk-sharp-list] diff: gnome/Program.custom
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:charles%40reptile.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000942.html">
   <LINK REL="Next"  HREF="000944.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gtk-sharp-list] diff: gnome/Program.custom
   </H1>
    <B>Charles Iliya Krempeaux
    </B> 
    <A HREF="mailto:charles%40reptile.ca"
       TITLE="[Gtk-sharp-list] diff: gnome/Program.custom">charles@reptile.ca
       </A><BR>
    <I>13 Feb 2003 12:06:40 -0800</I>
    <P><UL>
        <LI> Previous message: <A HREF="000942.html">[Gtk-sharp-list] diff: README
</A></li>
        <LI> Next message: <A HREF="000944.html">[Gtk-sharp-list] GtkSpell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#939">[ date ]</a>
              <a href="thread.html#939">[ thread ]</a>
              <a href="subject.html#939">[ subject ]</a>
              <a href="author.html#939">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-hJtoxqd8emw5MlxHGKT+
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hello,

Here's an update for the &quot;gnome/Program.custom&quot; file.  It
makes &quot;Run()&quot; and &quot;Quit()&quot; virtual methods (so that you
can override them).

(You many or may not want to commit it to the Gtk# CVS repository.)

This is useful for doing object oriented development.  By making
those methods virtual, you can override them, and make &quot;drop in&quot;
replacements for Gnome.Program.  (I.e., you get polymorphism.)

I ran it through &quot;diff&quot; and a diff file, for &quot;gnome/Program.custom&quot;
is attached to this message, and named &quot;Program.custom.diff&quot;.  And,
for your convenience, the whole (updated) file is attached to this
message too.  (And, of course, has been named &quot;Program.custom&quot;.)


See ya

-- 
     Charles Iliya Krempeaux, BSc
     <A HREF="mailto:charles@reptile.ca">charles@reptile.ca</A>

________________________________________________________________________
 Reptile Consulting &amp; Services    604-REPTILE    <A HREF="http://www.reptile.ca/">http://www.reptile.ca/</A>

--=-hJtoxqd8emw5MlxHGKT+
Content-Disposition: attachment; filename=Program.custom.diff
Content-Transfer-Encoding: quoted-printable
Content-Type: text/x-diff; name=Program.custom.diff; charset=ISO-8859-1

69c69
&lt; public void Run ()
---
&gt;<i> public virtual void Run ()
</I>74c74
&lt; public void Quit ()
---
&gt;<i> public virtual void Quit ()
</I>
--=-hJtoxqd8emw5MlxHGKT+
Content-Disposition: attachment; filename=Program.custom
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; name=Program.custom; charset=ISO-8859-1

//
// Gnome.Program.custom - Gnome Program class customizations
//
// Author: Rachel Hestilow &lt;<A HREF="mailto:hestilow@ximian.com">hestilow@ximian.com</A>&gt;
//
// Copyright (C) 2002 Rachel Hestilow
//
// This code is inserted after the automatically generated code.
//
       =20
[DllImport(&quot;gobject-2.0&quot;)]
static extern void g_type_init ();

[StructLayout(LayoutKind.Sequential)]
struct PropertyArg {
        public string name;
        public IntPtr value;
}

[DllImport(&quot;gtksharpglue&quot;)]
static extern System.IntPtr
gtksharp_gnome_program_init (string app_id, string app_version, ref ModuleI=
nfo module, int argc, string[] argv, int
nargs, PropertyArg[] args);

public Program (string app_id, string app_version, ModuleInfo module,
                string[] argv, params object[] props)
{
        int nargs =3D props.Length / 2;
        PropertyArg[] args =3D new PropertyArg[nargs];
        GLib.Value[] vals =3D new GLib.Value[nargs];
        string[] new_argv =3D new string[argv.Length + 1];
       =20
        g_type_init ();

        for (int i =3D 0; i &lt; nargs; i++)
        {
                args[i].name =3D (string) props[i * 2];
                GLib.Value value;
                // FIXME: handle more types
                object prop =3D props[i * 2 + 1];
                Type type =3D prop.GetType ();
                if (type =3D=3D &quot;hello&quot;.GetType ())
                        value =3D new GLib.Value ((string) prop);
                else if (type =3D=3D true.GetType ())
                        value =3D new GLib.Value ((bool) prop);
                else
                        value =3D null;
                vals[i] =3D value;
                args[i].value =3D value.Handle;=20
        }
       =20
        /* FIXME: Is there a way to access this in .NET? */=20
        new_argv[0] =3D app_id;
        Array.Copy (argv, 0, new_argv, 1, argv.Length);
        Raw =3D gtksharp_gnome_program_init (app_id, app_version, ref modul=
e, new_argv.Length, new_argv, nargs, args);

        //
        // Dynamically reset the signal handlers, because Gnome overwrites =
them
        //
        Type mono_runtime_type =3D Type.GetType (&quot;Mono.Runtime&quot;);
        if (mono_runtime_type !=3D null){
                object [] iargs =3D new object [0];
                System.Reflection.MethodInfo mi =3D mono_runtime_type.GetMe=
thod (&quot;InstallSignalHandlers&quot;);
       =20
                mi.Invoke (null, iargs);
        }
}

public virtual void Run ()
{
        Gtk.Application.Run ();
}

public virtual void Quit ()
{
        Gtk.Application.Quit ();
}




--=-hJtoxqd8emw5MlxHGKT+--

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000942.html">[Gtk-sharp-list] diff: README
</A></li>
	<LI> Next message: <A HREF="000944.html">[Gtk-sharp-list] GtkSpell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#939">[ date ]</a>
              <a href="thread.html#939">[ thread ]</a>
              <a href="subject.html#939">[ subject ]</a>
              <a href="author.html#939">[ author ]</a>
         </LI>
       </UL>
</body></html>
