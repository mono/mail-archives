<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodroid] Services, help please. :(
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Services%2C%20help%20please.%20%3A%28&In-Reply-To=93ACC206-797E-4671-9C3A-2A85BAE8274F%40alexsoto.me">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001464.html">
   <LINK REL="Next"  HREF="001466.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodroid] Services, help please. :(</H1>
    <B>Greg Shackles</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Services%2C%20help%20please.%20%3A%28&In-Reply-To=93ACC206-797E-4671-9C3A-2A85BAE8274F%40alexsoto.me"
       TITLE="[Monodroid] Services, help please. :(">gshackles at gmail.com
       </A><BR>
    <I>Thu Oct 21 10:01:49 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="001464.html">[Monodroid] Services, help please. :(
</A></li>
        <LI>Next message: <A HREF="001466.html">[Monodroid] Services, help please. :(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1465">[ date ]</a>
              <a href="thread.html#1465">[ thread ]</a>
              <a href="subject.html#1465">[ subject ]</a>
              <a href="author.html#1465">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The difference in this case is that the team already knows it's not
supported, so it doesn't make much sense for us to waste time trying to get
it working, and then in turn waste their time by having to answer
questions/bugs about it.  In cases where they don't know it's not working
until we try it out, I'm always more than happy to explore and open bugs or
raise questions when I run into a problem.  In those cases, if there are
known areas that are mostly unexplored, it would be cool to know where we
should focus our testing on.

- Greg

On Thu, Oct 21, 2010 at 9:37 AM, Alex Soto &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">alex at alexsoto.me</A>&gt; wrote:

&gt;<i> Umm i dont think that having a roadmap with the supported things will do
</I>&gt;<i> any good because we would focus just on those things and we would loose
</I>&gt;<i> great ideas like this one, now the mono team knows about your request and i
</I>&gt;<i> guess it will get supported in a near future
</I>&gt;<i>
</I>&gt;<i> Alex
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> El 20/10/2010, a las 10:42 p.m., Greg Shackles &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">gshackles at gmail.com</A>&gt;
</I>&gt;<i> escribi&#243;:
</I>&gt;<i>
</I>&gt;<i> I don't think services are supported yet (or any components other than
</I>&gt;<i> activities).  See the comments in this bug I opened: &lt;<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=645234">https://bugzilla.novell.com/show_bug.cgi?id=645234</A>&gt;
</I>&gt;<i> <A HREF="https://bugzilla.novell.com/show_bug.cgi?id=645234">https://bugzilla.novell.com/show_bug.cgi?id=645234</A>
</I>&gt;<i>
</I>&gt;<i> &lt;<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=645234">https://bugzilla.novell.com/show_bug.cgi?id=645234</A>&gt;- Greg
</I>&gt;<i>
</I>&gt;<i> On Wed, Oct 20, 2010 at 11:21 PM, bryan costanich &lt; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">b at wowzer.net</A>&gt;
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">b at wowzer.net</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>  Hey all,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I&#8217;m trying to create a service (following/porting the android sample
</I>&gt;&gt;<i> &lt;<A HREF="http://developer.android.com/reference/android/app/Service.html">http://developer.android.com/reference/android/app/Service.html</A>&gt;
</I>&gt;&gt;<i> <A HREF="http://developer.android.com/reference/android/app/Service.html">http://developer.android.com/reference/android/app/Service.html</A>).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I&#8217;ve gotten everything to build and run, but for some reason, my
</I>&gt;&gt;<i> OnServiceConnected method in my ServiceConnection class never runs. Here
</I>&gt;&gt;<i> is my main activity (with ServiceConnection):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> namespace Test_MediaPlayerService
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i>     [Activity(Label = &quot;Service&quot;, MainLauncher = true)]
</I>&gt;&gt;<i>     public class Activity1 : Activity
</I>&gt;&gt;<i>     {
</I>&gt;&gt;<i>         protected ServiceConnection _serviceConnection;
</I>&gt;&gt;<i>         protected bool _isBound;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         public Activity1(IntPtr handle) : base(handle)
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             this._serviceConnection = new ServiceConnection(this);
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         protected override void OnCreate(Bundle bundle)
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             base.OnCreate(bundle);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             // Set our view from the &quot;main&quot; layout resource
</I>&gt;&gt;<i>             SetContentView(Resource.layout.main);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             // Get our button from the layout resource,
</I>&gt;&gt;<i>             // and attach an event to it
</I>&gt;&gt;<i>             Button button = FindViewById&lt;Button&gt;(Resource.id.myButton);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             button.Click += (s,e) =&gt; {
</I>&gt;&gt;<i>                 Toast.MakeText(this, &quot;button click&quot;, ToastLength
</I>&gt;&gt;<i> .Short).Show();
</I>&gt;&gt;<i>                 this.BindService();
</I>&gt;&gt;<i>             };
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         protected void BindService()
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             // Establish a connection with the service.  We use an
</I>&gt;&gt;<i> explicit
</I>&gt;&gt;<i>             // class name because we want a specific service
</I>&gt;&gt;<i> implementation that
</I>&gt;&gt;<i>             // we know will be running in our own process (and thus won't
</I>&gt;&gt;<i> be
</I>&gt;&gt;<i>             // supporting component replacement by other applications).
</I>&gt;&gt;<i>             BindService(new Intent(this, typeof(MediaPlayerService)),
</I>&gt;&gt;<i> this._serviceConnection, Bind.AutoCreate);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             this._isBound = true;
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         protected void UnbindService()
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             this.UnbindService(this._serviceConnection);
</I>&gt;&gt;<i>             this._isBound = false;
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         protected override void OnDestroy()
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             base.OnDestroy();
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             if (this._isBound)
</I>&gt;&gt;<i>             {
</I>&gt;&gt;<i>                 this.UnbindService();
</I>&gt;&gt;<i>             }
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         protected class ServiceConnection : Java.Lang.Object,
</I>&gt;&gt;<i> IServiceConnection
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             public MediaPlayerService MediaPlayerService
</I>&gt;&gt;<i>             {
</I>&gt;&gt;<i>                 get { return this._mediaPlayerService; }
</I>&gt;&gt;<i>             }
</I>&gt;&gt;<i>             protected MediaPlayerService _mediaPlayerService;
</I>&gt;&gt;<i>             protected Activity _context = null;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             public ServiceConnection(Activity context)
</I>&gt;&gt;<i>             { this._context = context; }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             public void OnServiceConnected(ComponentName className,
</I>&gt;&gt;<i> IBinder service)
</I>&gt;&gt;<i>             {
</I>&gt;&gt;<i>                 Toast.MakeText(this._context, &quot;About to Connect to
</I>&gt;&gt;<i> Service&quot;, ToastLength.Short).Show();
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>                 // This is called when the connection with the service
</I>&gt;&gt;<i> has been
</I>&gt;&gt;<i>                 // established, giving us the service object we can use
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i>                 // interact with the service.  Because we have bound to a
</I>&gt;&gt;<i> explicit
</I>&gt;&gt;<i>                 // service that we know is running in our own process, we
</I>&gt;&gt;<i> can
</I>&gt;&gt;<i>                 // cast its IBinder to a concrete class and directly
</I>&gt;&gt;<i> access it.
</I>&gt;&gt;<i>                 this._mediaPlayerService = ((MediaPlayerService.
</I>&gt;&gt;<i> LocalBinder)service).GetService();
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>                 // Tell the user about this for our demo.
</I>&gt;&gt;<i>                 Toast.MakeText(this._context, &quot;Connected to Service&quot;,
</I>&gt;&gt;<i> ToastLength.Short).Show();
</I>&gt;&gt;<i>             }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             public void OnServiceDisconnected(ComponentName className) {
</I>&gt;&gt;<i>                 // This is called when the connection with the service
</I>&gt;&gt;<i> has been
</I>&gt;&gt;<i>                 // unexpectedly disconnected -- that is, its process
</I>&gt;&gt;<i> crashed.
</I>&gt;&gt;<i>                 // Because it is running in our same process, we should
</I>&gt;&gt;<i> never
</I>&gt;&gt;<i>                 // see this happen.
</I>&gt;&gt;<i>                 this._mediaPlayerService = null;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>                 Toast.MakeText(this._context, &quot;Disconnected from Service&quot;,
</I>&gt;&gt;<i> ToastLength.Short).Show();
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             }
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>     }
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> And here&#8217;s my service class:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> namespace Test_MediaPlayerService
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i>     public class MediaPlayerService : Android.App.Service
</I>&gt;&gt;<i>     {
</I>&gt;&gt;<i>         protected NotificationManager _notificationManager;
</I>&gt;&gt;<i>         protected LocalBinder _binder;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         public class LocalBinder : Binder
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             MediaPlayerService _service;
</I>&gt;&gt;<i>             internal LocalBinder(MediaPlayerService service)
</I>&gt;&gt;<i>             {
</I>&gt;&gt;<i>                 this._service = service;
</I>&gt;&gt;<i>             }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             public MediaPlayerService GetService()
</I>&gt;&gt;<i>             {
</I>&gt;&gt;<i>                 return this._service;
</I>&gt;&gt;<i>             }
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         public MediaPlayerService()
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             this._binder = new LocalBinder(this);
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         public override IBinder OnBind(Intent intent)
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             return this._binder;
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         public override void OnDestroy()
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             base.OnDestroy();
</I>&gt;&gt;<i>             //---- cancel our notification
</I>&gt;&gt;<i>             //---- TODO: provide a unique id
</I>&gt;&gt;<i>             this._notificationManager.Cancel(666);
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>         public override void OnCreate()
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             base.OnCreate();
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             this._notificationManager = this.GetSystemService(NotificationService)
</I>&gt;&gt;<i> as NotificationManager;
</I>&gt;&gt;<i>             if (this._notificationManager == null)
</I>&gt;&gt;<i>             { throw new Exception(&quot;couldn't get a reference to the
</I>&gt;&gt;<i> notification service&quot;); }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             //---- show the service starting notification
</I>&gt;&gt;<i>             //this.ShowNotification();
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         public override void OnStart(Intent intent, int startId)
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             base.OnStart(intent, startId);
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         public override StartCommandResult OnStartCommand(Intent intent,
</I>&gt;&gt;<i> StartCommandFlags flags, int startId)
</I>&gt;&gt;<i>         {
</I>&gt;&gt;<i>             //---- this service should continue running until it's told
</I>&gt;&gt;<i> to stop, so we make
</I>&gt;&gt;<i>             // it a sticky service
</I>&gt;&gt;<i>             return StartCommandResult.Sticky;
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> //================================================================================
</I>&gt;&gt;<i>         /// &lt;summary&gt;
</I>&gt;&gt;<i>         /// Displays a notification
</I>&gt;&gt;<i>         /// &lt;/summary&gt;
</I>&gt;&gt;<i>         protected void ShowNotification() {
</I>&gt;&gt;<i>             // Set the icon, scrolling text and timestamp
</I>&gt;&gt;<i>             Notification notification = new Notification(Resource.
</I>&gt;&gt;<i> drawable.icon, &quot;MediaPlayerService&quot;, DateTime.Now.ToJavaMilliseconds());
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             // The PendingIntent to launch our activity if the user
</I>&gt;&gt;<i> selects this notification
</I>&gt;&gt;<i>             PendingIntent contentIntent = PendingIntent.GetActivity(this,
</I>&gt;&gt;<i> 0, new Intent(this, typeof(MediaPlayerService)), 0);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             // Set the info for the views that show in the notification
</I>&gt;&gt;<i> panel.
</I>&gt;&gt;<i>             notification.SetLatestEventInfo(this, &quot;MPService&quot;, &quot;Service
</I>&gt;&gt;<i> Running&quot;, contentIntent);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             // Send the notification.
</I>&gt;&gt;<i>             // We use a layout id because it is a unique number.  We use
</I>&gt;&gt;<i> it later to cancel.
</I>&gt;&gt;<i>             // TODO: switch to a unique identifier
</I>&gt;&gt;<i>             this._notificationManager.Notify(666, notification);
</I>&gt;&gt;<i>             //mNM.notify(R.string.local_service_started, notification);
</I>&gt;&gt;<i>         }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> //================================================================================
</I>&gt;&gt;<i>     }
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Any ideas?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Monodroid mailing list
</I>&gt;&gt;<i>  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>&gt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;&gt;<i>  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>&gt;
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/mailman/private/monodroid/attachments/20101021/558cfff6/attachment-0001.html">http://lists.ximian.com/mailman/private/monodroid/attachments/20101021/558cfff6/attachment-0001.html</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001464.html">[Monodroid] Services, help please. :(
</A></li>
	<LI>Next message: <A HREF="001466.html">[Monodroid] Services, help please. :(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1465">[ date ]</a>
              <a href="thread.html#1465">[ thread ]</a>
              <a href="subject.html#1465">[ subject ]</a>
              <a href="author.html#1465">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
