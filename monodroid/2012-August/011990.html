<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Android 2.2 - EglCreateWindowSurface Exception
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Android%202.2%20-%20EglCreateWindowSurface%20Exception&In-Reply-To=%3C94205ACB-C57A-498F-86B1-0E7B099EFD2E%40xamarin.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011943.html">
   <LINK REL="Next"  HREF="011944.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Android 2.2 - EglCreateWindowSurface Exception</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Android%202.2%20-%20EglCreateWindowSurface%20Exception&In-Reply-To=%3C94205ACB-C57A-498F-86B1-0E7B099EFD2E%40xamarin.com%3E"
       TITLE="[mono-android] Android 2.2 - EglCreateWindowSurface Exception">jonp at xamarin.com
       </A><BR>
    <I>Thu Aug 23 18:01:50 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011943.html">[mono-android] Android 2.2 - EglCreateWindowSurface Exception
</A></li>
        <LI>Next message: <A HREF="011944.html">[mono-android] Using HttpListener with emulator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11990">[ date ]</a>
              <a href="thread.html#11990">[ thread ]</a>
              <a href="subject.html#11990">[ subject ]</a>
              <a href="author.html#11990">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Aug 14, 2012, at 10:05 AM, jvelite &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">jvelite at gmail.com</A>&gt; wrote:
&gt;<i> Any thoughts and/or suggestions would be greatly appreciated!
</I>
	<A HREF="https://bugzilla.xamarin.com/show_bug.cgi?id=6546#c1">https://bugzilla.xamarin.com/show_bug.cgi?id=6546#c1</A>

One of the causes for the problem is that certain Android hardware will lie: they'll state that a given graphics mode is supported (e.g. the default-attempted graphics mode!), then error out when you actually attempt to use it.

The (hopeful) solution? First, run the GLDiagnostics app:

	<A HREF="https://github.com/xamarin/monodroid-samples/blob/master/GLDiagnostics/">https://github.com/xamarin/monodroid-samples/blob/master/GLDiagnostics/</A>

Read the `adb logcat`, which should contain messages such as:

	V/AndroidGraphicsMode(29481): Valid graphics mode: 489685626 red 8 green 8 blue 8 alpha 8 (32) depth 24 stencil 8 samples 0 buffers 2 

Next, you'll need to override CreateFrameBuffer():

	<A HREF="https://github.com/xamarin/monodroid-samples/blob/master/GLTriangle20/PaintingView.cs#L40">https://github.com/xamarin/monodroid-samples/blob/master/GLTriangle20/PaintingView.cs#L40</A>

You'll need to try to use an AndroidGraphicsMode instance based upon the GLDiagnostics output, e.g.:

	protected override void CreateFrameBuffer ()
	{
		try {
			base.CreateFrameBuffer ();
			return;
		} catch (Exception ex) {
			Log.Warn (&quot;AppName&quot;, &quot;Unable to use default OpenTK settings: {0}&quot;, ex);
		}

		// Repeat the following try/catch for each graphics mode you wish to attempt to support
		try {
			// Use a value from GLDiagnostics output
			GraphicsMode = new AndroidGraphicsMode (
					display: 		null,		// default display
					version: 		1,		// 2 for OpenGLES 2.x
					colorFormat:	32, 		// value after the red/green/blue/alpha value, in parens
					depth: 		24,		// value after `depth`
					stencil: 		8,		// value after `stencil`
					samples: 	0,		// value after `samples`
					buffers: 		2,		// value after `buffers`
					stereo: 		false);	// I don't know what this is used for...
			base.CreateFrameBuffer();
			return;
		} catch (Exception ex) {
			Log.Warn (&quot;AppName&quot;, &quot;Unable to use default OpenTK settings: {0}&quot;, ex);
		}
		throw new NotSupportedException (&quot;Unable to initialize OpenGLES&quot;);
	}

 - Jon

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011943.html">[mono-android] Android 2.2 - EglCreateWindowSurface Exception
</A></li>
	<LI>Next message: <A HREF="011944.html">[mono-android] Using HttpListener with emulator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11990">[ date ]</a>
              <a href="thread.html#11990">[ thread ]</a>
              <a href="subject.html#11990">[ subject ]</a>
              <a href="author.html#11990">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
