<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] File inout output operations
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20File%20inout%20output%20operations&In-Reply-To=003501cbfda2%248ff3f410%24afdbdc30%24%40gb.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004385.html">
   <LINK REL="Next"  HREF="004387.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] File inout output operations</H1>
    <B>Yann Schwartz</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20File%20inout%20output%20operations&In-Reply-To=003501cbfda2%248ff3f410%24afdbdc30%24%40gb.com"
       TITLE="[mono-android] File inout output operations">abolibibelot at gmail.com
       </A><BR>
    <I>Mon Apr 18 05:04:51 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004385.html">[mono-android] File inout output operations
</A></li>
        <LI>Next message: <A HREF="004387.html">[mono-android] File inout output operations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4386">[ date ]</a>
              <a href="thread.html#4386">[ thread ]</a>
              <a href="subject.html#4386">[ subject ]</a>
              <a href="author.html#4386">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

It's likely an issue of the file not being entirely written. Try to do an
explicit Flush() on your writer !


using (var writer = new BufferedWriter(new FileWriter(mfile)))

{

            writer.Write(string1);

            writer.Flush();


}


(the using part should do the trick in itself, but I've run into this issue
even with a Dispose(), especially when dealing with these pesky xml
writers.)



On Mon, Apr 18, 2011 at 10:28 AM, John Murray &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">john at murray.gb.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Again effusive thanks Dennis you&#8217;re a massive help
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yep your example  reads ok
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Seem to have narrowed it down to the formation of my xml file
</I>&gt;<i>
</I>&gt;<i> When trying the android way of doing things I&#8217;m getting an &#8216;unexpected end
</I>&gt;<i> of file&#8217; exception
</I>&gt;<i>
</I>&gt;<i> Trying toread it using your code causes a hang and no exception
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It is written quite simply using
</I>&gt;<i>
</I>&gt;<i> BufferedWriter writer = new BufferedWriter(new FileWriter(mfile)); ;
</I>&gt;<i>
</I>&gt;<i>             writer.Write(string1);
</I>&gt;<i>
</I>&gt;<i> etc and I&#8217;ve carefully checked the text for xml authenticity
</I>&gt;<i>
</I>&gt;<i> I close the writer
</I>&gt;<i>
</I>&gt;<i> Should I be adding some eof flag or char?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> John Murray
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A> [mailto:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] *On Behalf Of *Dennis Quebe
</I>&gt;<i> *Sent:* 17 April 2011 15:52
</I>&gt;<i>
</I>&gt;<i> *To:* <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">john at murray.gb.com</A>; 'Discussions related to Mono for Android'
</I>&gt;<i> *Subject:* Re: [mono-android] File inout output operations
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Here is a full example with a real XML file that is in the Emulator
</I>&gt;<i> directory structure.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> try {
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        System.IO.StreamReader streamReader = new System.IO.StreamReader (
</I>&gt;<i> &quot;/etc/apns-conf.xml&quot;);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        System.Xml.XmlDocument document = new System.Xml.XmlDocument ();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        document.Load (streamReader);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        foreach (System.Xml.XmlNode currentNode in document.ChildNodes) {
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>               Android.Util.Log.Info (&quot;Node&quot;, currentNode.InnerText);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> catch (Exception exception) {
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        Android.Util.Log.Info (&quot;Exception&quot;, exception.Message);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* Dennis Quebe [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">dennis.quebe at quebesystems.com</A>]
</I>&gt;<i> *Sent:* Sunday, April 17, 2011 8:28 AM
</I>&gt;<i> *To:* <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">john at murray.gb.com</A>; 'Discussions related to Mono for Android'
</I>&gt;<i> *Subject:* RE: [mono-android] File inout output operations
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> John: This is how I am reading in an XML file. It seems to work for me. I
</I>&gt;<i> use the Util.Log to write the exception out right now because I am having
</I>&gt;<i> problems with Debug.WriteLine. I don&#8217;t know if this will help you.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                                                 try {
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> System.IO.StreamReader streamReader = new System.IO.StreamReader
</I>&gt;<i> (&quot;test.xml&quot;);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> System.Xml.XmlDocument document = new System.Xml.XmlDocument ();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> document.Load (streamReader);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                                                 }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                                                 catch (Exception exception)
</I>&gt;<i> {
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Android.Util.Log.Info (&quot;Exception&quot;, exception.Message);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                                                 }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A> [mailto:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] *On Behalf Of *John Murray
</I>&gt;<i> *Sent:* Wednesday, February 02, 2011 6:46 AM
</I>&gt;<i> *To:* 'Discussions related to Mono for Android'
</I>&gt;<i> *Subject:* [mono-android] File inout output operations
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Further to my last request for help can anyone explain this
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I am getting an exception message &#8216;File not found of the type
</I>&gt;<i> Java.Lang.Illegal argument exception&#8217; (this is a System exception message)
</I>&gt;<i>
</I>&gt;<i> Despite this code which says that the file exists
</I>&gt;<i>
</I>&gt;<i> And despite the code below which seems to successfully write the file
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>      public void readjavastyle()
</I>&gt;<i>
</I>&gt;<i>         {
</I>&gt;<i>
</I>&gt;<i>             string mystr = &quot;&quot;;
</I>&gt;<i>
</I>&gt;<i>             mystr = GetFileStreamPath(&quot;LastGar.xml&quot;).ToString();
</I>&gt;<i>
</I>&gt;<i>             if (System.IO.File.Exists(mystr))
</I>&gt;<i>
</I>&gt;<i>             {Toast.MakeText(this, &quot;filestream path &quot; + mystr, ToastLength.Long).Show();
</I>&gt;<i>     // this line reports file exists
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>             else{ Toast.MakeText(this, &quot;file not found error &quot; ,
</I>&gt;<i> ToastLength.Long).Show();
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>             try
</I>&gt;<i>
</I>&gt;<i>             {
</I>&gt;<i>
</I>&gt;<i>                 FileInputStream mystream = OpenFileInput(mystr);
</I>&gt;<i>
</I>&gt;<i>             }
</I>&gt;<i>
</I>&gt;<i>             catch (Exception ioe)
</I>&gt;<i>
</I>&gt;<i>             {
</I>&gt;<i>
</I>&gt;<i>                 Toast.MakeText(this, &quot;file not found error &quot; +
</I>&gt;<i> ioe.Message.ToString(), ToastLength.Long).Show();
</I>&gt;<i>
</I>&gt;<i> //this error is triggerd saying &#8216;file not found error JAVA.Lang.Illegal
</I>&gt;<i> argument&#8217;
</I>&gt;<i>
</I>&gt;<i>             }
</I>&gt;<i>
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Here is the write code which seems to report file has been written
</I>&gt;<i> successfully
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> public void writeAndroidJavaGarXml()
</I>&gt;<i>
</I>&gt;<i>         {
</I>&gt;<i>
</I>&gt;<i>             string Mystr = &quot;&quot;;
</I>&gt;<i>
</I>&gt;<i>             String string1 = &quot;&lt;?xml version=\&quot;1.0\&quot; standalone=\&quot;yes\&quot;?&gt;&quot;;
</I>&gt;<i>
</I>&gt;<i>                 String string2 = &quot;&lt;dataroot
</I>&gt;<i> generated=\&quot;2011-04-12T16:52:11\&quot;&gt;&quot;;
</I>&gt;<i>
</I>&gt;<i>                 String startjny = &quot;  &lt;JNY&gt;&quot;;
</I>&gt;<i>
</I>&gt;<i>                 String endjny = &quot;  &lt;JNY&gt;&quot;;
</I>&gt;<i>
</I>&gt;<i>                 Mystr = GetFileStreamPath(&quot;LastGar.xml&quot;).ToString();
</I>&gt;<i>
</I>&gt;<i>         try{
</I>&gt;<i>
</I>&gt;<i>             BufferedWriter writer = new BufferedWriter(new FileWriter
</I>&gt;<i> (Mystr));
</I>&gt;<i>
</I>&gt;<i>             writer.Write(string1);
</I>&gt;<i>
</I>&gt;<i>             writer.NewLine();
</I>&gt;<i>
</I>&gt;<i>             writer.Write(string2);
</I>&gt;<i>
</I>&gt;<i>             writer.NewLine();
</I>&gt;<i>
</I>&gt;<i>             writer.Write(startjny);
</I>&gt;<i>
</I>&gt;<i>             writer.NewLine();
</I>&gt;<i>
</I>&gt;<i>             Mystr= &quot;&lt;UI&gt;&quot;+&quot;9898989&quot;+&quot;&lt;/UI&gt;&quot;;
</I>&gt;<i>
</I>&gt;<i>             writer.Write(Mystr);
</I>&gt;<i>
</I>&gt;<i>             writer.Write(endjny);
</I>&gt;<i>
</I>&gt;<i>             writer.NewLine();
</I>&gt;<i>
</I>&gt;<i>             writer.Write(&quot;/dataroot&quot;);
</I>&gt;<i>
</I>&gt;<i>             writer.Flush();
</I>&gt;<i>
</I>&gt;<i>             writer.Close();
</I>&gt;<i>
</I>&gt;<i>             Toast.MakeText(this, &quot;filewritten &quot;, ToastLength.Long).Show();
</I>&gt;<i>
</I>&gt;<i>         } catch (Java.IO.IOException e) {
</I>&gt;<i>
</I>&gt;<i>              e.PrintStackTrace();
</I>&gt;<i>
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         Mystr = GetFileStreamPath(&quot;LastGar.xml&quot;).ToString();
</I>&gt;<i>
</I>&gt;<i>         if (System.IO.File.Exists(Mystr))
</I>&gt;<i>
</I>&gt;<i>         {
</I>&gt;<i>
</I>&gt;<i>             Toast.MakeText(this, &quot;filestream path &quot; + Mystr, ToastLength
</I>&gt;<i> .Long).Show();
</I>&gt;<i>
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         else
</I>&gt;<i>
</I>&gt;<i>         {
</I>&gt;<i>
</I>&gt;<i>             Toast.MakeText(this, &quot;file not found error &quot;, ToastLength
</I>&gt;<i> .Long).Show();
</I>&gt;<i>
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I have checked every read option I can see in the Manifest
</I>&gt;<i>
</I>&gt;<i> Thanks for any help or pointers given
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> John Murray
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i> UNSUBSCRIBE INFORMATION:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/mailman/private/monodroid/attachments/20110418/cc1cfd1d/attachment-0001.html">http://lists.ximian.com/mailman/private/monodroid/attachments/20110418/cc1cfd1d/attachment-0001.html</A> 
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004385.html">[mono-android] File inout output operations
</A></li>
	<LI>Next message: <A HREF="004387.html">[mono-android] File inout output operations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4386">[ date ]</a>
              <a href="thread.html#4386">[ thread ]</a>
              <a href="subject.html#4386">[ subject ]</a>
              <a href="author.html#4386">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
