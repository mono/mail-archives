<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Building a package with a jar bindings library strips the jar file from the assembly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Building%20a%20package%20with%20a%20jar%20bindings%20library%0A%20strips%20the%20jar%20file%20from%20the%20assembly&In-Reply-To=%3C77FF8461-ECD7-44CE-B97D-A6780F34E88E%40vt.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014019.html">
   <LINK REL="Next"  HREF="014033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Building a package with a jar bindings library strips the jar file from the assembly</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Building%20a%20package%20with%20a%20jar%20bindings%20library%0A%20strips%20the%20jar%20file%20from%20the%20assembly&In-Reply-To=%3C77FF8461-ECD7-44CE-B97D-A6780F34E88E%40vt.edu%3E"
       TITLE="[mono-android] Building a package with a jar bindings library strips the jar file from the assembly">jonpryor at vt.edu
       </A><BR>
    <I>Tue Nov 26 14:14:25 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="014019.html">[mono-android] Building a package with a jar bindings library strips the jar file from the assembly
</A></li>
        <LI>Next message: <A HREF="014033.html">[mono-android] Building a package with a jar bindings library strips the jar file from the assembly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14020">[ date ]</a>
              <a href="thread.html#14020">[ thread ]</a>
              <a href="subject.html#14020">[ subject ]</a>
              <a href="author.html#14020">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Nov 26, 2013, at 8:27 AM, Vladimir Dimitrov &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">vlad.dimitrov at gmail.com</A>&gt; wrote:
&gt;<i> I am trying to make a jar bindings project that I need in my app.
</I>&gt;<i> 1. I created a jar binding project.
</I>&gt;<i> 2. Added the .jar file in the Jars folder.
</I>&gt;<i> 3. Made it an EmbeddedJar
</I>&gt;<i> 4. Build the project
</I>&gt;<i> 5. Referenced the project from another project and added some logic using the callable wrappers.
</I>&gt;<i> 
</I>&gt;<i> Now when I build the project I see that an assembly is generated with the .jar file inside it as a resource.
</I>&gt;<i> But when I try to run in debug mode I get a java.lang.NoClassDefFoundError exception.
</I>&gt;<i> I noticed that if I build an .apk, unzip it and decompile the jar bindings assembly, the jar file is no longer in it.
</I>
This is by design, and is unrelated to your error.

Android doesn't run Java bytecode, it runs Dalvik bytecode. Consequently, .jar files on device are entirely useless, and would only serve to bloat your application size for no benefit.

Instead, what should be happening is that the .jar resource is extracted, and the .jar is then passed to dx.jar (the Dex compiler) along with all the other Java bytecode that makes up the app (compiled Android Callable Wrappers, etc.).

The important part, then, is the `classes.dex` entry within the .apk. The &quot;sanity check&quot; is to extract your .apk, run `dexdump classes.dex`, and see if the type you're getting a NoClassDefFoundError for is present (or not present) within classes.dex. (`dexdump` is located in the Android SDK, e.g. $ANDROID_SDK_PATH/build-tools/19.0.0/dexdump.)

Note that dexdump lists types in JNI format, e.g. you'll see &quot;L/your/package/name/TypeName;&quot;.

If the type is missing from classes.dex, that's a problem. :-)

I would suggest cleaning everything, nuking all bin &amp; obj directories, and rebuilding. If that doesn't fix it, please provide the diagnostic build output. In particular, you want to find `dx.jar` invocation, and double-check that your embedded .jar is listed:

	Tool /usr/bin/java execution started with arguments: -jar /opt/android/sdk/platform-tools/lib/dx.jar --no-strict --dex --output=obj/Release/android/bin/classes.dex obj/Release/android/bin/classes /Library/Frameworks/Xamarin.Android.framework/Versions/Current/lib/mandroid/platforms/android-8/mono.android.jar obj/Release/__library_projects__/android-support-v4.jar

 - Jon

</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014019.html">[mono-android] Building a package with a jar bindings library strips the jar file from the assembly
</A></li>
	<LI>Next message: <A HREF="014033.html">[mono-android] Building a package with a jar bindings library strips the jar file from the assembly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14020">[ date ]</a>
              <a href="thread.html#14020">[ thread ]</a>
              <a href="subject.html#14020">[ subject ]</a>
              <a href="author.html#14020">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
