<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodroid] PackageName isn't actually case sensitive
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20PackageName%20isn%27t%20actually%20case%20sensitive&In-Reply-To=AANLkTimXUpdM8GxfVR%2BihrdNVg1igx%2BU5SKzAWR1Czp9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002806.html">
   <LINK REL="Next"  HREF="002829.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodroid] PackageName isn't actually case sensitive</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20PackageName%20isn%27t%20actually%20case%20sensitive&In-Reply-To=AANLkTimXUpdM8GxfVR%2BihrdNVg1igx%2BU5SKzAWR1Czp9%40mail.gmail.com"
       TITLE="[Monodroid] PackageName isn't actually case sensitive">jpryor at novell.com
       </A><BR>
    <I>Tue Feb  1 15:28:05 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002806.html">[Monodroid] PackageName isn't actually case sensitive
</A></li>
        <LI>Next message: <A HREF="002829.html">[Monodroid] PackageName isn't actually case sensitive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2812">[ date ]</a>
              <a href="thread.html#2812">[ thread ]</a>
              <a href="subject.html#2812">[ subject ]</a>
              <a href="author.html#2812">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Feb 1, 2011, at 12:39 PM, Stefan Rusek wrote:
&gt;<i> All I do to create a java based project is this:
</I>&gt;<i> 
</I>&gt;<i> android create project --name MixedCaseName --target 4 --path MixedCasePath --package com.mydomain.MixedCasePackage --activity MyActivity
</I>&gt;<i> 
</I>&gt;<i> this works flawlessly and I don't have any of the problems you mentioned.
</I>
It's also not exactly what was originally described; the problem is that you're thinking like a Java programmer, not a .NET programmer. :-)

The problem, as I described earlier, is still with the package name --  your first package name component is camelCase, not PascalCase.

Thus, if you care to play along at nome:

	$ android create project --name MixedCaseName --target 4 --path MixedCasePath --package Mixed.Case.Package --activity MyActivity

Note that the package here starts with an uppercase letter, not a lowercase letter, and also contains a period, to appease the Android gods.

This builds and installs just fine:

	$ ant install
	...
	     [exec] 	pkg: /data/local/tmp/MixedCaseName-debug.apk
	     [exec] Success

HOWEVER, if you kindly view the /manifest/application/activity element within MixedCaseName/AndroidManifest.xml:

	&lt;activity android:name=&quot;MyActivity&quot;
	          android:label=&quot;@string/app_name&quot;&gt;
	    &lt;intent-filter&gt;
	        &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
	        &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
	    &lt;/intent-filter&gt;
	&lt;/activity&gt;

Now, I was slightly mistaken in my factor #2: if there are no periods, then it's fine [0].  The above clearly has no periods.  Let's fix that:

	&lt;activity android:name=&quot;Mixed.Case.Name.MyActivity&quot;
	          android:label=&quot;@string/app_name&quot;&gt;
	    &lt;intent-filter&gt;
	        &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
	        &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
	    &lt;/intent-filter&gt;
	&lt;/activity&gt;

We changed //activity/@android:name to Mixed.Case.Name.MyActivity, which (1) starts with an uppercase letter, and (2) contains periods.

If we try to build and install this one:

	$ ant uninstall
	# make above changes
	$ ant install
	     [exec] 	pkg: /data/local/tmp/MixedCaseName-debug.apk
	     [exec] Failure [INSTALL_PARSE_FAILED_MANIFEST_MALFORMED]

It doesn't install!  Which was, after all, my point.  The only way to make the &quot;manifest&quot; (AndroidManifest.xml) well-formed is to either have the package name start with a lowercase letter (which was the case for your original example), start with a period, or to not have any periods within the //activity/@android:name value [0].  Factor #1 requires the inclusion of a period, and I didn't want to deal with the extra work logic that would be required to avoid it.  Add in the fact that a leading '.' is probably broken _anyway_ [1], and things go south fast.

Thus, Factor #2 does, in fact, require that package names start with a lowercase letter.  Historically, my next logical leap was to just camelCase the package names instead of lowercasing them, but then factor #3 and #4 raise their heads.  For Mixed.Case.Package, camelCasing amounts to lowercasing, but if you have MonoDroidTestProject as the package name, the camelCase is monoDroidTestProject, but if the AndroidManifest.xml package name is still MonoDroidTestProject, you have the case mismatch issue of factors #3 and #4, and monoDroidTestProject != MonoDroidTestProject, so things go further south.

It's not for no reason that we require lowercase package names.

It's because Android can be phenomenally annoying, and we have to work around its annoyances.  (If not for Factor #2, we'd just leave everything as the original casing, no camelCasing or lowercasing at all.  Things would Just Work&#8482;, and I'd be overjoyed, and then we'd probably find out that XML layout files fail to properly support this as there's no easy way to know when the package name ends and the type names begin, and then I'd start crying...)

 - Jon

[0] <A HREF="http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob;f=core/java/android/content/pm/PackageParser.java;h=ff3656c22216e3421712647dc742ce468728f1fd;hb=HEAD#l1174">http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob;f=core/java/android/content/pm/PackageParser.java;h=ff3656c22216e3421712647dc742ce468728f1fd;hb=HEAD#l1174</A>

[1] VS default project names don't contain periods, so you're looking at a project name like MyTestProject.  However, Android requires that a period be in there _somewhere_, so to facilitate this MonoDroid will set the package name to $(AssemblyName).$(AssemblyName).  (If $(AssemblyName) contains a '.', then it's used unchanged).  This results in a package name of MyTestProject.MyTestProject, which is lowercased to mytestproject.mytestproject, but even when we ignore the lowercase, the package name won't actually match any packages within the app!  Specifically, you'll have a type named mytestproject.Foo (assuming MyTestProject is also the name of your default project namespace), and mytestproject.Foo != mytestproject.mytestproject.Foo.  Result: a &quot;smarter&quot; monodroid would likely make things worse!  Using a fully-qualified type name nicely sidesteps the entire issue, and doesn't require that C# users actually change their project naming conventions.

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002806.html">[Monodroid] PackageName isn't actually case sensitive
</A></li>
	<LI>Next message: <A HREF="002829.html">[Monodroid] PackageName isn't actually case sensitive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2812">[ date ]</a>
              <a href="thread.html#2812">[ thread ]</a>
              <a href="subject.html#2812">[ subject ]</a>
              <a href="author.html#2812">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
