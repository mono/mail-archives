<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodroid] Wi-Fi Deploy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Wi-Fi%20Deploy&In-Reply-To=098101cbc407%248f699e70%24ae3cdb50%24%40igraphicsgroup.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002878.html">
   <LINK REL="Next"  HREF="002886.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodroid] Wi-Fi Deploy</H1>
    <B>Michael Hutchinson</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Wi-Fi%20Deploy&In-Reply-To=098101cbc407%248f699e70%24ae3cdb50%24%40igraphicsgroup.com"
       TITLE="[Monodroid] Wi-Fi Deploy">mhutchinson at novell.com
       </A><BR>
    <I>Thu Feb  3 22:30:39 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002878.html">[Monodroid] Wi-Fi Deploy
</A></li>
        <LI>Next message: <A HREF="002886.html">[Monodroid] Wi-Fi Deploy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2881">[ date ]</a>
              <a href="thread.html#2881">[ thread ]</a>
              <a href="subject.html#2881">[ subject ]</a>
              <a href="author.html#2881">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

The workaround you suggest is problematic because it doesn't work if there are multiple devices connected, and would break usb badly if another device or emulator comes online during the sequence of commands we issue to deploy to the devices. Since this would adversely affect usb deployment too, I don't think it's an option.

The problem seems to be with how adb addresses services on devices. adb is essentially a commandline client to the adb daemon, and you can communicate directly with this daemon over tcp. If you look at the docs for this protocol - OVERVIEW.txt and SERVICES.txt in <A HREF="http://android.git.kernel.org/?p=platform/system/core.git;a=tree;f=adb">http://android.git.kernel.org/?p=platform/system/core.git;a=tree;f=adb</A> - you can see commands are targeted at devices using &lt;hostid&gt;:command. So it seems likely that the colon in the device ID is being interpreted as the end of the host id and the beginning of the command name. I don't know whether there's a way to escape the colon, or maybe you can even get away with just using the IP and trusting adb to use the default port. Or perhaps there's some other host addressing mode that can be used for such devices.

If you'd like some examples of how MD communicates with the daemon, see <A HREF="https://github.com/mono/monodevelop/blob/master/extras/MonoDevelop.MonoDroid/MonoDevelop.MonoDroid/Adb/">https://github.com/mono/monodevelop/blob/master/extras/MonoDevelop.MonoDroid/MonoDevelop.MonoDroid/Adb/</A>

- Michael


On Feb 3, 2011, at 8:05 PM, Mike Tajmajer wrote:

&gt;<i> I can deploying over Wi-Fi with adb without any issues.
</I>&gt;<i> 
</I>&gt;<i> But, when trying to deploy from Visual Studio I get: Unhandled exception in
</I>&gt;<i> WaitForDevice.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> The log files shows:
</I>&gt;<i> 
</I>&gt;<i> -- Starting Process - 2/3/2011 6:51:45 PM --
</I>&gt;<i> Executable: C:\Program
</I>&gt;<i> Files\Android\android-sdk-windows\platform-tools\adb.exe
</I>&gt;<i> Arguments: -s 192.168.55.89:5555 wait-for-device
</I>&gt;<i> Appending Java path: C:\Program Files\Java\jdk1.6.0_23\bin
</I>&gt;<i> [STDERR] error: unknown host service
</I>&gt;<i> 
</I>&gt;<i> If I run the command via the cmd line I get:
</I>&gt;<i> 
</I>&gt;<i> [C:\]adb devices
</I>&gt;<i> List of devices attached
</I>&gt;<i> 192.168.55.89:5555      device
</I>&gt;<i> 
</I>&gt;<i> [C:\]adb -s 192.168.55.89:5555 wait-for-device
</I>&gt;<i> error: unknown host service
</I>&gt;<i> 
</I>&gt;<i> [C:\]echo %?
</I>&gt;<i> 1
</I>&gt;<i> 
</I>&gt;<i> ** However **, if I do not specify the -s and only have one device
</I>&gt;<i> connected, adb returns 0
</I>&gt;<i> [C:\]adb wait-for-device
</I>&gt;<i> 
</I>&gt;<i> [C:\]echo %?
</I>&gt;<i> 0
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> So, I would really-really-really like to get this working.  
</I>&gt;<i> 
</I>&gt;<i> If there is only one device connected, perhaps the &quot;adb -s ip:5555
</I>&gt;<i> wait-for-device&quot; can just omit &quot;-s ip:5555&quot;.
</I>&gt;<i> 
</I>&gt;<i> The ADB Documentation says:
</I>&gt;<i> &quot;If multiple emulator/device instances are running, you need to specify a
</I>&gt;<i> target instance when issuing adb commands. To so so, use the -s option in
</I>&gt;<i> the commands. The usage for the -s option is:&quot;
</I>&gt;<i> 
</I>&gt;<i> So, when a single device is connected, just don't use the -s switch.
</I>&gt;<i> 
</I>&gt;<i> Or, at least make it an option.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Even though I can deploy from the command line, not being able to debug is a
</I>&gt;<i> deal-breaker for me.   Using an emulator with OpenGL code is too painfull.
</I>&gt;<i> 
</I>&gt;<i> Is the source code available?  If so, I'll make this change and try it out
</I>&gt;<i> over the weekend.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i> 
</I>&gt;<i> UNSUBSCRIBE INFORMATION:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002878.html">[Monodroid] Wi-Fi Deploy
</A></li>
	<LI>Next message: <A HREF="002886.html">[Monodroid] Wi-Fi Deploy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2881">[ date ]</a>
              <a href="thread.html#2881">[ thread ]</a>
              <a href="subject.html#2881">[ subject ]</a>
              <a href="author.html#2881">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
