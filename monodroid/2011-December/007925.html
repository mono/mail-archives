<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Can not send IDictionary to WCF
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Can%20not%20send%20IDictionary%20to%20WCF&In-Reply-To=1324066886455-5081325.post%40n5.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007904.html">
   <LINK REL="Next"  HREF="007910.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Can not send IDictionary to WCF</H1>
    <B>Richard Wilburn</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Can%20not%20send%20IDictionary%20to%20WCF&In-Reply-To=1324066886455-5081325.post%40n5.nabble.com"
       TITLE="[mono-android] Can not send IDictionary to WCF">rhwilburn at gmail.com
       </A><BR>
    <I>Sat Dec 17 15:14:03 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="007904.html">[mono-android] Can not send IDictionary to WCF
</A></li>
        <LI>Next message: <A HREF="007910.html">[mono-android] SPAM-LOW: Re: GridView not releasing view objects
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7925">[ date ]</a>
              <a href="thread.html#7925">[ thread ]</a>
              <a href="subject.html#7925">[ subject ]</a>
              <a href="author.html#7925">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>That &quot;3HyOSdeZ&quot; is because you need a concrete type, not an interface. WCF
accepts interfaces, but it turns them into implementations by making a
dyanmic proxy (ie runtime generated class for your type. So for example the
following is possible

Services.Get&lt;IService&gt;().Call(x =&gt; x.helloWorld());

What that would do because your UI wouldn't know about any IService
implementation is that it creates a dynamic proxy for IService and puts WCF
routing into the impelementation of IService. Each method will do the same
behavior, ie serialize and route across a network to some protocoll like
soap.

Your runtime heirachy looks like this:

IService &lt;---------- IServices9df87sdf987

What IService might look like is:

interface IService{
       void HelloWorld();
}

What your IServices9df87sdf987 might look like:

public IServices9df87sdf987 : IService{

        public void HelloWorld(){
                return SerializeAndRouteCallToWCF();
        }
}


The method I created there called: SerializeAndRouteCallToWCF() is purely
abitary to demonstrate what the implementation generated by a proxy object
pattern could look like at runtime. Understanding this concept in WCF is
quite the gotcha, it adds behavior to your application, where if you
understand it, its not such a mystery, but when you don't know. it
generates random rubbush and can cause strange behavior. An example of this
was where I was once struggling to understand what was happening to my
proxy objects when I passed them through a WCF boundary. (WCF was
unwrapping them).

Hope this shines a new light on the situation.

On Sat, Dec 17, 2011 at 9:21 AM, RScanlon &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">rscanlon at originhs.com</A>&gt; wrote:

&gt;<i> I too am having a very similar issue.
</I>&gt;<i> The only real difference is that we use actual Dictionaries instead of
</I>&gt;<i> IDictionary.
</I>&gt;<i> I believe the issue stems from having a custom or complex type as either
</I>&gt;<i> the
</I>&gt;<i> key or value in your dictionary.
</I>&gt;<i> I have tested it sending a string for the key and an int for the value and
</I>&gt;<i> it works fine.
</I>&gt;<i>
</I>&gt;<i> I have also used fiddler to examine the difference in the SOAP between the
</I>&gt;<i> XML that mono sends and the xml that .NET or Silverlight sends. What I have
</I>&gt;<i> found is that .NET and Silverlight appends what appears to be a seemingly
</I>&gt;<i> random set of characters onto the end of the type name. But in truth it
</I>&gt;<i> must
</I>&gt;<i> not be random because through different projects and compiles the string
</I>&gt;<i> remains consistent. I have also noticed that it changes depending on what
</I>&gt;<i> namespace your custom class is in. So it must be some form of digest of a
</I>&gt;<i> namespace. Without this, the WCF server is unable to deserialize the
</I>&gt;<i> dictionary properly.
</I>&gt;<i>
</I>&gt;<i> Below is an example of the dictionary in XML created by mono and then the
</I>&gt;<i> XML created by .NET.
</I>&gt;<i> This is in a namespace called Joe and is a dictionary keyed by string with
</I>&gt;<i> a
</I>&gt;<i> value of type SimpleTest.
</I>&gt;<i>
</I>&gt;<i> Mono:
</I>&gt;<i> &lt;d4p1:NewDict
</I>&gt;<i> xmlns:d5p1=&quot;<A HREF="http://schemas.microsoft.com/2003/10/Serialization/Arrays&quot;">http://schemas.microsoft.com/2003/10/Serialization/Arrays&quot;</A>&gt;
</I>&gt;<i>    &lt;d5p1:KeyValueOfstringSimpleTest&gt;
</I>&gt;<i>        &lt;d5p1:Key&gt;TestKey1&lt;/d5p1:Key&gt;
</I>&gt;<i>        &lt;d5p1:Value&gt;
</I>&gt;<i>            &lt;int1
</I>&gt;<i> xmlns=&quot;<A HREF="http://schemas.datacontract.org/2004/07/Origin.BLL.Joe&quot;">http://schemas.datacontract.org/2004/07/Origin.BLL.Joe&quot;</A>&gt;1&lt;/int1&gt;
</I>&gt;<i>            &lt;string1
</I>&gt;<i> xmlns=&quot;<A HREF="http://schemas.datacontract.org/2004/07/Origin.BLL.Joe">http://schemas.datacontract.org/2004/07/Origin.BLL.Joe</A>
</I>&gt;<i> &quot;&gt;Test1&lt;/string1
</I>&gt;<i>        &lt;/d5p1:Value&gt;
</I>&gt;<i>    &lt;/d5p1:KeyValueOfstringSimpleTest&gt;
</I>&gt;<i> &lt;/d4p1:NewDict&gt;
</I>&gt;<i>
</I>&gt;<i> .NET
</I>&gt;<i> &lt;d4p1:NewDict
</I>&gt;<i> xmlns:d5p1=&quot;<A HREF="http://schemas.microsoft.com/2003/10/Serialization/Arrays&quot;">http://schemas.microsoft.com/2003/10/Serialization/Arrays&quot;</A>&gt;
</I>&gt;<i>    &lt;d5p1:KeyValueOfstringSimpleTest3HyOSdeZ&gt;
</I>&gt;<i>        &lt;d5p1:Key&gt;TestKey1&lt;/d5p1:Key&gt;
</I>&gt;<i>        &lt;d5p1:Value
</I>&gt;<i> xmlns:d7p1=&quot;<A HREF="http://schemas.datacontract.org/2004/07/Origin.BLL.Joe&quot;">http://schemas.datacontract.org/2004/07/Origin.BLL.Joe&quot;</A>&gt;
</I>&gt;<i>            &lt;d7p1:int1&gt;1&lt;/d7p1:int1&gt;
</I>&gt;<i>            &lt;d7p1:string1&gt;Test1&lt;/d7p1:string1&gt;
</I>&gt;<i>        &lt;/d5p1:Value&gt;
</I>&gt;<i>    &lt;/d5p1:KeyValueOfstringSimpleTest3HyOSdeZ&gt;
</I>&gt;<i> &lt;/d4p1:NewDict&gt;
</I>&gt;<i>
</I>&gt;<i> Notice how .NET appends &quot;3HyOSdeZ&quot; on the end of SimpleTest.
</I>&gt;<i>
</I>&gt;<i> Where you able to come up with a solution to your issue?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://mono-for-android.1047100.n5.nabble.com/Can-not-send-IDictionary-to-WCF-tp4908854p5081325.html">http://mono-for-android.1047100.n5.nabble.com/Can-not-send-IDictionary-to-WCF-tp4908854p5081325.html</A>
</I>&gt;<i> Sent from the Mono for Android mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i> UNSUBSCRIBE INFORMATION:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20111218/207eee85/attachment.html">http://lists.ximian.com/pipermail/monodroid/attachments/20111218/207eee85/attachment.html</A> 
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007904.html">[mono-android] Can not send IDictionary to WCF
</A></li>
	<LI>Next message: <A HREF="007910.html">[mono-android] SPAM-LOW: Re: GridView not releasing view objects
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7925">[ date ]</a>
              <a href="thread.html#7925">[ thread ]</a>
              <a href="subject.html#7925">[ subject ]</a>
              <a href="author.html#7925">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
