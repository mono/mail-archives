<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodroid] Problem to realize a &quot;timer&quot; application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Problem%20to%20realize%20a%20%22timer%22%20application&In-Reply-To=1284391905.23014.264.camel%40linux-teg2.site">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000788.html">
   <LINK REL="Next"  HREF="000811.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodroid] Problem to realize a &quot;timer&quot; application</H1>
    <B>Torello Querci</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Problem%20to%20realize%20a%20%22timer%22%20application&In-Reply-To=1284391905.23014.264.camel%40linux-teg2.site"
       TITLE="[Monodroid] Problem to realize a &quot;timer&quot; application">tquerci at gmail.com
       </A><BR>
    <I>Tue Sep 14 16:54:54 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000788.html">[Monodroid] Problem to realize a &quot;timer&quot; application
</A></li>
        <LI>Next message: <A HREF="000811.html">[Monodroid] Problem to realize a &quot;timer&quot; application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#807">[ date ]</a>
              <a href="thread.html#807">[ thread ]</a>
              <a href="subject.html#807">[ subject ]</a>
              <a href="author.html#807">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2010/9/13 Mike Kestner &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">mkestner at novell.com</A>&gt;:
&gt;<i> On Mon, 2010-09-13 at 16:37 +0200, Torello Querci wrote:
</I>&gt;&gt;<i> 2010/9/13 Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">jpryor at novell.com</A>&gt;:
</I>&gt;&gt;<i> &gt; On Mon, 2010-09-13 at 12:11 +0200, Torello Querci wrote:
</I>&gt;&gt;<i> &gt;&gt; understand what you say so I try to modify my code to derive
</I>&gt;&gt;<i> &gt;&gt; TextUpdate from Java.Lang.Object.
</I>&gt;&gt;<i> &gt;&gt; In this way I have a warning message about the Handle attribute so I
</I>&gt;&gt;<i> &gt;&gt; try to declare it as new or remove it.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Remove the Handle property from your TextUpdater type. &#160;You should not
</I>&gt;&gt;<i> &gt; be implementing this property; Java.Lang.Object handles it for you.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;&gt; The result it's the same: the method Run() it's never caller :(
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Because you're re-implementing IJavaObject.Handle, and your version is
</I>&gt;&gt;<i> &gt; used instead of the Java.Lang.Object version.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi Jonathan,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> as I writes I try to remove the Handle attribute because I suppose
</I>&gt;&gt;<i> this, but I got the same result. The Run method is not called.
</I>&gt;&gt;<i> I also try using debugger, and effectively the Run method is not run.
</I>&gt;<i>
</I>&gt;<i> I'm not sure what's going on here. &#160;Not seeing your exact sample may be
</I>&gt;<i> confusing things. &#160;There's not much point to us going back and forth
</I>&gt;<i> about it here on the list though, so feel free to file a bug with a
</I>&gt;<i> concrete example that fails, and we'll either tell you exactly what's
</I>&gt;<i> wrong with your code, or we'll have a reproduction sample to fix a bug
</I>&gt;<i> if it's there.
</I>&gt;<i>
</I>&gt;<i> Note that you could theoretically be running up against a couple of
</I>&gt;<i> known issues. &#160;One, there is an issue with multi-threading and GC
</I>&gt;<i> invocation which has been known to hang activities. &#160;This is filed as:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://bugzilla.novell.com/show_bug.cgi?id=633454">https://bugzilla.novell.com/show_bug.cgi?id=633454</A>
</I>&gt;<i>
</I>&gt;<i> The second known issue is that Java.Lang.Objects will leak because we
</I>&gt;<i> haven't completed our GC synchronization between java and mono. &#160;This is
</I>&gt;<i> why using a coding paradigm with minimal java object usage is a good
</I>&gt;<i> workaround right now, and why I've been trying to steer you toward
</I>&gt;<i> implementing IRunnable on a single maintained J.L.O instance.
</I>&gt;<i>
</I>&gt;<i> FWIW, the attached sample has been running in an emulator for 20 minutes
</I>&gt;<i> (over 2500 timer invocations) on my current development version of
</I>&gt;<i> monodroid. &#160;I don't believe there have been any changes since the latest
</I>&gt;<i> preview release that would impact this specific scenario. &#160;There was
</I>&gt;<i> however, a bugfix over the weekend that would have impacted an
</I>&gt;<i> Action-based timer implementation.
</I>&gt;<i>
</I>
Hi Mike,

you are right so .... I copy here the source code used.
Unfortunately the code crash again. The difference between you code and my are:

1 - the timeout is changed to 1000 because I run on Virtual Machine so
suppose that the event are too much to be handled by the emulated
runtime
2 - add a write to the logcat to understand when the application crash.

Without the print  on the logcat the application crash on a higher cnt
value but crash.

I have only supposition about this problem and was related with the
livecycle of mono object called by android framework.
So I suppose that this is a bug, it's right?
-------------- next part --------------
E/MONODROID(  370): method info: n_onCreate:(Landroid/os/Bundle;)V:GetOnCreate_Landroid_os_Bundle_Handler
E/MONODROID(  370): token info: GetOnCreate_Landroid_os_Bundle_Handler
E/MONODROID(  370): connect instance: Android.Runtime.JNIEnv+GetCallbackHandler
E/MONODROID(  370): callback instance: System.Action`3[System.IntPtr,System.IntPtr,System.IntPtr]
E/MONODROID(  370): native method info: n_onCreate (Landroid/os/Bundle;)V
E/MONODROID(  370): method info: n_run:()V:GetRunHandler:Java.Lang.IRunnableAdapter
E/MONODROID(  370): token info: GetRunHandler
E/MONODROID(  370): connect instance: Android.Runtime.JNIEnv+GetCallbackHandler
E/MONODROID(  370): callback instance: System.Action`2[System.IntPtr,System.IntPtr]
E/MONODROID(  370): native method info: n_run ()V
E/MONODROID(  370): method info:
D/dalvikvm(  249): GC freed 201 objects / 9096 bytes in 5774ms
D/dalvikvm(  267): GC freed 2933 objects / 198952 bytes in 1828ms
I/ActivityManager(   55): Displayed activity TimerUI3.TimerUI3/timerUI3.HelloActivity: 31824 ms (total 31824 ms)
W/MonoDroid log(  370): CNT=1
W/MonoDroid log(  370): CNT=2
W/MonoDroid log(  370): CNT=3
W/MonoDroid log(  370): CNT=4
W/MonoDroid log(  370): CNT=5
W/MonoDroid log(  370): CNT=6
W/MonoDroid log(  370): CNT=7
W/MonoDroid log(  370): CNT=8
W/MonoDroid log(  370): CNT=9
W/MonoDroid log(  370): CNT=10
W/MonoDroid log(  370): CNT=11
W/MonoDroid log(  370): CNT=12
W/MonoDroid log(  370): CNT=13
W/MonoDroid log(  370): CNT=14
W/MonoDroid log(  370): CNT=15
W/MonoDroid log(  370): CNT=16
W/MonoDroid log(  370): CNT=17
W/MonoDroid log(  370): CNT=18
W/MonoDroid log(  370): CNT=19
W/MonoDroid log(  370): CNT=20
W/MonoDroid log(  370): CNT=21
W/MonoDroid log(  370): CNT=22
W/MonoDroid log(  370): CNT=23
W/MonoDroid log(  370): CNT=24
W/MonoDroid log(  370): CNT=25
W/MonoDroid log(  370): CNT=26
W/MonoDroid log(  370): CNT=27
W/MonoDroid log(  370): CNT=28
W/MonoDroid log(  370): CNT=29
W/MonoDroid log(  370): CNT=30
W/MonoDroid log(  370): CNT=31
W/MonoDroid log(  370): CNT=32
W/MonoDroid log(  370): CNT=33
W/MonoDroid log(  370): CNT=34
W/MonoDroid log(  370): CNT=35
W/MonoDroid log(  370): CNT=36
W/MonoDroid log(  370): CNT=37
W/MonoDroid log(  370): CNT=38
W/MonoDroid log(  370): CNT=39
W/MonoDroid log(  370): CNT=40
W/MonoDroid log(  370): CNT=41
W/MonoDroid log(  370): CNT=42
W/MonoDroid log(  370): CNT=43
W/MonoDroid log(  370): CNT=44
W/MonoDroid log(  370): CNT=45
W/MonoDroid log(  370): CNT=46
W/MonoDroid log(  370): CNT=47
W/MonoDroid log(  370): CNT=48
W/MonoDroid log(  370): CNT=49
W/MonoDroid log(  370): CNT=50
W/MonoDroid log(  370): CNT=51
W/MonoDroid log(  370): CNT=52
W/MonoDroid log(  370): CNT=53
W/MonoDroid log(  370): CNT=54
W/MonoDroid log(  370): CNT=55
W/MonoDroid log(  370): CNT=56
W/MonoDroid log(  370): CNT=57
W/MonoDroid log(  370): CNT=58
W/MonoDroid log(  370): CNT=59
W/MonoDroid log(  370): CNT=60
W/MonoDroid log(  370): CNT=61
W/MonoDroid log(  370): CNT=62
W/MonoDroid log(  370): CNT=63
W/MonoDroid log(  370): CNT=64
W/MonoDroid log(  370): CNT=65
W/MonoDroid log(  370): CNT=66
W/MonoDroid log(  370): CNT=67
W/MonoDroid log(  370): CNT=68
W/MonoDroid log(  370): CNT=69
W/MonoDroid log(  370): CNT=70
W/MonoDroid log(  370): CNT=71
W/MonoDroid log(  370): CNT=72
W/MonoDroid log(  370): CNT=73
W/MonoDroid log(  370): CNT=74
W/MonoDroid log(  370): CNT=75
W/MonoDroid log(  370): CNT=76
W/MonoDroid log(  370): CNT=77
W/MonoDroid log(  370): CNT=78
W/MonoDroid log(  370): CNT=79
W/MonoDroid log(  370): CNT=80
W/MonoDroid log(  370): CNT=81
W/MonoDroid log(  370): CNT=82
W/MonoDroid log(  370): CNT=83
W/MonoDroid log(  370): CNT=84
W/MonoDroid log(  370): CNT=85
W/MonoDroid log(  370): CNT=86
W/MonoDroid log(  370): CNT=87
W/MonoDroid log(  370): CNT=88
W/MonoDroid log(  370): CNT=89
W/MonoDroid log(  370): CNT=90
W/MonoDroid log(  370): CNT=91
W/MonoDroid log(  370): CNT=92
W/MonoDroid log(  370): CNT=93
W/MonoDroid log(  370): CNT=94
W/MonoDroid log(  370): CNT=95
W/MonoDroid log(  370): CNT=96
W/MonoDroid log(  370): CNT=97
W/MonoDroid log(  370): CNT=98
W/MonoDroid log(  370): CNT=99
W/MonoDroid log(  370): CNT=100
W/MonoDroid log(  370): CNT=101
W/MonoDroid log(  370): CNT=102
W/MonoDroid log(  370): CNT=103
W/MonoDroid log(  370): CNT=104
W/MonoDroid log(  370): CNT=105
W/MonoDroid log(  370): CNT=106
W/MonoDroid log(  370): CNT=107
W/MonoDroid log(  370): CNT=108
W/MonoDroid log(  370): CNT=109
W/MonoDroid log(  370): CNT=110
W/MonoDroid log(  370): CNT=111
W/MonoDroid log(  370): CNT=112
W/MonoDroid log(  370): CNT=113
W/MonoDroid log(  370): CNT=114
W/MonoDroid log(  370): CNT=115
W/MonoDroid log(  370): CNT=116
W/MonoDroid log(  370): CNT=117
W/MonoDroid log(  370): CNT=118
W/MonoDroid log(  370): CNT=119
W/MonoDroid log(  370): CNT=120
W/MonoDroid log(  370): CNT=121
W/MonoDroid log(  370): CNT=122
W/MonoDroid log(  370): CNT=123
W/MonoDroid log(  370): CNT=124
W/MonoDroid log(  370): CNT=125
W/MonoDroid log(  370): CNT=126
W/MonoDroid log(  370): CNT=127
W/MonoDroid log(  370): CNT=128
W/MonoDroid log(  370): CNT=129
W/MonoDroid log(  370): CNT=130
W/MonoDroid log(  370): CNT=131
W/MonoDroid log(  370): CNT=132
W/MonoDroid log(  370): CNT=133
W/MonoDroid log(  370): CNT=134
W/MonoDroid log(  370): CNT=135
W/MonoDroid log(  370): CNT=136
W/MonoDroid log(  370): CNT=137
W/MonoDroid log(  370): CNT=138
W/MonoDroid log(  370): CNT=139
W/MonoDroid log(  370): CNT=140
W/MonoDroid log(  370): CNT=141
W/MonoDroid log(  370): CNT=142
W/MonoDroid log(  370): CNT=143
W/MonoDroid log(  370): CNT=144
W/MonoDroid log(  370): CNT=145
W/MonoDroid log(  370): CNT=146
W/MonoDroid log(  370): CNT=147
W/MonoDroid log(  370): CNT=148
W/MonoDroid log(  370): CNT=149
W/MonoDroid log(  370): CNT=150
W/MonoDroid log(  370): CNT=151
W/MonoDroid log(  370): CNT=152
W/MonoDroid log(  370): CNT=153
W/MonoDroid log(  370): CNT=154
W/MonoDroid log(  370): CNT=155
W/MonoDroid log(  370): CNT=156
W/MonoDroid log(  370): CNT=157
W/MonoDroid log(  370): CNT=158
W/MonoDroid log(  370): CNT=159
W/MonoDroid log(  370): CNT=160
W/MonoDroid log(  370): CNT=161
W/MonoDroid log(  370): CNT=162
W/MonoDroid log(  370): CNT=163
W/MonoDroid log(  370): CNT=164
W/MonoDroid log(  370): CNT=165
W/MonoDroid log(  370): CNT=166
W/MonoDroid log(  370): CNT=167
W/MonoDroid log(  370): CNT=168
W/MonoDroid log(  370): CNT=169
W/MonoDroid log(  370): CNT=170
W/MonoDroid log(  370): CNT=171
W/MonoDroid log(  370): CNT=172
W/MonoDroid log(  370): CNT=173
W/MonoDroid log(  370): CNT=174
W/MonoDroid log(  370): CNT=175
W/MonoDroid log(  370): CNT=176
W/MonoDroid log(  370): CNT=177
W/MonoDroid log(  370): CNT=178
W/MonoDroid log(  370): CNT=179
W/MonoDroid log(  370): CNT=180
W/MonoDroid log(  370): CNT=181
W/MonoDroid log(  370): CNT=182
W/MonoDroid log(  370): CNT=183
W/MonoDroid log(  370): CNT=184
W/MonoDroid log(  370): CNT=185
W/MonoDroid log(  370): CNT=186
W/MonoDroid log(  370): CNT=187
W/MonoDroid log(  370): CNT=188
W/dalvikvm(  370): JNI WARNING: 0x43d2d578 is not a valid JNI reference
W/dalvikvm(  370):              in Ldalvik/system/NativeStart;.run ()V (DeleteLocalRef)
I/dalvikvm(  370): &quot;Thread-8&quot; prio=5 tid=15 RUNNABLE
I/dalvikvm(  370):   | group=&quot;main&quot; sCount=0 dsCount=0 s=N obj=0x43d2f0d0 self=0x3de808
I/dalvikvm(  370):   | sysTid=377 nice=0 sched=0/0 cgrp=default handle=3113056
I/dalvikvm(  370):   at dalvik.system.NativeStart.run(Native Method)
I/dalvikvm(  370):
E/dalvikvm(  370): VM aborting
E/mono    (  370):
E/mono    (  370): Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object
D/Zygote  (   30): Process 370 exited cleanly (1)
I/ActivityManager(   55): Process TimerUI3.TimerUI3 (pid 370) has died.
I/WindowManager(   55): WIN DEATH: Window{43cdd988 TimerUI3.TimerUI3/timerUI3.HelloActivity paused=false}
I/UsageStats(   55): Unexpected resume of com.android.launcher while already resumed in TimerUI3.TimerUI3
W/InputManagerService(   55): Got RemoteException sending setActive(false) notification to pid 370 uid 10027
-------------- next part --------------
A non-text attachment was scrubbed...
Name: HelloActivity.cs
Type: application/octet-stream
Size: 926 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/mailman/private/monodroid/attachments/20100914/ba63f1b9/attachment.obj">http://lists.ximian.com/mailman/private/monodroid/attachments/20100914/ba63f1b9/attachment.obj</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000788.html">[Monodroid] Problem to realize a &quot;timer&quot; application
</A></li>
	<LI>Next message: <A HREF="000811.html">[Monodroid] Problem to realize a &quot;timer&quot; application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#807">[ date ]</a>
              <a href="thread.html#807">[ thread ]</a>
              <a href="subject.html#807">[ subject ]</a>
              <a href="author.html#807">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
