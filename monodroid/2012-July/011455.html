<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Random crashes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Random%20crashes&In-Reply-To=%3C9C37FBE6-EA59-41C8-82D6-024C45F49C8D%40xamarin.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011454.html">
   <LINK REL="Next"  HREF="011486.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Random crashes</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Random%20crashes&In-Reply-To=%3C9C37FBE6-EA59-41C8-82D6-024C45F49C8D%40xamarin.com%3E"
       TITLE="[mono-android] Random crashes">jonp at xamarin.com
       </A><BR>
    <I>Fri Jul 20 20:41:41 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011454.html">[mono-android] Random crashes
</A></li>
        <LI>Next message: <A HREF="011486.html">[mono-android] Random crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11455">[ date ]</a>
              <a href="thread.html#11455">[ thread ]</a>
              <a href="subject.html#11455">[ subject ]</a>
              <a href="author.html#11455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jul 20, 2012, at 8:28 AM, jayemmess wrote:
&gt;<i> I've inherited a project built using Mono for Android and need establish why it is occasionally crashing.  I have no prior experience of Android or Mono, but am a .net developer.
</I>
Which Mono for Android version? Which target device? Which Android version on the Target device?

&gt;<i> The log seems to show that the crashes are happening for a number of different reasons, though that could just be me not understanding what the logs are telling me.
</I>&gt;<i> 
</I>&gt;<i> I've published one of the logs here: <A HREF="http://pastebin.com/KnzdKikM">http://pastebin.com/KnzdKikM</A>
</I>
The first thing to note is that the messages have structure:

	TimeStamp	Message-Level/Tag	(PID): Message

For example:

	07-20 19:33:23.585 E/MessageQueue(  479):

The timestamp is &quot;07-20 19:33:23.585&quot;.

The Message-Level is &quot;E&quot; (Error).

The Tag is &quot;MessageQueue.&quot;

The PID is 479.

The Message is &quot;Error: NameResolutionFailure.&quot;

If you read through that log, you'll notice that there are _lots_ of different pids. Note all of them are relevant to your app's execution, so the first thing to do is to determine which messages are relevant:

	<A HREF="http://docs.xamarin.com/android/advanced_topics/android_debug_log#Interesting_Messages">http://docs.xamarin.com/android/advanced_topics/android_debug_log#Interesting_Messages</A>

Search for &quot;__mono&quot;; this finds messages generated during process startup, from the executing process:

	07-20 19:33:02.215 I/ActivityThread(  479): Pub app.my.__mono_init__: mono.MonoRuntimeProvider

That message gives us a pid (479), which greatly narrows down the output: Lots of messages from 479 are NameResolutionFailure messages, suggesting that there's some kind of network issue. A quick sanity check is to see if the Browser app on your device is able to access the same website that your app is trying to access.

We can also see that the gref count is constantly increasing:

	07-20 19:36:13.825 D/dalvikvm(  479): GREF has increased to 1301

This is usually a sign that the GC isn't running frequently enough, or you're constantly creating new objects which are referenced by both VMs:

	<A HREF="http://docs.xamarin.com/android/advanced_topics/garbage_collection">http://docs.xamarin.com/android/advanced_topics/garbage_collection</A>
	<A HREF="http://docs.xamarin.com/android/advanced_topics/diagnostics">http://docs.xamarin.com/android/advanced_topics/diagnostics</A>

This is troubling though:

	07-20 19:36:22.795 I/mono    (  479): Stacktrace:
	07-20 19:36:22.795 I/mono    (  479):

There's an exception, but no stack trace. Fun. :-(

So search backwards, and:

	07-20 19:36:22.555 I/InputQueue-JNI(  479): Ignoring finish signal on channel that is no longer registered.

So timewise, shortly after your app generates an &quot;InputQueue-JNI&quot; message, it does something that results in an unhandled exception. Search your app source for &quot;InputQueue-JNI&quot;, and try to understand the surrounding logic and see what would be executed afterward.

&gt;<i> It seems that the app was in this instance terminated due to an ANR. Would anyone be able to tell me if that log shows why the ANR occurred or advise me on how I should go about debugging the issue?
</I>
You'd want to read the ANR log:

	07-20 19:36:31.195 I/dalvikvm(  479): Wrote stack traces to '/data/anr/traces.txt'

So grab that file:

	adb pull /data/anr/traces.txt

You won't get a complete stack trace, but it may be enough to help.

 - Jon

</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011454.html">[mono-android] Random crashes
</A></li>
	<LI>Next message: <A HREF="011486.html">[mono-android] Random crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11455">[ date ]</a>
              <a href="thread.html#11455">[ thread ]</a>
              <a href="subject.html#11455">[ subject ]</a>
              <a href="author.html#11455">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
