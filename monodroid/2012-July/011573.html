<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] How to handle garbage collection?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20How%20to%20handle%20garbage%20collection%3F&In-Reply-To=%3C1343774369704-5711096.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011570.html">
   <LINK REL="Next"  HREF="011566.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] How to handle garbage collection?</H1>
    <B>craig</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20How%20to%20handle%20garbage%20collection%3F&In-Reply-To=%3C1343774369704-5711096.post%40n5.nabble.com%3E"
       TITLE="[mono-android] How to handle garbage collection?">craigrs84 at gmail.com
       </A><BR>
    <I>Tue Jul 31 22:39:29 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011570.html">[mono-android] How to handle garbage collection?
</A></li>
        <LI>Next message: <A HREF="011566.html">[mono-android] How to handle garbage collection?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11573">[ date ]</a>
              <a href="thread.html#11573">[ thread ]</a>
              <a href="subject.html#11573">[ subject ]</a>
              <a href="author.html#11573">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I was running on Android emulator API Level 7 (2.1)

Curiously, I just tried the same code on Android emulator API Level 15 and
it behaved completely differently.  The app didn't lock up like it does on
API Level 7.

I don't know.  I don't fully understand it all yet (haven't had time to do
further research yet) but something just doesn't seem right.  It feels like
a bug to me.  Let me again re-iterate that I know the way I'm doing this is
not the most efficient way.  And I do plan to switch over to using a
ListView.  But it still feels very buggy.  If what I am mistaking as a bug
is actually just a limitation of Mono for Android then please correct me.

On API Level 7 it seems that garbage collection is finally kicking in after
it reaches around 1900 grefs.  I'm fine with this.  But what surprises me is
that it seems to go haywire and continue to run full GC over and over again. 
I'm not seeing this behavior on API Level 15.  Even after it finishes doing
full GC and it says that the &quot;GREF has decreased to 299&quot;, the next time I
click the button it runs full GC again!  I would have thought that it
wouldn't need to run full GC again for at least another 10-20 clicks of the
button.  So yes it seems like resources are not being released.  I'd be
suspicious of Android/Java except that I have tried it in Java and it works
fine.

Anyways I am attaching 2 different logs from my logcat.

The first log is from logcat on Android API Level 7:
<A HREF="http://codeviewer.org/view/code:2895">http://codeviewer.org/view/code:2895</A>

The second log is from logcat on Android API Level 15:
<A HREF="http://codeviewer.org/view/code:2896">http://codeviewer.org/view/code:2896</A>

Hopefully these two logs will provide some insight.  I have added an
additional logging line that records every time I pressed the button (at the
beginning of the event handler).

Also, you mentioned that you were confused by the 2200+ gref count.  I can
consistently reproduce these high counts on the API Level 7 emulator.







--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/How-to-handle-garbage-collection-memory-leak-tp5711079p5711096.html">http://mono-for-android.1047100.n5.nabble.com/How-to-handle-garbage-collection-memory-leak-tp5711079p5711096.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011570.html">[mono-android] How to handle garbage collection?
</A></li>
	<LI>Next message: <A HREF="011566.html">[mono-android] How to handle garbage collection?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11573">[ date ]</a>
              <a href="thread.html#11573">[ thread ]</a>
              <a href="subject.html#11573">[ subject ]</a>
              <a href="author.html#11573">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
