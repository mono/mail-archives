<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Get Bitmap from QRCodeWriter using Zxing Library
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Get%20Bitmap%20from%20QRCodeWriter%20using%20Zxing%20Library&In-Reply-To=%3C1343363084966-5711054.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011516.html">
   <LINK REL="Next"  HREF="011538.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Get Bitmap from QRCodeWriter using Zxing Library</H1>
    <B>DFX</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Get%20Bitmap%20from%20QRCodeWriter%20using%20Zxing%20Library&In-Reply-To=%3C1343363084966-5711054.post%40n5.nabble.com%3E"
       TITLE="[mono-android] Get Bitmap from QRCodeWriter using Zxing Library">dan.fearing at gmail.com
       </A><BR>
    <I>Fri Jul 27 04:24:44 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="011516.html">[mono-android] Mono for Android 4.2.5 Alpha Release Available
</A></li>
        <LI>Next message: <A HREF="011538.html">[mono-android] Get Bitmap from QRCodeWriter using Zxing Library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11537">[ date ]</a>
              <a href="thread.html#11537">[ thread ]</a>
              <a href="subject.html#11537">[ subject ]</a>
              <a href="author.html#11537">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using the MonoDroid port of Zxing, found here:
<A HREF="https://github.com/JohnACarruthers/zxing.MonoDroid">https://github.com/JohnACarruthers/zxing.MonoDroid</A>

I'm trying to create a QR Code and display it in an ImageView, but I
apparently I have no idea what I'm doing ;-)

QRCodeWriter has an encode method that returns a ByteMatrix. I'm trying to
use BitMapFactory.DecodeByteArray, by flattening out the ByteMatrix into a
standard byte[], but BitMapFactory.DecodeByteArray always returns null. 

Here is my code:

		const byte BLACK = 0;
		const byte WHITE = 255;
			var height = 100;
			var width = 100;
			var writer = new QRCodeWriter();
			var matrix = writer.encode(&quot;http//www.google.com&quot;,
com.google.zxing.BarcodeFormat.QR_CODE, width, height);
			var pixels = new byte[width * height];

			for (var y = 0; y &lt; height; y++)
			{
				var offset = y * width;

				for (var x = 0; x &lt; width; x++)
				{
					int grayValue = matrix.get_Renamed(y, x) &amp; 0xff;
					pixels[offset + x] = grayValue == 0 ? BLACK : WHITE;
				}
			}

			var bitmap = BitmapFactory.DecodeByteArray(pixels, 0, pixels.Length);
			var imageView = FindViewById&lt;ImageView&gt;(Resource.Id.QRCode);

			imageView.SetImageBitmap(bitmap);

The QRCode I'm generating is short lived, so I'm trying not to save it on
the phone's file system, just display it from memory.  Any help on what I'm
doing wrong or the proper way to do this would be helpful.

Also, apologies in advance, I feel like I'm most likely doing something
obviously stupid, I just don't see it.

Thanks,
Dan




--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/Get-Bitmap-from-QRCodeWriter-using-Zxing-Library-tp5711054.html">http://mono-for-android.1047100.n5.nabble.com/Get-Bitmap-from-QRCodeWriter-using-Zxing-Library-tp5711054.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011516.html">[mono-android] Mono for Android 4.2.5 Alpha Release Available
</A></li>
	<LI>Next message: <A HREF="011538.html">[mono-android] Get Bitmap from QRCodeWriter using Zxing Library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11537">[ date ]</a>
              <a href="thread.html#11537">[ thread ]</a>
              <a href="subject.html#11537">[ subject ]</a>
              <a href="author.html#11537">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
