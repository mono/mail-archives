<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Trouble using the AddJavascriptInterface with a	WebView
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Trouble%20using%20the%20AddJavascriptInterface%20with%20a%0A%09WebView&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006873.html">
   <LINK REL="Next"  HREF="006872.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Trouble using the AddJavascriptInterface with a	WebView</H1>
    <B>Windmiller</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Trouble%20using%20the%20AddJavascriptInterface%20with%20a%0A%09WebView&In-Reply-To="
       TITLE="[mono-android] Trouble using the AddJavascriptInterface with a	WebView">c7r5apperjapper at hotmail.com
       </A><BR>
    <I>Wed Oct 26 10:05:46 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006873.html">[mono-android] Onclick event handler on button contained in a	listview item
</A></li>
        <LI>Next message: <A HREF="006872.html">[mono-android] Trouble using the AddJavascriptInterface with a	WebView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6870">[ date ]</a>
              <a href="thread.html#6870">[ thread ]</a>
              <a href="subject.html#6870">[ subject ]</a>
              <a href="author.html#6870">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, this is my first post here, so I hope I follow all the guidlines??

I have a problem using the AddJavascriptInterface with a WebView, it
&quot;compiles&quot; and runs the application but the javascript function
window.Testaren.getNumb() isn't there, it is null.
The Test.html page is displayed in the app, like it should.

I'm trying to make the text Test Page! change to the calculated number 10,
but when i click the body the application crasches because Testaren is null.
I'm using an emulator for this.

Here is my code for this project.

My Testar.java file contains..

package com.testar.Totsie;

public class Testar
{
	public Testar()
	{
	}
	public int getNumb(int i)
	{
		return i*2;
	}
}


And my Mono activity class..

public class Activity1 : Activity
{
       
        protected override void OnCreate(Bundle savedInstanceState)
        {
            base.OnCreate(savedInstanceState);
           

            // Hide the window title.
            RequestWindowFeature(WindowFeatures.NoTitle);
            SetContentView(Resource.Layout.Main); 

            WebView vv = FindViewById&lt;WebView&gt;(Resource.Id.webView);
            vv.Settings.JavaScriptEnabled = true;
            
            IntPtr JavaScriptInterface_Class =
JNIEnv.FindClass(&quot;com/testar/Totsie/Testar&quot;);

            IntPtr JavaScriptInterface_ctor =
JNIEnv.GetMethodID(JavaScriptInterface_Class, &quot;&lt;init&gt;&quot;, &quot;()V&quot;);

            IntPtr instance = JNIEnv.NewObject(JavaScriptInterface_Class,
JavaScriptInterface_ctor);

            vv.AddJavascriptInterface(new Java.Lang.Object(instance),
&quot;Testaren&quot;);

            vv.LoadUrl(@&quot;<A HREF="http://www.xxxxxx.se/test.html&quot;">http://www.xxxxxx.se/test.html&quot;</A>);            
       
        }        
}

And javascript to call this function on the Test.html page, as follows..

&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Ruhuset&lt;/title&gt;

&lt;/head&gt;
&lt;body onclick=&quot;javascript:getNumb();&quot; id=&quot;body&quot;&gt;
Test page!
&lt;/body&gt;
&lt;/html&gt;

--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/Trouble-using-the-AddJavascriptInterface-with-a-WebView-tp4939866p4939866.html">http://mono-for-android.1047100.n5.nabble.com/Trouble-using-the-AddJavascriptInterface-with-a-WebView-tp4939866p4939866.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006873.html">[mono-android] Onclick event handler on button contained in a	listview item
</A></li>
	<LI>Next message: <A HREF="006872.html">[mono-android] Trouble using the AddJavascriptInterface with a	WebView
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6870">[ date ]</a>
              <a href="thread.html#6870">[ thread ]</a>
              <a href="subject.html#6870">[ subject ]</a>
              <a href="author.html#6870">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
