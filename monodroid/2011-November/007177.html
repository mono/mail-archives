<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Monodroid : Intermittent failure in StreamReader.ReadLine() when reading json from web service
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Monodroid%20%3A%20Intermittent%20failure%20in%0A%20StreamReader.ReadLine%28%29%20when%20reading%20json%20from%20web%20service&In-Reply-To=CANr-n594nKZ6b4okPbeOphNQ9ACJXGzp3A4e%3DzurfwCnA0e2RQ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007172.html">
   <LINK REL="Next"  HREF="007174.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Monodroid : Intermittent failure in StreamReader.ReadLine() when reading json from web service</H1>
    <B>Glen Hassell</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Monodroid%20%3A%20Intermittent%20failure%20in%0A%20StreamReader.ReadLine%28%29%20when%20reading%20json%20from%20web%20service&In-Reply-To=CANr-n594nKZ6b4okPbeOphNQ9ACJXGzp3A4e%3DzurfwCnA0e2RQ%40mail.gmail.com"
       TITLE="[mono-android] Monodroid : Intermittent failure in StreamReader.ReadLine() when reading json from web service">mrhassell at gmail.com
       </A><BR>
    <I>Thu Nov 17 16:20:44 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="007172.html">[mono-android] Monodroid : Intermittent failure in StreamReader.ReadLine() when reading json from web service
</A></li>
        <LI>Next message: <A HREF="007174.html">[mono-android] fragments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7177">[ date ]</a>
              <a href="thread.html#7177">[ thread ]</a>
              <a href="subject.html#7177">[ subject ]</a>
              <a href="author.html#7177">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>increase the maxArrayLength value because your byte[] array returned
exceeds the 16348 size. The max value you can set for maxArrayLength is
again the max Int32 number which is equal to 2147483647. Modify this
setting and your web service will be able to transfer large data between
your web service and the client application.

In *Web.config* , the web service reference bindings for clients are
generated.

&quot;The maximum message size quota for incoming messages (65536) has been
exceeded. To increase the quota, use the MaxReceivedMessageSize property on
the appropriate binding element.&quot;

set it to the maximum of 2^31 - 1 or 2147483647 the biggest 32 bit number.

Pay attention on the transferMode, which by default is Buffered.

   - *Bufferred* means the request and response messages will be both
   buffered.

Other enumerations for transferMode:

   - *Streamed* which means both the request and response messages will be
   streamed, or
   - *StreamedRequest* where the request will be streamed while response
   message buffered, or
   - *StreamedResponse* where the request message will be buffered while
   response message streamed.

For those that don't know, Buffered means that the transfer will hold the
entire message in memory buffer all until the transfer is completed.
Streamed means that only the message headers will be buffered, while the
message body will be exposed as a stream.

Change to the maxReceivedMessageSize from 65536 to 2147483647 - if you
leave the transferMode=&quot;Buffered&quot; we might get another error:

For TransferMode.Buffered, MaxReceivedMessageSize and MaxBufferSize must be
the same value. Parameter name: bindingElement

Both attributes require the same value, the MaxReceivedMessageSize is
larger than MaxBufferSize, if the whole message is buffered.

You have two options: a) Change the MaxBufferSize to size of 2147483647 b)
Make the transferMode to: Streamed, StreamedRequest or StreamedResponse.

&quot;The decision to use either buffered or streamed transfers is a local
decision of the endpoint for HTTP transports. For HTTP transports, the
transfer mode does not propagate across a connection, or to proxy servers
or other intermediaries. Setting the transfer mode is not reflected in the
description of the service contract. After generating a proxy to a service,
you can (it is allowed but not required) edit the configuration file for
services intended to be used with streamed transfers to set the transfer
mode. For TCP and named pipe transports, the transfer mode is propagated as
a policy assertion.&quot;
<A HREF="http://msdn.microsoft.com/en-us/library/system.servicemodel.transfermode.aspx">http://msdn.microsoft.com/en-us/library/system.servicemodel.transfermode.aspx</A>

On Fri, Nov 18, 2011 at 12:28 AM, kshitij limaye &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">klimaye at gmail.com</A>&gt; wrote:

&gt;<i> I posted this question on stackoverflow
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://stackoverflow.com/questions/8167726/monodroid-intermittent-failure-when-reading-a-large-json-string-from-web-servi">http://stackoverflow.com/questions/8167726/monodroid-intermittent-failure-when-reading-a-large-json-string-from-web-servi</A>
</I>&gt;<i>
</I>&gt;<i> If this is the right forum to ask the question, I can give details here as
</I>&gt;<i> well.
</I>&gt;<i>
</I>&gt;<i> I have had intermittent failures with StreamReader object's ReadLine and
</I>&gt;<i> ReadToEnd methods.
</I>&gt;<i>
</I>&gt;<i> This essentially causes the app to freeze and get stuck.
</I>&gt;<i>
</I>&gt;<i> Why would StreamReader fail intermittently and how would one gracefully
</I>&gt;<i> handle this without the app being stuck.
</I>&gt;<i>
</I>&gt;<i> Note : The exception by passes the try/catch block.
</I>&gt;<i>
</I>&gt;<i> Please advice.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Kshitij
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i> UNSUBSCRIBE INFORMATION:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Glen Hassell
Inner Technique
<A HREF="http://innertech.com.au/">http://innertech.com.au/</A>
Office: 03 9687 0006
Mobile: +61 (0) 438 340 385
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20111118/f0a24161/attachment-0001.html">http://lists.ximian.com/pipermail/monodroid/attachments/20111118/f0a24161/attachment-0001.html</A> 
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007172.html">[mono-android] Monodroid : Intermittent failure in StreamReader.ReadLine() when reading json from web service
</A></li>
	<LI>Next message: <A HREF="007174.html">[mono-android] fragments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7177">[ date ]</a>
              <a href="thread.html#7177">[ thread ]</a>
              <a href="subject.html#7177">[ subject ]</a>
              <a href="author.html#7177">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
