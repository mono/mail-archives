<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Random exceptions while reading SSL stream
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Random%20exceptions%20while%20reading%20SSL%20stream&In-Reply-To=CAHDw2Gf1B%2BH%2BNZqKk4Xn5Ti73w6jymUmGyypMe%3DugQroxw0V1w%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007165.html">
   <LINK REL="Next"  HREF="007329.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Random exceptions while reading SSL stream</H1>
    <B>Andrew Sinclair</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Random%20exceptions%20while%20reading%20SSL%20stream&In-Reply-To=CAHDw2Gf1B%2BH%2BNZqKk4Xn5Ti73w6jymUmGyypMe%3DugQroxw0V1w%40mail.gmail.com"
       TITLE="[mono-android] Random exceptions while reading SSL stream">andrew at magic5software.com
       </A><BR>
    <I>Thu Nov 17 04:41:18 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="007165.html">[mono-android] Random exceptions while reading SSL stream
</A></li>
        <LI>Next message: <A HREF="007329.html">[mono-android] Random exceptions while reading SSL stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7167">[ date ]</a>
              <a href="thread.html#7167">[ thread ]</a>
              <a href="subject.html#7167">[ subject ]</a>
              <a href="author.html#7167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Piotr,

 

This sounds like exactly the same problem as:

 

<A HREF="http://bugzilla.xamarin.com/show_bug.cgi?id=1394">http://bugzilla.xamarin.com/show_bug.cgi?id=1394</A>

<A HREF="http://bugzilla.xamarin.com/show_bug.cgi?id=1741">http://bugzilla.xamarin.com/show_bug.cgi?id=1741</A>

<A HREF="http://bugzilla.xamarin.com/show_bug.cgi?id=1534">http://bugzilla.xamarin.com/show_bug.cgi?id=1534</A>

<A HREF="http://bugzilla.xamarin.com/show_bug.cgi?id=1031">http://bugzilla.xamarin.com/show_bug.cgi?id=1031</A>

 

plus the &#8220;Mono Stacktrace and ANR&#8221; e-mail sent to the list yesterday.

 

I&#8217;ve only seen this type of thing since 1.2.0 and it also happens with 1.9.*. Prior to 1.2 there seemed to be many more GC-related bugs but maybe they just hid this one (or maybe it&#8217;s the knock-on effect of a fix.)

 

Xamarin people -&gt; any idea when this will be fixed? The bugzilla bugs are quiet. I can&#8217;t imagine there&#8217;s a more important problem for you to be fixing because it causes random hangs in all sorts of applications and there isn&#8217;t a workaround for the developer. I&#8217;d be happy to trade all of the new functionality in 2.x for a fix to this one and a stable runtime!!

 

Cheers,

 

Andy

 

From: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] On Behalf Of Piotr Kryger
Sent: 17 November 2011 09:24
To: Discussions related to Mono for Android
Subject: [mono-android] Random exceptions while reading SSL stream

 

Hi,

Im trying to read binary data from ssl stream.
Basically, I do this:

Stream inner = ConnectToMyHttpsServerAndGetStream();
SslStream sslStream = new SslStream(inner, false, null, null);
sslStream.AuthenticateAsClient(certificateServerName);
BinaryReader reader = new BinaryReader(sslStream);
//calls to reader methods go here
reader.Close();


Most of the time, code runs fine, but sometimes during reading operations my app freezes. Log shows following (or similar) stacktrace:
11-17 09:28:20.084 I/mono    (24066): Stacktrace:
11-17 09:28:20.084 I/mono    (24066): 
11-17 09:28:20.084 I/mono    (24066):   at Mono.Security.Protocol.Tls.CipherSuite.DecryptRecord (byte[],byte[]&amp;,byte[]&amp;) &lt;0x000e3&gt;
11-17 09:28:20.125 I/mono    (24066):   at Mono.Security.Protocol.Tls.RecordProtocol.decryptRecordFragment (Mono.Security.Protocol.Tls.ContentType,byte[]) &lt;0x0006b&gt;
11-17 09:28:20.125 I/mono    (24066):   at Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback (System.IAsyncResult) &lt;0x001b7&gt;
11-17 09:28:20.125 I/mono    (24066):   at System.IO.Stream.BeginRead (byte[],int,int,System.AsyncCallback,object) &lt;0x00117&gt;
11-17 09:28:20.125 I/mono    (24066):   at Mono.Security.Protocol.Tls.RecordProtocol.BeginReceiveRecord (System.IO.Stream,System.AsyncCallback,object) &lt;0x0016f&gt;
11-17 09:28:20.125 I/mono    (24066):   at Mono.Security.Protocol.Tls.RecordProtocol.ReceiveRecord (System.IO.Stream) &lt;0x00023&gt;
11-17 09:28:20.125 I/mono    (24066):   at Mono.Security.Protocol.Tls.SslStreamBase.InternalReadCallback (System.IAsyncResult) &lt;0x002a3&gt;
11-17 09:28:20.125 I/mono    (24066):   at (wrapper runtime-invoke) &lt;Module&gt;.runtime_invoke_void__this___object (object,intptr,intptr,intptr) &lt;0xffffffff&gt;

The more data is read, the more frequent the exception tends to be.
Is there anything I can do to workaround this issue? Or maybe Im doing something wrong?
Im using M4A 1.2 and VS2010.

Thanks,
Piotr
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20111117/306bc0b9/attachment-0001.html">http://lists.ximian.com/pipermail/monodroid/attachments/20111117/306bc0b9/attachment-0001.html</A> 
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007165.html">[mono-android] Random exceptions while reading SSL stream
</A></li>
	<LI>Next message: <A HREF="007329.html">[mono-android] Random exceptions while reading SSL stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7167">[ date ]</a>
              <a href="thread.html#7167">[ thread ]</a>
              <a href="subject.html#7167">[ subject ]</a>
              <a href="author.html#7167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
