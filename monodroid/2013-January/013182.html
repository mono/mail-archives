<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Google maps with MfA need for api key and	getting lat and long
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Google%20maps%20with%20MfA%20need%20for%20api%20key%20and%0A%09getting%20lat%20and%20long&In-Reply-To=%3CD061A0DF-D218-41C0-B7A7-A0170AFA2D70%40xamarin.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013198.html">
   <LINK REL="Next"  HREF="013184.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Google maps with MfA need for api key and	getting lat and long</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Google%20maps%20with%20MfA%20need%20for%20api%20key%20and%0A%09getting%20lat%20and%20long&In-Reply-To=%3CD061A0DF-D218-41C0-B7A7-A0170AFA2D70%40xamarin.com%3E"
       TITLE="[mono-android] Google maps with MfA need for api key and	getting lat and long">jonp at xamarin.com
       </A><BR>
    <I>Tue Jan  8 15:13:00 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="013198.html">[mono-android] Google maps with MfA need for api key and getting lat and long
</A></li>
        <LI>Next message: <A HREF="013184.html">[mono-android] Google maps with MfA need for api key and getting lat and long
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13182">[ date ]</a>
              <a href="thread.html#13182">[ thread ]</a>
              <a href="subject.html#13182">[ subject ]</a>
              <a href="author.html#13182">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jan 8, 2013, at 9:37 AM, John Murray &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">john at murray.gb.com</A>&gt; wrote:
&gt;<i> Any idea how I can get an up to date debug.keystore file
</I>
You are now entering a maze of twisty passages, all alike. Your sanity is likely to disappear.

First of all, where'd debug.keystore come from? Mono for Android auto-generates it during the build process if it doesn't already exist (because all apps need to be signed to get them onto the device). If you need a new one, delete it and a new one will be auto generated:

	OSX: $HOME/.local/share/Xamarin/Mono for Android/debug.keystore
	Windows: %LOCALAPPDATA%\Xamarin\Mono for Android\debug.keystore

HOWEVER, that's only part of the problem, and this is where things get crazy.

Since debug.keystore is automatically created, it will DIFFER between every machine that Mono for Android is installed on. This is fine outside of Google Maps, but when you need to use Google Maps (and it's API key) and you're on a team this will result in pain, suffering, and misery (because only one person will be able to build the app!).

So when it comes to Google Maps, you DO NOT want to use the default debug.keystore file!

Instead, create a new one:

	<A HREF="http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Creating_a_Private_Keystore">http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Creating_a_Private_Keystore</A>

Add it to your source repo, and update your project so that the included keystore is used instead of the default keystore:

	<A HREF="http://docs.xamarin.com/Android/Guides/Advanced_Topics/Build_Process#Signing">http://docs.xamarin.com/Android/Guides/Advanced_Topics/Build_Process#Signing</A>
	<A HREF="http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Permanently_Use_A_Different_Keystore">http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Permanently_Use_A_Different_Keystore</A>

This allows things to be &quot;sane&quot; in a team environment, but the security implications are terrible: you have a (private!) keystore in a &quot;public&quot; (presumably internal) source control repo, and the password + alias + etc. are stored in plain text in your .csproj.

This is NOT SECURE. It WORKS, but it's not secure. (Related note: this might not be &quot;that bad&quot;; if someone can access the in-repo keystore, they can also access all the source included in that repo, which is presumably something you don't want easily accessible either...)

Bear that in mind. ;-)

For Release apps, you'll want (need) to use a DIFFERENT keystore file, protected with actual security precautions (e.g. not stored on a network accessible computer), and then MANUALLY sign your Release app with this Release keystore:

	<A HREF="http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Signing_the_APK_in_Visual_Studio_(Mono_for_Android_4.2.6_or_higher">http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Signing_the_APK_in_Visual_Studio_(Mono_for_Android_4.2.6_or_higher</A>)

Of course, since your Release app is using a different keystore file, it'll also have a different Google Maps API key (argh!). You'll probably thus want to store the API key as a String resource, and have per-build string resources (one for Debug builds, one for Release builds):

	<A HREF="http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Storing_Google_Maps_API_Keys">http://docs.xamarin.com/Android/Guides/Deployment%2C_Testing%2C_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release#Storing_Google_Maps_API_Keys</A>

Related/different idea to the above: to your Project, add two files: Resources\Values\ApiKey-Release.xml and Resources\Values\ApiKey-Debug.xml:

	&lt;resources&gt;
		&lt;string name=&quot;google_maps_api_key&quot;&gt;...&lt;/string&gt;
	&lt;/resources&gt;

Update &quot;...&quot; with the appropriate value (Debug key in the -Debug file, Release key in the -Release file). Add one to your .csproj via the IDE, close the project, then manually edit the .csproj to replace the ApiKey-*.xml entry with:

	&lt;AndroidResource Include=&quot;Resources\Values\ApiKey-$(Configuration).xml&quot; /&gt;

This will make the API key a per-configuration value: build Debug, and you'll use the ApiKey-Debug.xml file (and thus Debug key), build Release and you'll use the ApiKey-Release.xml file (and thus Release key). This has the added benefit that your layout XML can &quot;just&quot; use @string/google_maps_api_key, removing the need to have per-profile Layout files.

 - Jon

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013198.html">[mono-android] Google maps with MfA need for api key and getting lat and long
</A></li>
	<LI>Next message: <A HREF="013184.html">[mono-android] Google maps with MfA need for api key and getting lat and long
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13182">[ date ]</a>
              <a href="thread.html#13182">[ thread ]</a>
              <a href="subject.html#13182">[ subject ]</a>
              <a href="author.html#13182">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
