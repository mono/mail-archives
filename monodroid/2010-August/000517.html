<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodroid] Obfuscating the DLL inside the APK
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Obfuscating%20the%20DLL%20inside%20the%20APK&In-Reply-To=1282744827.22005.17.camel%40lina.magi">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000520.html">
   <LINK REL="Next"  HREF="000467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodroid] Obfuscating the DLL inside the APK</H1>
    <B>Amir (GMail)</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Obfuscating%20the%20DLL%20inside%20the%20APK&In-Reply-To=1282744827.22005.17.camel%40lina.magi"
       TITLE="[Monodroid] Obfuscating the DLL inside the APK">amirw2k at gmail.com
       </A><BR>
    <I>Wed Aug 25 19:58:35 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000520.html">[Monodroid] Obfuscating the DLL inside the APK
</A></li>
        <LI>Next message: <A HREF="000467.html">[Monodroid] Obfuscating the DLL inside the APK
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#517">[ date ]</a>
              <a href="thread.html#517">[ thread ]</a>
              <a href="subject.html#517">[ subject ]</a>
              <a href="author.html#517">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jonathan,

1. Integrating post-build steps and maybe even pre-build steps would be good enough to work with most obfuscators. 

2. I don't have any experience with obfuscating Mono assemblies. I understand this may be the biggest problem here... I will run some tests soon to verify that.

3. First, I would feel much more comfortable if the assembly's name was not 'Assembly.DLL' which implies the existence of a .NET file. I would also be happier if the Mono DLLs were not so obvious, but that's a different story. Second, I was referring to some sort of an optional launcher that would decrypt files before loading on Android (I realize it may slow down the process), and of course I could do it myself for every project, but it would be nice to have built-in. 

I know that for some people these extra steps are useless, but for certain markets or sensitive data it actually can be helpful.

Thanks,
Amir

-----Original Message-----
From: Jonathan Pryor [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">jpryor at novell.com</A>] 
Sent: Wednesday, August 25, 2010 5:00 PM
To: Amir (GMail)
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
Subject: Re: [Monodroid] Obfuscating the DLL inside the APK

On Wed, 2010-08-25 at 11:55 +0300, Amir (GMail) wrote:
&gt;<i> 1. Is there an easy way to have an obfuscator handle this file before
</I>&gt;<i> it's packed?
</I>
At present, not that I know of, but once we get Library support I'd
expect it to be possible to use Library + post-build steps + referencing
assemblies by-filename (instead of by-project) to work.  (Completely
untested, of course, but that sort of process *sounds* sane...)

&gt;<i> 2. Do you have an idea if an obfuscated DLL would work on Android? (I
</I>&gt;<i> will run some tests myself soon).
</I>
Maybe.  The problem isn't Android, the problem is Mono, and there are
*tons* of bugs filed against Mono where some obfuscated assembly isn't
supported (often because they violate ECMA spec constraints and just
happen to produce IL that .NET executes).  So it might work, it might
not work, you'll have to test.

&gt;<i> 3. If possible, allow the DLL to be encrypted or password protected.
</I>&gt;<i> Currently it's too easy to fetch.
</I>
I don't understand how this would even work.  In order for MonoDroid to
load your app, it needs an assembly to execute.  This assembly obviously
can't be encrypted, because if it were Mono couldn't execute it.
There's a bit of a bootstrap issue here. ;-)

However, if you split your program into multiple assemblies, you could
encrypt one of your assemblies.  Mono would load your unencrypted
assembly to get the app running, and your unencrypted assembly would 
unencrypt the encrypted assembly at runtime and load it via e.g.
System.Reflection.Assembly.Load(byte[]).

This is workable, but I don't know what the performance implications are
(you're obviously going to be slowing down any operation requiring the
encrypted assembly, and the emulator is slow enough as it is!).  I'm
also not convinced that it's a worthwhile use of time -- every spiffy
encryption technology seems to get bypassed eventually (XBox?  PSP?  You
*know* these guys care about copy protection, yet they're still broken).

A likely better use of time is to move everything you want to protect
server-side and interact with it via WebServices/REST/etc.  Then it's
simply not possible to copy the &quot;important&quot; stuff, as it's not local.
(This obviously isn't always applicable, but what advice is?)

 - Jon

 

__________ Information from ESET NOD32 Antivirus, version of virus signature database 5396 (20100825) __________

The message was checked by ESET NOD32 Antivirus.

<A HREF="http://www.eset.com">http://www.eset.com</A>
 

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000520.html">[Monodroid] Obfuscating the DLL inside the APK
</A></li>
	<LI>Next message: <A HREF="000467.html">[Monodroid] Obfuscating the DLL inside the APK
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#517">[ date ]</a>
              <a href="thread.html#517">[ thread ]</a>
              <a href="subject.html#517">[ subject ]</a>
              <a href="author.html#517">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
