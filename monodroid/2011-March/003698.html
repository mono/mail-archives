<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] monodroid-samples/ApiDemo exception at start-up
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20monodroid-samples/ApiDemo%20exception%20at%20start-up&In-Reply-To=AANLkTinDLKixqpe7WdUXzLvYpfGUcavoqb1JwDoh-Pu-%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003694.html">
   <LINK REL="Next"  HREF="003692.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] monodroid-samples/ApiDemo exception at start-up</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20monodroid-samples/ApiDemo%20exception%20at%20start-up&In-Reply-To=AANLkTinDLKixqpe7WdUXzLvYpfGUcavoqb1JwDoh-Pu-%40mail.gmail.com"
       TITLE="[mono-android] monodroid-samples/ApiDemo exception at start-up">jpryor at novell.com
       </A><BR>
    <I>Tue Mar 15 20:48:27 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003694.html">[mono-android] monodroid-samples/ApiDemo exception at start-up
</A></li>
        <LI>Next message: <A HREF="003692.html">[mono-android] Initializing depth buffer for OpenGL 2.0 ES in	MonoDroid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3698">[ date ]</a>
              <a href="thread.html#3698">[ thread ]</a>
              <a href="subject.html#3698">[ subject ]</a>
              <a href="author.html#3698">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 15, 2011, at 6:01 PM, Len Charest wrote:
&gt;<i> Thanks for your feedback, Jon. I've attached the relevant part of the log.
</I>
Thank you. The actual error is [0]. There is a reference table overflow, which is why everything goes south.

I suspect that you have the Android API Demo sample installed on your emulator. Please remove it.

(A reference table overflow occurs when native code -- including and especially mono code -- generates too many live references to Dalvik-VM allocated objects. On hardware such as the N1, the reference table will hold ~52000 elements, while the emulator holds 512, as is seen in [0]. At the moment, the only real way to avoid this error is to not have so many live references, and the problem with ApiDemo is the
ApiDemo.GetData() method, which loads _every_ Activity with an action of &quot;main&quot; and a category of &quot;sample code&quot; -- 217 in the Android API demo + 24 in the MonoDroid API Demo -- then performs a LINQ OrderBy query on them [1], which pulls in a reference for the ActivityInfo object and the Java.Lang.String that the ActivityInfo references...  When you start with 241 activities and grab something from each one, it doesn't take much to overflow the emulator's local reference table of 512 entries...)

 - Jon

[0] W/dalvikvm(  662): ReferenceTable overflow (max=512)
W/dalvikvm(  662): Last 10 entries in JNI local reference table:
...
E/dalvikvm(  662): VM aborting

[1]  list = list.OrderBy (p =&gt; (p.ActivityInfo.NonLocalizedLabel == null ? &quot;&quot; : p.ActivityInfo.NonLocalizedLabel.ToString ()).ToString ()).ToList ();

</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003694.html">[mono-android] monodroid-samples/ApiDemo exception at start-up
</A></li>
	<LI>Next message: <A HREF="003692.html">[mono-android] Initializing depth buffer for OpenGL 2.0 ES in	MonoDroid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3698">[ date ]</a>
              <a href="thread.html#3698">[ thread ]</a>
              <a href="subject.html#3698">[ subject ]</a>
              <a href="author.html#3698">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
