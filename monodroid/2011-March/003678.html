<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Preview 14 - Can't deploy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Preview%2014%20-%20Can%27t%20deploy&In-Reply-To=OF4C4C6C3E.A63399BA-ONC1257854.0046A02D-C1257854.004801EC%40cs-ag.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003677.html">
   <LINK REL="Next"  HREF="003683.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Preview 14 - Can't deploy</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Preview%2014%20-%20Can%27t%20deploy&In-Reply-To=OF4C4C6C3E.A63399BA-ONC1257854.0046A02D-C1257854.004801EC%40cs-ag.de"
       TITLE="[mono-android] Preview 14 - Can't deploy">jpryor at novell.com
       </A><BR>
    <I>Tue Mar 15 09:52:11 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003677.html">[mono-android] Preview 14 - Can't deploy
</A></li>
        <LI>Next message: <A HREF="003683.html">[mono-android] Antwort: Re:  Preview 14 - Can't deploy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3678">[ date ]</a>
              <a href="thread.html#3678">[ thread ]</a>
              <a href="subject.html#3678">[ subject ]</a>
              <a href="author.html#3678">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 15, 2011, at 9:06 AM, <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">SebastianKellner at cs-ag.de</A> wrote:
&gt;<i> since I use Preview 14 of Monodroid, I can't deploy to my emulator anymore.
</I>
Which API level?

How much free space do you have on your internal storage (i.e. is it full)?

Do you have an SD card specified for your device? Does it have any free space?

In Preview 14, we changed the default install location for packages [0] from &quot;internalOnly&quot; (the default if the android:installLocation isn't specified at all, which was previously the case) to &quot;preferExternal.&quot; It's _plausible_ that if your emulator doesn't have an SD card [1], then Android would generate the INSTALL_FAILED_MEDIA_UNAVAILABLE error.

A cursory grepping of Android suggests that DefaultContainerService.java is the controlling factory, specifically DefaultContainerService.recommendAppInstallLocation() [2], and that if you're out of internal space and the package specifies preferExternal (as we do) and the SD card is unavailable (status.equals(Environment.MEDIA_MOUNTED) is false), then RECOMMEND_MEDIA_UNAVAILABLE is returned, which is translated into INSTALL_FAILED_MEDIA_UNAVAILABLE. This still seems odd to me (wouldn't RECOMMEND_FAILED_INSUFFICIENT_STORAGE make more sense?), but this _appears_ to be what's happening to you.

 - Jon

[0] <A HREF="http://developer.android.com/guide/topics/manifest/manifest-element.html#install">http://developer.android.com/guide/topics/manifest/manifest-element.html#install</A>

[1] Within the `android` app, go to Virtual devices, select a device, click Edit, and look at the SD Card section.

[2] <A HREF="http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob;f=packages/DefaultContainerService/src/com/android/defcontainer/DefaultContainerService.java;h=ce10f5b71d4582632a2f37bf2d89b08539d1d5c7;hb=HEAD#l386">http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob;f=packages/DefaultContainerService/src/com/android/defcontainer/DefaultContainerService.java;h=ce10f5b71d4582632a2f37bf2d89b08539d1d5c7;hb=HEAD#l386</A>

</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003677.html">[mono-android] Preview 14 - Can't deploy
</A></li>
	<LI>Next message: <A HREF="003683.html">[mono-android] Antwort: Re:  Preview 14 - Can't deploy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3678">[ date ]</a>
              <a href="thread.html#3678">[ thread ]</a>
              <a href="subject.html#3678">[ subject ]</a>
              <a href="author.html#3678">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
