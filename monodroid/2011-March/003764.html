<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] DrawLine problem with Paint.StrokeWidth = 1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20DrawLine%20problem%20with%20Paint.StrokeWidth%20%3D%201&In-Reply-To=E06BEDAA-9A9F-4C70-A667-C4EC7E896B0F%40novell.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003752.html">
   <LINK REL="Next"  HREF="003765.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] DrawLine problem with Paint.StrokeWidth = 1</H1>
    <B>Narc&#237;s Calvet</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20DrawLine%20problem%20with%20Paint.StrokeWidth%20%3D%201&In-Reply-To=E06BEDAA-9A9F-4C70-A667-C4EC7E896B0F%40novell.com"
       TITLE="[mono-android] DrawLine problem with Paint.StrokeWidth = 1">narcis at steema.com
       </A><BR>
    <I>Fri Mar 18 10:45:44 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003752.html">[mono-android] DrawLine problem with Paint.StrokeWidth = 1
</A></li>
        <LI>Next message: <A HREF="003765.html">[mono-android] DrawLine problem with Paint.StrokeWidth = 1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3764">[ date ]</a>
              <a href="thread.html#3764">[ thread ]</a>
              <a href="subject.html#3764">[ subject ]</a>
              <a href="author.html#3764">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jon,

-----Original Message-----
From: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] On Behalf Of Jonathan Pryor
Sent: dijous, 17 / mar&#231; / 2011 19:37
To: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid at lists.ximian.com</A>
Subject: Re: [mono-android] DrawLine problem with Paint.StrokeWidth = 1

&gt;<i>It works as you'd expect, while the C# code you provided does not, as you
</I>previously mentioned.

Great, thanks for investigating this issue.


&gt;<i>When I added the above element to the Java AndroidManifest.xml, the result
</I>is twofold:
 1. The Java app now renders lines which are the same size, on screen, as
the C# code.
 2. The Java app is ALSO missing the same lines.

So this would indicate this is a general Android problem, not a Monodroid
problem.


&gt;<i>The &quot;fix&quot; for your C# code is to edit Properties\AndroidManifest.xml
</I>(and/or create one if necessary), and add the following XML fragment within
the &lt;manifest/&gt; element:

    &lt;uses-sdk /&gt;

Yes, this worked fine but I don't think it's a good solution for us. I had
to modify the manifest in the demo project which uses the component we are
developing and which suffers from this problem. This means most users would
think our component is buggy and we should have to explain that to those
which give it a second chance. Moreover, I'm afraid this is a more complex
problem. I did some changes in the OnDraw method in the example I sent
yesterday:

    protected override void OnDraw(Canvas canvas)
    {
      base.OnDraw(canvas);

      Paint pen = new Paint();
      pen.Color = Color.Red;
      pen.StrokeWidth = 1;
      pen.SetStyle(Paint.Style.Stroke);

      Display disp =
this.Context.GetSystemService(Android.Content.Context.WindowService).JavaCas
t&lt;Android.Views.IWindowManager&gt;().DefaultDisplay;

      for (int x = 10; x &lt; disp.Width; x=x+10)
      {
        canvas.DrawLine(x, 0, x, disp.Height, pen);
      }

      for (int y = 10; y &lt; disp.Height; y=y+10)
      {
        canvas.DrawLine(0, y, disp.Width, y, pen);
      }      
    }

Some screenshots are available at <A HREF="http://bit.ly/hqXjEe.">http://bit.ly/hqXjEe.</A> You'll see the
output is substantially different using the default manifest
(TestAppDefaultManifest.png) or modifying it (TestAppModifiedManifest.png):
1. The second image draws thicker lines.
2. The second image draws less lines than the first image and than it
should. I think the number of lines is correct in the first image.

This is even worse in the charting component we are developping for
Monodroid. See FastLineDefaultManifest.png and FastLineModifiedManifest.png.
In the first image you'll notice one segment in the line series is not
painted, text in the legend is slightly overlapping and close to do so in
the left axis. In the second image you'll see series segments are plotted
correctly and text plots much better but some axes grid lines are thicker
than others.

Having seen that, how do you think we should proceed? If it is the case that
this is an Android issue perhaps it should be reported directly to Android's
developers. Do you know which channel should be used for that purpose?


&gt;<i>This prevents mandroid.exe from adding the android:minSdkVersion and
</I>android:targetSdkVersion attributes, thus generating an AndroidManifest.xml
which is closer to the &quot;original&quot; Java, and an app which shows all the lines
(as desired).

Would it be possible for mandroid.exe to not generate those attributes by
default?


&gt;<i>Another working solution is to use a SrokeWidth of 0 instead of 1, which
</I>also shows all 5 lines.

Considering Steema Software shares the same .NET code base for different
assemblies I don't think this would be a very good solution either but
probably the only one we have for now.


Thanks in advance.


Best Regards,
 
Narc&#237;s Calvet
Steema Software
<A HREF="http://www.steema.com">http://www.steema.com</A>  
<A HREF="http://twitter.com/SteemaSoftware">http://twitter.com/SteemaSoftware</A>   
<A HREF="https://www.facebook.com/SteemaSoftware">https://www.facebook.com/SteemaSoftware</A> 



</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003752.html">[mono-android] DrawLine problem with Paint.StrokeWidth = 1
</A></li>
	<LI>Next message: <A HREF="003765.html">[mono-android] DrawLine problem with Paint.StrokeWidth = 1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3764">[ date ]</a>
              <a href="thread.html#3764">[ thread ]</a>
              <a href="subject.html#3764">[ subject ]</a>
              <a href="author.html#3764">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
