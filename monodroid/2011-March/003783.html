<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] [Monodroid] switching views (again)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20%5BMonodroid%5D%20switching%20views%20%28again%29&In-Reply-To=002201cbe638%2456898040%24039c80c0%24%40gb.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003779.html">
   <LINK REL="Next"  HREF="003787.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] [Monodroid] switching views (again)</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20%5BMonodroid%5D%20switching%20views%20%28again%29&In-Reply-To=002201cbe638%2456898040%24039c80c0%24%40gb.com"
       TITLE="[mono-android] [Monodroid] switching views (again)">jpryor at novell.com
       </A><BR>
    <I>Sat Mar 19 12:08:08 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003779.html">[mono-android] [Monodroid] switching views (again)
</A></li>
        <LI>Next message: <A HREF="003787.html">[mono-android] Googlemap sample and Java -&gt; MDr interop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3783">[ date ]</a>
              <a href="thread.html#3783">[ thread ]</a>
              <a href="subject.html#3783">[ subject ]</a>
              <a href="author.html#3783">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 19, 2011, at 9:19 AM, John Murray wrote:
&gt;<i> But I just don&#8217;t understand why one cannot do this
</I>&gt;<i>  
</I>&gt;<i> [Activity(Label = &quot;monodlgtest1&quot;, MainLauncher = true)]
</I>&gt;<i>     public class Activity1 : Activity
</I>&gt;<i>     {
</I>&gt;<i>         int count = 1;
</I>&gt;<i>         protected override void OnCreate(Bundle bundle)
</I>&gt;<i>         {
</I>&gt;<i>             base.OnCreate(bundle);
</I>&gt;<i>             Button button = FindViewById&lt;Button&gt;(Resource.Id.MyButton);
</I>&gt;<i>             button.Click += delegate { bclick();}
</I>&gt;<i>             Button buttonback = FindViewById&lt;Button&gt;(Resource.Id.goBack);
</I>&gt;<i>             buttonback.Click += delegate { bclick2(); };
</I>&gt;<i>             SetContentView(Resource.Layout.Main);
</I>&gt;<i>         }
</I>
Problem #1, which is causing you the most grief at the moment: there is no View until you call SetContentView(). Consequently, you _cannot_ call FindViewById&lt;T&gt;() until _after_ SetContentView() is called. Thus, what you _really_ want is this:

&gt;<i>             base.OnCreate(bundle);
</I>&gt;<i>             SetContentView(Resource.Layout.Main);
</I>&gt;<i>             Button button = FindViewById&lt;Button&gt;(Resource.Id.MyButton);
</I>&gt;<i>             button.Click += delegate { bclick();}
</I>&gt;<i>             Button buttonback = FindViewById&lt;Button&gt;(Resource.Id.goBack);
</I>&gt;<i>             buttonback.Click += delegate { bclick2(); };
</I>

That said, you didn't provide the source to bclick() and bclick2(). I assume that each of them uses SetContentView() to set the view. This _should_ work, but remember: when you call SetContentView(), you're loading a _new_ object graph, and thus the buttons are no longer configured for the newly loaded view. Consequently, you need to set them back up again:

	void ConfigureButtons()
	{
		FindViewById&lt;Button&gt;(Resource.Id.MyButton).Click += delegate { bclick(); };
		FindViewById&lt;Button&gt;(Resource.Id.goBack).Click += delegate {bclick2(); };
	}

	protected override void OnCreate (Bundle b)
	{
		base.OnCreate(b);
		SetContentView(Resource.Layout.Main);
		ConfigureButtons();
	}

	void bclick()
	{
		SetContentView (Resource.Layout.ButtonOneClicked);
		ConfigureButtons();
		// ...
	}

	void bclick2()
	{
		SetContentView (Resource.Layout.ButtonTwoClicked);
		ConfigureButtons();
		// ...
	}

Note: I have not tested the above, it just seems plausible.

I would still suggest using Activities over what I outlined above.

&gt;<i> I have read through the fundamentals but being a beginner here it doesn&#8217;t always make sense to me
</I>&gt;<i> Can someone explain
</I>&gt;<i> a)      Why the above code doesn&#8217;t work
</I>
SetContentView() was called too late, as described above.

&gt;<i> b)      How one creates matching activities to each view (I presume that would solve the problem)
</I>
I would start with the mindset that an &quot;activity&quot; ISA &quot;view,&quot; instead of playing the &quot;let's call SetContentView() multiple times!&quot; game (shown above). Instead, you'd use StartActivity() to navigate to a new view, and when the user clicks the Back button they'll naturally return to the previously running Activity (it's a stack), or call Activity.Finish() (which removes the current Activity from the stack). Thus, there is no need for buttons to take you to the next &amp; previous screens, just the need for a button to take you to the next.

For an example, there's the GoogleMaps sample:

	<A HREF="https://github.com/mono/monodroid-samples/tree/master/GoogleMaps">https://github.com/mono/monodroid-samples/tree/master/GoogleMaps</A>

In which StartActivity() is used to launch a (Java-based in GoogleMaps) activity, but the basic idea is the same: clicking a button launches a new activity, which shows a new screen to the user. When the user clicks the Back button, they'll return to the initial screen:

	<A HREF="https://github.com/mono/monodroid-samples/blob/master/GoogleMaps/Activity1.cs#L26">https://github.com/mono/monodroid-samples/blob/master/GoogleMaps/Activity1.cs#L26</A>

Another example is the VoiceRecognition API Demo, which launches a new activity to invoke the voice recognizer:

	<A HREF="https://github.com/mono/monodroid-samples/blob/master/ApiDemo/App/VoiceRecognition.cs#L79">https://github.com/mono/monodroid-samples/blob/master/ApiDemo/App/VoiceRecognition.cs#L79</A>

&gt;<i> c)       Is there a better way of creating a modal data entry dialog
</I>
Once you embrace the mult-activity view, the real concern becomes sharing the model (data) between the various activities. This can be done by stuffing the model into a global (static) variable &quot;somewhere&quot;, or using the Application object (similarly global), using Intent.Extras (in theory; I haven't tested to see if there are any limitations here), etc.

 - Jon

</PRE>

































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003779.html">[mono-android] [Monodroid] switching views (again)
</A></li>
	<LI>Next message: <A HREF="003787.html">[mono-android] Googlemap sample and Java -&gt; MDr interop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3783">[ date ]</a>
              <a href="thread.html#3783">[ thread ]</a>
              <a href="subject.html#3783">[ subject ]</a>
              <a href="author.html#3783">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
