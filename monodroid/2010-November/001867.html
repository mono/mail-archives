<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodroid] NumberKeyListener.Filter is crashing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20NumberKeyListener.Filter%20is%20crashing&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001865.html">
   <LINK REL="Next"  HREF="001868.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodroid] NumberKeyListener.Filter is crashing</H1>
    <B>Michal Sartoris</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20NumberKeyListener.Filter%20is%20crashing&In-Reply-To="
       TITLE="[Monodroid] NumberKeyListener.Filter is crashing">miso at resco.net
       </A><BR>
    <I>Fri Nov 26 12:27:33 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="001865.html">[Monodroid] Application crash on Preview 8.1
</A></li>
        <LI>Next message: <A HREF="001868.html">[Monodroid] external databases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1867">[ date ]</a>
              <a href="thread.html#1867">[ thread ]</a>
              <a href="subject.html#1867">[ subject ]</a>
              <a href="author.html#1867">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,



I want to write my own key listener fro EditText. I derived it from NumberKeyListener (like DigitsKeyListener is doing), but calling base.Filter from my Filter method is crashing with java.lang.Exception: System.Exception: Unexpected char sequence type. It is crashing only when I press accepted characters. For other charatcers, it is working.



Sample source code:



namespace NumericInput

{

       [Activity(Label = &quot;NumericInput&quot;, MainLauncher = true)]

       public class Activity1 : Activity

       {

             private class NumericKeyListener : NumberKeyListener

             {

                    private static char[] Characters = new char[] { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '-', '.' };

                    public NumericKeyListener()

                    {

                    }



                    protected override char[] GetAcceptedChars()

                    {

                           return NumericKeyListener.Characters;

                    }



                    public override int InputType

                    {

                           get

                           {

                                  return (int)(InputTypes.ClassNumber | InputTypes.NumberFlagDecimal | InputTypes.NumberFlagSigned);

                           }

                    }



                    public override System.Collections.Generic.IEnumerable&lt;char&gt; Filter(System.Collections.Generic.IEnumerable&lt;char&gt; source, int start, int end, Android.Text.ISpanned dest, int dstart, int dend)

                    {

                           return base.Filter(source, start, end, dest, dstart, dend);

                    }

             }



             protected override void OnCreate(Bundle bundle)

             {

                    base.OnCreate(bundle);

                    SetContentView(Resource.layout.main);



                    EditText button = FindViewById&lt;EditText&gt;(Resource.id.edittext);

                    button.KeyListener = new NumericKeyListener();

             }

       }

}



Tested on P7 and P8.1.



Best regards,



Ing. Michal Sartoris

Resco.net&lt;<A HREF="http://resco.net/">http://resco.net/</A>&gt;



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/mailman/private/monodroid/attachments/20101126/3a8076be/attachment.html">http://lists.ximian.com/mailman/private/monodroid/attachments/20101126/3a8076be/attachment.html</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001865.html">[Monodroid] Application crash on Preview 8.1
</A></li>
	<LI>Next message: <A HREF="001868.html">[Monodroid] external databases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1867">[ date ]</a>
              <a href="thread.html#1867">[ thread ]</a>
              <a href="subject.html#1867">[ subject ]</a>
              <a href="author.html#1867">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
