<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodroid] Custom ArrayAdapter
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Custom%20ArrayAdapter&In-Reply-To=AANLkTimYU_F5tv5d-V46cMQS8MVNK3ETe4_DVc9s0UvZ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001517.html">
   <LINK REL="Next"  HREF="001510.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodroid] Custom ArrayAdapter</H1>
    <B>Jon Dick</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5BMonodroid%5D%20Custom%20ArrayAdapter&In-Reply-To=AANLkTimYU_F5tv5d-V46cMQS8MVNK3ETe4_DVc9s0UvZ%40mail.gmail.com"
       TITLE="[Monodroid] Custom ArrayAdapter">jondick at gmail.com
       </A><BR>
    <I>Mon Nov  1 16:43:59 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="001517.html">[Monodroid] Digg Service
</A></li>
        <LI>Next message: <A HREF="001510.html">[Monodroid] WCF Services (Soap and Rest/OData)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1509">[ date ]</a>
              <a href="thread.html#1509">[ thread ]</a>
              <a href="subject.html#1509">[ subject ]</a>
              <a href="author.html#1509">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Shameless plug, yet relevant:

<A HREF="http://redth.info/2010/10/12/monodroid-custom-listadapter-for-your-listview/">http://redth.info/2010/10/12/monodroid-custom-listadapter-for-your-listview/</A>
&lt;<A HREF="http://redth.info/2010/10/12/monodroid-custom-listadapter-for-your-listview/">http://redth.info/2010/10/12/monodroid-custom-listadapter-for-your-listview/</A>&gt;
---
Jon (aka Redth)



On Sun, Oct 31, 2010 at 2:00 PM, Dan Russell &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">danomania at gmail.com</A>&gt; wrote:

&gt;<i> Dean,
</I>&gt;<i>
</I>&gt;<i> Here is your problem:
</I>&gt;<i>
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime: FATAL EXCEPTION: main
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:
</I>&gt;<i> java.lang.IllegalStateException: ArrayAdapter requires the resource ID to be
</I>&gt;<i> a TextView
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:347)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.ArrayAdapter.getView(ArrayAdapter.java:323)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.AbsListView.obtainView(AbsListView.java:1338)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.ListView.measureHeightOfChildren(ListView.java:1256)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.ListView.onMeasure(ListView.java:1167)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.View.measure(View.java:8173)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1012)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.LinearLayout.measureHorizontal(LinearLayout.java:696)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.LinearLayout.onMeasure(LinearLayout.java:306)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.View.measure(View.java:8173)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.FrameLayout.onMeasure(FrameLayout.java:245)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.View.measure(View.java:8173)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.LinearLayout.measureVertical(LinearLayout.java:526)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.LinearLayout.onMeasure(LinearLayout.java:304)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.View.measure(View.java:8173)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.FrameLayout.onMeasure(FrameLayout.java:245)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.View.measure(View.java:8173)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.ViewRoot.performTraversals(ViewRoot.java:810)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.view.ViewRoot.handleMessage(ViewRoot.java:1736)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.os.Handler.dispatchMessage(Handler.java:99)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.os.Looper.loop(Looper.java:143)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.app.ActivityThread.main(ActivityThread.java:4701)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> java.lang.reflect.Method.invokeNative(Native Method)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> java.lang.reflect.Method.invoke(Method.java:521)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> dalvik.system.NativeStart.main(Native Method)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime: Caused by:
</I>&gt;<i> java.lang.ClassCastException: android.widget.LinearLayout
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     at
</I>&gt;<i> android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:340)
</I>&gt;<i> 10-31 17:22:13.368   313   313 E AndroidRuntime:     ... 29 more
</I>&gt;<i>
</I>&gt;<i> You can view the call stack by inspecting the &quot;Android Device Logging&quot;
</I>&gt;<i> view. From the main menu, select View -&gt; Other Windows -&gt; Android Device
</I>&gt;<i> Logging.
</I>&gt;<i>
</I>&gt;<i> Unfortunately, the call stack shown is only partial because it is so long,
</I>&gt;<i> but it's a start.
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i> Dan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Sun, Oct 31, 2010 at 7:53 AM, Dean Ellis &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">dellis1972 at googlemail.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (I'm converting an android project over to monodroid, and I've been
</I>&gt;&gt;<i> trying to get a custom ArrayAdapter working with  a ListActivity on
</I>&gt;&gt;<i> Preview 6.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> when the this.ListAdapter is set the application crashes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Has anyone else tried to use a Custom ArrayAdapter?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Code and the layout files are below.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Dean
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> C# code
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ---------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> using System;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> using Android.App;
</I>&gt;&gt;<i> using Android.Content;
</I>&gt;&gt;<i> using Android.Runtime;
</I>&gt;&gt;<i> using Android.Views;
</I>&gt;&gt;<i> using Android.Widget;
</I>&gt;&gt;<i> using Android.OS;
</I>&gt;&gt;<i> using System.Collections.Generic;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> namespace CustomListActivity
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i>    [Activity(Label = &quot;My Activity&quot;, MainLauncher = true)]
</I>&gt;&gt;<i>    public class PeopleActivity : ListActivity
</I>&gt;&gt;<i>    {
</I>&gt;&gt;<i>        private List&lt;Person&gt; people = null;
</I>&gt;&gt;<i>        private PersonAdapter adapter = null;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        public PeopleActivity(IntPtr handle)
</I>&gt;&gt;<i>            : base(handle)
</I>&gt;&gt;<i>        {
</I>&gt;&gt;<i>        }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        protected override void OnCreate(Bundle bundle)
</I>&gt;&gt;<i>        {
</I>&gt;&gt;<i>            base.OnCreate(bundle);
</I>&gt;&gt;<i>            SetContentView(Resource.layout.main);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>            people = new List&lt;Person&gt;();
</I>&gt;&gt;<i>            people.Add(new Person()
</I>&gt;&gt;<i>            {
</I>&gt;&gt;<i>                Name = &quot;Person 1&quot;,
</I>&gt;&gt;<i>                Age = new DateTime(1980,01,10)
</I>&gt;&gt;<i>            }
</I>&gt;&gt;<i>            );
</I>&gt;&gt;<i>            people.Add(new Person()
</I>&gt;&gt;<i>            {
</I>&gt;&gt;<i>                Name = &quot;Person 2&quot;,
</I>&gt;&gt;<i>                Age = new DateTime(1982, 01, 10)
</I>&gt;&gt;<i>            }
</I>&gt;&gt;<i>            );
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>            adapter = new PersonAdapter(this, Resource.layout.row,
</I>&gt;&gt;<i> this.people);
</I>&gt;&gt;<i>            this.ListAdapter = adapter;
</I>&gt;&gt;<i>            //ListView lv = this.ListView;
</I>&gt;&gt;<i>            // set the click handler
</I>&gt;&gt;<i>            //lv.ItemClick += new
</I>&gt;&gt;<i> EventHandler&lt;ItemEventArgs&gt;(lv_ItemClick);
</I>&gt;&gt;<i>        }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        void lv_ItemClick(object sender, ItemEventArgs e)
</I>&gt;&gt;<i>        {
</I>&gt;&gt;<i>            Toast.MakeText(this, e.Position, ToastLength.Short);
</I>&gt;&gt;<i>        }
</I>&gt;&gt;<i>    }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    public class Person
</I>&gt;&gt;<i>    {
</I>&gt;&gt;<i>        public string Name { get; set; }
</I>&gt;&gt;<i>        public DateTime Age { get; set; }
</I>&gt;&gt;<i>    }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    public class PersonAdapter : ArrayAdapter&lt;Person&gt;
</I>&gt;&gt;<i>    {
</I>&gt;&gt;<i>        private IList&lt;Person&gt; items;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        public PersonAdapter(Context context, int textViewResourceId,
</I>&gt;&gt;<i> IList&lt;Person&gt; items):
</I>&gt;&gt;<i>            base(context, textViewResourceId, items)
</I>&gt;&gt;<i>        {
</I>&gt;&gt;<i>                this.items = items;
</I>&gt;&gt;<i>        }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        public override View GetView(int position, View convertView,
</I>&gt;&gt;<i> ViewGroup parent)
</I>&gt;&gt;<i>        {
</I>&gt;&gt;<i>            View v = convertView;
</I>&gt;&gt;<i>            if (v == null)
</I>&gt;&gt;<i>            {
</I>&gt;&gt;<i>                LayoutInflater va =
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (LayoutInflater)this.Context.GetSystemService(Context.LayoutInflaterService);
</I>&gt;&gt;<i>                v = va.Inflate(Resource.layout.row, null);
</I>&gt;&gt;<i>            }
</I>&gt;&gt;<i>            if (position &gt;= 0 &amp;&amp; position &lt;= items.Count - 1)
</I>&gt;&gt;<i>            {
</I>&gt;&gt;<i>                Person p = items[position];
</I>&gt;&gt;<i>                if (p != null)
</I>&gt;&gt;<i>                {
</I>&gt;&gt;<i>                    TextView name =
</I>&gt;&gt;<i> v.FindViewById&lt;TextView&gt;(Resource.id.toptext);
</I>&gt;&gt;<i>                    TextView age =
</I>&gt;&gt;<i> v.FindViewById&lt;TextView&gt;(Resource.id.bottomtext);
</I>&gt;&gt;<i>                    if (name != null)
</I>&gt;&gt;<i>                    {
</I>&gt;&gt;<i>                        name.Text = p.Name;
</I>&gt;&gt;<i>                    }
</I>&gt;&gt;<i>                    if (age != null)
</I>&gt;&gt;<i>                    {
</I>&gt;&gt;<i>                        age.Text = p.Age.ToShortDateString();
</I>&gt;&gt;<i>                    }
</I>&gt;&gt;<i>                }
</I>&gt;&gt;<i>            }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>            return v;
</I>&gt;&gt;<i>        }
</I>&gt;&gt;<i>    }
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> main.xml
</I>&gt;&gt;<i> -----------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</I>&gt;&gt;<i> &lt;LinearLayout
</I>&gt;&gt;<i>  xmlns:android=&quot;<A HREF="http://schemas.android.com/apk/res/android&quot;">http://schemas.android.com/apk/res/android&quot;</A>
</I>&gt;&gt;<i>  android:layout_width=&quot;wrap_content&quot;
</I>&gt;&gt;<i>  android:layout_height=&quot;wrap_content&quot;&gt;
</I>&gt;&gt;<i>  &lt;ListView
</I>&gt;&gt;<i>        android:id=&quot;@+id/android:list&quot;
</I>&gt;&gt;<i>        android:layout_width=&quot;fill_parent&quot;
</I>&gt;&gt;<i>        android:layout_height=&quot;fill_parent&quot;
</I>&gt;&gt;<i>    /&gt;
</I>&gt;&gt;<i>  &lt;TextView
</I>&gt;&gt;<i>  android:id=&quot;@+id/android:empty&quot;
</I>&gt;&gt;<i>  android:layout_width=&quot;fill_parent&quot;
</I>&gt;&gt;<i>  android:layout_height=&quot;fill_parent&quot;
</I>&gt;&gt;<i>  android:text=&quot;No Items Found&quot;/&gt;
</I>&gt;&gt;<i> &lt;/LinearLayout&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> row.xml
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</I>&gt;&gt;<i> &lt;LinearLayout xmlns:android=&quot;<A HREF="http://schemas.android.com/apk/res/android&quot;">http://schemas.android.com/apk/res/android&quot;</A>
</I>&gt;&gt;<i>    android:layout_width=&quot;fill_parent&quot;
</I>&gt;&gt;<i>    android:layout_height=&quot;?android:attr/listPreferredItemHeight&quot;
</I>&gt;&gt;<i>    android:padding=&quot;6dip&quot;&gt;
</I>&gt;&gt;<i>  &lt;LinearLayout
</I>&gt;&gt;<i>      android:orientation=&quot;vertical&quot;
</I>&gt;&gt;<i>      android:layout_width=&quot;0dip&quot;
</I>&gt;&gt;<i>      android:layout_weight=&quot;1&quot;
</I>&gt;&gt;<i>      android:layout_height=&quot;fill_parent&quot;&gt;
</I>&gt;&gt;<i>    &lt;TextView
</I>&gt;&gt;<i>        android:id=&quot;@+id/toptext&quot;
</I>&gt;&gt;<i>        android:layout_width=&quot;fill_parent&quot;
</I>&gt;&gt;<i>        android:layout_height=&quot;0dip&quot;
</I>&gt;&gt;<i>        android:layout_weight=&quot;1&quot;
</I>&gt;&gt;<i>        android:gravity=&quot;center_vertical&quot;
</I>&gt;&gt;<i>        /&gt;
</I>&gt;&gt;<i>    &lt;TextView
</I>&gt;&gt;<i>        android:layout_width=&quot;fill_parent&quot;
</I>&gt;&gt;<i>        android:layout_height=&quot;0dip&quot;
</I>&gt;&gt;<i>        android:layout_weight=&quot;1&quot;
</I>&gt;&gt;<i>        android:id=&quot;@+id/bottomtext&quot;
</I>&gt;&gt;<i>        android:singleLine=&quot;true&quot;
</I>&gt;&gt;<i>        android:ellipsize=&quot;marquee&quot;
</I>&gt;&gt;<i>        /&gt;
</I>&gt;&gt;<i>  &lt;/LinearLayout&gt;
</I>&gt;&gt;<i> &lt;/LinearLayout&gt;
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Monodroid mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/mailman/private/monodroid/attachments/20101101/f48ef4d9/attachment-0001.html">http://lists.ximian.com/mailman/private/monodroid/attachments/20101101/f48ef4d9/attachment-0001.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001517.html">[Monodroid] Digg Service
</A></li>
	<LI>Next message: <A HREF="001510.html">[Monodroid] WCF Services (Soap and Rest/OData)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1509">[ date ]</a>
              <a href="thread.html#1509">[ thread ]</a>
              <a href="subject.html#1509">[ subject ]</a>
              <a href="author.html#1509">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
