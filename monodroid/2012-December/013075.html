<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Turning display on and off
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Turning%20display%20on%20and%20off&In-Reply-To=%3C1355389310941-5712611.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013073.html">
   <LINK REL="Next"  HREF="013077.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Turning display on and off</H1>
    <B>Stephan Steiner</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Turning%20display%20on%20and%20off&In-Reply-To=%3C1355389310941-5712611.post%40n5.nabble.com%3E"
       TITLE="[mono-android] Turning display on and off">stephan.steiner at gmail.com
       </A><BR>
    <I>Thu Dec 13 09:01:51 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="013073.html">[mono-android] Weird sporadic errors...
</A></li>
        <LI>Next message: <A HREF="013077.html">[mono-android] Turning display on and off
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13075">[ date ]</a>
              <a href="thread.html#13075">[ thread ]</a>
              <a href="subject.html#13075">[ subject ]</a>
              <a href="author.html#13075">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

My app does telephony - so I need to turn on and off the display when the
proximity sensor detects that the phone is close to the user's face (and
with the screen off the device shouldn't react to the ear touching the
display). I got the proximity sensor bit down but having major issues
getting anything to work with regards to turning the screen on/off.

First off, PowerManager.GoToSleep won't work due to security issues (even
though I gave my app the DEVICE_POWER permission)

Using

PowerManager manager = (PowerManager)GetSystemService(Context.PowerService);
            myWakeLock = manager.NewWakeLock(WakeLockFlags.Partial, tag);
myWakeLock.Acquire()

does nothing.

WindowManagerLayoutParams layoutParams = Window.Attributes;
oldBrightness = layoutParams.ScreenBrightness;
layoutParams.ScreenBrightness = 0f;
layoutParams.Flags |= WindowManagerFlags.KeepScreenOn;
Window.Attributes = layoutParams;

doesn't work either - 0 seems to be dimmed, but I need off (and disable all
touch input) if I set  I suppose because ScreenBrightNess doesn't appear to
be working (when the screen is on, brightness is still 0, even though if I
get the brightness from the system settings, it's 102 (I realize I need to
divide by 255 since for layout parameters the value is between 0 and 1).

int oldBrightNess = Android.Provider.Settings.System.GetInt(ContentResolver,
Android.Provider.Settings.System.ScreenBrightness);

Does anybody have any bright (well... I need blacked out and bright) ideas
on how to solve this one?

Regards
Stephan



--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/Turning-display-on-and-off-tp5712611.html">http://mono-for-android.1047100.n5.nabble.com/Turning-display-on-and-off-tp5712611.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013073.html">[mono-android] Weird sporadic errors...
</A></li>
	<LI>Next message: <A HREF="013077.html">[mono-android] Turning display on and off
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13075">[ date ]</a>
              <a href="thread.html#13075">[ thread ]</a>
              <a href="subject.html#13075">[ subject ]</a>
              <a href="author.html#13075">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
