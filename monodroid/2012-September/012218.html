<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Analog for Control.[Begin]Invoke
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Analog%20for%20Control.%5BBegin%5DInvoke&In-Reply-To=%3C1347212385758-5711744.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012217.html">
   <LINK REL="Next"  HREF="012219.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Analog for Control.[Begin]Invoke</H1>
    <B>Stephan Steiner</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Analog%20for%20Control.%5BBegin%5DInvoke&In-Reply-To=%3C1347212385758-5711744.post%40n5.nabble.com%3E"
       TITLE="[mono-android] Analog for Control.[Begin]Invoke">stephan.steiner at gmail.com
       </A><BR>
    <I>Sun Sep  9 17:39:45 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012217.html">[mono-android] Debugger Disconnecting, sometimes coupled with unhandled TPF exceptions
</A></li>
        <LI>Next message: <A HREF="012219.html">[mono-android] Analog for Control.[Begin]Invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12218">[ date ]</a>
              <a href="thread.html#12218">[ thread ]</a>
              <a href="subject.html#12218">[ subject ]</a>
              <a href="author.html#12218">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jon

Reading your post just made my day - I never quite understood why Android is
so extremely opposed to using non GUI classes for processing - every second
operation you make requires a view or an activity. This allows me to update
launch simple toasts, and do other stuff where I don't need to know which
Activity is currently active (if any at all) from my service without having
to go through all the complex constructs that I created (I bind to the
service from the Activities / Fragments that need it, then wire up a bunch
of event handlers, and unwire them if the Activity/Fragment gets paused
again - background processing will proceed in the service, but any and all
of the things that need to go on in the GUI get suspended as soon as the
service is unbound).

As it almost seems to good to be true, I cannot help but wonder - am I
risking anything using the approach you outlined?

Regards
Stephan


Jonathan Pryor-2 wrote
&gt;<i> 
</I>&gt;<i> On Feb 20, 2012, at 11:50 AM, Chris Tacke wrote:
</I>&gt;&gt;<i> I've moved to something a bit simpler that, from initial tests anyways,
</I>&gt;&gt;<i> appears to work.  Does this seem reasonable though (I think it assumes
</I>&gt;&gt;<i> that the UIInvoker class itself is created on the UI thread):
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>    public class UIInvoker : DisposableBase
</I>&gt;&gt;<i>    {
</I>&gt;&gt;<i>        private Activity m_activity = new Activity();
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>        public void Invoke(Delegate method)
</I>&gt;&gt;<i>        {
</I>&gt;&gt;<i>            m_activity.RunOnUiThread(delegate
</I>&gt;&gt;<i>            {
</I>&gt;&gt;<i>                method.DynamicInvoke(null);
</I>&gt;&gt;<i>            });
</I>&gt;&gt;<i>        }
</I>&gt;<i> 
</I>&gt;&gt;<i>I wouldn't suggest this solution, as this avoids a great deal of Activity
</I>initialization; you have a &quot;half-baked&quot; Activity instance. (For those
reading along at home, Activity.attach() is never invoked; Activity.attach()
is called in android.app.ActivityThread, which requires that you go through
the Context.startActivity() infrastructure, which `new Activity()` obviously
doesn't.)
&gt;<i> 
</I>&gt;<i> That said, it works...because Activity.runOnUiThread() doesn't use
</I>&gt;<i> Activity.mUiThread for anything except reference comparison, but I have no
</I>&gt;<i> idea how long that will be the case.
</I>&gt;<i> 
</I>&gt;<i> What I would instead suggest is:
</I>&gt;<i> 
</I>&gt;<i> 	public void Invoke(Delegate method)
</I>&gt;<i> 	{
</I>&gt;<i> 		using (var handler = new
</I>&gt;<i> Android.OS.Handler(Android.OS.Looper.MainLooper))
</I>&gt;<i> 			handler.Post(delegate {
</I>&gt;<i> 					method.DynamicInvoker(null);
</I>&gt;<i> 			});
</I>&gt;<i> 	}
</I>&gt;<i> 
</I>&gt;<i>  - Jon
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at .ximian</A>
</I>&gt;<i> 
</I>&gt;<i> UNSUBSCRIBE INFORMATION:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>&gt;<i> 
</I>



--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/how-to-access-an-activity-from-broadcast-receiver-tp5497414p5711744.html">http://mono-for-android.1047100.n5.nabble.com/how-to-access-an-activity-from-broadcast-receiver-tp5497414p5711744.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012217.html">[mono-android] Debugger Disconnecting, sometimes coupled with unhandled TPF exceptions
</A></li>
	<LI>Next message: <A HREF="012219.html">[mono-android] Analog for Control.[Begin]Invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12218">[ date ]</a>
              <a href="thread.html#12218">[ thread ]</a>
              <a href="subject.html#12218">[ subject ]</a>
              <a href="author.html#12218">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
