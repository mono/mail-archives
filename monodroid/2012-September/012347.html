<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Actionbar Tab - overlay issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Actionbar%20Tab%20-%20overlay%20issues&In-Reply-To=%3C1347992059003-5711868.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012358.html">
   <LINK REL="Next"  HREF="012350.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Actionbar Tab - overlay issues</H1>
    <B>Stephan Steiner</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Actionbar%20Tab%20-%20overlay%20issues&In-Reply-To=%3C1347992059003-5711868.post%40n5.nabble.com%3E"
       TITLE="[mono-android] Actionbar Tab - overlay issues">stephan.steiner at gmail.com
       </A><BR>
    <I>Tue Sep 18 18:14:19 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012358.html">[mono-android] JAR Bindings: Create properties
</A></li>
        <LI>Next message: <A HREF="012350.html">[mono-android] axml loading in vs2010
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12347">[ date ]</a>
              <a href="thread.html#12347">[ thread ]</a>
              <a href="subject.html#12347">[ subject ]</a>
              <a href="author.html#12347">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

I worked around this by forcing orientation (makes no sense to switch in my
project) but I'd still like to get to the bottom of this. My app has an
activity that uses a tab layout that I'm realizing using the actionbar tab
and two fragments.

Here's the fragment related code:

protected override void OnCreate(Bundle bundle)
        {
            base.OnCreate(bundle);
            createTabs();
        }

        private void createTabs()
        {
            ActionBar.NavigationMode = ActionBarNavigationMode.Tabs;
            ActionBar.Tab myTab = ActionBar.NewTab();
            myTab.SetText(Resource.String.dialer_tab);
            myTab.SetTabListener(this);
            myTab.SetTag(Constants.CALL_CREATION_FRAGMENT);
            //myTab.SetTag(Constants.DIALER_FRAGMENT);
            ActionBar.AddTab(myTab);

            myTab = ActionBar.NewTab();
            myTab.SetText(Resource.String.call_tab);
            myTab.SetTabListener(this);
            myTab.SetTag(Constants.CALLS_FRAGMENT);
            ActionBar.AddTab(myTab);
        }

        /// &lt;summary&gt;
        /// user selected the already existing tab
        /// &lt;/summary&gt;
        /// 
        /// 
        public void OnTabReselected(ActionBar.Tab tab, FragmentTransaction
ft)
        {
        }

        public void OnTabSelected(ActionBar.Tab tab, FragmentTransaction ft)
        {
            switch (tab.Tag.ToString())
            {
                case Constants.DIALER_FRAGMENT:
                    Fragment dialerFragment = tabFragments.FirstOrDefault(t
=&gt; t.GetType() == typeof(DialerFragment));
                    if (dialerFragment == null)
                    {
                        dialerFragment = DialerFragment.Instantiate(this,
(new DialerFragment()).Class.Name);
                        ft.Add(Android.Resource.Id.Content, dialerFragment,
typeof(DialerFragment).FullName);
                        tabFragments.Add(dialerFragment);
                    }
                    else
                        ft.Attach(dialerFragment);
                    break;
                case Constants.CALLS_FRAGMENT:
                    Fragment callsFragment = tabFragments.FirstOrDefault(t
=&gt; t.GetType() == typeof(CallsFragment));
                    if (callsFragment == null)
                    {
                        callsFragment = CallsFragment.Instantiate(this, (new
CallsFragment()).Class.Name);
                        ft.Add(Android.Resource.Id.Content, callsFragment,
typeof(CallsFragment).FullName);
                        tabFragments.Add(callsFragment);
                    }
                    else
                        ft.Attach(callsFragment);
                    break;
                case Constants.CALL_CREATION_FRAGMENT:
                    Fragment callCreationFragment =
tabFragments.FirstOrDefault(t =&gt; t.GetType() ==
typeof(CallCreationFragment));
                    if (callCreationFragment == null)
                    {
                        callCreationFragment =
CallCreationFragment.Instantiate(this, (new
CallCreationFragment()).Class.Name);
                        ft.Add(Android.Resource.Id.Content,
callCreationFragment, typeof(CallCreationFragment).FullName);
                        tabFragments.Add(callCreationFragment);
                    }
                    else
                        ft.Attach(callCreationFragment);
                    break;
            }
        }

        public void OnTabUnselected(ActionBar.Tab tab, FragmentTransaction
ft)
        {
            switch (tab.Tag.ToString())
            {
                case Constants.DIALER_FRAGMENT:
                    Fragment dialerFragment = tabFragments.FirstOrDefault(t
=&gt; t.GetType() == typeof(DialerFragment));
                    if (dialerFragment != null)
                        ft.Detach(dialerFragment);
                    break;
                case Constants.CALLS_FRAGMENT:
                    Fragment callsFragment = tabFragments.FirstOrDefault(t
=&gt; t.GetType() == typeof(CallsFragment));
                    if (callsFragment != null)
                        ft.Detach(callsFragment);
                    break;
                case Constants.CALL_CREATION_FRAGMENT:
                    Fragment callCreationFragment =
tabFragments.FirstOrDefault(t =&gt; t.GetType() ==
typeof(CallCreationFragment));
                    if (callCreationFragment != null)
                        ft.Detach(callCreationFragment);
                    break;
            }
        }

Switching between tabs works fine.

However, if I do this:

Enter the tab activity, change screen rotation by holding the device
differently, change screen rotation back to portrait, then select the calls
tab, the contents of the dialer tab remains visible and the contents of the
calls tab is being put on top. Switching between tabs in this state remains
a mess. The only way to get it back to normal is exiting the activity.

Is there something I'm missing with my fragment transactions?

Regards
Stephan



--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/Actionbar-Tab-overlay-issues-tp5711868.html">http://mono-for-android.1047100.n5.nabble.com/Actionbar-Tab-overlay-issues-tp5711868.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012358.html">[mono-android] JAR Bindings: Create properties
</A></li>
	<LI>Next message: <A HREF="012350.html">[mono-android] axml loading in vs2010
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12347">[ date ]</a>
              <a href="thread.html#12347">[ thread ]</a>
              <a href="subject.html#12347">[ subject ]</a>
              <a href="author.html#12347">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
