<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Program stops
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Program%20stops&In-Reply-To=CALqoN0ZN1u7n%2Bxb9y34ckzS0GMShkCKFR2vJ66bvEbufzOqzhA%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005671.html">
   <LINK REL="Next"  HREF="005684.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Program stops</H1>
    <B>Tim Kelly</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Program%20stops&In-Reply-To=CALqoN0ZN1u7n%2Bxb9y34ckzS0GMShkCKFR2vJ66bvEbufzOqzhA%40mail.gmail.com"
       TITLE="[mono-android] Program stops">tim.kelly at DesignerWare.com
       </A><BR>
    <I>Thu Aug  4 16:29:22 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="005671.html">[mono-android] Program stops
</A></li>
        <LI>Next message: <A HREF="005684.html">[mono-android] Program stops
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5683">[ date ]</a>
              <a href="thread.html#5683">[ thread ]</a>
              <a href="subject.html#5683">[ subject ]</a>
              <a href="author.html#5683">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok, I've done a proof of concept that I thought would show the service
stopping after awhile.  However, my simple application doesn't stop (go
figure).  So, now I'm faced with not so much a simple problem but
something we do causes that behavior, so I'm still researching it.

 

However, on another note.  One of the things I took out of the proof was
a HttpWebRequest and HttpWebResponse which hit the server.  So, I'm
adding more logging and have found one thing.  

 

Repeatedly calling these cause the network to stop functioning until you
reboot the emulator.  Calling the equivalent in java posses no issues.

 

If you call this repeatedly, it eventually knocks out the network on the
device.  You cannot even bring up the Browser after the network goes
down.  Not sure if there's something else to use to get/post data?????

 

private string getData(string url, Boolean postData, String xmlData)

        {

            HttpWebResponse response = null;

            HttpWebRequest request = null;

            // used to build entire input

            StringBuilder sb = new StringBuilder();

            try

            {

                // used on each read operation

                byte[] buf = new byte[4 * 1024];

 

                // prepare the web page we will be asking for

 

                request = (HttpWebRequest)

                WebRequest.Create(url);

               

                request.ContentType = &quot;text/plain&quot;;

 

                if (postData)

                {

                    request.Method = &quot;POST&quot;;

                    string postDataXML = xmlData;

 

                    // Create POST data and convert it to a byte array.

                   // byte[] byteArray =
Encoding.UTF8.GetBytes(postDataXML);

                    byte[] byteArray =
System.Text.Encoding.ASCII.GetBytes(postDataXML);

 

                    // Set the ContentLength property of the WebRequest.

                    request.ContentLength = byteArray.Length;

                    // Get the request stream.

                    Stream dataStream = request.GetRequestStream();

                    // Write the data to the request stream.

                    dataStream.Write(byteArray, 0, byteArray.Length);

                    // Close the Stream object.

                    dataStream.Close();

 

                }

                // execute the request

                response = (HttpWebResponse)

 

                request.GetResponse();

 

                // we will read data via the response stream

 

                Stream resStream = response.GetResponseStream();

 

                String tempString = null;

                int count = 0;

                do

                {

                    // fill the buffer with data

                    count = resStream.Read(buf, 0, buf.Length);

 

                    // make sure we read some data

                    if (count != 0)

                    {

                        // translate from bytes to ASCII text

                        tempString = Encoding.ASCII.GetString(buf, 0,
count);

                        // continue building the string

                        sb.Append(tempString);

                    }

                }

                while (count &gt; 0); // any more data to read?

                try

                {

                    resStream.Close();

                }

                catch { }

 

            } catch { }

            

            finally {

                try {

                    if (!(response == null))

                        response.Close();

                    response = null;

                }

                catch { }

                try

                {

                    if (!(request==null))

                        request = null;

                }

                catch { }

            }

           

 

            // print out page source

            return sb.ToString();

        }

 

 

 

________________________________

From: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] On Behalf Of Jeff Stedfast
Sent: Thursday, August 04, 2011 10:38 AM
To: Discussions related to Mono for Android
Subject: Re: [mono-android] Program stops

 

Hi Tim,

 

Do you have a sample test case that illustrates this bug that you could
attach to <A HREF="http://bugzilla.xamarin.com?">http://bugzilla.xamarin.com?</A> If this is a bug in Mono for
Android, and it sounds like it very well could be, we'd be very
interested in fixing this bug.

 

Jeff

On Thu, Aug 4, 2011 at 10:33 AM, Tim Kelly &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">tim.kelly at designerware.com</A>&gt;
wrote:

Has anyone noticed that after a while a program just stops running in
the emulator?   Not sure if this behavior happens on a real device.
This has me concerned and thinking maybe there's underlying issues.

 

Anyway, I have an application that creates a service.  This service
creates a thread, sleeps and loops writing to the log and doing other
proof of concept work.  After about an hour or so it just stops working.
The log file is never written to again nor are any of the proof of
concepts working.  If you click on the menu/settings on the Droid
emulator and look a Applications running, the program and service is
still running.  You can click on the application and the interface comes
up, just the service is dead.

 

Now just for the heck of it, I programmed the same service in Eclipse
with Java with the exact same functions.  When this program runs, it
runs forever, just like you'd expect.

 

So why both applications you might ask?  I'm bench testing MonoDroid and
Java based on business requirements for management.  I'd like to use C#
so we have a cross platform solution but I have to ensure MonoDroid
works.

 

 

So, I'm concerned that if we deploy an application that it will stop
running requiring reboots.  If it's an emulator problem that's
explainable, but if not then using MonoDroid will be out of the
question???  And this behavior in Java on the emulator is not seen.

 

 


_______________________________________________
Monodroid mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>

UNSUBSCRIBE INFORMATION:
<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/mailman/private/monodroid/attachments/20110804/fa57ad34/attachment-0001.html">http://lists.ximian.com/mailman/private/monodroid/attachments/20110804/fa57ad34/attachment-0001.html</A> 
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005671.html">[mono-android] Program stops
</A></li>
	<LI>Next message: <A HREF="005684.html">[mono-android] Program stops
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5683">[ date ]</a>
              <a href="thread.html#5683">[ thread ]</a>
              <a href="subject.html#5683">[ subject ]</a>
              <a href="author.html#5683">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
