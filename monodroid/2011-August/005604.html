<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Non-persisting property in custom application.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Non-persisting%20property%20in%20custom%20application.&In-Reply-To=28D6A1E4-27BA-4AE5-9A87-9860C37A80B0%40xamarin.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005603.html">
   <LINK REL="Next"  HREF="005605.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Non-persisting property in custom application.</H1>
    <B>Narc&#237;s Calvet</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20Non-persisting%20property%20in%20custom%20application.&In-Reply-To=28D6A1E4-27BA-4AE5-9A87-9860C37A80B0%40xamarin.com"
       TITLE="[mono-android] Non-persisting property in custom application.">narcis at steema.com
       </A><BR>
    <I>Mon Aug  1 11:10:08 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="005603.html">[mono-android] Non-persisting property in custom application.
</A></li>
        <LI>Next message: <A HREF="005605.html">[mono-android] Non-persisting property in custom application.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5604">[ date ]</a>
              <a href="thread.html#5604">[ thread ]</a>
              <a href="subject.html#5604">[ subject ]</a>
              <a href="author.html#5604">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jon,

Thank you very much! 

Re.: There's supposed to be only one Application instance per process, and
you want Android to create the instance (so that it can initialize things
properly). You're creating _two_: the one Android creates, and then the one
you create.

Yes, that's it. The solution you suggested fixed it.


Re.: The current top-voted answer is the correct one -- you need an
//application/@android:name attribute to cause Android to create a
MyApplication instance. You should not need to ever explicitly create an
android.app.Application instance.

But the same user at StackOverflow says I can't have more than one
application tag in the AndroidManifest.xml. Is that correct? If so, how show
I address that?


Re.: Finally, I'm not sure how advisable it is to have a Layout tied to an
Application instance, as you normally want/need the layout to change when
the display changes (screen rotation, localization, etc.). For images which
won't change, tying them to an Application instance makes sense, but for
Layouts? I'm not so sure...

I have to think about which is the best object I can use for that purpose.
I'm not much satisfied with approaching the problem this way but that's the
alternative I have found so far to implement something like what I tried
here: 

<A HREF="http://stackoverflow.com/questions/6792331/sluggish-zoom-and-scroll-with-gri">http://stackoverflow.com/questions/6792331/sluggish-zoom-and-scroll-with-gri</A>
dview-in-android

I'd find much more elegant using that solution if it worked in a responsive
manner. I asked for help at main Android resources (SO, google groups, etc.)
without success :-(. Do you have any other idea?

Thanks in advance!



Best Regards,
 
Narc&#237;s Calvet
Steema Software
<A HREF="http://www.steema.com">http://www.steema.com</A> 
<A HREF="http://twitter.com/SteemaSoftware">http://twitter.com/SteemaSoftware</A> 
<A HREF="https://www.facebook.com/SteemaSoftware">https://www.facebook.com/SteemaSoftware</A>


-----Original Message-----
From: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] On Behalf Of Jonathan Pryor
Sent: dilluns, 1 / agost / 2011 16:49
To: Discussions related to Mono for Android
Subject: Re: [mono-android] Non-persisting property in custom application.

On Aug 1, 2011, at 7:33 AM, Narc&#237;s Calvet wrote:
&gt;<i> I have created a custom Application deriving from Android.App.Application.
</I>This custom Application has one property (Layout) that it&#146;s valid throughout
Application&#146;s code execution but null once it is called from an instance of
the Application, for example:
&gt;<i>  
</I>&gt;<i>       SetContentView(MyApplication.TheApp.Layout);
</I>&gt;<i>  
</I>&gt;<i> An example project reproducing the issue can be found at
</I><A HREF="http://tinyurl.com/3ggnwya.">http://tinyurl.com/3ggnwya.</A>

The problem is line 18: you should not do this:

	private static readonly MyApplication theApp = new MyApplication();

There's supposed to be only one Application instance per process, and you
want Android to create the instance (so that it can initialize things
properly). You're creating _two_: the one Android creates, and then the one
you create.

What you should instead do is change line 18 to:

	private static MyApplication theApp;

Then in MyApplication.OnCreate(), add:

	theApp = this;

&gt;<i> I have tried developing and equivalent project with Android for Java and
</I>works fine there. Actually not very good either, the onCreate event is not
fired unless it&#146;s manually called at the constructor. But that&#146;s another
issue:<A HREF="http://stackoverflow.com/questions/6858158/custom-android-app-applicat">http://stackoverflow.com/questions/6858158/custom-android-app-applicat</A>
ion-not-firing-oncreate-event

The current top-voted answer is the correct one -- you need an
//application/@android:name attribute to cause Android to create a
MyApplication instance. You should not need to ever explicitly create an
android.app.Application instance.

Finally, I'm not sure how advisable it is to have a Layout tied to an
Application instance, as you normally want/need the layout to change when
the display changes (screen rotation, localization, etc.). For images which
won't change, tying them to an Application instance makes sense, but for
Layouts? I'm not so sure...

 - Jon

_______________________________________________
Monodroid mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>

UNSUBSCRIBE INFORMATION:
<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005603.html">[mono-android] Non-persisting property in custom application.
</A></li>
	<LI>Next message: <A HREF="005605.html">[mono-android] Non-persisting property in custom application.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5604">[ date ]</a>
              <a href="thread.html#5604">[ thread ]</a>
              <a href="subject.html#5604">[ subject ]</a>
              <a href="author.html#5604">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
