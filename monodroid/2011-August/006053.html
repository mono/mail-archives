<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] simple web client crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20simple%20web%20client%20crash&In-Reply-To=000701cc656c%240f7b6480%242e722d80%24%40gb.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006048.html">
   <LINK REL="Next"  HREF="006056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] simple web client crash</H1>
    <B>John Murray</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=%5Bmono-android%5D%20simple%20web%20client%20crash&In-Reply-To=000701cc656c%240f7b6480%242e722d80%24%40gb.com"
       TITLE="[mono-android] simple web client crash">john at murray.gb.com
       </A><BR>
    <I>Sun Aug 28 11:41:14 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="006048.html">[mono-android] simple web client crash
</A></li>
        <LI>Next message: <A HREF="006056.html">[mono-android] simple web client crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6053">[ date ]</a>
              <a href="thread.html#6053">[ thread ]</a>
              <a href="subject.html#6053">[ subject ]</a>
              <a href="author.html#6053">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sheer bloodymindedness J I found a workaround 

-          Just leave out the headers

Don t know what would happen if the server objected to this but in this case
it works 

 

Strange that adding headers worked in a straightforward c# Windows app but
not in Mono for Android 

The exception code gives some clue that it is in the Mono for android code 

 

&quot;-                            eee         {System.Net.WebException: An error
occurred performing a WebClient request. ---&gt; System.ArgumentException: This
header must be modified with the appropiate property.

  at System.Net.WebHeaderCollection.Add (System.String name, System.String
value) [0x00027] in
/home/mkestner/monogit/mono/mcs/class/System/System.Net/WebHeaderCollection.
cs:167 

  at System.Net.HttpWebRequest.set_Headers (System.Net.WebHeaderCollection
value) [0x0001b] in
/home/mkestner/monogit/mono/mcs/class/System/System.Net/HttpWebRequest.cs:35
3   ....................&quot;

 

I searched the web and in an unrelated article the author seemed to be
suggesting that in some circumstances one cannot set headers using the Add
method. That led me to eliminate them completely and it worked - let's hear
it for the by guess and by god programmers !!

 

If anyone knows more I'd be interested in why the c#/ windows thing works
and Mono does not - if only to avoid future pitfalls 

 

John Murray 

 

 

 

From: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] On Behalf Of John Murray
Sent: 28 August 2011 11:20
To: 'Discussions related to Mono for Android'
Subject: [mono-android] simple web client crash

 

Just transported this code from a windows form app testbed - where it is
working fine  in same VS2010 debugger

Can anyone tell me - should I be handling things differently in mandroid? 

It simply hangs on the line Wc.Uploaddata() and I cant get a clue  what's
causing it 

Obviously I've checked connection etc 

 

                                string mystr2 = &quot;&lt;nwx
version=\&quot;0.3.5\&quot;&gt;&lt;Request id=\&quot;1\&quot;&gt;&lt;AvailableEpochs/&gt;&lt;/Request&gt;&lt;/nwx&gt;&quot;;

WebClient wc = new WebClient();

            wc.Headers.Add(&quot;Content-Type&quot;, &quot;application/xml&quot;);

            wc.Headers.Add(&quot;Pragma&quot;, &quot;no-cache&quot;);

            wc.Headers.Add(&quot;Cache-Control&quot;, &quot;no-cache&quot;);

            wc.Headers.Add(&quot;Host&quot;, &quot;www.navlost.eu&quot;);

 

            string ss3 = &quot;<A HREF="http://navlost.eu/nwxs/&quot;;">http://navlost.eu/nwxs/&quot;;</A>

            byte[] byteArray = Encoding.ASCII.GetBytes(mystr2);    //(mystr2
is a string representation of xml file 

            byte[] responseArray = wc.UploadData(ss3, &quot;POST&quot;, byteArray);

 

 

I'm stumped 

 

Any help gratefully solicited 

 

John Murray

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/mailman/private/monodroid/attachments/20110828/9dcb291a/attachment-0001.html">http://lists.ximian.com/mailman/private/monodroid/attachments/20110828/9dcb291a/attachment-0001.html</A> 
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006048.html">[mono-android] simple web client crash
</A></li>
	<LI>Next message: <A HREF="006056.html">[mono-android] simple web client crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6053">[ date ]</a>
              <a href="thread.html#6053">[ thread ]</a>
              <a href="subject.html#6053">[ subject ]</a>
              <a href="author.html#6053">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
