<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Activity/Service dilemma
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Activity/Service%20dilemma&In-Reply-To=%3CC2122E90-9ABD-426E-9EFF-CA3FC872AAEB%40vt.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012741.html">
   <LINK REL="Next"  HREF="012748.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Activity/Service dilemma</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Activity/Service%20dilemma&In-Reply-To=%3CC2122E90-9ABD-426E-9EFF-CA3FC872AAEB%40vt.edu%3E"
       TITLE="[mono-android] Activity/Service dilemma">jonpryor at vt.edu
       </A><BR>
    <I>Tue Oct 30 02:05:04 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012741.html">[mono-android] Activity/Service dilemma
</A></li>
        <LI>Next message: <A HREF="012748.html">[mono-android] Activity/Service dilemma
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12745">[ date ]</a>
              <a href="thread.html#12745">[ thread ]</a>
              <a href="subject.html#12745">[ subject ]</a>
              <a href="author.html#12745">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>That approach sounds good to our docs team.

 - Jon

On Oct 29, 2012, at 2:43 PM, Goncalo Oliveira &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">goncalo at minkan.net</A>&gt; wrote:

&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> I'm having this dilemma on Activity/Service &quot;binding&quot; that I don't quite know what is the best way to achieve.
</I>&gt;<i> Here's a common scenario...
</I>&gt;<i> 
</I>&gt;<i> We have an activity named LoginActivity. This activity has two fields, username and password.
</I>&gt;<i> The authentication operation consists in making a web request, and processing the result. Visually, we want to display a nice progress bar while we wait.
</I>&gt;<i> 
</I>&gt;<i> That's it. Pretty common.
</I>&gt;<i> Obviously, we want to consider things like the activity getting paused or the screen orientation changing.
</I>&gt;<i> 
</I>&gt;<i> After reading the docs and going through a few forums, I came up with a solution.
</I>&gt;<i> 
</I>&gt;<i> First, the dialog issue. If the screen orientation changes, the view is destroyed and recreated, so the dialog just disappears (and worse, it's lost in space - leaks).
</I>&gt;<i> What I did was to keep a reference to the progress dialog shown. I retain a flag stating that the progress dialog is visible by overriding the OnRetainNonConfigurationInstance. I also make sure I dismiss the dialog when the activity gets trashed (destroyed). When the new view gets created, I recover the flag and show a new progress dialog. This works well.
</I>&gt;<i> There were other methods, like configChanges, but I didn't want to handle the view resources myself, so this seemed like a good and clean approach.
</I>&gt;<i> 
</I>&gt;<i> Now for the operation, I created a service to handle it. More specifically an IntentService. The request is done in background, and when done, I send a broadcast with the result. Because the activity might pause (or trashed), I send a sticky intent broadcast, to make sure it reaches its destination. When received, I clear up the sticky intent.
</I>&gt;<i> 
</I>&gt;<i> This works quite well...
</I>&gt;<i> Though I was happy with the result, I questioned if this was the best approach. Some defend that using sticky intents is evil, even though I do a very assertive use. Some say that service binding is a better approach, though I don't know if it can be used with an IntentService and it seems like an awful lot of trouble for such a simple task (maybe I'm just not looking correctly).
</I>&gt;<i> 
</I>&gt;<i> So, any thoughts on this approach and on best practices for accomplishing this are greatly appreciated.
</I>&gt;<i> Cheers.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Gon&#231;alo Oliveira
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i> 
</I>&gt;<i> UNSUBSCRIBE INFORMATION:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A>
</I>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012741.html">[mono-android] Activity/Service dilemma
</A></li>
	<LI>Next message: <A HREF="012748.html">[mono-android] Activity/Service dilemma
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12745">[ date ]</a>
              <a href="thread.html#12745">[ thread ]</a>
              <a href="subject.html#12745">[ subject ]</a>
              <a href="author.html#12745">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
