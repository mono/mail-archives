<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Activity/Service dilemma
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Activity/Service%20dilemma&In-Reply-To=%3CCA%2BC5j5bX-TXcE7oRVrtvY5vJWunC5FB2Aft9RNQjpJBzZ40DnQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012747.html">
   <LINK REL="Next"  HREF="012745.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Activity/Service dilemma</H1>
    <B>Goncalo Oliveira</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Activity/Service%20dilemma&In-Reply-To=%3CCA%2BC5j5bX-TXcE7oRVrtvY5vJWunC5FB2Aft9RNQjpJBzZ40DnQ%40mail.gmail.com%3E"
       TITLE="[mono-android] Activity/Service dilemma">goncalo at minkan.net
       </A><BR>
    <I>Mon Oct 29 18:43:20 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="012747.html">[mono-android] HTC crash in debug
</A></li>
        <LI>Next message: <A HREF="012745.html">[mono-android] Activity/Service dilemma
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12741">[ date ]</a>
              <a href="thread.html#12741">[ thread ]</a>
              <a href="subject.html#12741">[ subject ]</a>
              <a href="author.html#12741">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I'm having this dilemma on Activity/Service &quot;binding&quot; that I don't quite
know what is the best way to achieve.
Here's a common scenario...

We have an activity named *LoginActivity*. This activity has two fields,
username and password.
The authentication operation consists in making a web request, and
processing the result. Visually, we want to display a nice progress bar
while we wait.

That's it. Pretty common.
Obviously, we want to consider things like the activity getting paused or
the screen orientation changing.

After reading the docs and going through a few forums, I came up with a
solution.

First, the dialog issue. If the screen orientation changes, the view is
destroyed and recreated, so the dialog just disappears (and worse, it's
lost in space - leaks).
What I did was to keep a reference to the progress dialog shown. I retain a
flag stating that the progress dialog is visible by overriding the *
OnRetainNonConfigurationInstance*. I also make sure I dismiss the dialog
when the activity gets trashed (destroyed). When the new view gets created,
I recover the flag and show a new progress dialog. This works well.
There were other methods, like *configChanges*, but I didn't want to handle
the view resources myself, so this seemed like a good and clean approach.

Now for the operation, I created a service to handle it. More specifically
an *IntentService*. The request is done in background, and when done, I
send a broadcast with the result. Because the activity might pause (or
trashed), I send a sticky intent broadcast, to make sure it reaches its
destination. When received, I clear up the sticky intent.

This works quite well...
Though I was happy with the result, I questioned if this was the best
approach. Some defend that using sticky intents is evil, even though I do a
very assertive use. Some say that service binding is a better approach,
though I don't know if it can be used with an IntentService and it seems
like an awful lot of trouble for such a simple task (maybe I'm just not
looking correctly).

So, any thoughts on this approach and on best practices for accomplishing
this are greatly appreciated.
Cheers.


-- 
Gon&#231;alo Oliveira
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20121029/309f0730/attachment.html">http://lists.ximian.com/pipermail/monodroid/attachments/20121029/309f0730/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012747.html">[mono-android] HTC crash in debug
</A></li>
	<LI>Next message: <A HREF="012745.html">[mono-android] Activity/Service dilemma
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12741">[ date ]</a>
              <a href="thread.html#12741">[ thread ]</a>
              <a href="subject.html#12741">[ subject ]</a>
              <a href="author.html#12741">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
