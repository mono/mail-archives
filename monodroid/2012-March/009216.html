<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] 4.0.5's OpenTK overhaul
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%204.0.5%27s%20OpenTK%20overhaul&In-Reply-To=%3C2593692720502191190%40unknownmsgid%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009215.html">
   <LINK REL="Next"  HREF="009208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] 4.0.5's OpenTK overhaul</H1>
    <B>Andreia Gaita</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%204.0.5%27s%20OpenTK%20overhaul&In-Reply-To=%3C2593692720502191190%40unknownmsgid%3E"
       TITLE="[mono-android] 4.0.5's OpenTK overhaul">andreia at xamarin.com
       </A><BR>
    <I>Sun Mar  4 15:14:42 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009215.html">[mono-android] 4.0.5's OpenTK overhaul
</A></li>
        <LI>Next message: <A HREF="009208.html">[mono-android] profiling and other tools in monotouch/droid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9216">[ date ]</a>
              <a href="thread.html#9216">[ thread ]</a>
              <a href="subject.html#9216">[ subject ]</a>
              <a href="author.html#9216">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 4, 2012, at 15:07, Randy Ficker &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">randyficker at gmail.com</A>&gt; wrote:

&gt;<i> Thanks for the explanation!
</I>&gt;<i>
</I>&gt;<i> When you get shared contexts working, can you share a sample app that shows
</I>&gt;<i> how to use them?
</I>
Yes indeed! I'll probably upload a new sample tonight or tomorrow that
works with 4.0.5. I'm already working on improving the interfaces to
make this easier, as the current api and code doesn't help much with
context sharing, so expect the next mfa update to bring some
(non-breaking) api changes for this.

&gt;<i>
</I>&gt;<i> Also, I noticed that if you Finish() an activity that contains a GL view,
</I>&gt;<i> OnRenderFrame and OnUpdateFrame are called at least once after the graphics
</I>&gt;<i> context is disposed.  I see &quot;call to OpenGL ES API with no current context&quot;
</I>&gt;<i> logged and calling MakeCurrent() or SwapBuffers() throws an
</I>&gt;<i> InvalidOperationException in this situation.
</I>
Yeah, it's a very annoying race condition that slipped through in this
release. Use try/catch statements when calling those methods so your
app doesn't crash as a workaround for now, that should be fixed on the
next mfa update.


~~ andreia gaita ~~
scribled on my iPaddle

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Andreia Gaita [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">andreia at xamarin.com</A>]
</I>&gt;<i> Sent: Sunday, March 04, 2012 5:37 AM
</I>&gt;<i> To: Randy Ficker
</I>&gt;<i> Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid at lists.ximian.com</A>
</I>&gt;<i> Subject: Re: 4.0.5's OpenTK overhaul
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> On Sat, Mar 3, 2012 at 10:48 AM, Randy Ficker &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">randyficker at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> The release notes for 4.0.5 mention that &#8220;this release brings an
</I>&gt;&gt;<i> overhauled OpenTK/Android backend.&#8221;  However, it&#8217;s pretty light on the
</I>&gt;&gt;<i> details.  I&#8217;d like to hear more about what exactly is changing.
</I>&gt;<i>
</I>&gt;<i> The objective was to try and fix as much as possible without breaking
</I>&gt;<i> compatibility with existing code. The initialization code was rewritten, the
</I>&gt;<i> context is now created earlier, the lifecycle of the context and surface now
</I>&gt;<i> obeys the android rules (you can only touch a surface between SurfaceCreated
</I>&gt;<i> and SurfaceDestroyed), and other things of that nature. For the most part,
</I>&gt;<i> those should not affect user code, which is why they aren't mentioned in the
</I>&gt;<i> release notes.
</I>&gt;<i>
</I>&gt;&gt;<i> I installed this from the beta channel and I notice that all of the
</I>&gt;&gt;<i> OpenGL code now runs on the UI thread, as opposed to 4.0.4 where all
</I>&gt;&gt;<i> of the OpenGL code ran on its own dedicated thread.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is a pretty major change, so I was surprised it was not mentioned
</I>&gt;&gt;<i> in the release notes.  This means that if a GL view is running at a
</I>&gt;&gt;<i> low framerate, all of the native controls on the screen now behave
</I>&gt;&gt;<i> very slowly as well, unlike in 4.0.4 where they were independent of
</I>&gt;&gt;<i> each other.  Is this intentional?
</I>&gt;<i>
</I>&gt;<i> No, the runloop runs separately, in its own thread. Only the callbacks are
</I>&gt;<i> made on the UI thread, following the common behaviour of OpenTK and also
</I>&gt;<i> Android's GLSurfaceView. User code should be as efficient as possible during
</I>&gt;<i> these callbacks, to minimize UI delays. You can do your own background
</I>&gt;<i> threads for other expensive operations, if needed.
</I>&gt;<i>
</I>&gt;<i> There's been a report of the run loop running slower than requested, so
</I>&gt;<i> there's ongoing work to make the runloop more efficient and closer to the
</I>&gt;<i> requested fps. There's also some technical difficulties envolved with
</I>&gt;<i> creating shared contexts, so we'll try to make those easier (because they're
</I>&gt;<i> very useful). Anything else you find that needs improving, let us know.
</I>&gt;<i>
</I>&gt;<i> ---
</I>&gt;<i> andreia gaita
</I>&gt;<i>
</I></PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009215.html">[mono-android] 4.0.5's OpenTK overhaul
</A></li>
	<LI>Next message: <A HREF="009208.html">[mono-android] profiling and other tools in monotouch/droid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9216">[ date ]</a>
              <a href="thread.html#9216">[ thread ]</a>
              <a href="subject.html#9216">[ subject ]</a>
              <a href="author.html#9216">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
