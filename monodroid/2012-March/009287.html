<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Urban Airship Push Notifications - JNIENV
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Urban%20Airship%20Push%20Notifications%20-%20JNIENV&In-Reply-To=%3C1331491959560-5555652.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009286.html">
   <LINK REL="Next"  HREF="009288.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Urban Airship Push Notifications - JNIENV</H1>
    <B>GavinBryan</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Urban%20Airship%20Push%20Notifications%20-%20JNIENV&In-Reply-To=%3C1331491959560-5555652.post%40n5.nabble.com%3E"
       TITLE="[mono-android] Urban Airship Push Notifications - JNIENV">gavinbryan at hotmail.com
       </A><BR>
    <I>Sun Mar 11 18:52:39 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009286.html">[mono-android] Urban Airship Push Notifications - JNIENV
</A></li>
        <LI>Next message: <A HREF="009288.html">[mono-android] RadioElement and Click
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9287">[ date ]</a>
              <a href="thread.html#9287">[ thread ]</a>
              <a href="subject.html#9287">[ subject ]</a>
              <a href="author.html#9287">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Spent some more time on this and thought I would post what I found in case
anyone else is trying to integrate  Urban Airship with Mono For Android. The
JNI calls I was making were ok but I discovered when looking in the Android
Device Logging window that if I put the developmentAppKey or
developmentAppSecret as the first line in my airshipconfig.properties file
it was only reading the first entry and other item was null and was causing
my original Illegal Argument exception error. I tried a few options and
found that moving the inProduction entry to the top fixed it, not sure why
when the Java Android project is using the exact same config file without
any issues but this fixed it 

e.g.
inProduction = false
developmentAppKey = xxxxxxxxxxxxxxxx
developmentAppSecret = xxxxxxxxxxxxxxxx 
transport = c2dm
c2dmSender = <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">xxxxxxxxxx at gmail.com</A>
iapEnabled = false

After this the UrbanAirship.takeOff function ran but I noticed that it was
not connecting to C2DM to get a key and not registering the APID with Urban
Airship. I found I had to enable the UrbanAirship PushManager
(PushManager.enablePush is the Java call) by using the following JNI calls
in Mono For Android and then all has worked correctly :-

// Enable Push in Urban Airship Pushmanager    
IntPtr ip_pushmanager =
JNIEnv.FindClass(&quot;com/urbanairship/push/PushManager&quot;);
IntPtr ip_enablePush = JNIEnv.GetStaticMethodID(ip_pushmanager,
&quot;enablePush&quot;, &quot;()V&quot;);
JNIEnv.CallStaticVoidMethod(ip_pushmanager, ip_enablePush);

Now I have my APID registered with Urban Airship and working well. I'm not
sure why the entries had to be that way in the airshipconfig.properties but
seems to have resolved the issue. 

Just thought I'd add this if anyone is looking in the future. I also have a
small test app if anyone needed it in future to look at, just PM me.

Thanks Jon for verifying the JNI was ok, was great help as this was the
first time of using JNI and pointed me to look at other things. Also have
found using the Android Device Logging was invaluable for tracking
everything down.





--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/Urban-Airship-Push-Notifications-JNIENV-tp5553668p5555652.html">http://mono-for-android.1047100.n5.nabble.com/Urban-Airship-Push-Notifications-JNIENV-tp5553668p5555652.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009286.html">[mono-android] Urban Airship Push Notifications - JNIENV
</A></li>
	<LI>Next message: <A HREF="009288.html">[mono-android] RadioElement and Click
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9287">[ date ]</a>
              <a href="thread.html#9287">[ thread ]</a>
              <a href="subject.html#9287">[ subject ]</a>
              <a href="author.html#9287">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
