<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] JniEnv problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20JniEnv%20problem&In-Reply-To=%3C67CBC34DDF373E47A441FCBE8CE89E369F7EC2%40AMXPRD0610MB390.eurprd06.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009366.html">
   <LINK REL="Next"  HREF="009373.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] JniEnv problem</H1>
    <B>James Burton</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20JniEnv%20problem&In-Reply-To=%3C67CBC34DDF373E47A441FCBE8CE89E369F7EC2%40AMXPRD0610MB390.eurprd06.prod.outlook.com%3E"
       TITLE="[mono-android] JniEnv problem">james at thetin.net
       </A><BR>
    <I>Tue Mar 20 15:22:22 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009366.html">[mono-android] JniEnv problem
</A></li>
        <LI>Next message: <A HREF="009373.html">[mono-android] Sorting ArrayAdapter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9367">[ date ]</a>
              <a href="thread.html#9367">[ thread ]</a>
              <a href="subject.html#9367">[ subject ]</a>
              <a href="author.html#9367">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Try using JAVAP to establish the correct list of parameters, as the ones you list for the method and the ones in the native call have no match.

IIRC it's the &quot;-s&quot; parameter you want to use, along with the jar path (in class path) and the class name, but it's a while since I used it.  Get the right format and it will spit out the exact JNI parameter format for you though.

Regards,
James Burton

From: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid-bounces at lists.ximian.com</A>] On Behalf Of H&#228;nke, Maik
Sent: 20 March 2012 2:11 PM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">monodroid at lists.ximian.com</A>
Subject: [mono-android] JniEnv problem

Hi,

I try to use a 3rd party library with JNI.

I have the following java method header:
public static native int Msg_UpdateOptions(int lIdentifier, boolean bEnabled, boolean bQueue, String functionName, int convention, Object callBackObj);

I import the method with this code:
public static int Msg_UpdateOptions(uint lIdentifier, bool bEnabled, bool bQueue, String functionName, int convention, Java.Lang.Object callBackObj)
{
       IntPtr methodId = JNIEnv.GetStaticMethodID(mAlkClass, &quot;Msg_UpdateOptions&quot;, &quot;(IZZLjava/lang/String;ILjava/lang/Object;)I&quot;);
       return JNIEnv.CallStaticIntMethod(mAlkClass, methodId, new JValue[] {
             new JValue(lIdentifier),
             new JValue(bEnabled),
             new JValue(bQueue),
             new JValue(new Java.Lang.String(functionName)),
             new JValue(convention),
             new JValue(callBackObj)
       });
}

In the Java sample the method is used in this way:
Msg_UpdateOptions(AlkMsg.MSG_ID_TurnInstructions, true, false, &quot;OnTurnInstructionReceived&quot;, 0, this );

Where 'this' is an activity and OnTurnInstructionReceived is a method of the actvity.

public void OnTurnInstructionReceived(int buffer, int len)
{
}

When I try this in c#, my app crashes without an error. I think the library try to call my OnTurnInstructionReceived method. Does anyone have an idea what is wrong?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20120320/e678bc52/attachment.html">http://lists.ximian.com/pipermail/monodroid/attachments/20120320/e678bc52/attachment.html</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009366.html">[mono-android] JniEnv problem
</A></li>
	<LI>Next message: <A HREF="009373.html">[mono-android] Sorting ArrayAdapter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9367">[ date ]</a>
              <a href="thread.html#9367">[ thread ]</a>
              <a href="subject.html#9367">[ subject ]</a>
              <a href="author.html#9367">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
