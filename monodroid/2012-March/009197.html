<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Nothing being passed back from a webservice
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Nothing%20being%20passed%20back%20from%20a%20webservice&In-Reply-To=%3CCANdg_tQ09RpW4OG8DZCVDdSRCRE3YtO87sRdDSr4J%3DxoS6R7-w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009196.html">
   <LINK REL="Next"  HREF="009199.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Nothing being passed back from a webservice</H1>
    <B>Stuart Lodge</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Nothing%20being%20passed%20back%20from%20a%20webservice&In-Reply-To=%3CCANdg_tQ09RpW4OG8DZCVDdSRCRE3YtO87sRdDSr4J%3DxoS6R7-w%40mail.gmail.com%3E"
       TITLE="[mono-android] Nothing being passed back from a webservice">me at slodge.com
       </A><BR>
    <I>Fri Mar  2 08:31:50 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009196.html">[mono-android] Nothing being passed back from a webservice
</A></li>
        <LI>Next message: <A HREF="009199.html">[mono-android] Nothing being passed back from a webservice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9197">[ date ]</a>
              <a href="thread.html#9197">[ thread ]</a>
              <a href="subject.html#9197">[ subject ]</a>
              <a href="author.html#9197">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At a guess, it's to do with timing.

You could be returning your list f from your function before the Async
network call has occurred.

To get around this, change your method from:

   private List&lt;string&gt; DoThis()

to:

   private void DoThisAndCallMeBack(Action&lt;List&lt;string&gt;&gt; callback)

And then modify the return statements to callback calls:

List&lt;string&gt; f = new List&lt;string&gt;();
           if (checkForNetwork(true) != true)
           {
               f.Add(&quot;No network available&quot;);
                callback(f);
               return;
           }

               List&lt;Upcoming&gt; tableData = new List&lt;Upcoming&gt;();
               POHWS.webservice.Service1 Service3 = new
POHWS.webservice.Service1();

               try
               {
                   Service3.BeginGetUpcoming(**track, delegate(IAsyncResult
iar)
                   {
                       tableData = Service3.EndGetUpcoming(iar).**ToList();
                       Android.App.Application.**
SynchronizationContext.Post(**delegate
                       {
                           if (tableData.Count == 0)
                           {
                               tableData[0].PostTime = &quot;No data from the
webservice&quot;;
                           }

                           f.Add(tableData[0].PostTime);
                           Console.WriteLine(&quot;f[0] = {0}&quot;, f[0]);
                           callback (f);
                       }, null);
                   }, null);
               }
               catch (Exception oe)
               {
                   f.Add(oe.ToString());
                   callback(f);
               }

You might also need to marshall the callback calls on to the UI thread

Hope that works and helps

Stuart

On 2 March 2012 02:29, Paul Johnson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">paul at all-the-johnsons.co.uk</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> This is probably down to me being a klutz, but can anyone spot why nothing
</I>&gt;<i> is being returned? The Console.WriteLine is showing that something is being
</I>&gt;<i> added to the list. I'm guessing a scope problem...
</I>&gt;<i>
</I>&gt;<i> (calling routine)
</I>&gt;<i> case 1:
</I>&gt;<i>                            List&lt;string&gt; race = new List&lt;string&gt;();
</I>&gt;<i>                            currentview.**SetBackgroundDrawable(**
</I>&gt;<i> Resources.GetDrawable(**Resource.Drawable.Back_**BobMoore));
</I>&gt;<i>                            text.Text = Resources.GetString(Resource.**
</I>&gt;<i> String.ComingSoon);
</I>&gt;<i>                            webservice_user getRace = new webservice_user();
</I>&gt;<i>                            race = getRace.getUpcomingRaces(&quot;**
</I>&gt;<i> fairmeadowsUpcoming&quot;);
</I>&gt;<i>                            races = race.ToArray();
</I>&gt;<i>                            break;
</I>&gt;<i>
</I>&gt;<i> (webservice)
</I>&gt;<i> List&lt;string&gt; f = new List&lt;string&gt;();
</I>&gt;<i>            if (checkForNetwork(true) != true)
</I>&gt;<i>            {
</I>&gt;<i>                f.Add(&quot;No network available&quot;);
</I>&gt;<i>                return f;
</I>&gt;<i>            }
</I>&gt;<i>            else
</I>&gt;<i>            {
</I>&gt;<i>                List&lt;Upcoming&gt; tableData = new List&lt;Upcoming&gt;();
</I>&gt;<i>                POHWS.webservice.Service1 Service3 = new
</I>&gt;<i> POHWS.webservice.Service1();
</I>&gt;<i>
</I>&gt;<i>                try
</I>&gt;<i>                {
</I>&gt;<i>                    Service3.BeginGetUpcoming(**track,
</I>&gt;<i> delegate(IAsyncResult iar)
</I>&gt;<i>                    {
</I>&gt;<i>                        tableData = Service3.EndGetUpcoming(iar).**
</I>&gt;<i> ToList();
</I>&gt;<i>                        Android.App.Application.**
</I>&gt;<i> SynchronizationContext.Post(**delegate
</I>&gt;<i>                        {
</I>&gt;<i>                            if (tableData.Count == 0)
</I>&gt;<i>                            {
</I>&gt;<i>                                tableData[0].PostTime = &quot;No data from the
</I>&gt;<i> webservice&quot;;
</I>&gt;<i>                            }
</I>&gt;<i>
</I>&gt;<i>                            f.Add(tableData[0].PostTime);
</I>&gt;<i>                            Console.WriteLine(&quot;f[0] = {0}&quot;, f[0]);
</I>&gt;<i>                        }, null);
</I>&gt;<i>                    }, null);
</I>&gt;<i>                }
</I>&gt;<i>                catch (Exception oe)
</I>&gt;<i>                {
</I>&gt;<i>                    f.Add(oe.ToString());
</I>&gt;<i>                    return f;
</I>&gt;<i>                }
</I>&gt;<i>            return f;
</I>&gt;<i>            }
</I>&gt;<i>
</I>&gt;<i> Not sure, it could also be the Android.App.Application.**SynchronizationContext.Post
</I>&gt;<i> code.
</I>&gt;<i>
</I>&gt;<i> Any help here would be appreciated. Thanks
</I>&gt;<i>
</I>&gt;<i> Paul
</I>&gt;<i> ______________________________**_________________
</I>&gt;<i> Monodroid mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">Monodroid at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i> UNSUBSCRIBE INFORMATION:
</I>&gt;<i> <A HREF="http://lists.ximian.com/**mailman/listinfo/monodroid&lt;http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/**mailman/listinfo/monodroid&lt;http://lists.ximian.com/mailman/listinfo/monodroid</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20120302/3f709631/attachment.html">http://lists.ximian.com/pipermail/monodroid/attachments/20120302/3f709631/attachment.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009196.html">[mono-android] Nothing being passed back from a webservice
</A></li>
	<LI>Next message: <A HREF="009199.html">[mono-android] Nothing being passed back from a webservice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9197">[ date ]</a>
              <a href="thread.html#9197">[ thread ]</a>
              <a href="subject.html#9197">[ subject ]</a>
              <a href="author.html#9197">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
