<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] SQLite error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20SQLite%20error&In-Reply-To=%3C4FB66141.9070204%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010392.html">
   <LINK REL="Next"  HREF="010416.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] SQLite error</H1>
    <B>mdurli</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20SQLite%20error&In-Reply-To=%3C4FB66141.9070204%40gmail.com%3E"
       TITLE="[mono-android] SQLite error">mdurli at gmail.com
       </A><BR>
    <I>Fri May 18 14:48:56 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="010392.html">[mono-android] SQLite error
</A></li>
        <LI>Next message: <A HREF="010416.html">[mono-android] SQLite error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10394">[ date ]</a>
              <a href="thread.html#10394">[ thread ]</a>
              <a href="subject.html#10394">[ subject ]</a>
              <a href="author.html#10394">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
  
    
  
  
    Hello,&#160; no I haven't any error in logcat... when clicking the button
    to pull data nothing happens, and when I debug through it and
    arrives to the .Read() part it simply skips all the rest... is this
    that is strange, it doesn't give an error. 
    
    Il 18/05/2012 15:42, ledz [via Mono for Android] ha scritto:
     The same code works here, tried on 3 different
      devices; the only difference I can see offhand is the
      connection.CreateCommand instead of new Sqlitecommand(). You don't
      even have any errors on logcat? 
      
      
        On 18 May 2012 14:02, mdurli &lt; [hidden email] &gt;
        wrote: 
         Tried on a Motorola ET1 Tablet and on a
          Motorola Droid, both with Android 2.3. 
          
          I tried other samples, and this code for example works: 
          string&#160;dbPath&#160;=&#160;Path.Combine(System.Environment.GetFolderPath(System.Environment.SpecialFolder.Personal),&quot;items.db3&quot;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;bool&#160;exists&#160;=&#160;File.Exists(dbPath);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;(!exists)&#160;SqliteConnection.CreateFile(dbPath);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;var&#160;connection&#160;=&#160;new&#160;SqliteConnection(&quot;Data&#160;Source=&quot;&#160;+&#160;dbPath);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;connection.Open();
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;(!exists)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#160;This&#160;is&#160;the&#160;first&#160;time&#160;the&#160;app&#160;has&#160;run&#160;and/or&#160;that&#160;we&#160;need&#160;the&#160;DB.
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#160;Copy&#160;a&#160;&quot;template&quot;&#160;DB&#160;from&#160;your&#160;assets,&#160;or&#160;programmatically&#160;create&#160;one.
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;var&#160;commands&#160;=&#160;new[]{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;CREATE&#160;TABLE&#160;[Items]&#160;(Key&#160;ntext,&#160;Value&#160;ntext);&quot;,
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;INSERT&#160;INTO&#160;[Items]&#160;([Key],&#160;[Value])&#160;VALUES&#160;('sample',&#160;'text')&quot;,
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;INSERT&#160;INTO&#160;[Items]&#160;([Key],&#160;[Value])&#160;VALUES&#160;('sample2',&#160;'text2')&quot;
&#160;&#160;&#160;&#160;};
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;foreach&#160;(var&#160;command&#160;in&#160;commands)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;using&#160;(var&#160;c&#160;=&#160;connection.CreateCommand())
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;c.CommandText&#160;=&#160;command;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;c.ExecuteNonQuery();
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#160;use&#160;`connection`...
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#160;here,&#160;we'll&#160;just&#160;append&#160;the&#160;contents&#160;to&#160;a&#160;TextView
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;using&#160;(var&#160;contents&#160;=&#160;connection.CreateCommand())
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;contents.CommandText&#160;=&#160;&quot;SELECT&#160;[Key],&#160;[Value]&#160;from&#160;[Items]&quot;;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;var&#160;r&#160;=&#160;contents.ExecuteReader();
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while&#160;(r.Read())
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;textView1.Text&#160;+=&#160;string.Format(&quot;\n\tKey={0};&#160;Value={1}&quot;,
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;r[&quot;Key&quot;].ToString(),&#160;r[&quot;Value&quot;].ToString());
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;r.NextResult();
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;connection.Close();


I can start from here now, but I'm still wondering what't wrong in the other code (and why it didn't trap the error but just exit the procedure when .Read()

Thanks,
Mattia




          
          
          Il 18/05/2012 14:30, ledz [via Mono for Android] ha scritto:
          
             On what real device did you test? 
              
            
            
              
                On 18 May 2012 12:57, mdurli &lt; [hidden
                      email] &gt; wrote: 
                   Hello, 
                    
                    I tried both with emulator and with real device. 
                    
                    Thanks, 
                    Mattia 
                    
                    
                    Il 18/05/2012 13:23, Wally McClure [via Mono for
                    Android] ha scritto:
                    
                      
                         Mattia,
                          
                          
                          I haven't tried this under 4.2, but when
                            the book was written, the data readers did
                            not work in the emulator under the 4.0x
                            versions we tested with at the time, but
                            worked in every physical device that we
                            tested against. &#160;The joys of the emulator. 
                          
                          
                        
                        Wally 
                          
                          
                            
                              Date: Fri, 18 May 2012 13:12:04 +0200 
                            
                             From: [hidden email] 
                              To: [hidden email] 
                            
                            CC: [hidden email] 
                            
                              Subject: Re: [mono-android] SQLite error 
                              
                              Hello Wally, 
                              
                              thanks for the quick response. 
                              
                              
                                
                                  
                                    
                                      On that specific example,
                                        there should be another button
                                        on that form. &#160;IIRC, the other
                                        button should insert some data
                                        into the table. &#160;When I get down
                                        to my office, I'll verify this.
                                    
                                  
                                
                              
                              Yes there is a button and it completes the
                              DB creation and sample data insertion with
                              success, so that part works. 
                              The problem is with the second button that
                              should fetch the data with a datareader. 
                              
                              What I don't understand is why I can
                              follow the debug until the &quot;while
                              (sdr.Read())&quot; line, and then clicking F10
                              the debug jumps at the end of the file...
                              without rising any error, even if it's in
                              the try/catch block. 
                              I tried both in emulator and in real
                              device. 
                              
                              Debug should work, because there is a
                              third button that connects to a SQLServer
                              DB, that fails correctly during the
                              connection in its try/catch block. 
                              
                              Thanks, 
                              Mattia 
                              
                            
                            
                              
                                
                                  
                                    
                                      You should be able to create a
                                        DB and store it in the assets
                                        directory. &#160;When the application
                                        is first deployed and run, you
                                        can copy the db file out. &#160;I
                                        haven't done this, but you
                                        &quot;should&quot; be able to do this.
                                        &#160;I'm a db guy at heart, so sql
                                        commands are easy to put
                                        together for me, plus I like to
                                        use them when I update apps.
                                      Accessing the db remotely is
                                        way more complicated than we are
                                        used to with VS. &#160;You can use
                                        adb to connect to the db, but
                                        you have to have the device.
                                        &#160;I'm sure that there are higher
                                        level tools that you can use,
                                        but I am not aware of them.
                                    
                                    
                                    
                                    Wally 
                                
                                
                                  
                                    &gt; Date: Fri, 18 May 2012
                                      03:35:23 -0700 
                                    
                                     &gt; From: [hidden email] 
                                      &gt; To: [hidden email] 
                                    
                                    
                                       &gt; Subject: [mono-android]
                                        SQLite error 
                                        &gt; 
                                        &gt; Hello, 
                                        &gt; 
                                        &gt; I'm having this problem
                                        with the sample code of the wrox
                                        book &quot;Pro Android 
                                        &gt; programming with Mono for
                                        Android&quot;, InternalNetworkData
                                        sample. 
                                        &gt; First it creates a DB and
                                        fills it with data, with
                                        success, then tries to 
                                        &gt; read the data with a
                                        SqliteDataReader. 
                                        &gt; I tried to debug it and
                                        when it gets to the line &quot;while
                                        (sdr.Read())&quot; the 
                                        &gt; debug line jumps to the end
                                        of the file, no errors, and non
                                        processing, 
                                        &gt; application stil running,
                                        and I can press the button to
                                        get the data again. 
                                        &gt; What's wrong? with the code
                                        and with my debug that can't get
                                        the error. 
                                        &gt; 
                                        &gt; string DatabaseName =
                                        &quot;UserData.db3&quot;; 
                                        &gt; string documents =
                                        System.Environment.GetFolderPath( 
                                        &gt;
                                        System.Environment.SpecialFolder.Personal); 
                                        &gt; string db =
                                        Path.Combine(documents,
                                        DatabaseName); 
                                        &gt; var conn = new
                                        SqliteConnection(&quot;Data Source=&quot;
                                        + db); 
                                        &gt; var strSql = &quot;select Name
                                        from Customer where
                                        STATEID=@STATEID&quot;; 
                                        &gt; var cmd = new
                                        SqliteCommand(strSql, conn); 
                                        &gt; cmd.CommandType =
                                        CommandType.Text; 
                                        &gt; cmd.Parameters.Add(new
                                        SqliteParameter(&quot;@STATEID&quot;, 2)); 
                                        &gt; 
                                        &gt; tv.Text = &quot;&quot;; 
                                        &gt; 
                                        &gt; try 
                                        &gt; { 
                                        &gt; conn.Open(); 
                                        &gt; SqliteDataReader sdr =
                                        cmd.ExecuteReader(); 
                                        &gt; while (sdr.Read()) 
                                        &gt; { 
                                        &gt; tv.Text =
                                        Convert.ToString(sdr[&quot;Name&quot;]); 
                                        &gt; } 
                                        &gt; } 
                                        &gt; catch (System.Exception
                                        sysExc) 
                                        &gt; { 
                                        &gt; tv.Text = sysExc.Message; 
                                        &gt; } 
                                        &gt; finally 
                                        &gt; { 
                                        &gt; if (conn.State !=
                                        ConnectionState.Closed) 
                                        &gt; { 
                                        &gt; conn.Close(); 
                                        &gt; } 
                                        &gt; conn.Dispose(); 
                                        &gt; 
                                        &gt; } 
                                        &gt; 
                                        &gt; 
                                        &gt; By the way, is there a way
                                        with a thirdy part software or
                                        even with vs to 
                                        &gt; create a sqlite DB and
                                        deploy it with the application?
                                        and maybe even to 
                                        &gt; access the sqlite DBs in
                                        the connected device? asking too
                                        much? 
                                        &gt; 
                                        &gt; Thanks! 
                                        &gt; Mattia 
                                        &gt; 
                                        &gt; -- 
                                        &gt; View this message in
                                        context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898.html">http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898.html</A> 
                                        &gt; Sent from the Mono for
                                        Android mailing list archive at
                                        Nabble.com. 
                                        &gt;
                                        _______________________________________________ 
                                        &gt; Monodroid mailing list 
                                      
                                    
                                     &gt; [hidden email] 
                                      &gt; 
                                      &gt; UNSUBSCRIBE INFORMATION: 
                                      &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A> 
                                    
                                  
                                
                              
                            
                          
                        
                      
                       
                        _______________________________________________
                        
                        Monodroid mailing list 
                        [hidden

                          email]  
                        
                        UNSUBSCRIBE INFORMATION: 
                        <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A> 
                        
                        
                      
                      
                      
                        
                          If you reply to
                            this email, your message will be added to
                            the discussion below: 
                        
                        <A HREF="http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709904.html">http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709904.html</A> 
                      
                      
                        
                          To unsubscribe from SQLite error, click here . 
                          NAML  
                      
                    
                    
                     View this message in
                    context: Re:
                      SQLite error 
                    
                      
                        Sent from the Mono
                          for Android mailing list archive  at
                        Nabble.com. 
                      
                    
                    
                    _______________________________________________ 
                    Monodroid mailing list 
                    [hidden
                      email] 
                    
                    UNSUBSCRIBE INFORMATION: 
                    <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A> 
                    
                  
                
                
                
                
                
              
            
            -- 
            Gon&#231;alo Oliveira
            
              
              _______________________________________________ 
              Monodroid mailing list 
              [hidden
                email]  
              
              UNSUBSCRIBE INFORMATION: 
              <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A> 
              
              
               
            
              
                If you reply to this
                  email, your message will be added to the discussion
                  below: 
              
              <A HREF="http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709909.html">http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709909.html</A> 
            
            
              
                To unsubscribe from SQLite error, click here . 
                NAML  
            
          
          
             
              
              View this message in context: Re:
                SQLite error 
              Sent from the Mono for
                Android mailing list archive  at Nabble.com. 
            
          
          
          _______________________________________________ 
          Monodroid mailing list 
          [hidden email] 
          
          UNSUBSCRIBE INFORMATION: 
          <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A> 
          
        
      
      
      
      
      
      -- 
      Gon&#231;alo Oliveira 
      
      _______________________________________________
      
      Monodroid mailing list
      
      [hidden email] 
      
      
      UNSUBSCRIBE INFORMATION:
      
      <A HREF="http://lists.ximian.com/mailman/listinfo/monodroid">http://lists.ximian.com/mailman/listinfo/monodroid</A> 
      
      
      
      
        If you reply to this email, your
          message will be added to the discussion below: 
        <A HREF="http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709912.html">http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709912.html</A> 
      
      
        To unsubscribe from SQLite error, click
          here . 
        NAML  
    
  



--
View this message in context: <A HREF="http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709914.html">http://mono-for-android.1047100.n5.nabble.com/SQLite-error-tp5709898p5709914.html</A>
Sent from the Mono for Android mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20120518/5b29519b/attachment-0001.html">http://lists.ximian.com/pipermail/monodroid/attachments/20120518/5b29519b/attachment-0001.html</A>&gt;
</PRE>






































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010392.html">[mono-android] SQLite error
</A></li>
	<LI>Next message: <A HREF="010416.html">[mono-android] SQLite error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10394">[ date ]</a>
              <a href="thread.html#10394">[ thread ]</a>
              <a href="subject.html#10394">[ subject ]</a>
              <a href="author.html#10394">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
