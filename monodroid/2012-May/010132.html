<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mono-android] Odd behavior when restarting app
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Odd%20behavior%20when%20restarting%20app&In-Reply-To=%3C049c01cd2e8d%2469b21f80%243d165e80%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010158.html">
   <LINK REL="Next"  HREF="010144.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mono-android] Odd behavior when restarting app</H1>
    <B>Randy Ficker</B> 
    <A HREF="mailto:monodroid%40lists.ximian.com?Subject=Re%3A%20%5Bmono-android%5D%20Odd%20behavior%20when%20restarting%20app&In-Reply-To=%3C049c01cd2e8d%2469b21f80%243d165e80%24%40gmail.com%3E"
       TITLE="[mono-android] Odd behavior when restarting app">randyficker at gmail.com
       </A><BR>
    <I>Thu May 10 09:15:14 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="010158.html">[mono-android] MonoAndroidBinPath error with 4.2
</A></li>
        <LI>Next message: <A HREF="010144.html">[mono-android] Odd behavior when restarting app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10132">[ date ]</a>
              <a href="thread.html#10132">[ thread ]</a>
              <a href="subject.html#10132">[ subject ]</a>
              <a href="author.html#10132">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm encountering some strange behavior when I close and re-open my app.
Let's start with a basic two-activity app:

 

    [Activity(MainLauncher = true)]

    public class Activity1 : Activity

    {

        protected override void OnCreate(Bundle bundle)

        {

            base.OnCreate(bundle);

 

            var btn = new Button(this);

            btn.Text = &quot;One&quot;;

            btn.Click += (s, e) =&gt; this.StartActivity(typeof(Activity2));

 

            SetContentView(btn);

        }

    }

 

    [Activity]

    public class Activity2 : Activity

    {

        protected override void OnCreate(Bundle bundle)

        {

            base.OnCreate(bundle);

 

            var btn = new Button(this);

            btn.Text = &quot;Two&quot;;

            btn.Click += (s, e) =&gt; this.Finish();

 

            this.SetContentView(btn);

        }

    }

 

Then follow these steps:

 

1.       Set to release mode (not sure if it matters, but I always use
release)

2.       Deploy to a device from Visual Studio

3.       Tap Activity1's button to launch Activity2.

4.       Press the Home key

5.       Re-launch the app from a shortcut on the home screen (bug doesn't
seem to reliably repro if you re-launch it from the recently used app list) 

 

After re-launching the app, I would expect to see Activity2 presented to the
user.  Instead, it shows Activity1.  But the problem is much worse than just
seeing the wrong activity, since if the user presses Back they actually go
back to Activity2!  Going back again goes back to another copy of Activity1.


 

This shouldn't happen since Activity1 should be at the root of the app
(going back from it should exit the app) and nothing should go back *to*
Activity2 since it was the topmost activity.  It's as if a new copy of
Activity1 is created and pushed onto the stack on top of the two activities
that already exist.

 

In this small repro app, I can only reproduce the bug when I launch the app
from Visual Studio.  If I launch it from the home screen, everything works
as expected.   However, it's important to note that this property isn't true
of my real app.  It repros in my real app 100% of the time, no matter where
I launch it from.  I haven't figured out why they're different, but since I
can repro it 100% of the time in this small app when launched from Visual
Studio I hope it's enough for you to find the issue.

 

I'm running 4.0.6.  I don't think this happens in older versions since I
never saw this behavior before recently.  I verified it still repros in
4.1.0, but I couldn't get 4.2.0 to work at all so I couldn't try it there.

 

I really hope this repros for you guys since this is an elusive one.  I've
already burned way too much time trying to track this issue down.

 

Thanks for any assistance you can provide!

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/monodroid/attachments/20120510/848039c1/attachment-0001.html">http://lists.ximian.com/pipermail/monodroid/attachments/20120510/848039c1/attachment-0001.html</A>&gt;
</PRE>












































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010158.html">[mono-android] MonoAndroidBinPath error with 4.2
</A></li>
	<LI>Next message: <A HREF="010144.html">[mono-android] Odd behavior when restarting app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10132">[ date ]</a>
              <a href="thread.html#10132">[ thread ]</a>
              <a href="subject.html#10132">[ subject ]</a>
              <a href="author.html#10132">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodroid">More information about the Monodroid
mailing list</a><br>
</body></html>
