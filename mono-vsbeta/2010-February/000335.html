<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-vsbeta] Crash During Debug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-vsbeta%40lists.ximian.com?Subject=%5BMono-vsbeta%5D%20Crash%20During%20Debug&In-Reply-To=B4F712B5F4D0BF45B527428633813DBD01EF811C0A89%40VA3DIAXVS021.RED001.local">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000334.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-vsbeta] Crash During Debug</H1>
    <B>Jonathan Pobst</B> 
    <A HREF="mailto:mono-vsbeta%40lists.ximian.com?Subject=%5BMono-vsbeta%5D%20Crash%20During%20Debug&In-Reply-To=B4F712B5F4D0BF45B527428633813DBD01EF811C0A89%40VA3DIAXVS021.RED001.local"
       TITLE="[Mono-vsbeta] Crash During Debug">jpobst at novell.com
       </A><BR>
    <I>Thu Feb 25 15:24:30 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000334.html">[Mono-vsbeta] Crash During Debug
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#335">[ date ]</a>
              <a href="thread.html#335">[ thread ]</a>
              <a href="subject.html#335">[ subject ]</a>
              <a href="author.html#335">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> &gt; As a feature request for a future version, it would be nice if you 
could instruct monovs-server to pass parameters to mono similarly to how 
you can with mdb using something like &quot;-jit-arg:-O=-cmov&quot;

I am overhauling this system as we speak, and will add the ability to 
add arguments to mono, as well as set environment variables.

Unfortunately, this will be the version after 1.1.  :(

To me, your debugger error doesn't look related to the redirection.

cc'ing our debugger guru to see if he has any insight.

Jonathan


On 2/24/2010 5:23 PM, Dave Glick wrote:
&gt;&gt;<i> Maybe you can aliasing the mono command to include the options?
</I>&gt;<i>
</I>&gt;<i> I've tried everything I can think of.
</I>&gt;<i>
</I>&gt;<i> First I tried an alias, but that didn't work because monovs-server launches the mono application by name, not by issuing a command.
</I>&gt;<i>
</I>&gt;<i> Then I tried creating a shell script at /usr/bin/mono that used &quot;exec&quot; to launch my (renamed) mono executable. That worked in many cases, like running mono directly, but resulted in Visual Studio reporting that it couldn't start the debugging process due to a timeout. I'm assuming that's because the shell script is actually interpreted by sh so when monovs-server attempted to fork and attach to the process, it thought the process it forked was mono, but it instead got sh (meanwhile mono got kicked off in a different process space by the shell script).
</I>&gt;<i>
</I>&gt;<i> Finally, I created a simple wrapper application (code at the bottom). I compile it to /usr/bin/mono and it kicks off my renamed mono executable with the extra parameter in the same process space. It works in almost every case I tried, including when mdb starts mono. Unfortunately, monovs-server still doesn't seem to like this approach and crashes with the following stack trace. Any ideas? I realize this is starting to get specific to my particular problem, and appreciate any further advice you can give. Our application is very complicated and it would help tremendously if we were able to get monovs up and running...
</I>&gt;<i>
</I>&gt;<i> As a feature request for a future version, it would be nice if you could instruct monovs-server to pass parameters to mono similarly to how you can with mdb using something like &quot;-jit-arg:-O=-cmov&quot;
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vsbeta">rupert at linux-gxaj</A>:~&gt;  monovs-server
</I>&gt;<i> Using config file: /usr/lib/monotools-server/monovs-server.exe.config
</I>&gt;<i> Listening at: 192.168.139.130:8805, manager port range 8806..8815, webserver port range 8816..8872, using ssdp, using tcp-pipe channel
</I>&gt;<i> Using config file: /usr/lib/monotools-server/monovs-debug-server.exe.config
</I>&gt;<i> EXCEPTION: System.ArgumentException: An element with the same key already exists in the dictionary.
</I>&gt;<i>    at System.Collections.Generic.Dictionary`2[Mono.Debugger.Thread,Mono.VisualStudio.Mdb.ServerThread].Add (Mono.Debugger.Thread key, Mono.VisualStudio.Mdb.ServerThread value) [0x00171] in /usr/src/packages/BUILD/mono-2.6.2/mcs/class/corlib/System.Collections.Generic/Dictionary.cs:429
</I>&gt;<i>    at Mono.VisualStudio.Mdb.ServerProcess.OnThreadCreated (Mono.Debugger.Thread t) [0x00008] in /usr/src/packages/BUILD/monotools-server-1.1/MonoVS.DebugServer/ServerProcess.cs:75
</I>&gt;<i>    at Mono.VisualStudio.Mdb.ServerProcess.OnDebuggerReady (Mono.Debugger.Thread t) [0x00000] in /usr/src/packages/BUILD/monotools-server-1.1/MonoVS.DebugServer/ServerProcess.cs:83
</I>&gt;<i>    at (wrapper remoting-invoke-with-check) Mono.VisualStudio.Mdb.ServerProcess:OnDebuggerReady (Mono.Debugger.Thread)
</I>&gt;<i>    at Mono.VisualStudio.Mdb.DebuggerServer.OnReachedMainEvent (Mono.Debugger.Debugger debugger, Mono.Debugger.Process process) [0x0001d] in /usr/src/packages/BUILD/monotools-server-1.1/MonoVS.DebugServer/DebuggerServer.cs:198
</I>&gt;<i>    at Mono.Debugger.Debugger.OnProcessReachedMainEvent (Mono.Debugger.Process process) [0x0000b] in /usr/src/packages/BUILD/mono-debugger-2.6.2/classes/Debugger.cs:87
</I>&gt;<i>    at (wrapper remoting-invoke-with-check) Mono.Debugger.Debugger:OnProcessReachedMainEvent (Mono.Debugger.Process)
</I>&gt;<i>    at Mono.Debugger.Backend.ProcessServant.OnProcessReachedMainEvent () [0x00000] in /usr/src/packages/BUILD/mono-debugger-2.6.2/backend/ProcessServant.cs:380
</I>&gt;<i>    at (wrapper remoting-invoke-with-check) Mono.Debugger.Backend.ProcessServant:OnProcessReachedMainEvent ()
</I>&gt;<i>    at Mono.Debugger.Backend.Mono.MonoThreadManager.HandleChildEvent (Mono.Debugger.Backend.SingleSteppingEngine engine, Mono.Debugger.Backend.Inferior inferior, Mono.Debugger.Backend.ChildEvent&amp;  cevent, System.Boolean&amp;  resume_target) [0x0030b] in /usr/src/packages/BUILD/mono-debugger-2.6.2/backend/mono/MonoThreadManager.cs:400
</I>&gt;<i>    at Mono.Debugger.Backend.ThreadManager.HandleChildEvent (Mono.Debugger.Backend.SingleSteppingEngine engine, Mono.Debugger.Backend.Inferior inferior, Mono.Debugger.Backend.ChildEvent&amp;  cevent, System.Boolean&amp;  resume_target) [0x00181] in /usr/src/packages/BUILD/mono-debugger-2.6.2/backend/ThreadManager.cs:200
</I>&gt;<i>    at (wrapper remoting-invoke-with-check) Mono.Debugger.Backend.ThreadManager:HandleChildEvent (Mono.Debugger.Backend.SingleSteppingEngine,Mono.Debugger.Backend.Inferior,Mono.Debugger.Backend.Inferior/ChildEvent&amp;,bool&amp;)
</I>&gt;<i>    at Mono.Debugger.Backend.SingleSteppingEngine.ProcessEvent (Mono.Debugger.Backend.ChildEvent cevent) [0x001cd] in /usr/src/packages/BUILD/mono-debugger-2.6.2/backend/SingleSteppingEngine.cs:230
</I>&gt;<i>    at Mono.Debugger.Backend.SingleSteppingEngine.ProcessEvent (Int32 status) [0x0000c] in /usr/src/packages/BUILD/mono-debugger-2.6.2/backend/SingleSteppingEngine.cs:167
</I>&gt;<i>    at (wrapper remoting-invoke-with-check) Mono.Debugger.Backend.SingleSteppingEngine:ProcessEvent (int)
</I>&gt;<i>    at Mono.Debugger.Backend.ThreadManager.engine_thread_main () [0x000cd] in /usr/src/packages/BUILD/mono-debugger-2.6.2/backend/ThreadManager.cs:335
</I>&gt;<i>
</I>&gt;<i> Code of wrapper application:
</I>&gt;<i>
</I>&gt;<i> #include&lt;unistd.h&gt;
</I>&gt;<i> main(int argc, char *argv[])
</I>&gt;<i> {
</I>&gt;<i> 	char *args[argc+2];
</I>&gt;<i> 	args[0] = &quot;mono-wrapped&quot;;
</I>&gt;<i> 	args[1] = &quot;-O=-cmov&quot;;
</I>&gt;<i> 	int c;
</I>&gt;<i> 	for(c = 1 ; c&lt;  argc ; c++ )
</I>&gt;<i> 	{
</I>&gt;<i> 		args[c+1] = argv[c];
</I>&gt;<i> 	}
</I>&gt;<i> 	args[c+1] = (char*)0;
</I>&gt;<i> 	return execv(&quot;/usr/bin/mono-wrapped&quot;, args);
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-vsbeta mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vsbeta">Mono-vsbeta at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-vsbeta">http://lists.ximian.com/mailman/listinfo/mono-vsbeta</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000334.html">[Mono-vsbeta] Crash During Debug
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#335">[ date ]</a>
              <a href="thread.html#335">[ thread ]</a>
              <a href="subject.html#335">[ subject ]</a>
              <a href="author.html#335">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-vsbeta">More information about the Mono-vsbeta
mailing list</a><br>
</body></html>
