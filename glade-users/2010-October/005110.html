<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] Viewing custom widget sub-widgets in Glade	tree-view
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Viewing%20custom%20widget%20sub-widgets%20in%20Glade%0A%09tree-view&In-Reply-To=AANLkTin-KneYH3xs5ji-Zs8AAbr6bRzMG%2B1TdrOZ47BR%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005109.html">
   <LINK REL="Next"  HREF="005111.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] Viewing custom widget sub-widgets in Glade	tree-view</H1>
    <B>Tristan Van Berkom</B> 
    <A HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Viewing%20custom%20widget%20sub-widgets%20in%20Glade%0A%09tree-view&In-Reply-To=AANLkTin-KneYH3xs5ji-Zs8AAbr6bRzMG%2B1TdrOZ47BR%40mail.gmail.com"
       TITLE="[Glade-users] Viewing custom widget sub-widgets in Glade	tree-view">tvb at gnome.org
       </A><BR>
    <I>Tue Oct  5 05:18:25 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005109.html">[Glade-users] Viewing custom widget sub-widgets in Glade	tree-view
</A></li>
        <LI>Next message: <A HREF="005111.html">[Glade-users] Viewing custom widget sub-widgets in Glade	tree-view
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5110">[ date ]</a>
              <a href="thread.html#5110">[ thread ]</a>
              <a href="subject.html#5110">[ subject ]</a>
              <a href="author.html#5110">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry I have to run out right now, but reading your mail... if I
understand correctly
I think you will be able to get away with adding the text:

   &lt;property .... construct-only=&quot;True&quot; /&gt;

...to the properties you declared which control how many columns/rows your
custom widget has (this will trigger the widget being rebuilt whenever the
amount of children changes... so it will call the post-create again and add
the internal children correctly).

Ofcourse if your children have customized internal names (like &quot;button-c2-r5&quot;
for the button in column 2 and row 5...) then your GtkBuildable implementation
will have to handle that correctly too in it's own
get_internal_child() implementation,
I dont think there's going to be any problems with that though.

Cheers,
          -Tristan


On Tue, Oct 5, 2010 at 5:52 PM, Klaim &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/glade-users">mjklaim at gmail.com</A>&gt; wrote:
&gt;<i> Hi and thank you very much for answering so fast!
</I>&gt;<i> Your explaination is clear and I now I can clearly see how much I'm not in
</I>&gt;<i> this (simple) case.
</I>&gt;<i> I'll explain the structure of my custom widget to help you help me.
</I>&gt;<i> My custom widget isn't a container. I mean that in glade, or in the code
</I>&gt;<i> using it,
</I>&gt;<i> there shouldn't be ways to add something to it directly.
</I>&gt;<i> Instead, the use will simply change parametters:
</I>&gt;<i> My widget inherit from GtkAlignment and contains only a GtkTable. Now the
</I>&gt;<i> table is automatically filled with GtkToggleButtons.
</I>&gt;<i> I exposed column-width and column-height in parametters of my custom widget
</I>&gt;<i> and when you change it, it will automatically destroy and create toggle
</I>&gt;<i> buttons in the table to fill it. That's all done in the custom widget.
</I>&gt;<i> What I want is to allow the user to edit the buttons (everithing in it, like
</I>&gt;<i> normal button edit) without being allowed to touch the structure of the
</I>&gt;<i> custom widget other than what I voluntarly exposed in the interface.
</I>&gt;<i> Now, if I understood correctly, I'm in the case where I need to
</I>&gt;<i> &#160;1. implement get-internal-child
</I>&gt;<i> &#160;2. have to get new buttons created in the widget and make glade widgets for
</I>&gt;<i> them.
</I>&gt;<i> That's what I've done and it almost works perfectly so far. I just had to
</I>&gt;<i> add get-children to make the widgets visible in the tree view of glade (I'm
</I>&gt;<i> still not sure why).
</I>&gt;<i> So the problem I have is that is I add 1 to the column number, the widget
</I>&gt;<i> will add buttons automatically and make glade widgets too. However, only the
</I>&gt;<i> widget tree view in glade will not update.
</I>&gt;<i> It will only update on creation of the widget, or when I load it from a
</I>&gt;<i> saved file.
</I>&gt;<i> Yesterday I found that get-internal-child is called when I load it from a
</I>&gt;<i> saved file, so I was thinking that maybe I have to make a call to a function
</I>&gt;<i> or send a signal for the tree-view to get internal children again?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, Oct 4, 2010 at 18:20, Tristan Van Berkom &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/glade-users">tvb at gnome.org</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Tue, Oct 5, 2010 at 12:18 AM, Klaim &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/glade-users">mjklaim at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; Hi,
</I>&gt;&gt;<i> &gt; as disscussed there
</I>&gt;&gt;<i> &gt; :&#160;<A HREF="http://www.gtkforums.com/viewtopic.php?p=18030#18030">http://www.gtkforums.com/viewtopic.php?p=18030#18030</A>
</I>&gt;&gt;<i> &gt; I've managed to make my sub-widgets appear where I wanted, in the
</I>&gt;&gt;<i> &gt; treeview.
</I>&gt;&gt;<i> &gt; However, the treeview content will not be updated when I'll add new
</I>&gt;&gt;<i> &gt; seb-widget to my custom widget, or remove some from it.
</I>&gt;&gt;<i> &gt; I've been analzing and trying to reproduce some techniques that are used
</I>&gt;&gt;<i> &gt; in
</I>&gt;&gt;<i> &gt; gtk widgets plugin code that we can find here :
</I>&gt;&gt;<i> &gt; <A HREF="http://git.gnome.org/browse/glade3/tree/plugins/gtk+/glade-gtk.c">http://git.gnome.org/browse/glade3/tree/plugins/gtk+/glade-gtk.c</A>
</I>&gt;&gt;<i> &gt; I've been trying for several days but couldn't update the tree view.
</I>&gt;&gt;<i> &gt; I've implemented a plugin for glade, it provide (wired in the xml file)
</I>&gt;&gt;<i> &gt; :
</I>&gt;&gt;<i> &gt; &#160;&#160; &#160;post-create-function
</I>&gt;&gt;<i> &gt; &#160;&#160; &#160;set-property-function
</I>&gt;&gt;<i> &gt; &#160;&#160; &#160;get-internal-child-function
</I>&gt;&gt;<i> &gt; &#160;&#160; &#160;get-children-function
</I>&gt;&gt;<i> &gt; I see that the get-internal-child-function is not even called by glade
</I>&gt;&gt;<i> &gt; (then
</I>&gt;&gt;<i> &gt; I don't undersand when it should be called) but at the moment I
</I>&gt;&gt;<i> &gt; implemented
</I>&gt;&gt;<i> &gt; get-children-function I started to see the subwidgets in the glade
</I>&gt;&gt;<i> &gt; tree-view.
</I>&gt;&gt;<i> &gt; I've been following advices given there
</I>&gt;&gt;<i> &gt; :&#160;<A HREF="http://www.mail-archive.com/gtk-app-devel-list@gnome.org/msg12349.html">http://www.mail-archive.com/gtk-app-devel-list@gnome.org/msg12349.html</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I think I'm missing something simple as the gtk glade plugin code don't
</I>&gt;&gt;<i> &gt; seem
</I>&gt;&gt;<i> &gt; too complicated but I can't find how it makes the sub-children updated
</I>&gt;&gt;<i> &gt; in
</I>&gt;&gt;<i> &gt; the treeview.
</I>&gt;&gt;<i> &gt; When I load a gui built with glade and saved with modified number of
</I>&gt;&gt;<i> &gt; sub-widgets in my custom widget, I get the right count of sub-widgets in
</I>&gt;&gt;<i> &gt; the
</I>&gt;&gt;<i> &gt; tree-view. Only modifying it will not update the tree-view.
</I>&gt;&gt;<i> &gt; My custom widget have two properties with widgets counts that will add
</I>&gt;&gt;<i> &gt; or
</I>&gt;&gt;<i> &gt; remove widgets from the custom widget (in the widget code).
</I>&gt;&gt;<i> &gt; So in the plugin I've only added in post-create-function and
</I>&gt;&gt;<i> &gt; set-property-functino some way to call
</I>&gt;&gt;<i> &gt; glade_widget_adaptor_create_internal() on new digets added to the custom
</I>&gt;&gt;<i> &gt; widget.
</I>&gt;&gt;<i> &gt; It's the same function that is called in the two functions but it seem
</I>&gt;&gt;<i> &gt; to
</I>&gt;&gt;<i> &gt; work only with post-create-function.
</I>&gt;&gt;<i> &gt; Any suggestion?
</I>&gt;&gt;<i> &gt; I'm not sure if that question is clear enough, but tell me if it's not.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm a little confused about what exactly is not working for you.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you have a custom widget that is a GtkContainer, so long as
</I>&gt;&gt;<i> it works like an ordinary container you should not need to implement
</I>&gt;&gt;<i> anything custom along the lines of get-children or any of that.
</I>&gt;&gt;<i> (take the GtkBox implementation for reference in this case; it
</I>&gt;&gt;<i> uses a virtual 'size' property to decide how many placeholders
</I>&gt;&gt;<i> to expose in the Glade workspace).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Note that get-internal-child is for indirect children of composite
</I>&gt;&gt;<i> widgets. Thats what lets a GtkDialog configure properties and
</I>&gt;&gt;<i> add children to its internal 'vbox' or 'action-area' (I think thats
</I>&gt;&gt;<i> out of context for you, I think you just have a normal container).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What you need to do when implementing a normal container
</I>&gt;&gt;<i> is usually add placeholders to it if and when appropriate; then
</I>&gt;&gt;<i> you need to implement add-child-function/remove-child-function
</I>&gt;&gt;<i> and replace-child-function (replace-child will be called if your
</I>&gt;&gt;<i> plugin uses GladePlaceholder ... the Glade core will replace
</I>&gt;&gt;<i> the placeholder with a widget from the palette; giving it the
</I>&gt;&gt;<i> initial packing properties of the placeholder).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So, generally you should just start with add-child and remove-child
</I>&gt;&gt;<i> functions... you should not need to call
</I>&gt;&gt;<i> glade_widget_adaptor_create_internal()
</I>&gt;&gt;<i> unless you are exposing an internal child of a complex composite
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You dont need to implement get-children-function either unless you need
</I>&gt;&gt;<i> to add something to the generic child list already returned by your
</I>&gt;&gt;<i> container's implementation of GtkContainerClass-&gt;forall().
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Does that help ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please let me know in more detail what is the nature of your container
</I>&gt;&gt;<i> so I can better help you, is it a basic container widget that only lays
</I>&gt;&gt;<i> out
</I>&gt;&gt;<i> it's children in a custom way ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; -Tristan
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Thanks for reading
</I>&gt;&gt;<i> &gt; Joel Lamotte.
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Glade-users maillist &#160;- &#160;<A HREF="http://lists.ximian.com/mailman/listinfo/glade-users">Glade-users at lists.ximian.com</A>
</I>&gt;&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/glade-users">http://lists.ximian.com/mailman/listinfo/glade-users</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005109.html">[Glade-users] Viewing custom widget sub-widgets in Glade	tree-view
</A></li>
	<LI>Next message: <A HREF="005111.html">[Glade-users] Viewing custom widget sub-widgets in Glade	tree-view
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5110">[ date ]</a>
              <a href="thread.html#5110">[ thread ]</a>
              <a href="subject.html#5110">[ subject ]</a>
              <a href="author.html#5110">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/glade-users">More information about the Glade-users
mailing list</a><br>
</body></html>
