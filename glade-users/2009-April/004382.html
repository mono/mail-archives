<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] [gtkbuilder+glade3.4]The Child-window can not creat	again
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20%5Bgtkbuilder%2Bglade3.4%5DThe%20Child-window%20can%20not%20creat%0A%09again&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004381.html">
   <LINK REL="Next"  HREF="004383.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] [gtkbuilder+glade3.4]The Child-window can not creat	again</H1>
    <B>&#26045;&#24503;&#26469;delai</B> 
    <A HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20%5Bgtkbuilder%2Bglade3.4%5DThe%20Child-window%20can%20not%20creat%0A%09again&In-Reply-To="
       TITLE="[Glade-users] [gtkbuilder+glade3.4]The Child-window can not creat	again">wispernano at gmail.com
       </A><BR>
    <I>Tue Apr 28 02:43:00 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004381.html">[Glade-users] Determining GDK Event Mask
</A></li>
        <LI>Next message: <A HREF="004383.html">[Glade-users] [gtkbuilder+glade3.4]The Child-window can not	creat again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4382">[ date ]</a>
              <a href="thread.html#4382">[ thread ]</a>
              <a href="subject.html#4382">[ subject ]</a>
              <a href="author.html#4382">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I wirte a sample application use GktBuilder + glade3. there are one
main-window(top level) and some other child-window (top level too, creat and
show when the menu item is actived, in my code it is named window_rank).
after close the child-window for first time, i click the menu item again.
But this child-window cannot be created and showed again. with many errors
or warming like this:

(lsacs_gsecu:11866): GLib-GObject-WARNING **: invalid unclassed pointer in
cast to `GtkCList'

(lsacs_gsecu:11866): Gtk-CRITICAL **: gtk_clist_append: assertion
`GTK_IS_CLIST (clist)' failed

(lsacs_gsecu:11866): GLib-GObject-WARNING **: invalid unclassed pointer in
cast to `GtkCList'

(lsacs_gsecu:11866): Gtk-CRITICAL **: gtk_clist_set_text: assertion
`GTK_IS_CLIST (clist)' failed

(lsacs_gsecu:11866): GLib-GObject-WARNING **: invalid unclassed pointer in
cast to `GtkCList'

....

i thinke when i destroy the child-window, these UI data are freed, so i
cannot use builder again.
some one tell me that i can hide the child-window instead of destroy it, but
it will bring many terrible problem specially when the window contain
treeview.
so, do anyone can tell me how can i do with that child-window, or tell me
where can i find some example which develop by gktbuilder+glade

extremely grateful

*my code is here:*

main.c:

#include &quot;gsecu.h&quot;
#define BUILDER_XML_FILE &quot;gsecu.xml&quot;

gboolean init_app (LsacsGsecu *editor);
int main (int argc, char *argv[])
{
        LsacsGsecu *gsecu;
        gsecu = g_slice_new(LsacsGsecu);
        gtk_init (&amp;argc, &amp;argv);
        if (init_app (gsecu) == FALSE) return 1; /* error loading UI */
        gtk_widget_show(gsecu-&gt;window);
        gtk_main();
        return 0;
}


gboolean init_app (LsacsGsecu *gsecu)

{
        GtkBuilder *builder;
        GError                  *err=NULL;
        /* use GtkBuilder to build our interface from the XML file */
        builder = gtk_builder_new ();
        if (gtk_builder_add_from_file (builder, BUILDER_XML_FILE, &amp;err) == 0)
        {
                error_message (err-&gt;message);
                g_error_free (err);
                return FALSE;
        }

        /* get the widgets which will be referenced in callbacks */
        gsecu-&gt;window = GTK_WIDGET (gtk_builder_get_object (builder, &quot;window&quot;));
        //&#21021;&#22987;&#21270;&#23433;&#20840;&#31561;&#32423;
        gsecu-&gt;window_rank = GTK_WIDGET (gtk_builder_get_object
(builder, &quot;window_rank&quot;));
        gsecu-&gt;clist_rank = GTK_WIDGET (gtk_builder_get_object
(builder, &quot;clist_rank&quot;));
        gsecu-&gt;entry_rank = GTK_WIDGET (gtk_builder_get_object
(builder, &quot;entry_rank&quot;));
        /* connect signals, passing our LsacsGsecu struct as user data */
        gtk_builder_connect_signals (builder, gsecu);
        /* free memory used by GtkBuilder object */
        g_object_unref (G_OBJECT (builder));
        return TRUE;
}

inittable.c:

void on_initrank_activate (GtkObject *object, LsacsGsecu *gsecu)

{
        struct stat filebuf;
        gchar *p_space = &quot; &quot;;
        int fd,ranknum;
        int i;
        RANKNAME_SREC rankbuf;
        if((fd=open(LSACS_RANKNAME,O_RDWR|O_CREAT|O_APPEND))&lt;0)
        {
                OK_dialog(&quot;&#35835;&#21462;rankname&#25991;&#20214;&#20986;&#38169;&quot;, gsecu-&gt;window_rank);
                return;
        }
        fstat(fd,&amp;filebuf);
        ranknum=(filebuf.st_size/(sizeof(RANKNAME_SREC)));
        for(i=1;i&lt;=ranknum;i++)
        {
                gtk_clist_append(GTK_CLIST(gsecu-&gt;clist_rank), &amp;p_space);
                lseek(fd,(i-1)*sizeof(RANKNAME_SREC),SEEK_SET);
                read(fd,&amp;rankbuf,sizeof(RANKNAME_SREC));

gtk_clist_set_text(GTK_CLIST(gsecu-&gt;clist_rank),(i-1),0,rankbuf.rankname);
        }
        close(fd);
        gtk_clist_set_column_width (GTK_CLIST (gsecu-&gt;clist_rank), 0, 270);
        gtk_widget_show(gsecu-&gt;window_rank);
}

i have spended many many time to solve it, can some one help me !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/glade-users/attachments/20090428/b0f1aa3d/attachment-0001.html">http://lists.ximian.com/pipermail/glade-users/attachments/20090428/b0f1aa3d/attachment-0001.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004381.html">[Glade-users] Determining GDK Event Mask
</A></li>
	<LI>Next message: <A HREF="004383.html">[Glade-users] [gtkbuilder+glade3.4]The Child-window can not	creat again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4382">[ date ]</a>
              <a href="thread.html#4382">[ thread ]</a>
              <a href="subject.html#4382">[ subject ]</a>
              <a href="author.html#4382">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/glade-users">More information about the Glade-users
mailing list</a><br>
</body></html>
