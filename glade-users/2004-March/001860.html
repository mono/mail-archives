<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] Does glade work with GTK+  2.4?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:damon%40karuna.uklinux.net">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001859.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] Does glade work with GTK+  2.4?
   </H1>
    <B>Damon Chaplin
    </B> 
    <A HREF="mailto:damon%40karuna.uklinux.net"
       TITLE="[Glade-users] Does glade work with GTK+  2.4?">damon@karuna.uklinux.net
       </A><BR>
    <I>31 Mar 2004 12:13:54 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="001859.html">[Glade-users] Does glade work with GTK+  2.4?
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1860">[ date ]</a>
              <a href="thread.html#1860">[ thread ]</a>
              <a href="subject.html#1860">[ subject ]</a>
              <a href="author.html#1860">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-Sn+pD8sVldKIR2qwRdPE
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

On Wed, 2004-03-31 at 10:22, Gary Herron wrote:
&gt;<i> I just upgraded my GTK to version 2.4, and now glade is exhibiting the
</I>&gt;<i> following problem.
</I>&gt;<i> 
</I>&gt;<i> When I build a GUI which contains a toolbar, any toolbar buttons of
</I>&gt;<i> type Button or Toggle Button or Radio Button, disappear.  They show up
</I>&gt;<i> in the widget tree, but do not show up on the screen, and do not show
</I>&gt;<i> up in the XML file when saved.
</I>&gt;<i> 
</I>&gt;<i> Also, a previously built (before my upgrade), and fully working, GUI
</I>&gt;<i> which contains such toolbar buttons can not be safely read in and
</I>&gt;<i> written back out.  If I do so, all the buttons in the toolbar are
</I>&gt;<i> lost. (That is the XML description of the toolbar contains no &lt;child&gt;
</I>&gt;<i> tags.)
</I>&gt;<i> 
</I>&gt;<i> Before my upgrade to GTK 2.4, the version of glade I was using (How
</I>&gt;<i> can I tell wwhich version I had?) worked fine with toolbars.  After my
</I>&gt;<i> upgrade to 2.4, the problem occurs with whatever version of glade I
</I>&gt;<i> was previously running, as well as newly built versions glade-2.0.1
</I>&gt;<i> and glade-2.5.0.
</I>
The GTK+ toolbar changed internally in GTK+ 2.4, so glade 2.0.1 will not
work with it.

Glade 2.5.0 should work OK with normal/radio/toggle buttons, but there
is a bug which means any other widgets are lost. I'm about to do a new
release which fixes that.

I've attached the relevant patch if you want tot try it.

Damon


--=-Sn+pD8sVldKIR2qwRdPE
Content-Disposition: attachment; filename=glade.patch
Content-Type: text/plain; name=glade.patch; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

--- glade-2.5.0/glade/gbwidgets/gbtoolbar.c	2004-03-17 17:14:09.000000000 +0000
+++ glade-2.5.1/glade/gbwidgets/gbtoolbar.c	2004-03-28 17:15:06.000000000 +0100
@@ -159,11 +159,25 @@
       gtk_toolbar_insert (GTK_TOOLBAR (widget),
 			  GTK_TOOL_ITEM (toolitem), -1);
     }
-  else
+  /* GtkToolItems can just be added as they are. */
+  else if (GTK_IS_TOOL_ITEM (child))
     {
       gtk_toolbar_insert (GTK_TOOLBAR (widget),
 			  GTK_TOOL_ITEM (child), -1);
     }
+  /* Any other widgets are from the old GTK+ 2.2 files, and we need to insert
+     a GtkToolItem. */
+  else
+    {
+      GtkWidget *toolitem = gb_widget_new_full (&quot;GtkToolItem&quot;, FALSE,
+						NULL, NULL, 0, 0, NULL,
+						GB_LOADING, data);
+      gtk_toolbar_insert (GTK_TOOLBAR (widget),
+			  GTK_TOOL_ITEM (toolitem), -1);
+      tree_add_widget (toolitem);
+
+      gtk_container_add (GTK_CONTAINER (toolitem), child);
+    }
 }
 
 

--=-Sn+pD8sVldKIR2qwRdPE--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001859.html">[Glade-users] Does glade work with GTK+  2.4?
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1860">[ date ]</a>
              <a href="thread.html#1860">[ thread ]</a>
              <a href="subject.html#1860">[ subject ]</a>
              <a href="author.html#1860">[ author ]</a>
         </LI>
       </UL>
</body></html>
