<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] Update progressbar from forked child
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Update%20progressbar%20from%20forked%20child&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003160.html">
   <LINK REL="Next"  HREF="003162.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] Update progressbar from forked child</H1>
    <B>Steven</B> 
    <A HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Update%20progressbar%20from%20forked%20child&In-Reply-To="
       TITLE="[Glade-users] Update progressbar from forked child">steven at whoaa.be
       </A><BR>
    <I>Mon Nov 20 05:46:26 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="003160.html">[Glade-users] Glade runtime assertions for no apparent reason
</A></li>
        <LI>Next message: <A HREF="003162.html">[Glade-users] Update progressbar from forked child
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3161">[ date ]</a>
              <a href="thread.html#3161">[ thread ]</a>
              <a href="subject.html#3161">[ subject ]</a>
              <a href="author.html#3161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there,

This is my first attempt to Gtk Programming in Glade. Although I know
php and a little VB, It's been a long time since I used ansi C and maybe
I'm doing stupid things.  Please feel free to point them out :-)

I'm trying to make a front-end to ufraw-batch, a CLI program to convert
RAW images to a standard format.
I've built a nice interface to select the files and some options, and
ofcourse a start-button :-)
When I press start, I want the following to happen:
- All selected RAW images will be converted one by one
- Application window can't freeze while converting, I want to be able to
show a progress bar and status info
- After each image converted, I want to update the progress bar

The code I've writte to do that is pasted below...
(It works, the window isn't freezing until after the converts of all
files, but the progressbar is not updated)
(watch the use of 'fork' and 'vfork'. If I don't do it that way, the app
freezes until after convertion or the execve-statement isn't executed)
(To get rid of the first child after termination, I've created a signal
handler for SIGCHLD which executes &quot;wait(NULL);&quot;)

If there are other, more standard ways, to do what I'm doing, please
tell me :-)  I'm not familiar with programming a GUI, but I know php
quiet well and I want to learn... 


Thx in advance
Steven


============== CODE ==============

    char *argv[] = {&quot;&quot;, ...}

    int pid=fork();
    if (pid == 0)
    {
        while (files)
        {
            pid=vfork ();
            if (pid == 0)
            {
                GtkWidget *progressbar =
lookup_widget(GTK_WIDGET(button), &quot;progressbar1&quot;);
printf(&quot;Set fraction from %f to %f\n&quot;,
gtk_progress_bar_get_fraction(progressbar), counter*PBfraction+PBfraction);
                gtk_progress_bar_set_fraction(progressbar,
(counter*PBfraction+PBfraction));
                execve(&quot;/usr/bin/ufraw-batch&quot;, argv, envp);
                _exit(0);
            }
            else
            {
                wait(NULL);
            }
            counter++;
        }
        _exit(0)
    }

============== /CODE ==============
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003160.html">[Glade-users] Glade runtime assertions for no apparent reason
</A></li>
	<LI>Next message: <A HREF="003162.html">[Glade-users] Update progressbar from forked child
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3161">[ date ]</a>
              <a href="thread.html#3161">[ thread ]</a>
              <a href="subject.html#3161">[ subject ]</a>
              <a href="author.html#3161">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/glade-users">More information about the Glade-users
mailing list</a><br>
</body></html>
