<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] unexplainable crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:alef%40xs4all.nl">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001707.html">
   <LINK REL="Next"  HREF="001709.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] unexplainable crash
   </H1>
    <B>Alef T Veld
    </B> 
    <A HREF="mailto:alef%40xs4all.nl"
       TITLE="[Glade-users] unexplainable crash">alef@xs4all.nl
       </A><BR>
    <I>Mon, 29 Dec 2003 14:17:25 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="001707.html">[Glade-users] How to refresh pixmap with glade 1.0
</A></li>
        <LI> Next message: <A HREF="001709.html">[Glade-users] unexplainable crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1708">[ date ]</a>
              <a href="thread.html#1708">[ thread ]</a>
              <a href="subject.html#1708">[ subject ]</a>
              <a href="author.html#1708">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,

I don't know if this is GTK related or not, i always have a lot of GTK errors mostly due to casting i think,
but here is a weird one. I would appreciate it if someone could tell me if it's the linked list code or the
gtk code involved.

I had put multiple g_warning() statements so i could locate the culprit, but the code seems to be memory
related as it crashes on different times, different code spots. So i'm suspecting the linked list code.

The code is basically a calendar widget with a notebook that tries to connect data put in the notebooks tabs
with a certain date on the calendar widget by matching timestamps.

Thanks very much.

/* cut here */
 char *string;
        schedule *tmp=head;
        time_t dateedit1;
        struct tm *tstruct;

        /* Setup the string */
        strcat(string,gtk_entry_get_text(GTK_ENTRY(glade_xml_get_widget(xml,&quot;entry1&quot;))));

        /* Setup the date */
        dateedit1=gnome_date_edit_get_time((GnomeDateEdit *)glade_xml_get_widget(xml,&quot;dateedit1&quot;));
        tstruct=localtime(&amp;dateedit1);

        /* Get a node */
        if(tail==NULL) {
        g_warning(&quot;First record in schedule allocated&quot;);
        tail=malloc(sizeof(*tail));
        tail-&gt;string=malloc(sizeof(*string));
        tail-&gt;timestamp=malloc(sizeof(asctime(tstruct)));
        strcpy(tail-&gt;string,string);
        strcpy(tail-&gt;timestamp,asctime(tstruct));
        tail-&gt;year=tstruct-&gt;tm_year;
        tail-&gt;month=tstruct-&gt;tm_mon;
        tail-&gt;day=tstruct-&gt;tm_mday;
        tail-&gt;next=NULL;
        head=tail;
        } else {
        g_warning(&quot;New record in schedule allocated&quot;);
        /* First check if a day is already booked */
        while(tmp!=NULL) {
	if(!strcmp(tmp-&gt;timestamp,asctime(tstruct))) {
        g_warning(&quot;Date already booked in Calendar Widget&quot;);
        gtk_widget_hide(window1);
        return -1;}
        tmp=tmp-&gt;next;
        }
        tail-&gt;next=malloc(sizeof(*tail));
        tail=tail-&gt;next;
        tail-&gt;string=malloc(sizeof(*string));
        tail-&gt;timestamp=malloc(sizeof(asctime(tstruct)));
        strcpy(tail-&gt;string,string);
        strcpy(tail-&gt;timestamp,asctime(tstruct));
        tail-&gt;year=tstruct-&gt;tm_year;
        tail-&gt;month=tstruct-&gt;tm_mon;
        tail-&gt;day=tstruct-&gt;tm_mday;
        tail-&gt;next=NULL;
        }

        /* And mark the Calendar day so the user will know there's something scheduled */
        gtk_calendar_select_month((GtkCalendar *)glade_xml_get_widget(xml,&quot;calendar1&quot;),
                                                        (guint)tstruct-&gt;tm_mon,
                                                        (guint)tstruct-&gt;tm_year);

        gtk_calendar_mark_day((GtkCalendar *)glade_xml_get_widget(xml,&quot;calendar1&quot;),(guint)tstruct-&gt;tm_mday);

	/* And hide again cause on startup window1 visible=FALSE, we only do gtk_widget_show when user
	presses a button in the app1 window (main app window) */
        gtk_widget_hide(window1);
        }


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001707.html">[Glade-users] How to refresh pixmap with glade 1.0
</A></li>
	<LI> Next message: <A HREF="001709.html">[Glade-users] unexplainable crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1708">[ date ]</a>
              <a href="thread.html#1708">[ thread ]</a>
              <a href="subject.html#1708">[ subject ]</a>
              <a href="author.html#1708">[ author ]</a>
         </LI>
       </UL>
</body></html>
