<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] Possible bug with File-chooser dialog?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Possible%20bug%20with%20File-chooser%20dialog%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004847.html">
   <LINK REL="Next"  HREF="004849.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] Possible bug with File-chooser dialog?</H1>
    <B>alsaf</B> 
    <A HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Possible%20bug%20with%20File-chooser%20dialog%3F&In-Reply-To="
       TITLE="[Glade-users] Possible bug with File-chooser dialog?">alfraealba at googlemail.com
       </A><BR>
    <I>Tue Jan  5 15:52:48 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004847.html">[Glade-users] How to add widgets to the Gtkassistant
</A></li>
        <LI>Next message: <A HREF="004849.html">[Glade-users] Possible bug with File-chooser dialog?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4848">[ date ]</a>
              <a href="thread.html#4848">[ thread ]</a>
              <a href="subject.html#4848">[ subject ]</a>
              <a href="author.html#4848">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am just new to glade so not sure if this is a bug or a
misunderstanding on my part as I have an alternative way of doing what I
want working.

To give a bit of a background, I am converting GTK hardcoded code in my
python program to glade files. One part of the GTK code in my program is
a dialog which has a text entry and a button beside it when clicked
opens a filechooser dialog which populates the text entry with selected
folder. The glade file is as follows:

File: options.glade
******************************************************
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;interface&gt;
  &lt;requires lib=&quot;gtk+&quot; version=&quot;2.16&quot;/&gt;
  &lt;!-- interface-naming-policy project-wide --&gt;
  &lt;object class=&quot;GtkDialog&quot; id=&quot;dialog&quot;&gt;
    &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
    &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Options&lt;/property&gt;
    &lt;property name=&quot;modal&quot;&gt;True&lt;/property&gt;
    &lt;property name=&quot;window_position&quot;&gt;center&lt;/property&gt;
    &lt;property name=&quot;destroy_with_parent&quot;&gt;True&lt;/property&gt;
    &lt;property name=&quot;type_hint&quot;&gt;normal&lt;/property&gt;
    &lt;property name=&quot;has_separator&quot;&gt;False&lt;/property&gt;
    &lt;signal name=&quot;response&quot; handler=&quot;response_cb&quot;/&gt;
    &lt;child internal-child=&quot;vbox&quot;&gt;
      &lt;object class=&quot;GtkVBox&quot; id=&quot;dialog-vbox1&quot;&gt;
        &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
        &lt;property name=&quot;orientation&quot;&gt;vertical&lt;/property&gt;
        &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
        &lt;child&gt;
          &lt;object class=&quot;GtkHBox&quot; id=&quot;hbox1&quot;&gt;
            &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
            &lt;child&gt;
              &lt;object class=&quot;GtkLabel&quot; id=&quot;label&quot;&gt;
                &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;MP3 Player
Folder&lt;/property&gt;
              &lt;/object&gt;
              &lt;packing&gt;
                &lt;property name=&quot;position&quot;&gt;0&lt;/property&gt;
              &lt;/packing&gt;
            &lt;/child&gt;
            &lt;child&gt;
              &lt;object class=&quot;GtkEntry&quot; id=&quot;mp3_entry&quot;&gt;
                &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;invisible_char&quot;&gt;&amp;#x25CF;&lt;/property&gt;
              &lt;/object&gt;
              &lt;packing&gt;
                &lt;property name=&quot;position&quot;&gt;1&lt;/property&gt;
              &lt;/packing&gt;
            &lt;/child&gt;
            &lt;child&gt;
              &lt;object class=&quot;GtkButton&quot; id=&quot;mp3_button&quot;&gt;
                &lt;property name=&quot;label&quot;
translatable=&quot;yes&quot;&gt;Browse...&lt;/property&gt;
                &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;receives_default&quot;&gt;True&lt;/property&gt;
                &lt;signal name=&quot;clicked&quot; handler=&quot;mp3_button_cp&quot;/&gt;
              &lt;/object&gt;
              &lt;packing&gt;
                &lt;property name=&quot;position&quot;&gt;2&lt;/property&gt;
              &lt;/packing&gt;
            &lt;/child&gt;
          &lt;/object&gt;
          &lt;packing&gt;
            &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
            &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
            &lt;property name=&quot;position&quot;&gt;1&lt;/property&gt;
          &lt;/packing&gt;
        &lt;/child&gt;
        &lt;child internal-child=&quot;action_area&quot;&gt;
          &lt;object class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area1&quot;&gt;
            &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
            &lt;property name=&quot;layout_style&quot;&gt;end&lt;/property&gt;
            &lt;child&gt;
              &lt;object class=&quot;GtkButton&quot; id=&quot;dialog_cancel&quot;&gt;
                &lt;property name=&quot;label&quot;
translatable=&quot;yes&quot;&gt;Cancel&lt;/property&gt;
                &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;receives_default&quot;&gt;True&lt;/property&gt;
              &lt;/object&gt;
              &lt;packing&gt;
                &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;position&quot;&gt;0&lt;/property&gt;
              &lt;/packing&gt;
            &lt;/child&gt;
            &lt;child&gt;
              &lt;object class=&quot;GtkButton&quot; id=&quot;dialog_ok&quot;&gt;
                &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;OK&lt;/property&gt;
                &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;receives_default&quot;&gt;True&lt;/property&gt;
              &lt;/object&gt;
              &lt;packing&gt;
                &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;position&quot;&gt;1&lt;/property&gt;
              &lt;/packing&gt;
            &lt;/child&gt;
          &lt;/object&gt;
          &lt;packing&gt;
            &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
            &lt;property name=&quot;pack_type&quot;&gt;end&lt;/property&gt;
            &lt;property name=&quot;position&quot;&gt;0&lt;/property&gt;
          &lt;/packing&gt;
        &lt;/child&gt;
      &lt;/object&gt;
    &lt;/child&gt;
    &lt;action-widgets&gt;
      &lt;action-widget response=&quot;1&quot;&gt;dialog_cancel&lt;/action-widget&gt;
      &lt;action-widget response=&quot;2&quot;&gt;dialog_ok&lt;/action-widget&gt;
    &lt;/action-widgets&gt;
  &lt;/object&gt;
  &lt;object class=&quot;GtkFileChooserDialog&quot; id=&quot;mp3_fcd&quot;&gt;
    &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
    &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Select MP3 Player Mount
Folder..&lt;/property&gt;
    &lt;property name=&quot;modal&quot;&gt;True&lt;/property&gt;
    &lt;property name=&quot;window_position&quot;&gt;center&lt;/property&gt;
    &lt;property name=&quot;destroy_with_parent&quot;&gt;True&lt;/property&gt;
    &lt;property name=&quot;type_hint&quot;&gt;normal&lt;/property&gt;
    &lt;property name=&quot;has_separator&quot;&gt;False&lt;/property&gt;
    &lt;property name=&quot;action&quot;&gt;select-folder&lt;/property&gt;
    &lt;property name=&quot;create_folders&quot;&gt;False&lt;/property&gt;
    &lt;child internal-child=&quot;vbox&quot;&gt;
      &lt;object class=&quot;GtkVBox&quot; id=&quot;dialog-vbox2&quot;&gt;
        &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
        &lt;property name=&quot;orientation&quot;&gt;vertical&lt;/property&gt;
        &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
        &lt;child&gt;
          &lt;placeholder/&gt;
        &lt;/child&gt;
        &lt;child internal-child=&quot;action_area&quot;&gt;
          &lt;object class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area2&quot;&gt;
            &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
            &lt;property name=&quot;layout_style&quot;&gt;end&lt;/property&gt;
            &lt;child&gt;
              &lt;object class=&quot;GtkButton&quot; id=&quot;fc_cancel&quot;&gt;
                &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
                &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;receives_default&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
              &lt;/object&gt;
              &lt;packing&gt;
                &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;position&quot;&gt;0&lt;/property&gt;
              &lt;/packing&gt;
            &lt;/child&gt;
            &lt;child&gt;
              &lt;object class=&quot;GtkButton&quot; id=&quot;fc_select&quot;&gt;
                &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
                &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;receives_default&quot;&gt;True&lt;/property&gt;
                &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
              &lt;/object&gt;
              &lt;packing&gt;
                &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
                &lt;property name=&quot;position&quot;&gt;1&lt;/property&gt;
              &lt;/packing&gt;
            &lt;/child&gt;
          &lt;/object&gt;
          &lt;packing&gt;
            &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
            &lt;property name=&quot;pack_type&quot;&gt;end&lt;/property&gt;
            &lt;property name=&quot;position&quot;&gt;0&lt;/property&gt;
          &lt;/packing&gt;
        &lt;/child&gt;
      &lt;/object&gt;
    &lt;/child&gt;
    &lt;action-widgets&gt;
      &lt;action-widget response=&quot;0&quot;&gt;fc_cancel&lt;/action-widget&gt;
      &lt;action-widget response=&quot;1&quot;&gt;fc_select&lt;/action-widget&gt;
    &lt;/action-widgets&gt;
  &lt;/object&gt;
  &lt;object class=&quot;GtkAction&quot; id=&quot;action1&quot;/&gt;
&lt;/interface&gt;
************************************************************

The test file written in python is as follows:

options.py
************************************************************
import sys
import gtk
  
class template:
	def mp3_button_cp(self, widget, data=None):
		self.mp3_fcd.set_current_folder(&quot;/&quot;)
		response = self.mp3_fcd.run()
		print &quot;this is response &quot; + str (response)
		if response == 1:
			self.mp3_entry.set_text(self.mp3_fcd.get_filename())
	 	self.mp3_fcd.destroy()	
	
	def response_cb(self, widget, response_id):
		print &quot;This is response_id&quot; + str(response_id)
		self.dialog.destroy()

	def __init__(self):
		builder = gtk.Builder()
		builder.add_from_file(&quot;options.glade&quot;) 
		self.dialog = builder.get_object(&quot;dialog&quot;)
		self.mp3_fcd = builder.get_object(&quot;mp3_fcd&quot;)	
		self.mp3_entry = builder.get_object(&quot;mp3_entry&quot;)
		builder.connect_signals(self)
		self.dialog.show()

if __name__ == &quot;__main__&quot;:
	editor = template()
	gtk.main()
**************************************************************

The program works properly until you click on Browse... button again
where a blank filechooser dialog button appears and the following error
messages appear in console:


*****************************************************
options.py:6: GtkWarning: gtk_file_chooser_set_current_folder_file:
assertion `GTK_IS_FILE_CHOOSER (chooser)' failed
  self.mp3_fcd.set_current_folder(&quot;/&quot;)
options.py:7: GtkWarning: gtk_container_foreach: assertion
`GTK_IS_CONTAINER (container)' failed
  response = self.mp3_fcd.run()
options.py:7: GtkWarning: gtk_widget_map: assertion `GTK_IS_WIDGET
(widget)' failed
  response = self.mp3_fcd.run()
options.py:7: GtkWarning: _gtk_file_chooser_embed_initial_focus:
assertion `GTK_IS_FILE_CHOOSER_EMBED (chooser_embed)' failed
  response = self.mp3_fcd.run()
this is response -1
options.py:11: GtkWarning: gtk_widget_unmap: assertion `GTK_IS_WIDGET
(widget)' failed
  self.mp3_fcd.destroy()
*****************************************************

I have amended the code for the following and the behaviour still
occurs:

* create a new gtk.builder (calling it builder2) object solely for
mp3_fcd glade object
* moved mp3cp_fcd creation in mp3_button_cp callback function
* create a gtk.builder variable and mp3cp_fcd in mp3_button_cp function

I then proceeded to create a new glade file with just the fildechooser
dialog in it and obviously amending the code to create a new gtk.builder
object for it. I then ran the program and it worked properly with no
errors.

Is this a bug or has certain dialog got to be in separate files?

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004847.html">[Glade-users] How to add widgets to the Gtkassistant
</A></li>
	<LI>Next message: <A HREF="004849.html">[Glade-users] Possible bug with File-chooser dialog?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4848">[ date ]</a>
              <a href="thread.html#4848">[ thread ]</a>
              <a href="subject.html#4848">[ subject ]</a>
              <a href="author.html#4848">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/glade-users">More information about the Glade-users
mailing list</a><br>
</body></html>
