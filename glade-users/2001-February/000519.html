<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] Threading with GTK/Glade
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:james.cameron%40compaq.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000523.html">
   <LINK REL="Next"  HREF="000515.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] Threading with GTK/Glade
   </H1>
    <B>James Cameron
    </B> 
    <A HREF="mailto:james.cameron%40compaq.com"
       TITLE="[Glade-users] Threading with GTK/Glade">james.cameron@compaq.com
       </A><BR>
    <I>Tue, 27 Feb 2001 09:35:32 +1100</I>
    <P><UL>
        <LI> Previous message: <A HREF="000523.html">[Glade-users] Allocation error from Glade.....
</A></li>
        <LI> Next message: <A HREF="000515.html">[Glade-users] glade2perl problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#519">[ date ]</a>
              <a href="thread.html#519">[ thread ]</a>
              <a href="subject.html#519">[ subject ]</a>
              <a href="author.html#519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Johnathan,

I understand the need to keep the design of the interaction with the
external device in one piece of code ... I've done lots of state
critical code; microcontrollers, digital RF base stations, and computer
to computer communication.

Having thought again about the physical configuration you describe, I
would recommend a per serial port process instead of one for all ports.

Under Linux or another UNIX based operating system, you might then have
the following processes;

- gui
  - port 1
  - port 2
  - port 3
  etc

This will allow you to write the port processes without any threading;
instead using the operating system for process context switching.  No
efficiency change; your time is more expensive anyway.  An advantage of
using processes is that each process is isolated from the others, so a
fault (never! ;-)) in one process will not propogate and take down the
system as a whole.

Your description of operations suggests an event sequence to me; which
would represent the communication between the GUI process and the port
processes.

port -&gt; gui : &quot;i'm port 4; i'm started&quot;
port -&gt; gui : &quot;i'm port 4; gizmo detected, serial number x, programming&quot;
port -&gt; gui : &quot;i'm port 4; programming complete, success|fail&quot;

I note there doesn't appear to be any communication in the other
direction.  If that is so, a simple shared pipe would be sufficient. 
I'd recommend a text protocol for ease of testing; you can use echo to
write messages into the pipe.  Here is how I see the GUI operating;

a) the GUI creates the pipe,
b) the GUI fork()'s and exec()'s the port processes attached to pipe,
c) the GUI tells GTK+ that the pipe is an input source,
   (using gtk_input_add_full)
d) the GUI returns to the GTK+ main loop,
e) GTK+ calls the GUI handler when a message arrives in the pipe,
f) the handler figures out what to update on screen and returns.

Have a look at my gtsl program on <A HREF="http://quozl.netrek.org/ts/">http://quozl.netrek.org/ts/</A> for an
example of connecting a Glade application to an external event source;
in this case a serial port.

-- 
James Cameron                                 (<A HREF="mailto:james.cameron@compaq.com">james.cameron@compaq.com</A>)

<A HREF="http://quozl.linux.org.au/">http://quozl.linux.org.au/</A>         (or)         <A HREF="http://quozl.netrek.org/">http://quozl.netrek.org/</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000523.html">[Glade-users] Allocation error from Glade.....
</A></li>
	<LI> Next message: <A HREF="000515.html">[Glade-users] glade2perl problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#519">[ date ]</a>
              <a href="thread.html#519">[ thread ]</a>
              <a href="subject.html#519">[ subject ]</a>
              <a href="author.html#519">[ author ]</a>
         </LI>
       </UL>
</body></html>
