<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] gtk/glade programming
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:seb%40hypercubesystems.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001565.html">
   <LINK REL="Next"  HREF="001566.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] gtk/glade programming
   </H1>
    <B>Seb James
    </B> 
    <A HREF="mailto:seb%40hypercubesystems.co.uk"
       TITLE="[Glade-users] gtk/glade programming">seb@hypercubesystems.co.uk
       </A><BR>
    <I>25 Sep 2003 13:04:22 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="001565.html">[Glade-users] gtk/glade programming
</A></li>
        <LI> Next message: <A HREF="001566.html">[Glade-users] Backporting to gtk1.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1568">[ date ]</a>
              <a href="thread.html#1568">[ thread ]</a>
              <a href="subject.html#1568">[ subject ]</a>
              <a href="author.html#1568">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 2003-09-25 at 10:27, Seb James wrote:
&gt;<i> Hello all,
</I>&gt;<i> 
</I>&gt;<i> My application receives serial data. It has the following code in main.c
</I>&gt;<i> to set up the creation of a signal everytime a line is ready to be read
</I>&gt;<i> on the serial port:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 	/* Now we need to set things up so that receiving a line
</I>&gt;<i> 	   on the serial port will generate a signal to decode the 
</I>&gt;<i> 	   input and display it. */
</I>&gt;<i> 	serial_input_tag = gdk_input_add (fd, GDK_INPUT_READ, 
</I>&gt;<i> 					  on_serial_data_receive, 
</I>&gt;<i> 					  &amp;target_io_states);    
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And the following code to handle that signal in callbacks.c:
</I>&gt;<i> 
</I>&gt;<i> void
</I>&gt;<i> on_serial_data_receive                 (gpointer            user_data,
</I>&gt;<i> 					gint                fd,
</I>&gt;<i> 					GdkInputCondition   target_io_states)
</I>&gt;<i> {
</I>&gt;<i> 	GtkWidget *console_textview;
</I>&gt;<i> 
</I>&gt;<i> 	char buf[255];
</I>&gt;<i> 	gint res;
</I>&gt;<i> 
</I>&gt;<i> 	/* Don't know how to call lookup_widget in this case: */
</I>&gt;<i> 	console_textview = lookup_widget (GTK_WIDGET (console_textview), &quot;console_textview&quot;);
</I>&gt;<i> 
</I>&gt;<i> 	res = read(fd,buf,255); 
</I>&gt;<i> 	buf[res]=0;  /* set end of string, so we can printf */
</I>&gt;<i> 
</I>&gt;<i> 	/* print the received data to sdout */
</I>&gt;<i> 	printf(&quot;Buffer:%sNumber of characters:%d\n&quot;, buf, res);
</I>&gt;<i> 
</I>&gt;<i> 	/* Plus output it to the console window: */
</I>&gt;<i> 	gtk_text_buffer_set_text (gtk_text_view_get_buffer (GTK_TEXT_VIEW (console_textview)),
</I>&gt;<i> 				  _(&quot;Buffer text&quot;), -1);
</I>&gt;<i> 	/* How to replace &quot;Buffer text&quot; with &quot;%s&quot;, buf ? */
</I>&gt;<i> 
</I>&gt;<i> 	return;
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> The comments show my problems - I need to get the text from the serial
</I>&gt;<i> port onto a console window that I've created in glade. The problem seems
</I>&gt;<i> to be with looking up the widget. The form that I need my signal handler
</I>&gt;<i> in doesn't have a `parent' widget for lookup_widget to search for
</I>&gt;<i> console_textview in.
</I>&gt;<i> 
</I>&gt;<i> I'm trying to do something like that which I programmed for, for
</I>&gt;<i> example, closing the console window when its close button is clicked:
</I>&gt;<i> 
</I>&gt;<i> void
</I>&gt;<i> on_close_console_clicked               (GtkButton       *button,
</I>&gt;<i>                                         gpointer         user_data)
</I>&gt;<i> {
</I>&gt;<i> 	GtkWidget *console;
</I>&gt;<i> 	console = lookup_widget (GTK_WIDGET (button), &quot;console&quot;);
</I>&gt;<i> 	gtk_widget_destroy (console);
</I>&gt;<i> 
</I>&gt;<i> 	return;
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> In this code, you put in GTK_WIDGET (button) as the first argument of
</I>&gt;<i> lookup_widget. button is a pointer to the button you clicked, and so
</I>&gt;<i> lookup_widget finds console, as it is the parent of the button. However,
</I>&gt;<i> my serial_data_receive function has no such widget passed to it. How can
</I>&gt;<i> I use lookup_widget here?
</I>&gt;<i> 
</I>&gt;<i> Can anyone help with this?
</I>
I found out how to work this out. I created a global variable, 
GtkWidget *console_window_global, which I set to being equal to the
variable console, when the console is created. Then, I pass this
variable as the first argument to lookup_widget(). That works, as
lookup_widget can now find the text area that is a child of console.


&gt;<i> Thanks
</I>&gt;<i> 
</I>&gt;<i> Seb.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Glade-users maillist  -  <A HREF="mailto:Glade-users@lists.ximian.com">Glade-users@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/glade-users">http://lists.ximian.com/mailman/listinfo/glade-users</A>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001565.html">[Glade-users] gtk/glade programming
</A></li>
	<LI> Next message: <A HREF="001566.html">[Glade-users] Backporting to gtk1.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1568">[ date ]</a>
              <a href="thread.html#1568">[ thread ]</a>
              <a href="subject.html#1568">[ subject ]</a>
              <a href="author.html#1568">[ author ]</a>
         </LI>
       </UL>
</body></html>
