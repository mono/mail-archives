<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] Making my own Classes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Making%20my%20own%20Classes&In-Reply-To=1192399062.6092.55.camel%40zdra-laptop">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003649.html">
   <LINK REL="Next"  HREF="003651.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] Making my own Classes</H1>
    <B>Xavier Claessens</B> 
    <A HREF="mailto:glade-users%40lists.ximian.com?Subject=%5BGlade-users%5D%20Making%20my%20own%20Classes&In-Reply-To=1192399062.6092.55.camel%40zdra-laptop"
       TITLE="[Glade-users] Making my own Classes">xclaesse at gmail.com
       </A><BR>
    <I>Sun Oct 14 18:44:55 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003649.html">[Glade-users] Making my own Classes
</A></li>
        <LI>Next message: <A HREF="003651.html">[Glade-users] Making my own Classes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3650">[ date ]</a>
              <a href="thread.html#3650">[ thread ]</a>
              <a href="subject.html#3650">[ subject ]</a>
              <a href="author.html#3650">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hum, I'm not sure it can solve my problem... Here is what I want to do:

1) I create a foo.glade file, the root widget is a GtkVBox, I pack in it
logs of GTK widgets.
2) Manually I rename the root widget class from GtkVBox to EmpathyFoo,
EmpathyFoo is a class inheriting from GtkVBox implemented in libempathy-gtk.
3) Using gtk-builder-convert I convert foo.glade to foo.ui
4) I make a method empathy_foo_new(){return gtk_builder_get_object(foo.ui,
root);} With that function I think GtkBuilder will do a
g_object_new(empathy_foo_get_type(), NULL); and then it will pack all
widgets in it as described in the .ui file. If that works, glade will
introspect my widget, see all packed widgets and display me their properties
but won't allow me to removed them since they are internal childs?

My questions are:
1) If I write a catalog for EmpathyFoo widget, glade-3 will need to call
empathy_foo_new() to create my widget, not g_object_new() because the widget
needs to be constructed by GtkBuilder to have all needed widgets packed in
it. How can I do that?
2) If I want to modify EmpathyFoo object, I open foo.glade using glade-3,
but I changed the root type to from GtkVBox to EmpathyFoo, what will glade
do? Will it use empathy_foo_get_type() and then pack in it all widgets and
allows me to modify everything? If that works I can convert the new glade
file to foo.ui and I'm happy.

The problem I see is glade-3 needs to use
g_object_new(empathy_foo_get_type(), NULL); when I'm editing foo.glade and
empathy_foo_new() when I'm using a EmpathyFoo widget in another glade file.
Is glade able to manage that?

Thanks,
Xavier Claessens.

2007/10/14, Xavier Claessens &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/glade-users">xclaesse at gmail.com</A>&gt;:
&gt;<i>
</I>&gt;<i> Thanks for answering that fast;
</I>&gt;<i>
</I>&gt;<i> On your blog I see the &quot;parent&quot; attribute, seems exactly what I need.
</I>&gt;<i> It's not documented [1]? If I understand the patch for the &quot;parent&quot;
</I>&gt;<i> attribute, I write a catalog with my EmpathyFoo widget and say the
</I>&gt;<i> parent class is GtkHBox. When someone wants to embed my widget in the
</I>&gt;<i> glade UI, glade will create a GtkHBox object, pack everything in it so
</I>&gt;<i> it looks like a EmpathyFoo but it's not really one?
</I>&gt;<i>
</I>&gt;<i> Xavier Claessens.
</I>&gt;<i>
</I>&gt;<i> [1] <A HREF="http://glade.gnome.org/docs/index.html">http://glade.gnome.org/docs/index.html</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Le dimanche 14 octobre 2007 &#224; 16:20 -0400, Tristan Van Berkom a &#233;crit :
</I>&gt;<i> &gt; On Sun, 2007-10-14 at 17:55 +0200, Xavier Claessens wrote:
</I>&gt;<i> &gt; [...]
</I>&gt;<i> &gt; &gt; But how will glade-3 react if I want to edit my glade file? It will
</I>&gt;<i> see
</I>&gt;<i> &gt; &gt; a unknown widget type... Is there a way to tell glade that EmpathyFoo
</I>&gt;<i> is
</I>&gt;<i> &gt; &gt; just like GtkHBox but when a client wants to instantiate it should use
</I>&gt;<i> &gt; &gt; g_object_new(Empathy_foo_get_type(), NULL);
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; And if I write a catalog xml file to describe properties of my
</I>&gt;<i> &gt; &gt; EmpathyFoo widget, then other programs will be able to embed a
</I>&gt;<i> &gt; &gt; EmpathyFoo widget in their UI, but will they be able to modify widgets
</I>&gt;<i> &gt; &gt; packed in it?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yes.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; So I have a foo.glade describing my EmpathyFoo widget, if I edit that
</I>&gt;<i> &gt; &gt; file I want to be able to modify widgets packed in my EmpathyFoo
</I>&gt;<i> widget.
</I>&gt;<i> &gt; &gt; If a create a new bar.glade and pack (using catalog) an EmpathyFoo
</I>&gt;<i> &gt; &gt; widget into a GtkWindow I don't want to be able to edit widgets
</I>&gt;<i> &gt; &gt; contained in EmpathyFoo widget.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Is that possible? Thanks for explanations!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ok you'll have to look at glade3/plugins/gtk+/glade-gtk.c,gtk+.xml.in .
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; That will give you a good idea of how the class adapter works
</I>&gt;<i> &gt; (i.e. we use an object class implemented by your plugin to interact
</I>&gt;<i> &gt; with your runtime widgets).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; A plugin is not always nescisary, but you might need to override
</I>&gt;<i> &gt; some of the behaviour from the GtkHBox adaptor if your widget
</I>&gt;<i> &gt; behaves differently than a normal hbox (especially if you have
</I>&gt;<i> &gt; implicit internal child widgets, you might need to special case
</I>&gt;<i> &gt; them a bit). this blog post[1] you might have found explains the
</I>&gt;<i> &gt; simplest way to make a pluginless catalog, it should get you
</I>&gt;<i> &gt; started at least.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Note that from the libglade pov, you'll have to write a plugin
</I>&gt;<i> &gt; that calls glade_register_widget() for your types and does any
</I>&gt;<i> &gt; special casing on the libglade side of things (it will be loaded
</I>&gt;<i> &gt; as the &quot;name&quot; specified in your glade catalog), there are easier
</I>&gt;<i> &gt; ways to get your widgets working without writing libglade plugins
</I>&gt;<i> &gt; but if you want it available for everyone then you need libglade
</I>&gt;<i> &gt; plugins (those plugins will not be needed in a GtkBuilder situation).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Cheers,
</I>&gt;<i> &gt;                 -Tristan
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [1] <A HREF="http://blogs.gnome.org/tvb/2007/07/25/some-popular-features/">http://blogs.gnome.org/tvb/2007/07/25/some-popular-features/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/glade-users/attachments/20071015/784b88b9/attachment-0001.html">http://lists.ximian.com/pipermail/glade-users/attachments/20071015/784b88b9/attachment-0001.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003649.html">[Glade-users] Making my own Classes
</A></li>
	<LI>Next message: <A HREF="003651.html">[Glade-users] Making my own Classes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3650">[ date ]</a>
              <a href="thread.html#3650">[ thread ]</a>
              <a href="subject.html#3650">[ subject ]</a>
              <a href="author.html#3650">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/glade-users">More information about the Glade-users
mailing list</a><br>
</body></html>
