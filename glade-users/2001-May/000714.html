<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Glade-users] How to get to the label field of a button
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:amuys%40shortech.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000710.html">
   <LINK REL="Next"  HREF="000715.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glade-users] How to get to the label field of a button
   </H1>
    <B>Andrae Muys
    </B> 
    <A HREF="mailto:amuys%40shortech.com.au"
       TITLE="[Glade-users] How to get to the label field of a button">amuys@shortech.com.au
       </A><BR>
    <I>Tue, 15 May 2001 10:22:40 +1000</I>
    <P><UL>
        <LI> Previous message: <A HREF="000710.html">[Glade-users] How to get to the label field of a button
</A></li>
        <LI> Next message: <A HREF="000715.html">[Glade-users] How to get to the label field of a button
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#714">[ date ]</a>
              <a href="thread.html#714">[ thread ]</a>
              <a href="subject.html#714">[ subject ]</a>
              <a href="author.html#714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.
--------------EA32D12CCED06FA4A95CAC88
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Jered Bolton wrote:
&gt;<i> 
</I>&gt;<i> Ed Winchester wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi again, all,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I've been trying to get my glade-generated app to compile.  I know, from
</I>&gt;<i> &gt; something I read, but can't remember where, that Glade itself will not
</I>&gt;<i> &gt; generate code to change the label for a button.  I remember seeing
</I>&gt;<i> &gt; somewhere an example, but can't for the life of me remember where I read
</I>&gt;<i> &gt; that.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What I tried last was:
</I>&gt;<i> &gt;     gtk_label_set_text (GTK_LABEL(button-&gt;label),&quot;New button label&quot;);
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I got the error:
</I>&gt;<i> &gt;     structure has no member named `label'
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Please help.
</I>&gt;<i> 
</I>&gt;<i> No idea how this works (well I kind of have but....), but try the
</I>&gt;<i> following:
</I>&gt;<i> 
</I>&gt;<i>    GtkWidget        *label;
</I>&gt;<i>     GList            *glist;
</I>&gt;<i> 
</I>&gt;<i>   widget = lookup_widget(window_widget_is_on, &quot;slider_button&quot;); /* may not
</I>&gt;<i> need this as long as you have a pointer to the widget you'll be okay*/
</I>&gt;<i> 
</I>&gt;<i>     glist = gtk_container_children( GTK_CONTAINER(widget) );
</I>&gt;<i>    label = GTK_WIDGET( glist-&gt;data );
</I>&gt;<i>     gtk_label_set( GTK_LABEL(label), &quot;FRED&quot;);
</I>&gt;<i> 
</I>&gt;<i> I found this after trawling through stacks of stuff on the web, all seemed
</I>&gt;<i> a bit mysterious to me, as I too had similar problems in setting/changing
</I>&gt;<i> the label for the button.
</I>&gt;<i> I found the answer in a posting from 1998 from someone complaining about
</I>&gt;<i> the lack of useful documentation....
</I>&gt;<i> yet I still find myself wandering how the hell did they know to A) use a
</I>&gt;<i> GList, and B) that is has a member called data.  Half the time the
</I>&gt;<i> documentation states that the structure should only be accessed using the
</I>&gt;<i> functions given...  which in turn can only be used with this &quot;extra&quot;
</I>&gt;<i> knowledge.
</I>&gt;<i> I realise this is more of a GTK problem than glade specific, but I'm sure
</I>&gt;<i> there are many other relative &quot;newbies&quot; like myself who feel slightly lost
</I>&gt;<i> at times.
</I>
Actually Gtk+ is reasonably well documented (GNOME is sometimes a
different matter).  In this specific case the documentation is clear. 
(All quotes are direct cut/paste from
<A HREF="http://developer.gnome.org/doc/API/">http://developer.gnome.org/doc/API/</A> )

Reading from the Gtk+ reference for GtkButton :

Object Hierarchy
   GtkObject
    +----GtkWidget
          +----GtkContainer
                +----GtkBin
                      +----GtkButton

Args
   &quot;label&quot;                gchar*               : Read / Write
   &quot;relief&quot;               GtkReliefStyle       : Read / Write

Note that a GtkButton is a GtkBin, so it is a GtkContainer that supports
a single child widget (in this specific/normal case a GtkLabel).

Also note that the &quot;label&quot; Arg is available, which provides an immediate
answer to your question, specifically :

		gtk_object_set(GTK_OBJECT(button), &quot;label&quot;, &quot;goodbye&quot;, NULL);

You can know this is a gtk_object_* function because you can look in
GGAD, written by Havoc Pennington, and published under an Open licence
(ie, you can dl/read it off the web).  Dead tree version available from
New Riders IIRC.

If, like me, you have merely forgotten the precise syntax, you just need
to look at the reference docs for GtkObject, specifically:

++++++++
gtk_object_set ()

 void        gtk_object_set                  (GtkObject *object,
                                              const gchar
*first_arg_name,
                                              ...);

This function sets multiple arguments of an object.

It takes an object, then a list of name/value pairs in a list, followed
by NULL.

 void set_box_properties(GtkBox* box)
 {
   gtk_object_set(GTK_OBJECT(box), &quot;homogeneous&quot;, TRUE,
                                   &quot;spacing&quot;, 8,
                                   NULL);
 }
             object :
                     the object whose arguments should be set.
     first_arg_name :
                     the name of the first argument to set.
                ... :
                     the value of the first argument, followed
optionally by more name/value pairs, followed by
                     NULL. 
++++++++

However there are at least two other ways of achiving the same end.  As
the GtkButton appears to it's child as a GtkBin (see inheritance list),
it would make sense that facilities for manipulating it's child would be
associated with GtkBin, not GtkButton.  So if we take a look at GtkBin
we see:

GtkBin -- a container with just one child.
....
Details

struct GtkBin

 struct GtkBin;

The GtkBin struct contains the following fields. (These fields should be
considered read-only. They should
never be set by an application.) 

 GtkWidget *child;            the child widget.

Which immediately suggests the following code :

	gtk_label_set_text(GTK_LABEL(GTK_BIN(button)-&gt;child), &quot;hello&quot;);

(In actual fact this was my immediate response to the question, it's
just the GtkArg approach is most immediately obvious from the GtkButton
docs)

Of course there is also the child manipulation functions provided by
GtkBin's parent class GtkContainer:

GList*      gtk_container_children          (GtkContainer *container);

I am a little surprised to find this function undocumented, although it
is listed with it's full signature in the GtkContainer reference, and is
sufficiently obvious to hardly require documenting.  I guessed
(correctly) from the signature that it returns a linked list of children
widgets given a container widget.

Taking a look at the GList reference (which is complete except for
complexity info, that is rare in any documentation, but would be useful
in the glib docs sometimes) :

+++++
Description

The GList structure and its associated functions provide a standard
doubly-linked list data structure.

Each element in the list contains a piece of data, together with
pointers which link to the previous and next
elements in the list. &lt;SNIP: lots of useful info on GList's&gt;
Details

struct GList

 struct GList
 {
   gpointer data;
   GList *next;
   GList *prev;
 };

The GList struct is used for each element in a doubly-linked list. The
data field holds the element's data, which
can be a pointer to any kind of data, or any integer value using the
Type Conversion Macros. The next and prev
pointers are the links to the next and previous elements in the list.

+++++

Which makes the following code snippet easy enough to generate:

     GList *child = gtk_container_children(GTK_CONTAINER(button));
     gtk_label_set_text(GTK_LABEL(child-&gt;data), &quot;clicked&quot;);

I've attached a small libglade based demo that shows the above in
action. (Total project 115 lines in 3 files in 2.6k)

Andrae Muys
--------------EA32D12CCED06FA4A95CAC88
Content-Type: text/plain; charset=us-ascii;
 name=&quot;buttonlabel.c&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;buttonlabel.c&quot;

/*
 * File : buttonlabel.c
 *
 * Description : Simple application to demonstrate the changing of button 
 *         labels.
 *
 * Dependencies : buttonlabel.glade
 *
 * Author : Andrae Muys &lt;<A HREF="mailto:andrae@humbug.org.au">andrae@humbug.org.au</A>&gt;
 *
 * Date : 15th May 2001
 *
 * License : GPL.
 *
 */

#include &lt;gtk/gtk.h&gt;
#include &lt;glade/glade.h&gt;

#define FILENAME &quot;buttonlabel.glade&quot;

GladeXML *xml;
GtkWidget *button;

int main(int argc, char *argv[]) {
	gtk_init(&amp;argc, &amp;argv);
	glade_init();

	if (argc == 1) {
		xml = glade_xml_new(FILENAME, &quot;mainWindow&quot;);
	} else {
		xml = glade_xml_new(argv[1], &quot;mainWindow&quot;);
	}

	if(!xml) {
		g_warning(&quot;Could not load interface.&quot;);
		return 1;
	}

	button = glade_xml_get_widget(xml, &quot;button&quot;);
	gtk_label_set_text(GTK_LABEL(GTK_BIN(button)-&gt;child), &quot;hello&quot;);

	glade_xml_signal_autoconnect(xml);
	gtk_object_unref(GTK_OBJECT(xml));

	gtk_main();

	return 0;
}

static int clicked = 0;
void on_button_clicked(GtkWidget *button, gpointer data) {
	if (clicked == 0) {
		GList *child = gtk_container_children(GTK_CONTAINER(button));
		gtk_label_set_text(GTK_LABEL(child-&gt;data), &quot;clicked&quot;);
	} else if (clicked == 1) {
		gtk_object_set(GTK_OBJECT(button), &quot;label&quot;, &quot;goodbye&quot;, NULL);
	} else {
		gtk_main_quit();
	}
	clicked++;
}

--------------EA32D12CCED06FA4A95CAC88
Content-Type: text/html; charset=us-ascii;
 name=&quot;buttonlabel.glade&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;buttonlabel.glade&quot;

&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;GTK-Interface&gt;

&lt;project&gt;
  &lt;name&gt;buttonlabel&lt;/name&gt;
  &lt;program_name&gt;buttonlabel&lt;/program_name&gt;
  &lt;directory&gt;&lt;/directory&gt;
  &lt;source_directory&gt;src&lt;/source_directory&gt;
  &lt;pixmaps_directory&gt;pixmaps&lt;/pixmaps_directory&gt;
  &lt;language&gt;C&lt;/language&gt;
  &lt;gnome_support&gt;True&lt;/gnome_support&gt;
  &lt;gettext_support&gt;True&lt;/gettext_support&gt;
&lt;/project&gt;

&lt;widget&gt;
  &lt;class&gt;GtkWindow&lt;/class&gt;
  &lt;name&gt;mainWindow&lt;/name&gt;
  &lt;signal&gt;
    &lt;name&gt;delete_event&lt;/name&gt;
    &lt;handler&gt;gtk_main_quit&lt;/handler&gt;
    &lt;last_modification_time&gt;Mon, 14 May 2001 23:48:38 GMT&lt;/last_modification_time&gt;
  &lt;/signal&gt;
  &lt;title&gt;window1&lt;/title&gt;
  &lt;type&gt;GTK_WINDOW_TOPLEVEL&lt;/type&gt;
  &lt;position&gt;GTK_WIN_POS_NONE&lt;/position&gt;
  &lt;modal&gt;False&lt;/modal&gt;
  &lt;allow_shrink&gt;False&lt;/allow_shrink&gt;
  &lt;allow_grow&gt;True&lt;/allow_grow&gt;
  &lt;auto_shrink&gt;False&lt;/auto_shrink&gt;

  &lt;widget&gt;
    &lt;class&gt;GtkButton&lt;/class&gt;
    &lt;name&gt;button&lt;/name&gt;
    &lt;can_focus&gt;True&lt;/can_focus&gt;
    &lt;signal&gt;
      &lt;name&gt;clicked&lt;/name&gt;
      &lt;handler&gt;on_button_clicked&lt;/handler&gt;
      &lt;last_modification_time&gt;Mon, 14 May 2001 23:51:09 GMT&lt;/last_modification_time&gt;
    &lt;/signal&gt;
    &lt;label&gt;button&lt;/label&gt;
  &lt;/widget&gt;
&lt;/widget&gt;

&lt;/GTK-Interface&gt;

--------------EA32D12CCED06FA4A95CAC88
Content-Type: text/plain; charset=us-ascii;
 name=&quot;Makefile&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;Makefile&quot;

CC=gcc
DEBUG=-g
CFLAGS=$(DEBUG) -W -Wall -ansi-pedantic `gnome-config --cflags glib gtk libglade`
LDFLAGS=`gnome-config --libs glib gtk libglade`

all: buttonlabel

buttonlabel: buttonlabel.o
	$(CC) $(LDFLAGS) -o $@ $^

--------------EA32D12CCED06FA4A95CAC88--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000710.html">[Glade-users] How to get to the label field of a button
</A></li>
	<LI> Next message: <A HREF="000715.html">[Glade-users] How to get to the label field of a button
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#714">[ date ]</a>
              <a href="thread.html#714">[ thread ]</a>
              <a href="subject.html#714">[ subject ]</a>
              <a href="author.html#714">[ author ]</a>
         </LI>
       </UL>
</body></html>
