<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] SiteMapProvider patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SiteMapProvider%20patch&In-Reply-To=005101c7a1cd%24c39bbe40%24f265a8c0%40laptopdban">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023723.html">
   <LINK REL="Next"  HREF="023734.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] SiteMapProvider patch</H1>
    <B>Konstantin Triger</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SiteMapProvider%20patch&In-Reply-To=005101c7a1cd%24c39bbe40%24f265a8c0%40laptopdban"
       TITLE="[Mono-dev] SiteMapProvider patch">kostat at mainsoft.com
       </A><BR>
    <I>Wed May 30 02:11:24 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023723.html">[Mono-dev] SiteMapProvider patch
</A></li>
        <LI>Next message: <A HREF="023734.html">[Mono-dev] SiteMapProvider patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23733">[ date ]</a>
              <a href="thread.html#23733">[ thread ]</a>
              <a href="subject.html#23733">[ subject ]</a>
              <a href="author.html#23733">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Dumitru,

 

The problem is probably in case #1:

 

/* 1. */

IList roles = node.Roles;

if (roles != null &amp;&amp; roles.Count &gt; 0) {

      foreach (string rolename in roles)

            if (rolename == &quot;*&quot; || context.User.IsInRole (rolename))

                  return true;

      return false;

}

 

Either the rolename is not parsed correctly or context.User.IsInRole (rolename) works wrong. To check the later, you may run 'context.User.IsInRole (&quot;Administrator&quot;)' within your user code and see the result.

 

Regards,

Konstantin Triger

________________________________

From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] On Behalf Of Dumitru Ban
Sent: Tuesday, May 29, 2007 11:45 AM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: [Mono-dev] SiteMapProvider patch

 

Hi,

 

I'm trying to create a patch for SiteMapProvider-&gt;IsAccessibleToUser method.

 

Let's say a web.sitemap file is present, having the following content:

&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;siteMap xmlns=&quot;<A HREF="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0&quot;">http://schemas.microsoft.com/AspNet/SiteMap-File-1.0&quot;</A> &gt;
 &lt;siteMapNode url=&quot;home.aspx&quot; title=&quot;Home&quot;&gt;
  &lt;siteMapNode title=&quot;Test_no_url_no_roles&quot;/&gt;
  &lt;siteMapNode title=&quot;Test_no_url_roles&quot;  roles=&quot;Administrator&quot;/&gt;
  &lt;/siteMapNode&gt;
&lt;/siteMap&gt;

 

With Microsoft .NET, the &quot;Test_no_url_no_roles&quot; node is not accessible to any user and the &quot;Test_no_url_roles&quot; is accessible only to an Administrator.

In mono, both nodes are accessible to anyone. And this is because if the url of the node is null or is the empty string, the method returns true.

 

On the method there is a [MonoTODO (&quot;need to implement cases 2 and 3&quot;)]. But number 2 is already started and the code

String url = node.Url;

if (String.IsNullOrEmpty(url))

    return true;

is already there. 

Shouldn't we have the same behaviour as Microsoft .NET?

 

Thanks &amp; best regards,

Dumi.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070529/b8e87189/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070529/b8e87189/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023723.html">[Mono-dev] SiteMapProvider patch
</A></li>
	<LI>Next message: <A HREF="023734.html">[Mono-dev] SiteMapProvider patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23733">[ date ]</a>
              <a href="thread.html#23733">[ thread ]</a>
              <a href="subject.html#23733">[ subject ]</a>
              <a href="author.html#23733">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
