<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] BitVector32 patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20BitVector32%20patch&In-Reply-To=ee9b16d00808051942g23ab6959u10370a2f5d5509e6%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028747.html">
   <LINK REL="Next"  HREF="028749.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] BitVector32 patch</H1>
    <B>Rodrigo Kumpera</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20BitVector32%20patch&In-Reply-To=ee9b16d00808051942g23ab6959u10370a2f5d5509e6%40mail.gmail.com"
       TITLE="[Mono-dev] BitVector32 patch">kumpera at gmail.com
       </A><BR>
    <I>Wed Aug  6 10:01:47 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028747.html">[Mono-dev] BitVector32 patch
</A></li>
        <LI>Next message: <A HREF="028749.html">[Mono-dev] BitVector32 patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28748">[ date ]</a>
              <a href="thread.html#28748">[ thread ]</a>
              <a href="subject.html#28748">[ subject ]</a>
              <a href="author.html#28748">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Scott,

Mixing different kinds of changes together in the same patch makes the
reviewing process hard.
And even if the patch was ok, the mantainer would have to split it anyway to
make easier in the future
to track down changes.

If you could, please, split up your patches it would be nice.

About your patch, I left some comments  inline.

Thanks,
Rodrigo



2008/8/5 Scott Peterson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lunchtimemama at gmail.com</A>&gt;

&gt;<i> @@ -84,14 +84,12 @@
</I>&gt;<i>
</I>&gt;<i>              public override int GetHashCode ()
</I>&gt;<i>              {
</I>&gt;<i> -                return (((Int16) mask).GetHashCode () &lt;&lt; 16) +
</I>&gt;<i> -                       ((Int16) offset).GetHashCode ();
</I>&gt;<i> +                return mask &lt;&lt; offset;
</I>&gt;<i>              }
</I>&gt;<i>
</I>&gt;<i>
</I>
What is the possible range of offset? Can't it be bigger than 16 and discard
even more bits
of entropy from mask?



&gt;<i>
</I>&gt;<i> @@ -184,9 +184,8 @@
</I>&gt;<i>              if (maxValue &lt; 1)
</I>&gt;<i>                  throw new ArgumentException (&quot;maxValue&quot;);
</I>&gt;<i>
</I>&gt;<i> -            int bit = HighestSetBit(maxValue) + 1;
</I>&gt;<i> -            int mask = (1 &lt;&lt; bit) - 1;
</I>&gt;<i> -            int offset = previous.Offset + NumberOfSetBits
</I>&gt;<i> (previous.Mask);
</I>&gt;<i> +            int mask = (1 &lt;&lt; HighestSetBit(maxValue)) - 1;
</I>&gt;<i> +            int offset = previous.Offset + HighestSetBit(previous.Mask);
</I>&gt;<i>
</I>&gt;<i>              if (offset &gt; 32) {
</I>&gt;<i>                  throw new ArgumentException (&quot;Sections cannot exceed 32
</I>&gt;<i> bits in total&quot;);
</I>&gt;<i>
</I>
Shouldn't it be &quot;int mask = (1 &lt;&lt; (HighestSetBit(maxValue) + 1)) - 1;&quot;?

Besides that, I think the bit searching function should use a binary search
which has better
performance.


Cheers,
Rodrigo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080806/e9ba10ce/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080806/e9ba10ce/attachment.html</A> 
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028747.html">[Mono-dev] BitVector32 patch
</A></li>
	<LI>Next message: <A HREF="028749.html">[Mono-dev] BitVector32 patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28748">[ date ]</a>
              <a href="thread.html#28748">[ thread ]</a>
              <a href="subject.html#28748">[ subject ]</a>
              <a href="author.html#28748">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
