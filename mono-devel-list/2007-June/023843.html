<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] PATCH: Make Process.Start() use thesame'mono'runtime
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20PATCH%3A%20Make%20Process.Start%28%29%20use%20thesame%27mono%27runtime&In-Reply-To=29D696AE-A12E-4C74-B996-B3F9C3B81943%40web.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023840.html">
   <LINK REL="Next"  HREF="023847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] PATCH: Make Process.Start() use thesame'mono'runtime</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20PATCH%3A%20Make%20Process.Start%28%29%20use%20thesame%27mono%27runtime&In-Reply-To=29D696AE-A12E-4C74-B996-B3F9C3B81943%40web.de"
       TITLE="[Mono-dev] PATCH: Make Process.Start() use thesame'mono'runtime">robertj at gmx.net
       </A><BR>
    <I>Fri Jun  8 08:25:30 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023840.html">[Mono-dev] PATCH: Make Process.Start() use thesame'mono'runtime
</A></li>
        <LI>Next message: <A HREF="023847.html">[Mono-dev] PATCH: Make Process.Start() use thesame'mono'runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23843">[ date ]</a>
              <a href="thread.html#23843">[ thread ]</a>
              <a href="subject.html#23843">[ subject ]</a>
              <a href="author.html#23843">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Andreas!

Andreas F&#228;rber wrote:
&gt;<i>  From my view the core problem is rather the PE format of the  
</I>&gt;<i> assemblies. The reason why Microsoft is using it is because it's  
</I>&gt;<i> their *native* executable format and the x86 stub in there, as far as  
</I>&gt;<i> I understood, blocks execution under DOS (like all Windows apps) and  
</I>&gt;<i> somehow calls into mscoree.dll (or similar) to have the assembly  
</I>
Well, look at the Java mess on Windows: the average Windows user
is not even able to launch such apps, when they not come with
wrappers, shortcuts, whistles and bells.

No wonder MS has chosen their native exec format.

&gt;<i> executed on Windows. This is in the ECMA standard, okay, but I have  
</I>&gt;<i> been wondering why we don't provide a converter between PE and ELF/ 
</I>&gt;<i> Mach-O to do the equivalent?
</I>
#!/bin/sh
# Universal PE Converter, Copyright (C) Robert `Smartass' J. :-)
exec mono my-exciting-app.exe &quot;$*&quot;

&gt;<i> This is different from mkbundle's semantics in not embedding a full  
</I>&gt;<i> Mono but providing a stub only - either one dynamically linked to  
</I>&gt;<i> libmono.so/.dylib or invoking mono with the assembly, similar to a #!  
</I>&gt;<i> line. I understand that using the PE format is the basis of  
</I>&gt;<i> interoperability with Microsoft .NET but for a Unix-only app we don't  
</I>&gt;<i> need that and rather want to provide a convenient experience to users  
</I>&gt;<i> and developers (which a script does not always). On the Mac we don't  
</I>
Is it worthwhile to spend a couple of weeks to blow up the runtime
with X binfmt readers/writers, while breaking the specs and
eventually obsoleting an one liner script?

BTW, you can achieve this with mkbundle using its &quot;--nodeps&quot; option
and omitting &quot;--static&quot;. It's an one liner, too.

&gt;<i> Some other options to consider:
</I>&gt;<i> - use .config file to map exe to the desired executable (whether  
</I>&gt;<i> script or mono) as done for libraries
</I>&gt;<i> - instead of invoking mono with or without environment variables just  
</I>&gt;<i> strip the .exe extension and let the user take care of the path there  
</I>&gt;<i> (Unix only)
</I>&gt;<i> - try to execute .exe, if this fails (because .NET is not installed  
</I>&gt;<i> or we can't execute PE binaries) fall back to invoking mono (monow on  
</I>&gt;<i> Windows)
</I>&gt;<i> 
</I>&gt;<i> Simply prepending a pure shebang line does not seem to be an option  
</I>&gt;<i> given that mono does not read assemblies from stdin.
</I>
The PE format is, like every decent binfmt, mmapable, so handling
it from a stream is not a smart option.

Robert


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023840.html">[Mono-dev] PATCH: Make Process.Start() use thesame'mono'runtime
</A></li>
	<LI>Next message: <A HREF="023847.html">[Mono-dev] PATCH: Make Process.Start() use thesame'mono'runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23843">[ date ]</a>
              <a href="thread.html#23843">[ thread ]</a>
              <a href="subject.html#23843">[ subject ]</a>
              <a href="author.html#23843">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
