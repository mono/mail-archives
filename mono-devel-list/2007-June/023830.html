<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Fwd: Mono 1.1 and 2.0 runtimes and SessionState
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Fwd%3A%20Mono%201.1%20and%202.0%20runtimes%20and%20SessionState&In-Reply-To=c80dbdf30706052323v1469622dgf96f290cc32d514e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023826.html">
   <LINK REL="Next"  HREF="023832.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Fwd: Mono 1.1 and 2.0 runtimes and SessionState</H1>
    <B>Savva</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Fwd%3A%20Mono%201.1%20and%202.0%20runtimes%20and%20SessionState&In-Reply-To=c80dbdf30706052323v1469622dgf96f290cc32d514e%40mail.gmail.com"
       TITLE="[Mono-dev] Fwd: Mono 1.1 and 2.0 runtimes and SessionState">savvkin at gmail.com
       </A><BR>
    <I>Thu Jun  7 04:43:26 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023826.html">[Mono-dev] Patch for SqlCommand
</A></li>
        <LI>Next message: <A HREF="023832.html">[Mono-dev] Fwd: Mono 1.1 and 2.0 runtimes and SessionState
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23830">[ date ]</a>
              <a href="thread.html#23830">[ thread ]</a>
              <a href="subject.html#23830">[ subject ]</a>
              <a href="author.html#23830">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello.
I use openSUSE 10.2 image from site + daily monocharge binaries +
system auto update

I managed to compile ASP.NET 2.0 Web-Service under Apache + mod_mono,
but it still not working...

1. If I use those settings (in etc/apache2/server-default.conf), my
service runs under Mono Runtime 2.0. Is those settings are correct?

Alias /mstest /srv/www/htdocs/monoservice
MonoApplications msdefault &quot;/mstest:/srv/www/htdocs/monoservice&quot;
MonoServerPath msdefault &quot;/usr/bin/mod-mono-server2&quot;
&lt;Directory /srv/www/htdocs/monoservice&gt;
        Allow from all
         Order allow,deny
        SetHandler mono
        MonoSetServerAlias msdefault
&lt;/Directory&gt;

2. Why do I get 2 pairs of methods are generated on page in case of runtime 2.0?

Methods
HelloWorld
HelloWorld2

and

Methods for MyServiceSoap12
HelloWorld
HelloWorld2

3. When I try to test any method with test form I get following error
(after about 60 sec of waiting):
--- start here ---
The remote server returned an error: (500) Internal Server Error.
&lt;?xml version=&quot; 1.0&quot; ?&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
       &quot;<A HREF="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</A>&gt;&lt;html
       xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml&quot;">http://www.w3.org/1999/xhtml&quot;</A> xml:lang=&quot;en&quot;
lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;Error
       500&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body
{font-family:&quot;Verdana&quot;,&quot;DejaVu Sans&quot;,
     sans-serif;font-weight:normal;font-size:
.7em;color:black;background-color: white}
p {font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:normal;color:black;margin-top:
       -5px}
b {font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:bold;color:black;margin-top: -5px}
h1 { font-family:&quot;Verdana&quot;,&quot;DejaVu
Sans&quot;,sans-serif;font-weight:normal;font-size:18pt;color:red
       }
h2 { font-family:&quot;Verdana&quot;,&quot;DejaVu Sans&quot;,
      sans-serif;font-weight:normal;font-size:14pt;color:maroon }
pre {font-family:&quot;Lucida Console&quot;,&quot;DejaVu Sans Mono&quot;,
monospace;font-size:  1.2em}
div.bodyText {font-family: &quot;Verdana&quot;,&quot;DejaVu Sans&quot;,sans-serif}
 table.sampleCode  100%; background-color: #ffffcc;
.errorText  red; font-weight: bold
 .marker {font-weight: bold; color: black;text-decoration: none;}
.version  gray;
 .error {margin-bottom: 10px;}
.expandable { text-decoration:underline; font-weight:bold; color:navy;
cursor:hand;
       }&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Server Error in '/mstest' Application&lt;/h1&gt;&lt;hr
       style=&quot;color: silver&quot;/&gt;&lt;h2&gt;&lt;em&gt;Object reference not set to an
instance of an
      object&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Description: &lt;/strong&gt;Error processing request.&lt;/p&gt;
 &lt;p&gt;&lt;strong&gt;Error Message: &lt;/strong&gt;HTTP 500.
System.NullReferenceException: Object reference
      not set to an instance of an object
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stack Trace: &lt;/strong&gt;&lt;/p&gt;&lt;table summary=&quot;Stack Trace&quot;
class=&quot;sampleCode&quot;&gt;
&lt;tr&gt;&lt;td&gt;&lt;pre&gt;System.NullReferenceException: Object reference not set
to an instance of an object
   at System.Web.SessionState.SessionInProcHandler.SetAndReleaseItemExclusive (
       System.Web.HttpContext  context, System.String id,
        System.Web.SessionState.SessionStateStoreData item,
System.Object lockId, Boolean
         newItem) [0x00000] &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
 &lt;![CDATA[
System.Web.HttpException:  ---&gt; System.NullReferenceException: Object
reference not set to
      an instance of an object
  at System.Web.SessionState.SessionInProcHandler.SetAndReleaseItemExclusive  (
       System.Web.HttpContext context, System.String id,
         System.Web.SessionState.SessionStateStoreData item,
System.Object lockId, Boolean
        newItem) [0x00000] --- End of inner exception stack trace ---

]]&gt;
&lt;hr style=&quot;color: silver&quot;/&gt;02/17/2009 12:43:47&lt;/body&gt;&lt;/html&gt;
--- end here ---

4. If I switch off SessionState or comment out config (and make it
1.1), it works

&lt;sessionState mode=&quot;Off&quot; cookieless=&quot;false&quot; timeout=&quot;30&quot; /&gt;

OR

#Alias /mstest /srv/www/htdocs/monoservice
 #MonoApplications msdefault &quot;/mstest:/srv/www/htdocs/monoservice&quot;
 #MonoServerPath msdefault &quot;/usr/bin/mod-mono-server2&quot;
#&lt;Directory /srv/www/htdocs/monoservice&gt;
 #        Allow from all
 #        Order allow,deny
#        SetHandler mono
 #        MonoSetServerAlias msdefault
#&lt;/Directory&gt;

I have no idea how to fix all that... Please help.

This is src of my web service

--- start here ---
 using System;
using System.Data;
using System.Data.SqlClient;
using System.Data.Common;
using System.Web;
 using System.Collections;
using System.Web.Services;
 using System.Web.Services.Protocols;
using System.ComponentModel;

 namespace MonoService
{

    [WebService(Namespace = &quot; <A HREF="http://www.ru/&quot;,">http://www.ru/&quot;,</A> Name =
&quot;MyApplicationServer&quot;, Description = &quot;test&quot;)]
    //[WebServiceBinding(ConformsTo =  WsiProfiles.BasicProfile1_1)]
    public class Service1 : System.Web.Services.WebService
     {
        [WebMethod(EnableSession=true)]
        public DataSet HelloWorld(string query)
        {
            Session.Add(&quot;lastquery&quot;, query);
            SqlConnection conn = new
System.Data.SqlClient.SqlConnection(@&quot;my conn string&quot;);
             SqlDataAdapter adap = new SqlDataAdapter(query, conn);
             DataSet ds = new DataSet();
            adap.Fill(ds);
             return ds;
        }
         [WebMethod(EnableSession = true)]
        public string HelloWorld2()
         {
            string lastquery = &quot;&quot;;
            try
            {
                lastquery = Session[&quot;lastquery&quot;].ToString();
            }
            catch (Exception ex)
             {
                lastquery = &quot;Error: &quot; + ex.ToString();
             }

            return lastquery;
         }
    }
}
--- end here ---

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023826.html">[Mono-dev] Patch for SqlCommand
</A></li>
	<LI>Next message: <A HREF="023832.html">[Mono-dev] Fwd: Mono 1.1 and 2.0 runtimes and SessionState
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23830">[ date ]</a>
              <a href="thread.html#23830">[ thread ]</a>
              <a href="subject.html#23830">[ subject ]</a>
              <a href="author.html#23830">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
