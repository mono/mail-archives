<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Domain Unload crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Domain%20Unload%20crash&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023994.html">
   <LINK REL="Next"  HREF="023995.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Domain Unload crash</H1>
    <B>Joachim Ante</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Domain%20Unload%20crash&In-Reply-To="
       TITLE="[Mono-dev] Domain Unload crash">joe at otee.dk
       </A><BR>
    <I>Thu Jun 28 17:36:50 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023994.html">[Mono-dev] SerialPort - patch waiting to apply
</A></li>
        <LI>Next message: <A HREF="023995.html">[Mono-dev] Domain Unload crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23991">[ date ]</a>
              <a href="thread.html#23991">[ thread ]</a>
              <a href="subject.html#23991">[ subject ]</a>
              <a href="author.html#23991">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I am having some more issues in domain unloading. Paolo fixed one  
crashbug in the generics cache and at least it isn't crashing every  
time we unload a domain.
<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=77596">http://bugzilla.ximian.com/show_bug.cgi?id=77596</A>


The problem is that now i am getting crashbugs much less frequently  
and it happens in places that just don't make a lot of sense to me  
and it happens very rarely. After unload/loading a domain 40-50  
times. I get crashes which look like this:

So now i really have no idea how to debug this. Any ideas on what to  
do here? On how to debug this situation. Any hints on what might be  
going wrong?
I am stumped.


See crashlogs below.

In this one, it seemed that the return value of the signature was  
null and then got derefenced.

0   com.OverTheEdge.MonoBundle     	0x0955a244  
do_mono_metadata_type_equal + 24 (metadata.c:3593)
1   &lt;&lt;00000000&gt;&gt; 	0x024fddec 0 + 38788588
2   com.OverTheEdge.MonoBundle     	0x0955a49c  
mono_metadata_signature_equal + 160 (metadata.c:3688)
3   com.OverTheEdge.MonoBundle     	0x09621974 g_hash_table_lookup +  
124 (metadata.c:4789)
4   com.OverTheEdge.MonoBundle     	0x09547898  
mono_marshal_get_runtime_invoke + 392 ((null):-1)
5   com.OverTheEdge.MonoBundle     	0x095cd9ac  
mono_jit_runtime_invoke + 84 (metadata.c:4789)
6   dk.otee.UnityWebPlayerCore     	0x08cdd9b4  
_Z20ExtractMonoExceptionRSsiS0_PiiPK6Object + 340 (MonoManager.cpp:1919)


or something like this was also common.

0   com.OverTheEdge.MonoBundle     	0x09022344 mono_type_hash + 0  
(metadata.c:1351)
1   com.OverTheEdge.MonoBundle     	0x090255a4 mono_signature_hash +  
68 (metadata.c:3727)
2   com.OverTheEdge.MonoBundle     	0x090ed3ec g_hash_table_resize +  
128 (metadata.c:4793)
3   com.OverTheEdge.MonoBundle     	0x090130d8  
mono_marshal_get_runtime_invoke + 2536 ((null):-1)
4   com.OverTheEdge.MonoBundle     	0x090989a8  
mono_jit_runtime_invoke + 84 (metadata.c:4793)
5   dk.otee.UnityWebPlayerCore     	0x087aa740  
MonoManager::RebuildCommonMonoClasses() + 1728 (MonoManager.cpp:1104)
6   dk.otee.UnityWebPlayerCore     	0x087ab6d0  
MonoManager::ReloadAssembly(int, int&amp;) + 1040 (MonoManager.cpp:678)
7   dk.otee.UnityWebPlayerCore     	0x087ac048  
MonoManager::LoadAllNecessaryAssemblies() + 168 (MonoManager.cpp:280)
8   dk.otee.UnityWebPlayerCore     	0x087abf74  
MonoManager::AwakeFromLoad(__bool8) + 228 (MonoManager.cpp:295)
9   dk.otee.UnityWebPlayerCore     	0x0874ae1c  
PersistentManager::ReadObject(int) + 428 (PersistentManager.cpp:474)
10  dk.otee.UnityWebPlayerCore     	0x0876676c  
ReadObjectFromPersistentManager(int) + 44 (BaseObject.cpp:118)
11  dk.otee.UnityWebPlayerCore     	0x08780590  
PlayerLoadGlobalManagers(char const*) + 384 (SaveAndLoadHelper.cpp:214)
12  dk.otee.UnityWebPlayerCore     	0x087eb204  
PlayerInitEngineLoadData() + 164 (Player.cpp:348)
13  dk.otee.UnityWebPlayerCore     	0x087eb0bc PlayerLoadWebData 
(DecompressedDataFile&amp;, std::basic_string&lt;char,  
std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;, std::basic_string&lt;char,


or this:

0   com.OverTheEdge.MonoBundle     	0x0964f584 mono_signature_hash +  
36 (metadata.c:3725)
1   com.OverTheEdge.MonoBundle     	0x097173ec g_hash_table_resize +  
128 (metadata.c:4793)
2   com.OverTheEdge.MonoBundle     	0x0963d0d8  
mono_marshal_get_runtime_invoke + 2536 ((null):-1)
3   com.OverTheEdge.MonoBundle     	0x096c29a8  
mono_jit_runtime_invoke + 84 (metadata.c:4793)
4   dk.otee.UnityWebPlayerCore     	0x08dcd0f8 Coroutine::Run() + 72  
(MonoBehaviour.cpp:931)

Best regards,
Joachim Ante

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023994.html">[Mono-dev] SerialPort - patch waiting to apply
</A></li>
	<LI>Next message: <A HREF="023995.html">[Mono-dev] Domain Unload crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23991">[ date ]</a>
              <a href="thread.html#23991">[ thread ]</a>
              <a href="subject.html#23991">[ subject ]</a>
              <a href="author.html#23991">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
