<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] IMT patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20IMT%20patch&In-Reply-To=8cca42d80705310355o6807d47fj94c2ec3f2eb861a9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023785.html">
   <LINK REL="Next"  HREF="023783.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] IMT patch</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20IMT%20patch&In-Reply-To=8cca42d80705310355o6807d47fj94c2ec3f2eb861a9%40mail.gmail.com"
       TITLE="[Mono-dev] IMT patch">lupus at ximian.com
       </A><BR>
    <I>Fri Jun  1 12:17:08 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023785.html">[Mono-dev] [patch 5/5] Enable JIT on hppa-linux
</A></li>
        <LI>Next message: <A HREF="023783.html">[Mono-dev] Mono policies.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23784">[ date ]</a>
              <a href="thread.html#23784">[ thread ]</a>
              <a href="subject.html#23784">[ subject ]</a>
              <a href="author.html#23784">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05/31/07 Rodrigo Kumpera wrote:
&gt;<i> Do you have any measurements of the collision rates the hash function
</I>&gt;<i> generates over corlib? This should provide enough data to verify the hash
</I>&gt;<i> quality. If collision is too bad, you could store the IMT slot in MonoMethod
</I>&gt;<i> and do slot distribution when the interface is loaded.
</I>
We won't store the imt slot in MonoMethod, because it would be an
additional field and waste memory for something seldomly used. Besides
it's cheap to calculate the hash and that happens only in
non-performance critical codepaths.

&gt;<i> You are using indirect absolute jmps over the vtable pointer, which is
</I>&gt;<i> slower than relative jmps. The code could check if the target method is
</I>&gt;<i> already compiled and issue a relative jump directly. The compile trampolines
</I>&gt;<i> could patch the thunks, but this could end been really tricky.
</I>
We used the indirect jumps to avoid having to patch the thunks
(which would required either to decode the instructions or to keep
additional info in memory).

&gt;<i> How fast is the hash function? Shouldn't the IMT slot be cached in
</I>&gt;<i> MonoMethod?
</I>
See above, it doesn't matter if the hash is slow and using more runtime
memory is a bigger issue.

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023785.html">[Mono-dev] [patch 5/5] Enable JIT on hppa-linux
</A></li>
	<LI>Next message: <A HREF="023783.html">[Mono-dev] Mono policies.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23784">[ date ]</a>
              <a href="thread.html#23784">[ thread ]</a>
              <a href="subject.html#23784">[ subject ]</a>
              <a href="author.html#23784">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
