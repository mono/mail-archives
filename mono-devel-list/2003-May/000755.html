<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Using WinForms on WinNT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Using%20WinForms%20on%20WinNT&In-Reply-To=005e01c31823%242af11330%2446d6fea9%40alexhome">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000746.html">
   <LINK REL="Next"  HREF="000702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Using WinForms on WinNT</H1>
    <B>Aleksey Ryabchuk</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Using%20WinForms%20on%20WinNT&In-Reply-To=005e01c31823%242af11330%2446d6fea9%40alexhome"
       TITLE="[Mono-devel-list] Using WinForms on WinNT">ryabchuk at yahoo.com
       </A><BR>
    <I>Mon May 12 04:48:09 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="000746.html">[Mono-devel-list] Using WinForms on WinNT
</A></li>
        <LI>Next message: <A HREF="000702.html">[Mono-devel-list] Using WinForms on WinNT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#755">[ date ]</a>
              <a href="thread.html#755">[ thread ]</a>
              <a href="subject.html#755">[ subject ]</a>
              <a href="author.html#755">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Alexandre,

I needed to pass CLIENTCREATESTRUCT via cp.Param field
for MDI interface. I found this way of passing of void
pointer in MS help and it really works correctly with
MS runtime. Should not Mono be able to handle this
situation too, should it ?

Regards
Aleksey

--- Alexandre Pigolkine &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pigolkine at gmx.de</A>&gt; wrote:
&gt;<i> Hello Aleksey,
</I>&gt;<i> 
</I>&gt;<i> I think that one of the problems with crash is
</I>&gt;<i> connected to the
</I>&gt;<i> CreateWindowEx function.
</I>&gt;<i> 
</I>&gt;<i> ? SWF.diff
</I>&gt;<i> Index: NativeWindow.cs
</I>&gt;<i>
</I>===================================================================
&gt;<i> RCS file:
</I>&gt;<i>
</I>/cvs/public/mcs/class/System.Windows.Forms/System.Windows.Forms/NativeWindow
&gt;<i> .cs,v
</I>&gt;<i> retrieving revision 1.25
</I>&gt;<i> diff -r1.25 NativeWindow.cs
</I>&gt;<i> 105c105
</I>&gt;<i> &lt;      (IntPtr) 0, cp.Param);
</I>&gt;<i> ---
</I>&gt;<i> &gt;      (IntPtr) 0, (IntPtr)0/*cp.Param*/);
</I>&gt;<i> Index: win32functions.cs
</I>&gt;<i>
</I>===================================================================
&gt;<i> RCS file:
</I>&gt;<i>
</I>/cvs/public/mcs/class/System.Windows.Forms/System.Windows.Forms/win32functio
&gt;<i> ns.cs,v
</I>&gt;<i> retrieving revision 1.25
</I>&gt;<i> diff -r1.25 win32functions.cs
</I>&gt;<i> 748,749c748,750
</I>&gt;<i> &lt;    [ MarshalAs( UnmanagedType.AsAny )]
</I>&gt;<i> &lt;    object lpParam);
</I>&gt;<i> ---
</I>&gt;<i> &gt;    //[ MarshalAs( UnmanagedType.AsAny )]
</I>&gt;<i> &gt;    //object lpParam);
</I>&gt;<i> &gt;    IntPtr lpParam);
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> This change makes things a bit better, but result is
</I>&gt;<i> still the same :(
</I>&gt;<i> 
</I>&gt;<i> ...
</I>&gt;<i> mono_compile_create_var 00000000 to 16 bytes
</I>&gt;<i> no window, defwndproc
</I>&gt;<i> no window, defwndproc
</I>&gt;<i> WM_CREATE (static)
</I>&gt;<i> no window, defwndproc
</I>&gt;<i> mono_compile_create_var 00000000 to 16 bytes
</I>&gt;<i> 
</I>&gt;<i> Program received signal SIGSEGV, Segmentation fault.
</I>&gt;<i> [Switching to thread 2500.0xeec]
</I>&gt;<i> 0x77f52571 in ntdll!RtlInitNlsTables () from
</I>&gt;<i> ntdll.dll
</I>&gt;<i> (gdb) where
</I>&gt;<i> #0  0x77f52571 in ntdll!RtlInitNlsTables () from
</I>&gt;<i> ntdll.dll
</I>&gt;<i> #1  0x77f92910 in ntdll!RtlpNtMakeTemporaryKey ()
</I>&gt;<i> from ntdll.dll
</I>&gt;<i> #2  0x77f73bb5 in ntdll!RtlCheckRegistryKey () from
</I>&gt;<i> ntdll.dll
</I>&gt;<i> #3  0x77f527e4 in ntdll!RtlInitNlsTables () from
</I>&gt;<i> ntdll.dll
</I>&gt;<i> #4  0x77bfac14 in msvcrt!free () from
</I>&gt;<i> /cygdrive/d/WINDOWS/system32/msvcrt.dll
</I>&gt;<i> #5  0x77bfac2a in msvcrt!free () from
</I>&gt;<i> /cygdrive/d/WINDOWS/system32/msvcrt.dll
</I>&gt;<i> #6  0x672e3f8d in g_realloc () from
</I>&gt;<i> /usr/local/mono/bin/libglib-2.0-0.dll
</I>&gt;<i> #7  0x00408bcb in mono_compile_create_var
</I>&gt;<i> (cfg=0x17c1dc8, type=0x166a060,
</I>&gt;<i> opcode
</I>&gt;<i> =316) at mini.c:1299
</I>&gt;<i> #8  0x00419588 in mono_compile_create_vars
</I>&gt;<i> (cfg=0x17c1dc8) at mini.c:5249
</I>&gt;<i> #9  0x0041a50c in mini_method_compile
</I>&gt;<i> (method=0x1669fe8, opts=16779,
</I>&gt;<i> domain=0x3f
</I>&gt;<i> 4da0, parts=0) at mini.c:5701
</I>&gt;<i> #10 0x0041b04c in mono_jit_compile_method
</I>&gt;<i> (method=0x1669fe8) at mini.c:5970
</I>&gt;<i> #11 0x00423eae in mono_compile_method
</I>&gt;<i> (method=0x1669fe8) at object.c:145
</I>&gt;<i> #12 0x0047a33f in x86_magic_trampoline (eax=0,
</I>&gt;<i> ecx=24315200, edx=23502824,
</I>&gt;<i> esi=0
</I>&gt;<i> , edi=0, ebx=0, code=0x1730552
</I>&gt;<i> &quot;\203&#196;\b\210\205&#179;&#254;&#255;&#255;\205&#192;\017\204&#182;&quot;,
</I>&gt;<i> m=0x1669fe8)
</I>&gt;<i>  at tramp-x86.c:88
</I>&gt;<i> #13 0x00f37695 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Alexandre
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ----- Original Message ----- 
</I>&gt;<i> From: &quot;Aleksey Ryabchuk&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ryabchuk at yahoo.com</A>&gt;
</I>&gt;<i> To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i> Sent: Friday, May 09, 2003 2:01 PM
</I>&gt;<i> Subject: Re: [Mono-devel-list] Using WinForms on
</I>&gt;<i> WinNT
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't think that this crash has something to do
</I>&gt;<i> with
</I>&gt;<i> &gt; these warnings. I eliminated them by commenting
</I>&gt;<i> out
</I>&gt;<i> &gt; corresponding prototypes in win32functions.cs, but
</I>&gt;<i> the
</I>&gt;<i> &gt; program crashes anyway. In fact it starts
</I>&gt;<i> execution
</I>&gt;<i> &gt; and writes some debug output to the screen:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; no window, defwndproc
</I>&gt;<i> &gt; WM_CREATE (static)
</I>&gt;<i> &gt; no window, defwndproc
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; and then it reports that the program tried to
</I>&gt;<i> execute
</I>&gt;<i> &gt; privileged instruction and terminates. I run
</I>&gt;<i> Win2K.
</I>

__________________________________
Do you Yahoo!?
The New Yahoo! Search - Faster. Easier. Bingo.
<A HREF="http://search.yahoo.com">http://search.yahoo.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000746.html">[Mono-devel-list] Using WinForms on WinNT
</A></li>
	<LI>Next message: <A HREF="000702.html">[Mono-devel-list] Using WinForms on WinNT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#755">[ date ]</a>
              <a href="thread.html#755">[ thread ]</a>
              <a href="subject.html#755">[ subject ]</a>
              <a href="author.html#755">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
