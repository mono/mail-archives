<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] RFC 2617 basic auth in System.Net.HttpWebRequest
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20RFC%202617%20basic%20auth%20in%20System.Net.HttpWebRequest&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000838.html">
   <LINK REL="Next"  HREF="000847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] RFC 2617 basic auth in System.Net.HttpWebRequest</H1>
    <B>Mohammad DAMT</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20RFC%202617%20basic%20auth%20in%20System.Net.HttpWebRequest&In-Reply-To="
       TITLE="[Mono-devel-list] RFC 2617 basic auth in System.Net.HttpWebRequest">md at mt.web.id
       </A><BR>
    <I>Mon May 19 06:35:43 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="000838.html">[Mono-devel-list] Runtime support for custom marshalers
</A></li>
        <LI>Next message: <A HREF="000847.html">[Mono-devel-list] can't AppDomain under the mint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#841">[ date ]</a>
              <a href="thread.html#841">[ thread ]</a>
              <a href="subject.html#841">[ subject ]</a>
              <a href="author.html#841">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Basic auth in System.Net.HttpWebRequest can be set from Credentials 
property.
Currently this property does nothing and sends no auth info (RFC2617) 
to the server which will cause http error 401.
Patch to accomodate such auth method is attached. I have no idea is it 
the right place to set the http header in the set block of Credentials 
property.

Mohammad DAMT &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mdamt at bisnisweb.com</A>&gt;
-------------- next part --------------
--- _HttpWebRequest.cs	2003-05-19 17:26:19.000000000 +0700
+++ HttpWebRequest.cs	2003-05-19 17:23:04.000000000 +0700
@@ -167,7 +167,24 @@ namespace System.Net 
 		
 		public override ICredentials Credentials { 
 			get { return credentials; }
-			set { credentials = value; }
+			set { credentials = value; 
+				if (credentials is NetworkCredential &amp;&amp; credentials != null) {
+		 			if (((NetworkCredential) credentials).UserName != null) {
+						if (webHeaders [&quot;Authorization&quot;] != null &amp;&amp; webHeaders [&quot;Authorization&quot;].Length &gt; 0)
+							webHeaders.RemoveInternal (&quot;Authorization&quot;);
+
+	 					string user_pass_string = ((NetworkCredential) credentials).UserName + &quot;:&quot;;
+						if (((NetworkCredential) credentials).Password != null) 
+	 						user_pass_string += ((NetworkCredential) credentials).Password;
+
+						byte[] user_pass = new byte[user_pass_string.Length];
+						for (int i = 0; i &lt; user_pass_string.Length; i++) 
+	 						user_pass [i] = (byte) user_pass_string [i];
+							
+						webHeaders.SetInternal (&quot;Authorization&quot;, &quot;Basic &quot; +  + Convert.ToBase64String (user_pass));
+					}
+				}
+			}
 		}
 		
 		public string Expect {
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000838.html">[Mono-devel-list] Runtime support for custom marshalers
</A></li>
	<LI>Next message: <A HREF="000847.html">[Mono-devel-list] can't AppDomain under the mint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#841">[ date ]</a>
              <a href="thread.html#841">[ thread ]</a>
              <a href="subject.html#841">[ subject ]</a>
              <a href="author.html#841">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
