<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Bad performance of custom grid control under moonlight
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Bad%20performance%20of%20custom%20grid%20control%20under%20moonlight&In-Reply-To=%3CCAAOGMkys4YrnX3qajWzE4J%2BfG05KXD5eSaB1RYT9dFUunYuCrQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038552.html">
   <LINK REL="Next"  HREF="038565.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Bad performance of custom grid control under moonlight</H1>
    <B>Markku Tavasti</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Bad%20performance%20of%20custom%20grid%20control%20under%20moonlight&In-Reply-To=%3CCAAOGMkys4YrnX3qajWzE4J%2BfG05KXD5eSaB1RYT9dFUunYuCrQ%40mail.gmail.com%3E"
       TITLE="[Mono-dev] Bad performance of custom grid control under moonlight">tavasti at seravo.fi
       </A><BR>
    <I>Fri Feb  3 11:46:01 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="038552.html">[Mono-dev] Unable to debug
</A></li>
        <LI>Next message: <A HREF="038565.html">[Mono-dev] Bad performance of custom grid control under	moonlight
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38550">[ date ]</a>
              <a href="thread.html#38550">[ thread ]</a>
              <a href="subject.html#38550">[ subject ]</a>
              <a href="author.html#38550">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have application, which uses custom controls made by third party. On
windows platform these controls perform ok, but moonlight performance is
bad. Problem is in custom gridview which has suport for 'multiline' rows.

Problems we have:

1) performance. more lines the grid has, slower it gets. With 100-200 lines
it will be totally unusable.

2) memory consumption, grid consumes a lot of memory


Error messages we get on load:
---------------------------------------------------------------------------
trying to load:
/XXXX.Windows.Controls.GridView;component/themes/generic.xaml
VisualTreeWalker: unexpectedly got an unsorted UIElementCollection
---------------------------------------------------------------------------


And when using app, I get hundreds of these exceptions even on very short
run:
---------------------------------------------------------------------------
&quot;Finalizer&quot; tid=0x0xb31c8b70 this=0x0x57e70 thread handle 0x407 state : not
waiting
 owns ()
  at &lt;unknown&gt; &lt;0xffffffff&gt;
  at (wrapper runtime-invoke) object.runtime_invoke_virtual_void__this__
(object,in
tptr,intptr,intptr) &lt;IL 0x0004c, 0xffffffff&gt;
[0xb31c8b70:] EXCEPTION handling: System.MethodAccessException: Error
verifying
XXX.Windows.Controls.GridView.GridViewCellBase:Finalize (): Method
object:Finalize
 () is not accessible at 0x001e

&quot;Finalizer&quot; tid=0x0xb31c8b70 this=0x0x57e70 thread handle 0x407 state : not
waiting
 owns ()
  at &lt;unknown&gt; &lt;0xffffffff&gt;
  at (wrapper runtime-invoke) object.runtime_invoke_virtual_void__this__
(object,in
tptr,intptr,intptr) &lt;IL 0x0004c, 0xffffffff&gt;
[0xb31c8b70:] EXCEPTION handling: System.MethodAccessException: Error
verifying XXX.Windows.Controls.GridView.WeakEvent/WeakListener`1:Finalize
(): Method object:
Finalize () is not accessible at 0x0005
---------------------------------------------------------------------------

I have also been running profiler on that app, and part of the problem
might be too many calls to MeasureOveride.
However, this seems not to be problem on windows platform, or at least show
stopper.

Because we use those custom controls from third party, I cannot give public
access to that app,
but i someone wants to test I can give URL personally.

Ideas welcome from where to start digging up this problem in mono/moonlight
side?

--Tavasti
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120203/187537af/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120203/187537af/attachment.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038552.html">[Mono-dev] Unable to debug
</A></li>
	<LI>Next message: <A HREF="038565.html">[Mono-dev] Bad performance of custom grid control under	moonlight
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38550">[ date ]</a>
              <a href="thread.html#38550">[ thread ]</a>
              <a href="subject.html#38550">[ subject ]</a>
              <a href="author.html#38550">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
