<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] System.IO.Packaging throws NullReferenceExeption
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20System.IO.Packaging%20throws%20NullReferenceExeption&In-Reply-To=%3CCAGu5pZf%2BdNY5yVm24CW%2B9uN4OZ1W-397OpswodNAqcNAvLUqrg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038566.html">
   <LINK REL="Next"  HREF="038567.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] System.IO.Packaging throws NullReferenceExeption</H1>
    <B>Alan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20System.IO.Packaging%20throws%20NullReferenceExeption&In-Reply-To=%3CCAGu5pZf%2BdNY5yVm24CW%2B9uN4OZ1W-397OpswodNAqcNAvLUqrg%40mail.gmail.com%3E"
       TITLE="[Mono-dev] System.IO.Packaging throws NullReferenceExeption">alan.mcgovern at gmail.com
       </A><BR>
    <I>Thu Feb  9 20:22:02 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="038566.html">[Mono-dev] System.IO.Packaging throws NullReferenceExeption
</A></li>
        <LI>Next message: <A HREF="038567.html">[Mono-dev] SSL Certificate Binding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38571">[ date ]</a>
              <a href="thread.html#38571">[ thread ]</a>
              <a href="subject.html#38571">[ subject ]</a>
              <a href="author.html#38571">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

For every testcase which fails, could you create a bug report on
<A HREF="http://bugzilla.xamarin.com,">http://bugzilla.xamarin.com,</A> attach the testcase and assign it to &quot;
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">alan at xamarin.com</A>&quot;. I will look at them when I get a chance and fix the
underlying issues where possible. If you could also attach the resulting
'out.zip' created from the microsoft framework, that would make it faster
for me to ensure things are generated correctly.

Thanks!
Alan

On 9 February 2012 13:03, CikaPero1 &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">cika.pero1 at gmail.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Does anyone know why the code below throws an exception?
</I>&gt;<i>
</I>&gt;<i> The code below works with MS Visual Studio but simply won't work with Mono
</I>&gt;<i> 2.8.
</I>&gt;<i>
</I>&gt;<i> using System;
</I>&gt;<i> using System.IO;
</I>&gt;<i> using System.IO.Packaging;
</I>&gt;<i> using System.Text;
</I>&gt;<i> using System.Xml;
</I>&gt;<i>
</I>&gt;<i> namespace ConsoleApplication
</I>&gt;<i> {
</I>&gt;<i>    class Program
</I>&gt;<i>    {
</I>&gt;<i>        static void Main(string[] args)
</I>&gt;<i>        {
</I>&gt;<i>            using (Package Package = Package.Open(&quot;out.zip&quot;,
</I>&gt;<i> FileMode.Create))
</I>&gt;<i>            {
</I>&gt;<i>                Uri partUri = new Uri(&quot;/_rels/.rels&quot;, UriKind.Relative);
</I>&gt;<i>                PackagePart packagePart = Package.CreatePart(partUri,
</I>&gt;<i> &quot;application/vnd.openxmlformats-package.relationships+xml&quot;);
</I>&gt;<i>
</I>&gt;<i>                using (Stream str = packagePart.GetStream())
</I>&gt;<i>                {
</I>&gt;<i>                    using (var writer = new XmlTextWriter(str, new
</I>&gt;<i> UTF8Encoding(false)))
</I>&gt;<i>                    {
</I>&gt;<i>                        writer.WriteStartDocument(true);
</I>&gt;<i>                        writer.WriteStartElement(&quot;Relationships&quot;);
</I>&gt;<i>                        writer.WriteAttributeString(&quot;xmlns&quot;,
</I>&gt;<i> &quot;<A HREF="http://schemas.openxmlformats.org/package/2006/relationships">http://schemas.openxmlformats.org/package/2006/relationships</A>&quot;);
</I>&gt;<i>                        writer.WriteStartElement(&quot;Relationship&quot;);
</I>&gt;<i>                        writer.WriteAttributeString(&quot;Type&quot;,
</I>&gt;<i> &quot;
</I>&gt;<i> <A HREF="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties">http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties</A>
</I>&gt;<i> &quot;);
</I>&gt;<i>                        writer.WriteEndElement();
</I>&gt;<i>                        writer.WriteEndElement();
</I>&gt;<i>                    }
</I>&gt;<i>                }
</I>&gt;<i>            }
</I>&gt;<i>        }
</I>&gt;<i>    }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> Strangely, it works when I change some strings:
</I>&gt;<i> a) &quot;/_rels/.rels&quot; -&gt; &quot;/rels/.rels&quot;
</I>&gt;<i> b) or &quot;xmlns&quot; -&gt; &quot;x&quot;
</I>&gt;<i> c) or &quot;<A HREF="http://schemas.openxmlformats.org/package/2006/relationships">http://schemas.openxmlformats.org/package/2006/relationships</A>&quot; -&gt;
</I>&gt;<i> &quot;<A HREF="http://schemas.openxmlformats.org/package/2007/relationships">http://schemas.openxmlformats.org/package/2007/relationships</A>&quot;
</I>&gt;<i> d) or &quot;<A HREF="http://schemas.openxmlformats.org/package/2006/relationships">http://schemas.openxmlformats.org/package/2006/relationships</A>&quot; -&gt;
</I>&gt;<i> &quot;<A HREF="http://schemas.openxmlformats.org/package/2007/relationships">http://schemas.openxmlformats.org/package/2007/relationships</A>&quot; and
</I>&gt;<i> &quot;
</I>&gt;<i> <A HREF="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties">http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties</A>
</I>&gt;<i> &quot;
</I>&gt;<i> -&gt;
</I>&gt;<i> &quot;
</I>&gt;<i> <A HREF="http://schemas.openxmlformats.org/package/2007/relationships/metadata/core-properties">http://schemas.openxmlformats.org/package/2007/relationships/metadata/core-properties</A>
</I>&gt;<i> &quot;
</I>&gt;<i>
</I>&gt;<i> This will bring me to insanity!
</I>&gt;<i>
</I>&gt;<i> Thanks for any help,
</I>&gt;<i> Cika Pero
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://mono.1490590.n4.nabble.com/System-IO-Packaging-throws-NullReferenceExeption-tp4372735p4372735.html">http://mono.1490590.n4.nabble.com/System-IO-Packaging-throws-NullReferenceExeption-tp4372735p4372735.html</A>
</I>&gt;<i> Sent from the Mono - Dev mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120209/533f8548/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120209/533f8548/attachment-0001.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038566.html">[Mono-dev] System.IO.Packaging throws NullReferenceExeption
</A></li>
	<LI>Next message: <A HREF="038567.html">[Mono-dev] SSL Certificate Binding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38571">[ date ]</a>
              <a href="thread.html#38571">[ thread ]</a>
              <a href="subject.html#38571">[ subject ]</a>
              <a href="author.html#38571">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
