<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] security related fix for	mcs/class/System/System.Net/WebHeaderCollection.cs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20security%20related%20fix%20for%0A%09mcs/class/System/System.Net/WebHeaderCollection.cs&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023262.html">
   <LINK REL="Next"  HREF="023149.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] security related fix for	mcs/class/System/System.Net/WebHeaderCollection.cs</H1>
    <B>joel reed</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20security%20related%20fix%20for%0A%09mcs/class/System/System.Net/WebHeaderCollection.cs&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] security related fix for	mcs/class/System/System.Net/WebHeaderCollection.cs">joelwreed at gmail.com
       </A><BR>
    <I>Tue Apr 17 06:54:52 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023262.html">[Mono-dev] System.Collections.Specialized.NameValueCollection patch
</A></li>
        <LI>Next message: <A HREF="023149.html">[Mono-dev] [PATCH] security related fix for	mcs/class/System/System.Net/WebHeaderCollection.cs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23148">[ date ]</a>
              <a href="thread.html#23148">[ thread ]</a>
              <a href="subject.html#23148">[ subject ]</a>
              <a href="author.html#23148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Section 15.2 of RFC 2608 reads:

   An HTTP/1.1 server may return multiple challenges with a 401
   (Authenticate) response, and each challenge may use a different
   scheme.  The order of the challenges returned to the user agent is in
   the order that the server would prefer they be chosen. The server
   should order its challenges with the &quot;most secure&quot; authentication
   scheme first. A user agent should choose as the challenge to be made
   to the user the first one that the user agent understands.

Without the attached change, mono was choosing whatever was sent last,
which was the most insecure authentication option.

This is a one line fix. Please apply.

By the way, I'm not convinced HttpWebRequest.cs will do the right thing
when it gets multiple www-authenticate headers. Let's say the first 
header says use NTLM, but someone has called, 
&quot;AuthenticationManager.Unregister(&quot;NTLM&quot;)&quot; - I'm fairly certain that 
will fail. But this is a separate bug.

jr

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023262.html">[Mono-dev] System.Collections.Specialized.NameValueCollection patch
</A></li>
	<LI>Next message: <A HREF="023149.html">[Mono-dev] [PATCH] security related fix for	mcs/class/System/System.Net/WebHeaderCollection.cs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23148">[ date ]</a>
              <a href="thread.html#23148">[ thread ]</a>
              <a href="subject.html#23148">[ subject ]</a>
              <a href="author.html#23148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
