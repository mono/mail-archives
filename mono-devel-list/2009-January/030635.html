<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Complex script / international support in	Winforms/libgdiplus
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Complex%20script%20/%20international%20support%20in%0A%09Winforms/libgdiplus&In-Reply-To=49793ACB.5010408%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030630.html">
   <LINK REL="Next"  HREF="030607.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Complex script / international support in	Winforms/libgdiplus</H1>
    <B>Miguel De Icaza</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Complex%20script%20/%20international%20support%20in%0A%09Winforms/libgdiplus&In-Reply-To=49793ACB.5010408%40gmail.com"
       TITLE="[Mono-dev] Complex script / international support in	Winforms/libgdiplus">miguel at novell.com
       </A><BR>
    <I>Sat Jan 24 20:04:04 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="030630.html">[Mono-dev] Complex script / international	support	in	Winforms/libgdiplus
</A></li>
        <LI>Next message: <A HREF="030607.html">[Mono-dev] setters and getters for mono.simd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30635">[ date ]</a>
              <a href="thread.html#30635">[ thread ]</a>
              <a href="subject.html#30635">[ subject ]</a>
              <a href="author.html#30635">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Jonathan,

I was very happy to read about your effort to add support for complex  
scripts to Mono's Windows.Forms implementation.

Getting the rendering in GDI+ is the first stage, as you have already  
discovered.   The second stage is a little bit more complicated as it  
will involve actually extending the text editor controls.    Your  
strategy so far is sound.

&gt;<i> The problem is that the implementation of the TextBox makes some very
</I>&gt;<i> basic assumptions that don't work for complex scripts, i.e. the  
</I>&gt;<i> width of
</I>&gt;<i> a string is not necessarily equal to the sum of the widths of the
</I>&gt;<i> individual characters.  This can even be true for Latin fonts that use
</I>&gt;<i> kerning and ligatures like ae, ff, and fi.  Also, separate code points
</I>&gt;<i> can form one grapheme (one rendered symbol).  All this causes problems
</I>&gt;<i> with selection, caret placement, and line breaking.
</I>
Correct, this is an area that will require some extensions.

&gt;<i> Now, all that being said, I've been working on the TextBox as well to
</I>&gt;<i> improve the implementation.  I'm not done yet, so I don't have any  
</I>&gt;<i> good
</I>&gt;<i> code to post here yet.  One of the problems that I'm working against  
</I>&gt;<i> is
</I>&gt;<i> that the gdi+ interface doesn't supply the information needed to do  
</I>&gt;<i> the
</I>&gt;<i> TextBox correctly, that is, if I want to work with libgdiplus to make
</I>&gt;<i> the pango calls, I'll need to add some linux-specific functions that I
</I>&gt;<i> can call for text metrics.  I noticed there are some other functions  
</I>&gt;<i> in
</I>&gt;<i> libgdiplus with &quot;_linux&quot; in the names, so I'm assuming that this won't
</I>&gt;<i> be a huge problem - otherwise, a lot of code for the cairo/pango
</I>&gt;<i> interaction would have to be copied into winforms.
</I>
This sounds like a good approach.

&gt;<i> I just wanted to let everyone know that I'm working on this, and I
</I>&gt;<i> wanted to see if the direction I'm taking using TextBoxTextRenderer  
</I>&gt;<i> and
</I>&gt;<i> libgdiplus seemed appropriate.
</I>
Both seem correct to me.

&gt;<i> Also, as I'll have a good bit of code
</I>&gt;<i> for both libgdiplus and winforms that will depend on each other,  
</I>&gt;<i> what's
</I>&gt;<i> the best way for me to get it into the project once I've got it  
</I>&gt;<i> working.
</I>
I suggest that you start posting your patches to the list.   We will  
usually provide some feedback and code review before the code goes  
into SVN.

Once the code is ready, either one of us will check in the code, or if  
you do not mind, we will give you an SVN account so you can check-in  
and maintain the updated code directly on SVN.

I am looking forward to this.   It is a feature that we always wanted  
to have!

Miguel.

</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030630.html">[Mono-dev] Complex script / international	support	in	Winforms/libgdiplus
</A></li>
	<LI>Next message: <A HREF="030607.html">[Mono-dev] setters and getters for mono.simd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30635">[ date ]</a>
              <a href="thread.html#30635">[ thread ]</a>
              <a href="subject.html#30635">[ subject ]</a>
              <a href="author.html#30635">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
