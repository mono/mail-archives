<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] patches that allow calling mono_init_com_types	from native	using ICall's.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20patches%20that%20allow%20calling%20mono_init_com_types%0A%09from%20native%09using%20ICall%27s.&In-Reply-To=1229722064.6189.49.camel%40localhost">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030375.html">
   <LINK REL="Next"  HREF="030370.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] patches that allow calling mono_init_com_types	from native	using ICall's.</H1>
    <B>Tom Hindle</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20patches%20that%20allow%20calling%20mono_init_com_types%0A%09from%20native%09using%20ICall%27s.&In-Reply-To=1229722064.6189.49.camel%40localhost"
       TITLE="[Mono-dev] [PATCH] patches that allow calling mono_init_com_types	from native	using ICall's.">tom_hindle at sil.org
       </A><BR>
    <I>Mon Jan  5 18:37:38 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="030375.html">[Mono-dev] Crash in gmcs
</A></li>
        <LI>Next message: <A HREF="030370.html">[Mono-dev] [PATCH] patches that allow calling mono_init_com_types from native	using ICall's.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30369">[ date ]</a>
              <a href="thread.html#30369">[ thread ]</a>
              <a href="subject.html#30369">[ subject ]</a>
              <a href="author.html#30369">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Attached are two patches that allow calling mono_init_com_types using
ICALL.

the function mono_init_com_types() is usually called automatically when
needed by the following internal functions in marshal.c
emit_ptr_to_object_conv,
emit_object_to_ptr_conv,
emit_struct_conv,
emit_marshal_com_interface,
emit_marshal_variant,
cominterop_get_native_wrapper,

However in none of these functions have run it not possible to call
functions like GetIUnknownForObjectInternal and QueryInterfaceInternal
via ICALL.

If this approach isn't acceptable would it be possible to add explicit
calls to mono_init_com_types info methods like
GetIUnknownForObjectInternal and QueryInterfaceInternal?

Thanks
Tom Hindle
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mcs_r121536_exposing_mono_init_com_types.patch
Type: text/x-patch
Size: 604 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090105/269dae61/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090105/269dae61/attachment.bin</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mono_r121548_exposing_mono_init_com_types.patch
Type: text/x-patch
Size: 1901 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090105/269dae61/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090105/269dae61/attachment-0001.bin</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030375.html">[Mono-dev] Crash in gmcs
</A></li>
	<LI>Next message: <A HREF="030370.html">[Mono-dev] [PATCH] patches that allow calling mono_init_com_types from native	using ICall's.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30369">[ date ]</a>
              <a href="thread.html#30369">[ thread ]</a>
              <a href="subject.html#30369">[ subject ]</a>
              <a href="author.html#30369">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
