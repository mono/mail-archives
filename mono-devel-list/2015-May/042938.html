<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] ReferenceSource of System.Text.UnicodeEncoding breaks System.Data.Odbc.OdbcDataReader.GetColumn(int)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20ReferenceSource%20of%20System.Text.UnicodeEncoding%20breaks%0A%20System.Data.Odbc.OdbcDataReader.GetColumn%28int%29&In-Reply-To=%3C20150504132221.4d17f8f1%40pc7010-34.zkrd-h10.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042943.html">
   <LINK REL="Next"  HREF="042939.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] ReferenceSource of System.Text.UnicodeEncoding breaks System.Data.Odbc.OdbcDataReader.GetColumn(int)</H1>
    <B>Markus Beth</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20ReferenceSource%20of%20System.Text.UnicodeEncoding%20breaks%0A%20System.Data.Odbc.OdbcDataReader.GetColumn%28int%29&In-Reply-To=%3C20150504132221.4d17f8f1%40pc7010-34.zkrd-h10.de%3E"
       TITLE="[Mono-dev] ReferenceSource of System.Text.UnicodeEncoding breaks System.Data.Odbc.OdbcDataReader.GetColumn(int)">markus.beth at zkrd.de
       </A><BR>
    <I>Mon May  4 11:22:21 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="042943.html">[Mono-dev] WebSocket Support in Mono
</A></li>
        <LI>Next message: <A HREF="042939.html">[Mono-dev] ReferenceSource of System.Text.UnicodeEncoding	breaks System.Data.Odbc.OdbcDataReader.GetColumn(int)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42938">[ date ]</a>
              <a href="thread.html#42938">[ thread ]</a>
              <a href="subject.html#42938">[ subject ]</a>
              <a href="author.html#42938">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

System.Data.Odbc.OdbcDataReader.GetColumn(int) works fine for us 
(linux x86_64, unixODBC) in Mono 3.12.1, but it is broken in Mono 
4.0.1. The reason for this is that the ReferenceSource implementation 
of System.Text.UnicodeEncoding.GetString(byte[]) behaves differently 
when you call it with a byte[] of odd length.

mono 3.12.1:
csharp&gt; System.Text.Encoding.Unicode.GetString(new byte[3]);
&quot;&quot;
Which is a string of length 1 containing one '\x0' character.


mono 4.0.1:
csharp&gt; System.Text.Encoding.Unicode.GetString(new byte[3]);
&quot;?&quot;
Which is a string of length 2 containing one '\x0' character followed
by a '?' (question mark)


We use the attached patch for Mono 4.0.1 which changes the
implementation of System.Data.Odbc.OdbcDataReader.GetColumn(int) to make
it work with either implementation of
System.Text.UnicodeEncoding.GetString.

Does it make sense to bring in patches like this or will
System.Data.Odbc be replaced by ReferenceSource in the (near) future?

Regards,
Markus
-------------- next part --------------
A non-text attachment was scrubbed...
Name: OdbcDataReader.GetColumn.patch
Type: text/x-patch
Size: 1205 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150504/e6c44d79/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150504/e6c44d79/attachment.bin</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042943.html">[Mono-dev] WebSocket Support in Mono
</A></li>
	<LI>Next message: <A HREF="042939.html">[Mono-dev] ReferenceSource of System.Text.UnicodeEncoding	breaks System.Data.Odbc.OdbcDataReader.GetColumn(int)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42938">[ date ]</a>
              <a href="thread.html#42938">[ thread ]</a>
              <a href="subject.html#42938">[ subject ]</a>
              <a href="author.html#42938">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
