<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Bug?: Mcs Custom Attribute Handling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Bug%3F%3A%20Mcs%20Custom%20Attribute%20Handling&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018025.html">
   <LINK REL="Next"  HREF="018046.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Bug?: Mcs Custom Attribute Handling</H1>
    <B>Norbert Berzen</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Bug%3F%3A%20Mcs%20Custom%20Attribute%20Handling&In-Reply-To="
       TITLE="[Mono-dev] Bug?: Mcs Custom Attribute Handling">norbert at spice.gia.rwth-aachen.de
       </A><BR>
    <I>Tue Apr  4 10:27:04 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018025.html">[Mono-dev] Thread Abort() sometimes fails in mono
</A></li>
        <LI>Next message: <A HREF="018046.html">[Mono-dev] Bug?: Mcs Custom Attribute Handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18017">[ date ]</a>
              <a href="thread.html#18017">[ thread ]</a>
              <a href="subject.html#18017">[ subject ]</a>
              <a href="author.html#18017">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

After compiling 'mono-tools-1.1.11' by 'mcs-1.1.14' I ran into some
trouble during execution of 'browser.exe'. IMHO recent version(s) of mcs
(1.1.14 and may be earlier) introduce a bug custom attribute handling.

E.g.: In a declaration of the form

class SomeClass {
  [SomeCustomAttribute] int x, y;
}

the field 'x' does not have any 'SomeCustomAttribute' attached to it,
but the field 'y' does have two 'SomeCustomAttribute' attached to it.
One may proof by compiling the following small snippet.

---&lt;cut here&gt;---&lt;cut here&gt;---&lt;cut here&gt;---&lt;cut here&gt;---&lt;cut here&gt;---

using System;
using System.Reflection;

[AttributeUsage(AttributeTargets.Field)]
class SomeCustomAttribute : Attribute {
  public SomeCustomAttribute ()
  {
  }
}

class MainClass {

  // Here, the custom attribute is attached correctly
  [SomeCustomAttribute]
  public int a;

  // Here, the custom attribute attachment has a flaw
  [SomeCustomAttribute]
  public int x, y;

  public static void Main ()
  {
    Type t = typeof (MainClass);
    FieldInfo[] fia = t.GetFields();

    foreach (FieldInfo fi in fia) {
      object[] ca = fi.GetCustomAttributes(false);
      System.Console.WriteLine (&quot;Field: {0} [{1}]&quot;, fi.Name, ca.Length);
      foreach (Attribute a in ca)
        System.Console.WriteLine (&quot;  Attribute: {0}&quot;, a);
    }
  }

}

---&lt;cut here&gt;---&lt;cut here&gt;---&lt;cut here&gt;---&lt;cut here&gt;---&lt;cut here&gt;---


-- 
Norbert

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018025.html">[Mono-dev] Thread Abort() sometimes fails in mono
</A></li>
	<LI>Next message: <A HREF="018046.html">[Mono-dev] Bug?: Mcs Custom Attribute Handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18017">[ date ]</a>
              <a href="thread.html#18017">[ thread ]</a>
              <a href="subject.html#18017">[ subject ]</a>
              <a href="author.html#18017">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
