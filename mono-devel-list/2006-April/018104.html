<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Re: [PATCH] ShellExecuteEx ProcessId support	forWindows 2000 and Windows XP RTM
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20%5BPATCH%5D%20ShellExecuteEx%20ProcessId%20support%0A%09forWindows%202000%20and%20Windows%20XP%20RTM&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018165.html">
   <LINK REL="Next"  HREF="018105.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Re: [PATCH] ShellExecuteEx ProcessId support	forWindows 2000 and Windows XP RTM</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20%5BPATCH%5D%20ShellExecuteEx%20ProcessId%20support%0A%09forWindows%202000%20and%20Windows%20XP%20RTM&In-Reply-To="
       TITLE="[Mono-dev] Re: [PATCH] ShellExecuteEx ProcessId support	forWindows 2000 and Windows XP RTM">kornelpal at gmail.com
       </A><BR>
    <I>Sat Apr  8 11:02:19 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018165.html">[Mono-dev] [PATCH] 2.0 profile version of resgen
</A></li>
        <LI>Next message: <A HREF="018105.html">[Mono-dev] Question about System.Web.UI.WebControls.DataList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18104">[ date ]</a>
              <a href="thread.html#18104">[ thread ]</a>
              <a href="subject.html#18104">[ subject ]</a>
              <a href="author.html#18104">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

For detailed information please refer to my previous message (included in 
this one).

&gt;<i> The GetProcessId check should remain in configure.in, and
</I>&gt;<i> HAVE_GETPROCESSID be used by the code to check if its available or not.
</I>&gt;<i> Remember, check for features not platforms.
</I>
We have a single binary for all supported Windows versions so we can't rely 
on actual feature set (or we should use LoadLibrary and GetProcaddress 
instead of static linking with run-time feature detection). Furthermore 
Windows header files are universal (for more information please read my 
previous post).

io-layer's GetProcessId can be used anywhere io-layer is used (anything but 
Windows). GetProcessId is not present on all Windows versions we support but 
NtQueryInformationProcess is supported on all of them. io-layer checks for 
platform as well so this is consistent. As such there is no need to have 
HAVE_GETPROCESSID.

Also note that your current code is never calling GetProcessId on Windows 
because _WIN32_WINNT is never set to 0x0502 or greater. So your current code 
is simply not working at all on Windows.

&gt;<i> Check that interdependencies between msvcrt.dll and ntdll.dll can be
</I>&gt;<i> _reliably_ solved by the link order.
</I>
My second (corrected) patch submitter right after my first one does this.

&gt;<i> Then I'll review an updated patch.
</I>
I resubmit the same patch (diff against the most recent SVN revision). 
Please review it. If you find any problems or have any objections please let 
me know otherwise please approve it.

Thanks.

Korn&#233;l

----- Original Message ----- 
From: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt;
To: &quot;Dick Porter&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">dick at ximian.com</A>&gt;; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Wednesday, April 05, 2006 3:12 AM
Subject: Re: [Mono-dev] Re: [PATCH] ShellExecuteEx ProcessId support
forWindows 2000 and Windows XP RTM


&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm only unsure about the configure part when specifying library (DLL)
</I>&gt;<i> dependencies. I know that the solution is the link order but I don't know
</I>&gt;<i> how to solve it. The submitted patch is correct but I'm not sure whether
</I>&gt;<i> it is the best solution. I'm not going to submit another patch as I don't
</I>&gt;<i> know other solution. If you have a better one please let me know.
</I>&gt;<i>
</I>&gt;<i> I consider the actual code patch to be complete, stable and safe so I'm
</I>&gt;<i> not going to modify it either.
</I>&gt;<i>
</I>&gt;<i> I'm confident regarding modifications made to process.c. I'm sure that
</I>&gt;<i> modifications made to configure.in are correct but there may be some other
</I>&gt;<i> solution as well.
</I>&gt;<i>
</I>&gt;<i> Checking for GetProcessId in header files is a bad idea as Windows
</I>&gt;<i> (Platform SDK) header files are universal so if you define the appropriate
</I>&gt;<i> WINVER (and/or _WIN32_WINNT, _WIN32_WINDOWS, _WIN32_IE) version you can
</I>&gt;<i> link to the API (including GetProcessId) of that version regardless of the
</I>&gt;<i> Windows version in use. Unlike the header files of Linux header files of
</I>&gt;<i> Windows are not describing the actual operating system version.
</I>&gt;<i>
</I>&gt;<i> But anyway this new code is not using GetProcessId on Windows and is using
</I>&gt;<i> io-layer's implementation everywhere else so there is no need to check for
</I>&gt;<i> GetProcessId.
</I>&gt;<i>
</I>&gt;<i> Korn&#233;l
</I>&gt;<i>
</I>&gt;<i> ----- Original Message ----- 
</I>&gt;<i> From: &quot;Dick Porter&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">dick at ximian.com</A>&gt;
</I>&gt;<i> To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i> Sent: Tuesday, April 04, 2006 2:18 PM
</I>&gt;<i> Subject: Re: [Mono-dev] Re: [PATCH] ShellExecuteEx ProcessId support
</I>&gt;<i> forWindows 2000 and Windows XP RTM
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Tue, 2006-04-04 at 12:01 +0200, Korn&#233;l P&#225;l wrote:
</I>&gt;&gt;<i> Could someone please review this patch.
</I>&gt;<i>
</I>&gt;<i> I was on holiday, and you didn't seem too confident about this patch
</I>&gt;<i> anyway; but here goes:
</I>&gt;<i>
</I>&gt;<i> The GetProcessId check should remain in configure.in, and
</I>&gt;<i> HAVE_GETPROCESSID be used by the code to check if its available or not.
</I>&gt;<i> Remember, check for features not platforms.
</I>&gt;<i>
</I>&gt;<i> Check that interdependencies between msvcrt.dll and ntdll.dll can be
</I>&gt;<i> _reliably_ solved by the link order.
</I>&gt;<i>
</I>&gt;<i> Then I'll review an updated patch.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> - Dick
</I>-------------- next part --------------
A non-text attachment was scrubbed...
Name: pid.diff
Type: application/octet-stream
Size: 2588 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060408/9c00778b/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060408/9c00778b/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018165.html">[Mono-dev] [PATCH] 2.0 profile version of resgen
</A></li>
	<LI>Next message: <A HREF="018105.html">[Mono-dev] Question about System.Web.UI.WebControls.DataList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18104">[ date ]</a>
              <a href="thread.html#18104">[ thread ]</a>
              <a href="subject.html#18104">[ subject ]</a>
              <a href="author.html#18104">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
