<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono Continuations and MicroThreads
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20Continuations%20and%20MicroThreads&In-Reply-To=BAY103-DAV18F2DA1357D18E71BBBD6887BB0%40phx.gbl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018319.html">
   <LINK REL="Next"  HREF="018322.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono Continuations and MicroThreads</H1>
    <B>Tomi Valkeinen</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20Continuations%20and%20MicroThreads&In-Reply-To=BAY103-DAV18F2DA1357D18E71BBBD6887BB0%40phx.gbl"
       TITLE="[Mono-dev] Mono Continuations and MicroThreads">tomba at bat.org
       </A><BR>
    <I>Fri Apr 21 03:42:08 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018319.html">[Mono-dev] Mono Continuations and MicroThreads
</A></li>
        <LI>Next message: <A HREF="018322.html">[Mono-dev] Mono Continuations and MicroThreads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18321">[ date ]</a>
              <a href="thread.html#18321">[ thread ]</a>
              <a href="subject.html#18321">[ subject ]</a>
              <a href="author.html#18321">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i> As i remember, previous version of your scheduler class has a &quot;strong 
</I>&gt;<i> reference&quot; to the socket manager class.
</I>&gt;<i>
</I>&gt;<i> What about an application does not using sockets ?
</I>&gt;<i> What about another socket implementation ( my case ) ?
</I>&gt;<i>
</I>&gt;<i> This is not a crucial fix, but i think it is better to keep out the Socket 
</I>&gt;<i> management. A programmer will use a microthread to update his socket ;).
</I>
The socket manager does not prevent you from doing anything. If you don't 
use the included socket implementation, the manager does not do anything, 
so you can as well use standard .Net sockets in your code. However, then 
you have to do all the work in non-blocking way, because if you block one 
microthread, all microthreads are frozen. You have to remember that 
microthreads are not OS threads =).

I've thought of implementing a generic way to add these &quot;managers&quot; to the 
scheduler, so you could implement blocking code (blocking in microthread 
sense, not in OS thread sense) similar to the socket implementation I 
have. But that's not so simple:

The basic problem here is about events. If we don't want to run in a busy 
loop, constantly polling for new events and using 100% of the CPU, there 
has to be some place where we wait for events or sleep for a certain time. 
Sleeping is not good because we can't know when the next event will come, 
and we would usually sleep too long.

In my current code this place, where we wait, is in the socket manager 
when we Select() the sockets. This works because currently socket events 
are the only events the microthreads react to. If we'd like to add a new 
type of event, for example input from console, we'd be in trouble as 
there's no way we could wait for events both from sockets and from console 
in the same place. Currently you'd have to have a microthread that polls 
the console input in a loop and sleeps for some milliseconds between the 
polls.

I'm not sure yet how to solve this event problem. Perhaps a separate OS 
thread that listens to the event, and notifies the OS thread where 
microthreads run via a socket.

  Tomi

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018319.html">[Mono-dev] Mono Continuations and MicroThreads
</A></li>
	<LI>Next message: <A HREF="018322.html">[Mono-dev] Mono Continuations and MicroThreads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18321">[ date ]</a>
              <a href="thread.html#18321">[ thread ]</a>
              <a href="subject.html#18321">[ subject ]</a>
              <a href="author.html#18321">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
