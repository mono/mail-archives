<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Thread Abort() sometimes fails in mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Thread%20Abort%28%29%20sometimes%20fails%20in%20mono&In-Reply-To=45a1b53e0604040726m56c7b208yd90bb83b5e9298cd%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018016.html">
   <LINK REL="Next"  HREF="018022.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Thread Abort() sometimes fails in mono</H1>
    <B>Felipe Almeida Lessa</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Thread%20Abort%28%29%20sometimes%20fails%20in%20mono&In-Reply-To=45a1b53e0604040726m56c7b208yd90bb83b5e9298cd%40mail.gmail.com"
       TITLE="[Mono-dev] Thread Abort() sometimes fails in mono">felipe.lessa at gmail.com
       </A><BR>
    <I>Tue Apr  4 12:13:10 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018016.html">[Mono-dev] Thread Abort() sometimes fails in mono
</A></li>
        <LI>Next message: <A HREF="018022.html">[Mono-dev] Re: Thread Abort() sometimes fails in mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18020">[ date ]</a>
              <a href="thread.html#18020">[ thread ]</a>
              <a href="subject.html#18020">[ subject ]</a>
              <a href="author.html#18020">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Em Ter, 2006-04-04 &#224;s 08:26 -0600, Wade Maxfield escreveu:
&gt;<i> Hi,
</I>
Hi! Correct me if I'm wrong but...

&gt;<i> /*doesn't always work ----&gt;*/    Global.WebThread.Abort();
</I>
You shouldn't be using Thread.Abort, right? AFAIK, this is a bad way of
killing threads.

&gt;<i>         while (!Global.WebThread.IsAlive);
</I>
Why do you make the CPU go to 100% here? At least some Sleep should be
better, no?

------

I didn't read all of your code, but I suspect you should be using
another thread abortion method. I have some code that uses a thread with
some web requests, and to abort it I do 2 things:

1) Create a variable that is marked false when I want the thread to die.
The thread's code periodically checks for the variable.
2) Save the WebRequest on a private variable to try to abort it, if
possible. 

The relevant abortion method:

public void Abort() {
	this.aborted = true;
	try {
		if (this.abortable) {
			this.webRequest.Abort();
			Logger.Log(this, &quot;WebRequest aborted with (apparent) success!&quot;);
		} else
			Logger.Log(this, &quot;WebRequest is not abortable.&quot;);
	} catch (Exception e) {
		Logger.Log(this, &quot;Failed to abort the WebRequest:\n&quot; + e.ToString());
	}
}

The method name is &quot;Abort&quot; because this class does not derive from
Thread. Also, you can safely ignore all Logger::Log calls.

abortable is a variable that is set to false when the code starts an
operation on the WebRequest that would probably crash the program if it
was aborted.

It's also worth noting that we just try to abort the WebRequest and
ignore any exceptions -- the code will stop anyway sometime soon as we
set the aborted variable.

HTH,

-- 
Felipe.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018016.html">[Mono-dev] Thread Abort() sometimes fails in mono
</A></li>
	<LI>Next message: <A HREF="018022.html">[Mono-dev] Re: Thread Abort() sometimes fails in mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18020">[ date ]</a>
              <a href="thread.html#18020">[ thread ]</a>
              <a href="subject.html#18020">[ subject ]</a>
              <a href="author.html#18020">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
