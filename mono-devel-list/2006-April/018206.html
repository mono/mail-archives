<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Re: StructLayout with misaligned offsets
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20StructLayout%20with%20misaligned%20offsets&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018205.html">
   <LINK REL="Next"  HREF="018208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Re: StructLayout with misaligned offsets</H1>
    <B>tcmichals</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20StructLayout%20with%20misaligned%20offsets&In-Reply-To="
       TITLE="[Mono-dev] Re: StructLayout with misaligned offsets">tcmichals at msn.com
       </A><BR>
    <I>Wed Apr 12 14:18:37 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018205.html">[Mono-dev] StructLayout with misaligned offsets
</A></li>
        <LI>Next message: <A HREF="018208.html">[Mono-dev] Re: StructLayout with misaligned offsets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18206">[ date ]</a>
              <a href="thread.html#18206">[ thread ]</a>
              <a href="subject.html#18206">[ subject ]</a>
              <a href="author.html#18206">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm also using the same method on other struct's and getting different sizes 
between mono 1.1.14 and 2.0 .NET, the .NET version is giving me the correct 
sizes, would this also be considered the same issue?

I'm trying use the StructLayout to overlay the same data structures used 
bettwen C++ and C#.
&quot;Zoltan Varga&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vargaz at gmail.com</A>&gt; wrote in message 
news:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">295e750a0604120928reebc06eh1e00f61496fb8123 at mail.gmail.com...</A>
            Hi,

 This is a known bug and it is tracked as:

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=77788">http://bugzilla.ximian.com/show_bug.cgi?id=77788</A>

       Zoltan

On 4/12/06, tcmichals &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">tcmichals at msn.com</A>&gt; wrote:
&gt;<i> namespace testCode
</I>&gt;<i> {
</I>&gt;<i>     class Program
</I>&gt;<i>     {
</I>&gt;<i>         [StructLayout(LayoutKind.Sequential, Pack = 1 /*, CharSet =
</I>&gt;<i> CharSet.Ansi */)/*, Serializable*/]
</I>&gt;<i>         public struct tagSDK
</I>&gt;<i>         {
</I>&gt;<i>
</I>&gt;<i>             [MarshalAs(UnmanagedType.ByValArray, SizeConst = 12)]
</I>&gt;<i>             public ushort[] inter;
</I>&gt;<i>             public ushort integ;
</I>&gt;<i>             public ushort mode;
</I>&gt;<i>             public ushort imaging;
</I>&gt;<i>             [MarshalAs(UnmanagedType.ByValArray, SizeConst = 12)]
</I>&gt;<i>             public ushort[] Avg;
</I>&gt;<i>             public ushort numOfIntervals;
</I>&gt;<i>             public tagSDK(int val)
</I>&gt;<i>             {
</I>&gt;<i>                 this.inter = new ushort[12];
</I>&gt;<i>                 this.inter[0] = 0;
</I>&gt;<i>                 this.Avg = new ushort[12];
</I>&gt;<i>                Avg[0] = 0;
</I>&gt;<i>                 integ = 0;
</I>&gt;<i>                 imaging = 0;
</I>&gt;<i>                 imaging2 = 0;
</I>&gt;<i>                 numOfIntervals = 0;
</I>&gt;<i>                 mode = 0;
</I>&gt;<i>            }
</I>&gt;<i>         };
</I>&gt;<i>         static void Main(string[] args)
</I>&gt;<i>         {
</I>&gt;<i>             tagSDK t= new tagSDK(0);
</I>&gt;<i>             Console.WriteLine(&quot;Hello World&quot;);
</I>&gt;<i>         }
</I>&gt;<i>     }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> When I attempt to execute the following program the following message is
</I>&gt;<i> generated
</I>&gt;<i> * ERROR **: file object.c: line 509 (compute_class_bitmap): assertion
</I>&gt;<i> failed: ((field-&gt;offset % sizeof(gpointer)) == 0)
</I>&gt;<i>
</I>&gt;<i> If I change The alignment of Avg to be on a 4 byte boundry it works,
</I>&gt;<i> sugguestions?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018205.html">[Mono-dev] StructLayout with misaligned offsets
</A></li>
	<LI>Next message: <A HREF="018208.html">[Mono-dev] Re: StructLayout with misaligned offsets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18206">[ date ]</a>
              <a href="thread.html#18206">[ thread ]</a>
              <a href="subject.html#18206">[ subject ]</a>
              <a href="author.html#18206">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
