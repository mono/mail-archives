<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Possible Crypto bug found...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Possible%20Crypto%20bug%20found...&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024219.html">
   <LINK REL="Next"  HREF="024220.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Possible Crypto bug found...</H1>
    <B>Stutzman, JL Jason @ IS</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Possible%20Crypto%20bug%20found...&In-Reply-To="
       TITLE="[Mono-dev] Possible Crypto bug found...">jae.stutzman at L-3com.com
       </A><BR>
    <I>Thu Jul 19 13:21:43 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024219.html">[Mono-dev] [PATCH] Optimizations for	FileSystemWatcher	and	MulticastDelegate
</A></li>
        <LI>Next message: <A HREF="024220.html">[Mono-dev] Possible Crypto bug found...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24215">[ date ]</a>
              <a href="thread.html#24215">[ thread ]</a>
              <a href="subject.html#24215">[ subject ]</a>
              <a href="author.html#24215">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Using the sample code found below:

<A HREF="http://www.obviex.com/samples/EncryptionWithSalt.aspx">http://www.obviex.com/samples/EncryptionWithSalt.aspx</A>

In the sample there is a loop that encrypts and decrypts several times.
If I add an extra encrypt in the loop before doing a decrypt:

cipherText = rijndaelKey.Encrypt(plainText);
cipherText = rijndaelKey.Encrypt(plainText);

then the Decrypt throws and exception on mono (which is not exactly
relevant, just pointing to the real problem):

System.OverflowException: Number overflow.
  at &lt;0x00000&gt; &lt;unknown method&gt;
  at (wrapper managed-to-native)
System.Object:__icall_wrapper_mono_array_new_specific (intptr,int)
  at RijndaelEnhanced.DecryptToBytes (System.Byte[] cipherTextBytes)
[0x00000] 
  at RijndaelEnhanced.Decrypt (System.Byte[] cipherTextBytes) [0x00000] 
  at RijndaelEnhancedTest.Main (System.String[] args) [0x00000] 

However if I recreate the encryptor and decryptor each time, the sample
works.

What seems to be happening is that the decryptor is not working
properly. The reason for this error is that the array trying to be
created is a negative size :)...but that is because the salt length is
greater than the decrypted size. My point is that the sample is showing
differences between the two runtimes.

On MS I don't have to recreate the encryptor/decryptor each time. Is
this known? Is the goal for crypto stuff to work the same as MS?


Jae

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024219.html">[Mono-dev] [PATCH] Optimizations for	FileSystemWatcher	and	MulticastDelegate
</A></li>
	<LI>Next message: <A HREF="024220.html">[Mono-dev] Possible Crypto bug found...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24215">[ date ]</a>
              <a href="thread.html#24215">[ thread ]</a>
              <a href="subject.html#24215">[ subject ]</a>
              <a href="author.html#24215">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
