<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Compiler bug with Generics and where constraints
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Compiler%20bug%20with%20Generics%20and%20where%20constraints&In-Reply-To=bce52be60707161343m7210441ao1e5ae114adccb17b%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024156.html">
   <LINK REL="Next"  HREF="024158.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Compiler bug with Generics and where constraints</H1>
    <B>Alan McGovern</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Compiler%20bug%20with%20Generics%20and%20where%20constraints&In-Reply-To=bce52be60707161343m7210441ao1e5ae114adccb17b%40mail.gmail.com"
       TITLE="[Mono-dev] Compiler bug with Generics and where constraints">alan.mcgovern at gmail.com
       </A><BR>
    <I>Mon Jul 16 16:46:09 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024156.html">[Mono-dev] Compiler bug with Generics and where constraints
</A></li>
        <LI>Next message: <A HREF="024158.html">[Mono-dev] Compiler bug with Generics and where constraints
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24157">[ date ]</a>
              <a href="thread.html#24157">[ thread ]</a>
              <a href="subject.html#24157">[ subject ]</a>
              <a href="author.html#24157">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I suggested the same thing, but was told the compiler didn't allow you to
add constraints to the overridden method. Also, i believe his code compiles
fine under csc, so unless it's a bug in CSC, there's definitely an issue
here.

Alan.

On 7/16/07, Adar Wesley &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">adar.wesley at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Hi John,
</I>&gt;<i>
</I>&gt;<i> It seams to me there is a problem with the code.  (I don't know if it
</I>&gt;<i> worked before)
</I>&gt;<i> In
</I>&gt;<i>
</I>&gt;<i>    1. protected static T
</I>&gt;<i>    GetBusinessQueryObjectFromReader&lt;T&gt;(IDataReader reader)
</I>&gt;<i>    2. 74             where T : BusinessQueryObject, new()
</I>&gt;<i>
</I>&gt;<i> The generic parameter T is contained.  However in:
</I>&gt;<i> public override T[] GetQueryObjects&lt;T&gt;(string query, params
</I>&gt;<i> QueryParameter[] parameters)
</I>&gt;<i> T is not constrained.
</I>&gt;<i>
</I>&gt;<i> When you try to call GetBusinessQueryObjectFromReader&lt;T&gt;(IDataReader
</I>&gt;<i> reader)
</I>&gt;<i> from within GetQueryObjects&lt;T&gt; with the same generic parameter you get the
</I>&gt;<i> error.
</I>&gt;<i>
</I>&gt;<i> Either add the same constraint on T in the decleration of
</I>&gt;<i> GetQueryObjects&lt;T&gt; or remove
</I>&gt;<i> the constraint from GetBusinessQueryObjectFromReader&lt;T&gt;.
</I>&gt;<i>
</I>&gt;<i> ---
</I>&gt;<i> Adar Wesley
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 7/16/07, John Anderson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sontek at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I tried making a smaller example but couldn't reproduce the error
</I>&gt;<i> &gt; because i'm not exactly sure whats causing it.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Heres the code:
</I>&gt;<i> &gt; <A HREF="http://dev.orchidesolutions.com/testcode.tar.bz2">http://dev.orchidesolutions.com/testcode.tar.bz2</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; if you run 'nant'  you'll see the error, its:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;    1. [nant] /home/sontek/code/personal/devtoo/trunk/src/DataArch.
</I>&gt;<i> &gt;    DataFactory.MsSqlDatabase/DataArch.DataFactory.MsSqlDatabase.dll .
</I>&gt;<i> &gt;    build build
</I>&gt;<i> &gt;    2.             Buildfile: file:
</I>&gt;<i> &gt;    ///home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.MsSqlDatabase/DataArch.DataFactory.MsSqlDatabase.dll.build
</I>&gt;<i> &gt;    3.             Target framework: Mono 2.0 Profile
</I>&gt;<i> &gt;    4.             Target(s ) specified: build
</I>&gt;<i> &gt;    5.
</I>&gt;<i> &gt;    6.
</I>&gt;<i> &gt;    7.             build:
</I>&gt;<i> &gt;    8.
</I>&gt;<i> &gt;    9.                  [echo] Build Directory is
</I>&gt;<i> &gt;    &lt;<A HREF="http://www.google.com/search?q=is+msdn.microsoft.com">http://www.google.com/search?q=is+msdn.microsoft.com</A>&gt;
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.
</I>&gt;<i> &gt;    MsSqlDatabase/bin/Release
</I>&gt;<i> &gt;    10.                   [csc] Compiling 3 files to '/home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.MsSqlDatabase/bin/Release/DataArch.DataFactory.MsSqlDatabase.dll'
</I>&gt;<i> &gt;    .
</I>&gt;<i> &gt;    11.                   [csc]/home/sontek/code/personal/devtoo/trunk/src/DataArch.
</I>&gt;<i> &gt;    DataFactory. MsSqlDatabase/MsSqlDataObjectFactory.cs(351 ,30):
</I>&gt;<i> &gt;    warning CS0219: The variable `columnsToUpdate ' is assigned but
</I>&gt;<i> &gt;    its value is never used
</I>&gt;<i> &gt;    12.                   [csc]
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.MsSqlDatabase/MsSqlDataObjectFactory.cs(479,30):
</I>&gt;<i> &gt;    error CS0309: The type `T' must be convertible to `DataArch.
</I>&gt;<i> &gt;    DataFactory.Common.BusinessQueryObject' in order to use it as
</I>&gt;<i> &gt;    parameter `T' in the generic type or method `DataArch.DataFactory.Common
</I>&gt;<i> &gt;    .BaseDataObjectFactory.GetBusinessQueryObjectFromReader &lt;T&gt;(System
</I>&gt;<i> &gt;    .Data.IDataReader)'
</I>&gt;<i> &gt;    13.                   [csc]
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.Common/bin/Release/DataArch.DataFactory.Common.dll
</I>&gt;<i> &gt;    (Location of the symbol related to previous error)
</I>&gt;<i> &gt;    14.                   [csc]
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.MsSqlDatabase/MsSqlDataObjectFactory.cs(462,9):
</I>&gt;<i> &gt;    (Location of the symbol related to previous error)
</I>&gt;<i> &gt;    15.                   [csc]
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.MsSqlDatabase/MsSqlDataObjectFactory.cs(479,30):
</I>&gt;<i> &gt;    error CS0309: The type `T' must be convertible to `DataArch.
</I>&gt;<i> &gt;    DataFactory.Common.BusinessQueryObject' in order to use it as
</I>&gt;<i> &gt;    parameter `T' in the generic type or method `DataArch.DataFactory.Common
</I>&gt;<i> &gt;    .BaseDataObjectFactory.GetBusinessQueryObjectFromReader &lt;T&gt;(System
</I>&gt;<i> &gt;    .Data.IDataReader)'
</I>&gt;<i> &gt;    16.                   [csc]
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.Common/bin/Release/DataArch.DataFactory.Common.dll
</I>&gt;<i> &gt;    (Location of the symbol related to previous error)
</I>&gt;<i> &gt;    17.                   [csc]
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.MsSqlDatabase/MsSqlDataObjectFactory.cs(462,9):
</I>&gt;<i> &gt;    (Location of the symbol related to previous error)
</I>&gt;<i> &gt;    18.                   [csc] Compilation failed: 2 error(s), 1
</I>&gt;<i> &gt;    warnings
</I>&gt;<i> &gt;    19.
</I>&gt;<i> &gt;    20.             BUILD FAILED - 0 non-fatal error(s), 7 warning(s)
</I>&gt;<i> &gt;    21.
</I>&gt;<i> &gt;    22.
</I>&gt;<i> &gt;    /home/sontek/code/personal/devtoo/trunk/src/DataArch.DataFactory.MsSqlDatabase/DataArch.DataFactory.MsSqlDatabase.dll.build(12,10):
</I>&gt;<i> &gt;    23.             External Program Failed:
</I>&gt;<i> &gt;    /usr/lib/pkgconfig/../../lib/mono/2.0/gmcs.exe (return code was 1)
</I>&gt;<i> &gt;    24.
</I>&gt;<i> &gt;    25.             Total time: 1 seconds.
</I>&gt;<i> &gt;    26.
</I>&gt;<i> &gt;    27.
</I>&gt;<i> &gt;    28. ======= MsSqlDataObjectFactory =================
</I>&gt;<i> &gt;    29.
</I>&gt;<i> &gt;    30.   public override T[] GetQueryObjects&lt;T&gt;(string query, params
</I>&gt;<i> &gt;    QueryParameter[] parameters)
</I>&gt;<i> &gt;    31. 462         {
</I>&gt;<i> &gt;    32. 463             DbCommand command = this.CreateNewCommand();
</I>&gt;<i> &gt;    33. 464
</I>&gt;<i> &gt;    34. 465              command.CommandText = query;
</I>&gt;<i> &gt;    35. 466             foreach (QueryParameter parameter in
</I>&gt;<i> &gt;    parameters)
</I>&gt;<i> &gt;    36. 467             {
</I>&gt;<i> &gt;    37. 468                 DbParameter dbParameter =
</I>&gt;<i> &gt;    command.CreateParameter();
</I>&gt;<i> &gt;    38. 469                 dbParameter.ParameterName = parameter.Name
</I>&gt;<i> &gt;    ;
</I>&gt;<i> &gt;    39. 470                 dbParameter.Value = parameter.Value;
</I>&gt;<i> &gt;    40. 471                 command.Parameters.Add(dbParameter);
</I>&gt;<i> &gt;    41. 472             }
</I>&gt;<i> &gt;    42. 473
</I>&gt;<i> &gt;    43. 474             List&lt;T&gt; list = new List&lt;T&gt;();
</I>&gt;<i> &gt;    44. 475
</I>&gt;<i> &gt;    45. 476             ExecuteReader(command,
</I>&gt;<i> &gt;    46. 477                 delegate(IDataReader reader)
</I>&gt;<i> &gt;    47. 478                 {
</I>&gt;<i> &gt;    48. 479                     list.Add(GetBusinessQueryObjectFromReader&lt;T&gt;(reader));
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;    49. 480                 });
</I>&gt;<i> &gt;    50. 481
</I>&gt;<i> &gt;    51. 482             return list.ToArray();
</I>&gt;<i> &gt;    52. 483         }
</I>&gt;<i> &gt;    53.
</I>&gt;<i> &gt;    54.
</I>&gt;<i> &gt;    55.
</I>&gt;<i> &gt;    56. ====== BASE  ==========
</I>&gt;<i> &gt;    57.
</I>&gt;<i> &gt;    58.   protected static T
</I>&gt;<i> &gt;    GetBusinessQueryObjectFromReader&lt;T&gt;(IDataReader reader)
</I>&gt;<i> &gt;    59. 74             where T : BusinessQueryObject, new()
</I>&gt;<i> &gt;    60. 75         {
</I>&gt;<i> &gt;    61. 76             QueryDataObject data = new
</I>&gt;<i> &gt;    QueryDataObject(reader);
</I>&gt;<i> &gt;    62. 77             T t = new T();
</I>&gt;<i> &gt;    63. 78             t.data = data;
</I>&gt;<i> &gt;    64. 79             return t;
</I>&gt;<i> &gt;    65. 80         }
</I>&gt;<i> &gt;    66.
</I>&gt;<i> &gt;    67.
</I>&gt;<i> &gt;    68. public abstract T[] GetQueryObjects&lt;T&gt;(string query, params
</I>&gt;<i> &gt;    QueryParameter[] parameters)
</I>&gt;<i> &gt;    69. 91             where T : BusinessQueryObject, new();
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> ---
</I>&gt;<i> Adar Wesley
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070716/0ad47024/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070716/0ad47024/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024156.html">[Mono-dev] Compiler bug with Generics and where constraints
</A></li>
	<LI>Next message: <A HREF="024158.html">[Mono-dev] Compiler bug with Generics and where constraints
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24157">[ date ]</a>
              <a href="thread.html#24157">[ thread ]</a>
              <a href="subject.html#24157">[ subject ]</a>
              <a href="author.html#24157">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
