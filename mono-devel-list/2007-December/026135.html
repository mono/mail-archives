<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] SSL Channel implementation and SslServerStream
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SSL%20Channel%20implementation%20and%20SslServerStream&In-Reply-To=049801c840c8%24d219c440%240702a8c0%40beardtongue">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026131.html">
   <LINK REL="Next"  HREF="026137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] SSL Channel implementation and SslServerStream</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SSL%20Channel%20implementation%20and%20SslServerStream&In-Reply-To=049801c840c8%24d219c440%240702a8c0%40beardtongue"
       TITLE="[Mono-dev] SSL Channel implementation and SslServerStream">sebastien.pouliot at gmail.com
       </A><BR>
    <I>Mon Dec 17 13:50:42 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="026131.html">[Mono-dev] SSL Channel implementation and SslServerStream
</A></li>
        <LI>Next message: <A HREF="026137.html">[Mono-dev] SSL Channel implementation and SslServerStream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26135">[ date ]</a>
              <a href="thread.html#26135">[ thread ]</a>
              <a href="subject.html#26135">[ subject ]</a>
              <a href="author.html#26135">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Pablo,

On Mon, 2007-12-17 at 17:21 +0100, pablosantosluac wrote:
&gt;<i> Hi again,
</I>&gt;<i> 
</I>&gt;<i> Well, looking into the ServerContext constructor: the code converts between 
</I>&gt;<i> the System.Security cert to a Mono cert. Ok, this calculation could be 
</I>&gt;<i> skipped if a server is launching threads with the same certificate. The 
</I>&gt;<i> performance hit &quot;caching&quot; this one is about a 50% (launching 350 client 
</I>&gt;<i> threads simultaneously).
</I>
Sorry but this is confusing. Let me clear this up a bit so the answer
will be meaningful when goggled in the future ;-)

Converting the certificate between the minimal MS X509Certificate and
the Mono.Security X509Certificate is a very simple process. This could
be cached but this, alone, won't influence much performance.

The key exchange does an expensive RSA operation, but it cannot be
cached in ServerContext.

Now what *could* help is implementing a session cache in the
server[1][2]. However this helps only caching a session between the
server and a single client - you cannot share a session between multiple
clients.

That being said the server code won't scale to support, efficiently, 350
sessions. If you need high performance SSL code don't look at a managed
implementation (and IMO consider hardware acceleration).

[1] the SslClientStream already support session caching
[2] contributions welcome

&gt;<i> 
</I>&gt;<i> I'll try to locate the next bottleneck
</I>
All cryptographic operations, like key exchange, encryption, integrity,
will show as a &quot;bottleneck&quot; - but they are exactly what you (should)
seek by choosing SSL.

&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> pablo
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ----- Original Message ----- 
</I>&gt;<i> From: &quot;pablosantosluac&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A>&gt;
</I>&gt;<i> To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i> Sent: Monday, December 17, 2007 4:23 PM
</I>&gt;<i> Subject: [Mono-dev] SSL Channel implementation and SslServerStream
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi all,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm implemented a secured TCP remoting channel. I took the current TCP
</I>&gt;<i> &gt; Channel as starting point, and used Ssl{Client|Server}Stream to implement
</I>&gt;<i> &gt; communication, as Robert Jordan suggested.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Well, it seems it works correctly but I've found the following issue:
</I>&gt;<i> &gt; creating each new connection takes time (obviously), but it is basically 
</I>&gt;<i> &gt; due
</I>&gt;<i> &gt; to a call to &quot;new ServerContext&quot; inside the SslServerStream constructor.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The problem, in fact, seems related with the property 
</I>&gt;<i> &gt; X509Certificate::RSA.
</I>&gt;<i> &gt; Each time a new connection is opened, a new certificate is given, and the
</I>&gt;<i> &gt; private key used.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Is there a way to actually make all this initialization just once? It 
</I>&gt;<i> &gt; would
</I>&gt;<i> &gt; greatly improve performance both in Mono and .NET.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any idea?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; thanks
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; pablo
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026131.html">[Mono-dev] SSL Channel implementation and SslServerStream
</A></li>
	<LI>Next message: <A HREF="026137.html">[Mono-dev] SSL Channel implementation and SslServerStream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26135">[ date ]</a>
              <a href="thread.html#26135">[ thread ]</a>
              <a href="subject.html#26135">[ subject ]</a>
              <a href="author.html#26135">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
