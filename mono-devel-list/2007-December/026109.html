<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Remoting and thread pool limits
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Remoting%20and%20thread%20pool%20limits&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026108.html">
   <LINK REL="Next"  HREF="026113.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Remoting and thread pool limits</H1>
    <B>pablosantosluac</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Remoting%20and%20thread%20pool%20limits&In-Reply-To="
       TITLE="[Mono-dev] Remoting and thread pool limits">pablosantosluac at terra.es
       </A><BR>
    <I>Sat Dec 15 11:02:27 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="026108.html">[Mono-dev] Remoting and thread pool limits
</A></li>
        <LI>Next message: <A HREF="026113.html">[Mono-dev] Remoting and thread pool limits
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26109">[ date ]</a>
              <a href="thread.html#26109">[ thread ]</a>
              <a href="subject.html#26109">[ subject ]</a>
              <a href="author.html#26109">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Well, it is not a *bug* but a feature. I wonder if it should be changed. If 
you look into RemotingThreadPool.cs there is a line like:


threadDone.WaitOne(PoolGrowDelay, false);


This one is actually the one making the process too slow. I'm afraid it must 
be something similar on the .NET code too!

Of course removing this line the problem gets solved, but I guess there is a 
reason in the channel to do that.


pablo


----- Original Message ----- 
From: &quot;Robert Jordan&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">robertj at gmx.net</A>&gt;
To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Saturday, December 15, 2007 4:12 PM
Subject: Re: [Mono-dev] Remoting and thread pool limits


&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> pablosantosluac wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I've found the following difference working with .NET and Mono remoting. 
</I>&gt;&gt;<i> In
</I>&gt;&gt;<i> .NET when the remoting ThreadPool reaches the pool's maximum (25 threads 
</I>&gt;&gt;<i> per
</I>&gt;&gt;<i> process), it is able to continue creating new threads. In fact, you can 
</I>&gt;&gt;<i> end
</I>&gt;&gt;<i> up having a remoting server with hundreds of threads.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In mono the behaviour is different. Once the limit is reached it starts
</I>&gt;&gt;<i> refusing connections.
</I>&gt;<i>
</I>&gt;<i> This is unrelated to mono's remoting thread pool. You have probably
</I>&gt;<i> ran your tests on Windows, where mono indeed fails with a GC failure
</I>&gt;<i> when too many threads are created because the GC has a hard coded
</I>&gt;<i> max thread count limit.
</I>&gt;<i>
</I>&gt;<i> On Linux (x86_64, Mono 1.2.6) I can finish the tests:
</I>&gt;<i>
</I>&gt;<i> Linux Mono client -&gt; Linux Mono server (same machine)
</I>&gt;<i>
</I>&gt;<i> poseidon [~/foo] $ mono client/bin/Debug/client.exe
</I>&gt;<i> <A HREF="tcp://localhost:8084/remote">tcp://localhost:8084/remote</A>
</I>&gt;<i> 1 - Time 1206 ms
</I>&gt;<i> 5 - Time 2045 ms
</I>&gt;<i> 10 - Time 3575 ms
</I>&gt;<i> 20 - Time 8174 ms
</I>&gt;<i> 40 - Time 12055 ms
</I>&gt;<i> 50 - Time 8185 ms
</I>&gt;<i> 200 - Time 46150 ms
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> MS.NET client -&gt; Linux Mono server (different machines)
</I>&gt;<i>
</I>&gt;<i> troll:/cygdrive/u/foo/client/bin/Debug $ ./client.exe
</I>&gt;<i> <A HREF="tcp://poseidon:8084/remote">tcp://poseidon:8084/remote</A>
</I>&gt;<i> 1 - Time 1297 ms
</I>&gt;<i> 5 - Time 2000 ms
</I>&gt;<i> 10 - Time 3515 ms
</I>&gt;<i> 20 - Time 6016 ms
</I>&gt;<i> 40 - Time 11031 ms
</I>&gt;<i> 50 - Time 6016 ms
</I>&gt;<i> 200 - Time 94375 ms
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The numbers don't look very well, though. I promise to look at
</I>&gt;<i> this when you file a bug report so that it doesn't get
</I>&gt;<i> overlooked.
</I>&gt;<i>
</I>&gt;<i> Robert
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026108.html">[Mono-dev] Remoting and thread pool limits
</A></li>
	<LI>Next message: <A HREF="026113.html">[Mono-dev] Remoting and thread pool limits
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26109">[ date ]</a>
              <a href="thread.html#26109">[ thread ]</a>
              <a href="subject.html#26109">[ subject ]</a>
              <a href="author.html#26109">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
