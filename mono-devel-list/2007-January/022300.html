<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] A question on Mono and -Bsymbolic
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20A%20question%20on%20Mono%20and%20-Bsymbolic&In-Reply-To=20070126155454.GA29952%40lucon.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022374.html">
   <LINK REL="Next"  HREF="022248.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] A question on Mono and -Bsymbolic</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20A%20question%20on%20Mono%20and%20-Bsymbolic&In-Reply-To=20070126155454.GA29952%40lucon.org"
       TITLE="[Mono-dev] A question on Mono and -Bsymbolic">lupus at ximian.com
       </A><BR>
    <I>Tue Jan 30 13:17:52 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022374.html">[Mono-dev] A question on Mono and -Bsymbolic
</A></li>
        <LI>Next message: <A HREF="022248.html">[Mono-dev] Need your help: Mainsoft/Novell &quot;Race to Linux&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22300">[ date ]</a>
              <a href="thread.html#22300">[ thread ]</a>
              <a href="subject.html#22300">[ subject ]</a>
              <a href="author.html#22300">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/26/07 H. J. Lu wrote:
&gt;<i> My optimization is to remove those extra PLT relocations and jumps
</I>&gt;<i> at link-time.  People reported:
</I>
That would be great.

&gt;<i> There are some performance numbers at
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://sourceware.org/bugzilla/show_bug.cgi?id=3831#c13">http://sourceware.org/bugzilla/show_bug.cgi?id=3831#c13</A>
</I>
I doubt we'd get much performance improvements, but it sure sounds like 
a worthwhile optimization.

&gt;<i> One side effect is you can no longer override global functions in a
</I>&gt;<i> shared libraries. Does it work with Mono shared libraries? If not,
</I>&gt;<i> is there a list of Mono functions which have to be overridable by
</I>&gt;<i> another shared library or user?
</I>
Do you plan to enable this feature by default?
Anyway, there is one case where this could cause problems for us if
enabled by default, if I understand things correctly.

Our setup is like this:
*) the mono runtime is implemented in a library, libmono
*) for speed, memory usage and debuggability issues, the mono binary
is statically linked to libmono
*) the runtime exposes a C API for profiling: profilers can be written
independently and compiled to shared libraries. The profiler uses
symbols from the embedding and profiling C API exposed by libmono:
the profile shared lib is linked against the dynamic libmono.
*) the mono binary loads the profiler module with dlopen: for it to work
the symbols must be resolved against the mono binary (typically a
function to register callbacks that happen during the program run)

Now the scenario can get complicated and I guess this may not even work
today if it happens (we'll always be able to fix the issue by
dynamically linking the mono binary...): if the profiler module uses a
symbol from libmono that the linker removed from the mono binary
(because it looks unused), the function from libmono will be used
and any other function it will call will come from libmono and not mono,
with the proposed change. I guess that depending on the nature of the
missing function things may work or not currently as well.

So, in the end, the change shouldn't be a problem for us.

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022374.html">[Mono-dev] A question on Mono and -Bsymbolic
</A></li>
	<LI>Next message: <A HREF="022248.html">[Mono-dev] Need your help: Mainsoft/Novell &quot;Race to Linux&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22300">[ date ]</a>
              <a href="thread.html#22300">[ thread ]</a>
              <a href="subject.html#22300">[ subject ]</a>
              <a href="author.html#22300">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
