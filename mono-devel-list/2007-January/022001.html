<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] vo.getAttribute is not a function (WebUIValidation*.js	bug)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20vo.getAttribute%20is%20not%20a%20function%20%28WebUIValidation%2A.js%0A%09bug%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022000.html">
   <LINK REL="Next"  HREF="022003.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] vo.getAttribute is not a function (WebUIValidation*.js	bug)</H1>
    <B>joel reed</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20vo.getAttribute%20is%20not%20a%20function%20%28WebUIValidation%2A.js%0A%09bug%29&In-Reply-To="
       TITLE="[Mono-dev] vo.getAttribute is not a function (WebUIValidation*.js	bug)">joel.reed at ddiworld.com
       </A><BR>
    <I>Wed Jan  3 09:41:33 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022000.html">[Mono-dev] Error parsing href values
</A></li>
        <LI>Next message: <A HREF="022003.html">[Mono-dev] ASP.NET ObjectDataSource problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22001">[ date ]</a>
              <a href="thread.html#22001">[ thread ]</a>
              <a href="subject.html#22001">[ subject ]</a>
              <a href="author.html#22001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The following patch fixes a bug in the web validation js files:

class/System.Web/resources/WebUIValidation.js
class/System.Web/resources/WebUIValidation_2.0.js

The &quot;bug&quot; is more like a quality of implementation issue. Basically, the 
patch changes all occurrences of

&quot;for (var v in myArray)&quot;

to

&quot;for (var v=0; v &lt; myArray.length; v++)&quot;

Without this change, aspx pages using prototype.js 
(<A HREF="http://prototype.conio.net/">http://prototype.conio.net/</A>), a popular ajax javascript library, will 
fail with a &quot;vo.getAttribute is not a function&quot; javascript error on 
mono. On Microsoft's .Net, they work just fine.

I have attached a sample html file and a copy of prototype.js which 
demonstrate why this happens. prototype.js extends the array class (see 
<A HREF="http://www.sergiopereira.com/articles/prototype.js.html#Reference.Array">http://www.sergiopereira.com/articles/prototype.js.html#Reference.Array</A>), 
which causes &quot;for (var v in myArray)&quot; to loop over not just the DOM 
elements with validation functions, but also the extended functions of 
the Array.prototype. This leads to the &quot;vo.getAttribute is not a 
function&quot; javascript error, when the loop tries to call getAttribute on 
the &quot;each&quot; function.

To fix this problem, I switched to the syntax &quot;for (var v=0; v &lt; 
myArray.length; v++)&quot;, which doesn't loop over the extended function set.

To reiterate: the ASPX pages which originally surfaced this issue work 
on Microsoft's .Net platform, but not on mono. With the attached patch, 
the ASPX pages work on mono.

OK to apply?

jr
-------------- next part --------------
A non-text attachment was scrubbed...
Name: vo.GetAttribute.patch
Type: text/x-patch
Size: 4495 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment.bin</A> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: prototype.js
Type: application/javascript
Size: 55149 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment-0001.bin</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: joel.reed.vcf
Type: text/x-vcard
Size: 405 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment.vcf">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070103/ec81a8e0/attachment.vcf</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022000.html">[Mono-dev] Error parsing href values
</A></li>
	<LI>Next message: <A HREF="022003.html">[Mono-dev] ASP.NET ObjectDataSource problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22001">[ date ]</a>
              <a href="thread.html#22001">[ thread ]</a>
              <a href="subject.html#22001">[ subject ]</a>
              <a href="author.html#22001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
