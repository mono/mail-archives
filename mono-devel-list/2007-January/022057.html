<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Possible security issue with Mono's dllmaps in etc/config
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Possible%20security%20issue%20with%20Mono%27s%20dllmaps%20in%20etc/config&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022056.html">
   <LINK REL="Next"  HREF="022058.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Possible security issue with Mono's dllmaps in etc/config</H1>
    <B>Marek Habersack</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Possible%20security%20issue%20with%20Mono%27s%20dllmaps%20in%20etc/config&In-Reply-To="
       TITLE="[Mono-dev] Possible security issue with Mono's dllmaps in etc/config">grendello at gmail.com
       </A><BR>
    <I>Mon Jan  8 06:17:28 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022056.html">[Mono-dev] New alternative patches list.
</A></li>
        <LI>Next message: <A HREF="022058.html">[Mono-dev] Possible security issue with Mono's dllmaps	in	etc/config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22057">[ date ]</a>
              <a href="thread.html#22057">[ thread ]</a>
              <a href="subject.html#22057">[ subject ]</a>
              <a href="author.html#22057">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everybody,

  Today while looking at the ODBC code in Mono, it occurred to me that
there might be a possible security problem with the way DLL maps are
specified in the default $prefix/etc/mono/config file. Given entries
like,

&lt;dllmap dll=&quot;libxslt.dll&quot; target=&quot;libxslt.so&quot; os=&quot;!windows&quot;/&gt;
&lt;dllmap dll=&quot;libmySQL.dll&quot; target=&quot;libmysqlclient.so&quot; os=&quot;!windows&quot; /&gt;
&lt;dllmap dll=&quot;odbc32.dll&quot; target=&quot;libodbc.so&quot; os=&quot;!windows&quot;/&gt;

we may encounter two issues. First (not security related, just usage
annoyance) is that on some Linux distributions the lib*.so file won't
exist unless there are devel packages installed for the library in
question. So unless the mono library mapper automatically appends the
soversion to the .so name and looks for files of the lib*.so.X form,
the library map will fail and the corresponding managed code won't work.
Second issue, this time security related, is with the library ABI. Say
that managed code uses a C structure in libsome.so whose field
types/field order/whatnot were changed in the newer library versions,
which were not released when the managed code was created (for instance
managed code was created with libsome.so.1 being the released version,
while the current libsome.so symlink points to libsome.so.3 - new ABI).
Such situation can introduce the possibility for buffer overruns,
variable overwrites, stack destruction - with the smallest impact on the
application being segfaults. If I'm talking nonsense, just lart me and
ignore :), but if the above is correct reasoning, then I propose to add
a feature to &lt;dllmap&gt; to specify the expected soversion for the map,
like so:

1. Consider only libxslt.so.1
&lt;dllmap dll=&quot;libxslt.dll&quot; target=&quot;libxslt.so&quot; soversion=&quot;1&quot;
os=&quot;!windows&quot;/&gt;

2. Consider several libxslt.so.X, in the order given
&lt;dllmap dll=&quot;libxslt.dll&quot; target=&quot;libxslt.so&quot; soversion=&quot;1,2,3&quot;
os=&quot;!windows&quot;/&gt;

3. Consider any soversion, starting from 0 and counting upwards
&lt;dllmap dll=&quot;libxslt.dll&quot; target=&quot;libxslt.so&quot; soversion=&quot;any&quot;
os=&quot;!windows&quot;/&gt;

4. Consider any soversion within the ranges (normal comparison
operators could also be used - eg. &gt;4,&lt;7)
&lt;dllmap dll=&quot;libxslt.dll&quot; target=&quot;libxslt.so&quot; soversion=&quot;4-7,8-10&quot;
os=&quot;!windows&quot;/&gt;

What do you think about the idea? Does it make sense?

best regards,

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070108/67ffe6ff/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070108/67ffe6ff/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022056.html">[Mono-dev] New alternative patches list.
</A></li>
	<LI>Next message: <A HREF="022058.html">[Mono-dev] Possible security issue with Mono's dllmaps	in	etc/config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22057">[ date ]</a>
              <a href="thread.html#22057">[ thread ]</a>
              <a href="subject.html#22057">[ subject ]</a>
              <a href="author.html#22057">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
