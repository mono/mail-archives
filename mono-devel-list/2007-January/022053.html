<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] 'sizeof' returns different results between .NET and Mono/Linux: a bug?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%27sizeof%27%20returns%20different%20results%20between%20.NET%20and%0A%20Mono/Linux%3A%20a%20bug%3F&In-Reply-To=459E63E9.1050509%40aulofee.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022032.html">
   <LINK REL="Next"  HREF="022033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] 'sizeof' returns different results between .NET and Mono/Linux: a bug?</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%27sizeof%27%20returns%20different%20results%20between%20.NET%20and%0A%20Mono/Linux%3A%20a%20bug%3F&In-Reply-To=459E63E9.1050509%40aulofee.com"
       TITLE="[Mono-dev] 'sizeof' returns different results between .NET and Mono/Linux: a bug?">robertj at gmx.net
       </A><BR>
    <I>Sun Jan  7 10:55:13 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022032.html">[Mono-dev] 'sizeof' returns different results between .NET	and	Mono/Linux: a bug?
</A></li>
        <LI>Next message: <A HREF="022033.html">[Mono-dev] crypto API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22053">[ date ]</a>
              <a href="thread.html#22053">[ thread ]</a>
              <a href="subject.html#22053">[ subject ]</a>
              <a href="author.html#22053">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Lionel Cuir wrote:
&gt;<i> Trying to understand what was wrong, I discovered that a given struct has not 
</I>&gt;<i> the same size for .NET and for Mono / Linux, even when playing with the Pack 
</I>&gt;<i> args. That seems very surprising... and I would it a bug of Mono on Linux. Any 
</I>&gt;<i> advice on this?
</I>
DateTime has different sizes between the runtimes and even between
runtime versions, so your code is doomed to break even on MS.NET
sooner or later.

Since DateTime is not under your control, you can't influence
its marshaling behavior. Hence you must either use binary serialization
or some surrogate representation of DateTime (DateTime.Ticks,
for example). This applies to all types that are not under your
control.

About your own types: you have to apply explicit packing to them,
because packing differs between platforms. Usually this doesn't
matter, because unmanaged libs have the same packing difference,
but since you're exchanging data over the wire, it becomes important.

Robert


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022032.html">[Mono-dev] 'sizeof' returns different results between .NET	and	Mono/Linux: a bug?
</A></li>
	<LI>Next message: <A HREF="022033.html">[Mono-dev] crypto API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22053">[ date ]</a>
              <a href="thread.html#22053">[ thread ]</a>
              <a href="subject.html#22053">[ subject ]</a>
              <a href="author.html#22053">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
