<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] monodocer and compier generated types.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20monodocer%20and%20compier%20generated%20types.&In-Reply-To=1167600278.21718.24.camel%40erandi.dom">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021978.html">
   <LINK REL="Next"  HREF="021980.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] monodocer and compier generated types.</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20monodocer%20and%20compier%20generated%20types.&In-Reply-To=1167600278.21718.24.camel%40erandi.dom"
       TITLE="[Mono-dev] monodocer and compier generated types.">jonpryor at vt.edu
       </A><BR>
    <I>Mon Jan  1 08:12:36 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="021978.html">[Mono-dev] NotSupportedException
</A></li>
        <LI>Next message: <A HREF="021980.html">[Mono-dev] Another bug in	System.Configuration.SettingsPropertyValueTest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21979">[ date ]</a>
              <a href="thread.html#21979">[ thread ]</a>
              <a href="subject.html#21979">[ subject ]</a>
              <a href="author.html#21979">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 2006-12-31 at 16:24 -0500, Miguel de Icaza wrote:
&gt;<i> &gt; I think monodocer (or whoever has generated this file) should
</I>&gt;<i> &gt; ignore classes marked with the CompilerGenerated attribute.
</I>&gt;<i> 
</I>&gt;<i> It seems like recent monodocer versions took care of this (or maybe it
</I>&gt;<i> was an improved scope for the classes generated by mcs/gmcs).
</I>
At present, monodocer only ignores internal types.  If a type is public
and has the CompilerGenerated attribute, it will still get documented.

Question: will there ever be a circumstance for a CompilerGenerated type
to be public (aside from someone manually creating such a type, rather
than the compiler doing so)?

If there shouldn't be a public CompilerGenerated type, then this patch
isn't necessary.

&gt;<i> Index: monodocer.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- monodocer.cs        (revision 70266)
</I>&gt;<i> +++ monodocer.cs        (working copy)
</I>&gt;<i> @@ -4,6 +4,8 @@
</I>&gt;<i>  
</I>&gt;<i>  using System;
</I>&gt;<i>  using System.Collections;
</I>&gt;<i> +using System.Runtime.CompilerServices;
</I>&gt;<i> +
</I>&gt;<i>  #if !NET_1_0
</I>&gt;<i>  using System.Collections.Generic;
</I>&gt;<i>  #endif
</I>&gt;<i> @@ -313,6 +315,26 @@
</I>&gt;<i>                 }       
</I>&gt;<i>         }
</I>&gt;<i>  
</I>&gt;<i> +       //
</I>&gt;<i> +       // Returns true if the given type was compiler generated.
</I>&gt;<i> +       //
</I>&gt;<i> +       // In the 1.0 profile we do not have an attribute to check
</I>&gt;<i> +       // for, so we check for the MCS pattern for compiler generated
</I>&gt;<i> +       // types.  This is fragile.
</I>&gt;<i> +       //
</I>&gt;<i> +       public static bool IsCompilerGenerated (Type type)
</I>&gt;<i> +       {
</I>&gt;<i> +#if NET_1_0
</I>&gt;<i> +               string type_name = type.Name;
</I>&gt;<i> +               
</I>&gt;<i> +               if (type_name.IndexOf (&quot;&lt;&gt;c__&quot;) != -1)
</I>&gt;<i> +                       return true;
</I>&gt;<i> +               return false;
</I>&gt;<i> +#else
</I>&gt;<i> +               object [] attrs = type.GetCustomAttributes (typeof
</I>&gt;<i> (CompilerGeneratedAttribute), true);
</I>&gt;<i> +               return (attrs.Length &gt; 0);
</I>&gt;<i> +#endif
</I>&gt;<i> +       }
</I>&gt;<i>         
</I>&gt;<i>         public static void DoUpdateNS(string ns, string nspath, string
</I>&gt;<i> outpath) {
</I>&gt;<i>                 Hashtable seenTypes = new Hashtable();
</I>&gt;<i> @@ -342,10 +364,14 @@
</I>&gt;<i>                 
</I>&gt;<i>                 // Stub types not in the directory
</I>&gt;<i>                 foreach (Type type in assembly.GetTypes()) {
</I>&gt;<i> -                       if (type.Namespace == null) continue;
</I>&gt;<i> +                       if (type.Namespace == null)
</I>&gt;<i> +                               continue;
</I>
This change is redundant.

Otherwise, the patch looks good, *if* it's necessary.

If it is deemed necessary, you should include a test for it by changing
DocTest-v1.cs and adding a public [CompilerGenerated] type.  It
shouldn't cause any new files to be created (use `svn status DocTest' to
check).

 - Jon



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021978.html">[Mono-dev] NotSupportedException
</A></li>
	<LI>Next message: <A HREF="021980.html">[Mono-dev] Another bug in	System.Configuration.SettingsPropertyValueTest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21979">[ date ]</a>
              <a href="thread.html#21979">[ thread ]</a>
              <a href="subject.html#21979">[ subject ]</a>
              <a href="author.html#21979">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
