<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] HttpWebRequest method patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20HttpWebRequest%20method%20patch&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022261.html">
   <LINK REL="Next"  HREF="022266.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] HttpWebRequest method patch</H1>
    <B>Gert Driesen</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20HttpWebRequest%20method%20patch&In-Reply-To="
       TITLE="[Mono-dev] HttpWebRequest method patch">gert.driesen at telenet.be
       </A><BR>
    <I>Mon Jan 29 04:48:43 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022261.html">[Mono-dev] HttpWebRequest method patch
</A></li>
        <LI>Next message: <A HREF="022266.html">[Mono-dev] HttpWebRequest method patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22265">[ date ]</a>
              <a href="thread.html#22265">[ thread ]</a>
              <a href="subject.html#22265">[ subject ]</a>
              <a href="author.html#22265">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Atushi,

I noticed something similar for FileWebRequest, where methods are handled 
case-insensitive too.

I'd suggest adding unit tests which verify the MS behavior, and modify our 
HttpWebRequest accordingly.

We could then still report it as an issue to MS (using 
connect.microsoft.com), and the unit test would alert us if/when MS changes 
their (broken) behavior (but this is unlikely to happen, as it could break 
existing code).

I'll take care of the unit tests (later), if you want to.

Gert

----- Original Message ----- 
From: &quot;Atsushi Eno&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushi at ximian.com</A>&gt;
To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Monday, January 29, 2007 12:46 AM
Subject: [Mono-dev] HttpWebRequest method patch


&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I have a patch for HttpWebRequest.cs which might be problematic.
</I>&gt;<i>
</I>&gt;<i> HttpWebRequest differentiates request/response stream processing
</I>&gt;<i> based on the method (POST/PUT etc.). .NET actually handles things
</I>&gt;<i> like &quot;post&quot; as POST and thus with such methods it uses POST-style
</I>&gt;<i> processing.
</I>&gt;<i>
</I>&gt;<i> The attached patch makes HttpWebRequest to work along that way,
</I>&gt;<i> but to me it looks like HTTP RFC (2616) violation.
</I>&gt;<i>
</I>&gt;<i> (I noticed this issue when trying to get Lingr API .NET wrapper ==
</I>&gt;<i> <A HREF="http://www.legendes.jp/lingr/api.net/">http://www.legendes.jp/lingr/api.net/</A> . The source will be fixed
</I>&gt;<i> anyways.)
</I>&gt;<i>
</I>&gt;<i> Atsushi Eno
</I>&gt;<i>
</I>

--------------------------------------------------------------------------------


&gt;<i> Index: System.Net/HttpWebRequest.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- System.Net/HttpWebRequest.cs (revision 71778)
</I>&gt;<i> +++ System.Net/HttpWebRequest.cs (working copy)
</I>&gt;<i> @@ -372,7 +372,23 @@
</I>&gt;<i>  if (value == null || value.Trim () == &quot;&quot;)
</I>&gt;<i>  throw new ArgumentException (&quot;not a valid method&quot;);
</I>&gt;<i>
</I>&gt;<i> - method = value;
</I>&gt;<i> + // LAMESPEC: This class is not really case
</I>&gt;<i> + // sensitive for those methods here, which
</I>&gt;<i> + // would violate RFC 2616 (5.1.1).
</I>&gt;<i> + string upper = value.ToUpperInvariant ();
</I>&gt;<i> + switch (value.ToUpperInvariant ()) {
</I>&gt;<i> + case &quot;GET&quot;:
</I>&gt;<i> + case &quot;POST&quot;:
</I>&gt;<i> + case &quot;PUT&quot;:
</I>&gt;<i> + case &quot;HEAD&quot;:
</I>&gt;<i> + case &quot;CONNECT&quot;:
</I>&gt;<i> + case &quot;MKCOL&quot;:
</I>&gt;<i> + method = upper; // case sensitive
</I>&gt;<i> + break;
</I>&gt;<i> + default:
</I>&gt;<i> + method = value; // case insensitive
</I>&gt;<i> + break;
</I>&gt;<i> + }
</I>&gt;<i>  }
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i>
</I>

--------------------------------------------------------------------------------


&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022261.html">[Mono-dev] HttpWebRequest method patch
</A></li>
	<LI>Next message: <A HREF="022266.html">[Mono-dev] HttpWebRequest method patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22265">[ date ]</a>
              <a href="thread.html#22265">[ thread ]</a>
              <a href="subject.html#22265">[ subject ]</a>
              <a href="author.html#22265">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
