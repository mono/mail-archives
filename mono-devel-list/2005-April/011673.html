<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Authenticode / signcode / chktrust  problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Authenticode%20/%20signcode%20/%20chktrust%20%20problem&In-Reply-To=009701c5461e%244aafde10%245200010a%40FOO">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011667.html">
   <LINK REL="Next"  HREF="011689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Authenticode / signcode / chktrust  problem</H1>
    <B>S&#233;bastien Pouliot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Authenticode%20/%20signcode%20/%20chktrust%20%20problem&In-Reply-To=009701c5461e%244aafde10%245200010a%40FOO"
       TITLE="[Mono-devel-list] Authenticode / signcode / chktrust  problem">spouliot at videotron.ca
       </A><BR>
    <I>Thu Apr 21 07:50:40 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011667.html">[Mono-devel-list] Authenticode / signcode / chktrust  problem
</A></li>
        <LI>Next message: <A HREF="011689.html">[Mono-devel-list] Authenticode / signcode / chktrust  problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11673">[ date ]</a>
              <a href="thread.html#11673">[ thread ]</a>
              <a href="subject.html#11673">[ subject ]</a>
              <a href="author.html#11673">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Daryn,

&gt;<i> I'm having a problem signing some code  (the pvk &amp; spc are valid,
</I>&gt;<i> and work
</I>&gt;<i> fine for signing on windows using signcode.exe)
</I>&gt;<i>
</I>&gt;<i> 1. signcode -spc mycert.spc -v mykey.pvk -t
</I>&gt;<i> <A HREF="http://timestamp.verisign.com/scripts/timstamp.dll">http://timestamp.verisign.com/scripts/timstamp.dll</A> Setup.exe
</I>&gt;<i>             Mono SignCode - version 1.1.5.0
</I>&gt;<i>             Sign assemblies and PE files using Authenticode(tm).
</I>&gt;<i>             Copyright 2002, 2003 Motus Technologies. Copyright 2004-2005
</I>&gt;<i> Novell. BSD licensed.
</I>&gt;<i>
</I>&gt;<i> 2. chktrust -v /root/Setup.exe
</I>&gt;<i>             Mono CheckTrust - version 1.1.5.0
</I>&gt;<i>             Verify if an PE executable has a valid Authenticode(tm)
</I>&gt;<i> signature
</I>&gt;<i>             Copyright 2002, 2003 Motus Technologies. Copyright 2004-2005
</I>&gt;<i> Novell. BSD licensed.
</I>&gt;<i>
</I>&gt;<i>             Verifying file Setup.exe for Authenticode(tm) signatures...
</I>&gt;<i>
</I>&gt;<i>             WARNING! Setup.exe is not timestamped!
</I>&gt;<i>             ERROR! Setup.exe couldn't find the certificate that
</I>&gt;<i> signed the
</I>&gt;<i> file!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> My guess is that perhaps this has something to do with CA's,
</I>
Maybe but this isn't the error that chktrust would normally display if it
was missing the root certificate.

&gt;<i> and I've
</I>&gt;<i> downloaded the CA Certs from thawte and verisign, but I'm not sure I've
</I>&gt;<i> installed them correctly using certmgr, as I'm not sure the proper use of
</I>&gt;<i> the various stores.
</I>
Is your certificate from Thawte or VeriSign ?

Some people had problem with the SPC file supplied by VeriSign because it
use undefined length encoding in it's ASN.1 structure. The &quot;trick&quot; is to
import it in Windows then export it back to a SPC file. Windows will have
converted the structure to &quot;defined&quot; length - which Mono tools can
understand.

Look in bugzilla for #68903 for a detailled workaround.

&gt;<i> This is what I did (for every CA cert I could find):
</I>&gt;<i>
</I>&gt;<i> certmgr -add -c -m CA ThawteServerCA.cer
</I>&gt;<i>             Mono Certificate Manager - version 1.1.5.0
</I>&gt;<i>             Manage X.509 certificates and CRL from stores.
</I>&gt;<i>             Copyright 2002, 2003 Motus Technologies. Copyright 2004-2005
</I>&gt;<i> Novell. BSD licensed.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>             1 certificate(s) added to store CA.
</I>
Wrong store. You must use the Trust store if you want chktrust to validate
your signatures. The CA store can be used for any type of CA (i.e. not only
root CA).

<A HREF="http://www.mono-project.com/FAQ:_Security">http://www.mono-project.com/FAQ:_Security</A>
or
&quot;man certmgr&quot;

&gt;<i> Also, on Widows, when I look at the properties &gt; digital signatures, the
</I>&gt;<i> signature IS there, but it says it is &quot;not valid&quot;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Can anyone provide some guidance?
</I>
The FAQ and the man pages of the tools should be able to answers most
questions. Also have a look at the mailing list archives.

Sebastien Pouliot
home: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">spouliot at videotron.ca</A>
blog: <A HREF="http://pages.infinit.net/ctech/poupou.html">http://pages.infinit.net/ctech/poupou.html</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011667.html">[Mono-devel-list] Authenticode / signcode / chktrust  problem
</A></li>
	<LI>Next message: <A HREF="011689.html">[Mono-devel-list] Authenticode / signcode / chktrust  problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11673">[ date ]</a>
              <a href="thread.html#11673">[ thread ]</a>
              <a href="subject.html#11673">[ subject ]</a>
              <a href="author.html#11673">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
