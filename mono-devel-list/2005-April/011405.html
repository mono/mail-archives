<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] [PATCH] SslCipherSuite sequence #
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20SslCipherSuite%20sequence%20%23&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011404.html">
   <LINK REL="Next"  HREF="011411.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] [PATCH] SslCipherSuite sequence #</H1>
    <B>Brian Ritchie</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20SslCipherSuite%20sequence%20%23&In-Reply-To="
       TITLE="[Mono-devel-list] [PATCH] SslCipherSuite sequence #">brian.ritchie at gmail.com
       </A><BR>
    <I>Mon Apr  4 23:15:21 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011404.html">[Mono-devel-list] monod: System.ServiceProcess on Linux
</A></li>
        <LI>Next message: <A HREF="011411.html">[Mono-devel-list] [PATCH] SslCipherSuite sequence #
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11405">[ date ]</a>
              <a href="thread.html#11405">[ thread ]</a>
              <a href="subject.html#11405">[ subject ]</a>
              <a href="author.html#11405">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I've been working on integrating the SslServerStream with XSP and ran
across what appears to be a bug in the SslCipherSuite class. I'm new
to the inner workings of SSL, so please forgive any misstatements.

Once I had the SslServerStream hooked into the XSP server, it wasn't
working properly...GETs would work, but POST-backs wouldn't. (On
Firefox &amp; IE)  After much debugging, I think I've found the answer.
The ComputeClientRecordMAC function that calculated the hash for each
fragment coming from the client (and comparing it to the hash provided
by the client)...was using the wrong sequence #.  As I understand it,
a request is broken into multiple fragments, and a sequence # is
incremented for each fragment.  Since the wrong sequence # was being
used, the hashes for requests with more than one fragment were
invalid.  Since POSTs have more data, they were being broken into
multiple fragments.

Once I applied this simple patch (attached), XSP worked nicely with
both browsers
in SSL mode.

Please let me know if this patch can be committed.

Thanks,
Brian
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SslCipherSuite.diff
Type: application/octet-stream
Size: 573 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050404/e230a31e/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050404/e230a31e/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011404.html">[Mono-devel-list] monod: System.ServiceProcess on Linux
</A></li>
	<LI>Next message: <A HREF="011411.html">[Mono-devel-list] [PATCH] SslCipherSuite sequence #
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11405">[ date ]</a>
              <a href="thread.html#11405">[ thread ]</a>
              <a href="subject.html#11405">[ subject ]</a>
              <a href="author.html#11405">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
