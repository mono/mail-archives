<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Can I use Microsoft's DLL's on the Win32 platform?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Can%20I%20use%20Microsoft%27s%20DLL%27s%20on%20the%20Win32%20platform%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011719.html">
   <LINK REL="Next"  HREF="011724.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Can I use Microsoft's DLL's on the Win32 platform?</H1>
    <B>Pete Gonzalez</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Can%20I%20use%20Microsoft%27s%20DLL%27s%20on%20the%20Win32%20platform%3F&In-Reply-To="
       TITLE="[Mono-devel-list] Can I use Microsoft's DLL's on the Win32 platform?">pgonzalez at bluel.com
       </A><BR>
    <I>Mon Apr 25 15:17:07 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011719.html">[Mono-devel-list] Re: removing the vnc keyboard
</A></li>
        <LI>Next message: <A HREF="011724.html">[Mono-devel-list] Can I use Microsoft's DLL's on the Win32	platform?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11722">[ date ]</a>
              <a href="thread.html#11722">[ thread ]</a>
              <a href="subject.html#11722">[ subject ]</a>
              <a href="author.html#11722">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am just getting started with Mono on Windows XP.  I built a very simple 
HelloWorld.exe using Visual Studio, then I clicked on the &quot;Mono-1.1.6 
Command Prompt&quot; and typed &quot;mono HelloWorld&quot;.  When my form appeared, the 
GUI did not look quite right, which is a little surprising since it's just 
an empty dialog box with a button.  :-)

The Mono Windows.Forms implementation obviously is still &quot;under 
construction,&quot; but since my target platform is Windows XP, I can just use 
the real Microsoft libraries.  So I tracked down all the referenced 
Microsoft DLL's and copied them to the same folder as HelloWorld.exe, so 
that Mono will load them instead of its custom versions.  However, now my 
application crashes with an exception:

 &gt; Unhandled Exception: System.NotImplementedException: The
 &gt; requested feature is not implemented.
 &gt; in &lt;0x00021&gt; Microsoft.Win32.SystemEvents:add_UserPreferenceChanging
 &gt; (Microsoft.Win32.UserPreferenceChangingEventHandler value)
 &gt; in &lt;0x0004e&gt; System.Drawing.KnownColorTable:InitColorTable ()
 &gt; in &lt;0x00010&gt; System.Drawing.KnownColorTable:EnsureColorTable ()
 &gt; in &lt;0x00007&gt; System.Drawing.KnownColorTable:KnownColorToArgb
 &gt; (KnownColor color)
 &gt; in &lt;0x0003c&gt; System.Drawing.Color:get_Value ()

I read the FAQ's, but apparently using Microsoft DLL's has never occurred 
to anyone?  It seems to me that, as long Mono's MSIL virtual machine and 
pinvoke support are there, mono.exe should work as a drop-in replacement 
for Microsoft's virtual machine (regardless of how incomplete Mono's .NET 
Framework is).  Moreover, it seems that this would be a quite simple 
challenge compared to implementing a full C# compiler or Windows.Forms 
replacement.  So -- has anyone asked about this?  Does it work?

My hope is to use kick-ass Mono features (such as the SSA optimizations, 
&quot;--aot&quot;, &quot;mkbundle&quot;, etc.) with standard Visual Studio projects, which 
you'd think would be very attractive.  More importantly, Win32 offers a 
vast array of libraries that may be unsupported by Mono for a long time, so 
in a sense, this is a mandatory requirement for Win32 developers who aren't 
hindered by portability concerns.

Cheers,
-Pete


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011719.html">[Mono-devel-list] Re: removing the vnc keyboard
</A></li>
	<LI>Next message: <A HREF="011724.html">[Mono-devel-list] Can I use Microsoft's DLL's on the Win32	platform?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11722">[ date ]</a>
              <a href="thread.html#11722">[ thread ]</a>
              <a href="subject.html#11722">[ subject ]</a>
              <a href="author.html#11722">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
