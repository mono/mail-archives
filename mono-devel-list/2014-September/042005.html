<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Heads up: upcoming Dns.GetHostByName changes.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Heads%20up%3A%20upcoming%20Dns.GetHostByName%20changes.&In-Reply-To=%3CCANqeOFpgJ3u3tBkeen0sX%2Bu04AFbG4d2hAGasT4OOX5pHwhoKw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042004.html">
   <LINK REL="Next"  HREF="042006.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Heads up: upcoming Dns.GetHostByName changes.</H1>
    <B>Miguel de Icaza</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Heads%20up%3A%20upcoming%20Dns.GetHostByName%20changes.&In-Reply-To=%3CCANqeOFpgJ3u3tBkeen0sX%2Bu04AFbG4d2hAGasT4OOX5pHwhoKw%40mail.gmail.com%3E"
       TITLE="[Mono-dev] Heads up: upcoming Dns.GetHostByName changes.">miguel at xamarin.com
       </A><BR>
    <I>Mon Sep 29 13:57:14 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="042004.html">[Mono-dev] SerialPort
</A></li>
        <LI>Next message: <A HREF="042006.html">[Mono-dev] spec file changes to enable RH builds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42005">[ date ]</a>
              <a href="thread.html#42005">[ thread ]</a>
              <a href="subject.html#42005">[ subject ]</a>
              <a href="author.html#42005">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Short version:

We will be changing the behavior of GetHostByName to be a raw mapping to
the underlying Unix gethostinfo information, and removing some of the
special behavior we added in 2005 to try to mimic the Windows DNS API.

This will break applications that depended on this idiom to work:

Dns.GetHostByName (Dns.GetHostName ())

To return the list of publicly visible names/IP addresses associated with
the host.

Fix: Use System.Net.NetworkInformation APIs instead.

On Friday we were debugging a curious issue with HttpListener that fixes an
old bug.

In the past, HttpListener would start a listening socket on all interfaces,
regardless of a hostname being specified.  For example (&quot;localhost:8080&quot;)
would listen on both the 127.0.0.1 interface as well as your public IP
address on port 8080.

This was changed to require &quot;*&quot; to have this behavior, and altered so that
you would need to explicitly list all the IP addresses or hostnames that
you wanted to listen to manually.   So if you did &quot;localhost:8080&quot;, this
would only listen on the lo interface, and if you did &quot;
MyPublic.host.name.com&quot;, it would only listen on the interface that had
that name/ip address on the host.

But back in 2005, we implemented a behavior to track the Windows behavior
on the Dns class:

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=MONO63265">https://bugzilla.novell.com/show_bug.cgi?id=MONO63265</A>

It has the following side effect: when the name of the host passed to
GetHostByName matches the DNS hostname (which we implement with a call to
gethostname), instead of returning the actual IP address for the device, we
adopted the Windows behavior that would list all-non-localhost addresses,
*excluding* the localhost address.

It boils down to an attempt to make this idiom:

GetHostByName (Dns.GetHostName ())

Return a list of interfaces associated with the host.

This is only a problem when your hostname is set to &quot;localhost&quot;, and while
not very common, it happens in the wild.

There was at least one bug that claimed that a feature of Remoting depended
on this:

<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=MONO54234">https://bugzilla.novell.com/show_bug.cgi?id=MONO54234</A>

Our plan right now is to remove the special behavior, which means that code
that expected the above idiom to return the list of host interfaces from
the current hostname will not work anymore.

That should have never worked in the first place, it just happened to be
mostly correct on Windows.    The proper way of retrieving the list of
network interfaces on .NET is not to use the DNS lookup system, but to use
the System.Net.NetworkInformation APIs.

Miguel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140929/9f1479a6/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140929/9f1479a6/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042004.html">[Mono-dev] SerialPort
</A></li>
	<LI>Next message: <A HREF="042006.html">[Mono-dev] spec file changes to enable RH builds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42005">[ date ]</a>
              <a href="thread.html#42005">[ thread ]</a>
              <a href="subject.html#42005">[ subject ]</a>
              <a href="author.html#42005">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
