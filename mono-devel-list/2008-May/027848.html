<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Trivial Enumerable Optimizations
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Trivial%20Enumerable%20Optimizations&In-Reply-To=g01r5e%24uo0%241%40ger.gmane.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027845.html">
   <LINK REL="Next"  HREF="027851.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Trivial Enumerable Optimizations</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Trivial%20Enumerable%20Optimizations&In-Reply-To=g01r5e%24uo0%241%40ger.gmane.org"
       TITLE="[Mono-dev] Trivial Enumerable Optimizations">jonpryor at vt.edu
       </A><BR>
    <I>Fri May  9 12:32:38 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027845.html">[Mono-dev] Trivial Enumerable Optimizations
</A></li>
        <LI>Next message: <A HREF="027851.html">[Mono-dev] Trivial Enumerable Optimizations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27848">[ date ]</a>
              <a href="thread.html#27848">[ thread ]</a>
              <a href="subject.html#27848">[ subject ]</a>
              <a href="author.html#27848">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2008-05-09 at 17:38 +0200, Robert Jordan wrote:
&gt;<i> Jonathan Pryor wrote:
</I>&gt;<i> &gt; So is it possible to further optimize the LongCount() extension method?
</I>&gt;<i> &gt; Perhaps something like this?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;     public static long LongCount&lt;TSource&gt; (this IEnumerable&lt;TSource&gt; source)
</I>&gt;<i> &gt;     {
</I>&gt;<i> &gt;        // as before...
</I>&gt;<i> &gt;        ICollection&lt;TSource&gt; c = source as ICollection&lt;TSource&gt;;
</I>&gt;<i> &gt;        if (c != null) {
</I>&gt;<i> &gt;            try {
</I>&gt;<i> &gt;                return c.Count;
</I>&gt;<i> &gt;            }
</I>&gt;<i> &gt;            catch {
</I>&gt;<i> &gt;                // ignore; collection has &gt; int.MaxValue elements, 
</I>&gt;<i> &gt;                // so count manually below.
</I>&gt;<i> &gt;            }
</I>&gt;<i> &gt;        }
</I>&gt;<i> &gt;        // as before...
</I>&gt;<i> &gt;     }
</I>&gt;<i>
</I>&gt;<i> I'd check whether &quot;source&quot; is an array and return what
</I>&gt;<i> Array.GetLongLength returned.
</I>
This was part of the original optimization which started this thread
(though that uses the LongLength property, not the GetLongLength()
method), and has been committed to svn.

So it would be part of the first &quot;as before&quot; block of code.

 - Jon


</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027845.html">[Mono-dev] Trivial Enumerable Optimizations
</A></li>
	<LI>Next message: <A HREF="027851.html">[Mono-dev] Trivial Enumerable Optimizations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27848">[ date ]</a>
              <a href="thread.html#27848">[ thread ]</a>
              <a href="subject.html#27848">[ subject ]</a>
              <a href="author.html#27848">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
