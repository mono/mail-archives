<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] How To Convince Mono To Allocate Big Arrays
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20How%20To%20Convince%20Mono%20To%20Allocate%20Big%20Arrays&In-Reply-To=1210253570.24633.2.camel%40lina.magi.balthasar.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027820.html">
   <LINK REL="Next"  HREF="027815.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] How To Convince Mono To Allocate Big Arrays</H1>
    <B>Luis F. Ortiz</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20How%20To%20Convince%20Mono%20To%20Allocate%20Big%20Arrays&In-Reply-To=1210253570.24633.2.camel%40lina.magi.balthasar.com"
       TITLE="[Mono-dev] How To Convince Mono To Allocate Big Arrays">LuisOrtiz at Verizon.Net
       </A><BR>
    <I>Thu May  8 11:05:37 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027820.html">[Mono-dev] How To Convince Mono To Allocate Big Arrays
</A></li>
        <LI>Next message: <A HREF="027815.html">[Mono-dev] MonoRpmSpecManager
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27823">[ date ]</a>
              <a href="thread.html#27823">[ thread ]</a>
              <a href="subject.html#27823">[ subject ]</a>
              <a href="author.html#27823">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On May 8, 2008, at 9:32 AM, Jonathan Pryor wrote:
&gt;<i> On Thu, 2008-05-08 at 08:45 -0300, Rodrigo Kumpera wrote:
</I>&gt;&gt;<i> We want to keep changes to a minimum
</I>&gt;<i> Understandable.
</I>&gt;<i>
</I>&gt;&gt;<i> and we want to keep default array size 32bits.
</I>&gt;<i> This I still don't understand.  The implication is that the only way  
</I>&gt;<i> to
</I>&gt;<i> get 64-bit arrays on 64-bit platforms is to install your own mono, and
</I>&gt;<i> not use any prebuilt RPMs (as -- presumably -- the prebuilt RPMs would
</I>&gt;<i> use the default array size of 32bits).
</I>&gt;<i>
</I>&gt;<i> Why would we want to do this?  Do 64-bit arrays have a performance  
</I>&gt;<i> cost
</I>&gt;<i> that would show up in real apps (and not just benchmarks)?
</I>
Jon, for what it is worth, on 64 bit platforms, the additional fixed  
costs are the
doubling of the size of the array lengths and bounds &quot;suffix&quot; to the  
array,
which is peanuts, and additional computation time for validating the  
64 array
dimensions, which is slightly more expensive.

The 64 bit array extensions as I implemented them also have a cost for  
32 bit arrays,
because you now need to fetch a 64 bit word for the array length for  
doing bounds checking,
and you need to check to see that the 64 bit length can be validly  
converted to a 32 bit length
and throw an exception if that is not the case when using the 32 bit  
length property. The
additional exception throwing logic is the biggest cost JITed code- 
wise.  I am not aware of
any impact on code size for 32 bit vs 64 bit indexing itself.

Those is the biggest costs imposed.  Both are necessary if you are to  
avoid bizarre breakage.
Are they killers for mono embedders?  I don't know.

/Ortiz/Luis
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027820.html">[Mono-dev] How To Convince Mono To Allocate Big Arrays
</A></li>
	<LI>Next message: <A HREF="027815.html">[Mono-dev] MonoRpmSpecManager
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27823">[ date ]</a>
              <a href="thread.html#27823">[ thread ]</a>
              <a href="subject.html#27823">[ subject ]</a>
              <a href="author.html#27823">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
