<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Add mixed-mode assembly support on Windows	(now build with cygwin as well)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Add%20mixed-mode%20assembly%20support%20on%20Windows%0A%09%28now%20build%20with%20cygwin%20as%20well%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027744.html">
   <LINK REL="Next"  HREF="027752.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Add mixed-mode assembly support on Windows	(now build with cygwin as well)</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Add%20mixed-mode%20assembly%20support%20on%20Windows%0A%09%28now%20build%20with%20cygwin%20as%20well%29&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] Add mixed-mode assembly support on Windows	(now build with cygwin as well)">kornelpal at gmail.com
       </A><BR>
    <I>Sat May  3 09:54:25 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027744.html">[Mono-dev] [PATCH] Add mixed-mode assembly support on Windows	(now build with cygwin as well)
</A></li>
        <LI>Next message: <A HREF="027752.html">[Mono-dev] [PATCH] Add mixed-mode assembly support on Windows	(now build with cygwin as well)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27751">[ date ]</a>
              <a href="thread.html#27751">[ thread ]</a>
              <a href="subject.html#27751">[ subject ]</a>
              <a href="author.html#27751">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i> From: Jonathan Chambers
</I>&gt;<i> This patch seems to be the cause of the build failures on Win32:
</I>
I have tracked down the issue. The problem is that 
&quot;load_aot_module_from_cache&quot; calls that calls &quot;mono_dl_open&quot; that calls 
&quot;LoadLibrary&quot; with just a file name without a full path. This will result in 
MS.NET assemblies being loaded when MS.NET is in PATH. I don't know how 
load_aot_module_from_cache is supposed to work but I think this is a bug in 
load_aot_module_from_cache.

On the other hand my patch had a bug with reference counting when the image 
was loaded using LoadLibrary outside of image.c. Assembly name is a pointer 
to raw_data that was freed that caused the problems you described. This 
should now be fixed.

Please try the attached patch. If the build is still broken please let me 
know.

Korn&#233;l 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: coreefix.diff.txt
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080503/541da0c8/attachment.txt">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080503/541da0c8/attachment.txt</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027744.html">[Mono-dev] [PATCH] Add mixed-mode assembly support on Windows	(now build with cygwin as well)
</A></li>
	<LI>Next message: <A HREF="027752.html">[Mono-dev] [PATCH] Add mixed-mode assembly support on Windows	(now build with cygwin as well)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27751">[ date ]</a>
              <a href="thread.html#27751">[ thread ]</a>
              <a href="subject.html#27751">[ subject ]</a>
              <a href="author.html#27751">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
