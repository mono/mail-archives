<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono C# Serial Port problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20C%23%20Serial%20Port%20problem&In-Reply-To=17241892.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027925.html">
   <LINK REL="Next"  HREF="027927.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono C# Serial Port problem</H1>
    <B>Panoramix</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20C%23%20Serial%20Port%20problem&In-Reply-To=17241892.post%40talk.nabble.com"
       TITLE="[Mono-dev] Mono C# Serial Port problem">aria.francesco at gmail.com
       </A><BR>
    <I>Thu May 15 03:44:06 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027925.html">[Mono-dev]  Mono C# Serial Port problem
</A></li>
        <LI>Next message: <A HREF="027927.html">[Mono-dev] Mono C# Serial Port problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27926">[ date ]</a>
              <a href="thread.html#27926">[ thread ]</a>
              <a href="subject.html#27926">[ subject ]</a>
              <a href="author.html#27926">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
In Linux to use a device the user who requires access should have the
permission to use it. 
So you must verify that the user starts the application is registered in the
group owner of ttysN. 
To find out the group owner of the device by a shell run the command below:
 
ls-al / dev / ttyS *




Alan_Chun wrote:
&gt;<i> 
</I>&gt;<i> HI, currently I am porting a windows app to linux using Mono. I have some
</I>&gt;<i> difficulties to get the serial port work. here is the code(based on mono
</I>&gt;<i> website):
</I>&gt;<i> 
</I>&gt;<i>  public static void Main(string[] args)
</I>&gt;<i>     {
</I>&gt;<i>         SerialPortTest myTest = new SerialPortTest();
</I>&gt;<i>         myTest.Test();
</I>&gt;<i>                
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i>     private SerialPort mySerial;
</I>&gt;<i> 
</I>&gt;<i>     // Constructor
</I>&gt;<i>     public SerialPortTest()
</I>&gt;<i>     {
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i>     public void Test()
</I>&gt;<i>     {
</I>&gt;<i>         Console.WriteLine(&quot;Begin&quot;);
</I>&gt;<i>         if (mySerial != null)
</I>&gt;<i>             if (mySerial.IsOpen)
</I>&gt;<i>                 mySerial.Close();
</I>&gt;<i> 
</I>&gt;<i>         mySerial = new System.IO.Ports.SerialPort(&quot;COM3&quot;, 9600,
</I>&gt;<i> Parity.Even, 7, StopBits.One);
</I>&gt;<i>         mySerial.Open();
</I>&gt;<i>         mySerial.DtrEnable = true;
</I>&gt;<i>         mySerial.RtsEnable = true;
</I>&gt;<i>         mySerial.Handshake = System.IO.Ports.Handshake.None;
</I>&gt;<i>         mySerial.ReadTimeout = 400;
</I>&gt;<i>         Thread t = new Thread(new ThreadStart(DataReceived));
</I>&gt;<i> 
</I>&gt;<i>         t.Start();
</I>&gt;<i>          string tmp = &quot;5D.1&quot;;
</I>&gt;<i>        
</I>&gt;<i>          SendData(tmp);
</I>&gt;<i> 
</I>&gt;<i>         // Should output some information about your modem firmware
</I>&gt;<i>         //Console.WriteLine(&quot;Baaa&quot;);
</I>&gt;<i>        // Console.WriteLine(ReadData());
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i>     public void DataReceived()
</I>&gt;<i>     {
</I>&gt;<i>         while (true)
</I>&gt;<i>         {
</I>&gt;<i>             byte tmpByte = 255;
</I>&gt;<i>             string rxString = &quot;&quot;;
</I>&gt;<i>             //int tot = mySerial.BytesToRead;
</I>&gt;<i>             tmpByte = (byte)mySerial.ReadByte();
</I>&gt;<i>              
</I>&gt;<i>             while (tmpByte != 255)
</I>&gt;<i>             {
</I>&gt;<i>                 rxString += ((char)tmpByte);
</I>&gt;<i>                  mpByte = (byte)mySerial.ReadByte();
</I>&gt;<i>             }
</I>&gt;<i>               if (!string.IsNullOrEmpty(rxString))
</I>&gt;<i>                   Console.WriteLine(rxString);
</I>&gt;<i>         }
</I>&gt;<i>         //return rxString;
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i> I ran this under windows using .netframwork run time, it is fine but under
</I>&gt;<i> mono I always got this exception:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Unhandled Exception: System.NullReferenceException: Object reference not
</I>&gt;<i> set to an instance of an object
</I>&gt;<i>   at (wrapper managed-to-native)
</I>&gt;<i> System.IO.Ports.WinSerialStream:ClearCommError
</I>&gt;<i> (int,System.IO.Ports.CommStat&amp;)
</I>&gt;<i>   at System.IO.Ports.WinSerialStream.get_BytesToRead () [0x00000]
</I>&gt;<i>   at System.IO.Ports.SerialPort.get_BytesToRead () [0x00000]
</I>&gt;<i>   at (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.IO.Ports.SerialPort:get_BytesToRead ()
</I>&gt;<i>   at SerialPortTest.DataReceived () [0x00000]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I have also tried BytesToRead, Read, ReadByte, all of them are working
</I>&gt;<i> fine under windows using .net2.0 framwork. But once I use the mono
</I>&gt;<i> runtime, the nightmare begins.
</I>&gt;<i> 
</I>&gt;<i> Any help will be really apprecaited!
</I>&gt;<i> 
</I>&gt;<i> Thanks  
</I>&gt;<i> 
</I>

-----
:<i>working:
</I>-----------------------------------------------------------------------------
<A HREF="http://freeflow.awardspace.com">http://freeflow.awardspace.com</A> <A HREF="http://freeflow.awardspace.com">http://freeflow.awardspace.com</A> 
-----------------------------------------------------------------------------

-- 
View this message in context: <A HREF="http://www.nabble.com/Mono-C--Serial-Port-problem-tp17241892p17247791.html">http://www.nabble.com/Mono-C--Serial-Port-problem-tp17241892p17247791.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.

</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027925.html">[Mono-dev]  Mono C# Serial Port problem
</A></li>
	<LI>Next message: <A HREF="027927.html">[Mono-dev] Mono C# Serial Port problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27926">[ date ]</a>
              <a href="thread.html#27926">[ thread ]</a>
              <a href="subject.html#27926">[ subject ]</a>
              <a href="author.html#27926">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
