<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Fixes and improvements for mixed-mode	assembly support
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Fixes%20and%20improvements%20for%20mixed-mode%0A%09assembly%20support&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027887.html">
   <LINK REL="Next"  HREF="027889.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Fixes and improvements for mixed-mode	assembly support</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Fixes%20and%20improvements%20for%20mixed-mode%0A%09assembly%20support&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] Fixes and improvements for mixed-mode	assembly support">kornelpal at gmail.com
       </A><BR>
    <I>Tue May 13 11:28:38 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027887.html">[Mono-dev] Double check locking pattern in Mono? (was: Some	notes from my use of Gengarme...)
</A></li>
        <LI>Next message: <A HREF="027889.html">[Mono-dev] [PATCH] Fixes and improvements for mixed-mode	assembly support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27886">[ date ]</a>
              <a href="thread.html#27886">[ thread ]</a>
              <a href="subject.html#27886">[ subject ]</a>
              <a href="author.html#27886">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

This is the patch without renaming and thread.c modification. Otherwise 
unmodified.

Currently mixed mode assembly support is disabled so this patch would be 
needed for reenabling it.

ChangeLog:
* domain.c: Open exe_image anyway so that it can be fixed up. Add a 
mono_close_exe_image function that closes exe_image.

* image.c: Fix reference counting when DLL image is loaded using LoadLibrary 
outside of image.c. The image was previously freed in this case using 
FreeLibrary even when it's memory was referenced by metadata that caused the 
crash reported by Jonathan Chambers.

* coree.c: Some improvements and add mono_set_act_ctx that loads manifest 
file from the main assembly when process is created from mono.exe. This is 
required for MSVCRT support but may be used by other assemblies as well for 
example for XP Visual Style support.

Please review the attached patch and if you like it please approve it.

Korn&#233;l 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: coreefix.diff.txt
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080513/7a0a6c52/attachment-0001.txt">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080513/7a0a6c52/attachment-0001.txt</A> 
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027887.html">[Mono-dev] Double check locking pattern in Mono? (was: Some	notes from my use of Gengarme...)
</A></li>
	<LI>Next message: <A HREF="027889.html">[Mono-dev] [PATCH] Fixes and improvements for mixed-mode	assembly support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27886">[ date ]</a>
              <a href="thread.html#27886">[ thread ]</a>
              <a href="subject.html#27886">[ subject ]</a>
              <a href="author.html#27886">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
