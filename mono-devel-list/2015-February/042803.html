<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] ToolStripManager.RevertMerge
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20ToolStripManager.RevertMerge&In-Reply-To=%3C381EC38A-7F01-41F6-88D0-075CD8BC59B4%40asme.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042800.html">
   <LINK REL="Next"  HREF="042802.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] ToolStripManager.RevertMerge</H1>
    <B>David Curylo</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20ToolStripManager.RevertMerge&In-Reply-To=%3C381EC38A-7F01-41F6-88D0-075CD8BC59B4%40asme.org%3E"
       TITLE="[Mono-dev] ToolStripManager.RevertMerge">curylod at asme.org
       </A><BR>
    <I>Tue Feb 24 21:37:35 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="042800.html">[Mono-dev] ToolStripManager.RevertMerge
</A></li>
        <LI>Next message: <A HREF="042802.html">[Mono-dev] Patch for Bug 8207: Can't set 1000000 baud with System.IO.Ports.SerialPort.BaudRate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42803">[ date ]</a>
              <a href="thread.html#42803">[ thread ]</a>
              <a href="subject.html#42803">[ subject ]</a>
              <a href="author.html#42803">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It sounds like a bug if it&#8217;s specified to have different behavior.  The Windows Forms code isn&#8217;t as actively maintained as other parts of mono.  It sounds like you have a failing test and know what to fix&#8230;all the makings for a PR on Github.  I&#8217;m not familiar with that particular WinForms code, but if you need assistance, I would be happy to help you craft a pull request to fix it.

On Feb 24, 2015, at 1:02 PM, Chad Dettmering &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">chad.dettmering at gmail.com</A>&gt; wrote:

&gt;<i> Hello Mono Devs! This is my first time posting to this mailing list so forgive me if I step on any toes.
</I>&gt;<i> 
</I>&gt;<i> I was running an application called Chummer5 link: <A HREF="https://code.google.com/p/chummer5/">https://code.google.com/p/chummer5/</A> with Mono. The application kept crashing on the method Windows.Systems.Forms.ToolStripManager.RevertMerge. 
</I>&gt;<i> 
</I>&gt;<i> Being the curious software dev that I am, I decided to download the Mono and Chummer5 source code to figure out the problem. I might add the application runs fine on a Windows machine using the official .NET runtime.
</I>&gt;<i> 
</I>&gt;<i> After poking around I came to this line of code in Chummer5
</I>&gt;<i> 
</I>&gt;<i> // Merge the ToolStrips.
</I>&gt;<i> ToolStripManager.RevertMerge(&quot;toolStrip&quot;);
</I>&gt;<i> ToolStripManager.Merge(toolStrip, &quot;toolStrip&quot;); 
</I>&gt;<i> 
</I>&gt;<i> which leads to an ArgumentNullException in Mono. The argument is not null of course but this method calls the base RevertMerge method which takes (ToolStrip, ToolStrip) as it's parameters, and uses the FindToolStrip method to find the ToolStrip based on the name. Now this implementation will always cause the RevertMerge parameter to be null if a Merge has not been called with the same name.
</I>&gt;<i> 
</I>&gt;<i> Digging into the Mono source I came to this line of code inside the RevertMerge method implementation
</I>&gt;<i> 
</I>&gt;<i> if (sourceToolStrip == null)
</I>&gt;<i>     throw new ArgumentNullException (&quot;sourceToolStrip&quot;);
</I>&gt;<i> 
</I>&gt;<i> So Mono is throwing an Exception explicitly in this case and will throw an Exception everytime RevertMerge is called before Merge using the same
</I>&gt;<i> 
</I>&gt;<i> I thought this was odd so I went to the msdn documentation here: <A HREF="https://msdn.microsoft.com/en-us/library/b4e35dwy%28v=vs.110%29.aspx">https://msdn.microsoft.com/en-us/library/b4e35dwy%28v=vs.110%29.aspx</A>
</I>&gt;<i> 
</I>&gt;<i> According to the documentation this method shouldn't throw any Exceptions, instead it should return false if the RevertMerge failed. Also looking at the example on the page it shows this as a valid way to use the method
</I>&gt;<i> 
</I>&gt;<i> // Undo previous merge, if any. 
</I>&gt;<i> ToolStripManager.RevertMerge(cmsBase, cmsItemsToMerge);
</I>&gt;<i> 
</I>&gt;<i> which implies that sending null is valid.
</I>&gt;<i> 
</I>&gt;<i> Given all of this information is this a &quot;bug&quot; in Mono? Someone wrote that Exception explicitly so the code is working as intended but it breaks compatibility on the application I'm running.
</I>&gt;<i> 
</I>&gt;<i> Any more info on this topic would be great! Nice to meet everyone! :)
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150224/2ee8e720/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150224/2ee8e720/attachment-0001.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042800.html">[Mono-dev] ToolStripManager.RevertMerge
</A></li>
	<LI>Next message: <A HREF="042802.html">[Mono-dev] Patch for Bug 8207: Can't set 1000000 baud with System.IO.Ports.SerialPort.BaudRate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42803">[ date ]</a>
              <a href="thread.html#42803">[ thread ]</a>
              <a href="subject.html#42803">[ subject ]</a>
              <a href="author.html#42803">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
