<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Add encoding deserialization	proxiesforSystem.Text
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Add%20encoding%20deserialization%0A%09proxiesforSystem.Text&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019242.html">
   <LINK REL="Next"  HREF="019247.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Add encoding deserialization	proxiesforSystem.Text</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Add%20encoding%20deserialization%0A%09proxiesforSystem.Text&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] Add encoding deserialization	proxiesforSystem.Text">kornelpal at gmail.com
       </A><BR>
    <I>Mon Jul  3 20:31:26 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="019242.html">[Mono-dev] implement me in class.c
</A></li>
        <LI>Next message: <A HREF="019247.html">[Mono-dev] Status of ADO.NET 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19246">[ date ]</a>
              <a href="thread.html#19246">[ thread ]</a>
              <a href="subject.html#19246">[ subject ]</a>
              <a href="author.html#19246">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>One more thing:

These classes are proxy classes so users will not see them at all because 
they are instantiated by the serialization framework that calls 
IObjectReference.GetRealObject and the user will only see the returned 
object as the deserialized object. So the only way to see instances of these 
classes is when you instantiate them using Activator.

Korn&#233;l

----- Original Message ----- 
From: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt;
To: &quot;Miguel de Icaza&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">miguel at ximian.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Tuesday, July 04, 2006 2:23 AM
Subject: Re: [Mono-dev] [PATCH] Add encoding deserialization 
proxiesforSystem.Text


&gt;<i> OK, I'll add some inline documentation (i.e. comments) to some of these 
</I>&gt;<i> classes. (Today I'm going to sleep.:))
</I>&gt;<i>
</I>&gt;&gt;<i> Was ISerializable there before, or is this an interface that our
</I>&gt;&gt;<i> implementation would have that might differ from MS?
</I>&gt;<i>
</I>&gt;<i> All of these classes 
</I>&gt;<i> (<A HREF="http://lists.ximian.com/pipermail/mono-patches/2006-July/077142.html">http://lists.ximian.com/pipermail/mono-patches/2006-July/077142.html</A>) are 
</I>&gt;<i> internal so I think this doesn't matter. By the way they are ISerializable 
</I>&gt;<i> in MS.NET 2.0 and weren't ISerializable in MS.NET 1.x (but are 
</I>&gt;<i> [Serializable]). In Mono they are ISerializable in all of our profiles. 
</I>&gt;<i> But as they are internal classes, exact class layout shouldn't be assumed 
</I>&gt;<i> by users.
</I>&gt;<i>
</I>&gt;<i> Korn&#233;l
</I>&gt;<i>
</I>&gt;<i> ----- Original Message ----- 
</I>&gt;<i> From: &quot;Miguel de Icaza&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">miguel at ximian.com</A>&gt;
</I>&gt;<i> To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt;
</I>&gt;<i> Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i> Sent: Tuesday, July 04, 2006 2:05 AM
</I>&gt;<i> Subject: Re: [Mono-dev] [PATCH] Add encoding deserialization 
</I>&gt;<i> proxiesforSystem.Text
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Implements ISerializable so that they control their own deserialization.
</I>&gt;&gt;&gt;<i> This may not be necessary, but ensures that extra fields don't matter at
</I>&gt;&gt;&gt;<i> all. And this way serializaton can be prevented by throwing an 
</I>&gt;&gt;&gt;<i> exception.
</I>&gt;&gt;&gt;<i> This may not be necessary because they are internal so are probably 
</I>&gt;&gt;&gt;<i> never
</I>&gt;&gt;&gt;<i> instantiated except by serialization framework.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Was ISerializable there before, or is this an interface that our
</I>&gt;&gt;<i> implementation would have that might differ from MS?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Btw, your explanation is very useful, could you get the explanation that
</I>&gt;&gt;<i> you posted here into the modified files?  It will help people reading
</I>&gt;&gt;<i> the code later.   Or in the ChangeLog :-)
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> And they implement IObjectReference so that they can return a different
</I>&gt;&gt;&gt;<i> object when deseriealized.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> As a result you will transparently get the right encoding object instead 
</I>&gt;&gt;&gt;<i> of
</I>&gt;&gt;&gt;<i> an exception informing that the type was not found when deserializing
</I>&gt;&gt;&gt;<i> objects of these types.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The above description was detailed but in fact they don't do anything 
</I>&gt;&gt;&gt;<i> tricky
</I>&gt;&gt;&gt;<i> beyond the documented behaviour of GetRealObject:
</I>&gt;&gt;&gt;<i> &quot;Returns the real object that should be deserialized, rather than the 
</I>&gt;&gt;&gt;<i> object
</I>&gt;&gt;&gt;<i> that the serialized stream specifies.&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="http://msdn2.microsoft.com/en-us/library/system.runtime.serialization.iobjectreference.getrealobject.aspx">http://msdn2.microsoft.com/en-us/library/system.runtime.serialization.iobjectreference.getrealobject.aspx</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So I don't think that they should have more inline documentation than 
</I>&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;<i> currently have in comments.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Note that MS.NET 2.0 probably has similar proxy classes because it
</I>&gt;&gt;&gt;<i> deserializes these types to it's own (and different) encoding classes. 
</I>&gt;&gt;&gt;<i> But
</I>&gt;&gt;&gt;<i> as these classes are internal we can solve MS.NET 1.x serialization
</I>&gt;&gt;&gt;<i> compatibility as well.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Also note that to make encoding serialization compatiblity complete 
</I>&gt;&gt;&gt;<i> (that is
</I>&gt;&gt;&gt;<i> that our serialized encoding objects can be deserialized on MS.NET) our
</I>&gt;&gt;&gt;<i> internal encoding classes should later be modified to serialize 
</I>&gt;&gt;&gt;<i> themselves
</I>&gt;&gt;&gt;<i> to these proxy classes by calling SerializationInfo.SetType in
</I>&gt;&gt;&gt;<i> ISerializable.GetObjectData.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> These proxy class can no way harm Mono because their only effect is that
</I>&gt;&gt;&gt;<i> some objects can now be deserialized that were unable to be deserialized
</I>&gt;&gt;&gt;<i> previously.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Would you mind including this text in either the encoding files?
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019242.html">[Mono-dev] implement me in class.c
</A></li>
	<LI>Next message: <A HREF="019247.html">[Mono-dev] Status of ADO.NET 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19246">[ date ]</a>
              <a href="thread.html#19246">[ thread ]</a>
              <a href="subject.html#19246">[ subject ]</a>
              <a href="author.html#19246">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
