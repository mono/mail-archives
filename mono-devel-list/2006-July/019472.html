<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Redirect certain string constructors to	CreateString
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Redirect%20certain%20string%20constructors%20to%0A%09CreateString&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019471.html">
   <LINK REL="Next"  HREF="019475.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Redirect certain string constructors to	CreateString</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Redirect%20certain%20string%20constructors%20to%0A%09CreateString&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] Redirect certain string constructors to	CreateString">kornelpal at gmail.com
       </A><BR>
    <I>Tue Jul 18 07:33:17 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="019471.html">[Mono-dev] System.IO.UnmanagedMemoryStream class implementation
</A></li>
        <LI>Next message: <A HREF="019475.html">[Mono-dev] [PATCH] Redirect certain string constructors to	CreateString
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19472">[ date ]</a>
              <a href="thread.html#19472">[ thread ]</a>
              <a href="subject.html#19472">[ subject ]</a>
              <a href="author.html#19472">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I attached three different versions of the patch:
CreateString_marshal_none.diff: use no wrapper (fastest)
CreateString_marshal_jmp.diff: use managed-to-managed wrapper with CEE_JMP
(security attributes of .ctor applied)
CreateString_marshal_call.diff: use managed-to-managed wrapper with CEE_CALL
(slowest, security attributes of .ctor applied, .ctor in stack trace)

CreateString_corlib.diff: this is required by all the above patches

All of the three versions are faster than the current implementation (note
that constructors that take no Encoding should use Encoding.Default so they
are currently faster because they are implemented incorrectly).

Also note that performance will be improved further when an internal
GetString method will be used for internal Encoding classes that takes a
byte* instead of byte[].

Andvantages and disadvantages of these versions were explained and discussed
on the list.

Please review the patch and approve one of the three versions.

Korn&#233;l

----- Original Message ----- 
From: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt;
To: &quot;Zoltan Varga&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vargaz at gmail.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Sunday, July 16, 2006 5:01 PM
Subject: Re: [Mono-dev] [PATCH] Redirect certain string constructors to
CreateString


&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Now I consider the attached patch being complete.
</I>&gt;<i>
</I>&gt;<i> Please review and approve the patch.
</I>&gt;<i>
</I>&gt;<i> Korn&#233;l
</I>&gt;<i>
</I>&gt;<i> ----- Original Message ----- 
</I>&gt;<i> From: &quot;Zoltan Varga&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vargaz at gmail.com</A>&gt;
</I>&gt;<i> To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt;
</I>&gt;<i> Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i> Sent: Sunday, July 16, 2006 3:28 PM
</I>&gt;<i> Subject: Re: [Mono-dev] [PATCH] Redirect certain string constructors to
</I>&gt;<i> CreateString
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                   Hi,
</I>&gt;<i>
</I>&gt;<i> Just add it to the relevant header file.
</I>&gt;<i>
</I>&gt;<i>              Zoltan
</I>&gt;<i>
</I>-------------- next part --------------
A non-text attachment was scrubbed...
Name: CreateString_corlib.diff
Type: application/octet-stream
Size: 4408 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CreateString_marshal_call.diff
Type: application/octet-stream
Size: 8007 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment-0001.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment-0001.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CreateString_marshal_jmp.diff
Type: application/octet-stream
Size: 7844 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment-0002.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment-0002.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CreateString_marshal_none.diff
Type: application/octet-stream
Size: 4207 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment-0003.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060718/bb449a19/attachment-0003.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019471.html">[Mono-dev] System.IO.UnmanagedMemoryStream class implementation
</A></li>
	<LI>Next message: <A HREF="019475.html">[Mono-dev] [PATCH] Redirect certain string constructors to	CreateString
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19472">[ date ]</a>
              <a href="thread.html#19472">[ thread ]</a>
              <a href="subject.html#19472">[ subject ]</a>
              <a href="author.html#19472">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
