<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] OdbcParameter.CopyValue does not implement Binary
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20OdbcParameter.CopyValue%20does%20not%20implement%20Binary&In-Reply-To=9d0602eb0807151036i2ee2338fl970a6783c25cd6ae%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028515.html">
   <LINK REL="Next"  HREF="028521.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] OdbcParameter.CopyValue does not implement Binary</H1>
    <B>Ernesto</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20OdbcParameter.CopyValue%20does%20not%20implement%20Binary&In-Reply-To=9d0602eb0807151036i2ee2338fl970a6783c25cd6ae%40mail.gmail.com"
       TITLE="[Mono-dev] OdbcParameter.CopyValue does not implement Binary">equistango at gmail.com
       </A><BR>
    <I>Tue Jul 15 19:30:27 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028515.html">[Mono-dev] OdbcParameter.CopyValue does not implement Binary
</A></li>
        <LI>Next message: <A HREF="028521.html">[Mono-dev] OdbcParameter.CopyValue does not implement Binary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28519">[ date ]</a>
              <a href="thread.html#28519">[ thread ]</a>
              <a href="subject.html#28519">[ subject ]</a>
              <a href="author.html#28519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nagappan A escribi&#243;:
&gt;<i> Hello Ernesto,
</I>&gt;<i>
</I>&gt;<i> Could you please attach a test to verify your patch ?
</I>&gt;<i>
</I>As you can see in my patch, the odbc type handling code is already 
there. I'm suggesting using the current code to handle the Binary type 
as well (it's already handling VarBinary).
I don't know exactly what to test for, since I didn't write the original 
class and this is not a bug fix. Not even a new implementation.
The attached patch, however, will check whether OdbcType.Binary is beign 
handled or not.

Does this help?

Regards,
Ernesto

&gt;<i> Thanks
</I>&gt;<i> Nagappan
</I>&gt;<i>
</I>&gt;<i> 2008/7/14 Ernesto &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">equistango at gmail.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">equistango at gmail.com</A>&gt;&gt;:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     I noted OdbcParameter.CopyValue does not implement OdbcType.Binary:
</I>&gt;<i>
</I>&gt;<i>     DataBase.Execute: System.NotImplementedException: The requested
</I>&gt;<i>     feature is not implemented.
</I>&gt;<i>      at System.Data.Odbc.OdbcParameter.CopyValue () [0x000be] in
</I>&gt;<i>     /home/usuario/mono/mcs/class/System.Data/System.Data.Odbc/OdbcParameter.cs:432
</I>&gt;<i>
</I>&gt;<i>      at (wrapper remoting-invoke-with-check)
</I>&gt;<i>     System.Data.Odbc.OdbcParameter:CopyValue ()
</I>&gt;<i>      at System.Data.Odbc.OdbcCommand.BindParameters () [0x0002d] in
</I>&gt;<i>     /home/usuario/mono/mcs/class/System.Data/System.Data.Odbc/OdbcCommand.cs:465
</I>&gt;<i>
</I>&gt;<i>      ...
</I>&gt;<i>
</I>&gt;<i>     However it implements OdbcType.VarBinary and OdbcType.Image, which
</I>&gt;<i>     should be the same (like Char, VarChar and Text all get the same
</I>&gt;<i>     treatment).
</I>&gt;<i>     If you think it's ok, this is a patch to give Binary the same
</I>&gt;<i>     treatment as VarBinary. Passed the test suite and tested in real
</I>&gt;<i>     life with myodbc.
</I>&gt;<i>
</I>&gt;<i>     Regards,
</I>&gt;<i>     Ernesto
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     Index: OdbcParameter.cs
</I>&gt;<i>     ===================================================================
</I>&gt;<i>     --- OdbcParameter.cs    (revision 107657)
</I>&gt;<i>     +++ OdbcParameter.cs    (working copy)
</I>&gt;<i>     @@ -428,8 +428,6 @@
</I>&gt;<i>                            byte [] nativeBytes, buffer;
</I>&gt;<i>
</I>&gt;<i>                            switch (_typeMap.OdbcType) {
</I>&gt;<i>     -                       case OdbcType.Binary:
</I>&gt;<i>     -                               throw new NotImplementedException ();
</I>&gt;<i>                            case OdbcType.Bit:
</I>&gt;<i>                                    Marshal.WriteByte (_nativeBuffer,
</I>&gt;<i>     Convert.ToByte (Value));
</I>&gt;<i>                                    return;
</I>&gt;<i>     @@ -488,6 +486,7 @@
</I>&gt;<i>                                    return;
</I>&gt;<i>                            case OdbcType.VarBinary:
</I>&gt;<i>                            case OdbcType.Image:
</I>&gt;<i>     +                       case OdbcType.Binary:
</I>&gt;<i>                                    if (Value.GetType ().IsArray &amp;&amp;
</I>&gt;<i>                                        Value.GetType ().GetElementType
</I>&gt;<i>     () == typeof (byte)) {
</I>&gt;<i>                                            Marshal.Copy ( (byte [])
</I>&gt;<i>     Value, 0, _nativeBuffer, ((byte []) Value).Length);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     Mono-devel-list mailing list
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> Linux Desktop (GUI Application) Testing Project - 
</I>&gt;<i> <A HREF="http://ldtp.freedesktop.org">http://ldtp.freedesktop.org</A>
</I>&gt;<i> <A HREF="http://nagappanal.blogspot.com">http://nagappanal.blogspot.com</A> 
</I>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: odbcparamenter_binary_test.patch
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080715/9e8f90e7/attachment.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080715/9e8f90e7/attachment.pl</A> 
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028515.html">[Mono-dev] OdbcParameter.CopyValue does not implement Binary
</A></li>
	<LI>Next message: <A HREF="028521.html">[Mono-dev] OdbcParameter.CopyValue does not implement Binary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28519">[ date ]</a>
              <a href="thread.html#28519">[ thread ]</a>
              <a href="subject.html#28519">[ subject ]</a>
              <a href="author.html#28519">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
