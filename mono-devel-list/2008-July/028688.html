<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Ping on nternal call builders
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ping%20on%20nternal%20call%20builders&In-Reply-To=295e750a0807300522x4c7f2bd4h4d76d43d971fe820%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028686.html">
   <LINK REL="Next"  HREF="028692.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Ping on nternal call builders</H1>
    <B>Rodrigo Kumpera</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ping%20on%20nternal%20call%20builders&In-Reply-To=295e750a0807300522x4c7f2bd4h4d76d43d971fe820%40mail.gmail.com"
       TITLE="[Mono-dev] Ping on nternal call builders">kumpera at gmail.com
       </A><BR>
    <I>Wed Jul 30 10:16:28 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028686.html">[Mono-dev] Ping on nternal call builders
</A></li>
        <LI>Next message: <A HREF="028692.html">[Mono-dev] Ping on nternal call builders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28688">[ date ]</a>
              <a href="thread.html#28688">[ thread ]</a>
              <a href="subject.html#28688">[ subject ]</a>
              <a href="author.html#28688">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Zoltan,

It's only doable to encode some very simple icalls with IL. I have the
feeling that
we get an order of magnitude code increase for going from C/C# to emitting
IL.

OTOH, for things like UnsafeAddrOfPinnedArrayElement, the code is so
straight
forward that gcc will hardly do much better than mono's JIT.

Anyway, allowing M2M frames to be considered for inlining is the way to go
or should we use a new wrapper type?

Rodrigo


On Wed, Jul 30, 2008 at 9:22 AM, Zoltan Varga &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vargaz at gmail.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i>  This patch replaces a small, fast, simple piece of code
</I>&gt;<i> in mono_emit_inst_for_method () with something far more complex. Also,
</I>&gt;<i> about replacing
</I>&gt;<i> icalls with generated IL code:
</I>&gt;<i> - the code to generate the icalls is usually much bigger and more
</I>&gt;<i> complex than the icall
</I>&gt;<i>  itself.
</I>&gt;<i> - it replaces code generated by the gcc optimizing C compiler with
</I>&gt;<i> code generated by out JIT,
</I>&gt;<i>  which is of much lower quality. So even tough we incur a
</I>&gt;<i> managed-to-native transition
</I>&gt;<i> overhead by calling native code, we get some (or all) of it back by
</I>&gt;<i> having gcc compiled code
</I>&gt;<i>  in the icall.
</I>&gt;<i> - as rodrigo said, every new type of wrapper function adds some
</I>&gt;<i> complexity to our AOT
</I>&gt;<i> compiler which has to know about them.
</I>&gt;<i>
</I>&gt;<i> So I'm not against adding the _ability_ to implement icalls in IL, but
</I>&gt;<i> I'm against using it in
</I>&gt;<i> situations where it just makes things more complex.
</I>&gt;<i>
</I>&gt;<i>                     Zoltan
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080730/e8324fe9/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080730/e8324fe9/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028686.html">[Mono-dev] Ping on nternal call builders
</A></li>
	<LI>Next message: <A HREF="028692.html">[Mono-dev] Ping on nternal call builders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28688">[ date ]</a>
              <a href="thread.html#28688">[ thread ]</a>
              <a href="subject.html#28688">[ subject ]</a>
              <a href="author.html#28688">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
