<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Ping on nternal call builders
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ping%20on%20nternal%20call%20builders&In-Reply-To=20080730172020.GJ7544%40debian.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028693.html">
   <LINK REL="Next"  HREF="028675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Ping on nternal call builders</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ping%20on%20nternal%20call%20builders&In-Reply-To=20080730172020.GJ7544%40debian.org"
       TITLE="[Mono-dev] Ping on nternal call builders">kornelpal at gmail.com
       </A><BR>
    <I>Wed Jul 30 15:38:25 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028693.html">[Mono-dev] Ping on nternal call builders
</A></li>
        <LI>Next message: <A HREF="028675.html">[Mono-dev]  [PATCH] Backport of r108759
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28694">[ date ]</a>
              <a href="thread.html#28694">[ thread ]</a>
              <a href="subject.html#28694">[ subject ]</a>
              <a href="author.html#28694">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Paolo Molaro wrote:
&gt;<i> If you propose a considerable amount of increased complexity and your
</I>&gt;<i> reference 'improvements' are actually a lot worse you should at least
</I>&gt;<i> choose better references to show.
</I>
My goal would be to make some icalls execute faster. Of course I don't 
want to cripple the JIT. (I may have tried but I was convinced not to do 
that each time.:)

&gt;<i> There are not many cases like UnsafeAddrOfPinnedArrayElement (the
</I>&gt;<i> implementation also likely needs security checks, so in the end the
</I>&gt;<i> implementation will be more complex and the transition overhead will be
</I>&gt;<i> less significant).
</I>
This one needs no security checks because this is intended to be fast 
but unsafe (unpinned, unchecked) pointer access.

Note that I've chosen those three methods as reference implementatios 
because they are different and require really few opcodes to implement 
so that I don't waste time on implementing them if the patch don't get 
approved.

I've created a list about methods that could be implemented using 
managed code.

Also note that there are methods that probably should be implemented in 
C# with some inlined helpers.

Some of these may not be used in real world applications but Array, 
Buffer, MonoType and Marshal methods are in use for sure.

System.Array:
- GetLength
- GetLongLength
- GetLowerBound

System.Buffer
- all methods

System.MonoType
- GetArrayRank
- IsByRefImpl
- IsCOMObjectImpl
- IsPointerImpl
- IsPrimitiveImpl
- get_IsGenericParameter
- get_attributes

System.Object
- obj_address

System.Reflection.Emit.TypeBuilder
- get_IsGenericParameter

System.Reflection.Module
- GetGuidInternal
- GetHINSTANCE
- GetMDStreamVersion
- GetPEKind

System.Reflection.MonoField
- GetFieldOffset

System.Runtime.InteropServices.Marshal
- ReadByte
- ReadInt16
- ReadInt32
- ReadInt64
- ReadIntPtr
- UnsafeAddrOfPinnedArrayElement
- WriteByte
- WriteInt16
- WriteInt32
- WriteInt64
- WriteIntPtr
- copy_from_unmanaged (overloads lead there)
- copy_to_unmanaged (overloads lead there)

System.Threading.Thread
- VolatileRead (overloaded)
- VolatileWrite (overloaded)
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028693.html">[Mono-dev] Ping on nternal call builders
</A></li>
	<LI>Next message: <A HREF="028675.html">[Mono-dev]  [PATCH] Backport of r108759
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28694">[ date ]</a>
              <a href="thread.html#28694">[ thread ]</a>
              <a href="subject.html#28694">[ subject ]</a>
              <a href="author.html#28694">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
