<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Ping on nternal call builders
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ping%20on%20nternal%20call%20builders&In-Reply-To=1217408220.4343.306.camel%40Matrix.site">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028684.html">
   <LINK REL="Next"  HREF="028687.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Ping on nternal call builders</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ping%20on%20nternal%20call%20builders&In-Reply-To=1217408220.4343.306.camel%40Matrix.site"
       TITLE="[Mono-dev] Ping on nternal call builders">kornelpal at gmail.com
       </A><BR>
    <I>Wed Jul 30 06:18:09 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028684.html">[Mono-dev] Ping on nternal call builders
</A></li>
        <LI>Next message: <A HREF="028687.html">[Mono-dev] Ping on nternal call builders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28685">[ date ]</a>
              <a href="thread.html#28685">[ thread ]</a>
              <a href="subject.html#28685">[ subject ]</a>
              <a href="author.html#28685">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i>Massimiliano Mantione wrote:
</I>&gt;<i> The good news is that the current commit of the linear IR work
</I>&gt;<i> is the first step in getting a better JIT infrastructure so
</I>&gt;<i> that we can handle these things properly.
</I>
Thanks for the explanation about inlining. Now I understand that it's 
even more complicated than I thought. Anyway I think that it's better to 
let the JIT decide whether to inline managed-to-managed wrappers instead 
of forcing to inline them always.

I succeeded with the new IR. The old IR has more checks so it's not 
worth to patch it.

I have attached the new patch and a new test for OffsetToStringData.

I got results around 59900 with and without the patch as well.

Note that inlining constructors is not covered by the patch but string 
.ctors would not be inlined because they call CreateString methods.

UnsafeAddrOfPinnedArrayElement will not be inlined either because 
[SuppressUnmanagedCodeSecurity ()].

OffsetToStringData is inlined for sure because without inlining I got 
results around 201100.

Korn&#233;l
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ICallBuilderPerfTest2.cs
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080730/e2132504/attachment-0001.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080730/e2132504/attachment-0001.pl</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: icall_builder_new_ir.diff.txt
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080730/e2132504/attachment-0001.txt">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080730/e2132504/attachment-0001.txt</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028684.html">[Mono-dev] Ping on nternal call builders
</A></li>
	<LI>Next message: <A HREF="028687.html">[Mono-dev] Ping on nternal call builders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28685">[ date ]</a>
              <a href="thread.html#28685">[ thread ]</a>
              <a href="subject.html#28685">[ subject ]</a>
              <a href="author.html#28685">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
