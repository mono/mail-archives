<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] async IO &amp; Exceptions on NetworkStream: Windows vs. Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20async%20IO%20%26%20Exceptions%20on%20NetworkStream%3A%20Windows%20vs.%20Mono&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003381.html">
   <LINK REL="Next"  HREF="003370.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] async IO &amp; Exceptions on NetworkStream: Windows vs. Mono</H1>
    <B>Brad Fitzpatrick</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20async%20IO%20%26%20Exceptions%20on%20NetworkStream%3A%20Windows%20vs.%20Mono&In-Reply-To="
       TITLE="[Mono-devel-list] async IO &amp; Exceptions on NetworkStream: Windows vs. Mono">brad at danga.com
       </A><BR>
    <I>Thu Dec 25 21:47:42 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003381.html">[Mono-devel-list] Npgsql possible bug
</A></li>
        <LI>Next message: <A HREF="003370.html">[Mono-devel-list] Assembly Sharing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3366">[ date ]</a>
              <a href="thread.html#3366">[ thread ]</a>
              <a href="subject.html#3366">[ subject ]</a>
              <a href="author.html#3366">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello!

I've found a behavioral difference between .NET on Windows and Mono.

According to the docs I've read on .NET's async design patterns,
exceptions thrown in worker threads from async method calls should be
re-thrown when the caller thread executes EndInvoke(IAsyncResult) (or
EndWrite/EndRead/etc).

With mono, it's impossible to catch these errors, at least for the case of
NetworkStream.BeginWrite(..).  If the client reading from the
NetworkStream disconnects, a SocketException is thrown, and the backtrace
mono dumps shows it ending in the worker thread.  But I can't catch it:
not around ns.BeginWrite() nor ns.EndWrite().

On Windows, however, the exception is thrown from ns.EndWrite() so I can
do the proper cleanup.  (this seems to be the correct behavior)

I can't even determine if this is a runtime or code generation issue
because the binary I built with csc on Windows won't run under mono.  Just
says:  &quot;cannot open assembly filename.exe&quot;

(I've actually been learning and developing C# with Mono.  Today was the
 first time I've used .NET on Windows.)

Is this a known bug, or should I submit a test case?

Thanks!

-- 
Brad Fitzpatrick
<A HREF="http://www.danga.com/">http://www.danga.com/</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">brad at danga.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003381.html">[Mono-devel-list] Npgsql possible bug
</A></li>
	<LI>Next message: <A HREF="003370.html">[Mono-devel-list] Assembly Sharing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3366">[ date ]</a>
              <a href="thread.html#3366">[ thread ]</a>
              <a href="subject.html#3366">[ subject ]</a>
              <a href="author.html#3366">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
