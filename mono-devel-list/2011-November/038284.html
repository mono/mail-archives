<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] mono numerical performance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20mono%20numerical%20performance&In-Reply-To=CAM21Rt8YziopMHB%2B7551qhdHpSxO7QHoH%2BHx14f2DxSR_PX%2Bpw%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038283.html">
   <LINK REL="Next"  HREF="038287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] mono numerical performance</H1>
    <B>Jonathan Shore</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20mono%20numerical%20performance&In-Reply-To=CAM21Rt8YziopMHB%2B7551qhdHpSxO7QHoH%2BHx14f2DxSR_PX%2Bpw%40mail.gmail.com"
       TITLE="[Mono-dev] mono numerical performance">jonathan.shore at gmail.com
       </A><BR>
    <I>Sun Nov 20 13:48:02 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="038283.html">[Mono-dev] mono numerical performance
</A></li>
        <LI>Next message: <A HREF="038287.html">[Mono-dev] mono numerical performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38284">[ date ]</a>
              <a href="thread.html#38284">[ thread ]</a>
              <a href="subject.html#38284">[ subject ]</a>
              <a href="author.html#38284">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes, the modern java JIT does not need final as does the analysis.   However, it is very nice to be able to specify constness, not only to help the JIT along, but also in terms of documenting intent.   Given that C# does not have such a construct (too bad) / const is too constrained, the next best thing would be an attribute of some sort.   It gets pretty ugly though.   

An analysis of the code tree through the loop body should allow one to observe local invariance for trivial cases without too much trouble (I would think).   This would get increasingly complex and murky within delegates and other situations.

On Nov 20, 2011, at 1:39 PM, Dawid Weiss wrote:

&gt;<i> 
</I>&gt;<i> As far as I know the final on local variables is only a hint for the java compiler (javac), not jit (hotspot) engine. Detection of loop invariants is done at runtime (during code jitting) so there's really no difference between any of the following in modern Java jits:
</I>&gt;<i> 
</I>&gt;<i> 1) (final) int max = array.length;
</I>&gt;<i> for (int i = 0; i &lt; max; i++) {}
</I>&gt;<i> 
</I>&gt;<i> 2) for (int i = 0; i &lt; array.length; i++) {}
</I>&gt;<i> 
</I>&gt;<i> Dawid
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 2011/11/20 Konrad M. &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">konrad.kruczynski at gmail.com</A>&gt;
</I>&gt;<i> On the other hand, maybe it could be possible to add the final-like
</I>&gt;<i> mechanism to Mono's compiler. Such mechanism would be beneficial if the
</I>&gt;<i> CLR had some notion of local readonly variables. F# uses non-mutable
</I>&gt;<i> variables a lot, so maybe CLR recognizes it. I am not sure what kind of
</I>&gt;<i> transparent denotation could be used - maybe some kind of comment, like
</I>&gt;<i> it was done in MS Java in the pre-annotations days.
</I>&gt;<i> 
</I>&gt;<i> Does Mono team see this as something worth considering? Probably proper
</I>&gt;<i> analysis of assignments is a better idea.
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> Regards,
</I>&gt;<i>  Konrad
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20111120/751c0acc/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20111120/751c0acc/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038283.html">[Mono-dev] mono numerical performance
</A></li>
	<LI>Next message: <A HREF="038287.html">[Mono-dev] mono numerical performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38284">[ date ]</a>
              <a href="thread.html#38284">[ thread ]</a>
              <a href="subject.html#38284">[ subject ]</a>
              <a href="author.html#38284">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
