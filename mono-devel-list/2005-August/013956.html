<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Odbc-Exception-Error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Odbc-Exception-Error&In-Reply-To=0ML21M-1E3suE2weL-0001JB%40mrelayeu.kundenserver.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013951.html">
   <LINK REL="Next"  HREF="013960.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Odbc-Exception-Error</H1>
    <B>tsureshkumar</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Odbc-Exception-Error&In-Reply-To=0ML21M-1E3suE2weL-0001JB%40mrelayeu.kundenserver.de"
       TITLE="[Mono-dev] Odbc-Exception-Error">tsureshkumar at novell.com
       </A><BR>
    <I>Sat Aug 13 11:55:17 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013951.html">[Mono-dev] Odbc-Exception-Error
</A></li>
        <LI>Next message: <A HREF="013960.html">[Mono-dev] Odbc-Exception-Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13956">[ date ]</a>
              <a href="thread.html#13956">[ thread ]</a>
              <a href="subject.html#13956">[ subject ]</a>
              <a href="author.html#13956">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Jan Waiz wrote:
&gt;<i> Hi Folks,
</I>&gt;<i> big Trouble in China! J
</I>&gt;<i> Working with ODBC on a PostgreSQL.
</I>&gt;<i> While the ODBC did not support named Parameters and to be save about 
</I>&gt;<i> Signs like the &lt;&#8217;&gt; in Textboxes, i am building my Update-Statements like 
</I>&gt;<i> this:
</I>&gt;<i> cStmnt = &#8220;UPDATE ComanySTD SET&#8221; +
</I>&gt;<i>               &#8220;Name1 = ?,&#8221;
</I>&gt;<i>               &#8220;Name2 = ?&#8221;
</I>&gt;<i>               &#8220;WHERE PKey = &#8216;&#8221; + cPKey + &#8216;&#8221;
</I>&gt;<i> oCommand.Parameters.Add( &#8220;@Name1&#8221;, Textbox_Name1.Text.Trim() )
</I>&gt;<i> oCommand.Parameters.Add( &#8220;@Name2&#8221;, Textbox_Name2.Text.Trim() )
</I>&gt;<i> oCommand.ExecuteNonQuery()
</I>&gt;<i> 
</I>&gt;<i> This works fine when starting under Localhost.
</I>&gt;<i> 
</I>&gt;<i> If running in Mono I get an Error:
</I>&gt;<i> 
</I>&gt;<i> System.Data.Odbc.OdbcException: [unixODBC]Unrecognized C_parameter type in copy_statement_with_parameters
</I>
Try setting odbc type explicitly.

OdbcParameter oParam = Command.Parameters.Add( &#8220;@Name1&#8221;, OdbcType.VarChar);
oParam.Value = Textbox_Name1.Text.Trim();

if it does not work,
please provide a sample table schema.  Did you verify your postgres odbc 
driver works fine (with C/perl/ms.net client) with the same query.

&gt;<i> When changing the Statement to:
</I>&gt;<i> 
</I>&gt;<i> cStmnt = &#8220;UPDATE ComanySTD SET&#8221; +
</I>&gt;<i>               &#8220;Name1 = &#8220; + Textbox_Name1.Text.Trim()  + ,&#8221;
</I>&gt;<i>               &#8220;Name2 = &#8220; + Textbox_Name2.Text.Trim()  + ,&#8221;
</I>&gt;<i>               &#8220;WHERE PKey = &#8216;&#8221; + cPKey + &#8216;&#8221;
</I>&gt;<i> 
</I>&gt;<i> oCommand.ExecuteNonQuery()
</I>&gt;<i> 
</I>&gt;<i> it works with Mono &#8211; but if there is an &lt;&#8217;&gt; in a Textbox it crashes. So 
</I>&gt;<i> I have to escape special Signs manuel.
</I>
yes. with the structure of the query, you have to escape the text 
entered by the user, as you are giving plain SQL query. odbccommand does 
not know which part of the query to escape.

&gt;<i> 
</I>&gt;<i> I found one Entry in Google, where one Developer will have the same 
</I>&gt;<i> Problem &#8211; but there wasn&#180;t any Answers what to do.
</I>&gt;<i> 
</I>&gt;<i> Someone here who can help me what I have to do?
</I>
Please file a bug report at <A HREF="http://bugzilla.ximian.com">http://bugzilla.ximian.com</A> with a small test 
code, table schema, version of postgres and postgres odbc driver. If 
possible attach a odbc trace log, with only this query running.

suresh.

&gt;<i> 
</I>&gt;<i> Many Thanks in Advance for any Help !!
</I>&gt;<i> Regards
</I>&gt;<i> 
</I>&gt;<i> Jan Waiz
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013951.html">[Mono-dev] Odbc-Exception-Error
</A></li>
	<LI>Next message: <A HREF="013960.html">[Mono-dev] Odbc-Exception-Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13956">[ date ]</a>
              <a href="thread.html#13956">[ thread ]</a>
              <a href="subject.html#13956">[ subject ]</a>
              <a href="author.html#13956">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
