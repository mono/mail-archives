<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Unhandled Exceptions in Novell.Directory.Ldap and other	Synchronization Issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Unhandled%20Exceptions%20in%20Novell.Directory.Ldap%20and%20other%0A%09Synchronization%20Issues&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014263.html">
   <LINK REL="Next"  HREF="014218.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Unhandled Exceptions in Novell.Directory.Ldap and other	Synchronization Issues</H1>
    <B>JD Conley</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Unhandled%20Exceptions%20in%20Novell.Directory.Ldap%20and%20other%0A%09Synchronization%20Issues&In-Reply-To="
       TITLE="[Mono-dev] Unhandled Exceptions in Novell.Directory.Ldap and other	Synchronization Issues">jd.conley at coversant.net
       </A><BR>
    <I>Mon Aug 22 19:58:00 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014263.html">[Mono-dev] The Bleeding Edge of SuSE is not Mono-friendly
</A></li>
        <LI>Next message: <A HREF="014218.html">[Mono-dev] Unhandled Exceptions in Novell.Directory.Ldap and	other Synchronization Issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14216">[ date ]</a>
              <a href="thread.html#14216">[ thread ]</a>
              <a href="subject.html#14216">[ subject ]</a>
              <a href="author.html#14216">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Novell.Directory.Ldap spawns threads for various queued operations.
However, it appears as though there is no &quot;catch all&quot; exception handler
in Connection+ReaderThread:Run() (or other spawned threads either).  If
anything other than an IO exception is thrown the thread will exit
without notifying the consumer, and in Beta 2 this causes the
application to terminate.  In my current application it causes a search
timeout.

One such example is as follows (this is received some time during
connecting, binding, or doing a search -- I'm not exactly sure):

Unhandled Exception: System.ArgumentException: length
in &lt;0x004a3&gt; System.Array:Copy (System.Array sourceArray, Int32
sourceIndex, System.Array destinationArray, Int32 destinationIndex,
Int32 length)
in &lt;0x0004f&gt; System.Array:Copy (System.Array sourceArray, System.Array
destinationArray, Int32 length)
in &lt;0x00016&gt; System.Collections.ArrayList:CopyTo (System.Array array)
in &lt;0x0002a&gt; System.Collections.ArrayList:ToArray ()
in &lt;0x0004a&gt; Novell.Directory.Ldap.MessageVector:findMessageById (Int32
msgId)
in &lt;0x001b7&gt; Novell.Directory.Ldap.Connection+ReaderThread:Run ()
in (wrapper delegate-invoke) System.MulticastDelegate:invoke_void ()


This exception looks very strange at first glance.  An invalid length on
an ArrayList:ToArray() just doesn't compute.  After further
investigation I have found that the MessageVector class is only
partially synchronized.  Synchronization happens on the
findMessageById() and some other functions that do iteration, but the
atomic Add, Remove, and Contains operations are not protected.  It
appears as though the findMessageById is being called while messages are
being added to or removed from the MessageVector in another thread.

It is possible that I am the first to notice this since I am currently
doing LDAP queries through a VPN tunnel over an internet connection.
Messages coming back from the server have a tendency to trickle in
relatively slowly.

So, do I submit patches to this group, or through a different Novell
forum?  Is anybody actively working on this subsystem in such a way that
we might have to merge a lot of work?

-JD Conley

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014263.html">[Mono-dev] The Bleeding Edge of SuSE is not Mono-friendly
</A></li>
	<LI>Next message: <A HREF="014218.html">[Mono-dev] Unhandled Exceptions in Novell.Directory.Ldap and	other Synchronization Issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14216">[ date ]</a>
              <a href="thread.html#14216">[ thread ]</a>
              <a href="subject.html#14216">[ subject ]</a>
              <a href="author.html#14216">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
