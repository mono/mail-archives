<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] COM Interop, or something like it
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20COM%20Interop%2C%20or%20something%20like%20it&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014438.html">
   <LINK REL="Next"  HREF="014363.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] COM Interop, or something like it</H1>
    <B>Ring, Kevin</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20COM%20Interop%2C%20or%20something%20like%20it&In-Reply-To="
       TITLE="[Mono-dev] COM Interop, or something like it">kring at agi.com
       </A><BR>
    <I>Fri Aug 26 19:31:46 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014438.html">[Mono-dev] mono_aot_get_method, aot_mutex, and default_opt
</A></li>
        <LI>Next message: <A HREF="014363.html">[Mono-dev] SPEC files?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14362">[ date ]</a>
              <a href="thread.html#14362">[ thread ]</a>
              <a href="subject.html#14362">[ subject ]</a>
              <a href="author.html#14362">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you to everyone who responded!

I hadn't found cilc in my searching before - it certainly makes the
Embedded Mono approach seem less intimidating.

In playing with it some today, I was able to get some simple unmanaged
-&gt; managed calls working on my Linux machine.  I haven't had much luck
on Windows, though, because of the dependency on glib.  I know I can set
up a whole Cygwin environment complete with glib and build my
application there... but is there a way to embed Mono in an application
built with Visual C++?  I apologize if this is a stupid question.

The purpose of all of this is to enable a large C++ application, which
has been ported to Linux and other Unix platforms with the aid of
MainWin, to continue to be portable as some of its components begin to
be implemented in C#.  So eventually, I'd like to have something that
can generate real C++ interfaces in order to better approximate COM
interop, which I suspect is what we'll be using on the Windows side.  It
sounds like it might not be terribly difficult to do this using an
approach similar to the one used by cilc.  I may be able to convince my
company to sponsor a developer closer to the Mono project to develop
such a thing, if that sounds at all interesting to anyone...just a
thought.

Thanks,
Kevin Ring


&gt;<i> -----Original Message-----
</I>&gt;<i> From: Jonathan Pryor [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jonpryor at vt.edu</A>]
</I>&gt;<i> Sent: Thursday, August 25, 2005 9:21 PM
</I>&gt;<i> To: Ring, Kevin
</I>&gt;<i> Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> Subject: Re: [Mono-dev] COM Interop, or something like it
</I>&gt;<i> 
</I>&gt;<i> On Thu, 2005-08-25 at 16:27 -0400, Ring, Kevin wrote:
</I>&gt;<i> &gt; In Microsoft's implementation of .NET, it is possible to expose a
</I>&gt;<i> &gt; class written in C# via a COM interface.  This makes it possible
</I>&gt;<i> &gt; (perhaps even easy!) to instantiate C# objects and call methods on
</I>&gt;<i> &gt; them from, say, a native C++ application.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Does Mono have a capability like this?
</I>&gt;<i> 
</I>&gt;<i> Yes.  Mono provides an embedding API which allows an unmanaged
</I>&gt;<i> application to create and use managed objects:
</I>&gt;<i> 
</I>&gt;<i> 	<A HREF="http://www.mono-project.com/Embedding_Mono">http://www.mono-project.com/Embedding_Mono</A>
</I>&gt;<i> 
</I>&gt;<i> This isn't terribly ideal, as it's a string-based API.  There is a
</I>&gt;<i> program called cilc which will take a managed class and generate a
</I>bunch
&gt;<i> of C wrappers for each method exposed by the class.  This makes it
</I>easy
&gt;<i> to use a managed class from C (and thus C++, if not perfectly from
</I>C++).
&gt;<i> 
</I>&gt;<i>
</I><A HREF="http://lists.ximian.com/pipermail/mono-list/2003-April/013529.html">http://lists.ximian.com/pipermail/mono-list/2003-April/013529.html</A>
&gt;<i> 
</I>&gt;<i> &gt; I'd just like an easy way to instantiate managed objects and
</I>interact
&gt;<i> &gt; with them from a native C++ application.  I know I can embed Mono,
</I>and
&gt;<i> &gt; call methods that way, but it seems very cumbersome compared to COM
</I>&gt;<i> &gt; interop.  Is there a better way?
</I>&gt;<i> 
</I>&gt;<i> Let cilc handle the cumbersome unmanaged-&gt;managed invocation layer.
</I>&gt;<i> 
</I>&gt;<i>  - Jon
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014438.html">[Mono-dev] mono_aot_get_method, aot_mutex, and default_opt
</A></li>
	<LI>Next message: <A HREF="014363.html">[Mono-dev] SPEC files?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14362">[ date ]</a>
              <a href="thread.html#14362">[ thread ]</a>
              <a href="subject.html#14362">[ subject ]</a>
              <a href="author.html#14362">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
