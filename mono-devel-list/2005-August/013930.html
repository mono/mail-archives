<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] System.Data.SqlClient TDS 7.0 bigint issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20System.Data.SqlClient%20TDS%207.0%20bigint%20issue&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013925.html">
   <LINK REL="Next"  HREF="013921.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] System.Data.SqlClient TDS 7.0 bigint issue</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20System.Data.SqlClient%20TDS%207.0%20bigint%20issue&In-Reply-To="
       TITLE="[Mono-dev] System.Data.SqlClient TDS 7.0 bigint issue">kornelpal at hotmail.com
       </A><BR>
    <I>Thu Aug 11 06:22:17 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013925.html">[Mono-dev] System.Data.SqlClient TDS 7.0 bigint issue
</A></li>
        <LI>Next message: <A HREF="013921.html">[Mono-dev] Re: [Mono-docs-list] [PATCH] css support for Monodoc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13930">[ date ]</a>
              <a href="thread.html#13930">[ thread ]</a>
              <a href="subject.html#13930">[ subject ]</a>
              <a href="author.html#13930">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The range of decimal(19,0) is:
-9,999,999,999,999,999,999..9,999,999,999,999,999,999 (I've tested it on SQL
Server)

The range of Int64 is:
-9,223,372,036,854,775,808..9,223,372,036,854,775,807

You are right that the range of decimal(19,0) is bigger than the range of
Int64 but this can be solved by using Decimal and SqlDecimal for
decimal(19,0) values that cannot be represented using Int64. In other words
that cannot be bigint values.

I know it's an ugly hack to do things like the above and has some
performance penalty but is required to work around TDS 7.0 limitations. And
I think decimal(19,0) is more likely represent a bigint than a real
decimal(19,0).

Korn&#233;l

----- Original Message -----
From: &quot;tsureshkumar&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">tsureshkumar at novell.com</A>&gt;
To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at hotmail.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Thursday, August 11, 2005 9:02 AM
Subject: Re: [Mono-dev] System.Data.SqlClient TDS 7.0 bigint issue


&gt;<i> Korn&#233;l P&#225;l wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you have opinion about this issue please comment it. If the idea will
</I>&gt;&gt;<i> be
</I>&gt;&gt;<i> approved I'll propose a patch.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Look at bug <A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=53169">http://bugzilla.ximian.com/show_bug.cgi?id=53169</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The problem is that Decimal is returned instead of Int64.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is a limitation of TDS 7.0 used by Mono. .NET Framework uses TDS
</I>&gt;&gt;<i> 8.0.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It is difficult to fix as TDS 8.0 should be implemented.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I committed a workaround that makes GetInt64 and GetSqlInt64 able to
</I>&gt;&gt;<i> read decimal(19,0). But there is no way in TDS 7.0 to determine
</I>&gt;&gt;<i> whether the type is bigint.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you use GetValue or GetSqlValue you will get Decimal or SqlDecimal.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> GetValue seems to be used by Mono users as well. And I think it's more
</I>&gt;&gt;<i> likely to use bigint in an MS SQL database than decimal(19,0).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What about trating decimal(19,0) as bigint but let GetDecimal and
</I>&gt;&gt;<i> GetSqlDecimal to return decimal(19,0)? (This would be the revrse of the
</I>&gt;&gt;<i> current solution.)
</I>&gt;<i>
</I>&gt;<i> If I understand your point correctly, you say  that GetValue () should
</I>&gt;<i> return a type of BigInt, instead of Decimal for decimal (19, 0).
</I>&gt;<i>
</I>&gt;<i> I think  this has a potential of treating a decimal field as bigint and
</I>&gt;<i> overflow the Int64. bigint uses 8 bytes whereas decimal uses 9 bytes.
</I>&gt;<i> 10^19 is higher than 2^63. I think bigint to decimal is a safe cast, but
</I>&gt;<i>  not the vice versa.  Ofcourse, in practical, people choose bigint if
</I>&gt;<i> they want higher capacity and our problem lies in, if they want to use
</I>&gt;<i> those extra 7 bits in decimal (19,0) and we are not letting them to use
</I>&gt;<i> through mono, if we follow this approach.
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Korn&#233;l
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013925.html">[Mono-dev] System.Data.SqlClient TDS 7.0 bigint issue
</A></li>
	<LI>Next message: <A HREF="013921.html">[Mono-dev] Re: [Mono-docs-list] [PATCH] css support for Monodoc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13930">[ date ]</a>
              <a href="thread.html#13930">[ thread ]</a>
              <a href="subject.html#13930">[ subject ]</a>
              <a href="author.html#13930">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
