<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] URGENT: Odbc-Exception-Error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20URGENT%3A%20Odbc-Exception-Error&In-Reply-To=0MKwpI-1E5Igp2lW2-0004K1%40mrelayeu.kundenserver.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014024.html">
   <LINK REL="Next"  HREF="014027.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] URGENT: Odbc-Exception-Error</H1>
    <B>Daniel Morgan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20URGENT%3A%20Odbc-Exception-Error&In-Reply-To=0MKwpI-1E5Igp2lW2-0004K1%40mrelayeu.kundenserver.de"
       TITLE="[Mono-dev] URGENT: Odbc-Exception-Error">danielmorgan at verizon.net
       </A><BR>
    <I>Wed Aug 17 08:12:40 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014024.html">[Mono-dev] URGENT: Odbc-Exception-Error
</A></li>
        <LI>Next message: <A HREF="014027.html">[Mono-dev] URGENT: Odbc-Exception-Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14026">[ date ]</a>
              <a href="thread.html#14026">[ thread ]</a>
              <a href="subject.html#14026">[ subject ]</a>
              <a href="author.html#14026">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Read up on MSDN documentation on System.Data.Odbc.OdbcCommand property 
CommandText

The Odbc provider uses question mark placeholders. It does not support 
named parameters. You have to use a SQL statement like:

SELECT * FROM SOME_TABLE WHERE SOME_ID = ?

In your parameters, it is positional, not named.

I noticed in your code your are mis-matching. In your SQL statement, you 
have placeholders, but your creation of the parameters you are using 
named parameters with an @ symbol. You can not do this.

cStmnt = &#8220;UPDATE ComanySTD SET &#8221; +

&#8220; Name1 = ?, &#8221;

&#8220; Name2 = ? &#8221;

&#8220; WHERE PKey = &#8216;&#8221; + cPKey + &quot;&#8216;&#8221;


oCommand.Parameters.Add(new OdbcParameter).Value = 
Textbox_Name1.Text.Trim();

oCommand.Parameters.Add(new OdbcParameter).Value = 
Textbox_Name2.Text.Trim();

oCommand.ExecuteNonQuery();

If Odbc does not work for you, try Npgsql instead to connect to PostgreSQL.

Jan Waiz wrote:

&gt;<i> HI All,
</I>&gt;<i>
</I>&gt;<i> view Days ago i postet Porblems with ODBC and Postgre.
</I>&gt;<i>
</I>&gt;<i> One Answer was testet without solving the Problem so I send it to 
</I>&gt;<i> bugzilla &#8211; without any Answer up to know.
</I>&gt;<i>
</I>&gt;<i> Now I am running in Timeproblems for the Project because I can&#8217;t 
</I>&gt;<i> finish important Parts of the Application and the Deadline will come! 
</I>&gt;<i> So I am coming in Trouble if I did not found a Solution. Be so kind 
</I>&gt;<i> and let me know:
</I>&gt;<i>
</I>&gt;<i> How did YOU work via ODBC with a SQL-Database &#8211; meaning: How did you 
</I>&gt;<i> build Insert- or Updatestatements? And how did you solve the Problem 
</I>&gt;<i> with escaping Signs like &lt;&#8217;&gt; or german Signs like &#8220;&#228;&#246;&#252;&#8221; ? Or did you 
</I>&gt;<i> work with an other SQL-Database in the descriped way without any 
</I>&gt;<i> Problems (*s*) ?
</I>&gt;<i>
</I>&gt;<i> In short I am doing it like this:
</I>&gt;<i>
</I>&gt;<i> cStmnt = &#8220;UPDATE ComanySTD SET&#8221; +
</I>&gt;<i>
</I>&gt;<i> &#8220;Name1 = ?,&#8221;
</I>&gt;<i>
</I>&gt;<i> &#8220;Name2 = ?&#8221;
</I>&gt;<i>
</I>&gt;<i> &#8220;WHERE PKey = &#8216;&#8221; + cPKey + &#8216;&#8221;
</I>&gt;<i>
</I>&gt;<i> oCommand.Parameters.Add( &#8220;@Name1&#8221;, Textbox_Name1.Text.Trim() )
</I>&gt;<i>
</I>&gt;<i> oCommand.Parameters.Add( &#8220;@Name2&#8221;, Textbox_Name2.Text.Trim() )
</I>&gt;<i>
</I>&gt;<i> oCommand.ExecuteNonQuery()
</I>&gt;<i>
</I>&gt;<i> wich is working fine running under Localhost but makes an Error 
</I>&gt;<i> running under Mono:
</I>&gt;<i>
</I>&gt;<i>System.Data.Odbc.OdbcException: [unixODBC]Unrecognized C_parameter type in copy_statement_with_parameters
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> When changing to:
</I>&gt;<i>
</I>&gt;<i> cStmnt = &#8220;UPDATE ComanySTD SET&#8221; +
</I>&gt;<i>
</I>&gt;<i> &#8220;Name1 = &#8220; + Textbox_Name1.Text.Trim() + ,&#8221;
</I>&gt;<i>
</I>&gt;<i> &#8220;Name2 = &#8220; + Textbox_Name2.Text.Trim() + ,&#8221;
</I>&gt;<i>
</I>&gt;<i> &#8220;WHERE PKey = &#8216;&#8221; + cPKey + &#8216;&#8221;
</I>&gt;<i>
</I>&gt;<i> It works. But without excaping! And Signs like &#8220;&#228;&#246;&#252;&#8221; will shown as 
</I>&gt;<i> Crashed-Signs in a Textbox when showing a Record.
</I>&gt;<i>
</I>&gt;<i> I am playing around with different Ways using Parameter like:
</I>&gt;<i>
</I>&gt;<i> oCommand.Parameters.Add( &#8220;@Name1&#8221;, OdbcType.varchar, 36 ).Value = 
</I>&gt;<i> Textbox_Name1.Text.Trim()
</I>&gt;<i>
</I>&gt;<i> but everytime the same Runtimeerror.
</I>&gt;<i>
</I>&gt;<i> So &#8211; now I am at the end of my Nerves and my Knowledge. Hope, there is 
</I>&gt;<i> anyone outside there, who can tell me, how he is using ODBC-Parameter&#8230;
</I>&gt;<i>
</I>&gt;<i> Many Thanks for ANY Help !!!
</I>&gt;<i>
</I>&gt;<i> Jan Waiz
</I>&gt;<i>
</I>&gt;<i>------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-devel-list mailing list
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>  
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014024.html">[Mono-dev] URGENT: Odbc-Exception-Error
</A></li>
	<LI>Next message: <A HREF="014027.html">[Mono-dev] URGENT: Odbc-Exception-Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14026">[ date ]</a>
              <a href="thread.html#14026">[ thread ]</a>
              <a href="subject.html#14026">[ subject ]</a>
              <a href="author.html#14026">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
