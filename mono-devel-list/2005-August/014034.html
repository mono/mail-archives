<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] URGENT: Odbc-Exception-Error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20URGENT%3A%20Odbc-Exception-Error&In-Reply-To=0ML2Dk-1E5RCm0oWJ-00033u%40mrelayeu.kundenserver.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014033.html">
   <LINK REL="Next"  HREF="014028.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] URGENT: Odbc-Exception-Error</H1>
    <B>S&#233;bastien Robitaille</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20URGENT%3A%20Odbc-Exception-Error&In-Reply-To=0ML2Dk-1E5RCm0oWJ-00033u%40mrelayeu.kundenserver.de"
       TITLE="[Mono-dev] URGENT: Odbc-Exception-Error">sebastien.robitaille at croesus.com
       </A><BR>
    <I>Wed Aug 17 13:58:52 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014033.html">AW: [Mono-dev] URGENT: Odbc-Exception-Error
</A></li>
        <LI>Next message: <A HREF="014028.html">[Mono-dev] Mono and bytecode enhancement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14034">[ date ]</a>
              <a href="thread.html#14034">[ thread ]</a>
              <a href="subject.html#14034">[ subject ]</a>
              <a href="author.html#14034">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jan,

I'm sorry. I was wrong. I just realized that our application is totally broken with Odbc :-(
What Daniel said is true; Named parameters cannot be used with Odbc.

There is an interesting thread on the mono-list about this:
<A HREF="http://lists.ximian.com/pipermail/mono-list/2003-January/011259.html">http://lists.ximian.com/pipermail/mono-list/2003-January/011259.html</A>

S&#233;bas

-----Original Message-----
From: Jan Waiz [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">hamburg at icomedv.de</A>]
Sent: August 17, 2005 12:57 PM
To: 'S&#233;bastien Robitaille'
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: AW: [Mono-dev] URGENT: Odbc-Exception-Error


Sebastien,

of course! It seems to be a Problem with the Combination Odbc/Postgre. It
MUST be that, because it is me who is doing that :-)

I will test other Driver tomorrow - today I am to tired for that :-)

Thanks for your Help. Will have a look to unixODBC and freeTDS.

Regards
Jan Waiz

-----Urspr&#252;ngliche Nachricht-----
Von: S&#233;bastien Robitaille [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sebastien.robitaille at croesus.com</A>]
Gesendet: Mittwoch, 17. August 2005 17:11
An: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">hamburg at icomedv.de</A>
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Betreff: RE: [Mono-dev] URGENT: Odbc-Exception-Error

Jan,

I am using the ODBC .NET Provider to access a Sybase database.
On Linux, I am using unixODBC and freeTDS.

And yes, it works as expected.
I never used PostgreSQL, but my code works as-is on Sybase and SQL Server
with the following .NET providers on both Mono and MS.NET:
- SybaseClient
- SQLClient
- Odbc

Maybe your problem has something to do with the ODBC database driver you are
using?

Hope it helps.

S&#233;bas

-----Original Message-----
From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>]On Behalf Of Jan Waiz
Sent: August 17, 2005 10:23 AM
To: 'S&#233;bastien Robitaille'
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: AW: [Mono-dev] URGENT: Odbc-Exception-Error


Sebas,

Problem is, that the ODBC-Classes did not support named Parameters. When
doing as you describe, I got a Runtime-Error

Syntax-Error at Sign,,,

Did you use the ODBC-Classes ?

Regards
Jan Waiz

-----Urspr&#252;ngliche Nachricht-----
Von: S&#233;bastien Robitaille [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sebastien.robitaille at croesus.com</A>]
Gesendet: Mittwoch, 17. August 2005 15:14
An: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">hamburg at icomedv.de</A>
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Betreff: RE: [Mono-dev] URGENT: Odbc-Exception-Error

Hi,

maybe you should try something like this instead:

cStmnt = &quot;UPDATE ComanySTD SET Name1=@Name1, Name2=@Name2 WHERE PKey=@PKey&quot;;

oCommand.Parameters.Add(&quot;@Name1&quot;, Textbox_Name1.Text.Trim() )
oCommand.Parameters.Add(&quot;@Name2&quot;, Textbox_Name2.Text.Trim() )
oCommand.Parameters.Add(&quot;@PKey&quot;, cPKey);
oCommand.ExecuteNonQuery()

S&#233;bas

-----Original Message-----
From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>]On Behalf Of Daniel
Morgan
Sent: August 17, 2005 8:13 AM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">hamburg at icomedv.de</A>
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: Re: [Mono-dev] URGENT: Odbc-Exception-Error


Read up on MSDN documentation on System.Data.Odbc.OdbcCommand property
CommandText

The Odbc provider uses question mark placeholders. It does not support
named parameters. You have to use a SQL statement like:

SELECT * FROM SOME_TABLE WHERE SOME_ID = ?

In your parameters, it is positional, not named.

I noticed in your code your are mis-matching. In your SQL statement, you
have placeholders, but your creation of the parameters you are using
named parameters with an @ symbol. You can not do this.

cStmnt = &#147;UPDATE ComanySTD SET &#148; +

&#147; Name1 = ?, &#148;

&#147; Name2 = ? &#148;

&#147; WHERE PKey = &#145;&#148; + cPKey + &quot;&#145;&#148;


oCommand.Parameters.Add(new OdbcParameter).Value =
Textbox_Name1.Text.Trim();

oCommand.Parameters.Add(new OdbcParameter).Value =
Textbox_Name2.Text.Trim();

oCommand.ExecuteNonQuery();

If Odbc does not work for you, try Npgsql instead to connect to PostgreSQL.

Jan Waiz wrote:

&gt;<i> HI All,
</I>&gt;<i>
</I>&gt;<i> view Days ago i postet Porblems with ODBC and Postgre.
</I>&gt;<i>
</I>&gt;<i> One Answer was testet without solving the Problem so I send it to
</I>&gt;<i> bugzilla &#150; without any Answer up to know.
</I>&gt;<i>
</I>&gt;<i> Now I am running in Timeproblems for the Project because I can&#146;t
</I>&gt;<i> finish important Parts of the Application and the Deadline will come!
</I>&gt;<i> So I am coming in Trouble if I did not found a Solution. Be so kind
</I>&gt;<i> and let me know:
</I>&gt;<i>
</I>&gt;<i> How did YOU work via ODBC with a SQL-Database &#150; meaning: How did you
</I>&gt;<i> build Insert- or Updatestatements? And how did you solve the Problem
</I>&gt;<i> with escaping Signs like &lt;&#146;&gt; or german Signs like &#147;&#228;&#246;&#252;&#148; ? Or did you
</I>&gt;<i> work with an other SQL-Database in the descriped way without any
</I>&gt;<i> Problems (*s*) ?
</I>&gt;<i>
</I>&gt;<i> In short I am doing it like this:
</I>&gt;<i>
</I>&gt;<i> cStmnt = &#147;UPDATE ComanySTD SET&#148; +
</I>&gt;<i>
</I>&gt;<i> &#147;Name1 = ?,&#148;
</I>&gt;<i>
</I>&gt;<i> &#147;Name2 = ?&#148;
</I>&gt;<i>
</I>&gt;<i> &#147;WHERE PKey = &#145;&#148; + cPKey + &#145;&#148;
</I>&gt;<i>
</I>&gt;<i> oCommand.Parameters.Add( &#147;@Name1&#148;, Textbox_Name1.Text.Trim() )
</I>&gt;<i>
</I>&gt;<i> oCommand.Parameters.Add( &#147;@Name2&#148;, Textbox_Name2.Text.Trim() )
</I>&gt;<i>
</I>&gt;<i> oCommand.ExecuteNonQuery()
</I>&gt;<i>
</I>&gt;<i> wich is working fine running under Localhost but makes an Error
</I>&gt;<i> running under Mono:
</I>&gt;<i>
</I>&gt;<i>System.Data.Odbc.OdbcException: [unixODBC]Unrecognized C_parameter type in
</I>copy_statement_with_parameters
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> When changing to:
</I>&gt;<i>
</I>&gt;<i> cStmnt = &#147;UPDATE ComanySTD SET&#148; +
</I>&gt;<i>
</I>&gt;<i> &#147;Name1 = &#147; + Textbox_Name1.Text.Trim() + ,&#148;
</I>&gt;<i>
</I>&gt;<i> &#147;Name2 = &#147; + Textbox_Name2.Text.Trim() + ,&#148;
</I>&gt;<i>
</I>&gt;<i> &#147;WHERE PKey = &#145;&#148; + cPKey + &#145;&#148;
</I>&gt;<i>
</I>&gt;<i> It works. But without excaping! And Signs like &#147;&#228;&#246;&#252;&#148; will shown as
</I>&gt;<i> Crashed-Signs in a Textbox when showing a Record.
</I>&gt;<i>
</I>&gt;<i> I am playing around with different Ways using Parameter like:
</I>&gt;<i>
</I>&gt;<i> oCommand.Parameters.Add( &#147;@Name1&#148;, OdbcType.varchar, 36 ).Value =
</I>&gt;<i> Textbox_Name1.Text.Trim()
</I>&gt;<i>
</I>&gt;<i> but everytime the same Runtimeerror.
</I>&gt;<i>
</I>&gt;<i> So &#150; now I am at the end of my Nerves and my Knowledge. Hope, there is
</I>&gt;<i> anyone outside there, who can tell me, how he is using ODBC-Parameter
</I>
&gt;<i>
</I>&gt;<i> Many Thanks for ANY Help !!!
</I>&gt;<i>
</I>&gt;<i> Jan Waiz
</I>&gt;<i>
</I>&gt;<i>------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-devel-list mailing list
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
_______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>

_______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014033.html">AW: [Mono-dev] URGENT: Odbc-Exception-Error
</A></li>
	<LI>Next message: <A HREF="014028.html">[Mono-dev] Mono and bytecode enhancement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14034">[ date ]</a>
              <a href="thread.html#14034">[ thread ]</a>
              <a href="subject.html#14034">[ subject ]</a>
              <a href="author.html#14034">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
