<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Writing assembly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Writing%20assembly&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004021.html">
   <LINK REL="Next"  HREF="004025.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Writing assembly</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Writing%20assembly&In-Reply-To="
       TITLE="[Mono-devel-list] Writing assembly">05mauben at hawken.edu
       </A><BR>
    <I>Thu Feb 12 13:39:03 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="004021.html">[Mono-devel-list] Writing assembly
</A></li>
        <LI>Next message: <A HREF="004025.html">[Mono-devel-list] DataAdapter retrieves only two records
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4023">[ date ]</a>
              <a href="thread.html#4023">[ thread ]</a>
              <a href="subject.html#4023">[ subject ]</a>
              <a href="author.html#4023">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yeah, you should only compile the pre-written code if you are saving to an assembly.

The time to add the code is not really a problem. There is really not that much cost to generating the actual code. I think you will find that parsing the Regex and making a strategy is much more costly than is spitting out some pre generated code. Also, remember the CompileToAssembly case is not really performance critical.

As always, do concentrate on getting it working. Once you guys have that, you can look at performance. I would be happy to lend you a hand if you want it.

Am very excited to see this sort of thing working. Some day, we are probably going to be doing a compiled version of XPath/XQuery/XSLT, so it will be interesting to see another similar piece of code. (MS has this for whidbey)

-- Ben

&gt;&gt;&gt;<i> Eric Durand-Tremblay &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">eric.durand-tremblay.1 at ulaval.ca</A>&gt; 02/12/04 13:11 PM &gt;&gt;&gt;
</I>Thank you for the quick response.

This is not a problem,  we will eventually rewrite dynamically our base 
class and merge it with the dynamic assembly. (I asked out of laziness 
;) ) The only problem is that it cost a lot of compile time for each 
regex.  An other possibility is to dynamically compile the base class 
only when saving to an assembly.  Hence we will keep our compile time 
when compiling usual regex.

Actually, MS use base class to achieve this ( RegexRunner ) It is 
exactly why we have compatibility issues.  Note that we use the IMachine 
Interface like  mono interpreter.

For now, we concentrate on getting it all to run. We will be happy to 
introduce some tweaking later.

Eric

Ben Maurer a &#233;crit :

&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>No, there is not a way to do this easily. Your best option is to use a Perl script that would take the compiled class and turn it into S.R.E code to emit the same IL.
</I>&gt;<i>
</I>&gt;<i>One other possibility is that the runtime guys could hack something up for you that would copy the code from one assembly into one that is being built. However, this prevents you from using your impl on the MS runtime (eg, you cant copy just your code and compile/run on MS). Although this seems unimportant, it actually opens some unique testing possibilities. For example, you can run a run a regex on a set of random string data under MS and your impl, and see if they come out the same. Or you can do some performance testing of how fast your compiler is. Not a big deal, but if you dont have to loose it you should not.
</I>&gt;<i>
</I>&gt;<i>Also, for code that will be going into many assemblies, you should optimize it a bit by hand for size. Eg, mcs does not emit short jumps, but you can code those in yourself. There are many other ways you can work on reducing size, and some pretty cool tricks you can do in IL.
</I>&gt;<i>
</I>&gt;<i>-- Ben
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Eric Durand-Tremblay &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">eric.durand-tremblay.1 at ulaval.ca</A>&gt; 02/12/04 11:34 AM &gt;&gt;&gt;
</I>&gt;&gt;&gt;&gt;<i>        
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;<i>Hello all,
</I>&gt;<i>
</I>&gt;<i>Does anyone know a way to emit (with reflection) an already existing 
</I>&gt;<i>class (compiled in C#).  We looked at System.Reflection.Emit namespace 
</I>&gt;<i>but we are only able to save dynamicaly created assembly.
</I>&gt;<i>
</I>&gt;<i>It could be usefull to do this when it is time to make our assembly 
</I>&gt;<i>compatible with MS runtime.  (Like saving some base class to assembly)
</I>&gt;<i>
</I>&gt;<i>Thanks,
</I>&gt;<i>
</I>&gt;<i>-------------------------------
</I>&gt;<i>Eric Durand Tremblay
</I>&gt;<i>TIP-Mono Team
</I>&gt;<i>Blogging : <A HREF="http://aeglos.dyndns.org/tip-mono">http://aeglos.dyndns.org/tip-mono</A>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-devel-list mailing list
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004021.html">[Mono-devel-list] Writing assembly
</A></li>
	<LI>Next message: <A HREF="004025.html">[Mono-devel-list] DataAdapter retrieves only two records
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4023">[ date ]</a>
              <a href="thread.html#4023">[ thread ]</a>
              <a href="subject.html#4023">[ subject ]</a>
              <a href="author.html#4023">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
