<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Mono performance problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Mono%20performance%20problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004196.html">
   <LINK REL="Next"  HREF="004182.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Mono performance problem</H1>
    <B>Namit Dhameja</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Mono%20performance%20problem&In-Reply-To="
       TITLE="[Mono-devel-list] Mono performance problem">ndhameja at panaceasoftware.com
       </A><BR>
    <I>Mon Feb 23 13:28:50 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="004196.html">[Mono-devel-list] Mono performance problem
</A></li>
        <LI>Next message: <A HREF="004182.html">[Mono-devel-list] mono runtime type and function definitions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4222">[ date ]</a>
              <a href="thread.html#4222">[ thread ]</a>
              <a href="subject.html#4222">[ subject ]</a>
              <a href="author.html#4222">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Paolo,
      Thank you for your feedback. It was really quite detailed, much more
than the profile page on the mono site :-).
    I did put the wrong unit about the time taken. It's
      MS.NET ~ 2-3s
      MONO (0.3 on Suse 9.0) ~ 10-12s
      MINT (0.3 on Suse 9.0) ~ 40s
With all this information that you have provided, I will try to identify the
bottlenecks and hopefully come back with a more detailed report.
Thanks again.
-Best Reagrds,
Namit.

----- Original Message ----- 
From: &quot;Paolo Molaro&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>&gt;
To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Saturday, February 21, 2004 8:31 AM
Subject: Re: [Mono-devel-list] Mono performance problem


&gt;<i> On 02/20/04 Namit Dhameja wrote:
</I>&gt;<i> &gt; We recently ported our server code to Linux (Mono) from Windows
</I>&gt;<i> &gt; (MS.Net). The problem is that there is a huge performance hit. A
</I>&gt;<i> &gt; particular transcation on MS.Net takes ~2sec, on Mono the same takes
</I>&gt;<i> &gt; around ~10-12ms.
</I>&gt;<i>
</I>&gt;<i> Wow, mono is 200 times faster? :-)
</I>&gt;<i> Anyway: there are still many areas of mono that have not yet been
</I>&gt;<i> optimized, we appreciate reports about particular workloads in which we
</I>&gt;<i> are significantly slower than the MS runtime. Please tell us aolaso
</I>&gt;<i> which version of Mono you're using.
</I>&gt;<i>
</I>&gt;<i> &gt; To find out the reason I ran Mono with '--profile' option and got
</I>&gt;<i> &gt; a 510KB file. If you know of any software (UI)  which would take this
</I>&gt;<i> &gt; file and give me some sort of easily digestable information that would
</I>&gt;<i> &gt; be really appreciated.
</I>&gt;<i>
</I>&gt;<i> Sadly there is no GUI yet to look at the profiling data: we hope to
</I>&gt;<i> provide one for our 1.0 release, but nobody volunteered yet:-)
</I>&gt;<i> At the top of the file you'll find the list of methods where most of the
</I>&gt;<i> time has been spent. It looks like this:
</I>&gt;<i>
</I>&gt;<i> Time(ms) Count   P/call(ms) Method name
</I>&gt;<i> ########################
</I>&gt;<i>  47863.442       1  47863.442   .T::Main(object,intptr,intptr)
</I>&gt;<i>   Callers (with count) that contribute at least for 1%:
</I>&gt;<i> ########################
</I>&gt;<i>  47861.575       1  47861.575   .T::Main()
</I>&gt;<i>   Callers (with count) that contribute at least for 1%:
</I>&gt;<i>            1  100 % .T::Main(object,intptr,intptr)
</I>&gt;<i> ########################
</I>&gt;<i>  26721.975       1  26721.975   .T::use_activator()
</I>&gt;<i>   Callers (with count) that contribute at least for 1%:
</I>&gt;<i>            1  100 % .T::Main()
</I>&gt;<i> ########################
</I>&gt;<i>  26245.512 1000000    0.026   System.Activator::CreateInstance(Type)
</I>&gt;<i>   Callers (with count) that contribute at least for 1%:
</I>&gt;<i>      1000000  100 % .T::use_activator()
</I>&gt;<i> ########################
</I>&gt;<i>  25663.816 1000000    0.026
</I>&gt;<i> System.Activator::CreateInstance(Type,bool)
</I>&gt;<i>   Callers (with count) that contribute at least for 1%:
</I>&gt;<i>      1000000  100 % System.Activator::CreateInstance(Type)
</I>&gt;<i> ########################
</I>&gt;<i>  22373.921 2000000    0.011
</I>&gt;<i> System.Reflection.ConstructorInfo::Invoke(object[])
</I>&gt;<i>   Callers (with count) that contribute at least for 1%:
</I>&gt;<i>      1000000  50 % System.Activator::CreateInstance(Type,bool)
</I>&gt;<i>      1000000  50 % .T::use_ctor()
</I>&gt;<i>
</I>&gt;<i> For each method you get how many milliseconds were spent in all the
</I>&gt;<i> invocations of that method, how many times it was called and the mean
</I>&gt;<i> invocation time for call. You also get a list of the callers with a
</I>&gt;<i> count of how many times each caller called the method.
</I>&gt;<i> In this example, ConstructorInfo::Invoke(object[]) was called 2000000
</I>&gt;<i> times, 1000000 from the T::use_ctor() method and 1000000 from the
</I>&gt;<i> Activator::CreateInstance(Type,bool) method.
</I>&gt;<i> We can also see that roughly half of the time in the benchmark run as
</I>&gt;<i> spent inside ConstructorInfo::Invoke(object[]) (22 seconds out of 48
</I>&gt;<i> seconds): this means that method probably needs some speedups in mono...
</I>&gt;<i>
</I>&gt;<i> So, given the above info, you can try to look at the data and report
</I>&gt;<i> where most of time is spent. Or you can send me the file in private
</I>&gt;<i> email and I'll try to sumamrize it and see if there are obvious spots in
</I>&gt;<i> mono that need improvement.
</I>&gt;<i> If you can distribute the source of your app we can try and run with
</I>&gt;<i> profiling ourself, otherwise, please provide us the data from the
</I>&gt;<i> profiler or, given the data, send us possibly small programs that
</I>&gt;<i> execute the same kind of code, so we can try and optimize their
</I>&gt;<i> execution.
</I>&gt;<i> Thanks!
</I>&gt;<i>
</I>&gt;<i> lupus
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> -----------------------------------------------------------------
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004196.html">[Mono-devel-list] Mono performance problem
</A></li>
	<LI>Next message: <A HREF="004182.html">[Mono-devel-list] mono runtime type and function definitions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4222">[ date ]</a>
              <a href="thread.html#4222">[ thread ]</a>
              <a href="subject.html#4222">[ subject ]</a>
              <a href="author.html#4222">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
