<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Debug mono ODBC ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Debug%20mono%20ODBC%20%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037909.html">
   <LINK REL="Next"  HREF="037911.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Debug mono ODBC ?</H1>
    <B>quandary</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Debug%20mono%20ODBC%20%3F&In-Reply-To="
       TITLE="[Mono-dev] Debug mono ODBC ?">quandary82 at hailmail.net
       </A><BR>
    <I>Sat Aug  6 05:00:20 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037909.html">[Mono-dev] mod_mono on OSX
</A></li>
        <LI>Next message: <A HREF="037911.html">[Mono-dev] Debug mono ODBC ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37910">[ date ]</a>
              <a href="thread.html#37910">[ thread ]</a>
              <a href="subject.html#37910">[ subject ]</a>
              <a href="author.html#37910">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, question:

In short, I want to know how I can debug ODBC with mono.
Because
A) My code just freezes at (string) reader[&quot;BEZEICHNUNG&quot;];
and
B) mono --debug myfile.exe shows no messages

Since the available memory goes down for as long as the program runs, my
guess is that
(string) reader[&quot;BEZEICHNUNG&quot;];
never gets a '\0' character.


Below some background info:


I'm trying to connect to an Access DB on Linux (Ubuntu 11.04, mono 2.10.2).

The way I do this:
1. Install mdbtools-dev
2. Install unixodbc-dev
3. Create an ODBC DSN entry in /etc/odbc.ini

[MyDSN]
Description = Microsoft Access Database
Database = /root/DBs/myAccessDB.mdb
Driver = /usr/lib/libmdbodbc.so
Setup =
FileUsage = 1
CPTimeout =
CPReuse =

4. Test the ODBC connection with OpenOffice base --&gt; nothing (no error
either) with Access DB
    ODBC works for Firebird + MySQL, so no setup bug, probably
OpenOffice bug
5. Figure out whether it's a mdbtools-bug, with mdbtools-viewer (gmdb2) 
--&gt; success, can see db + content, so no mdbtools-bug, so it's either an
ODBC or an OpenOffice bug
6. Test whether it is an ODBC or an OpenOffice bug: ODBC query with isql
--&gt; success, I can retrieve the Access data via the ODBC connection, so
no ODBC bug, it follows it's an OpenOffice bug
7. Write a mono ODBC test program.
8. Test --&gt; crashes on Access (same query as with isql)
9. Test whether the program is wrong: Use same program on MySQL ODBC
---&gt; Works fine
10. It follows --&gt; We have a mono bug here.



Here my code:

using System;
using System.Data;
using System.Data.Odbc;

namespace OdbcTest
{
    class MainClass
    {
       
        // <A HREF="https://help.ubuntu.com/community/ODBC">https://help.ubuntu.com/community/ODBC</A>
        //
<A HREF="http://user.services.openoffice.org/en/forum/viewtopic.php?f=40&amp;t=1416">http://user.services.openoffice.org/en/forum/viewtopic.php?f=40&amp;t=1416</A>
        // <A HREF="http://ngommans.ca/howto/jdbc-odbc/">http://ngommans.ca/howto/jdbc-odbc/</A>
        // <A HREF="http://www.firebirdnews.org/?p=1324">http://www.firebirdnews.org/?p=1324</A>
        // <A HREF="http://manpages.ubuntu.com/manpages/hardy/man1/isql-fb.1.html">http://manpages.ubuntu.com/manpages/hardy/man1/isql-fb.1.html</A>
        // <A HREF="http://www.mono-project.com/ODBC">http://www.mono-project.com/ODBC</A>
       
        public static void Main (string[] args)
        {
                    // have an ODBC DSN setup named MYSQLDSN
        // that accesses a MySQL database via
        // MyODBC driver for ODBC with a
        // hostname of localhost and database test
       string connectionString =
          &quot;DSN=MyDSN;&quot; +
          //&quot;&quot;;
            &quot;UID=;&quot; +
          &quot;PWD=&quot;;
       //IDbConnection dbcon;
            OdbcConnection dbcon;
       dbcon = new OdbcConnection(connectionString);
       dbcon.Open();
       IDbCommand dbcmd = dbcon.CreateCommand();
       // requires a table to be created named employee
       // with columns firstname and lastname
       // such as,
       //        CREATE TABLE employee (
       //           firstname varchar(32),
       //           lastname varchar(32));
       string sql =
           &quot;select * from ART&quot;;
       dbcmd.CommandText = sql;
      
        IDataReader reader = dbcmd.ExecuteReader();
       while(reader.Read()) {
            // Stays here forever
            string FirstName = (string) reader[&quot;BEZEICHNUNG&quot;];
            string LastName = (string) reader[&quot;MEINHEIT&quot;];
            Console.WriteLine(&quot;modul form: &quot; + FirstName + &quot; &quot; + LastName);
       }
       // clean up
       reader.Close();
       reader = null;
     
    /*
                DataTable dt = new DataTable();
    OdbcDataAdapter da = new OdbcDataAdapter(sql,dbcon);
            da.Fill(dt); // Takes forever
            Console.WriteLine(dt.Rows.Count.ToString());
             */
           
       dbcmd.Dispose();
       dbcmd = null;
       dbcon.Close();
       dbcon = null;
        }
    }
}

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037909.html">[Mono-dev] mod_mono on OSX
</A></li>
	<LI>Next message: <A HREF="037911.html">[Mono-dev] Debug mono ODBC ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37910">[ date ]</a>
              <a href="thread.html#37910">[ thread ]</a>
              <a href="subject.html#37910">[ subject ]</a>
              <a href="author.html#37910">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
