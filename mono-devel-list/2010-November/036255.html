<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Deadlock Detection in Mono Libraries
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Deadlock%20Detection%20in%20Mono%20Libraries&In-Reply-To=AANLkTimR5xsTLGzJHH_oi0X6qwmwQsLB9cmFynEKkB_n%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036251.html">
   <LINK REL="Next"  HREF="036260.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Deadlock Detection in Mono Libraries</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Deadlock%20Detection%20in%20Mono%20Libraries&In-Reply-To=AANLkTimR5xsTLGzJHH_oi0X6qwmwQsLB9cmFynEKkB_n%40mail.gmail.com"
       TITLE="[Mono-dev] Deadlock Detection in Mono Libraries">jonpryor at vt.edu
       </A><BR>
    <I>Mon Nov  8 09:33:12 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="036251.html">[Mono-dev] Deadlock Detection in Mono Libraries
</A></li>
        <LI>Next message: <A HREF="036260.html">[Mono-dev] Deadlock Detection in Mono Libraries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36255">[ date ]</a>
              <a href="thread.html#36255">[ thread ]</a>
              <a href="subject.html#36255">[ subject ]</a>
              <a href="author.html#36255">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2010-11-08 at 07:35 +0530, Arun K wrote:
&gt;<i> I am performing a static analysis on the mono 2.4.x libraries.
</I>
2.4.x?  How old!  (We're up to 2.8 now...)

&gt;<i> The aim of this analysis is to detect potential deadlock scenarios
</I>&gt;<i> within the libraries. As a first step, I wanted to find if any
</I>&gt;<i> synchronized method invokes another synchronized method either
</I>&gt;<i> directly or eventually
</I>
Thus, the *most* important question: How do you define &quot;synchronized&quot;?

My guess is that your definition is a method with the attribute:

        [MethodImpl (MethodImplOptions.Synchronized)]

If this is the case, the problem you're encountering is that this is
explicitly counter to .NET documentation, e.g. [0, 1]:

        Generally, it is best to avoid locking on a public type, or on
        object instances beyond the control of your application. For
        example, lock(this) can be problematic if the instance can be
        accessed publicly, because code beyond your control may lock on
        the object as well. This could create deadlock situations where
        two or more threads wait for the release of the same object.

.NET guidelines advocate declaring a *private* object instance and
locking on that, instead of using Synchronized methods. [2]

In short, if you see [MethodImpl (MethodImplOptions.Synchronized)],
you're either looking at compatibility with .NET, or you're looking at a
probable bug.

 - Jon

[0] <A HREF="http://msdn.microsoft.com/en-us/library/ms173179.aspx">http://msdn.microsoft.com/en-us/library/ms173179.aspx</A>
[1] <A HREF="http://msdn.microsoft.com/en-us/library/ms182290(VS.80">http://msdn.microsoft.com/en-us/library/ms182290(VS.80</A>).aspx
[2] My guess is that the only reason you can lock on System.Object and
not some more restricted type is for Java compatibility...which is the
~same reason that .NET arrays are covariant.


</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036251.html">[Mono-dev] Deadlock Detection in Mono Libraries
</A></li>
	<LI>Next message: <A HREF="036260.html">[Mono-dev] Deadlock Detection in Mono Libraries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36255">[ date ]</a>
              <a href="thread.html#36255">[ thread ]</a>
              <a href="subject.html#36255">[ subject ]</a>
              <a href="author.html#36255">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
