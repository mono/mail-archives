<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mixed Mode Assemblies
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mixed%20Mode%20Assemblies&In-Reply-To=1310231211573-3656441.post%40n4.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037807.html">
   <LINK REL="Next"  HREF="037810.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mixed Mode Assemblies</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mixed%20Mode%20Assemblies&In-Reply-To=1310231211573-3656441.post%40n4.nabble.com"
       TITLE="[Mono-dev] Mixed Mode Assemblies">jonpryor at vt.edu
       </A><BR>
    <I>Sat Jul  9 13:57:08 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037807.html">[Mono-dev] Mixed Mode Assemblies
</A></li>
        <LI>Next message: <A HREF="037810.html">[Mono-dev] Mixed Mode Assemblies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37809">[ date ]</a>
              <a href="thread.html#37809">[ thread ]</a>
              <a href="subject.html#37809">[ subject ]</a>
              <a href="author.html#37809">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jul 9, 2011, at 1:06 PM, arkain wrote:
&gt;<i> Here's another possibility. I don't see what the problem would be in
</I>&gt;<i> embedding ELF objects into a PE following the usual COFF objects. Doesn't PE
</I>&gt;<i> have a text section that could be used to tag for extraction the native
</I>&gt;<i> portion of the assembly? If that were used, then it would be possible to
</I>&gt;<i> create a PE that contained COFF for the .NET  code and ELF for the native
</I>&gt;<i> code (on linux). The assembly loader in Linux could then extract the ELF
</I>&gt;<i> content into a separate file in a temp directory and load it with dlopen.
</I>
That's only a halfway solution. One of the Nice Things about C++/CLI (and COM interop, for that matter) is that native clients can load managed assemblies without even realizing it [0]. Things Just Work because LoadLibrary() loads a mixed-mode assembly the same way it loads any other native library, and the loading app doesn't need to do anything differently.

Consequently, what you really want is to embed IL/etc. into ELF/Mach-O/etc. file formats, and add support to mono for these alternative file formats. This would allow existing native code to continue to use dlopen(3)/etc. against platform-native libraries which &quot;just happen&quot; to contain IL as well, implicitly pulling in mono (via shared library dependencies, more or less how things work with PE on Windows).

This was previously discussed on this thread, and given that ELF allows embedding ~arbitrary text/binary sections into .so files (and presumably .dylib does as well), adding support for this likely wouldn't be _too_ difficult...

 - Jon

[0] This is also potentially a Bad Thing&#8482;, depending on how you see it. :-)

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037807.html">[Mono-dev] Mixed Mode Assemblies
</A></li>
	<LI>Next message: <A HREF="037810.html">[Mono-dev] Mixed Mode Assemblies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37809">[ date ]</a>
              <a href="thread.html#37809">[ thread ]</a>
              <a href="subject.html#37809">[ subject ]</a>
              <a href="author.html#37809">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
