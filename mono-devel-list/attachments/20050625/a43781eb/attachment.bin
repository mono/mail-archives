/*
 * compile with:
 *     gcc -g -Wall -o foo foo.c -ldl
 *
 * test with:
 *     MALLOC_CHECK_=3 gdb ./foo
 *
 * continue after the first libgc SIGSEGV
 */

#include <stdio.h>
#include <dlfcn.h>

int
main (int argc, char **argv)
{
    void *dlh;
    void *(*mono_jit_init)(const char *domain_name);

    dlh = dlopen ("libmono.so", RTLD_NOW);
    mono_jit_init = dlsym (dlh, "mono_jit_init");
    printf ("%p\n", mono_jit_init ("Foo"));

    return 0;
}
