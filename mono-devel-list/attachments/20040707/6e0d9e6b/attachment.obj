Index: TypeBuilder.cs
===================================================================
RCS file: /cvs/public/mcs/class/corlib/System.Reflection.Emit/TypeBuilder.cs,v
retrieving revision 1.106
diff -u -r1.106 TypeBuilder.cs
--- TypeBuilder.cs	23 Jun 2004 12:50:05 -0000	1.106
+++ TypeBuilder.cs	7 Jul 2004 18:03:12 -0000
@@ -247,18 +247,18 @@
 				throw not_after_created ();
 
 			if (interfaces != null) {
-				// Check for duplicates
-				foreach (Type t in interfaces)
-					if (t == interfaceType)
-						return;
-
-				Type[] ifnew = new Type [interfaces.Length + 1];
-				interfaces.CopyTo (ifnew, 0);
-				ifnew [interfaces.Length] = interfaceType;
-				interfaces = ifnew;
+				ArrayList newInterfaces = new ArrayList(interfaces);
+				if(!newInterfaces.Contains(interfaceType))
+					newInterfaces.Add(interfaceType);
+				foreach(Type t in interfaceType.GetInterfaces())
+					newInterfaces.Add(t);
+				interfaces = (Type[])newInterfaces.ToArray(typeof(Type));
 			} else {
-				interfaces = new Type [1];
-				interfaces [0] = interfaceType;
+				ArrayList interfacesToAdd = new ArrayList();
+				interfacesToAdd.Add(interfaceType);
+				foreach(Type t in interfaceType.GetInterfaces())
+					interfacesToAdd.Add(t);
+				interfaces = (Type[])interfacesToAdd.ToArray(typeof(Type));
 			}
 		}
 
