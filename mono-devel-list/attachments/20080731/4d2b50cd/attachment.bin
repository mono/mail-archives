Index: runtime/Makefile.am
===================================================================
--- runtime/Makefile.am	(revision 109357)
+++ runtime/Makefile.am	(working copy)
@@ -75,8 +75,13 @@
 	cd $(mcs_topdir) && $(MAKE) NO_DIR_CHECK=1 PROFILES='$(build_profiles)' run-test-profiles
 
 if PLATFORM_WIN32
+if CROSS_COMPILING
+cur_dir_cmd = pwd
+PLATFORM_PATH_SEPARATOR = :
+else
 cur_dir_cmd = cygpath -w -a .
 PLATFORM_PATH_SEPARATOR = ;
+endif
 else
 cur_dir_cmd = pwd
 PLATFORM_PATH_SEPARATOR = :
Index: scripts/Makefile.am
===================================================================
--- scripts/Makefile.am	(revision 109357)
+++ scripts/Makefile.am	(working copy)
@@ -126,8 +126,13 @@
 endif
 
 if PLATFORM_WIN32
+if CROSS_COMPILING
+plat_bindir = $(bindir)
+mono_instdir = $(prefix)/lib/mono
+else
 plat_bindir = $(shell cygpath -m $(libdir))
 mono_instdir = $(shell cygpath -m $(libdir))/mono
+endif
 else
 plat_bindir = $(bindir)
 mono_instdir = $(prefix)/lib/mono
Index: build-mingw32.sh
===================================================================
--- build-mingw32.sh	(revision 0)
+++ build-mingw32.sh	(revision 0)
@@ -0,0 +1,72 @@
+#!/bin/bash -e
+CROSS_DIR=/opt/cross/
+MINGW=i386-mingw32msvc
+CROSS_PKG_CONFIG_DIR=$CROSS_DIR/$MINGW/lib/pkgconfig
+PATH=$CROSS_DIR/bin:$PATH
+
+export PATH
+
+if [ -d ./.git/svn ]; then
+    SVN_INFO='git svn info'
+elif [ -d ./.svn ]; then
+    SVN_INFO='svn info'
+else
+    SVN_INFO=""
+fi
+
+if [ -n "$SVN_INFO" ]; then
+    MONO_SVN_REVISION=`$SVN_INFO | grep Revision | sed 's/.*: //'`
+    MONO_BRANCH=`$SVN_INFO | grep URL | sed -e 's;.*source/;;g' -e 's;/mono;;g'`
+else
+    MONO_SVN_REVISION="rUNKNOWN"
+    MONO_BRANCH="tarball"
+fi
+
+MONO_VERSION=`grep AM_INIT_AUTOMAKE configure.in | cut -d ',' -f 2|tr -d '\)'`
+MONO_PREFIX="/mono-${MONO_VERSION}-${MONO_BRANCH}-r${MONO_SVN_REVISION}"
+
+echo Mono Win32 installation prefix: $MONO_PREFIX
+NOCONFIGURE=yes
+export NOCONFIGURE
+./autogen.sh 
+
+if [ -f ./Makefile ]; then
+    make distclean
+fi
+
+if [ ! -d build-cross-windows ]; then
+    mkdir build-cross-windows
+fi
+
+cd build-cross-windows
+rm -rf *
+../configure --prefix=$MONO_PREFIX --with-crosspkgdir=$CROSS_PKG_CONFIG_DIR --target=$MINGW --host=$MINGW --enable-parallel-mark --program-transform-name=""
+make
+mkdir -p mono-win32
+rm -rf mono-win32/*
+make DESTDIR=`pwd`/mono-win32 install
+cd ..
+
+if [ ! -d build-cross-windows-mcs ]; then
+    mkdir build-cross-windows-mcs
+fi
+cd build-cross-windows-mcs
+rm -rf *
+../configure --prefix=$MONO_PREFIX --enable-parallel-mark
+make
+
+PROFILES="PROFILE=net_2_0 PROFILE=net_2_1 PROFILE=net_3_5"
+cd build-cross-windows-mcs
+INSTALL_DESTDIR="`pwd`/../build-cross-windows/mono-win32"
+cd ../../mcs/mcs
+
+for p in $PROFILES; do
+make DESTDIR="$INSTALL_DESTDIR" $p install
+done
+
+cd ../class
+for p in $PROFILES; do
+make DESTDIR="$INSTALL_DESTDIR" $p install
+done
+
+cd ../../mono

Property changes on: build-mingw32.sh
___________________________________________________________________
Added: svn:executable
   + *
Added: svn:eol-style
   + native

Index: mono/metadata/Makefile.am
===================================================================
--- mono/metadata/Makefile.am	(revision 109357)
+++ mono/metadata/Makefile.am	(working copy)
@@ -2,8 +2,13 @@
 # Use -m here. This will use / as directory separator (C:/WINNT).
 # The files that use MONO_ASSEMBLIES and/or MONO_CFG_DIR replace the
 # / by \ if running under WIN32.
+if CROSS_COMPILING
+assembliesdir = ${libdir}
+confdir = ${sysconfdir}
+else
 assembliesdir = `cygpath -m "${libdir}"`
 confdir = `cygpath -m "${sysconfdir}"`
+endif
 export HOST_CC
 # The mingw math.h has "extern inline" functions that dont appear in libs, so
 # optimisation is required to actually inline them
Index: configure.in
===================================================================
--- configure.in	(revision 109357)
+++ configure.in	(working copy)
@@ -77,8 +77,8 @@
 		HOST_CC="gcc"
 		# Windows 2000 is required that includes Internet Explorer 5.01
 		CPPFLAGS="$CPPFLAGS -DWINVER=0x0500 -D_WIN32_WINNT=0x0500 -D_WIN32_IE=0x0501 -D_UNICODE -DUNICODE -DWIN32_THREADS -DFD_SETSIZE=1024"
-		libmono_cflags="-mno-cygwin"
-		libmono_ldflags="-mno-cygwin"
+		libmono_cflags="-mno-cygwin -mms-bitfields -mwindows"
+		libmono_ldflags="-mno-cygwin -mms-bitfields -mwindows"
 		libdl=
 		libgc_threads=win32
 		gc_default=included
@@ -491,9 +491,13 @@
   AC_CONFIG_SUBDIRS(eglib)
   ;;
 system)
+  pkg_config_path="$PKG_CONFIG_PATH"
+  unset PKG_CONFIG_PATH
   BUILD_GLIB_CFLAGS=`$PKG_CONFIG --cflags glib-2.0 gthread-2.0`
   BUILD_GLIB_LIBS=`$PKG_CONFIG --libs glib-2.0 gthread-2.0`
-
+  PKG_CONFIG_PATH=$pkg_config_path
+  export PKG_CONFIG_PATH
+  
   ## Versions of dependencies
   GLIB_REQUIRED_VERSION=1.3.11
   
@@ -2175,7 +2179,11 @@
 
 mono_cfg_root=$mono_build_root/runtime
 if test x$platform_win32 = xyes; then
-  mono_cfg_dir=`cygpath -w -a $mono_cfg_root`\\etc
+  if test "x$cross_compiling" = "xno"; then
+    mono_cfg_dir=`cygpath -w -a $mono_cfg_root`\\etc
+  else
+    mono_cfg_dir=`echo $mono_cfg_root | tr '/' '\\\'`\\etc
+  fi
 else
   mono_cfg_dir=$mono_cfg_root/etc
 fi
