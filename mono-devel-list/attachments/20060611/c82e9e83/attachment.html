<tt>
I&nbsp;am&nbsp;working&nbsp;on&nbsp;exception&nbsp;handler&nbsp;translation&nbsp;for&nbsp;JaCIL&nbsp;(CLI&nbsp;to&nbsp;JVM&nbsp;byte-code&nbsp;compiler)&nbsp;so&nbsp;I've&nbsp;been&nbsp;writing&nbsp;some&nbsp;sample&nbsp;cases&nbsp;in&nbsp;CIL&nbsp;to&nbsp;better&nbsp;understand&nbsp;the&nbsp;handler&nbsp;semantics&nbsp;in&nbsp;the&nbsp;CLI.&amp;nbsp;&nbsp;When&nbsp;running&nbsp;up&nbsp;this&nbsp;CIL&nbsp;code&nbsp;in&nbsp;Mono&nbsp;<br>
&lt;a&nbsp;href=&quot;http://1.1.13.6&quot;&gt;1.1.13.6&lt;/a&gt;,&nbsp;the&nbsp;run&nbsp;time&nbsp;aborted&nbsp;on&nbsp;an&nbsp;assertion&nbsp;error.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;margin-left:&nbsp;40px;&quot;&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;T_START:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ldstr&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;Start&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;call&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;[mscorlib]System.Console::WriteLine(string)<br>
&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;leave.s&nbsp;COMPLETE&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;T1_END:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;nop&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;T2_END:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;COMPLETE:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ret&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;F1_START:<br>
&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ldstr&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;Finally1&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;call&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;[mscorlib]System.Console::WriteLine(string)&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;endfinally&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;F1_END:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;F2_START:<br>
&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ldstr&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;Finally2&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;call&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;[mscorlib]System.Console::WriteLine(string)&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;endfinally&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;F2_END:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;.try&nbsp;T_START&nbsp;to&nbsp;T1_END&nbsp;finally&nbsp;handler&nbsp;F1_START&nbsp;to&nbsp;F1_END<br>
&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;.try&nbsp;T_START&nbsp;to&nbsp;T2_END&nbsp;finally&nbsp;handler&nbsp;F2_START&nbsp;to&nbsp;F2_END&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;The&nbsp;error&nbsp;returned&nbsp;when&nbsp;trying&nbsp;to&nbsp;execute&nbsp;this&nbsp;code&nbsp;in&nbsp;Mono&nbsp;is:<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;margin-left:&nbsp;40px;&quot;&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;$&nbsp;mono&nbsp;sample.exe&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;**&nbsp;ERROR&nbsp;**:&nbsp;file&nbsp;mini.c:&nbsp;line&nbsp;9517&nbsp;(mini_method_compile):&nbsp;assertion&nbsp;failed:&nbsp;(tblock-&amp;gt;native_offset)&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
aborting...&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;Aborted&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;If&nbsp;I&nbsp;move&nbsp;the&nbsp;method&nbsp;return&nbsp;and&nbsp;its&nbsp;label&nbsp;past&nbsp;the&nbsp;last&nbsp;finally&nbsp;handler&nbsp;the&nbsp;above&nbsp;code&nbsp;works&nbsp;(probably&nbsp;how&nbsp;most&nbsp;compilers&nbsp;would&nbsp;probably&nbsp;generate&nbsp;this&nbsp;type&nbsp;of&nbsp;code).&amp;nbsp;&nbsp;From&nbsp;what&nbsp;I&nbsp;understand&nbsp;of&nbsp;ECMA-335,&nbsp;it&nbsp;is&nbsp;legitimate&nbsp;to&nbsp;have&nbsp;this&nbsp;case,&nbsp;and&nbsp;it&nbsp;indeed&nbsp;works&nbsp;in&nbsp;.NET&nbsp;Framework&nbsp;and&nbsp;Portable&nbsp;.NET&nbsp;as&nbsp;shown&nbsp;below:<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;margin-left:&nbsp;40px;&nbsp;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;D:\tmp&amp;gt;&nbsp;sample.exe&lt;br&gt;Start&lt;br&gt;Finally1&lt;br&gt;Finally2&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;br&gt;I&nbsp;could&nbsp;be&nbsp;missing&nbsp;something&nbsp;in&nbsp;ECMA-335&nbsp;(which&nbsp;has&nbsp;parts&nbsp;of&nbsp;the&nbsp;handler&nbsp;spec&nbsp;in&nbsp;Partitions&nbsp;I,&nbsp;II,&nbsp;and&nbsp;III&nbsp;making&nbsp;more&nbsp;room&nbsp;for&nbsp;confusion)&nbsp;and&nbsp;PNet&nbsp;and&nbsp;.NET&nbsp;Framework&nbsp;are&nbsp;just&nbsp;simply&nbsp;lax&nbsp;in&nbsp;this&nbsp;regard.&amp;nbsp;&nbsp;This&nbsp;is&nbsp;certainly&nbsp;not&nbsp;a&nbsp;show&nbsp;stopper&nbsp;for&nbsp;my&nbsp;work,&nbsp;but&nbsp;I&nbsp;was&nbsp;wondering&nbsp;if&nbsp;anyone&nbsp;else&nbsp;has&nbsp;run&nbsp;into&nbsp;anything&nbsp;similar&nbsp;on&nbsp;Mono&nbsp;with&nbsp;regard&nbsp;to&nbsp;exception&nbsp;handlers.<br>
&lt;br&gt;&lt;br&gt;Best&nbsp;regards,&lt;br&gt;Almann&lt;br&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Almann&nbsp;T.&nbsp;Goo&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:almann.goo@gmail.com&quot;&gt;almann.goo@gmail.com&lt;/a&gt;<br>

</tt>
