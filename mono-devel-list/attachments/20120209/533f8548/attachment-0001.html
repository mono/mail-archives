<tt>
Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;every&nbsp;testcase&nbsp;which&nbsp;fails,&nbsp;could&nbsp;you&nbsp;create&nbsp;a&nbsp;bug&nbsp;report&nbsp;on&nbsp;&lt;a&nbsp;href=&quot;http://bugzilla.xamarin.com&quot;&gt;http://bugzilla.xamarin.com&lt;/a&gt;,&nbsp;attach&nbsp;the&nbsp;testcase&nbsp;and&nbsp;assign&nbsp;it&nbsp;to&nbsp;&quot;&lt;a&nbsp;href=&quot;mailto:alan@xamarin.com&quot;&gt;alan@xamarin.com&lt;/a&gt;&quot;.&nbsp;I&nbsp;will&nbsp;look&nbsp;at&nbsp;them&nbsp;when&nbsp;I&nbsp;get&nbsp;a&nbsp;chance&nbsp;and&nbsp;fix&nbsp;the&nbsp;underlying&nbsp;issues&nbsp;where&nbsp;possible.&nbsp;If&nbsp;you&nbsp;could&nbsp;also&nbsp;attach&nbsp;the&nbsp;resulting&nbsp;&#39;out.zip&#39;&nbsp;created&nbsp;from&nbsp;the&nbsp;microsoft&nbsp;framework,&nbsp;that&nbsp;would&nbsp;make&nbsp;it&nbsp;faster&nbsp;for&nbsp;me&nbsp;to&nbsp;ensure&nbsp;things&nbsp;are&nbsp;generated&nbsp;correctly.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;Alan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;9&nbsp;February&nbsp;2012&nbsp;13:03,&nbsp;CikaPero1&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:cika.pero1@gmail.com&quot;&gt;cika.pero1@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
Does&nbsp;anyone&nbsp;know&nbsp;why&nbsp;the&nbsp;code&nbsp;below&nbsp;throws&nbsp;an&nbsp;exception?&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;code&nbsp;below&nbsp;works&nbsp;with&nbsp;MS&nbsp;Visual&nbsp;Studio&nbsp;but&nbsp;simply&nbsp;won&#39;t&nbsp;work&nbsp;with&nbsp;Mono&lt;br&gt;<br>
2.8.&lt;br&gt;<br>
&lt;br&gt;<br>
using&nbsp;System;&lt;br&gt;<br>
using&nbsp;System.IO;&lt;br&gt;<br>
using&nbsp;System.IO.Packaging;&lt;br&gt;<br>
using&nbsp;System.Text;&lt;br&gt;<br>
using&nbsp;System.Xml;&lt;br&gt;<br>
&lt;br&gt;<br>
namespace&nbsp;ConsoleApplication&lt;br&gt;<br>
{&lt;br&gt;<br>
&nbsp; &nbsp; class&nbsp;Program&lt;br&gt;<br>
&nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; static&nbsp;void&nbsp;Main(string[]&nbsp;args)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using&nbsp;(Package&nbsp;Package&nbsp;=&nbsp;Package.Open(&quot;out.zip&quot;,&lt;br&gt;<br>
FileMode.Create))&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Uri&nbsp;partUri&nbsp;=&nbsp;new&nbsp;Uri(&quot;/_rels/.rels&quot;,&nbsp;UriKind.Relative);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PackagePart&nbsp;packagePart&nbsp;=&nbsp;Package.CreatePart(partUri,&lt;br&gt;<br>
&quot;application/vnd.openxmlformats-package.relationships+xml&quot;);&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using&nbsp;(Stream&nbsp;str&nbsp;=&nbsp;packagePart.GetStream())&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using&nbsp;(var&nbsp;writer&nbsp;=&nbsp;new&nbsp;XmlTextWriter(str,&nbsp;new&lt;br&gt;<br>
UTF8Encoding(false)))&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writer.WriteStartDocument(true);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writer.WriteStartElement(&quot;Relationships&quot;);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writer.WriteAttributeString(&quot;xmlns&quot;,&lt;br&gt;<br>
&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2006/relationships&lt;/a&gt;&quot;);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writer.WriteStartElement(&quot;Relationship&quot;);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writer.WriteAttributeString(&quot;Type&quot;,&lt;br&gt;<br>
&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties&lt;/a&gt;&quot;);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writer.WriteEndElement();&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; writer.WriteEndElement();&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
&nbsp; &nbsp; }&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
Strangely,&nbsp;it&nbsp;works&nbsp;when&nbsp;I&nbsp;change&nbsp;some&nbsp;strings:&lt;br&gt;<br>
a)&nbsp;&quot;/_rels/.rels&quot;&nbsp;-&gt;&nbsp;&quot;/rels/.rels&quot;&lt;br&gt;<br>
b)&nbsp;or&nbsp;&quot;xmlns&quot;&nbsp;-&gt;&nbsp;&quot;x&quot;&lt;br&gt;<br>
c)&nbsp;or&nbsp;&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2006/relationships&lt;/a&gt;&quot;&nbsp;-&gt;&lt;br&gt;<br>
&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2007/relationships&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2007/relationships&lt;/a&gt;&quot;&lt;br&gt;<br>
d)&nbsp;or&nbsp;&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2006/relationships&lt;/a&gt;&quot;&nbsp;-&gt;&lt;br&gt;<br>
&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2007/relationships&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2007/relationships&lt;/a&gt;&quot;&nbsp;and&lt;br&gt;<br>
&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties&lt;/a&gt;&quot;&lt;br&gt;<br>
-&gt;&lt;br&gt;<br>
&quot;&lt;a&nbsp;href=&quot;http://schemas.openxmlformats.org/package/2007/relationships/metadata/core-properties&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schemas.openxmlformats.org/package/2007/relationships/metadata/core-properties&lt;/a&gt;&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;will&nbsp;bring&nbsp;me&nbsp;to&nbsp;insanity!&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;for&nbsp;any&nbsp;help,&lt;br&gt;<br>
Cika&nbsp;Pero&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/System-IO-Packaging-throws-NullReferenceExeption-tp4372735p4372735.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://mono.1490590.n4.nabble.com/System-IO-Packaging-throws-NullReferenceExeption-tp4372735p4372735.html&lt;/a&gt;&lt;br&gt;<br>
<br>
Sent&nbsp;from&nbsp;the&nbsp;Mono&nbsp;-&nbsp;Dev&nbsp;mailing&nbsp;list&nbsp;archive&nbsp;at&nbsp;Nabble.com.&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
