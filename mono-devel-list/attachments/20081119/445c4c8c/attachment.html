<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Nov&nbsp;19,&nbsp;2008&nbsp;at&nbsp;4:23&nbsp;PM,&nbsp;crashfourit&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:crashfourit@gmail.com&quot;&gt;crashfourit@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;have&nbsp;the&nbsp;vector*&nbsp;have&nbsp;a&nbsp;constructor&nbsp;that&nbsp;takes&nbsp;in&nbsp;only&lt;br&gt;<br>
one&nbsp;argument&nbsp;and&nbsp;fills&nbsp;all&nbsp;spots&nbsp;in&nbsp;the&nbsp;vector*&nbsp;with&nbsp;the&nbsp;same&nbsp;value.&nbsp;Like...&lt;br&gt;<br>
Vector4f&nbsp;vector&nbsp;=&nbsp;new&nbsp;Vector4f(1);&lt;br&gt;<br>
&lt;br&gt;<br>
Second...&nbsp;I&nbsp;can&nbsp;really&nbsp;see&nbsp;someone&nbsp;doing&nbsp;this&nbsp;to&nbsp;use&nbsp;mono.simd&nbsp;in&nbsp;already&lt;br&gt;<br>
established&nbsp;code&nbsp;base.&lt;br&gt;<br>
&lt;br&gt;<br>
[StructLayout(&nbsp;LayoutKind.Sequential,&nbsp;Pack&nbsp;=&nbsp;0,&nbsp;Size&nbsp;=&nbsp;16&nbsp;)]&lt;br&gt;<br>
class&nbsp;Vector4&nbsp;{&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;/*&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;some&nbsp;user&nbsp;defined&nbsp;vector&nbsp;methods.&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;..........&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;*/&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;private&nbsp;static&nbsp;explicit&nbsp;operator&nbsp;Vector4f(Vector4&nbsp;v){&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;unsafe&nbsp;{&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Vector4f*&nbsp;p&nbsp;=&nbsp;(Vector4f*)&nbsp;&amp;amp;v;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;return&nbsp;*p;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;private&nbsp;static&nbsp;explicit&nbsp;operator&nbsp;Vector4(Vector4f&nbsp;v){&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;unsafe&nbsp;{&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Vector4*&nbsp;p&nbsp;=&nbsp;(Vector4*)&nbsp;&amp;amp;v;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;return&nbsp;*p;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;accelerate&nbsp;these&nbsp;user&nbsp;defined&nbsp;operator&nbsp;overloads?&nbsp;Or&nbsp;do&nbsp;I&lt;br&gt;<br>
have&nbsp;to&nbsp;resort&nbsp;to&nbsp;C#&nbsp;style&nbsp;unions?&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;--&lt;br&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;This&nbsp;code&nbsp;will&nbsp;be&nbsp;inlined&nbsp;and&nbsp;work&nbsp;like&nbsp;a&nbsp;charm.&nbsp;But&nbsp;I&nbsp;recommend&nbsp;coding&nbsp;it&nbsp;in&nbsp;the&nbsp;following&nbsp;way&nbsp;to&lt;br&gt;squeeze&nbsp;the&nbsp;maximum&amp;nbsp;&nbsp;performance&nbsp;out&nbsp;of&nbsp;it:&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;static&nbsp;unsafe&nbsp;Vector4f&nbsp;AsVector(ref&nbsp;Vector4&nbsp;v){&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;fixed&nbsp;(Vector4&nbsp;*f&nbsp;=&nbsp;&amp;amp;v)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;return&nbsp;*(Vector4f*)f;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;This&nbsp;will&nbsp;avoid&nbsp;the&nbsp;extra&nbsp;copy&nbsp;of&nbsp;passing&nbsp;the&nbsp;valuetype&nbsp;by&nbsp;value&nbsp;on&nbsp;stack&nbsp;and&nbsp;will&nbsp;inline&nbsp;straight&nbsp;to&nbsp;a&nbsp;load&nbsp;from&nbsp;the&lt;br&gt;<br>
load/array&nbsp;element&nbsp;to&nbsp;a&nbsp;simd&nbsp;machine&nbsp;register.&nbsp;Pretty&nbsp;cool,&nbsp;isn&amp;#39;t&nbsp;it?&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
