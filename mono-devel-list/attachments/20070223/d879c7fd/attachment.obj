Index: build/common/Consts.vb.in
===================================================================
--- build/common/Consts.vb.in	(revision 0)
+++ build/common/Consts.vb.in	(revision 0)
@@ -0,0 +1,69 @@
+'
+' Consts.vb.in
+'
+' Author:
+'   Kornél Pál <http://www.kornelpal.hu/>
+'
+' Copyright (C) 2007 Kornél Pál
+'
+
+'
+' Permission is hereby granted, free of charge, to any person obtaining
+' a copy of this software and associated documentation files (the
+' "Software"), to deal in the Software without restriction, including
+' without limitation the rights to use, copy, modify, merge, publish,
+' distribute, sublicense, and/or sell copies of the Software, and to
+' permit persons to whom the Software is furnished to do so, subject to
+' the following conditions:
+'
+' The above copyright notice and this permission notice shall be
+' included in all copies or substantial portions of the Software.
+'
+' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+' EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+' MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+' NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
+' LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
+' OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
+' WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+'
+
+Friend Module Consts
+    '
+    ' Use these assembly version constants to make code more maintainable.
+    '
+
+    Public Const MonoBasicVersion As String = "@MONO_BASIC_VERSION@"
+
+#If NET_2_0 Then
+    ' Versions of .NET Framework 2.0 RTM
+    Public Const FxVersion As String = "2.0.0.0"
+    Public Const VsVersion As String = "8.0.0.0"
+    Public Const FxFileVersion As String = "2.0.50727.42"
+    Public Const VsFileVersion As String = "8.0.50727.42"
+    Public Const ScriptEngineMajorVersion As Integer = 8
+    Public Const ScriptEngineMinorVersion As Integer = 0
+    Public Const ScriptEngineBuildVersion As Integer = 50727
+#ElseIf NET_1_1 Then
+    ' Versions of .NET Framework 1.1 SP1
+    Public Const FxVersion As String = "1.0.5000.0"
+    Public Const VsVersion As String = "7.0.5000.0"
+    Public Const FxFileVersion As String = "1.1.4322.2032"
+    Public Const VsFileVersion As String = "7.10.6001.4"
+    Public Const ScriptEngineMajorVersion As Integer = 7
+    Public Const ScriptEngineMinorVersion As Integer = 10
+    Public Const ScriptEngineBuildVersion As Integer = 0
+#ElseIf NET_1_0 Then
+    ' Versions of .NET Framework 1.0 SP3
+    Public Const FxVersion As String = "1.0.3300.0"
+    Public Const VsVersion As String = "7.0.3300.0"
+    Public Const FxFileVersion As String = "1.0.3705.6018"
+    Public Const VsFileVersion As String = "7.0.9951.0"
+    Public Const ScriptEngineMajorVersion As Integer = 7
+    Public Const ScriptEngineMinorVersion As Integer = 0
+    Public Const ScriptEngineBuildVersion As Integer = 0
+#Else
+' Invalid but causes compilation error
+#Error No profile symbols defined.
+#End If
+End Module

Property changes on: build\common\Consts.vb.in
___________________________________________________________________
Name: svn:eol-style
   + native

Index: build/Makefile
===================================================================
--- build/Makefile	(revision 73358)
+++ build/Makefile	(working copy)
@@ -2,21 +2,31 @@
 SUBDIRS = 
 include ../build/rules.make
 
+BUILT_FILES = common/Consts.vb
+
 all-local install-local test-local run-test-local run-test-ondotnet-local uninstall-local: $(BUILT_FILES)
 	@:
 
 clean-local:
 	-rm -f $(BUILT_FILES) deps/*
 
+common/Consts.vb: common/Consts.vb.in $(wildcard config.make)
+	test -n '$(MONO_BASIC_VERSION)'
+	sed -e 's,@''MONO_BASIC_VERSION@,$(MONO_BASIC_VERSION),' $< > $@
+
 PLATFORMS = linux win32
 
 PROFILES = bootstrap vbnc
 
+COMMON_SRCS = \
+	Consts.vb.in
+
 DISTFILES = \
 	config-default.make		\
 	executable.make			\
 	library.make			\
 	rules.make			\
+	$(COMMON_SRCS:%=common/%)	\
 	$(PLATFORMS:%=platforms/%.make) $(PROFILES:%=profiles/%.make)
 
 dist-local: dist-default
Index: configure
===================================================================
--- configure	(revision 73358)
+++ configure	(working copy)
@@ -16,12 +16,19 @@
         shift
 done
 
+# Version number suitable for AssemblyVersion
+export VERSION
+MONO_BASIC_VERSION=$(awk 'BEGIN {
+  split (ENVIRON["VERSION"] ".0.0.0", vsplit, ".")
+  print vsplit [1] "." vsplit [2] "." vsplit [3] "." vsplit [4]
+}')
+
 echo "prefix=$prefix" > build/config.make
 echo "exec_prefix=\${prefix}" >> build/config.make
 echo "mono_libdir=\${exec_prefix}/lib" >> build/config.make
 echo "MCS_FLAGS=-debug+" >> build/config.make
 echo "RUNTIME=mono" >> build/config.make
-echo "MONO_BASIC_VERSION=$VERSION" >> build/config.make
-echo "VERSION :=$VERSION" >> build/config.make
+echo "VERSION=$VERSION" >> build/config.make
+echo "MONO_BASIC_VERSION=$MONO_BASIC_VERSION" >> build/config.make
 
 echo "mono-basic $VERSION module configure to use prefix=$prefix"
Index: vbnc/vbnc/source/vbnc.vbproj
===================================================================
--- vbnc/vbnc/source/vbnc.vbproj	(revision 73358)
+++ vbnc/vbnc/source/vbnc.vbproj	(working copy)
@@ -70,7 +70,7 @@
     <RunCodeAnalysis>false</RunCodeAnalysis>
     <CodeAnalysisRules>-Microsoft.Design#CA1012;-Microsoft.Design#CA2210;-Microsoft.Design#CA1040;-Microsoft.Design#CA1005;-Microsoft.Design#CA1020;-Microsoft.Design#CA1021;-Microsoft.Design#CA1010;-Microsoft.Design#CA1011;-Microsoft.Design#CA1009;-Microsoft.Design#CA1050;-Microsoft.Design#CA1026;-Microsoft.Design#CA1019;-Microsoft.Design#CA1031;-Microsoft.Design#CA1047;-Microsoft.Design#CA1000;-Microsoft.Design#CA1048;-Microsoft.Design#CA1051;-Microsoft.Design#CA1002;-Microsoft.Design#CA1061;-Microsoft.Design#CA1006;-Microsoft.Design#CA1046;-Microsoft.Design#CA1045;-Microsoft.Design#CA1038;-Microsoft.Design#CA1008;-Microsoft.Design#CA1028;-Microsoft.Design#CA1004;-Microsoft.Design#CA1035;-Microsoft.Design#CA1063;-Microsoft.Design#CA1032;-Microsoft.Design#CA1023;-Microsoft.Design#CA1033;-Microsoft.Design#CA1039;-Microsoft.Design#CA1016;-Microsoft.Design#CA1014;-Microsoft.Design#CA1017;-Microsoft.Design#CA1018;-Microsoft.Design#CA1027;-Microsoft.Design#CA1059;-Microsoft.Design#CA1060;-Microsoft.Design#CA1034;-Microsoft.Design#CA1013;-Microsoft.Design#CA1036;-Microsoft.Design#CA1044;-Microsoft.Design#CA1041;-Microsoft.Design#CA1025;-Microsoft.Design#CA1052;-Microsoft.Design#CA1053;-Microsoft.Design#CA1057;-Microsoft.Design#CA1058;-Microsoft.Design#CA1001;-Microsoft.Design#CA1049;-Microsoft.Design#CA1054;-Microsoft.Design#CA1056;-Microsoft.Design#CA1055;-Microsoft.Design#CA1030;-Microsoft.Design#CA1003;-Microsoft.Design#CA1007;-Microsoft.Design#CA1043;-Microsoft.Design#CA1024;-Microsoft.Design#CA1062;-Microsoft.Globalization#CA1301;-Microsoft.Globalization#CA1302;-Microsoft.Globalization#CA1303;-Microsoft.Globalization#CA1306;-Microsoft.Globalization#CA1304;-Microsoft.Globalization#CA1305;-Microsoft.Globalization#CA1300;-Microsoft.Interoperability#CA1403;-Microsoft.Interoperability#CA1406;-Microsoft.Interoperability#CA1413;-Microsoft.Interoperability#CA1402;-Microsoft.Interoperability#CA1407;-Microsoft.Interoperability#CA1404;-Microsoft.Interoperability#CA1410;-Microsoft.Interoperability#CA1411;-Microsoft.Interoperability#CA1405;-Microsoft.Interoperability#CA1409;-Microsoft.Interoperability#CA1415;-Microsoft.Interoperability#CA1408;-Microsoft.Interoperability#CA1414;-Microsoft.Interoperability#CA1412;-Microsoft.Interoperability#CA1400;-Microsoft.Interoperability#CA1401;-Microsoft.Maintainability#CA1502;-Microsoft.Maintainability#CA1501;-Microsoft.Maintainability#CA1500;-Microsoft.Mobility#CA1600;-Microsoft.Mobility#CA1601;-Microsoft.Naming#CA1718;-Microsoft.Naming#CA1720;-Microsoft.Naming#CA1700;-Microsoft.Naming#CA1712;-Microsoft.Naming#CA1713;-Microsoft.Naming#CA1709;-Microsoft.Naming#CA1708;-Microsoft.Naming#CA1715;-Microsoft.Naming#CA1710;-Microsoft.Naming#CA1707;-Microsoft.Naming#CA1722;-Microsoft.Naming#CA1711;-Microsoft.Naming#CA1716;-Microsoft.Naming#CA1705;-Microsoft.Naming#CA1725;-Microsoft.Naming#CA1719;-Microsoft.Naming#CA1721;-Microsoft.Naming#CA1706;-Microsoft.Naming#CA1724;-Microsoft.Naming#CA1726;-Microsoft.Performance#CA1809;-Microsoft.Performance#CA1811;-Microsoft.Performance#CA1812;-Microsoft.Performance#CA1807;-Microsoft.Performance#CA1813;-Microsoft.Performance#CA1823;-Microsoft.Performance#CA1816;-Microsoft.Performance#CA1817;-Microsoft.Performance#CA1800;-Microsoft.Performance#CA1818;-Microsoft.Performance#CA1805;-Microsoft.Performance#CA1810;-Microsoft.Performance#CA1822;-Microsoft.Performance#CA1815;-Microsoft.Performance#CA1814;-Microsoft.Performance#CA1819;-Microsoft.Performance#CA1804;-Microsoft.Performance#CA1820;-Microsoft.Performance#CA1802;-Microsoft.Portability#CA1901;-Microsoft.Portability#CA1900;-Microsoft.Reliability#CA2000;-Microsoft.Reliability#CA2002;-Microsoft.Reliability#CA2003;-Microsoft.Reliability#CA2004;-Microsoft.Reliability#CA2006;-Microsoft.Security#CA2116;-Microsoft.Security#CA2117;-Microsoft.Security#CA2105;-Microsoft.Security#CA2115;-Microsoft.Security#CA2104;-Microsoft.Security#CA2122;-Microsoft.Security#CA2114;-Microsoft.Security#CA2123;-Microsoft.Security#CA2111;-Microsoft.Security#CA2108;-Microsoft.Security#CA2107;-Microsoft.Security#CA2103;-Microsoft.Security#CA2100;-Microsoft.Security#CA2118;-Microsoft.Security#CA2109;-Microsoft.Security#CA2119;-Microsoft.Security#CA2106;-Microsoft.Security#CA2112;-Microsoft.Security#CA2110;-Microsoft.Security#CA2120;-Microsoft.Security#CA2101;-Microsoft.Security#CA2121;-Microsoft.Security#CA2126;-Microsoft.Security#CA2124;-Microsoft.Usage#CA2209;-Microsoft.Usage#CA2236;-Microsoft.Usage#CA2227;-Microsoft.Usage#CA2213;-Microsoft.Usage#CA2216;-Microsoft.Usage#CA2215;-Microsoft.Usage#CA2214;-Microsoft.Usage#CA2222;-Microsoft.Usage#CA2202;-Microsoft.Usage#CA1806;-Microsoft.Usage#CA2217;-Microsoft.Usage#CA2212;-Microsoft.Usage#CA2219;-Microsoft.Usage#CA2201;-Microsoft.Usage#CA2228;-Microsoft.Usage#CA2221;-Microsoft.Usage#CA2220;-Microsoft.Usage#CA2240;-Microsoft.Usage#CA2229;-Microsoft.Usage#CA2238;-Microsoft.Usage#CA2207;-Microsoft.Usage#CA2208;-Microsoft.Usage#CA2235;-Microsoft.Usage#CA2237;-Microsoft.Usage#CA2232;-Microsoft.Usage#CA2223;-Microsoft.Usage#CA2211;-Microsoft.Usage#CA2233;-Microsoft.Usage#CA2225;-Microsoft.Usage#CA2226;-Microsoft.Usage#CA2231;-Microsoft.Usage#CA2224;-Microsoft.Usage#CA2218;-Microsoft.Usage#CA2234;-Microsoft.Usage#CA2241;-Microsoft.Usage#CA2239;-Microsoft.Usage#CA2200;-Microsoft.Usage#CA1801;-Microsoft.Usage#CA2205;-Microsoft.Usage#CA2230</CodeAnalysisRules>
     <UseVSHostingProcess>false</UseVSHostingProcess>
-    <DefineConstants>GENERATOR,DEVGENERATOR</DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0,GENERATOR,DEVGENERATOR</DefineConstants>
     <OutputType>Exe</OutputType>
     <AssemblyName>vbnc</AssemblyName>
     <RootNamespace>vbnc</RootNamespace>
@@ -84,8 +84,7 @@
     <BaseAddress>285212672</BaseAddress>
     <ConfigurationOverrideFile>
     </ConfigurationOverrideFile>
-    <DefineConstants>
-    </DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0</DefineConstants>
     <DefineDebug>false</DefineDebug>
     <DefineTrace>true</DefineTrace>
     <DebugSymbols>False</DebugSymbols>
@@ -112,7 +111,7 @@
     <WarningsAsErrors>42016,42017,42018,42019,42032,42020,42021,42022</WarningsAsErrors>
     <ConfigurationOverrideFile>
     </ConfigurationOverrideFile>
-    <DefineConstants>SELF=1</DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0,SELF=1</DefineConstants>
     <DefineDebug>true</DefineDebug>
     <DefineTrace>true</DefineTrace>
     <DebugSymbols>True</DebugSymbols>
@@ -148,8 +147,7 @@
     <FxCopInputAssembly>obj\Debug\vbnc.exe</FxCopInputAssembly>
     <ConfigurationOverrideFile>
     </ConfigurationOverrideFile>
-    <DefineConstants>
-    </DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0</DefineConstants>
     <GenerateSerializationAssemblies>Auto</GenerateSerializationAssemblies>
     <Optimize>False</Optimize>
     <RegisterForComInterop>false</RegisterForComInterop>
@@ -183,8 +181,7 @@
     <AllowUnsafeBlocks>False</AllowUnsafeBlocks>
     <Optimize>True</Optimize>
     <CheckForOverflowUnderflow>True</CheckForOverflowUnderflow>
-    <DefineConstants>
-    </DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0</DefineConstants>
     <WarningLevel>4</WarningLevel>
     <OptionExplicit>True</OptionExplicit>
     <OptionStrict>True</OptionStrict>
@@ -202,8 +199,7 @@
     <AllowUnsafeBlocks>False</AllowUnsafeBlocks>
     <Optimize>True</Optimize>
     <CheckForOverflowUnderflow>True</CheckForOverflowUnderflow>
-    <DefineConstants>
-    </DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0</DefineConstants>
     <WarningLevel>4</WarningLevel>
     <OptionExplicit>True</OptionExplicit>
     <OptionStrict>True</OptionStrict>
@@ -220,8 +216,7 @@
     <AllowUnsafeBlocks>False</AllowUnsafeBlocks>
     <Optimize>True</Optimize>
     <CheckForOverflowUnderflow>True</CheckForOverflowUnderflow>
-    <DefineConstants>
-    </DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0</DefineConstants>
     <WarningLevel>4</WarningLevel>
     <OptionExplicit>True</OptionExplicit>
     <OptionStrict>True</OptionStrict>
@@ -234,6 +229,9 @@
     <Import Include="VB=Microsoft.VisualBasic" />
   </ItemGroup>
   <ItemGroup>
+    <Compile Include="..\..\..\build\common\Consts.vb">
+      <Link>Consts.vb</Link>
+    </Compile>
     <Compile Include="..\tests\Generated\Constants.vb">
       <Link>AutoGen\Constants.vb</Link>
     </Compile>

Property changes on: vbnc\vbnc\source\vbnc.vbproj
___________________________________________________________________
Name: svn:eol-style
   + native

Index: vbnc/vbnc/source/General/AssemblyInfo.vb
===================================================================
--- vbnc/vbnc/source/General/AssemblyInfo.vb	(revision 73358)
+++ vbnc/vbnc/source/General/AssemblyInfo.vb	(working copy)
@@ -49,5 +49,5 @@
 ' You can specify all the values or you can default the Build and Revision Numbers 
 ' by using the '*' as shown below:
 
-<Assembly: AssemblyVersion("0.0.0.4809")> 
+<Assembly: AssemblyVersion(Consts.MonoBasicVersion)> 
 
Index: vbnc/vbnc/tests/VBRunTime/Microsoft.VisualBasic.response
===================================================================
--- vbnc/vbnc/tests/VBRunTime/Microsoft.VisualBasic.response	(revision 73358)
+++ vbnc/vbnc/tests/VBRunTime/Microsoft.VisualBasic.response	(working copy)
@@ -19,6 +19,6 @@
 
 #Non-general arguments
 -debug:full
--define:DEBUG=False,TRACE=false,NET_2_0=True,_MYTYPE=\"Empty\" 
+-define:DEBUG=False,TRACE=false,NET_1_1=True,NET_2_0=True,_MYTYPE=\"Empty\" 
 #-verbose
 -define:mono_disabled=true
Index: vbnc/vbnc/vbnc.exe.sources
===================================================================
--- vbnc/vbnc/vbnc.exe.sources	(revision 73358)
+++ vbnc/vbnc/vbnc.exe.sources	(working copy)
@@ -1,3 +1,4 @@
+../../build/common/Consts.vb
 source/../tests/Generated/Constants.vb
 source/../tests/Generated/Conversions.vb
 source/AutoGen/ZCompilerCodeGenerator.vb
Index: vbruntime/Microsoft.VisualBasic/2005VB.vbproj
===================================================================
--- vbruntime/Microsoft.VisualBasic/2005VB.vbproj	(revision 73358)
+++ vbruntime/Microsoft.VisualBasic/2005VB.vbproj	(working copy)
@@ -22,7 +22,7 @@
     <DocumentationFile>Microsoft.VisualBasic.xml</DocumentationFile>
     <NoWarn>
     </NoWarn>
-    <DefineConstants>NET_2_0=True,_MYTYPE="Empty",mono_not_yet=true,INDEVENV=true</DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0,_MYTYPE="Empty",mono_not_yet=true,INDEVENV=true</DefineConstants>
     <WarningsAsErrors>41999,42016,42017,42018,42019,42020,42021,42022,42032,42036</WarningsAsErrors>
     <OutputType>Exe</OutputType>
     <AssemblyName>Microsoft.VisualBasic</AssemblyName>
@@ -50,8 +50,7 @@
     <RootNamespace>dummy_root</RootNamespace>
     <AllowUnsafeBlocks>False</AllowUnsafeBlocks>
     <CheckForOverflowUnderflow>True</CheckForOverflowUnderflow>
-    <DefineConstants>
-    </DefineConstants>
+    <DefineConstants>NET_1_1,NET_2_0</DefineConstants>
     <WarningLevel>4</WarningLevel>
     <OptionExplicit>True</OptionExplicit>
     <OptionStrict>True</OptionStrict>
@@ -73,6 +72,9 @@
     <Import Include="System.Diagnostics" />
   </ItemGroup>
   <ItemGroup>
+    <Compile Include="..\..\build\common\Consts.vb">
+      <Link>Consts.vb</Link>
+    </Compile>
     <Compile Include="AssemblyInfo.vb" />
     <Compile Include="Helper.vb">
     </Compile>
@@ -240,4 +242,4 @@
   <Target Name="AfterBuild">
   </Target>
   -->
-</Project>
+</Project>
\ No newline at end of file
Index: vbruntime/Microsoft.VisualBasic/AssemblyInfo.vb
===================================================================
--- vbruntime/Microsoft.VisualBasic/AssemblyInfo.vb	(revision 73358)
+++ vbruntime/Microsoft.VisualBasic/AssemblyInfo.vb	(working copy)
@@ -29,52 +29,50 @@
 ' WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 '
 Imports System
+Imports System.Diagnostics
 Imports System.Reflection
+Imports System.Resources
 Imports System.Runtime.InteropServices
+Imports System.Security
 
-' General Information about an assembly is controlled through the following 
-' set of attributes. Change these attribute values to modify the information
-' associated with an assembly.
+<Assembly: AssemblyVersion(Consts.VsVersion)> 
 
-' Review the values of the assembly attributes
+<Assembly: NeutralResourcesLanguage("en-US")> 
+<Assembly: SatelliteContractVersion(Consts.VsVersion)> 
 
-<Assembly: AssemblyTitle("vbruntime")> 
-<Assembly: AssemblyDescription("")> 
-<Assembly: AssemblyCompany("Ximian")> 
-<Assembly: AssemblyProduct("vbruntime")> 
-<Assembly: AssemblyCopyright("Copyright © Ximian 2006")> 
-<Assembly: AssemblyTrademark("")> 
+<Assembly: AllowPartiallyTrustedCallers()> 
 
-<Assembly: ComVisible(False)>
+<Assembly: AssemblyCopyright("(C) 2006-2007 Novell, Inc and Contributors.")> 
+<Assembly: AssemblyCompany("Novell, Inc and Contributors")> 
 
 #If NET_2_0 Then
-'The following GUID is for the ID of the typelib if this project is exposed to COM
-<Assembly: Guid("aa353322-85a4-4601-a6b7-e3b724e9350c")> 
+<Assembly: AssemblyFileVersion(Consts.VsFileVersion)> 
+<Assembly: AssemblyInformationalVersion(Consts.VsFileVersion)>
+
+<Assembly: ComVisible(True)> 
+<Assembly: AssemblyDefaultAlias("Microsoft.VisualBasic.dll")>
+
+<Assembly: AssemblyTitle("Microsoft.VisualBasic.dll")>
+<Assembly: AssemblyDescription("Microsoft.VisualBasic.dll")>
+<Assembly: AssemblyProduct("Mono Basic")>
+#If Not DEBUG Then
+<Assembly: Debuggable((DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints Or DebuggableAttribute.DebuggingModes.Default))> 
+#End If
 #Else
-<Assembly: Guid("d5e192e2-301b-49b5-9b05-da883f937c84")> 
-<Assembly: CLSCompliant(True)> 
+<Assembly: AssemblyTitle("Mono Visual Basic Runtime")> 
+<Assembly: AssemblyDescription("Mono Visual Basic Runtime")> 
 #End If
 
-' Version information for an assembly consists of the following four values:
-'
-'      Major Version
-'      Minor Version 
-'      Build Number
-'      Revision
-'
-' You can specify all the values or you can default the Build and Revision Numbers 
-' by using the '*' as shown below:
-' <Assembly: AssemblyVersion("1.0.*")> 
+#If NET_1_1 And Not NET_2_0 Then
+<Assembly: ComCompatibleVersion(7, 0, 3300, 0)>
+<Assembly: TypeLibVersion(7, 1)>
+#End If
 
-#If NET_2_0 Then
-<Assembly: AssemblyVersion("8.0.0.0")> 
-#Else
-<Assembly: AssemblyVersion("7.0.5000.0")> 
+#If Not NET_1_1 Or NET_2_0 Then
+<Assembly: CLSCompliant(True)> 
 #End If
 
-<Assembly: AssemblyFileVersion("1.0.0.0")> 
 <Assembly: AssemblyDelaySign(True)> 
 #If TARGET_JVM = False And INDEVENV = False Then
 <Assembly: AssemblyKeyFile("msfinal.pub")> 
 #End If
-
Index: vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic.dll.sources.win
===================================================================
--- vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic.dll.sources.win	(revision 73358)
+++ vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic.dll.sources.win	(working copy)
@@ -1,3 +1,4 @@
+..\..\build\common\Consts.vb
 AssemblyInfo.vb
 Helper.vb
 Microsoft.VisualBasic.ApplicationServices\ApplicationBase.vb
Index: vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic.dll.sources
===================================================================
--- vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic.dll.sources	(revision 73358)
+++ vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic.dll.sources	(working copy)
@@ -1,3 +1,4 @@
+../../build/common/Consts.vb
 AssemblyInfo.vb
 Helper.vb
 Microsoft.VisualBasic.ApplicationServices/ApplicationBase.vb
Index: vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic/Globals.vb
===================================================================
--- vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic/Globals.vb	(revision 73358)
+++ vbruntime/Microsoft.VisualBasic/Microsoft.VisualBasic/Globals.vb	(working copy)
@@ -35,33 +35,20 @@
 
         Public ReadOnly Property ScriptEngineBuildVersion() As Integer
             Get
-#If NET_2_0 Then
-                Return 50727
-#Else
-                return 0
-#End If
+                Return Consts.ScriptEngineBuildVersion
             End Get
         End Property
 
         Public ReadOnly Property ScriptEngineMajorVersion() As Integer
             Get
-#If NET_2_0 Then
-                Return 8
-#Else
-                return 7
-#End If
+                Return Consts.ScriptEngineMajorVersion
             End Get
         End Property
 
         Public ReadOnly Property ScriptEngineMinorVersion() As Integer
             Get
-#If NET_2_0 Then
-                Return 0
-#Else
-                return 0
-#End If
+                Return Consts.ScriptEngineMinorVersion
             End Get
         End Property
     End Module
 End Namespace
-
Index: vbruntime/Microsoft.VisualBasic/vbruntime.rsp
===================================================================
--- vbruntime/Microsoft.VisualBasic/vbruntime.rsp	(revision 73358)
+++ vbruntime/Microsoft.VisualBasic/vbruntime.rsp	(working copy)
@@ -4,7 +4,7 @@
 /r:mscorlib.dll
 /r:System.dll,System.Windows.Forms.dll,System.Data.dll,System.Drawing.dll,System.Web.dll,System.Xml.dll
 /novbruntimeref
-/define:DEBUG=False,TRACE=false,NET_2_0=True,_MYTYPE=\"Empty\"
+/define:DEBUG=False,TRACE=false,NET_1_1=True,NET_2_0=True,_MYTYPE=\"Empty\"
 /errorreport:prompt
 /verbose
 /t:library
Index: vbruntime/VB.build.bat
===================================================================
--- vbruntime/VB.build.bat	(revision 73358)
+++ vbruntime/VB.build.bat	(working copy)
@@ -42,13 +42,13 @@
 
 :SETOPTIONS2
 SET VB_COMPILE_OPTIONS=/nowarn:42016,41999,42017,42018,42019,42032,42036,42020,42021,42022,40005 /errorreport:prompt /noconfig /imports:System.Collections,System.Diagnostics,System.Collections.Generic,System
-IF NOT %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=%VB_COMPILE_OPTIONS% /define:DEBUG=False,NET_2_0=True,_MYTYPE=\"Empty\"
-IF %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=%VB_COMPILE_OPTIONS% /debug:full /define:DEBUG=True,TRACE=False,NET_2_0=True,_MYTYPE=\"Empty\" /errorreport:prompt  -verbose
+IF NOT %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=%VB_COMPILE_OPTIONS% /define:DEBUG=False,NET_1_1=True,NET_2_0=True,_MYTYPE=\"Empty\"
+IF %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=%VB_COMPILE_OPTIONS% /debug:full /define:DEBUG=True,TRACE=False,NET_1_1=True,NET_2_0=True,_MYTYPE=\"Empty\" /errorreport:prompt  -verbose
 GOTO ENDSETOPTIONS
 
 :SETOPTIONS1
-IF NOT %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=/define:DEBUG=False
-IF %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=/debug:full /define:DEBUG=True,TRACE=True 
+IF NOT %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=/define:DEBUG=False,NET_1_1=True
+IF %VB_BUILD_PARAM_CONFIGURATION%=="debug" SET VB_COMPILE_OPTIONS=/debug:full /define:DEBUG=True,TRACE=True,NET_1_1=True
 GOTO ENDSETOPTIONS
 
 echo %VB_COMPILE_OPTIONS%
Index: vbruntime/2003VB.vbproj
===================================================================
--- vbruntime/2003VB.vbproj	(revision 73358)
+++ vbruntime/2003VB.vbproj	(working copy)
@@ -27,7 +27,7 @@
                     Name = "Debug"
                     BaseAddress = "285212672"
                     ConfigurationOverrideFile = ""
-                    DefineConstants = ""
+                    DefineConstants = "NET_1_1"
                     DefineDebug = "true"
                     DefineTrace = "true"
                     DebugSymbols = "true"
@@ -43,7 +43,7 @@
                     Name = "Release"
                     BaseAddress = "285212672"
                     ConfigurationOverrideFile = ""
-                    DefineConstants = ""
+                    DefineConstants = "NET_1_1"
                     DefineDebug = "false"
                     DefineTrace = "true"
                     DebugSymbols = "false"
@@ -81,6 +81,12 @@
         <Files>
             <Include>
                 <File
+                    RelPath = "Consts.vb"
+                    Link = "..\build\common\Consts.vb"
+                    SubType = "Code"
+                    BuildAction = "Compile"
+                />
+                <File
                     RelPath = "msfinal.pub"
                     BuildAction = "None"
                 />
