Index: Test/System.Xml.Schema/XmlSchemaTests.cs
===================================================================
--- Test/System.Xml.Schema/XmlSchemaTests.cs	(revision 103415)
+++ Test/System.Xml.Schema/XmlSchemaTests.cs	(working copy)
@@ -9,6 +9,7 @@
 
 using System;
 using System.IO;
+using System.Net;
 using System.Xml;
 using System.Xml.Schema;
 using System.Xml.Serialization;
@@ -16,6 +17,29 @@
 
 namespace MonoTests.System.Xml
 {
+	public class XmlTestResolver : XmlResolver
+	{
+		const string schemaUri = "asembly://MyAssembly.Name/MyProjectNameSpace/objects.xsd";
+
+		public override ICredentials Credentials
+		{
+		    set { throw new NotSupportedException (); }
+		}
+
+		public override Uri ResolveUri (Uri baseUri, string relativeUri)
+		{
+		    if (relativeUri != schemaUri)
+		        throw new ApplicationException (string.Format ("Incorrect Uri returned! Got {0}, expected {1}", relativeUri, schemaUri));            
+
+		    return new Uri (relativeUri);
+		}
+
+		public override object GetEntity (Uri absoluteUri, string role, Type ofObjectToReturn)
+		{
+		    throw new NotSupportedException ();
+		}
+	}	
+	
 	[TestFixture]
 	public class XmlSchemaTests : XmlSchemaAssertion
 	{
@@ -418,5 +442,23 @@
 				r.Close ();
 			}
 		}
+		
+#if NET_2_0
+		[Test]
+		[ExpectedException (typeof (XmlSchemaValidationException))]
+		public void TestResolveUri ()
+		{
+			XmlSchemaSet schemaSet = new XmlSchemaSet ();
+			schemaSet.Add ("http://tempuri.org/resolveUriSchema.xsd", new XmlTextReader ("Test/XmlFiles/xsd/resolveUriSchema.xsd"));
+
+			XmlReaderSettings settings = new XmlReaderSettings ();
+			settings.Schemas = schemaSet;
+			settings.Schemas.XmlResolver = new XmlResourceResolver ();
+			settings.ValidationType = ValidationType.Schema;
+			settings.ValidationFlags = XmlSchemaValidationFlags.ProcessInlineSchema | XmlSchemaValidationFlags.ProcessSchemaLocation;
+
+			XmlReader.Create (stream, settings);
+		}
+#endif
 	}
 }
Index: System.Xml.Schema/ChangeLog
===================================================================
--- System.Xml.Schema/ChangeLog	(revision 103415)
+++ System.Xml.Schema/ChangeLog	(working copy)
@@ -1,3 +1,8 @@
+2008-05-18  James Fitzsimons <james.fitzsimons@gmail.com>
+
+	* XmlSchema.cs : Changed GetResolvedUri to return Uri in correct case
+	  to make compatible with the Microsoft.NET framework.
+	  
 2008-02-19  Atsushi Enomoto <atsushi@ximian.com>
 
 	* XmlSchema.cs : Do recursively process xs:include inside included
Index: System.Xml.Schema/XmlSchema.cs
===================================================================
--- System.Xml.Schema/XmlSchema.cs	(revision 103415)
+++ System.Xml.Schema/XmlSchema.cs	(working copy)
@@ -469,7 +469,11 @@
 			if (this.SourceUri != null && this.SourceUri != String.Empty)
 				baseUri = new Uri (this.SourceUri);
 			Uri abs = resolver.ResolveUri (baseUri, relativeUri);
+#if NET_2_0
+			return abs != null ? abs.OriginalString : String.Empty;
+#else
 			return abs != null ? abs.ToString () : String.Empty;
+#endif
 		}
 
 		void ProcessExternal (ValidationEventHandler handler, Hashtable handledUris, XmlResolver resolver, XmlSchemaExternal ext)