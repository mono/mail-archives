<tt>
Sorry,&lt;br&gt;&lt;br&gt;Forgot&nbsp;to&nbsp;add&nbsp;this&nbsp;is&nbsp;with&nbsp;&lt;a&nbsp;href=&quot;http://MS.NET&quot;&gt;MS.NET&lt;/a&gt;&nbsp;(so&nbsp;csc).&lt;br&gt;&lt;br&gt;Alan&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;1/28/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Alan&nbsp;McGovern&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:alan.mcgovern@gmail.com&quot;&gt;<br>
alan.mcgovern@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Hi,&lt;br&gt;&lt;br&gt;While&nbsp;NUniting&nbsp;for&nbsp;Mono.XNA&nbsp;i&nbsp;came&nbsp;across&nbsp;a&nbsp;problem&nbsp;i&nbsp;have&nbsp;no&nbsp;real&nbsp;idea&nbsp;how&nbsp;to&nbsp;fix.&nbsp;The&nbsp;problem&nbsp;appears&nbsp;when&nbsp;i&nbsp;compile&nbsp;in&nbsp;&amp;quot;Release&amp;quot;&nbsp;mode&nbsp;with&nbsp;optimisations&nbsp;enabled.&nbsp;For&nbsp;example,&nbsp;when&nbsp;i&nbsp;coded&nbsp;a&nbsp;method&nbsp;which&nbsp;calculates&nbsp;the&nbsp;8&nbsp;corners&nbsp;of&nbsp;a&nbsp;cube&nbsp;when&nbsp;given&nbsp;the&nbsp;6&nbsp;sides&nbsp;of&nbsp;the&nbsp;cube,&nbsp;i&nbsp;get&nbsp;completely&nbsp;different&nbsp;answers&nbsp;as&nbsp;my&nbsp;result&nbsp;when&nbsp;i&nbsp;compile&nbsp;in&nbsp;release&nbsp;as&nbsp;opposed&nbsp;to&nbsp;debug.<br>
&lt;br&gt;&lt;br&gt;What&nbsp;i&nbsp;assume&nbsp;is&nbsp;happening&nbsp;is&nbsp;that&nbsp;the&nbsp;math&nbsp;routines&nbsp;are&nbsp;being&nbsp;optimised,&nbsp;which&nbsp;is&nbsp;resulting&nbsp;in&nbsp;the&nbsp;floating&nbsp;point&nbsp;multiplications&nbsp;and&nbsp;divisions&nbsp;being&nbsp;moved&nbsp;around&nbsp;thus&nbsp;making&nbsp;the&nbsp;calculation&nbsp;more&nbsp;inaccurate.&nbsp;From&nbsp;my&nbsp;NUnit&nbsp;tests&nbsp;debug&nbsp;mode&nbsp;gives&nbsp;me&nbsp;a&nbsp;result&nbsp;of&nbsp;~0.19&nbsp;whereas&nbsp;Release&nbsp;mode&nbsp;would&nbsp;give&nbsp;a&nbsp;result&nbsp;of&nbsp;<br>
0.125.&nbsp;That&amp;#39;s&nbsp;a&nbsp;30%&nbsp;difference!&lt;br&gt;&lt;br&gt;Does&nbsp;anyone&nbsp;have&nbsp;any&nbsp;advice&nbsp;on&nbsp;how&nbsp;to&nbsp;code&nbsp;the&nbsp;methods&nbsp;to&nbsp;reduce&nbsp;the&nbsp;impact&nbsp;of&nbsp;the&nbsp;optimiser?&nbsp;Or&nbsp;should&nbsp;i&nbsp;just&nbsp;disable&nbsp;optimisations&nbsp;altogether,&nbsp;although&nbsp;I&amp;#39;d&nbsp;assume&nbsp;that&nbsp;wouldn&amp;#39;t&nbsp;be&nbsp;advisable&nbsp;for&nbsp;performance&nbsp;reasons.<br>
&lt;br&gt;&lt;br&gt;For&nbsp;example,&nbsp;this&nbsp;is&nbsp;what&nbsp;is&nbsp;currently&nbsp;in&nbsp;SVN:&lt;br&gt;&lt;br&gt;&lt;pre&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;private&lt;/font&gt;&lt;/b&gt;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;static&lt;/font&gt;&lt;/b&gt;&nbsp;Vector3&nbsp;IntersectionPoint(&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;ref&lt;/font&gt;<br>
<br>
&lt;/b&gt;&nbsp;Plane&nbsp;a,&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;ref&lt;/font&gt;&lt;/b&gt;&nbsp;Plane&nbsp;b,&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;ref&lt;/font&gt;&lt;/b&gt;&nbsp;Plane&nbsp;c)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vector3&nbsp;v1,&nbsp;v2,&nbsp;v3;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;float&lt;/font&gt;&lt;/b&gt;&nbsp;f&nbsp;=&nbsp;-<br>
Vector3.Dot(a.Normal,&nbsp;Vector3.Cross(b.Normal,&nbsp;c.Normal));&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v1&nbsp;=&nbsp;(a.D&nbsp;*&nbsp;Vector3.Cross(b.Normal,&nbsp;c.Normal))&nbsp;/&nbsp;f;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v2&nbsp;=&nbsp;(b.D&nbsp;*&nbsp;Vector3.Cross(c.Normal,&nbsp;a.Normal))&nbsp;/&nbsp;f;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v3&nbsp;=&nbsp;(c.D<br>
&nbsp;*&nbsp;<br>
Vector3.Cross(a.Normal,&nbsp;b.Normal))&nbsp;/&nbsp;f;&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vector3&nbsp;vec&nbsp;=&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;new&lt;/font&gt;&lt;/b&gt;&nbsp;Vector3(v1.X&nbsp;+&nbsp;v2.X&nbsp;+&nbsp;v3.X,&nbsp;v1.Y&nbsp;+&nbsp;v2.Y&nbsp;+&nbsp;v3.Y,&nbsp;v1.Z&nbsp;+&nbsp;v2.Z&nbsp;+&nbsp;v3.Z);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;<br>
<br>
return&lt;/font&gt;&lt;/b&gt;&nbsp;vec;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;If&nbsp;i&nbsp;change&nbsp;to&nbsp;the&nbsp;following&nbsp;(mathmatically&nbsp;identical&nbsp;form)&nbsp;i&nbsp;end&nbsp;up&nbsp;with&nbsp;a&nbsp;different&nbsp;(more&nbsp;accurate)&nbsp;answer:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;private&lt;/font&gt;&lt;/b&gt;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;<br>
<br>
static&lt;/font&gt;&lt;/b&gt;&nbsp;Vector3&nbsp;IntersectionPoint(&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;ref&lt;/font&gt;&lt;/b&gt;&nbsp;Plane&nbsp;a,&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;ref&lt;/font&gt;&lt;/b&gt;&nbsp;Plane&nbsp;b,&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;ref&lt;/font&gt;&lt;/b&gt;&nbsp;Plane&nbsp;c)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vector3&nbsp;v1,&nbsp;v2,&nbsp;v3;<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;float&lt;/font&gt;&lt;/b&gt;&nbsp;f&nbsp;=&nbsp;-1&nbsp;/&nbsp;Vector3.Dot(a.Normal,&nbsp;Vector3.Cross(b.Normal,&nbsp;c.Normal));&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v1&nbsp;=&nbsp;(a.D&nbsp;*&nbsp;Vector3.Cross(b.Normal,&nbsp;c.Normal));&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v2&nbsp;=&nbsp;(b.D&nbsp;*&nbsp;Vector3.Cross<br>
<br>
(c.Normal,&nbsp;a.Normal));&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v3&nbsp;=&nbsp;(c.D&nbsp;*&nbsp;Vector3.Cross(a.Normal,&nbsp;b.Normal));&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vector3&nbsp;vec&nbsp;=&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;new&lt;/font&gt;&lt;/b&gt;&nbsp;Vector3(v1.X&nbsp;+&nbsp;v2.X&nbsp;+&nbsp;v3.X,&nbsp;v1.Y&nbsp;+&nbsp;v2.Y&nbsp;+&nbsp;v3.Y,&nbsp;v1.Z&nbsp;+&nbsp;v2.Z&nbsp;+&nbsp;<br>
v3.Z);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;return&lt;/font&gt;&lt;/b&gt;&nbsp;vec&nbsp;/&nbsp;f;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;However&nbsp;the&nbsp;results&nbsp;of&nbsp;both&nbsp;methods&nbsp;change&nbsp;depending&nbsp;on&nbsp;whether&nbsp;i&amp;#39;m&nbsp;in&nbsp;debug&nbsp;or&nbsp;release&nbsp;mode,&nbsp;which&nbsp;just&nbsp;isn&amp;#39;t&nbsp;good.&lt;br&gt;<br>
<br>
&lt;/pre&gt;<br>
<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
