<tt>
Hi&nbsp;Sebastien,&lt;br&gt;&lt;br&gt;A&nbsp;few&nbsp;notes:&lt;br&gt;&lt;br&gt;+   &nbsp;/*&nbsp;we&nbsp;check&nbsp;rank&nbsp;==&nbsp;0&nbsp;because&nbsp;this&nbsp;is&nbsp;the&nbsp;&amp;quot;newarr&amp;quot;&nbsp;instruction,&nbsp;i.e.&nbsp;newarr&nbsp;Char&nbsp;--&amp;gt;&nbsp;Char[]&nbsp;*/&lt;br&gt;+   &nbsp;if&nbsp;(element-&amp;gt;rank&nbsp;!=&nbsp;0)&lt;br&gt;+   &nbsp;   &nbsp;return;&lt;br&gt;You&nbsp;don&amp;#39;t&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;element-&amp;gt;rank&nbsp;==&nbsp;0&nbsp;as&nbsp;newarr&nbsp;is&nbsp;only&nbsp;ever&nbsp;used&nbsp;for&nbsp;them.&lt;br&gt;<br>
&lt;br&gt;Besides&nbsp;that,&nbsp;are&nbsp;you&nbsp;sure&nbsp;this&nbsp;restriction&nbsp;doesn&amp;#39;t&nbsp;apply&nbsp;to&nbsp;bounded&nbsp;rank-1&nbsp;arrays?&lt;br&gt;&lt;br&gt;As&nbsp;noted&nbsp;on&nbsp;irc,&nbsp;your&nbsp;patch&nbsp;don&amp;#39;t&nbsp;work&nbsp;with&nbsp;domain&nbsp;sharing&nbsp;(-O=shared)&nbsp;enabled.&lt;br&gt;&lt;br&gt;+   &nbsp;   &nbsp;if&nbsp;(mlevel&nbsp;==&nbsp;MONO_SECURITY_CORE_CLR_TRANSPARENT)&nbsp;{&lt;br&gt;<br>
+   &nbsp;   &nbsp;   &nbsp;cfg-&amp;gt;exception_type&nbsp;=&nbsp;MONO_EXCEPTION_TYPE_LOAD;&lt;br&gt;+   &nbsp;   &nbsp;   &nbsp;cfg-&amp;gt;exception_message&nbsp;=&nbsp;g_strdup_printf&nbsp;(&amp;quot;Invalid&nbsp;array&nbsp;of&nbsp;[SecurityCritical]&nbsp;&amp;#39;%s&amp;#39;&nbsp;type.&amp;quot;,&nbsp;element-&amp;gt;name);&lt;br&gt;+   &nbsp;   &nbsp;}&lt;br&gt;<br>
&lt;br&gt;Please&nbsp;use&nbsp;something&nbsp;like&nbsp;mono_type_get_full_name&nbsp;that&nbsp;builds&nbsp;the&nbsp;FQN&nbsp;of&nbsp;the&nbsp;type.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sun,&nbsp;Sep&nbsp;13,&nbsp;2009&nbsp;at&nbsp;12:47&nbsp;PM,&nbsp;Sebastien&nbsp;Pouliot&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sebastien.pouliot@gmail.com&quot;&gt;sebastien.pouliot@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Hello,&lt;br&gt;&lt;br&gt;This&nbsp;patch&nbsp;adds&nbsp;a&nbsp;new&nbsp;check&nbsp;for&nbsp;newarr&nbsp;when&nbsp;CoreCLR&nbsp;is&nbsp;enabled.&nbsp;In&nbsp;this&nbsp;case&nbsp;creating&nbsp;an&nbsp;array&nbsp;of&nbsp;a&nbsp;[SecuirtyCritical]&nbsp;type&nbsp;will&nbsp;throw&nbsp;a&nbsp;TypeLoadException&nbsp;at&nbsp;JIT&nbsp;time.&nbsp;AFAIK*&nbsp;this&nbsp;is&nbsp;the&nbsp;last&nbsp;runtime&nbsp;behavior&nbsp;difference,&nbsp;wrt&nbsp;CoreCLR,&nbsp;between&nbsp;Moonlight&nbsp;and&nbsp;Silverlight.&lt;br&gt;<br>
<br>
&lt;br&gt;Thanks,&lt;br&gt;Sebastien&lt;br&gt;&lt;br&gt;*&nbsp;please&nbsp;feel&nbsp;free&nbsp;to&nbsp;educate&nbsp;me&nbsp;better&nbsp;;-)&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
