<tt>
Hey,&lt;br&gt;&lt;br&gt;Attached&nbsp;is&nbsp;the&nbsp;initial&nbsp;patch&nbsp;that&nbsp;implemented&nbsp;guarded&nbsp;finally&nbsp;blocks.&nbsp;It&nbsp;only&nbsp;works&nbsp;on&nbsp;unix/x86.&lt;br&gt;&lt;br&gt;It&nbsp;solves&nbsp;the&nbsp;problem&nbsp;of&nbsp;Thread::Abort&nbsp;been&nbsp;delivered&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;a&nbsp;handler&nbsp;blocks.&nbsp;The&nbsp;correct&lt;br&gt;behavior&nbsp;is&nbsp;to&nbsp;raise&nbsp;the&nbsp;exception&nbsp;right&nbsp;after&nbsp;the&nbsp;handler&nbsp;finishes.&nbsp;This&nbsp;applies&nbsp;to&nbsp;catch,&nbsp;finally&nbsp;and&nbsp;fault&lt;br&gt;<br>
handlers,&nbsp;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;about&nbsp;filter.&nbsp;This&nbsp;patch&nbsp;only&nbsp;deals&nbsp;with&nbsp;finally&nbsp;clauses.&lt;br&gt;&lt;br&gt;It&nbsp;does&nbsp;handle&nbsp;finally&nbsp;clauses&nbsp;by&nbsp;patching&nbsp;the&nbsp;return&nbsp;address&nbsp;from&nbsp;the&nbsp;finally&nbsp;clause&nbsp;to&nbsp;call&nbsp;back&nbsp;into&nbsp;the&lt;br&gt;runtime&nbsp;so&nbsp;we&nbsp;can&nbsp;resume&nbsp;interruption.&nbsp;We&nbsp;patch&nbsp;in&nbsp;a&nbsp;thunk&nbsp;that&nbsp;restores&nbsp;the&nbsp;return&nbsp;address&nbsp;and&lt;br&gt;<br>
calls&nbsp;into&nbsp;the&nbsp;effective&nbsp;trampoline.&lt;br&gt;&lt;br&gt;Please&nbsp;review,&lt;br&gt;Rodrigo&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
