<tt>
Hi,&lt;br&gt;&lt;br&gt; &nbsp;mono&nbsp;uses&nbsp;the&nbsp;GC_GCJ_MALLOC&nbsp;family&nbsp;of&nbsp;functions&nbsp;which&nbsp;take&nbsp;a&nbsp;gc&nbsp;descriptor.&lt;br&gt;&lt;br&gt;             &nbsp;Zoltan&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;29,&nbsp;2009&nbsp;at&nbsp;6:08&nbsp;PM,&nbsp;Dick&nbsp;Porter&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:dporter@codicesoftware.com&quot;&gt;dporter@codicesoftware.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;Mon,&nbsp;2009-09-28&nbsp;at&nbsp;17:41&nbsp;-0400,&nbsp;Miguel&nbsp;de&nbsp;Icaza&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hello,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;Libgc&nbsp;supports&nbsp;this&nbsp;kind&nbsp;of&nbsp;descriptors&nbsp;and&nbsp;mono&nbsp;already&nbsp;generates&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;them&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;for&nbsp;the&nbsp;sgen&nbsp;gc,&nbsp;so&nbsp;it&amp;#39;s&nbsp;just&nbsp;a&nbsp;matter&nbsp;of&nbsp;joining&nbsp;those&nbsp;together&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;(which&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;should&nbsp;beeasy&nbsp;to&nbsp;do).&nbsp;This&nbsp;should&nbsp;improve&nbsp;a&nbsp;great&nbsp;number&nbsp;of&nbsp;scans&nbsp;in&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;arking&nbsp;process,&nbsp;leaving&nbsp;only&nbsp;stacks&nbsp;and&nbsp;several&nbsp;minor&nbsp;objects&nbsp;without&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;precise&nbsp;marking.&nbsp;(Should&nbsp;become&nbsp;similar&nbsp;to&nbsp;the&nbsp;current&nbsp;sgen&nbsp;idea,&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;where&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;stacks&nbsp;and&nbsp;other&nbsp;roots&nbsp;are&nbsp;scanned&nbsp;conservatively,&nbsp;although&nbsp;not&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;compacting).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Mono&nbsp;already&nbsp;uses&nbsp;those&nbsp;descriptors&nbsp;for&nbsp;the&nbsp;heap;&nbsp; &nbsp;There&nbsp;are&nbsp;only&nbsp;two&lt;br&gt;<br>
&amp;gt;&nbsp;cases&nbsp;when&nbsp;it&nbsp;does&nbsp;not&nbsp;use&nbsp;that:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp;*&nbsp;Scanning&nbsp;the&nbsp;stack,&nbsp;this&nbsp;is&nbsp;done&nbsp;with&nbsp;the&nbsp;conservative&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collector.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp;*&nbsp;Any&nbsp;AppDomains&nbsp;that&nbsp;are&nbsp;not&nbsp;the&nbsp;root&nbsp;appdomain.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&amp;#39;ve&nbsp;been&nbsp;looking&nbsp;through&nbsp;the&nbsp;code&nbsp;in&nbsp;svn&nbsp;head.&nbsp; The&nbsp;only&nbsp;place&nbsp;I&nbsp;can&lt;br&gt;<br>
see&nbsp;an&nbsp;object&nbsp;allocated&nbsp;with&nbsp;mono_gc_alloc_fixed&nbsp;()&nbsp;with&nbsp;the&nbsp;descr&lt;br&gt;<br>
parameter&nbsp;not&nbsp;NULL&nbsp;(which&nbsp;is&nbsp;the&nbsp;only&nbsp;place&nbsp;in&nbsp;boehm-gc&nbsp;mode&nbsp;that&nbsp;calls&lt;br&gt;<br>
GC_MALLOC_EXPLICITLY_TYPED&nbsp;())&nbsp;is&nbsp;in&nbsp;object.c,&lt;br&gt;<br>
mono_class_create_runtime_vtable()&nbsp;when&nbsp;class-&amp;gt;has_static_refs&nbsp;is&nbsp;true.&lt;br&gt;<br>
&lt;br&gt;<br>
Am&nbsp;I&nbsp;missing&nbsp;something&nbsp;here?&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
-&nbsp;Dick&lt;br&gt;<br>
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
