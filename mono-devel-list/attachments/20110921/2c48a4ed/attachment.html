<tt>
Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Are&nbsp;you&nbsp;on&nbsp;32&nbsp;or&nbsp;64&nbsp;bits?&nbsp;Our&nbsp;FP&nbsp;code&nbsp;is&nbsp;quite&nbsp;different&nbsp;on&nbsp;those&nbsp;two.&lt;/div&gt;&lt;div&gt;Can&nbsp;you&nbsp;have&nbsp;a&nbsp;run&nbsp;on&nbsp;.NET&nbsp;without&nbsp;the&nbsp;added&nbsp;denormal&nbsp;hack?&nbsp;We&nbsp;strike&nbsp;to&lt;/div&gt;&lt;div&gt;be&nbsp;as&nbsp;compatible&nbsp;as&nbsp;possible,&nbsp;specially&nbsp;when&nbsp;it&nbsp;comes&nbsp;to&nbsp;numerical&nbsp;stability&lt;/div&gt;<br>
&lt;div&gt;and output.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Sep&nbsp;21,&nbsp;2011&nbsp;at&nbsp;10:00&nbsp;AM,&nbsp;noisecrime&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:noise@noisecrime.com&quot;&gt;noise@noisecrime.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Good&nbsp;news,&nbsp;looks&nbsp;like&nbsp;I&nbsp;may&nbsp;have&nbsp;found&nbsp;a&nbsp;solution&nbsp;to&nbsp;the&nbsp;problem.&lt;br&gt;<br>
&lt;br&gt;<br>
Though&nbsp;I&nbsp;probably&nbsp;need&nbsp;to&nbsp;do&nbsp;some&nbsp;further&nbsp;testing,&nbsp;it&nbsp;does&nbsp;indeed&nbsp;appear&nbsp;to&lt;br&gt;<br>
be&nbsp;denormals&nbsp;causing&nbsp;the&nbsp;issue.&nbsp;After&nbsp;reading&nbsp;up&nbsp;on&nbsp;it&nbsp;online&nbsp;its&nbsp;been&nbsp;a&lt;br&gt;<br>
very&nbsp;common&nbsp;problem&nbsp;for&nbsp;DSP/audio&nbsp;developers&nbsp;and&nbsp;thankfully&nbsp;there&nbsp;appears&nbsp;to&lt;br&gt;<br>
be&nbsp;a&nbsp;simple&nbsp;solution.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;page&nbsp;describes&nbsp;the&nbsp;problem&nbsp;and&nbsp;various&nbsp;solutions&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://phonophunk.com/articles/pentium4-denormalization.php?pg=3&quot;&nbsp;target=&quot;_blank&quot;&gt;http://phonophunk.com/articles/pentium4-denormalization.php?pg=3&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;went&nbsp;with&nbsp;the&nbsp;simplest&lt;br&gt;<br>
“On&nbsp;every&nbsp;location&nbsp;in&nbsp;the&nbsp;code&nbsp;where&nbsp;denormalization&nbsp;might&nbsp;occur,&nbsp;just&nbsp;add&lt;br&gt;<br>
1.0e-24&nbsp;to&nbsp;the&nbsp;float&nbsp;value,&nbsp;then&nbsp;subtract&nbsp;it&nbsp;again,&nbsp;that&nbsp;should&nbsp;fix&nbsp;it.”&lt;br&gt;<br>
&lt;br&gt;<br>
Doing&nbsp;that&nbsp;in&nbsp;just&nbsp;the&nbsp;lin_solve&nbsp;function&nbsp;such&nbsp;as&lt;br&gt;<br>
&lt;br&gt;<br>
x[i+N2J]&nbsp;=&nbsp; denormal&nbsp;+&nbsp;((&nbsp;x0[i+N2J]&nbsp;+&nbsp;a&nbsp;*&nbsp;(x[i-1+N2J]&nbsp;+&nbsp;x[i+1+N2J]&nbsp;+&lt;br&gt;<br>
x[i+N2JN]&nbsp;+&nbsp;x[i+N2JP])&nbsp;)&nbsp;*&nbsp;oneOverC);&lt;br&gt;<br>
x[i+N2J]&nbsp;-=&nbsp; denormal;&lt;br&gt;<br>
&lt;br&gt;<br>
gives&nbsp;constant&nbsp;performance,&nbsp;though&nbsp;I&nbsp;suspect&nbsp;i&amp;#39;ll&nbsp;need&nbsp;to&nbsp;add&nbsp;it&nbsp;to&nbsp;a&nbsp;few&lt;br&gt;<br>
other&nbsp;places&nbsp;in&nbsp;the&nbsp;code&nbsp;as&nbsp;well.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://mono.1490590.n4.nabble.com/Weird-performance-problems-possibly-due-to-floats-and-precision-issues-tp3829087p3829895.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://mono.1490590.n4.nabble.com/Weird-performance-problems-possibly-due-to-floats-and-precision-issues-tp3829087p3829895.html&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;/font&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;Sent&nbsp;from&nbsp;the&nbsp;Mono&nbsp;-&nbsp;Dev&nbsp;mailing&nbsp;list&nbsp;archive&nbsp;at&nbsp;Nabble.com.&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
