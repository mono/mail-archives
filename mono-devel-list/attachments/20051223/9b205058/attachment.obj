Index: driver.cs
===================================================================
--- driver.cs	(revision 54791)
+++ driver.cs	(working copy)
@@ -1613,17 +1613,6 @@
 			if (!CodeGen.Init (output_file, output_file, want_debugging_support))
 				return false;
 
-			if (RootContext.Target == Target.Module) {
-				PropertyInfo module_only = typeof (AssemblyBuilder).GetProperty ("IsModuleOnly", BindingFlags.Instance|BindingFlags.Public|BindingFlags.NonPublic);
-				if (module_only == null) {
-					Report.RuntimeMissingSupport (Location.Null, "/target:module");
-					Environment.Exit (1);
-				}
-
-				MethodInfo set_method = module_only.GetSetMethod (true);
-				set_method.Invoke (CodeGen.Assembly.Builder, BindingFlags.Default, null, new object[]{true}, null);
-			}
-
 			RootNamespace.Global.AddModuleReference (CodeGen.Module.Builder);
 
 			if (modules.Count > 0) {
@@ -1799,7 +1788,17 @@
 			if (Report.Errors > 0)
 				return false;
 			
-			CodeGen.Save (output_file);
+			if (RootContext.Target == Target.Module) {
+				string assembly_file = "assembly.tmp";
+				try {
+					CodeGen.Save (assembly_file);
+				} finally {
+					File.Delete (Path.Combine (Path.GetDirectoryName (output_file), assembly_file));
+				}
+			}
+			else
+				CodeGen.Save (output_file);
+
 			if (timestamps) {
 				ShowTime ("Saved output");
 				ShowTotalTime ("Total");
