Index: mcs/tools/security/AssemblyInfo.cs
===================================================================
--- mcs/tools/security/AssemblyInfo.cs	(revision 48754)
+++ mcs/tools/security/AssemblyInfo.cs	(working copy)
@@ -18,6 +18,7 @@
 [assembly: AssemblyCompany("Motus Technologies, Novell")]
 [assembly: AssemblyProduct("Mono Security Tools")]
 [assembly: AssemblyCopyright("Copyright 2002, 2003 Motus Technologies. Copyright 2004-2005 Novell. BSD licensed.")]
+[assembly: AssemblyVersion (Consts.MonoVersion)]
 
 //[assembly: AssemblyConfiguration("")]
 //[assembly: AssemblyTrademark("")]
Index: mcs/tools/security/Makefile
===================================================================
--- mcs/tools/security/Makefile	(revision 48754)
+++ mcs/tools/security/Makefile	(working copy)
@@ -6,7 +6,7 @@
 LOCAL_MCS_FLAGS = /lib:$(topdir)/class/lib/$(PROFILE) -r:Mono.Security.dll
 
 SECURITY_PROGRAMS = secutil.exe cert2spc.exe sn.exe makecert.exe chktrust.exe signcode.exe setreg.exe certmgr.exe caspol.exe permview.exe
-SECURITY_SOURCES = AssemblyInfo.cs $(topdir)/build/common/MonoVersion.cs StrongNameManager.cs $(SECURITY_PROGRAMS:.exe=.cs)
+SECURITY_SOURCES = AssemblyInfo.cs $(topdir)/build/common/Consts.cs StrongNameManager.cs $(SECURITY_PROGRAMS:.exe=.cs)
 
 PROGRAM_INSTALL_DIR = $(mono_libdir)/mono/$(FRAMEWORK_VERSION)
 
@@ -45,9 +45,9 @@
 
 dist-local: dist-default
 
-sn_sources = sn.cs StrongNameManager.cs AssemblyInfo.cs $(topdir)/build/common/MonoVersion.cs
+sn_sources = sn.cs StrongNameManager.cs AssemblyInfo.cs $(topdir)/build/common/Consts.cs
 sn.exe $(topdir)/class/lib/$(PROFILE)/sn.exe: $(sn_sources)
 	$(CSCOMPILE) /out:$@ $(sn_sources)
 
-%.exe: %.cs AssemblyInfo.cs $(topdir)/build/common/MonoVersion.cs
+%.exe: %.cs AssemblyInfo.cs $(topdir)/build/common/Consts.cs
 	$(CSCOMPILE) $^
Index: mcs/mcs/mcs.exe.sources
===================================================================
--- mcs/mcs/mcs.exe.sources	(revision 48754)
+++ mcs/mcs/mcs.exe.sources	(working copy)
@@ -36,4 +36,4 @@
 ../class/Mono.CompilerServices.SymbolWriter/MonoSymbolTable.cs
 ../class/Mono.CompilerServices.SymbolWriter/MonoSymbolWriter.cs
 ../class/corlib/Mono.Security.Cryptography/CryptoConvert.cs
-../build/common/MonoVersion.cs
\ No newline at end of file
+../build/common/Consts.cs
\ No newline at end of file
Index: mcs/mcs/AssemblyInfo.cs
===================================================================
--- mcs/mcs/AssemblyInfo.cs	(revision 48754)
+++ mcs/mcs/AssemblyInfo.cs	(working copy)
@@ -1,6 +1,7 @@
 using System.Reflection;
 using System.Runtime.CompilerServices;
 
+[assembly: AssemblyVersion (Consts.MonoVersion)]
 [assembly: AssemblyTitle ("Mono C# Compiler")]
 [assembly: AssemblyDescription ("Mono C# Compiler")]
 [assembly: AssemblyCopyright ("2001, 2002, 2003 Ximian, Inc.")]
Index: mcs/gmcs/gmcs.exe.sources
===================================================================
--- mcs/gmcs/gmcs.exe.sources	(revision 48754)
+++ mcs/gmcs/gmcs.exe.sources	(working copy)
@@ -36,4 +36,4 @@
 ../class/Mono.CompilerServices.SymbolWriter/MonoSymbolFile.cs
 ../class/Mono.CompilerServices.SymbolWriter/MonoSymbolTable.cs
 ../class/Mono.CompilerServices.SymbolWriter/MonoSymbolWriter.cs
-../build/common/MonoVersion.cs
+../build/common/Consts.cs
Index: mcs/gmcs/AssemblyInfo.cs
===================================================================
--- mcs/gmcs/AssemblyInfo.cs	(revision 48754)
+++ mcs/gmcs/AssemblyInfo.cs	(working copy)
@@ -1,6 +1,7 @@
 using System.Reflection;
 using System.Runtime.CompilerServices;
 
+[assembly: AssemblyVersion (Consts.MonoVersion)]
 [assembly: AssemblyTitle ("Mono C# Compiler")]
 [assembly: AssemblyDescription ("Mono C# Compiler with Generics")]
 [assembly: AssemblyCopyright ("2001, 2002, 2003 Ximian, Inc.")]

Property changes on: mcs\build\common
___________________________________________________________________
Name: svn:ignore
   - MonoVersion.cs

   + Consts.cs


Index: mcs/build/common/Consts.cs.in
===================================================================
--- mcs/build/common/Consts.cs.in	(revision 48754)
+++ mcs/build/common/Consts.cs.in	(working copy)
@@ -1,5 +1,5 @@
 //
-// Consts.cs
+// Consts.cs.in
 //
 // Author:
 //   Kornél Pál <http://www.kornelpal.hu/>
@@ -48,6 +48,7 @@
 	// Use these assembly version constants to make code more maintainable.
 	//
 
+	public const string MonoVersion = "@MONO_VERSION@";
 #if NET_2_0 || BOOTSTRAP_NET_2_0
 	public const string FxVersion = "2.0.0.0";
 	public const string VsVersion = "8.0.0.0";
Index: mcs/build/common/Consts.cs
===================================================================
--- mcs/build/common/Consts.cs	(revision 48754)
+++ mcs/build/common/Consts.cs	(working copy)
@@ -1,92 +0,0 @@
-//
-// Consts.cs
-//
-// Author:
-//   Kornél Pál <http://www.kornelpal.hu/>
-//
-// Copyright (C) 2005 Kornél Pál
-//
-
-//
-// Permission is hereby granted, free of charge, to any person obtaining
-// a copy of this software and associated documentation files (the
-// "Software"), to deal in the Software without restriction, including
-// without limitation the rights to use, copy, modify, merge, publish,
-// distribute, sublicense, and/or sell copies of the Software, and to
-// permit persons to whom the Software is furnished to do so, subject to
-// the following conditions:
-//
-// The above copyright notice and this permission notice shall be
-// included in all copies or substantial portions of the Software.
-//
-// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
-// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
-// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
-// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
-// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
-// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
-// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-//
-
-using System.Runtime.InteropServices;
-
-internal
-#if NET_2_0
-	static
-#else
-	sealed
-#endif
-	class Consts
-{
-#if !NET_2_0
-	private Consts ()
-	{
-	}
-#endif
-
-	//
-	// Use these assembly version constants to make code more maintainable.
-	//
-
-#if NET_2_0 || BOOTSTRAP_NET_2_0
-	public const string FxVersion = "2.0.0.0";
-	public const string VsVersion = "8.0.0.0";
-#elif NET_1_1 || TARGET_JVM
-	public const string FxVersion = "1.0.5000.0";
-	public const string VsVersion = "7.0.5000.0";
-#elif NET_1_0
-	public const string FxVersion = "1.0.3300.0";
-	public const string VsVersion = "7.0.3300.0";
-#else
-#error No profile symbols specified.
-#endif
-
-	//
-	// Use these assembly name constants to make code more maintainable.
-	//
-
-	public const string AssemblyI18N = "I18N, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=0738eb9f132ed756";
-	public const string AssemblyMicrosoft_VisualStudio = "Microsoft.VisualStudio, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblyMicrosoft_VSDesigner = "Microsoft.VSDesigner, Version=" + VsVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblyMono_Http = "Mono.Http, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=0738eb9f132ed756";
-	public const string AssemblyMono_Posix = "Mono.Posix, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=0738eb9f132ed756";
-	public const string AssemblyMono_Security = "Mono.Security, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=0738eb9f132ed756";
-	public const string AssemblySystem = "System, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b77a5c561934e089";
-	public const string AssemblySystem_Data = "System.Data, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b77a5c561934e089";
-	public const string AssemblySystem_Design = "System.Design, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblySystem_DirectoryServices = "System.DirectoryServices, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblySystem_Drawing = "System.Drawing, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblySystem_Drawing_Design = "System.Drawing.Design, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblySystem_Messaging = "System.Messaging, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblySystem_Security = "System.Security, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblySystem_ServiceProcess = "System.ServiceProcess, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
-	public const string AssemblySystem_Windows_Forms = "System.Windows.Forms, Version=" + FxVersion + ", Culture=neutral, PublicKeyToken=b77a5c561934e089";
-
-#if INSIDE_CORLIB
-#if BOOTSTRAP_WITH_OLDLIB
-	public const UnmanagedType UnmanagedType_80 = UnmanagedType.mono_bootstrap_NativeTypeMax;
-#else
-	public const UnmanagedType UnmanagedType_80 = (UnmanagedType) 80;
-#endif
-#endif
-}
Index: mcs/build/Makefile
===================================================================
--- mcs/build/Makefile	(revision 48754)
+++ mcs/build/Makefile	(working copy)
@@ -15,9 +15,9 @@
 
 COMMON_SRCS = \
 	Consts.cs			\
+	Consts.cs.in			\
 	Locale.cs			\
 	MonoTODOAttribute.cs		\
-	MonoVersion.cs			\
 	TestConfiguration.cs
 
 DISTFILES = \
Index: mcs/ilasm/AssemblyInfo.cs
===================================================================
--- mcs/ilasm/AssemblyInfo.cs	(revision 48754)
+++ mcs/ilasm/AssemblyInfo.cs	(working copy)
@@ -1,6 +1,7 @@
 using System.Reflection;
 using System.Runtime.CompilerServices;
 
+[assembly: AssemblyVersion (Consts.MonoVersion)]
 [assembly: AssemblyTitle ("Mono ILasm Compiler")]
 [assembly: AssemblyDescription ("Mono ILasm Compiler")]
 [assembly: AssemblyCopyright ("Sergey Chaban and Jackson Harper")]
Index: mcs/ilasm/ilasm.exe.sources
===================================================================
--- mcs/ilasm/ilasm.exe.sources	(revision 48754)
+++ mcs/ilasm/ilasm.exe.sources	(working copy)
@@ -75,4 +75,4 @@
 scanner/NumberHelper.cs
 scanner/StringHelperBase.cs
 scanner/StringHelper.cs
-../build/common/MonoVersion.cs
+../build/common/Consts.cs
Index: mono/configure.in
===================================================================
--- mono/configure.in	(revision 48754)
+++ mono/configure.in	(working copy)
@@ -1810,18 +1810,12 @@
 
   export VERSION
   [myver=$($AWK 'BEGIN {
-    split (ENVIRON["VERSION"] ".0.0.0.0", vsplit, ".")
+    split (ENVIRON["VERSION"] ".0.0.0", vsplit, ".")
     print vsplit [1] "." vsplit [2] "." vsplit [3] "." vsplit [4]
   }')]
-  
-  cat > $srcdir/$mcsdir/build/common/MonoVersion.cs <<EOF
-//
-// This version number is generated from configure.in in the mono source tree.
-//
-using System.Reflection;
 
-[[assembly: AssemblyVersion("${myver}")]]
-EOF
+  # Generate Consts.cs
+  sed -e "s/@MONO_VERSION@/$myver/" $srcdir/$mcsdir/build/common/Consts.cs.in > $srcdir/$mcsdir/build/common/Consts.cs
 )
 
 libgdiplus_msg=${libgdiplus_loc:-assumed to be installed}
