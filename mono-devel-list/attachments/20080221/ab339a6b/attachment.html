<tt>
It&nbsp;may&nbsp;be&nbsp;closed&nbsp;automatically,&nbsp;but&nbsp;*when*&nbsp;will&nbsp;it&nbsp;be&nbsp;closed?&nbsp;There&amp;#39;s&nbsp;no&nbsp;guarantee&nbsp;on&nbsp;when&nbsp;finalizers&nbsp;will&nbsp;be&nbsp;called&nbsp;which&nbsp;is&nbsp;why&nbsp;calling&nbsp;.Close()&nbsp;is&nbsp;a&nbsp;much&nbsp;better&nbsp;solution&nbsp;(where&nbsp;possible).&lt;br&gt;&lt;br&gt;Alan.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;Thu,&nbsp;Feb&nbsp;21,&nbsp;2008&nbsp;at&nbsp;11:53&nbsp;AM,&nbsp;Zoltan&nbsp;Varga&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:vargaz@gmail.com&quot;&gt;vargaz@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;applied&nbsp;the&nbsp;following&nbsp;patch&nbsp;instead&nbsp;to&nbsp;the&nbsp;1.9&nbsp;branch:&lt;br&gt;<br>
&lt;br&gt;<br>
Index:&nbsp;HttpConnection.cs&lt;br&gt;<br>
===================================================================&lt;br&gt;<br>
---&nbsp;HttpConnection.cs&nbsp;&amp;nbsp;&nbsp;(revision&nbsp;96098)&lt;br&gt;<br>
+++&nbsp;HttpConnection.cs&nbsp;&amp;nbsp;&nbsp;(working&nbsp;copy)&lt;br&gt;<br>
@@&nbsp;-313,8&nbsp;+313,11&nbsp;@@&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Socket&nbsp;s&nbsp;=&nbsp;sock;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sock&nbsp;=&nbsp;null;&lt;br&gt;<br>
-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;s.Shutdown&nbsp;(SocketShutdown.Both);&lt;br&gt;<br>
&lt;/div&gt;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;s.Close&nbsp;();&lt;br&gt;<br>
+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;try&nbsp;{&lt;br&gt;<br>
+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;s.Shutdown&nbsp;(SocketShutdown.Both);&lt;br&gt;<br>
+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&nbsp;finally&nbsp;{&lt;br&gt;<br>
+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;s.Close&nbsp;();&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;if&nbsp;(context_bound)&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;epl.UnbindContext&nbsp;(context);&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;This&nbsp;is&nbsp;still&nbsp;just&nbsp;a&nbsp;workaround,&nbsp;since&nbsp;the&nbsp;socket&nbsp;should&nbsp;be&nbsp;closed&nbsp;automatically&lt;br&gt;<br>
by&nbsp;its&nbsp;finalizer.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;Zoltan&lt;br&gt;<br>
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;&lt;br&gt;<br>
On&nbsp;Wed,&nbsp;Feb&nbsp;20,&nbsp;2008&nbsp;at&nbsp;5:37&nbsp;PM,&nbsp;Avery&nbsp;Pennarun&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:apenwarr@gmail.com&quot;&gt;apenwarr@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;2008/2/20&nbsp;Steve&nbsp;Bjorg&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:steveb@mindtouch.com&quot;&gt;steveb@mindtouch.com&lt;/a&gt;&amp;gt;:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;-&nbsp;s.Shutdown&nbsp;(SocketShutdown.Both);&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;gt;&nbsp;+&nbsp;try&nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;gt;&nbsp;+&nbsp;s.Shutdown&nbsp;(SocketShutdown.Both);&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;gt;&nbsp;+&nbsp;}&nbsp;catch(Exception&nbsp;e)&nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;gt;&nbsp;+&nbsp;//&nbsp;log&nbsp;here?&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;gt;&nbsp;+&nbsp;}&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;gt;&nbsp;&amp;nbsp;&nbsp;s.Close&nbsp;();&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;Why&nbsp;call&nbsp;Shutdown()&nbsp;at&nbsp;all?&nbsp;&amp;nbsp;The&nbsp;shutdown&nbsp;syscall&nbsp;is&nbsp;only&nbsp;useful&nbsp;if&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;you&nbsp;need&nbsp;to&nbsp;keep&nbsp;the&nbsp;fd&nbsp;around&nbsp;longer&nbsp;(eg.&nbsp;if&nbsp;someone&nbsp;else&nbsp;is&nbsp;still&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;holding&nbsp;onto&nbsp;it&nbsp;and&nbsp;you&nbsp;don&amp;#39;t&nbsp;want&nbsp;it&nbsp;to&nbsp;be&nbsp;reused).&nbsp;&amp;nbsp;In&nbsp;the&nbsp;above&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;code,&nbsp;close()&nbsp;shuts&nbsp;down&nbsp;the&nbsp;socket&nbsp;anyway.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;...unless&nbsp;mono&amp;#39;s&nbsp;socket&nbsp;code&nbsp;is&nbsp;doing&nbsp;something&nbsp;different&nbsp;than&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;standard&nbsp;C&nbsp;sockets,&nbsp;that&nbsp;is.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;Have&nbsp;fun,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;Avery&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
