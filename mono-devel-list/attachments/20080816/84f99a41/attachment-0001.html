<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;OK,&nbsp;this&nbsp;patch&nbsp;just&nbsp;spruces&nbsp;up&nbsp;the&nbsp;HighestSetBit&nbsp;method&nbsp;and&nbsp;fixes&nbsp;the&nbsp;bug.&lt;br&gt;&lt;br&gt;Index:&nbsp;class/System/System.Collections.Specialized/ChangeLog&lt;br&gt;===================================================================&lt;br&gt;<br>
---&nbsp;class/System/System.Collections.Specialized/ChangeLog&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(revision&nbsp;109665)&lt;br&gt;+++&nbsp;class/System/System.Collections.Specialized/ChangeLog&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(working&nbsp;copy)&lt;br&gt;@@&nbsp;-1,3&nbsp;+1,10&nbsp;@@&lt;br&gt;+2008-08-06&amp;nbsp;&nbsp;Scott&nbsp;Peterson&amp;nbsp;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:lunchtimemama@gmail.com&quot;&gt;lunchtimemama@gmail.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
+&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;BitVector32.cs:&nbsp;Fixed&nbsp;a&nbsp;bug&nbsp;which&nbsp;allowed&nbsp;for&nbsp;invalid&nbsp;sections&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;to&nbsp;be&nbsp;created&nbsp;with&nbsp;CreateSection.&nbsp;Also&nbsp;simlpified&nbsp;HighestSetBit&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;algorithm&nbsp;and&nbsp;got&nbsp;rid&nbsp;ofNumberOfSetBits&nbsp;(using&nbsp;HighestSetBit&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;works&nbsp;just&nbsp;fine).&lt;br&gt;<br>
+&lt;br&gt;&amp;nbsp;2008-07-31&amp;nbsp;&nbsp;Jb&nbsp;Evain&amp;nbsp;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jbevain@novell.com&quot;&gt;jbevain@novell.com&lt;/a&gt;&amp;gt;&lt;br&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;StringDictionary.cs:&nbsp;remove&nbsp;ComponentModel&nbsp;bits&nbsp;for&nbsp;NET_2_1.&lt;br&gt;Index:&nbsp;class/System/System.Collections.Specialized/BitVector32.cs&lt;br&gt;<br>
===================================================================&lt;br&gt;---&nbsp;class/System/System.Collections.Specialized/BitVector32.cs&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(revision&nbsp;109665)&lt;br&gt;+++&nbsp;class/System/System.Collections.Specialized/BitVector32.cs&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(working&nbsp;copy)&lt;br&gt;<br>
@@&nbsp;-184,11&nbsp;+184,11&nbsp;@@&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(maxValue&nbsp;&amp;lt;&nbsp;1)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throw&nbsp;new&nbsp;ArgumentException&nbsp;(&amp;quot;maxValue&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;bit&nbsp;=&nbsp;HighestSetBit(maxValue)&nbsp;+&nbsp;1;&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;bit&nbsp;=&nbsp;HighestSetBit(maxValue);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;mask&nbsp;=&nbsp;(1&nbsp;&amp;lt;&amp;lt;&nbsp;bit)&nbsp;-&nbsp;1;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;offset&nbsp;=&nbsp;previous.Offset&nbsp;+&nbsp;NumberOfSetBits&nbsp;(previous.Mask);&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;offset&nbsp;=&nbsp;previous.Offset&nbsp;+&nbsp;HighestSetBit&nbsp;(previous.Mask);&lt;br&gt;&amp;nbsp;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(offset&nbsp;&amp;gt;&nbsp;32)&nbsp;{&lt;br&gt;<br>
+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(offset&nbsp;+&nbsp;bit&nbsp;&amp;gt;&nbsp;32)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throw&nbsp;new&nbsp;ArgumentException&nbsp;(&amp;quot;Sections&nbsp;cannot&nbsp;exceed&nbsp;32&nbsp;bits&nbsp;in&nbsp;total&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&lt;br&gt;@@&nbsp;-227,27&nbsp;+227,12&nbsp;@@&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;Private&nbsp;utilities&lt;br&gt;<br>
-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;int&nbsp;NumberOfSetBits&nbsp;(int&nbsp;i)&nbsp;&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;int&nbsp;HighestSetBit&nbsp;(int&nbsp;i)&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;count&nbsp;=&nbsp;0;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;(int&nbsp;bit&nbsp;=&nbsp;0;&nbsp;bit&nbsp;&amp;lt;&nbsp;32;&nbsp;bit++)&nbsp;{&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;mask&nbsp;=&nbsp;1&nbsp;&amp;lt;&amp;lt;&nbsp;bit;&lt;br&gt;<br>
-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;((i&nbsp;&amp;amp;&nbsp;mask)&nbsp;!=&nbsp;0)&nbsp;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;count++;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;while(i&nbsp;&amp;gt;&amp;gt;&nbsp;count&nbsp;!=&nbsp;0)&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;count++;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;count;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;-&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;int&nbsp;HighestSetBit&nbsp;(int&nbsp;i)&nbsp;&lt;br&gt;<br>
-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;(int&nbsp;bit&nbsp;=&nbsp;31;&nbsp;bit&nbsp;&amp;gt;=&nbsp;0;&nbsp;bit--)&nbsp;{&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;mask&nbsp;=&nbsp;1&nbsp;&amp;lt;&amp;lt;&nbsp;bit;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;((mask&nbsp;&amp;amp;&nbsp;i)&nbsp;!=&nbsp;0)&nbsp;{&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;bit;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;-&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;-1;&lt;br&gt;-&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;}&lt;br&gt;&lt;/div&gt;<br>

</tt>
