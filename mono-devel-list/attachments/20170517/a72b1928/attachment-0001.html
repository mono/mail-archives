<tt>
&lt;html&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Title&quot;&nbsp;content=&quot;&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Keywords&quot;&nbsp;content=&quot;&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;15&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:&quot;Cambria&nbsp;Math&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;4&nbsp;5&nbsp;3&nbsp;5&nbsp;4&nbsp;6&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:12.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,serif;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:blue;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:purple;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
span.EmailStyle17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-reply;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext;}<br>
span.msoIns<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-style-name:&quot;&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:teal;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:10.0pt;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:8.5in&nbsp;11.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:WordSection1;}<br>
/*&nbsp;List&nbsp;Definitions&nbsp;*/<br>
@list&nbsp;l0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-list-id:1353609234;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-list-template-ids:-2070633704;}<br>
@list&nbsp;l0:level1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:1.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:1.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:2.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:2.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:3.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:3.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:4.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
@list&nbsp;l0:level9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:bullet;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-text:;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:4.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-ansi-font-size:10.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:Symbol;}<br>
ol<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
ul<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
--&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;white&quot;&nbsp;lang=&quot;EN-US&quot;&nbsp;link=&quot;blue&quot;&nbsp;vlink=&quot;purple&quot;&gt;<br>
&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Hi&nbsp;Johan,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;On&nbsp;the&nbsp;refactoring&nbsp;bit,&nbsp;my&nbsp;reasoning&nbsp;for&nbsp;it&nbsp;is&nbsp;to&nbsp;pay&nbsp;some&nbsp;of&nbsp;our&nbsp;technical&nbsp;debt&nbsp;in&nbsp;that&nbsp;area&nbsp;as&nbsp;we&nbsp;go,&nbsp;spending&nbsp;time&nbsp;on&nbsp;that&nbsp;part&nbsp;of&nbsp;the&nbsp;codebase&nbsp;makes&nbsp;you&nbsp;the&nbsp;honorary&nbsp;expect<br>
&nbsp;on&nbsp;it&nbsp;;)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;I’m&nbsp;onboard&nbsp;on&nbsp;the&nbsp;specifics&nbsp;of&nbsp;how&nbsp;you&nbsp;want&nbsp;to&nbsp;approach.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;There&nbsp;are&nbsp;two&nbsp;reasons&nbsp;for&nbsp;us&nbsp;to&nbsp;make&nbsp;a&nbsp;certain&nbsp;feature&nbsp;optional&nbsp;on&nbsp;mono.&nbsp;It’s&nbsp;either&nbsp;because&nbsp;we&nbsp;can’t&nbsp;support&nbsp;it&nbsp;on&nbsp;a&nbsp;specific&nbsp;configuration&nbsp;(SRE&nbsp;without&nbsp;a&nbsp;JIT)&nbsp;or&nbsp;because<br>
&nbsp;the&nbsp;benefit/cost&nbsp;ratio&nbsp;is&nbsp;horrible&nbsp;(System.Configuration&nbsp;on&nbsp;mobile).&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;In&nbsp;the&nbsp;case&nbsp;of&nbsp;ICastable,&nbsp;by&nbsp;design&nbsp;we’ll&nbsp;have&nbsp;ubiquitous&nbsp;support&nbsp;and&nbsp;the&nbsp;cost&nbsp;of&nbsp;having&nbsp;it&nbsp;across&nbsp;the&nbsp;board&nbsp;is&nbsp;minimal&nbsp;(a&nbsp;slower&nbsp;slow&nbsp;path&nbsp;and&nbsp;little&nbsp;code/footprint&nbsp;we&nbsp;could<br>
&nbsp;eliminate).&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;To&nbsp;sum&nbsp;up,&nbsp;I&nbsp;don’t&nbsp;see&nbsp;us&nbsp;disabling&nbsp;ICastable&nbsp;on&nbsp;any&nbsp;of&nbsp;Xamarin’s&nbsp;targets,&nbsp;so&nbsp;we&nbsp;gain&nbsp;nothing&nbsp;by&nbsp;making&nbsp;it&nbsp;optional.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;--&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Rodrigo&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;div&nbsp;style=&quot;border:none;border-top:solid&nbsp;#B5C4DF&nbsp;1.0pt;padding:3.0pt&nbsp;0in&nbsp;0in&nbsp;0in&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Calibri&quot;,sans-serif;color:black&quot;&gt;From:<br>
&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Calibri&quot;,sans-serif;color:black&quot;&gt;Johan&nbsp;Lorensson&nbsp;&lt;lateralusx.github@gmail.com&gt;&lt;br&gt;<br>
&lt;b&gt;Date:&nbsp;&lt;/b&gt;Wednesday,&nbsp;May&nbsp;17,&nbsp;2017&nbsp;at&nbsp;4:41&nbsp;AM&lt;br&gt;<br>
&lt;b&gt;To:&nbsp;&lt;/b&gt;Rodrigo&nbsp;Kumpera&nbsp;&lt;rokumper@microsoft.com&gt;&lt;br&gt;<br>
&lt;b&gt;Cc:&nbsp;&lt;/b&gt;&quot;mono-devel-list@lists.dot.net&quot;&nbsp;&lt;mono-devel-list@lists.dot.net&gt;&lt;br&gt;<br>
&lt;b&gt;Subject:&nbsp;&lt;/b&gt;Re:&nbsp;[Mono-dev]&nbsp;Supporting&nbsp;ICastable&nbsp;on&nbsp;Mono&nbsp;Windows&nbsp;x64.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Hi&nbsp;Rodrigo,&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Thanks&nbsp;for&nbsp;feedback!&nbsp;I&nbsp;believe&nbsp;I&nbsp;could&nbsp;adopt&nbsp;using&nbsp;the&nbsp;IMT&nbsp;approach&nbsp;instead&nbsp;of&nbsp;patching&nbsp;the&nbsp;vtable&nbsp;(will&nbsp;simplify&nbsp;the&nbsp;solution).&nbsp;When&nbsp;I&nbsp;tried&nbsp;this&nbsp;in&nbsp;the&nbsp;past&nbsp;it&nbsp;didn't&nbsp;work&nbsp;out&nbsp;as&nbsp;expected&nbsp;so&nbsp;then&nbsp;I&nbsp;started&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;transparent&nbsp;proxy<br>
&nbsp;solution,&nbsp;since&nbsp;it&nbsp;seemed&nbsp;to&nbsp;be&nbsp;quite&nbsp;close&nbsp;to&nbsp;what&nbsp;I&nbsp;was&nbsp;looking&nbsp;for.&nbsp;Based&nbsp;on&nbsp;your&nbsp;feedback&nbsp;I&nbsp;did&nbsp;a&nbsp;quick&nbsp;tests&nbsp;of&nbsp;switching&nbsp;to&nbsp;IMT&nbsp;together&nbsp;with&nbsp;the&nbsp;rest&nbsp;of&nbsp;ICastable&nbsp;changes&nbsp;&#43;&nbsp;armed&nbsp;with&nbsp;a&nbsp;deeper&nbsp;knowledge&nbsp;around&nbsp;Mono's&nbsp;implementation&nbsp;of&nbsp;vtable's&nbsp;and&nbsp;type<br>
&nbsp;system,&nbsp;and&nbsp;it&nbsp;seems&nbsp;to&nbsp;work,&nbsp;getting&nbsp;pass&nbsp;on&nbsp;ICastable&nbsp;test&nbsp;suite,&nbsp;&#43;&nbsp;MCG&nbsp;sample.&nbsp;I&nbsp;already&nbsp;had&nbsp;most&nbsp;code&nbsp;in&nbsp;place,&nbsp;so&nbsp;what&nbsp;I&nbsp;did&nbsp;was&nbsp;to&nbsp;make&nbsp;sure&nbsp;we&nbsp;get&nbsp;a&nbsp;IMT&nbsp;fail&nbsp;tramp&nbsp;for&nbsp;vtables&nbsp;supporting&nbsp;ICastable&nbsp;(will&nbsp;be&nbsp;the&nbsp;same&nbsp;fail&nbsp;tramp&nbsp;as&nbsp;other&nbsp;cases,&nbsp;callbacks.get_imt_trampoline).<br>
&nbsp;I&nbsp;already&nbsp;have&nbsp;logic&nbsp;in&nbsp;mono_vcall_trampoline&nbsp;to&nbsp;take&nbsp;care&nbsp;of&nbsp;resolving&nbsp;methods&nbsp;on&nbsp;ICastable&nbsp;objects&nbsp;and&nbsp;all&nbsp;seems&nbsp;to&nbsp;be&nbsp;working&nbsp;as&nbsp;expected.&nbsp;For&nbsp;methods&nbsp;implemented&nbsp;directly&nbsp;by&nbsp;a&nbsp;class&nbsp;that&nbsp;also&nbsp;implements&nbsp;ICastable,&nbsp;I&nbsp;already&nbsp;had&nbsp;solution&nbsp;making&nbsp;sure&nbsp;standard<br>
&nbsp;method&nbsp;resolve&nbsp;still&nbsp;kicks&nbsp;in,&nbsp;so&nbsp;the&nbsp;slow&nbsp;path&nbsp;will&nbsp;only&nbsp;be&nbsp;hit&nbsp;when&nbsp;calling&nbsp;methods&nbsp;not&nbsp;directly&nbsp;implemented&nbsp;by&nbsp;class,&nbsp;doing&nbsp;call&nbsp;to&nbsp;ICastable::GetImplType&nbsp;to&nbsp;get&nbsp;to&nbsp;the&nbsp;implementation.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;When&nbsp;it&nbsp;comes&nbsp;to&nbsp;the&nbsp;broader&nbsp;refactoring&nbsp;idea&nbsp;I&nbsp;think&nbsp;we&nbsp;could&nbsp;do&nbsp;this&nbsp;work&nbsp;in&nbsp;several&nbsp;steps.&nbsp;First&nbsp;step&nbsp;is&nbsp;to&nbsp;getting&nbsp;ICastable&nbsp;done&nbsp;together&nbsp;with&nbsp;the&nbsp;rest&nbsp;of&nbsp;changes&nbsp;needed&nbsp;for&nbsp;the&nbsp;MCG&nbsp;use&nbsp;case&nbsp;to&nbsp;work&nbsp;on&nbsp;the&nbsp;platforms&nbsp;we&nbsp;initial&nbsp;need<br>
&nbsp;it.&nbsp;Once&nbsp;all&nbsp;that&nbsp;is&nbsp;working&nbsp;we&nbsp;can&nbsp;move&nbsp;back&nbsp;to&nbsp;do&nbsp;an&nbsp;overhaul&nbsp;of&nbsp;the&nbsp;type&nbsp;checking&nbsp;and&nbsp;casting&nbsp;unifying&nbsp;it&nbsp;where&nbsp;it&nbsp;makes&nbsp;sense.&nbsp;We&nbsp;could&nbsp;keep&nbsp;patches&nbsp;at&nbsp;our&nbsp;end&nbsp;until&nbsp;all&nbsp;is&nbsp;done&nbsp;and&nbsp;then&nbsp;upstream,&nbsp;or&nbsp;we&nbsp;could&nbsp;issue&nbsp;PR's&nbsp;upstream&nbsp;in&nbsp;several&nbsp;steps&nbsp;as&nbsp;we<br>
&nbsp;go.&nbsp;One&nbsp;thing&nbsp;I'm&nbsp;a&nbsp;little&nbsp;worried&nbsp;around&nbsp;is&nbsp;the&nbsp;regression&nbsp;impact&nbsp;refactoring&nbsp;the&nbsp;casting&nbsp;logic.&nbsp;The&nbsp;ICastable&nbsp;changes&nbsp;are&nbsp;still&nbsp;quite&nbsp;isolated&nbsp;to&nbsp;this&nbsp;use&nbsp;case&nbsp;and&nbsp;won't&nbsp;change&nbsp;other&nbsp;casting&nbsp;scenarios,&nbsp;but&nbsp;doing&nbsp;the&nbsp;bigger&nbsp;refactoring&nbsp;will&nbsp;of&nbsp;course&nbsp;open<br>
&nbsp;up&nbsp;for&nbsp;more&nbsp;potential&nbsp;problems.&nbsp;I&nbsp;assume&nbsp;we&nbsp;have&nbsp;tests&nbsp;covering&nbsp;most&nbsp;of&nbsp;the&nbsp;scenarios,&nbsp;special&nbsp;array,&nbsp;interfaces,&nbsp;TP&nbsp;and&nbsp;ones&nbsp;ICastable&nbsp;is&nbsp;in&nbsp;place,&nbsp;we&nbsp;will&nbsp;have&nbsp;a&nbsp;test&nbsp;suite&nbsp;covering&nbsp;that&nbsp;as&nbsp;well,&nbsp;to&nbsp;mitigate&nbsp;potential&nbsp;regression&nbsp;problems&nbsp;in&nbsp;areas&nbsp;not&nbsp;hit<br>
&nbsp;that&nbsp;frequent.&nbsp;This&nbsp;might&nbsp;be&nbsp;another&nbsp;reason&nbsp;for&nbsp;doing&nbsp;the&nbsp;change&nbsp;in&nbsp;more&nbsp;than&nbsp;one&nbsp;step,&nbsp;making&nbsp;it&nbsp;easier&nbsp;to&nbsp;track&nbsp;potential&nbsp;regression&nbsp;problems&nbsp;related&nbsp;to&nbsp;changes.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Regarding&nbsp;ICastable&nbsp;and&nbsp;reflection,&nbsp;as&nbsp;far&nbsp;as&nbsp;I&nbsp;know&nbsp;and&nbsp;have&nbsp;seen,&nbsp;it&nbsp;is&nbsp;not&nbsp;supported&nbsp;in&nbsp;CoreCLR&nbsp;for&nbsp;ICastable&nbsp;and&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;be&nbsp;needed&nbsp;by&nbsp;use&nbsp;cases&nbsp;as&nbsp;MCG.&nbsp;The&nbsp;ICastable&nbsp;test&nbsp;suite&nbsp;in&nbsp;CoreCLR&nbsp;(that&nbsp;I'm&nbsp;using&nbsp;as&nbsp;well)&nbsp;don't&nbsp;include<br>
&nbsp;any&nbsp;tests&nbsp;for&nbsp;reflection&nbsp;in&nbsp;it.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Regarding&nbsp;making&nbsp;ICastable&nbsp;feature&nbsp;mandatory&nbsp;in&nbsp;Mono?&nbsp;CoreCLR&nbsp;guards&nbsp;it's&nbsp;implementation&nbsp;with&nbsp;a&nbsp;define&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;set&nbsp;in&nbsp;order&nbsp;to&nbsp;get&nbsp;ICastable&nbsp;runtime&nbsp;support,&nbsp;FEATURE_ICASTABLE.&nbsp;If&nbsp;ICastable&nbsp;should&nbsp;be&nbsp;considered&nbsp;a&nbsp;supported&nbsp;feature<br>
&nbsp;in&nbsp;Mono,&nbsp;maybe&nbsp;it&nbsp;could&nbsp;still&nbsp;make&nbsp;sense&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;disable&nbsp;it&nbsp;using&nbsp;a&nbsp;define&nbsp;like&nbsp;DISABLE_ICASTABLE?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Johan&nbsp;Lorensson&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;On&nbsp;Wed,&nbsp;May&nbsp;17,&nbsp;2017&nbsp;at&nbsp;12:36&nbsp;AM,&nbsp;Rodrigo&nbsp;Kumpera&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rokumper@microsoft.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rokumper@microsoft.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;blockquote&nbsp;style=&quot;border:none;border-left:solid&nbsp;#CCCCCC&nbsp;1.0pt;padding:0in&nbsp;0in&nbsp;0in&nbsp;6.0pt;margin-left:4.8pt;margin-right:0in&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Hi&nbsp;Johan,&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Transparent&nbsp;proxy&nbsp;needs&nbsp;to&nbsp;extend&nbsp;the&nbsp;vtable&nbsp;due&nbsp;to&nbsp;virtual&nbsp;methods.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;ICastable&nbsp;(IC),&nbsp;IIRC,&nbsp;doesn't&nbsp;need&nbsp;to,&nbsp;as&nbsp;it's&nbsp;only&nbsp;possible&nbsp;to&nbsp;dispatch&nbsp;to&nbsp;interface&nbsp;methods.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Beyond&nbsp;that,&nbsp;vtable&nbsp;patching&nbsp;has&nbsp;a&nbsp;lot&nbsp;of&nbsp;other&nbsp;complications,&nbsp;it&nbsp;breaks&nbsp;invariants&nbsp;such&nbsp;as&nbsp;that&nbsp;two&nbsp;instances&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;of&nbsp;the&nbsp;same&nbsp;class&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;vtable&nbsp;pointer&nbsp;-&nbsp;we&nbsp;compare&nbsp;them&nbsp;all&nbsp;over&nbsp;the&nbsp;place.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;My&nbsp;suggestion&nbsp;is&nbsp;the&nbsp;following:&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Types&nbsp;implementing&nbsp;IC&nbsp;would&nbsp;force&nbsp;their&nbsp;IMT&nbsp;thunks&nbsp;to&nbsp;have&nbsp;a&nbsp;fail&nbsp;tramp,&nbsp;in&nbsp;a&nbsp;similar&nbsp;fashion&nbsp;as&nbsp;its&nbsp;done&nbsp;for&nbsp;other<br>
&nbsp;cases.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;The&nbsp;imt&nbsp;fail&nbsp;trampoline&nbsp;code&nbsp;would&nbsp;then&nbsp;be&nbsp;adjusted&nbsp;to&nbsp;handle&nbsp;IC.&nbsp;It's&nbsp;a&nbsp;much&nbsp;simpler&nbsp;and&nbsp;maintainable&nbsp;change.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;That&nbsp;would&nbsp;not&nbsp;require&nbsp;changes&nbsp;to&nbsp;our&nbsp;compilation&nbsp;pipeline.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;The&nbsp;comes&nbsp;the&nbsp;second&nbsp;part,&nbsp;type&nbsp;testing.&nbsp;We&nbsp;should&nbsp;be&nbsp;taking&nbsp;this&nbsp;opportunity&nbsp;to&nbsp;clean&nbsp;up&nbsp;the&nbsp;casting&nbsp;code&nbsp;a&nbsp;bit.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;My&nbsp;suggestion&nbsp;is&nbsp;that&nbsp;we&nbsp;use&nbsp;space&nbsp;in&nbsp;the&nbsp;vtable&nbsp;to&nbsp;indicate&nbsp;whether&nbsp;type&nbsp;testing&nbsp;has&nbsp;a&nbsp;slow&nbsp;path.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Right&nbsp;now,&nbsp;we&nbsp;have&nbsp;a&nbsp;couple&nbsp;of&nbsp;cases:&nbsp;special&nbsp;array&nbsp;interfaces&nbsp;and&nbsp;TP.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;My&nbsp;suggestion&nbsp;is&nbsp;to&nbsp;unify&nbsp;the&nbsp;TP&nbsp;and&nbsp;the&nbsp;ICastable&nbsp;checks&nbsp;in&nbsp;the&nbsp;common&nbsp;path&nbsp;and&nbsp;outline&nbsp;the&nbsp;resolution&nbsp;of&nbsp;those.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;We&nbsp;should&nbsp;them&nbsp;experiment&nbsp;applying&nbsp;the&nbsp;same&nbsp;idea&nbsp;to&nbsp;special&nbsp;array&nbsp;interfaces&nbsp;and&nbsp;see&nbsp;whether&nbsp;performance&nbsp;numbers<br>
&nbsp;hold.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;We'd&nbsp;need&nbsp;to&nbsp;add&nbsp;checks&nbsp;for&nbsp;IC&nbsp;to&nbsp;all&nbsp;places&nbsp;we&nbsp;do&nbsp;today&nbsp;for&nbsp;TP.&nbsp;They&nbsp;might&nbsp;require&nbsp;big&nbsp;code&nbsp;changes&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;as&nbsp;the&nbsp;TP&nbsp;checks&nbsp;don't&nbsp;require&nbsp;calling&nbsp;into&nbsp;managed&nbsp;while&nbsp;IC&nbsp;does.&nbsp;The&nbsp;comments&nbsp;in&nbsp;that&nbsp;C#&nbsp;file&nbsp;don't&nbsp;mention&nbsp;impact&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;on&nbsp;other&nbsp;parts&nbsp;of&nbsp;the&nbsp;runtime,&nbsp;like&nbsp;reflection,&nbsp;which&nbsp;we&nbsp;would&nbsp;need&nbsp;to&nbsp;verify&nbsp;as&nbsp;well.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;The&nbsp;above&nbsp;model&nbsp;is&nbsp;how&nbsp;I&nbsp;think&nbsp;TP&nbsp;should&nbsp;be&nbsp;implemented,&nbsp;but&nbsp;that&nbsp;code&nbsp;predates&nbsp;IMTs.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Finally,&nbsp;there's&nbsp;no&nbsp;point&nbsp;in&nbsp;making&nbsp;ICastable&nbsp;an&nbsp;optional&nbsp;feature&nbsp;as&nbsp;it&nbsp;should&nbsp;be&nbsp;supported&nbsp;across&nbsp;the&nbsp;board.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;--&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;Rodrigo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif&quot;&gt;&nbsp;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;div&nbsp;style=&quot;border:none;border-top:solid&nbsp;#B5C4DF&nbsp;1.0pt;padding:3.0pt&nbsp;0in&nbsp;0in&nbsp;0in&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Calibri&quot;,sans-serif;color:black&quot;&gt;From:<br>
&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Calibri&quot;,sans-serif;color:black&quot;&gt;Mono-devel-list&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:mono-devel-list-bounces@lists.dot.net&quot;&nbsp;target=&quot;_blank&quot;&gt;mono-devel-list-bounces@lists.dot.net&lt;/a&gt;&gt;&nbsp;on&nbsp;behalf&nbsp;of&nbsp;Johan&nbsp;Lorensson&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:lateralusx.github@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;lateralusx.github@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;b&gt;Date:&nbsp;&lt;/b&gt;Tuesday,&nbsp;May&nbsp;16,&nbsp;2017&nbsp;at&nbsp;2:44&nbsp;AM&lt;br&gt;<br>
&lt;b&gt;To:&nbsp;&lt;/b&gt;&quot;&lt;a&nbsp;href=&quot;mailto:mono-devel-list@lists.dot.net&quot;&nbsp;target=&quot;_blank&quot;&gt;mono-devel-list@lists.dot.net&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:mono-devel-list@lists.dot.net&quot;&nbsp;target=&quot;_blank&quot;&gt;mono-devel-list@lists.dot.net&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;b&gt;Subject:&nbsp;&lt;/b&gt;[Mono-dev]&nbsp;Supporting&nbsp;ICastable&nbsp;on&nbsp;Mono&nbsp;Windows&nbsp;x64.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;Hi,<br>
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;Below&nbsp;is&nbsp;a&nbsp;proposed&nbsp;solution&nbsp;to&nbsp;implement&nbsp;support&nbsp;of&nbsp;CoreCLR&nbsp;ICastable&nbsp;feature&nbsp;on&nbsp;Mono&nbsp;Windows&nbsp;x64.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;b&gt;Why:&lt;/b&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;ICastable&nbsp;is&nbsp;supported&nbsp;by&nbsp;CoreCLR&nbsp;and&nbsp;used&nbsp;by&nbsp;MCG&nbsp;(Microsoft&nbsp;interop&nbsp;codegen&nbsp;tooling&nbsp;for&nbsp;WinRT&nbsp;API's)&nbsp;in&nbsp;order&nbsp;to&nbsp;call&nbsp;WinRT&nbsp;API's&nbsp;from&nbsp;managed&nbsp;code&nbsp;on&nbsp;Windows&nbsp;platforms.&nbsp;MCG&nbsp;consumes<br>
&nbsp;winmd&nbsp;files&nbsp;&#43;&nbsp;a&nbsp;closure&nbsp;of&nbsp;WinRT&nbsp;API&nbsp;used&nbsp;by&nbsp;an&nbsp;application&nbsp;generating&nbsp;managed&nbsp;interop&nbsp;code.&nbsp;Supporting&nbsp;ICastable&nbsp;is&nbsp;a&nbsp;prerequisite&nbsp;in&nbsp;order&nbsp;to&nbsp;support&nbsp;MCG&nbsp;on&nbsp;Mono&nbsp;Windows&nbsp;x64.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;The&nbsp;requirements&nbsp;on&nbsp;the&nbsp;ICastable&nbsp;feature&nbsp;is&nbsp;described&nbsp;in&nbsp;the&nbsp;interface:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;a&nbsp;href=&quot;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Fcoreclr%2Fblob%2F68f72dd2587c3365a9fe74d1991f93612c3bc62a%2Fsrc%2Fmscorlib%2Fsrc%2FSystem%2FRuntime%2FCompilerServices%2FICastable.cs&amp;data=02%7C01%7Crokumper%40microsoft.com%7Cd254047ed900449f843e08d49c40321e%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636305246941657781&amp;sdata=t8tOm1Cvn9Klm4JwgxF%2BbeH%2Bqk%2B8sZbDOpIF2Q4t4Cc%3D&amp;reserved=0&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/dotnet/coreclr/blob/68f72dd2587c3365a9fe74d1991f93612c3bc62a/src/mscorlib/src/System/Runtime/CompilerServices/ICastable.cs&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;There&nbsp;is&nbsp;also&nbsp;a&nbsp;test&nbsp;case&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;validate&nbsp;Mono's&nbsp;implementation&nbsp;of&nbsp;ICastable:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;a&nbsp;href=&quot;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Fcoreclr%2Fblob%2F84aab5f59d023849b9ccdc290e698e4a61ac75a2%2Ftests%2Fsrc%2FInterop%2FICastable%2FCastable.cs&amp;data=02%7C01%7Crokumper%40microsoft.com%7Cd254047ed900449f843e08d49c40321e%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636305246941657781&amp;sdata=srFnEjYYl0MlveNf0dOKlydPiuXnb8Yy44XwVncoNWM%3D&amp;reserved=0&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/dotnet/coreclr/blob/84aab5f59d023849b9ccdc290e698e4a61ac75a2/tests/src/Interop/ICastable/Castable.cs&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;The&nbsp;ICastable&nbsp;implementation&nbsp;&#43;&nbsp;additional&nbsp;Mono&nbsp;extensions&nbsp;will&nbsp;also&nbsp;be&nbsp;used&nbsp;to&nbsp;run&nbsp;a&nbsp;couple&nbsp;of&nbsp;MCG-&gt;WinRT&nbsp;samples&nbsp;testing&nbsp;MCG's&nbsp;usage&nbsp;of&nbsp;Mono's&nbsp;ICastable&nbsp;implementation.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;All&nbsp;should&nbsp;work&nbsp;on&nbsp;Windows&nbsp;x64&nbsp;JIT&nbsp;&#43;&nbsp;full&nbsp;AOT.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;b&gt;How:&lt;/b&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;ICastable&nbsp;is&nbsp;a&nbsp;specific&nbsp;feature&nbsp;with&nbsp;several&nbsp;restrictions&nbsp;and&nbsp;constraints.&nbsp;The&nbsp;purpose&nbsp;is&nbsp;to&nbsp;dynamically,&nbsp;at&nbsp;runtime,&nbsp;add&nbsp;interfaces&nbsp;and&nbsp;implementation&nbsp;to&nbsp;a&nbsp;type&nbsp;that&nbsp;is&nbsp;not&nbsp;part<br>
&nbsp;of&nbsp;the&nbsp;types&nbsp;original&nbsp;metadata.&nbsp;The&nbsp;added&nbsp;interfaces&nbsp;are&nbsp;then&nbsp;implemented&nbsp;by&nbsp;a&nbsp;complete&nbsp;different&nbsp;unrelated&nbsp;type&nbsp;returned&nbsp;by&nbsp;implementation&nbsp;of&nbsp;ICastable&nbsp;interface.&nbsp;That&nbsp;put&nbsp;some&nbsp;specific&nbsp;requirements&nbsp;on&nbsp;both&nbsp;the&nbsp;runtime&nbsp;but&nbsp;also&nbsp;on&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the<br>
&nbsp;class&nbsp;implementing&nbsp;the&nbsp;ICastable&nbsp;interface&nbsp;and&nbsp;its&nbsp;dispatch&nbsp;targets.&nbsp;Due&nbsp;to&nbsp;this,&nbsp;the&nbsp;feature&nbsp;should&nbsp;be&nbsp;considered&nbsp;&quot;Private&quot;&nbsp;limiting&nbsp;it's&nbsp;use&nbsp;and&nbsp;support&nbsp;to&nbsp;specific&nbsp;use&nbsp;cases.&nbsp;The&nbsp;main&nbsp;initial&nbsp;target&nbsp;is&nbsp;MCG&nbsp;stubs&nbsp;and&nbsp;interopability&nbsp;with&nbsp;WinRT&nbsp;API's&nbsp;on&nbsp;Windows<br>
&nbsp;platforms.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;u&gt;Extending&nbsp;Mono&nbsp;Runtime:&lt;/u&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;Looking&nbsp;into&nbsp;the&nbsp;current&nbsp;Mono&nbsp;source&nbsp;there&nbsp;is&nbsp;currently&nbsp;a&nbsp;feature&nbsp;that&nbsp;has&nbsp;similar&nbsp;characteristics&nbsp;and&nbsp;behavior&nbsp;as&nbsp;ICastable,&nbsp;transparent&nbsp;proxy&nbsp;support&nbsp;used&nbsp;by&nbsp;remoting.&nbsp;The&nbsp;plan<br>
&nbsp;is&nbsp;to&nbsp;use&nbsp;that&nbsp;as&nbsp;inspiration&nbsp;but&nbsp;not&nbsp;depending&nbsp;on&nbsp;current&nbsp;implementation&nbsp;(should&nbsp;not&nbsp;need&nbsp;to&nbsp;include&nbsp;remoting&nbsp;support&nbsp;to&nbsp;work).&nbsp;The&nbsp;underlying&nbsp;mechanism&nbsp;is&nbsp;still&nbsp;similar,&nbsp;dynamically&nbsp;extend&nbsp;an&nbsp;objects&nbsp;vtable&nbsp;if&nbsp;an&nbsp;objects&nbsp;gets&nbsp;casted&nbsp;to&nbsp;an&nbsp;interface&nbsp;indirectly<br>
&nbsp;supported&nbsp;by&nbsp;the&nbsp;underlying&nbsp;implementation&nbsp;of&nbsp;ICastable&nbsp;(or&nbsp;IRemotingTypeInfo.CanCastTo&nbsp;in&nbsp;remoting&nbsp;use&nbsp;case).&nbsp;The&nbsp;idea&nbsp;is&nbsp;to&nbsp;generalize&nbsp;and&nbsp;share&nbsp;the&nbsp;code&nbsp;already&nbsp;doing&nbsp;this&nbsp;logic&nbsp;in&nbsp;remoting&nbsp;making&nbsp;sure&nbsp;we&nbsp;only&nbsp;include&nbsp;one&nbsp;implementation&nbsp;of&nbsp;key&nbsp;features<br>
&nbsp;like&nbsp;rebuilding&nbsp;the&nbsp;vtable&nbsp;(currently&nbsp;done&nbsp;in&nbsp;mono_class_proxy_vtable).&nbsp;ICastable&nbsp;implementation&nbsp;will&nbsp;also&nbsp;include&nbsp;a&nbsp;cache&nbsp;similar&nbsp;to&nbsp;the&nbsp;one&nbsp;used&nbsp;in&nbsp;the&nbsp;remoting&nbsp;use&nbsp;case&nbsp;(see&nbsp;mono_upgrade_remote_class&nbsp;for&nbsp;details).&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;All&nbsp;code&nbsp;related&nbsp;to&nbsp;the&nbsp;ICastable&nbsp;feature&nbsp;will&nbsp;be&nbsp;guarded&nbsp;by&nbsp;a&nbsp;defined,&nbsp;FEATURE_ICASTABLE,&nbsp;so&nbsp;all&nbsp;platforms&nbsp;not&nbsp;needing&nbsp;this&nbsp;support&nbsp;(currently&nbsp;only&nbsp;needed&nbsp;on&nbsp;WinRT&nbsp;platforms),<br>
&nbsp;won't&nbsp;be&nbsp;affected&nbsp;by&nbsp;this&nbsp;change.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;u&gt;Extending&nbsp;Mono&nbsp;BCL:&lt;/u&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;The&nbsp;ICastable&nbsp;implementation&nbsp;&#43;&nbsp;helper&nbsp;class&nbsp;can&nbsp;be&nbsp;included&nbsp;from&nbsp;CoreCLR&nbsp;into&nbsp;Mono's&nbsp;mscorlib&nbsp;with&nbsp;a&nbsp;small&nbsp;adjustment&nbsp;to&nbsp;the&nbsp;helper&nbsp;class:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;a&nbsp;href=&quot;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Fcoreclr%2Fblob%2F68f72dd2587c3365a9fe74d1991f93612c3bc62a%2Fsrc%2Fmscorlib%2Fsrc%2FSystem%2FRuntime%2FCompilerServices%2FICastable.cs&amp;data=02%7C01%7Crokumper%40microsoft.com%7Cd254047ed900449f843e08d49c40321e%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636305246941657781&amp;sdata=t8tOm1Cvn9Klm4JwgxF%2BbeH%2Bqk%2B8sZbDOpIF2Q4t4Cc%3D&amp;reserved=0&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/dotnet/coreclr/blob/68f72dd2587c3365a9fe74d1991f93612c3bc62a/src/mscorlib/src/System/Runtime/CompilerServices/ICastable.cs&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;Part&nbsp;of&nbsp;supporting&nbsp;ICastable&nbsp;includes&nbsp;adding&nbsp;the&nbsp;above&nbsp;assembly&nbsp;and&nbsp;classes&nbsp;to&nbsp;Mono's&nbsp;BCL.&nbsp;It&nbsp;should&nbsp;build&nbsp;under&nbsp;net_4_x&nbsp;and&nbsp;winAOT&nbsp;profiles.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&lt;u&gt;Examples&nbsp;of&nbsp;things&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;to&nbsp;support&nbsp;ICastable:&lt;/u&gt;<br>
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;ul&nbsp;type=&quot;disc&quot;&gt;<br>
&lt;li&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;<br>
Extend&nbsp;MonoVTable&nbsp;with&nbsp;a&nbsp;field&nbsp;indicating&nbsp;support&nbsp;for&nbsp;ICastable&nbsp;(optimization&nbsp;for&nbsp;fast&nbsp;lookups&nbsp;and&nbsp;checks).&nbsp;Since&nbsp;this&nbsp;field&nbsp;is&nbsp;checked&nbsp;both&nbsp;by&nbsp;C&nbsp;code&nbsp;and&nbsp;generated&nbsp;code&nbsp;(handle_isinst,&nbsp;handle_castclass)&nbsp;it&nbsp;needs&nbsp;to&nbsp;be&nbsp;addressable.&nbsp;Field&nbsp;will&nbsp;also&nbsp;be&nbsp;used&nbsp;to<br>
&nbsp;include&nbsp;more&nbsp;meta&nbsp;information&nbsp;when&nbsp;an&nbsp;object&nbsp;implements&nbsp;ICastable&nbsp;and&nbsp;has&nbsp;been&nbsp;casted&nbsp;to&nbsp;different&nbsp;interfaces&nbsp;(needed&nbsp;by&nbsp;both&nbsp;caching&nbsp;and&nbsp;vtable&nbsp;rebuild).&lt;o:p&gt;&lt;/o:p&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;<br>
Extend&nbsp;mono_object_handle_isinst_mbyref&nbsp;to&nbsp;have&nbsp;fallback&nbsp;for&nbsp;objects&nbsp;supporting&nbsp;ICastable.&lt;o:p&gt;&lt;/o:p&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;<br>
Extend&nbsp;handle_isinst&nbsp;and&nbsp;handle_castclass&nbsp;to&nbsp;have&nbsp;fallback&nbsp;for&nbsp;objects&nbsp;supporting&nbsp;ICastable.&lt;o:p&gt;&lt;/o:p&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;<br>
Extend&nbsp;objects&nbsp;vtable&nbsp;with&nbsp;new&nbsp;interfaces&nbsp;implemented&nbsp;by&nbsp;a&nbsp;different&nbsp;type&nbsp;indicated&nbsp;by&nbsp;ICastable::IsInstanceOfInterface.&nbsp;Similar&nbsp;to&nbsp;how&nbsp;mono_upgrade_remote_class&nbsp;works&nbsp;for&nbsp;remote&nbsp;objects.&lt;o:p&gt;&lt;/o:p&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;<br>
Add&nbsp;support&nbsp;to&nbsp;mono_vcall_trampoline&nbsp;to&nbsp;resolve&nbsp;method&nbsp;implementation&nbsp;for&nbsp;ICastable&nbsp;objects&nbsp;when&nbsp;not&nbsp;directly&nbsp;implemented&nbsp;by&nbsp;type.&nbsp;Implementing&nbsp;type&nbsp;for&nbsp;method&nbsp;is&nbsp;returned&nbsp;by&nbsp;ICastable::GetImplType.&lt;o:p&gt;&lt;/o:p&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;<br>
Cache&nbsp;dynamically&nbsp;generated&nbsp;vtables&nbsp;based&nbsp;on&nbsp;object&nbsp;class&nbsp;&#43;&nbsp;additional&nbsp;supported&nbsp;interface(s).&lt;o:p&gt;&lt;/o:p&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;<br>
Add&nbsp;support&nbsp;for&nbsp;CoreCLR&nbsp;ICastable&nbsp;interface&nbsp;and&nbsp;support&nbsp;class&nbsp;in&nbsp;Mono's&nbsp;mscorlib&nbsp;(net_4_x,&nbsp;winAOT&nbsp;profiles).&lt;o:p&gt;&lt;/o:p&gt;&lt;/li&gt;&lt;/ul&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;I&nbsp;have&nbsp;implemented&nbsp;a&nbsp;POC&nbsp;using&nbsp;the&nbsp;above&nbsp;approach&nbsp;and&nbsp;it&nbsp;solve&nbsp;the&nbsp;use&nbsp;case,&nbsp;getting&nbsp;pass&nbsp;on&nbsp;all&nbsp;tests&nbsp;in&nbsp;CoreCLR&nbsp;ICastable&nbsp;test&nbsp;suite&nbsp;and&nbsp;working&nbsp;with&nbsp;MCG&nbsp;stub&nbsp;samples,&nbsp;so&nbsp;above<br>
&nbsp;suggestion&nbsp;seems&nbsp;at&nbsp;least&nbsp;to&nbsp;be&nbsp;a&nbsp;way&nbsp;moving&nbsp;forward&nbsp;implementing&nbsp;support&nbsp;for&nbsp;ICastable&nbsp;on&nbsp;Mono&nbsp;Windows&nbsp;x64.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto&quot;&gt;Comments,&nbsp;thoughts&nbsp;and&nbsp;ideas&nbsp;are&nbsp;much&nbsp;appreciated.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
