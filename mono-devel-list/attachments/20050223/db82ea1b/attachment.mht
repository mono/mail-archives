[From nobody Fri Feb  8 08:59:37 2008
X-Account-Key: account4
X-Apparently-To: scott.mohekey@telogis.com via 68.142.224.172;
	Mon, 21 Feb 2005 19:36:15 -0800
X-Originating-IP: [66.163.175.82]
Return-Path: &lt;scott.mohekey@telogis.com&gt;
Received: from 66.163.175.82 (HELO smtp005.bizmail.sc5.yahoo.com)
	(66.163.175.82) by mta106.biz.mail.re2.yahoo.com with SMTP;
	Mon, 21 Feb 2005 19:36:15 -0800
Received: from unknown (HELO ?192.168.3.187?)
	(scott.mohekey@telogis.com@203.98.10.169 with plain)
	by smtp005.bizmail.sc5.yahoo.com with SMTP; 22 Feb 2005 03:36:14 -0000
Message-ID: &lt;421AA8F0.5040307@telogis.com&gt;
Date: Tue, 22 Feb 2005 16:37:20 +1300
From: Scott Mohekey &lt;scott.mohekey@telogis.com&gt;
User-Agent: Mozilla Thunderbird 1.0 (X11/20050121)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: Scott Mohekey &lt;scott.mohekey@telogis.com&gt;
Subject: Re: [Mono-devel-list] marshal.c assertion failed.
References: &lt;4213D7AC.5070903@telogis.com&gt; &lt;421A55F7.8010406@telogis.com&gt;
In-Reply-To: &lt;421A55F7.8010406@telogis.com&gt;
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

After hacking away for the last 8 hours, I believe I've found the 
problem. However I'm unsure as to how to go about fixing it.

Essentially, when a delegate is finalized, the MonoJitInfo allocated for 
the delegate_trampoline is freed, regardless of whether other delegates 
are also using it. Therefore, when an identical delegate is later freed, 
an attempt to lookup the MonoJitInfo for the delegate_trampoline is 
made, which erroneously fails causing the assertion.

What would be the best way to go about fixing this?

Scott.


Scott Mohekey wrote:

&gt; Has no one else encountered this?
&gt;
&gt; We see this as often as once in every 4 or 5 requests, which is less 
&gt; than desireable.
&gt;
&gt; I've managed to narrow this down somewhat, and have the following 
&gt; information to offer:
&gt;
&gt; When the assertion occurs, it is always when attempting to free one of 
&gt; the delegates created in the class GdiPlusStreamHelper, which is in 
&gt; mcs/class/System.Drawing/System.Drawing/gdipFunctions.cs
&gt;
&gt; The codec being used is pngcodec.c in libgdiplus.
&gt;
&gt; Any help would be greatly appreciated.
&gt;
&gt; Scott.
&gt;
&gt;
&gt; Scott Mohekey wrote:
&gt;
&gt;&gt; We're using mono and mod-mono-server to host a large .net web 
&gt;&gt; application. When using mono from svn trunk, we frequently get the 
&gt;&gt; following assertion:
&gt;&gt;
&gt;&gt; ** ERROR **: file marshal.c: line 348 (mono_delegate_free_ftnptr): 
&gt;&gt; assertion failed: (ji)
&gt;&gt;
&gt;&gt; Is this a known issue?
&gt;&gt;
&gt;&gt; Scott.
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; Mono-devel-list mailing list
&gt;&gt; Mono-devel-list@lists.ximian.com
&gt;&gt; http://lists.ximian.com/mailman/listinfo/mono-devel-list
&gt;&gt;
&gt;
&gt;


]