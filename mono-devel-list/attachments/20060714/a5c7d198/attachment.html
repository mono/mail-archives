<tt>
Jonathan,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Not&nbsp;sure,&nbsp;but&nbsp;would&nbsp;the&nbsp;hdc&nbsp;need&nbsp;disposed&nbsp;(in&nbsp;the&nbsp;Dispose&nbsp;method)&nbsp;if&nbsp;the&nbsp;user&nbsp;never&nbsp;calls&nbsp;ReleaseHdc?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jonathan&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;7/14/06,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;<br>
Sebastien&nbsp;Pouliot&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sebastien.pouliot@gmail.com&quot;&gt;sebastien.pouliot@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hello&nbsp;Jonathan,&lt;br&gt;&lt;br&gt;Please&nbsp;add&nbsp;a&nbsp;space&nbsp;before&nbsp;the&nbsp;starting&nbsp;parenthesis&nbsp;(see&nbsp;Mono&nbsp;source&nbsp;code&lt;br&gt;guidelines&nbsp;in&nbsp;the&nbsp;wiki)&nbsp;and,&nbsp;more&nbsp;importantly,&nbsp;provide&nbsp;some&nbsp;unit&nbsp;test&lt;br&gt;cases&nbsp;for&nbsp;ReleaseHdc&nbsp;(e.g.&nbsp;what&nbsp;happens&nbsp;on&nbsp;a&nbsp;second&nbsp;call&nbsp;to<br>
&lt;br&gt;ReleaseHdc&nbsp;?).&lt;br&gt;&lt;br&gt;I'll&nbsp;commit&nbsp;everything&nbsp;asap&nbsp;(or,&nbsp;at&nbsp;worse,&nbsp;when&nbsp;I&nbsp;get&nbsp;back&nbsp;from&lt;br&gt;vacations).&lt;br&gt;&lt;br&gt;Thanks!&lt;br&gt;&lt;br&gt;On&nbsp;Fri,&nbsp;2006-07-14&nbsp;at&nbsp;18:04&nbsp;-0500,&nbsp;Jonathan&nbsp;Pobst&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;Patch&nbsp;to&nbsp;implement&nbsp;2.0&nbsp;parameterless&nbsp;<br>
Graphics.ReleaseHdc()&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;-&nbsp;Creates&nbsp;a&nbsp;private&nbsp;variable&nbsp;to&nbsp;hold&nbsp;the&nbsp;IntPtr&nbsp;that&nbsp;GetHdc()&nbsp;returns.&lt;br&gt;&amp;gt;&nbsp;-&nbsp;Stores&nbsp;IntPtr&nbsp;to&nbsp;private&nbsp;variable&nbsp;in&nbsp;GetHdc().&lt;br&gt;&amp;gt;&nbsp;-&nbsp;In&nbsp;ReleaseHdc(),&nbsp;call&nbsp;ReleaseHdc(IntPtr)&nbsp;passing&nbsp;stored&nbsp;IntPtr.<br>
&lt;br&gt;&amp;gt;&nbsp;-&nbsp;Set&nbsp;private&nbsp;variable&nbsp;back&nbsp;to&nbsp;IntPtr.Zero.&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;Please&nbsp;review&nbsp;and&nbsp;commit.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Thanks,&lt;br&gt;&amp;gt;&nbsp;Jonathan&lt;br&gt;&amp;gt;&nbsp;plain&nbsp;text&nbsp;document&nbsp;attachment&nbsp;(graphicsreleasehdc.patch)&lt;br&gt;&amp;gt;&nbsp;Index:&nbsp;Graphics.cs<br>
&lt;br&gt;&amp;gt;&nbsp;===================================================================&lt;br&gt;&amp;gt;&nbsp;---&nbsp;Graphics.cs&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(revision&nbsp;62615)&lt;br&gt;&amp;gt;&nbsp;+++&nbsp;Graphics.cs&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(working&nbsp;copy)&lt;br&gt;&amp;gt;&nbsp;@@&nbsp;-52,6&nbsp;+52,9&nbsp;@@&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;bool&nbsp;disposed&nbsp;=&nbsp;false;<br>
&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;float&nbsp;defDpiX&nbsp;=&nbsp;0;&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;float&nbsp;defDpiY&nbsp;=&nbsp;0;&lt;br&gt;&amp;gt;&nbsp;+#if&nbsp;NET_2_0&lt;br&gt;&amp;gt;&nbsp;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;internal&nbsp;IntPtr&nbsp;deviceContextHdc&nbsp;=&nbsp;IntPtr.Zero;&lt;br&gt;&amp;gt;&nbsp;+#endif&lt;br&gt;<br>
&amp;gt;&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;#if&nbsp;!NET_2_0&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[ComVisible(false)]&lt;br&gt;&amp;gt;&nbsp;@@&nbsp;-1771,6&nbsp;+1774,9&nbsp;@@&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;IntPtr&nbsp;hdc;&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;GDIPlus.CheckStatus&nbsp;(GDIPlus.GdipGetDC<br>
&nbsp;(this.nativeObject,&nbsp;out&nbsp;hdc));&lt;br&gt;&amp;gt;&nbsp;+#if&nbsp;NET_2_0&lt;br&gt;&amp;gt;&nbsp;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;deviceContextHdc&nbsp;=&nbsp;hdc;&lt;br&gt;&amp;gt;&nbsp;+#endif&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;hdc;&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;@@&nbsp;-2034,11&nbsp;+2040,18&nbsp;@@<br>
&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Status&nbsp;status&nbsp;=&nbsp;GDIPlus.GdipReleaseDC&nbsp;(nativeObject,&nbsp;hdc);&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;GDIPlus.CheckStatus&nbsp;(status);&lt;br&gt;&amp;gt;&nbsp;+&lt;br&gt;&amp;gt;&nbsp;+#if&nbsp;NET_2_0&lt;br&gt;&amp;gt;&nbsp;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if(hdc&nbsp;==&nbsp;deviceContextHdc)<br>
&lt;br&gt;&amp;gt;&nbsp;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;deviceContextHdc&nbsp;=&nbsp;IntPtr.Zero;&lt;br&gt;&amp;gt;&nbsp;+#endif&lt;br&gt;&amp;gt;&nbsp;+&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;#if&nbsp;NET_2_0&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;void&nbsp;ReleaseHdc()&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;&amp;gt;&nbsp;-<br>
&lt;br&gt;&amp;gt;&nbsp;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if(deviceContextHdc&nbsp;!=&nbsp;IntPtr.Zero)&lt;br&gt;&amp;gt;&nbsp;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ReleaseHdc(deviceContextHdc);&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;#endif&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[MonoTODO]&lt;br&gt;&amp;gt;&nbsp;_______________________________________________<br>
&lt;br&gt;&amp;gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list<br>
&lt;/a&gt;&lt;br&gt;--&lt;br&gt;Sebastien&nbsp;Pouliot&amp;nbsp;&amp;nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sebastien@ximian.com&quot;&gt;sebastien@ximian.com&lt;/a&gt;&amp;gt;&lt;br&gt;Blog:&nbsp;&lt;a&nbsp;href=&quot;http://pages.infinit.net/ctech/&quot;&gt;http://pages.infinit.net/ctech/&lt;/a&gt;&lt;br&gt;&lt;br&gt;_______________________________________________<br>
&lt;br&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list<br>
&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
