<tt>
Hi&nbsp;Luis,&lt;br&gt;&lt;br&gt;Most&nbsp;parts&nbsp;of&nbsp;your&nbsp;patch&nbsp;are&nbsp;ok&nbsp;to&nbsp;be&nbsp;commited.&nbsp;As&nbsp;I&nbsp;said&nbsp;before,&nbsp;it&amp;#39;s&nbsp;better&nbsp;to&nbsp;have&nbsp;separate&nbsp;patches&nbsp;to&nbsp;speed&nbsp;up&nbsp;the&nbsp;review.&nbsp;As&nbsp;you&nbsp;get&nbsp;more&nbsp;changes&nbsp;in,&nbsp;it&nbsp;will&nbsp;ease&nbsp;your&nbsp;work&nbsp;on&nbsp;preparing&nbsp;patches&nbsp;and&nbsp;will&nbsp;ease&nbsp;on&nbsp;tracking&nbsp;head&nbsp;changes.&lt;br&gt;<br>
&lt;br&gt;Right&nbsp;now&nbsp;I&amp;#39;m&nbsp;ok&nbsp;with&nbsp;the&nbsp;configure,&nbsp;mono_array_t&nbsp;and&nbsp;related&nbsp;changes.&nbsp;These&nbsp;were&nbsp;easy&nbsp;to&nbsp;review&nbsp;and&nbsp;don&amp;#39;t&nbsp;introduce&nbsp;any&nbsp;change&nbsp;in&nbsp;behavior,&nbsp;so&nbsp;we&nbsp;can&nbsp;check-in&nbsp;then&nbsp;right&nbsp;now.&nbsp;The&nbsp;others&nbsp;requires&nbsp;more&nbsp;testing&nbsp;from&nbsp;me&nbsp;and&nbsp;would&nbsp;be&nbsp;easier&nbsp;to&nbsp;both&nbsp;of&nbsp;us&nbsp;if&nbsp;done&nbsp;after.&nbsp;&lt;br&gt;<br>
Do&nbsp;you&nbsp;mind&nbsp;cooking&nbsp;you&nbsp;a&nbsp;patch&nbsp;only&nbsp;with&nbsp;the&nbsp;ok&nbsp;parts.&lt;br&gt;&lt;br&gt;Remember&nbsp;that&nbsp;you&nbsp;need&nbsp;to&nbsp;either&nbsp;release&nbsp;these&nbsp;changes&nbsp;under&nbsp;the&nbsp;X11&nbsp;license&nbsp;or&nbsp;have&nbsp;done&nbsp;some&nbsp;copyright&nbsp;assignment&nbsp;paperwork.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Rodrigo&lt;br&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;May&nbsp;8,&nbsp;2008&nbsp;at&nbsp;8:21&nbsp;PM,&nbsp;Luis&nbsp;F.&nbsp;Ortiz&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:LuisOrtiz@verizon.net&quot;&gt;LuisOrtiz@verizon.net&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;On&nbsp;May&nbsp;8,&nbsp;2008,&nbsp;at&nbsp;9:29&nbsp;AM,&nbsp;Rodrigo&nbsp;Kumpera&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
One&nbsp;important&nbsp;thing&nbsp;I&nbsp;forgot.&nbsp;If&nbsp;you&nbsp;break&nbsp;your&nbsp;patch&nbsp;into&nbsp;a&nbsp;few&nbsp;smaller&nbsp;ones&nbsp;the&nbsp;review&nbsp;process&nbsp;will&nbsp;be&nbsp;a&nbsp;lot&nbsp;easier&nbsp;to&nbsp;every&nbsp;one&nbsp;involved.&lt;br&gt;<br>
The&nbsp;first&nbsp;one&nbsp;can&nbsp;introduce&nbsp;new&nbsp;types&nbsp;and&nbsp;configuration&nbsp;foo;&nbsp;then&nbsp;other&nbsp;to&nbsp;fix&nbsp;codegen&nbsp;and&nbsp;Array&nbsp;methods&nbsp;and;&nbsp;at&nbsp;last,&nbsp;a&nbsp;bunch&nbsp;of&nbsp;fixes&nbsp;to&nbsp;classlib&nbsp;issues&nbsp;-like&nbsp;sockets,&nbsp;file&nbsp;i/o&nbsp;and&nbsp;so&nbsp;on.&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
Rodrigo&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
OK,&nbsp;here&nbsp;is&nbsp;another&nbsp;stab&nbsp;at&nbsp;the&nbsp;changes.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;modifies&nbsp;the&nbsp;following&nbsp;files:&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;a&nbsp;href=&quot;http://configure.in&quot;&nbsp;target=&quot;_blank&quot;&gt;configure.in&lt;/a&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;mono/metadata/object.c&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;mono/metadata/object.h&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;mono/metadata/icall-def.h&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;mono/metadata/icall.c&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;mono/metadata/socket-io.c&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
These&nbsp;files:&lt;br&gt;<br>
&amp;nbsp;1)&nbsp;Add&nbsp;a&nbsp;new&nbsp;configuration&nbsp;option,&nbsp;--enable-big-arrays,&nbsp;which&nbsp;defines&nbsp;conditionally&nbsp;defines&nbsp;MONO_BIG_ARRAYS&nbsp;in&nbsp;config.h,&lt;br&gt;<br>
&amp;nbsp;2)&nbsp;Add&nbsp;in&nbsp;mono/metadata/object.h&nbsp;:&lt;br&gt;<br>
&nbsp;&amp;nbsp;A)&nbsp;A&nbsp;new&nbsp;typedef&nbsp;for&nbsp;mono_array_size_t&nbsp;to&nbsp;be&nbsp;either&nbsp;guint32&nbsp;or&nbsp;guint64&lt;br&gt;<br>
&nbsp;&amp;nbsp;B)&nbsp;A&nbsp;new&nbsp;#define&nbsp;for&nbsp;MONO_ARRAY_MAX_INDEX&nbsp;for&nbsp;the&nbsp;biggest&nbsp;valid&nbsp;array&nbsp;index,&nbsp;i.e.&nbsp;G_MAXINTxx&lt;br&gt;<br>
&nbsp;&amp;nbsp;C)&nbsp;A&nbsp;new&nbsp;#define&nbsp;for&nbsp;MONO_ARRAY_MAX_SIZE&nbsp;for&nbsp;the&nbsp;biggest&nbsp;valid&nbsp;array&nbsp;allocation,&nbsp;i.e.&nbsp;G_MAXUINTxx&lt;br&gt;<br>
&nbsp;&amp;nbsp;D)&nbsp;The&nbsp;above&nbsp;all&nbsp;controlled&nbsp;by&nbsp;MONO_BIG_ARRAYS&lt;br&gt;<br>
&amp;nbsp;3)&nbsp;Modify&nbsp;the&nbsp;definitions&nbsp;of&nbsp;mono_array_new(),&nbsp;mono_array_new_full(),&nbsp;and&nbsp;mono_array_new_specific()&nbsp;to&nbsp;match,&lt;br&gt;<br>
&amp;nbsp;4)&nbsp;Modify&nbsp;the&nbsp;usages&nbsp;of&nbsp;those&nbsp;functions&nbsp;in&nbsp;the&nbsp;metadata&nbsp;directory&nbsp;to&nbsp;match,&lt;br&gt;<br>
&amp;nbsp;5)&nbsp;Add&nbsp;range&nbsp;checking&nbsp;in&nbsp;ves_icall_System_Array_CreateInstanceImpl64&nbsp;so&nbsp;it&nbsp;works&nbsp;with&nbsp;or&nbsp;without&nbsp;MONO_BIG_ARRAYS,&lt;br&gt;<br>
&amp;nbsp;6)&nbsp;Attempt&nbsp;to&nbsp;address&nbsp;all&nbsp;the&nbsp;mistakes&nbsp;you&nbsp;pointed&nbsp;out.&lt;br&gt;<br>
&lt;br&gt;<br>
These&nbsp;changes,&nbsp;in&nbsp;addition&nbsp;to&nbsp;the&nbsp;other&nbsp;changes&nbsp;I&nbsp;made,&nbsp;pass&nbsp;&amp;quot;make&nbsp;check&amp;quot;&nbsp;with&nbsp;the&nbsp;exception&nbsp;of&nbsp;Tests.test_0_regress_75832(),&nbsp;as&nbsp;previously&nbsp;confessed.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
/Ortiz/Luis&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
