Index: AssemblyName.cs
===================================================================
--- AssemblyName.cs	(revisi√≥n: 48211)
+++ AssemblyName.cs	(copia de trabajo)
@@ -37,6 +37,7 @@
 using System.Text;
 using System.Runtime.InteropServices;
 using System.Runtime.CompilerServices;
+using System.IO;
 
 using Mono.Security;
 
@@ -73,6 +74,7 @@
 		int processor_architecture;
 #endif
         #endregion
+		static readonly char [] delimiter = {','};
 		
 		public AssemblyName ()
 		{
@@ -83,9 +85,64 @@
 #if NET_2_0
 		public AssemblyName (string assemblyName)
 		{
-			name = assemblyName;
+			string [] parts;
+
+			if (assemblyName == null)
+				throw new ArgumentNullException ("assemblyName");
+			if (assemblyName == "")
+				throw new ArgumentException ("assemblyName cannot have zero length", "assemblyName");
+			
+			// Remove white spaces, to mimic .Net behavior
+			assemblyName = assemblyName.Replace (" ", "");
+			parts = assemblyName.Split (delimiter);
+			if (parts [0] == "")
+				throw new FileLoadException ("The assembly name is invalid.");
+
+			name = parts [0];
+			for (int i = 0; i < parts.Length; i++) {
+				try {
+					if (String.Compare (parts [i], 0, "Version=", 0, 8, true, CultureInfo.InvariantCulture) == 0)
+						version = new Version (parts [i].Substring (8, parts [i].Length - 8));
+					else if (String.Compare (parts [i], 0, "Culture=", 0, 8, true, CultureInfo.InvariantCulture) == 0) {
+						string culture = parts [i].Substring (8, parts [i].Length - 8);
+						if (String.Compare (culture, "neutral", true, CultureInfo.InvariantCulture) == 0)
+							culture = "";
+						cultureinfo = new CultureInfo (culture);
+					}
+					else if (String.Compare (parts [i], 0, "PublicKeyToken=", 0, 15, true, CultureInfo.InvariantCulture) == 0)
+						ParseKeyToken (parts [i].Substring (15, parts [i].Length - 15));
+					else if (String.Compare (parts [i], 0, "PublicKey=", 0, 10, true, CultureInfo.InvariantCulture) == 0)
+						ParseKey (parts [i].Substring (10, parts [i].Length - 10));
+				} catch {
+					throw new FileLoadException ("The assembly name is invalid.");
+				}
+			}
+			
 		}
 
+		[MethodImpl (MethodImplOptions.InternalCall)]
+		extern void InternalParseKeyToken (string keyToken);
+		
+		void ParseKeyToken (string kToken)
+		{
+			if (kToken.Length != 16)
+				throw new Exception ();
+
+			InternalParseKeyToken (kToken);
+		}
+
+		[MethodImpl (MethodImplOptions.InternalCall)]
+		extern void InternalParseKey (string key);
+		
+		void ParseKey (string key)
+		{
+			if (key.Length != 320)
+				throw new Exception ();
+			
+			flags = AssemblyNameFlags.PublicKey;
+			InternalParseKey (key);
+		}
+
 		[MonoTODO]
 		public ProcessorArchitecture ProcessorArchitecture {
 			get {
