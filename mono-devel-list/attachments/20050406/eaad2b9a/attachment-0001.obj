Index: ApplicationServer.cs
===================================================================
--- ApplicationServer.cs	(revision 42593)
+++ ApplicationServer.cs	(working copy)
@@ -104,7 +104,7 @@
 			set { verbose = value; }
 		}
 
-		private void AddApplication (string vhost, int vport, string vpath, string fullPath)
+		public void AddApplication (string vhost, int vport, string vpath, string fullPath)
 		{
 			// TODO - check for duplicates, sort, optimize, etc.
 			if (started)
@@ -280,9 +280,9 @@
 			stop = true;	
 			webSource.Dispose ();
 
-			// A foreground thread is required to end cleanly
-			Thread stopThread = new Thread (new ThreadStart (RealStop));
-			stopThread.Start ();
+ 			// A foreground thread is required to end cleanly
+ 			Thread stopThread = new Thread (new ThreadStart (RealStop));
+ 			stopThread.Start ();
 		}
 
 		void RealStop ()
@@ -526,6 +526,8 @@
 		}
 	}
 	
+	public delegate void CreateHost(IApplicationHost apphost);
+
 	public class VPathToHost
 	{
 		public readonly string vhost;
@@ -537,6 +539,8 @@
 		public IApplicationHost AppHost;
 		public IRequestBroker RequestBroker;
 
+		public CreateHost OnCreateHost;
+
 		public VPathToHost (string vhost, int vport, string vpath, string realPath)
 		{
 			this.vhost = (vhost != null) ? vhost.ToLower (CultureInfo.InvariantCulture) : null;
@@ -642,6 +646,9 @@
 			// Link the host in the application domain with a request broker in the main domain
 			RequestBroker = webSource.CreateRequestBroker ();
 			AppHost.RequestBroker = RequestBroker;
+
+			if (OnCreateHost!=null)
+				OnCreateHost(AppHost);
 		}
 	}
 	