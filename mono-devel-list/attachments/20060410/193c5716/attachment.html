<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7638.1&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[Mono-dev]&nbsp;HttpRequest.MapPath&nbsp;and&nbsp;UrlUtils.Combine&nbsp;codeduplication&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Hello&nbsp;Gonzalo,&lt;BR&gt;<br>
&lt;BR&gt;<br>
Probably&nbsp;I&nbsp;had&nbsp;to&nbsp;explain&nbsp;more.&nbsp;If&nbsp;you&nbsp;follow&nbsp;the&nbsp;flow&nbsp;in&nbsp;HttpRequest.MapPath,&nbsp;then&nbsp;you&nbsp;see&nbsp;that&nbsp;after&nbsp;handling&nbsp;backslashes,&nbsp;function&nbsp;UrlUtils.Combine&nbsp;is&nbsp;called,&nbsp;and&nbsp;the&nbsp;latter&nbsp;already&nbsp;has&nbsp;the&nbsp;very&nbsp;same&nbsp;code.&nbsp;First&nbsp;backslashes&nbsp;are&nbsp;handled,&nbsp;then&nbsp;check&nbsp;for&nbsp;rooted&nbsp;and&nbsp;call&nbsp;to&nbsp;Canonic.&nbsp;The&nbsp;only&nbsp;difference&nbsp;was&nbsp;that&nbsp;Combine&nbsp;checked&nbsp;for&nbsp;backslashes&nbsp;like&nbsp;the&nbsp;following:&lt;BR&gt;<br>
&lt;BR&gt;<br>
relPath&nbsp;=&nbsp;relPath.Replace&nbsp;(&amp;quot;\\&amp;quot;,&nbsp;&amp;quot;/&amp;quot;);&lt;BR&gt;<br>
&lt;BR&gt;<br>
So&nbsp;I&nbsp;replaced&nbsp;it&nbsp;with&nbsp;code&nbsp;from&nbsp;MapPath,&nbsp;looking&nbsp;like:&lt;BR&gt;<br>
&lt;BR&gt;<br>
if&nbsp;(System.IO.Path.DirectorySeparatorChar&nbsp;!='/')&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;relPath&nbsp;=&nbsp;relPath.Replace&nbsp;(System.IO.Path.DirectorySeparatorChar,&nbsp;'/');&lt;BR&gt;<br>
&lt;BR&gt;<br>
If&nbsp;you&nbsp;say&nbsp;that&nbsp;you&nbsp;want&nbsp;to&nbsp;replace&nbsp;backslashes&nbsp;on&nbsp;non-windows&nbsp;system,&nbsp;too,&nbsp;then&nbsp;I&nbsp;will&nbsp;leave&nbsp;Combine&nbsp;intact.&nbsp;But&nbsp;anyway&nbsp;the&nbsp;code&nbsp;that&nbsp;I&nbsp;removed&nbsp;from&nbsp;MapPath&nbsp;can&nbsp;be&nbsp;removed&nbsp;safely,&nbsp;Combine&nbsp;does&nbsp;all&nbsp;that&nbsp;anyway.&lt;BR&gt;<br>
&lt;BR&gt;<br>
What&nbsp;do&nbsp;you&nbsp;think?&lt;BR&gt;<br>
&lt;BR&gt;<br>
Regards,&lt;BR&gt;<br>
Andrew.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
-----Original&nbsp;Message-----&lt;BR&gt;<br>
From:&nbsp;mono-devel-list-bounces@lists.ximian.com&nbsp;on&nbsp;behalf&nbsp;of&nbsp;Gonzalo&nbsp;Paniagua&nbsp;Javier&lt;BR&gt;<br>
Sent:&nbsp;Sun&nbsp;4/9/2006&nbsp;10:56&nbsp;PM&lt;BR&gt;<br>
To:&nbsp;mono-devel-list@lists.ximian.com&lt;BR&gt;<br>
Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;HttpRequest.MapPath&nbsp;and&nbsp;UrlUtils.Combine&nbsp;codeduplication&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;Sun,&nbsp;2006-04-09&nbsp;at&nbsp;08:08&nbsp;-0700,&nbsp;Andrew&nbsp;Skiba&nbsp;wrote:&lt;BR&gt;<br>
&amp;gt;&nbsp;Hello.&lt;BR&gt;<br>
&amp;gt;&lt;BR&gt;<br>
&amp;gt;&nbsp;I&nbsp;found&nbsp;code&nbsp;duplication,&nbsp;please&nbsp;review&nbsp;the&nbsp;patch&nbsp;to&nbsp;remove&nbsp;it.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Sometimes&nbsp;we&nbsp;have&nbsp;ASP.NET&nbsp;files&nbsp;copied&nbsp;from&nbsp;windows&nbsp;that&nbsp;have&nbsp;stuff&nbsp;like&lt;BR&gt;<br>
'Src=&amp;quot;.\someotherfile.ascx&amp;quot;.&nbsp;The&nbsp;code&nbsp;that&nbsp;you're&nbsp;removing&nbsp;handles&nbsp;that.&lt;BR&gt;<br>
Don't&nbsp;commit.&lt;BR&gt;<br>
&lt;BR&gt;<br>
-Gonzalo&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
_______________________________________________&lt;BR&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;BR&gt;<br>
Mono-devel-list@lists.ximian.com&lt;BR&gt;<br>
&lt;A&nbsp;HREF=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/A&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
