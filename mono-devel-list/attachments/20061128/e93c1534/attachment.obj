Index: Test/System.Web.Hosting/HostingEnvironmentTest.cs
===================================================================
--- Test/System.Web.Hosting/HostingEnvironmentTest.cs	(revision 68573)
+++ Test/System.Web.Hosting/HostingEnvironmentTest.cs	(working copy)
@@ -31,6 +31,9 @@
 using System.Web.Hosting;
 using NUnit.Framework;
 using System.Web;
+using System.IO;
+using System.Web.UI;
+using MonoTests.SystemWeb.Framework;
 
 namespace MonoTests.System.Web.Hosting {
 	[TestFixture]
@@ -69,6 +72,41 @@
 		{
 			Assert.IsNull (HostingEnvironment.MapPath ("hola"));
 		}
+
+		[Test]
+		[Category ("NunitWeb")]
+		public void VirtualPathProvider_GetFile ()
+		{
+			WebTest t = new WebTest (PageInvoker.CreateOnLoad (VirtualPathProvider_GetFile_Load));
+			t.Run ();
+		}
+		
+		public static void VirtualPathProvider_GetFile_Load (Page p)
+		{
+			VirtualFile vFile = HostingEnvironment.VirtualPathProvider.GetFile ("~/MyPage.aspx");
+			Stream strem = vFile.Open ();
+			Assert.IsNotNull (strem, "VirtualPathProvider_GetFile#1");
+
+			vFile = HostingEnvironment.VirtualPathProvider.GetFile (HostingEnvironment.ApplicationVirtualPath + "/MyPage.aspx");
+			strem = vFile.Open ();
+			Assert.IsNotNull (strem, "VirtualPathProvider_GetFile#2");
+		}
+		
+		[Test]
+		[Category ("NunitWeb")]
+		[ExpectedException(typeof(ArgumentException))]
+		public void VirtualPathProvider_GetFile2 ()
+		{
+			WebTest t = new WebTest (PageInvoker.CreateOnLoad (VirtualPathProvider_GetFile2_Load));
+			t.Run ();
+		}
+
+		public static void VirtualPathProvider_GetFile2_Load (Page p)
+		{
+			VirtualFile vFile = HostingEnvironment.VirtualPathProvider.GetFile ("MyPage.aspx");
+			Stream strem = vFile.Open ();
+			Assert.IsNotNull (strem, "VirtualPathProvider_GetFile#2");
+		}
 	}
 }
 #endif
