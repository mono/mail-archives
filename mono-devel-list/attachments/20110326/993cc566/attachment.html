<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#ffffff&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Question:&nbsp;Why&nbsp;does&nbsp;the&nbsp;below&nbsp;code&nbsp;(to&nbsp;take&nbsp;a&nbsp;thumbnail&nbsp;of&nbsp;a&nbsp;website)<br>
&nbsp;&nbsp;&nbsp;&nbsp;hang&nbsp;forever&nbsp;at:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman';&nbsp;font-style:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-spacing:&nbsp;0px;&nbsp;font-size:&nbsp;medium;&quot;&gt;&lt;span<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;color:&nbsp;rgb(85,&nbsp;85,&nbsp;85);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&nbsp;Verdana,'BitStream&nbsp;vera&nbsp;Sans',Helvetica,sans-serif;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:&nbsp;12px;&nbsp;line-height:&nbsp;17px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;csharpcode&quot;&nbsp;style=&quot;margin:&nbsp;5px&nbsp;0px;&nbsp;padding:&nbsp;8px&nbsp;12px&nbsp;8px&nbsp;36px;&nbsp;background-image:&nbsp;url(&amp;quot;http://pietschsoft.com/themes/inove/img/blockquote.gif&amp;quot;);&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&nbsp;border:&nbsp;1px&nbsp;dashed&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;font-size:&nbsp;small;&nbsp;color:&nbsp;black;&nbsp;font-family:&nbsp;consolas,'Courier&nbsp;New',courier,monospace;&nbsp;background-position:&nbsp;3px&nbsp;3px;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;while&lt;/span&gt;&nbsp;(wb.ReadyState&nbsp;!=&nbsp;WebBrowserReadyState.Complete)&nbsp;{&nbsp;Application.DoEvents();&nbsp;}&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;?&nbsp;It&nbsp;works&nbsp;with&nbsp;.NET&nbsp;on&nbsp;Windows.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;And&nbsp;furthermore,&nbsp;is&nbsp;it&nbsp;possible&nbsp;to&nbsp;take&nbsp;a&nbsp;WebSite&nbsp;Thumbnail&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;webkit-sharp&nbsp;?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;have&nbsp;not&nbsp;found&nbsp;a&nbsp;way.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I'm&nbsp;now&nbsp;resorting&nbsp;to&nbsp;khtml2png.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Code:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman';&nbsp;font-style:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-spacing:&nbsp;0px;&nbsp;font-size:&nbsp;medium;&quot;&gt;&lt;span<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;color:&nbsp;rgb(85,&nbsp;85,&nbsp;85);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&nbsp;Verdana,'BitStream&nbsp;vera&nbsp;Sans',Helvetica,sans-serif;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:&nbsp;12px;&nbsp;line-height:&nbsp;17px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;csharpcode&quot;&nbsp;style=&quot;margin:&nbsp;5px&nbsp;0px;&nbsp;padding:&nbsp;8px&nbsp;12px&nbsp;8px&nbsp;36px;&nbsp;background-image:&nbsp;url(&amp;quot;http://pietschsoft.com/themes/inove/img/blockquote.gif&amp;quot;);&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&nbsp;border:&nbsp;1px&nbsp;dashed&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;font-size:&nbsp;small;&nbsp;color:&nbsp;black;&nbsp;font-family:&nbsp;consolas,'Courier&nbsp;New',courier,monospace;&nbsp;background-position:&nbsp;3px&nbsp;3px;&quot;&gt;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;<br>
<br>
<br>
public&lt;/span&gt;&nbsp;Bitmap&nbsp;GenerateScreenshot(&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;string&lt;/span&gt;&nbsp;url)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;rem&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;128,&nbsp;0);&quot;&gt;//&nbsp;This&nbsp;method&nbsp;gets&nbsp;a&nbsp;screenshot&nbsp;of&nbsp;the&nbsp;webpage&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;rem&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;128,&nbsp;0);&quot;&gt;//&nbsp;rendered&nbsp;at&nbsp;its&nbsp;full&nbsp;size&nbsp;(height&nbsp;and&nbsp;width)&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;return&lt;/span&gt;&nbsp;GenerateScreenshot(url,&nbsp;-1,&nbsp;-1);<br>
}<br>
<br>
&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;public&lt;/span&gt;&nbsp;Bitmap&nbsp;GenerateScreenshot(&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;string&lt;/span&gt;&nbsp;url,&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;int&lt;/span&gt;&nbsp;width,&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;int&lt;/span&gt;&nbsp;height)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;rem&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;128,&nbsp;0);&quot;&gt;//&nbsp;Load&nbsp;the&nbsp;webpage&nbsp;into&nbsp;a&nbsp;WebBrowser&nbsp;control&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;WebBrowser&nbsp;wb&nbsp;=&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;new&lt;/span&gt;&nbsp;WebBrowser();<br>
&nbsp;&nbsp;&nbsp;&nbsp;wb.ScrollBarsEnabled&nbsp;=&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;false&lt;/span&gt;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;wb.ScriptErrorsSuppressed&nbsp;=&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;true&lt;/span&gt;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;wb.Navigate(url);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;while&lt;/span&gt;&nbsp;(wb.ReadyState&nbsp;!=&nbsp;WebBrowserReadyState.Complete)&nbsp;{&nbsp;Application.DoEvents();&nbsp;}<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;rem&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;128,&nbsp;0);&quot;&gt;//&nbsp;Set&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;WebBrowser&nbsp;control&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;wb.Width&nbsp;=&nbsp;width;<br>
&nbsp;&nbsp;&nbsp;&nbsp;wb.Height&nbsp;=&nbsp;height;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;if&lt;/span&gt;&nbsp;(width&nbsp;==&nbsp;-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;rem&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;128,&nbsp;0);&quot;&gt;//&nbsp;Take&nbsp;Screenshot&nbsp;of&nbsp;the&nbsp;web&nbsp;pages&nbsp;full&nbsp;width&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wb.Width&nbsp;=&nbsp;wb.Document.Body.ScrollRectangle.Width;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;if&lt;/span&gt;&nbsp;(height&nbsp;==&nbsp;-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;rem&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;128,&nbsp;0);&quot;&gt;//&nbsp;Take&nbsp;Screenshot&nbsp;of&nbsp;the&nbsp;web&nbsp;pages&nbsp;full&nbsp;height&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wb.Height&nbsp;=&nbsp;wb.Document.Body.ScrollRectangle.Height;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;rem&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;128,&nbsp;0);&quot;&gt;//&nbsp;Get&nbsp;a&nbsp;Bitmap&nbsp;representation&nbsp;of&nbsp;the&nbsp;webpage&nbsp;as&nbsp;it's&nbsp;rendered&nbsp;in&nbsp;the&nbsp;WebBrowser&nbsp;control&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Bitmap&nbsp;bitmap&nbsp;=&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;new&lt;/span&gt;&nbsp;Bitmap(wb.Width,&nbsp;wb.Height);<br>
&nbsp;&nbsp;&nbsp;&nbsp;wb.DrawToBitmap(bitmap,&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;new&lt;/span&gt;&nbsp;Rectangle(0,&nbsp;0,&nbsp;wb.Width,&nbsp;wb.Height));<br>
&nbsp;&nbsp;&nbsp;&nbsp;wb.Dispose();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;kwrd&quot;&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;255);&quot;&gt;return&lt;/span&gt;&nbsp;bitmap;<br>
}&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
