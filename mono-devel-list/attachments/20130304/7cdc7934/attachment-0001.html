<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Good&nbsp;catch!&nbsp;I&#39;m&nbsp;pushing&nbsp;a&nbsp;fix&nbsp;for&nbsp;it&nbsp;as&nbsp;of&nbsp;now,&nbsp;it&nbsp;will&nbsp;be&nbsp;part&nbsp;of&nbsp;mono&nbsp;3.0.7.&lt;div&gt;Thanks&nbsp;for&nbsp;investigating&nbsp;it.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&nbsp;style&gt;Rodrigo&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Mar&nbsp;4,&nbsp;2013&nbsp;at&nbsp;7:53&nbsp;AM,&nbsp;Chris&nbsp;Ball&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:qhalid@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;qhalid@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;I&nbsp;maintain&nbsp;a&nbsp;Linux&nbsp;build&nbsp;of&nbsp;mono&nbsp;(and&nbsp;F#)&nbsp;that&nbsp;is&nbsp;hosted&nbsp;via&nbsp;NFS,&nbsp;and&nbsp;used&nbsp;on&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;machines,&nbsp;but&nbsp;the&nbsp;mount&nbsp;directory&nbsp;is&nbsp;not&nbsp;always&nbsp;identical.&nbsp;I&nbsp;have&nbsp;discovered&nbsp;that&nbsp;the&nbsp;mono-sgen&nbsp;binary&nbsp;does&nbsp;not&nbsp;properly&nbsp;detect&nbsp;the&nbsp;location&nbsp;of&nbsp;mscorlib&nbsp;on&nbsp;my&nbsp;systems,&nbsp;but&nbsp;the&nbsp;normal&nbsp;mono&nbsp;binary&nbsp;has&nbsp;no&nbsp;problems.&nbsp;This&nbsp;problem&nbsp;occurs&nbsp;in&nbsp;both&nbsp;2.10.9&nbsp;and&nbsp;3.0.4.&nbsp;My&nbsp;&quot;simple&quot;&nbsp;test&nbsp;case&nbsp;(for&nbsp;mono&nbsp;3.0)&nbsp;is&nbsp;to&nbsp;build&nbsp;the&nbsp;runtime,&nbsp;rename&nbsp;the&nbsp;output&nbsp;directory,&nbsp;and&nbsp;run&nbsp;the&nbsp;following:&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;MONO_GAC_PREFIX=/tmp/mono-test/renamed&nbsp;\&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;PATH=$PATH:/tmp/mono-test/renamed/bin&nbsp;\&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/tmp/mono-test/renamed/lib&nbsp;\&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;/tmp/mono-test/renamed/bin/mono&nbsp;/tmp/mono-test/renamed/lib/mono/4.5/sn.exe&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp; &nbsp;MONO_GAC_PREFIX=/tmp/mono-test/renamed&nbsp;\&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;PATH=$PATH:/tmp/mono-test/renamed/bin&nbsp;\&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/tmp/mono-test/renamed/lib&nbsp;\&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;/tmp/mono-test/renamed/bin/mono-sgen&nbsp;/tmp/mono-test/renamed/lib/mono/4.5/sn.exe&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;The&nbsp;first&nbsp;command&nbsp;succeeds&nbsp;(prints&nbsp;out&nbsp;the&nbsp;usage).&nbsp;The&nbsp;second&nbsp;command&nbsp;fails,&nbsp;returning:&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;The&nbsp;assembly&nbsp;mscorlib.dll&nbsp;was&nbsp;not&nbsp;found&nbsp;or&nbsp;could&nbsp;not&nbsp;be&nbsp;loaded.&lt;br&gt;&nbsp; &nbsp;It&nbsp;should&nbsp;have&nbsp;been&nbsp;installed&nbsp;in&nbsp;the&nbsp;`/source/on/build/server/lib/mono/4.5/mscorlib.dll&#39;&nbsp;directory.&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;traced&nbsp;the&nbsp;issue&nbsp;to&nbsp;mono/metadata/assembly.c:compute_base:&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;/*&nbsp;Not&nbsp;a&nbsp;well&nbsp;known&nbsp;Mono&nbsp;executable,&nbsp;we&nbsp;are&nbsp;embedded,&nbsp;cant&nbsp;guess&nbsp;the&nbsp;base&nbsp;&nbsp;*/&lt;br&gt;&nbsp; &nbsp;if&nbsp;(strcmp&nbsp;(p,&nbsp;&quot;/mono&quot;)&nbsp;&amp;&amp;&nbsp;strcmp&nbsp;(p,&nbsp;&quot;/monodis&quot;)&nbsp;&amp;&amp;&nbsp;strcmp&nbsp;(p,&nbsp;&quot;/mint&quot;)&nbsp;&amp;&amp;&nbsp;strcmp&nbsp;(p,&nbsp;&quot;/monodiet&quot;))&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;return&nbsp;NULL;&lt;br&gt;&lt;br&gt;By&nbsp;changing&nbsp;this&nbsp;as&nbsp;follows,&nbsp;the&nbsp;behavior&nbsp;is&nbsp;corrected:&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp; &nbsp;/*&nbsp;Not&nbsp;a&nbsp;well&nbsp;known&nbsp;Mono&nbsp;executable,&nbsp;we&nbsp;are&nbsp;embedded,&nbsp;cant&nbsp;guess&nbsp;the&nbsp;base&nbsp;&nbsp;*/&lt;br&gt;&nbsp; &nbsp;if&nbsp;(strcmp&nbsp;(p,&nbsp;&quot;/mono&quot;)&nbsp;&amp;&amp;&nbsp;strcmp&nbsp;(p,&nbsp;&quot;/mono-sgen&quot;)&nbsp;&amp;&amp;&nbsp;strcmp&nbsp;(p,&nbsp;&quot;/monodis&quot;)&nbsp;&amp;&amp;&nbsp;strcmp&nbsp;(p,&nbsp;&quot;/mint&quot;)&nbsp;&amp;&amp;&nbsp;strcmp&nbsp;(p,&nbsp;&quot;/monodiet&quot;))&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;return&nbsp;NULL;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;not&nbsp;filed&nbsp;this&nbsp;as&nbsp;a&nbsp;bug&nbsp;or&nbsp;submitted&nbsp;a&nbsp;patch&nbsp;yet,&nbsp;because&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;if&nbsp;other&nbsp;binaries&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;this&nbsp;test&nbsp;as&nbsp;well&nbsp;(e.g.&nbsp;pedump).&nbsp;My&nbsp;preliminary&nbsp;tests&nbsp;using&nbsp;&quot;pedump&nbsp;--verify&nbsp;all&quot;&nbsp;suggest&nbsp;that&nbsp;it&nbsp;should&nbsp;also&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;&quot;well&nbsp;known&quot;&nbsp;list.&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
