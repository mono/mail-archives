From 586c54dd5f6becf5aae8b446adfbd2034ee1b153 Mon Sep 17 00:00:00 2001
From: Gleb Golubitsky <sectoid@gnolltech.org>
Date: Tue, 22 Nov 2011 14:35:26 +0200
Subject: [PATCH 1/2] [sgen] Trying to fix ephemerons handling (e.g. problem
 decribed in [1])

[1] -- http://bugzilla.xamarin.com/show_bug.cgi?id=1175

Signed-off-by: Gleb Golubitsky <sectoid@gnolltech.org>
---
 mono/metadata/sgen-gc.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/mono/metadata/sgen-gc.c b/mono/metadata/sgen-gc.c
index 48cf0ec..c6fbb5f 100644
--- a/mono/metadata/sgen-gc.c
+++ b/mono/metadata/sgen-gc.c
@@ -4436,8 +4436,9 @@ mark_ephemerons_in_range (CopyOrMarkObjectFunc copy_func, char *start, char *end
 		DEBUG (5, fprintf (gc_debug_file, "Ephemeron array at %p\n", object));
 
 		/*We ignore arrays in old gen during minor collections since all objects are promoted by the remset machinery.*/
-		if (object < start || object >= end)
+		/*if (object < start || object >= end)
 			continue;
+                */
 
 		/*It has to be alive*/
 		if (!object_is_reachable (object, start, end)) {
-- 
1.7.7.3

