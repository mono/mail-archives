<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7226.0&quot;&gt;<br>
&lt;TITLE&gt;Marshal&nbsp;Variable&nbsp;length&nbsp;structure&nbsp;Array&nbsp;in&nbsp;Mono&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Hi&nbsp;,&lt;BR&gt;<br>
&amp;nbsp;I&nbsp;want&nbsp;to&nbsp;marshal&nbsp;following&nbsp;C&nbsp;structure&nbsp;.&lt;BR&gt;<br>
----------------------------&lt;BR&gt;<br>
[C]&lt;BR&gt;<br>
struct&nbsp;Foo&lt;BR&gt;<br>
{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;First;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;Second;&lt;BR&gt;<br>
};&lt;BR&gt;<br>
&lt;BR&gt;<br>
struct&nbsp;FooList&lt;BR&gt;<br>
{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;Count;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;Foo&nbsp;List[1];&lt;BR&gt;<br>
};&lt;BR&gt;<br>
&lt;BR&gt;<br>
void&nbsp;GetFooList(struct&nbsp;*&nbsp;FooList&nbsp;fList);&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;am&nbsp;doing&nbsp;it&nbsp;following&nbsp;way&lt;BR&gt;<br>
[C#]&lt;BR&gt;<br>
--------------------&lt;BR&gt;<br>
[StructLayout(LayoutKind.Sequential)]&lt;BR&gt;<br>
class&nbsp;Foo&lt;BR&gt;<br>
{&lt;BR&gt;<br>
&amp;nbsp;&nbsp;public&nbsp;Int32&nbsp;First;&lt;BR&gt;<br>
&amp;nbsp;&nbsp;public&nbsp;Int32&nbsp;Second;&lt;BR&gt;<br>
}&lt;BR&gt;<br>
&lt;BR&gt;<br>
[StructLayout(LayoutKind.Sequential)]&lt;BR&gt;<br>
class&nbsp;FooList&lt;BR&gt;<br>
{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;Int32&nbsp;Count;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;IntPtr&nbsp;list;//pointer&nbsp;to&nbsp;first&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;Foo[]&nbsp;Foos&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//????&nbsp;HOW&nbsp;TO&nbsp;DO&nbsp;THIS&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&nbsp;}&lt;BR&gt;<br>
}&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
My&nbsp;problem&nbsp;is&nbsp;how&nbsp;to&nbsp;form&nbsp;objects&nbsp;from&nbsp;IntPtr&nbsp;and&nbsp;return&nbsp;as&nbsp;Foo[].&lt;BR&gt;<br>
(If&nbsp;i&nbsp;directly&nbsp;use&nbsp;Marshal.PtrToStruct(list,typeof(Foo));&nbsp;it&nbsp;throws&nbsp;object&nbsp;reference&nbsp;not&nbsp;set&nbsp;to&nbsp;object&nbsp;while&nbsp;access&nbsp;Foo.First.)&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;googled&nbsp;about&nbsp;it&nbsp;and&nbsp;I&nbsp;found&nbsp;a&nbsp;solution&nbsp;which&nbsp;uses&nbsp;kernel32.dll&nbsp;and&nbsp;uses&nbsp;GlobalFree,&nbsp;GlobalAlloc&nbsp;API's.&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;want&nbsp;to&nbsp;run&nbsp;this&nbsp;on&nbsp;Mono.&nbsp;I&nbsp;am&nbsp;new&nbsp;to&nbsp;Interop&nbsp;Please&nbsp;help.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thank&nbsp;in&nbsp;Advance.&lt;BR&gt;<br>
&lt;BR&gt;<br>
-YoGi&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
