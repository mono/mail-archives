<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:st1=&quot;urn:schemas-microsoft-com:office:smarttags&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
<br>
&lt;head&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;meta&nbsp;name=Generator&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;11&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;!--[if&nbsp;!mso]&gt;<br>
&lt;style&gt;<br>
v\:*&nbsp;{behavior:url(#default#VML);}<br>
o\:*&nbsp;{behavior:url(#default#VML);}<br>
w\:*&nbsp;{behavior:url(#default#VML);}<br>
.shape&nbsp;{behavior:url(#default#VML);}<br>
&lt;/style&gt;<br>
&lt;![endif]--&gt;&lt;o:SmartTagType<br>
&nbsp;namespaceuri=&quot;urn:schemas-microsoft-com:office:smarttags&quot;&nbsp;name=&quot;PersonName&quot;/&gt;<br>
&lt;!--[if&nbsp;!mso]&gt;<br>
&lt;style&gt;<br>
st1\:*{behavior:url(#default#ieooui)&nbsp;}<br>
&lt;/style&gt;<br>
&lt;![endif]--&gt;<br>
&lt;style&gt;<br>
&lt;!--<br>
&nbsp;/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
&nbsp;@font-face<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{font-family:Tahoma;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppanose-1:2&nbsp;11&nbsp;6&nbsp;4&nbsp;3&nbsp;5&nbsp;4&nbsp;4&nbsp;2&nbsp;4;}<br>
&nbsp;/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
&nbsp;p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{margin:0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-bottom:.0001pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-size:12.0pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Times&nbsp;New&nbsp;Roman&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{color:blue;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{color:blue;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-decoration:underline;}<br>
span.EmailStyle18<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-type:personal-reply;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:Arial;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:navy;}<br>
@page&nbsp;Section1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{size:8.5in&nbsp;11.0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin:1.0in&nbsp;1.25in&nbsp;1.0in&nbsp;1.25in;}<br>
div.Section1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{page:Section1;}<br>
--&gt;<br>
&lt;/style&gt;<br>
<br>
&lt;/head&gt;<br>
<br>
&lt;body&nbsp;lang=EN-US&nbsp;link=blue&nbsp;vlink=blue&gt;<br>
<br>
&lt;div&nbsp;class=Section1&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;color=navy&nbsp;face=Arial&gt;&lt;span&nbsp;style='font-size:<br>
10.0pt;font-family:Arial;color:navy'&gt;Harry,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;color=navy&nbsp;face=Arial&gt;&lt;span&nbsp;style='font-size:<br>
10.0pt;font-family:Arial;color:navy'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;color=navy&nbsp;face=Arial&gt;&lt;span&nbsp;style='font-size:<br>
10.0pt;font-family:Arial;color:navy'&gt;The&nbsp;latest&nbsp;patch&nbsp;that&nbsp;I&nbsp;sent&nbsp;to&nbsp;the<br>
maintainers&nbsp;doesn&amp;#8217;t&nbsp;use&nbsp;the&nbsp;delegate&nbsp;BeginInvoke&nbsp;any&nbsp;more.&nbsp;It&nbsp;uses&nbsp;an<br>
asynchronous&nbsp;BeginRead&nbsp;or&nbsp;BeginWrite&nbsp;call&nbsp;to&nbsp;the&nbsp;innerStream&nbsp;to&nbsp;kick&nbsp;off&nbsp;the<br>
handshake&nbsp;in&nbsp;a&nbsp;background&nbsp;thread.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;color=navy&nbsp;face=Arial&gt;&lt;span&nbsp;style='font-size:<br>
10.0pt;font-family:Arial;color:navy'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;color=navy&nbsp;face=Arial&gt;&lt;span&nbsp;style='font-size:<br>
10.0pt;font-family:Arial;color:navy'&gt;-&lt;st1:PersonName&nbsp;w:st=&quot;on&quot;&gt;JD&nbsp;Conley&lt;/st1:PersonName&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;color=navy&nbsp;face=Arial&gt;&lt;span&nbsp;style='font-size:<br>
10.0pt;font-family:Arial;color:navy'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;div&nbsp;style='border:none;border-left:solid&nbsp;blue&nbsp;1.5pt;padding:0in&nbsp;0in&nbsp;0in&nbsp;4.0pt'&gt;<br>
<br>
&lt;div&gt;<br>
<br>
&lt;div&nbsp;class=MsoNormal&nbsp;align=center&nbsp;style='text-align:center'&gt;&lt;font&nbsp;size=3<br>
face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span&nbsp;style='font-size:12.0pt'&gt;<br>
<br>
&lt;hr&nbsp;size=2&nbsp;width=&quot;100%&quot;&nbsp;align=center&nbsp;tabindex=-1&gt;<br>
<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;b&gt;&lt;font&nbsp;size=2&nbsp;face=Tahoma&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:Tahoma;font-weight:bold'&gt;From:&lt;/span&gt;&lt;/font&gt;&lt;/b&gt;&lt;font&nbsp;size=2<br>
face=Tahoma&gt;&lt;span&nbsp;style='font-size:10.0pt;font-family:Tahoma'&gt;&nbsp;mono-devel-list-bounces@lists.ximian.com<br>
[mailto:mono-devel-list-bounces@lists.ximian.com]&nbsp;&lt;b&gt;&lt;span&nbsp;style='font-weight:<br>
bold'&gt;On&nbsp;Behalf&nbsp;Of&nbsp;&lt;/span&gt;&lt;/b&gt;Harry&nbsp;Holt&lt;br&gt;<br>
&lt;b&gt;&lt;span&nbsp;style='font-weight:bold'&gt;Sent:&lt;/span&gt;&lt;/b&gt;&nbsp;Wednesday,&nbsp;August&nbsp;31,&nbsp;2005<br>
6:12&nbsp;AM&lt;br&gt;<br>
&lt;b&gt;&lt;span&nbsp;style='font-weight:bold'&gt;To:&lt;/span&gt;&lt;/b&gt;<br>
mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&lt;b&gt;&lt;span&nbsp;style='font-weight:bold'&gt;Subject:&lt;/span&gt;&lt;/b&gt;&nbsp;Re:&nbsp;[Mono-dev]&nbsp;Re:<br>
[PATCH]&nbsp;Fully&nbsp;Asynchronous&nbsp;and&nbsp;Re-Factored&nbsp;SslStreams&nbsp;in&nbsp;Mono.Security&lt;/span&gt;&lt;/font&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=3&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span&nbsp;style='font-size:<br>
12.0pt'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-bottom:12.0pt'&gt;&lt;font&nbsp;size=3<br>
face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span&nbsp;style='font-size:12.0pt'&gt;This&nbsp;seems&nbsp;to&nbsp;work&nbsp;fine<br>
on&nbsp;W2k.&amp;nbsp;&nbsp;Running&nbsp;under&nbsp;IIS5.1&nbsp;on&nbsp;WXP,&nbsp;though,&nbsp;it&nbsp;always&nbsp;throws&nbsp;an<br>
&amp;quot;ObjectDisposedException&amp;quot;&nbsp;in&nbsp;&amp;quot;SSLStreamBase.cs&amp;quot;&nbsp;when&nbsp;a&nbsp;bind<br>
over&nbsp;SSL&nbsp;is&nbsp;attempted.&lt;br&gt;<br>
&lt;br&gt;<br>
Won't&nbsp;this:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(workthreads&nbsp;&amp;gt;=<br>
(maxworkthreads&nbsp;-&nbsp;4))&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
async&nbsp;=&nbsp;false;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
cause&nbsp;the&nbsp;SSL&nbsp;Stream&nbsp;to&nbsp;use&nbsp;synchronous&nbsp;handshake&nbsp;until&nbsp;threads&nbsp;start&nbsp;getting<br>
used?&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;would&nbsp;also&nbsp;recommend&nbsp;changing&nbsp;this:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;protected&nbsp;void&nbsp;checkDisposed()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(this.disposed)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
throw&nbsp;new&nbsp;ObjectDisposedException(&amp;quot;The&nbsp;Stream&nbsp;is&nbsp;closed.&amp;quot;);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
to&nbsp;this:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;protected&nbsp;void&nbsp;checkDisposed()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(this.disposed)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
throw&nbsp;new&nbsp;ObjectDisposedException(this.GetType().Name,&nbsp;&amp;quot;The&nbsp;Stream&nbsp;is<br>
closed.&amp;quot;);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
which&nbsp;produces&nbsp;a&nbsp;more&nbsp;readable&nbsp;error&nbsp;message.&lt;br&gt;<br>
&lt;br&gt;<br>
Thx...&nbsp;HH&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;div&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;class=gmailquote&gt;&lt;font&nbsp;size=3&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font-size:12.0pt'&gt;On&nbsp;8/25/05,&nbsp;&lt;b&gt;&lt;span&nbsp;style='font-weight:bold'&gt;Sebastien<br>
Pouliot&lt;/span&gt;&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sebastien@ximian.com&quot;&gt;sebastien@ximian.com&lt;/a&gt;&amp;gt;<br>
wrote:&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=3&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span&nbsp;style='font-size:<br>
12.0pt'&gt;Hello&nbsp;JD,&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Wed,&nbsp;2005-24-08&nbsp;at&nbsp;21:12&nbsp;-0700,&nbsp;&lt;st1:PersonName&nbsp;w:st=&quot;on&quot;&gt;JD&nbsp;Conley&lt;/st1:PersonName&gt;<br>
wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;took&nbsp;the&nbsp;plunge&nbsp;and&nbsp;fully&nbsp;implemented&nbsp;async&nbsp;Ssl&nbsp;streams&nbsp;for&nbsp;both&lt;br&gt;<br>
&amp;gt;&nbsp;client&nbsp;and&nbsp;server.&amp;nbsp;&amp;nbsp;This&nbsp;fixes&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://bugzilla.ximian.com/show_bug.cgi?id=75687&quot;&gt;http://bugzilla.ximian.com/show_bug.cgi?id=75687&lt;/a&gt;<br>
as&nbsp;well&nbsp;as&nbsp;other&nbsp;bugs&lt;br&gt;<br>
&amp;gt;&nbsp;I've&nbsp;been&nbsp;talking&nbsp;with&nbsp;Sebastien&nbsp;and&nbsp;Carlos&nbsp;about&nbsp;off&nbsp;list.&nbsp;This&nbsp;patch&lt;br&gt;<br>
&amp;gt;&nbsp;passes&nbsp;the&nbsp;SocketHell&nbsp;tests&nbsp;that&nbsp;I&nbsp;contributed&nbsp;to&nbsp;them&nbsp;last&nbsp;week&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;(multi&nbsp;threaded&nbsp;concurrent&nbsp;async&nbsp;streaming&nbsp;through&nbsp;TCP&nbsp;sockets).&lt;br&gt;<br>
&lt;br&gt;<br>
Wow!&nbsp;That's&nbsp;the&nbsp;kind&nbsp;of&nbsp;surprise&nbsp;I&nbsp;like&nbsp;when&nbsp;I&nbsp;wake&nbsp;up&nbsp;:-)&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;It's&nbsp;also&nbsp;a&nbsp;bit&nbsp;of&nbsp;a&nbsp;re-factor,&nbsp;though&nbsp;I&nbsp;only&nbsp;touched&nbsp;two&nbsp;classes&nbsp;and&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;added&nbsp;one.&amp;nbsp;&amp;nbsp;I&nbsp;pulled&nbsp;most&nbsp;of&nbsp;the&nbsp;code&nbsp;out&nbsp;of&nbsp;the&nbsp;individual&lt;br&gt;<br>
&amp;gt;&nbsp;SslClientStream&nbsp;and&nbsp;SslServerStream&nbsp;and&nbsp;moved&nbsp;it&nbsp;down&nbsp;into&nbsp;a&nbsp;new&lt;br&gt;<br>
&amp;gt;&nbsp;abstract&nbsp;SslStreamBase.&amp;nbsp;&amp;nbsp;Client&nbsp;and&nbsp;server&nbsp;are&nbsp;now&nbsp;practically<br>
the&lt;br&gt;<br>
&amp;gt;&nbsp;same&nbsp;implementation.&amp;nbsp;&amp;nbsp;I&nbsp;left&nbsp;all&nbsp;existing&nbsp;interfaces&nbsp;present,<br>
but&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;obviously&nbsp;had&nbsp;to&nbsp;add&nbsp;some&nbsp;new&nbsp;ones.&lt;br&gt;<br>
&lt;br&gt;<br>
We&nbsp;always&nbsp;&amp;quot;sticked&amp;quot;&nbsp;to&nbsp;the&nbsp;Fx&nbsp;1.2&nbsp;preview&nbsp;specs&nbsp;for&nbsp;the&nbsp;Ssl[Client|&lt;br&gt;<br>
Server]Stream&nbsp;API&nbsp;and&nbsp;didn't&nbsp;planned&nbsp;to&nbsp;change&nbsp;this&nbsp;before&nbsp;implementing&lt;br&gt;<br>
the&nbsp;new&nbsp;SslStream&nbsp;(in&nbsp;System.dll)&nbsp;for&nbsp;2.0&nbsp;-&nbsp;BUT&nbsp;this&nbsp;isn't&nbsp;a&nbsp;major&lt;br&gt;<br>
problem&nbsp;if&nbsp;it&nbsp;doesn't&nbsp;break&nbsp;binary&nbsp;compatibility&nbsp;(for&nbsp;current&lt;br&gt;<br>
applications&nbsp;linked&nbsp;with&nbsp;Mono.Security.dll).&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;only&nbsp;&amp;quot;gotcha&amp;quot;&nbsp;is&nbsp;if&nbsp;you&nbsp;start&nbsp;running&nbsp;low&nbsp;on&nbsp;threadpool<br>
threads.&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;Then&nbsp;the&nbsp;Ssl&nbsp;Stream&nbsp;will&nbsp;fall&nbsp;back&nbsp;to&nbsp;a&nbsp;synchronous&nbsp;handshake.&nbsp;The&lt;br&gt;<br>
&amp;gt;&nbsp;other&nbsp;option&nbsp;here&nbsp;is&nbsp;to&nbsp;spawn&nbsp;a&nbsp;thread&nbsp;ourselves&nbsp;for&nbsp;the&nbsp;handshake&lt;br&gt;<br>
&amp;gt;&nbsp;instead&nbsp;of&nbsp;using&nbsp;Delegate.BeginInvoke(),&nbsp;use&nbsp;the&nbsp;IO&nbsp;ThreadPool&nbsp;(is&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;that&nbsp;available&nbsp;to&nbsp;Mono.Security?),&nbsp;or&nbsp;just&nbsp;live&nbsp;with&nbsp;a&nbsp;synchronous&lt;br&gt;<br>
&amp;gt;&nbsp;handshake.&nbsp;Of&nbsp;course,&nbsp;99.999%&nbsp;of&nbsp;the&nbsp;time&nbsp;this&nbsp;issue&nbsp;won't&nbsp;occur&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;won't&nbsp;be&nbsp;a&nbsp;problem&nbsp;unless&nbsp;you&nbsp;have&nbsp;both&nbsp;client&nbsp;and&nbsp;server&nbsp;sharing&nbsp;the&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;same&nbsp;Threadpool&nbsp;causing&nbsp;a&nbsp;deadlock.&lt;br&gt;<br>
&lt;br&gt;<br>
That's&nbsp;not&nbsp;worse&nbsp;than&nbsp;the&nbsp;original&nbsp;(where&nbsp;the&nbsp;handshake&nbsp;was&nbsp;always&lt;br&gt;<br>
synchronous).&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;hope&nbsp;this&nbsp;helps&nbsp;and&nbsp;gets&nbsp;integrated.&amp;nbsp;&amp;nbsp;It's&nbsp;definitely<br>
necessary&nbsp;for&lt;br&gt;<br>
&amp;gt;&nbsp;our&nbsp;implementation.&lt;br&gt;<br>
&lt;br&gt;<br>
1.&nbsp;I'll&nbsp;review&nbsp;the&nbsp;patch&nbsp;and,&nbsp;in&nbsp;doing&nbsp;so,&nbsp;check&nbsp;for&nbsp;possible&nbsp;binary&lt;br&gt;<br>
compatibility&nbsp;problems.&nbsp;I'm&nbsp;sure&nbsp;Carlos&nbsp;will&nbsp;do&nbsp;likewise;&lt;br&gt;<br>
&lt;br&gt;<br>
2.&nbsp;I'll&nbsp;make&nbsp;public&nbsp;a&nbsp;new&nbsp;Mono.Security.dll&nbsp;assembly&nbsp;so&nbsp;that&nbsp;people&nbsp;that&nbsp;&lt;br&gt;<br>
depends&nbsp;on&nbsp;Ssl*Stream&nbsp;may&nbsp;tests&nbsp;it&nbsp;and&nbsp;report&nbsp;any&nbsp;problem/difference;&lt;br&gt;<br>
&lt;br&gt;<br>
3.&nbsp;I'll&nbsp;run&nbsp;the&nbsp;regressions&nbsp;tests,&nbsp;the&nbsp;tools&nbsp;under&nbsp;/mcs/class/&lt;br&gt;<br>
Mono.Security/Test/tools/*,&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;works&nbsp;in&nbsp;previously&nbsp;reported&lt;br&gt;<br>
conditions.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
4.&nbsp;Commit&nbsp;(both&nbsp;the&nbsp;patch&nbsp;and&nbsp;your&nbsp;SocketHell&nbsp;tests).&nbsp;Hopefully&nbsp;we&nbsp;can&lt;br&gt;<br>
do&nbsp;all&nbsp;this&nbsp;before&nbsp;the&nbsp;next&nbsp;release.&lt;br&gt;<br>
&lt;br&gt;<br>
Many&nbsp;thanks!&lt;br&gt;<br>
--&lt;br&gt;<br>
Sebastien&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&nbsp;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;<br>
&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=3&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span&nbsp;style='font-size:<br>
12.0pt'&gt;&lt;br&gt;<br>
&lt;br&nbsp;clear=all&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
====================================================&lt;br&gt;<br>
Robbie&nbsp;the&nbsp;Nanobot&nbsp;says:&lt;br&gt;<br>
&amp;quot;Only&nbsp;YOU&nbsp;can&nbsp;prevent&nbsp;gray&nbsp;goo&lt;br&gt;<br>
(NEVER&nbsp;release&nbsp;nanobot&nbsp;assemblers&nbsp;without&nbsp;replication&nbsp;limiting&nbsp;code)&amp;quot;&nbsp;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lizardslounge.org&quot;&gt;http://lizardslounge.org&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
&lt;/body&gt;<br>
<br>
&lt;/html&gt;<br>

</tt>
