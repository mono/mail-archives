<tt>
Paolo,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;I&nbsp;removed&nbsp;the&nbsp;additional&nbsp;wrappers.&nbsp;For&nbsp;COM&nbsp;Interop&nbsp;methods,&nbsp;there&nbsp;will&nbsp;either&nbsp;be&nbsp;two&nbsp;or&nbsp;three&nbsp;generated&nbsp;wrappers.&nbsp;For&nbsp;managed&nbsp;code&nbsp;calling&nbsp;an&nbsp;unmanaged&nbsp;COM&nbsp;object&nbsp;there&nbsp;will&nbsp;be&nbsp;3.&lt;br&gt;&lt;br&gt;MONO_WRAPPER_COMINTEROP_INVOKE:&nbsp;This&nbsp;transitions&nbsp;the&nbsp;call&nbsp;made&nbsp;on&nbsp;the&nbsp;TransparentProxy&nbsp;to&nbsp;the&nbsp;underlying&nbsp;__ComObject.<br>
&lt;br&gt;<br>
MONO_WRAPPER_COMINTEROP:&nbsp;This&nbsp;transitions&nbsp;the&nbsp;call&nbsp;made&nbsp;on&nbsp;the&nbsp;_ComObject&nbsp;to&nbsp;the&nbsp;correct&nbsp;unmanaged&nbsp;signature&nbsp;just&nbsp;to&nbsp;remove&nbsp;the&nbsp;need&nbsp;for&nbsp;special&nbsp;case&nbsp;logic&nbsp;in&nbsp;the&nbsp;current&nbsp;pinvoke&nbsp;marshalling&nbsp;code.&lt;br&gt;<br>
MONO_WRAPPER_MANAGED_TO_NATIVE:&nbsp;This&nbsp;marshals&nbsp;the&nbsp;arguments&nbsp;and&nbsp;makes&nbsp;the&nbsp;call&nbsp;on&nbsp;the&nbsp;unmanaged&nbsp;function&nbsp;pointer.&lt;br&gt;&lt;br&gt;For&nbsp;unmanaged&nbsp;code&nbsp;calling&nbsp;back&nbsp;into&nbsp;managed&nbsp;code&nbsp;there&nbsp;will&nbsp;be&nbsp;2&nbsp;wrapper&nbsp;methods.&lt;br&gt;&lt;br&gt;<br>
<br>
<br>
MONO_WRAPPER_NATIVE_TO_MANAGED:&nbsp;This&nbsp;marshals&nbsp;the&nbsp;arguments&nbsp;and&nbsp;makes&nbsp;the&nbsp;call&nbsp;on&nbsp;the&nbsp;signature&nbsp;identical&nbsp;wrapper&nbsp;method.&lt;br&gt;MONO_WRAPPER_COMINTEROP:&nbsp;This&nbsp;transitions&nbsp;the&nbsp;call&nbsp;to&nbsp;the&nbsp;correct&nbsp;managed&nbsp;signature&nbsp;and&nbsp;makes&nbsp;the&nbsp;all&nbsp;on&nbsp;the&nbsp;managed&nbsp;object.<br>
&lt;br&gt;&lt;br&gt;So,&nbsp;right&nbsp;now&nbsp;I&nbsp;have&nbsp;two&nbsp;wrapper&nbsp;types&nbsp;to&nbsp;support&nbsp;COM&nbsp;Interop.&nbsp;If&nbsp;you&nbsp;think&nbsp;one&nbsp;of&nbsp;the&nbsp;other&nbsp;wrapper&nbsp;types&nbsp;is&nbsp;appropriate&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;MONO_WRAPPER_COMINTEROP_INVOKE,&nbsp;let&nbsp;me&nbsp;know&nbsp;and&nbsp;I&nbsp;will&nbsp;use&nbsp;it.&lt;br&gt;&lt;br&gt;Thanks,<br>
&lt;br&gt;Jonathan&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;1/15/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Paolo&nbsp;Molaro&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:lupus@ximian.com&quot;&gt;lupus@ximian.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;01/12/07&nbsp;Jon&nbsp;Chambers&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;This&nbsp;patch&nbsp;doesn&amp;#39;t&nbsp;initialize&nbsp;COM&nbsp;types&nbsp;in&nbsp;the&nbsp;runtime&nbsp;until&nbsp;they&nbsp;are&lt;br&gt;&amp;gt;&nbsp;needed,&nbsp;and&nbsp;also&nbsp;renames&nbsp;the&nbsp;COM&nbsp;wrapper&nbsp;methods&nbsp;to&nbsp;something&nbsp;more&lt;br&gt;&amp;gt;&nbsp;understandable.&nbsp;I&amp;#39;ll&nbsp;work&nbsp;on&nbsp;supporting&nbsp;the&nbsp;DISABLE_COM&nbsp;flag&nbsp;in&nbsp;the&nbsp;near<br>
&lt;br&gt;&amp;gt;&nbsp;future.&lt;br&gt;&lt;br&gt;Do&nbsp;you&nbsp;really&nbsp;need&nbsp;all&nbsp;that&nbsp;many&nbsp;different&nbsp;wrapper&nbsp;type&nbsp;names?&lt;br&gt;A&nbsp;diffrent&nbsp;wrapper&nbsp;type&nbsp;must&nbsp;be&nbsp;used&nbsp;only&nbsp;if&nbsp;needed&nbsp;for&nbsp;some&lt;br&gt;semantic&nbsp;reason&nbsp;(like,&nbsp;it&nbsp;will&nbsp;be&nbsp;actually&nbsp;checked&nbsp;later&nbsp;at&nbsp;runtime<br>
&lt;br&gt;for&nbsp;some&nbsp;reason).&nbsp;They&nbsp;are&nbsp;a&nbsp;scarce&nbsp;resource&nbsp;and&nbsp;we&nbsp;can&amp;#39;t&nbsp;have&nbsp;more&nbsp;than&lt;br&gt;32&nbsp;(we&nbsp;have&nbsp;been&nbsp;adding&nbsp;them&nbsp;too&nbsp;happily&nbsp;in&nbsp;the&nbsp;past&nbsp;and&nbsp;also&nbsp;some&nbsp;of&lt;br&gt;the&nbsp;existing&nbsp;ones&nbsp;will&nbsp;go&nbsp;away).&lt;br&gt;So,&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;really&nbsp;strong&nbsp;reason,&nbsp;do&nbsp;not&nbsp;add&nbsp;to&nbsp;the&nbsp;types<br>
&lt;br&gt;(and&nbsp;if&nbsp;possible&nbsp;use&nbsp;a&nbsp;single&nbsp;type&nbsp;for&nbsp;it&nbsp;if&nbsp;one&nbsp;of&nbsp;the&nbsp;existing&nbsp;ones&nbsp;is&lt;br&gt;not&nbsp;appropriate&nbsp;already).&lt;br&gt;&lt;br&gt;lupus&lt;br&gt;&lt;br&gt;--&lt;br&gt;-----------------------------------------------------------------&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:lupus@debian.org&quot;&gt;<br>
lupus@debian.org&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;debian/rules&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:lupus@ximian.com&quot;&gt;lupus@ximian.com&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Monkeys&nbsp;do&nbsp;it&nbsp;better&lt;br&gt;_______________________________________________<br>
&lt;br&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list<br>
&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
