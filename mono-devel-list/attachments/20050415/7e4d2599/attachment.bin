using System;
using System.Data;

class  MainClass
{
        public static void Main (string [] args)
        {

                DataTable dt = new DataTable ("test");
                dt.Columns.Add ("author", typeof (string));
                dt.Columns.Add ("id", typeof (int));
                dt.Columns.Add ("pubdate", typeof (DateTime));

                dt.Rows.Add (new object [] {"suresh", 5, new DateTime (2005,3,3)}) ;
                dt.Rows.Add (new object [] {"suresh", 10, new DateTime (2005,3,6)}) ;
                dt.Rows.Add (new object [] {"ramesh", 6, new DateTime (2005,3,2)}) ;
                dt.Rows.Add (new object [] {"ramesh",12, new DateTime (2005,1,2)}) ;
                dt.Rows.Add (new object [] {"kamesh", 3, new DateTime (2005,3,5)}) ;
                dt.Rows.Add (new object [] {"raju", 2, new DateTime (2005,2,5)}) ;

                Console.WriteLine ("DataTable : ");
                Print (dt);

                DataView dv = new DataView (dt, "author like '%sh'", "pubdate", DataViewRowState.CurrentRows);
                Console.WriteLine ("\nfiltered sorted view :");
                Print (dv);

                dv.Sort = "pubdate desc";
                Console.WriteLine ("\nsorting dec:");
                Print (dv);

        }

        public static void Print (DataTable dt)
        {
                for (int i = 0 ; i < dt.Columns.Count ; i++) {
                        Console.Write ("{0,20}", dt.Columns [i].ColumnName);
                }

                Console.WriteLine ();
                
                foreach (DataRow r in dt.Rows) {
                        for (int i =0 ; i < dt.Columns.Count; i++)
                                Console.Write ("{0,20}", r [i].ToString ());
                        Console.WriteLine ();
                }
                
        }


        public static void Print (DataView dv)
        {
                for (int i = 0 ; i < dv.Table.Columns.Count ; i++) {
                        Console.Write ("{0,20}", dv.Table.Columns [i].ColumnName);
                }

                Console.WriteLine ();
                
                foreach (DataRowView r in dv) {
                        for (int i =0 ; i < dv.Table.Columns.Count; i++)
                                Console.Write ("{0,20}", r [i].ToString ());
                        Console.WriteLine ();
                }
                
        }

        
}



