--- CaseInsensitiveHashCodeProvider.cs	2004-03-16 17:29:59.000000000 +0700
+++ CaseInsensitiveHashCodeProvider.cs-patch	2004-03-14 02:11:30.000000000 +0700
@@ -3,6 +3,9 @@
 //
 // Author:
 //   Sergey Chaban (serge@wildwestsoftware.com)
+//	 Mohammad DAMT (mdamt@cdl2000.com)
+//
+// (C) 2004 PT Cakram Datalingga Duaribu  http://www.cdl2000.com
 //
 
 
@@ -10,6 +13,7 @@
 using System;
 using System.Collections;
 using System.Globalization;
+using System.Threading;
 
 namespace System.Collections {
 
@@ -17,35 +21,30 @@
 	public class CaseInsensitiveHashCodeProvider : IHashCodeProvider {
 
 		private static CaseInsensitiveHashCodeProvider singleton;
-
+		CultureInfo cInfo = CultureInfo.InvariantCulture;
 
 		// Class constructor
-
 		static CaseInsensitiveHashCodeProvider ()
 		{
 			singleton=new CaseInsensitiveHashCodeProvider ();
 		}
 
-
-
 		// Public instance constructor
-
 		public CaseInsensitiveHashCodeProvider ()
 		{
 		}
 
-		[MonoTODO]
 		public CaseInsensitiveHashCodeProvider (CultureInfo culture)
 		{
-			throw new NotImplementedException ();
-		}
-
+			if (culture == null)
+				throw new ArgumentNullException ("culture");
 
+			cInfo = culture;			
+		}
 
 		//
 		// Public static properties
 		//
-
 		public static CaseInsensitiveHashCodeProvider Default {
 			get {
 				return singleton;
@@ -60,7 +59,6 @@
 		//
 		// IHashCodeProvider
 		//
-
 		public int GetHashCode (object obj)
 		{
 			if (obj == null) {
@@ -73,12 +71,10 @@
 				return obj.GetHashCode ();
 
 			int h = 0;
-			char c;
+			str = str.ToLower (cInfo);
 
-			int length = str.Length;
-			for (int i = 0;i<length;i++) {
-				c = Char.ToLower (str [i]);
-				h = h * 31 + c;
+			for (int i = 0; i < str.Length; i ++) {
+				h = h * 31 + str [i];
 			}
 
 			return h;
