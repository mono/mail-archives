<tt>
Hi,&nbsp;&lt;br&gt;&nbsp;&lt;p&gt;I&amp;#39;m&nbsp;writing&nbsp;a&nbsp;port&nbsp;scanning&nbsp;application&nbsp;that&nbsp;sends&nbsp;a&nbsp;SYN&nbsp;packet&nbsp;to&nbsp;a&nbsp;port&nbsp;on&nbsp;a&nbsp;host,&nbsp;identifying&nbsp;the&nbsp;status&nbsp;of&nbsp;the&nbsp;port&nbsp;by&nbsp;whether&nbsp;it&nbsp;returns&nbsp;a&nbsp;SYN/ACK,&nbsp;an&nbsp;ACK/RST&nbsp;or&nbsp;nothing&nbsp;at&nbsp;all.&amp;nbsp;&nbsp;In&nbsp;the&nbsp;example&nbsp;code&nbsp;below,&nbsp;I&amp;#39;m&nbsp;sending&nbsp;a&nbsp;SYN&nbsp;to&nbsp;port&nbsp;80&nbsp;and&nbsp;the&nbsp;source&nbsp;port&nbsp;of&nbsp;my&nbsp;machine&nbsp;is&nbsp;2126.&amp;nbsp;&nbsp;When&nbsp;I&nbsp;use&nbsp;a&nbsp;remote&nbsp;host&nbsp;(such&nbsp;as&nbsp;one&nbsp;of&nbsp;Google&amp;#39;s&nbsp;IP&nbsp;addresses&nbsp;in&nbsp;the&nbsp;example&nbsp;below),&nbsp;the&nbsp;SYN/ACK&nbsp;from&nbsp;Google&nbsp;port&nbsp;80&nbsp;is&nbsp;received&nbsp;by&nbsp;my&nbsp;machine&nbsp;on&nbsp;port&nbsp;2126,&nbsp;as&nbsp;expected.&nbsp;&amp;nbsp;&nbsp;However,&nbsp;when&nbsp;I&nbsp;try&nbsp;to&nbsp;send&nbsp;a&nbsp;SYN&nbsp;packet&nbsp;to&nbsp;port&nbsp;80&nbsp;on&nbsp;my&nbsp;own&nbsp;computer&nbsp;using&nbsp;any&nbsp;of&nbsp;the&nbsp;available&nbsp;IPs&nbsp;that&nbsp;identify&nbsp;my&nbsp;machine,&nbsp;locSocket&nbsp;on&nbsp;port&nbsp;2126&nbsp;receives&nbsp;the&nbsp;packet&nbsp;I&nbsp;sent&nbsp;that&nbsp;was&nbsp;intended&nbsp;for&nbsp;port&nbsp;80.&nbsp;&amp;nbsp;In&nbsp;other&nbsp;words,&nbsp;I&nbsp;send&nbsp;a&nbsp;packet&nbsp;to&nbsp;port&nbsp;80&nbsp;on&nbsp;my&nbsp;machine&nbsp;and&nbsp;it&nbsp;shows&nbsp;up&nbsp;on&nbsp;port&nbsp;2126&nbsp;instead.<br>
&lt;br&gt;&lt;br&gt;When&nbsp;I&nbsp;use&nbsp;Wireshark&nbsp;to&nbsp;see&nbsp;what&nbsp;is&nbsp;happening&nbsp;in&nbsp;the&nbsp;network&nbsp;layer,&nbsp;I&nbsp;don&amp;#39;t&nbsp;see&nbsp;this&nbsp;discrepancy&nbsp;-&nbsp;Wireshark&nbsp;identifies&nbsp;my&nbsp;SYN&nbsp;packet&nbsp;going&nbsp;from&nbsp;port&nbsp;2126&nbsp;to&nbsp;port&nbsp;80&nbsp;and&nbsp;the&nbsp;response&nbsp;packet&nbsp;going&nbsp;from&nbsp;port&nbsp;80&nbsp;to&nbsp;port&nbsp;2126.&amp;nbsp;&nbsp;Can&nbsp;anyone&nbsp;help&nbsp;explain&nbsp;what&nbsp;is&nbsp;happening&nbsp;-&nbsp;basically&nbsp;why&nbsp;my&nbsp;application&nbsp;behaves&nbsp;as&nbsp;expected&nbsp;when&nbsp;I&nbsp;try&nbsp;to&nbsp;scan&nbsp;a&nbsp;server&nbsp;half&nbsp;way&nbsp;across&nbsp;the&nbsp;globe&nbsp;but&nbsp;when&nbsp;I&nbsp;try&nbsp;to&nbsp;scan&nbsp;my&nbsp;own&nbsp;machine&nbsp;the&nbsp;packets&nbsp;aren&amp;#39;t&nbsp;making&nbsp;their&nbsp;way&nbsp;to&nbsp;my&nbsp;application&nbsp;the&nbsp;way&nbsp;they&nbsp;should?&nbsp;<br>
&lt;/p&gt;&lt;p&gt;I&amp;#39;ve&nbsp;attached&nbsp;code&nbsp;below&nbsp;showing&nbsp;what&nbsp;I&amp;#39;m&nbsp;doing&nbsp;with&nbsp;the&nbsp;remote&nbsp;endpoint.&nbsp;&amp;nbsp;The&nbsp;code&nbsp;I&amp;#39;ve&nbsp;skipped&nbsp;deals&nbsp;with&nbsp;building&nbsp;a&nbsp;TCP&nbsp;SYN&nbsp;packet&nbsp;and&nbsp;computing&nbsp;its&nbsp;checksum.&amp;nbsp;&nbsp;&lt;br&gt;&lt;/p&gt;&lt;p&gt;IPAddress&nbsp;remoteIP&nbsp;=&nbsp;IPAddress.Parse<br>
&nbsp;(&amp;quot;&lt;a&nbsp;href=&quot;http://64.233.187.99&quot;&gt;64.233.187.99&lt;/a&gt;&amp;quot;);&nbsp;&lt;br&gt;&nbsp;IPEndPoint&nbsp;remoteEndPoint&nbsp;=&nbsp;new&nbsp;IPEndPoint&nbsp;(remoteIP,&nbsp;port);&nbsp;&lt;br&gt;&nbsp;&lt;/p&gt;&lt;p&gt;System.Net.Sockets.Socket&nbsp;locSocket&nbsp;=&nbsp;new&nbsp;System.Net.Sockets.Socket&nbsp;&lt;br&gt;&nbsp;(AddressFamily.InterNetwork<br>
,&nbsp;SocketType.Raw,&nbsp;ProtocolType.Tcp);&nbsp;&lt;br&gt;&nbsp;System.Net.Sockets.Socket&nbsp;remSocket&nbsp;=&nbsp;new&nbsp;System.Net.Sockets.Socket&nbsp;&lt;br&gt;&nbsp;(AddressFamily.InterNetwork,&nbsp;SocketType.Raw,&nbsp;ProtocolType.Tcp);&nbsp;&lt;br&gt;&nbsp;locSocket.Bind&nbsp;(new&nbsp;IPEndPoint&nbsp;(locIP,&nbsp;2126));&nbsp;<br>
&lt;br&gt;&nbsp;&lt;/p&gt;&lt;p&gt;/*&nbsp;&lt;br&gt;&nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&nbsp;&amp;nbsp;Code&nbsp;to&nbsp;create&nbsp;a&nbsp;packet&nbsp;of&nbsp;data&nbsp;(byte[]&nbsp;datagram)&nbsp;goes&nbsp;here&nbsp;&lt;br&gt;&nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;*/&nbsp;&lt;br&gt;&nbsp;&lt;/p&gt;byte[]&nbsp;receivedPacket&nbsp;=&nbsp;new&nbsp;byte[96];&nbsp;&lt;br&gt;&nbsp;Console.WriteLine&nbsp;(&amp;quot;Sending&nbsp;packet...&amp;quot;);&nbsp;&lt;br&gt;&nbsp;remSocket.SendTo<br>
&nbsp;(datagram,&nbsp;remoteEndPoint);&nbsp;&lt;br&gt;&nbsp;Console.WriteLine&nbsp;(&amp;quot;Packet&nbsp;sent&amp;quot;);&nbsp;&lt;br&gt;&nbsp;locSocket.Receive&nbsp;(receivedPacket);&nbsp;<br>

</tt>
