<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Jonathan&nbsp;Pryor&nbsp;wrote:<br>
&lt;blockquote&nbsp;cite=&quot;mid:1200080343.4616.77.camel@lina.magi.jprl.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;(aside&nbsp;from&nbsp;syntax&nbsp;and&nbsp;tests)&nbsp;Options&nbsp;_should_&nbsp;currently&nbsp;be&nbsp;.NET&nbsp;2.0&nbsp;compatible<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
I&nbsp;think&nbsp;2.0&nbsp;compatibility&nbsp;is&nbsp;important.&amp;nbsp;&nbsp;Not&nbsp;everybody&nbsp;is&nbsp;ready&nbsp;to&nbsp;jump<br>
on&nbsp;the&nbsp;C#&nbsp;3.0&nbsp;bandwagon&nbsp;(my&nbsp;company&nbsp;included).&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:1200080343.4616.77.camel@lina.magi.jprl.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;I&nbsp;guess&nbsp;I&nbsp;should&nbsp;create&nbsp;a&nbsp;new&nbsp;delegate&nbsp;type:<br>
<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspdelegate&nbsp;string&nbsp;OptionLocalizer&nbsp;(string&nbsp;format,&nbsp;string[]&nbsp;args);<br>
<br>
Other&nbsp;possible&nbsp;type&nbsp;names&nbsp;appreciated&nbsp;(and&nbsp;I&nbsp;don't&nbsp;like&nbsp;Rafael's<br>
TranslateIt&nbsp;name.&nbsp;;-)<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
I&nbsp;like&nbsp;this&nbsp;approach.&amp;nbsp;&nbsp;Would&nbsp;it&nbsp;be&nbsp;used&nbsp;for&nbsp;option&nbsp;descriptions&nbsp;as<br>
well?&amp;nbsp;&nbsp;&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:1200080343.4616.77.camel@lina.magi.jprl.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;This&nbsp;is&nbsp;also&nbsp;a&nbsp;good&nbsp;idea,&nbsp;and&nbsp;suffers&nbsp;the&nbsp;same&nbsp;problem&nbsp;as&nbsp;providing&nbsp;the<br>
actual&nbsp;option&nbsp;used:&nbsp;the&nbsp;callback&nbsp;doesn't&nbsp;have&nbsp;that&nbsp;information,&nbsp;and&nbsp;thus<br>
can't&nbsp;provide&nbsp;it&nbsp;in&nbsp;the&nbsp;OptionException.<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
I&nbsp;faced&nbsp;this&nbsp;exact&nbsp;issue&nbsp;in&nbsp;a&nbsp;configuration&nbsp;system&nbsp;I&nbsp;wrote,&nbsp;except<br>
there&nbsp;the&nbsp;problem&nbsp;was&nbsp;exacerbated&nbsp;by&nbsp;the&nbsp;need&nbsp;to&nbsp;have&nbsp;file&nbsp;and&nbsp;line<br>
information&nbsp;in&nbsp;the&nbsp;exception&nbsp;(plus&nbsp;it&nbsp;was&nbsp;based&nbsp;on&nbsp;.NET&nbsp;1.1,&nbsp;so&nbsp;no&nbsp;anon<br>
delegates&nbsp;to&nbsp;make&nbsp;things&nbsp;prettier).&nbsp;I&amp;nbsp;&nbsp;solved&nbsp;it&nbsp;by&nbsp;requiring&nbsp;the&nbsp;use<br>
of&nbsp;a&nbsp;context&nbsp;object.&lt;br&gt;<br>
&lt;br&gt;<br>
How&nbsp;about&nbsp;this.&amp;nbsp;&nbsp;Create&nbsp;a&nbsp;delegate&nbsp;that&nbsp;takes&nbsp;the&nbsp;necessary&nbsp;context<br>
information,&nbsp;e.g.:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;tt&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;delegate&nbsp;void&nbsp;OptionAction&amp;lt;T&amp;gt;(T&nbsp;v,&nbsp;string&nbsp;optionName);&lt;br&gt;<br>
&lt;/tt&gt;&lt;br&gt;<br>
and&nbsp;use&nbsp;this&nbsp;as&nbsp;the&nbsp;argument&nbsp;to&nbsp;the&nbsp;workhorse&nbsp;Add&amp;lt;T&amp;gt;&nbsp;method:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;tt&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;Options&nbsp;Add&amp;lt;T&amp;gt;&nbsp;(string&nbsp;options,&nbsp;string<br>
description,&nbsp;OptionAction&amp;lt;T&amp;gt;&nbsp;action)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/tt&gt;then&nbsp;create&nbsp;an&nbsp;overloaded&nbsp;Add&amp;lt;T&amp;gt;&nbsp;that&nbsp;accepts&nbsp;an<br>
Action&amp;lt;T&amp;gt;&nbsp;and&nbsp;calls&nbsp;the&nbsp;workhorse&nbsp;method:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;tt&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;Options&nbsp;Add&amp;lt;T&amp;gt;(string&nbsp;options,&nbsp;string&nbsp;description,<br>
Action&amp;lt;T&amp;gt;&nbsp;action)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;Add(options,&nbsp;description,&nbsp;delegate(T&nbsp;v,&nbsp;string<br>
optionName)&nbsp;{&nbsp;action(v);&nbsp;});&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;/tt&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;way&nbsp;the&nbsp;user&nbsp;can&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;context&nbsp;when&nbsp;they&nbsp;want&nbsp;too,&nbsp;but<br>
the&nbsp;type&nbsp;conversion&nbsp;code&nbsp;has&nbsp;access&nbsp;to&nbsp;it&nbsp;all&nbsp;the&nbsp;time.&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:1200080343.4616.77.camel@lina.magi.jprl.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;Foo&nbsp;isn't&nbsp;a&nbsp;stand-in&nbsp;for&nbsp;the&nbsp;real&nbsp;type,&nbsp;it&nbsp;*is*&nbsp;the&nbsp;real&nbsp;type.&nbsp;&nbsp;Just&nbsp;as<br>
`int'&nbsp;is&nbsp;the&nbsp;real&nbsp;type,&nbsp;not&nbsp;System.ComponentModel.Int32Converter&nbsp;(the<br>
actual&nbsp;type&nbsp;that&nbsp;does&nbsp;the&nbsp;string-&amp;gt;int&nbsp;conversion).&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
What&nbsp;about&nbsp;the&nbsp;case&nbsp;where&nbsp;you&nbsp;want&nbsp;an&nbsp;option&nbsp;that&nbsp;accepts&nbsp;standard<br>
binary&nbsp;abbreviations,&nbsp;e.g.&nbsp;1K&nbsp;for&nbsp;1024?&amp;nbsp;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;value&nbsp;is<br>
clearly&nbsp;an&nbsp;integer,&nbsp;but&nbsp;I&nbsp;need&nbsp;a&nbsp;custom&nbsp;parser&nbsp;to&nbsp;handle&nbsp;the&nbsp;syntax.&amp;nbsp;&amp;nbsp;<br>
I'd&nbsp;rather&nbsp;not&nbsp;have&nbsp;to&nbsp;wrap&nbsp;the&nbsp;integer&nbsp;in&nbsp;a&nbsp;custom&nbsp;type&nbsp;just&nbsp;to&nbsp;get<br>
special&nbsp;parsing&nbsp;behavior&nbsp;(e.g.&nbsp;class&nbsp;Int32ThatSupportsBinAbbrevs&nbsp;:-).&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;said,&nbsp;if&nbsp;you&nbsp;solve&nbsp;the&nbsp;problem&nbsp;of&nbsp;user&nbsp;thrown&nbsp;exceptions&nbsp;having<br>
access&nbsp;to&nbsp;the&nbsp;parsing&nbsp;context,&nbsp;then&nbsp;I&nbsp;can&nbsp;just&nbsp;handle&nbsp;this&nbsp;myself&nbsp;in<br>
the&nbsp;Action&nbsp;code.&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;Jay&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
