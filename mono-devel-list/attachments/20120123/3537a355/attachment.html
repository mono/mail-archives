<tt>
Mono&nbsp;os&nbsp;OSX&nbsp;has&nbsp;some&nbsp;performance&nbsp;issues&nbsp;due&nbsp;to&nbsp;multiple&nbsp;factors,&nbsp;some&nbsp;Reimer&nbsp;pointed&nbsp;out,&nbsp;but&nbsp;it&#39;s&nbsp;hard&nbsp;to&nbsp;tell&nbsp;without&nbsp;a&nbsp;good&nbsp;profiler&nbsp;run.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Boehm&nbsp;doesn&#39;t&nbsp;support&nbsp;the&nbsp;fast&nbsp;memory&nbsp;allocator&nbsp;on&nbsp;OSX.&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;lack&nbsp;of&nbsp;compiler&nbsp;support&nbsp;for&nbsp;fast&nbsp;TLS&nbsp;is&nbsp;another&nbsp;pain&nbsp;point,&nbsp;this&nbsp;has&nbsp;been&nbsp;mostly&nbsp;addressed&nbsp;on&nbsp;trunk&nbsp;so&nbsp;2.12&nbsp;will&nbsp;be&nbsp;closer.&lt;/div&gt;&lt;div&gt;Another&nbsp;issue&nbsp;is&nbsp;that&nbsp;OSX&nbsp;primitives&nbsp;are&nbsp;much&nbsp;worse&nbsp;than&nbsp;linux&#39;s.&nbsp;Things&nbsp;like&nbsp;mutex&#39;es&nbsp;and&nbsp;semephores&nbsp;perform&nbsp;much&nbsp;worse.&lt;/div&gt;<br>
&lt;div&gt;Finally,&nbsp;the&nbsp;32&nbsp;x&nbsp;64&nbsp;bits&nbsp;issue&nbsp;can&nbsp;make&nbsp;a&nbsp;huge&nbsp;difference&nbsp;depending&nbsp;on&nbsp;your&nbsp;code.&nbsp;If&nbsp;you&#39;re&nbsp;doing&nbsp;a&nbsp;lot&nbsp;of&nbsp;64bits&nbsp;math&nbsp;or&nbsp;your&lt;/div&gt;&lt;div&gt;code&nbsp;is&nbsp;register&nbsp;happy,&nbsp;32bits&nbsp;will&nbsp;be&nbsp;slower.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jonathan,&nbsp;if&nbsp;you&nbsp;could&nbsp;do&nbsp;an&nbsp;Instruments&nbsp;run&nbsp;on&nbsp;osx&nbsp;and&nbsp;perf&nbsp;on&nbsp;linux&nbsp;of&nbsp;your&nbsp;add&nbsp;and&nbsp;send&nbsp;the&nbsp;decoded&nbsp;results,&nbsp;it&nbsp;would&nbsp;help&nbsp;a&nbsp;lot&nbsp;troubleshoot&lt;/div&gt;<br>
&lt;div&gt;the&nbsp;issue.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sat,&nbsp;Jan&nbsp;21,&nbsp;2012&nbsp;at&nbsp;5:28&nbsp;PM,&nbsp;Jonathan&nbsp;Shore&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:jonathan.shore@gmail.com&quot;&gt;jonathan.shore@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:break-word&quot;&gt;I&nbsp;am&nbsp;running&nbsp;a&nbsp;program&nbsp;that&nbsp;does&nbsp;millions&nbsp;of&nbsp;transactions&nbsp;on&nbsp;FIFO&nbsp;queues,&nbsp;etc.&nbsp; &nbsp;Running&nbsp;on&nbsp;my&nbsp;OSX&nbsp;box&nbsp;(which&nbsp;is&nbsp;on&nbsp;a&nbsp;dual&nbsp;CPU&nbsp;/&nbsp;8&nbsp;core&nbsp;Xeon&nbsp;E5520)&nbsp;and&nbsp;on&nbsp;a&nbsp;linux&nbsp;box&nbsp;which&nbsp;is&nbsp;a&nbsp;core&nbsp;I7-950,&nbsp;I&nbsp;found&nbsp;a&nbsp;significant&nbsp;performance&nbsp;difference&nbsp;which&nbsp;is&nbsp;difficult&nbsp;to&nbsp;explain.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;a&nbsp;single&nbsp;threaded&nbsp;run,&nbsp;the&nbsp;OSX&nbsp;based&nbsp;E5520&nbsp;took&nbsp;21&nbsp;seconds&nbsp;to&nbsp;process&nbsp;8&nbsp;million&nbsp;&quot;transactions&quot;&nbsp;and&nbsp;the&nbsp;linux&nbsp;box&nbsp;took&nbsp;only&nbsp;8&nbsp;seconds.&nbsp; &nbsp;The&nbsp;i7-950&nbsp;is&nbsp;marginally&nbsp;faster&nbsp;(~10%&nbsp;faster)&nbsp;in&nbsp;typical&nbsp;benchmarks&nbsp;that&nbsp;the&nbsp;E5520.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Both&nbsp;runs&nbsp;were&nbsp;done&nbsp;with&nbsp;-llvm&nbsp;enabled&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;garbage&nbsp;collector.&nbsp; &nbsp; There&nbsp;are&nbsp;probably&nbsp;16&nbsp;-&nbsp;32&nbsp;million&nbsp;small&nbsp;objects&nbsp;created&nbsp;during&nbsp;the&nbsp;course&nbsp;of&nbsp;this&nbsp;evaluation,&nbsp;but&nbsp;generally&nbsp;with&nbsp;good&nbsp;locality,&nbsp;so&nbsp;should&nbsp;be&nbsp;easy&nbsp;to&nbsp;GC.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;&lt;b&gt;OSX-based&nbsp;mono&nbsp;performance&nbsp;for&nbsp;this&nbsp;app&nbsp;is&nbsp;3x&nbsp;slower&lt;/b&gt;&nbsp;than&nbsp;the&nbsp;linux&nbsp;performance&nbsp;(whereas&nbsp;for&nbsp;typical&nbsp;programs,&nbsp;say&nbsp;in&nbsp;C,&nbsp;the&nbsp;difference&nbsp;would&nbsp;be&nbsp;about&nbsp;10%).&nbsp; &nbsp;Both&nbsp;the&nbsp;linux&nbsp;and&nbsp;OSX&nbsp;boxes&nbsp;have&nbsp;significant&nbsp;memory&nbsp;(in&nbsp;fact&nbsp;the&nbsp;OSX&nbsp;box&nbsp;has&nbsp;more&nbsp;memory).&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Finally,&nbsp;the&nbsp;OSX&nbsp;version&nbsp;is&nbsp;using&nbsp;2.10.8&nbsp;32bit&nbsp; and&nbsp;the&nbsp;linux&nbsp;version&nbsp;2.10.6&nbsp;64bit.&nbsp; I&nbsp;doubt&nbsp;that&nbsp;there&nbsp;is&nbsp;a&nbsp;retrogression&nbsp;in&nbsp;performance&nbsp;between&nbsp;2.10.6.&nbsp; Thinking&nbsp;is&nbsp;more&nbsp;likely&nbsp;to&nbsp;be&nbsp;an&nbsp;implementation&nbsp;difference&nbsp;between&nbsp;OSX&nbsp;and&nbsp;linux?&nbsp; &nbsp; I&nbsp;would&nbsp;also&nbsp;think&nbsp;that&nbsp;the&nbsp;32bit&nbsp;vs&nbsp;64bit&nbsp;would&nbsp;not&nbsp;make&nbsp;all&nbsp;that&nbsp;much&nbsp;difference?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;I&nbsp;am&nbsp;wondering&nbsp;whether&nbsp;there&nbsp;are&nbsp;differences&nbsp;in&nbsp;implementation&nbsp;between&nbsp;mono&nbsp;on&nbsp;these&nbsp;platforms&nbsp;that&nbsp;could&nbsp;account&nbsp;for&nbsp;a&nbsp;significant&nbsp;performance&nbsp;difference?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;<br>
Jonathan&lt;/div&gt;&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
