<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Jan&nbsp;23,&nbsp;2012&nbsp;at&nbsp;12:18&nbsp;PM,&nbsp;Jonathan&nbsp;Shore&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:jonathan.shore@gmail.com&quot;&gt;jonathan.shore@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:break-word&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;div&gt;On&nbsp;Jan&nbsp;23,&nbsp;2012,&nbsp;at&nbsp;7:27&nbsp;AM,&nbsp;Rodrigo&nbsp;Kumpera&nbsp;wrote:&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Mono&nbsp;os&nbsp;OSX&nbsp;has&nbsp;some&nbsp;performance&nbsp;issues&nbsp;due&nbsp;to&nbsp;multiple&nbsp;factors,&nbsp;some&nbsp;Reimer&nbsp;pointed&nbsp;out,&nbsp;but&nbsp;it&#39;s&nbsp;hard&nbsp;to&nbsp;tell&nbsp;without&nbsp;a&nbsp;good&nbsp;profiler&nbsp;run.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;Boehm&nbsp;doesn&#39;t&nbsp;support&nbsp;the&nbsp;fast&nbsp;memory&nbsp;allocator&nbsp;on&nbsp;OSX.&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;lack&nbsp;of&nbsp;compiler&nbsp;support&nbsp;for&nbsp;fast&nbsp;TLS&nbsp;is&nbsp;another&nbsp;pain&nbsp;point,&nbsp;this&nbsp;has&nbsp;been&nbsp;mostly&nbsp;addressed&nbsp;on&nbsp;trunk&nbsp;so&nbsp;2.12&nbsp;will&nbsp;be&nbsp;closer.&lt;/div&gt;&lt;div&gt;Another&nbsp;issue&nbsp;is&nbsp;that&nbsp;OSX&nbsp;primitives&nbsp;are&nbsp;much&nbsp;worse&nbsp;than&nbsp;linux&#39;s.&nbsp;Things&nbsp;like&nbsp;mutex&#39;es&nbsp;and&nbsp;semephores&nbsp;perform&nbsp;much&nbsp;worse.&lt;/div&gt;<br>
<br>
&lt;div&gt;Finally,&nbsp;the&nbsp;32&nbsp;x&nbsp;64&nbsp;bits&nbsp;issue&nbsp;can&nbsp;make&nbsp;a&nbsp;huge&nbsp;difference&nbsp;depending&nbsp;on&nbsp;your&nbsp;code.&nbsp;If&nbsp;you&#39;re&nbsp;doing&nbsp;a&nbsp;lot&nbsp;of&nbsp;64bits&nbsp;math&nbsp;or&nbsp;your&lt;/div&gt;&lt;div&gt;code&nbsp;is&nbsp;register&nbsp;happy,&nbsp;32bits&nbsp;will&nbsp;be&nbsp;slower.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;see.&nbsp; I&nbsp;am&nbsp;using&nbsp;a&nbsp;SpinLock&nbsp;around&nbsp;every&nbsp;(very&nbsp;short&nbsp;lived)&nbsp;transaction.&nbsp; &nbsp;Perhaps&nbsp;the&nbsp;primitives&nbsp;used&nbsp;in&nbsp;SpinWait&nbsp;have&nbsp;a&nbsp;different&nbsp;performance&nbsp;profile&nbsp;on&nbsp;OSX&nbsp;vs&nbsp;Linux?&nbsp; &nbsp;Also,&nbsp;all&nbsp;of&nbsp;the&nbsp;transactions&nbsp;involve&nbsp;longs&nbsp;and&nbsp;doubles&nbsp;{comparisons,&nbsp;load/store,&nbsp;some&nbsp;arithmetic).&nbsp; &nbsp;I&nbsp;am&nbsp;not&nbsp;at&nbsp;all&nbsp;clear&nbsp;on&nbsp;how&nbsp;longs&nbsp;and&nbsp;doubles&nbsp;would&nbsp;be&nbsp;rendered&nbsp;differently&nbsp;in&nbsp;terms&nbsp;of&nbsp;instructions&nbsp;on&nbsp;32bit&nbsp;vs&nbsp;64bit.&nbsp; &nbsp; I&nbsp;thought&nbsp;even&nbsp;in&nbsp;the&nbsp;32bit&nbsp;world,&nbsp;intel&nbsp;CPUs&nbsp;had&nbsp;a&nbsp;64bit&nbsp;pipeline&nbsp;for&nbsp;doubles,&nbsp;though&nbsp;probably&nbsp;not&nbsp;for&nbsp;longs.&nbsp;  &lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;doubles&nbsp;have&nbsp;hardware&nbsp;support&nbsp;on&nbsp;32&nbsp;and&nbsp;64bits.&nbsp;longs&nbsp;don&#39;t&nbsp;have&nbsp;any&nbsp;under&nbsp;32bits&nbsp;and&nbsp;things&nbsp;like&nbsp;division&nbsp;are&nbsp;done&nbsp;in&nbsp;software.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:break-word&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;sort&nbsp;of&nbsp;instrumentation&nbsp;would&nbsp;be&nbsp;useful? &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Nothing&nbsp;fancy,&nbsp;high&nbsp;frequency&nbsp;sampling&nbsp;to&nbsp;see&nbsp;what&nbsp;runtime&nbsp;code&nbsp;shows&nbsp;up.&nbsp;On&nbsp;instruments&nbsp;this&nbsp;the&nbsp;template&nbsp;under:&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;-&gt;&nbsp;CPU&nbsp;-&gt;&nbsp;Timer&nbsp;Profiler.&lt;/div&gt;<br>
&lt;div&gt;Then&nbsp;customize&nbsp;it&nbsp;from&nbsp;a&nbsp;sample&nbsp;every&nbsp;1ms&nbsp;to&nbsp;every&nbsp;100&nbsp;us.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
