<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;style&gt;Hi,&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;have&nbsp;found&nbsp;a&nbsp;mismatch&nbsp;in&nbsp;behaviour&nbsp;between&nbsp;mono&nbsp;and&nbsp;.NET&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Mono&nbsp;version:&nbsp;Mono&nbsp;JIT&nbsp;compiler&nbsp;version&nbsp;3.0.4&nbsp;(master/e5fba9d&nbsp;Wed&nbsp;Jan&nbsp;30&nbsp;18:38:48&nbsp;GMT&nbsp;2013)&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style&gt;.NET&nbsp;version:&nbsp;4.5&nbsp;from&nbsp;VS2012&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Running&nbsp;the&nbsp;simple&nbsp;program&nbsp;below&nbsp;which&nbsp;reads&nbsp;mscorlib.dll&nbsp;into&nbsp;memory&nbsp;and&nbsp;then&nbsp;loads&nbsp;in&nbsp;with&nbsp;Assembly.Load&nbsp;causes&nbsp;Mono&nbsp;to&nbsp;afterwards&nbsp;return&nbsp;the&nbsp;location&nbsp;of&nbsp;mscorlib&nbsp;as&nbsp;the&nbsp;empty&nbsp;string.&nbsp;On&nbsp;.NET&nbsp;the&nbsp;original&nbsp;location&nbsp;of&nbsp;mscorlib&nbsp;is&nbsp;returned.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Program:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;open&nbsp;System.Reflection&lt;/div&gt;&lt;div&gt;open&nbsp;System&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;[&lt;EntryPoint&gt;]&lt;/div&gt;&lt;div&gt;let&nbsp;main&nbsp;args&nbsp;=&lt;/div&gt;&lt;div&gt; &nbsp;let&nbsp;asmBytes&nbsp;=&nbsp;System.IO.File.ReadAllBytes(&quot;/home/scratch/local_mono/lib/mono/4.5/mscorlib.dll&quot;)&lt;/div&gt;<br>
<br>
<br>
&lt;div&gt; &nbsp;printfn&nbsp;&quot;Location&nbsp;of&nbsp;mscorlib:&nbsp;&#39;%s&#39;&quot;&nbsp;(typeof&lt;System.Object&gt;.Assembly.Location)&lt;/div&gt;&lt;div&gt; &nbsp;let&nbsp;assm&nbsp;=&nbsp;Assembly.Load(asmBytes)&lt;/div&gt;&lt;div&gt; &nbsp;printfn&nbsp;&quot;Location&nbsp;of&nbsp;mscorlib:&nbsp;&#39;%s&#39;&quot;&nbsp;(typeof&lt;System.Object&gt;.Assembly.Location)&lt;/div&gt;<br>
<br>
<br>
&lt;div&gt; &nbsp;0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Output:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;div&gt;Location&nbsp;of&nbsp;mscorlib:&nbsp;&#39;/home/scratch/local_mono/lib/mono/4.5/mscorlib.dll&#39;&lt;/div&gt;&lt;div&gt;Location&nbsp;of&nbsp;mscorlib:&nbsp;&#39;&#39;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;On&nbsp;Windows&nbsp;I&nbsp;change&nbsp;ReadAllBytes&nbsp;to&nbsp;load&nbsp;from @&quot;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorlib.dll&quot;,&nbsp;and&nbsp;the&nbsp;output&nbsp;is:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;div&gt;Location&nbsp;of&nbsp;mscorlib:&nbsp;&#39;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorlib.&lt;/div&gt;<br>
<br>
&lt;div&gt;dll&#39;&lt;/div&gt;&lt;div&gt;Location&nbsp;of&nbsp;mscorlib:&nbsp;&#39;C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorlib.&lt;/div&gt;&lt;div&gt;dll&#39;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;This&nbsp;causes&nbsp;problems&nbsp;if&nbsp;you&nbsp;try&nbsp;to&nbsp;do&nbsp;this&nbsp;during&nbsp;xbuild&nbsp;because&nbsp;some&nbsp;tasks&nbsp;(in&nbsp;my&nbsp;case&nbsp;the&nbsp;Fsc&nbsp;task)&nbsp;try&nbsp;to&nbsp;find&nbsp;the&nbsp;mono&nbsp;location&nbsp;and&nbsp;call&nbsp;into&nbsp;MonoLocationHelper.cs:47&nbsp;which&nbsp;is&nbsp;below:&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;assemblyLocation&nbsp;=&nbsp;Path.GetDirectoryName&nbsp;(typeof&nbsp;(object).Assembly.Location);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;This&nbsp;line&nbsp;then&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string&nbsp;and&nbsp;everything&nbsp;goes&nbsp;wrong&nbsp;from&nbsp;there.&lt;/div&gt;&lt;div&nbsp;style&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
