Index: ChangeLog
===================================================================
--- ChangeLog	(revision 98283)
+++ ChangeLog	(working copy)
@@ -1,3 +1,7 @@
+2006-03-08
+	* check immediatly to see if a provider fails to load 
+        otherwise it's possible to attempt to dereference a null value
+
 2006-02-13  Daniel Morgan <danielmorgan@verizon.net>
 	
 	* ProviderSectionHandler.cs
Index: Provider.cs
===================================================================
--- Provider.cs	(revision 98283)
+++ Provider.cs	(working copy)
@@ -132,7 +132,13 @@
 						providerAssembly = Assembly.LoadWithPartialName (assemblyName);
 					else 
 						providerAssembly = Assembly.Load (assemblyName);
+
+					//if it's still null then the provider was not loadable
+					if (providerAssembly == null) 
+						throw new Exception (String.Format ("Unable to load type of connection class: {0} from an assembly named: {1}. Is it installed?",
+							connectionTypeName, assemblyName));
 				}
+				
 
 				return providerAssembly;
 			}
Index: ProviderFactory.cs
===================================================================
--- ProviderFactory.cs	(revision 98283)
+++ ProviderFactory.cs	(working copy)
@@ -93,11 +93,25 @@
 
 		static public IDbConnection CreateConnection(string ProviderName, string ConnectionString)
 		{
+			bool foundProvider = false;
+
 			if (ProviderName == null) 
 				throw new System.ArgumentNullException("ProviderName");
 			if (ConnectionString == null) 
 				throw new System.ArgumentNullException ("ConnectionString");
 
+			foreach (Provider tmpProvider in providers)
+			{
+				if (tmpProvider.Name.CompareTo (ProviderName) == 0)
+				{
+					foundProvider = true;
+					break;
+				}	
+			} 
+
+			if  ( ! foundProvider ) 
+				throw new System.ArgumentOutOfRangeException("ProviderName",ProviderName,"Unable to find a provider of the specified class in the list of available providers " );
+			
 			Provider provider = providers [ProviderName];
 			IDbConnection conn = provider.CreateConnection ();
 			conn.ConnectionString = ConnectionString;
