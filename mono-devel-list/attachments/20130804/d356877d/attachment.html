<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&nbsp;&quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Zarafa&nbsp;WebApp&nbsp;v7.1.5-41923&quot;&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;title&gt;RE:&nbsp;[Mono-dev]&nbsp;NancyFX&nbsp;self&nbsp;hosting&nbsp;(HttpListener)&nbsp;locking&nbsp;up&nbsp;on&nbsp;linux&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;Hi&nbsp;Esben.&lt;/font&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;Certainly&nbsp;a&nbsp;good&nbsp;suggestion.&nbsp;I've&nbsp;tried&nbsp;increasing&nbsp;it:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;div&gt;nitoback@mulder:~$&nbsp;ulimit&nbsp;-Sn&lt;/div&gt;&lt;div&gt;200000&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;nitoback@mulder:~$&nbsp;ulimit&nbsp;-Hn&lt;/div&gt;&lt;div&gt;200000&lt;/div&gt;&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;Doesn't&nbsp;really&nbsp;have&nbsp;any&nbsp;effect.&nbsp;Here's&nbsp;what&nbsp;happens&nbsp;when&nbsp;I&nbsp;start&nbsp;hammering&nbsp;it&nbsp;-&nbsp;regarding&nbsp;connections&nbsp;-&nbsp;The&nbsp;self&nbsp;host&nbsp;is&nbsp;running&nbsp;on&nbsp;port&nbsp;9591:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;div&gt;root@mulder:~#&nbsp;lsof&nbsp;-n&nbsp;|&nbsp;grep&nbsp;-i&nbsp;9591&nbsp;|&nbsp;wc&nbsp;-l&lt;/div&gt;&lt;div&gt;93&lt;/div&gt;&lt;div&gt;root@mulder:~#&nbsp;lsof&nbsp;-n&nbsp;|&nbsp;grep&nbsp;-i&nbsp;9591&nbsp;|&nbsp;wc&nbsp;-l&lt;/div&gt;&lt;div&gt;642&lt;/div&gt;&lt;div&gt;root@mulder:~#&nbsp;lsof&nbsp;-n&nbsp;|&nbsp;grep&nbsp;-i&nbsp;9591&nbsp;|&nbsp;wc&nbsp;-l&lt;/div&gt;&lt;div&gt;573&lt;/div&gt;&lt;div&gt;root@mulder:~#&nbsp;lsof&nbsp;-n&nbsp;|&nbsp;grep&nbsp;-i&nbsp;9591&nbsp;|&nbsp;wc&nbsp;-l&lt;/div&gt;&lt;div&gt;677&lt;/div&gt;&lt;div&gt;root@mulder:~#&nbsp;lsof&nbsp;-n&nbsp;|&nbsp;grep&nbsp;-i&nbsp;9591&nbsp;|&nbsp;wc&nbsp;-l&lt;/div&gt;&lt;div&gt;1270&lt;/div&gt;&lt;div&gt;root@mulder:~#&nbsp;lsof&nbsp;-n&nbsp;|&nbsp;grep&nbsp;-i&nbsp;9591&nbsp;|&nbsp;wc&nbsp;-l&lt;/div&gt;&lt;div&gt;1270&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;connection&nbsp;count&nbsp;goes&nbsp;up&nbsp;to&nbsp;1270&nbsp;and&nbsp;at&nbsp;that&nbsp;point&nbsp;it&nbsp;hangs,&nbsp;this&nbsp;is&nbsp;slightly&nbsp;different&nbsp;each&nbsp;time&nbsp;I&nbsp;run&nbsp;this.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;After&nbsp;having&nbsp;stopped&nbsp;the&nbsp;tests&nbsp;and&nbsp;10&nbsp;minutes&nbsp;after&nbsp;it:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@mulder:~#&nbsp;lsof&nbsp;-n&nbsp;|&nbsp;grep&nbsp;-i&nbsp;9591&nbsp;|&nbsp;wc&nbsp;-l&lt;/div&gt;&lt;div&gt;1170&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;an&nbsp;example&nbsp;of&nbsp;the&nbsp;connections&nbsp;that&nbsp;are&nbsp;in&nbsp;the&nbsp;CLOSE_WAIT&nbsp;state:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;mono&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2788&nbsp;2840&nbsp;&nbsp;&nbsp;nitoback&nbsp;&nbsp;&nbsp;71u&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPv4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65081&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP&nbsp;127.0.0.1:9591-&gt;127.0.0.1:40372&nbsp;(CLOSE_WAIT)&lt;/div&gt;&lt;div&gt;mono&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2788&nbsp;2840&nbsp;&nbsp;&nbsp;nitoback&nbsp;&nbsp;&nbsp;72u&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPv4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65082&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP&nbsp;127.0.0.1:9591-&gt;127.0.0.1:40373&nbsp;(CLOSE_WAIT)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;They&nbsp;seem&nbsp;to&nbsp;be&nbsp;stuck&nbsp;in&nbsp;CLOSE_WAIT&nbsp;which&nbsp;I&nbsp;guess&nbsp;means&nbsp;that&nbsp;there&nbsp;is&nbsp;unread&nbsp;data&nbsp;on&nbsp;the&nbsp;socket.&nbsp;When&nbsp;it&nbsp;gets&nbsp;into&nbsp;this&nbsp;situation&nbsp;its&nbsp;not&nbsp;recoverable,&nbsp;just&nbsp;hangs&nbsp;and&nbsp;keeps&nbsp;the&nbsp;connections&nbsp;in&nbsp;CLOSE_WAIT&nbsp;state.&lt;/div&gt;&lt;/font&gt;&lt;blockquote&nbsp;style=&quot;border-left:&nbsp;2px&nbsp;solid&nbsp;#325FBA;&nbsp;padding-left:&nbsp;5px;&nbsp;margin-left:&nbsp;5px;&nbsp;margin-right:&nbsp;0px;&quot;&gt;-----Original&nbsp;message-----&lt;br&gt;&lt;strong&gt;From:&lt;/strong&gt;&nbsp;hyber@hyber.dk&nbsp;&lt;hyber@hyber.dk&gt;&lt;br&gt;&lt;strong&gt;Sent:&lt;/strong&gt;&nbsp;Sunday&nbsp;4th&nbsp;August&nbsp;2013&nbsp;14:39&lt;br&gt;&lt;strong&gt;To:&lt;/strong&gt;&nbsp;Alfred&nbsp;Hall&nbsp;&lt;ahall@ahall.org&gt;&lt;br&gt;&lt;strong&gt;Cc:&lt;/strong&gt;&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;&lt;strong&gt;Subject:&lt;/strong&gt;&nbsp;SV:&nbsp;[Mono-dev]&nbsp;NancyFX&nbsp;self&nbsp;hosting&nbsp;(HttpListener)&nbsp;locking&nbsp;up&nbsp;on&nbsp;linux&lt;br&gt;&lt;br&gt;&lt;base&nbsp;target=&quot;_blank&quot;&gt;<br>
&lt;!--&nbsp;begin&nbsp;sanitized&nbsp;html&nbsp;--&gt;<br>
<br>
<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<br>
<br>
&lt;div&nbsp;class=&quot;bodyclass&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;Arial;&quot;&gt;Hi&nbsp;Alfred&lt;br&gt;&lt;br&gt;Are&nbsp;you&nbsp;sure&nbsp;its&nbsp;not&nbsp;a&nbsp;ulimit&nbsp;issue?&nbsp;I&nbsp;have&nbsp;had&nbsp;this&nbsp;issue&nbsp;before&nbsp;with&nbsp;the&nbsp;&quot;nofile&quot;&nbsp;limit&nbsp;as&nbsp;each&nbsp;tcp&nbsp;session&nbsp;is&nbsp;a&nbsp;&quot;file&quot;&nbsp;under&nbsp;/proc&nbsp;and&nbsp;when&nbsp;you&nbsp;have&nbsp;1024&nbsp;open&nbsp;(or&nbsp;close&nbsp;wait)&nbsp;sessions&nbsp;the&nbsp;OS&nbsp;does&nbsp;not&nbsp;allow&nbsp;you&nbsp;to&nbsp;open&nbsp;more&nbsp;files&nbsp;and&nbsp;the&nbsp;code&nbsp;seems&nbsp;to&nbsp;hang&nbsp;for&nbsp;a&nbsp;bit&nbsp;until&nbsp;a&nbsp;session&nbsp;is&nbsp;completely&nbsp;gone.&nbsp;Eg.&nbsp;Timed&nbsp;out&nbsp;and&nbsp;you&nbsp;can&nbsp;create&nbsp;files&nbsp;again...&lt;br&gt;&lt;br&gt;&lt;br&gt;--&lt;br&gt;Esben&lt;br&gt;(on&nbsp;mobile)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;id=&quot;htc_header&quot;&nbsp;style=&quot;&quot;&gt;-----&nbsp;Reply&nbsp;message&nbsp;-----&lt;br&gt;Fra:&nbsp;&quot;Alfred&nbsp;Hall&quot;&nbsp;&lt;ahall@ahall.org&gt;&lt;br&gt;Til:&nbsp;&quot;Andrés&nbsp;G.&nbsp;Aragoneses&quot;&nbsp;&lt;knocte@gmail.com&gt;,&nbsp;&lt;mono-devel-list@lists.ximian.com&gt;,&nbsp;&lt;mono-devel-list@lists.ximian.com&gt;&lt;br&gt;Emne:&nbsp;[Mono-dev]&nbsp;NancyFX&nbsp;self&nbsp;hosting&nbsp;(HttpListener)&nbsp;locking&nbsp;up&nbsp;on&nbsp;linux&lt;br&gt;Dato:&nbsp;søn.,&nbsp;aug.&nbsp;4,&nbsp;2013&nbsp;13:17&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;I&nbsp;meant&nbsp;to&nbsp;say&nbsp;I&nbsp;tried&nbsp;master&nbsp;too:&lt;/font&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;&lt;div&gt;root@mulder:~#&nbsp;/opt/ahall-mono/bin/mono&nbsp;-V&lt;/div&gt;&lt;div&gt;Mono&nbsp;JIT&nbsp;compiler&nbsp;version&nbsp;3.3.0&nbsp;(master/2354865&nbsp;Sun&nbsp;Aug&nbsp;&nbsp;4&nbsp;00:42:51&nbsp;BST&nbsp;2013)&lt;/div&gt;&lt;div&gt;Copyright&nbsp;(C)&nbsp;2002-2012&nbsp;Novell,&nbsp;Inc,&nbsp;Xamarin&nbsp;Inc&nbsp;and&nbsp;Contributors.&nbsp;www.mono-project.com&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;TLS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__thread&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;SIGSEGV:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;altstack&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Notifications:&nbsp;epoll&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&lt;/span&gt;Architecture:&nbsp;&nbsp;amd64&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Disabled:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;none&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Misc:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;softdebug&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;LLVM:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supported,&nbsp;not&nbsp;enabled.&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;GC:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgen&lt;/div&gt;&lt;/font&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;word-wrap:&nbsp;break-word;&quot;&gt;&lt;br&gt;That&nbsp;should&nbsp;have&nbsp;the&nbsp;fix&nbsp;in&nbsp;from&nbsp;https://github.com/ysw,&nbsp;but&nbsp;setting&nbsp;&lt;span&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;MONO_DISABLE_AIO&nbsp;should&nbsp;have&nbsp;worked&nbsp;around&nbsp;that&nbsp;anyway,&nbsp;as&nbsp;its&nbsp;meant&nbsp;to&nbsp;bypass&nbsp;the&nbsp;epoll&nbsp;backend.&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;word-wrap:&nbsp;break-word;&quot;&gt;My&nbsp;Nancy&nbsp;service&nbsp;is&nbsp;literally&nbsp;just&nbsp;returning&nbsp;a&nbsp;very&nbsp;simple&nbsp;JSON:&lt;/pre&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;word-wrap:&nbsp;break-word;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12px;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;HelloWorldModule&nbsp;:&nbsp;NancyModule<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;HelloWorldModule()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get[&quot;/&quot;]&nbsp;=&nbsp;parameters&nbsp;=&gt;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Response.AsJson(new&nbsp;HomeResponse&nbsp;{&nbsp;Message&nbsp;=&nbsp;&quot;Test&quot;&nbsp;});<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;/span&gt;&lt;/pre&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&quot;&gt;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre-wrap;&quot;&gt;In&nbsp;JMeter&nbsp;I'm&nbsp;using&nbsp;100&nbsp;threads&nbsp;and&nbsp;loop&nbsp;count&nbsp;of&nbsp;100&nbsp;and&nbsp;it&nbsp;locks&nbsp;up&nbsp;after&nbsp;like&nbsp;15&nbsp;seconds&nbsp;even&nbsp;over&nbsp;the&nbsp;network.&nbsp;Very&nbsp;odd.&lt;/span&gt;&lt;/div&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;word-wrap:&nbsp;break-word;&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;-----Original&nbsp;message-----&lt;br&gt;&gt;&nbsp;From:&amp;quot;Andrés&nbsp;G.&nbsp;Aragoneses&amp;quot;&nbsp;&lt;&lt;/font&gt;&lt;a&nbsp;href=&quot;mailto:knocte@gmail.com&quot;&nbsp;onclick=&quot;parent.webclient.openWindow(this,&nbsp;'createmail',&nbsp;'index.php?load=dialog&amp;task=createmail_standard&amp;to=knocte@gmail.com');&nbsp;return&nbsp;false;&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&nbsp;target=&quot;_blank&quot;&nbsp;title=&quot;This&nbsp;external&nbsp;link&nbsp;will&nbsp;open&nbsp;in&nbsp;a&nbsp;new&nbsp;window&quot;&gt;knocte@gmail.com&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&gt;&lt;br&gt;&gt;&nbsp;Sent:&nbsp;Sunday&nbsp;4th&nbsp;August&nbsp;2013&nbsp;10:03&lt;br&gt;&gt;&nbsp;To:&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;mailto:mono-devel-list@lists.ximian.com&quot;&nbsp;onclick=&quot;parent.webclient.openWindow(this,&nbsp;'createmail',&nbsp;'index.php?load=dialog&amp;task=createmail_standard&amp;to=mono-devel-list@lists.ximian.com');&nbsp;return&nbsp;false;&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&nbsp;target=&quot;_blank&quot;&nbsp;title=&quot;This&nbsp;external&nbsp;link&nbsp;will&nbsp;open&nbsp;in&nbsp;a&nbsp;new&nbsp;window&quot;&gt;mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;NancyFX&nbsp;self&nbsp;hosting&nbsp;(HttpListener)&nbsp;locking&nbsp;up&nbsp;on&nbsp;linux&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;On&nbsp;04/08/13&nbsp;03:07,&nbsp;Alfred&nbsp;Hall&nbsp;wrote:&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Hi&nbsp;there.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I'm&nbsp;running&nbsp;the&nbsp;NancyFX&nbsp;web&nbsp;framework&nbsp;in&nbsp;self&nbsp;hosting&nbsp;mode&nbsp;which&nbsp;is&lt;br&gt;&gt;&nbsp;&gt;&nbsp;using&nbsp;HttpListener&nbsp;which&nbsp;basically&nbsp;means&nbsp;I&nbsp;deploy&nbsp;an&nbsp;executable&nbsp;and&nbsp;run&lt;br&gt;&gt;&nbsp;&gt;&nbsp;it&nbsp;and&nbsp;it&nbsp;will&nbsp;start&nbsp;a&nbsp;webserver&nbsp;on&nbsp;localhost&nbsp;on&nbsp;a&nbsp;TCP&nbsp;port&nbsp;of&nbsp;choice.&nbsp;I&lt;br&gt;&gt;&nbsp;&gt;&nbsp;then&nbsp;use&nbsp;nginx&nbsp;to&nbsp;proxy&nbsp;to&nbsp;it.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;first&nbsp;ran&nbsp;my&nbsp;executable&nbsp;on&nbsp;my&nbsp;macbook&nbsp;pro&nbsp;and&nbsp;bombarded&nbsp;it&nbsp;with&nbsp;jmeter&lt;br&gt;&gt;&nbsp;&gt;&nbsp;and&nbsp;it&nbsp;coped&nbsp;fine&nbsp;and&nbsp;no&nbsp;issues.&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;then&nbsp;deployed&nbsp;on&nbsp;my&nbsp;debian&nbsp;wheezy&nbsp;64&nbsp;bit&nbsp;linux&nbsp;box&nbsp;running&nbsp;on&nbsp;top&nbsp;of&lt;br&gt;&gt;&nbsp;&gt;&nbsp;KVM&nbsp;using&nbsp;mono&nbsp;3.2.0&nbsp;and&nbsp;performed&nbsp;the&nbsp;same&nbsp;jmeter&nbsp;experiment.&nbsp;It&nbsp;locks&lt;br&gt;&gt;&nbsp;&gt;&nbsp;up&nbsp;fairly&nbsp;quickly&nbsp;and&nbsp;wont&nbsp;take&nbsp;any&nbsp;new&nbsp;requests.&nbsp;I've&nbsp;tried&nbsp;using&nbsp;both&lt;br&gt;&gt;&nbsp;&gt;&nbsp;sgen&nbsp;and&nbsp;boehm&nbsp;but&nbsp;they&nbsp;behave&nbsp;similarly&nbsp;although&nbsp;it&nbsp;seems&nbsp;to&nbsp;lock&nbsp;up&lt;br&gt;&gt;&nbsp;&gt;&nbsp;faster&nbsp;when&nbsp;using&nbsp;sgen.&nbsp;I&nbsp;also&nbsp;tried&nbsp;enabling&nbsp;MONO_DISABLE_AIO&nbsp;but&nbsp;it&lt;br&gt;&gt;&nbsp;&gt;&nbsp;doesn't&nbsp;make&nbsp;any&nbsp;difference.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Anyone&nbsp;had&nbsp;similar&nbsp;issues?&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;tried&nbsp;using&nbsp;self&nbsp;hosted&nbsp;ServiceStack&nbsp;which&nbsp;also&nbsp;uses&nbsp;HttpListener&nbsp;and&lt;br&gt;&gt;&nbsp;&gt;&nbsp;had&nbsp;similar&nbsp;issues&nbsp;so&nbsp;I'm&nbsp;finding&nbsp;it&nbsp;unlikely&nbsp;that&nbsp;the&nbsp;bug&nbsp;is&nbsp;in&nbsp;NancyFX&lt;br&gt;&gt;&nbsp;&gt;&nbsp;itself.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;tried&nbsp;installing&nbsp;mono&nbsp;2.10.8&nbsp;to&nbsp;check&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;regression,&nbsp;but&lt;br&gt;&gt;&nbsp;&gt;&nbsp;getting&nbsp;exactly&nbsp;the&nbsp;same&nbsp;results.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Any&nbsp;idea&nbsp;how&nbsp;I&nbsp;can&nbsp;debug&nbsp;this&nbsp;further&nbsp;or&nbsp;what&nbsp;could&nbsp;be&nbsp;going&nbsp;on.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Hey&nbsp;Alfred.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Could&nbsp;you&nbsp;try&nbsp;mono&nbsp;master&nbsp;(3.3)&nbsp;instead&nbsp;of&nbsp;3.2?&nbsp;I&nbsp;mention&nbsp;this&nbsp;because&nbsp;&lt;br&gt;&gt;&nbsp;this&nbsp;pull&nbsp;request&nbsp;[1]&nbsp;has&nbsp;been&nbsp;merged&nbsp;recently,&nbsp;which&nbsp;could&nbsp;help&nbsp;in&nbsp;this&nbsp;&lt;br&gt;&gt;&nbsp;situation&nbsp;(and&nbsp;wouldn't&nbsp;make&nbsp;much&nbsp;difference&nbsp;in&nbsp;Mac&nbsp;since&nbsp;the&nbsp;problem&nbsp;in&nbsp;&lt;br&gt;&gt;&nbsp;this&nbsp;platform&nbsp;is&nbsp;worked-around&nbsp;by&nbsp;avoiding&nbsp;kqueue&nbsp;[2]).&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;[1]&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;https://github.com/mono/mono/pull/703&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&nbsp;target=&quot;_blank&quot;&nbsp;title=&quot;This&nbsp;external&nbsp;link&nbsp;will&nbsp;open&nbsp;in&nbsp;a&nbsp;new&nbsp;window&quot;&gt;https://github.com/mono/mono/pull/703&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;[2]&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;https://github.com/mono/mono/blob/master/configure.in#L1823&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&nbsp;target=&quot;_blank&quot;&nbsp;title=&quot;This&nbsp;external&nbsp;link&nbsp;will&nbsp;open&nbsp;in&nbsp;a&nbsp;new&nbsp;window&quot;&gt;https://github.com/mono/mono/blob/master/configure.in#L1823&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;_______________________________________________&lt;br&gt;&gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&gt;&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&nbsp;onclick=&quot;parent.webclient.openWindow(this,&nbsp;'createmail',&nbsp;'index.php?load=dialog&amp;task=createmail_standard&amp;to=Mono-devel-list@lists.ximian.com');&nbsp;return&nbsp;false;&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&nbsp;target=&quot;_blank&quot;&nbsp;title=&quot;This&nbsp;external&nbsp;link&nbsp;will&nbsp;open&nbsp;in&nbsp;a&nbsp;new&nbsp;window&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&nbsp;target=&quot;_blank&quot;&nbsp;title=&quot;This&nbsp;external&nbsp;link&nbsp;will&nbsp;open&nbsp;in&nbsp;a&nbsp;new&nbsp;window&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&lt;/font&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;!--&nbsp;end&nbsp;sanitized&nbsp;html&nbsp;--&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
