<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&nbsp;&quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Zarafa&nbsp;WebApp&nbsp;v7.1.5-41923&quot;&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;title&gt;RE:&nbsp;[Mono-dev]&nbsp;NancyFX&nbsp;self&nbsp;hosting&nbsp;(HttpListener)&nbsp;locking&nbsp;up&nbsp;on&nbsp;linux&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;I&nbsp;meant&nbsp;to&nbsp;say&nbsp;I&nbsp;tried&nbsp;master&nbsp;too:&lt;/font&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;&lt;div&gt;root@mulder:~#&nbsp;/opt/ahall-mono/bin/mono&nbsp;-V&lt;/div&gt;&lt;div&gt;Mono&nbsp;JIT&nbsp;compiler&nbsp;version&nbsp;3.3.0&nbsp;(master/2354865&nbsp;Sun&nbsp;Aug&nbsp;&nbsp;4&nbsp;00:42:51&nbsp;BST&nbsp;2013)&lt;/div&gt;&lt;div&gt;Copyright&nbsp;(C)&nbsp;2002-2012&nbsp;Novell,&nbsp;Inc,&nbsp;Xamarin&nbsp;Inc&nbsp;and&nbsp;Contributors.&nbsp;www.mono-project.com&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;TLS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__thread&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;SIGSEGV:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;altstack&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Notifications:&nbsp;epoll&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&lt;/span&gt;Architecture:&nbsp;&nbsp;amd64&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Disabled:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;none&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Misc:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;softdebug&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;LLVM:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supported,&nbsp;not&nbsp;enabled.&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;GC:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgen&lt;/div&gt;&lt;/font&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;word-wrap:&nbsp;break-word;&quot;&gt;&lt;br&gt;That&nbsp;should&nbsp;have&nbsp;the&nbsp;fix&nbsp;in&nbsp;from&nbsp;https://github.com/ysw,&nbsp;but&nbsp;setting&nbsp;&lt;span&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;MONO_DISABLE_AIO&nbsp;should&nbsp;have&nbsp;worked&nbsp;around&nbsp;that&nbsp;anyway,&nbsp;as&nbsp;its&nbsp;meant&nbsp;to&nbsp;bypass&nbsp;the&nbsp;epoll&nbsp;backend.&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;word-wrap:&nbsp;break-word;&quot;&gt;My&nbsp;Nancy&nbsp;service&nbsp;is&nbsp;literally&nbsp;just&nbsp;returning&nbsp;a&nbsp;very&nbsp;simple&nbsp;JSON:&lt;/pre&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;word-wrap:&nbsp;break-word;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12px;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;HelloWorldModule&nbsp;:&nbsp;NancyModule<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;HelloWorldModule()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get[&quot;/&quot;]&nbsp;=&nbsp;parameters&nbsp;=&gt;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Response.AsJson(new&nbsp;HomeResponse&nbsp;{&nbsp;Message&nbsp;=&nbsp;&quot;Test&quot;&nbsp;});<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;/span&gt;&lt;/pre&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&quot;&gt;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre-wrap;&quot;&gt;In&nbsp;JMeter&nbsp;I'm&nbsp;using&nbsp;100&nbsp;threads&nbsp;and&nbsp;loop&nbsp;count&nbsp;of&nbsp;100&nbsp;and&nbsp;it&nbsp;locks&nbsp;up&nbsp;after&nbsp;like&nbsp;15&nbsp;seconds&nbsp;even&nbsp;over&nbsp;the&nbsp;network.&nbsp;Very&nbsp;odd.&lt;/span&gt;&lt;/div&gt;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;word-wrap:&nbsp;break-word;&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;-----Original&nbsp;message-----&lt;br&gt;&gt;&nbsp;From:&amp;quot;Andr√©s&nbsp;G.&nbsp;Aragoneses&amp;quot;&nbsp;&lt;&lt;/font&gt;&lt;a&nbsp;href=&quot;mailto:knocte@gmail.com&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;knocte@gmail.com&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&gt;&lt;br&gt;&gt;&nbsp;Sent:&nbsp;Sunday&nbsp;4th&nbsp;August&nbsp;2013&nbsp;10:03&lt;br&gt;&gt;&nbsp;To:&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;mailto:mono-devel-list@lists.ximian.com&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;NancyFX&nbsp;self&nbsp;hosting&nbsp;(HttpListener)&nbsp;locking&nbsp;up&nbsp;on&nbsp;linux&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;On&nbsp;04/08/13&nbsp;03:07,&nbsp;Alfred&nbsp;Hall&nbsp;wrote:&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Hi&nbsp;there.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I'm&nbsp;running&nbsp;the&nbsp;NancyFX&nbsp;web&nbsp;framework&nbsp;in&nbsp;self&nbsp;hosting&nbsp;mode&nbsp;which&nbsp;is&lt;br&gt;&gt;&nbsp;&gt;&nbsp;using&nbsp;HttpListener&nbsp;which&nbsp;basically&nbsp;means&nbsp;I&nbsp;deploy&nbsp;an&nbsp;executable&nbsp;and&nbsp;run&lt;br&gt;&gt;&nbsp;&gt;&nbsp;it&nbsp;and&nbsp;it&nbsp;will&nbsp;start&nbsp;a&nbsp;webserver&nbsp;on&nbsp;localhost&nbsp;on&nbsp;a&nbsp;TCP&nbsp;port&nbsp;of&nbsp;choice.&nbsp;I&lt;br&gt;&gt;&nbsp;&gt;&nbsp;then&nbsp;use&nbsp;nginx&nbsp;to&nbsp;proxy&nbsp;to&nbsp;it.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;first&nbsp;ran&nbsp;my&nbsp;executable&nbsp;on&nbsp;my&nbsp;macbook&nbsp;pro&nbsp;and&nbsp;bombarded&nbsp;it&nbsp;with&nbsp;jmeter&lt;br&gt;&gt;&nbsp;&gt;&nbsp;and&nbsp;it&nbsp;coped&nbsp;fine&nbsp;and&nbsp;no&nbsp;issues.&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;then&nbsp;deployed&nbsp;on&nbsp;my&nbsp;debian&nbsp;wheezy&nbsp;64&nbsp;bit&nbsp;linux&nbsp;box&nbsp;running&nbsp;on&nbsp;top&nbsp;of&lt;br&gt;&gt;&nbsp;&gt;&nbsp;KVM&nbsp;using&nbsp;mono&nbsp;3.2.0&nbsp;and&nbsp;performed&nbsp;the&nbsp;same&nbsp;jmeter&nbsp;experiment.&nbsp;It&nbsp;locks&lt;br&gt;&gt;&nbsp;&gt;&nbsp;up&nbsp;fairly&nbsp;quickly&nbsp;and&nbsp;wont&nbsp;take&nbsp;any&nbsp;new&nbsp;requests.&nbsp;I've&nbsp;tried&nbsp;using&nbsp;both&lt;br&gt;&gt;&nbsp;&gt;&nbsp;sgen&nbsp;and&nbsp;boehm&nbsp;but&nbsp;they&nbsp;behave&nbsp;similarly&nbsp;although&nbsp;it&nbsp;seems&nbsp;to&nbsp;lock&nbsp;up&lt;br&gt;&gt;&nbsp;&gt;&nbsp;faster&nbsp;when&nbsp;using&nbsp;sgen.&nbsp;I&nbsp;also&nbsp;tried&nbsp;enabling&nbsp;MONO_DISABLE_AIO&nbsp;but&nbsp;it&lt;br&gt;&gt;&nbsp;&gt;&nbsp;doesn't&nbsp;make&nbsp;any&nbsp;difference.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Anyone&nbsp;had&nbsp;similar&nbsp;issues?&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;tried&nbsp;using&nbsp;self&nbsp;hosted&nbsp;ServiceStack&nbsp;which&nbsp;also&nbsp;uses&nbsp;HttpListener&nbsp;and&lt;br&gt;&gt;&nbsp;&gt;&nbsp;had&nbsp;similar&nbsp;issues&nbsp;so&nbsp;I'm&nbsp;finding&nbsp;it&nbsp;unlikely&nbsp;that&nbsp;the&nbsp;bug&nbsp;is&nbsp;in&nbsp;NancyFX&lt;br&gt;&gt;&nbsp;&gt;&nbsp;itself.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;tried&nbsp;installing&nbsp;mono&nbsp;2.10.8&nbsp;to&nbsp;check&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;regression,&nbsp;but&lt;br&gt;&gt;&nbsp;&gt;&nbsp;getting&nbsp;exactly&nbsp;the&nbsp;same&nbsp;results.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Any&nbsp;idea&nbsp;how&nbsp;I&nbsp;can&nbsp;debug&nbsp;this&nbsp;further&nbsp;or&nbsp;what&nbsp;could&nbsp;be&nbsp;going&nbsp;on.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Hey&nbsp;Alfred.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Could&nbsp;you&nbsp;try&nbsp;mono&nbsp;master&nbsp;(3.3)&nbsp;instead&nbsp;of&nbsp;3.2?&nbsp;I&nbsp;mention&nbsp;this&nbsp;because&nbsp;&lt;br&gt;&gt;&nbsp;this&nbsp;pull&nbsp;request&nbsp;[1]&nbsp;has&nbsp;been&nbsp;merged&nbsp;recently,&nbsp;which&nbsp;could&nbsp;help&nbsp;in&nbsp;this&nbsp;&lt;br&gt;&gt;&nbsp;situation&nbsp;(and&nbsp;wouldn't&nbsp;make&nbsp;much&nbsp;difference&nbsp;in&nbsp;Mac&nbsp;since&nbsp;the&nbsp;problem&nbsp;in&nbsp;&lt;br&gt;&gt;&nbsp;this&nbsp;platform&nbsp;is&nbsp;worked-around&nbsp;by&nbsp;avoiding&nbsp;kqueue&nbsp;[2]).&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;[1]&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;https://github.com/mono/mono/pull/703&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;https://github.com/mono/mono/pull/703&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;[2]&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;https://github.com/mono/mono/blob/master/configure.in#L1823&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;https://github.com/mono/mono/blob/master/configure.in#L1823&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;_______________________________________________&lt;br&gt;&gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&gt;&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&lt;/font&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
