<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Hello,&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;fact,&nbsp;I'm&nbsp;working&nbsp;on&nbsp;a&nbsp;gcc&nbsp;backend&nbsp;which&nbsp;generates&nbsp;CIL&nbsp;code&nbsp;(from<br>
C):&nbsp;&lt;a&nbsp;href=&quot;http://gcc.gnu.org/projects/cli.html&quot;&gt;gcc4cli&lt;/a&gt;.&nbsp;We&nbsp;use<br>
the&nbsp;cbenchmark&nbsp;suite&nbsp;to&nbsp;evaluate&nbsp;the&nbsp;performance&nbsp;of&nbsp;our&nbsp;backend,&nbsp;and&nbsp;in<br>
this&nbsp;suite&nbsp;there&nbsp;is&nbsp;C&nbsp;code&nbsp;which&nbsp;is&nbsp;not&nbsp;really&nbsp;clean;&nbsp;one&nbsp;of&nbsp;the&nbsp;benchs<br>
declares&nbsp;a&nbsp;big&nbsp;table&nbsp;in&nbsp;a&nbsp;local&nbsp;variable&nbsp;which&nbsp;we&nbsp;translate&nbsp;into&nbsp;CIL<br>
stack&nbsp;data.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;Thierry&nbsp;Lafage.<br>
&lt;/pre&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Miguel&nbsp;de&nbsp;Icaza&nbsp;a&nbsp;&amp;eacute;crit&amp;nbsp;:<br>
&lt;blockquote&nbsp;cite=&quot;mid:1262799127.4513.2151.camel@erandi.site&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hello,<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;am&nbsp;curious,&nbsp;why&nbsp;does&nbsp;the&nbsp;Main&nbsp;method&nbsp;need&nbsp;1&nbsp;megabyte&nbsp;of&nbsp;IL&nbsp;stack?<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Thanks&nbsp;for&nbsp;your&nbsp;answer.<br>
I'll&nbsp;try&nbsp;one&nbsp;of&nbsp;your&nbsp;solutions.<br>
<br>
IMHO,&nbsp;a&nbsp;nice&nbsp;long&nbsp;term&nbsp;fix&nbsp;for&nbsp;it&nbsp;would&nbsp;be&nbsp;to&nbsp;provide&nbsp;a&nbsp;command-line&nbsp;<br>
option&nbsp;to&nbsp;set&nbsp;a&nbsp;max&nbsp;value&nbsp;different&nbsp;from&nbsp;the&nbsp;default's,&nbsp;as&nbsp;for&nbsp;java&nbsp;and&nbsp;<br>
heap&nbsp;size&nbsp;(-Xmx).&nbsp;This&nbsp;way,&nbsp;one&nbsp;could&nbsp;fine&nbsp;tune&nbsp;according&nbsp;to&nbsp;the&nbsp;running&nbsp;<br>
application.<br>
<br>
Regards,<br>
<br>
Thierry&nbsp;Lafage.<br>
<br>
<br>
<br>
Rodrigo&nbsp;Kumpera&nbsp;a&nbsp;&amp;eacute;crit&nbsp;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;This&nbsp;was&nbsp;a&nbsp;stop-gap&nbsp;hack&nbsp;I&nbsp;added&nbsp;to&nbsp;fix&nbsp;a&nbsp;security&nbsp;issue.<br>
<br>
The&nbsp;value&nbsp;is&nbsp;hardcoded&nbsp;into&nbsp;mono's&nbsp;source&nbsp;and&nbsp;until&nbsp;we&nbsp;figure&nbsp;out&nbsp;a&nbsp;long<br>
term&nbsp;fix&nbsp;for&nbsp;it,&nbsp;the&nbsp;only&nbsp;solution&nbsp;is&nbsp;to&nbsp;custom&nbsp;compile&nbsp;mono.<br>
<br>
I&nbsp;have&nbsp;a&nbsp;patch&nbsp;that&nbsp;improves&nbsp;the&nbsp;JIT&nbsp;to&nbsp;use&nbsp;smaller&nbsp;stacks,&nbsp;but&nbsp;it's&nbsp;<br>
against&nbsp;trunk<br>
and&nbsp;remains&nbsp;experimental.<br>
<br>
Besides&nbsp;that,&nbsp;we&nbsp;need&nbsp;to&nbsp;fix&nbsp;all&nbsp;unbounded&nbsp;code&nbsp;expansion&nbsp;to&nbsp;really&nbsp;<br>
support&nbsp;big<br>
stack.&nbsp;Work&nbsp;on&nbsp;this&nbsp;have&nbsp;not&nbsp;been&nbsp;started.<br>
<br>
Right&nbsp;now,&nbsp;the&nbsp;only&nbsp;remedy&nbsp;for&nbsp;you&nbsp;is&nbsp;to&nbsp;custom&nbsp;build&nbsp;mono&nbsp;after&nbsp;<br>
either&nbsp;removing<br>
the&nbsp;stack&nbsp;check[1]&nbsp;or&nbsp;increase&nbsp;it[2].&nbsp;Be&nbsp;aware&nbsp;that&nbsp;such&nbsp;changes&nbsp;do&nbsp;<br>
have&nbsp;security<br>
implications.<br>
<br>
Sorry&nbsp;for&nbsp;this,<br>
Rodrigo&nbsp;Kumpera<br>
<br>
[1]To&nbsp;remove&nbsp;it,&nbsp;edit&nbsp;mini-x86.c&nbsp;or&nbsp;mini-amd64.c.&nbsp;Search&nbsp;<br>
for&nbsp;MONO_ARCH_MAX_FRAME_SIZE<br>
and&nbsp;remove&nbsp;the&nbsp;if&nbsp;that&nbsp;uses&nbsp;it.<br>
<br>
[2]To&nbsp;increase&nbsp;it,&nbsp;change&nbsp;the&nbsp;define&nbsp;MONO_ARCH_MAX_FRAME_SIZE&nbsp;in&nbsp;either<br>
mini-x86.h&nbsp;or&nbsp;mini-amd64.h&nbsp;depending&nbsp;if&nbsp;you're&nbsp;building&nbsp;a&nbsp;32&nbsp;or&nbsp;64&nbsp;<br>
bits&nbsp;mono.<br>
<br>
&nbsp;<br>
<br>
<br>
<br>
On&nbsp;Wed,&nbsp;Jan&nbsp;6,&nbsp;2010&nbsp;at&nbsp;9:02&nbsp;AM,&nbsp;Thierry&nbsp;Lafage&nbsp;<br>
&amp;lt;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:thierry.lafage@inria.fr&quot;&gt;thierry.lafage@inria.fr&lt;/a&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:thierry.lafage@inria.fr&quot;&gt;&amp;lt;mailto:thierry.lafage@inria.fr&amp;gt;&lt;/a&gt;&amp;gt;&nbsp;wrote:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi&nbsp;all,<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;have&nbsp;a&nbsp;problem&nbsp;with&nbsp;a&nbsp;code&nbsp;running&nbsp;with&nbsp;mono-2.6.1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;says&nbsp;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unhandled&nbsp;Exception:&nbsp;System.InvalidProgramException:&nbsp;Method&nbsp;toto:main<br>
&nbsp;&nbsp;&nbsp;&nbsp;()&nbsp;stack&nbsp;is&nbsp;too&nbsp;big.&quot;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;problem&nbsp;does&nbsp;not&nbsp;appear&nbsp;with&nbsp;mono-2.4.3<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;stack&nbsp;length&nbsp;is&nbsp;more&nbsp;than&nbsp;1MB&nbsp;(it's&nbsp;ok&nbsp;with&nbsp;less<br>
&nbsp;&nbsp;&nbsp;&nbsp;than<br>
&nbsp;&nbsp;&nbsp;&nbsp;1MB).<br>
&nbsp;&nbsp;&nbsp;&nbsp;My&nbsp;question&nbsp;is:&nbsp;is&nbsp;it&nbsp;possible&nbsp;to&nbsp;force&nbsp;mono-2.6.1&nbsp;to&nbsp;accept&nbsp;stacks<br>
&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;are&nbsp;more&nbsp;than&nbsp;1MB&nbsp;(I've&nbsp;found&nbsp;no&nbsp;related&nbsp;command&nbsp;line&nbsp;option)?<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Regards,<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thierry&nbsp;Lafage.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;_______________________________________________<br>
&nbsp;&nbsp;&nbsp;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;&amp;lt;mailto:Mono-devel-list@lists.ximian.com&amp;gt;&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
