using Microsoft.Win32;
using System;

public class RegBug
{
  public static void Main(String[] args) 
  {
    string subkey = @"Software\nunit.org\Nunit\2.4";
    using(RegistryKey key = Registry.LocalMachine.CreateSubKey(subkey))
    using(RegistryKey fooKey = key.CreateSubKey("foo"))
    {
    	Console.WriteLine("Setting Values");
	key.SetValue("X", 5);
	fooKey.SetValue("Y", 6);

	Console.WriteLine("Clearing Names");
	foreach(string name in key.GetValueNames())
	  key.DeleteValue(name);

	Console.WriteLine("Clearing Subkeys");
	foreach(string name in key.GetSubKeyNames())
	  key.DeleteSubKeyTree(name);
    }

    Console.WriteLine("All Clear");
    
  }
}
