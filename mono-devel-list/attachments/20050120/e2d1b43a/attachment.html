<tt>
&lt;P&gt;<br>
Thanks&nbsp;for&nbsp;the&nbsp;response.&lt;BR&gt;<br>
&lt;BR&gt;<br>
For&nbsp;example,&nbsp;if&nbsp;i&nbsp;want&nbsp;to&nbsp;set&nbsp;a&nbsp;breakpoint&nbsp;at&nbsp;ILOffset&nbsp;5&nbsp;for&nbsp;a&nbsp;managed&nbsp;method,&nbsp;is&nbsp;the&nbsp;following&nbsp;true?&lt;BR&gt;<br>
Step1.&nbsp;I&nbsp;find&nbsp;the&nbsp;memory&nbsp;address&nbsp;corresponding&nbsp;to&nbsp;an&nbsp;ILOffset&nbsp;6&nbsp;for&nbsp;the&nbsp;managed&nbsp;method.&nbsp;I&nbsp;do&nbsp;this&nbsp;in&nbsp;mono_arch_output_basic_block.&nbsp;Let's&nbsp;assume&nbsp;no&nbsp;JIT&nbsp;optimizations.&lt;BR&gt;<br>
Step2.&nbsp;I&nbsp;write&nbsp;a&nbsp;software&nbsp;breakpoint&nbsp;opcode&nbsp;at&nbsp;the&nbsp;memory&nbsp;address&nbsp;that&nbsp;i&nbsp;found&nbsp;in&nbsp;Step&nbsp;1.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Can&nbsp;a&nbsp;software&nbsp;breakpoint&nbsp;be&nbsp;written&nbsp;to&nbsp;replace&nbsp;any&nbsp;opcode?&nbsp;or&nbsp;are&nbsp;there&nbsp;rules&nbsp;on&nbsp;where&nbsp;software&nbsp;breakpoints&nbsp;are&nbsp;allowed?&nbsp;&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;tried&nbsp;the&nbsp;following&nbsp;on&nbsp;a&nbsp;simple&nbsp;C#&nbsp;HelloWorld&nbsp;application&nbsp;with&nbsp;just&nbsp;two&nbsp;lines&nbsp;of&nbsp;code&lt;BR&gt;<br>
Console.WriteLine&nbsp;(&amp;quot;Hello&nbsp;World&nbsp;1&amp;quot;);&lt;BR&gt;<br>
Console.WriteLine&nbsp;(&amp;quot;Hello&nbsp;World&nbsp;2&amp;quot;);&lt;BR&gt;<br>
1.&nbsp;Remember/Store&nbsp;the&nbsp;memory&nbsp;address&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;ILOffset&nbsp;of&nbsp;the&nbsp;sourceline&nbsp;that&nbsp;has&nbsp;the&nbsp;&amp;quot;WriteLine&amp;quot;&nbsp;call.&nbsp;Did&nbsp;this&nbsp;in&nbsp;mono_arch_output_basic_block&lt;BR&gt;<br>
2.&nbsp;After&nbsp;the&nbsp;method&nbsp;&amp;quot;main&amp;quot;&nbsp;has&nbsp;been&nbsp;JITted&nbsp;replace&nbsp;the&nbsp;value&nbsp;at&nbsp;memory&nbsp;address&nbsp;in&nbsp;step&nbsp;1&nbsp;with&nbsp;a&nbsp;0xCC.&nbsp;(E8&nbsp;is&nbsp;the&nbsp;original&nbsp;opcode&nbsp;at&nbsp;this&nbsp;address)&lt;BR&gt;<br>
3.&nbsp;Allow&nbsp;the&nbsp;method&nbsp;to&nbsp;run&lt;BR&gt;<br>
4.&nbsp;Method&nbsp;hits&nbsp;the&nbsp;software&nbsp;breakpoint&nbsp;and&nbsp;generates&nbsp;a&nbsp;breakpoint&nbsp;exception&lt;BR&gt;<br>
5.&nbsp;An&nbsp;UnhandledExceptionFilter&nbsp;that&nbsp;is&nbsp;registered&amp;nbsp;&nbsp;gets&nbsp;called&nbsp;(I'm&nbsp;on&nbsp;windows)&lt;BR&gt;<br>
6.&nbsp;In&nbsp;this&nbsp;filter&nbsp;function&nbsp;replace&nbsp;the&nbsp;0xCC&nbsp;with&nbsp;the&nbsp;original&nbsp;instruction&nbsp;which&nbsp;is&nbsp;E8.&lt;BR&gt;<br>
7.&nbsp;Resume&nbsp;execution&nbsp;of&nbsp;main&lt;BR&gt;<br>
&lt;BR&gt;<br>
The&nbsp;result&nbsp;is&nbsp;that&nbsp;the&nbsp;string&nbsp;&amp;quot;Hello&nbsp;World&nbsp;1&amp;quot;&nbsp;gets&nbsp;printed&nbsp;but&nbsp;the&nbsp;second&nbsp;string&nbsp;&amp;quot;Hello&nbsp;World&nbsp;2&amp;quot;&nbsp;does&nbsp;not&nbsp;get&nbsp;printed&nbsp;and&nbsp;application&nbsp;just&nbsp;finishes&nbsp;execution&nbsp;withut&nbsp;any&nbsp;obvious&nbsp;indications&nbsp;of&nbsp;a&nbsp;crash.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Then&nbsp;i&nbsp;tried&nbsp;the&nbsp;following&lt;BR&gt;<br>
1.&nbsp;Forced&nbsp;a&nbsp;software&nbsp;breakpoint&nbsp;to&nbsp;be&nbsp;inserted&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;managed&nbsp;method&nbsp;&amp;quot;main&amp;quot;.&nbsp;Did&nbsp;this&nbsp;in&nbsp;&amp;quot;mono_method_to_ir&amp;quot;&nbsp;using&nbsp;the&nbsp;CEE_BREAK&nbsp;code&nbsp;that&nbsp;is&nbsp;already&nbsp;in&nbsp;there.&lt;BR&gt;<br>
2.Now&nbsp;when&nbsp;main&nbsp;executes&nbsp;&amp;amp;&nbsp;the&nbsp;breakpoint&nbsp;is&nbsp;hit,&nbsp;control&nbsp;reaches&nbsp;the&nbsp;unhandledexceptionfilter&nbsp;function&nbsp;where&nbsp;i&nbsp;just&nbsp;do&nbsp;a&nbsp;Eip++.&nbsp;&lt;BR&gt;<br>
3.Resume&nbsp;execution&nbsp;of&nbsp;main&lt;BR&gt;<br>
&lt;BR&gt;<br>
The&nbsp;result&nbsp;is&nbsp;that&nbsp;the&nbsp;strings&nbsp;&amp;quot;Hello&nbsp;World&nbsp;1&amp;quot;&nbsp;&amp;amp;&nbsp;&amp;quot;Hello&nbsp;World&nbsp;2&amp;quot;&nbsp;get&nbsp;printed.&lt;BR&gt;<br>
&lt;BR&gt;<br>
That&nbsp;leads&nbsp;me&nbsp;to&nbsp;believe&nbsp;that&nbsp;a&nbsp;breakpoint&nbsp;opcode&nbsp;should&nbsp;not&nbsp;be&nbsp;placed&nbsp;at&nbsp;certain&nbsp;places&nbsp;in&nbsp;emitted&nbsp;code.&nbsp;Is&nbsp;that&nbsp;right?&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thanks!&nbsp;Sorry&nbsp;about&nbsp;the&nbsp;long&nbsp;email.&lt;BR&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;/P&gt;<br>
&lt;br&gt;&lt;br&gt;<br>
&lt;A&nbsp;target=&quot;_blank&quot;&nbsp;HREF=&quot;http://clients.rediff.com/signature/track_sig.asp&quot;&gt;&lt;IMG&nbsp;SRC=&quot;http://ads.rediff.com/RealMedia/ads/adstream_nx.cgi/www.rediffmail.com/inbox.htm@Bottom&quot;&nbsp;BORDER=0&nbsp;VSPACE=0&nbsp;HSPACE=0&gt;&lt;/a&gt;<br>

</tt>
