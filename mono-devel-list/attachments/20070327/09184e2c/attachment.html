<tt>
I&nbsp;applied&nbsp;the&nbsp;optimisation&nbsp;from&nbsp;Michael,&nbsp;and&nbsp;the&nbsp;speed&nbsp;increase&nbsp;is&nbsp;quite&nbsp;substantial.&nbsp;The&nbsp;original&nbsp;code&nbsp;running&nbsp;with&nbsp;a&nbsp;9,000&nbsp;element&nbsp;array&nbsp;took&nbsp;about&nbsp;030&nbsp;ms&nbsp;to&nbsp;process.&nbsp;The&nbsp;new&nbsp;code&nbsp;with&nbsp;a&nbsp;900,000&nbsp;element&nbsp;array&nbsp;takes&nbsp;210ms.<br>
&lt;br&gt;&lt;br&gt;Attached&nbsp;is&nbsp;a&nbsp;new&nbsp;patch&nbsp;containing&nbsp;those&nbsp;changes.&lt;br&gt;&lt;br&gt;All&nbsp;comments&nbsp;welcome&nbsp;on&nbsp;the&nbsp;new&nbsp;implementation,&nbsp;or&nbsp;if&nbsp;anyone&nbsp;has&nbsp;some&nbsp;equally&nbsp;good&nbsp;ideas&nbsp;on&nbsp;how&nbsp;to&nbsp;optimise&nbsp;the&nbsp;other&nbsp;methods&nbsp;further,&nbsp;that&amp;#39;d&nbsp;be&nbsp;great.&lt;br&gt;<br>
&lt;br&gt;Alan.&lt;br&gt;<br>

</tt>
