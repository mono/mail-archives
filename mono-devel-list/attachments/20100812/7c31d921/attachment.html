<tt>
I&nbsp;am&nbsp;currently&nbsp;porting&nbsp;an&nbsp;application&nbsp;to&nbsp;Mono&nbsp;that&nbsp;requires&nbsp;Active&nbsp;Directory&nbsp;integration,&nbsp;but&nbsp;can&amp;#39;t&nbsp;seem&nbsp;to&nbsp;get&nbsp;the&nbsp;same&nbsp;code&nbsp;base&nbsp;to&nbsp;run&nbsp;under&nbsp;.NET&nbsp;3.5&nbsp;and&nbsp;Mono.&nbsp;I&nbsp;am&nbsp;using&nbsp;Mono&nbsp;2.6.4,&nbsp;but&nbsp;I&amp;#39;ve&nbsp;also&nbsp;tried&nbsp;a&nbsp;build&nbsp;of&nbsp;2.6.7.&nbsp;For&nbsp;example,&nbsp;if&nbsp;I&nbsp;want&nbsp;to&nbsp;fetch&nbsp;the&nbsp;defaultNamingContext,&nbsp;I&nbsp;can&nbsp;do&nbsp;it&nbsp;in&nbsp;.NET&nbsp;with:&lt;br&gt;<br>
&lt;br&gt; using&nbsp;(DirectoryEntry&nbsp;de&nbsp;=&nbsp;new&nbsp;DirectoryEntry())&lt;br&gt; {&lt;br&gt;                   &nbsp;de.AuthenticationType&nbsp;=&nbsp;AuthenticationTypes.Anonymous;&lt;br&gt;                   &nbsp;de.Path&nbsp;=&nbsp;&amp;quot;LDAP://&lt;a&nbsp;href=&quot;http://192.168.1.2/rootDSE&quot;&gt;192.168.1.2/rootDSE&lt;/a&gt;&amp;quot;;&lt;br&gt;<br>
                   &nbsp;&lt;br&gt;                   &nbsp;_defaultNamingContext&nbsp;=&nbsp;de.Properties[&amp;quot;defaultNamingContext&amp;quot;][0].ToString();&lt;br&gt;  &nbsp;}&lt;br&gt;&lt;br&gt;However,&nbsp;under&nbsp;Mono,&nbsp;this&nbsp;fails&nbsp;with&nbsp;an&nbsp;LdapException&lt;br&gt;&lt;br&gt;Cause:&nbsp;LDAP&nbsp;Error&nbsp;Message:&nbsp;0000208F:&nbsp;NameErr:&nbsp;DSID-031001F7,&nbsp;problem&nbsp;2006&nbsp;(BAD_NAME),&nbsp;data&nbsp;8350,&nbsp;best&nbsp;match&nbsp;of:&amp;#39;rootDSE&amp;#39;&lt;br&gt;<br>
Error&nbsp;Message:&nbsp;Invalid&nbsp;DN&nbsp;Syntax&lt;br&gt;ResultCode:&nbsp;34&lt;br&gt;&lt;br&gt;Instead,&nbsp;I&nbsp;can&nbsp;get&nbsp;it&nbsp;working&nbsp;under&nbsp;Mono&nbsp;with:&lt;br&gt;&lt;br&gt;using&nbsp;(DirectoryEntry&nbsp;de&nbsp;=&nbsp;new&nbsp;DirectoryEntry())&lt;br&gt;{&lt;br&gt;    &nbsp;de.AuthenticationType&nbsp;=&nbsp;AuthenticationTypes.Anonymous;&lt;br&gt;<br>
    &nbsp;de.Path&nbsp;=&nbsp;&amp;quot;LDAP://&lt;a&nbsp;href=&quot;http://192.168.1.2&quot;&gt;192.168.1.2&lt;/a&gt;&amp;quot;;&lt;br&gt;&lt;br&gt;     &nbsp;using&nbsp;(DirectorySearcher&nbsp;deSearch&nbsp;=&nbsp;new&nbsp;DirectorySearcher())&lt;br&gt;     &nbsp;{&lt;br&gt; &nbsp; &nbsp; &nbsp;    &nbsp;deSearch.SearchRoot&nbsp;=&nbsp;de;&lt;br&gt;          &nbsp;deSearch.SearchScope&nbsp;=&nbsp;System.DirectoryServices.SearchScope.Base;&lt;br&gt;<br>
          &nbsp;deSearch.PropertiesToLoad.Add(&amp;quot;defaultNamingContext&amp;quot;);&lt;br&gt;&lt;br&gt;          &nbsp;using&nbsp;(SearchResultCollection&nbsp;src&nbsp;=&nbsp;deSearch.FindAll())&lt;br&gt;          &nbsp;{&lt;br&gt;               &nbsp;foreach&nbsp;(SearchResult&nbsp;sr&nbsp;in&nbsp;src)&lt;br&gt;<br>
               &nbsp;{&lt;br&gt;                    &nbsp;ResultPropertyValueCollection&nbsp;rpvc&nbsp;=&nbsp;sr.Properties[&amp;quot;defaultNamingContext&amp;quot;];&lt;br&gt;                         &nbsp;if&nbsp;(rpvc&nbsp;!=&nbsp;null)&lt;br&gt;                              &nbsp;_defaultNamingContext&nbsp;=&nbsp;rpvc[0].ToString();&lt;br&gt;<br>
                &nbsp;}&lt;br&gt;          &nbsp;}&lt;br&gt;}&lt;br&gt;&lt;br&gt;but&nbsp;this&nbsp;fails&nbsp;in&nbsp;.NET&nbsp;with&nbsp;System.Runtime.InteropServices.COMException,&nbsp;&amp;quot;The&nbsp;specified&nbsp;directory&nbsp;service&nbsp;attribute&nbsp;or&nbsp;value&nbsp;does&nbsp;not&nbsp;exist.&nbsp;&lt;br&gt;&lt;br&gt;Is&nbsp;there&nbsp;an&nbsp;easy&nbsp;way&nbsp;around&nbsp;this?&lt;br&gt;<br>
&lt;br&gt;Should&nbsp;I&nbsp;just&nbsp;abandon&nbsp;System.DirectoryServices&nbsp;and&nbsp;instead&nbsp;just&nbsp;use&nbsp;Novell.Directory.Ldap?&nbsp;&lt;br&gt;&lt;br&gt;The&nbsp;AD&nbsp;server&nbsp;is&nbsp;running&nbsp;Windows&nbsp;2008&nbsp;R2.&nbsp;&lt;br&gt;&lt;br&gt;Thanks!&lt;br&gt;&lt;br&gt;-Ron&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
