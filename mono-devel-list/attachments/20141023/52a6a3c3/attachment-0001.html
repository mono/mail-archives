<tt>
I&nbsp;would&nbsp;be&nbsp;looking&nbsp;for&nbsp;threading&nbsp;issues&nbsp;here.&lt;br&gt;&lt;br&gt;On&nbsp;Thursday,&nbsp;October&nbsp;23,&nbsp;2014,&nbsp;Etienne&nbsp;Champetier&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:champetier.etienne@gmail.com&quot;&gt;champetier.etienne@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;After&nbsp;some&nbsp;more&nbsp;investigation,&nbsp;reading&nbsp;many&nbsp;lines&nbsp;of&nbsp;code&nbsp;with&nbsp;a&nbsp;collegue,&nbsp;we&nbsp;came&nbsp;to&nbsp;the&nbsp;conclusion&nbsp;that&nbsp;this&nbsp;exception&nbsp;is&nbsp;impossible&nbsp;:)&lt;br&gt;&lt;/div&gt;&lt;div&gt;(yet&nbsp;the&nbsp;web&nbsp;is&nbsp;stuck&nbsp;on&nbsp;it)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;span&gt;m_ItemsContainer&nbsp;is&nbsp;an&nbsp;hashtable,&nbsp;and&nbsp;a&nbsp;private&nbsp;field&nbsp;of&nbsp;&lt;/span&gt;NameObjectCollectionBase&nbsp;class&nbsp;(new&nbsp;HashTable(0,&lt;span&gt;&lt;/span&gt;&lt;span&gt;StringComparer&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Ordinal&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;).&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;exception&nbsp;tell&nbsp;us&nbsp;that&nbsp;there&nbsp;is&nbsp;already&nbsp;a&nbsp;key&nbsp;&#39;httpModules&#39;&nbsp;in&nbsp;&lt;span&gt;m_ItemsContainer&lt;/span&gt;.&lt;br&gt;Reading&nbsp;the&nbsp;code&nbsp;the&nbsp;only&nbsp;way&nbsp;we&nbsp;go&nbsp;from&nbsp;BaseSet&nbsp;to&nbsp;BaseAdd&nbsp;is&nbsp;if&lt;br&gt;&lt;span&gt;FindFirstMatchedItem&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#39;httpModules&#39;),&nbsp;so&nbsp;if&nbsp;&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_Item&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;m_ItemsContainer&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;&#39;httpModules&#39;&lt;/span&gt;&lt;span&gt;]&nbsp;is&nbsp;null&lt;/span&gt;&lt;span&gt;,&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;so&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;null&nbsp;(the&nbsp;key&nbsp;exists,&nbsp;we&nbsp;got&nbsp;an&nbsp;exception&nbsp;to&nbsp;prove&nbsp;it&nbsp;:))&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if&nbsp;i&#39;m&nbsp;right,&nbsp;we&nbsp;are&nbsp;sure&nbsp;that&nbsp;we&nbsp;have&nbsp;(&#39;httpModules&#39;,null)&nbsp;in&nbsp;&nbsp;&lt;span&gt;m_ItemsContainer&lt;/span&gt;.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now&nbsp;&lt;span&gt;m_ItemsContainer&nbsp;only&nbsp;modifications&nbsp;are:&lt;br&gt;&lt;/span&gt;&lt;span&gt;0)&lt;/span&gt;&nbsp;&lt;span&gt;&lt;span&gt;m_ItemsContainer&lt;/span&gt;&nbsp;&lt;span&gt;=&lt;/span&gt;&nbsp;&lt;span&gt;new&lt;/span&gt;&nbsp;&lt;span&gt;Hashtable&lt;/span&gt;&nbsp;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;m_defCapacity&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&nbsp;&lt;span&gt;equality_comparer&lt;/span&gt;&lt;span&gt;);&lt;br&gt;&lt;/span&gt;&lt;br&gt;1)&nbsp;m_ItemsContainer&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Clear&lt;/span&gt;&nbsp;&lt;span&gt;();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;2)&nbsp;_Item&lt;/span&gt;&nbsp;&lt;span&gt;newitem&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&nbsp;&lt;span&gt;_Item&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;name&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&nbsp;&lt;span&gt;value&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span&gt;  &nbsp;m_ItemsContainer&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Add&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;name&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;newitem&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;3)&nbsp;&lt;span&gt;m_ItemsContainer&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Remove&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;name&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;there&nbsp;is&nbsp;(&#39;httpModules&#39;,null)&nbsp;in&nbsp;&nbsp;&lt;span&gt;m_ItemsContainer&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Please&nbsp;someone&nbsp;tell&nbsp;me&nbsp;where&nbsp;i&#39;m&nbsp;wrong&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://github.com/mono/mono/blob/master/mcs/class/System/System.Collections.Specialized/NameObjectCollectionBase.cs&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/mono/mono/blob/master/mcs/class/System/System.Collections.Specialized/NameObjectCollectionBase.cs&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;br&gt;&lt;/div&gt;&lt;div&gt;Etienne&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2014-10-21&nbsp;14:54&nbsp;GMT+02:00&nbsp;Etienne&nbsp;Champetier&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;javascript:_e(%7B%7D,&#39;cvml&#39;,&#39;champetier.etienne@gmail.com&#39;);&quot;&nbsp;target=&quot;_blank&quot;&gt;champetier.etienne@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;br&gt;&lt;br&gt;At&nbsp;my&nbsp;firm&nbsp;we&nbsp;are&nbsp;running&nbsp;multiple&nbsp;webapplication&nbsp;using&nbsp;mono&nbsp;(nginx&nbsp;+&nbsp;fastcgi-mono-server2.exe)&nbsp;on&nbsp;a&nbsp;cluster&nbsp;of&nbsp;4&nbsp;VM,&nbsp;2&nbsp;vcpus.&lt;br&gt;One&nbsp;of&nbsp;them&nbsp;is&nbsp;restarted&nbsp;every&nbsp;day&nbsp;at&nbsp;1h45&nbsp;(small&nbsp;memory&nbsp;leak).&lt;br&gt;3&nbsp;weeks&nbsp;ago&nbsp;we&nbsp;went&nbsp;from&nbsp;8VM&nbsp;with&nbsp;1vcpu&nbsp;(no&nbsp;restart&nbsp;problem)&nbsp;to&nbsp;4VM&nbsp;with&nbsp;2vcpus,&nbsp;and&nbsp;now,&lt;br&gt;it&#39;s&nbsp;the&nbsp;3rd&nbsp;time&nbsp;in&nbsp;2&nbsp;weeks&nbsp;that&nbsp;on&nbsp;one&nbsp;VM,&nbsp;the&nbsp;restart&nbsp;doesn&#39;t&nbsp;work&nbsp;well&nbsp;and&nbsp;we&nbsp;have:&lt;br&gt;&lt;br&gt;[System.ArgumentException]:&nbsp;Key&nbsp;duplication&nbsp;when&nbsp;adding:&nbsp;httpModules&lt;br&gt; &nbsp;at&nbsp;System.Collections.Hashtable.PutImpl&nbsp;(System.Object&nbsp;key,&nbsp;System.Object&nbsp;value,&nbsp;Boolean&nbsp;overwrite)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Collections.Hashtable.Add&nbsp;(System.Object&nbsp;key,&nbsp;System.Object&nbsp;value)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Collections.Specialized.NameObjectCollectionBase.BaseAdd&nbsp;(System.String&nbsp;name,&nbsp;System.Object&nbsp;value)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Collections.Specialized.NameObjectCollectionBase.BaseSet&nbsp;(System.String&nbsp;name,&nbsp;System.Object&nbsp;value)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Configuration.ConfigurationSectionCollection.get_Item&nbsp;(System.String&nbsp;name)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Configuration.Configuration.GetSection&nbsp;(System.String&nbsp;path)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Web.Configuration.WebConfigurationManager.GetSection&nbsp;(System.String&nbsp;sectionName,&nbsp;System.String&nbsp;path,&nbsp;System.Web.HttpContext&nbsp;context)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Web.Configuration.WebConfigurationManager.GetSection&nbsp;(System.String&nbsp;sectionName,&nbsp;System.String&nbsp;path)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Web.Configuration.WebConfigurationManager.GetWebApplicationSection&nbsp;(System.String&nbsp;sectionName)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt; &nbsp;at&nbsp;System.Web.HttpApplication.InitOnce&nbsp;(Boolean&nbsp;full_init)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;filename&nbsp;unknown&gt;:0&lt;br&gt;&lt;br&gt;&lt;br&gt;The&nbsp;really&nbsp;cool&nbsp;stuff&nbsp;is&nbsp;that&nbsp;even&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;500&nbsp;error,&nbsp;the&nbsp;returned&nbsp;http&nbsp;code&nbsp;is&nbsp;200&nbsp;:)&lt;br&gt;&lt;br&gt;I&#39;ve&nbsp;already&nbsp;checked&nbsp;and&nbsp;all&nbsp;files&nbsp;are&nbsp;equal&nbsp;(dll,&nbsp;exe,&nbsp;conf),&nbsp;all&nbsp;VM&nbsp;conf&nbsp;are&nbsp;equal&nbsp;(vcpu,&nbsp;memory,&nbsp;...),&nbsp;...&lt;br&gt;&lt;br&gt;I&#39;m&nbsp;not&nbsp;able&nbsp;to&nbsp;reproduce&nbsp;the&nbsp;bug&nbsp;(restart&nbsp;under&nbsp;high&nbsp;load&nbsp;(ab&nbsp;-c&nbsp;50&nbsp;-n&nbsp;100000))&nbsp;so&nbsp;can&#39;t&nbsp;tell&nbsp;if&nbsp;the&nbsp;bug&nbsp;is&nbsp;there&nbsp;in&nbsp;the&nbsp;newest&nbsp;version.&lt;br&gt;&lt;br&gt;We&nbsp;are&nbsp;using&nbsp;a&nbsp;version&nbsp;of&nbsp;mono&nbsp;before&nbsp;3.2.7&nbsp;(92887027be801b012846866208e6b4e362a4fc24)&nbsp;and&nbsp;fastcgi-mono-server2&nbsp;(xsp)&nbsp;version&nbsp;2.10.2-1&nbsp;(old&nbsp;version&nbsp;build&nbsp;on&nbsp;14/09/12&nbsp;by&nbsp;someone&nbsp;at&nbsp;my&nbsp;firm)&lt;br&gt;I&nbsp;know&nbsp;we&nbsp;are&nbsp;using&nbsp;old&nbsp;version&nbsp;but&nbsp;it&nbsp;seems&nbsp;that&nbsp;the&nbsp;bug&nbsp;is&nbsp;still&nbsp;there:&lt;br&gt;&lt;a&nbsp;href=&quot;https://bugzilla.xamarin.com/show_bug.cgi?id=18303&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugzilla.xamarin.com/show_bug.cgi?id=18303&lt;/a&gt;&lt;br&gt;&lt;br&gt;I&#39;ve&nbsp;run&nbsp;lsof&nbsp;on&nbsp;the&nbsp;processes&nbsp;(the&nbsp;stuck&nbsp;one&nbsp;and&nbsp;one&nbsp;working),&nbsp;and&nbsp;by&nbsp;comparing&nbsp;the&nbsp;2,&nbsp;i&nbsp;see&nbsp;that&nbsp;App_global.asax_XXXXXXX.dll&lt;br&gt;is&nbsp;here&nbsp;in&nbsp;both&nbsp;case,&nbsp;but&nbsp;not&nbsp; App_Web_XXXXXXXX.dll&nbsp;(only&nbsp;on&nbsp;the&nbsp;working&nbsp;one)&nbsp;(see&nbsp;attachment)&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;root&nbsp;access&nbsp;on&nbsp;the&nbsp;VM&nbsp;with&nbsp;the&nbsp;stuck&nbsp;process,&nbsp;and&nbsp;i&#39;m&nbsp;on&nbsp;irc&nbsp;right&nbsp;now&nbsp;(champtar),&nbsp;so&nbsp;if&nbsp;you&nbsp;have&nbsp;some&nbsp;ideas&nbsp;to&nbsp;gather&nbsp;more&nbsp;info&nbsp;to&nbsp;kill&nbsp;this&nbsp;bug&lt;br&gt;&lt;br&gt;Thanks&nbsp;in&nbsp;advance&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;&lt;br&gt;Etienne&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;br&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Studying&nbsp;for&nbsp;the&nbsp;Turing&nbsp;test&lt;/div&gt;&lt;br&gt;<br>

</tt>
