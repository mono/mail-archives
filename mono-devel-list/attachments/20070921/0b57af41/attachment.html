<tt>
&lt;span&nbsp;class=&quot;q&quot;&gt;Hi&nbsp;Kevin,&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;enjoying&nbsp;reading&nbsp;these&nbsp;posts&nbsp;of&nbsp;yours&nbsp;-&nbsp;very&nbsp;fascinating.&nbsp;&lt;br&gt;&lt;br&gt;With<br>
regards&nbsp;to&nbsp;change&nbsp;tracking,&nbsp;the&nbsp;last&nbsp;time&nbsp;I&nbsp;looked,&nbsp;DLINQ&nbsp;objects&nbsp;raise<br>
a&nbsp;PropertyChanging&nbsp;(INotifyPropertyChanging,&nbsp;part&nbsp;of<br>
System.ComponentModel<br>
)&nbsp;event&nbsp;when&nbsp;properties&nbsp;are&nbsp;changed.&nbsp;Since&nbsp;it&nbsp;is&nbsp;your&nbsp;QueryProvider<br>
(the&nbsp;DataContext)&nbsp;which&nbsp;is&nbsp;returning&nbsp;the&nbsp;objects,&nbsp;it&nbsp;can&nbsp;subscribe&nbsp;to<br>
these&nbsp;events&nbsp;and&nbsp;use&nbsp;them&nbsp;to&nbsp;builds&nbsp;its&nbsp;hashtable&nbsp;when&nbsp;updateable&nbsp;items<br>
are&nbsp;modified.&nbsp;&lt;br&gt;&lt;br&gt;So&nbsp;a&nbsp;Dictionary&amp;lt;Row,&nbsp;Change&amp;gt;&nbsp;(where&nbsp;a&nbsp;&amp;quot;Change&amp;quot;<br>
represents&nbsp;the&nbsp;original&nbsp;and&nbsp;new&nbsp;value),&nbsp;as&nbsp;you&nbsp;suggested,&nbsp;would&nbsp;seem<br>
like&nbsp;the&nbsp;way&nbsp;to&nbsp;go&nbsp;to&nbsp;me.&nbsp;&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;&lt;br&gt;Paul&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.paulstovell.net/&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;<br>
www.paulstovell.net&lt;/a&gt;&lt;br&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;9/21/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Kevin&nbsp;Kubasik&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:kevin@kubasik.net&quot;&gt;kevin@kubasik.net&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Ok,&nbsp;so&nbsp;I&amp;#39;ve&nbsp;been&nbsp;able&nbsp;to&nbsp;create&nbsp;a&nbsp;pretty&nbsp;generic&nbsp;(if&nbsp;highly&nbsp;adaptable)&lt;br&gt;IQueryProvider&nbsp;which&nbsp;implements&nbsp;very&nbsp;basic&nbsp;Linq&nbsp;-&amp;gt;&nbsp;Sql&nbsp;support(More&nbsp;on&lt;br&gt;that&nbsp;later).&nbsp;This&nbsp;project&nbsp;was&nbsp;to&nbsp;better&nbsp;understand&nbsp;the&nbsp;roll&nbsp;played&nbsp;by<br>
&lt;br&gt;different&nbsp;components&nbsp;in&nbsp;the&nbsp;linq-&amp;gt;sql&nbsp;pipeline.&nbsp;While&nbsp;the&nbsp;more&lt;br&gt;complicated&nbsp;and&nbsp;optimized&nbsp;we&nbsp;try&nbsp;to&nbsp;make&nbsp;the&nbsp;Linq-SQL&nbsp;conversion,&nbsp;the&lt;br&gt;harder&nbsp;it&nbsp;becomes,&nbsp;the&nbsp;core&nbsp;of&nbsp;implementing&nbsp;a&nbsp;Provider&nbsp;is&nbsp;pretty&nbsp;easy.&lt;br&gt;We&nbsp;could&nbsp;write&nbsp;custom&nbsp;_query_&nbsp;providers&nbsp;all&nbsp;day&nbsp;long&nbsp;and&nbsp;have&nbsp;linq&nbsp;to<br>
&lt;br&gt;the&nbsp;world.&nbsp;The&nbsp;problem&nbsp;is&nbsp;that&nbsp;we&nbsp;want&nbsp;updates,&nbsp;deletes,&nbsp;sprocs&nbsp;etc.&lt;br&gt;That&nbsp;is&nbsp;where&nbsp;the&nbsp;DataContext&nbsp;comes&nbsp;in,&nbsp;and&nbsp;my&nbsp;headaches&nbsp;start.&lt;br&gt;&lt;br&gt;The&nbsp;principal&nbsp;of&nbsp;the&nbsp;DataContext&nbsp;is&nbsp;easy&nbsp;enough,&nbsp;its&nbsp;like&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://ADO.NET&quot;&gt;<br>
ADO.NET&lt;/a&gt;&lt;br&gt;2.0&nbsp;DataSets&nbsp;in&nbsp;that&nbsp;it&nbsp;can&nbsp;be&nbsp;generated&nbsp;as&nbsp;a&nbsp;strongly-typed&nbsp;extension&lt;br&gt;of&nbsp;the&nbsp;core&nbsp;DataContex,&nbsp;or&nbsp;as&nbsp;a&nbsp;generic&nbsp;and&nbsp;adaptable&nbsp;class.&nbsp;The&lt;br&gt;DataContext&nbsp;sits&nbsp;in&nbsp;System.Data.Linq,&nbsp;and&nbsp;is&nbsp;the&nbsp;gatekeeper&nbsp;between<br>
&lt;br&gt;the&nbsp;query&nbsp;language&nbsp;and&nbsp;a&nbsp;provider.&nbsp;In&nbsp;addition&nbsp;to&nbsp;just&nbsp;being&nbsp;in&nbsp;the&lt;br&gt;way,&nbsp;the&nbsp;DataContext&nbsp;provides&nbsp;metadata&nbsp;about&nbsp;a&nbsp;database,&nbsp;has&nbsp;an&lt;br&gt;understanding&nbsp;of&nbsp;tables&nbsp;and&nbsp;relationships,&nbsp;as&nbsp;well&nbsp;as&nbsp;stored&lt;br&gt;procedures.&nbsp;It&nbsp;is&nbsp;also&nbsp;responsible&nbsp;for&nbsp;object&nbsp;caches.<br>
&lt;br&gt;&lt;br&gt;This&nbsp;is&nbsp;all&nbsp;fun&nbsp;and&nbsp;good,&nbsp;with&nbsp;some&nbsp;decent&nbsp;mapping&nbsp;code&nbsp;we&nbsp;can&nbsp;do&nbsp;all&lt;br&gt;that&nbsp;without&nbsp;breaking&nbsp;a&nbsp;sweat.&nbsp;The&nbsp;problem&nbsp;is&lt;br&gt;DataContext.SubmitChanges().&nbsp;As&nbsp;tables&nbsp;are&nbsp;manipulated&nbsp;etc.&nbsp;these&lt;br&gt;changes&nbsp;are&nbsp;tracked&nbsp;in-memory&nbsp;(or&nbsp;some&nbsp;other&nbsp;awesometastic&nbsp;way)&nbsp;and<br>
&lt;br&gt;eventually&nbsp;either&nbsp;reverted&nbsp;or&nbsp;submitted.&nbsp;More&nbsp;importantly,&nbsp;to&nbsp;anyone&lt;br&gt;using&nbsp;the&nbsp;DataContext&amp;#39;s&nbsp;tables&nbsp;gets&nbsp;the&nbsp;modified&nbsp;information.&nbsp;Again,&lt;br&gt;things&nbsp;don&amp;#39;t&nbsp;sound&nbsp;too&nbsp;bad,&nbsp;and&nbsp;there&nbsp;are&nbsp;already&nbsp;implementations<br>
&lt;br&gt;(DataTable,&nbsp;DataSet&nbsp;etc.).&nbsp;The&nbsp;difference&nbsp;is&nbsp;they&nbsp;have&nbsp;all&nbsp;the&nbsp;data,&lt;br&gt;and&nbsp;execute&nbsp;a&nbsp;modification&nbsp;upon&nbsp;call,&nbsp;then&nbsp;store&nbsp;the&nbsp;old&nbsp;value&nbsp;and&nbsp;the&lt;br&gt;current&nbsp;state&nbsp;of&nbsp;the&nbsp;data.&nbsp;Linq&nbsp;is&nbsp;all&nbsp;deferred&nbsp;execution,&nbsp;we&nbsp;don&amp;#39;t<br>
&lt;br&gt;have&nbsp;an&nbsp;in&nbsp;memory&nbsp;representation&nbsp;of&nbsp;the&nbsp;data&nbsp;on&nbsp;the&nbsp;database,&nbsp;we&nbsp;just&lt;br&gt;have&nbsp;a&nbsp;list&nbsp;of&nbsp;instructions,&nbsp;each&nbsp;of&nbsp;which&nbsp;will&nbsp;return&nbsp;a&nbsp;result.&lt;br&gt;&lt;br&gt;So,&nbsp;basically&nbsp;I&amp;#39;ve&nbsp;determined&nbsp;that&nbsp;out&nbsp;DataContext&nbsp;will&nbsp;have&nbsp;to&nbsp;track<br>
&lt;br&gt;everything&nbsp;happening&nbsp;in&nbsp;each&nbsp;of&nbsp;its&nbsp;tables.&nbsp;This&nbsp;got&nbsp;me&nbsp;thinking,&nbsp;an&lt;br&gt;event&nbsp;driven&nbsp;model&nbsp;would&nbsp;be&nbsp;perfect,&nbsp;we&nbsp;would&nbsp;only&nbsp;act&nbsp;when&nbsp;actual&lt;br&gt;action&nbsp;was&nbsp;being&nbsp;taken.&amp;nbsp;&amp;nbsp;Now,&nbsp;I&nbsp;basically&nbsp;have&nbsp;both&nbsp;ends&nbsp;of&nbsp;the&lt;br&gt;spectrum,&nbsp;we&nbsp;get&nbsp;every&nbsp;object&nbsp;associated&nbsp;with&nbsp;an&nbsp;expression&nbsp;utilizing<br>
&lt;br&gt;a&nbsp;DataContext,&nbsp;and&nbsp;flag&nbsp;it&nbsp;in&nbsp;our&nbsp;cool&nbsp;DiffTracker,&nbsp;using&nbsp;a&nbsp;Dictionary&lt;br&gt;or&nbsp;Hashtable&nbsp;for&nbsp;fast&nbsp;lookups&nbsp;based&nbsp;upon&nbsp;the&nbsp;entity&nbsp;itself,&nbsp;then&nbsp;we&lt;br&gt;process&nbsp;each&nbsp;event&nbsp;as&nbsp;it&nbsp;happens&nbsp;(which&nbsp;is&nbsp;pretty&nbsp;much&nbsp;the&nbsp;last&nbsp;thing&lt;br&gt;<br>
an&nbsp;expression&nbsp;will&nbsp;do).&nbsp;I&nbsp;think&nbsp;we&nbsp;can&nbsp;get&nbsp;away&nbsp;with&nbsp;only&nbsp;the&nbsp;current&lt;br&gt;state&nbsp;of&nbsp;each&nbsp;noteworthy&nbsp;object&nbsp;and&nbsp;the&nbsp;most&nbsp;recent&nbsp;past.I&nbsp;figure&nbsp;if&lt;br&gt;the&nbsp;state&nbsp;is&nbsp;Insert,&nbsp;who&nbsp;cares&nbsp;what&nbsp;the&nbsp;object&nbsp;was&nbsp;before,&nbsp;if&nbsp;the&lt;br&gt;state&nbsp;is&nbsp;Update,&nbsp;we&nbsp;just&nbsp;update&nbsp;all&nbsp;values&nbsp;to&nbsp;their&nbsp;current&nbsp;value,<br>
&lt;br&gt;selecting&nbsp;on&nbsp;the&nbsp;old&nbsp;object,&nbsp;and&nbsp;if&nbsp;its&nbsp;delete....&nbsp;yeah.&nbsp;There&nbsp;is&nbsp;a&lt;br&gt;States.cs&nbsp;Enum&nbsp;in&nbsp;the&nbsp;System.Data.Linq&nbsp;directory&nbsp;with&nbsp;all&nbsp;the&nbsp;states&nbsp;a&lt;br&gt;DataContext&amp;nbsp;&amp;nbsp;is&nbsp;aware&nbsp;of.&lt;br&gt;&lt;br&gt;The&nbsp;problem&nbsp;is&nbsp;the&nbsp;massive&nbsp;middleman,&nbsp;I&amp;#39;ve&nbsp;gotten&nbsp;absolutely&nbsp;worlds<br>
&lt;br&gt;better&nbsp;with&nbsp;some&nbsp;of&nbsp;C#&amp;#39;s&nbsp;more&nbsp;advanced&nbsp;language&nbsp;structures&nbsp;in&nbsp;the&nbsp;few&lt;br&gt;days&nbsp;I&amp;#39;ve&nbsp;been&nbsp;working&nbsp;on&nbsp;this,&nbsp;but&nbsp;I&nbsp;am&nbsp;not&nbsp;100%&nbsp;sure&nbsp;of&nbsp;hows&nbsp;the&lt;br&gt;best&nbsp;way&nbsp;to&nbsp;go&nbsp;about&nbsp;this.&nbsp;As&nbsp;a&nbsp;result,&nbsp;I&nbsp;would&nbsp;really&nbsp;love&nbsp;some&nbsp;help.<br>
&lt;br&gt;I&nbsp;can&nbsp;get&nbsp;the&nbsp;DataContext&nbsp;to&nbsp;respond&nbsp;intelligently&nbsp;to&nbsp;Linq&nbsp;queries,&lt;br&gt;and&nbsp;continue&nbsp;to&nbsp;process&nbsp;the&nbsp;subtree&nbsp;into&nbsp;a&nbsp;table.&nbsp;Once&nbsp;we&nbsp;are&nbsp;at&nbsp;that&lt;br&gt;point,&nbsp;its&nbsp;all&nbsp;on&nbsp;the&nbsp;individual&nbsp;Sql&nbsp;implementation&nbsp;(which&nbsp;isn&amp;#39;t&lt;br&gt;important&nbsp;yet,&nbsp;and&nbsp;isn&amp;#39;t&nbsp;really&nbsp;on&nbsp;the&nbsp;immeidate&nbsp;radar.).<br>
&lt;br&gt;&lt;br&gt;If&nbsp;someone&nbsp;could&nbsp;help&nbsp;me&nbsp;out&nbsp;a&nbsp;bit&nbsp;with&nbsp;the&nbsp;actual&nbsp;construction&nbsp;of&nbsp;the&lt;br&gt;DiffTracker&nbsp;and&nbsp;DiffWrapper&nbsp;classes,&nbsp;it&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appreciated.&lt;br&gt;You&nbsp;aren&amp;#39;t&nbsp;obligated&nbsp;to&nbsp;use&nbsp;my&nbsp;design,&nbsp;or&nbsp;even&nbsp;help&nbsp;at&nbsp;all.&nbsp;But&nbsp;I<br>
&lt;br&gt;would&nbsp;_greatly_&nbsp;appreciate&nbsp;some&nbsp;feedback&nbsp;or&nbsp;any&nbsp;ideas&nbsp;anyone&nbsp;has&nbsp;about&lt;br&gt;this.&nbsp;Specifically&nbsp;with&nbsp;regard&nbsp;too&nbsp;keeping&nbsp;this&nbsp;light&nbsp;and&nbsp;simple,&nbsp;as&nbsp;I&lt;br&gt;feel&nbsp;like&nbsp;it&nbsp;could&nbsp;quickly&nbsp;become&nbsp;a&nbsp;massive&nbsp;buggy&nbsp;mess.&lt;br&gt;&lt;br&gt;--&lt;br&gt;<br>
Cheers,&lt;br&gt;Kevin&nbsp;Kubasik&lt;br&gt;&lt;a&nbsp;href=&quot;http://kubasik.net/blog&quot;&gt;http://kubasik.net/blog&lt;/a&gt;&lt;br&gt;_______________________________________________&lt;br&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;<br>
Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
