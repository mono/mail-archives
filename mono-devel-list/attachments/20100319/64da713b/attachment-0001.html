<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Mar&nbsp;17,&nbsp;2010&nbsp;at&nbsp;2:22&nbsp;PM,&nbsp;Thierry&nbsp;Lafage&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:thierry.lafage@inria.fr&quot;&gt;thierry.lafage@inria.fr&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Hi&nbsp;all,&lt;br&gt;<br>
&lt;br&gt;<br>
Here&nbsp;is&nbsp;a&nbsp;small&nbsp;patch&nbsp;for&nbsp;ilasm&nbsp;which&nbsp;makes&nbsp;it&nbsp;replace&nbsp;ldc.i4&nbsp;with&nbsp;short&nbsp;forms&nbsp;when&nbsp;possible.&lt;br&gt;<br>
Note&nbsp;that&nbsp;I&amp;#39;m&nbsp;a&nbsp;C#&nbsp;and&nbsp;monodevelop&nbsp;newbie&nbsp;(but&nbsp;I&nbsp;tried&nbsp;to&nbsp;respect&nbsp;the&nbsp;coding&nbsp;guidelines).&lt;br&gt;<br>
I&nbsp;suggest&nbsp;to&nbsp;add&nbsp;the&nbsp;&amp;quot;-opt:ldc&amp;quot;&nbsp;because&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;add&nbsp;the&nbsp;same&nbsp;kind&nbsp;of&nbsp;optimization&nbsp;for&nbsp;ldloc/stloc&nbsp;(use&nbsp;short&nbsp;forms&nbsp;when&nbsp;possible).&nbsp;For&nbsp;this&nbsp;latter&nbsp;one,&nbsp;the&nbsp;command&nbsp;line&nbsp;option&nbsp;could&nbsp;be&nbsp;&amp;quot;-opt:loc&amp;quot;&nbsp;(and&nbsp;we&nbsp;could&nbsp;add&nbsp;&amp;quot;-opt:all&amp;quot;&nbsp;to&nbsp;enable&nbsp;both&nbsp;at&nbsp;once).&lt;br&gt;<br>
<br>
I&nbsp;think&nbsp;the&nbsp;impact&nbsp;of&nbsp;such&nbsp;a&nbsp;patch&nbsp;is&nbsp;quite&nbsp;limited,&nbsp;but&nbsp;it&amp;#39;s&nbsp;important&nbsp;for&nbsp;us&nbsp;(the&nbsp;gcc4cli&nbsp;team)&nbsp;since&nbsp;we&nbsp;rely&nbsp;on&nbsp;ilasm&nbsp;to&nbsp;assemble&nbsp;the&nbsp;CIL&nbsp;code&nbsp;produced&nbsp;by&nbsp;our&nbsp;compiler.&nbsp;And&nbsp;these&nbsp;&amp;quot;optimizations&amp;quot;&nbsp;tasks&nbsp;are&nbsp;better&nbsp;suited&nbsp;to&nbsp;the&nbsp;assembler&nbsp;than&nbsp;to&nbsp;the&nbsp;compiler&nbsp;itself.&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&amp;#39;s&nbsp;worth&nbsp;mentioning&nbsp;one&nbsp;thing&nbsp;thou.&nbsp;I&nbsp;don&amp;#39;t&nbsp;think&nbsp;it&amp;#39;s&nbsp;very&nbsp;advisable&nbsp;for&nbsp;you&nbsp;guys&nbsp;to&nbsp;spend&nbsp;time&nbsp;on&nbsp;the&nbsp;current&nbsp;MSIL&nbsp;assembler.&lt;/div&gt;&lt;div&gt;We&amp;#39;re&nbsp;trying&nbsp;to&nbsp;get&nbsp;rid&nbsp;of&nbsp;PEAPI&nbsp;in&nbsp;favor&nbsp;of&nbsp;a&nbsp;Cecil&nbsp;based&nbsp;version.&nbsp;We&nbsp;just&nbsp;haven&amp;#39;t&nbsp;really&nbsp;got&nbsp;enough&nbsp;resources&nbsp;to&nbsp;do&nbsp;all&nbsp;of&nbsp;it.&lt;/div&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;div&gt;Rodrigo&lt;/div&gt;<br>

</tt>
