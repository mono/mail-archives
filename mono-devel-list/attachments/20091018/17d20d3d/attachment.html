<tt>
Thanks&nbsp;for&nbsp;your&nbsp;prompt&nbsp;response&nbsp;Sebastien.&lt;br&gt;&lt;br&gt;I&nbsp;tried&nbsp;option&nbsp;B&nbsp;first,&nbsp;and&nbsp;things&nbsp;seemed&nbsp;to&nbsp;turn&nbsp;out&nbsp;worse&nbsp;than&nbsp;before.&nbsp;You&nbsp;can&nbsp;see&nbsp;from&nbsp;the&nbsp;stack&nbsp;trace&nbsp;below&nbsp;that&nbsp;the&nbsp;length&nbsp;is&nbsp;now&nbsp;121,&nbsp;rather&nbsp;than&nbsp;104;&nbsp;and&nbsp;it&nbsp;is&nbsp;deeper&nbsp;in&nbsp;the&nbsp;recursion.&lt;br&gt;<br>
&lt;br&gt;Mono.Security.dll!Mono.Security.ASN1.DecodeTLV(byte[]&nbsp;asn1&nbsp;=&nbsp;{byte[69238]},&nbsp;ref&nbsp;int&nbsp;pos&nbsp;=&nbsp;69138,&nbsp;out&nbsp;byte&nbsp;tag&nbsp;=&nbsp;43,&nbsp;out&nbsp;int&nbsp;length&nbsp;=&nbsp;121,&nbsp;out&nbsp;byte[]&nbsp;content&nbsp;=&nbsp;{byte[121]})&nbsp;Line&nbsp;279&nbsp;+&nbsp;0x33&nbsp;bytes&lt;br&gt;Mono.Security.dll!Mono.Security.ASN1.Decode(byte[]&nbsp;asn1&nbsp;=&nbsp;{byte[69238]},&nbsp;ref&nbsp;int&nbsp;anPos&nbsp;=&nbsp;69138,&nbsp;int&nbsp;anLength&nbsp;=&nbsp;69201)&nbsp;Line&nbsp;249&nbsp;+&nbsp;0x36&nbsp;bytes&lt;br&gt;<br>
Mono.Security.dll!Mono.Security.ASN1.Decode(byte[]&nbsp;asn1&nbsp;=&nbsp;{byte[69238]},&nbsp;ref&nbsp;int&nbsp;anPos&nbsp;=&nbsp;69136,&nbsp;int&nbsp;anLength&nbsp;=&nbsp;69238)&nbsp;Line&nbsp;258&nbsp;+&nbsp;0x2b&nbsp;bytes&lt;br&gt;Mono.Security.dll!Mono.Security.ASN1.Decode(byte[]&nbsp;asn1&nbsp;=&nbsp;{byte[69238]},&nbsp;ref&nbsp;int&nbsp;anPos&nbsp;=&nbsp;69134,&nbsp;int&nbsp;anLength&nbsp;=&nbsp;69238)&nbsp;Line&nbsp;258&nbsp;+&nbsp;0x2b&nbsp;bytes&lt;br&gt;<br>
Mono.Security.dll!Mono.Security.ASN1.ASN1(byte[]&nbsp;data&nbsp;=&nbsp;{byte[69238]})&nbsp;Line&nbsp;90&nbsp;+&nbsp;0x26&nbsp;bytes&lt;br&gt;Mono.Security.dll!Mono.Security.X509.X509Crl.Parse(byte[]&nbsp;crl&nbsp;=&nbsp;{byte[69238]})&nbsp;Line&nbsp;139&nbsp;+&nbsp;0x33&nbsp;bytes&lt;br&gt;Mono.Security.dll!Mono.Security.X509.X509Crl.X509Crl(byte[]&nbsp;crl&nbsp;=&nbsp;{byte[69238]})&nbsp;Line&nbsp;131&nbsp;+&nbsp;0x13&nbsp;bytes&lt;br&gt;<br>
&lt;br&gt;I&nbsp;couldn&amp;#39;t&nbsp;find&nbsp;the&nbsp;freeware&nbsp;asn1view&nbsp;tool&nbsp;you&nbsp;mention,&nbsp;but&nbsp;I&nbsp;tried&nbsp;some&nbsp;other&nbsp;ones&nbsp;I&nbsp;found&nbsp;in&nbsp;a&nbsp;google&nbsp;search.&nbsp;I&nbsp;can&amp;#39;t&nbsp;build&nbsp;gasn1view&nbsp;on&nbsp;this&nbsp;machine&nbsp;so&nbsp;I&nbsp;couldn&amp;#39;t&nbsp;try&nbsp;that&nbsp;one.&lt;br&gt;&lt;br&gt;ASN.1&nbsp;Editor&nbsp;(&lt;a&nbsp;href=&quot;http://lipingshare.com/Asn1Editor/&quot;&gt;http://lipingshare.com/Asn1Editor/&lt;/a&gt;)&nbsp;took&nbsp;5mins&nbsp;to&nbsp;open&nbsp;the&nbsp;CRL&nbsp;and&nbsp;from&nbsp;what&nbsp;it&nbsp;shows&nbsp;the&nbsp;data&nbsp;ends&nbsp;at&nbsp;position&nbsp;51088,&nbsp;which&nbsp;means&nbsp;there&nbsp;would&nbsp;be&nbsp;18149&nbsp;bytes&nbsp;of&nbsp;junk&nbsp;at&nbsp;the&nbsp;end?&nbsp;I&nbsp;cannot&nbsp;confirm&nbsp;whether&nbsp;it&nbsp;shows&nbsp;all&nbsp;revoked&nbsp;certificates&nbsp;in&nbsp;the&nbsp;sequence.&lt;br&gt;<br>
&lt;br&gt;ASN1VE&nbsp;(&lt;a&nbsp;href=&quot;http://www.obj-sys.com/products_asn1ve.php&quot;&gt;http://www.obj-sys.com/products_asn1ve.php&lt;/a&gt;)&nbsp;threw&nbsp;up&nbsp;an&nbsp;error&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Oct&nbsp;16,&nbsp;2009&nbsp;at&nbsp;10:09&nbsp;PM,&nbsp;Sebastien&nbsp;Pouliot&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sebastien.pouliot@gmail.com&quot;&gt;sebastien.pouliot@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;Fri,&nbsp;2009-10-16&nbsp;at&nbsp;11:40&nbsp;+1000,&nbsp;Jonathon&nbsp;Rossi&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hi,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;load&nbsp;a&nbsp;CRL&nbsp;with&nbsp;the&nbsp;Mono.Security&nbsp;library&nbsp;(tried&nbsp;with&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;2.4.2.3&nbsp;Windows&nbsp;binaries,&nbsp;and&nbsp;with&nbsp;the&nbsp;trunk)&nbsp;like&nbsp;this:&lt;br&gt;<br>
&amp;gt;&nbsp;X509Crl&nbsp;crl&nbsp;=&nbsp;X509Crl.CreateFromFile(@&amp;quot;C:\ca.crl&amp;quot;);&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;And&nbsp;I&nbsp;get&nbsp;a&nbsp;CryptographicException:&nbsp;Input&nbsp;data&nbsp;cannot&nbsp;be&nbsp;coded&nbsp;as&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;valid&nbsp;CRL.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;have&nbsp;looking&nbsp;into&nbsp;the&nbsp;source&nbsp;code&nbsp;and&nbsp;this&nbsp;is&nbsp;occurring&nbsp;inside&lt;br&gt;<br>
&amp;gt;&nbsp;ASN1.DecodeTLV.&nbsp;At&nbsp;this&nbsp;point&nbsp;the&nbsp;code&nbsp;is&nbsp;trying&nbsp;to&nbsp;do&nbsp;a&nbsp;block&nbsp;copy&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;104&nbsp;bytes,&nbsp;where&nbsp;the&nbsp;asn1&nbsp;array&nbsp;only&nbsp;has&nbsp;103&nbsp;left&nbsp;(pos+length),&nbsp;and&nbsp;it&lt;br&gt;<br>
&amp;gt;&nbsp;throws&nbsp;an&nbsp;ArgumentException:&nbsp;&amp;quot;Offset&nbsp;and&nbsp;length&nbsp;were&nbsp;out&nbsp;of&nbsp;bounds&nbsp;for&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;array&nbsp;or&nbsp;count&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;from&nbsp;index&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source&nbsp;collection.&amp;quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Mono.Security.dll!Mono.Security.ASN1.DecodeTLV(byte[]&nbsp;asn1&nbsp;=&lt;br&gt;<br>
&amp;gt;&nbsp;{byte[69237]},&nbsp;ref&nbsp;int&nbsp;pos&nbsp;=&nbsp;69134,&nbsp;out&nbsp;byte&nbsp;tag&nbsp;=&nbsp;104,&nbsp;out&nbsp;int&nbsp;length&lt;br&gt;<br>
&amp;gt;&nbsp;=&nbsp;104,&nbsp;out&nbsp;byte[]&nbsp;content&nbsp;=&nbsp;{byte[104]})&nbsp;Line&nbsp;279&nbsp;+&nbsp;0x33&nbsp;bytes&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;It&nbsp;looks&nbsp;weird&nbsp;(but&nbsp;not&nbsp;impossible)&nbsp;that&nbsp;both&nbsp;the&nbsp;tag&nbsp;and&nbsp;length&nbsp;are&lt;br&gt;<br>
104.&nbsp;However&nbsp;the&nbsp;problem&nbsp;is&nbsp;that&nbsp;that&amp;#39;s&nbsp;only&nbsp;103&nbsp;byte&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer&lt;br&gt;<br>
-&nbsp;which&nbsp;(if&nbsp;the&nbsp;length&nbsp;is&nbsp;valid)&nbsp;is&nbsp;not&nbsp;legal&nbsp;ASN.1&nbsp;(but&nbsp;not&nbsp;unheard&nbsp;of&lt;br&gt;<br>
either,&nbsp;e.g.&nbsp;extra&nbsp;bytes&nbsp;are&nbsp;common&nbsp;and&nbsp;accepted&nbsp;by&nbsp;most&nbsp;parsers)&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Mono.Security.dll!Mono.Security.ASN1.Decode(byte[]&nbsp;asn1&nbsp;=&lt;br&gt;<br>
&amp;gt;&nbsp;{byte[69237]},&nbsp;ref&nbsp;int&nbsp;anPos&nbsp;=&nbsp;69134,&nbsp;int&nbsp;anLength&nbsp;=&nbsp;69237)&nbsp;Line&nbsp;249&nbsp;+&lt;br&gt;<br>
&amp;gt;&nbsp;0x36&nbsp;bytes&lt;br&gt;<br>
&amp;gt;&nbsp;Mono.Security.dll!Mono.Security.ASN1.ASN1(byte[]&nbsp;data&nbsp;=&nbsp;{byte[69237]})&lt;br&gt;<br>
&amp;gt;&nbsp;Line&nbsp;90&nbsp;+&nbsp;0x26&nbsp;bytes&lt;br&gt;<br>
&amp;gt;&nbsp;Mono.Security.dll!Mono.Security.X509.X509Crl.Parse(byte[]&nbsp;crl&nbsp;=&lt;br&gt;<br>
&amp;gt;&nbsp;{byte[69237]})&nbsp;Line&nbsp;139&nbsp;+&nbsp;0x33&nbsp;bytes&lt;br&gt;<br>
&amp;gt;&nbsp;Mono.Security.dll!Mono.Security.X509.X509Crl.X509Crl(byte[]&nbsp;crl&nbsp;=&lt;br&gt;<br>
&amp;gt;&nbsp;{byte[69237]})&nbsp;Line&nbsp;131&nbsp;+&nbsp;0x13&nbsp;bytes&lt;br&gt;<br>
&amp;gt;&nbsp;Mono.Security.dll!Mono.Security.X509.X509Crl.CreateFromFile(string&lt;br&gt;<br>
&amp;gt;&nbsp;filename&nbsp;=&nbsp;&amp;quot;C:\\ca.crl&amp;quot;)&nbsp;Line&nbsp;421&nbsp;+&nbsp;0x20&nbsp;bytes&lt;br&gt;<br>
&amp;gt;&nbsp;ConsoleApplication2.exe!ConsoleApplication2.Program.Main(string[]&nbsp;args&lt;br&gt;<br>
&amp;gt;&nbsp;=&nbsp;{string[0]})&nbsp;Line&nbsp;14&nbsp;+&nbsp;0x12&nbsp;bytes&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;CRL&nbsp;is&nbsp;68KB,&nbsp;and&nbsp;verifies&nbsp;using&nbsp;certutil.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;If&nbsp;the&nbsp;parser&nbsp;allows&nbsp;the&nbsp;truncation&nbsp;then&nbsp;the&nbsp;CRL&nbsp;can&nbsp;still&nbsp;verify&nbsp;if&nbsp;the&lt;br&gt;<br>
missing&nbsp;part&nbsp;(the&nbsp;last&nbsp;byte&nbsp;in&nbsp;this&nbsp;case)&nbsp;is&nbsp;not&nbsp;part&nbsp;of&nbsp;the&nbsp;signed&nbsp;data&lt;br&gt;<br>
of&nbsp;the&nbsp;CRL&nbsp;(e.g.&nbsp;its&nbsp;common&nbsp;to&nbsp;have&nbsp;unauthenticated&nbsp;attributes&nbsp;in&nbsp;ASN.1&lt;br&gt;<br>
structures).&nbsp;This&nbsp;*could*&nbsp;be&nbsp;the&nbsp;case&nbsp;here&nbsp;(can&amp;#39;t&nbsp;be&nbsp;sure&nbsp;without&nbsp;the&lt;br&gt;<br>
actual&nbsp;data).&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;cannot&nbsp;provide&nbsp;the&nbsp;CRL,&nbsp;however&nbsp;any&nbsp;pointers&nbsp;on&nbsp;what&nbsp;could&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;causing&nbsp;this&nbsp;would&nbsp;be&nbsp;really&nbsp;helpful.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;You&nbsp;can:&lt;br&gt;<br>
&lt;br&gt;<br>
(a)&nbsp;try&nbsp;loading&nbsp;the&nbsp;CRL&nbsp;into&nbsp;asn1view&nbsp;(windows&nbsp;freeware)&nbsp;or&nbsp;gasnview&lt;br&gt;<br>
(.net&nbsp;application&nbsp;in&nbsp;mono-tools,&nbsp;which&nbsp;requires&nbsp;gtk#)&nbsp;and&nbsp;look&nbsp;at&nbsp;what&lt;br&gt;<br>
data&nbsp;exists&nbsp;at&nbsp;position&nbsp;69134&lt;br&gt;<br>
&lt;br&gt;<br>
(b)&nbsp;load&nbsp;the&nbsp;CRL&nbsp;manually&nbsp;and&nbsp;copy&nbsp;it&nbsp;into&nbsp;a&nbsp;byte[]&nbsp;array&nbsp;that&nbsp;is&nbsp;one&lt;br&gt;<br>
byte&nbsp;larger&nbsp;than&nbsp;the&nbsp;original&nbsp;one&nbsp;-&nbsp;that&nbsp;will&nbsp;validate&nbsp;the&nbsp;above&nbsp;theory.&lt;br&gt;<br>
That&amp;#39;s&nbsp;a&nbsp;lame&nbsp;workaround&nbsp;since&nbsp;it&amp;#39;s&nbsp;specific&nbsp;to&nbsp;the&nbsp;current&nbsp;CRL&nbsp;you&lt;br&gt;<br>
have.&lt;br&gt;<br>
&lt;br&gt;<br>
(c)&nbsp;open&nbsp;a&nbsp;bug&nbsp;report&nbsp;at&nbsp;&lt;a&nbsp;href=&quot;http://bugzilla.novell.com&quot;&nbsp;target=&quot;_blank&quot;&gt;bugzilla.novell.com&lt;/a&gt;&nbsp;and&nbsp;attach&nbsp;the&nbsp;CRL&nbsp;as&nbsp;a&lt;br&gt;<br>
private&nbsp;attachment&nbsp;(only&nbsp;Novell&nbsp;employees&nbsp;will&nbsp;see&nbsp;it)&lt;br&gt;<br>
&lt;br&gt;<br>
﻿(d)&nbsp;open&nbsp;a&nbsp;bug&nbsp;report&nbsp;at&nbsp;&lt;a&nbsp;href=&quot;http://bugzilla.novell.com&quot;&nbsp;target=&quot;_blank&quot;&gt;bugzilla.novell.com&lt;/a&gt;&nbsp;and&nbsp;attach&nbsp;the&nbsp;CRL&nbsp;and&lt;br&gt;<br>
email&nbsp;me&nbsp;the&nbsp;CRL&nbsp;separately&nbsp;(only&nbsp;I&nbsp;will&nbsp;see&nbsp;it)&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
Sebastien&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Jono&lt;br&gt;<br>

</tt>
