Index: SqlConnectionPool.cs
===================================================================
RCS file: /mono/mcs/class/System.Data/System.Data.SqlClient/SqlConnectionPool.cs,v
retrieving revision 1.3
diff -u -r1.3 SqlConnectionPool.cs
--- SqlConnectionPool.cs	21 Nov 2002 16:55:20 -0000	1.3
+++ SqlConnectionPool.cs	18 Aug 2003 15:12:22 -0000
@@ -139,7 +139,22 @@
 
 		public void ReleaseConnection (ITds tds)
 		{
-			Monitor.Exit (tds);
+			// Check if connection is still valid
+			try
+			{
+				// Send dummy statement to check connection
+				tds.Execute("select 1");
+			}
+			catch
+			{
+				// Remove invalid connection
+				list.Remove(tds);
+			}
+			finally
+			{
+				// Release lock
+				Monitor.Exit (tds);
+			}
 		}
 
 		public int IndexOf (object o)
