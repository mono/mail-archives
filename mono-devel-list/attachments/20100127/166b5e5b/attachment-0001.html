<tt>
Hi&nbsp;Leszek,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;patch&nbsp;breaks&nbsp;OSX&nbsp;as&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;define &lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;&quot;&gt;B460800.&nbsp;Is&nbsp;guarding&nbsp;the&nbsp;case&nbsp;entry&nbsp;if&nbsp;a&nbsp;&amp;quot;#if&nbsp;defined&nbsp;(B460800)&amp;quot;&nbsp;the&nbsp;right&nbsp;way&nbsp;to&nbsp;fix&nbsp;it?&lt;/span&gt;&lt;/div&gt;<br>
&lt;meta&nbsp;charset=&quot;utf-8&quot;&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;Thanks,&lt;/div&gt;&lt;div&gt;Rodrigo&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;Fri,&nbsp;Jan&nbsp;22,&nbsp;2010&nbsp;at&nbsp;8:30&nbsp;AM,&nbsp;Leszek&nbsp;Ciesielski&nbsp;(&lt;a&nbsp;href=&quot;mailto:skolima@gmail.com&quot;&gt;skolima@gmail.com&lt;/a&gt;)&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mono-patches-list@lists.ximian.com&quot;&gt;mono-patches-list@lists.ximian.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Author:&nbsp;leszek&lt;br&gt;<br>
Date:&nbsp;2010-01-22&nbsp;05:30:08&nbsp;-0500&nbsp;(Fri,&nbsp;22&nbsp;Jan&nbsp;2010)&lt;br&gt;<br>
New&nbsp;Revision:&nbsp;150061&lt;br&gt;<br>
&lt;br&gt;<br>
Modified:&lt;br&gt;<br>
&nbsp; &nbsp;trunk/mono/support/ChangeLog&lt;br&gt;<br>
&nbsp; &nbsp;trunk/mono/support/serial.c&lt;br&gt;<br>
Log:&lt;br&gt;<br>
2010-01-22&nbsp;Leszek&nbsp;Ciesielski&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:skolima@gmail.com&quot;&gt;skolima@gmail.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; *&nbsp;serial.c:&nbsp;baud&nbsp;rate&nbsp;460800&nbsp;by&nbsp;Thad&nbsp;Thompson&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:TThompson@nucsafe.com&quot;&gt;TThompson@nucsafe.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; *&nbsp;serial.c:&nbsp;report&nbsp;errors&nbsp;from&nbsp;every&nbsp;function&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Modified:&nbsp;trunk/mono/support/ChangeLog&lt;br&gt;<br>
===================================================================&lt;br&gt;<br>
---&nbsp;trunk/mono/support/ChangeLog&nbsp; &nbsp; &nbsp; &nbsp; 2010-01-22&nbsp;09:49:07&nbsp;UTC&nbsp;(rev&nbsp;150060)&lt;br&gt;<br>
+++&nbsp;trunk/mono/support/ChangeLog&nbsp; &nbsp; &nbsp; &nbsp; 2010-01-22&nbsp;10:30:08&nbsp;UTC&nbsp;(rev&nbsp;150061)&lt;br&gt;<br>
@@&nbsp;-1,3&nbsp;+1,8&nbsp;@@&lt;br&gt;<br>
+2010-01-22&nbsp;Leszek&nbsp;Ciesielski&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:skolima@gmail.com&quot;&gt;skolima@gmail.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
+&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp;*&nbsp;serial.c:&nbsp;baud&nbsp;rate&nbsp;460800&nbsp;by&nbsp;Thad&nbsp;Thompson&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:TThompson@nucsafe.com&quot;&gt;TThompson@nucsafe.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp;*&nbsp;serial.c:&nbsp;report&nbsp;errors&nbsp;from&nbsp;every&nbsp;function&lt;br&gt;<br>
+&lt;br&gt;<br>
 2009-12-16&nbsp;Gonzalo&nbsp;Paniagua&nbsp;Javier&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:gonzalo@novell.com&quot;&gt;gonzalo@novell.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; *&nbsp;zlib-helper.c:&nbsp;when&nbsp;finishing&nbsp;uncompressing&nbsp;a&nbsp;buffer,&nbsp;we&nbsp;might&nbsp;need&lt;br&gt;<br>
&lt;br&gt;<br>
Modified:&nbsp;trunk/mono/support/serial.c&lt;br&gt;<br>
===================================================================&lt;br&gt;<br>
---&nbsp;trunk/mono/support/serial.c&nbsp;2010-01-22&nbsp;09:49:07&nbsp;UTC&nbsp;(rev&nbsp;150060)&lt;br&gt;<br>
+++&nbsp;trunk/mono/support/serial.c&nbsp;2010-01-22&nbsp;10:30:08&nbsp;UTC&nbsp;(rev&nbsp;150061)&lt;br&gt;<br>
@@&nbsp;-66,9&nbsp;+66,6&nbsp;@@&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; int&nbsp;fd;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; fd&nbsp;=&nbsp;open&nbsp;(devfile,&nbsp;O_RDWR&nbsp;|&nbsp;O_NOCTTY&nbsp;|&nbsp;O_NONBLOCK);&lt;br&gt;<br>
&lt;br&gt;<br>
-&nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;(fd&nbsp;==&nbsp;-1)&lt;br&gt;<br>
-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;-1;&lt;br&gt;<br>
-&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;fd;&lt;br&gt;<br>
 }&lt;br&gt;<br>
&lt;br&gt;<br>
@@&nbsp;-128,10&nbsp;+125,10&nbsp;@@&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;0;&lt;br&gt;<br>
 }&lt;br&gt;<br>
&lt;br&gt;<br>
-void&lt;br&gt;<br>
+int&lt;br&gt;<br>
 discard_buffer&nbsp;(int&nbsp;fd,&nbsp;gboolean&nbsp;input)&lt;br&gt;<br>
 {&lt;br&gt;<br>
-&nbsp; &nbsp; &nbsp; &nbsp;tcflush(fd,&nbsp;input&nbsp;?&nbsp;TCIFLUSH&nbsp;:&nbsp;TCOFLUSH);&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;tcflush(fd,&nbsp;input&nbsp;?&nbsp;TCIFLUSH&nbsp;:&nbsp;TCOFLUSH);&lt;br&gt;<br>
 }&lt;br&gt;<br>
&lt;br&gt;<br>
 gint32&lt;br&gt;<br>
@@&nbsp;-151,7&nbsp;+148,9&nbsp;@@&lt;br&gt;<br>
 {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; struct&nbsp;termios&nbsp;newtio;&lt;br&gt;<br>
&lt;br&gt;<br>
-&nbsp; &nbsp; &nbsp; &nbsp;tcgetattr&nbsp;(fd,&nbsp;&amp;amp;newtio);&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;(tcgetattr&nbsp;(fd,&nbsp;&amp;amp;newtio)&nbsp;==&nbsp;-1)&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;FALSE;&lt;br&gt;<br>
+&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; newtio.c_cflag&nbsp;|=&nbsp; (CLOCAL&nbsp;|&nbsp;CREAD);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; newtio.c_lflag&nbsp;&amp;amp;=&nbsp;~(ICANON&nbsp;|&nbsp;ECHO&nbsp;|&nbsp;ECHOE&nbsp;|&nbsp;ECHOK&nbsp;|&nbsp;ECHONL&nbsp;|&nbsp;ISIG&nbsp;|&nbsp;IEXTEN&nbsp;);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; newtio.c_oflag&nbsp;&amp;amp;=&nbsp;~(OPOST);&lt;br&gt;<br>
@@&nbsp;-160,6&nbsp;+159,9&nbsp;@@&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; /*&nbsp;setup&nbsp;baudrate&nbsp;*/&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; switch&nbsp;(baud_rate)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp;case&nbsp;460800:&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;baud_rate&nbsp;=&nbsp;B460800;&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; case&nbsp;230400:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; baud_rate&nbsp;=&nbsp;B230400;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&lt;br&gt;<br>
@@&nbsp;-398,10&nbsp;+400,10&nbsp;@@&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;1;&lt;br&gt;<br>
 }&lt;br&gt;<br>
&lt;br&gt;<br>
-void&lt;br&gt;<br>
+int&lt;br&gt;<br>
 breakprop&nbsp;(int&nbsp;fd)&lt;br&gt;<br>
 {&lt;br&gt;<br>
-&nbsp; &nbsp; &nbsp; &nbsp;tcsendbreak&nbsp;(fd,&nbsp;0);&lt;br&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;tcsendbreak&nbsp;(fd,&nbsp;0);&lt;br&gt;<br>
 }&lt;br&gt;<br>
&lt;br&gt;<br>
 gboolean&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-patches&nbsp;maillist&nbsp; -&nbsp; &lt;a&nbsp;href=&quot;mailto:Mono-patches@lists.ximian.com&quot;&gt;Mono-patches@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-patches&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-patches&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
