Index: NpgsqlTypesHelper.cs
===================================================================
RCS file: /cvs/public/mcs/class/Npgsql/NpgsqlTypes/NpgsqlTypesHelper.cs,v
retrieving revision 1.3
diff -u -u -b -r1.3 NpgsqlTypesHelper.cs
--- NpgsqlTypesHelper.cs	15 Jul 2003 00:27:34 -0000	1.3
+++ NpgsqlTypesHelper.cs	23 Oct 2003 07:56:45 -0000
@@ -26,6 +26,7 @@
 using System.Collections;
 using System.Globalization;
 using System.Data;
+using System.Text;
 using Npgsql;
 
 
@@ -135,6 +136,9 @@
 				case DbType.Time:
 				  return "'" + ((DateTime)parameter.Value).ToString("HH:mm:ss.ffff") + "'";
 					
+                        case DbType.Binary:
+                                return GetBinaryString ((byte[]) parameter.Value);
+
 				default:
 					// This should not happen!
 					throw new NpgsqlException(String.Format("This type {0} isn't supported yet.", parameter.DbType));
@@ -358,6 +362,32 @@
 			
 		}
 		
+                private static string GetBinaryString (Byte[] value)
+                {
+                        StringBuilder res = new StringBuilder ();
+
+                        res.Append ('\'');
+                        foreach (int b in value) {
+                                res.Append ('\\');
+                                switch (b) {
+                                case 0:
+                                case 39:
+                                case 92:
+                                        res.Append ('\\');
+                                        break;
+                                }
+                                if (b < 10)
+                                        res.Append ("00");
+                                else if (b < 100)
+                                        res.Append ("0");
+
+                                res.Append (b);
+                        }
+                        res.Append ('\'');
+
+                        return res.ToString ();
+                }
+
 	}
 	
 }
