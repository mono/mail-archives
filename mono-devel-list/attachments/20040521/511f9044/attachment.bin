Index: x86-codegen.h
===================================================================
RCS file: /cvs/public/mono/mono/arch/x86/x86-codegen.h,v
retrieving revision 1.39
diff -u -r1.39 x86-codegen.h
--- x86-codegen.h	25 Jun 2003 13:18:00 -0000	1.39
+++ x86-codegen.h	22 May 2004 02:37:59 -0000
@@ -487,18 +487,17 @@
 
 #define x86_alu_reg_imm(inst,opc,reg,imm) 	\
 	do {	\
-		if ((reg) == X86_EAX) {	\
-			*(inst)++ = (((unsigned char)(opc)) << 3) + 5;	\
-			x86_imm_emit32 ((inst), (imm));	\
-			break;	\
-		}	\
 		if (x86_is_imm8((imm))) {	\
 			*(inst)++ = (unsigned char)0x83;	\
 			x86_reg_emit ((inst), (opc), (reg));	\
 			x86_imm_emit8 ((inst), (imm));	\
 		} else {	\
-			*(inst)++ = (unsigned char)0x81;	\
-			x86_reg_emit ((inst), (opc), (reg));	\
+			if ((reg) == X86_EAX) {	\
+				*(inst)++ = (((unsigned char)(opc)) << 3) + 5; \
+			} else { \
+				*(inst)++ = (unsigned char)0x81;	\
+				x86_reg_emit ((inst), (opc), (reg));	\
+			} \
 			x86_imm_emit32 ((inst), (imm));	\
 		}	\
 	} while (0)
