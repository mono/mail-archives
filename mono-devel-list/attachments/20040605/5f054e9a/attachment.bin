? diff.patch
? icall.patch
Index: ChangeLog
===================================================================
RCS file: /cvs/public/mono/mono/metadata/ChangeLog,v
retrieving revision 1.1645
diff -u -r1.1645 ChangeLog
--- ChangeLog	5 Jun 2004 19:16:29 -0000	1.1645
+++ ChangeLog	5 Jun 2004 21:48:12 -0000
@@ -1,3 +1,9 @@
+2004-06-05  Joshua Tauberer <tauberer@for.net>
+
+	* icall.c: ves_icall_MonoField_[Get/Set]ValueInternal did not
+	handle getting/setting MONO_TYPE_GENERICINST objects.
+	* object.c: similarly for set_value
+
 2004-06-05  Sebastien Pouliot  <sebastien@ximian.com>
 
 	* object.c: Fixed possible integer overflow when allocating large
Index: icall.c
===================================================================
RCS file: /cvs/public/mono/mono/metadata/icall.c,v
retrieving revision 1.491
diff -u -r1.491 icall.c
--- icall.c	5 Jun 2004 10:42:37 -0000	1.491
+++ icall.c	5 Jun 2004 21:48:12 -0000
@@ -1249,6 +1249,7 @@
 	switch (cf->type->type) {
 	case MONO_TYPE_STRING:
 	case MONO_TYPE_OBJECT:
+	case MONO_TYPE_GENERICINST:
 	case MONO_TYPE_CLASS:
 	case MONO_TYPE_ARRAY:
 	case MONO_TYPE_SZARRAY:
@@ -1337,6 +1338,7 @@
 			break;
 		case MONO_TYPE_STRING:
 		case MONO_TYPE_OBJECT:
+		case MONO_TYPE_GENERICINST:
 		case MONO_TYPE_CLASS:
 		case MONO_TYPE_ARRAY:
 		case MONO_TYPE_SZARRAY:
Index: object.c
===================================================================
RCS file: /cvs/public/mono/mono/metadata/object.c,v
retrieving revision 1.213
diff -u -r1.213 object.c
--- object.c	5 Jun 2004 19:16:29 -0000	1.213
+++ object.c	5 Jun 2004 21:48:12 -0000
@@ -1020,6 +1020,7 @@
 	case MONO_TYPE_SZARRAY:
 	case MONO_TYPE_CLASS:
 	case MONO_TYPE_OBJECT:
+	case MONO_TYPE_GENERICINST:
 	case MONO_TYPE_ARRAY:
 	case MONO_TYPE_PTR: {
 		gpointer *p = (gpointer*)dest;
