Index: SerialPort.cs
===================================================================
--- SerialPort.cs	(revision 90504)
+++ SerialPort.cs	(working copy)
@@ -25,6 +25,7 @@
 using System.Diagnostics;
 using System.Text;
 using System.Runtime.InteropServices;
+using Microsoft.Win32;
 
 namespace System.IO.Ports
 {
@@ -59,8 +60,6 @@
 		object error_received = new object ();
 		object data_received = new object ();
 		object pin_changed = new object ();
-		
-		static string default_port_name = "ttyS0";
 
 		public SerialPort () : 
 			this (GetDefaultPortName (), DefaultBaudRate, DefaultParity, DefaultDataBits, DefaultStopBits)
@@ -103,7 +102,14 @@
 
 		static string GetDefaultPortName ()
 		{
-			return default_port_name;
+			int p = (int) Environment.OSVersion.Platform;
+			if (p == 4 || p == 128) {
+				// Using Unix
+				return "ttyS0";
+			} else {
+				// Using Windows
+				return "COM1";
+			}
 		}
 
 		[Browsable (false)]
@@ -510,26 +516,31 @@
 		{
 			return new NotImplementedException ("Detection of ports is not implemented for this platform yet.");
 		}
-
+		
 		public static string [] GetPortNames ()
 		{
 			int p = (int) Environment.OSVersion.Platform;
+			List<string> serial_ports = new List<string>();
 			
 			// Are we on Unix?
-			if (p == 4 || p == 128){
-				string [] ttys = Directory.GetFiles ("/dev/", "tty*");
-				List<string> serial_ports = new List<string> ();
-				
-				foreach (string dev in ttys){
-					if (dev.StartsWith ("/dev/ttyS") || dev.StartsWith ("/dev/ttyUSB"))
-						serial_ports.Add (dev);
-						
+			if (p == 4 || p == 128) {
+				string[] ttys = Directory.GetFiles("/dev/", "tty*");
+				foreach (string dev in ttys) {
+					if (dev.StartsWith("/dev/ttyS") || dev.StartsWith("/dev/ttyUSB"))
+						serial_ports.Add(dev);
 				}
-				return serial_ports.ToArray ();
+			} else {
+				RegistryKey subkey = Registry.LocalMachine.OpenSubKey("HARDWARE\\DEVICEMAP\\SERIALCOMM");
+				string[] names = subkey.GetValueNames();
+				foreach (string value in names) {
+					string port = subkey.GetValue(value, "").ToString();
+					if (port != "")
+						serial_ports.Add(port);
+				}
 			}
-			throw GetNotImplemented ();
+			return serial_ports.ToArray();
 		}
-
+		
 		static bool IsWindows {
 			get {
 				PlatformID id =  Environment.OSVersion.Platform;
