<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Exchange&nbsp;Server&quot;&gt;<br>
&lt;!--&nbsp;converted&nbsp;from&nbsp;text&nbsp;--&gt;&lt;style&gt;&lt;!--&nbsp;.EmailQuote&nbsp;{&nbsp;margin-left:&nbsp;1pt;&nbsp;padding-left:&nbsp;4pt;&nbsp;border-left:&nbsp;#800000&nbsp;2px&nbsp;solid;&nbsp;}&nbsp;--&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&lt;style&nbsp;type=&quot;text/css&quot;&nbsp;style=&quot;&quot;&gt;<br>
&lt;!--<br>
p<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-top:0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:0}<br>
--&gt;<br>
&lt;/style&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;id=&quot;x_divtagdefaultwrapper&quot;&nbsp;dir=&quot;ltr&quot;&nbsp;style=&quot;font-size:12pt;&nbsp;color:#000000;&nbsp;font-family:Calibri,Arial,Helvetica,sans-serif&quot;&gt;<br>
&lt;p&gt;If&nbsp;we&nbsp;ever&nbsp;build&nbsp;this,&nbsp;I&nbsp;do&nbsp;not&nbsp;think&nbsp;it&nbsp;should&nbsp;be&nbsp;AOT&nbsp;only.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;Inline&nbsp;assembly&nbsp;in&nbsp;a&nbsp;method&nbsp;has&nbsp;the&nbsp;problems&nbsp;that&nbsp;you&nbsp;outlined,&nbsp;namely&nbsp;that&nbsp;we&nbsp;do&nbsp;need&nbsp;to&nbsp;sort&nbsp;out&nbsp;input/output/clobbers.&nbsp;&nbsp;&nbsp;By&nbsp;isolating&nbsp;this&nbsp;to&nbsp;a&nbsp;method,&nbsp;we&nbsp;can&nbsp;just&nbsp;say&nbsp;&quot;These&nbsp;are&nbsp;the&nbsp;Mono&nbsp;calling&nbsp;conventions,&nbsp;follow&nbsp;these&quot;.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;The&nbsp;inline&nbsp;method&nbsp;as&nbsp;well&nbsp;as&nbsp;my&nbsp;original&nbsp;proposal&nbsp;have&nbsp;one&nbsp;advantage:&nbsp;both&nbsp;of&nbsp;them&nbsp;can&nbsp;be&nbsp;implemented&nbsp;without&nbsp;requiring&nbsp;changes&nbsp;to&nbsp;the&nbsp;metadata&nbsp;format,&nbsp;the&nbsp;former&nbsp;by&nbsp;having&nbsp;the&nbsp;JIT&nbsp;recognize&nbsp;a&nbsp;special&nbsp;method&nbsp;call&nbsp;sequence,&nbsp;and&nbsp;the&nbsp;latter&nbsp;by&nbsp;leveraging&nbsp;the<br>
&nbsp;existing&nbsp;mixed-mode&nbsp;execution&nbsp;that&nbsp;is&nbsp;supported&nbsp;in&nbsp;the&nbsp;file&nbsp;format.&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;Your&nbsp;new&nbsp;proposal&nbsp;would&nbsp;allow&nbsp;us&nbsp;to&nbsp;provide&nbsp;multiple&nbsp;implementations,&nbsp;but&nbsp;would&nbsp;require&nbsp;either&nbsp;a&nbsp;file&nbsp;format&nbsp;change.&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
Perhaps&nbsp;what&nbsp;we&nbsp;could&nbsp;do&nbsp;is&nbsp;flag&nbsp;the&nbsp;method&nbsp;with&nbsp;&quot;RTSPECIALNAME&quot;&nbsp;or&nbsp;&quot;SPECIALNAME&quot;&nbsp;when&nbsp;we&nbsp;do&nbsp;inline&nbsp;assembly,&nbsp;and&nbsp;only&nbsp;when&nbsp;this&nbsp;flag&nbsp;is&nbsp;set,&nbsp;we&nbsp;could&nbsp;trigger&nbsp;a&nbsp;slower&nbsp;method&nbsp;lookup&nbsp;system&nbsp;that&nbsp;lookups&nbsp;the&nbsp;real&nbsp;method&nbsp;based&nbsp;on&nbsp;the&nbsp;architecture.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;So&nbsp;you&nbsp;would&nbsp;write:&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;public&nbsp;unsafe&nbsp;asm(x86)&nbsp;ReturnOne&nbsp;()&nbsp;{&nbsp;movl&nbsp;$1,&nbsp;%rax&nbsp;}&lt;/p&gt;<br>
&lt;p&gt;&lt;span&nbsp;style=&quot;font-family:Calibri,Arial,Helvetica,sans-serif,EmojiFont,&quot;Apple&nbsp;Color&nbsp;Emoji&quot;,&quot;Segoe&nbsp;UI&nbsp;Emoji&quot;,NotoColorEmoji,&quot;Segoe&nbsp;UI&nbsp;Symbol&quot;,&quot;Android&nbsp;Emoji&quot;,EmojiSymbols;&nbsp;font-size:16px&quot;&gt;public&nbsp;unsafe&nbsp;asm(ppc)&nbsp;ReturnOne&nbsp;()&nbsp;{&nbsp;li&nbsp;r3,&nbsp;1&nbsp;}&lt;/span&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;&lt;span&nbsp;style=&quot;font-family:Calibri,Arial,Helvetica,sans-serif,EmojiFont,&quot;Apple&nbsp;Color&nbsp;Emoji&quot;,&quot;Segoe&nbsp;UI&nbsp;Emoji&quot;,NotoColorEmoji,&quot;Segoe&nbsp;UI&nbsp;Symbol&quot;,&quot;Android&nbsp;Emoji&quot;,EmojiSymbols;&nbsp;font-size:16px&quot;&gt;public&nbsp;unsafe&nbsp;asm(default)&nbsp;ReturnOne&nbsp;()&nbsp;{&nbsp;return&nbsp;1;&nbsp;}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&nbsp;style=&quot;font-family:Calibri,Arial,Helvetica,sans-serif,EmojiFont,&quot;Apple&nbsp;Color&nbsp;Emoji&quot;,&quot;Segoe&nbsp;UI&nbsp;Emoji&quot;,NotoColorEmoji,&quot;Segoe&nbsp;UI&nbsp;Symbol&quot;,&quot;Android&nbsp;Emoji&quot;,EmojiSymbols;&nbsp;font-size:16px&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;The&nbsp;compiler&nbsp;would&nbsp;generate&nbsp;x86_ReturnOne,&nbsp;ppc_ReturnOne&nbsp;and&nbsp;ReturnOne,&nbsp;the&nbsp;last&nbsp;one&nbsp;with&nbsp;&quot;SPECIALNAME&quot;&nbsp;set&nbsp;and&nbsp;an&nbsp;attribute&nbsp;[AsmImplementations(x86,ppc)]&nbsp;which&nbsp;would&nbsp;trigger&nbsp;the&nbsp;runtime&nbsp;to&nbsp;resolve&nbsp;the&nbsp;call&nbsp;to&nbsp;the&nbsp;right&nbsp;method.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;That&nbsp;sounds&nbsp;like&nbsp;it&nbsp;would&nbsp;address&nbsp;all&nbsp;the&nbsp;requirements.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;div&nbsp;id=&quot;x_Signature&quot;&gt;<br>
&lt;p&gt;Sent&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;http://aka.ms/weboutlook&quot;&nbsp;id=&quot;LPNoLP&quot;&gt;Outlook&lt;/a&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;hr&nbsp;tabindex=&quot;-1&quot;&nbsp;style=&quot;display:inline-block;&nbsp;width:98%&quot;&gt;<br>
&lt;div&nbsp;id=&quot;x_divRplyFwdMsg&quot;&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&nbsp;color=&quot;#000000&quot;&nbsp;style=&quot;font-size:11pt&quot;&gt;&lt;b&gt;From:&lt;/b&gt;&nbsp;Jon&nbsp;Purdy&lt;br&gt;<br>
&lt;b&gt;Sent:&lt;/b&gt;&nbsp;Friday,&nbsp;June&nbsp;2,&nbsp;2017&nbsp;4:49:04&nbsp;PM&lt;br&gt;<br>
&lt;b&gt;To:&lt;/b&gt;&nbsp;Miguel&nbsp;de&nbsp;Icaza&lt;br&gt;<br>
&lt;b&gt;Cc:&lt;/b&gt;&nbsp;mono-devel-list@lists.dot.net&lt;br&gt;<br>
&lt;b&gt;Subject:&lt;/b&gt;&nbsp;Re:&nbsp;[Mono-dev]&nbsp;Inline&nbsp;assembly&nbsp;in&nbsp;C#&lt;/font&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10pt;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;PlainText&quot;&gt;Would&nbsp;this&nbsp;be&nbsp;AOT-only?&nbsp;And&nbsp;should&nbsp;a&nbsp;method&nbsp;be&nbsp;allowed&nbsp;to&nbsp;contain&nbsp;a&nbsp;mix&nbsp;of&lt;br&gt;<br>
inline&nbsp;assembly&nbsp;and&nbsp;managed&nbsp;code?&nbsp;These&nbsp;greatly&nbsp;affect&nbsp;whatever&nbsp;design&nbsp;we&lt;br&gt;<br>
might&nbsp;come&nbsp;up&nbsp;with.&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;assembly&nbsp;can&nbsp;appear&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;managed&nbsp;method,&nbsp;you&nbsp;need&nbsp;something&lt;br&gt;<br>
like&nbsp;the&nbsp;GCC&nbsp;extended&nbsp;asm&nbsp;notation&nbsp;so&nbsp;you&nbsp;can&nbsp;specify&nbsp;inputs,&nbsp;outputs,&nbsp;and&lt;br&gt;<br>
clobbers&nbsp;to&nbsp;determine&nbsp;things&nbsp;like&nbsp;addressing&nbsp;modes&nbsp;and&nbsp;register&nbsp;allocation&lt;br&gt;<br>
for&nbsp;the&nbsp;surrounding&nbsp;code.&nbsp;It¹s&nbsp;also&nbsp;useful&nbsp;to&nbsp;have&nbsp;³volatile²&nbsp;(don¹t&nbsp;move&lt;br&gt;<br>
this)&nbsp;and&nbsp;³goto²&nbsp;(may&nbsp;jump&nbsp;to&nbsp;managed&nbsp;label),&nbsp;but&nbsp;these&nbsp;are&nbsp;maybe&nbsp;less&lt;br&gt;<br>
critical.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;would&nbsp;be&nbsp;in&nbsp;favor&nbsp;of&nbsp;the&nbsp;simpler&nbsp;alternative&nbsp;of&nbsp;restricting&nbsp;inline&lt;br&gt;<br>
assembly&nbsp;to&nbsp;a&nbsp;whole&nbsp;method:&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;unsafe&nbsp;__asm__(x86_64)&nbsp;int&nbsp;ReturnOne&nbsp;()&nbsp;&nbsp;{&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;movl&nbsp;$1,&nbsp;%rax&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;unsafe&nbsp;__asm__(ppc)&nbsp;int&nbsp;ReturnOne&nbsp;()&nbsp;{&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;li&nbsp;r3,&nbsp;1&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;__asm__&nbsp;int&nbsp;ReturnOne&nbsp;()&nbsp;{&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;idea&nbsp;is&nbsp;that&nbsp;when&nbsp;you&nbsp;compile&nbsp;(AOT)&nbsp;or&nbsp;load&#43;compile&nbsp;(JIT)&nbsp;this&lt;br&gt;<br>
assembly&nbsp;on&nbsp;x86-64,&nbsp;the&nbsp;__asm__(x86_64)&nbsp;method&nbsp;is&nbsp;selected&nbsp;and&nbsp;the&lt;br&gt;<br>
__asm__(ppc)&nbsp;method&nbsp;is&nbsp;ignored&nbsp;entirely;&nbsp;if&nbsp;you¹re&nbsp;compiling&nbsp;on&nbsp;neither&lt;br&gt;<br>
x86-64&nbsp;nor&nbsp;PowerPC,&nbsp;the&nbsp;managed&nbsp;fallback&nbsp;is&nbsp;chosen.&nbsp;I&nbsp;suppose&nbsp;the&nbsp;fallback&lt;br&gt;<br>
could&nbsp;also&nbsp;be&nbsp;written&nbsp;in&nbsp;IL:&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;unsafe&nbsp;__asm__(cil)&nbsp;int&nbsp;ReturnOne&nbsp;()&nbsp;{&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ldc.i4&nbsp;1&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ret&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
However,&nbsp;this&nbsp;comes&nbsp;at&nbsp;the&nbsp;cost&nbsp;of&nbsp;some&nbsp;expressiveness&nbsp;and&nbsp;inhibits&lt;br&gt;<br>
optimisations.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;6/1/17,&nbsp;6:59&nbsp;AM,&nbsp;&quot;Mono-devel-list&nbsp;on&nbsp;behalf&nbsp;of&nbsp;Miguel&nbsp;de&nbsp;Icaza&nbsp;via&lt;br&gt;<br>
Mono-devel-list&quot;&nbsp;&lt;mono-devel-list-bounces@lists.dot.net&nbsp;on&nbsp;behalf&nbsp;of&lt;br&gt;<br>
mono-devel-list@lists.dot.net&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;Hello,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;These&nbsp;are&nbsp;good&nbsp;observations.&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;we&nbsp;ever&nbsp;do&nbsp;this&nbsp;(I&nbsp;am&nbsp;not&nbsp;saying&nbsp;we&lt;br&gt;<br>
&gt;are,&nbsp;I&nbsp;just&nbsp;wanted&nbsp;to&nbsp;get&nbsp;this&nbsp;off&nbsp;my&nbsp;head),&nbsp;we&nbsp;would&nbsp;indeed&nbsp;require&lt;br&gt;<br>
&gt;assemblies&nbsp;for&nbsp;32/64&nbsp;on&nbsp;the&nbsp;same&nbsp;system.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;Any&nbsp;work&nbsp;that&nbsp;we&nbsp;did&nbsp;to&nbsp;support&nbsp;inline&nbsp;assembly&nbsp;would&nbsp;need&nbsp;some&nbsp;extra&lt;br&gt;<br>
&gt;work&nbsp;on&nbsp;the&nbsp;runtime,&nbsp;so&nbsp;adding&nbsp;support&nbsp;for&nbsp;mixed-mode&nbsp;execution&nbsp;would&lt;br&gt;<br>
&gt;fall&nbsp;into&nbsp;the&nbsp;sort&nbsp;of&nbsp;work&nbsp;we&nbsp;would&nbsp;need&nbsp;to&nbsp;do.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;Anyways,&nbsp;this&nbsp;is&nbsp;a&nbsp;very&nbsp;good&nbsp;catch,&nbsp;and&nbsp;it&nbsp;means&nbsp;that&nbsp;the&nbsp;original&nbsp;design&lt;br&gt;<br>
&gt;was&nbsp;probably&nbsp;best.&nbsp;&nbsp;&nbsp;And&nbsp;it&nbsp;is&nbsp;still&nbsp;an&nbsp;independent&nbsp;issue&nbsp;from&nbsp;having&nbsp;an&lt;br&gt;<br>
&gt;inline&nbsp;assembler&nbsp;in&nbsp;place.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;Miguel.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;On&nbsp;5/30/17,&nbsp;1:58&nbsp;PM,&nbsp;&quot;Vincent&nbsp;Povirk&quot;&nbsp;&lt;madewokherd@gmail.com&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Now&nbsp;that&nbsp;Mono&nbsp;is&nbsp;switching&nbsp;to&nbsp;platform-specific&nbsp;assemblies&nbsp;for&nbsp;the&lt;br&gt;<br>
&gt;core&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;assemblies&nbsp;as&nbsp;opposed&nbsp;to&nbsp;cross-platform&nbsp;assemblies&nbsp;that&nbsp;work&nbsp;across&lt;br&gt;<br>
&gt;Windows,&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Mac&nbsp;and&nbsp;Linux&nbsp;(a&nbsp;price&nbsp;we&nbsp;pay&nbsp;to&nbsp;converge&nbsp;with&nbsp;CoreFX)&nbsp;it&nbsp;made&nbsp;me&lt;br&gt;<br>
&gt;wonder&nbsp;if&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;we&nbsp;could&nbsp;not&nbsp;reuse&nbsp;instead&nbsp;the&nbsp;existing&nbsp;support&nbsp;for&nbsp;mixed-mode&lt;br&gt;<br>
&gt;assemblies&nbsp;in&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;the&nbsp;CLR.&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;What&nbsp;you're&nbsp;suggesting&nbsp;are&nbsp;architecture-specific&nbsp;assemblies,&nbsp;not&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;platform-specific.&nbsp;So&nbsp;you&nbsp;would&nbsp;be&nbsp;multiplying&nbsp;the&nbsp;platform&nbsp;variations&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;the&nbsp;set&nbsp;of&nbsp;architecture&nbsp;variations.&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;would&nbsp;be&nbsp;a&nbsp;problem&nbsp;for&nbsp;Wine&nbsp;Mono's&nbsp;use&nbsp;case.&nbsp;Currently&nbsp;we&nbsp;can&nbsp;use&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;set&nbsp;of&nbsp;class&nbsp;libraries&nbsp;with&nbsp;32-bit&nbsp;and&nbsp;64-bit&nbsp;Mono&nbsp;dll's.&nbsp;We&nbsp;would&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;need&nbsp;a&nbsp;mechanism&nbsp;to&nbsp;load&nbsp;some&nbsp;different&nbsp;class&nbsp;libraries&nbsp;based&nbsp;on&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;architecture.&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Essentially,&nbsp;instead&nbsp;of&nbsp;having&nbsp;inline&nbsp;assembly&nbsp;in&nbsp;the&nbsp;body&nbsp;of&nbsp;a&lt;br&gt;<br>
&gt;method,&nbsp;we&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;could&nbsp;define&nbsp;entire&nbsp;method&nbsp;as&nbsp;inline&nbsp;assembly,&nbsp;and&nbsp;set&nbsp;the&nbsp;method&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;implementation&nbsp;flags&nbsp;in&nbsp;the&nbsp;ECMA&nbsp;metadata&nbsp;to&nbsp;be&nbsp;native&nbsp;and&nbsp;point&nbsp;to&lt;br&gt;<br>
&gt;the&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;code.&nbsp;&nbsp;&nbsp;It&nbsp;is&nbsp;not&nbsp;as&nbsp;flexible,&nbsp;but&nbsp;would&nbsp;eliminate&nbsp;the&nbsp;need&nbsp;for&nbsp;a&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;post-processor,&nbsp;and&nbsp;would&nbsp;merely&nbsp;require&nbsp;the&nbsp;C#&nbsp;compiler&nbsp;to&nbsp;perform&lt;br&gt;<br>
&gt;the&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;assembly&nbsp;code&nbsp;generation&nbsp;and&nbsp;injection.&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;would&nbsp;also&nbsp;have&nbsp;to&nbsp;extend&nbsp;the&nbsp;Mono&nbsp;runtime&nbsp;to&nbsp;support&nbsp;mixed-mode&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;assemblies&nbsp;on&nbsp;non-Windows&nbsp;platforms.&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;_______________________________________________&lt;br&gt;<br>
&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;Mono-devel-list@lists.dot.net&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2Flists.dot&quot;&gt;https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2Flists.dot&lt;/a&gt;.&lt;br&gt;<br>
&gt;net%2Fmailman%2Flistinfo%2Fmono-devel-list&amp;data=02%7C01%7Cjopur%40microsof&lt;br&gt;<br>
&gt;t.com%7C8ded07862a7b48c9590608d4a8f667e9%7C72f988bf86f141af91ab2d7cd011db4&lt;br&gt;<br>
&gt;7%7C1%7C0%7C636319223645828454&amp;sdata=4JueGESfWp8sLKAYXKibnUTZQNu1NBcsPwmpB&lt;br&gt;<br>
&gt;lWtaTg%3D&amp;reserved=0&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/span&gt;&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
