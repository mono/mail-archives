<tt>
The&nbsp;mono_arch_flush_icache&nbsp;is&nbsp;wrong,&nbsp;it&nbsp;passes&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;end&lt;br&gt;of&nbsp;the&nbsp;code&nbsp;buffer&nbsp;and&nbsp;not&nbsp;to&nbsp;the&nbsp;beggining.&lt;br&gt;&lt;br&gt;It&nbsp;should&nbsp;be&nbsp;mono_arch_flush_icache&nbsp;(buf,&nbsp;code&nbsp;-&nbsp;buf);&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;11,&nbsp;2008&nbsp;at&nbsp;5:35&nbsp;PM,&nbsp;Cliff&nbsp;Brake&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:cliff.brake@gmail.com&quot;&gt;cliff.brake@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;I&nbsp;have&nbsp;traced&nbsp;it&nbsp;down&nbsp;to&nbsp;the&nbsp;kernel&nbsp;image.&nbsp;&amp;nbsp;The&nbsp;kernel&nbsp;that&nbsp;works&nbsp;is&lt;br&gt;<br>
virtually&nbsp;identical,&nbsp;but&nbsp;likely&nbsp;compiled&nbsp;with&nbsp;a&nbsp;older&nbsp;toolchain.&nbsp;&amp;nbsp;The&lt;br&gt;<br>
only&nbsp;other&nbsp;difference&nbsp;is&nbsp;a&nbsp;minor&nbsp;defconfig&nbsp;change&nbsp;with&nbsp;the&nbsp;MTD&lt;br&gt;<br>
partition&nbsp;setup.&lt;br&gt;<br>
&lt;br&gt;<br>
Tracing&nbsp;with&nbsp;gdb&nbsp;on&nbsp;the&nbsp;bad&nbsp;(more&nbsp;recent)&nbsp;kernel&nbsp;image,&nbsp;I&nbsp;get:&lt;br&gt;<br>
&lt;br&gt;<br>
Program&nbsp;received&nbsp;signal&nbsp;SIGILL,&nbsp;Illegal&nbsp;instruction.&lt;br&gt;<br>
mono_arch_flush_icache&nbsp;(code=0x0,&nbsp;size=&amp;lt;value&nbsp;optimized&nbsp;out&amp;gt;)&nbsp;at&nbsp;mini-arm.c:595&lt;br&gt;<br>
595&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
(gdb)&nbsp;bt&lt;br&gt;<br>
#0&nbsp;&amp;nbsp;mono_arch_flush_icache&nbsp;(code=0x0,&nbsp;size=&amp;lt;value&nbsp;optimized&nbsp;out&amp;gt;)&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;at&nbsp;mini-arm.c:595&lt;br&gt;<br>
#1&nbsp;&amp;nbsp;0x000d1a08&nbsp;in&nbsp;mono_arch_create_trampoline_code_full&nbsp;(&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;tramp_type=MONO_TRAMPOLINE_JIT,&nbsp;code_size=0xbeddde34,&nbsp;ji=0xbedddbbc,&nbsp;aot=0)&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;at&nbsp;tramp-arm.c:365&lt;br&gt;<br>
#2&nbsp;&amp;nbsp;0x000d1d0c&nbsp;in&nbsp;mono_arch_create_trampoline_code&nbsp;(&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;tramp_type=MONO_TRAMPOLINE_JIT)&nbsp;at&nbsp;tramp-arm.c:160&lt;br&gt;<br>
#3&nbsp;&amp;nbsp;0x000bce08&nbsp;in&nbsp;mono_trampolines_init&nbsp;()&nbsp;at&nbsp;mini-trampolines.c:691&lt;br&gt;<br>
#4&nbsp;&amp;nbsp;0x0001aa2c&nbsp;in&nbsp;mini_init&nbsp;(filename=0xbedddf17&nbsp;&amp;quot;test.exe&amp;quot;,&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;runtime_version=0x0)&nbsp;at&nbsp;mini.c:14310&lt;br&gt;<br>
#5&nbsp;&amp;nbsp;0x0009ff14&nbsp;in&nbsp;mono_main&nbsp;(argc=2,&nbsp;argv=0xbeddde34)&nbsp;at&nbsp;driver.c:1545&lt;br&gt;<br>
#6&nbsp;&amp;nbsp;0x401ed9cc&nbsp;in&nbsp;__libc_start_main&nbsp;()&nbsp;from&nbsp;/lib/libc.so.6&lt;br&gt;<br>
#7&nbsp;&amp;nbsp;0x00019214&nbsp;in&nbsp;_start&nbsp;()&lt;br&gt;<br>
&lt;br&gt;<br>
Looks&nbsp;like&nbsp;this&nbsp;could&nbsp;be&nbsp;a&nbsp;fun&nbsp;one&nbsp;to&nbsp;track&nbsp;down.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
Cliff&lt;br&gt;<br>
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;&lt;br&gt;<br>
On&nbsp;Thu,&nbsp;Dec&nbsp;11,&nbsp;2008&nbsp;at&nbsp;11:32&nbsp;AM,&nbsp;Cliff&nbsp;Brake&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:cliff.brake@gmail.com&quot;&gt;cliff.brake@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;appears&nbsp;I&nbsp;have&nbsp;some&nbsp;type&nbsp;of&nbsp;system&nbsp;problem&nbsp;as&nbsp;the&nbsp;2.2&nbsp;mono&nbsp;binaries&lt;br&gt;<br>
&amp;gt;&nbsp;run&nbsp;on&nbsp;a&nbsp;older&nbsp;rootfs,&nbsp;so&nbsp;I&amp;#39;m&nbsp;now&nbsp;tracking&nbsp;down&nbsp;what&nbsp;all&nbsp;has&nbsp;changed&lt;br&gt;<br>
&amp;gt;&nbsp;in&nbsp;the&nbsp;system.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;appears&nbsp;that&nbsp;VFP&nbsp;is&nbsp;the&nbsp;correct&nbsp;option&nbsp;as&nbsp;a&nbsp;simple&nbsp;floating&nbsp;point&lt;br&gt;<br>
&amp;gt;&nbsp;test&nbsp;app&nbsp;works.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Cliff&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;On&nbsp;Wed,&nbsp;Dec&nbsp;10,&nbsp;2008&nbsp;at&nbsp;5:47&nbsp;PM,&nbsp;Cliff&nbsp;Brake&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:cliff.brake@gmail.com&quot;&gt;cliff.brake@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Hello,&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;run&nbsp;mono&nbsp;2.2&nbsp;on&nbsp;ARM,&nbsp;and&nbsp;mono&nbsp;is&nbsp;crashing&nbsp;fairly&nbsp;early&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;(see&nbsp;attached).&nbsp;&amp;nbsp;Note,&nbsp;it&nbsp;has&nbsp;not&nbsp;accessed&nbsp;the&nbsp;test.exe&nbsp;file&nbsp;yet.&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Setup:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;PXA270&nbsp;CPU&nbsp;(armv5te)&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;fairly&nbsp;recent&nbsp;OE&nbsp;toolchain&nbsp;(EABI,&nbsp;&amp;nbsp;4.2.4)&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;hardcoded&nbsp;ARM_FPU_VFP=1&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Questions:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;1)&nbsp;has&nbsp;anyone&nbsp;run&nbsp;mono&nbsp;2.2&nbsp;on&nbsp;ARM?&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;2)&nbsp;is&nbsp;VFP&nbsp;the&nbsp;correct&nbsp;FP&nbsp;config?&nbsp;&amp;nbsp;I&nbsp;have&nbsp;tried&nbsp;soft-float&nbsp;as&nbsp;well&nbsp;with&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;the&nbsp;same&nbsp;result.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;3)&nbsp;any&nbsp;suggestions&nbsp;on&nbsp;how&nbsp;to&nbsp;debug&nbsp;this&nbsp;or&nbsp;what&nbsp;I&nbsp;should&nbsp;look&nbsp;at&nbsp;next.&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Thanks,&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Cliff&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;--&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;=======================&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Cliff&nbsp;Brake&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://bec-systems.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bec-systems.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;--&lt;br&gt;<br>
&amp;gt;&nbsp;=======================&lt;br&gt;<br>
&amp;gt;&nbsp;Cliff&nbsp;Brake&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://bec-systems.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bec-systems.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
=======================&lt;br&gt;<br>
Cliff&nbsp;Brake&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://bec-systems.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bec-systems.com&lt;/a&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
