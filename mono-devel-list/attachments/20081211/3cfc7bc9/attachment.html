<tt>
Hi&nbsp;Mark,&lt;br&gt;&lt;br&gt;Do&nbsp;you&nbsp;have&nbsp;an&nbsp;idea&nbsp;of&nbsp;how&nbsp;big&nbsp;such&nbsp;change&nbsp;would&nbsp;be?&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;Rodrigo&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;11,&nbsp;2008&nbsp;at&nbsp;1:21&nbsp;AM,&nbsp;Mark&nbsp;Mason&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mmason@upwardaccess.com&quot;&gt;mmason@upwardaccess.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Hello&nbsp;all,&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;current&nbsp;JIT&nbsp;code&nbsp;assumes&nbsp;that&nbsp;SIZEOF_VOID_P&nbsp;is&nbsp;also&nbsp;the&nbsp;size&nbsp;of&lt;br&gt;<br>
registers&nbsp;(as&nbsp;per&nbsp;the&nbsp;calling&nbsp;convention&nbsp;that&nbsp;we&amp;#39;re&nbsp;generating&nbsp;code&lt;br&gt;<br>
for).&nbsp;There&amp;#39;s&nbsp;a&nbsp;fair&nbsp;number&nbsp;of&nbsp;#if&nbsp;tests&nbsp;for&nbsp;this&nbsp;in&nbsp;the&nbsp;mono/mini&lt;br&gt;<br>
directory&nbsp;(as&nbsp;well&nbsp;as&nbsp;in&nbsp;a&nbsp;few&nbsp;others).&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;brings&nbsp;this&nbsp;up&nbsp;is&nbsp;porting&nbsp;to&nbsp;mips/n32,&nbsp;a&nbsp;calling&nbsp;convention&nbsp;which&lt;br&gt;<br>
uses&nbsp;the&nbsp;&amp;#39;usual&amp;#39;&nbsp;32-bit&nbsp;types&nbsp;for&nbsp;C&nbsp;language&nbsp;constructs:&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sizeof(int)&nbsp;=&nbsp;4&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sizeof(void&nbsp;*)&nbsp;=&nbsp;4&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sizeof(long)&nbsp;=&nbsp;4&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sizeof(float)&nbsp;=&nbsp;8&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sizeof(double)&nbsp;=&nbsp;8&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sizeof(long&nbsp;long)&nbsp;=&nbsp;8&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;where&nbsp;registers&nbsp;are&nbsp;64-bits&nbsp;instead&nbsp;of&nbsp;32-bits,&nbsp;and&nbsp;we&nbsp;need&nbsp;to&lt;br&gt;<br>
generate&nbsp;any&nbsp;number&nbsp;of&nbsp;64-bit&nbsp;operations&nbsp;under&nbsp;the&nbsp;hood&nbsp;for&nbsp;loads/stores&lt;br&gt;<br>
into&nbsp;stack&nbsp;slots,&nbsp;parameter&nbsp;passing,&nbsp;return&nbsp;values,&nbsp;etc.&lt;br&gt;<br>
&lt;br&gt;<br>
Since&nbsp;SIZEOF_VOID_P&nbsp;is&nbsp;still&nbsp;4&nbsp;on&nbsp;this&nbsp;target,&lt;br&gt;<br>
mono_decompose_long_opts()&nbsp;insists&nbsp;on&nbsp;breaking&nbsp;up&nbsp;long&nbsp;operands&nbsp;that&nbsp;I&amp;#39;d&lt;br&gt;<br>
rather&nbsp;stayed&nbsp;together.&nbsp;Rather&nbsp;than&nbsp;putting&nbsp;in&nbsp;a&nbsp;lot&nbsp;of&nbsp;MIPS&nbsp;specific&lt;br&gt;<br>
#ifdef&nbsp;tests&nbsp;in&nbsp;the&nbsp;generic&nbsp;code,&nbsp;ï»¿I&amp;#39;d&nbsp;like&nbsp;to&nbsp;suggest&nbsp;splitting&nbsp;the&lt;br&gt;<br>
current&nbsp;usage&nbsp;of&nbsp;SIZEOF_VOID_P&nbsp;--&nbsp;using&nbsp;SIZEOF_VOID_P&nbsp;to&nbsp;represent&nbsp;the&lt;br&gt;<br>
size&nbsp;of&nbsp;addresses,&nbsp;and&nbsp;a&nbsp;new&nbsp;define&nbsp;(SIZEOF_REGISTER&nbsp;maybe?)&nbsp;to&lt;br&gt;<br>
represent&nbsp;the&nbsp;size&nbsp;of&nbsp;general&nbsp;purpose&nbsp;machine&nbsp;registers.&nbsp;On&nbsp;most&nbsp;all&lt;br&gt;<br>
targets,&nbsp;SIZEOF_VOID_P&nbsp;==&nbsp;SIZEOF_REGISTER&nbsp;and&nbsp;everything&nbsp;will&nbsp;behave&nbsp;as&lt;br&gt;<br>
it&nbsp;does&nbsp;today.&nbsp;For&nbsp;mips/n32,&nbsp;SIZEOF_VOID_P=4,&nbsp;SIZEOF_REGISTER=8&nbsp;and&lt;br&gt;<br>
we&amp;#39;ll&nbsp;get&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;we&nbsp;want&nbsp;there.&lt;br&gt;<br>
&lt;br&gt;<br>
Thoughts?&nbsp;Does&nbsp;someone&nbsp;see&nbsp;a&nbsp;better&nbsp;way&nbsp;to&nbsp;handle&nbsp;this?&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;in&nbsp;advance.&lt;br&gt;<br>
Mark&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;
</tt>
