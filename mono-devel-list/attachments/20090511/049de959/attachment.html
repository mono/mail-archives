<tt>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;TITLE&gt;Patch&nbsp;for&nbsp;io-layer/collection.c&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;Android&amp;#8217;s&nbsp;build&nbsp;uses&nbsp;the&nbsp;GNU&nbsp;C&nbsp;compiler,&nbsp;but&nbsp;is&nbsp;failing&nbsp;while&nbsp;compiling&nbsp;&amp;#8220;gpointer&nbsp;collection_thread&nbsp;(gpointer&nbsp;unused&nbsp;G_GNUC_UNUSED)&amp;#8221;&nbsp;because&nbsp;it&nbsp;exits&nbsp;via&nbsp;a&nbsp;pthread_exit,&nbsp;and&nbsp;not&nbsp;via&nbsp;the&nbsp;return&nbsp;statement:&lt;BR&gt;<br>
&lt;BR&gt;<br>
static&nbsp;gpointer&nbsp;collection_thread&nbsp;(gpointer&nbsp;unused&nbsp;G_GNUC_UNUSED)&lt;BR&gt;<br>
{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;struct&nbsp;timespec&nbsp;sleepytime;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;sleepytime.tv_sec&nbsp;=&nbsp;_WAPI_HANDLE_COLLECTION_UPDATE_INTERVAL;&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;sleepytime.tv_nsec&nbsp;=&nbsp;0;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;while&nbsp;(_wapi_has_shut_down&nbsp;==&nbsp;FALSE)&nbsp;{&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;nanosleep&nbsp;(&amp;amp;sleepytime,&nbsp;NULL);&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//_wapi_handle_dump&nbsp;();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_wapi_handle_update_refs&nbsp;();&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/*&nbsp;This&nbsp;is&nbsp;an&nbsp;abuse&nbsp;of&nbsp;the&nbsp;collection&nbsp;thread,&nbsp;but&nbsp;it's&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&nbsp;better&nbsp;than&nbsp;creating&nbsp;a&nbsp;new&nbsp;thread&nbsp;just&nbsp;for&nbsp;one&nbsp;more&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&nbsp;function.&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*/&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_wapi_process_reap&nbsp;();&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pthread_exit&nbsp;(NULL);&lt;BR&gt;<br>
&lt;BR&gt;<br>
#if&nbsp;!defined(__GNUC__)&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/*&nbsp;Even&nbsp;though&nbsp;we&nbsp;tell&nbsp;gcc&nbsp;that&nbsp;this&nbsp;function&nbsp;doesn't&nbsp;return,&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*&nbsp;other&nbsp;compilers&nbsp;won't&nbsp;see&nbsp;that.&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;*/&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return(NULL);&lt;BR&gt;<br>
#endif&lt;BR&gt;<br>
}&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&amp;#8217;ve&nbsp;attached&nbsp;a&nbsp;patch&nbsp;that&nbsp;fixes&nbsp;the&nbsp;Android&nbsp;build&nbsp;by&nbsp;adding&nbsp;another&nbsp;condition&nbsp;to&nbsp;the&nbsp;#if.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Koush&nbsp;&lt;/SPAN&gt;&lt;/FONT&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
