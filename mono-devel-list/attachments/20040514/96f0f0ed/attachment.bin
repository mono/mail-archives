Index: mini.c
===================================================================
RCS file: /cvs/public/mono/mono/mini/mini.c,v
retrieving revision 1.177
diff -u -r1.177 mini.c
--- mini.c	20 Feb 2004 01:14:08 -0000	1.177
+++ mini.c	25 Feb 2004 03:31:34 -0000
@@ -2305,6 +2305,11 @@
 {
 	int pc, op;
 	MonoInst *ins;
+	
+	static MonoClass *runtime_helpers_class = NULL;
+	if (! runtime_helpers_class)
+		runtime_helpers_class = mono_class_from_name (mono_defaults.corlib,
+			"System.Runtime.CompilerServices", "RuntimeHelpers");
 
 	if (cmethod->klass == mono_defaults.string_class) {
  		if (cmethod->name [0] != 'g')
@@ -2326,6 +2331,12 @@
 		else if (strcmp (cmethod->name, "get_Length") == 0)
 			op = CEE_LDLEN;
 		else
+			return NULL;
+	} else if (cmethod->klass == runtime_helpers_class) {
+		if (strcmp (cmethod->name, "get_OffsetToStringData") == 0) {
+			NEW_ICONST (cfg, ins, G_STRUCT_OFFSET (MonoString, chars));
+			return ins;
+		} else
 			return NULL;
 	} else {
 		op = mono_arch_get_opcode_for_method (cfg, cmethod, fsig, args);
