<tt>
Another&nbsp;patch&nbsp;for&nbsp;COM&nbsp;Interop.&nbsp;Details&nbsp;from&nbsp;ChangeLog:&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;domain.c,&nbsp;class-internals.h:&nbsp;Added&nbsp;ComInteropProxy&nbsp;class&nbsp;to&nbsp;MonoDefaults.&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;marshal.c:&nbsp;Return&nbsp;correct&nbsp;unmanaged&nbsp;size&nbsp;for&nbsp;object&nbsp;when&nbsp;MarshalAs.Struct<br>
.&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Emit&nbsp;exception&nbsp;rather&nbsp;than&nbsp;crash&nbsp;in&nbsp;case&nbsp;of&nbsp;COM&nbsp;Callable&nbsp;Wrapper&nbsp;(not&nbsp;yet&nbsp;implemented).&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Handle&nbsp;marshalling&nbsp;of&nbsp;interfaces&nbsp;and&nbsp;VARIANTs&nbsp;contained&nbsp;in&nbsp;structs.&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Code&nbsp;is&nbsp;contributed&nbsp;under&nbsp;MIT/X11&nbsp;license.<br>
&lt;br&gt;&lt;br&gt;Just&nbsp;an&nbsp;update,&nbsp;at&nbsp;this&nbsp;point&nbsp;I'm&nbsp;hoping&nbsp;to&nbsp;start&nbsp;working&nbsp;on&nbsp;COM&nbsp;Callable&nbsp;Wrappers&nbsp;(exposing&nbsp;managed&nbsp;objects&nbsp;to&nbsp;unmanaged&nbsp;code&nbsp;as&nbsp;COM&nbsp;objects).&nbsp;The&nbsp;only&nbsp;other&nbsp;thing&nbsp;I&nbsp;was&nbsp;considering&nbsp;was&nbsp;moving&nbsp;as&nbsp;much&nbsp;COM&nbsp;Interop&nbsp;code&nbsp;as&nbsp;possible&nbsp;to&nbsp;seperate&nbsp;files&nbsp;(<br>
cominterop.c/.h)&nbsp;and&nbsp;add&nbsp;a&nbsp;marshal-internals.h&nbsp;for&nbsp;some&nbsp;functionality&nbsp;that&nbsp;is&nbsp;needed.&nbsp;Is&nbsp;this&nbsp;worthwhile?&nbsp;If&nbsp;not,&nbsp;I'm&nbsp;glad&nbsp;to&nbsp;just&nbsp;continue&nbsp;working&nbsp;as&nbsp;is.&lt;br&gt;&lt;br&gt;The&nbsp;code&nbsp;to&nbsp;marshal&nbsp;VARIANTs&nbsp;and&nbsp;interfaces&nbsp;is&nbsp;duplicated&nbsp;for&nbsp;within&nbsp;structs&nbsp;and&nbsp;in&nbsp;emit_marshal_object.&nbsp;Any&nbsp;advice&nbsp;on&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;have&nbsp;this&nbsp;code&nbsp;in&nbsp;one&nbsp;place;&nbsp;perhaps&nbsp;a&nbsp;routine&nbsp;that&nbsp;assumes&nbsp;source/dest&nbsp;addresses&nbsp;are&nbsp;on&nbsp;the&nbsp;stack,&nbsp;similar&nbsp;to&nbsp;what&nbsp;is&nbsp;done&nbsp;for&nbsp;struct&nbsp;marshalling?&nbsp;Or&nbsp;is&nbsp;the&nbsp;code&nbsp;duplication&nbsp;just&nbsp;not&nbsp;that&nbsp;big&nbsp;of&nbsp;an&nbsp;issue?<br>
&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jonathan&lt;br&gt;<br>

</tt>
