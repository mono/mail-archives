<tt>
Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  &nbsp; Update:&nbsp;I&nbsp;did&nbsp;not&nbsp;commit&nbsp;the&nbsp;tests,&nbsp;since&nbsp;I&nbsp;am&nbsp;waiting&nbsp;for&nbsp;these&nbsp;patches&nbsp;to&nbsp;be&nbsp;fixed.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Miguel.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;18,&nbsp;2010&nbsp;at&nbsp;5:53&nbsp;AM,&nbsp;Marek&nbsp;Safar&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:marek.safar@seznam.cz&quot;&gt;marek.safar@seznam.cz&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Hello,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&amp;gt;&nbsp;Some&nbsp;of&nbsp;the&nbsp;existing&nbsp;code&nbsp;was&nbsp;protected&nbsp;by&nbsp;&amp;quot;#if&nbsp;NET_2_1&nbsp;||&nbsp;NET_4_0&amp;quot;&lt;br&gt;<br>
&amp;gt;&nbsp;(e.g.&nbsp;PureAttribute)&lt;br&gt;<br>
&amp;gt;&nbsp;And&nbsp;other&nbsp;parts&nbsp;of&nbsp;the&nbsp;code&nbsp;were&nbsp;always&nbsp;compiled,&nbsp;but&nbsp;made&nbsp;internal&nbsp;if&lt;br&gt;<br>
&amp;gt;&nbsp;not&nbsp;NET_2_1&nbsp;or&nbsp;NET_4_0&nbsp;(e.g.&nbsp;Contract.cs)&lt;br&gt;<br>
&amp;gt;&nbsp;So&nbsp;I&nbsp;left&nbsp;these&nbsp;as&nbsp;they&nbsp;are,&nbsp;and&nbsp;did&nbsp;the&nbsp;same&nbsp;in&nbsp;new&nbsp;files&nbsp;that&nbsp;I&lt;br&gt;<br>
&amp;gt;&nbsp;introduced,&nbsp;which&nbsp;meant&nbsp;the&nbsp;call&nbsp;to&nbsp;Environment.FailFast()&nbsp;had&nbsp;to&nbsp;have&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;additional&nbsp;&amp;quot;#if&nbsp;NET_4_0&amp;quot;.&lt;br&gt;<br>
&amp;gt;&nbsp;However,&nbsp;if&nbsp;it&nbsp;would&nbsp;be&nbsp;better&nbsp;to&nbsp;change&nbsp;all&nbsp;files&nbsp;to&nbsp;be&nbsp;completely&lt;br&gt;<br>
&amp;gt;&nbsp;surrounded&nbsp;by&nbsp;&amp;quot;#if&nbsp;NET_4_0&amp;quot;&nbsp;then&nbsp;please&nbsp;let&nbsp;me&nbsp;know.&lt;br&gt;<br>
&lt;/div&gt;Keep&nbsp;existing&nbsp;code&nbsp;without&nbsp;change&nbsp;and&nbsp;any&nbsp;new&nbsp;stuff&nbsp;add&nbsp;as&nbsp;NET_4_0&nbsp;only&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;private&nbsp;exception&nbsp;class&nbsp;ContractException&nbsp;is&nbsp;specified&nbsp;in&nbsp;the&nbsp;MS&lt;br&gt;<br>
&amp;gt;&nbsp;documentation:&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://research.microsoft.com/en-us/projects/contracts/userdoc.pdf&quot;&nbsp;target=&quot;_blank&quot;&gt;http://research.microsoft.com/en-us/projects/contracts/userdoc.pdf&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;See&nbsp;sections&nbsp;7.6,&nbsp;7.3,&nbsp;7.4&lt;br&gt;<br>
&amp;gt;&nbsp;And&nbsp;I&nbsp;have&nbsp;verified&nbsp;what&nbsp;I&nbsp;have&nbsp;implemented&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;MS.&lt;br&gt;<br>
&lt;/div&gt;Quite&nbsp;strange&nbsp;design&nbsp;but&nbsp;fair&nbsp;enough&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;private&nbsp;exception&nbsp;class&nbsp;ContractShouldAssertException&nbsp;is&nbsp;because,&lt;br&gt;<br>
&amp;gt;&nbsp;in&nbsp;some&nbsp;circumstances,&nbsp;the&nbsp;code&nbsp;should&nbsp;Assert,&nbsp;but&nbsp;there&nbsp;appears&nbsp;to&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;no&nbsp;simple&nbsp;way&nbsp;to&nbsp;do&nbsp;this&nbsp;from&nbsp;within&nbsp;corlib,&nbsp;so&nbsp;I&nbsp;throw&nbsp;this&nbsp;exception&lt;br&gt;<br>
&amp;gt;&nbsp;instead.&nbsp;However,&nbsp;this&nbsp;will&nbsp;never&nbsp;occur&nbsp;because&nbsp;it&nbsp;is&nbsp;guarded&nbsp;by&nbsp;&amp;quot;if&lt;br&gt;<br>
&amp;gt;&nbsp;(Environment.UserInteractive)&amp;quot;&nbsp;which&nbsp;currently&nbsp;always&nbsp;returns&nbsp;false.&nbsp;I&lt;br&gt;<br>
&amp;gt;&nbsp;have&nbsp;put&nbsp;a&nbsp;FIXME&nbsp;comment&nbsp;at&nbsp;both&nbsp;places&nbsp;in&nbsp;the&nbsp;code&nbsp;where&nbsp;this&nbsp;is&lt;br&gt;<br>
&amp;gt;&nbsp;done.&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;better&nbsp;way&nbsp;to&nbsp;implement&nbsp;this,&nbsp;please&nbsp;let&nbsp;me&nbsp;know.&lt;br&gt;<br>
&lt;/div&gt;This&nbsp;is&nbsp;trick&nbsp;you&nbsp;will&nbsp;have&nbsp;to&nbsp;try&nbsp;to&nbsp;implement&nbsp;it&nbsp;&amp;quot;correctly&amp;quot;&nbsp;yourself&lt;br&gt;<br>
or&nbsp;ask&nbsp;runtime&nbsp;guys&nbsp;to&nbsp;do&nbsp;it.&nbsp;My&nbsp;understanding&nbsp;is&nbsp;that&nbsp;you&nbsp;want&nbsp;to&lt;br&gt;<br>
terminate&nbsp;the&nbsp;process&nbsp;without&nbsp;missing&nbsp;any&nbsp;catch/finally&nbsp;clause&nbsp;but&lt;br&gt;<br>
without&nbsp;throwing&nbsp;an&nbsp;exception&nbsp;(could&nbsp;be&nbsp;captured&nbsp;at&nbsp;higher&nbsp;level&nbsp;and&lt;br&gt;<br>
stop&nbsp;the&nbsp;shutdown).&lt;br&gt;<br>
&lt;br&gt;<br>
Good&nbsp;work,&nbsp;you&nbsp;can&nbsp;commit&nbsp;the&nbsp;patch&nbsp;after&nbsp;the&nbsp;minor&nbsp;fixes.&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;Marek&lt;br&gt;<br>
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Kind&nbsp;regards&lt;br&gt;<br>
&amp;gt;&nbsp;Chris&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Marek&nbsp;Safar&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Hello,&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Few&nbsp;comments&nbsp;from&nbsp;me&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;All&nbsp;code&nbsp;is&nbsp;#if&nbsp;NET_4_0&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;for&nbsp;further&nbsp;nested&nbsp;#if&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;Why&nbsp;did&nbsp;you&nbsp;have&nbsp;to&nbsp;introduce&nbsp;private&nbsp;exception&nbsp;classes&nbsp;?&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Marek&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;-----Ursprüngliche&nbsp;Nachricht-----&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Von:&nbsp;&lt;a&nbsp;href=&quot;mailto:mono-devel-list-bounces@lists.ximian.com&quot;&gt;mono-devel-list-bounces@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;[mailto:&lt;a&nbsp;href=&quot;mailto:mono-devel-list-&quot;&gt;mono-devel-list-&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:bounces@lists.ximian.com&quot;&gt;bounces@lists.ximian.com&lt;/a&gt;]&nbsp;Im&nbsp;Auftrag&nbsp;von&nbsp;Chris&nbsp;Bacon&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Gesendet:&nbsp;Mittwoch,&nbsp;16.&nbsp;Juni&nbsp;2010&nbsp;12:03&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;An:&nbsp;Marek&nbsp;Safar&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Cc:&nbsp;&lt;a&nbsp;href=&quot;mailto:mono-devel-list@lists.ximian.com&quot;&gt;mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Betreff:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;Patch&nbsp;1/2&nbsp;-&nbsp;System.Diagnostics.Contracts&nbsp;in&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;corlib&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Attached&nbsp;is&nbsp;a&nbsp;new,&nbsp;improved,&nbsp;patch&nbsp;that&nbsp;keeps&nbsp;existing&nbsp;formatting.&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Sorry&nbsp;for&nbsp;the&nbsp;mistake.&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Kind&nbsp;regards&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Chris&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Marek&nbsp;Safar&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Hi&nbsp;Chris,&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Attached&nbsp;is&nbsp;a&nbsp;patch&nbsp;to&nbsp;corlib&nbsp;containing&nbsp;updates&nbsp;the&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;System.Diagnostics.Contracts&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;GSoC&nbsp;work&nbsp;I&nbsp;am&nbsp;doing.&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;I&amp;#39;m&nbsp;sure&nbsp;there&nbsp;will&nbsp;be&nbsp;parts&nbsp;of&nbsp;this&nbsp;I&nbsp;haven&amp;#39;t&nbsp;done&nbsp;quite&nbsp;right,&nbsp;so&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;please&nbsp;let&nbsp;me&nbsp;know&nbsp;what&nbsp;they&nbsp;are,&nbsp;and&nbsp;I&amp;#39;ll&nbsp;sort&nbsp;them&nbsp;out.&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Can&nbsp;you&nbsp;keep&nbsp;existing&nbsp;formatting,&nbsp;most&nbsp;of&nbsp;the&nbsp;changes&nbsp;are&nbsp;about&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;changing&nbsp;tabs&nbsp;to&nbsp;spaces.&nbsp;Please&nbsp;send&nbsp;a&nbsp;new&nbsp;set&nbsp;of&nbsp;patches&nbsp;without&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;any&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;noise&nbsp;(lines&nbsp;you&nbsp;have&nbsp;not&nbsp;changed)&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Thanks&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Marek&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
