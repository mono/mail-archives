<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Apr&nbsp;14,&nbsp;2008&nbsp;at&nbsp;12:50&nbsp;PM,&nbsp;Mark&nbsp;Probst&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mark.probst@gmail.com&quot;&gt;mark.probst@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hey&nbsp;Rodrigo,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Anyway,&nbsp;this&nbsp;would&nbsp;only&nbsp;make&nbsp;sense&nbsp;if&nbsp;freeing&nbsp;is&nbsp;something&nbsp;that&nbsp;happens&lt;br&gt;<br>
&amp;gt;&nbsp;enough&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;justify&nbsp;the&nbsp;extra&nbsp;work.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;don&amp;#39;t&nbsp;think&nbsp;freeing&nbsp;would&nbsp;happen&nbsp;often&nbsp;enough.&nbsp;&amp;nbsp;I&amp;#39;m&nbsp;actually&nbsp;more&lt;br&gt;<br>
concerned&nbsp;about&nbsp;the&nbsp;impact&nbsp;of&nbsp;the&nbsp;write&nbsp;barrier&nbsp;I&amp;#39;d&nbsp;need&nbsp;for&nbsp;the&lt;br&gt;<br>
hazard&nbsp;pointer,&nbsp;which&nbsp;would&nbsp;be&nbsp;used&nbsp;every&nbsp;time&nbsp;a&nbsp;slot&nbsp;is&nbsp;fetched&nbsp;from&lt;br&gt;<br>
a&nbsp;RGCTX.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;was&nbsp;thinking&nbsp;more&nbsp;about&nbsp;collections.&nbsp;Do&nbsp;interfaces&nbsp;have&nbsp;a&nbsp;rgctx&nbsp;too?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;No.&nbsp;&amp;nbsp;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;what&nbsp;I&amp;#39;d&nbsp;put&nbsp;into&nbsp;the&nbsp;RGCTX&nbsp;of&nbsp;an&nbsp;interface,&nbsp;anyway.&lt;br&gt;<br>
&amp;nbsp;What&nbsp;do&nbsp;you&nbsp;have&nbsp;in&nbsp;mind?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Well,&nbsp;I&nbsp;know&nbsp;just&nbsp;a&nbsp;little&nbsp;of&nbsp;how&nbsp;sharing&nbsp;works&nbsp;and&nbsp;I&nbsp;wasn&amp;#39;t&nbsp;sure&nbsp;if&nbsp;it&nbsp;did&nbsp;build&lt;br&gt;rgctx&nbsp;for&nbsp;inferfaces&nbsp;or&nbsp;not.&nbsp;Since&nbsp;it&nbsp;doesn&amp;#39;t,&nbsp;using&nbsp;a&nbsp;chained&nbsp;rgctx&nbsp;&nbsp;won&amp;#39;t&nbsp;do&lt;br&gt;<br>
any&nbsp;good&nbsp;for&nbsp;collections,&nbsp;at&nbsp;least.&lt;br&gt;&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;expected&nbsp;that&nbsp;for&nbsp;F#&nbsp;sharing&nbsp;would&nbsp;have&nbsp;saved&nbsp;some&nbsp;overall&nbsp;time&nbsp;since&nbsp;JIT&lt;br&gt;<br>
&amp;gt;&nbsp;activity&nbsp;is&nbsp;a&nbsp;lot&nbsp;smaller.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;had&nbsp;hoped&nbsp;for&nbsp;that,&nbsp;too,&nbsp;but&nbsp;it&amp;#39;s&nbsp;not&nbsp;there.&nbsp;&amp;nbsp;Not&nbsp;that&nbsp;I&amp;#39;m&nbsp;terribly&lt;br&gt;<br>
unhappy,&nbsp;though&nbsp;-&nbsp;I&nbsp;saw&nbsp;generic&nbsp;sharing&nbsp;as&nbsp;mainly&nbsp;a&nbsp;memory&lt;br&gt;<br>
optimization.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;By&nbsp;the&nbsp;way,&nbsp;talking&nbsp;about&nbsp;the&nbsp;F#&nbsp;case,&nbsp;generic&nbsp;sharing&nbsp;compiles&nbsp;27%&nbsp;less&lt;br&gt;<br>
&amp;gt;&nbsp;methods,&nbsp;but&nbsp;only&nbsp;reduces&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;the&nbsp;compiled&nbsp;code&nbsp;size&nbsp;by&nbsp;6%.&nbsp;These&nbsp;numbers&nbsp;seen&nbsp;odd&nbsp;to&nbsp;me.&nbsp;Is&nbsp;generic&nbsp;code&lt;br&gt;<br>
&amp;gt;&nbsp;really&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;smaller&nbsp;than&nbsp;non-generic&nbsp;or&nbsp;is&nbsp;the&nbsp;added&nbsp;code&nbsp;for&nbsp;sharing&nbsp;support&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;result&nbsp;on&nbsp;these&nbsp;numbers?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&amp;#39;ll&nbsp;look&nbsp;into&nbsp;it&nbsp;in&nbsp;more&nbsp;detail,&nbsp;but&nbsp;it&nbsp;seems&nbsp;that&nbsp;generic&nbsp;methods&lt;br&gt;<br>
are&nbsp;usually&nbsp;very&nbsp;short,&nbsp;more&nbsp;so&nbsp;than&nbsp;non-generic&nbsp;methods.&nbsp;&amp;nbsp;And&nbsp;we&nbsp;do&lt;br&gt;<br>
generate&nbsp;code&nbsp;that&amp;#39;s&nbsp;a&nbsp;bit&nbsp;longer,&nbsp;but&nbsp;not&nbsp;by&nbsp;much.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Other&nbsp;thing,&nbsp;how&nbsp;does&nbsp;sharing&nbsp;and&nbsp;inlining&nbsp;play&nbsp;together?&nbsp;I&nbsp;guess&nbsp;inlined&nbsp;generic&nbsp;code&lt;br&gt;uses&nbsp;rgctx&nbsp;a&nbsp;bit&nbsp;less&nbsp;as&nbsp;it&nbsp;has&nbsp;precise&nbsp;type&nbsp;information&nbsp;at&nbsp;hand.&nbsp;If&nbsp;so,&nbsp;wouldn&amp;#39;t&lt;br&gt;<br>
more&nbsp;aggressively&nbsp;inlining&nbsp;generic&nbsp;code&nbsp;reduce&nbsp;the&nbsp;need&nbsp;for&nbsp;rgctx?&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
