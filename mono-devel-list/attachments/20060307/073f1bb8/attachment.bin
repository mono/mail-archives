Index: Mono.Data.SqliteClient/SqliteDataReader.cs
===================================================================
--- Mono.Data.SqliteClient/SqliteDataReader.cs	(wersja 57661)
+++ Mono.Data.SqliteClient/SqliteDataReader.cs	(kopia robocza)
@@ -368,7 +368,12 @@
 			int row = current_row;
 			if (row == -1 && rows.Count == 0) return typeof(string);
 			if (row == -1) row = 0;
-			return ((object[]) rows[row])[i].GetType();
+			object element = ((object[]) rows[row])[i];
+			if (element != null)
+				return element.GetType();
+			else
+				return typeof (string);
+
 			// Note that the return value isn't guaranteed to
 			// be the same as the rows are read if different
 			// types of information are stored in the column.
Index: Mono.Data.SqliteClient/ChangeLog
===================================================================
--- Mono.Data.SqliteClient/ChangeLog	(wersja 57661)
+++ Mono.Data.SqliteClient/ChangeLog	(kopia robocza)
@@ -1,3 +1,8 @@
+2006-03-07  Kamil Skalski  <nazgul@nemerle.org>
+
+	* SqliteDataReader.cs: Handle null values in result as having
+	string type
+
 2006-02-10  Joshua Tauberer  <tauberer@for.net>
 
 	* SqliteDataReader: Made 64bit clean.  Patch from
Index: Test/SqliteDataReaderTest.cs
===================================================================
--- Test/SqliteDataReaderTest.cs	(wersja 57661)
+++ Test/SqliteDataReaderTest.cs	(kopia robocza)
@@ -75,5 +75,26 @@
                                 }
                         }
                 }
+
+		[Test]
+		public void TypeOfNullInResultTest ()
+		{
+			_conn.ConnectionString = _connectionString;
+			SqliteDataReader reader = null;
+			using (_conn) {
+				_conn.Open ();
+				SqliteCommand cmd = _conn.CreateCommand ();
+				cmd.CommandText = "select null from test";
+				reader = cmd.ExecuteReader ();
+				try {
+					Assert.IsTrue (reader.Read());
+					Assert.IsNotNull (reader.GetFieldType (0));
+				} finally {
+					if (reader != null && !reader.IsClosed)
+						reader.Close ();
+					_conn.Close ();
+				}
+			}
+		}
         }
 }
Index: Test/ChangeLog
===================================================================
--- Test/ChangeLog	(wersja 57661)
+++ Test/ChangeLog	(kopia robocza)
@@ -1,3 +1,8 @@
+2006-03-07  Kamil Skalski  <nazgul@nemerle.org>
+
+	* SqliteDataReaderTest.cs: Add test for getting field type of null
+	value
+
 2006-01-29  Joshua Tauberer <tauberer@for.net>
 
 	* Added tests from Thomas Zoechling <thomas.zoechling@gmx.at>.