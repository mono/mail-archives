#define TRACE

using System;
using System.IO;
using System.Collections;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Data;
using System.Data.SqlClient;
using System.Diagnostics;

public class Test
{
	public static void Main(string[] args)
	{
		StreamWriter sw = new StreamWriter("log.txt");
		
		Trace.Listeners.Clear();
		Trace.Listeners.Add(new TextWriterTraceListener(sw));
		
		string connectionString =
		"Server=R55S;" +
		"Database=pubs;" +
		"User ID=ttuser;" +
		"Password=ttuser;" +
		"Encrypt=True;";
		IDbConnection dbcon;
		using (dbcon = new SqlConnection(connectionString))
		{
			dbcon.Open();
			using (IDbCommand dbcmd = dbcon.CreateCommand())
			{
				dbcmd.CommandText = "SELECT * FROM employee WHERE emp_id > @id";
				dbcmd.Parameters.Add(new SqlParameter("@id", "1000"));
				using (IDataReader reader = dbcmd.ExecuteReader())
				{
					while (reader.Read())
					{
						string FirstName = (string)reader["fname"];
						string LastName = (string)reader["lname"];
						Console.WriteLine("Name: " +
							FirstName + " " + LastName);
					}
				}
			}
		}
		
		sw.Close();
	}
}
