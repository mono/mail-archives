Index: HttpSoapWebServiceHandler.cs
===================================================================
--- HttpSoapWebServiceHandler.cs	(revision 57296)
+++ HttpSoapWebServiceHandler.cs	(working copy)
@@ -149,7 +149,7 @@
 
 				_extensionChainHighPrio = SoapExtension.CreateExtensionChain (_typeStubInfo.SoapExtensions[0]);
 				stream = SoapExtension.ExecuteChainStream (_extensionChainHighPrio, stream);
-				SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, false);
+				SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, stream, false);
 
 				// If the routing style is RequestElement, try to get the method name from the
 				// stream processed by the high priority extensions
@@ -195,8 +195,8 @@
 
 				stream = SoapExtension.ExecuteChainStream (_extensionChainMedPrio, stream);
 				stream = SoapExtension.ExecuteChainStream (_extensionChainLowPrio, stream);
-				SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, false);
-				SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, false);
+				SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, stream, false);
+				SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, stream, false);
 
 				// Deserialize the request
 
@@ -219,9 +219,9 @@
 				// Notify the extensions after deserialization
 
 				message.SetStage (SoapMessageStage.AfterDeserialize);
-				SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, false);
-				SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, false);
-				SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, false);
+				SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, stream, false);
+				SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, stream, false);
+				SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, stream, false);
 
 				xmlReader.Close ();
 
@@ -281,9 +281,9 @@
 					outStream = SoapExtension.ExecuteChainStream (_extensionChainLowPrio, outStream);
 	
 					message.SetStage (SoapMessageStage.BeforeSerialize);
-					SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, true);
-					SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, true);
-					SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, true);
+					SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, outStream, true);
+					SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, outStream, true);
+					SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, outStream, true);
 				}
 				
 				XmlTextWriter xtw = WebServiceHelper.CreateXmlWriter (outStream);
@@ -298,9 +298,9 @@
 				if (bufferResponse)
 				{
 					message.SetStage (SoapMessageStage.AfterSerialize);
-					SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, true);
-					SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, true);
-					SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, true);
+					SoapExtension.ExecuteProcessMessage (_extensionChainLowPrio, message, outStream, true);
+					SoapExtension.ExecuteProcessMessage (_extensionChainMedPrio, message, outStream, true);
+					SoapExtension.ExecuteProcessMessage (_extensionChainHighPrio, message, outStream, true);
 				}
 				
 				xtw.Flush ();
