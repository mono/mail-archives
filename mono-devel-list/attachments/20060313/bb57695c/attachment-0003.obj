Index: SoapServerMessage.cs
===================================================================
--- SoapServerMessage.cs	(revision 57296)
+++ SoapServerMessage.cs	(working copy)
@@ -42,6 +42,8 @@
 		object server;
 		string url;
 		object[] parameters;
+		HttpRequest request;
+		HttpResponse response;
 
 		#endregion
 
@@ -52,6 +54,7 @@
 		{
 			this.action = request.Headers ["SOAPAction"];
 			this.server = server;
+			this.request = request;
 			this.url = request.Url.ToString();
 		}
 
@@ -61,6 +64,7 @@
 			this.action = request.Headers ["SOAPAction"];
 			this.stubInfo = stubInfo;
 			this.server = server;
+			this.request = request;
 			this.url = request.Url.ToString();
 		}
 
@@ -101,6 +105,43 @@
 		}
 #endif
 
+		protected override string InternalContentEncoding {
+			get {
+				return request != null ? request.Headers["Content-Encoding"] : null;
+			}
+			set {
+				if (response != null)
+					response.AddHeader("Content-Encoding", value);
+				else
+					if (request != null)
+					request.Headers["Content-Encoding"] = value;
+			}
+		}
+
+		protected override string InternalContentType {
+			get {
+				if (response != null)
+					return response.ContentType;
+				return request != null ? request.ContentType : null;
+			}
+			set {
+				if (response != null)
+					response.ContentType = value;
+				else
+					if (request != null)
+					request.ContentType = value;
+			}
+		}
+
+		internal HttpResponse HttpResponse {
+			get {
+				return response;
+			}
+			set {
+				response = value;
+			}
+		}
+
 		#endregion // Properties
 
 		#region Methods
