Index: class/System/System.Collections.Generic/SortedList.cs
===================================================================
--- class/System/System.Collections.Generic/SortedList.cs	(revision 132563)
+++ class/System/System.Collections.Generic/SortedList.cs	(working copy)
@@ -327,6 +327,9 @@
 
 		void ICollection<KeyValuePair<TKey, TValue>>.CopyTo (KeyValuePair<TKey, TValue>[] array, int arrayIndex)
 		{
+			if (Count == 0)
+				return;
+			
 			if (null == array)
 				throw new ArgumentNullException();
 
@@ -421,6 +424,9 @@
 
 		void ICollection.CopyTo (Array array, int arrayIndex)
 		{
+			if (Count == 0)
+				return;
+			
 			if (null == array)
 				throw new ArgumentNullException();
 
Index: class/System/System.Collections.Generic/ChangeLog
===================================================================
--- class/System/System.Collections.Generic/ChangeLog	(revision 132563)
+++ class/System/System.Collections.Generic/ChangeLog	(working copy)
@@ -1,3 +1,8 @@
+2009-05-06  Pia Eriksson  <pe@hallerud.se>
+
+	* SortedList.cs: Handle Count == 0 in CopyTo correcly
+	* SortedDictionary.cs: Handle Count == 0 in CopyTo correcly
+
 2007-11-15  Roei Erez  <roeie@mainsoft.com>
 
 	* Stack.cs: Performance improvement in the case where the stack is popped
Index: class/System/System.Collections.Generic/SortedDictionary.cs
===================================================================
--- class/System/System.Collections.Generic/SortedDictionary.cs	(revision 132563)
+++ class/System/System.Collections.Generic/SortedDictionary.cs	(working copy)
@@ -194,6 +194,8 @@
 
 		public void CopyTo (KeyValuePair<TKey,TValue>[] array, int arrayIndex)
 		{
+			if (Count == 0)
+				return;
 			if (array == null)
 				throw new ArgumentNullException ();
 			if (arrayIndex < 0 || array.Length <= arrayIndex)
@@ -331,6 +333,8 @@
 
 		void ICollection.CopyTo (Array array, int index)
 		{
+			if (Count == 0)
+				return;
 			if (array == null)
 				throw new ArgumentNullException ();
 			if (index < 0 || array.Length <= index)
@@ -399,6 +403,8 @@
 
 			public void CopyTo (TValue [] array, int arrayIndex)
 			{
+				if (Count == 0)
+					return;
 				if (array == null)
 					throw new ArgumentNullException ();
 				if (arrayIndex < 0 || array.Length <= arrayIndex)
@@ -434,6 +440,8 @@
 		
 			void ICollection.CopyTo (Array array, int index)
 			{
+				if (Count == 0)
+					return;
 				if (array == null)
 					throw new ArgumentNullException ();
 				if (index < 0 || array.Length <= index)
@@ -524,6 +532,8 @@
 
 			public void CopyTo (TKey [] array, int arrayIndex)
 			{
+				if (Count == 0)
+					return;
 				if (array == null)
 					throw new ArgumentNullException ();
 				if (arrayIndex < 0 || array.Length <= arrayIndex)
@@ -554,6 +564,8 @@
 
 			void ICollection.CopyTo (Array array, int index)
 			{
+				if (Count == 0)
+					return;
 				if (array == null)
 					throw new ArgumentNullException ();
 				if (index < 0 || array.Length <= index)
