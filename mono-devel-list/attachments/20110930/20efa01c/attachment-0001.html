<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Sep&nbsp;30,&nbsp;2011&nbsp;at&nbsp;7:37&nbsp;PM,&nbsp;Mehrdad&nbsp;Reshadi&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:reshadi@gmail.com&quot;&gt;reshadi@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Hi,&lt;div&gt;I&nbsp;have&nbsp;been&nbsp;searching&nbsp;on&nbsp;the&nbsp;internet&nbsp;but&nbsp;could&nbsp;not&nbsp;find&nbsp;a&nbsp;definitive&nbsp;answer&nbsp;to&nbsp;this. &lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;any&nbsp;limitation&nbsp;in&nbsp;the&nbsp;latest&nbsp;version&nbsp;of&nbsp;Mono&nbsp;(as&nbsp;of&nbsp;2.10.5)&nbsp;in&nbsp;inlining&nbsp;a&nbsp;method&nbsp;in&nbsp;the&nbsp;following&nbsp;cases:&lt;/div&gt;<br>
<br>
&lt;div&gt;-&nbsp;a&nbsp;method&nbsp;that&nbsp;only&nbsp;uses&nbsp;&amp;quot;ref&amp;quot;&nbsp;struct&nbsp;parameters &lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&gt;-&nbsp;a&nbsp;method&nbsp;that&nbsp;uses&nbsp;struct&nbsp;parameters&lt;/div&gt;<br>
&lt;div&gt;-&nbsp;a&nbsp;method&nbsp;that&nbsp;has&nbsp;struct&nbsp;local&nbsp;variables&lt;/div&gt;&lt;div&gt;-&nbsp;a&nbsp;method&nbsp;that&nbsp;returns&nbsp;a&nbsp;struct&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;I&nbsp;appreciate&nbsp;if&nbsp;anyone&nbsp;can&nbsp;point&nbsp;me&nbsp;to&nbsp;the&nbsp;part&nbsp;of&nbsp;mini&nbsp;that&nbsp;deals&nbsp;with&nbsp;inlining heuristics? &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;checks&nbsp;are&nbsp;done&nbsp;here:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;mono/mini/method-to-ir.c&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;function&nbsp;mono_method_check_inlining&nbsp;does&nbsp;basic&nbsp;checks&nbsp;and&nbsp;the&nbsp;rest&nbsp;are&nbsp;done&nbsp;while&nbsp;converting&nbsp;method&nbsp;to&nbsp;IR.&lt;/div&gt;&lt;div&gt;Then&nbsp;look&nbsp;for&nbsp;uses&nbsp;of&nbsp;the INLINE_FAILURE&nbsp;macro&nbsp;to&nbsp;see&nbsp;what&nbsp;in&nbsp;the&nbsp;body&nbsp;of&nbsp;a&nbsp;method&nbsp;aborts&nbsp;inlining.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Take&nbsp;the&nbsp;below&nbsp;example,&nbsp;Foo&nbsp;will&nbsp;be&nbsp;inlined:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;using&nbsp;System;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;class&nbsp;Driver&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;static&nbsp;DateTime&nbsp;Foo&nbsp;(DateTime&nbsp;a,&nbsp;DateTime&nbsp;b,&nbsp;DateTime&nbsp;c)&nbsp;{&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;return&nbsp;a;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;static&nbsp;void&nbsp;Main&nbsp;()&nbsp;{&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;DateTime&nbsp;a&nbsp;=&nbsp;DateTime.Now;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;DateTime&nbsp;b&nbsp;=&nbsp;a.AddDays&nbsp;(1);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;DateTime&nbsp;c&nbsp;=&nbsp;a.AddDays&nbsp;(2);&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;DateTime&nbsp;d&nbsp;=&nbsp;Foo&nbsp;(a,&nbsp;b,&nbsp;c);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;Console.WriteLine&nbsp;(d);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;}&lt;/div&gt;<br>
&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;<br>

</tt>
