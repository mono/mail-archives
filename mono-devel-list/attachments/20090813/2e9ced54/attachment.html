<tt>
The&nbsp;runtime&nbsp;function&nbsp;mono_raise_exception&nbsp;is&nbsp;very&nbsp;problematic&nbsp;and&nbsp;can&amp;#39;t&nbsp;be&nbsp;used&lt;br&gt;as&nbsp;promiscuous&nbsp;as&nbsp;it&nbsp;currently&nbsp;is.&lt;br&gt;&lt;br&gt;The&nbsp;issue&nbsp;is&nbsp;that&nbsp;it&nbsp;will&nbsp;unwind&nbsp;the&nbsp;current&nbsp;block&nbsp;of&nbsp;unmanaged&nbsp;code&nbsp;regardless&nbsp;of&lt;br&gt;it&amp;#39;s&nbsp;state,&nbsp;which&nbsp;can&nbsp;be&nbsp;holding&nbsp;locks&nbsp;or&nbsp;floating&nbsp;memory&nbsp;(that&nbsp;needs&nbsp;to&nbsp;be&nbsp;freed).&lt;br&gt;<br>
<br>
&lt;br&gt;To&nbsp;avoid&nbsp;such&nbsp;problems&nbsp;I&amp;#39;m&nbsp;going&nbsp;to&nbsp;remove&nbsp;all&nbsp;uses&nbsp;of&nbsp;mono_raise_exception&nbsp;from&nbsp;functions&lt;br&gt;that&nbsp;are&nbsp;not&nbsp;an&nbsp;icall,&nbsp;a&nbsp;top&nbsp;level&nbsp;trampoline&nbsp;target&nbsp;or&nbsp;has&nbsp;explicit&nbsp;parameter&nbsp;telling&nbsp;to&nbsp;raise&nbsp;it[1].&lt;br&gt;&lt;br&gt;Here&nbsp;is&nbsp;the&nbsp;list&nbsp;of&nbsp;functions&nbsp;that&nbsp;do&nbsp;causes&nbsp;problems&nbsp;for&nbsp;the&nbsp;runtime.&nbsp;The&nbsp;functions&nbsp;or&nbsp;their&nbsp;callers&lt;br&gt;<br>
must&nbsp;be&nbsp;reworked&nbsp;to&nbsp;avoid&nbsp;memory&nbsp;leaks&nbsp;or&nbsp;deadlocks&nbsp;(all&nbsp;of&nbsp;those&nbsp;functions&nbsp;are&nbsp;called&nbsp;with&nbsp;the&nbsp;loader&nbsp;lock&nbsp;held):&lt;br&gt;&lt;br&gt;mono_make_shadow_copy&lt;br&gt;mono_runtime_class_init&lt;br&gt;mono_class_vtable&lt;br&gt;mono_string_to_utf8&lt;br&gt;&lt;br&gt;<br>
The&nbsp;most&nbsp;problematic&nbsp;here&nbsp;is&nbsp;mono_string_to_utf8&nbsp;that&nbsp;has&nbsp;over&nbsp;a&nbsp;100&nbsp;calls&nbsp;spread&nbsp;all&nbsp;over&nbsp;the&nbsp;runtime.&lt;br&gt;I&nbsp;think&nbsp;we&nbsp;should&nbsp;deprecated&nbsp;and&nbsp;replaced&nbsp;with&nbsp;a&nbsp;version&nbsp;that&nbsp;doesn&amp;#39;t&nbsp;raise&nbsp;and&nbsp;just&nbsp;return&nbsp;null.&lt;br&gt;&lt;br&gt;Callers&nbsp;of&nbsp;all&nbsp;object&nbsp;allocation&nbsp;functions&nbsp;must&nbsp;be&nbsp;audited&nbsp;as&nbsp;well&nbsp;because&nbsp;those&nbsp;can&nbsp;throw&nbsp;too.&lt;br&gt;<br>
&lt;br&gt;Rodrigo&lt;br&gt;&lt;br&gt;[1]Those&nbsp;are&nbsp;deemed&nbsp;problematic&nbsp;as&nbsp;well&nbsp;and&nbsp;all&nbsp;callers&nbsp;must&nbsp;respect&nbsp;the&nbsp;same&nbsp;rules&nbsp;&lt;br&gt;<br>
that&nbsp;applies&nbsp;to&nbsp;mono_raise_exception.&lt;br&gt;&lt;br&gt;<br>

</tt>
