<tt>
Slightly&nbsp;modified&nbsp;patch.&nbsp;I&nbsp;did&nbsp;make&nbsp;MonoType.IsCOMObjectImpl&nbsp;an&nbsp;internal&nbsp;call.&nbsp;Also,&nbsp;I&nbsp;fixed&nbsp;a&nbsp;problem&nbsp;with&nbsp;calling&nbsp;the&nbsp;constructor&nbsp;of&nbsp;RCWs&nbsp;(both&nbsp;order,&nbsp;and&nbsp;the&nbsp;fact&nbsp;that&nbsp;I&nbsp;was&nbsp;always&nbsp;calling&nbsp;the&nbsp;default/empty&nbsp;.ctor).&nbsp;As&nbsp;indicated&nbsp;in&nbsp;ChangeLog,&nbsp;all&nbsp;contributions&nbsp;are&nbsp;under&nbsp;the&nbsp;MIT/X11&nbsp;license.<br>
&lt;br&gt;&lt;br&gt;-&nbsp;Jonathan&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;8/9/06,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Zoltan&nbsp;Varga&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:vargaz@gmail.com&quot;&gt;vargaz@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hi,&lt;br&gt;&lt;br&gt;This&nbsp;is&nbsp;ok&nbsp;to&nbsp;check&nbsp;in.&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;Zoltan&lt;br&gt;&lt;br&gt;On&nbsp;8/9/06,&nbsp;Jon&nbsp;Chambers&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:joncham@gmail.com&quot;&gt;joncham@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;Here&nbsp;is&nbsp;another&nbsp;patch&nbsp;for&nbsp;COM&nbsp;Interop.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;1.&nbsp;Corrected&nbsp;marshalling&nbsp;when&nbsp;MarshalAs&nbsp;is&nbsp;specified&nbsp;as&nbsp;IDispatch&nbsp;or<br>
&lt;br&gt;&amp;gt;&nbsp;IUnknown.&lt;br&gt;&amp;gt;&nbsp;2.&nbsp;Added&nbsp;null&nbsp;checks&nbsp;to&nbsp;marshalling&nbsp;code&lt;br&gt;&amp;gt;&nbsp;3.&nbsp;Added&nbsp;is_com_object&nbsp;field&nbsp;to&nbsp;classes.&nbsp;This&nbsp;is&nbsp;required&nbsp;because&nbsp;it&nbsp;is&lt;br&gt;&amp;gt;&nbsp;possible&nbsp;to&nbsp;derive&nbsp;from&nbsp;a&nbsp;ComImport&nbsp;attributed&nbsp;type.&nbsp;Thus&nbsp;the&nbsp;current&nbsp;type<br>
&lt;br&gt;&amp;gt;&nbsp;where&nbsp;the&nbsp;method&nbsp;is&nbsp;defined&nbsp;is&nbsp;not&nbsp;marked&nbsp;with&nbsp;the&nbsp;attribute,&nbsp;but&nbsp;a&lt;br&gt;&amp;gt;&nbsp;supertype&nbsp;is.&lt;br&gt;&amp;gt;&nbsp;4.&nbsp;Added&nbsp;tests&nbsp;and&nbsp;fixed&nbsp;QueryInterface&nbsp;implementation&nbsp;so&nbsp;that&nbsp;test&nbsp;runs&lt;br&gt;&amp;gt;&nbsp;successfully&nbsp;on&nbsp;.Net.&lt;br&gt;&amp;gt;&nbsp;5.&nbsp;Fixed&nbsp;cominterop_get_com_slot_for_method&nbsp;to&nbsp;look&nbsp;on<br>
&lt;br&gt;&amp;gt;&nbsp;interface&nbsp;where&nbsp;method&nbsp;is&nbsp;defined,&nbsp;not&nbsp;on&nbsp;implementing&nbsp;class,&nbsp;for&lt;br&gt;&amp;gt;&nbsp;attributes.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;The&nbsp;only&nbsp;minor&nbsp;thing&nbsp;is&nbsp;whether&nbsp;I&nbsp;should&nbsp;have&nbsp;IsCOMObjectImpl&nbsp;be&nbsp;an&nbsp;internal&lt;br&gt;&amp;gt;&nbsp;call&nbsp;and&nbsp;simply&nbsp;check&nbsp;the&nbsp;is_com_object&nbsp;flag&nbsp;of&nbsp;the&nbsp;class?&nbsp;This&nbsp;seems&nbsp;to<br>
&lt;br&gt;&amp;gt;&nbsp;make&nbsp;sense,&nbsp;but&nbsp;not&nbsp;sure&nbsp;whether&nbsp;I&nbsp;should&nbsp;add&nbsp;an&nbsp;internal&nbsp;call&nbsp;if&nbsp;I&nbsp;can&nbsp;do&lt;br&gt;&amp;gt;&nbsp;it&nbsp;in&nbsp;managed&nbsp;(albeit&nbsp;less&nbsp;efficiently).&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Thanks,&lt;br&gt;&amp;gt;&nbsp;Jonathan&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;_______________________________________________<br>
&lt;br&gt;&amp;gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list<br>
&lt;/a&gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
