<tt>
Hi,&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sun,&nbsp;Jun&nbsp;7,&nbsp;2009&nbsp;at&nbsp;3:02&nbsp;AM,&nbsp;Steven&nbsp;Munroe&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:munroesj@us.ibm.com&quot;&gt;munroesj@us.ibm.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
In&nbsp;mono-ppc.c:&nbsp;mono_arch_emit_exceptions&nbsp;g_assert&nbsp;(cfg-&amp;gt;code_len&nbsp;&amp;lt;&lt;br&gt;<br>
cfg-&amp;gt;code_size)&nbsp;is&nbsp;triggered&nbsp;becuase&nbsp;gfg-&amp;gt;code_len&nbsp;==&nbsp;cfg-&amp;gt;code_size.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;assume&nbsp;this&nbsp;should&nbsp;be&nbsp;g_assert&nbsp;(cfg-&amp;gt;code_len&nbsp;&amp;lt;=&nbsp;cfg-&amp;gt;code_size)&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;attached&nbsp;patch&nbsp;fixes&nbsp;this.&lt;br&gt;<br>
&lt;br&gt;<br>
Also&nbsp;the&nbsp;marshalbool.cs&nbsp;test&nbsp;is&nbsp;still&nbsp;failing&nbsp;for&nbsp;both&nbsp;PPC32&nbsp;and&nbsp;PPC64.&lt;br&gt;<br>
I&nbsp;assume&nbsp;that&nbsp;the&nbsp;required&nbsp;&amp;quot;managed-to-native&nbsp;wrapper&amp;quot;&nbsp;is&nbsp;not&nbsp;being&lt;br&gt;<br>
build/inserted&nbsp;into&nbsp;the&nbsp;call&nbsp;path&nbsp;for&nbsp;this&nbsp;case.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;No&nbsp;idea&nbsp;why&nbsp;that&nbsp;would&nbsp;happen,&nbsp;on&nbsp;my&nbsp;ppc&nbsp;machine&nbsp;a&nbsp;wrapper&nbsp;is&nbsp;inserted,&nbsp;and&nbsp;the&nbsp;relevant&lt;br&gt;code&nbsp;in&nbsp;it&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;(wrapper&nbsp;managed-to-native)&nbsp;marshalbool:mono_test_marshal_bool_in&nbsp;(int,uint,bool,bool,bool,bool,bool)&lt;br&gt;<br>
&lt;br&gt; &nbsp;b8:   &nbsp;99&nbsp;21&nbsp;00&nbsp;44&nbsp;   &nbsp;stb    &nbsp;r9,68(r1)&lt;br&gt;&lt;br&gt; 158:   &nbsp;88&nbsp;61&nbsp;00&nbsp;44&nbsp;   &nbsp;lbz    &nbsp;r3,68(r1)&lt;br&gt; 15c:   &nbsp;2c&nbsp;03&nbsp;00&nbsp;00&nbsp;   &nbsp;cmpwi  &nbsp;r3,0&lt;br&gt; 160:   &nbsp;41&nbsp;82&nbsp;00&nbsp;10&nbsp;   &nbsp;beq-   &nbsp;170&nbsp;&amp;lt;apper_managed_to_native__marshalbool_mono_test_marshal_bool_in+0x170&amp;gt;&lt;br&gt;<br>
 164:   &nbsp;3c&nbsp;60&nbsp;ff&nbsp;ff&nbsp;   &nbsp;lis    &nbsp;r3,-1&lt;br&gt; 168:   &nbsp;60&nbsp;63&nbsp;ff&nbsp;ff&nbsp;   &nbsp;ori    &nbsp;r3,r3,65535&lt;br&gt; 16c:   &nbsp;b0&nbsp;61&nbsp;00&nbsp;36&nbsp;   &nbsp;sth    &nbsp;r3,54(r1)&lt;br&gt;&lt;br&gt; 188:   &nbsp;a9&nbsp;21&nbsp;00&nbsp;36&nbsp;   &nbsp;lha    &nbsp;r9,54(r1)&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;This&nbsp;code&nbsp;converts&nbsp;the&nbsp;1&nbsp;received&nbsp;in&nbsp;r9&nbsp;to&nbsp;-1&nbsp;and&nbsp;passes&nbsp;it&nbsp;to&nbsp;the&nbsp;C&nbsp;function&nbsp;in&nbsp;r9.&lt;br&gt;<br>
&lt;br&gt;               &nbsp;Zoltan&lt;br&gt;<br>

</tt>
