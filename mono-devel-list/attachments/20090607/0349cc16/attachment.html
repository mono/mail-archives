<tt>
&lt;div&gt;Bill,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;feedback.&nbsp;I&nbsp;attach&nbsp;an&nbsp;updated&nbsp;patch&nbsp;that&nbsp;addresses&nbsp;the&nbsp;issues&nbsp;you&nbsp;found.&nbsp;Here&nbsp;are&nbsp;the&nbsp;details:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;1)&nbsp;Failing&nbsp;cominterop.exe&nbsp;tests:&lt;/div&gt;<br>
&lt;div&gt;Sorry&nbsp;for&nbsp;not&nbsp;catching&nbsp;that.&nbsp;There&nbsp;was&nbsp;a&nbsp;flaw&nbsp;in&nbsp;my&nbsp;initial&nbsp;testing&nbsp;approach.&nbsp;Basically&nbsp;I&nbsp;only&nbsp;tested&nbsp;with&nbsp;assemblies&nbsp;compiled&nbsp;with&nbsp;the&nbsp;Microsoft&nbsp;compiler&nbsp;and&nbsp;never&nbsp;tested&nbsp;assemblies&nbsp;compiled&nbsp;with&nbsp;the&nbsp;mono&nbsp;mcs&nbsp;compiler.&nbsp;Due&nbsp;to&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;mcs&nbsp;compiler&nbsp;the&nbsp;SafeArraySubType&nbsp;marshal&nbsp;attribute&nbsp;option&nbsp;was&nbsp;not&nbsp;properly&nbsp;generated.&nbsp;It&nbsp;was&nbsp;being&nbsp;dropped.&nbsp;I&nbsp;fixed&nbsp;that&nbsp;issue&nbsp;in&nbsp;the&nbsp;attached&nbsp;patch&nbsp;by&nbsp;making&nbsp;changes&nbsp;to&nbsp;two&nbsp;files:&nbsp;reflection.c&nbsp;and&nbsp;CustomAttributeBuilder.cs.&lt;/div&gt;<br>
<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;2)&nbsp;Tab&nbsp;problems&nbsp;in&nbsp;cominterop.cs:&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;fixed&nbsp;the&nbsp;issues&nbsp;you&nbsp;noticed&nbsp;in&nbsp;cominterop.cs.&nbsp;I&nbsp;also&nbsp;did&nbsp;one&nbsp;pass&nbsp;on&nbsp;all&nbsp;the&nbsp;files&nbsp;to&nbsp;clean-up&nbsp;tabs,&nbsp;white&nbsp;spaces,&nbsp;formatting,&nbsp;etc.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;3)&nbsp;Changelog&nbsp;entries:&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;updated&nbsp;the&nbsp;changelogs&nbsp;in&nbsp;the&nbsp;3&nbsp;directories&nbsp;where&nbsp;I&nbsp;made&nbsp;changes.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks,&lt;/div&gt;<br>
&lt;div&gt;Sylvain&lt;/div&gt;<br>
&lt;p&gt;On&nbsp;Wed,&nbsp;Jun&nbsp;3,&nbsp;2009&nbsp;at&nbsp;5:02&nbsp;PM,&nbsp;Bill&nbsp;Holmes&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:billholmes54@gmail.com&quot;&gt;billholmes54@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;Sorry&nbsp;I&nbsp;should&nbsp;have&nbsp;mentioned&nbsp;that&nbsp;I&nbsp;tested&nbsp;this&nbsp;on&nbsp;Win32&nbsp;and&nbsp;Winx64.&lt;br&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;On&nbsp;Wed,&nbsp;Jun&nbsp;3,&nbsp;2009&nbsp;at&nbsp;5:00&nbsp;PM,&nbsp;Bill&nbsp;Holmes&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:billholmes54@gmail.com&quot;&gt;billholmes54@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;I&nbsp;tested&nbsp;this&nbsp;patch&nbsp;out&nbsp;and&nbsp;the&nbsp;cominterop.exe&nbsp;test&nbsp;does&nbsp;not&nbsp;work.&nbsp; I&lt;br&gt;<br>
&amp;gt;&nbsp;get&nbsp;a&nbsp;return&nbsp;value&nbsp;of&nbsp;62.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Second&nbsp;I&nbsp;noticed&nbsp;some&nbsp;tab&nbsp;problems&nbsp;with&nbsp;your&nbsp;formatting&nbsp;in&nbsp;cominterop.cs.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Finally&nbsp;It&nbsp;makes&nbsp;it&nbsp;easier&nbsp;for&nbsp;me&nbsp;to&nbsp;commit&nbsp;a&nbsp;patch&nbsp;if&nbsp;you&nbsp;include&lt;br&gt;&amp;gt;&nbsp;ChangeLog&nbsp;entirs.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;&amp;gt;&nbsp;thanks&lt;br&gt;&amp;gt;&nbsp;-bill&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;On&nbsp;Sun,&nbsp;May&nbsp;17,&nbsp;2009&nbsp;at&nbsp;8:43&nbsp;PM,&nbsp;Sylvain&nbsp;Dupont&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:duposyl@gmail.com&quot;&gt;duposyl@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;The&nbsp;patch&nbsp;attached&nbsp;adds&nbsp;support&nbsp;for&nbsp;marshalling&nbsp;out&nbsp;parameters&nbsp;of&nbsp;type&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;SAFEARRAY[VARIANT].&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;tests&nbsp;included&nbsp;in&nbsp;the&nbsp;patch,&nbsp;I&nbsp;have&lt;br&gt;&amp;gt;&amp;gt;&nbsp;also&nbsp;tested&nbsp;this&nbsp;successfully&nbsp;against&nbsp;other&nbsp;COM&nbsp;components,&nbsp;both&nbsp;on&nbsp;Windows&lt;br&gt;&amp;gt;&amp;gt;&nbsp;and&nbsp;Linux&nbsp;(using&nbsp;Mainwin&nbsp;and&nbsp;with&nbsp;the&nbsp;MONO_COM&nbsp;environment&nbsp;variable&nbsp;set&nbsp;to&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;MS).&lt;br&gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;Contributed&nbsp;under&nbsp;MIT/X11&nbsp;license.&lt;br&gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;Thanks,&lt;br&gt;&amp;gt;&amp;gt;&nbsp;Sylvain&lt;br&gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;&amp;gt;&amp;gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
