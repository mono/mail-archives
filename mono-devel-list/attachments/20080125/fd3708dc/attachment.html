<tt>
Paolo,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Thanks&nbsp;for&nbsp;the&nbsp;reviews.&nbsp;I&nbsp;just&nbsp;hardcoded&nbsp;the&nbsp;functions&nbsp;for&nbsp;now,&nbsp;and&nbsp;did&nbsp;the&nbsp;cleanup&nbsp;you&nbsp;requested.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jonathan&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Jan&nbsp;11,&nbsp;2008&nbsp;1:03&nbsp;PM,&nbsp;Paolo&nbsp;Molaro&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:lupus@ximian.com&quot;&gt;lupus@ximian.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;On&nbsp;01/08/08&nbsp;Jonathan&nbsp;Chambers&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Here&nbsp;is&nbsp;the&nbsp;first&nbsp;attempt&nbsp;at&nbsp;a&nbsp;patch.&nbsp;Nothing&nbsp;is&nbsp;changed&nbsp;with&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;default&nbsp;configuration.&nbsp;Things&nbsp;are&nbsp;controlled&nbsp;via&nbsp;an&nbsp;environment&nbsp;variable&lt;br&gt;&amp;gt;&nbsp;(MONO_COM),&nbsp;and&nbsp;extensible&nbsp;using&nbsp;the&nbsp;dllmap&nbsp;in&nbsp;the&nbsp;config&nbsp;file.&nbsp;The&nbsp;only&lt;br&gt;&amp;gt;&nbsp;other&nbsp;current&nbsp;configuration&nbsp;is&nbsp;MONO_MS,&nbsp;which&nbsp;supports&nbsp;Mainsoft&nbsp;COM&lt;br&gt;<br>
&amp;gt;&nbsp;components.&nbsp;If&nbsp;this&nbsp;looks&nbsp;acceptable,&nbsp;I&nbsp;will&nbsp;cleanup&nbsp;any&nbsp;issues&nbsp;and&nbsp;document&lt;br&gt;&amp;gt;&nbsp;the&nbsp;environment&nbsp;variable.&lt;br&gt;&lt;br&gt;&lt;/div&gt;Since&nbsp;we&nbsp;hardcode&nbsp;the&nbsp;functions,&nbsp;I&nbsp;wonder&nbsp;if&nbsp;this&nbsp;should&nbsp;really&nbsp;be&lt;br&gt;configurable.&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;Index:&nbsp;metadata/loader.h&lt;br&gt;<br>
&amp;gt;&nbsp;===================================================================&lt;br&gt;&amp;gt;&nbsp;---&nbsp;metadata/loader.h&nbsp;(revision&nbsp;92458)&lt;br&gt;&amp;gt;&nbsp;+++&nbsp;metadata/loader.h&nbsp;(working&nbsp;copy)&lt;br&gt;&amp;gt;&nbsp;@@&nbsp;-62,6&nbsp;+62,9&nbsp;@@&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;void&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;mono_dllmap_insert&nbsp;(MonoImage&nbsp;*assembly,&nbsp;const&nbsp;char&nbsp;*dll,&nbsp;const&nbsp;char&nbsp;*func,&nbsp;const&nbsp;char&nbsp;*tdll,&nbsp;const&nbsp;char&nbsp;*tfunc);&lt;br&gt;<br>
&amp;gt;&lt;br&gt;&amp;gt;&nbsp;+int&lt;br&gt;&amp;gt;&nbsp;+mono_dllmap_lookup&nbsp;(MonoImage&nbsp;*assembly,&nbsp;const&nbsp;char&nbsp;*dll,&nbsp;const&nbsp;char*&nbsp;func,&nbsp;const&nbsp;char&nbsp;**rdll,&nbsp;const&nbsp;char&nbsp;**rfunc);&lt;br&gt;&lt;br&gt;IIF&nbsp;we&nbsp;expose&nbsp;this,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;MONO_INTERNAL&nbsp;function&nbsp;in&nbsp;a&nbsp;private&lt;br&gt;<br>
header.&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;Index:&nbsp;metadata/marshal.c&lt;br&gt;&amp;gt;&nbsp;===================================================================&lt;br&gt;&amp;gt;&nbsp;---&nbsp;metadata/marshal.c&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;(revision&nbsp;92458)&lt;br&gt;&amp;gt;&nbsp;+++&nbsp;metadata/marshal.c&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;(working&nbsp;copy)&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;mono_string_to_bstr&nbsp;(MonoString&nbsp;*string_obj)&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;{&lt;br&gt;&amp;gt;&nbsp;@@&nbsp;-1082,19&nbsp;+1094,60&nbsp;@@&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;SysAllocStringLen&nbsp;(mono_string_chars&nbsp;(string_obj),&nbsp;mono_string_length&nbsp;(string_obj));&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;#else&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;int&nbsp;slen&nbsp;=&nbsp;mono_string_length&nbsp;(string_obj);&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;char&nbsp;*ret&nbsp;=&nbsp;g_malloc&nbsp;(slen&nbsp;*&nbsp;2&nbsp;+&nbsp;4&nbsp;+&nbsp;2);&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(ret&nbsp;==&nbsp;NULL)&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;memcpy&nbsp;(ret&nbsp;+&nbsp;4,&nbsp;mono_string_chars&nbsp;(string_obj),&nbsp;slen&nbsp;*&nbsp;2);&lt;br&gt;<br>
&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;*&nbsp;((guint32&nbsp;*)&nbsp;ret)&nbsp;=&nbsp;slen&nbsp;*&nbsp;2;&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;ret&nbsp;[4&nbsp;+&nbsp;slen&nbsp;*&nbsp;2]&nbsp;=&nbsp;0;&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;ret&nbsp;[5&nbsp;+&nbsp;slen&nbsp;*&nbsp;2]&nbsp;=&nbsp;0;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(com_provider&nbsp;==&nbsp;MONO_COM_DEFAULT)&nbsp;{&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;int&nbsp;slen&nbsp;=&nbsp;mono_string_length&nbsp;(string_obj);&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;char&nbsp;*ret&nbsp;=&nbsp;g_malloc&nbsp;(slen&nbsp;*&nbsp;2&nbsp;+&nbsp;4&nbsp;+&nbsp;2);&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(ret&nbsp;==&nbsp;NULL)&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;memcpy&nbsp;(ret&nbsp;+&nbsp;4,&nbsp;mono_string_chars&nbsp;(string_obj),&nbsp;slen&nbsp;*&nbsp;2);&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;*&nbsp;((guint32&nbsp;*)&nbsp;ret)&nbsp;=&nbsp;slen;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;ret&nbsp;[4&nbsp;+&nbsp;slen&nbsp;*&nbsp;2]&nbsp;=&nbsp;0;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;ret&nbsp;[5&nbsp;+&nbsp;slen&nbsp;*&nbsp;2]&nbsp;=&nbsp;0;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;-&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;ret&nbsp;+&nbsp;4;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;ret&nbsp;+&nbsp;4;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;else&nbsp;if&nbsp;(com_provider&nbsp;==&nbsp;MONO_COM_MS)&nbsp;{&lt;br&gt;&lt;br&gt;The&nbsp;else&nbsp;goes&nbsp;into&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;closing&nbsp;}.&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;char&nbsp;*error_msg;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;gpointer&nbsp;ret&nbsp;=&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;gunichar*&nbsp;str&nbsp;=&nbsp;NULL;&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;guint32&nbsp;len;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;MonoDl&nbsp;*module&nbsp;=&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;SysAllocStringLenFunc&nbsp;pSysAllocString&nbsp;=&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;const&nbsp;char*&nbsp;scope&nbsp;=&nbsp;&amp;quot;liboleaut32.so&amp;quot;;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;const&nbsp;char*&nbsp;import&nbsp;=&nbsp;&amp;quot;SysAllocStringLen&amp;quot;;&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;const&nbsp;char*&nbsp;new_scope&nbsp;=&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;const&nbsp;char*&nbsp;new_import&nbsp;=&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(mono_dllmap_lookup&nbsp;(mono_defaults.corlib,&nbsp;scope,&nbsp;import,&nbsp;&amp;amp;new_scope,&nbsp;&amp;amp;new_import))&nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;scope&nbsp;=&nbsp;new_scope;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;import&nbsp;=&nbsp;new_import;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;module&nbsp;=&nbsp;mono_dl_open(scope,&nbsp;MONO_DL_LAZY,&nbsp;&amp;amp;error_msg);&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(error_msg)&nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;g_warning&nbsp;(&amp;quot;Error&nbsp;loading&nbsp;COM&nbsp;support&nbsp;library&nbsp;&amp;#39;%s&amp;#39;:&nbsp;%s&amp;quot;,&nbsp;scope,&nbsp;error_msg);&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;g_assert_not_reached&nbsp;();&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;NULL;&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;error_msg&nbsp;=&nbsp;mono_dl_symbol&nbsp;(module,&nbsp;import,&nbsp;(gpointer*)&amp;amp;pSysAllocString);&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(error_msg)&nbsp;{&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;g_warning&nbsp;(&amp;quot;Error&nbsp;loading&nbsp;entry&nbsp;point&nbsp;&amp;#39;%s&amp;#39;&nbsp;in&nbsp;COM&nbsp;support&nbsp;library&nbsp;&amp;#39;%s&amp;#39;:&nbsp;%s&amp;quot;,&nbsp;import,&nbsp;scope,&nbsp;error_msg);&lt;br&gt;<br>
&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;g_assert_not_reached&nbsp;();&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;return&nbsp;NULL;&lt;br&gt;&amp;gt;&nbsp;+&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;Please&nbsp;put&nbsp;this&nbsp;code&nbsp;into&nbsp;its&nbsp;own&nbsp;function&nbsp;and&nbsp;share&nbsp;it&nbsp;with&lt;br&gt;SysStringLen&nbsp;and&nbsp;SysFreeString:&nbsp;the&nbsp;tree&nbsp;lookups&nbsp;should&nbsp;be&nbsp;done&nbsp;at&nbsp;the&lt;br&gt;<br>
same&nbsp;time.&lt;br&gt;Thanks!&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;&lt;br&gt;lupus&lt;br&gt;&lt;br&gt;--&lt;br&gt;-----------------------------------------------------------------&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:lupus@debian.org&quot;&gt;lupus@debian.org&lt;/a&gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;debian/rules&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:lupus@ximian.com&quot;&gt;lupus@ximian.com&lt;/a&gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;Monkeys&nbsp;do&nbsp;it&nbsp;better&lt;br&gt;_______________________________________________&lt;br&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
