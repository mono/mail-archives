<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;gt;&amp;nbsp;&nbsp;You&nbsp;could,&nbsp;but&nbsp;this&nbsp;is&nbsp;not&nbsp;how&nbsp;security&nbsp;evolves&nbsp;;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xD&nbsp;I&nbsp;know.&nbsp;But&nbsp;for&nbsp;now,&nbsp;a&nbsp;quick&nbsp;and&nbsp;dirty&nbsp;hack&nbsp;is&nbsp;better&nbsp;than&nbsp;half&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;year&nbsp;of&nbsp;work.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Looking&nbsp;at:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mono/metadata/loader.c:mono_lookup_pinvoke_call&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;just&nbsp;wanted&nbsp;to&nbsp;say,&nbsp;that&nbsp;looking&nbsp;at&nbsp;the&nbsp;source&nbsp;file,&nbsp;this&nbsp;line<br>
&nbsp;&nbsp;&nbsp;&nbsp;hurt&nbsp;my&nbsp;eye:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;small&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strstr&nbsp;(new_scope,&nbsp;&quot;.dll&quot;)&nbsp;==&nbsp;(new_scope&nbsp;+&nbsp;strlen&nbsp;(new_scope)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;4))&nbsp;{&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;check&nbsp;whether&nbsp;new_scope&nbsp;ends&nbsp;on&nbsp;&quot;.dll&quot;,&nbsp;I&nbsp;wouldn't&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;strstr.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;did&nbsp;this&nbsp;one&nbsp;in&nbsp;an&nbsp;aimbot&nbsp;of&nbsp;mine,&nbsp;like&nbsp;this:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;(urth_aimAtHead.integer&nbsp;!=&nbsp;0)&nbsp;)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;bHeadInModel=&nbsp;(strstr(modelName,&nbsp;&quot;head&quot;))&nbsp;||&nbsp;(strstr(modelName,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;helmet&quot;))&nbsp;;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;when&nbsp;I&nbsp;started&nbsp;the&nbsp;program&nbsp;with&nbsp;this&nbsp;modification&nbsp;(as&nbsp;opposed&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;without&nbsp;this&nbsp;modification),&nbsp;you&nbsp;just&nbsp;heard&nbsp;the&nbsp;fan&nbsp;start&nbsp;going<br>
&nbsp;&nbsp;&nbsp;&nbsp;(every&nbsp;time),&nbsp;as&nbsp;well&nbsp;as&nbsp;a&nbsp;very&nbsp;obvious&nbsp;CPU-performance&nbsp;related<br>
&nbsp;&nbsp;&nbsp;&nbsp;lagging.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;realized&nbsp;I&nbsp;could&nbsp;replace&nbsp;strstr&nbsp;when&nbsp;i&nbsp;just&nbsp;took&nbsp;the&nbsp;ending&nbsp;of&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;full&nbsp;model&nbsp;name,&nbsp;added&nbsp;a&nbsp;strrcmp&nbsp;instead&nbsp;of&nbsp;strstr.&nbsp;So<br>
&nbsp;&nbsp;&nbsp;&nbsp;strstr(modelName,&nbsp;&quot;head&quot;)&nbsp;became&nbsp;!strrcmp(modelName,&nbsp;&quot;head.md3&quot;)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;And&nbsp;my&nbsp;performance&nbsp;problems&nbsp;were&nbsp;gone,&nbsp;and&nbsp;the&nbsp;fan&nbsp;stopped<br>
&nbsp;&nbsp;&nbsp;&nbsp;immediately.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;the&nbsp;strrcmp&nbsp;function&nbsp;I&nbsp;used&nbsp;(origining&nbsp;from&nbsp;BSD&nbsp;libc<br>
&nbsp;&nbsp;&nbsp;&nbsp;extensions,&nbsp;BSD&nbsp;license):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;strrcmp(char*&nbsp;chrptr_SearchIn,&nbsp;char*&nbsp;chrptr_SearchFor)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;size_t&nbsp;szeSearchInLength&amp;nbsp;&nbsp;=&nbsp;strlen(chrptr_SearchIn)&nbsp;;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;size_t&nbsp;szeSearchForLength&nbsp;=&nbsp;strlen(chrptr_SearchFor)&nbsp;;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(szeSearchForLength&nbsp;&amp;gt;&nbsp;szeSearchInLength)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;false&nbsp;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(memcmp(chrptr_SearchIn&nbsp;+&nbsp;szeSearchInLength&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;szeSearchForLength,&nbsp;chrptr_SearchFor,&nbsp;szeSearchForLength))&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;false&nbsp;;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;true&nbsp;;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;09/02/2011&nbsp;06:05&nbsp;PM,&nbsp;Robert&nbsp;Jordan&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:j3qusk$aue$1@dough.gmane.org&quot;&nbsp;type=&quot;cite&quot;&gt;On<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;02.09.2011&nbsp;17:29,&nbsp;quandary82&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Couldn't&nbsp;I&nbsp;hack&nbsp;together&nbsp;my&nbsp;own&nbsp;custom<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mono-runtime&nbsp;version,&nbsp;to&nbsp;block<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DllImport&nbsp;for&nbsp;all&nbsp;dll's&nbsp;that&nbsp;are&nbsp;not&nbsp;in&nbsp;an&nbsp;allowed-dlls&nbsp;list&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Diagnostics.Process.Start&nbsp;as&nbsp;well&nbsp;?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;could,&nbsp;but&nbsp;this&nbsp;is&nbsp;not&nbsp;how&nbsp;security&nbsp;evolves&nbsp;;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;System.Diagnosts.Process&nbsp;would&nbsp;be&nbsp;in&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcs&nbsp;class&nbsp;library,&nbsp;but&nbsp;where&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Starting&nbsp;processes&nbsp;can&nbsp;be&nbsp;prevented&nbsp;with&nbsp;SELinux&nbsp;or&nbsp;AppArmor.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;DllImport&nbsp;?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Is&nbsp;it&nbsp;just&nbsp;an&nbsp;attribute&nbsp;?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;suppose&nbsp;there&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;dlopen/LoadLibrary&nbsp;somewhere<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DllImport&nbsp;is&nbsp;special.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;good&nbsp;place&nbsp;to&nbsp;block&nbsp;p/invokes&nbsp;is:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mono/metadata/loader.c:mono_lookup_pinvoke_call<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;you&nbsp;can&nbsp;look&nbsp;from&nbsp;which&nbsp;assemblies&nbsp;the&nbsp;pinvoke&nbsp;comes&nbsp;from<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etc.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Robert<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_______________________________________________<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
