<tt>
This&nbsp;patch&nbsp;should&nbsp;provide&nbsp;most&nbsp;of&nbsp;the&nbsp;remaining&nbsp;functionality&nbsp;of&nbsp;RCWs.&nbsp;This&nbsp;allows&nbsp;methods/properties&nbsp;to&nbsp;have&nbsp;object&nbsp;parameters&nbsp;(i.e.&nbsp;MarshalAs&nbsp;Interface,&nbsp;IUnknown,&nbsp;and&nbsp;IDispatch).&nbsp;It&nbsp;fixes&nbsp;a&nbsp;warning&nbsp;or&nbsp;two,&nbsp;and&nbsp;also&nbsp;implements&nbsp;two&nbsp;more&nbsp;COM&nbsp;related&nbsp;methods&nbsp;in&nbsp;the&nbsp;Marshal&nbsp;class.&nbsp;Additional&nbsp;tests&nbsp;were&nbsp;also&nbsp;added.&nbsp;I&nbsp;modified&nbsp;it&nbsp;so&nbsp;the&nbsp;previously&nbsp;disabled&nbsp;tests&nbsp;now&nbsp;run&nbsp;only&nbsp;on&nbsp;windows.&nbsp;Theoretically,&nbsp;they&nbsp;should&nbsp;run&nbsp;on&nbsp;all&nbsp;x86/x86-64&nbsp;OSes&nbsp;I&nbsp;believe&nbsp;but&nbsp;I&nbsp;could&nbsp;not&nbsp;find&nbsp;an&nbsp;easy&nbsp;way&nbsp;to&nbsp;enable&nbsp;that.<br>
&lt;br&gt;&lt;br&gt;What's&nbsp;left?&nbsp;I&nbsp;need&nbsp;to&nbsp;handle&nbsp;the&nbsp;LCIDConversionAttribute,&nbsp;support&nbsp;object&nbsp;marshalling&nbsp;in&nbsp;variants,&nbsp;and&nbsp;handle&nbsp;connection&nbsp;point&nbsp;interfaces&nbsp;among&nbsp;other&nbsp;things.&nbsp;I&nbsp;also&nbsp;need&nbsp;to&nbsp;work&nbsp;on&nbsp;the&nbsp;custom&nbsp;marshallers&nbsp;for&nbsp;enumerator&nbsp;support.<br>
&lt;br&gt;&lt;br&gt;Some&nbsp;highlights.&nbsp;There&nbsp;is&nbsp;a&nbsp;bunch&nbsp;of&nbsp;logic&nbsp;in&nbsp;__ComObject&nbsp;and&nbsp;ComInteropProxy&nbsp;to&nbsp;ensure&nbsp;identity&nbsp;of&nbsp;RCWs.&nbsp;Equality&nbsp;checks&nbsp;should&nbsp;work&nbsp;correctly&nbsp;for&nbsp;RCWs.&nbsp;&nbsp;Basically,&nbsp;a&nbsp;RCW&nbsp;is&nbsp;only&nbsp;created&nbsp;once&nbsp;for&nbsp;each&nbsp;COM&nbsp;object,&nbsp;no&nbsp;matter&nbsp;how&nbsp;many&nbsp;times&nbsp;it&nbsp;is&nbsp;marshalled&nbsp;into&nbsp;managed&nbsp;code&nbsp;from&nbsp;unmanaged&nbsp;code.&nbsp;There&nbsp;is&nbsp;a&nbsp;managed&nbsp;reference&nbsp;count&nbsp;of&nbsp;how&nbsp;many&nbsp;times&nbsp;this&nbsp;occurs.&nbsp;<br>
Marshal.ReleaseComObject&nbsp;can&nbsp;then&nbsp;be&nbsp;called&nbsp;that&nbsp;many&nbsp;times&nbsp;before&nbsp;the&nbsp;RCW&nbsp;releases&nbsp;all&nbsp;references&nbsp;to&nbsp;the&nbsp;unmanaged&nbsp;COM&nbsp;object&nbsp;and&nbsp;becomes&nbsp;invalid.&nbsp;This&nbsp;matches&nbsp;MS&nbsp;behavior.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jonathan&lt;br&gt;<br>

</tt>
