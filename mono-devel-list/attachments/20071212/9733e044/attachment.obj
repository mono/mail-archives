<%@ Page Language="C#" AutoEventWireup="true" Title="Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<script runat="server">
	protected override void OnPreInit (EventArgs e) {
		base.OnPreInit (e);
		PageLiveCycle.Text = "[OnPreInit]";
	}
	protected override void OnInit (EventArgs e) {
		base.OnInit (e);
		PageLiveCycle.Text += "[OnInit]";
	}
	protected override void OnInitComplete (EventArgs e) {
		base.OnInitComplete (e);
		PageLiveCycle.Text += "[OnInitComplete]";
	}
	protected override void OnPreLoad (EventArgs e) {
		base.OnPreLoad (e);
		PageLiveCycle.Text += "[OnPreLoad]";
	}
	protected override void OnLoad (EventArgs e) {
		base.OnLoad (e);
		PageLiveCycle.Text += "[OnLoad]";
	}
	protected override void OnLoadComplete (EventArgs e) {
		base.OnLoadComplete (e);
		PageLiveCycle.Text += "[OnLoadComplete]";
	}
	protected override void OnPreRender (EventArgs e) {
		base.OnPreRender (e);
		PageLiveCycle.Text += "[OnPreRender]";
	}
	protected override void OnPreRenderComplete (EventArgs e) {
		base.OnPreRenderComplete (e);
		PageLiveCycle.Text += "[OnPreRenderComplete]";
	}

	protected void Button_Click (object sender, EventArgs e) {
		TextBox1.Text += " " + ((IButtonControl) sender).Text;
		PageLiveCycle.Text += "[Button_Click]";
	}

	protected void Page_Load (object sender, EventArgs e) {
		TextBox1.Text = "";
		Label3.Text = String.Format ("FilePath = {0}, CurrentExecutionPath = {1}", Request.FilePath, Request.CurrentExecutionFilePath);
		Label1.Text = String.Format ("IsPostBack = {0}, IsCallback = {1}, IsCrossPagePostBack = {2}.", IsPostBack, IsCallback, IsCrossPagePostBack);
		Label2.Text = PreviousPage == null ? "null" : PreviousPage.Title;
	}

	protected void ServerTransfer_Click (object sender, EventArgs e) {
		Button_Click (sender, e);
		Server.Transfer ("CrossPagePostBackTarget.aspx");
	}

	protected void LinkButton1_Click (object sender, EventArgs e) {
		Button_Click (sender, e);
		Server.Transfer ("CrossPagePostBackTarget.aspx");
	}

	protected void LinkButton2_Click (object sender, EventArgs e) {
		Button_Click (sender, e);
		Server.Transfer ("CrossPagePostBackTarget.aspx", false);
	}

	protected void LinkButton3_Click (object sender, EventArgs e) {
		Button_Click (sender, e);
		Server.Execute ("CrossPagePostBackTarget.aspx");
	}

	protected void LinkButton4_Click (object sender, EventArgs e) {
		Button_Click (sender, e);
		Server.Execute ("CrossPagePostBackTarget.aspx", false);
	}

	protected void LinkButton5_Click (object sender, EventArgs e) {
		Button_Click (sender, e);
		string path = VirtualPathUtility.ToAbsolute ("~/CrossPagePostBackTarget.aspx");
		Server.Transfer (PageParser.GetCompiledPageInstance (path, MapPath (path), Context), true);
	}

	protected void LinkButton6_Click (object sender, EventArgs e) {
		Button_Click (sender, e);
		string path = VirtualPathUtility.ToAbsolute ("~/CrossPagePostBackTarget.aspx");
		Server.Transfer (PageParser.GetCompiledPageInstance (path, MapPath (path), Context), false);
	}

	protected override NameValueCollection DeterminePostBackMode () {
		return base.DeterminePostBackMode ();
	}
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
	<title>Cross-Page PostBack source page</title>
</head>
<body>
	<form id="form1" runat="server">
		<div>
			<strong>Cross-Page PostBack source page</strong><br />
			<br />
			<asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
			- Text is assigned on button click<br />
			<asp:Button ID="PostBack" runat="server" Text="PostBack" OnClick="Button_Click" />&nbsp;
			<asp:Button ID="CrossPostBack" runat="server" Text="CrossPostBack" OnClick="Button_Click"
				PostBackUrl="CrossPagePostBackTarget.aspx" />&nbsp;
			<asp:Button ID="ServerTransfer" runat="server" OnClick="ServerTransfer_Click" Text="ServerTransfer" /><br />
			<br />
			<asp:Label ID="Label3" runat="server" Text="Label"></asp:Label><br />
			Page:
			<asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
			<br />
			Page Live Cycle:
			<asp:Label ID="PageLiveCycle" runat="server" Text="Label" EnableViewState="False"></asp:Label><br />
			PreviousPage:
			<asp:Label ID="Label2" runat="server" Text="Label"></asp:Label>
			<br />
			<br />
			<a href="http://msdn2.microsoft.com/en-us/library/ms178139.aspx">http://msdn2.microsoft.com/en-us/library/ms178139.aspx</a><br />
			<a href="http://msdn2.microsoft.com/en-us/library/ms178141.aspx">http://msdn2.microsoft.com/en-us/library/ms178141.aspx</a></div>
		<br />
		<br />
		<div>
			<asp:LinkButton ID="LinkButton1" runat="server" OnClick="LinkButton1_Click">Transfer with form</asp:LinkButton><br />
			<asp:LinkButton ID="LinkButton2" runat="server" OnClick="LinkButton2_Click">Transfer w/o form</asp:LinkButton><br />
			<asp:LinkButton ID="LinkButton3" runat="server" OnClick="LinkButton3_Click">Execute with form</asp:LinkButton><br />
			<asp:LinkButton ID="LinkButton4" runat="server" OnClick="LinkButton4_Click">Execute w/o form</asp:LinkButton><br />
			<asp:LinkButton ID="LinkButton5" runat="server" OnClick="LinkButton5_Click">Transfer with form (IHttpHandler)</asp:LinkButton><br />
			<asp:LinkButton ID="LinkButton6" runat="server" OnClick="LinkButton6_Click">Transfer w/o form (IHttpHandler)</asp:LinkButton><br />
		</div>
	</form>
</body>
</html>
