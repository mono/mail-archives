Index: ChangeLog
===================================================================
--- ChangeLog	(revision 65900)
+++ ChangeLog	(working copy)
@@ -1,3 +1,9 @@
+2006-09-26  Joerg Rosenkranz  <joergr@voelcker.com>
+
+    * System.Data.OracleClient.Oci/OciDefineHandle.cs:
+        - Buffer length in DefineChar is now computed using UTF8.GetMaxByteCount.
+          This prevents data with more than 2 bytes per character from being truncated.
+
 2006-09-12	Boris Kirzner <borisk@mainsoft.com>
 
 	* run-tests.test.bat: small fixes for TARGET_JVM test scripts.
Index: System.Data.OracleClient.Oci/OciDefineHandle.cs
===================================================================
--- System.Data.OracleClient.Oci/OciDefineHandle.cs	(revision 65900)
+++ System.Data.OracleClient.Oci/OciDefineHandle.cs	(working copy)
@@ -263,9 +263,8 @@
 		{
 			fieldType = typeof (System.String);
 
-			// The buffer is able to contain twice the defined size
-			// to allow usage of multibyte characters
-			value = Marshal.AllocHGlobal (definedSize * 2);
+			int maxByteCount = Encoding.UTF8.GetMaxByteCount (definedSize);
+			value = Marshal.AllocHGlobal (maxByteCount);
 
 			ociType = OciDataType.Char;
 
@@ -276,7 +275,7 @@
 						ErrorHandle,
 						position + 1,
 						value,
-						definedSize * 2,
+						maxByteCount,
 						ociType,
 						ref indicator,
 						ref rlenp,