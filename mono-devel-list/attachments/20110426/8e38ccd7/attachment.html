<tt>
Ivo,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Both&nbsp;RCWs&nbsp;and&nbsp;CCWs&nbsp;should&nbsp;be&nbsp;working&nbsp;in&nbsp;mono.&nbsp;Please&nbsp;post&nbsp;more&nbsp;details&nbsp;of&nbsp;the&nbsp;issues&nbsp;you&nbsp;are&nbsp;hitting.&nbsp;I&nbsp;am&nbsp;using&nbsp;both&nbsp;RCWs&nbsp;and&nbsp;CCWs&nbsp;extensively&nbsp;in&nbsp;my&nbsp;applications.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;InterfaceType attribute&nbsp;is&nbsp;interesting.&nbsp;I&nbsp;believe&nbsp;interfaces&nbsp;are&nbsp;dual&nbsp;by&nbsp;default&nbsp;(IDispatch&nbsp;based&nbsp;with&nbsp;a&nbsp;vtable),&nbsp;so&nbsp;if&nbsp;your&nbsp;interfaces&nbsp;really&nbsp;are&nbsp;dual&nbsp;this&nbsp;should&nbsp;work.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Jonathan&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Apr&nbsp;26,&nbsp;2011&nbsp;at&nbsp;4:47&nbsp;PM,&nbsp;Ivo&nbsp;Smits&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:Ivo@ufo-net.nl&quot;&gt;Ivo@ufo-net.nl&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;In&nbsp;Mono&nbsp;COM/XPCOM&nbsp;interop,&nbsp;Runtime&nbsp;Callable&nbsp;Wrappers&nbsp;appear&nbsp;to&nbsp;be&lt;br&gt;<br>
implemented&nbsp;and&nbsp;work&nbsp;correctly&nbsp;with&nbsp;VirtualBox,&nbsp;although&nbsp;it&amp;#39;s&nbsp;not&lt;br&gt;<br>
directly&nbsp;compatible&nbsp;with&nbsp;COM&nbsp;interop&nbsp;in&nbsp;the&nbsp;Microsoft&nbsp;.Net&nbsp;runtime:&nbsp;the&lt;br&gt;<br>
interop&nbsp;assemblies&nbsp;generated&nbsp;by&nbsp;VS.Net&nbsp;cause&nbsp;crashes&nbsp;(segmentation&lt;br&gt;<br>
fault)&nbsp;and&nbsp;for&nbsp;interfaces&nbsp;written&nbsp;in&nbsp;C#,&nbsp;Mono&nbsp;needs&nbsp;the&lt;br&gt;<br>
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]&nbsp;attribute&nbsp;on&nbsp;the&lt;br&gt;<br>
interfaces,&nbsp;while&nbsp;this&nbsp;attribute&nbsp;breaks&nbsp;the&nbsp;interface&nbsp;in&nbsp;MS&nbsp;.Net.&nbsp;If&lt;br&gt;<br>
anyone&nbsp;has&nbsp;more&nbsp;information,&nbsp;or&nbsp;would&nbsp;like&nbsp;to&nbsp;have&nbsp;more&nbsp;information,&nbsp;let&lt;br&gt;<br>
me&nbsp;know.&nbsp;For&nbsp;now,&nbsp;I&nbsp;will&nbsp;work&nbsp;around&nbsp;this&nbsp;by&nbsp;using&nbsp;different,&nbsp;equally&lt;br&gt;<br>
named&nbsp;interop&nbsp;assemblies&nbsp;exposing&nbsp;the&nbsp;same&nbsp;interfaces.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;not&nbsp;been&nbsp;able&nbsp;to&nbsp;get&nbsp;COM&nbsp;Callable&nbsp;Wrappers&nbsp;to&nbsp;work&nbsp;yet.&nbsp;I&nbsp;can&nbsp;get&lt;br&gt;<br>
an&nbsp;IUnknown&nbsp;interface&nbsp;pointer&nbsp;for&nbsp;the&nbsp;managed&nbsp;object&nbsp;(using&lt;br&gt;<br>
Marshal.GetIUnknownForObject),&nbsp;I&nbsp;can&nbsp;use&nbsp;Marshal.AddRef&nbsp;on&nbsp;this&nbsp;pointer,&lt;br&gt;<br>
and&nbsp;I&nbsp;can&nbsp;pass&nbsp;this&nbsp;pointer&nbsp;to&nbsp;the&nbsp;COM&nbsp;code.&nbsp;Presumably&nbsp;when&nbsp;the&nbsp;COM&lt;br&gt;<br>
code&nbsp;makes&nbsp;a&nbsp;call&nbsp;on&nbsp;the&nbsp;CCW&nbsp;interface,&nbsp;a&nbsp;segmentation&nbsp;fault&nbsp;occurs.&lt;br&gt;<br>
This&nbsp;is&nbsp;still&nbsp;pretty&nbsp;much&nbsp;a&nbsp;black&nbsp;box&nbsp;for&nbsp;me,&nbsp;so&nbsp;before&nbsp;I&nbsp;investigate&lt;br&gt;<br>
any&nbsp;further:&nbsp;have&nbsp;CCWs&nbsp;been&nbsp;implemented&nbsp;in&nbsp;Mono&nbsp;and&nbsp;are&nbsp;they&nbsp;supposed&nbsp;to&lt;br&gt;<br>
work?&nbsp;Has&nbsp;anyone&nbsp;successfully&nbsp;used&nbsp;them?&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;crash&nbsp;is&nbsp;short&nbsp;and&nbsp;not&nbsp;very&nbsp;useful:&lt;br&gt;<br>
Native&nbsp;stacktrace:&lt;br&gt;<br>
&lt;br&gt;<br>
Segmentatiefout&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
Ivo&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
