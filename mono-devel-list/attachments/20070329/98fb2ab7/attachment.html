<tt>
Hi,&lt;br&gt;&lt;br&gt;Basically,&nbsp;i&nbsp;have&nbsp;a&nbsp;major&nbsp;(ish)&nbsp;problem&nbsp;in&nbsp;monotorrent&nbsp;with&nbsp;Mono&nbsp;1.2.1&nbsp;and&nbsp;above.&nbsp;After&nbsp;spending&nbsp;a&nbsp;few&nbsp;hours&nbsp;backtracking&nbsp;through&nbsp;svn&nbsp;revisions,&nbsp;i&amp;#39;ve&nbsp;managed&nbsp;to&nbsp;place&nbsp;the&nbsp;origin&nbsp;of&nbsp;the&nbsp;problem&nbsp;to&nbsp;between&nbsp;revision&nbsp;72227&nbsp;and&nbsp;72228&nbsp;of&nbsp;monotorrent&nbsp;in&nbsp;the&nbsp;mono&nbsp;svn.<br>
&lt;br&gt;&lt;br&gt;To&nbsp;generate&nbsp;the&nbsp;diff&nbsp;just&nbsp;use:&nbsp;svn&nbsp;diff&nbsp;-r&nbsp;72227:72228&nbsp;svn://svn.myrealbox.com/source/trunk/bitsharp&nbsp;.&nbsp;I&amp;#39;ve&nbsp;also&nbsp;attached&nbsp;the&nbsp;diff.&lt;br&gt;&lt;br&gt;The&nbsp;changes&nbsp;in&nbsp;this&nbsp;diff&nbsp;are&nbsp;solely&nbsp;related&nbsp;to&nbsp;a&nbsp;refactor&nbsp;where&nbsp;i&nbsp;moved&nbsp;three&nbsp;seperate&nbsp;lists&nbsp;into&nbsp;one&nbsp;main&nbsp;PeerList&nbsp;class.&nbsp;Now,&nbsp;after&nbsp;careful&nbsp;examination&nbsp;of&nbsp;that&nbsp;diff,&nbsp;i&nbsp;just&nbsp;can&amp;#39;t&nbsp;see&nbsp;anything&nbsp;in&nbsp;it&nbsp;that&nbsp;would&nbsp;cause&nbsp;the&nbsp;problems&nbsp;i&amp;#39;m&nbsp;seeing.&nbsp;Also,&nbsp;to&nbsp;further&nbsp;complicate&nbsp;matters,&nbsp;if&nbsp;i&nbsp;step&nbsp;back&nbsp;to&nbsp;the&nbsp;mono&nbsp;<br>
1.2&nbsp;release,&nbsp;everything&nbsp;appears&nbsp;to&nbsp;work&nbsp;perfectly.&lt;br&gt;&lt;br&gt;&lt;br&gt;Now,&nbsp;the&nbsp;actual&nbsp;bug&nbsp;is&nbsp;that&nbsp;memory&nbsp;usage&nbsp;rockets&nbsp;to&nbsp;100%&nbsp;after&nbsp;a&nbsp;very&nbsp;short&nbsp;running&nbsp;time.&nbsp;Typically&nbsp;30&nbsp;seconds&nbsp;is&nbsp;plenty&nbsp;of&nbsp;time&nbsp;for&nbsp;the&nbsp;bug&nbsp;to&nbsp;manifest&nbsp;on&nbsp;a&nbsp;well&nbsp;seeded&nbsp;torrent.&nbsp;I&amp;#39;ve&nbsp;seen&nbsp;this&nbsp;problem&nbsp;once&nbsp;before&nbsp;on&nbsp;completely&nbsp;different&nbsp;code&nbsp;(however&nbsp;i&nbsp;can&amp;#39;t&nbsp;remember&nbsp;who&nbsp;i&nbsp;was&nbsp;helping&nbsp;track&nbsp;down&nbsp;the&nbsp;source,&nbsp;but&nbsp;it&nbsp;was&nbsp;a&nbsp;guy&nbsp;on&nbsp;#mono).&nbsp;His&nbsp;code&nbsp;was&nbsp;a&nbsp;crawler&nbsp;for&nbsp;another&nbsp;P2P&nbsp;network&nbsp;and&nbsp;after&nbsp;a&nbsp;similar&nbsp;amount&nbsp;of&nbsp;time,&nbsp;it&nbsp;would&nbsp;hit&nbsp;100%&nbsp;memory&nbsp;usage&nbsp;aswell.&nbsp;I&nbsp;profiled&nbsp;his&nbsp;code&nbsp;using&nbsp;the&nbsp;mono&nbsp;profiler&nbsp;and&nbsp;eventually&nbsp;managed&nbsp;to&nbsp;get&nbsp;some&nbsp;usable&nbsp;output&nbsp;which&nbsp;pointed&nbsp;out&nbsp;that&nbsp;he&nbsp;was&nbsp;allocating&nbsp;10000&amp;#39;s&nbsp;of&nbsp;instances&nbsp;of&nbsp;multi-cast&nbsp;delegates&nbsp;which&nbsp;were&nbsp;just&nbsp;eating&nbsp;memory.&nbsp;At&nbsp;the&nbsp;time,&nbsp;i&nbsp;put&nbsp;this&nbsp;down&nbsp;to&nbsp;bad&nbsp;programming&nbsp;or&nbsp;incorrect&nbsp;usage&nbsp;of&nbsp;async&nbsp;sockets.<br>
&lt;br&gt;&lt;br&gt;So,&nbsp;the&nbsp;thing&nbsp;is&nbsp;i&nbsp;can&amp;#39;t&nbsp;track&nbsp;down&nbsp;what&amp;#39;s&nbsp;causing&nbsp;the&nbsp;memory&nbsp;usage&nbsp;in&nbsp;monotorrent.&nbsp;I&nbsp;have&nbsp;no&nbsp;idea&nbsp;how&nbsp;to&nbsp;even&nbsp;start.&nbsp;I&amp;#39;ve&nbsp;tried&nbsp;using&nbsp;the&nbsp;built&nbsp;in&nbsp;profilers,&nbsp;but&nbsp;they&nbsp;require&nbsp;a&nbsp;graceful&nbsp;exit&nbsp;before&nbsp;they&nbsp;output&nbsp;their&nbsp;data,&nbsp;and&nbsp;unfortunately&nbsp;i&nbsp;can&amp;#39;t&nbsp;get&nbsp;them&nbsp;a&nbsp;graceful&nbsp;exit&nbsp;;)<br>
&lt;br&gt;&lt;br&gt;If&nbsp;anyone&nbsp;has&nbsp;any&nbsp;ideas&nbsp;on&nbsp;how&nbsp;i&nbsp;could&nbsp;track&nbsp;this&nbsp;problem,&nbsp;or&nbsp;if&nbsp;they&nbsp;need&nbsp;more&nbsp;information,&nbsp;please&nbsp;let&nbsp;me&nbsp;know.&nbsp;I&amp;#39;m&nbsp;going&nbsp;demented&nbsp;trying&nbsp;to&nbsp;figure&nbsp;out&nbsp;the&nbsp;problem&nbsp;;)&lt;br&gt;&lt;br&gt;Also,&nbsp;for&nbsp;anyone&nbsp;trying&nbsp;to&nbsp;compile&nbsp;revision&nbsp;72227&nbsp;from&nbsp;svn,&nbsp;you&nbsp;will&nbsp;need&nbsp;the&nbsp;&amp;quot;<br>
BufferedFileRead.cs&amp;quot;&nbsp;and&nbsp;&amp;quot;BufferedFileWrite.cs&amp;quot;&nbsp;classes&nbsp;which&nbsp;were&nbsp;commited&nbsp;in&nbsp;rev&nbsp;72228.&nbsp;I&nbsp;accidently&nbsp;left&nbsp;them&nbsp;out&nbsp;of&nbsp;a&nbsp;previous&nbsp;commit.&nbsp;Revision&nbsp;72228&nbsp;will&nbsp;compile&nbsp;fine&nbsp;(i&nbsp;hope)&nbsp;from&nbsp;a&nbsp;fresh&nbsp;checkout&nbsp;with&nbsp;no&nbsp;messing.<br>
&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Alan.&lt;br&gt;<br>

</tt>
