<tt>
Hello&nbsp;Josh,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;You&nbsp;didn&amp;#39;t&nbsp;post&nbsp;the&nbsp;signature&nbsp;of&nbsp;your&nbsp;pinvoke&nbsp;function,&nbsp;but&nbsp;it&nbsp;looks&nbsp;like&nbsp;you&nbsp;are&nbsp;trying&nbsp;to&nbsp;marshal&nbsp;a&nbsp;string&nbsp;using&nbsp;UnmanagedType.&lt;span&nbsp;class=&quot;selflink&quot;&gt;VBByRefStr.&nbsp;This&nbsp;does&nbsp;seem&nbsp;to&nbsp;be&nbsp;a&nbsp;limitation&nbsp;in&nbsp;mono&nbsp;(and&nbsp;not&nbsp;fixed&nbsp;in&nbsp;svn&nbsp;head),&nbsp;however&nbsp;the&nbsp;docs&nbsp;seem&nbsp;to&nbsp;indicate&nbsp;that&nbsp;this&nbsp;should&nbsp;only&nbsp;be&nbsp;used&nbsp;for&nbsp;VB&nbsp;compatibility.&nbsp;If&nbsp;you&nbsp;are&nbsp;changing/return&nbsp;the&nbsp;string&nbsp;in&nbsp;unmanaged,&nbsp;you&nbsp;need&nbsp;to&nbsp;use&nbsp;a&nbsp;StringBuilder.&nbsp;If&nbsp;you&nbsp;are&nbsp;only&nbsp;passing&nbsp;a&nbsp;string&nbsp;in,&nbsp;you&nbsp;can&nbsp;just&nbsp;pass&nbsp;a&nbsp;string&nbsp;(and&nbsp;specify&nbsp;the&nbsp;native&nbsp;string&nbsp;type).&lt;br&gt;<br>
&lt;br&gt;See&nbsp;this&nbsp;great&nbsp;page&nbsp;on&nbsp;the&nbsp;wiki&nbsp;for&nbsp;more&nbsp;info:&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.mono-project.com/Interop_with_Native_Libraries&quot;&gt;http://www.mono-project.com/Interop_with_Native_Libraries&lt;/a&gt;&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Jonathan&lt;br&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2008/4/4&nbsp;Josh&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:TwoOneSix@thatclothingco.com&quot;&gt;TwoOneSix@thatclothingco.com&lt;/a&gt;&amp;gt;:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Mono&nbsp;is&nbsp;throwing&nbsp;me&nbsp;the&nbsp;error&nbsp;&amp;quot;string&nbsp;marshalling&nbsp;conversion&nbsp;34&nbsp;not&nbsp;implemented&amp;quot;&nbsp;when&nbsp;I&amp;#39;m&nbsp;attempting&nbsp;to&nbsp;call&nbsp;a&nbsp;function&nbsp;to&nbsp;libvlc.dll&nbsp;from&nbsp;my&nbsp;code.&nbsp;The&nbsp;other&nbsp;calls&nbsp;to&nbsp;the&nbsp;DLL&nbsp;work&nbsp;fine,&nbsp;but&nbsp;the&nbsp;AddTarget&nbsp;Function&nbsp;causes&nbsp;the&nbsp;error.&nbsp;I&amp;#39;m&nbsp;getting&nbsp;the&nbsp;same&nbsp;results&nbsp;on&nbsp;both&nbsp;Windows&nbsp;and&nbsp;Linux&nbsp;versions.&lt;br&gt;<br>
<br>
&lt;br&gt;[AddTarget&nbsp;Function]&lt;br&gt;===============================&lt;br&gt;public&nbsp;Err&nbsp;AddTarget(string&nbsp;Target)&nbsp;&lt;br&gt;{&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;((m_iVlcHandle&nbsp;==&nbsp;-1))&nbsp;{&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;m_strLastErr&nbsp;=&nbsp;&amp;quot;LibVlc&nbsp;is&nbsp;not&nbsp;initialzed&amp;quot;;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;Err.NoInit;&nbsp;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Err&nbsp;enmErr&nbsp;=&nbsp;Err.Success;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;try&nbsp;{&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;enmErr&nbsp;=&nbsp;VLC_AddTarget(m_iVlcHandle,&nbsp;Target,&nbsp;null,&nbsp;0,&nbsp;(int)Mode.Append,&nbsp;(int)Pos.Close);&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;catch&nbsp;(Exception&nbsp;ex)&nbsp;{&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;m_strLastErr&nbsp;=&nbsp;ex.Message;&nbsp;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;Err.Execption;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(((int)enmErr&nbsp;&amp;lt;&nbsp;0))&nbsp;{&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;m_strLastErr&nbsp;=&nbsp;VLC_Err((int)enmErr);&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;enmErr;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;OK&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;Err.Success;&nbsp;&lt;br&gt;}&nbsp;&lt;br&gt;===============================&lt;br&gt;<br>
<br>
&lt;br&gt;[Mono&nbsp;Details&nbsp;-&nbsp;Windows]&lt;br&gt;===============================&lt;br&gt;Mono&nbsp;JIT&nbsp;compiler&nbsp;version&nbsp;1.9&nbsp;(tarball)&lt;br&gt;Copyright&nbsp;(C)&nbsp;2002-2007&nbsp;Novell,&nbsp;Inc&nbsp;and&nbsp;Contributors.&nbsp;&lt;a&nbsp;href=&quot;http://www.mono-project.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.mono-project.com&lt;/a&gt;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;TLS:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;normal&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;GC:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Included&nbsp;Boehm&nbsp;(with&nbsp;typed&nbsp;GC)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;SIGSEGV:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;normal&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Notification:&amp;nbsp;&nbsp;Thread&nbsp;+&nbsp;polling&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Architecture:&amp;nbsp;&nbsp;x86&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Disabled:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;none&lt;br&gt;<br>
<br>
===============================&lt;br&gt;&lt;br&gt;[Mono&nbsp;Details&nbsp;-&nbsp;Linux]&lt;br&gt;===============================&lt;br&gt;Mono&nbsp;JIT&nbsp;compiler&nbsp;version&nbsp;1.9&nbsp;(tarball)&lt;br&gt;Copyright&nbsp;(C)&nbsp;2002-2007&nbsp;Novell,&nbsp;Inc&nbsp;and&nbsp;Contributors.&nbsp;&lt;a&nbsp;href=&quot;http://www.mono-project.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.mono-project.com&lt;/a&gt;&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;TLS:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;__thread&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;GC:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Included&nbsp;Boehm&nbsp;(with&nbsp;typed&nbsp;GC)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;SIGSEGV:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;normal&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Notifications:&nbsp;epoll&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Architecture:&amp;nbsp;&nbsp;x86&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Disabled:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;none&lt;br&gt;===============================&lt;br&gt;<br>
<br>
&lt;br&gt;Any&nbsp;ideas?&nbsp;Might&nbsp;this&nbsp;be&nbsp;fixed&nbsp;in&nbsp;HEAD?&nbsp;I&amp;#39;m&nbsp;also&nbsp;up&nbsp;to&nbsp;using&nbsp;a&nbsp;different&nbsp;media&nbsp;player&nbsp;that&nbsp;is&nbsp;&amp;quot;known&nbsp;to&nbsp;work&amp;quot;&nbsp;in&nbsp;mono.&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;Josh&lt;br&gt;<br>
&lt;/font&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
