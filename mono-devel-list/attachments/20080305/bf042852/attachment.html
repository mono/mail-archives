<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Hello&nbsp;everyone.&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;help&nbsp;me&nbsp;translating&nbsp;one&nbsp;function&nbsp;in&nbsp;the&nbsp;correct&nbsp;way&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;a&nbsp;library&nbsp;from&nbsp;which&nbsp;I&nbsp;have&nbsp;to&nbsp;use&nbsp;some&nbsp;methods&nbsp;which&nbsp;is&nbsp;written<br>
in&nbsp;C++.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;method&nbsp;I&nbsp;need&nbsp;to&nbsp;correctly&nbsp;translate&nbsp;is&nbsp;this:&lt;br&gt;<br>
&lt;b&gt;integer&nbsp;method_name(const&nbsp;void*&nbsp;a_handle,&nbsp;char*&nbsp;name,&nbsp;int*&nbsp;length)&lt;/b&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Now,&nbsp;what&nbsp;I&nbsp;tried&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;b&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[DllImport&nbsp;(libraryName,&nbsp;EntryPoint&nbsp;=&nbsp;&quot;method_name&quot;,&nbsp;CharSet<br>
=&nbsp;CharSet.Auto,&nbsp;CallingConvention&nbsp;=&nbsp;CallingConvention.StdCall)]&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;unsafe&nbsp;extern&nbsp;integer&nbsp;EXT_method_name(void*<br>
handle,&nbsp;out&nbsp;string&nbsp;name,&nbsp;out&nbsp;int&nbsp;length);&lt;/b&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
when&nbsp;I&nbsp;test&nbsp;the&nbsp;code&nbsp;I&nbsp;receive&nbsp;an&nbsp;integer&nbsp;that&nbsp;informs&nbsp;me&nbsp;that&nbsp;I<br>
delivered&nbsp;Invalid&nbsp;parameters&lt;br&gt;<br>
&lt;br&gt;<br>
Next&nbsp;I&nbsp;tried&amp;nbsp;&nbsp;this:&lt;br&gt;<br>
&lt;b&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[DllImport&nbsp;(libraryName,&nbsp;EntryPoint&nbsp;=&nbsp;&quot;method_name&quot;,&nbsp;CharSet<br>
=<br>
CharSet.Auto,&nbsp;CallingConvention&nbsp;=&nbsp;CallingConvention.StdCall)]&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;unsafe&nbsp;extern&nbsp;integer&nbsp;EXT_method_name(void*<br>
handle,&nbsp;StringBuilder&nbsp;name,&nbsp;ref&nbsp;int&nbsp;length);&lt;/b&gt;&lt;br&gt;<br>
this&nbsp;doesn't&nbsp;work&nbsp;either&lt;br&gt;<br>
&lt;br&gt;<br>
Then&nbsp;I&nbsp;tried&nbsp;this:&lt;br&gt;<br>
&lt;b&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[DllImport&nbsp;(libraryName,&nbsp;EntryPoint&nbsp;=&nbsp;&quot;method_name&quot;,&nbsp;CharSet<br>
=<br>
CharSet.Auto,&nbsp;CallingConvention&nbsp;=&nbsp;CallingConvention.StdCall)]&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;unsafe&nbsp;extern&nbsp;integer&nbsp;EXT_method_name(IntPtr<br>
handle,&nbsp;StringBuilder&nbsp;name,&nbsp;out&nbsp;int&nbsp;length);&lt;/b&gt;&lt;br&gt;<br>
and&nbsp;this&nbsp;doesn't&nbsp;work&nbsp;either&nbsp;:(&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;a&nbsp;similar&nbsp;method&nbsp;which&nbsp;works&nbsp;and&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;b&gt;integer&nbsp;method_name(const&nbsp;void*&nbsp;a_handle,&nbsp;int*&nbsp;length)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/b&gt;And&nbsp;my&nbsp;working&nbsp;&quot;translation&quot;&nbsp;is&nbsp;this:&lt;br&gt;<br>
&lt;b&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[DllImport&nbsp;(libraryName,&nbsp;EntryPoint&nbsp;=&nbsp;&quot;method_name&quot;,&nbsp;CharSet<br>
=<br>
CharSet.Auto,&nbsp;CallingConvention&nbsp;=&nbsp;CallingConvention.StdCall)]&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;unsafe&nbsp;extern&nbsp;integer&nbsp;EXT_method_name(void*<br>
handle,&nbsp;out&nbsp;int&nbsp;length);&lt;/b&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Any&nbsp;ideas&nbsp;about&nbsp;what&nbsp;I&nbsp;did&nbsp;wrong?&nbsp;I'm&nbsp;a&nbsp;total&nbsp;newbie&nbsp;with&nbsp;Interop<br>
communication&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;understood&nbsp;correctly&nbsp;that&nbsp;when&nbsp;I&nbsp;pass&nbsp;strings&nbsp;as&nbsp;parameters&nbsp;to&nbsp;that<br>
external&nbsp;method&nbsp;I&nbsp;have&nbsp;to&nbsp;Marshal&nbsp;them,&nbsp;but&nbsp;when&nbsp;I&nbsp;need&nbsp;strings&nbsp;as<br>
output...&nbsp;how&nbsp;&lt;br&gt;<br>
should&nbsp;I&nbsp;do&nbsp;this?&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;mono's&nbsp;wiki&nbsp;there&nbsp;is&nbsp;an&nbsp;example&nbsp;with&nbsp;StringBuilder&nbsp;(the&nbsp;strncpy<br>
example),&nbsp;but&nbsp;either&nbsp;I&nbsp;did&nbsp;something&nbsp;wrong&nbsp;or&nbsp;some&nbsp;different&nbsp;approach<br>
is&nbsp;needed.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Thank&nbsp;you&nbsp;for&nbsp;all&nbsp;your&nbsp;efforts&nbsp;in&nbsp;helping&nbsp;me&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
With&nbsp;kind&nbsp;regards,&lt;br&gt;<br>
Sebastian&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
