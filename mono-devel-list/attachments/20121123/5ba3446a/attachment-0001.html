<tt>
Hello,&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
&lt;div&gt;I&#39;m&nbsp;currently&nbsp;implementing&nbsp;REPL&nbsp;functionality&nbsp;in&nbsp;my&nbsp;app&nbsp;that&nbsp;embeds&nbsp;mono&nbsp;runtime&nbsp;(3.0.1),&nbsp;and&nbsp;I&#39;ve&nbsp;encountered&nbsp;some&nbsp;issues&nbsp;when&nbsp;evaluating&nbsp;code&nbsp;that&nbsp;contains&nbsp;dynamic&nbsp;invocation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;For&nbsp;example,&nbsp;consider&nbsp;this&nbsp;simple&nbsp;dynamic&nbsp;class:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;public&nbsp;class&nbsp;Foo&nbsp;:&nbsp;DynamicObject&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;public&nbsp;override&nbsp;bool&nbsp;TryGetMember(GetMemberBinder&nbsp;binder,&nbsp;out&nbsp;object&nbsp;result)&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt; &lt;/span&gt;{&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;result&nbsp;=&nbsp;5;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;return&nbsp;true;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;}&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;following&nbsp;Evaluator&nbsp;initialization:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;var&nbsp;settings&nbsp;=&nbsp;new&nbsp;CompilerSettings();&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;var&nbsp;printer&nbsp;=&nbsp;new&nbsp;ConsoleReportPrinter();&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;eval&nbsp;=&nbsp;new&nbsp;Evaluator(new&nbsp;CompilerContext(settings,&nbsp;printer));&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;eval.ReferenceAssembly(typeof(REPL).Assembly);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;eval.Run(&quot;using&nbsp;System;&quot;);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;the&nbsp;evaluation&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;dynamic&nbsp;f&nbsp;=&nbsp;new&nbsp;Program.Foo();&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;f.Whatever;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;gives&nbsp;following&nbsp;error:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;error&nbsp;CS0518:&nbsp;The&nbsp;predefined&nbsp;type&nbsp;Microsoft.CSharp.RuntimeBinder.Binder&#39;&nbsp;is&nbsp;not defined&nbsp;or&nbsp;imported (1,4):&nbsp;error&nbsp;CS1969:&nbsp;Dynamic&nbsp;operation&nbsp;cannot&nbsp;be&nbsp;compiled&nbsp;without&nbsp;`Microsoft.CSharp.dll&#39;&nbsp;assembly&nbsp;reference.&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;strange,&nbsp;are&nbsp;you&nbsp;embedding&nbsp;correct&nbsp;runtime&nbsp;version&nbsp;(4.0)&nbsp;?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;tried&nbsp;to&nbsp;cook&nbsp;full&nbsp;sample&nbsp;based&nbsp;on&nbsp;your&nbsp;code&nbsp;and&nbsp;it&nbsp;works&nbsp;without&nbsp;error&nbsp;for&nbsp;me&nbsp;as&nbsp;a&nbsp;standalone&nbsp;app.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;using&nbsp;System;&lt;/div&gt;&lt;div&gt;using&nbsp;System.Dynamic;&lt;/div&gt;&lt;div&gt;using&nbsp;Mono.CSharp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;public&nbsp;class&nbsp;Foo&nbsp;:&nbsp;DynamicObject&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;public&nbsp;override&nbsp;bool&nbsp;TryGetMember(GetMemberBinder&nbsp;binder,&nbsp;out&nbsp;object&nbsp;result)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(&quot;called&quot;);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;result&nbsp;=&nbsp;5;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;true;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;}&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;class&nbsp;C&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;public&nbsp;static&nbsp;void&nbsp;Main()&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;var&nbsp;settings&nbsp;=&nbsp;new&nbsp;CompilerSettings();&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;var&nbsp;printer&nbsp;=&nbsp;new&nbsp;ConsoleReportPrinter();&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;var&nbsp;eval&nbsp;=&nbsp;new&nbsp;Evaluator(new&nbsp;CompilerContext(settings,&nbsp;printer));&lt;/div&gt;&lt;div&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;eval.ReferenceAssembly(typeof(Foo).Assembly);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;eval.Run(&quot;using&nbsp;System;&quot;);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;eval.Run(&quot;dynamic&nbsp;f&nbsp;=&nbsp;new&nbsp;Foo();&quot;);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;eval.Run(&quot;f.Whatever;&quot;);&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;}&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Marek&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
