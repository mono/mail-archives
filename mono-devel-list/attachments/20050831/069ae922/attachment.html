<tt>
This&nbsp;seems&nbsp;to&nbsp;work&nbsp;fine&nbsp;on&nbsp;W2k.&amp;nbsp;&nbsp;Running&nbsp;under&nbsp;IIS5.1&nbsp;on&nbsp;WXP,<br>
though,&nbsp;it&nbsp;always&nbsp;throws&nbsp;an&nbsp;&amp;quot;ObjectDisposedException&amp;quot;&nbsp;in<br>
&amp;quot;SSLStreamBase.cs&amp;quot;&nbsp;when&nbsp;a&nbsp;bind&nbsp;over&nbsp;SSL&nbsp;is&nbsp;attempted.&lt;br&gt;<br>
&lt;br&gt;<br>
Won't&nbsp;this:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(workthreads&nbsp;&amp;gt;=&nbsp;(maxworkthreads&nbsp;-&nbsp;4))&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;async&nbsp;=&nbsp;false;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
cause&nbsp;the&nbsp;SSL&nbsp;Stream&nbsp;to&nbsp;use&nbsp;synchronous&nbsp;handshake&nbsp;until&nbsp;threads&nbsp;start&nbsp;getting&nbsp;used?&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;would&nbsp;also&nbsp;recommend&nbsp;changing&nbsp;this:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;protected&nbsp;void&nbsp;checkDisposed()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(this.disposed)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throw&nbsp;new&nbsp;ObjectDisposedException(&amp;quot;The&nbsp;Stream&nbsp;is<br>
closed.&amp;quot;);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
to&nbsp;this:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;protected&nbsp;void&nbsp;checkDisposed()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(this.disposed)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throw&nbsp;new<br>
ObjectDisposedException(this.GetType().Name,&nbsp;&amp;quot;The&nbsp;Stream&nbsp;is&nbsp;closed.&amp;quot;);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;<br>
which&nbsp;produces&nbsp;a&nbsp;more&nbsp;readable&nbsp;error&nbsp;message.&lt;br&gt;<br>
&lt;br&gt;<br>
Thx...&nbsp;HH&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;8/25/05,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Sebastien&nbsp;Pouliot&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sebastien@ximian.com&quot;&gt;sebastien@ximian.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hello&nbsp;JD,&lt;br&gt;&lt;br&gt;On&nbsp;Wed,&nbsp;2005-24-08&nbsp;at&nbsp;21:12&nbsp;-0700,&nbsp;JD&nbsp;Conley&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;I&nbsp;took&nbsp;the&nbsp;plunge&nbsp;and&nbsp;fully&nbsp;implemented&nbsp;async&nbsp;Ssl&nbsp;streams&nbsp;for&nbsp;both&lt;br&gt;&amp;gt;&nbsp;client&nbsp;and&nbsp;server.&amp;nbsp;&amp;nbsp;This&nbsp;fixes&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://bugzilla.ximian.com/show_bug.cgi?id=75687&quot;&gt;<br>
http://bugzilla.ximian.com/show_bug.cgi?id=75687&lt;/a&gt;&nbsp;as&nbsp;well&nbsp;as&nbsp;other&nbsp;bugs&lt;br&gt;&amp;gt;&nbsp;I've&nbsp;been&nbsp;talking&nbsp;with&nbsp;Sebastien&nbsp;and&nbsp;Carlos&nbsp;about&nbsp;off&nbsp;list.&nbsp;This&nbsp;patch&lt;br&gt;&amp;gt;&nbsp;passes&nbsp;the&nbsp;SocketHell&nbsp;tests&nbsp;that&nbsp;I&nbsp;contributed&nbsp;to&nbsp;them&nbsp;last&nbsp;week<br>
&lt;br&gt;&amp;gt;&nbsp;(multi&nbsp;threaded&nbsp;concurrent&nbsp;async&nbsp;streaming&nbsp;through&nbsp;TCP&nbsp;sockets).&lt;br&gt;&lt;br&gt;Wow!&nbsp;That's&nbsp;the&nbsp;kind&nbsp;of&nbsp;surprise&nbsp;I&nbsp;like&nbsp;when&nbsp;I&nbsp;wake&nbsp;up&nbsp;:-)&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;It's&nbsp;also&nbsp;a&nbsp;bit&nbsp;of&nbsp;a&nbsp;re-factor,&nbsp;though&nbsp;I&nbsp;only&nbsp;touched&nbsp;two&nbsp;classes&nbsp;and<br>
&lt;br&gt;&amp;gt;&nbsp;added&nbsp;one.&amp;nbsp;&amp;nbsp;I&nbsp;pulled&nbsp;most&nbsp;of&nbsp;the&nbsp;code&nbsp;out&nbsp;of&nbsp;the&nbsp;individual&lt;br&gt;&amp;gt;&nbsp;SslClientStream&nbsp;and&nbsp;SslServerStream&nbsp;and&nbsp;moved&nbsp;it&nbsp;down&nbsp;into&nbsp;a&nbsp;new&lt;br&gt;&amp;gt;&nbsp;abstract&nbsp;SslStreamBase.&amp;nbsp;&amp;nbsp;Client&nbsp;and&nbsp;server&nbsp;are&nbsp;now&nbsp;practically&nbsp;the&lt;br&gt;&amp;gt;&nbsp;same&nbsp;implementation.&amp;nbsp;&amp;nbsp;I&nbsp;left&nbsp;all&nbsp;existing&nbsp;interfaces&nbsp;present,&nbsp;but<br>
&lt;br&gt;&amp;gt;&nbsp;obviously&nbsp;had&nbsp;to&nbsp;add&nbsp;some&nbsp;new&nbsp;ones.&lt;br&gt;&lt;br&gt;We&nbsp;always&nbsp;&amp;quot;sticked&amp;quot;&nbsp;to&nbsp;the&nbsp;Fx&nbsp;1.2&nbsp;preview&nbsp;specs&nbsp;for&nbsp;the&nbsp;Ssl[Client|&lt;br&gt;Server]Stream&nbsp;API&nbsp;and&nbsp;didn't&nbsp;planned&nbsp;to&nbsp;change&nbsp;this&nbsp;before&nbsp;implementing&lt;br&gt;the&nbsp;new&nbsp;SslStream&nbsp;(in&nbsp;<br>
System.dll)&nbsp;for&nbsp;2.0&nbsp;-&nbsp;BUT&nbsp;this&nbsp;isn't&nbsp;a&nbsp;major&lt;br&gt;problem&nbsp;if&nbsp;it&nbsp;doesn't&nbsp;break&nbsp;binary&nbsp;compatibility&nbsp;(for&nbsp;current&lt;br&gt;applications&nbsp;linked&nbsp;with&nbsp;Mono.Security.dll).&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;The&nbsp;only&nbsp;&amp;quot;gotcha&amp;quot;&nbsp;is&nbsp;if&nbsp;you&nbsp;start&nbsp;running&nbsp;low&nbsp;on&nbsp;threadpool&nbsp;threads.<br>
&lt;br&gt;&amp;gt;&nbsp;Then&nbsp;the&nbsp;Ssl&nbsp;Stream&nbsp;will&nbsp;fall&nbsp;back&nbsp;to&nbsp;a&nbsp;synchronous&nbsp;handshake.&nbsp;The&lt;br&gt;&amp;gt;&nbsp;other&nbsp;option&nbsp;here&nbsp;is&nbsp;to&nbsp;spawn&nbsp;a&nbsp;thread&nbsp;ourselves&nbsp;for&nbsp;the&nbsp;handshake&lt;br&gt;&amp;gt;&nbsp;instead&nbsp;of&nbsp;using&nbsp;Delegate.BeginInvoke(),&nbsp;use&nbsp;the&nbsp;IO&nbsp;ThreadPool&nbsp;(is<br>
&lt;br&gt;&amp;gt;&nbsp;that&nbsp;available&nbsp;to&nbsp;Mono.Security?),&nbsp;or&nbsp;just&nbsp;live&nbsp;with&nbsp;a&nbsp;synchronous&lt;br&gt;&amp;gt;&nbsp;handshake.&nbsp;Of&nbsp;course,&nbsp;99.999%&nbsp;of&nbsp;the&nbsp;time&nbsp;this&nbsp;issue&nbsp;won't&nbsp;occur&nbsp;and&lt;br&gt;&amp;gt;&nbsp;won't&nbsp;be&nbsp;a&nbsp;problem&nbsp;unless&nbsp;you&nbsp;have&nbsp;both&nbsp;client&nbsp;and&nbsp;server&nbsp;sharing&nbsp;the<br>
&lt;br&gt;&amp;gt;&nbsp;same&nbsp;Threadpool&nbsp;causing&nbsp;a&nbsp;deadlock.&lt;br&gt;&lt;br&gt;That's&nbsp;not&nbsp;worse&nbsp;than&nbsp;the&nbsp;original&nbsp;(where&nbsp;the&nbsp;handshake&nbsp;was&nbsp;always&lt;br&gt;synchronous).&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;I&nbsp;hope&nbsp;this&nbsp;helps&nbsp;and&nbsp;gets&nbsp;integrated.&amp;nbsp;&amp;nbsp;It's&nbsp;definitely&nbsp;necessary&nbsp;for&lt;br&gt;<br>
&amp;gt;&nbsp;our&nbsp;implementation.&lt;br&gt;&lt;br&gt;1.&nbsp;I'll&nbsp;review&nbsp;the&nbsp;patch&nbsp;and,&nbsp;in&nbsp;doing&nbsp;so,&nbsp;check&nbsp;for&nbsp;possible&nbsp;binary&lt;br&gt;compatibility&nbsp;problems.&nbsp;I'm&nbsp;sure&nbsp;Carlos&nbsp;will&nbsp;do&nbsp;likewise;&lt;br&gt;&lt;br&gt;2.&nbsp;I'll&nbsp;make&nbsp;public&nbsp;a&nbsp;new&nbsp;Mono.Security.dll&nbsp;assembly&nbsp;so&nbsp;that&nbsp;people&nbsp;that<br>
&lt;br&gt;depends&nbsp;on&nbsp;Ssl*Stream&nbsp;may&nbsp;tests&nbsp;it&nbsp;and&nbsp;report&nbsp;any&nbsp;problem/difference;&lt;br&gt;&lt;br&gt;3.&nbsp;I'll&nbsp;run&nbsp;the&nbsp;regressions&nbsp;tests,&nbsp;the&nbsp;tools&nbsp;under&nbsp;/mcs/class/&lt;br&gt;Mono.Security/Test/tools/*,&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;works&nbsp;in&nbsp;previously&nbsp;reported&lt;br&gt;conditions.<br>
&lt;br&gt;&lt;br&gt;4.&nbsp;Commit&nbsp;(both&nbsp;the&nbsp;patch&nbsp;and&nbsp;your&nbsp;SocketHell&nbsp;tests).&nbsp;Hopefully&nbsp;we&nbsp;can&lt;br&gt;do&nbsp;all&nbsp;this&nbsp;before&nbsp;the&nbsp;next&nbsp;release.&lt;br&gt;&lt;br&gt;Many&nbsp;thanks!&lt;br&gt;--&lt;br&gt;Sebastien&lt;br&gt;&lt;br&gt;_______________________________________________&lt;br&gt;Mono-devel-list&nbsp;mailing&nbsp;list<br>
&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;====================================================&lt;br&gt;Robbie&nbsp;the&nbsp;Nanobot&nbsp;says:&lt;br&gt;&amp;quot;Only&nbsp;YOU&nbsp;can&nbsp;prevent&nbsp;gray&nbsp;goo&lt;br&gt;(NEVER&nbsp;release&nbsp;nanobot&nbsp;assemblers&nbsp;without&nbsp;replication&nbsp;limiting&nbsp;code)&amp;quot;<br>
&lt;br&gt;&lt;a&nbsp;href=&quot;http://lizardslounge.org&quot;&gt;http://lizardslounge.org&lt;/a&gt;&lt;br&gt;<br>

</tt>
