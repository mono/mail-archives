<tt>
Hi&nbsp;Tyler,&lt;br&gt;&lt;br&gt;I&nbsp;some&nbsp;coments&nbsp;about&nbsp;our&nbsp;patch,&nbsp;some&nbsp;are&nbsp;just&nbsp;minor&nbsp;details&nbsp;like&nbsp;formating&nbsp;issues.&nbsp;You&nbsp;can&nbsp;read&nbsp;about&nbsp;our&nbsp;coding&nbsp;guidelines&nbsp;in&nbsp;&lt;a&nbsp;href=&quot;http://www.mono-project.com/Coding_Guidelines&quot;&gt;http://www.mono-project.com/Coding_Guidelines<br>
&lt;/a&gt;&lt;br&gt;&lt;br&gt;For&nbsp;the&nbsp;options&nbsp;it&amp;#39;s&nbsp;a&nbsp;good&nbsp;idea&nbsp;to&nbsp;create&nbsp;an&nbsp;enum&nbsp;in&nbsp;the&nbsp;c&nbsp;side.&nbsp;&amp;quot;options&nbsp;&amp;amp;&nbsp;SPLIT_OPTIONS_REMOVE_EMPTY_ENTRIES&amp;quot;,&nbsp;or&nbsp;something&nbsp;alika,&nbsp;is&nbsp;way&nbsp;better&nbsp;than&nbsp;&amp;quot;options&nbsp;&amp;amp;&nbsp;0x01&amp;quot;&nbsp;-&nbsp;which&nbsp;uses&nbsp;some&nbsp;sort&nbsp;of&nbsp;magical&nbsp;number.&nbsp;Take&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;GenericParameterAttributes&nbsp;enum&nbsp;in&nbsp;<br>
object-internals.h.&lt;br&gt;&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(string_icall_is_in_array(separator,&nbsp;arrsize,&nbsp;src[i]))&nbsp;{&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;splitsize++;&lt;br&gt;&lt;br&gt;Please&nbsp;add&nbsp;a&nbsp;space&nbsp;after&nbsp;function&nbsp;name&nbsp;and&nbsp;array&nbsp;index,&nbsp;it&nbsp;should&nbsp;be&nbsp;something&nbsp;like:<br>
&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(string_icall_is_in_array&nbsp;(separator,&nbsp;arrsize,&nbsp;src&nbsp;[i]))&nbsp;{&lt;br&gt;<br>
+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;splitsize++;&lt;br&gt;&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(lastpos&nbsp;==&nbsp;1)&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;splitsize++;&lt;br&gt;+&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;Avoid&nbsp;braces&nbsp;for&nbsp;single&nbsp;line&nbsp;ifs.&nbsp;&lt;br&gt;&lt;br&gt;About&nbsp;fixing&nbsp;the&nbsp;broken&nbsp;code,&nbsp;we&nbsp;are&nbsp;going&nbsp;to&nbsp;need&nbsp;new&nbsp;unit&nbsp;tests&nbsp;for&nbsp;all&nbsp;this&nbsp;code.&nbsp;You&nbsp;could&nbsp;sent&nbsp;the&nbsp;patch&nbsp;for&nbsp;mcs/class/corlib/Test/System/StringTest.cs&nbsp;too&nbsp;;)<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;Rodrigo&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;10/5/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Tyler&nbsp;Larson&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mono-devel@tlarson.com&quot;&gt;mono-devel@tlarson.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hey&nbsp;Mono&nbsp;team:&lt;br&gt;&lt;br&gt;This&nbsp;is&nbsp;my&nbsp;first&nbsp;time&nbsp;contributing,&nbsp;so&nbsp;please&nbsp;bear&nbsp;with&nbsp;me&nbsp;if&nbsp;I&nbsp;do&lt;br&gt;something&nbsp;dumb.&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;provided&nbsp;a&nbsp;patch&nbsp;for&nbsp;incorrect&nbsp;behavior&nbsp;in&nbsp;the&nbsp;String.Split()&lt;br&gt;function.&nbsp;In&nbsp;particular,&nbsp;String.Split<br>
(char[],int,StringSplitOptions)&lt;br&gt;behaves&nbsp;incorrectly&nbsp;when&nbsp;instructed&nbsp;to&nbsp;remove&nbsp;empty&nbsp;entries&nbsp;while&nbsp;also&lt;br&gt;limiting&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;resultant&nbsp;array.&lt;br&gt;&lt;br&gt;Take&nbsp;for&nbsp;example,&nbsp;the&nbsp;following&nbsp;code:&lt;br&gt;&nbsp;&amp;quot;,a,,b,c&amp;quot;.Split(new&nbsp;char[]{&amp;#39;,&amp;#39;},3,<br>
StringSplitOptions.RemoveEmptyEntries);&lt;br&gt;&lt;br&gt;The&nbsp;existing&nbsp;implementation&nbsp;split&nbsp;the&nbsp;string&nbsp;into&nbsp;the&nbsp;following&nbsp;3&lt;br&gt;components:&amp;nbsp;&amp;nbsp;{[],&nbsp;[],&nbsp;[a,,b,c]}&lt;br&gt;Then&nbsp;it&nbsp;scans&nbsp;the&nbsp;array&nbsp;and&nbsp;removes&nbsp;all&nbsp;empty&nbsp;entries,&nbsp;returning&nbsp;simply<br>
&lt;br&gt;{[a,,b,c]}&lt;br&gt;&lt;br&gt;The&nbsp;correct&nbsp;behavior&nbsp;would&nbsp;be&nbsp;to&nbsp;remove&nbsp;empty&nbsp;entries&nbsp;while&nbsp;the&nbsp;string&lt;br&gt;was&nbsp;being&nbsp;split,&nbsp;and&nbsp;always&nbsp;return&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements&lt;br&gt;possible.&nbsp;The&nbsp;*correct*&nbsp;result&nbsp;to&nbsp;the&nbsp;preceding&nbsp;example&nbsp;would&nbsp;be:<br>
&lt;br&gt;{[a],[b],[c]}&lt;br&gt;&lt;br&gt;In&nbsp;order&nbsp;to&nbsp;do&nbsp;this&nbsp;correctly&nbsp;and&nbsp;efficiently,&nbsp;the&nbsp;InternalSplit&lt;br&gt;function&nbsp;had&nbsp;to&nbsp;be&nbsp;modified&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;remove&nbsp;empty&nbsp;entries&nbsp;during&lt;br&gt;the&nbsp;split&nbsp;procedure;&nbsp;this&nbsp;included&nbsp;changing&nbsp;the&nbsp;signature&nbsp;to&nbsp;accept&nbsp;an<br>
&lt;br&gt;&amp;quot;options&amp;quot;&nbsp;parameter.&lt;br&gt;&lt;br&gt;This&nbsp;patch&nbsp;also&nbsp;removes&nbsp;the&nbsp;need&nbsp;for&nbsp;further&nbsp;optimization&nbsp;of&nbsp;the&lt;br&gt;String.Split()&nbsp;call.&lt;br&gt;&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;a&nbsp;bit&nbsp;unsure&nbsp;about&nbsp;the&nbsp;coding&nbsp;style&nbsp;required;&nbsp;the&nbsp;.c&nbsp;file&nbsp;seemed&nbsp;to&lt;br&gt;<br>
be&nbsp;a&nbsp;bit&nbsp;of&nbsp;a&nbsp;combination&nbsp;of&nbsp;a&nbsp;few&nbsp;coding&nbsp;styles&nbsp;all&nbsp;together.&nbsp;Also,&nbsp;the&lt;br&gt;new&nbsp;InternalSplit&nbsp;function&nbsp;in&nbsp;this&nbsp;patch&nbsp;contains&nbsp;the&nbsp;line:&lt;br&gt;&nbsp;remempty&nbsp;=&nbsp;options&nbsp;&amp;amp;&nbsp;0x01;&lt;br&gt;&lt;br&gt;where&nbsp;0x01&nbsp;refers&nbsp;to&nbsp;the&nbsp;StringSplitOptions.RemoveEmptyEntries<br>
&nbsp;flag.&nbsp;I&amp;#39;m&lt;br&gt;sure&nbsp;there&amp;#39;s&nbsp;a&nbsp;&amp;quot;better&amp;quot;&nbsp;way&nbsp;of&nbsp;indicating&nbsp;this;&nbsp;either&nbsp;by&nbsp;referencing&lt;br&gt;the&nbsp;enum&nbsp;somehow&nbsp;or&nbsp;with&nbsp;a&nbsp;#define&nbsp;somewhere.&nbsp;I&nbsp;don&amp;#39;t&nbsp;know&nbsp;how&nbsp;you&nbsp;do&lt;br&gt;that&nbsp;sort&nbsp;of&nbsp;thing&nbsp;here.&lt;br&gt;&lt;br&gt;The&nbsp;patch,&nbsp;as&nbsp;provided,&nbsp;DOES&nbsp;fix&nbsp;the&nbsp;broken&nbsp;code&nbsp;and&nbsp;works&nbsp;without&nbsp;any<br>
&lt;br&gt;trouble,&nbsp;but&nbsp;I&nbsp;would&nbsp;appreciate&nbsp;it&nbsp;if&nbsp;someone&nbsp;more&nbsp;familiar&nbsp;with&nbsp;the&lt;br&gt;Mono&nbsp;project&nbsp;would&nbsp;go&nbsp;over&nbsp;the&nbsp;changes&nbsp;and&nbsp;bring&nbsp;those&nbsp;style&nbsp;bits&nbsp;a&nbsp;bit&lt;br&gt;more&nbsp;into&nbsp;conformance&nbsp;with&nbsp;what&nbsp;is&nbsp;expected.&lt;br&gt;&lt;br&gt;Cheers&lt;br&gt;&lt;br&gt;-Tyler&nbsp;Larson<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;_______________________________________________&lt;br&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;<br>
http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
