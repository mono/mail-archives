<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;http-equiv=Content-Type&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;META&nbsp;content=&quot;MSHTML&nbsp;6.00.6000.16414&quot;&nbsp;name=GENERATOR&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;text=#000000&nbsp;bgColor=#ffffff&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=531092409-19042007&gt;&lt;FONT&nbsp;face=Arial&nbsp;<br>
color=#0000ff&nbsp;size=2&gt;Lionel,&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=531092409-19042007&gt;&lt;FONT&nbsp;face=Arial&nbsp;<br>
color=#0000ff&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=531092409-19042007&gt;&lt;FONT&nbsp;face=Arial&nbsp;<br>
color=#0000ff&nbsp;size=2&gt;You&nbsp;must&nbsp;use&nbsp;Path.PathSeparator&nbsp;(which&nbsp;will&nbsp;get&nbsp;you&nbsp;';'&nbsp;on&nbsp;<br>
Windows,&nbsp;and&nbsp;':'&nbsp;on&nbsp;unix)&nbsp;instead&nbsp;of&nbsp;';'&nbsp;to&nbsp;separate&nbsp;both&nbsp;<br>
directories.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=531092409-19042007&gt;&lt;FONT&nbsp;face=Arial&nbsp;<br>
color=#0000ff&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=531092409-19042007&gt;&lt;FONT&nbsp;face=Arial&nbsp;<br>
color=#0000ff&nbsp;size=2&gt;When&nbsp;you're&nbsp;constructing&nbsp;the&nbsp;privatebinpath&nbsp;from&nbsp;code&nbsp;this&nbsp;<br>
will&nbsp;work&nbsp;fine,&nbsp;but&nbsp;problem&nbsp;is&nbsp;when&nbsp;you're&nbsp;configuring&nbsp;it&nbsp;from&nbsp;an&nbsp;application&nbsp;<br>
configuration&nbsp;file.&nbsp;In&nbsp;that&nbsp;case,&nbsp;you'll&nbsp;need&nbsp;separate&nbsp;configuration&nbsp;files&nbsp;for&nbsp;<br>
each&nbsp;platform.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=531092409-19042007&gt;&lt;FONT&nbsp;face=Arial&nbsp;<br>
color=#0000ff&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;face=Arial&nbsp;color=#0000ff&nbsp;size=2&gt;&lt;SPAN&nbsp;<br>
class=531092409-19042007&gt;Gert&lt;/SPAN&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;class=OutlookMessageHeader&nbsp;lang=en-us&nbsp;dir=ltr&nbsp;align=left&gt;<br>
&lt;HR&nbsp;tabIndex=-1&gt;<br>
&lt;FONT&nbsp;face=Tahoma&nbsp;size=2&gt;&lt;B&gt;From:&lt;/B&gt;&nbsp;mono-devel-list-bounces@lists.ximian.com&nbsp;<br>
[mailto:mono-devel-list-bounces@lists.ximian.com]&nbsp;&lt;B&gt;On&nbsp;Behalf&nbsp;Of&nbsp;&lt;/B&gt;Lionel&nbsp;<br>
Cuir&lt;BR&gt;&lt;B&gt;Sent:&lt;/B&gt;&nbsp;donderdag&nbsp;19&nbsp;april&nbsp;2007&nbsp;11:23&lt;BR&gt;&lt;B&gt;To:&lt;/B&gt;&nbsp;<br>
mono-devel-list@ximian.com&lt;BR&gt;&lt;B&gt;Subject:&lt;/B&gt;&nbsp;[Mono-dev]&nbsp;Assembly.Load&nbsp;fails&nbsp;<br>
when&nbsp;specifying&nbsp;multiple&nbsp;directoriesin&nbsp;<br>
AppDomainSetup.PrivateBinPath&lt;BR&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;When&nbsp;I&nbsp;create&nbsp;an&nbsp;AppDomain&nbsp;by&nbsp;specifying&nbsp;a&nbsp;single&nbsp;subdirectory&nbsp;in&nbsp;the&nbsp;<br>
AppDomainSetup.PrivateBinPath,&nbsp;an&nbsp;Assembly.Load&nbsp;works&nbsp;well&nbsp;in&nbsp;both&nbsp;Mono&nbsp;and&nbsp;.Net&nbsp;<br>
and&nbsp;is&nbsp;able&nbsp;to&nbsp;load&nbsp;any&nbsp;assembly&nbsp;located&nbsp;in&nbsp;that&nbsp;directory.&nbsp;But&nbsp;if&nbsp;I'm&nbsp;<br>
specifying&nbsp;two&nbsp;subdirectories,&nbsp;Mono&nbsp;will&nbsp;fail&nbsp;loading&nbsp;any&nbsp;assembly&nbsp;from&nbsp;any&nbsp;of&nbsp;<br>
these&nbsp;two&nbsp;subdirectories,&nbsp;while&nbsp;.Net&nbsp;will&nbsp;succeed&nbsp;(with&nbsp;the&nbsp;same&nbsp;code&nbsp;-&nbsp;see&nbsp;<br>
below).&lt;BR&gt;&lt;BR&gt;Can&nbsp;anybody&nbsp;tell&nbsp;me&nbsp;if&nbsp;I'm&nbsp;doing&nbsp;things&nbsp;correctly?&nbsp;If&nbsp;that's&nbsp;a&nbsp;<br>
bug&nbsp;in&nbsp;Mono,&nbsp;could&nbsp;you&nbsp;tell&nbsp;me&nbsp;to&nbsp;which&nbsp;file&nbsp;I&nbsp;should&nbsp;look&nbsp;at&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;try&nbsp;<br>
to&nbsp;patch&nbsp;the&nbsp;<br>
problem?&lt;BR&gt;&lt;BR&gt;Regards,&lt;BR&gt;Lionel&lt;BR&gt;&lt;BR&gt;////////////////////////////////////////&lt;BR&gt;&lt;BR&gt;To&nbsp;<br>
reproduce&nbsp;the&nbsp;problem:&lt;BR&gt;&lt;BR&gt;1.&nbsp;Use&nbsp;the&nbsp;code&nbsp;below&nbsp;to&nbsp;create&nbsp;a&nbsp;main&nbsp;application&nbsp;<br>
and&nbsp;compile&nbsp;it&nbsp;into&nbsp;/home/myapp&nbsp;for&nbsp;instance.&lt;BR&gt;<br>
&lt;BLOCKQUOTE&gt;&lt;SMALL&gt;using&nbsp;System;&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;using&nbsp;<br>
&nbsp;&nbsp;System.Reflection;&lt;/SMALL&gt;&lt;BR&gt;&lt;BR&gt;&lt;SMALL&gt;class&nbsp;MainClass&nbsp;:&nbsp;<br>
&nbsp;&nbsp;MarshalByRefObject&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;{&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;static&nbsp;int&nbsp;Main()&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;{&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;AppDomainSetup&nbsp;<br>
&nbsp;&nbsp;domainSetup&nbsp;=&nbsp;new&nbsp;AppDomainSetup();&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;domainSetup.ApplicationBase&nbsp;=&nbsp;<br>
&nbsp;&nbsp;AppDomain.CurrentDomain.BaseDirectory;&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;domainSetup.ConfigurationFile&nbsp;=&nbsp;<br>
&nbsp;&nbsp;AppDomain.CurrentDomain.SetupInformation.ConfigurationFile;&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&lt;/SMALL&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;domainSetup.PrivateBinPath&nbsp;=&nbsp;<br>
&nbsp;&nbsp;&quot;solution&quot;;&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;AppDomain&nbsp;<br>
&nbsp;&nbsp;_secondaryDomain&nbsp;=&nbsp;AppDomain.CreateDomain(&quot;SecondaryDomain&quot;,&nbsp;<br>
&nbsp;&nbsp;AppDomain.CurrentDomain.Evidence,&nbsp;<br>
&nbsp;&nbsp;domainSetup);&lt;/SMALL&gt;&lt;BR&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;MainClass&nbsp;_secondDomainHost&nbsp;=&nbsp;<br>
&nbsp;&nbsp;(MainClass)_secondaryDomain.CreateInstanceFromAndUnwrap(&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;typeof(MainClass).Assembly.Location,&nbsp;<br>
&nbsp;&nbsp;typeof(MainClass).FullName);&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;_secondDomainHost.Run();&lt;/SMALL&gt;&lt;BR&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.WriteLine(&quot;Press&nbsp;a&nbsp;key&nbsp;to&nbsp;<br>
&nbsp;&nbsp;continue...&quot;);&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;Console.ReadKey();&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;return&nbsp;0;&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;}&lt;/SMALL&gt;&lt;BR&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;<br>
&nbsp;&nbsp;Run()&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;{&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Assembly&nbsp;ass&nbsp;=&nbsp;<br>
&nbsp;&nbsp;Assembly.Load(&quot;test&quot;);&lt;/SMALL&gt;&lt;BR&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;Console.WriteLine(&quot;Loaded:&quot;);&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;Console.WriteLine(ass.FullName);&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.WriteLine(&quot;from:&nbsp;&quot;&nbsp;+&nbsp;<br>
&nbsp;&nbsp;ass.Location);&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;}&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;}&lt;/SMALL&gt;&lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;BR&gt;2.&nbsp;Create&nbsp;the&nbsp;directory&nbsp;<br>
/home/myapp/solution&lt;BR&gt;&lt;BR&gt;3.&nbsp;Use&nbsp;the&nbsp;code&nbsp;below&nbsp;to&nbsp;create&nbsp;the&nbsp;assembly&nbsp;<br>
test.dll&nbsp;and&nbsp;compile&nbsp;it&nbsp;into&nbsp;/home/myapp/solution&lt;BR&gt;<br>
&lt;BLOCKQUOTE&gt;&lt;SMALL&gt;using&nbsp;System;&lt;/SMALL&gt;&lt;BR&gt;&lt;BR&gt;&lt;SMALL&gt;namespace&nbsp;<br>
&nbsp;&nbsp;Test&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;{&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;class&nbsp;<br>
&nbsp;&nbsp;TestClass&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
&nbsp;&nbsp;{&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
}&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;}&lt;/SMALL&gt;&lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;BR&gt;4.&nbsp;Run&nbsp;the&nbsp;main&nbsp;app&nbsp;-&amp;gt;&nbsp;it&nbsp;<br>
works&lt;BR&gt;&lt;BR&gt;5.&nbsp;Now&nbsp;create&nbsp;the&nbsp;directory&amp;nbsp;&nbsp;/home/myapp/function&nbsp;and&nbsp;change&nbsp;<br>
the&nbsp;main&nbsp;application&nbsp;'s&nbsp;AppDomainSetup.PrivateBinPath&nbsp;statement&nbsp;<br>
into:&lt;BR&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
domainSetup.PrivateBinPath&nbsp;=&nbsp;&quot;solution;function&quot;;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;This&nbsp;does&nbsp;not&nbsp;<br>
work&nbsp;with&nbsp;Mono&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;<br>
domainSetup.PrivateBinPath&nbsp;=&nbsp;&quot;solution&quot;;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;Old&nbsp;line&nbsp;-&nbsp;it&nbsp;was&nbsp;<br>
working&lt;/SMALL&gt;&lt;BR&gt;&lt;BR&gt;==&amp;gt;&nbsp;Now,&nbsp;Assembly.Load&nbsp;throws&nbsp;an&nbsp;exception:&nbsp;&lt;BR&gt;<br>
&lt;BLOCKQUOTE&gt;&amp;nbsp;&lt;SMALL&gt;System.IO.FileNotFoundException:&nbsp;Could&nbsp;not&nbsp;load&nbsp;file&nbsp;<br>
&nbsp;&nbsp;or&nbsp;assembly&nbsp;'test'&nbsp;or&nbsp;one&nbsp;of&nbsp;its&nbsp;dependencies.&nbsp;The&nbsp;system&nbsp;cannot&nbsp;find&nbsp;the&nbsp;file&nbsp;<br>
&nbsp;&nbsp;specified.&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;File&nbsp;name:&nbsp;'test'&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&nbsp;at&nbsp;<br>
&nbsp;&nbsp;(wrapper&nbsp;xdomain-invoke)&nbsp;MainClass:Run&nbsp;(string[])&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&nbsp;at&nbsp;<br>
&nbsp;&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;MainClass:Run&nbsp;<br>
&nbsp;&nbsp;(string[])&lt;/SMALL&gt;&lt;BR&gt;&lt;SMALL&gt;&amp;nbsp;&nbsp;at&nbsp;MainClass.Main&nbsp;(System.String[]&nbsp;args)&nbsp;<br>
&nbsp;&nbsp;[0x00000]&lt;/SMALL&gt;&lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;BR&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
