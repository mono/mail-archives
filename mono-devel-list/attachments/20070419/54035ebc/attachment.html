<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
When&nbsp;I&nbsp;create&nbsp;an&nbsp;AppDomain&nbsp;by&nbsp;specifying&nbsp;a&nbsp;single&nbsp;subdirectory&nbsp;in&nbsp;the<br>
AppDomainSetup.PrivateBinPath,&nbsp;an&nbsp;Assembly.Load&nbsp;works&nbsp;well&nbsp;in&nbsp;both&nbsp;Mono<br>
and&nbsp;.Net&nbsp;and&nbsp;is&nbsp;able&nbsp;to&nbsp;load&nbsp;any&nbsp;assembly&nbsp;located&nbsp;in&nbsp;that&nbsp;directory.<br>
But&nbsp;if&nbsp;I'm&nbsp;specifying&nbsp;two&nbsp;subdirectories,&nbsp;Mono&nbsp;will&nbsp;fail&nbsp;loading&nbsp;any<br>
assembly&nbsp;from&nbsp;any&nbsp;of&nbsp;these&nbsp;two&nbsp;subdirectories,&nbsp;while&nbsp;.Net&nbsp;will&nbsp;succeed<br>
(with&nbsp;the&nbsp;same&nbsp;code&nbsp;-&nbsp;see&nbsp;below).&lt;br&gt;<br>
&lt;br&gt;<br>
Can&nbsp;anybody&nbsp;tell&nbsp;me&nbsp;if&nbsp;I'm&nbsp;doing&nbsp;things&nbsp;correctly?&nbsp;If&nbsp;that's&nbsp;a&nbsp;bug&nbsp;in<br>
Mono,&nbsp;could&nbsp;you&nbsp;tell&nbsp;me&nbsp;to&nbsp;which&nbsp;file&nbsp;I&nbsp;should&nbsp;look&nbsp;at&nbsp;so&nbsp;that&nbsp;I&nbsp;can<br>
try&nbsp;to&nbsp;patch&nbsp;the&nbsp;problem?&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
Lionel&lt;br&gt;<br>
&lt;br&gt;<br>
////////////////////////////////////////&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;reproduce&nbsp;the&nbsp;problem:&lt;br&gt;<br>
&lt;br&gt;<br>
1.&nbsp;Use&nbsp;the&nbsp;code&nbsp;below&nbsp;to&nbsp;create&nbsp;a&nbsp;main&nbsp;application&nbsp;and&nbsp;compile&nbsp;it&nbsp;into<br>
/home/myapp&nbsp;for&nbsp;instance.&lt;br&gt;<br>
&lt;blockquote&gt;&lt;small&gt;using&nbsp;System;&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;using&nbsp;System.Reflection;&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;class&nbsp;MainClass&nbsp;:&nbsp;MarshalByRefObject&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;{&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;static&nbsp;int&nbsp;Main()&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;AppDomainSetup&nbsp;domainSetup&nbsp;=&nbsp;new&nbsp;AppDomainSetup();&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;domainSetup.ApplicationBase&nbsp;=<br>
AppDomain.CurrentDomain.BaseDirectory;&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;domainSetup.ConfigurationFile&nbsp;=<br>
AppDomain.CurrentDomain.SetupInformation.ConfigurationFile;&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&lt;/small&gt;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;domainSetup.PrivateBinPath&nbsp;=&nbsp;&quot;solution&quot;;&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;AppDomain&nbsp;_secondaryDomain&nbsp;=<br>
AppDomain.CreateDomain(&quot;SecondaryDomain&quot;,<br>
AppDomain.CurrentDomain.Evidence,&nbsp;domainSetup);&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;MainClass&nbsp;_secondDomainHost&nbsp;=<br>
(MainClass)_secondaryDomain.CreateInstanceFromAndUnwrap(&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;typeof(MainClass).Assembly.Location,<br>
typeof(MainClass).FullName);&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;_secondDomainHost.Run();&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.WriteLine(&quot;Press&nbsp;a&nbsp;key&nbsp;to&nbsp;continue...&quot;);&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.ReadKey();&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;0;&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;void&nbsp;Run()&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Assembly&nbsp;ass&nbsp;=&nbsp;Assembly.Load(&quot;test&quot;);&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.WriteLine(&quot;Loaded:&quot;);&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.WriteLine(ass.FullName);&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Console.WriteLine(&quot;from:&nbsp;&quot;&nbsp;+&nbsp;ass.Location);&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;}&lt;/small&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
2.&nbsp;Create&nbsp;the&nbsp;directory&nbsp;/home/myapp/solution&lt;br&gt;<br>
&lt;br&gt;<br>
3.&nbsp;Use&nbsp;the&nbsp;code&nbsp;below&nbsp;to&nbsp;create&nbsp;the&nbsp;assembly&nbsp;test.dll&nbsp;and&nbsp;compile&nbsp;it<br>
into&nbsp;/home/myapp/solution&lt;br&gt;<br>
&lt;blockquote&gt;&lt;small&gt;using&nbsp;System;&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;namespace&nbsp;Test&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;{&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;class&nbsp;TestClass&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;}&lt;/small&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
4.&nbsp;Run&nbsp;the&nbsp;main&nbsp;app&nbsp;-&amp;gt;&nbsp;it&nbsp;works&lt;br&gt;<br>
&lt;br&gt;<br>
5.&nbsp;Now&nbsp;create&nbsp;the&nbsp;directory&amp;nbsp;&nbsp;/home/myapp/function&nbsp;and&nbsp;change&nbsp;the&nbsp;main<br>
application&nbsp;'s&nbsp;AppDomainSetup.PrivateBinPath&nbsp;statement&nbsp;into:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;domainSetup.PrivateBinPath&nbsp;=&nbsp;&quot;solution;function&quot;;&amp;nbsp;&amp;nbsp;&nbsp;//<br>
This&nbsp;does&nbsp;not&nbsp;work&nbsp;with&nbsp;Mono&lt;/small&gt;&lt;br&gt;<br>
&lt;small&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;domainSetup.PrivateBinPath&nbsp;=&nbsp;&quot;solution&quot;;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;Old<br>
line&nbsp;-&nbsp;it&nbsp;was&nbsp;working&lt;/small&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
==&amp;gt;&nbsp;Now,&nbsp;Assembly.Load&nbsp;throws&nbsp;an&nbsp;exception:&nbsp;&lt;br&gt;<br>
&lt;blockquote&gt;&amp;nbsp;&lt;small&gt;System.IO.FileNotFoundException:&nbsp;Could&nbsp;not&nbsp;load<br>
file&nbsp;or&nbsp;assembly&nbsp;'test'&nbsp;or&nbsp;one&nbsp;of&nbsp;its&nbsp;dependencies.&nbsp;The&nbsp;system&nbsp;cannot<br>
find&nbsp;the&nbsp;file&nbsp;specified.&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;File&nbsp;name:&nbsp;'test'&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&nbsp;at&nbsp;(wrapper&nbsp;xdomain-invoke)&nbsp;MainClass:Run&nbsp;(string[])&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&nbsp;at&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;MainClass:Run<br>
(string[])&lt;/small&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;small&gt;&amp;nbsp;&nbsp;at&nbsp;MainClass.Main&nbsp;(System.String[]&nbsp;args)&nbsp;[0x00000]&lt;/small&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>
<br>

</tt>
