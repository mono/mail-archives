<tt>
Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;This&nbsp;is&nbsp;now&nbsp;fixed&nbsp;in&nbsp;HEAD/2.10&nbsp;branch.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Zoltan&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jan&nbsp;3,&nbsp;2012&nbsp;at&nbsp;1:34&nbsp;PM,&nbsp;Martin&nbsp;Däumler&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mdae@cs.tu-chemnitz.de&quot;&gt;mdae@cs.tu-chemnitz.de&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hello,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;wanted&nbsp;to&nbsp;use&nbsp;Marshal.PrelinkAll()&nbsp;in&nbsp;order&nbsp;to&nbsp;pre-initialize&nbsp;a&lt;br&gt;<br>
PInvoke.&nbsp;Unfortunately,&nbsp;executing&nbsp;this&nbsp;method&nbsp;leads&nbsp;to&nbsp;an&nbsp;assertion&lt;br&gt;<br>
failure&nbsp;on&nbsp;x86/Linux.&nbsp;The&nbsp;C#&nbsp;code&nbsp;is&nbsp;quite&nbsp;simple:&lt;br&gt;<br>
&lt;br&gt;<br>
using&nbsp;System;&lt;br&gt;<br>
using&nbsp;System.Runtime.InteropServices;&lt;br&gt;<br>
class&nbsp;Test1&lt;br&gt;<br>
{&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; [DllImport(&amp;quot;libpinvoke&amp;quot;)]&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; public&nbsp;static&nbsp;extern&nbsp;int&nbsp;pinvoke(int&nbsp;value);&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; static&nbsp;void&nbsp;Main&nbsp;(string[]&nbsp;args)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; {&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Marshal.PrelinkAll(typeof(Test1));&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int&nbsp;ret&nbsp;=&nbsp;pinvoke(1);&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine(&amp;quot;return&nbsp;value:&nbsp;&amp;quot;&nbsp;+&nbsp;ret.ToString());&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; }&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
..&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;library&nbsp;code&nbsp;(pinvoke.c):&lt;br&gt;<br>
&lt;br&gt;<br>
int&nbsp;pinvoke(&nbsp;int&nbsp;value&nbsp;)&nbsp;{&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;value;&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;full&nbsp;example&nbsp;including&nbsp;Makefile&nbsp;can&nbsp;be&nbsp;downloaded&nbsp;[1].&lt;br&gt;<br>
Surprisingly,&nbsp;the&nbsp;assertion&nbsp;is&nbsp;raised&nbsp;by&nbsp;Mono&nbsp;2.6.1&nbsp;and&lt;br&gt;<br>
2.10.7,&nbsp;but&nbsp;not&nbsp;by&nbsp;Mono&nbsp;2.8.2&nbsp;(the&nbsp;versions&nbsp;I&nbsp;tested).&lt;br&gt;<br>
Further,&nbsp;the&nbsp;assertion&nbsp;is&nbsp;not&nbsp;raised&nbsp;when&nbsp;the&nbsp;C#&nbsp;code&lt;br&gt;<br>
was&nbsp;AOT-compiled&nbsp;in&nbsp;advance&nbsp;(works&nbsp;with&nbsp;each&nbsp;tested&nbsp;Mono&lt;br&gt;<br>
version).&lt;br&gt;<br>
&lt;br&gt;<br>
Is&nbsp;it&nbsp;a&nbsp;bug&nbsp;or&nbsp;a&nbsp;feature?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
With&nbsp;kind&nbsp;regards,&lt;br&gt;<br>
Martin&nbsp;Däumler&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
[1]&nbsp;&lt;a&nbsp;href=&quot;http://www-user.tu-chemnitz.de/~mdae/PrelinkAllTest.tar&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www-user.tu-chemnitz.de/~mdae/PrelinkAllTest.tar&lt;/a&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
