--- DefaultWsdlHelpGenerator.aspx.orig	Sun Feb  6 15:29:34 2005
+++ DefaultWsdlHelpGenerator.aspx	Mon Feb  7 09:13:50 2005
@@ -22,8 +22,6 @@
 <%@ Import Namespace="System.Diagnostics" %>
 <%@ Import Namespace="System.CodeDom" %>
 <%@ Import Namespace="System.CodeDom.Compiler" %>
-<%@ Import Namespace="Microsoft.CSharp" %>
-<%@ Import Namespace="Microsoft.VisualBasic" %>
 <%@ Import Namespace="System.Text.RegularExpressions" %>
 <%@ Assembly name="System.Web.Services" %>
 <%@ Page debug="true" %>
@@ -459,12 +457,29 @@
 
 private CodeDomProvider GetProvider(string langId)
 {
-	switch (langId.ToUpper())
-	{
-		case "CS": return new CSharpCodeProvider();
-		case "VB": return new VBCodeProvider();
-		default: return null;
-	}
+	bool providerExists = false;
+	string machineConfig = System.Web.HttpRuntime.MachineConfigurationDirectory + Path.Directo
+	XmlDocument xml = new XmlDocument ();
+	xml.Load (machineConfig);
+	XmlNodeList nodeList = xml.GetElementsByTagName ("compiler");
+	foreach(XmlNode node in nodeList) {
+		string[] languages = node.Attributes ["language"].Value.Split (';');
+		if (Array.IndexOf (languages, langId.ToLower ()) != -1) {
+            		string[] info    = node.Attributes ["type"].Value.Split (',');
+                	Type     type    = null;
+                	string   asmName = info [1];
+                	string   version = info [2];
+                	string   culture = info [3];
+                	string   token   = info [4];
+                	Assembly asm = Assembly.Load (asmName + "," + version + "," + culture + "," + token);
+                	if (asm != null)
+                		type = asm.GetType (info [0]);
+                	return (CodeDomProvider) Activator.CreateInstance (type);
+    		}
+        }
+	if(! providerExists)
+		throw new Exception ("Unknown language: " + langId);
+	return null;
 }
 
 //