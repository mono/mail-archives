<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/12/1&nbsp;Zoltan&nbsp;Varga&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:vargaz@gmail.com&quot;&gt;vargaz@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;Tue,&nbsp;Dec&nbsp;1,&nbsp;2009&nbsp;at&nbsp;6:02&nbsp;PM,&nbsp;Babbage&nbsp;Linden&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:babbage@lindenlab.com&quot;&nbsp;target=&quot;_blank&quot;&gt;babbage@lindenlab.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
Hi&nbsp;all,&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;currently&nbsp;investigating&nbsp;a&nbsp;performance&nbsp;problem&nbsp;which&nbsp;is&nbsp;causing&nbsp;complex&nbsp;objects&nbsp;in&nbsp;Second&nbsp;Life&nbsp;containing&nbsp;many&nbsp;scripts&nbsp;to&nbsp;take&nbsp;a&nbsp;long&nbsp;time&nbsp;to&nbsp;load.&lt;br&gt;&lt;br&gt;We&nbsp;embed&nbsp;Mono&nbsp;in&nbsp;the&nbsp;Second&nbsp;Life&nbsp;simulator,&nbsp;so&nbsp;I&nbsp;turned&nbsp;on&nbsp;the&nbsp;profiler&nbsp;before&nbsp;initialising&nbsp;the&nbsp;runtime:&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;mono_profiler_load(&amp;quot;default:stat&amp;quot;);&lt;br&gt;mono_jit_init(&amp;quot;root&nbsp;domain&amp;quot;);&lt;br&gt;mono_internal_call_init();&lt;br&gt;&lt;br&gt;After&nbsp;shutting&nbsp;down&nbsp;the&nbsp;simulator,&nbsp;the&nbsp;profiler&nbsp;reported&nbsp;the&nbsp;slow&nbsp;method&nbsp;as&nbsp;being&nbsp;System.Reflection.Assembly::Load(byte[]),&nbsp;with&nbsp;each&nbsp;call&nbsp;taking&nbsp;19.961ms:&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;Time(ms)&nbsp;Count  &nbsp;P/call(ms)&nbsp;Method&nbsp;name&lt;br&gt;########################&lt;br&gt; 4052.135    &nbsp;203  &nbsp;19.961  &nbsp;System.Reflection.Assembly::Load(byte[])&lt;br&gt; &nbsp;Callers&nbsp;(with&nbsp;count)&nbsp;that&nbsp;contribute&nbsp;at&nbsp;least&nbsp;for&nbsp;1%:&lt;br&gt;        &nbsp;102 &nbsp;50&nbsp;%&nbsp;LindenLab.SecondLife.Script::.ctor(string,byte[],long&amp;amp;)&lt;br&gt;<br>
<br>
<br>
        &nbsp;101 &nbsp;49&nbsp;%&nbsp;LindenLab.SecondLife.Script::Deserialize(byte[],byte[])&lt;br&gt;&lt;br&gt;Does&nbsp;this&nbsp;seem&nbsp;right?&nbsp;We&amp;#39;re&nbsp;just&nbsp;passing&nbsp;an&nbsp;assembly&nbsp;as&nbsp;bytes&nbsp;to&nbsp;Mono&nbsp;and&nbsp;asking&nbsp;it&nbsp;to&nbsp;turn&nbsp;it&nbsp;in&nbsp;to&nbsp;an&nbsp;assembly,&nbsp;19ms&nbsp;seems&nbsp;like&nbsp;a&nbsp;long&nbsp;time&nbsp;to&nbsp;do&nbsp;that.&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;Are&nbsp;there&nbsp;any&nbsp;faster&nbsp;ways&nbsp;we&nbsp;could&nbsp;do&nbsp;this?&nbsp;In&nbsp;the&nbsp;example&nbsp;above&nbsp;an&nbsp;object&nbsp;with&nbsp;200&nbsp;scripts&nbsp;in&nbsp;it&nbsp;is&nbsp;taking&nbsp;4s&nbsp;to&nbsp;load,&nbsp;which&nbsp;is&nbsp;much&nbsp;faster&nbsp;than&nbsp;with&nbsp;an&nbsp;LSL&nbsp;script.&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;I&nbsp;can&amp;#39;t&nbsp;reproduce&nbsp;this,&nbsp;most&nbsp;of&nbsp;the&nbsp;work&nbsp;happens&nbsp;in&nbsp;native&nbsp;code,&nbsp;could&nbsp;you&nbsp;try&nbsp;running&nbsp;under&lt;br&gt;<br>
<br>
valgrind&nbsp;--tool=callgrind,&nbsp;that&nbsp;will&nbsp;profile&nbsp;the&nbsp;runtime&nbsp;code.&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;OK,&nbsp;I&nbsp;have&nbsp;a&nbsp;(15MB)&nbsp;callgrind.out&nbsp;file,&nbsp;what&amp;#39;s&nbsp;the&nbsp;best&nbsp;way&nbsp;for&nbsp;me&nbsp;to&nbsp;get&nbsp;it&nbsp;to&nbsp;you?&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;&lt;br&gt;Jim&lt;br&gt;<br>

</tt>
