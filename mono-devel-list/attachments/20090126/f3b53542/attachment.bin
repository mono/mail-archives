Index: class/System/System.Net.NetworkInformation/ChangeLog
===================================================================
--- class/System/System.Net.NetworkInformation/ChangeLog	(revision 124499)
+++ class/System/System.Net.NetworkInformation/ChangeLog	(working copy)
@@ -1,3 +1,8 @@
+2009-01-26  Christian Prochnow <cproch@seculogix.de>
+
+	* Ping.cs: ignore ICMP echo request packet in case we ping
+	  localhost.
+
 2009-01-11  Atsushi Enomoto  <atsushi@ximian.com>
 
 	* NetworkInformationPermission.cs,
Index: class/System/System.Net.NetworkInformation/Ping.cs
===================================================================
--- class/System/System.Net.NetworkInformation/Ping.cs	(revision 124499)
+++ class/System/System.Net.NetworkInformation/Ping.cs	(working copy)
@@ -233,9 +233,11 @@
 						continue;
 
 					IcmpMessage recv = new IcmpMessage (bytes, headerLength, bodyLength);
-					if (recv.Identifier != identifier)
-						continue; // ping reply to different request. discard it.
 
+					/* discard ping reply to different request or echo requests if running on same host. */
+					if (recv.Identifier != identifier || recv.Type == 8)
+						continue; 
+
 					return new PingReply (address, recv.Data, options, rtt, recv.IPStatus);
 				} while (true);
 			}
@@ -461,6 +463,8 @@
 						return IPStatus.ParameterProblem;
 					case 4:
 						return IPStatus.SourceQuench;
+					case 8:
+						return IPStatus.Success;
 					}
 					return IPStatus.Unknown;
 					//throw new NotSupportedException (String.Format ("Unexpected pair of ICMP message type and code: type is {0} and code is {1}", Type, Code));
