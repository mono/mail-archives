<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;feedback&lt;br&gt;&lt;br&gt;&lt;/div&gt;I&nbsp;started&nbsp;this&nbsp;project&nbsp;merely&nbsp;as&nbsp;an&nbsp;investigation&nbsp;into&nbsp;whether&nbsp;it&nbsp;was&nbsp;even&nbsp;possible&nbsp;to&nbsp;implement&nbsp;in&nbsp;unix,&nbsp;and&nbsp;so&nbsp;hadn&#39;t&nbsp;really&nbsp;thought&nbsp;far&nbsp;enough&nbsp;ahead&nbsp;as&nbsp;to&nbsp;sharing&nbsp;it.&nbsp;The&nbsp;code&nbsp;is&nbsp;now&nbsp;pushed&nbsp;to&nbsp;a&nbsp;fork&nbsp;on&nbsp;github:&nbsp;&lt;a&nbsp;href=&quot;https://github.com/smokingrope/mono/commit/8837a69d202ddb7d8350ebd052ff44d9e889a627&quot;&gt;https://github.com/smokingrope/mono/commit/8837a69d202ddb7d8350ebd052ff44d9e889a627&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;terms&nbsp;of&nbsp;compatiblity&nbsp;i&nbsp;have&nbsp;not&nbsp;needed&nbsp;to&nbsp;change&nbsp;any&nbsp;existing&nbsp;dll&nbsp;references.&nbsp;At&nbsp;this&nbsp;point&nbsp;i&nbsp;have&nbsp;added&nbsp;two&nbsp;internal&nbsp;calls&nbsp;to&nbsp;the&nbsp;corlib\System.IO.MonoIO&nbsp;class.&nbsp;Perhaps&nbsp;you&nbsp;could&nbsp;look&nbsp;over&nbsp;these&nbsp;new&nbsp;internal&nbsp;calls&nbsp;and&nbsp;give&nbsp;a&nbsp;little&nbsp;more&nbsp;specific&nbsp;advice&nbsp;on&nbsp;what&nbsp;(if&nbsp;anything)&nbsp;needs&nbsp;conditioned&nbsp;out.&nbsp;&lt;br&gt;<br>
       &nbsp;I&nbsp;reused&nbsp;the&nbsp;poll()&nbsp;wrapper&nbsp;from&nbsp;the&nbsp;sockets&nbsp;implementation,&nbsp;(as&nbsp;MonoIO.PollFD)&nbsp;so&nbsp;i&nbsp;assume&nbsp;that&nbsp;is&nbsp;ok.&nbsp;&lt;br&gt;       &nbsp;I&nbsp;am&nbsp;re-using&nbsp;the&nbsp;existing&nbsp;CreatePipe()&nbsp;function&nbsp;for&nbsp;pipe&nbsp;creation,&nbsp;so&nbsp;that&nbsp;behaves&nbsp;the&nbsp;same&nbsp;as&nbsp;before.&nbsp;&lt;br&gt;<br>
       &nbsp;The&nbsp;GetPipeHandle()&nbsp;internal&nbsp;call&nbsp;just&nbsp;initializes&nbsp;a&nbsp;handle&nbsp;that&nbsp;was&nbsp;inherited&nbsp;from&nbsp;a&nbsp;parent&nbsp;process&nbsp;in&nbsp;mono&#39;s&nbsp;file&nbsp;descriptor&nbsp;table,&nbsp;which&nbsp;would&nbsp;not&nbsp;strike&nbsp;me&nbsp;as&nbsp;a&nbsp;compatibilty&nbsp;concern&nbsp;on&nbsp;it&#39;s&nbsp;own&nbsp;as&nbsp;it&#39;s&nbsp;only&nbsp;doing&nbsp;mono&nbsp;platform&nbsp;work.&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A&nbsp;new&nbsp;problem&nbsp;has&nbsp;presented&nbsp;itself,&nbsp;which&nbsp;some&nbsp;expert&nbsp;feedback&nbsp;would&nbsp;be&nbsp;appreciated.&nbsp;Based&nbsp;on&nbsp;the&nbsp;sample&nbsp;code:&nbsp;&nbsp;&lt;a&nbsp;href=&quot;http://msdn.microsoft.com/en-us/library/bb546102.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://msdn.microsoft.com/en-us/library/bb546102.aspx&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;1)&nbsp;Process.Start()&nbsp;is&nbsp;called&nbsp;on&nbsp;the&nbsp;server&nbsp;application&nbsp;to&nbsp;launch&nbsp;the&nbsp;client&nbsp;application&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;2)&nbsp;When&nbsp;the&nbsp;client&nbsp;application&nbsp;is&nbsp;started,&nbsp;it&nbsp;will&nbsp;inherit&nbsp;the&nbsp;pipe&nbsp;handle&nbsp;and&nbsp;eventually&nbsp;start&nbsp;using&nbsp;it&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt; &nbsp;3)&nbsp;The&nbsp;server&nbsp;application&nbsp;calls&nbsp;DisposeLocalCopyOfClientHandle()&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;4)&nbsp;The&nbsp;server&nbsp;writes&nbsp;to&nbsp;the&nbsp;pipe&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  &nbsp;There&nbsp;is&nbsp;a&nbsp;synchronization&nbsp;issue&nbsp;between&nbsp;when&nbsp;2&nbsp;and&nbsp;3&nbsp;run,&nbsp;because&nbsp;in&nbsp;my&nbsp;testing,&nbsp;sometimes&nbsp;the&nbsp;Process.Start()&nbsp;call&nbsp;has&nbsp;not&nbsp;fully&nbsp;completed&nbsp;launching&nbsp;the&nbsp;child&nbsp;process,&nbsp;and&nbsp;closing&nbsp;the&nbsp;client&nbsp;handle&nbsp;on&nbsp;the&nbsp;server&nbsp;side&nbsp;cause&nbsp;the&nbsp;pipe&nbsp;to&nbsp;be&nbsp;broken&nbsp;before&nbsp;the&nbsp;client&nbsp;is&nbsp;fully&nbsp;booted.&nbsp;Because&nbsp;the&nbsp;pipe&nbsp;is&nbsp;broken&nbsp;step&nbsp;4&nbsp;should&nbsp;fail,&nbsp;though&nbsp;right&nbsp;now&nbsp;this&nbsp;isn&#39;t&nbsp;quite&nbsp;happening&nbsp;:)&nbsp;&lt;br&gt;<br>
 &nbsp;&lt;br&gt; &nbsp;With&nbsp;a&nbsp;Thread.Sleep(10)&nbsp;in&nbsp;DisposeLocalCopyOfClientHandle()&nbsp;the&nbsp;code&nbsp;seems&nbsp;to&nbsp;work&nbsp;about&nbsp;50%&nbsp;of&nbsp;the&nbsp;time&nbsp;on&nbsp;my&nbsp;machine.&nbsp;With&nbsp;no&nbsp;sleep,&nbsp;the&nbsp;pipe&nbsp;seems&nbsp;to&nbsp;be&nbsp;broken&nbsp;every&nbsp;time.&nbsp;&lt;br&gt; &nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;With&nbsp;the&nbsp;technical&nbsp;explanation&nbsp;out&nbsp;of&nbsp;the&nbsp;way,&nbsp;is&nbsp;there&nbsp;any&nbsp;way&nbsp;i&nbsp;could&nbsp;wait&nbsp;/&nbsp;yield,&nbsp;and&nbsp;force&nbsp;the&nbsp;Process.Start()&nbsp;to&nbsp;complete&nbsp;launching&nbsp;the&nbsp;client&nbsp;before&nbsp;DisploseLocalCopyOfClientHandle()&nbsp;complete?&nbsp;I&nbsp;can&nbsp;certainly&nbsp;find&nbsp;some&nbsp;threshold&nbsp;where&nbsp;Thread.Sleep()&nbsp;reliably&nbsp;fixes&nbsp;the&nbsp;issue&nbsp;on&nbsp;my&nbsp;machine,&nbsp;but&nbsp;it&nbsp;may&nbsp;not&nbsp;be&nbsp;nearly&nbsp;as&nbsp;reliable&nbsp;across&nbsp;platforms&nbsp;either,&nbsp;and&nbsp;may&nbsp;need&nbsp;to&nbsp;be&nbsp;pretty&nbsp;huge&nbsp;(multiple&nbsp;seconds&nbsp;maybe?)&nbsp;to&nbsp;really&nbsp;get&nbsp;good&nbsp;reliability&nbsp;that&nbsp;way.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;also&nbsp;would&nbsp;still&nbsp;appreciate&nbsp;some&nbsp;feedback&nbsp;on&nbsp;the&nbsp;handle&nbsp;inheritance&nbsp;problem.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;There&nbsp;aren&#39;t&nbsp;any&nbsp;tests&nbsp;yet,&nbsp;and&nbsp;i&#39;m&nbsp;pretty&nbsp;severely&nbsp;violating&nbsp;the&nbsp;coding&nbsp;standards&nbsp;document&nbsp;at&nbsp;this&nbsp;point,&nbsp;so&nbsp;both&nbsp;of&nbsp;those&nbsp;things&nbsp;are&nbsp;still&nbsp;on&nbsp;my&nbsp;todo&nbsp;list.&nbsp;I&#39;d&nbsp;also&nbsp;like&nbsp;to&nbsp;throw&nbsp;together&nbsp;the&nbsp;win32&nbsp;implementation&nbsp;as&nbsp;well&nbsp;(something&nbsp;that&nbsp;would&nbsp;be&nbsp;compatible&nbsp;with&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://MS.NET&quot;&gt;MS.NET&lt;/a&gt;&nbsp;implementation).&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
