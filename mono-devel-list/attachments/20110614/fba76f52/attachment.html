<tt>
&lt;p&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&quot;&gt;Yes,&nbsp;Tom,&nbsp;I&nbsp;think&nbsp;it&nbsp;could&nbsp;be&nbsp;the&nbsp;problem.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&quot;&gt;For&nbsp;the&nbsp;moment&nbsp;I&nbsp;solved&nbsp;with&nbsp;a&nbsp;workaround.&nbsp;I&nbsp;changed&nbsp;the&nbsp;architecture&nbsp;and&nbsp;made&nbsp;up&nbsp;threads&nbsp;instead&nbsp;of&nbsp;processes.&nbsp;Anyways&nbsp;I&nbsp;think&nbsp;there&nbsp;are&nbsp;several&nbsp;situations&nbsp;where&nbsp;having&nbsp;more&nbsp;than&nbsp;255&nbsp;processes&nbsp;is&nbsp;possible.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&quot;&gt;Another&nbsp;difference&nbsp;I&nbsp;noticed&nbsp;is&nbsp;that&nbsp;when&nbsp;you&nbsp;create&nbsp;child&nbsp;processes&nbsp;and&nbsp;kill&nbsp;the&nbsp;main&nbsp;program,&nbsp;under&nbsp;windows&nbsp;the&nbsp;processes&nbsp;are&nbsp;killed,&nbsp;whereas&nbsp;they&nbsp;continue&nbsp;to&nbsp;live&nbsp;on&nbsp;linux.&nbsp;&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;i&gt;Tom&nbsp;wrote:&lt;/i&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;i&gt;Might&nbsp;it&nbsp;have&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;fact&nbsp;that&nbsp;Mono&nbsp;only&nbsp;allows&nbsp;256&nbsp;shared&nbsp;handles?<br>
<br>
See&nbsp;_WAPI_HANDLE_INITIAL_COUNT&nbsp;in&nbsp;wapi-private.h&nbsp;and&nbsp;the&nbsp;&quot;/*&nbsp;FIXME:&nbsp;grow<br>
the&nbsp;arrays&nbsp;*/&quot;&nbsp;in&nbsp;handles.c&nbsp;_wapi_handle_real_new().<br>
<br>
We&nbsp;ran&nbsp;into&nbsp;a&nbsp;problem&nbsp;like&nbsp;this&nbsp;on&nbsp;a&nbsp;build&nbsp;box&nbsp;that&nbsp;exec'd&nbsp;a&nbsp;lot&nbsp;of<br>
processes&nbsp;but&nbsp;we&nbsp;worked&nbsp;around&nbsp;it&nbsp;by&nbsp;using&nbsp;GC.Collect();<br>
GC.WaitForPendingFinalizers();&nbsp;GC.Collect();&nbsp;to&nbsp;clean&nbsp;up&nbsp;the&nbsp;handles.<br>
<br>
Tom<br>
&lt;/i&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;br&gt;&lt;/p&gt;<br>
&lt;blockquote&gt;<br>
----Messaggio&nbsp;originale----&lt;br&gt;<br>
Da:&nbsp;fcolle@libero.it&lt;br&gt;<br>
Data:&nbsp;13/06/2011&nbsp;16.10&lt;br&gt;<br>
A:&nbsp;&amp;lt;mono-devel-list@lists.ximian.com&amp;gt;&lt;br&gt;<br>
Ogg:&nbsp;System.Diagnostics.Process.Start()&nbsp;crashes&nbsp;when&nbsp;trying&nbsp;to&nbsp;allocate&nbsp;more&nbsp;than&nbsp;255&nbsp;processes&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;p&gt;&lt;span&gt;Dear&nbsp;all,<br>
&nbsp;my&nbsp;linux&nbsp;application&nbsp;needs&nbsp;to&nbsp;start&nbsp;a&nbsp;big&nbsp;number&nbsp;(400)&nbsp;of&nbsp;processes.&nbsp;Each&nbsp;process&nbsp;is&nbsp;a&nbsp;mono&nbsp;application.&nbsp;<br>
I&nbsp;found&nbsp;the&nbsp;when&nbsp;trying&nbsp;to&nbsp;run&nbsp;more&nbsp;then&nbsp;255&nbsp;processes&nbsp;the&nbsp;runtime&nbsp;generates&nbsp;an&nbsp;exception.&lt;/span&gt;&lt;br&gt;&lt;span&gt;<br>
The&nbsp;problem&nbsp;does&nbsp;NOT&nbsp;arise&nbsp;when&nbsp;executing&nbsp;other&nbsp;processes,&nbsp;like&nbsp;e.g.&nbsp;bash.<br>
<br>
&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;span&gt;<br>
The&nbsp;following&nbsp;two&nbsp;executables&nbsp;classes&nbsp;are&nbsp;a&nbsp;simple&nbsp;proof&nbsp;of&nbsp;concept.&nbsp;<br>
Just&nbsp;compile&nbsp;the&nbsp;second&nbsp;class&nbsp;and&nbsp;put&nbsp;in&nbsp;into&nbsp;the&nbsp;/tmp&nbsp;folder&lt;/span&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;MAIN&nbsp;PROGRAM&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;code&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;&lt;pre&gt;&lt;span&gt;using&nbsp;System;<br>
using&nbsp;System.Collections.Generic;<br>
using&nbsp;System.Text;<br>
<br>
using&nbsp;System.Diagnostics;<br>
<br>
namespace&nbsp;CrashTester<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Program<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;void&nbsp;Main(string[]&nbsp;args)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///In&nbsp;the&nbsp;real&nbsp;application&nbsp;this&nbsp;dictionary<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;contains&nbsp;useful&nbsp;data.&nbsp;When&nbsp;a&nbsp;process&nbsp;dies,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;it&nbsp;can&nbsp;be&nbsp;started&nbsp;again&nbsp;with&nbsp;the&nbsp;same&nbsp;input&nbsp;parameters<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;260;&nbsp;i++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.Error.WriteLine(&quot;STARTING&nbsp;PROCESS:&nbsp;&quot;+(i+1).ToString());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessStartInfo&nbsp;startinfo&nbsp;=&nbsp;new&nbsp;ProcessStartInfo();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startinfo.FileName&nbsp;=&nbsp;&quot;/usr/local/bin/mono&quot;;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startinfo.Arguments&nbsp;=&nbsp;&quot;/tmp/ToCrash.exe&nbsp;&quot;+(i+1).ToString();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startinfo.UseShellExecute&nbsp;=&nbsp;false;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startinfo.RedirectStandardError&nbsp;=&nbsp;false;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startinfo.RedirectStandardOutput&nbsp;=&nbsp;false;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process&nbsp;p&nbsp;=&nbsp;new&nbsp;Process();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.StartInfo&nbsp;=&nbsp;startinfo;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.Start();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;(Exception&nbsp;ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.Error.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.Error.WriteLine(&quot;ERROR&nbsp;IN&nbsp;START&nbsp;PROCESS!&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.ReadKey();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
&lt;/span&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;CHILD&nbsp;PROCESSES&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;<br>
using&nbsp;System;<br>
using&nbsp;System.Collections.Generic;<br>
using&nbsp;System.Text;<br>
<br>
namespace&nbsp;ToCrash<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Program<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;void&nbsp;Main(string[]&nbsp;args)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif((args!=null)&amp;amp;&amp;amp;(args.Length&amp;gt;0))<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(args[0]);<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.ReadLine();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div&nbsp;style=&quot;position:&nbsp;absolute;&nbsp;left:&nbsp;-10000px;&nbsp;top:&nbsp;0px;&nbsp;width:&nbsp;1px;&nbsp;height:&nbsp;1px;&nbsp;overflow:&nbsp;hidden;&quot;&nbsp;id=&quot;_mcePaste&quot;&gt;&amp;nbsp;&lt;/div&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
</tt>
