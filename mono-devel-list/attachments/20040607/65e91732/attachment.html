<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;TITLE&gt;Message&lt;/TITLE&gt;<br>
<br>
&lt;META&nbsp;content=&quot;MSHTML&nbsp;6.00.2800.1400&quot;&nbsp;name=GENERATOR&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;style=&quot;COLOR:&nbsp;#000000;&nbsp;FONT-FAMILY:&nbsp;Arial&quot;&nbsp;hb_focus_attach=&quot;true&quot;&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;Hello,&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;In&nbsp;Order&nbsp;to&nbsp;improve&nbsp;performance&nbsp;<br>
,&nbsp;I&nbsp;have&nbsp;change&nbsp;Server&nbsp;Variables&nbsp;implementation.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;I&nbsp;performed&nbsp;the&nbsp;following&nbsp;<br>
change&nbsp;in&nbsp;HttpRequest:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;UL&gt;<br>
&nbsp;&nbsp;&lt;LI&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;&amp;nbsp;Added&nbsp;2&nbsp;new&nbsp;properties&nbsp;:&nbsp;<br>
&nbsp;&nbsp;Context&nbsp;and&nbsp;WorkerRequest.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/LI&gt;<br>
&nbsp;&nbsp;&lt;LI&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;The&nbsp;method&nbsp;<br>
&nbsp;&nbsp;ParseServerVariables&nbsp;creates&nbsp;a&nbsp;new&nbsp;ServerVariablesCollection&nbsp;<br>
&nbsp;&nbsp;instance&amp;nbsp;instead&nbsp;of&amp;nbsp;creating&nbsp;new&nbsp;NameValueCollection&nbsp;that&nbsp;contains&nbsp;<br>
&nbsp;&nbsp;all&nbsp;the&amp;nbsp;&lt;BR&gt;server&nbsp;variables.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/LI&gt;&lt;/UL&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;ServerVariableCollection&nbsp;is&nbsp;a&nbsp;<br>
new&nbsp;class&nbsp;that&amp;nbsp;derive&nbsp;from&nbsp;NameValueCollection.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;<br>
size=2&gt;While&nbsp;trying&nbsp;to&nbsp;get&lt;/FONT&gt;&lt;FONT&nbsp;size=3&gt;&amp;nbsp;&lt;/FONT&gt;&lt;FONT&nbsp;size=2&gt;the&nbsp;<br>
value&nbsp;associated&nbsp;with&nbsp;a&nbsp;specified&nbsp;key,&nbsp;the&nbsp;new&nbsp;class&nbsp;performs&nbsp;the&nbsp;following&nbsp;<br>
steps:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;UL&gt;<br>
&nbsp;&nbsp;&lt;LI&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;Check&nbsp;if&nbsp;the&nbsp;collection&nbsp;was&nbsp;<br>
&nbsp;&nbsp;loaded&nbsp;in&nbsp;the&nbsp;past&nbsp;(meaning&nbsp;that&nbsp;all&nbsp;the&nbsp;variables&nbsp;were&amp;nbsp;added).&nbsp;if&nbsp;the&nbsp;<br>
&nbsp;&nbsp;answer&nbsp;is&nbsp;yes&nbsp;,&amp;nbsp;&lt;BR&gt;then&amp;nbsp;return&nbsp;the&nbsp;value&nbsp;from&nbsp;the&nbsp;<br>
&nbsp;&nbsp;collection.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&amp;nbsp;&lt;/SPAN&gt;&lt;/LI&gt;<br>
&nbsp;&nbsp;&lt;LI&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;if&nbsp;the&nbsp;answer&nbsp;was&nbsp;no&nbsp;,check&nbsp;if&nbsp;<br>
&nbsp;&nbsp;for&nbsp;this&nbsp;key&nbsp;the&nbsp;method&nbsp;can&nbsp;be&nbsp;called&nbsp;directly.&nbsp;if&nbsp;the&nbsp;answer&nbsp;is&nbsp;yes&nbsp;return&nbsp;<br>
&nbsp;&nbsp;the&nbsp;method&nbsp;value.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/LI&gt;<br>
&nbsp;&nbsp;&lt;LI&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;it&amp;nbsp;answer&nbsp;was&nbsp;<br>
&nbsp;&nbsp;no,&amp;nbsp;add&nbsp;all&nbsp;the&nbsp;server&nbsp;variables&nbsp;to&nbsp;the&nbsp;collection&nbsp;and&amp;nbsp;return&nbsp;the&nbsp;<br>
&nbsp;&nbsp;key's&nbsp;value&nbsp;from&nbsp;the&nbsp;collection.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/LI&gt;&lt;/UL&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;Thanks,&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;Alon&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=717400515-07062004&gt;&amp;nbsp;&amp;nbsp;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;P&gt;&lt;/P&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
