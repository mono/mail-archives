Index: ChangeLog
===================================================================
RCS file: /mono/mono/mono/metadata/ChangeLog,v
retrieving revision 1.1535
diff -u -3 -p -r1.1535 ChangeLog
--- ChangeLog	23 Apr 2004 14:58:44 -0000	1.1535
+++ ChangeLog	23 Apr 2004 23:14:43 -0000
@@ -1,3 +1,7 @@
+2004-04-23  Robert Shade <rshade@dvsconsulting.com>
+	* locales.c:  icalls for String.ToUpper/ToLower and Char.ToUpper/ToLower
+	should throw an ArgumentNullException if the cult argument is null.
+
 2004-04-23  Sebastien Pouliot  <sebastien@ximian.com>
 
 	* icall.c: Registred new icalls for key pair protection and added an
Index: locales.c
===================================================================
RCS file: /mono/mono/mono/metadata/locales.c,v
retrieving revision 1.16
diff -u -3 -p -r1.16 locales.c
--- locales.c	21 Apr 2004 14:58:37 -0000	1.16
+++ locales.c	23 Apr 2004 23:14:44 -0000
@@ -1427,6 +1427,11 @@ MonoString *ves_icall_System_String_Inte
 	UErrorCode ec;
 	char *icu_loc;
 	int32_t len;
+
+    if(cult==NULL) {
+        mono_raise_exception(mono_get_exception_argument_null("cult"));
+        return(0);
+    }
 	
 #ifdef DEBUG
 	g_message (G_GNUC_PRETTY_FUNCTION ": [%s]",
@@ -1496,6 +1501,11 @@ MonoString *ves_icall_System_String_Inte
 	UErrorCode ec;
 	char *icu_loc;
 	int32_t len;
+
+	if(cult==NULL) {
+		mono_raise_exception(mono_get_exception_argument_null("cult"));
+		return(0);
+	}
 	
 #ifdef DEBUG
 	g_message (G_GNUC_PRETTY_FUNCTION ": [%s]",
@@ -1567,6 +1577,11 @@ gunichar2 ves_icall_System_Char_Internal
 	
 	MONO_ARCH_SAVE_REGS;
 
+	if(cult==NULL) {
+		mono_raise_exception(mono_get_exception_argument_null("cult"));
+		return(0);
+	}
+
 	if(cult->lcid==0x007F) {
 		/* Invariant shortcut */
 		return g_unichar_toupper (c);
@@ -1599,6 +1614,11 @@ gunichar2 ves_icall_System_Char_Internal
 	
 	MONO_ARCH_SAVE_REGS;
 
+	if(cult==NULL) {
+		mono_raise_exception(mono_get_exception_argument_null("cult"));
+		return(0);
+	}
+
 	if(cult->lcid==0x007F) {
 		/* Invariant shortcut */
 		return g_unichar_tolower (c);
@@ -1707,14 +1727,24 @@ MonoString *ves_icall_System_String_Inte
 MonoString *ves_icall_System_String_InternalToLower_Comp (MonoString *this, MonoCultureInfo *cult)
 {
 	MONO_ARCH_SAVE_REGS;
-	
+
+	if(cult==NULL) {
+		mono_raise_exception(mono_get_exception_argument_null("cult"));
+		return(0);
+	}
+
 	return(string_invariant_tolower (this));
 }
 
 MonoString *ves_icall_System_String_InternalToUpper_Comp (MonoString *this, MonoCultureInfo *cult)
 {
 	MONO_ARCH_SAVE_REGS;
-	
+
+	if(cult==NULL) {
+		mono_raise_exception(mono_get_exception_argument_null("cult"));
+		return(0);
+	}
+
 	return(string_invariant_toupper (this));
 }
 
@@ -1722,6 +1752,11 @@ gunichar2 ves_icall_System_Char_Internal
 {
 	MONO_ARCH_SAVE_REGS;
 
+	if(cult==NULL) {
+		mono_raise_exception(mono_get_exception_argument_null("cult"));
+		return(0);
+	}
+
 	return g_unichar_toupper (c);
 }
 
@@ -1729,6 +1764,11 @@ gunichar2 ves_icall_System_Char_Internal
 gunichar2 ves_icall_System_Char_InternalToLower_Comp (gunichar2 c, MonoCultureInfo *cult)
 {
 	MONO_ARCH_SAVE_REGS;
+
+	if(cult==NULL) {
+		mono_raise_exception(mono_get_exception_argument_null("cult"));
+		return(0);
+	}
 
 	return g_unichar_tolower (c);
 }
