<tt>
On&nbsp;5/11/05,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Jérôme&nbsp;Laban&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jaylee@epitech.net&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;jaylee@epitech.net&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;div&gt;&lt;span&nbsp;class=&quot;q&quot;&gt;<br>
&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;q&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&nbsp;align=&quot;left&quot;&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&nbsp;face=&quot;Tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;/font&gt;&nbsp;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&nbsp;face=&quot;Tahoma&quot;&gt;I&nbsp;also&nbsp;noted&nbsp;that&nbsp;redefining&nbsp;register&nbsp;indices&nbsp;is&nbsp;not&nbsp;needed&nbsp;if&nbsp;<br>
&lt;/font&gt;&lt;font&nbsp;face=&quot;Tahoma&quot;&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;HAVE_WORKING_SIGALTSTACK&lt;/font&gt;&lt;span&gt;&nbsp;&lt;font&nbsp;size=&quot;2&quot;&gt;is&nbsp;defined.&nbsp;But&nbsp;since&nbsp;it&nbsp;can&nbsp;be&nbsp;disabled&nbsp;using&nbsp;<br>
--with-sigaltstack=no,&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;font&nbsp;color=&quot;#0000ff&quot;&nbsp;face=&quot;Tahoma&quot;&gt;it&nbsp;would&nbsp;break&nbsp;the&nbsp;compatibility&nbsp;with&nbsp;NetBSD's&nbsp;sigcontext.&nbsp;I&nbsp;think&nbsp;<br>
its&nbsp;best&nbsp;to&nbsp;leave&nbsp;it&nbsp;there.&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/span&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Hmm.&amp;nbsp;&nbsp;Well,&nbsp;it's&nbsp;probably&amp;nbsp;&nbsp;beyond&nbsp;my&nbsp;charter&nbsp;to<br>
criticize&nbsp;here,&nbsp;but&nbsp;I&nbsp;don't&nbsp;think&nbsp;it'll&nbsp;make&nbsp;it&nbsp;in&nbsp;to&nbsp;the&nbsp;source&nbsp;like<br>
that.&amp;nbsp;&nbsp;You've&nbsp;made&nbsp;sigaltstack=yes&nbsp;the&nbsp;default&nbsp;for&nbsp;netbsd2&nbsp;in<br>
configure.in,&nbsp;so&nbsp;if&nbsp;some&nbsp;poor&nbsp;sap&nbsp;wants&nbsp;to&nbsp;try&nbsp;to&nbsp;run&nbsp;without&nbsp;it,&nbsp;he<br>
deserves&nbsp;to&nbsp;get&nbsp;his&nbsp;registers&nbsp;zapped&nbsp;a&nbsp;little,&nbsp;imho.&amp;nbsp;&nbsp;:)&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
Btw,&nbsp;did&nbsp;you&nbsp;not&nbsp;have&nbsp;trouble&nbsp;with&amp;nbsp;&nbsp;io-layer/collection.c?&amp;nbsp;<br>
Awhile&nbsp;back&nbsp;I&nbsp;tried&nbsp;to&nbsp;help&nbsp;a&nbsp;netbsd&nbsp;user&nbsp;and&nbsp;we&nbsp;found&nbsp;that,&nbsp;at&nbsp;least<br>
on&nbsp;his&nbsp;version&nbsp;(early?)&nbsp;of&nbsp;2.0,&nbsp;there&nbsp;was&nbsp;no&nbsp;definition&nbsp;for<br>
PTHREAD_STACK_MIN.&amp;nbsp;&nbsp;Perhaps&nbsp;that's&nbsp;been&nbsp;fixed&nbsp;in&nbsp;netbsd&nbsp;now?&amp;nbsp;<br>
Here's&nbsp;the&nbsp;patch&nbsp;that&nbsp;got&nbsp;him&nbsp;past&nbsp;that&nbsp;error.&amp;nbsp;&nbsp;It&nbsp;simply&nbsp;presets<br>
a&nbsp;reasonable&nbsp;default&nbsp;for&nbsp;minimum&nbsp;stack&nbsp;size&nbsp;(which&nbsp;is&nbsp;broken&nbsp;in&nbsp;Freebsd<br>
except&nbsp;for&nbsp;CURRENT),&nbsp;so&nbsp;I&nbsp;knew&nbsp;right&nbsp;where&nbsp;to&nbsp;look.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Index:&nbsp;/home/wjm/src/mono/mono/io-layer/collection.c&lt;br&gt;<br>
===================================================================&lt;br&gt;<br>
---&nbsp;collection.c&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(revision&nbsp;44342)&lt;br&gt;<br>
+++&nbsp;collection.c&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(working&nbsp;copy)&lt;br&gt;<br>
@@&nbsp;-53,7&nbsp;+53,7&nbsp;@@&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;g_assert&nbsp;(ret&nbsp;==&nbsp;0);&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;#ifdef&nbsp;HAVE_PTHREAD_ATTR_SETSTACKSIZE&lt;br&gt;<br>
-#ifdef&nbsp;__FreeBSD__&lt;br&gt;<br>
+#if&nbsp;defined(__FreeBSD__)&nbsp;||&nbsp;defined(__NetBSD__)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ret&nbsp;=&nbsp;pthread_attr_setstacksize&nbsp;(&amp;amp;attr,&nbsp;65536);&lt;br&gt;<br>
&amp;nbsp;#else&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ret&nbsp;=&nbsp;pthread_attr_setstacksize&nbsp;(&amp;amp;attr,&nbsp;PTHREAD_STACK_MIN);&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Finally,&nbsp;as&nbsp;I&nbsp;understood&nbsp;it,&nbsp;NetBSD&nbsp;1.6&nbsp;_does_&nbsp;have&nbsp;working&nbsp;kernel<br>
threads,&nbsp;but&nbsp;not&nbsp;tls&nbsp;support&nbsp;for&nbsp;__thread,&nbsp;yes?&amp;nbsp;&nbsp;I&nbsp;haven't&nbsp;tried<br>
it,&nbsp;but&nbsp;I&nbsp;was&nbsp;pretty&nbsp;sure&nbsp;that&nbsp;netbsd&nbsp;1.6&nbsp;would&nbsp;work&nbsp;ok&nbsp;with<br>
tls=pthread&nbsp;and&nbsp;sigaltstack&nbsp;(although&nbsp;ucontext&nbsp;was&nbsp;still&nbsp;very&nbsp;tentative<br>
then,&nbsp;and&nbsp;may&nbsp;not&nbsp;have&nbsp;__gregs,&nbsp;even).&amp;nbsp;&nbsp;Unfortunately,&nbsp;I&nbsp;cant<br>
verify&nbsp;this,&nbsp;but&nbsp;thanks&nbsp;for&nbsp;leaving&nbsp;1.6&nbsp;a&nbsp;chance&nbsp;to&nbsp;join&nbsp;in&nbsp;the<br>
fray.&amp;nbsp;&nbsp;I'll&nbsp;look&nbsp;your&nbsp;updated&nbsp;patch&nbsp;over&nbsp;soon&nbsp;and&nbsp;may&nbsp;even&nbsp;have&nbsp;some&nbsp;more&nbsp;witty&nbsp;comments.&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
Bill&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;br&gt;
</tt>
