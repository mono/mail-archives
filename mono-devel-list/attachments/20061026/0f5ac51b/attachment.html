<tt>
If&nbsp;you're&nbsp;asking&nbsp;about&nbsp;the&nbsp;performance&nbsp;of&nbsp;the&nbsp;current&nbsp;COM&nbsp;Interop&nbsp;implementation,&nbsp;I&nbsp;don't&nbsp;have&nbsp;many&nbsp;answers.&nbsp;It&nbsp;has&nbsp;not&nbsp;been&nbsp;optimized&nbsp;at&nbsp;all&nbsp;currently.&nbsp;A&nbsp;brief&nbsp;benchmark&nbsp;showed&nbsp;COM&nbsp;Interop&nbsp;on&nbsp;mono&nbsp;running&nbsp;at&nbsp;about&nbsp;5x&nbsp;slower&nbsp;than&nbsp;on&nbsp;.Net.&nbsp;I'm&nbsp;sure&nbsp;that&nbsp;will&nbsp;get&nbsp;better&nbsp;if&nbsp;I&nbsp;spend&nbsp;some&nbsp;time&nbsp;working&nbsp;on&nbsp;that&nbsp;(but&nbsp;I'd&nbsp;rather&nbsp;get&nbsp;some&nbsp;other&nbsp;features&nbsp;working&nbsp;first).&nbsp;I&nbsp;don't&nbsp;know&nbsp;how&nbsp;this&nbsp;compares&nbsp;to&nbsp;the&nbsp;icall&nbsp;example&nbsp;you&nbsp;posted.<br>
&lt;br&gt;&lt;br&gt;Remember&nbsp;though,&nbsp;there&nbsp;is&nbsp;a&nbsp;lot&nbsp;of&nbsp;stuff&nbsp;that&nbsp;goes&nbsp;on&nbsp;beyond&nbsp;emitting&nbsp;a&nbsp;calli&nbsp;instruction.&nbsp;Proper&nbsp;reference&nbsp;counting,&nbsp;type&nbsp;marshalling,&nbsp;casting/QI,&nbsp;preserving&nbsp;identity,&nbsp;etc.&nbsp;Right&nbsp;now,&nbsp;a&nbsp;COM&nbsp;Interop&nbsp;call&nbsp;involves&nbsp;the&nbsp;overhead&nbsp;of&nbsp;an&nbsp;equivalent&nbsp;pinvoke&nbsp;call,&nbsp;plus&nbsp;some&nbsp;other&nbsp;stuff&nbsp;for&nbsp;mapping&nbsp;managed&nbsp;call&nbsp;signature&nbsp;to&nbsp;COM&nbsp;signature,&nbsp;reference&nbsp;counting,&nbsp;retrieving&nbsp;function&nbsp;pointer&nbsp;from&nbsp;vtable&nbsp;at&nbsp;call&nbsp;time,&nbsp;preserving&nbsp;identity&nbsp;of&nbsp;Runtime&nbsp;Callable&nbsp;Wrappers&nbsp;(so&nbsp;each&nbsp;COM&nbsp;object&nbsp;is&nbsp;only&nbsp;represented&nbsp;by&nbsp;one&nbsp;managed&nbsp;wrapper),&nbsp;etc.<br>
&lt;br&gt;&lt;br&gt;-&nbsp;Jonathan&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;10/26/06,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Brian&nbsp;Crowell&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mono-devel@fluggo.com&quot;&gt;mono-devel@fluggo.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Jon&nbsp;Chambers&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;interop&nbsp;assemblies.&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;try&nbsp;anything&nbsp;out&nbsp;on&nbsp;mono,&nbsp;you&nbsp;will&lt;br&gt;&amp;gt;&nbsp;need&nbsp;to&nbsp;build&nbsp;you&nbsp;interop&nbsp;assemblies&nbsp;with&nbsp;.Net&nbsp;(either&nbsp;by&nbsp;hand&nbsp;or&nbsp;via&lt;br&gt;&amp;gt;&nbsp;tlbimp).&nbsp;If&nbsp;you&nbsp;need&nbsp;any&nbsp;other&nbsp;help&nbsp;let&nbsp;me&nbsp;know.<br>
&lt;br&gt;&lt;br&gt;All&nbsp;right,&nbsp;I&nbsp;went&nbsp;back&nbsp;and&nbsp;found&nbsp;the&nbsp;COM&nbsp;import&nbsp;examples&nbsp;in&nbsp;the&nbsp;.NET&nbsp;documentation.&nbsp;I&nbsp;had&nbsp;read&nbsp;this&nbsp;stuff&nbsp;once,&nbsp;but&nbsp;I&nbsp;hadn't&nbsp;ever&nbsp;tried&nbsp;it&nbsp;out.&nbsp;Managed&nbsp;to&nbsp;get&nbsp;an&nbsp;IDirect3D9&nbsp;interface&nbsp;definition&nbsp;working&nbsp;in&nbsp;pure&nbsp;C#.<br>
&lt;br&gt;&lt;br&gt;That&nbsp;lends&nbsp;some&nbsp;possibility&nbsp;to&nbsp;doing&nbsp;the&nbsp;whole&nbsp;thing&nbsp;in&nbsp;C#.&nbsp;*Now*&nbsp;my&nbsp;question&nbsp;is&nbsp;how&nbsp;this&nbsp;performs.&nbsp;How&nbsp;do&nbsp;runtime-callable-wrappers&nbsp;perform,&nbsp;compared&nbsp;to&nbsp;doing&nbsp;the&nbsp;icall&nbsp;shown&nbsp;in&nbsp;the&nbsp;previous&nbsp;IL&nbsp;listing?&lt;br&gt;&lt;br&gt;--Brian<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
