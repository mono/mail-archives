<tt>
&lt;html&gt;Hello&nbsp;all,&lt;br&gt;&lt;br&gt;I&nbsp;know&nbsp;mono&nbsp;will&nbsp;run&nbsp;on&nbsp;OMAPs&nbsp;(nokia&nbsp;770),&nbsp;and&nbsp;I&nbsp;managed&nbsp;to&nbsp;get&nbsp;the&nbsp;same&nbsp;binary&nbsp;to&nbsp;run&nbsp;a&nbsp;Cirrus&nbsp;Logic&nbsp;EP9302.&lt;br&gt;What&nbsp;is&nbsp;required&nbsp;to&nbsp;get&nbsp;mono&nbsp;to&nbsp;run&nbsp;on&nbsp;XScale.&nbsp;I&nbsp;have&nbsp;an&nbsp;application&nbsp;in&nbsp;mind&nbsp;that&nbsp;uses&nbsp;a&nbsp;PXA255,&nbsp;and&nbsp;I&nbsp;would&nbsp;love&nbsp;to&nbsp;use&nbsp;C#...&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Thanks!&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;J.Cody&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;-----Original&nbsp;Message-----&lt;br&gt;<br>
&amp;gt;From:&nbsp;mono-devel-list-request@lists.ximian.com&nbsp;[mailto:mono-devel-list-request@lists.ximian.com]&lt;br&gt;<br>
&amp;gt;Sent:&nbsp;Thursday,&nbsp;October&nbsp;26,&nbsp;2006&nbsp;12:11&nbsp;AM&lt;br&gt;<br>
&amp;gt;To:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Mono-devel-list&nbsp;Digest,&nbsp;Vol&nbsp;18,&nbsp;Issue&nbsp;62&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Send&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsphttp://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;br&gt;<br>
&amp;gt;or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;'help'&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmono-devel-list-request@lists.ximian.com&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmono-devel-list-owner@lists.ximian.com&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific&lt;br&gt;<br>
&amp;gt;than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;Mono-devel-list&nbsp;digest...&quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Today's&nbsp;Topics:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;1.&nbsp;Re:&nbsp;&nbsp;Managed&nbsp;DirectX&nbsp;(Brian&nbsp;Crowell)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;2.&nbsp;Re:&nbsp;&nbsp;Managed&nbsp;DirectX&nbsp;(Stefan&nbsp;D?singer)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;3.&nbsp;Re:&nbsp;&nbsp;Managed&nbsp;DirectX&nbsp;(Brian&nbsp;Crowell)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;4.&nbsp;&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&nbsp;(Ben&nbsp;Maurer)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;5.&nbsp;Re:&nbsp;&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&nbsp;(Atsushi&nbsp;Eno)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;6.&nbsp;Re:&nbsp;&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&nbsp;(Aaron&nbsp;Bockover)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;7.&nbsp;Re:&nbsp;&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&nbsp;(Alan&nbsp;McGovern)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;8.&nbsp;Re:&nbsp;&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&nbsp;(Atsushi&nbsp;Eno)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;9.&nbsp;Re:&nbsp;&nbsp;Managed&nbsp;DirectX&nbsp;(Miguel&nbsp;de&nbsp;Icaza)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;10.&nbsp;&nbsp;[PATCH]&nbsp;OS&nbsp;X&nbsp;MACHINE_THREAD_STATE&nbsp;patch&nbsp;for&nbsp;newer&nbsp;10.4u&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspSDK&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Allan&nbsp;Hsu)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;----------------------------------------------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;1&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;13:31:07&nbsp;-0500&lt;br&gt;<br>
&amp;gt;From:&nbsp;Brian&nbsp;Crowell&nbsp;&amp;lt;mono-devel@fluggo.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;Managed&nbsp;DirectX&lt;br&gt;<br>
&amp;gt;To:&nbsp;Michael&nbsp;Schurter&nbsp;&amp;lt;michael@synthesyssolutions.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Cc:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;453FAD6B.5020509@fluggo.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=ISO-8859-1;&nbsp;format=flowed&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Michael&nbsp;Schurter&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Careful&nbsp;what&nbsp;you&nbsp;do&nbsp;with&nbsp;ILDASM&nbsp;Brian,&nbsp;at&nbsp;least&nbsp;if&nbsp;you&nbsp;plan&nbsp;on&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;contributing&nbsp;code&nbsp;to&nbsp;the&nbsp;mono&nbsp;project:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Yes,&nbsp;I&nbsp;know.&nbsp;I&nbsp;mostly&nbsp;just&nbsp;wanted&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;they&nbsp;made&nbsp;calls;&nbsp;everything&nbsp;else&nbsp;in&nbsp;my&nbsp;own&nbsp;managed&nbsp;implementation&nbsp;is&nbsp;written&nbsp;from&nbsp;scratch&nbsp;using&nbsp;documentation.&nbsp;Better&nbsp;yet,&nbsp;I&nbsp;throw&nbsp;more&nbsp;useful&nbsp;exceptions.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Anyhow,&nbsp;does&nbsp;anyone&nbsp;know&nbsp;of&nbsp;a&nbsp;good&nbsp;way&nbsp;to&nbsp;step&nbsp;around&nbsp;the&nbsp;hand-coded&nbsp;interop&nbsp;problem&nbsp;without&nbsp;using&nbsp;Managed&nbsp;C++&nbsp;or&nbsp;C++/CLI?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;--Brian&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;2&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;20:49:29&nbsp;+0200&lt;br&gt;<br>
&amp;gt;From:&nbsp;Stefan&nbsp;D?singer&nbsp;&amp;lt;stefandoesinger@gmx.at&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;Managed&nbsp;DirectX&lt;br&gt;<br>
&amp;gt;To:&nbsp;Brian&nbsp;Crowell&nbsp;&amp;lt;mono-devel@fluggo.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Cc:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;200610252049.35526.stefandoesinger@gmx.at&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;iso-8859-1&quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Am&nbsp;Mittwoch&nbsp;25&nbsp;Oktober&nbsp;2006&nbsp;19:02&nbsp;schrieben&nbsp;Sie:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;A&nbsp;practical&nbsp;example&nbsp;of&nbsp;building&nbsp;a&nbsp;wrapper&nbsp;by&nbsp;hand&nbsp;would&nbsp;be&nbsp;most&nbsp;helpful.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Late&nbsp;binding&nbsp;is&nbsp;not&nbsp;an&nbsp;option,&nbsp;and&nbsp;I&nbsp;haven't&nbsp;ever&nbsp;found&nbsp;interface&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;definition&nbsp;files&nbsp;for&nbsp;DirectX9.&lt;br&gt;<br>
&amp;gt;As&nbsp;far&nbsp;as&nbsp;I&nbsp;know&nbsp;idl&nbsp;files&nbsp;for&nbsp;dx9&nbsp;do&nbsp;not&nbsp;exist,&nbsp;only&nbsp;the&nbsp;d3d9.h,&nbsp;d3d9types.h&nbsp;&lt;br&gt;<br>
&amp;gt;and&nbsp;d3d9caps.h(simmilar&nbsp;for&nbsp;other&nbsp;dx&nbsp;parts),&nbsp;but&nbsp;with&nbsp;dx10&nbsp;ms&nbsp;started&nbsp;using&nbsp;&lt;br&gt;<br>
&amp;gt;idl&nbsp;files.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;So&nbsp;from&nbsp;the&nbsp;other&nbsp;replies&nbsp;it&nbsp;sounds&nbsp;like&nbsp;you&nbsp;can&nbsp;use&nbsp;wine&nbsp;for&nbsp;dx,&nbsp;but&nbsp;mono&nbsp;&lt;br&gt;<br>
&amp;gt;needs&nbsp;some&nbsp;preparation&nbsp;work&nbsp;first.&nbsp;If&nbsp;you&nbsp;need&nbsp;any&nbsp;help&nbsp;just&nbsp;contact&nbsp;me&nbsp;or&nbsp;&lt;br&gt;<br>
&amp;gt;the&nbsp;wine-devel&nbsp;list&nbsp;:-)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Stefan&lt;br&gt;<br>
&amp;gt;--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
&amp;gt;A&nbsp;non-text&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
&amp;gt;Name:&nbsp;not&nbsp;available&lt;br&gt;<br>
&amp;gt;Type:&nbsp;application/pgp-signature&lt;br&gt;<br>
&amp;gt;Size:&nbsp;189&nbsp;bytes&lt;br&gt;<br>
&amp;gt;Desc:&nbsp;not&nbsp;available&lt;br&gt;<br>
&amp;gt;Url&nbsp;:&nbsp;http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/f9253082/attachment-0001.bin&nbsp;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;3&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;14:08:14&nbsp;-0500&lt;br&gt;<br>
&amp;gt;From:&nbsp;Brian&nbsp;Crowell&nbsp;&amp;lt;mono-devel@fluggo.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;Managed&nbsp;DirectX&lt;br&gt;<br>
&amp;gt;To:&nbsp;Stefan&nbsp;D?singer&nbsp;&amp;lt;stefandoesinger@gmx.at&amp;gt;&lt;br&gt;<br>
&amp;gt;Cc:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;453FB61E.6040705@fluggo.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=ISO-8859-1;&nbsp;format=flowed&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Stefan&nbsp;D?singer&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;So&nbsp;from&nbsp;the&nbsp;other&nbsp;replies&nbsp;it&nbsp;sounds&nbsp;like&nbsp;you&nbsp;can&nbsp;use&nbsp;wine&nbsp;for&nbsp;dx,&nbsp;but&nbsp;mono&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;needs&nbsp;some&nbsp;preparation&nbsp;work&nbsp;first.&nbsp;If&nbsp;you&nbsp;need&nbsp;any&nbsp;help&nbsp;just&nbsp;contact&nbsp;me&nbsp;or&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;the&nbsp;wine-devel&nbsp;list&nbsp;:-)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Well,&nbsp;one&nbsp;option&nbsp;is&nbsp;to&nbsp;use&nbsp;a&nbsp;library&nbsp;written&nbsp;in&nbsp;C++/CLI,&nbsp;compile&nbsp;it&nbsp;with&nbsp;Microsoft's&nbsp;C++&nbsp;compiler,&nbsp;and&nbsp;then&nbsp;use&nbsp;the&nbsp;resulting&nbsp;library&nbsp;with&nbsp;Mono.&nbsp;That&nbsp;should&nbsp;work.&nbsp;There's&nbsp;just&nbsp;no&nbsp;equivalent&nbsp;all-Mono&nbsp;method.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Tell&nbsp;you&nbsp;what.&nbsp;Sometime&nbsp;this&nbsp;week&nbsp;I'll&nbsp;look&nbsp;to&nbsp;release&nbsp;what&nbsp;I&nbsp;have&nbsp;done&nbsp;regarding&nbsp;XNA.&nbsp;It&nbsp;won't&nbsp;be&nbsp;exactly&nbsp;what&nbsp;you&nbsp;want--&nbsp;in&nbsp;particular,&nbsp;my&nbsp;library&nbsp;depends&nbsp;on&nbsp;a&nbsp;common&nbsp;primitives&nbsp;library--&nbsp;but&nbsp;it&nbsp;could&nbsp;be&nbsp;a&nbsp;good&nbsp;starting&nbsp;point&nbsp;for&nbsp;a&nbsp;Managed&nbsp;DirectX&nbsp;9&nbsp;implementation.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;--Brian&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;4&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;16:51:57&nbsp;-0400&nbsp;(EDT)&lt;br&gt;<br>
&amp;gt;From:&nbsp;&quot;Ben&nbsp;Maurer&quot;&nbsp;&amp;lt;bmaurer@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;[Mono-dev]&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&lt;br&gt;<br>
&amp;gt;To:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&amp;lt;37993.130.57.170.100.1161809517.squirrel@webmail.ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;iso-8859-1&quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Hey&nbsp;guys,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;On&nbsp;the&nbsp;2.0&nbsp;profile,&nbsp;Encoding&nbsp;uses&nbsp;the&nbsp;char*/byte*&nbsp;version&nbsp;of&nbsp;encoding&lt;br&gt;<br>
&amp;gt;methods&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;memory.&nbsp;One&nbsp;code&nbsp;path&nbsp;missed&nbsp;this&lt;br&gt;<br>
&amp;gt;optimization,&nbsp;I've&nbsp;attached&nbsp;a&nbsp;fix.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;This&nbsp;code&nbsp;path&nbsp;ends&nbsp;up&nbsp;being&nbsp;used&nbsp;in&nbsp;Banshee&nbsp;quite&nbsp;a&nbsp;bit&nbsp;on&nbsp;their&nbsp;tree&lt;br&gt;<br>
&amp;gt;view&nbsp;(basically,&nbsp;every&nbsp;time&nbsp;the&nbsp;model&nbsp;is&nbsp;queried,&nbsp;this&nbsp;method&nbsp;gets&nbsp;called&lt;br&gt;<br>
&amp;gt;in&nbsp;passing&nbsp;String&nbsp;objects&nbsp;to&nbsp;char*).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;A&nbsp;few&nbsp;things&nbsp;to&nbsp;think&nbsp;about:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;-&nbsp;It&nbsp;might&nbsp;pay&nbsp;to&nbsp;do&nbsp;something&nbsp;on&nbsp;the&nbsp;1.0&nbsp;profile&nbsp;as&nbsp;well.&lt;br&gt;<br>
&amp;gt;-&nbsp;Paolo,&nbsp;can&nbsp;you&nbsp;comment&nbsp;on&nbsp;how&nbsp;this&nbsp;kind&nbsp;of&nbsp;change&nbsp;works&nbsp;with&nbsp;the&nbsp;moving&nbsp;gc?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;-b&lt;br&gt;<br>
&amp;gt;--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
&amp;gt;A&nbsp;non-text&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
&amp;gt;Name:&nbsp;enc.patch&lt;br&gt;<br>
&amp;gt;Type:&nbsp;text/x-patch&lt;br&gt;<br>
&amp;gt;Size:&nbsp;712&nbsp;bytes&lt;br&gt;<br>
&amp;gt;Desc:&nbsp;not&nbsp;available&lt;br&gt;<br>
&amp;gt;Url&nbsp;:&nbsp;http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/8d07183e/attachment-0001.bin&nbsp;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;5&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Thu,&nbsp;26&nbsp;Oct&nbsp;2006&nbsp;06:06:28&nbsp;+0900&lt;br&gt;<br>
&amp;gt;From:&nbsp;Atsushi&nbsp;Eno&nbsp;&amp;lt;atsushi@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&lt;br&gt;<br>
&amp;gt;To:&nbsp;Ben&nbsp;Maurer&nbsp;&amp;lt;bmaurer@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Cc:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;453FD1D4.6080500@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=ISO-8859-1;&nbsp;format=flowed&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Ben&nbsp;Maurer&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Hey&nbsp;guys,&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;On&nbsp;the&nbsp;2.0&nbsp;profile,&nbsp;Encoding&nbsp;uses&nbsp;the&nbsp;char*/byte*&nbsp;version&nbsp;of&nbsp;encoding&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;methods&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;memory.&nbsp;One&nbsp;code&nbsp;path&nbsp;missed&nbsp;this&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;optimization,&nbsp;I've&nbsp;attached&nbsp;a&nbsp;fix.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;nice&nbsp;:-)&nbsp;Comment&nbsp;for&nbsp;patch&nbsp;below.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;It&nbsp;might&nbsp;pay&nbsp;to&nbsp;do&nbsp;something&nbsp;on&nbsp;the&nbsp;1.0&nbsp;profile&nbsp;as&nbsp;well.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;Paolo,&nbsp;can&nbsp;you&nbsp;comment&nbsp;on&nbsp;how&nbsp;this&nbsp;kind&nbsp;of&nbsp;change&nbsp;works&nbsp;with&nbsp;the&nbsp;moving&nbsp;gc?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;To&nbsp;my&nbsp;understanding,&nbsp;fixed&nbsp;pointers&nbsp;do&nbsp;not&nbsp;participate&nbsp;GC&nbsp;target.&nbsp;And&lt;br&gt;<br>
&amp;gt;-&nbsp;locally-allocated&nbsp;array&nbsp;anyways&nbsp;lives&nbsp;until&nbsp;its&nbsp;conversion&nbsp;finishes&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;(and&nbsp;probably&nbsp;immediately&nbsp;disposed&nbsp;depending&nbsp;on&nbsp;the&nbsp;JIT&nbsp;optimization)&lt;br&gt;<br>
&amp;gt;-&nbsp;Usually&nbsp;this&nbsp;conversion&nbsp;do&nbsp;not&nbsp;take&nbsp;long&nbsp;time&lt;br&gt;<br>
&amp;gt;So&nbsp;I&nbsp;guess&nbsp;fixed&nbsp;pointer&nbsp;would&nbsp;work&nbsp;better&nbsp;than&nbsp;possibly&nbsp;being&nbsp;moved&lt;br&gt;<br>
&amp;gt;from&nbsp;nursery&nbsp;area.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif&nbsp;(s&nbsp;==&nbsp;null)&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspthrow&nbsp;new&nbsp;ArgumentNullException&nbsp;(&quot;s&quot;);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+#if&nbsp;NET_2_0&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspunsafe&nbsp;{&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfixed&nbsp;(char*&nbsp;cptr&nbsp;=&nbsp;s)&nbsp;{&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspreturn&nbsp;GetByteCount&nbsp;(cptr,&nbsp;s.Length);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp}&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp}&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+#else&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspchar[]&nbsp;chars&nbsp;=&nbsp;s.ToCharArray&nbsp;();&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspreturn&nbsp;GetByteCount&nbsp;(chars,&nbsp;0,&nbsp;chars.Length);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;+#endif&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Before&nbsp;fixing&nbsp;the&nbsp;pointer&nbsp;you&nbsp;have&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;s&nbsp;is&nbsp;non-zero&nbsp;length.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Atsushi&nbsp;Eno&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;6&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;17:19:53&nbsp;-0400&lt;br&gt;<br>
&amp;gt;From:&nbsp;Aaron&nbsp;Bockover&nbsp;&amp;lt;abockover@novell.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&lt;br&gt;<br>
&amp;gt;To:&nbsp;Ben&nbsp;Maurer&nbsp;&amp;lt;bmaurer@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Cc:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;1161811193.4788.14.camel@linux-0790.site&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Thanks&nbsp;Ben!&lt;br&gt;<br>
&amp;gt;--Aaron&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;On&nbsp;Wed,&nbsp;2006-10-25&nbsp;at&nbsp;16:51&nbsp;-0400,&nbsp;Ben&nbsp;Maurer&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Hey&nbsp;guys,&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;On&nbsp;the&nbsp;2.0&nbsp;profile,&nbsp;Encoding&nbsp;uses&nbsp;the&nbsp;char*/byte*&nbsp;version&nbsp;of&nbsp;encoding&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;methods&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;memory.&nbsp;One&nbsp;code&nbsp;path&nbsp;missed&nbsp;this&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;optimization,&nbsp;I've&nbsp;attached&nbsp;a&nbsp;fix.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;This&nbsp;code&nbsp;path&nbsp;ends&nbsp;up&nbsp;being&nbsp;used&nbsp;in&nbsp;Banshee&nbsp;quite&nbsp;a&nbsp;bit&nbsp;on&nbsp;their&nbsp;tree&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;view&nbsp;(basically,&nbsp;every&nbsp;time&nbsp;the&nbsp;model&nbsp;is&nbsp;queried,&nbsp;this&nbsp;method&nbsp;gets&nbsp;called&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;in&nbsp;passing&nbsp;String&nbsp;objects&nbsp;to&nbsp;char*).&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;A&nbsp;few&nbsp;things&nbsp;to&nbsp;think&nbsp;about:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;It&nbsp;might&nbsp;pay&nbsp;to&nbsp;do&nbsp;something&nbsp;on&nbsp;the&nbsp;1.0&nbsp;profile&nbsp;as&nbsp;well.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;Paolo,&nbsp;can&nbsp;you&nbsp;comment&nbsp;on&nbsp;how&nbsp;this&nbsp;kind&nbsp;of&nbsp;change&nbsp;works&nbsp;with&nbsp;the&nbsp;moving&nbsp;gc?&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-b&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;_______________________________________________&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&nbsp;Mono-devel-list@lists.ximian.com&nbsp;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;7&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;22:53:51&nbsp;+0100&lt;br&gt;<br>
&amp;gt;From:&nbsp;&quot;Alan&nbsp;McGovern&quot;&nbsp;&amp;lt;alan.mcgovern@gmail.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&lt;br&gt;<br>
&amp;gt;To:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&amp;lt;117799f00610251453w3aa6c5abr127bd697ab55627b@mail.gmail.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;iso-8859-1&quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;To&nbsp;my&nbsp;understanding,&nbsp;fixed&nbsp;pointers&nbsp;do&nbsp;not&nbsp;participate&nbsp;GC&nbsp;target.&nbsp;And&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;locally-allocated&nbsp;array&nbsp;anyways&nbsp;lives&nbsp;until&nbsp;its&nbsp;conversion&nbsp;finishes&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;(and&nbsp;probably&nbsp;immediately&nbsp;disposed&nbsp;depending&nbsp;on&nbsp;the&nbsp;JIT&nbsp;optimization)&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;-&nbsp;Usually&nbsp;this&nbsp;conversion&nbsp;do&nbsp;not&nbsp;take&nbsp;long&nbsp;time&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;So&nbsp;I&nbsp;guess&nbsp;fixed&nbsp;pointer&nbsp;would&nbsp;work&nbsp;better&nbsp;than&nbsp;possibly&nbsp;being&nbsp;moved&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;from&nbsp;nursery&nbsp;area.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;It's&nbsp;better&nbsp;to&nbsp;not&nbsp;allocate&nbsp;a&nbsp;new&nbsp;array&nbsp;if&nbsp;it&nbsp;can&nbsp;be&nbsp;avoided.&nbsp;From&nbsp;my&nbsp;own&lt;br&gt;<br>
&amp;gt;code&nbsp;i&nbsp;found&nbsp;that&nbsp;in&nbsp;one&nbsp;of&nbsp;my&nbsp;intensively&nbsp;used&nbsp;methods&nbsp;i&nbsp;allocated&nbsp;a&lt;br&gt;<br>
&amp;gt;100byte&nbsp;array&nbsp;each&nbsp;time&nbsp;the&nbsp;method&nbsp;was&nbsp;called.&nbsp;By&nbsp;moving&nbsp;that&nbsp;variable&lt;br&gt;<br>
&amp;gt;outside&nbsp;the&nbsp;method&nbsp;and&nbsp;just&nbsp;reinitialising&nbsp;it&nbsp;each&nbsp;time&nbsp;i&nbsp;used&nbsp;it&nbsp;(with&lt;br&gt;<br>
&amp;gt;appropriate&nbsp;locking)&nbsp;memory&nbsp;usage&nbsp;reduced&nbsp;by&nbsp;a&nbsp;large&nbsp;%.&nbsp;Don't&nbsp;rely&nbsp;on&nbsp;the&nbsp;GC&lt;br&gt;<br>
&amp;gt;to&nbsp;tidy&nbsp;up&nbsp;your&nbsp;mess&nbsp;if&nbsp;you&nbsp;can&nbsp;avoid&nbsp;creating&nbsp;it&nbsp;in&nbsp;the&nbsp;first&nbsp;place&nbsp;:p&lt;br&gt;<br>
&amp;gt;--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
&amp;gt;An&nbsp;HTML&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
&amp;gt;URL:&nbsp;http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/be451a55/attachment-0001.html&nbsp;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;8&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Thu,&nbsp;26&nbsp;Oct&nbsp;2006&nbsp;07:02:02&nbsp;+0900&lt;br&gt;<br>
&amp;gt;From:&nbsp;Atsushi&nbsp;Eno&nbsp;&amp;lt;atsushi@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;[PATCH]&nbsp;Optimize&nbsp;Encoding.GetByteCount&lt;br&gt;<br>
&amp;gt;To:&nbsp;Alan&nbsp;McGovern&nbsp;&amp;lt;alan.mcgovern@gmail.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Cc:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;453FDEDA.70306@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=ISO-8859-1;&nbsp;format=flowed&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Hi,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Well,&nbsp;the&nbsp;point&nbsp;of&nbsp;the&nbsp;Ben's&nbsp;question&nbsp;is,&nbsp;compacting&nbsp;GC&nbsp;is&nbsp;likely&nbsp;to&lt;br&gt;<br>
&amp;gt;store&nbsp;array&nbsp;in&nbsp;nursery&nbsp;area&nbsp;(likely,&nbsp;since&nbsp;it&nbsp;could&nbsp;be&nbsp;regarded&nbsp;too&lt;br&gt;<br>
&amp;gt;big&nbsp;to&nbsp;store&nbsp;in&nbsp;nursery&nbsp;area),&nbsp;so&nbsp;nursery&nbsp;allocation&nbsp;and&nbsp;releasing&lt;br&gt;<br>
&amp;gt;might&nbsp;become&nbsp;faster&nbsp;than&nbsp;fixing&nbsp;string&nbsp;pointer&nbsp;which&nbsp;might&nbsp;slowdown&nbsp;GC.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;(That's&nbsp;why&nbsp;BenM&nbsp;asked&nbsp;Paolo,&nbsp;as&nbsp;only&nbsp;he&nbsp;would&nbsp;know&nbsp;the&nbsp;best&nbsp;answer&nbsp;;-)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Atsushi&nbsp;Eno&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Alan&nbsp;McGovern&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;To&nbsp;my&nbsp;understanding,&nbsp;fixed&nbsp;pointers&nbsp;do&nbsp;not&nbsp;participate&nbsp;GC&nbsp;target.&nbsp;And&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;-&nbsp;locally-allocated&nbsp;array&nbsp;anyways&nbsp;lives&nbsp;until&nbsp;its&nbsp;conversion&nbsp;finishes&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;(and&nbsp;probably&nbsp;immediately&nbsp;disposed&nbsp;depending&nbsp;on&nbsp;the&nbsp;JIT&nbsp;optimization)&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;-&nbsp;Usually&nbsp;this&nbsp;conversion&nbsp;do&nbsp;not&nbsp;take&nbsp;long&nbsp;time&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;So&nbsp;I&nbsp;guess&nbsp;fixed&nbsp;pointer&nbsp;would&nbsp;work&nbsp;better&nbsp;than&nbsp;possibly&nbsp;being&nbsp;moved&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;from&nbsp;nursery&nbsp;area.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;It's&nbsp;better&nbsp;to&nbsp;not&nbsp;allocate&nbsp;a&nbsp;new&nbsp;array&nbsp;if&nbsp;it&nbsp;can&nbsp;be&nbsp;avoided.&nbsp;From&nbsp;my&nbsp;own&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;code&nbsp;i&nbsp;found&nbsp;that&nbsp;in&nbsp;one&nbsp;of&nbsp;my&nbsp;intensively&nbsp;used&nbsp;methods&nbsp;i&nbsp;allocated&nbsp;a&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;100byte&nbsp;array&nbsp;each&nbsp;time&nbsp;the&nbsp;method&nbsp;was&nbsp;called.&nbsp;By&nbsp;moving&nbsp;that&nbsp;variable&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;outside&nbsp;the&nbsp;method&nbsp;and&nbsp;just&nbsp;reinitialising&nbsp;it&nbsp;each&nbsp;time&nbsp;i&nbsp;used&nbsp;it&nbsp;(with&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;appropriate&nbsp;locking)&nbsp;memory&nbsp;usage&nbsp;reduced&nbsp;by&nbsp;a&nbsp;large&nbsp;%.&nbsp;Don't&nbsp;rely&nbsp;on&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;the&nbsp;GC&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;to&nbsp;tidy&nbsp;up&nbsp;your&nbsp;mess&nbsp;if&nbsp;you&nbsp;can&nbsp;avoid&nbsp;creating&nbsp;it&nbsp;in&nbsp;the&nbsp;first&nbsp;place&nbsp;:p&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;------------------------------------------------------------------------&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;9&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;20:53:04&nbsp;-0400&lt;br&gt;<br>
&amp;gt;From:&nbsp;Miguel&nbsp;de&nbsp;Icaza&nbsp;&amp;lt;miguel@ximian.com&amp;gt;&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;Re:&nbsp;[Mono-dev]&nbsp;Managed&nbsp;DirectX&lt;br&gt;<br>
&amp;gt;To:&nbsp;Stefan&nbsp;D?singer&nbsp;&amp;lt;stefandoesinger@gmx.at&amp;gt;&lt;br&gt;<br>
&amp;gt;Cc:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;1161823984.5109.26.camel@erandi.dom&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Hello,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;I&nbsp;am&nbsp;one&nbsp;of&nbsp;the&nbsp;programmers&nbsp;of&nbsp;the&nbsp;Wine&nbsp;Direct3D&nbsp;implementation,&nbsp;and&nbsp;I&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;wondered&nbsp;if&nbsp;there&nbsp;are&nbsp;any&nbsp;plans&nbsp;to&nbsp;implement&nbsp;Managed&nbsp;DirectX&nbsp;in&nbsp;Mono,&nbsp;and&nbsp;if&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;it&nbsp;is&nbsp;possible&nbsp;to&nbsp;share&nbsp;efforts&nbsp;between&nbsp;wine&nbsp;and&nbsp;mono?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;This&nbsp;would&nbsp;be&nbsp;fantastic.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;This&nbsp;is&nbsp;basically&nbsp;what&nbsp;the&nbsp;wine&nbsp;direct3d&nbsp;code&nbsp;looks&nbsp;like:&nbsp;We&nbsp;have&nbsp;3&nbsp;libraries&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;for&nbsp;the&nbsp;various&nbsp;dx&nbsp;versions,&nbsp;ddraw.dll,&nbsp;d3d8.dll&nbsp;and&nbsp;d3d9.dll.&nbsp;Plans&nbsp;are&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;going&nbsp;on&nbsp;for&nbsp;a&nbsp;d3d10.dll.&nbsp;Those&nbsp;libraries&nbsp;offer&nbsp;a&nbsp;binary&nbsp;and&nbsp;source&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;compatible&nbsp;interface&nbsp;to&nbsp;Microsoft's&nbsp;Direct3D&nbsp;user&nbsp;mode&nbsp;interface.&nbsp;We&nbsp;do&nbsp;not&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;implement&nbsp;the&nbsp;kernel-side&nbsp;DDI&nbsp;or&nbsp;gdientry/ddentry&nbsp;interface&nbsp;and&nbsp;we&nbsp;do&nbsp;not&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;plan&nbsp;to&nbsp;do&nbsp;that.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Does&nbsp;the&nbsp;library&nbsp;depend&nbsp;on&nbsp;the&nbsp;rest&nbsp;of&nbsp;Wine&nbsp;to&nbsp;run?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Am&nbsp;curious&nbsp;if&nbsp;it&nbsp;is&nbsp;possible&nbsp;to&nbsp;write&nbsp;a&nbsp;C&nbsp;program&nbsp;that&nbsp;can&nbsp;just&nbsp;call&lt;br&gt;<br>
&amp;gt;into&nbsp;these&nbsp;libraries&nbsp;directly?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;I&nbsp;mention&nbsp;this&nbsp;because&nbsp;Mono&nbsp;would&nbsp;be&nbsp;accessing&nbsp;the&nbsp;libraries&nbsp;by&lt;br&gt;<br>
&amp;gt;dlopening&nbsp;them,&nbsp;looking&nbsp;up&nbsp;the&nbsp;addresses&nbsp;of&nbsp;methods&nbsp;with&nbsp;dlsym&nbsp;and&lt;br&gt;<br>
&amp;gt;calling&nbsp;them.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;And&nbsp;the&nbsp;question&nbsp;is&nbsp;whether&nbsp;this&nbsp;means&nbsp;that&nbsp;we&nbsp;need&nbsp;to&nbsp;run&nbsp;side-by-side&lt;br&gt;<br>
&amp;gt;with&nbsp;the&nbsp;Wine&nbsp;runtime,&nbsp;as&nbsp;that&nbsp;is&nbsp;currently&nbsp;not&nbsp;possible&nbsp;with&nbsp;Mono.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Miguel.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Message:&nbsp;10&lt;br&gt;<br>
&amp;gt;Date:&nbsp;Wed,&nbsp;25&nbsp;Oct&nbsp;2006&nbsp;20:22:32&nbsp;-0700&lt;br&gt;<br>
&amp;gt;From:&nbsp;allan@counterpop.net&nbsp;(Allan&nbsp;Hsu)&lt;br&gt;<br>
&amp;gt;Subject:&nbsp;[Mono-dev]&nbsp;[PATCH]&nbsp;OS&nbsp;X&nbsp;MACHINE_THREAD_STATE&nbsp;patch&nbsp;for&nbsp;newer&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp10.4u&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspSDK&lt;br&gt;<br>
&amp;gt;To:&nbsp;mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;Message-ID:&nbsp;&amp;lt;20061026032232.GA14592@daybreaker.counterpop.net&amp;gt;&lt;br&gt;<br>
&amp;gt;Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;us-ascii&quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;This&nbsp;patch&nbsp;fixes&nbsp;problems&nbsp;with&nbsp;building&nbsp;mono&nbsp;for&nbsp;i386&nbsp;using&nbsp;the&nbsp;new&lt;br&gt;<br>
&amp;gt;10.4u&nbsp;SDK&nbsp;that&nbsp;ships&nbsp;with&nbsp;Xcode&nbsp;2.4.&nbsp;Current&nbsp;SVN&nbsp;builds&nbsp;for&nbsp;i386&nbsp;under&lt;br&gt;<br>
&amp;gt;the&nbsp;new&nbsp;SDK,&nbsp;but&nbsp;does&nbsp;not&nbsp;run&nbsp;properly&nbsp;due&nbsp;to&nbsp;changes&nbsp;in&lt;br&gt;<br>
&amp;gt;MACHINE_THREAD_STATE.&nbsp;It&nbsp;looks&nbsp;like&nbsp;the&nbsp;breakage&nbsp;in&nbsp;source&nbsp;compatibility&lt;br&gt;<br>
&amp;gt;is&nbsp;intentional&nbsp;on&nbsp;Apple's&nbsp;part&nbsp;and&nbsp;future&nbsp;headers&nbsp;will&nbsp;be&nbsp;similarly&lt;br&gt;<br>
&amp;gt;broken.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;I&nbsp;will&nbsp;be&nbsp;submitting&nbsp;the&nbsp;same&nbsp;patch&nbsp;to&nbsp;libgc&nbsp;upstream.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp-Allan&lt;br&gt;<br>
&amp;gt;--&nbsp;&lt;br&gt;<br>
&amp;gt;Allan&nbsp;Hsu&nbsp;&amp;lt;allan&nbsp;at&nbsp;counterpop&nbsp;dot&nbsp;net&amp;gt;&lt;br&gt;<br>
&amp;gt;1E64&nbsp;E20F&nbsp;34D9&nbsp;CBA7&nbsp;1300&nbsp;1457&nbsp;AC37&nbsp;CBBB&nbsp;0E92&nbsp;C779&lt;br&gt;<br>
&amp;gt;--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
&amp;gt;Index:&nbsp;libgc/darwin_stop_world.c&lt;br&gt;<br>
&amp;gt;===================================================================&lt;br&gt;<br>
&amp;gt;---&nbsp;libgc/darwin_stop_world.c&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp(revision&nbsp;66738)&lt;br&gt;<br>
&amp;gt;+++&nbsp;libgc/darwin_stop_world.c&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp(working&nbsp;copy)&lt;br&gt;<br>
&amp;gt;@@&nbsp;-75,12&nbsp;+75,14&nbsp;@@&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;ptr_t&nbsp;lo,&nbsp;hi;&lt;br&gt;<br>
&amp;gt;&nbsp;#if&nbsp;defined(POWERPC)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;ppc_thread_state_t&nbsp;state;&lt;br&gt;<br>
&amp;gt;+&nbsp;&nbsp;mach_msg_type_number_t&nbsp;thread_state_count&nbsp;=&nbsp;PPC_THREAD_STATE_COUNT;&lt;br&gt;<br>
&amp;gt;&nbsp;#elif&nbsp;defined(I386)&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;i386_thread_state_t&nbsp;state;&lt;br&gt;<br>
&amp;gt;+&nbsp;&nbsp;mach_msg_type_number_t&nbsp;thread_state_count&nbsp;=&nbsp;i386_THREAD_STATE_COUNT;&lt;br&gt;<br>
&amp;gt;&nbsp;#else&lt;br&gt;<br>
&amp;gt;&nbsp;#&nbsp;error&nbsp;FIXME&nbsp;for&nbsp;non-x86&nbsp;||&nbsp;ppc&nbsp;architectures&lt;br&gt;<br>
&amp;gt;+&nbsp;&nbsp;mach_msg_type_number_t&nbsp;thread_state_count&nbsp;=&nbsp;MACHINE_THREAD_STATE_COUNT;&lt;br&gt;<br>
&amp;gt;&nbsp;#endif&lt;br&gt;<br>
&amp;gt;-&nbsp;&nbsp;mach_msg_type_number_t&nbsp;thread_state_count&nbsp;=&nbsp;MACHINE_THREAD_STATE_COUNT;&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;me&nbsp;=&nbsp;pthread_self();&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;if&nbsp;(!GC_thr_initialized)&nbsp;GC_thr_init();&lt;br&gt;<br>
&amp;gt;@@&nbsp;-94,7&nbsp;+96,7&nbsp;@@&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp/*&nbsp;Get&nbsp;the&nbsp;thread&nbsp;state&nbsp;(registers,&nbsp;etc)&nbsp;*/&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspr&nbsp;=&nbsp;thread_get_state(&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p-&amp;gt;stop_info.mach_thread,&lt;br&gt;<br>
&amp;gt;-&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACHINE_THREAD_STATE,&lt;br&gt;<br>
&amp;gt;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GC_MACH_THREAD_STATE_FLAVOR,&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(natural_t*)&amp;amp;state,&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;thread_state_count);&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif(r&nbsp;!=&nbsp;KERN_SUCCESS)&nbsp;ABORT(&quot;thread_get_state&nbsp;failed&quot;);&lt;br&gt;<br>
&amp;gt;@@&nbsp;-193,7&nbsp;+195,7&nbsp;@@&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspppc_thread_state64_t&nbsp;info;&lt;br&gt;<br>
&amp;gt;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmach_msg_type_number_t&nbsp;outCount&nbsp;=&nbsp;THREAD_STATE_MAX;&lt;br&gt;<br>
&amp;gt;-&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspr&nbsp;=&nbsp;thread_get_state(thread,&nbsp;MACHINE_THREAD_STATE,&lt;br&gt;<br>
&amp;gt;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspr&nbsp;=&nbsp;thread_get_state(thread,&nbsp;GC_MACH_THREAD_STATE_FLAVOR,&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(natural_t&nbsp;*)&amp;amp;info,&nbsp;&amp;amp;outCount);&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif(r&nbsp;!=&nbsp;KERN_SUCCESS)&nbsp;continue;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;@@&nbsp;-236,7&nbsp;+238,7&nbsp;@@&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspWARN(&quot;This&nbsp;is&nbsp;completely&nbsp;untested&nbsp;and&nbsp;likely&nbsp;will&nbsp;not&nbsp;work\n&quot;,&nbsp;0);&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspi386_thread_state_t&nbsp;info;&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmach_msg_type_number_t&nbsp;outCount&nbsp;=&nbsp;THREAD_STATE_MAX;&lt;br&gt;<br>
&amp;gt;-&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspr&nbsp;=&nbsp;thread_get_state(thread,&nbsp;MACHINE_THREAD_STATE,&lt;br&gt;<br>
&amp;gt;+&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspr&nbsp;=&nbsp;thread_get_state(thread,&nbsp;GC_MACH_THREAD_STATE_FLAVOR,&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(natural_t&nbsp;*)&amp;amp;info,&nbsp;&amp;amp;outCount);&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif(r&nbsp;!=&nbsp;KERN_SUCCESS)&nbsp;continue;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;Index:&nbsp;libgc/include/private/gc_priv.h&lt;br&gt;<br>
&amp;gt;===================================================================&lt;br&gt;<br>
&amp;gt;---&nbsp;libgc/include/private/gc_priv.h&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp(revision&nbsp;66738)&lt;br&gt;<br>
&amp;gt;+++&nbsp;libgc/include/private/gc_priv.h&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp(working&nbsp;copy)&lt;br&gt;<br>
&amp;gt;@@&nbsp;-366,6&nbsp;+366,16&nbsp;@@&lt;br&gt;<br>
&amp;gt;&nbsp;#&nbsp;&nbsp;&nbsp;define&nbsp;BZERO(x,n)&nbsp;bzero((char&nbsp;*)(x),(int)(n))&lt;br&gt;<br>
&amp;gt;&nbsp;#&nbsp;endif&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;+#if&nbsp;defined(DARWIN)&lt;br&gt;<br>
&amp;gt;+#&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif&nbsp;defined(POWERPC)&lt;br&gt;<br>
&amp;gt;+#&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspdefine&nbsp;GC_MACH_THREAD_STATE_FLAVOR&nbsp;PPC_THREAD_STATE&lt;br&gt;<br>
&amp;gt;+#&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspelif&nbsp;defined(I386)&lt;br&gt;<br>
&amp;gt;+#&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspdefine&nbsp;GC_MACH_THREAD_STATE_FLAVOR&nbsp;i386_THREAD_STATE&lt;br&gt;<br>
&amp;gt;+#&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspelse&lt;br&gt;<br>
&amp;gt;+#&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspdefine&nbsp;GC_MACH_THREAD_STATE_FLAVOR&nbsp;MACHINE_THREAD_STATE&lt;br&gt;<br>
&amp;gt;+#&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspendif&lt;br&gt;<br>
&amp;gt;+#endif&lt;br&gt;<br>
&amp;gt;+&lt;br&gt;<br>
&amp;gt;&nbsp;/*&nbsp;Delay&nbsp;any&nbsp;interrupts&nbsp;or&nbsp;signals&nbsp;that&nbsp;may&nbsp;abort&nbsp;this&nbsp;thread.&nbsp;&nbsp;Data&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp*/&lt;br&gt;<br>
&amp;gt;&nbsp;/*&nbsp;structures&nbsp;are&nbsp;in&nbsp;a&nbsp;consistent&nbsp;state&nbsp;outside&nbsp;this&nbsp;pair&nbsp;of&nbsp;calls.&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp*/&lt;br&gt;<br>
&amp;gt;&nbsp;/*&nbsp;ANSI&nbsp;C&nbsp;allows&nbsp;both&nbsp;to&nbsp;be&nbsp;empty&nbsp;(though&nbsp;the&nbsp;standard&nbsp;isn't&nbsp;very&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp*/&lt;br&gt;<br>
&amp;gt;Index:&nbsp;libgc/os_dep.c&lt;br&gt;<br>
&amp;gt;===================================================================&lt;br&gt;<br>
&amp;gt;---&nbsp;libgc/os_dep.c&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp(revision&nbsp;66738)&lt;br&gt;<br>
&amp;gt;+++&nbsp;libgc/os_dep.c&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp(working&nbsp;copy)&lt;br&gt;<br>
&amp;gt;@@&nbsp;-3702,7&nbsp;+3702,7&nbsp;@@&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask,&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GC_ports.exception,&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTION_DEFAULT,&lt;br&gt;<br>
&amp;gt;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACHINE_THREAD_STATE&lt;br&gt;<br>
&amp;gt;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GC_MACH_THREAD_STATE_FLAVOR&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(r&nbsp;!=&nbsp;KERN_SUCCESS)&nbsp;ABORT(&quot;task_set_exception_ports&nbsp;failed&quot;);&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;------------------------------&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;_______________________________________________&lt;br&gt;<br>
&amp;gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;Mono-devel-list@lists.ximian.com&lt;br&gt;<br>
&amp;gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;End&nbsp;of&nbsp;Mono-devel-list&nbsp;Digest,&nbsp;Vol&nbsp;18,&nbsp;Issue&nbsp;62&lt;br&gt;<br>
&amp;gt;***********************************************&lt;br&gt;<br>
&amp;gt;&lt;/html&gt;<br>

</tt>
