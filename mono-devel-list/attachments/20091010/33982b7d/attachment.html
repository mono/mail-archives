<tt>
&lt;div&gt;I&nbsp;have&nbsp;trouble&nbsp;running&nbsp;my&nbsp;application&nbsp;under&nbsp;mono&nbsp;on&nbsp;Windows&nbsp;(using&nbsp;the&nbsp;head&nbsp;of&nbsp;trunk).&nbsp;The&nbsp;following&nbsp;assert&nbsp;triggers&nbsp;at&nbsp;startup:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;   &nbsp;*&nbsp;Assertion&nbsp;at&nbsp;..\mono\metadata\cominterop.c:356,&nbsp;condition&nbsp;`ic&amp;#39;&nbsp;not&nbsp;met&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;This&nbsp;happens&nbsp;because&nbsp;the&nbsp;slot&nbsp;for&nbsp;the&nbsp;TestMethod&nbsp;method&nbsp;(method-&amp;gt;slot==7)&nbsp;passed&nbsp;in&nbsp;argument&nbsp;to&nbsp;the&nbsp;cominterop_get_method_interface&nbsp;function&nbsp;is&nbsp;not&nbsp;available&nbsp;in&nbsp;the&nbsp;packed&nbsp;interface&nbsp;table:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Packed&nbsp;interface&nbsp;table&nbsp;for&nbsp;class&nbsp;TestClass&nbsp;has&nbsp;size&nbsp;2&lt;br&gt; &nbsp;[000][UUID&nbsp;089][SLOT&nbsp;006][SIZE &nbsp;001]&nbsp;interface&nbsp;COMExampleLib.ITest&lt;br&gt; &nbsp;[001][UUID&nbsp;090][SLOT&nbsp;007][SIZE &nbsp;000]&nbsp;interface&nbsp;COMExampleLib.Test&lt;/div&gt;<br>
&lt;div&gt;[LEVEL&nbsp;0]&nbsp;Implemented&nbsp;interfaces&nbsp;by&nbsp;class&nbsp;TestClass:&lt;br&gt; &nbsp;[UIID&nbsp;89]&nbsp;interface&nbsp;ITest&lt;br&gt; &nbsp;[000][UUID&nbsp;089][SLOT&nbsp;006][SIZE &nbsp;001]&nbsp;interface&nbsp;COMExampleLib.ITest&lt;br&gt; &nbsp;[UIID&nbsp;90]&nbsp;interface&nbsp;Test&lt;br&gt; &nbsp;[001][UUID&nbsp;090][SLOT&nbsp;007][SIZE &nbsp;000]&nbsp;interface&nbsp;COMExampleLib.Test&lt;br&gt;<br>
 &nbsp;[UIID&nbsp;89]&nbsp;interface&nbsp;ITest&lt;br&gt; &nbsp;[002][UUID&nbsp;089][SLOT&nbsp;006][SIZE &nbsp;001]&nbsp;interface&nbsp;COMExampleLib.ITest&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;I&nbsp;also&nbsp;attach&nbsp;the&nbsp;relevant&nbsp;section&nbsp;of&nbsp;the&nbsp;trace&nbsp;obtained&nbsp;by&nbsp;turning&nbsp;on&nbsp;DEBUG_INTERFACE_VTABLE_CODE/TRACE_INTERFACE_VTABLE_CODE/VERIFY_INTERFACE_VTABLE_CODE&nbsp;in&nbsp;class.c&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Now&nbsp;if&nbsp;I&nbsp;comment&nbsp;out&nbsp;the&nbsp;two&nbsp;lines&nbsp;added&nbsp;in&nbsp;revision&nbsp;141535:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;---&nbsp;class.c    &nbsp;(revision&nbsp;143891)&lt;br&gt;+++&nbsp;class.c    &nbsp;(working&nbsp;copy)&lt;br&gt;-              &nbsp;if&nbsp;((cm-&amp;gt;flags&nbsp;&amp;amp;&nbsp;METHOD_ATTRIBUTE_NEW_SLOT)&nbsp;&amp;amp;&amp;amp;&nbsp;!(cm-&amp;gt;flags&nbsp;&amp;amp;&nbsp;METHOD_ATTRIBUTE_FINAL)&nbsp;&amp;amp;&amp;amp;&nbsp;cm-&amp;gt;slot&nbsp;&amp;gt;=&nbsp;0)&lt;br&gt;<br>
-                      &nbsp;cm-&amp;gt;slot&nbsp;=&nbsp;-1;&lt;br&gt;+              &nbsp;//if&nbsp;((cm-&amp;gt;flags&nbsp;&amp;amp;&nbsp;METHOD_ATTRIBUTE_NEW_SLOT)&nbsp;&amp;amp;&amp;amp;&nbsp;!(cm-&amp;gt;flags&nbsp;&amp;amp;&nbsp;METHOD_ATTRIBUTE_FINAL)&nbsp;&amp;amp;&amp;amp;&nbsp;cm-&amp;gt;slot&nbsp;&amp;gt;=&nbsp;0)&lt;br&gt;+              &nbsp;//     &nbsp;cm-&amp;gt;slot&nbsp;=&nbsp;-1;&lt;/div&gt;<br>
<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;the&nbsp;slot&nbsp;for&nbsp;the&nbsp;TestMethod&nbsp;method&nbsp;becomes&nbsp;6&nbsp;and&nbsp;the&nbsp;cominterop_get_method_interface&nbsp;function&nbsp;works&nbsp;fine&nbsp;without&nbsp;asseting.&nbsp;My&nbsp;application&nbsp;also&nbsp;works&nbsp;with&nbsp;no&nbsp;issue.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Any&nbsp;idea?&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks!&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Sylvain&lt;/div&gt;<br>

</tt>
