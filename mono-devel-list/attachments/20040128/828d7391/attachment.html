<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=Content-Type&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;meta&nbsp;name=Generator&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;11&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;style&gt;<br>
&lt;!--<br>
&nbsp;/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
&nbsp;@font-face<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{font-family:Wingdings;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppanose-1:5&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0;}<br>
&nbsp;/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
&nbsp;p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{margin:0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-bottom:.0001pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-size:12.0pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Times&nbsp;New&nbsp;Roman&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{color:blue;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{color:purple;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-decoration:underline;}<br>
span.EmailStyle17<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-type:personal-compose;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:Arial;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:windowtext;}<br>
@page&nbsp;Section1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{size:8.5in&nbsp;11.0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin:1.0in&nbsp;1.25in&nbsp;1.0in&nbsp;1.25in;}<br>
div.Section1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{page:Section1;}<br>
&nbsp;/*&nbsp;List&nbsp;Definitions&nbsp;*/<br>
&nbsp;@list&nbsp;l0<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-list-id:512913625;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-type:hybrid;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-template-ids:279237692&nbsp;-624766136&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693;}<br>
@list&nbsp;l0:level1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-level-number-format:bullet;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-text:\F0B7;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-tab-stop:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-number-position:left;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-left:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-indent:-.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:Symbol;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:windowtext;}<br>
@list&nbsp;l1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-list-id:1069960805;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-type:hybrid;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-template-ids:1656798578&nbsp;-624766136&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693;}<br>
@list&nbsp;l1:level1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-level-number-format:bullet;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-text:\F0B7;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-tab-stop:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-number-position:left;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-left:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-indent:-.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:Symbol;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:windowtext;}<br>
@list&nbsp;l2<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-list-id:1250699424;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-type:hybrid;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-template-ids:2052195486&nbsp;-624766136&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693;}<br>
@list&nbsp;l2:level1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-level-number-format:bullet;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-text:\F0B7;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-tab-stop:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-number-position:left;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-left:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-indent:-.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:Symbol;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:windowtext;}<br>
@list&nbsp;l3<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-list-id:1825050908;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-type:hybrid;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-list-template-ids:1031317460&nbsp;-624766136&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693&nbsp;67698689&nbsp;67698691&nbsp;67698693;}<br>
@list&nbsp;l3:level1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-level-number-format:bullet;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-text:\F0B7;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-tab-stop:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-level-number-position:left;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-left:.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-indent:-.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:Symbol;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:windowtext;}<br>
ol<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{margin-bottom:0in;}<br>
ul<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{margin-bottom:0in;}<br>
--&gt;<br>
&lt;/style&gt;<br>
&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&nbsp;&lt;o:shapedefaults&nbsp;v:ext=&quot;edit&quot;&nbsp;spidmax=&quot;1026&quot;&nbsp;/&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&nbsp;&lt;o:shapelayout&nbsp;v:ext=&quot;edit&quot;&gt;<br>
&nbsp;&nbsp;&lt;o:idmap&nbsp;v:ext=&quot;edit&quot;&nbsp;data=&quot;1&quot;&nbsp;/&gt;<br>
&nbsp;&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;<br>
&lt;/head&gt;<br>
<br>
&lt;body&nbsp;lang=EN-US&nbsp;link=blue&nbsp;vlink=purple&gt;<br>
<br>
&lt;div&nbsp;class=Section1&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;Apologies&nbsp;for&nbsp;the&nbsp;wordy&nbsp;email,&nbsp;but&nbsp;Paolo&nbsp;asked&nbsp;for&nbsp;an<br>
update&nbsp;earlier.&amp;nbsp;&nbsp;The&nbsp;text&nbsp;below&nbsp;explains&nbsp;how&nbsp;I&nbsp;understand&nbsp;the&nbsp;problem&nbsp;and<br>
the&nbsp;decisions&nbsp;that&nbsp;I&nbsp;think&nbsp;need&nbsp;to&nbsp;be&nbsp;made.&amp;nbsp;&nbsp;Any&nbsp;feedback&nbsp;would&nbsp;be&nbsp;very,<br>
very&nbsp;much&nbsp;appreciated.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;So&nbsp;far:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;I&nbsp;have&nbsp;decided&nbsp;to&nbsp;cut&nbsp;the&nbsp;problem&nbsp;down&nbsp;for&nbsp;the<br>
purposes&nbsp;of&nbsp;my&nbsp;thesis&nbsp;to&nbsp;the&nbsp;following&nbsp;5&nbsp;items,&nbsp;representing&nbsp;the&nbsp;core&nbsp;of<br>
CAS.&amp;nbsp;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l1&nbsp;level1&nbsp;lfo3'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;A&nbsp;basic&nbsp;caspol.exe.&amp;nbsp;<br>
This&nbsp;writes&nbsp;out&nbsp;a&nbsp;default&nbsp;security&nbsp;policy,&nbsp;and&nbsp;allows&nbsp;the&nbsp;user&nbsp;to&nbsp;add&nbsp;or&nbsp;remove<br>
permissions&nbsp;to&nbsp;a&nbsp;given&nbsp;code&nbsp;group.&amp;nbsp;&nbsp;It&amp;#8217;s&nbsp;not&nbsp;going&nbsp;to&nbsp;be&nbsp;fully<br>
complete,&nbsp;but&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;C#&nbsp;so&nbsp;it&amp;#8217;s&nbsp;completely&nbsp;extensible.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l1&nbsp;level1&nbsp;lfo3'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Runtime&nbsp;loading&nbsp;of<br>
security&nbsp;policy&nbsp;and&nbsp;calculation&nbsp;of&nbsp;final&nbsp;policy&nbsp;taking&nbsp;into&nbsp;account&nbsp;the&nbsp;policy<br>
levels.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l1&nbsp;level1&nbsp;lfo3'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Calculating&nbsp;final&nbsp;grants<br>
to&nbsp;assemblies&nbsp;based&nbsp;on&nbsp;local&nbsp;policy&nbsp;and&nbsp;evidence,&nbsp;and&nbsp;assigning&nbsp;these&nbsp;grants&nbsp;to<br>
the&nbsp;assembly&nbsp;objects&nbsp;as&nbsp;XML.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l1&nbsp;level1&nbsp;lfo3'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;CodeAccessPermission.Demand(),<br>
CodeAccessPermission.Deny()&nbsp;and&nbsp;CodeAccessPermission.Assert().&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l1&nbsp;level1&nbsp;lfo3'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Declarative&nbsp;RequestMinimum,<br>
RequestOptional&nbsp;etc.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;I&nbsp;will&nbsp;add&nbsp;more&nbsp;as&nbsp;time&nbsp;allows,&nbsp;and&nbsp;may&nbsp;carry&nbsp;on<br>
working&nbsp;on&nbsp;this&nbsp;after&nbsp;my&nbsp;deadline.&amp;nbsp;&nbsp;Either&nbsp;way&nbsp;I&nbsp;hope&nbsp;to&nbsp;leave&nbsp;something<br>
useful,&nbsp;along&nbsp;with&nbsp;some&nbsp;useful&nbsp;documentation&nbsp;so&nbsp;that&nbsp;someone&nbsp;else&nbsp;can&nbsp;continue<br>
my&nbsp;work.&amp;nbsp;&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;my&nbsp;thesis&nbsp;though&nbsp;(which&nbsp;has&nbsp;to&nbsp;be&nbsp;finished<br>
in&nbsp;2&nbsp;months!)&nbsp;it&amp;#8217;s&nbsp;important&nbsp;that&nbsp;I&nbsp;have&nbsp;a&nbsp;useful&nbsp;subset&nbsp;which&nbsp;is&nbsp;achievable.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;Something&nbsp;I&nbsp;won&amp;#8217;t&nbsp;be&nbsp;attempting&nbsp;as&nbsp;part&nbsp;of&nbsp;this<br>
project:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo4'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Declarative&nbsp;security<br>
demands.&amp;nbsp;&nbsp;They&nbsp;are&nbsp;going&nbsp;to&nbsp;involve&nbsp;hacking&nbsp;the&nbsp;JIT,&nbsp;albeit&nbsp;in&nbsp;a&nbsp;simple<br>
way&nbsp;as&nbsp;described&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;[4].&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;Plan:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;Essentially,&nbsp;here&nbsp;is&nbsp;what&nbsp;I&nbsp;think&nbsp;has&nbsp;to<br>
happen.&amp;nbsp;&nbsp;The&nbsp;decisions&nbsp;have&nbsp;quite&nbsp;a&nbsp;bit&nbsp;of&nbsp;consequence,&nbsp;and&nbsp;even&nbsp;if&nbsp;I&nbsp;don&amp;#8217;t<br>
end&nbsp;up&nbsp;completing&nbsp;this&nbsp;it&nbsp;would&nbsp;be&nbsp;nice&nbsp;if&nbsp;they&nbsp;were&nbsp;made&nbsp;in&nbsp;the&nbsp;best&nbsp;way&nbsp;early<br>
on&nbsp;so&nbsp;I&nbsp;at&nbsp;least&nbsp;offer&nbsp;a&nbsp;good&nbsp;base&nbsp;for&nbsp;someone&nbsp;to&nbsp;continue&nbsp;the&nbsp;work.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;There&nbsp;are&nbsp;three&nbsp;security<br>
policy&nbsp;levels&nbsp;&amp;#8211;&nbsp;enterprise,&nbsp;machine&nbsp;and&nbsp;user.&amp;nbsp;&nbsp;Policies&nbsp;set&nbsp;across<br>
the&nbsp;enterprise&nbsp;supersede&nbsp;those&nbsp;for&nbsp;the&nbsp;machine&nbsp;and&nbsp;user.&amp;nbsp;&nbsp;Each&nbsp;level&nbsp;has<br>
an&nbsp;XML&nbsp;.config&nbsp;file&nbsp;associated&nbsp;with&nbsp;it&nbsp;[1]&nbsp;that&nbsp;describes&nbsp;local&nbsp;policy.&amp;nbsp;&nbsp;Caspol<br>
and&nbsp;the&nbsp;management&nbsp;console&nbsp;provide&nbsp;a&nbsp;nice&nbsp;way&nbsp;of&nbsp;manipulating&nbsp;these&nbsp;files.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;At&nbsp;the&nbsp;runtime&nbsp;start,<br>
there&nbsp;is&nbsp;a&nbsp;check&nbsp;to&nbsp;see&nbsp;if&nbsp;CAS&nbsp;is&nbsp;off,&nbsp;or&nbsp;if&nbsp;full&nbsp;trust&nbsp;is&nbsp;assigned.&amp;nbsp;&nbsp;If<br>
either&nbsp;of&nbsp;those&nbsp;is&nbsp;true&nbsp;then&nbsp;we&nbsp;need&nbsp;to&nbsp;toggle&nbsp;CAS&nbsp;off&nbsp;to&nbsp;prevent&nbsp;any&nbsp;overhead.&amp;nbsp;<br>
In&nbsp;any&nbsp;other&nbsp;situation&nbsp;the&nbsp;configuration&nbsp;files&nbsp;have&nbsp;to&nbsp;be&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;*somewhere*<br>
in&nbsp;the&nbsp;runtime.&amp;nbsp;&nbsp;There&nbsp;are&nbsp;managed&nbsp;classes&nbsp;representing&nbsp;code&nbsp;groups&nbsp;and<br>
permission&nbsp;sets,&nbsp;but&nbsp;I&amp;#8217;m&nbsp;not&nbsp;sure&nbsp;if&nbsp;the&nbsp;intention&nbsp;is&nbsp;to&nbsp;make&nbsp;use&nbsp;of<br>
these&nbsp;to&nbsp;reflect&nbsp;what&nbsp;was&nbsp;in&nbsp;the&nbsp;config&nbsp;files,&nbsp;or&nbsp;if&nbsp;we&nbsp;should&nbsp;store&nbsp;some<br>
representation&nbsp;of&nbsp;this&nbsp;in&nbsp;the&nbsp;C.&amp;nbsp;&nbsp;(One&nbsp;point&nbsp;of&nbsp;confusion&nbsp;&amp;#8211;&nbsp;does&nbsp;this<br>
occur&nbsp;at&nbsp;startup,&nbsp;or&nbsp;do&nbsp;we&nbsp;call&nbsp;into&nbsp;SecurityManager.ResolvePolicy()&nbsp;which&nbsp;can<br>
call&nbsp;LoadPolicyFromFile()&nbsp;&amp;#8211;&nbsp;The&nbsp;guys&nbsp;who&nbsp;wrote&nbsp;PolicyLevel.cs&nbsp;may&nbsp;be&nbsp;able<br>
to&nbsp;help&nbsp;here.)&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;So,&nbsp;at&nbsp;this&nbsp;point&nbsp;the&nbsp;runtime&nbsp;knows&nbsp;all&nbsp;about&nbsp;local<br>
policy.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Assemblies&nbsp;have&nbsp;evidence&nbsp;[0]<br>
attached&nbsp;to&nbsp;them.&amp;nbsp;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;The&nbsp;goal&nbsp;of&nbsp;CAS&nbsp;is&nbsp;to&nbsp;use<br>
evidence&nbsp;to&nbsp;determine&nbsp;if&nbsp;any&nbsp;membership&nbsp;conditions&nbsp;are&nbsp;met.&amp;nbsp;&nbsp;If&nbsp;any&nbsp;are&nbsp;met,<br>
then&nbsp;the&nbsp;assembly&nbsp;will&nbsp;be&nbsp;added&nbsp;to&nbsp;a&nbsp;specific&nbsp;code&nbsp;group.&amp;nbsp;&nbsp;If&nbsp;none&nbsp;are&nbsp;met<br>
then&nbsp;they&nbsp;fall&nbsp;into&nbsp;a&nbsp;default&nbsp;code&nbsp;group.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Associated&nbsp;with&nbsp;each&nbsp;code<br>
group&nbsp;is&nbsp;a&nbsp;permission&nbsp;set.&amp;nbsp;&nbsp;An&nbsp;example&nbsp;of&nbsp;this&nbsp;might&nbsp;be&nbsp;code&nbsp;that&nbsp;has&nbsp;been<br>
Microsoft&nbsp;Strong&nbsp;Named&nbsp;meeting&nbsp;the&nbsp;Strong&nbsp;Name&nbsp;membership&nbsp;condition,&nbsp;being<br>
assigned&nbsp;to&nbsp;the&nbsp;Strong&nbsp;Name&nbsp;group&nbsp;which&nbsp;has&nbsp;associated&nbsp;with&nbsp;it&nbsp;a&nbsp;very&nbsp;flexible<br>
set&nbsp;of&nbsp;permissions.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;An&nbsp;assembly&nbsp;can&nbsp;also&nbsp;request<br>
or&nbsp;deny&nbsp;certain&nbsp;permissions&nbsp;declaratively.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;The&nbsp;logic&nbsp;for&nbsp;calculating<br>
the&nbsp;final&nbsp;grant&nbsp;set&nbsp;from&nbsp;the&nbsp;requests,&nbsp;denials,&nbsp;and&nbsp;evidence&nbsp;all&nbsp;seem&nbsp;to&nbsp;be&nbsp;encapsulated<br>
in&nbsp;the&nbsp;SecurityManager.ResolvePolicy()&nbsp;method&nbsp;[3].&amp;nbsp;&nbsp;I&nbsp;think&nbsp;this&nbsp;needs&nbsp;to<br>
be&nbsp;called&nbsp;indirectly&nbsp;at&nbsp;assembly&nbsp;load&nbsp;time.&amp;nbsp;&nbsp;This&nbsp;method&nbsp;returns&nbsp;a&nbsp;final<br>
grant&nbsp;set.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l3&nbsp;level1&nbsp;lfo1'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;The&nbsp;final&nbsp;grant&nbsp;set&nbsp;can<br>
be&nbsp;extracted&nbsp;as&nbsp;XML&nbsp;[2],&nbsp;and&nbsp;stored&nbsp;with&nbsp;the&nbsp;assembly.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;At&nbsp;this&nbsp;point&nbsp;each&nbsp;assembly&nbsp;knows&nbsp;it&amp;#8217;s&nbsp;grant<br>
set.&amp;nbsp;&nbsp;At&nbsp;this&nbsp;point&nbsp;we&nbsp;can&nbsp;actually&nbsp;start&nbsp;to&nbsp;use&nbsp;CAS.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l2&nbsp;level1&nbsp;lfo2'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Developers&nbsp;can&nbsp;demand<br>
permissions.&amp;nbsp;&nbsp;This&nbsp;triggers&nbsp;a&nbsp;stack&nbsp;walk.&amp;nbsp;&nbsp;For&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;stack<br>
we&nbsp;get&nbsp;the&nbsp;assembly,&nbsp;get&nbsp;its&nbsp;associated&nbsp;permission&nbsp;set&nbsp;as&nbsp;XML,&nbsp;and&nbsp;recreate&nbsp;the<br>
permission&nbsp;set.&amp;nbsp;&nbsp;We&nbsp;then&nbsp;ask&nbsp;if&nbsp;the&nbsp;demanded&nbsp;permission&nbsp;is&nbsp;a&nbsp;subset&nbsp;of&nbsp;the<br>
associated&nbsp;permission&nbsp;set.&amp;nbsp;&nbsp;For&nbsp;all&nbsp;items&nbsp;in&nbsp;the&nbsp;stack&nbsp;this&nbsp;has&nbsp;to&nbsp;be<br>
true,&nbsp;else&nbsp;a&nbsp;SecurityException&nbsp;is&nbsp;thrown.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l2&nbsp;level1&nbsp;lfo2'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;LinkDemands&nbsp;are&nbsp;similar&nbsp;&amp;#8211;<br>
we&nbsp;just&nbsp;only&nbsp;walk&nbsp;one&nbsp;step&nbsp;of&nbsp;the&nbsp;stack.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l2&nbsp;level1&nbsp;lfo2'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;I&amp;#8217;m&nbsp;not&nbsp;sure&nbsp;how&nbsp;to<br>
handle&nbsp;Deny()&amp;#8217;s&nbsp;and&nbsp;Assertions&nbsp;at&nbsp;the&nbsp;moment.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='margin-left:.25in;text-indent:-.25in;mso-list:l2&nbsp;level1&nbsp;lfo2'&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;font<br>
size=2&nbsp;face=Symbol&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Symbol'&gt;&lt;span<br>
style='mso-list:Ignore'&gt;&amp;middot;&lt;font&nbsp;size=1&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&gt;&lt;span<br>
style='font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;![endif]&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span<br>
lang=EN-GB&nbsp;style='font-size:10.0pt;font-family:Arial'&gt;Class&nbsp;libraries&nbsp;need&nbsp;to&nbsp;have<br>
Demands()&nbsp;placed&nbsp;throughout.&amp;nbsp;&nbsp;Unfortunately&nbsp;Microsoft&nbsp;seem&nbsp;to&nbsp;use<br>
imperative&nbsp;demands&nbsp;&amp;#8211;&nbsp;I&nbsp;tried&nbsp;to&nbsp;use&nbsp;reflection&nbsp;to&nbsp;look&nbsp;for&nbsp;security<br>
attributes,&nbsp;but&nbsp;none&nbsp;are&nbsp;listed.&amp;nbsp;&nbsp;This&nbsp;means&nbsp;that&nbsp;we&nbsp;can&amp;#8217;t&nbsp;automate&nbsp;this<br>
process&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;Most&nbsp;of&nbsp;this&nbsp;last&nbsp;part&nbsp;is&nbsp;completed.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;Thanks&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;Ben&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;[0]&nbsp;&lt;a<br>
href=&quot;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconsecuritypolicyadministrationoverview.asp&quot;&gt;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconsecuritypolicyadministrationoverview.asp&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;[1]&nbsp;&lt;a<br>
href=&quot;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconsecurityconfigurationfiles.asp&quot;&gt;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconsecurityconfigurationfiles.asp&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;[2]&nbsp;&lt;a<br>
href=&quot;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemSecurityPermissionSetClassToXmlTopic.asp&quot;&gt;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemSecurityPermissionSetClassToXmlTopic.asp&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;[3]&nbsp;&lt;a<br>
href=&quot;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritysecuritymanagerclassresolvepolicytopic2.asp&quot;&gt;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritysecuritymanagerclassresolvepolicytopic2.asp&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;[4]&nbsp;&lt;a<br>
href=&quot;http://bugzilla.ximian.com/show_bug.cgi?id=52693&quot;&gt;http://bugzilla.ximian.com/show_bug.cgi?id=52693&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;font&nbsp;size=2&nbsp;face=Arial&gt;&lt;span&nbsp;lang=EN-GB&nbsp;style='font-size:<br>
10.0pt;font-family:Arial'&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
&lt;/body&gt;<br>
<br>
&lt;/html&gt;<br>

</tt>
