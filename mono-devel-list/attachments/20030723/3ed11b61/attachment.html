<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Re:&nbsp;[Mono-devel-list]&nbsp;handles.c&nbsp;patch&lt;/TITLE&gt;<br>
&lt;META&nbsp;http-equiv=Content-Type&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;content=&quot;MSHTML&nbsp;6.00.2800.1170&quot;&nbsp;name=GENERATOR&gt;<br>
&lt;STYLE&gt;&lt;/STYLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;bgColor=#e2f8fe&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;This&nbsp;still&nbsp;fails.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;As&nbsp;I&nbsp;said&nbsp;I&nbsp;wasn't&nbsp;sure&nbsp;my&nbsp;patch&nbsp;was&nbsp;quite&nbsp;right.&nbsp;<br>
But&nbsp;it&nbsp;is&nbsp;the&nbsp;private_list's&nbsp;shared_cond&nbsp;&amp;amp;&nbsp;shared_mutex&nbsp;that&nbsp;I&nbsp;am&nbsp;<br>
initializing&nbsp;(though&nbsp;maybe&nbsp;in&nbsp;the&nbsp;wrong&nbsp;place)&nbsp;not&nbsp;the&nbsp;shared&nbsp;ones.&nbsp;<br>
_wapi_handle_timedwait_signal&nbsp;waits&nbsp;on&nbsp;these&nbsp;if&nbsp;_POSIX_THREAD_PROCESS_SHARED&nbsp;is&nbsp;<br>
undefined&nbsp;and&nbsp;they&nbsp;don't&nbsp;seem&nbsp;to&nbsp;be&nbsp;initialized&nbsp;anywhere&nbsp;else.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;Bernie&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;BLOCKQUOTE&nbsp;<br>
style=&quot;PADDING-RIGHT:&nbsp;0px;&nbsp;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#000000&nbsp;2px&nbsp;solid;&nbsp;MARGIN-RIGHT:&nbsp;0px&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT:&nbsp;10pt&nbsp;arial&quot;&gt;-----&nbsp;Original&nbsp;Message&nbsp;-----&nbsp;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;<br>
&nbsp;&nbsp;style=&quot;BACKGROUND:&nbsp;#e4e4e4;&nbsp;FONT:&nbsp;10pt&nbsp;arial;&nbsp;font-color:&nbsp;black&quot;&gt;&lt;B&gt;From:&lt;/B&gt;&nbsp;<br>
&nbsp;&nbsp;&lt;A&nbsp;title=dick@ximian.com&nbsp;href=&quot;mailto:dick@ximian.com&quot;&gt;Dick&nbsp;Porter&lt;/A&gt;&nbsp;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT:&nbsp;10pt&nbsp;arial&quot;&gt;&lt;B&gt;To:&lt;/B&gt;&nbsp;&lt;A&nbsp;title=bernard@ugsolutions.com&nbsp;<br>
&nbsp;&nbsp;href=&quot;mailto:bernard@ugsolutions.com&quot;&gt;Bernie&nbsp;Solomon&lt;/A&gt;&nbsp;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT:&nbsp;10pt&nbsp;arial&quot;&gt;&lt;B&gt;Cc:&lt;/B&gt;&nbsp;&lt;A&nbsp;<br>
&nbsp;&nbsp;title=mono-devel-list@lists.ximian.com&nbsp;<br>
&nbsp;&nbsp;href=&quot;mailto:mono-devel-list@lists.ximian.com&quot;&gt;mono-devel-list@lists.ximian.com&lt;/A&gt;&nbsp;<br>
&nbsp;&nbsp;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT:&nbsp;10pt&nbsp;arial&quot;&gt;&lt;B&gt;Sent:&lt;/B&gt;&nbsp;Wednesday,&nbsp;July&nbsp;23,&nbsp;2003&nbsp;8:39&nbsp;<br>
&nbsp;&nbsp;AM&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT:&nbsp;10pt&nbsp;arial&quot;&gt;&lt;B&gt;Subject:&lt;/B&gt;&nbsp;Re:&nbsp;[Mono-devel-list]&nbsp;handles.c&nbsp;<br>
&nbsp;&nbsp;patch&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;On&nbsp;Wed,&nbsp;2003-07-23&nbsp;at&nbsp;01:29,&nbsp;Bernie&nbsp;Solomon&nbsp;wrote:&lt;/FONT&gt;&nbsp;<br>
&nbsp;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&amp;nbsp;&nbsp;&lt;/FONT&gt;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;I&nbsp;eventually&nbsp;realized&nbsp;<br>
&nbsp;&nbsp;that&nbsp;one&nbsp;reason&nbsp;things&nbsp;were&nbsp;slow&nbsp;for&nbsp;me&nbsp;is&nbsp;that&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;<br>
&nbsp;&nbsp;the&nbsp;thread&nbsp;management&nbsp;thread&nbsp;was&nbsp;in&nbsp;a&nbsp;busy&nbsp;loop&nbsp;because&nbsp;mutexes&lt;/FONT&gt;&nbsp;<br>
&nbsp;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;weren't&nbsp;initialized&nbsp;so&nbsp;calls&nbsp;continually&nbsp;failed.&lt;/FONT&gt;&nbsp;<br>
&nbsp;&nbsp;&lt;/P&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;Strange...&lt;/FONT&gt;&nbsp;&lt;/P&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;I&nbsp;am&nbsp;not&nbsp;100%&nbsp;sure&nbsp;this&nbsp;is&nbsp;the&nbsp;correct&nbsp;fix&nbsp;but&nbsp;it&nbsp;<br>
&nbsp;&nbsp;addresses&nbsp;my&nbsp;test&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;case.&nbsp;I&nbsp;am&nbsp;currently&nbsp;<br>
&nbsp;&nbsp;configuring&nbsp;with&nbsp;shared&nbsp;handles&nbsp;disabled.&nbsp;The&nbsp;fix&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;<br>
&nbsp;&nbsp;makes&nbsp;everything&nbsp;twice&nbsp;as&nbsp;fast&nbsp;for&nbsp;me&nbsp;having&nbsp;removed&nbsp;a&nbsp;busy&nbsp;thread.&lt;/FONT&gt;&nbsp;<br>
&lt;/P&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;This&nbsp;shouldn't&nbsp;actually&nbsp;do&nbsp;anything,&nbsp;because&nbsp;the&nbsp;shared&nbsp;mutex&nbsp;<br>
&nbsp;&nbsp;code&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;should&nbsp;be&nbsp;disabled.&amp;nbsp;&nbsp;Please&nbsp;try&nbsp;the&nbsp;attached&nbsp;<br>
&nbsp;&nbsp;patch&nbsp;instead&nbsp;and&nbsp;see&nbsp;if&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;that&nbsp;has&nbsp;the&nbsp;same&nbsp;<br>
&nbsp;&nbsp;effect.&lt;/FONT&gt;&nbsp;&lt;/P&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&amp;nbsp;&nbsp;&lt;/FONT&gt;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;I&nbsp;assume&nbsp;this&nbsp;matters&nbsp;<br>
&nbsp;&nbsp;on&nbsp;HP&nbsp;because&nbsp;initializing&nbsp;mutexes&nbsp;to&nbsp;zeroes&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;<br>
&nbsp;&nbsp;isn't&nbsp;the&nbsp;right&nbsp;thing&nbsp;to&nbsp;do&nbsp;yet&nbsp;presumably&nbsp;is&nbsp;OK&nbsp;on&nbsp;other&nbsp;platforms.&lt;/FONT&gt;&nbsp;<br>
&nbsp;&nbsp;&lt;/P&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;I'll&nbsp;save&nbsp;your&nbsp;suggested&nbsp;patch&nbsp;for&nbsp;when&nbsp;I&nbsp;get&nbsp;the&nbsp;time&nbsp;to&nbsp;make&nbsp;<br>
&nbsp;&nbsp;the&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;shared&nbsp;mutex&nbsp;code&nbsp;work.&amp;nbsp;&nbsp;The&nbsp;new&nbsp;Linux&nbsp;thread&nbsp;<br>
&nbsp;&nbsp;libraries&nbsp;support&lt;/FONT&gt;&nbsp;&lt;BR&gt;&lt;FONT&nbsp;size=2&gt;process-shared&nbsp;objects.&lt;/FONT&gt;&nbsp;&lt;/P&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;Thanks,&lt;/FONT&gt;&nbsp;&lt;/P&gt;<br>
&nbsp;&nbsp;&lt;P&gt;&lt;FONT&nbsp;size=2&gt;-&nbsp;Dick&lt;/FONT&gt;&nbsp;&lt;/P&gt;&lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
