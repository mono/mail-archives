<tt>
Will&nbsp;take&nbsp;a&nbsp;look.&nbsp;Not&nbsp;sure&nbsp;what&nbsp;it&nbsp;may&nbsp;not&nbsp;be&nbsp;liking.&nbsp;Code&nbsp;is&nbsp;very&nbsp;basic.&nbsp;Literally&nbsp;allocates&nbsp;16mb&nbsp;chunk&nbsp;then&nbsp;frees&nbsp;it&nbsp;(each&nbsp;object&nbsp;has&nbsp;one)&nbsp;code&nbsp;works&nbsp;fine&nbsp;in&nbsp;windows&nbsp;with&nbsp;same&nbsp;calls.&nbsp;Will&nbsp;debug&nbsp;it&nbsp;on&nbsp;Sunday.&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;br&gt;On&nbsp;Friday,&nbsp;August&nbsp;24,&nbsp;2012,&nbsp;Jonathan&nbsp;Pryor&nbsp;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;Aug&nbsp;23,&nbsp;2012,&nbsp;at&nbsp;2:35&nbsp;AM,&nbsp;Greg&nbsp;Young&nbsp;&lt;&lt;a&nbsp;href=&quot;javascript:;&quot;&nbsp;onclick=&quot;_e(event,&nbsp;&#39;cvml&#39;,&nbsp;&#39;gregoryyoung1@gmail.com&#39;)&quot;&gt;gregoryyoung1@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&gt;&nbsp;We&nbsp;are&nbsp;allocating&nbsp;and&nbsp;releasing&nbsp;unmanaged&nbsp;memory&nbsp;with&nbsp;marshal.allochglobal.&nbsp;In&nbsp;mono&nbsp;we&nbsp;are&nbsp;getting&nbsp;the&nbsp;following&nbsp;failure&nbsp;(no&nbsp;failures&nbsp;under&nbsp;clr).&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Any&nbsp;ideas?&lt;br&gt;<br>
&lt;br&gt;<br>
That&#39;s&nbsp;not&nbsp;a&nbsp;mono&nbsp;error,&nbsp;that&#39;s&nbsp;a&nbsp;glibc&nbsp;assert&nbsp;(and&nbsp;thus&nbsp;cannot&nbsp;become&nbsp;an&nbsp;exception,&nbsp;ever):&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;part&nbsp;from&nbsp;team&nbsp;city&nbsp;logs:&lt;br&gt;<br>
&gt;&nbsp;[20:55:52][Step&nbsp;2/2]&nbsp;mono:&nbsp;malloc.c:2451:&nbsp;sYSMALLOc:&nbsp;Assertion&nbsp;`(old_top&nbsp;==&nbsp;(((mbinptr)&nbsp;(((char&nbsp;*)&nbsp;&amp;((av)-&gt;bins[((1)&nbsp;-&nbsp;1)&nbsp;*&nbsp;2]))&nbsp;-&nbsp;__builtin_offsetof&nbsp;(struct&nbsp;malloc_chunk,&nbsp;fd))))&nbsp;&amp;&amp;&nbsp;old_size&nbsp;==&nbsp;0)&nbsp;||&nbsp;((unsigned&nbsp;long)&nbsp;(old_size)&nbsp;&gt;=&nbsp;(unsigned&nbsp;long)((((__builtin_offsetof&nbsp;(struct&nbsp;malloc_chunk,&nbsp;fd_nextsize))+((2&nbsp;*&nbsp;(sizeof(size_t)))&nbsp;-&nbsp;1))&nbsp;&amp;&nbsp;~((2&nbsp;*&nbsp;(sizeof(size_t)))&nbsp;-&nbsp;1)))&nbsp;&amp;&amp;&nbsp;((old_top)-&gt;size&nbsp;&amp;&nbsp;0x1)&nbsp;&amp;&amp;&nbsp;((unsigned&nbsp;long)old_end&nbsp;&amp;&nbsp;pagemask)&nbsp;==&nbsp;0)&#39;&nbsp;failed.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Very&nbsp;probably&nbsp;coming&nbsp;from:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;http://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=0f1796c9134ffef289ec31fb1cd538f3a9490ae1;hb=HEAD#l2361&quot;&nbsp;target=&quot;_blank&quot;&gt;http://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=0f1796c9134ffef289ec31fb1cd538f3a9490ae1;hb=HEAD#l2361&lt;/a&gt;&lt;br&gt;<br>
<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /*&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;If&nbsp;not&nbsp;the&nbsp;first&nbsp;time&nbsp;through,&nbsp;we&nbsp;require&nbsp;old_size&nbsp;to&nbsp;be&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;at&nbsp;least&nbsp;MINSIZE&nbsp;and&nbsp;to&nbsp;have&nbsp;prev_inuse&nbsp;set.&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assert((old_top&nbsp;==&nbsp;initial_top(av)&nbsp;&amp;&amp;&nbsp;old_size&nbsp;==&nbsp;0)&nbsp;||&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;((unsigned&nbsp;long)&nbsp;(old_size)&nbsp;&gt;=&nbsp;MINSIZE&nbsp;&amp;&amp;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_inuse(old_top)&nbsp;&amp;&amp;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((unsigned&nbsp;long)old_end&nbsp;&amp;&nbsp;pagemask)&nbsp;==&nbsp;0));&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;line&nbsp;number&nbsp;is&nbsp;different,&nbsp;but&nbsp;it&#39;s&nbsp;the&nbsp;same&nbsp;file&nbsp;and&nbsp;the&nbsp;assert&nbsp;looks&nbsp;close&nbsp;enough&nbsp;(considering&nbsp;macro&nbsp;expansion,&nbsp;etc.).&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;short,&nbsp;malloc(3)&nbsp;doesn&#39;t&nbsp;like&nbsp;you&nbsp;or&nbsp;something&nbsp;that&nbsp;you&#39;re&nbsp;doing.&nbsp;I&nbsp;would&nbsp;suggest&nbsp;setting&nbsp;the&nbsp;MALLOC_CHECK_&nbsp;environment&nbsp;variable&nbsp;(see&nbsp;the&nbsp;malloc(3)&nbsp;man&nbsp;page),&nbsp;and/or&nbsp;&quot;porting&quot;&nbsp;your&nbsp;malloc&nbsp;use&nbsp;to&nbsp;C&nbsp;to&nbsp;verify&nbsp;that&nbsp;it&nbsp;also&nbsp;crashes&nbsp;there.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
 -&nbsp;Jon&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;br&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Le&nbsp;doute&nbsp;n&#39;est&nbsp;pas&nbsp;une&nbsp;condition&nbsp;agréable,&nbsp;mais&nbsp;la&nbsp;certitude&nbsp;est&nbsp;absurde.&lt;br&gt;<br>

</tt>
