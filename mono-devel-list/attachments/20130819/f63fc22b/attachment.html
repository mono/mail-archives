<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Those&nbsp;hangs&nbsp;are&nbsp;known&nbsp;limitations&nbsp;of&nbsp;our&nbsp;AOT&nbsp;technology&nbsp;for&nbsp;which&nbsp;we&nbsp;have&nbsp;no&nbsp;plans&nbsp;on&nbsp;fixing&nbsp;in&nbsp;the&nbsp;near&nbsp;term.&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Aug&nbsp;19,&nbsp;2013&nbsp;at&nbsp;10:49&nbsp;AM,&nbsp;Charles&nbsp;Randall&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:Charles.Randall@nirvanix.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Charles.Randall@nirvanix.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Continuing&nbsp;this&nbsp;investigation,&nbsp;I&nbsp;ran&nbsp;the&nbsp;following&nbsp;using&nbsp;the&nbsp;mono-3-2&nbsp;branch&nbsp;as&nbsp;of&nbsp;a0fc6ba35b7454425b8ec772b2652730b8030a52.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
I&nbsp;couldn&#39;t&nbsp;run&nbsp;a&nbsp;top-level&nbsp;&quot;make&nbsp;check&quot;&nbsp;because&nbsp;of&nbsp;this&nbsp;bug,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://bugzilla.xamarin.com/show_bug.cgi?id=14049&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugzilla.xamarin.com/show_bug.cgi?id=14049&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Because&nbsp;of&nbsp;this&nbsp;limitation,&nbsp;I&nbsp;ran&nbsp;&quot;make&nbsp;check&quot;&nbsp;in&nbsp;the&nbsp;mono&nbsp;directory.&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;117&nbsp;failures&nbsp;in&nbsp;441&nbsp;iterations&nbsp;(26.5%).&nbsp;Here&#39;s&nbsp;the&nbsp;count&nbsp;of&nbsp;the&nbsp;tests&nbsp;that&nbsp;failed,&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;103&nbsp;gsharing-valuetype-layout.exe&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;8&nbsp;sgen-bridge.exe|ms-conc&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;2&nbsp;gc-altstack.exe&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;1&nbsp;sgen-weakref-stress.exe|ms-par&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;1&nbsp;sgen-case-23400.exe|ms-par&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;1&nbsp;sgen-bridge.exe|plain&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;1&nbsp;bug-10127.exe&lt;br&gt;<br>
&lt;br&gt;<br>
Looking&nbsp;only&nbsp;at&nbsp;the&nbsp;103&nbsp;failures&nbsp;of&nbsp;gsharing-valuetype-layout.exe,&nbsp;in&nbsp;81&nbsp;of&nbsp;the&nbsp;failures&nbsp;were&nbsp;the&nbsp;120&nbsp;second&nbsp;test&nbsp;timeout.&nbsp;A&nbsp;successful&nbsp;run&nbsp;of&nbsp;this&nbsp;test&nbsp;takes&nbsp;less&nbsp;than&nbsp;a&nbsp;second.&nbsp;In&nbsp;the&nbsp;timeout&nbsp;case,&nbsp;mono&nbsp;simply&nbsp;appears&nbsp;to&nbsp;hang.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Running&nbsp;this&nbsp;manually,&nbsp;when&nbsp;it&nbsp;hangs&nbsp;it&nbsp;stops&nbsp;using&nbsp;CPU&nbsp;and&nbsp;strace&nbsp;reports,&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;strace&nbsp;-fp&nbsp;4289&lt;br&gt;<br>
Process&nbsp;4289&nbsp;attached&nbsp;with&nbsp;3&nbsp;threads&lt;br&gt;<br>
[pid&nbsp; 4292]&nbsp;futex(0x7f6264000020,&nbsp;FUTEX_WAIT_PRIVATE,&nbsp;2,&nbsp;NULL&nbsp;&lt;unfinished&nbsp;...&gt;&lt;br&gt;<br>
[pid&nbsp; 4290]&nbsp;futex(0x967340,&nbsp;FUTEX_WAIT_PRIVATE,&nbsp;0,&nbsp;NULL&nbsp;&lt;unfinished&nbsp;...&gt;&lt;br&gt;<br>
[pid&nbsp; 4289]&nbsp;futex(0x1c84f1c,&nbsp;FUTEX_WAIT_PRIVATE,&nbsp;3,&nbsp;NULL&lt;br&gt;<br>
&lt;br&gt;<br>
Here&#39;s&nbsp;a&nbsp;gstack&nbsp;stack&nbsp;trace,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://sprunge.us/CfjX&quot;&nbsp;target=&quot;_blank&quot;&gt;http://sprunge.us/CfjX&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;trivial&nbsp;to&nbsp;reproduce&nbsp;on&nbsp;my&nbsp;system,&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;uname&nbsp;-a&lt;br&gt;<br>
Linux&nbsp;linux-mono.....com&nbsp;3.7.10-1.1-desktop&nbsp;#1&nbsp;SMP&nbsp;PREEMPT&nbsp;Thu&nbsp;Feb&nbsp;28&nbsp;15:06:29&nbsp;UTC&nbsp;2013&nbsp;(82d3f21)&nbsp;x86_64&nbsp;x86_64&nbsp;x86_64&nbsp;GNU/Linux&lt;br&gt;<br>
&lt;br&gt;<br>
Running&nbsp;as&nbsp;a&nbsp;VMware&nbsp;virtual&nbsp;machine,&nbsp;4&nbsp;CPU,&nbsp;8&nbsp;GB&nbsp;RAM.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;use&nbsp;this&nbsp;simple&nbsp;script&nbsp;to&nbsp;repeatedly&nbsp;run&nbsp;the&nbsp;commands,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://sprunge.us/VKTS&quot;&nbsp;target=&quot;_blank&quot;&gt;http://sprunge.us/VKTS&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
E.g.,&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;./repeat.sh&nbsp;mono&nbsp;gsharing-valuetype-layout.exe&lt;br&gt;<br>
&lt;br&gt;<br>
Filed&nbsp;bug&nbsp;14073&nbsp;to&nbsp;track&nbsp;this,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://bugzilla.xamarin.com/show_bug.cgi?id=14073&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugzilla.xamarin.com/show_bug.cgi?id=14073&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Looking&nbsp;back&nbsp;at&nbsp;previous&nbsp;failures,&nbsp;I&nbsp;realize&nbsp;that&nbsp;this&nbsp;hang&nbsp;can&nbsp;be&nbsp;worked&nbsp;around&nbsp;by&nbsp;disabling&nbsp;AOT&nbsp;using&nbsp;the&nbsp;mono&nbsp;option&nbsp;&#39;-O=-aot&quot;.&nbsp;Ugh.&nbsp;Given&nbsp;that,&nbsp;this&nbsp;may&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;bug&nbsp;7564,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://bugzilla.xamarin.com/show_bug.cgi?id=7564&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugzilla.xamarin.com/show_bug.cgi?id=7564&lt;/a&gt;&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
-Charles&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;im&nbsp;HOEnZb&quot;&gt;&lt;br&gt;<br>
-----Original&nbsp;Message-----&lt;br&gt;<br>
From:&nbsp;Charles&nbsp;Randall&lt;br&gt;<br>
Sent:&nbsp;Wednesday,&nbsp;August&nbsp;14,&nbsp;2013&nbsp;2:36&nbsp;PM&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;href=&quot;mailto:mono-devel-list@lists.ximian.com&quot;&gt;mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;RE:&nbsp;[Mono-dev]&nbsp;mono-3.2.1&nbsp;&quot;make&nbsp;check&quot;&nbsp;failures&nbsp;&amp;&nbsp;sgen&nbsp;assertion&lt;br&gt;<br>
&lt;br&gt;<br>
Continuing&nbsp;to&nbsp;dig&nbsp;into&nbsp;these&nbsp;failures,&nbsp;here&nbsp;is&nbsp;what&nbsp;I&#39;ve&nbsp;found&nbsp;so&nbsp;far.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;majority&nbsp;of&nbsp;the&nbsp;bug-10127&nbsp;test&nbsp;failures&nbsp;were&nbsp;due&nbsp;to&nbsp;bug&nbsp;13604&nbsp;and&nbsp;now&nbsp;resolves&nbsp;the&nbsp;assert&nbsp;in&nbsp;sgen-os-posix.c:60&nbsp;and&nbsp;is&nbsp;already&nbsp;in&nbsp;the&nbsp;mono&nbsp;3.2&nbsp;branch&nbsp;and&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;upcoming&nbsp;mono&nbsp;3.2.2.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://bugzilla.xamarin.com/show_bug.cgi?id=13604&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugzilla.xamarin.com/show_bug.cgi?id=13604&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;failures&nbsp;in&nbsp;sgen-weakref-stress&nbsp;were&nbsp;resolved&nbsp;in&nbsp;this&nbsp;fix&nbsp;which&nbsp;is&nbsp;planned&nbsp;to&nbsp;be&nbsp;in&nbsp;the&nbsp;upcoming&nbsp;3.2.2,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://github.com/mono/mono/commit/aef4b77ea79aa0a4c06e10bd5842da9df0d10973&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/mono/mono/commit/aef4b77ea79aa0a4c06e10bd5842da9df0d10973&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;majority&nbsp;of&nbsp;delegate2&nbsp;test&nbsp;failures&nbsp;are&nbsp;due&nbsp;to&nbsp;bug&nbsp;7564.&nbsp;There&nbsp;is&nbsp;a&nbsp;workaround&nbsp;for&nbsp;this&nbsp;listed&nbsp;in&nbsp;the&nbsp;bug&nbsp;report.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://bugzilla.xamarin.com/show_bug.cgi?id=7564&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugzilla.xamarin.com/show_bug.cgi?id=7564&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;bug&nbsp;is&nbsp;pretty&nbsp;disturbing.&nbsp;Once&nbsp;you&#39;ve&nbsp;determined&nbsp;you&nbsp;need&nbsp;the&nbsp;workaround,&nbsp;your&nbsp;application&nbsp;has&nbsp;already&nbsp;hung.&nbsp;If&nbsp;your&nbsp;application&nbsp;is&nbsp;critical&nbsp;to&nbsp;your&nbsp;business&nbsp;that&#39;s&nbsp;a&nbsp;tough&nbsp;lesson&nbsp;to&nbsp;learn.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;discrepancy&nbsp;between&nbsp;my&nbsp;observed&nbsp;&quot;make&nbsp;check&quot;&nbsp;failures&nbsp;and&nbsp;the&nbsp;&quot;all&nbsp;green&quot;&nbsp;results&nbsp;of&nbsp;the&nbsp;monkey&nbsp;wrench&nbsp;automated&nbsp;tests&nbsp;appears&nbsp;to&nbsp;be&nbsp;because&nbsp;many&nbsp;tests&nbsp;are&nbsp;disabled&nbsp;for&nbsp;monkey&nbsp;wrench.&nbsp;See&nbsp;DISABLED_TESTS_WRENCH&nbsp;in&nbsp;mono/tests/Makefile&nbsp;for&nbsp;the&nbsp;details.&nbsp;Notably,&nbsp;bug-10127&nbsp;is&nbsp;disabled.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Continuing&nbsp;these&nbsp;tests&nbsp;with&nbsp;the&nbsp;3.2&nbsp;branch&nbsp;and&nbsp;the&nbsp;second&nbsp;fix&nbsp;above.&lt;br&gt;<br>
&lt;br&gt;<br>
-Charles&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
