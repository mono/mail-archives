<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#ffffff&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hello,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppublic&nbsp;class&nbsp;Sort&amp;lt;T&amp;gt;&nbsp;{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppublic&nbsp;delegate&nbsp;int&nbsp;Comparison&nbsp;(T&nbsp;v0,&nbsp;T&nbsp;v1);<br>
<br>
You&nbsp;don't&nbsp;need&nbsp;yet&nbsp;another&nbsp;delegate,&nbsp;just&nbsp;use&nbsp;standard&nbsp;Func<br>
<br>
&amp;gt;&amp;gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspstatic&nbsp;readonly&nbsp;int&nbsp;INSERTIONSORT_THRESHOLD&nbsp;=&nbsp;7;<br>
<br>
Why&nbsp;not&nbsp;to&nbsp;used&nbsp;const&nbsp;int&nbsp;?<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;More&nbsp;importantly&nbsp;what&nbsp;is&nbsp;performance&nbsp;of&nbsp;sorting&nbsp;array&nbsp;of&nbsp;10-20<br>
&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;called&nbsp;1000000&nbsp;times&nbsp;?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thanks&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Marek&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:4D9B9C5B.9050709@novell.com&quot;&nbsp;type=&quot;cite&quot;&gt;Attached<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;you'll&nbsp;find&nbsp;qsort.cs&nbsp;which&nbsp;includes&nbsp;3&nbsp;QuickSort&nbsp;implementations:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;QuickSortBasic[R]:&nbsp;This&nbsp;is&nbsp;a&nbsp;basic&nbsp;QuickSort&nbsp;implementation&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;one&nbsp;currently&nbsp;in&nbsp;use&nbsp;as&nbsp;the&nbsp;sorting&nbsp;function&nbsp;in&nbsp;Array.Sort().<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;implementation&nbsp;always&nbsp;uses&nbsp;the&nbsp;middle&nbsp;element&nbsp;as&nbsp;the&nbsp;pivot.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;QuickSortMedian[R]:&nbsp;This&nbsp;implementation&nbsp;is&nbsp;also&nbsp;a&nbsp;basic<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort&nbsp;implementation&nbsp;which&nbsp;attempts&nbsp;choose&nbsp;a&nbsp;better&nbsp;pivot<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;based&nbsp;on&nbsp;the&nbsp;first,&nbsp;last,&nbsp;and&nbsp;middle&nbsp;elements.&nbsp;For&nbsp;sorted&nbsp;inputs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;random&nbsp;inputs,&nbsp;this&nbsp;seems&nbsp;to&nbsp;help&nbsp;performance&nbsp;somewhat&nbsp;as&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;gets&nbsp;larger&nbsp;and&nbsp;larger.&nbsp;However,&nbsp;for&nbsp;reverse-sorted&nbsp;inputs,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;seems&nbsp;to&nbsp;kill&nbsp;performance.&nbsp;Perhaps&nbsp;if&nbsp;I&nbsp;choose&nbsp;3&nbsp;random&nbsp;points<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;feed&nbsp;into&nbsp;Median()&nbsp;it&nbsp;will&nbsp;do&nbsp;better.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;QuickSortInsertion[R]:&nbsp;This&nbsp;implementation&nbsp;includes&nbsp;the&nbsp;above<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perf&nbsp;trick&nbsp;and&nbsp;also&nbsp;includes&nbsp;an&nbsp;Insertion&nbsp;Sort&nbsp;fallback&nbsp;when<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partitions&nbsp;are&nbsp;broken&nbsp;down&nbsp;smaller&nbsp;than&nbsp;some&nbsp;threshold&nbsp;#&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;(7&nbsp;in&nbsp;the&nbsp;attached&nbsp;code).&nbsp;It&nbsp;also&nbsp;falls&nbsp;back&nbsp;to&nbsp;Insertion<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sort&nbsp;when&nbsp;it&nbsp;encounters&nbsp;a&nbsp;worst-case&nbsp;scenario.&nbsp;As&nbsp;always,&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;performance&nbsp;improvement&nbsp;with&nbsp;this&nbsp;is&nbsp;greater&nbsp;as&nbsp;the&nbsp;number&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;increases&nbsp;and/or&nbsp;as&nbsp;the&nbsp;comparison&nbsp;function&nbsp;becomes&nbsp;more<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You'll&nbsp;notice&nbsp;that&nbsp;the&nbsp;attached&nbsp;test&nbsp;program&nbsp;will&nbsp;print&nbsp;out&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;comparisons&nbsp;that&nbsp;each&nbsp;sort&nbsp;routine&nbsp;uses&nbsp;in&nbsp;order&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complete&nbsp;its&nbsp;job.&nbsp;It's&nbsp;important&nbsp;to&nbsp;keep&nbsp;in&nbsp;mind&nbsp;that&nbsp;the&nbsp;more<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex&nbsp;the&nbsp;comparison&nbsp;function&nbsp;is,&nbsp;the&nbsp;more&nbsp;important&nbsp;it&nbsp;is&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;comparisons&nbsp;is&nbsp;kept&nbsp;to&nbsp;a&nbsp;minimum.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;are&nbsp;some&nbsp;example&nbsp;runs:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fejj@warpig&nbsp;sorting]$&nbsp;mono&nbsp;./qsort.exe&nbsp;-random&nbsp;100000000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic&nbsp;QuickSort&nbsp;comparisons&nbsp;needed:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;3807986012<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Median&nbsp;comparisons&nbsp;needed:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;3077915654<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Insertion&nbsp;comparisons&nbsp;needed:&nbsp;3021355043<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic&nbsp;QuickSort&nbsp;finished&nbsp;in:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;00:00:43.8178721s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Median&nbsp;finished&nbsp;in:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;00:00:37.3047443s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Insertion&nbsp;finished&nbsp;in:&nbsp;00:00:36.6122681s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fejj@warpig&nbsp;sorting]$&nbsp;mono&nbsp;./qsort.exe&nbsp;-sorted&nbsp;100000000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic&nbsp;QuickSort&nbsp;comparisons&nbsp;needed:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;2632227866<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Median&nbsp;comparisons&nbsp;needed:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;2632227867<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Insertion&nbsp;comparisons&nbsp;needed:&nbsp;2483222808<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic&nbsp;QuickSort&nbsp;finished&nbsp;in:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;00:00:21.8213618s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Median&nbsp;finished&nbsp;in:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;00:00:21.2622527s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Insertion&nbsp;finished&nbsp;in:&nbsp;00:00:19.0837352s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Note:&nbsp;I&nbsp;reduced&nbsp;the&nbsp;array&nbsp;size&nbsp;here&nbsp;due&nbsp;to&nbsp;wanting&nbsp;to&nbsp;head&nbsp;home<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;dinner)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fejj@warpig&nbsp;sorting]$&nbsp;mono&nbsp;./qsort.exe&nbsp;-reversed&nbsp;10000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic&nbsp;QuickSort&nbsp;comparisons&nbsp;needed:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;129546<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Median&nbsp;comparisons&nbsp;needed:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;12522499<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Insertion&nbsp;comparisons&nbsp;needed:&nbsp;39993<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic&nbsp;QuickSort&nbsp;finished&nbsp;in:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;00:00:00.0016905s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Median&nbsp;finished&nbsp;in:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;00:00:00.0911385s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuickSort+Insertion&nbsp;finished&nbsp;in:&nbsp;00:00:00.0008721s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jeff<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
&lt;fieldset&nbsp;class=&quot;mimeAttachmentHeader&quot;&gt;&lt;/fieldset&gt;<br>
_______________________________________________<br>
Mono-devel-list&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
