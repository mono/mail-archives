__doc__ = '''

gdatareader.py - A quick and dirty GDATA reader

Version created for tutorial:

 http://hex-dump.blogspot.com/2006/08/agile-investigation-of-gdata-client.html

(C) 2006 Mark Rees http://hex-dump.blogspot.com

License: MIT

'''
import sys
import clr
import System
import System.Net
clr.AddReference("gdata.dll")
import Google.GData.Client as GDClient

def parse(uri, nc=None):
    # Create a query and service object
    query = GDClient.FeedQuery()
    service = GDClient.Service("cl","hexdump-gdatareader-0.1")
    service.Credentials = nc
    query.Uri = System.Uri(uri)
    return service.Query(query)

if __name__ == "__main__":
    url = "http://www.google.com/calendar/feeds/..."
    
    if len(sys.argv) == 2:
        print sys.argv
        url = sys.argv[1]
    
    nc = System.Net.NetworkCredential("<accoount-here>", "<password-here>")
    
    feed = parse(url, nc)
    for entry in feed.Entries:
        print entry.Title.Text,":",entry.Summary.Text
