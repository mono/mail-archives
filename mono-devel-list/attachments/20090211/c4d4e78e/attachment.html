<tt>
Russel,&lt;br&gt;&lt;br&gt;I&nbsp;think&nbsp;the&nbsp;issue&nbsp;is&nbsp;that&nbsp;you&amp;#39;re&nbsp;using&nbsp;long&nbsp;to&nbsp;represent&nbsp;pointers&nbsp;when&nbsp;you&nbsp;should&nbsp;be&nbsp;using&nbsp;IntPtr&nbsp;only.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/2/11&nbsp;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:russell.kay@realtimeworlds.com&quot;&gt;russell.kay@realtimeworlds.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&nbsp;link=&quot;blue&quot;&nbsp;vlink=&quot;purple&quot;&nbsp;lang=&quot;EN-GB&quot;&gt;<br>
<br>
&lt;div&gt;<br>
<br>
&lt;p&gt;All,&lt;/p&gt;<br>
<br>
&lt;p&gt;&amp;nbsp;&lt;/p&gt;<br>
<br>
&lt;p&gt;Not&nbsp;sure&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;submit&nbsp;this,&nbsp;please&nbsp;correct&nbsp;me&nbsp;if<br>
there&nbsp;is&nbsp;a&nbsp;better&nbsp;way&nbsp;to&nbsp;do&nbsp;this&nbsp;(via&nbsp;bugzilla?)&lt;/p&gt;<br>
<br>
&lt;p&gt;&amp;nbsp;&lt;/p&gt;<br>
<br>
&lt;p&gt;I&nbsp;encountered&nbsp;a&nbsp;problem&nbsp;when&nbsp;casting&nbsp;a&nbsp;long&nbsp;to&nbsp;an&nbsp;IntPtr,<br>
which&nbsp;is&nbsp;something&nbsp;we&nbsp;have&nbsp;ended&nbsp;up&nbsp;doing&nbsp;a&nbsp;lot&nbsp;(we&nbsp;want&nbsp;to&nbsp;keep&nbsp;binary&nbsp;assembly<br>
compatibility&nbsp;between&nbsp;x86&nbsp;and&nbsp;x64,&nbsp;only&nbsp;changing&nbsp;the&nbsp;native&nbsp;code&nbsp;on&nbsp;the<br>
different&nbsp;architectures).&nbsp;We&nbsp;encountered&nbsp;a&nbsp;problem&nbsp;with&nbsp;Mono&nbsp;as&nbsp;there&nbsp;has&nbsp;been<br>
a&nbsp;check&nbsp;introduced&nbsp;into&nbsp;the&nbsp;IntPtr&nbsp;constructor&nbsp;from&nbsp;a&nbsp;long,&nbsp;this&nbsp;is&nbsp;checking<br>
the&nbsp;range&nbsp;of&nbsp;the&nbsp;long&nbsp;to&nbsp;ensure&nbsp;it&nbsp;is&nbsp;in&nbsp;range,&nbsp;unfortunately&nbsp;the&nbsp;check&nbsp;is<br>
incorrect.&nbsp;A&nbsp;long&nbsp;can&nbsp;easily&nbsp;hold&nbsp;from&nbsp;Int32.MinValue&nbsp;to&nbsp;UInt32.MaxValue&nbsp;(and<br>
not&nbsp;Int32.MaxValue&nbsp;as&nbsp;it&nbsp;currently&nbsp;in&nbsp;there).&lt;/p&gt;<br>
<br>
&lt;p&gt;&amp;nbsp;&lt;/p&gt;<br>
<br>
&lt;p&gt;See&nbsp;attached&nbsp;patch&nbsp;(contributed&nbsp;under&nbsp;the&nbsp;MIT&nbsp;X11&nbsp;license)<br>
to&nbsp;introduce&nbsp;the&nbsp;one&nbsp;extra&nbsp;character&nbsp;that&nbsp;makes&nbsp;the&nbsp;range&nbsp;check&nbsp;correct.&lt;/p&gt;<br>
<br>
&lt;p&gt;&amp;nbsp;&lt;/p&gt;<br>
<br>
&lt;p&gt;Can&nbsp;I&nbsp;also&nbsp;say&nbsp;that&nbsp;I&nbsp;think&nbsp;the&nbsp;check&nbsp;should&nbsp;really&nbsp;be&nbsp;in&nbsp;a<br>
Debug.Assert&nbsp;so&nbsp;that&nbsp;it&nbsp;disappears&nbsp;in&nbsp;non-Debug&nbsp;versions,&nbsp;the&nbsp;check&nbsp;is&nbsp;good&nbsp;for<br>
sanity&nbsp;checking&nbsp;but&nbsp;superfluous&nbsp;on&nbsp;released&nbsp;code.&lt;/p&gt;<br>
<br>
&lt;p&gt;&amp;nbsp;&lt;/p&gt;<br>
<br>
&lt;p&gt;Regards&lt;/p&gt;<br>
<br>
&lt;p&gt;&amp;nbsp;&lt;/p&gt;<br>
<br>
&lt;p&gt;Russell&lt;/p&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
<br>
&lt;br&gt;<br>
____________________________________________________________________&lt;br&gt;<br>
DISCLAIMER&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;message&nbsp;and&nbsp;any&nbsp;attachments&nbsp;contain&nbsp;privileged&nbsp;and&nbsp;confidential&nbsp;information&nbsp;intended&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;addressee&nbsp;named&nbsp;above.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient&nbsp;of&nbsp;this&nbsp;message,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;use,&nbsp;dissemination,&nbsp;distribution&nbsp;or&nbsp;reproduction&nbsp;of&nbsp;this&nbsp;message&nbsp;is&nbsp;prohibited.&nbsp;Please&nbsp;note&nbsp;that&nbsp;we&nbsp;cannot&nbsp;guarantee&nbsp;that&nbsp;this&nbsp;message&nbsp;or&nbsp;any&nbsp;attachment&nbsp;is&nbsp;virus&nbsp;free&nbsp;or&nbsp;that&nbsp;it&nbsp;has&nbsp;not&nbsp;been&nbsp;intercepted&nbsp;and&nbsp;amended.&nbsp;The&nbsp;views&nbsp;of&nbsp;the&nbsp;author&nbsp;may&nbsp;not&nbsp;necessarily&nbsp;reflect&nbsp;those&nbsp;of&nbsp;Realtime&nbsp;Worlds&nbsp;Ltd.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Realtime&nbsp;Worlds&nbsp;Ltd&nbsp;is&nbsp;registered&nbsp;in&nbsp;Scotland,&nbsp;number&nbsp;225628.&nbsp;Registered&nbsp;Office:&nbsp;152&nbsp;West&nbsp;Marketgait,&nbsp;Dundee,&nbsp;DD1&nbsp;1NJ.&lt;br&gt;<br>
&lt;/div&gt;<br>
<br>
<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
