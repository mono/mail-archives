using System;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;

class tmp {

	public static void Main (String[] args)
	{
		DataSet ds = new DataSet ();
		DataTable table = ds.Tables.Add ("Table");
		table.Columns.Add ("ID", typeof (int));
		table.Columns.Add ("Value", typeof (int));

		table.PrimaryKey = new DataColumn[] {table.Columns [0]};

		long t = DateTime.Now.Ticks;	
		for (int i=0; i < 1000000; i++) {
			try {
			DataRow row = table.NewRow ();
			row ["ID"] = i;
			row ["Value"] = 1000;
			table.Rows.Add (row);
			} catch (Exception e) {
			}
		}
		t = DateTime.Now.Ticks - t;
		Console.WriteLine ((float)t/(10000000));

		t = DateTime.Now.Ticks;
		ds.EnforceConstraints = false;
		ds.EnforceConstraints = true;
		t = DateTime.Now.Ticks - t;
		Console.WriteLine ((float)t/(10000000));
		

	}
}