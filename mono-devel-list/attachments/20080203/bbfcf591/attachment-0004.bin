using System;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;

class tmp {

	public static void Main (String[] args)
	{
		DataSet ds = new DataSet ();
		DataTable table = ds.Tables.Add ("Table");
		table.Columns.Add ("ID", typeof (int));
		table.Columns.Add ("Value", typeof (int));

		table.PrimaryKey = new DataColumn[] {table.Columns [0]};

		Random rand = new Random ();
		long t = DateTime.Now.Ticks;	
		int count =0 ;
		for (int i=0; i < 1000000; i++) {
			try {
			DataRow row = table.NewRow ();
			row ["ID"] = rand.Next() ;
			row ["Value"] = i*1000;
			table.Rows.Add (row);
			} catch (Exception e) {
				count++;
			}
		}
		t = DateTime.Now.Ticks - t;
		
		Console.WriteLine ((float)t/(10000000));
		Console.WriteLine (" no of collisions : " + count);
	}
}