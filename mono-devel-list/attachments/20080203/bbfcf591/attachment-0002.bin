using System;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;

class tmp {

	public static void Main (String[] args)
	{
		DataSet ds = new DataSet ();
		DataTable table1 = ds.Tables.Add ("Table1");
		DataTable table2 = ds.Tables.Add ("Table2");

		table1.Columns.Add ("ID", typeof (int));
		table1.Columns.Add ("Value", typeof (int));

		table2.Columns.Add ("PID", typeof (int));
		table2.Columns.Add ("Value", typeof (int));

		table1.PrimaryKey = new DataColumn[] {table1.Columns [0]};
		table2.Constraints.Add ("fk", table1.Columns [0], table2.Columns [0]);
		long t = DateTime.Now.Ticks;
			
		for (int i=0; i < 1000000; i++) {
			try {
			DataRow prow = table1.NewRow ();
			prow ["ID"] = i;
			prow ["Value"] = 1000;
			table1.Rows.Add (prow);

			} catch (Exception e) {
			}
		}
		Console.WriteLine (((float)(t-DateTime.Now.Ticks))/10000000);

		for (int i=0; i < 1000000; i++) {
			try {
				DataRow crow = table2.NewRow ();
				crow ["PID"] = i;
				crow ["Value"] = -1000;
				table2.Rows.Add (crow);

				crow = table2.NewRow ();
				crow ["PID"] = i;
				crow ["Value"] = 1000;
				table2.Rows.Add (crow);

				crow = table2.NewRow ();
				crow ["PID"] = i;
				crow ["Value"] = 2000;
				table2.Rows.Add (crow);

			} catch (Exception e) {
			}
		}
		Console.WriteLine (((float)(t-DateTime.Now.Ticks))/10000000);

		Console.WriteLine ( "Finished creating the tables");
		table1.Rows [0][0] = 5000000;
		Console.WriteLine (((float)(t-DateTime.Now.Ticks))/10000000);
	}
}