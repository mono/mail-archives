using System;
using System.Data;

class tmp {
	public static void Main (String[] args)
	{
		DataSet ds = new DataSet ();
		DataTable table1 = new DataTable ("table1");
		DataTable table2 = new DataTable ("table2");
		DataTable table3 = new DataTable ("table3");
	
		table1.Columns.Add ("col1", typeof (int));	

		table2.Columns.Add ("col2_1", typeof (int));	
		table2.Columns.Add ("col2_2", typeof (int));	

		table3.Columns.Add ("col3_1", typeof (int));	
		table3.Columns.Add ("col3_2", typeof (int));	

		ds.Tables.AddRange (new DataTable[] {table1,table2,table3});

		DataRelation rel1_2 = ds.Relations.Add ("rel1_2", table1.Columns [0], table2.Columns [0], true);
		DataRelation rel2_3 = ds.Relations.Add ("rel2_3", table2.Columns [0], table3.Columns [0], true);

		Random rand = new Random ();
				
		for (int i=0; i < 100000; i++) {
			DataRow row = table1.NewRow ();
			row ["col1"] = i;
			table1.Rows.Add (row);
		}

		for (int i=0; i < 100000; i++) {
			DataRow row = table2.NewRow ();
			row ["col2_1"] = rand.Next (0,999);
			row ["col2_2"] = rand.Next (0,999);
			try {
				table2.Rows.Add (row);
			}catch (Exception) {}
		}

		for (int i=0; i < 100000; i++) {
			DataRow row = table3.NewRow ();
			row ["col3_1"] = rand.Next (0,999);
			row ["col3_2"] = rand.Next (0,999);
			try {
				table3.Rows.Add (row);
			}catch (Exception) {}
		}
	}
}