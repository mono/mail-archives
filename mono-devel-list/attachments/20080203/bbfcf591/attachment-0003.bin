using System;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;

class tmp {

	public static void Main (String[] args)
	{
		DataSet ds = new DataSet ();
		DataTable table = ds.Tables.Add ("Table");
		table.Columns.Add ("ID", typeof (int));
		table.Columns.Add ("Value", typeof (int));

		int count =0 ;
		for (int i=0; i < 1000000; i++) {
			try {
			DataRow row = table.NewRow ();
			row ["ID"] = i;
			row ["Value"] = i*1000;
			table.Rows.Add (row);
			} catch (Exception e) {
				count++;
			}
		}

		long t = DateTime.Now.Ticks;	
		table.PrimaryKey = new DataColumn[] {table.Columns [0]};
		Console.WriteLine ((float)(DateTime.Now.Ticks - t)/10000000);
		table.Rows.Add (new object [] {-1, 100});
		Console.WriteLine ((float)(DateTime.Now.Ticks - t)/10000000);
		Console.WriteLine (" no of collisions : " + count);
	}
}