--- C:\DIFF\old\System.Data\System.Data.Common\DbDataAdapter.cs	2003-08-24 08:59:28.000000000 +0300
+++ C:\DIFF\new\System.Data\System.Data.Common\DbDataAdapter.cs	2003-09-29 10:05:23.014078500 +0300
@@ -137,7 +137,14 @@
 
 		protected virtual int Fill (DataTable dataTable, IDbCommand command, CommandBehavior behavior) 
 		{
-			return Fill (dataTable, command.ExecuteReader (behavior));
+			CommandBehavior commandBehavior = behavior;
+			// first see that the connection is not close.
+			if (command.Connection.State == ConnectionState.Closed) 
+			{
+				command.Connection.Open ();
+				commandBehavior |= CommandBehavior.CloseConnection;
+			}
+			return Fill (dataTable, command.ExecuteReader (commandBehavior));
 		}
 
 		public int Fill (DataSet dataSet, int startRecord, int maxRecords, string srcTable) 
