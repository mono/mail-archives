<tt>
There&nbsp;are&nbsp;two&nbsp;situations&nbsp;that&nbsp;make&nbsp;sgen&nbsp;slower&nbsp;than&nbsp;boehm. &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;first&nbsp;is&nbsp;a&nbsp;non-generational&nbsp;workload.&nbsp;If&nbsp;your survivor&nbsp;rate&nbsp;is&nbsp;too&nbsp;high,&nbsp;a&nbsp;generational&nbsp;collector&lt;/div&gt;&lt;div&gt;can&#39;t&nbsp;compete&nbsp;with&nbsp;single&nbsp;space&nbsp;one&nbsp;like&nbsp;boehm.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;second&nbsp;one&nbsp;is&nbsp;if&nbsp;you&nbsp;have&nbsp;too&nbsp;much&nbsp;of&nbsp;the&nbsp;old&nbsp;generation&nbsp;pointing&nbsp;to&nbsp;young&nbsp;objects&nbsp;causing&nbsp;minor&nbsp;collections&lt;/div&gt;&lt;div&gt;to&nbsp;scan&nbsp;way&nbsp;too&nbsp;much&nbsp;memory&nbsp;to&nbsp;be&nbsp;profitable.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;nursery&nbsp;size&nbsp;should&nbsp;usually&nbsp;be&nbsp;a&nbsp;not&nbsp;so&nbsp;small&nbsp;fraction&nbsp;of&nbsp;the&nbsp;total&nbsp;heap&nbsp;you&nbsp;expect.&nbsp;As&nbsp;a&nbsp;good&nbsp;guess&nbsp;you&nbsp;can&nbsp;use&lt;/div&gt;<br>
&lt;div&gt;1/10&nbsp;-&nbsp;1/20.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Are&nbsp;you&nbsp;expecting&nbsp;to&nbsp;have&nbsp;a&nbsp;heap&nbsp;of&nbsp;multiple&nbsp;Gigs?&nbsp;Because&nbsp;a&nbsp;2Gb&nbsp;nursery&nbsp;will&nbsp;need&nbsp;at&nbsp;least&nbsp;8Gb&nbsp;of&nbsp;major&nbsp;memory.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;About&nbsp;your&nbsp;crash.&nbsp;I&nbsp;just&nbsp;noticed&nbsp;a&nbsp;very&nbsp;silly&nbsp;thing,&nbsp;we&nbsp;have&nbsp;never&nbsp;ever&nbsp;tried&nbsp;sgen&nbsp;with&nbsp;huge&nbsp;nurseries&nbsp;because&nbsp;there&#39;s&nbsp;a &lt;/div&gt;<br>
&lt;div&gt;128Mb&nbsp;implicit&nbsp;limit&nbsp;due&nbsp;to&nbsp;some&nbsp;internal&nbsp;sizes.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jonathan,&nbsp;for&nbsp;such&nbsp;huge&nbsp;heaps,&nbsp;sgen&nbsp;will&nbsp;need&nbsp;the&nbsp;parallel&nbsp;collector&nbsp;to&nbsp;compete&nbsp;with&nbsp;boehm&nbsp;on&nbsp;linux,&nbsp;which&nbsp;is&nbsp;a&nbsp;not&lt;/div&gt;&lt;div&gt;very&nbsp;mature&nbsp;piece&nbsp;of&nbsp;code&nbsp;both&nbsp;in&nbsp;stability&nbsp;and&nbsp;performance.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Aug&nbsp;31,&nbsp;2012&nbsp;at&nbsp;2:03&nbsp;PM,&nbsp;Jonathan&nbsp;Shore&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:jonathan.shore@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jonathan.shore@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:break-word&quot;&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;HI,&lt;/font&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;sgen&nbsp;is&nbsp;now&nbsp;working&nbsp;for&nbsp;me&nbsp;(thanks&nbsp;to&nbsp;a&nbsp;subtle&nbsp;bug&nbsp;fix&nbsp;for&nbsp;thread-local-storage&nbsp;by&nbsp;Zoltan).&nbsp; &nbsp;However,&nbsp;for&nbsp;one&nbsp;application,&nbsp;&lt;b&gt;sgen&nbsp;is&nbsp;25%&nbsp;slower&lt;/b&gt;&nbsp;than&nbsp;the&nbsp;same&nbsp;with&nbsp;the&nbsp;boehm&nbsp;collector.&nbsp; &nbsp;I&nbsp;am&nbsp;processing&nbsp;some&nbsp;GBs&nbsp;of&nbsp;timeseries&nbsp;data,&nbsp;though&nbsp;only&nbsp;evaluating&nbsp;a&nbsp;window&nbsp;at&nbsp;a&nbsp;time.&nbsp; &nbsp;As&nbsp;the&nbsp;window&nbsp;reaches&nbsp;some&nbsp;size,&nbsp;older&nbsp;objects&nbsp;in&nbsp;the&nbsp;timeseries&nbsp;are&nbsp;dereferenced.&nbsp; &nbsp;The&nbsp;object&nbsp;size&nbsp;is&nbsp;88bytes,&nbsp;but&nbsp;generate&nbsp;many&nbsp;millions&nbsp;across&nbsp;the&nbsp;course&nbsp;of&nbsp;a&nbsp;run.&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;I&nbsp;suspect&nbsp;that&nbsp;the&nbsp;nursery&nbsp;is&nbsp;too&nbsp;small,&nbsp;so&nbsp;that&nbsp;the&nbsp;objects&nbsp;I&nbsp;want&nbsp;to&nbsp;collect&nbsp;are&nbsp;now&nbsp;in&nbsp;the&nbsp;main&nbsp;heap.&nbsp; &nbsp; Towards&nbsp;that&nbsp;end&nbsp;I&nbsp;wanted&nbsp;to&nbsp;extend&nbsp;the&nbsp;nursery,&nbsp;and&nbsp;attempted&nbsp;this:&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;export &lt;span&nbsp;style=&quot;color:rgb(51,51,51);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(248,248,248);display:inline!important;float:none&quot;&gt;MONO_GC_PARAMS=&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(51,51,51);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(248,248,248);display:inline!important;float:none&quot;&gt;nursery-size=2g&quot;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(51,51,51);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(248,248,248);display:inline!important;float:none&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(51,51,51);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(248,248,248);display:inline!important;float:none&quot;&gt;This&nbsp;causes&nbsp;mono&nbsp;to&nbsp;crash&nbsp;immediately,&nbsp;with:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(51,51,51);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(248,248,248);display:inline!important;float:none&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(51,51,51);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(248,248,248);display:inline!important;float:none&quot;&gt;&lt;div&gt;<br>
&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;*&nbsp;Assertion&nbsp;at&nbsp;sgen-gc.c:1206,&nbsp;condition&nbsp;`idx&nbsp;&lt;&nbsp;section-&gt;num_scan_start&#39;&nbsp;not&nbsp;met&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;(this&nbsp;is&nbsp;on&nbsp;linux&nbsp;with&nbsp;the&nbsp;latest&nbsp;code&nbsp;on&nbsp;master,&nbsp;roughly&nbsp;2.11.3+)&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;took&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;code,&nbsp;but&nbsp;requires&nbsp;too&nbsp;much&nbsp;context&nbsp;for&nbsp;me&nbsp;to&nbsp;understand&nbsp;the&nbsp;real&nbsp;cause&nbsp;of&nbsp;the&nbsp;issue.&nbsp; &nbsp;I&nbsp;am&nbsp;guessing&nbsp;that&nbsp;there&nbsp;is&nbsp;some&nbsp;assumption&nbsp;re:&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;nursery,&nbsp;block&nbsp;size,&nbsp;etc.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Finally,&nbsp;I&nbsp;am&nbsp;interested&nbsp;in&nbsp;trying&nbsp;the&nbsp;&quot;copying&nbsp;collector&quot;&nbsp;as&nbsp;discussed&nbsp;in&nbsp;this&nbsp;blog&nbsp;entry: &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://schani.wordpress.com/2011/01/10/sgen-the-major-collectors/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://schani.wordpress.com/2011/01/10/sgen-the-major-collectors/&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;wondering&nbsp;if&nbsp;will&nbsp;get&nbsp;some&nbsp;performance&nbsp;advantages&nbsp;with&nbsp;this&nbsp;approach,&nbsp;whereas&nbsp;the&nbsp;nursery&nbsp;may&nbsp;be&nbsp;too&nbsp;small&nbsp;for&nbsp;my&nbsp;garbage&nbsp;working&nbsp;set.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ideas?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;div&gt;Jonathan&lt;/div&gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(51,51,51);font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(248,248,248);display:inline!important;float:none&quot;&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;4&quot;&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;text-align:left&quot;&gt;&lt;font&nbsp;color=&quot;#333333&quot;&nbsp;face=&quot;Consolas,&nbsp;Courier,&nbsp;&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&nbsp;monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-size:16px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
