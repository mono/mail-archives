<tt>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;http-equiv=Content-Type&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;content=&quot;MSHTML&nbsp;6.00.2900.2149&quot;&nbsp;name=GENERATOR&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;style=&quot;MARGIN:&nbsp;4px&nbsp;4px&nbsp;1px;&nbsp;FONT:&nbsp;10pt&nbsp;Tahoma&quot;&gt;<br>
&lt;DIV&gt;I'm&nbsp;not&nbsp;really&nbsp;embedding&nbsp;mono&nbsp;in&nbsp;my&nbsp;C/C++&nbsp;application.&nbsp;Rather,&nbsp;I'm&nbsp;using&nbsp;mono&nbsp;and&nbsp;p/invoke&nbsp;to&nbsp;access&nbsp;some&nbsp;native&nbsp;code&nbsp;that&nbsp;I&nbsp;already&nbsp;have.&nbsp;I&nbsp;could&nbsp;add&nbsp;a&nbsp;call&nbsp;to&nbsp;mono_thread_attach()&nbsp;but&nbsp;that&nbsp;would&nbsp;mean&nbsp;that&nbsp;my&nbsp;native&nbsp;api&nbsp;that&nbsp;previously&nbsp;had&nbsp;no&nbsp;dependancy&nbsp;on&nbsp;mono&nbsp;would&nbsp;need&nbsp;to&nbsp;be&nbsp;linked&nbsp;to&nbsp;it.&nbsp;When&nbsp;the&nbsp;delegate&nbsp;gets&nbsp;marshalled&nbsp;to&nbsp;a&nbsp;fucntion&nbsp;pointer&nbsp;a&nbsp;bunch&nbsp;of&nbsp;native&nbsp;code&nbsp;gets&nbsp;generated.&nbsp;It&nbsp;seems&nbsp;like&nbsp;the&nbsp;call&nbsp;to&nbsp;mono_thread_attach()&nbsp;should&nbsp;be&nbsp;embedded&nbsp;somewhere&nbsp;in&nbsp;that&nbsp;code.&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;I&nbsp;haven't&nbsp;had&nbsp;a&nbsp;chance&nbsp;yet&nbsp;to&nbsp;build&nbsp;my&nbsp;app&nbsp;under&nbsp;windows&nbsp;yet&nbsp;(that&nbsp;comes&nbsp;later)...&nbsp;does&nbsp;anyone&nbsp;know&nbsp;whether&nbsp;or&nbsp;not&nbsp;I&nbsp;will&nbsp;have&nbsp;similar&nbsp;problems&nbsp;in&nbsp;Windows?&nbsp;Do&nbsp;you&nbsp;have&nbsp;to&nbsp;do&nbsp;something&nbsp;special&nbsp;before&nbsp;calling&nbsp;a&nbsp;marshalled&nbsp;delegate&nbsp;on&nbsp;a&nbsp;different&nbsp;thread&nbsp;or&nbsp;does&nbsp;it&nbsp;just&nbsp;work?&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Thanks,&lt;/DIV&gt;<br>
&lt;DIV&gt;Dan&lt;BR&gt;&lt;BR&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Zoltan&nbsp;Varga&nbsp;&amp;lt;vargaz@gmail.com&amp;gt;&nbsp;7/20/2004&nbsp;12:11:01&nbsp;PM&nbsp;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;style=&quot;COLOR:&nbsp;#000000&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Hi,&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&nbsp;The&nbsp;function&nbsp;is&nbsp;called&nbsp;mono_thread_attach&nbsp;().&nbsp;For&nbsp;more&nbsp;info&nbsp;on&nbsp;the&lt;BR&gt;mono&nbsp;embedding&lt;BR&gt;interfaces:&lt;BR&gt;&lt;BR&gt;&lt;A&nbsp;href=&quot;http://www.mono-project.com/using/embedded-api.html&quot;&gt;http://www.mono-project.com/using/embedded-api.html&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Zoltan&lt;BR&gt;&lt;BR&gt;-----&nbsp;Original&nbsp;Message&nbsp;-----&lt;BR&gt;From:&nbsp;Daniel&nbsp;L.&nbsp;Christensen&nbsp;&amp;lt;dachristensen@gw.novell.com&amp;gt;&lt;BR&gt;Date:&nbsp;Wed,&nbsp;14&nbsp;Jul&nbsp;2004&nbsp;12:03:16&nbsp;-0600&lt;BR&gt;Subject:&nbsp;[Mono-devel-list]&nbsp;Calling&nbsp;C#&nbsp;delegate&nbsp;from&nbsp;native&nbsp;code&nbsp;on&nbsp;a&lt;BR&gt;different&nbsp;thread.&lt;BR&gt;To:&nbsp;mono-devel-list@lists.ximian.com&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;wrap&nbsp;a&nbsp;native&nbsp;C++&nbsp;API&nbsp;with&nbsp;C#.&nbsp;I've&nbsp;run&nbsp;into&nbsp;a&lt;BR&gt;spot&nbsp;where&nbsp;the&nbsp;C#&nbsp;object&nbsp;needs&nbsp;to&nbsp;register&nbsp;for&nbsp;an&nbsp;event&nbsp;that&nbsp;occurs&nbsp;on&lt;BR&gt;the&nbsp;native&nbsp;C++&nbsp;object.&nbsp;So&nbsp;I&nbsp;pass&nbsp;down&nbsp;a&nbsp;delegate&nbsp;which&nbsp;gets&nbsp;converted&lt;BR&gt;to&nbsp;a&nbsp;function&nbsp;pointer&nbsp;on&nbsp;the&nbsp;native&nbsp;side,&nbsp;wrap&nbsp;the&nbsp;funciton&nbsp;pointers&lt;BR&gt;with&nbsp;an&nbsp;event&nbsp;handler&nbsp;object&nbsp;and&nbsp;register&nbsp;the&nbsp;event&nbsp;handler&nbsp;object&lt;BR&gt;with&nbsp;the&nbsp;native&nbsp;C++&nbsp;object.&nbsp;Certain&nbsp;actions&nbsp;performed&nbsp;by&nbsp;the&nbsp;C++&lt;BR&gt;object&nbsp;happen&nbsp;asynchronously&nbsp;(i.e.&nbsp;on&nbsp;another&nbsp;thread&nbsp;that&nbsp;mono&nbsp;doesn't&lt;BR&gt;know&nbsp;about).&nbsp;When&nbsp;the&nbsp;action&nbsp;completes&nbsp;(or&nbsp;is&nbsp;in&nbsp;progress)&nbsp;it&lt;BR&gt;generates&nbsp;a&nbsp;native&nbsp;event.&nbsp;The&nbsp;native&nbsp;object&nbsp;calls&nbsp;back&nbsp;on&nbsp;the&nbsp;event&lt;BR&gt;handler&nbsp;which&nbsp;in&nbsp;turn&nbsp;tries&nbsp;to&nbsp;call&nbsp;back&nbsp;up&nbsp;into&nbsp;the&nbsp;C#&nbsp;code&nbsp;using&nbsp;the&lt;BR&gt;function&nbsp;pointer&nbsp;that&nbsp;was&nbsp;created&nbsp;from&nbsp;the&nbsp;delegate.&nbsp;When&nbsp;this&nbsp;happens&lt;BR&gt;I&nbsp;get&nbsp;the&nbsp;following&nbsp;error:&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;**&nbsp;ERROR&nbsp;**:&nbsp;file&nbsp;mini.c:&nbsp;line&nbsp;6508&nbsp;(mono_get_lmf_addr):&nbsp;should&lt;BR&gt;not&nbsp;be&nbsp;reached&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;aborting...&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;I&nbsp;imagine&nbsp;that&nbsp;the&nbsp;problem&nbsp;is&nbsp;that&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;communicate&nbsp;to&lt;BR&gt;the&nbsp;mono&nbsp;vm&nbsp;from&nbsp;a&nbsp;thread&nbsp;that&nbsp;is&nbsp;not&nbsp;attached&nbsp;to&nbsp;it.&nbsp;When&nbsp;attempting&lt;BR&gt;a&nbsp;similar&nbsp;operation&nbsp;in&nbsp;Java/JNI,&nbsp;you&nbsp;are&nbsp;required&nbsp;to&nbsp;attach&nbsp;the&nbsp;JVM&nbsp;to&lt;BR&gt;the&nbsp;native&nbsp;thread&nbsp;before&nbsp;trying&nbsp;to&nbsp;call&nbsp;up&nbsp;into&nbsp;java.&nbsp;Does&nbsp;mono&nbsp;have&nbsp;a&lt;BR&gt;similar&nbsp;convention?&nbsp;How&nbsp;is&nbsp;this&nbsp;accomplished?&nbsp;Or,&nbsp;is&nbsp;there&nbsp;a&nbsp;better&lt;BR&gt;way&nbsp;to&nbsp;accomplish&nbsp;this&nbsp;using&nbsp;mono?&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Thanks,&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Dan&nbsp;Christensen&lt;BR&gt;_______________________________________________&lt;BR&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;BR&gt;Mono-devel-list@lists.ximian.com&lt;BR&gt;&lt;A&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/A&gt;&lt;BR&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
