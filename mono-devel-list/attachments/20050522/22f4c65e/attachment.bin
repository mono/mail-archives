
using System;
using System.Threading;
using System.Diagnostics;


public class
TestProcess
{
	public static void TestUseShellFalse ()
	{
		Process proc = new Process ();

		proc.StartInfo.FileName = "exampleScript";
		proc.StartInfo.Arguments = "argument with spaces";
		proc.StartInfo.RedirectStandardOutput = true;
		proc.StartInfo.UseShellExecute = false;
		proc.Start ();

		while (proc.HasExited == false)
			Thread.Sleep (1000);

		Console.WriteLine ("TestUseShellFalse: {0}", proc.ExitCode == 0);
	}

	public static void TestUseShellTrue ()
	{
		Process proc = new Process ();

		proc.StartInfo.FileName = "/tmp/exampleScript";
		proc.StartInfo.Arguments = "argument with spaces";

		// In case UseShellExecute is true, we cannot redirect the standard
		// output.
		proc.StartInfo.RedirectStandardOutput = false;
		proc.StartInfo.UseShellExecute = true;
		proc.Start ();

		while (proc.HasExited == false)
			Thread.Sleep (1000);

		Console.WriteLine ("TestUseShellTrue: {0}", proc.ExitCode == 0);
	}

	public static void Main (string[] args)
	{
		TestUseShellFalse ();
		TestUseShellTrue ();
	}
}

