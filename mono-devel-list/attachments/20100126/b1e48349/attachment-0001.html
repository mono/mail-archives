<tt>
Tom,&lt;div&gt;  &nbsp; &nbsp; I&nbsp;don&amp;#39;t&nbsp;think&nbsp;domains&nbsp;were&nbsp;completely&nbsp;taken&nbsp;into&nbsp;account&nbsp;when&nbsp;the&nbsp;COM&nbsp;Interop&nbsp;code&nbsp;was&nbsp;written.&nbsp;This&nbsp;will&nbsp;probably&nbsp;need&nbsp;looked&nbsp;into.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Jonathan&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;Tue,&nbsp;Jan&nbsp;26,&nbsp;2010&nbsp;at&nbsp;11:35&nbsp;AM,&nbsp;tom&nbsp;hindle&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:tom_hindle@sil.org&quot;&gt;tom_hindle@sil.org&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
It&nbsp;looks&nbsp;like&nbsp;a&nbsp;domain&nbsp;issue:&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;wrapped&nbsp;my&nbsp;test&nbsp;code&nbsp;in:&lt;br&gt;<br>
&lt;br&gt;<br>
AppDomain&nbsp;domain&nbsp;=&nbsp;AppDomain.CreateDomain(&amp;quot;MyDomain&amp;quot;);&lt;br&gt;<br>
domain.ExecuteAssembly(&amp;quot;GCTestLib.exe&amp;quot;);&lt;br&gt;<br>
AppDomain.Unload(domain);&lt;br&gt;<br>
&lt;br&gt;<br>
and&nbsp;as&nbsp;segv&nbsp;is&nbsp;produced&nbsp;because&nbsp;the&nbsp;ccw&nbsp;are&nbsp;freed&nbsp;before&lt;br&gt;<br>
cominterop_release_all_rcws&nbsp;is&nbsp;called.&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Tue,&nbsp;2010-01-26&nbsp;at&nbsp;09:14&nbsp;-0700,&nbsp;tom&nbsp;hindle&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Bill,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Change&nbsp;(121114)&nbsp;cominterop_release_all_rcws&nbsp;is&nbsp;still&nbsp;in&nbsp;and&nbsp;functioning&lt;br&gt;<br>
&amp;gt;&nbsp;ok.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;However&nbsp;the&nbsp;problem&nbsp;I&nbsp;am&nbsp;seeing&nbsp;seems&nbsp;to&nbsp;happen&nbsp;before&lt;br&gt;<br>
&amp;gt;&nbsp;cominterop_release_all_rcws&nbsp;is&nbsp;called&nbsp;from&nbsp;mini_cleanup.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;ccws&nbsp;are&nbsp;being&nbsp;freed&nbsp;from&nbsp;the&nbsp;finalize_domain_objects&nbsp;function:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;#2&nbsp;0x00000000004dcf2e&nbsp;in&nbsp;mono_marshal_free_ccw&nbsp;(object=0x7ffff4450700)&lt;br&gt;<br>
&amp;gt;&nbsp;at&nbsp;cominterop.c:2067&lt;br&gt;<br>
&amp;gt;&nbsp;#3&nbsp;0x00000000004da310&nbsp;in&nbsp;mono_gc_run_finalize&nbsp;(obj=&amp;lt;value&nbsp;optimized&lt;br&gt;<br>
&amp;gt;&nbsp;out&amp;gt;,&nbsp;data=&amp;lt;value&nbsp;optimized&nbsp;out&amp;gt;)&nbsp;at&nbsp;gc.c:197&lt;br&gt;<br>
&amp;gt;&nbsp;#4&nbsp;0x00000000004da4c7&nbsp;in&nbsp;finalize_domain_objects&nbsp;(unused=&amp;lt;value&lt;br&gt;<br>
&amp;gt;&nbsp;optimized&nbsp;out&amp;gt;)&nbsp;at&nbsp;gc.c:984&lt;br&gt;<br>
&amp;gt;&nbsp;#5&nbsp;finalizer_thread&nbsp;(unused=&amp;lt;value&nbsp;optimized&nbsp;out&amp;gt;)&nbsp;at&nbsp;gc.c:1039&lt;br&gt;<br>
&amp;gt;&nbsp;#6&nbsp;0x0000000000500c46&nbsp;in&nbsp;start_wrapper&nbsp;(data=&amp;lt;value&nbsp;optimized&nbsp;out&amp;gt;)&nbsp;at&lt;br&gt;<br>
&amp;gt;&nbsp;threads.c:721&lt;br&gt;<br>
&amp;gt;&nbsp;#7&nbsp;0x000000000059afb3&nbsp;in&nbsp;thread_start_routine&nbsp;(args=0x987a50)&nbsp;at&lt;br&gt;<br>
&amp;gt;&nbsp;wthreads.c:286&lt;br&gt;<br>
&amp;gt;&nbsp;#8&nbsp;0x00000000005c0d0f&nbsp;in&nbsp;GC_start_routine&nbsp;(arg=0x7ffff7e88e70)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;before&nbsp;cominterop_release_all_rcws&nbsp;is&nbsp;called.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Also&nbsp;I&nbsp;can&nbsp;only&nbsp;seem&nbsp;to&nbsp;reproduce&nbsp;the&nbsp;fault&nbsp;in&nbsp;a&nbsp;NUnit&nbsp;test.&nbsp;The&lt;br&gt;<br>
&amp;gt;&nbsp;identical&nbsp;code&nbsp;in&nbsp;a&nbsp;main&nbsp;block&nbsp;doesn&amp;#39;t&nbsp;seem&nbsp;to&nbsp;show&nbsp;the&nbsp;error.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;wondering&nbsp;if&nbsp;it&nbsp;has&nbsp;anything&nbsp;to&nbsp;do&nbsp;with&nbsp;Application&nbsp;domain&amp;#39;s?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Thanks,&lt;br&gt;<br>
&amp;gt;&nbsp;Tom&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;On&nbsp;Sat,&nbsp;2010-01-23&nbsp;at&nbsp;12:48&nbsp;-0500,&nbsp;Bill&nbsp;Holmes&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;Tom,&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;I&nbsp;beleive&nbsp;that&nbsp;we&nbsp;had&nbsp;a&nbsp;problem&nbsp;with&nbsp;this&nbsp;before&nbsp;and&nbsp;I&nbsp;applied&nbsp;a&nbsp;fix.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://anonsvn.mono-project.com/viewvc?view=revision&amp;amp;revision=121114&quot;&nbsp;target=&quot;_blank&quot;&gt;http://anonsvn.mono-project.com/viewvc?view=revision&amp;amp;revision=121114&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;IIRC&nbsp;this&nbsp;code/fix&nbsp;should&nbsp;release&nbsp;all&nbsp;outstanding&nbsp;rcws&nbsp;before&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;final&nbsp;collect&nbsp;of&nbsp;other&nbsp;mono&nbsp;objects,&nbsp;including&nbsp;ccws.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;Can&nbsp;you&nbsp;investigate&nbsp;if&nbsp;this&nbsp;change&nbsp;(121114)&nbsp;has&nbsp;been&nbsp;broken,&nbsp;or&nbsp;needs&nbsp;enhanced?&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;-bill&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;On&nbsp;Fri,&nbsp;Jan&nbsp;22,&nbsp;2010&nbsp;at&nbsp;8:26&nbsp;PM,&nbsp;tom&nbsp;hindle&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:tom_hindle@sil.org&quot;&gt;tom_hindle@sil.org&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;I&nbsp;have&nbsp;added&nbsp;a&nbsp;check&nbsp;in&nbsp;mono_gc_run_finalize&nbsp;(void&nbsp;*obj,&nbsp;void&nbsp;*data)&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;(gc.c):&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;---&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;if&nbsp;(suspend_finalizers)&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;+&nbsp;if&nbsp;(mono_marshal_ccw_refcount(o)&nbsp;&amp;gt;&nbsp;0)&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;+&nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;+&nbsp; return;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;+&nbsp;}&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;domain&nbsp;=&nbsp;o-&amp;gt;vtable-&amp;gt;domain;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;----&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;This&nbsp;seems&nbsp;to&nbsp;solve&nbsp;the&nbsp;problem.&nbsp;The&nbsp;ccw&nbsp;isn&amp;#39;t&nbsp;freed,&nbsp;which&nbsp;means&nbsp;when&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;the&nbsp;rcw&nbsp;releases&nbsp;its&nbsp;reference&nbsp;to&nbsp;the&nbsp;ccw,&nbsp;so&nbsp;it&nbsp;no&nbsp;longer&nbsp;segv&amp;#39;s.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Does&nbsp;this&nbsp;seem&nbsp;like&nbsp;an&nbsp;valid&nbsp;approach?&nbsp;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;If&nbsp;this&nbsp;means&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;finalize_domain_objects&nbsp;needs&nbsp;to&nbsp;make&nbsp;multiple&nbsp;passes&nbsp;at&nbsp;freeing&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;ccw&amp;#39;s?&nbsp;I&nbsp;guess&nbsp;this&nbsp;change&nbsp;would&nbsp;also&nbsp;mean&nbsp;the&nbsp;badly&nbsp;written&nbsp;native&nbsp;COM&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;objects&nbsp;would&nbsp;prevent&nbsp;ccw&nbsp;from&nbsp;being&nbsp;freed.&nbsp;Is&nbsp;this&nbsp;a&nbsp;problem?&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Thanks&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Tom&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;On&nbsp;Fri,&nbsp;2010-01-22&nbsp;at&nbsp;16:16&nbsp;-0700,&nbsp;tom&nbsp;hindle&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Hi&nbsp;all,&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;I&nbsp;have&nbsp;been&nbsp;investigating&nbsp;some&nbsp;seemingly&nbsp;random&nbsp;crash&nbsp;on&nbsp;exit&nbsp;problems&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;that&nbsp;our&nbsp;application&nbsp;has&nbsp;been&nbsp;having.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;I&nbsp;have&nbsp;managed&nbsp;mostly&nbsp;reliably&nbsp;to&nbsp;reproduce&nbsp;the&nbsp;issue&nbsp;by&nbsp;following&nbsp;this&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;set&nbsp;of&nbsp;steps:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;1.&nbsp;Create&nbsp;a&nbsp;managed&nbsp;object&nbsp;ManagedObj&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;2.&nbsp;Create&nbsp;a&nbsp;COM&nbsp;object&nbsp;COMObj&nbsp;for&nbsp;which&nbsp;its&nbsp;rcw&nbsp;is&nbsp;likely&nbsp;to&nbsp;be&nbsp;Garbage&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;collected&nbsp;after&nbsp;ManagedObj&nbsp;and&nbsp;during&nbsp;mono&nbsp;shutdown.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;3.&nbsp;Make&nbsp;COMObj&nbsp;contain&nbsp;a&nbsp;ref&nbsp;to&nbsp;ManagedObj&amp;#39;s&nbsp;ccw&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;4.&nbsp;Set&nbsp;ManagedObj&nbsp;ref&nbsp;to&nbsp;null&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;5.&nbsp;Call&nbsp;GC.Collect()&nbsp;to&nbsp;encourage&nbsp;GC.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;If&nbsp;Garbage&nbsp;Collection&nbsp;of&nbsp;COMObj&amp;#39;s&nbsp;rcw&nbsp;happens&nbsp;after&nbsp;the&nbsp;Garbage&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Collection&nbsp;of&nbsp;ManagedObj&amp;#39;s&nbsp;ccw,&nbsp;then&nbsp;when&nbsp;COMObj&nbsp;calls&nbsp;Release&nbsp;on&nbsp;its&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;ref&nbsp;to&nbsp;ManagedObj&amp;#39;s&nbsp;ccw&nbsp;a&nbsp;segv&nbsp;is&nbsp;produced.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Normally&nbsp;it&nbsp;seems&nbsp;that&nbsp;ref&nbsp;counts&nbsp;for&nbsp;the&nbsp;wrappers&nbsp;are&nbsp;respected,&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;however&nbsp;this&nbsp;doesn&amp;#39;t&nbsp;seem&nbsp;to&nbsp;be&nbsp;the&nbsp;case&nbsp;on&nbsp;program&nbsp;shutdown.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Some&nbsp;pseudo&nbsp;code&nbsp;which&nbsp;reproduces&nbsp;the&nbsp;problem:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;public&nbsp;class&nbsp;TestComRelease&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;static&nbsp;COMObj&nbsp;cObj;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;[Test]&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;public&nbsp;void&nbsp;Test()&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;{&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp; ManagedObj&nbsp;mObj&nbsp;=&nbsp;new&nbsp;ManagedObj()&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp; cObj&nbsp;=&nbsp;new&nbsp;COMObj();&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp; cObj.SetManagedRef(mObj);&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp; mObj&nbsp;=&nbsp;null;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp; GC.Collect();&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;}&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;}&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;I&nbsp;am&nbsp;attempting&nbsp;to&nbsp;find&nbsp;the&nbsp;cause&nbsp;of&nbsp;this&nbsp;in&nbsp;mono.&nbsp;Any&nbsp;pointers&nbsp;would&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;grateful&nbsp;received.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Thanks&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Tom&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.ximian.com/mailman/listinfo/mono-devel-list&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
