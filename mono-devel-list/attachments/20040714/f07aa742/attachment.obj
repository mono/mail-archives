Index: ApplicationServer.cs
===================================================================
RCS file: /mono/xsp/server/ApplicationServer.cs,v
retrieving revision 1.2
diff -r1.2 ApplicationServer.cs
75c75
< 		ArrayList vpathToHost = new ArrayList ();
---
> 		ArrayList vpathToHosts = new ArrayList ();
89c89
< 			// TODO - check for duplicates, sort, optimize, etc.
---
> 			// TODO - sort, optimize, etc.
91a92,105
> 				
> 			VPathToHost vpathToHost = new VPathToHost (vhost, vport, vpath, fullPath); 
> 				
> 			// Check for duplicates.
> 			foreach (VPathToHost v in vpathToHosts) {
> 				if (v.vhost == vhost && v.vport == vport && v.vpath == vpath) {
> 					StringBuilder error = new StringBuilder();
> 					error.Append ("An application is already configured for ");
> 					error.AppendFormat ("Host: {0}, ", (vhost != null) ? vhost : "any");
> 					error.AppendFormat ("Port: {0}, ", (vport != -1) ? vport.ToString () : "any");
> 					error.AppendFormat ("Virtual Path: {0}", vpath);
> 					throw new InvalidOperationException (error.ToString ());
> 				}
> 			} 
103c117
< 			vpathToHost.Add (new VPathToHost (vhost, vport, vpath, fullPath));
---
> 			vpathToHosts.Add (vpathToHost);
227c241
<  			if (vpathToHost == null)
---
>  			if (vpathToHosts == null)
230c244
<  			if (vpathToHost.Count == 0)
---
>  			if (vpathToHosts.Count == 0)
250,251c264,265
< 			lock (vpathToHost) {
< 				foreach (VPathToHost v in vpathToHost) {
---
> 			lock (vpathToHosts) {
> 				foreach (VPathToHost v in vpathToHosts) {
280,281c294,295
< 			for (int i = vpathToHost.Count - 1; i >= 0; i--) {
< 				VPathToHost v = (VPathToHost) vpathToHost [i];
---
> 			for (int i = vpathToHosts.Count - 1; i >= 0; i--) {
> 				VPathToHost v = (VPathToHost) vpathToHosts [i];