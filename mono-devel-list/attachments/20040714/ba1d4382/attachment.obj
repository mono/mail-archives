Index: Thread.cs
===================================================================
RCS file: /mono/mcs/class/corlib/System.Threading/Thread.cs,v
retrieving revision 1.54
diff -u -r1.54 Thread.cs
--- Thread.cs	15 Jun 2004 17:55:07 -0000	1.54
+++ Thread.cs	15 Jul 2004 00:58:25 -0000
@@ -210,15 +210,18 @@
 		public extern static int GetDomainID();
 
 		public static LocalDataStoreSlot GetNamedDataSlot(string name) {
-			if (datastorehash == null)
-				InitDataStoreHash ();
-			LocalDataStoreSlot slot=(LocalDataStoreSlot)datastorehash[name];
+			lock(typeof(Thread))
+			{
+				if (datastorehash == null)
+					InitDataStoreHash ();
+				LocalDataStoreSlot slot=(LocalDataStoreSlot)datastorehash[name];
 
-			if(slot==null) {
-				slot=AllocateNamedDataSlot(name);
-			}
+				if(slot==null) {
+					slot=AllocateNamedDataSlot(name);
+				}
 			
-			return(slot);
+				return(slot);
+			}
 		}
 		
 		[MethodImplAttribute(MethodImplOptions.InternalCall)]
