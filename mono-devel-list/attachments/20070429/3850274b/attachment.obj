Index: mono/mini/aot-runtime.c 
*** mono/mini/aot-runtime.c	2007-01-25 07:11:23.000000000 +0100
--- mono/mini/aot-runtime.c	2007-04-15 16:26:17.000000000 +0200
***************
*** 62,67 ****
--- 62,68 ----
  #define ALIGN_PTR_TO(ptr,align) (gpointer)((((gssize)(ptr)) + (align - 1)) & (~(align - 1)))
  #define ROUND_DOWN(VALUE,SIZE)	((VALUE) & ~((SIZE) - 1))
  
+ #endif
  typedef struct MonoAotModule {
  	char *aot_name;
  	/* Optimization flags used to compile the module */
***************
*** 99,104 ****
--- 100,107 ----
  	guint16 *class_name_table;
  } MonoAotModule;
  
+ #ifndef DISABLE_AOT
+ 
  static GHashTable *aot_modules;
  #define mono_aot_lock() EnterCriticalSection (&aot_mutex)
  #define mono_aot_unlock() LeaveCriticalSection (&aot_mutex)
***************
*** 158,163 ****
--- 161,168 ----
  /*                 AOT RUNTIME                       */
  /*****************************************************/
  
+ #endif 
+ 
  static MonoImage *
  load_image (MonoAotModule *module, int index)
  {
***************
*** 187,193 ****
  	return assembly->image;
  }
  
- 
  static inline gint32
  decode_value (guint8 *ptr, guint8 **rptr)
  {
--- 192,197 ----
***************
*** 295,300 ****
--- 299,306 ----
  		return image;
  }
  
+ #ifndef DISABLE_AOT
+ 
  G_GNUC_UNUSED
  static void
  make_writable (guint8* addr, guint32 len)
***************
*** 1043,1048 ****
--- 1049,1056 ----
  	return jinfo;
  }
  
+ #endif
+ 
  static gboolean
  decode_patch_info (MonoAotModule *aot_module, MonoMemPool *mp, MonoJumpInfo *ji, guint8 *buf, guint8 **endbuf, guint32 *got_offset)
  {
***************
*** 1267,1272 ****
--- 1275,1282 ----
  	return FALSE;
  }
  
+ #ifndef DISABLE_AOT
+ 
  static MonoJumpInfo*
  load_patch_info (MonoAotModule *aot_module, MonoMemPool *mp, int n_patches, 
  				 guint32 got_index, guint32 **got_slots, 
***************
*** 1846,1851 ****
--- 1856,1862 ----
  #endif
  }
  
+ #endif
  /*
   * aot_dyn_resolve:
   *
***************
*** 1884,1890 ****
  	return NULL;
  #endif
  }
! 
  /**
   * init_plt:
   *
--- 1895,1901 ----
  	return NULL;
  #endif
  }
! #ifndef DISABLE_AOT
  /**
   * init_plt:
   *
Only mono/mini: aot-runtime.loT
Index: mono/mini/mini-trampolines.c
*** mono/mini/mini-trampolines.c	2006-07-05 23:55:50.000000000 +0200
--- mono/mini/mini-trampolines.c	2007-04-15 16:26:17.000000000 +0200
***************
*** 146,152 ****
  #else
  	guint32 plt_info_offset = -1;
  #endif
- 
  	return mono_aot_plt_resolve (aot_module, plt_info_offset, code);
  }
  #endif
--- 146,151 ----
Index: mono/mini/mini.h 
*** mono/mini/mini.h	2007-01-25 07:11:22.000000000 +0100
--- mono/mini/mini.h	2007-04-15 16:26:17.000000000 +0200
***************
*** 852,859 ****
  void	  mono_print_ins (int i, MonoInst *ins) MONO_INTERNAL;
  
  void      mono_aot_init                     (void) MONO_INTERNAL;
! gpointer  mono_aot_get_method               (MonoDomain *domain,
! 											 MonoMethod *method) MONO_INTERNAL;
  gpointer  mono_aot_get_method_from_token    (MonoDomain *domain, MonoImage *image, guint32 token) MONO_INTERNAL;
  gboolean  mono_aot_is_got_entry             (guint8 *code, guint8 *addr) MONO_INTERNAL;
  guint8*   mono_aot_get_plt_entry            (guint8 *code) MONO_INTERNAL;
--- 852,860 ----
  void	  mono_print_ins (int i, MonoInst *ins) MONO_INTERNAL;
  
  void      mono_aot_init                     (void) MONO_INTERNAL;
! #ifndef DISABLE_AOT
! gpointer  mono_aot_get_method               (MonoDomain *domain, MonoMethod *method) MONO_INTERNAL;
! #endif
  gpointer  mono_aot_get_method_from_token    (MonoDomain *domain, MonoImage *image, guint32 token) MONO_INTERNAL;
  gboolean  mono_aot_is_got_entry             (guint8 *code, guint8 *addr) MONO_INTERNAL;
  guint8*   mono_aot_get_plt_entry            (guint8 *code) MONO_INTERNAL;