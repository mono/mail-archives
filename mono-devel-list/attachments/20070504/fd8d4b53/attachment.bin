using System;
using System.Data;
using System.Data.Odbc;

namespace Test.OdbcTest {
  class OdbcTest {
    // [STAThread]
    static void Main(string[] args)
    {
      // DateTime foo = new DateTime( 2007, 4 , 17, 14, 10, 50, 340 );
      Console.WriteLine( "Creating connection" );
      OdbcConnection dbcon = new OdbcConnection();
      // Setup to an ODBC connection, that goes against a Sybase ASA 9.0.2
      dbcon.ConnectionString = "DSN=madstest;UID=mmw;PWD=mmw";
      Console.WriteLine( "Opening connection" );
      dbcon.Open();
      // PublishedTime is a datetime value in the database
      OdbcCommand dbcmd = new OdbcCommand( "Select PublishedTime from PublishingJob", dbcon );
      Console.WriteLine( "Executing command" );
      OdbcDataReader reader = (OdbcDataReader) dbcmd.ExecuteReader();
      Console.WriteLine( "Reading data" );
      // Check for data.
      while(reader.Read()) {
	// This crashes, if the date in the database has a fractional
	// second value.
	Console.WriteLine("Column 0: " + reader[0].ToString());
      }
      reader.Close();
      dbcmd.Dispose();
      dbcon.Close();
    }
  }
}






