<tt>
The&nbsp;attached&nbsp;fix&nbsp;fixes&nbsp;only&nbsp;the&nbsp;load&nbsp;address&nbsp;issue&nbsp;with&nbsp;constructors,&nbsp;the&nbsp;paragraphs&nbsp;about&nbsp;class&nbsp;constructors&nbsp;said&nbsp;about&nbsp;this&nbsp;fact.&nbsp;I&amp;#39;ll&nbsp;focus&nbsp;on&nbsp;the&nbsp;access&nbsp;checks&nbsp;until&nbsp;we&nbsp;settle&nbsp;down&nbsp;the&nbsp;overlapping&nbsp;field&nbsp;issue.&nbsp;Enjoy&nbsp;your&nbsp;vacations.&nbsp;:)<br>
&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;6/22/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Rodrigo&nbsp;Kumpera&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:kumpera@gmail.com&quot;&gt;kumpera@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;e&quot;&nbsp;id=&quot;q_1135382a6c793e5b_1&quot;&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;6/22/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Paolo&nbsp;Molaro&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:lupus@ximian.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;<br>
lupus@ximian.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;06/21/07&nbsp;Rodrigo&nbsp;Kumpera&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;&amp;gt;This&nbsp;should&nbsp;be&nbsp;allowed&nbsp;in&nbsp;the&nbsp;.cctor&nbsp;for&nbsp;the&nbsp;class&nbsp;(same&nbsp;for&nbsp;the&lt;br&gt;&amp;gt;&nbsp;&amp;gt;equivalent&nbsp;case&nbsp;of&nbsp;an&nbsp;instance&nbsp;field&nbsp;and&nbsp;the&nbsp;.ctor):&nbsp;a&nbsp;test&nbsp;case&nbsp;is&lt;br&gt;&amp;gt;&nbsp;&amp;gt;something&nbsp;like:&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;readonly&nbsp;static&nbsp;MyValueType&nbsp;v&nbsp;=&nbsp;new&nbsp;MyValueType&nbsp;(5);&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;&amp;gt;Note,&nbsp;eventually&nbsp;you&nbsp;also&nbsp;need&nbsp;to&nbsp;add&nbsp;accessibility&nbsp;checks:&nbsp;the&nbsp;method&lt;br&gt;&amp;gt;&nbsp;&amp;gt;needs&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;access&nbsp;the&nbsp;field&nbsp;keeping&nbsp;in&nbsp;mind&nbsp;both&nbsp;the&nbsp;field&amp;#39;s<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;and&nbsp;the&nbsp;field&amp;#39;s&nbsp;class&nbsp;visibility.&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Definely,&nbsp;the&nbsp;spec&nbsp;say&nbsp;nothing&nbsp;about&nbsp;that,&nbsp;I&amp;#39;ll&nbsp;add&nbsp;this&nbsp;check&nbsp;and&nbsp;mark&nbsp;it&lt;br&gt;&lt;br&gt;There&nbsp;are&nbsp;references&nbsp;to&nbsp;this&nbsp;both&nbsp;in&nbsp;the&nbsp;instance&nbsp;constructor&nbsp;and&nbsp;type<br>
&lt;br&gt;initializers&nbsp;paragraphs&nbsp;(and&nbsp;also&nbsp;under&nbsp;Field&nbsp;contract&nbsp;attributes).&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;as&nbsp;a&nbsp;spec&nbsp;issue.&nbsp;About&nbsp;the&nbsp;accessibility&nbsp;checks,&nbsp;I&amp;#39;m&nbsp;going&nbsp;to&nbsp;tackle&nbsp;all&lt;br&gt;&amp;gt;&nbsp;cases&nbsp;at&nbsp;once,&nbsp;as&nbsp;it&nbsp;should&nbsp;quite&nbsp;hairy,&nbsp;I&nbsp;believe.<br>
&lt;br&gt;<br>
&lt;br&gt;There&nbsp;is&nbsp;code&nbsp;to&nbsp;deal&nbsp;with&nbsp;this&nbsp;in&nbsp;mini/mini.c,&nbsp;it&nbsp;is&nbsp;mostly&nbsp;complete&lt;br&gt;(look&nbsp;for&nbsp;can_access_field&nbsp;and&nbsp;can_access_method).&nbsp;Note&nbsp;that&nbsp;such&nbsp;code&lt;br&gt;must&nbsp;not&nbsp;be&nbsp;duplicated,&nbsp;we&nbsp;need&nbsp;to&nbsp;share&nbsp;it&nbsp;for&nbsp;both&nbsp;implementations.<br>
&lt;br&gt;<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;The&nbsp;code&nbsp;for&nbsp;overlapped&nbsp;fields&nbsp;is&nbsp;not&nbsp;as&nbsp;trivial&nbsp;as&nbsp;this.&nbsp;It&nbsp;is&nbsp;moreover&lt;br&gt;&amp;gt;&nbsp;&amp;gt;something&nbsp;you&nbsp;should&nbsp;do&nbsp;on&nbsp;a&nbsp;per-type&nbsp;basis&nbsp;instead&nbsp;of&nbsp;per-field&nbsp;access&lt;br&gt;&amp;gt;&nbsp;&amp;gt;in&nbsp;the&nbsp;IL&nbsp;code.&nbsp;metadata/object.c&nbsp;has&nbsp;the&nbsp;code&nbsp;to&nbsp;do&nbsp;proper&nbsp;overlapping<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;field&nbsp;detection:&nbsp;that&nbsp;code&nbsp;should&nbsp;not&nbsp;be&nbsp;duplicated.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;I&nbsp;don&amp;#39;t&nbsp;quite&nbsp;follow&nbsp;you,&nbsp;I&nbsp;should&nbsp;test&nbsp;it&nbsp;it&amp;#39;s&nbsp;a&nbsp;load/store&nbsp;to&nbsp;a&nbsp;class&nbsp;with&lt;br&gt;&amp;gt;&nbsp;bad&nbsp;overlapping,&nbsp;even&nbsp;if&nbsp;the&nbsp;target&nbsp;is&nbsp;a&nbsp;good&nbsp;field?<br>
&lt;br&gt;&lt;br&gt;The&nbsp;process&nbsp;of&nbsp;verification&nbsp;doesn&amp;#39;t&nbsp;involve&nbsp;just&nbsp;a&nbsp;single&nbsp;method&amp;#39;s&lt;br&gt;code:&nbsp;major&nbsp;things&nbsp;in&nbsp;the&nbsp;assembly&nbsp;containing&nbsp;it&nbsp;must&nbsp;be&nbsp;checked&nbsp;first.&lt;br&gt;verify.c&nbsp;contains&nbsp;quite&nbsp;a&nbsp;bit&nbsp;of&nbsp;those&nbsp;checks,&nbsp;more&nbsp;are&nbsp;needed&nbsp;of&nbsp;course.<br>
&lt;br&gt;Between&nbsp;them&nbsp;there&nbsp;is&nbsp;the&nbsp;field&nbsp;overlapping&nbsp;detection:&nbsp;it&nbsp;is&nbsp;a&nbsp;check&lt;br&gt;that&nbsp;doesn&amp;#39;t&nbsp;belong&nbsp;inside&nbsp;the&nbsp;field&nbsp;access&nbsp;checks,&nbsp;but&nbsp;it&nbsp;belongs&lt;br&gt;to&nbsp;a&nbsp;per-type&nbsp;check&nbsp;that&nbsp;you&nbsp;need&nbsp;to&nbsp;perform&nbsp;anyway.&lt;br&gt;In&nbsp;the&nbsp;field&nbsp;access&nbsp;you&nbsp;need&nbsp;just&nbsp;to&nbsp;check&nbsp;if&nbsp;the&nbsp;type&nbsp;was&nbsp;ok<br>
&lt;br&gt;and&nbsp;the&nbsp;type&nbsp;should&nbsp;have&nbsp;been&nbsp;checked&nbsp;earlier&nbsp;(though&nbsp;it&amp;#39;s&nbsp;reasonable&nbsp;to&lt;br&gt;check&nbsp;it&nbsp;lazily&nbsp;whenever&nbsp;a&nbsp;type&nbsp;is&nbsp;seen,&nbsp;but&nbsp;the&nbsp;full&nbsp;checks&nbsp;for&nbsp;the&lt;br&gt;type&nbsp;are&nbsp;needed,&nbsp;not&nbsp;just&nbsp;about&nbsp;overlapping&nbsp;fields).&nbsp;So&nbsp;you&amp;#39;d&nbsp;have&nbsp;code<br>
&lt;br&gt;like&nbsp;this&nbsp;whenever&nbsp;a&nbsp;type&nbsp;or&nbsp;class&nbsp;is&nbsp;seen:&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&nbsp;(!type_is_ok&nbsp;(type))&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;report&nbsp;verification/validation&nbsp;issues&nbsp;in&nbsp;type&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&lt;br&gt;and&nbsp;inside&nbsp;type_is_ok():<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&nbsp;lazy&nbsp;check&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&nbsp;(!type_has_been_checked&nbsp;(type))&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;check_type&nbsp;(type);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return&nbsp;type_status&nbsp;(type)&nbsp;==&nbsp;ok;&lt;br&gt;&lt;br&gt;With&nbsp;this&nbsp;code&nbsp;field&nbsp;overlapping&nbsp;will&nbsp;just&nbsp;be&nbsp;one&nbsp;of&nbsp;the&nbsp;many&nbsp;checks<br>
&lt;br&gt;performed&nbsp;inside&nbsp;check_type&nbsp;().&lt;/blockquote&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;So&nbsp;the&nbsp;idea&nbsp;is&nbsp;to&nbsp;lazy&nbsp;check&nbsp;all&nbsp;types&nbsp;that&nbsp;a&nbsp;method&nbsp;faces,&nbsp;seen&nbsp;a&nbsp;reasonable&nbsp;approach.&nbsp;About&nbsp;the&nbsp;overlapping&nbsp;tests,&nbsp;I&amp;#39;ve&nbsp;been&nbsp;checking&nbsp;against&nbsp;.net&nbsp;and&nbsp;I&nbsp;got&nbsp;the&nbsp;following&nbsp;results&nbsp;regarding&nbsp;verifiable&nbsp;code:<br>
&lt;br&gt;&lt;br&gt;-can&nbsp;create&nbsp;objects&nbsp;with&nbsp;dangerous&nbsp;overlapping&lt;br&gt;-can&nbsp;load/store&nbsp;from&nbsp;other&nbsp;non-overlapping&nbsp;field&lt;br&gt;-only&nbsp;loading&nbsp;from&nbsp;bad&nbsp;overlapping&nbsp;fields&nbsp;cause&nbsp;verification&nbsp;errors.&lt;br&gt;&lt;br&gt;What&nbsp;you&nbsp;think&nbsp;that&nbsp;should&nbsp;be&nbsp;done&nbsp;on&nbsp;this&nbsp;case?&nbsp;<br>
&lt;br&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;sg&quot;&gt;&lt;br&gt;Rodrigo&lt;/span&gt;&lt;span&nbsp;class=&quot;q&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;lupus&lt;br&gt;&lt;br&gt;--&lt;br&gt;-----------------------------------------------------------------<br>
&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:lupus@debian.org&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;lupus@debian.org&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;debian/rules&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:lupus@ximian.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;<br>
lupus@ximian.com&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Monkeys&nbsp;do&nbsp;it&nbsp;better&lt;br&gt;_______________________________________________<br>
&lt;br&gt;Mono-devel-list&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Mono-devel-list@lists.ximian.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;Mono-devel-list@lists.ximian.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.ximian.com/mailman/listinfo/mono-devel-list&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;<br>
http://lists.ximian.com/mailman/listinfo/mono-devel-list<br>
&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
