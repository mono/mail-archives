Index: acconfig.h
===================================================================
RCS file: /mono/mono/acconfig.h,v
retrieving revision 1.30
diff -p -u -b -r1.30 acconfig.h
--- acconfig.h	29 Jul 2003 16:21:20 -0000	1.30
+++ acconfig.h	31 Jul 2003 08:05:41 -0000
@@ -20,6 +20,7 @@
 #undef HAVE_TIMEZONE
 #undef HAVE_TM_GMTOFF
 #undef MONO_SIZEOF_SUNPATH
+#undef MONO_ZERO_ARRAY_LENGTH
 #undef NEED_LINK_UNLINK
 #undef PTHREAD_POINTER_ID
 #undef HAVE_GC_H
Index: configure.in
===================================================================
RCS file: /mono/mono/configure.in,v
retrieving revision 1.155
diff -p -u -b -r1.155 configure.in
--- configure.in	29 Jul 2003 16:21:19 -0000	1.155
+++ configure.in	31 Jul 2003 08:29:01 -0000
@@ -72,6 +72,14 @@ case "$host" in
 		libdl="-ldl"
 		libgc_threads=pthreads
 		;;
+        *-*-hpux*)
+                platform_win32=no
+                CPPFLAGS="$CPPFLAGS -DGC_HPUX_THREADS -D_HPUX_SOURCE -D_XOPEN_SOURCE_EXTENDED -D_REENTRANT"
+		libmono_cflags="-D_REENTRANT"
+		libmono_ldflags="-lpthread"
+		libgc_threads=pthreads
+		AC_DEFINE(NEED_LINK_UNLINK)
+                ;;
 	*-*-solaris*)
 		platform_win32=no
 		CPPFLAGS="$CPPFLAGS -DGC_SOLARIS_THREADS -DGC_SOLARIS_PTHREADS -D_REENTRANT"
@@ -146,7 +154,11 @@ AC_CHECK_HEADERS(wchar.h)
 # not 64 bit clean in cross-compile
 AC_CHECK_SIZEOF(void *, 4)
 
-CFLAGS='-g -Wall -Wunused -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes  -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wno-cast-qual -Wcast-align -Wwrite-strings'
+WARN=''
+if test x"$GCC" = xyes; then
+        WARN='-Wall -Wunused -Wmissing-prototypes -Wmissing-declarations -Wstrict-prototypes  -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wno-cast-qual -Wcast-align -Wwrite-strings'
+fi
+CFLAGS="-g $WARN"
 
 AC_PATH_PROG(PKG_CONFIG, pkg-config, no)
 if test "x$PKG_CONFIG" = "xno"; then
@@ -464,6 +476,23 @@ if test x$platform_win32 = xno; then
 	AC_MSG_RESULT($cv_mono_sizeof_sunpath)
 	AC_DEFINE_UNQUOTED(MONO_SIZEOF_SUNPATH, $cv_mono_sizeof_sunpath)
 
+	dnl *************************************
+	dnl *** Checks for zero length arrays ***
+	dnl *************************************
+	AC_MSG_CHECKING(whether $CC supports zero length arrays)
+	AC_TRY_COMPILE([
+                struct s {
+                        int  length;
+                        char data [0];
+                };
+        ], [], [
+		AC_MSG_RESULT(yes)
+		AC_DEFINE_UNQUOTED(MONO_ZERO_ARRAY_LENGTH, 0)
+	], [
+		AC_MSG_RESULT(no)
+		AC_DEFINE_UNQUOTED(MONO_ZERO_ARRAY_LENGTH, 1)
+	])
+
 	dnl *****************************
 	dnl *** Checks for libxnet    ***
 	dnl *****************************
@@ -621,16 +650,56 @@ TARGET="unknown"
 ACCESS_UNALIGNED="yes"
 
 JIT_SUPPORTED=no
+LIBC="libc.so.6"
 
 case "$host" in
-#mips-sgi-irix5.* | mips-sgi-irix6.*) TARGET=MIPS; ACCESS_UNALIGNED="no";;
-i*86-*-*) TARGET=X86; arch_target=x86; JIT_SUPPORTED=yes;;
-sparc*-*-*) TARGET=SPARC; arch_target=sparc; ACCESS_UNALIGNED="no";;
-#alpha*-*-linux* | alpha*-*-osf*) TARGET=ALPHA; ACCESS_UNALIGNED="no";;
-#m68k-*-linux*) TARGET=M68K;;
-macppc-*-openbsd* | powerpc-*-linux* | powerpc-*-openbsd* | powerpc-*-sysv* | powerpc-*-darwin*) TARGET=POWERPC; arch_target=ppc; JIT_SUPPORTED=yes;;
-arm-*-linux-* | armv4l-*-linux-*) TARGET=ARM; arch_target=arm; ACCESS_UNALIGNED="no";;
-s390-*-linux*) TARGET=S390; arch_target=s390; ACCESS_UNALIGNED="no";;
+#	mips-sgi-irix5.* | mips-sgi-irix6.*)
+#		TARGET=MIPS;
+#		ACCESS_UNALIGNED="no"
+#		;;
+	i*86-*-*)
+		TARGET=X86;
+		arch_target=x86;
+		JIT_SUPPORTED=yes
+		;;
+	sparc*-*-*)
+		TARGET=SPARC;
+		arch_target=sparc;
+		ACCESS_UNALIGNED="no"
+		;;
+#       alpha*-*-linux* | alpha*-*-osf*)
+#		TARGET=ALPHA;
+#		ACCESS_UNALIGNED="no"
+#	       ;;
+#	ia64-*-linux* | ia64-*-hpux*)
+#		TARGET=IA64;
+#		arch_target=ia64;
+#		JIT_SUPPORTED=no;
+#		ACCESS_UNALIGNED="no";
+#		case "$host_os" in
+#			linux*) LIBC="libc.so.6.1";;
+#			hpux*)  LIBC="libc.so.1";;
+#		esac
+#		;;
+#       m68k-*-linux*)
+#		TARGET=M68K
+#		;;
+	macppc-*-openbsd* | powerpc-*-linux* | powerpc-*-openbsd* | \
+        powerpc-*-sysv* | powerpc-*-darwin*)
+		TARGET=POWERPC;
+		arch_target=ppc;
+		JIT_SUPPORTED=yes
+		;;
+	arm-*-linux-* | armv4l-*-linux-*)
+		TARGET=ARM;
+		arch_target=arm;
+		ACCESS_UNALIGNED="no"
+		;;
+	s390-*-linux*)
+		TARGET=S390;
+		arch_target=s390;
+		ACCESS_UNALIGNED="no"
+		;;
 esac
 
 if test ${TARGET} = unknown; then
@@ -647,6 +716,7 @@ AM_CONDITIONAL(MIPS_SGI, test ${TARGET}$
 AM_CONDITIONAL(SPARC, test x$TARGET = xSPARC)
 AM_CONDITIONAL(X86, test x$TARGET = xX86)
 AM_CONDITIONAL(ALPHA, test x$TARGET = xALPHA)
+AM_CONDITIONAL(IA64, test x$TARGET = xIA64)
 AM_CONDITIONAL(M68K, test x$TARGET = xM68K)
 AM_CONDITIONAL(POWERPC, test x$TARGET = xPOWERPC)
 AM_CONDITIONAL(ARM, test x$TARGET = xARM)
@@ -654,7 +724,6 @@ AM_CONDITIONAL(S390, test x$TARGET = xS3
 
 AM_CONDITIONAL(JIT_SUPPORTED, test x$JIT_SUPPORTED = xyes)
 
-LIBC="libc.so.6"
 AC_SUBST(LIBC)
 
 AC_SUBST(arch_target)
@@ -680,8 +749,9 @@ mono/arch/sparc/Makefile
 mono/arch/s390/Makefile
 mono/arch/arm/Makefile
 mono/arch/alpha/Makefile
 mono/interpreter/Makefile
 mono/tests/Makefile
+mono/tests/tests-config
 mono/benchmark/Makefile
 mono/monoburg/Makefile
 mono/monograph/Makefile
Index: data/Makefile.am
===================================================================
RCS file: /mono/mono/data/Makefile.am,v
retrieving revision 1.4
diff -p -u -b -r1.4 Makefile.am
--- data/Makefile.am	6 Dec 2002 23:48:19 -0000	1.4
+++ data/Makefile.am	31 Jul 2003 08:05:42 -0000
@@ -7,5 +7,5 @@ mono_DATA = config machine.config
 DISTCLEANFILES = config
 
 config: config.in Makefile
-	sed -e 's^\@LIBC\@^libc.so.6^g' < $(srcdir)/config.in > config.tmp \
+	sed -e 's^\@LIBC\@^$(LIBC)^g' < $(srcdir)/config.in > config.tmp \
 	&& mv config.tmp config
Index: mono/arch/arm/Makefile.am
===================================================================
RCS file: /mono/mono/mono/arch/arm/Makefile.am,v
retrieving revision 1.3
diff -p -u -b -r1.3 Makefile.am
--- mono/arch/arm/Makefile.am	4 Apr 2002 04:42:45 -0000	1.3
+++ mono/arch/arm/Makefile.am	31 Jul 2003 08:06:08 -0000
@@ -14,7 +14,7 @@ libmonoarch_arm_la_SOURCES = $(BUILT_SOU
 	arm-dis.h
 
 arm_dpimacros.h: dpiops.sh mov_macros.th dpi_macros.th cmp_macros.th
-	bash ./dpiops.sh
+	bash $(srcdir)/dpiops.sh
 
 CLEANFILES = $(BUILT_SOURCES)
 
Index: mono/io-layer/wapi-private.h
===================================================================
RCS file: /mono/mono/mono/io-layer/wapi-private.h,v
retrieving revision 1.23
diff -p -u -b -r1.23 wapi-private.h
--- mono/io-layer/wapi-private.h	23 Jul 2003 17:08:19 -0000	1.23
+++ mono/io-layer/wapi-private.h	31 Jul 2003 08:06:21 -0000
@@ -119,7 +119,7 @@ struct _WapiHandleScratch
 	 * resize will go via mremap() or just realloc().
 	 */
 	gboolean is_shared;
-	guchar scratch_data[0];
+	guchar scratch_data[MONO_ZERO_ARRAY_LENGTH];
 };
 
 /*
Index: mono/metadata/appdomain.h
===================================================================
RCS file: /mono/mono/mono/metadata/appdomain.h,v
retrieving revision 1.51
diff -p -u -b -r1.51 appdomain.h
--- mono/metadata/appdomain.h	21 Jul 2003 15:43:19 -0000	1.51
+++ mono/metadata/appdomain.h	31 Jul 2003 08:06:21 -0000
@@ -138,13 +138,13 @@ mono_runtime_quit (void);
 MonoDomain *
 mono_domain_create         (void);
 
-inline MonoDomain *
+MonoDomain *
 mono_domain_get            (void);
 
-inline MonoDomain *
+MonoDomain *
 mono_domain_get_by_id      (gint32 domainid);
 
-inline void
+void
 mono_domain_set            (MonoDomain *domain);
 
 void
@@ -219,10 +219,10 @@ ves_icall_System_AppDomain_ExecuteAssemb
 void
 mono_context_init 				   (MonoDomain *domain);
 
-inline void 
+void 
 mono_context_set				   (MonoAppContext *new_context);
 
-inline MonoAppContext * 
+MonoAppContext * 
 mono_context_get				   (void);
 
 MonoAppDomain * 
Index: mono/metadata/domain.c
===================================================================
RCS file: /mono/mono/mono/metadata/domain.c,v
retrieving revision 1.34
diff -p -u -b -r1.34 domain.c
--- mono/metadata/domain.c	11 Jul 2003 17:16:00 -0000	1.34
+++ mono/metadata/domain.c	31 Jul 2003 08:06:23 -0000
@@ -456,7 +456,7 @@ mono_init (const char *filename)
  *
  * Returns the current domain.
  */
-inline MonoDomain *
+MonoDomain *
 mono_domain_get ()
 {
 	return ((MonoDomain *)TlsGetValue (appdomain_thread_id));
@@ -468,7 +468,7 @@ mono_domain_get ()
  *
  * Sets the current domain to @domain.
  */
-inline void
+void
 mono_domain_set (MonoDomain *domain)
 {
 	TlsSetValue (appdomain_thread_id, domain);
Index: mono/mini/Makefile.am
===================================================================
RCS file: /mono/mono/mono/mini/Makefile.am,v
retrieving revision 1.28
diff -p -u -b -r1.28 Makefile.am
--- mono/mini/Makefile.am	31 Jul 2003 02:45:13 -0000	1.28
+++ mono/mini/Makefile.am	31 Jul 2003 08:06:35 -0000
@@ -10,12 +10,8 @@ libs=	\
 
 MCS=mcs
 RUNTIME=mono
-WARN=-Wall -Wunused -Wmissing-prototypes -Wmissing-declarations \
-	-Wstrict-prototypes  -Wmissing-prototypes -Wnested-externs \
-	-Wpointer-arith -Wno-cast-qual -Wcast-align -Wwrite-strings
 
 INCLUDES = \
-	$(WARN) -fexceptions -DMONO_USE_EXC_TABLES	\
 	-I$(top_srcdir) 	\
 	$(GMODULE_CFLAGS)		\
 	$(GLIB_CFLAGS)
Index: mono/tests/Makefile.am
===================================================================
RCS file: /mono/mono/mono/tests/Makefile.am,v
retrieving revision 1.144
diff -p -u -b -r1.144 Makefile.am
--- mono/tests/Makefile.am	22 Jul 2003 10:08:27 -0000	1.144
+++ mono/tests/Makefile.am	31 Jul 2003 08:06:42 -0000
@@ -193,10 +193,10 @@ TESTBS=$(BENCHSRC:.cs=.exe)
 EXTRA_DIST=test-driver $(TEST_CS_SRC) $(TEST_IL_SRC)
 
 %.exe: %.il
-	ilasm $< /OUTPUT=$@
+	ilasm -out:$@ $<
 
 %.exe: %.cs
-	$(CSC) $<
+	$(CSC) -out:$@ $<
 
 test:	testjit
 
@@ -205,7 +205,7 @@ test_cs: $(TEST_PROG) $(TESTSI_CS) libte
 	passed=0; \
 	export LD_LIBRARY_PATH="`pwd`/.libs:$${LD_LIBRARY_PATH}"; \
 	for i in $(TESTSI_CS); do	\
-		if ./test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS); \
+		if $(srcdir)/test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS); \
 		then \
 			passed=`expr $${passed} + 1`; \
 		else \
@@ -220,7 +220,7 @@ test_il: $(TEST_PROG) $(TESTSI_IL) libte
 	passed=0; \
 	export LD_LIBRARY_PATH="`pwd`/.libs:$${LD_LIBRARY_PATH}"; \
 	for i in $(TESTSI_IL); do	\
-		if ./test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS); \
+		if $(srcdir)/test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS); \
 		then \
 			passed=`expr $${passed} + 1`; \
 		else \
@@ -232,7 +232,7 @@ test_il: $(TEST_PROG) $(TESTSI_IL) libte
 
 testb: $(TEST_PROG) $(TESTBS)
 	for i in $(TESTBS); do	\
-		./test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS);	\
+		$(srcdir)/test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS);	\
 	done
 
 testjit: $(TESTSI_CS) $(TESTSI_IL) $(TESTBS) libtest.la
@@ -241,7 +241,7 @@ testjit: $(TESTSI_CS) $(TESTSI_IL) $(TES
 	failed_tests="";\
 	export LD_LIBRARY_PATH="`pwd`/.libs:$${LD_LIBRARY_PATH}"; \
 	for i in $(TESTSI_CS) $(TESTSI_IL) $(TESTBS); do	\
-		if ./test-driver $(JITTEST_PROG) $$i $(RUNTIME_ARGS); \
+		if $(srcdir)/test-driver $(JITTEST_PROG) $$i $(RUNTIME_ARGS); \
 		then \
 			passed=`expr $${passed} + 1`; \
 		else \
@@ -259,11 +259,10 @@ testinterp: $(TESTSI_CS) $(TESTSI_IL) li
 	failed_tests="";\
 	export LD_LIBRARY_PATH="`pwd`/.libs:$${LD_LIBRARY_PATH}"; \
 	for i in $(TESTSI_CS) $(TESTSI_IL); do \
-		echo $$i; \
 		if [ $$i == thread5.exe ]; then \
 			continue; \
 		fi; \
-		if ./test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS); \
+		if $(srcdir)/test-driver $(TEST_PROG) $$i $(RUNTIME_ARGS); \
 		then \
 			passed=`expr $${passed} + 1`; \
 		else \
Index: mono/tests/test-driver
===================================================================
RCS file: /mono/mono/mono/tests/test-driver,v
retrieving revision 1.4
diff -p -u -b -r1.4 test-driver
--- mono/tests/test-driver	8 May 2003 21:32:38 -0000	1.4
+++ mono/tests/test-driver	31 Jul 2003 08:06:43 -0000
@@ -1,4 +1,4 @@
-#!/usr/bin/perl -w
+#!/usr/bin/env perl 
 
 my $interpreter = shift;
 my $test = shift;
Index: mono/tests/tests-config
===================================================================
RCS file: mono/tests/tests-config
diff -N mono/tests/tests-config
--- mono/tests/tests-config	31 May 2002 07:51:40 -0000	1.1
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,5 +0,0 @@
-<configuration>
-	<dllmap dll="cygwin1.dll" target="libc.so.6" />
-	<dllmap dll="libc" target="libc.so.6" />
-</configuration>
-
Index: mono/tests/tests-config.in
===================================================================
RCS file: mono/tests/tests-config.in
diff -N mono/tests/tests-config.in
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ mono/tests/tests-config.in	31 Jul 2003 08:06:43 -0000
@@ -0,0 +1,5 @@
+<configuration>
+	<dllmap dll="cygwin1.dll" target="@LIBC@" />
+	<dllmap dll="libc" target="@LIBC@" />
+</configuration>
+
Index: runtime/Makefile.am
===================================================================
RCS file: /mono/mono/runtime/Makefile.am,v
retrieving revision 1.29
diff -p -u -b -r1.29 Makefile.am
--- runtime/Makefile.am	23 Jul 2003 01:28:50 -0000	1.29
+++ runtime/Makefile.am	31 Jul 2003 08:06:44 -0000
@@ -69,7 +69,7 @@ $(monobins_DATA):
 
 dist-hook:
 	for i in $(monobins_DATA) $(assemblies_DATA); do	\
-		if test ! -s $(srcdir)/$$i; then echo $$i is empty && exit 1; fi	\
+		if test ! -s ./$$i; then echo $$i is empty && exit 1; fi	\
 	done
 
 copy_dlls:
