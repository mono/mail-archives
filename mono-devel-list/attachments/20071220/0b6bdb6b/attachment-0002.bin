Index: System/Test/System.Collections.Specialized/NameObjectCollectionBaseTest.cs
===================================================================
--- System/Test/System.Collections.Specialized/NameObjectCollectionBaseTest.cs	(revision 91612)
+++ System/Test/System.Collections.Specialized/NameObjectCollectionBaseTest.cs	(working copy)
@@ -452,5 +452,74 @@
 			Assert.AreEqual ("string1", array[0], "[0]");
 			Assert.AreEqual ("string2", array[1], "[1]");
 		}
+
+		[Test]
+		public void CopyTo_Null () 
+		{
+			UnitTestNameObjectCollectionBase c = new UnitTestNameObjectCollectionBase ();
+			try {
+				((ICollection)c).CopyTo (null, 0);
+				Assert.Fail ("#1");
+			} catch(ArgumentNullException ex) {
+				Assert.AreEqual (typeof (ArgumentNullException), ex.GetType (), "#2");
+				Assert.IsNull (ex.InnerException, "#3");
+				Assert.IsNotNull (ex.Message, "#4");
+				Assert.IsNotNull (ex.ParamName, "#5");
+			}
+		}
+
+		[Test]
+		public void CopyTo_NegativeIndex () 
+		{
+			string [] array = new string [1];
+			UnitTestNameObjectCollectionBase c = new UnitTestNameObjectCollectionBase ();
+			c.Add ("1", "mono");
+			try {
+				((ICollection)c).CopyTo (array, -1);
+				Assert.Fail ("#1");
+			} catch(ArgumentOutOfRangeException ex) {
+				Assert.AreEqual (typeof (ArgumentOutOfRangeException), ex.GetType (), "#2");
+				Assert.IsNull (ex.InnerException, "#3");
+				Assert.IsNotNull (ex.Message, "#4");
+				Assert.IsNotNull (ex.ParamName, "#5");
+			}
+		}
+
+		[Test]
+		public void CopyTo_NotEnoughSpace () 
+		{
+			string [] array = new string [4];
+			UnitTestNameObjectCollectionBase c = new UnitTestNameObjectCollectionBase ();
+			c.Add ("1", "mono");
+			c.Add ("2", "MoNo");
+			c.Add ("3", "mOnO");
+			c.Add ("4", "MONO");
+			try {
+				((ICollection)c).CopyTo (array, 2);
+				Assert.Fail ("#1");
+			} catch (ArgumentException ex) {
+				Assert.AreEqual (typeof (ArgumentException), ex.GetType (), "#2");
+				Assert.IsNull (ex.InnerException, "#3");
+				Assert.IsNotNull (ex.Message, "#4");
+				Assert.IsNull (ex.ParamName, "#5");
+			}
+		}
+
+		[Test]
+		public void CopyTo_MultipleDimensionStringArray () 
+		{
+			string [,] matrix = new string [1,1];
+			UnitTestNameObjectCollectionBase c = new UnitTestNameObjectCollectionBase ();
+			c.Add ("1", "mono");
+			try {
+				((ICollection)c).CopyTo (matrix, 0);
+				Assert.Fail ("#1");
+			} catch (ArgumentException ex) {
+				Assert.AreEqual (typeof (ArgumentException), ex.GetType (), "#2");
+				Assert.IsNull (ex.InnerException, "#3");
+				Assert.IsNotNull (ex.Message, "#4");
+				Assert.IsNotNull (ex.ParamName, "#5");
+			}
+		}
 	}
 }
Index: System/Test/System.Collections.Specialized/ChangeLog
===================================================================
--- System/Test/System.Collections.Specialized/ChangeLog	(revision 91612)
+++ System/Test/System.Collections.Specialized/ChangeLog	(working copy)
@@ -1,3 +1,8 @@
+2007-12-19  Juraj Skripsky <js@hotfeet.ch>
+
+	* NameObjectCollectionBaseTest.cs: Add tests for argument checking in
+	CopyTo.
+
 2007-04-29  Ilya Kharmatsky <ilyak@mainsoft.com>
 
 	* NameValueCollectionTest.cs: Added test which checks proper exception
