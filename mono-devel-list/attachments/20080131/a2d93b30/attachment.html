<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7652.24&quot;&gt;<br>
&lt;TITLE&gt;PATCH:&nbsp;mcs:&nbsp;better&nbsp;type&nbsp;matching&nbsp;for&nbsp;anonymous&nbsp;methods&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Hi.&nbsp;The&nbsp;attached&nbsp;patch&nbsp;to&nbsp;mcs&nbsp;seems&nbsp;to&nbsp;fix&nbsp;bug&nbsp;357047&nbsp;(which&nbsp;I&nbsp;also&lt;BR&gt;<br>
filed).&nbsp;The&nbsp;issue&nbsp;is&nbsp;that&nbsp;the&nbsp;compiler&nbsp;can't&nbsp;tell&nbsp;that:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&nbsp;enumerable.Average(o&nbsp;=&amp;gt;&nbsp;op&nbsp;on&nbsp;o&nbsp;that&nbsp;returns&nbsp;a&nbsp;double);&lt;BR&gt;<br>
&lt;BR&gt;<br>
or&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;nbsp;&nbsp;enumerable.Average(delegate(T&nbsp;o)&nbsp;{&nbsp;return&nbsp;(op&nbsp;on&nbsp;o&nbsp;that&nbsp;returns&nbsp;a&lt;BR&gt;<br>
double);&nbsp;});&lt;BR&gt;<br>
&lt;BR&gt;<br>
Means&nbsp;Average&amp;lt;T&amp;gt;(IEnumerable&amp;lt;T&amp;gt;,Func&amp;lt;T,double&amp;gt;)&nbsp;or&lt;BR&gt;<br>
Average&amp;lt;T&amp;gt;(IEnumerable&amp;lt;T&amp;gt;,Func&amp;lt;T,double?&amp;gt;).&nbsp;This&nbsp;means&nbsp;that&nbsp;you&nbsp;get&nbsp;an&lt;BR&gt;<br>
error&nbsp;that&nbsp;the&nbsp;method&nbsp;call&nbsp;is&nbsp;ambiguous.&lt;BR&gt;<br>
&lt;BR&gt;<br>
The&nbsp;patch&nbsp;works&nbsp;by&nbsp;inferring&nbsp;the&nbsp;return&nbsp;type&nbsp;of&nbsp;the&nbsp;argument,&nbsp;then&lt;BR&gt;<br>
testing&nbsp;if&nbsp;that&nbsp;return&nbsp;value&nbsp;is&nbsp;an&nbsp;exact&nbsp;match&nbsp;for&nbsp;the&nbsp;return&nbsp;value&nbsp;of&lt;BR&gt;<br>
the&nbsp;Func&nbsp;parameter.&nbsp;If&nbsp;so,&nbsp;it&nbsp;breaks&nbsp;ties&nbsp;with&nbsp;the&nbsp;exact&nbsp;match.&lt;BR&gt;<br>
&lt;BR&gt;<br>
This&nbsp;is&nbsp;the&nbsp;first&nbsp;hacking&nbsp;I've&nbsp;done&nbsp;on&nbsp;mcs,&nbsp;so&nbsp;I'm&nbsp;not&nbsp;sure&nbsp;about&nbsp;how&lt;BR&gt;<br>
correct&nbsp;this&nbsp;is.&nbsp;Comments&nbsp;are&nbsp;welcome.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thanks.&lt;BR&gt;<br>
&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
