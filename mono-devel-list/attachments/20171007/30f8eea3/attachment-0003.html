<tt>
&lt;div&nbsp;dir=&quot;auto&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;br&nbsp;type=&quot;attribution&quot;&gt;&lt;blockquote&nbsp;class=&quot;quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;HI&nbsp;All&nbsp;,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;While&nbsp;calling&nbsp;ProtectedData.Protect(&lt;wbr&gt;Encoding.Unicode.GetBytes(&quot;&lt;wbr&gt;XXXXXXXXXXXXXXX&quot;),&nbsp;null,&nbsp;DataProtectionScope.&lt;wbr&gt;LocalMachine);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;getting&nbsp;following&nbsp;error&nbsp;....i&nbsp;am&nbsp;running&nbsp;my&nbsp;application&nbsp;under&nbsp;fast_cgi_mono+nginx&nbsp;and&nbsp;running&nbsp;as&nbsp;non&nbsp;root&nbsp;user..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;following&nbsp;error&nbsp;is&nbsp;coming&nbsp;randomly&nbsp;not&nbsp;always.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;run&nbsp;my&nbsp;application&nbsp;as&nbsp;root&nbsp;user&nbsp;for&nbsp;Security&nbsp;reasons&lt;/div&gt;&lt;div&gt;.please&nbsp;advice&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;System.Security.Cryptography.&lt;wbr&gt;CryptographicException:&nbsp;Data&nbsp;protection&nbsp;failed.&nbsp;---&gt;&nbsp;System.&lt;wbr&gt;UnauthorizedAccessException:&nbsp;Access&nbsp;to&nbsp;the&nbsp;path&nbsp;&quot;/usr/share/.mono/keypairs/[1]&lt;wbr&gt;[98f3a7e3-0d6e-f432-8a18-&lt;wbr&gt;e1144b53633f][-1].xml&quot;&nbsp;is&nbsp;denied.&lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.IO.FileStream..ctor&nbsp;(System.String&nbsp;path,&nbsp;System.IO.FileMode&nbsp;mode,&nbsp;System.IO.FileAccess&nbsp;access,&nbsp;System.IO.FileShare&nbsp;share,&nbsp;System.Int32&nbsp;bufferSize,&nbsp;System.Boolean&nbsp;anonymous,&nbsp;System.IO.FileOptions&nbsp;options)&nbsp;[0x001d8]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.IO.FileStream..ctor&nbsp;(System.String&nbsp;path,&nbsp;System.IO.FileMode&nbsp;mode,&nbsp;System.IO.FileAccess&nbsp;access,&nbsp;System.IO.FileShare&nbsp;share)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;System.IO.FileStream:.ctor&nbsp;(string,System.IO.FileMode,&lt;wbr&gt;System.IO.FileAccess,System.&lt;wbr&gt;IO.FileShare)&lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.IO.File.Open&nbsp;(System.String&nbsp;path,&nbsp;System.IO.FileMode&nbsp;mode)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;KeyPairPersistence.Save&nbsp;()&nbsp;[0x00006]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSACryptoServiceProvider.&lt;wbr&gt;OnKeyGenerated&nbsp;(System.Object&nbsp;sender,&nbsp;System.EventArgs&nbsp;e)&nbsp;[0x0002f]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;RSAManaged.GenerateKeyPair&nbsp;()&nbsp;[0x00151]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;RSAManaged.EncryptValue&nbsp;(System.Byte[]&nbsp;rgb)&nbsp;[0x0001b]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;PKCS1.RSAEP&nbsp;(System.Security.Cryptography.&lt;wbr&gt;RSA&nbsp;rsa,&nbsp;System.Byte[]&nbsp;m)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;PKCS1.Encrypt_OAEP&nbsp;(System.Security.Cryptography.&lt;wbr&gt;RSA&nbsp;rsa,&nbsp;System.Security.Cryptography.&lt;wbr&gt;HashAlgorithm&nbsp;hash,&nbsp;System.Security.Cryptography.&lt;wbr&gt;RandomNumberGenerator&nbsp;rng,&nbsp;System.Byte[]&nbsp;M)&nbsp;[0x000f6]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;Utils.RsaOaepEncrypt&nbsp;(System.Security.Cryptography.&lt;wbr&gt;RSA&nbsp;rsa,&nbsp;System.Security.Cryptography.&lt;wbr&gt;HashAlgorithm&nbsp;hash,&nbsp;System.Security.Cryptography.&lt;wbr&gt;PKCS1MaskGenerationMethod&nbsp;mgf,&nbsp;System.Security.Cryptography.&lt;wbr&gt;RandomNumberGenerator&nbsp;rng,&nbsp;System.Byte[]&nbsp;data)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSAOAEPKeyExchangeFormatter.&lt;wbr&gt;CreateKeyExchange&nbsp;(System.Byte[]&nbsp;rgbData)&nbsp;[0x00047]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSACryptoServiceProvider.&lt;wbr&gt;Encrypt&nbsp;(System.Byte[]&nbsp;rgb,&nbsp;System.Boolean&nbsp;fOAEP)&nbsp;[0x0001f]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSACryptoServiceProvider.&lt;wbr&gt;Encrypt&nbsp;(System.Byte[]&nbsp;data,&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSAEncryptionPadding&nbsp;padding)&nbsp;[0x00045]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSAOAEPKeyExchangeFormatter.&lt;wbr&gt;CreateKeyExchange&nbsp;(System.Byte[]&nbsp;rgbData)&nbsp;[0x0002c]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;ManagedProtection.Protect&nbsp;(System.Byte[]&nbsp;userData,&nbsp;System.Byte[]&nbsp;optionalEntropy,&nbsp;System.Security.Cryptography.&lt;wbr&gt;DataProtectionScope&nbsp;scope)&nbsp;[0x0013e]&nbsp;in&nbsp;&lt;&lt;wbr&gt;2c890ca2f2c3434ca04011ecd5d571&lt;wbr&gt;65&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;ProtectedData.Protect&nbsp;(System.Byte[]&nbsp;userData,&nbsp;System.Byte[]&nbsp;optionalEntropy,&nbsp;System.Security.Cryptography.&lt;wbr&gt;DataProtectionScope&nbsp;scope)&nbsp;[0x00023]&nbsp;in&nbsp;&lt;&lt;wbr&gt;2c890ca2f2c3434ca04011ecd5d571&lt;wbr&gt;65&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp; ---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---&lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;ProtectedData.Protect&nbsp;(System.Byte[]&nbsp;userData,&nbsp;System.Byte[]&nbsp;optionalEntropy,&nbsp;System.Security.Cryptography.&lt;wbr&gt;DataProtectionScope&nbsp;scope)&nbsp;[0x0003f]&nbsp;in&nbsp;&lt;&lt;wbr&gt;2c890ca2f2c3434ca04011ecd5d571&lt;wbr&gt;65&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Writelog.Program.Main&nbsp;(System.String[]&nbsp;args)&nbsp;[0x00010]&nbsp;in&nbsp;&lt;&lt;wbr&gt;e4a1cce0275a48f29c577f83bf7113&lt;wbr&gt;1e&gt;:0 &lt;/div&gt;&lt;div&gt;[ERROR]&nbsp;FATAL&nbsp;UNHANDLED&nbsp;EXCEPTION:&nbsp;System.Security.Cryptography.&lt;wbr&gt;CryptographicException:&nbsp;Data&nbsp;protection&nbsp;failed.&nbsp;---&gt;&nbsp;System.&lt;wbr&gt;UnauthorizedAccessException:&nbsp;Access&nbsp;to&nbsp;the&nbsp;path&nbsp;&quot;/usr/share/.mono/keypairs/[1]&lt;wbr&gt;[98f3a7e3-0d6e-f432-8a18-&lt;wbr&gt;e1144b53633f][-1].xml&quot;&nbsp;is&nbsp;denied.&lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.IO.FileStream..ctor&nbsp;(System.String&nbsp;path,&nbsp;System.IO.FileMode&nbsp;mode,&nbsp;System.IO.FileAccess&nbsp;access,&nbsp;System.IO.FileShare&nbsp;share,&nbsp;System.Int32&nbsp;bufferSize,&nbsp;System.Boolean&nbsp;anonymous,&nbsp;System.IO.FileOptions&nbsp;options)&nbsp;[0x001d8]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.IO.FileStream..ctor&nbsp;(System.String&nbsp;path,&nbsp;System.IO.FileMode&nbsp;mode,&nbsp;System.IO.FileAccess&nbsp;access,&nbsp;System.IO.FileShare&nbsp;share)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;(wrapper&nbsp;remoting-invoke-with-check)&nbsp;System.IO.FileStream:.ctor&nbsp;(string,System.IO.FileMode,&lt;wbr&gt;System.IO.FileAccess,System.&lt;wbr&gt;IO.FileShare)&lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.IO.File.Open&nbsp;(System.String&nbsp;path,&nbsp;System.IO.FileMode&nbsp;mode)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;KeyPairPersistence.Save&nbsp;()&nbsp;[0x00006]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSACryptoServiceProvider.&lt;wbr&gt;OnKeyGenerated&nbsp;(System.Object&nbsp;sender,&nbsp;System.EventArgs&nbsp;e)&nbsp;[0x0002f]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;RSAManaged.GenerateKeyPair&nbsp;()&nbsp;[0x00151]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;RSAManaged.EncryptValue&nbsp;(System.Byte[]&nbsp;rgb)&nbsp;[0x0001b]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;PKCS1.RSAEP&nbsp;(System.Security.Cryptography.&lt;wbr&gt;RSA&nbsp;rsa,&nbsp;System.Byte[]&nbsp;m)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;PKCS1.Encrypt_OAEP&nbsp;(System.Security.Cryptography.&lt;wbr&gt;RSA&nbsp;rsa,&nbsp;System.Security.Cryptography.&lt;wbr&gt;HashAlgorithm&nbsp;hash,&nbsp;System.Security.Cryptography.&lt;wbr&gt;RandomNumberGenerator&nbsp;rng,&nbsp;System.Byte[]&nbsp;M)&nbsp;[0x000f6]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;Utils.RsaOaepEncrypt&nbsp;(System.Security.Cryptography.&lt;wbr&gt;RSA&nbsp;rsa,&nbsp;System.Security.Cryptography.&lt;wbr&gt;HashAlgorithm&nbsp;hash,&nbsp;System.Security.Cryptography.&lt;wbr&gt;PKCS1MaskGenerationMethod&nbsp;mgf,&nbsp;System.Security.Cryptography.&lt;wbr&gt;RandomNumberGenerator&nbsp;rng,&nbsp;System.Byte[]&nbsp;data)&nbsp;[0x00000]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSAOAEPKeyExchangeFormatter.&lt;wbr&gt;CreateKeyExchange&nbsp;(System.Byte[]&nbsp;rgbData)&nbsp;[0x00047]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSACryptoServiceProvider.&lt;wbr&gt;Encrypt&nbsp;(System.Byte[]&nbsp;rgb,&nbsp;System.Boolean&nbsp;fOAEP)&nbsp;[0x0001f]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSACryptoServiceProvider.&lt;wbr&gt;Encrypt&nbsp;(System.Byte[]&nbsp;data,&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSAEncryptionPadding&nbsp;padding)&nbsp;[0x00045]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;RSAOAEPKeyExchangeFormatter.&lt;wbr&gt;CreateKeyExchange&nbsp;(System.Byte[]&nbsp;rgbData)&nbsp;[0x0002c]&nbsp;in&nbsp;&lt;&lt;wbr&gt;77c9551943624fd18301ba6f78a841&lt;wbr&gt;e5&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Mono.Security.Cryptography.&lt;wbr&gt;ManagedProtection.Protect&nbsp;(System.Byte[]&nbsp;userData,&nbsp;System.Byte[]&nbsp;optionalEntropy,&nbsp;System.Security.Cryptography.&lt;wbr&gt;DataProtectionScope&nbsp;scope)&nbsp;[0x0013e]&nbsp;in&nbsp;&lt;&lt;wbr&gt;2c890ca2f2c3434ca04011ecd5d571&lt;wbr&gt;65&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;ProtectedData.Protect&nbsp;(System.Byte[]&nbsp;userData,&nbsp;System.Byte[]&nbsp;optionalEntropy,&nbsp;System.Security.Cryptography.&lt;wbr&gt;DataProtectionScope&nbsp;scope)&nbsp;[0x00023]&nbsp;in&nbsp;&lt;&lt;wbr&gt;2c890ca2f2c3434ca04011ecd5d571&lt;wbr&gt;65&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp; ---&nbsp;End&nbsp;of&nbsp;inner&nbsp;exception&nbsp;stack&nbsp;trace&nbsp;---&lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;System.Security.Cryptography.&lt;wbr&gt;ProtectedData.Protect&nbsp;(System.Byte[]&nbsp;userData,&nbsp;System.Byte[]&nbsp;optionalEntropy,&nbsp;System.Security.Cryptography.&lt;wbr&gt;DataProtectionScope&nbsp;scope)&nbsp;[0x0003f]&nbsp;in&nbsp;&lt;&lt;wbr&gt;2c890ca2f2c3434ca04011ecd5d571&lt;wbr&gt;65&gt;:0 &lt;/div&gt;&lt;div&gt; &nbsp;at&nbsp;Writelog.Program.Main&nbsp;(System.String[]&nbsp;args)&nbsp;[0x00010]&nbsp;in&nbsp;&lt;&lt;wbr&gt;e4a1cce0275a48f29c577f83bf7113&lt;wbr&gt;1e&gt;:0 &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
