<tt>
I&nbsp;try&nbsp;to&nbsp;use&nbsp;these&nbsp;voodoo&nbsp;keywords&nbsp;and&nbsp;have&nbsp;a&nbsp;small&nbsp;report:&lt;br&gt;&lt;br&gt;1)&nbsp;gmcs&nbsp;currently&nbsp;supports&nbsp;only&nbsp;__arglist&nbsp;keyword,&nbsp;but&nbsp;sometimes&nbsp;generates&nbsp;incorrect&nbsp;CIL.&nbsp;That&nbsp;code&nbsp;works&nbsp;while&nbsp;compiling&nbsp;with&nbsp;csc.exe,&nbsp;but&nbsp;leads&nbsp;to&nbsp;segmentation&nbsp;fault&nbsp;after&nbsp;gmsc&nbsp;(I&nbsp;try&nbsp;it&nbsp;on&nbsp;Mac&nbsp;OS&nbsp;10.5,&nbsp;Mono&nbsp;2.2&nbsp;):&lt;br&gt;<br>
==================&nbsp;CODE&nbsp;===========================&lt;br&gt;&amp;nbsp;private&nbsp;static&nbsp;void&nbsp;TestArglistMethod()&lt;br&gt;{&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;ArglistMethod(&nbsp;__arglist(&nbsp;1,&nbsp;2,&nbsp;3&nbsp;)&nbsp;);&lt;br&gt;}&lt;br&gt;&amp;nbsp;&lt;br&gt;private&nbsp;static&nbsp;void&nbsp;ArglistMethod(__arglist&nbsp;)&lt;br&gt;{&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;iter&nbsp;=&nbsp;new&nbsp;ArgIterator(&nbsp;__arglist&nbsp;);&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;for(&nbsp;var&nbsp;n&nbsp;=&nbsp;iter.GetRemainingCount();&nbsp;n&nbsp;&amp;gt;&nbsp;0;&nbsp;n--&nbsp;)&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(&nbsp;TypedReference.ToObject(&nbsp;iter.GetNextArg()&nbsp;)&nbsp;);&lt;br&gt;}&lt;br&gt;===================================================&lt;br&gt;2)&nbsp;Mono&nbsp;VES&nbsp;currently&nbsp;supports&nbsp;mkrefany,&nbsp;refanyval,&nbsp;refanytype,&nbsp;arglist&nbsp;instructions&nbsp;for&nbsp;non-P/Invoke&nbsp;scenario.&lt;br&gt;<br>
&lt;br&gt;3)&nbsp;Mono&nbsp;JIT&nbsp;&amp;amp;&nbsp;P/Invoke&nbsp;layer&nbsp;don&amp;#39;t&nbsp;like&nbsp;__arglist&nbsp;parameters&nbsp;and&nbsp;reports&nbsp;something&nbsp;like&nbsp;this:&nbsp;Invalid&nbsp;IL&nbsp;code&nbsp;in&nbsp;NObjective.Program:Main&nbsp;(string[]):&nbsp;IL_0021:&nbsp;ret&lt;br&gt;==================&nbsp;CODE&nbsp;===========================&lt;br&gt;<br>
[DllImport(&nbsp;&amp;quot;libc.dylib&amp;quot;&nbsp;)]&lt;br&gt;public&nbsp;extern&nbsp;static&nbsp;void&nbsp;printf(&nbsp;string&nbsp;format,&nbsp;__arglist&nbsp;);&lt;br&gt;&lt;br&gt;...&lt;br&gt;&amp;nbsp;&lt;br&gt;printf(&nbsp;&amp;quot;ytu&amp;quot;,&nbsp;__arglist(&nbsp;&amp;quot;44&amp;quot;&nbsp;)&nbsp;);&lt;br&gt;===================================================&lt;br&gt;<br>
If&nbsp;compiler&nbsp;&nbsp;will&nbsp;be&nbsp;able&nbsp;generate&nbsp;correct&nbsp;CIL&nbsp;it&nbsp;will&nbsp;be&nbsp;useful&nbsp;for&nbsp;debugging&nbsp;future&nbsp;P/Invoke&nbsp;layer&nbsp;that&nbsp;will&nbsp;able&nbsp;to&nbsp;work&nbsp;with&nbsp;__arglist&lt;br&gt;NObjective&nbsp;contains&nbsp;about&nbsp;of&nbsp;43000&nbsp;generated&nbsp;methods&nbsp;(generated&nbsp;from&nbsp;Objective-C&nbsp;method&nbsp;signatures)&nbsp;accessible&nbsp;by&nbsp;user&nbsp;that&nbsp;looks&nbsp;like:&lt;br&gt;<br>
&lt;br&gt;==================&nbsp;CODE&nbsp;===========================&lt;br&gt;unsafe&nbsp;public&nbsp;static&nbsp;bool&nbsp;writeToURL_atomically_(&nbsp;this&nbsp;NSData&nbsp;___this,&nbsp;NSURL&nbsp;url,&nbsp;bool&nbsp;atomically&nbsp;)&nbsp;{&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;RuntimeObject&nbsp;___occuredException;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;___result&nbsp;=&nbsp;NativeMethods.writeToURL_atomically_(&nbsp;___this,&nbsp;CachedSelectors.writeToURL_atomically_,&nbsp;out&nbsp;___occuredException,&nbsp;sizeof(&nbsp;NSURL&nbsp;)&nbsp;+&nbsp;sizeof(&nbsp;bool&nbsp;),&nbsp;url,&nbsp;atomically&nbsp;);&lt;br&gt;<br>
&amp;nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;___occuredException&nbsp;!=&nbsp;RuntimeObject.Null&nbsp;)&nbsp;throw&nbsp;RuntimeException.Create(&nbsp;___occuredException&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;___result;&lt;br&gt;}&lt;br&gt;&lt;br&gt;unsafe&nbsp;public&nbsp;static&nbsp;bool&nbsp;writeToURL_options_error_(&nbsp;this&nbsp;NSData&nbsp;___this,&nbsp;NSURL&nbsp;url,&nbsp;uint&nbsp;options,&nbsp;ref&nbsp;NSError&nbsp;error&nbsp;)&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&nbsp;&nbsp;&nbsp;RuntimeObject&nbsp;___occuredException;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;___result&nbsp;=&nbsp;NativeMethods.writeToURL_options_error_(&nbsp;___this,&nbsp;CachedSelectors.writeToURL_options_error_,&nbsp;out&nbsp;___occuredException,&nbsp;sizeof(&nbsp;NSURL&nbsp;)&nbsp;+&nbsp;sizeof(&nbsp;uint&nbsp;)&nbsp;+&nbsp;sizeof(&nbsp;IntPtr&nbsp;),&nbsp;url,&nbsp;options,&nbsp;ref&nbsp;error&nbsp;);&lt;br&gt;<br>
&amp;nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;___occuredException&nbsp;!=&nbsp;RuntimeObject.Null&nbsp;)&nbsp;throw&nbsp;RuntimeException.Create(&nbsp;___occuredException&nbsp;);&amp;nbsp;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;___result;&lt;br&gt;}&lt;br&gt;===================================================&lt;br&gt;Each&nbsp;generated&nbsp;method&nbsp;have&nbsp;a&nbsp;generated&nbsp;P/Invoke&nbsp;counterpart&nbsp;with&nbsp;same&nbsp;entry&nbsp;point&nbsp;and&nbsp;nearly&nbsp;same&nbsp;signature&nbsp;(another&nbsp;43000&nbsp;methods!):&lt;br&gt;<br>
==================&nbsp;CODE&nbsp;===========================&lt;br&gt;[DllImport(Runtime.InteropLibrary,&nbsp;EntryPoint&nbsp;=&nbsp;&amp;quot;objc_msgSend_eh2&amp;quot;)]&lt;br&gt;public&nbsp;static&nbsp;extern&nbsp;bool&nbsp;writeToURL_atomically_(&nbsp;RuntimeObject&nbsp;___object,&nbsp;Selector&nbsp;___selector,&nbsp;out&nbsp;RuntimeObject&nbsp;___occuredException,&nbsp;int&nbsp;___stackSize,&nbsp;NSURL&nbsp;url,&nbsp;bool&nbsp;atomically&nbsp;);&lt;br&gt;<br>
&lt;br&gt;[DllImport(Runtime.InteropLibrary,&nbsp;EntryPoint&nbsp;=&nbsp;&amp;quot;objc_msgSend_eh2&amp;quot;)]&lt;br&gt;public&nbsp;static&nbsp;extern&nbsp;bool&nbsp;writeToURL_options_error_(&nbsp;RuntimeObject&nbsp;___object,&nbsp;Selector&nbsp;___selector,&nbsp;out&nbsp;RuntimeObject&nbsp;___occuredException,&nbsp;int&nbsp;___stackSize,&nbsp;NSURL&nbsp;url,&nbsp;uint&nbsp;options,&nbsp;ref&nbsp;NSError&nbsp;error&nbsp;);&lt;br&gt;<br>
===================================================&lt;br&gt;&lt;br&gt;With&nbsp;proper&nbsp;__arglist&nbsp;support&nbsp;in&nbsp;VES/gmcs&nbsp;unnecessary&nbsp;P/Invokes&nbsp;can&nbsp;be&nbsp;easily&nbsp;removed&nbsp;(&nbsp;-43000&nbsp;methods&nbsp;=&nbsp;assembly&nbsp;will&nbsp;hold&nbsp;much&nbsp;less&nbsp;metadata&nbsp;)&nbsp;and&nbsp;calls&nbsp;redirected&nbsp;to&nbsp;SINGLE&nbsp;__arglist&nbsp;method:&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;==================&nbsp;CODE&nbsp;===========================&lt;br&gt;unsafe&nbsp;public&nbsp;static&nbsp;bool&nbsp;writeToURL_atomically_(&nbsp;this&nbsp;NSData&nbsp;___this,&nbsp;NSURL&nbsp;url,&nbsp;bool&nbsp;atomically&nbsp;)&nbsp;{&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;RuntimeObject&nbsp;___occuredException;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;___result&nbsp;=&nbsp;NativeMethods.FutureArglistMethod(&nbsp;___this,&nbsp;CachedSelectors.writeToURL_atomically_,&nbsp;out&nbsp;___occuredException,&nbsp;sizeof(&nbsp;NSURL&nbsp;)&nbsp;+&nbsp;sizeof(&nbsp;bool&nbsp;),&nbsp;__arglist(&nbsp;url,&nbsp;atomically&nbsp;)&nbsp;);&lt;br&gt;<br>
&amp;nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;___occuredException&nbsp;!=&nbsp;RuntimeObject.Null&nbsp;)&nbsp;throw&nbsp;RuntimeException.Create(&nbsp;___occuredException&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;___result;&lt;br&gt;}&lt;br&gt;&lt;br&gt;unsafe&nbsp;public&nbsp;static&nbsp;bool&nbsp;writeToURL_options_error_(&nbsp;this&nbsp;NSData&nbsp;___this,&nbsp;NSURL&nbsp;url,&nbsp;uint&nbsp;options,&nbsp;ref&nbsp;NSError&nbsp;error&nbsp;)&nbsp;{&lt;br&gt;<br>
&amp;nbsp;&nbsp;&nbsp;&nbsp;RuntimeObject&nbsp;___occuredException;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;___result&nbsp;=&nbsp;NativeMethods.FutureArglistMethod(&nbsp;___this,&nbsp;CachedSelectors.writeToURL_options_error_,&nbsp;out&nbsp;___occuredException,&nbsp;sizeof(&nbsp;NSURL&nbsp;)&nbsp;+&nbsp;sizeof(&nbsp;uint&nbsp;)&nbsp;+&nbsp;sizeof(&nbsp;IntPtr&nbsp;),&nbsp;__arglist(&nbsp;url,&nbsp;options,&nbsp;ref&nbsp;error&nbsp;)&nbsp;);&lt;br&gt;<br>
&amp;nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;___occuredException&nbsp;!=&nbsp;RuntimeObject.Null&nbsp;)&nbsp;throw&nbsp;RuntimeException.Create(&nbsp;___occuredException&nbsp;);&amp;nbsp;&lt;br&gt;&amp;nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;___result;&lt;br&gt;}&lt;br&gt;&lt;br&gt;...&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;br&gt;[DllImport(Runtime.InteropLibrary,&nbsp;EntryPoint&nbsp;=&nbsp;&amp;quot;objc_msgSend_eh2&amp;quot;)]&lt;br&gt;<br>
public&nbsp;static&nbsp;extern&nbsp;bool&nbsp;FutureArglistMethod(&nbsp;RuntimeObject&nbsp;___object,&nbsp;Selector&nbsp;___selector,&nbsp;out&nbsp;RuntimeObject&nbsp;___occuredException,&nbsp;int&nbsp;___stackSize,&nbsp;__arglist&nbsp;);&lt;br&gt;===================================================&lt;br&gt;<br>
&lt;br&gt;WBR,&lt;br&gt;Eugeny&nbsp;Grishul&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/2/5&nbsp;Miguel&nbsp;de&nbsp;Icaza&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:miguel@novell.com&quot;&gt;miguel@novell.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Hello,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;gmcs&nbsp;Compiler&nbsp;already&nbsp;not&nbsp;100%&nbsp;compatible&nbsp;with&nbsp;csc&nbsp;-&nbsp;__arglist&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;http://bartdesmet.net/blogs/bart/archive/2006/09/28/4473.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bartdesmet.net/blogs/bart/archive/2006/09/28/4473.aspx&lt;/a&gt;&amp;gt;,&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;__refvalue&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;http://bartdesmet.net/blogs/bart/archive/2006/09/28/4473.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bartdesmet.net/blogs/bart/archive/2006/09/28/4473.aspx&lt;/a&gt;&amp;gt;,&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;__makeref&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;http://bartdesmet.net/blogs/bart/archive/2006/09/28/4473.aspx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bartdesmet.net/blogs/bart/archive/2006/09/28/4473.aspx&lt;/a&gt;&amp;gt;&nbsp;not&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;supported&nbsp;(&nbsp;it&nbsp;can&nbsp;significatly&nbsp;reduce&nbsp;P/Invokes&nbsp;in&nbsp;bridging&nbsp;code&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;NObjective&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;http://code.google.com/p/nobjective/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://code.google.com/p/nobjective/&lt;/a&gt;&amp;gt;)&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;__arglist&nbsp;is&nbsp;fully&nbsp;supported.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;We&nbsp;have&nbsp;not&nbsp;implemented&nbsp;__reftype/__makeref&nbsp;mainly&nbsp;because&nbsp;nobody&nbsp;raised&lt;br&gt;<br>
&amp;gt;&nbsp;any&nbsp;interested&nbsp;in&nbsp;these&nbsp;undocumented&nbsp;keyword.&nbsp;If&nbsp;you&nbsp;missing&nbsp;this&lt;br&gt;<br>
&amp;gt;&nbsp;support&nbsp;please&nbsp;fill&nbsp;a&nbsp;bug&nbsp;report.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;agree.&nbsp;&amp;nbsp;&nbsp;Until&nbsp;today&nbsp;I&nbsp;did&nbsp;not&nbsp;even&nbsp;know&nbsp;those&nbsp;existed.&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;is&nbsp;their&nbsp;use&nbsp;case&nbsp;and&nbsp;how&nbsp;do&nbsp;you&nbsp;use&nbsp;these&nbsp;in&nbsp;NObjective?&nbsp;&amp;nbsp;I&nbsp;would&lt;br&gt;<br>
like&nbsp;to&nbsp;know&nbsp;more&nbsp;about&nbsp;this.&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;Marek&nbsp;said,&nbsp;please&nbsp;file&nbsp;a&nbsp;bug&nbsp;report,&nbsp;that&nbsp;will&nbsp;help&nbsp;us&nbsp;track&nbsp;this&lt;br&gt;<br>
task.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
miguel&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;WBR,&lt;br&gt;Eugeny&nbsp;Grishul&lt;br&gt;<br>

</tt>
