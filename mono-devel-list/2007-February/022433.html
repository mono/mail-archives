<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] WS stack.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WS%20stack.&In-Reply-To=1170762419.28845.17.camel%40pf-danlun2">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022419.html">
   <LINK REL="Next"  HREF="022436.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] WS stack.</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WS%20stack.&In-Reply-To=1170762419.28845.17.camel%40pf-danlun2"
       TITLE="[Mono-dev] WS stack.">atsushi at ximian.com
       </A><BR>
    <I>Wed Feb  7 06:51:55 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022419.html">[Mono-dev] WS stack.
</A></li>
        <LI>Next message: <A HREF="022436.html">[Mono-dev] WS stack.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22433">[ date ]</a>
              <a href="thread.html#22433">[ thread ]</a>
              <a href="subject.html#22433">[ subject ]</a>
              <a href="author.html#22433">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Daniel,

Daniel Lundqvist wrote:
&gt;<i> Hi Atsushi,
</I>&gt;<i> 
</I>&gt;<i> m&#229;n 2007-02-05 klockan 15:14 +0900 skrev Atsushi Eno:
</I>&gt;&gt;<i> Hi Daniel,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Daniel Lundqvist wrote:
</I>&gt;&gt;&gt;<i> The issue here is that it always sends the oid and parentoid field 
</I>&gt;&gt;&gt;<i> regardless of value of &lt;field&gt;Specified.
</I>&gt;&gt;&gt;<i> I got a patch (against SVN) for it, don't know if it's correct but 
</I>&gt;&gt;&gt;<i> solves the problem for me. So now it only sends oid and parentoid when 
</I>&gt;&gt;&gt;<i> &lt;field&gt;Specified is set to true. This was tested with 1.1.17.1 but the 
</I>&gt;&gt;&gt;<i> problem is in SVN as well from what I can see.
</I>&gt;&gt;<i> Oh, cool. Can you please share the patch so that it could be fixed?
</I>&gt;<i> 
</I>&gt;<i> Of course, thought I attached it but I'll reattach it. The problem is
</I>&gt;<i> that XmlTypeMapMember::CheckOptionalValueType is never called and thus
</I>&gt;<i> the OPTIONAL bit in its flags field is never set (Which is then checked
</I>&gt;<i> in XmlSerializationWriterInterpreter::MemberHasValue).
</I>
Thanks :) However, now I tried your patch but it does not seem to
fix the issue. Do you have actual case that the patch indeed fix
the issue? I attached what I tried.

&gt;<i> There are some other places (I think) that XmlTypeMapMember is
</I>&gt;<i> instanciated but I didn't add the call there, so this patch only fixes
</I>&gt;<i> my problem. Perhaps this call should be placed in a more appropiate
</I>&gt;<i> place, but I don't speak the XML/WS stack fluently enough to find where.
</I>
If your patch does not fix the case that I attached, then yes it is
likely to happen. I'd wait for your case and try to fix it.

&gt;&gt;&gt;<i> 2) When using wsdl2 from latest release of Mono I have the following issues:
</I>&gt;&gt;&gt;<i>  1) When using properties for member access, and field is the same name 
</I>&gt;&gt;&gt;<i> as a keyword it don't prefix the property name with @.
</I>&gt;&gt;<i> Hmm, it would be nice if you file a bug for it. It is kind of corner
</I>&gt;&gt;<i> case, but fixing it would be nicer.
</I>&gt;<i> 
</I>&gt;<i> Will do. Discovered another problem of the same kind. The parser that is
</I>&gt;<i> generated for the WS also have the same problem with types that is named
</I>&gt;<i> after keywords and object, so when Mono tries to compile it it
</I>&gt;<i> encounters a couple of syntax errors.
</I>
Thanks :)

&gt;&gt;&gt;<i>  2) It seems to generate each service binding twice. One with the normal 
</I>&gt;&gt;&gt;<i> name and another with &lt;name&gt;1. I.i
</I>&gt;&gt;&gt;<i>     [System.Web.Services.WebServiceBinding(Name=&quot;packetfront_becs&quot;, 
</I>&gt;&gt;&gt;<i> Namespace=&quot;urn:packetfront_becs&quot;)]
</I>&gt;&gt;&gt;<i>     [System.Diagnostics.DebuggerStepThroughAttribute()]
</I>&gt;&gt;&gt;<i>     [System.ComponentModel.DesignerCategoryAttribute(&quot;code&quot;)]
</I>&gt;&gt;&gt;<i>     public class packetfront_becs : 
</I>&gt;&gt;&gt;<i> System.Web.Services.Protocols.SoapHttpClientProtocol {
</I>&gt;&gt;&gt;<i>      &lt;snip&gt;
</I>&gt;&gt;&gt;<i>     }
</I>&gt;&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i>     [System.Web.Services.WebServiceBinding(Name=&quot;packetfront_becs&quot;, 
</I>&gt;&gt;&gt;<i> Namespace=&quot;urn:packetfront_becs&quot;)]
</I>&gt;&gt;&gt;<i>     [System.Diagnostics.DebuggerStepThroughAttribute()]
</I>&gt;&gt;&gt;<i>     [System.ComponentModel.DesignerCategoryAttribute(&quot;code&quot;)]
</I>&gt;&gt;&gt;<i>     public class packetfront_becs1 : 
</I>&gt;&gt;&gt;<i> System.Web.Services.Protocols.SoapHttpClientProtocol {
</I>&gt;&gt;&gt;<i>      &lt;snip&gt;
</I>&gt;&gt;&gt;<i>     }
</I>&gt;&gt;<i> Do you have test case for this as well? I tried it (from svn) but
</I>&gt;&gt;<i> it didn't happen. Though I remember this kind of duplicate results
</I>&gt;&gt;<i> from those days I was working on Sys.Web.Services in my private
</I>&gt;&gt;<i> branch. It was because of target protocol unawareness on processing
</I>&gt;&gt;<i> bindings.
</I>&gt;<i> 
</I>&gt;<i> Hmm.. ok. Do this mean that there is some error in the WSDL file? I can
</I>&gt;<i> send our WSDL file in private to you if you want to investigate it.
</I>
If you mean what I've experienced, then no, it was bugs in my code
that it produced proxy classes for both SOAP 1.1 and 1.2 profiles.

If you can send me the problematic WSDL, I'll check it :)

&gt;<i> Btw is there a way to have the WS stack reuse same WebRequest object for
</I>&gt;<i> the duration of the program? As it is now it creates a new for
</I>&gt;<i> WebRequest now and then (after a short while of inactivity it seems) and
</I>&gt;<i> this a new TCP connection. I would like it to use HTTP/1.1 Keep-Alive to
</I>&gt;<i> cut down traffic and TCP connections (since my software is a fairly long
</I>&gt;<i> running CLI program that does 50k-100k SOAP calls). I tried overriding
</I>&gt;<i> GetWebRequest(Uri) on the generated WS proxy code to return a singleton
</I>&gt;<i> WebRequest but that only resulting in using a disposed object after a
</I>&gt;<i> short while.
</I>
I'm kind of newbie to this area, but according to the API I guess
it might be possible if you create your own SoapHttpClientProtocol
(derived) class that overrides GetWebRequest() where you return
the same WebRequest whose KeepAlive is enabled, and use replace
SoapHttpClientProtocol with your own class.

Atsushi Eno
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: daniel-svc.cs
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070207/ff4e92c9/attachment.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070207/ff4e92c9/attachment.pl</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022419.html">[Mono-dev] WS stack.
</A></li>
	<LI>Next message: <A HREF="022436.html">[Mono-dev] WS stack.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22433">[ date ]</a>
              <a href="thread.html#22433">[ thread ]</a>
              <a href="subject.html#22433">[ subject ]</a>
              <a href="author.html#22433">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
