<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] WS stack.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WS%20stack.&In-Reply-To=45C9BD5B.10207%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022433.html">
   <LINK REL="Next"  HREF="022437.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] WS stack.</H1>
    <B>Daniel Lundqvist</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WS%20stack.&In-Reply-To=45C9BD5B.10207%40ximian.com"
       TITLE="[Mono-dev] WS stack.">daniel.lundqvist at packetfront.com
       </A><BR>
    <I>Wed Feb  7 08:39:15 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022433.html">[Mono-dev] WS stack.
</A></li>
        <LI>Next message: <A HREF="022437.html">[Mono-dev] WS stack.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22436">[ date ]</a>
              <a href="thread.html#22436">[ thread ]</a>
              <a href="subject.html#22436">[ subject ]</a>
              <a href="author.html#22436">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey again :)

ons 2007-02-07 klockan 20:51 +0900 skrev Atsushi Eno:
&gt;<i> Hi Daniel,
</I>&gt;<i> 
</I>&gt;<i> Daniel Lundqvist wrote:
</I>&gt;<i> &gt; Hi Atsushi,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; m&#229;n 2007-02-05 klockan 15:14 +0900 skrev Atsushi Eno:
</I>&gt;<i> &gt;&gt; Hi Daniel,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Daniel Lundqvist wrote:
</I>&gt;<i> &gt;&gt;&gt; The issue here is that it always sends the oid and parentoid field 
</I>&gt;<i> &gt;&gt;&gt; regardless of value of &lt;field&gt;Specified.
</I>&gt;<i> &gt;&gt;&gt; I got a patch (against SVN) for it, don't know if it's correct but 
</I>&gt;<i> &gt;&gt;&gt; solves the problem for me. So now it only sends oid and parentoid when 
</I>&gt;<i> &gt;&gt;&gt; &lt;field&gt;Specified is set to true. This was tested with 1.1.17.1 but the 
</I>&gt;<i> &gt;&gt;&gt; problem is in SVN as well from what I can see.
</I>&gt;<i> &gt;&gt; Oh, cool. Can you please share the patch so that it could be fixed?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Of course, thought I attached it but I'll reattach it. The problem is
</I>&gt;<i> &gt; that XmlTypeMapMember::CheckOptionalValueType is never called and thus
</I>&gt;<i> &gt; the OPTIONAL bit in its flags field is never set (Which is then checked
</I>&gt;<i> &gt; in XmlSerializationWriterInterpreter::MemberHasValue).
</I>&gt;<i> 
</I>&gt;<i> Thanks :) However, now I tried your patch but it does not seem to
</I>&gt;<i> fix the issue. Do you have actual case that the patch indeed fix
</I>&gt;<i> the issue? I attached what I tried.
</I>
Weird. I've redone my tests with the 1.2.3 release. With a stock
System.Xml.dll it have the problem but with a patched (with the patch I
sent earlier) it don't.

&gt;<i> &gt; There are some other places (I think) that XmlTypeMapMember is
</I>&gt;<i> &gt; instanciated but I didn't add the call there, so this patch only fixes
</I>&gt;<i> &gt; my problem. Perhaps this call should be placed in a more appropiate
</I>&gt;<i> &gt; place, but I don't speak the XML/WS stack fluently enough to find where.
</I>&gt;<i> 
</I>&gt;<i> If your patch does not fix the case that I attached, then yes it is
</I>&gt;<i> likely to happen. I'd wait for your case and try to fix it.
</I>
Now I think I see one issue. Since you are using WebService and
WebMethod attributes perhaps they are hitting the other path that is
calling CreateMapMember(), in ImportMembersMapping in either
XmlReflectionImport.cs or SoapReflectionImport.cs (depends on using
literal encoding or not).

After some more investigation that seems to be the case. From what I can
see the enclosing type is not available at that point (which is needed
to call XmlTypeMapMember::CheckOptionalValueType).

&gt;<i> &gt;&gt;&gt;  2) It seems to generate each service binding twice. One with the normal 
</I>&gt;<i> &gt;&gt;&gt; name and another with &lt;name&gt;1. I.i
</I>&gt;<i> &gt;&gt;&gt;     [System.Web.Services.WebServiceBinding(Name=&quot;packetfront_becs&quot;, 
</I>&gt;<i> &gt;&gt;&gt; Namespace=&quot;urn:packetfront_becs&quot;)]
</I>&gt;<i> &gt;&gt;&gt;     [System.Diagnostics.DebuggerStepThroughAttribute()]
</I>&gt;<i> &gt;&gt;&gt;     [System.ComponentModel.DesignerCategoryAttribute(&quot;code&quot;)]
</I>&gt;<i> &gt;&gt;&gt;     public class packetfront_becs : 
</I>&gt;<i> &gt;&gt;&gt; System.Web.Services.Protocols.SoapHttpClientProtocol {
</I>&gt;<i> &gt;&gt;&gt;      &lt;snip&gt;
</I>&gt;<i> &gt;&gt;&gt;     }
</I>&gt;<i> &gt;&gt;&gt;   
</I>&gt;<i> &gt;&gt;&gt;     [System.Web.Services.WebServiceBinding(Name=&quot;packetfront_becs&quot;, 
</I>&gt;<i> &gt;&gt;&gt; Namespace=&quot;urn:packetfront_becs&quot;)]
</I>&gt;<i> &gt;&gt;&gt;     [System.Diagnostics.DebuggerStepThroughAttribute()]
</I>&gt;<i> &gt;&gt;&gt;     [System.ComponentModel.DesignerCategoryAttribute(&quot;code&quot;)]
</I>&gt;<i> &gt;&gt;&gt;     public class packetfront_becs1 : 
</I>&gt;<i> &gt;&gt;&gt; System.Web.Services.Protocols.SoapHttpClientProtocol {
</I>&gt;<i> &gt;&gt;&gt;      &lt;snip&gt;
</I>&gt;<i> &gt;&gt;&gt;     }
</I>&gt;<i> &gt;&gt; Do you have test case for this as well? I tried it (from svn) but
</I>&gt;<i> &gt;&gt; it didn't happen. Though I remember this kind of duplicate results
</I>&gt;<i> &gt;&gt; from those days I was working on Sys.Web.Services in my private
</I>&gt;<i> &gt;&gt; branch. It was because of target protocol unawareness on processing
</I>&gt;<i> &gt;&gt; bindings.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Hmm.. ok. Do this mean that there is some error in the WSDL file? I can
</I>&gt;<i> &gt; send our WSDL file in private to you if you want to investigate it.
</I>&gt;<i> 
</I>&gt;<i> If you mean what I've experienced, then no, it was bugs in my code
</I>&gt;<i> that it produced proxy classes for both SOAP 1.1 and 1.2 profiles.
</I>&gt;<i> 
</I>&gt;<i> If you can send me the problematic WSDL, I'll check it :)
</I>
Thanks. I'll send that in a separate mail.

Thanks for taking your time with this.

-- 
daniel

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022433.html">[Mono-dev] WS stack.
</A></li>
	<LI>Next message: <A HREF="022437.html">[Mono-dev] WS stack.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22436">[ date ]</a>
              <a href="thread.html#22436">[ thread ]</a>
              <a href="subject.html#22436">[ subject ]</a>
              <a href="author.html#22436">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
