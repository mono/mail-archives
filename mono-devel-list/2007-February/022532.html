<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use locale-dependent decimal separator
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20ASP.NET%20-%20make%20FontUnit%20NOT%20use%0A%20locale-dependent%20decimal%20separator&In-Reply-To=006701c74ee9%241a93d170%244fbb7450%24%40driesen%40telenet.be">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022531.html">
   <LINK REL="Next"  HREF="022557.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use locale-dependent decimal separator</H1>
    <B>Marek Habersack</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20ASP.NET%20-%20make%20FontUnit%20NOT%20use%0A%20locale-dependent%20decimal%20separator&In-Reply-To=006701c74ee9%241a93d170%244fbb7450%24%40driesen%40telenet.be"
       TITLE="[Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use locale-dependent decimal separator">grendello at gmail.com
       </A><BR>
    <I>Mon Feb 12 16:17:13 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022531.html">[Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use	locale-dependent decimal separator
</A></li>
        <LI>Next message: <A HREF="022557.html">[Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use locale-dependent decimal separator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22532">[ date ]</a>
              <a href="thread.html#22532">[ thread ]</a>
              <a href="subject.html#22532">[ subject ]</a>
              <a href="author.html#22532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 12 Feb 2007 22:02:28 +0100, &quot;Gert Driesen&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">gert.driesen at telenet.be</A>&gt;
scribbled:

&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: Marek Habersack [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">grendello at gmail.com</A>]
</I>&gt;<i> &gt; Sent: maandag 12 februari 2007 14:32
</I>&gt;<i> &gt; To: Gert Driesen
</I>&gt;<i> &gt; Cc: 'Mono Development List'
</I>&gt;<i> &gt; Subject: Re: [Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use locale-
</I>&gt;<i> &gt; dependent decimal separator
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; On Sat, 10 Feb 2007 14:28:54 +0100, &quot;Gert Driesen&quot;
</I>&gt;<i> &gt; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">gert.driesen at telenet.be</A>&gt;
</I>&gt;<i> &gt; scribbled:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; &gt; From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; &gt; [mailto:mono-devel-list- <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bounces at lists.ximian.com</A>] On Behalf Of
</I>&gt;<i> &gt; &gt; &gt; Marek Habersack
</I>&gt;<i> &gt; &gt; &gt; Sent: zaterdag 10 februari 2007 6:20
</I>&gt;<i> &gt; &gt; &gt; To: Mono Development List
</I>&gt;<i> &gt; &gt; &gt; Subject: [Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use locale-
</I>&gt;<i> &gt; &gt; &gt; dependent decimal separator
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Hello,
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;   The attached diff fixes the issue mentioned in the subject.
</I>&gt;<i> &gt; &gt; &gt; Currently mono will fail to parse font-size=0.Xem (etc) correctly
</I>&gt;<i> &gt; if
</I>&gt;<i> &gt; &gt; &gt; the current thread culture is set to a locale that uses , as the
</I>&gt;<i> &gt; &gt; &gt; decimal point separator (e.g. de, pl). Please review, thanks
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; This does not match the MS behavior. I've added a unit test to
</I>&gt;<i> &gt; &gt; FontUnitTest.cs to verify this, and fixed FontUnit.ToString() to use
</I>&gt;<i> &gt; &gt; the current locale.
</I>&gt;<i> &gt; Alas, this doesn't fix the problem. Please run xsp2 with the attached
</I>&gt;<i> &gt; test file
</I>&gt;<i> &gt; - you will get an exception thrown, because the Unit constructor cannot
</I>&gt;<i> &gt; parse the passed 0.9em value with cultures which have a decimal
</I>&gt;<i> &gt; separator different to a dot. In other words, Unit (and FontUnit) in
</I>&gt;<i> &gt; mono right now expect culture-dependent input while it gets the CSS
</I>&gt;<i> &gt; decimal font size, which will always use the dot as a separator.
</I>&gt;<i> &gt; ASP.NET parser uses the FontUnit(string) constructor - and that one, in
</I>&gt;<i> &gt; turn, invokes the FontUnit(string, CultureInfo) one. By saying that the
</I>&gt;<i> &gt; behavior is not MS-compatible, are you claiming that Microsoft parse
</I>&gt;<i> &gt; the 0.9em value and turn it into locale-specific form (e.g.
</I>&gt;<i> &gt; 0,9em) before passing it to the first FontUnit constructor above?
</I>&gt;<i> 
</I>&gt;<i> Apparently, MS uses FontUnitConverter.ConvertFromInvariantString to parse
</I>&gt;<i> the value:
</I>&gt;<i> 
</I>[snip]
Looks like this area of Mono needs some love. I will start working on it
tomorrow.

regards,

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070212/c0265c03/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20070212/c0265c03/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022531.html">[Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use	locale-dependent decimal separator
</A></li>
	<LI>Next message: <A HREF="022557.html">[Mono-dev] [PATCH] ASP.NET - make FontUnit NOT use locale-dependent decimal separator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22532">[ date ]</a>
              <a href="thread.html#22532">[ thread ]</a>
              <a href="subject.html#22532">[ subject ]</a>
              <a href="author.html#22532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
