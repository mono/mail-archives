<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Patch for System.Runtime.Remoting.ServerIdentity 
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%20for%20System.Runtime.Remoting.ServerIdentity%20&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015539.html">
   <LINK REL="Next"  HREF="015540.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Patch for System.Runtime.Remoting.ServerIdentity </H1>
    <B>Svetlana Zholkovsky</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%20for%20System.Runtime.Remoting.ServerIdentity%20&In-Reply-To="
       TITLE="[Mono-dev] Patch for System.Runtime.Remoting.ServerIdentity ">svetlanaz at mainsoft.com
       </A><BR>
    <I>Mon Oct 31 07:48:59 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015539.html">[Mono-dev] Patch for problem with	RemotingConfiguration.Configure, when the configuration file contains	custom providers with child elements
</A></li>
        <LI>Next message: <A HREF="015540.html">[Mono-dev] emails in asp.net
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15538">[ date ]</a>
              <a href="thread.html#15538">[ thread ]</a>
              <a href="subject.html#15538">[ subject ]</a>
              <a href="author.html#15538">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I found the following problem with the singleton remote object:
	When the lease of such object is expired, the object is
disconnected from the remoting infrastructure, 
      but it's ServerIdentity continue to hold reference to the server
sink chain, because the DisposeServerObject()
      method does not clear it and so, it will not be recreated for the
new attached singleton object.
      The server sink chain contains in it's last sink
(StackBuilderSink) reference to the old object, and
      all methods are executed on that old object, instead the new.
      It can be tested by trying to get the lease object associated with
the singleton. 
      After the lease is expired for the first time, the following
TestLease() method will fail 
      with NullReferenceException, because it is executed on the old
object and that object is already 
      disconnected from the identity, so
RemotingServices.GetLifetimeService will return null.
     
public class LifecycleTestObject : MarshalbyRefObject
{
	public void TestLease()
	{
			ILease lease =
(ILease)RemotingServices.GetLifetimeService(this);
			lease.Register(new MySponsor());
	}
}

Thanks,
Svetlana
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ServerIdentity.diff
Type: application/octet-stream
Size: 535 bytes
Desc: ServerIdentity.diff
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20051031/f5a9baab/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20051031/f5a9baab/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015539.html">[Mono-dev] Patch for problem with	RemotingConfiguration.Configure, when the configuration file contains	custom providers with child elements
</A></li>
	<LI>Next message: <A HREF="015540.html">[Mono-dev] emails in asp.net
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15538">[ date ]</a>
              <a href="thread.html#15538">[ thread ]</a>
              <a href="subject.html#15538">[ subject ]</a>
              <a href="author.html#15538">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
