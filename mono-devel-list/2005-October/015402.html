<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Re: ImageList patches r51171 and r51889	arenotcompatible with MS.NET behaviour
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20ImageList%20patches%20r51171%20and%20r51889%0A%09arenotcompatible%20with%20MS.NET%20behaviour&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015399.html">
   <LINK REL="Next"  HREF="015400.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Re: ImageList patches r51171 and r51889	arenotcompatible with MS.NET behaviour</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20ImageList%20patches%20r51171%20and%20r51889%0A%09arenotcompatible%20with%20MS.NET%20behaviour&In-Reply-To="
       TITLE="[Mono-dev] Re: ImageList patches r51171 and r51889	arenotcompatible with MS.NET behaviour">kornelpal at hotmail.com
       </A><BR>
    <I>Wed Oct 19 14:14:28 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015399.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
</A></li>
        <LI>Next message: <A HREF="015400.html">[Mono-dev] System.Security.Cryptography : TripleDES  Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15402">[ date ]</a>
              <a href="thread.html#15402">[ thread ]</a>
              <a href="subject.html#15402">[ subject ]</a>
              <a href="author.html#15402">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I'll post the modified version to the list for approval.

I think the current version will not cause any exceptions but may result in
wrong visual appearance so it can be used until the new version will be
approved.

There are no other differences than the documented ones in ImageList.cs if
you think or know that any of them may or can break applications please let
me know.

Korn&#233;l

----- Original Message -----
From: &quot;Jackson Harper&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jackson at ximian.com</A>&gt;
To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at hotmail.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Wednesday, October 19, 2005 7:36 PM
Subject: Re: [Mono-dev] Re: ImageList patches r51171 and r51889
arenotcompatible with MS.NET behaviour


&gt;<i> On Wed, 2005-10-19 at 19:05 +0200, Korn&#233;l P&#225;l wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please read my original message one again.:) I explained the differences
</I>&gt;&gt;<i> between MS.NET and this implementation. This difference is documented in
</I>&gt;&gt;<i> my
</I>&gt;&gt;<i> previous message, in ImageList.cs and was documented when the
</I>&gt;&gt;<i> modifications
</I>&gt;&gt;<i> were approved. And told you that if you think that this difference is
</I>&gt;&gt;<i> important let me know and I will modify ImageList to match MS.NET
</I>&gt;&gt;<i> behaviour.
</I>&gt;&gt;<i> I did not say that everything is the same as in MS.NET I only said that I
</I>&gt;&gt;<i> don't think that MS.NET behaviour should be followed.
</I>&gt;<i>
</I>&gt;<i> Well we need it to be in a state where it does not crash existing
</I>&gt;<i> applictions. Please modify it to match the MS behavoir.  Many apps are
</I>&gt;<i> closed source and we can't modify them to use best practices, so we have
</I>&gt;<i> to match their behavoir as closely as possible.
</I>&gt;<i>
</I>&gt;<i> Jackson
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Usually it's a bad practicle to add images befor setting ColorDepth and
</I>&gt;&gt;<i> Images size but if you do so images will be cleared on Mono currently but
</I>&gt;&gt;<i> will not be cleared on MS.NET if handle was not created yet. Note that on
</I>&gt;&gt;<i> MS.NET if you modify ImageSize after adding images image strips will be
</I>&gt;&gt;<i> added incorrectly (if their size matches new size) or exception will be
</I>&gt;&gt;<i> thrown when creating handle and you will be unable to use the image list.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Your patch should not be retained because images are not modified after
</I>&gt;&gt;<i> handle was created the list is cleared instead.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> And reducing image size without using ReduceColorDepth will result in
</I>&gt;&gt;<i> 32-bit
</I>&gt;&gt;<i> images because of calculated colors.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Korn&#233;l
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----- Original Message -----
</I>&gt;&gt;<i> From: &quot;Jackson Harper&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jackson at ximian.com</A>&gt;
</I>&gt;&gt;<i> To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at hotmail.com</A>&gt;
</I>&gt;&gt;<i> Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;&gt;<i> Sent: Wednesday, October 19, 2005 6:27 PM
</I>&gt;&gt;<i> Subject: [Mono-dev] Re: ImageList patches r51171 and r51889 are
</I>&gt;&gt;<i> notcompatible with MS.NET behaviour
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; On Wed, 2005-10-19 at 11:10 +0200, Korn&#233;l P&#225;l wrote:
</I>&gt;&gt;<i> &gt;&gt; Hi,
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; MS.NET ImageList creates handle when you first time retrieve or draw
</I>&gt;&gt;<i> &gt;&gt; any
</I>&gt;&gt;<i> &gt;&gt; of
</I>&gt;&gt;<i> &gt;&gt; it's images. Until that is stores the original image object, after
</I>&gt;&gt;<i> &gt;&gt; handle
</I>&gt;&gt;<i> &gt;&gt; creation it uses a native ImageList. It applies size and color depth
</I>&gt;&gt;<i> &gt;&gt; when
</I>&gt;&gt;<i> &gt;&gt; handle is created. (This is documented in ImageList.cs.)
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; After handle is created modifying ColorDepth or ImageSize results in
</I>&gt;&gt;<i> &gt;&gt; handle
</I>&gt;&gt;<i> &gt;&gt; recreation and the loss of all images.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; As we don't create any handle at all I decided to create it when
</I>&gt;&gt;<i> &gt;&gt; images
</I>&gt;&gt;<i> &gt;&gt; are
</I>&gt;&gt;<i> &gt;&gt; added and apply size and colordepth when handle is created in other
</I>&gt;&gt;<i> &gt;&gt; words
</I>&gt;&gt;<i> &gt;&gt; when they are added.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Patches r51171 and r51889 are not compatible with MS.NET behaviour as
</I>&gt;&gt;<i> &gt;&gt; they
</I>&gt;&gt;<i> &gt;&gt; don't clear images after handle was created so these modifications
</I>&gt;&gt;<i> &gt;&gt; should
</I>&gt;&gt;<i> &gt;&gt; not be preserved.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Well what you had broke an existing application that runs fine on
</I>&gt;&gt;<i> &gt; MS.NET, so you aren't entirely right.  I'm writing a test application
</I>&gt;&gt;<i> &gt; now to find out when the images are cleared.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Jackson
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;&gt; I belive that caching the images until using them is a bad idea as we
</I>&gt;&gt;<i> &gt;&gt; don't
</I>&gt;&gt;<i> &gt;&gt; use any native image list and doing time consuming operations at
</I>&gt;&gt;<i> &gt;&gt; initializaion is better as if you create an ImageList you do it
</I>&gt;&gt;<i> &gt;&gt; because
</I>&gt;&gt;<i> &gt;&gt; you
</I>&gt;&gt;<i> &gt;&gt; want to access the images.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; If you think caching before handle creation behaviour is important
</I>&gt;&gt;<i> &gt;&gt; after
</I>&gt;&gt;<i> &gt;&gt; considering the above things please let me know and I will implement
</I>&gt;&gt;<i> &gt;&gt; that
</I>&gt;&gt;<i> &gt;&gt; behaviour.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Korn&#233;l
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015399.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
</A></li>
	<LI>Next message: <A HREF="015400.html">[Mono-dev] System.Security.Cryptography : TripleDES  Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15402">[ date ]</a>
              <a href="thread.html#15402">[ thread ]</a>
              <a href="subject.html#15402">[ subject ]</a>
              <a href="author.html#15402">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
