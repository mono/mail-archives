<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20ImageList%20patches%20r51171%20and%20r51889%20are%0A%09notcompatible%20with%20MS.NET%20behaviour&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015397.html">
   <LINK REL="Next"  HREF="015399.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20ImageList%20patches%20r51171%20and%20r51889%20are%0A%09notcompatible%20with%20MS.NET%20behaviour&In-Reply-To="
       TITLE="[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour">kornelpal at hotmail.com
       </A><BR>
    <I>Wed Oct 19 13:05:37 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015397.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are not	compatible with MS.NET behaviour
</A></li>
        <LI>Next message: <A HREF="015399.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15398">[ date ]</a>
              <a href="thread.html#15398">[ thread ]</a>
              <a href="subject.html#15398">[ subject ]</a>
              <a href="author.html#15398">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Please read my original message one again.:) I explained the differences
between MS.NET and this implementation. This difference is documented in my
previous message, in ImageList.cs and was documented when the modifications
were approved. And told you that if you think that this difference is
important let me know and I will modify ImageList to match MS.NET behaviour.
I did not say that everything is the same as in MS.NET I only said that I
don't think that MS.NET behaviour should be followed.

Usually it's a bad practicle to add images befor setting ColorDepth and
Images size but if you do so images will be cleared on Mono currently but
will not be cleared on MS.NET if handle was not created yet. Note that on
MS.NET if you modify ImageSize after adding images image strips will be
added incorrectly (if their size matches new size) or exception will be
thrown when creating handle and you will be unable to use the image list.

Your patch should not be retained because images are not modified after
handle was created the list is cleared instead.

And reducing image size without using ReduceColorDepth will result in 32-bit
images because of calculated colors.

Korn&#233;l

----- Original Message -----
From: &quot;Jackson Harper&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jackson at ximian.com</A>&gt;
To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at hotmail.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Wednesday, October 19, 2005 6:27 PM
Subject: [Mono-dev] Re: ImageList patches r51171 and r51889 are
notcompatible with MS.NET behaviour


&gt;<i> On Wed, 2005-10-19 at 11:10 +0200, Korn&#233;l P&#225;l wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> MS.NET ImageList creates handle when you first time retrieve or draw any
</I>&gt;&gt;<i> of
</I>&gt;&gt;<i> it's images. Until that is stores the original image object, after handle
</I>&gt;&gt;<i> creation it uses a native ImageList. It applies size and color depth when
</I>&gt;&gt;<i> handle is created. (This is documented in ImageList.cs.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> After handle is created modifying ColorDepth or ImageSize results in
</I>&gt;&gt;<i> handle
</I>&gt;&gt;<i> recreation and the loss of all images.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As we don't create any handle at all I decided to create it when images
</I>&gt;&gt;<i> are
</I>&gt;&gt;<i> added and apply size and colordepth when handle is created in other words
</I>&gt;&gt;<i> when they are added.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Patches r51171 and r51889 are not compatible with MS.NET behaviour as
</I>&gt;&gt;<i> they
</I>&gt;&gt;<i> don't clear images after handle was created so these modifications should
</I>&gt;&gt;<i> not be preserved.
</I>&gt;<i>
</I>&gt;<i> Well what you had broke an existing application that runs fine on
</I>&gt;<i> MS.NET, so you aren't entirely right.  I'm writing a test application
</I>&gt;<i> now to find out when the images are cleared.
</I>&gt;<i>
</I>&gt;<i> Jackson
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> I belive that caching the images until using them is a bad idea as we
</I>&gt;&gt;<i> don't
</I>&gt;&gt;<i> use any native image list and doing time consuming operations at
</I>&gt;&gt;<i> initializaion is better as if you create an ImageList you do it because
</I>&gt;&gt;<i> you
</I>&gt;&gt;<i> want to access the images.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you think caching before handle creation behaviour is important after
</I>&gt;&gt;<i> considering the above things please let me know and I will implement that
</I>&gt;&gt;<i> behaviour.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Korn&#233;l
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015397.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are not	compatible with MS.NET behaviour
</A></li>
	<LI>Next message: <A HREF="015399.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15398">[ date ]</a>
              <a href="thread.html#15398">[ thread ]</a>
              <a href="subject.html#15398">[ subject ]</a>
              <a href="author.html#15398">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
