<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20ImageList%20patches%20r51171%20and%20r51889%20are%0A%09notcompatible%20with%20MS.NET%20behaviour&In-Reply-To=004a01c5d4cf%245bac1450%240100a8c0%40kornelpal.hu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015398.html">
   <LINK REL="Next"  HREF="015402.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour</H1>
    <B>Jackson Harper</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20ImageList%20patches%20r51171%20and%20r51889%20are%0A%09notcompatible%20with%20MS.NET%20behaviour&In-Reply-To=004a01c5d4cf%245bac1450%240100a8c0%40kornelpal.hu"
       TITLE="[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour">jackson at ximian.com
       </A><BR>
    <I>Wed Oct 19 13:36:11 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015398.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
</A></li>
        <LI>Next message: <A HREF="015402.html">[Mono-dev] Re: ImageList patches r51171 and r51889	arenotcompatible with MS.NET behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15399">[ date ]</a>
              <a href="thread.html#15399">[ thread ]</a>
              <a href="subject.html#15399">[ subject ]</a>
              <a href="author.html#15399">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 2005-10-19 at 19:05 +0200, Korn&#233;l P&#225;l wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Please read my original message one again.:) I explained the differences
</I>&gt;<i> between MS.NET and this implementation. This difference is documented in my
</I>&gt;<i> previous message, in ImageList.cs and was documented when the modifications
</I>&gt;<i> were approved. And told you that if you think that this difference is
</I>&gt;<i> important let me know and I will modify ImageList to match MS.NET behaviour.
</I>&gt;<i> I did not say that everything is the same as in MS.NET I only said that I
</I>&gt;<i> don't think that MS.NET behaviour should be followed.
</I>
Well we need it to be in a state where it does not crash existing
applictions. Please modify it to match the MS behavoir.  Many apps are
closed source and we can't modify them to use best practices, so we have
to match their behavoir as closely as possible.

Jackson


&gt;<i> Usually it's a bad practicle to add images befor setting ColorDepth and
</I>&gt;<i> Images size but if you do so images will be cleared on Mono currently but
</I>&gt;<i> will not be cleared on MS.NET if handle was not created yet. Note that on
</I>&gt;<i> MS.NET if you modify ImageSize after adding images image strips will be
</I>&gt;<i> added incorrectly (if their size matches new size) or exception will be
</I>&gt;<i> thrown when creating handle and you will be unable to use the image list.
</I>&gt;<i> 
</I>&gt;<i> Your patch should not be retained because images are not modified after
</I>&gt;<i> handle was created the list is cleared instead.
</I>&gt;<i> 
</I>&gt;<i> And reducing image size without using ReduceColorDepth will result in 32-bit
</I>&gt;<i> images because of calculated colors.
</I>&gt;<i> 
</I>&gt;<i> Korn&#233;l
</I>&gt;<i> 
</I>&gt;<i> ----- Original Message -----
</I>&gt;<i> From: &quot;Jackson Harper&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jackson at ximian.com</A>&gt;
</I>&gt;<i> To: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at hotmail.com</A>&gt;
</I>&gt;<i> Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i> Sent: Wednesday, October 19, 2005 6:27 PM
</I>&gt;<i> Subject: [Mono-dev] Re: ImageList patches r51171 and r51889 are
</I>&gt;<i> notcompatible with MS.NET behaviour
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; On Wed, 2005-10-19 at 11:10 +0200, Korn&#233;l P&#225;l wrote:
</I>&gt;<i> &gt;&gt; Hi,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; MS.NET ImageList creates handle when you first time retrieve or draw any
</I>&gt;<i> &gt;&gt; of
</I>&gt;<i> &gt;&gt; it's images. Until that is stores the original image object, after handle
</I>&gt;<i> &gt;&gt; creation it uses a native ImageList. It applies size and color depth when
</I>&gt;<i> &gt;&gt; handle is created. (This is documented in ImageList.cs.)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; After handle is created modifying ColorDepth or ImageSize results in
</I>&gt;<i> &gt;&gt; handle
</I>&gt;<i> &gt;&gt; recreation and the loss of all images.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; As we don't create any handle at all I decided to create it when images
</I>&gt;<i> &gt;&gt; are
</I>&gt;<i> &gt;&gt; added and apply size and colordepth when handle is created in other words
</I>&gt;<i> &gt;&gt; when they are added.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Patches r51171 and r51889 are not compatible with MS.NET behaviour as
</I>&gt;<i> &gt;&gt; they
</I>&gt;<i> &gt;&gt; don't clear images after handle was created so these modifications should
</I>&gt;<i> &gt;&gt; not be preserved.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Well what you had broke an existing application that runs fine on
</I>&gt;<i> &gt; MS.NET, so you aren't entirely right.  I'm writing a test application
</I>&gt;<i> &gt; now to find out when the images are cleared.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Jackson
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; I belive that caching the images until using them is a bad idea as we
</I>&gt;<i> &gt;&gt; don't
</I>&gt;<i> &gt;&gt; use any native image list and doing time consuming operations at
</I>&gt;<i> &gt;&gt; initializaion is better as if you create an ImageList you do it because
</I>&gt;<i> &gt;&gt; you
</I>&gt;<i> &gt;&gt; want to access the images.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If you think caching before handle creation behaviour is important after
</I>&gt;<i> &gt;&gt; considering the above things please let me know and I will implement that
</I>&gt;<i> &gt;&gt; behaviour.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Korn&#233;l
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015398.html">[Mono-dev] Re: ImageList patches r51171 and r51889 are	notcompatible with MS.NET behaviour
</A></li>
	<LI>Next message: <A HREF="015402.html">[Mono-dev] Re: ImageList patches r51171 and r51889	arenotcompatible with MS.NET behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15399">[ date ]</a>
              <a href="thread.html#15399">[ thread ]</a>
              <a href="subject.html#15399">[ subject ]</a>
              <a href="author.html#15399">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
