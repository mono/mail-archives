<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Strong-named assembly built with Linux Mono not	working	with Windows VB Web Application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Strong-named%20assembly%20built%20with%20Linux%20Mono%20not%0A%09working%09with%20Windows%20VB%20Web%20Application&In-Reply-To=e4229a7f0809291043lad5d4abta739b104e7598112%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029264.html">
   <LINK REL="Next"  HREF="029269.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Strong-named assembly built with Linux Mono not	working	with Windows VB Web Application</H1>
    <B>Rolf Bjarne Kvinge</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Strong-named%20assembly%20built%20with%20Linux%20Mono%20not%0A%09working%09with%20Windows%20VB%20Web%20Application&In-Reply-To=e4229a7f0809291043lad5d4abta739b104e7598112%40mail.gmail.com"
       TITLE="[Mono-dev] Strong-named assembly built with Linux Mono not	working	with Windows VB Web Application">rolflists at ya.com
       </A><BR>
    <I>Tue Sep 30 04:20:28 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="029264.html">[Mono-dev] Strong-named assembly built with Linux Mono not	working with Windows VB Web Application
</A></li>
        <LI>Next message: <A HREF="029269.html">[Mono-dev] libgdiplus tutorials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29273">[ date ]</a>
              <a href="thread.html#29273">[ thread ]</a>
              <a href="subject.html#29273">[ subject ]</a>
              <a href="author.html#29273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

 

This seems to be a MS bug (their VB compiler refuses to accept an assembly
their own tools say is valid, and only under certain circumstances), in any
case here is a couple of ideas how to debug:

 

1.       You say the C# assembly is built and signed using Mono, but happens
if you build with Mono and sign with MS (and vice versa)? 

2.       Use ildasm (MS tool) to dump both C# assemblies to disk and compare
the files. You'll probably get a lot of noise here though.

3.       Try to compile the VB Web Site Project from the command line and/or
using codedom to see if you can replicate the issue.

4.       File a bug with MS (good luck with this one J)

 

Rolf

 

From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] On Behalf Of Dean Brettle
Sent: lunes, 29 de septiembre de 2008 19:43
To: mono-devel-list
Subject: [Mono-dev] Strong-named assembly built with Linux Mono not working
with Windows VB Web Application

 

Hi all,

I have a custom web control written in C# that I develop using MonoDevelop
(trunk) and release for use under both Mono (trunk) and .NET.  Under some
circumstances it needs to be installed in the GAC so I sign it.  It works
fine when referenced from a C# or VB.NET Web Site Project and from a C# Web
Application Project, but does not work when referenced from a VB.NET Web
Application Project. The error I get when loading the page with my control
on it is:

Compiler Error Message: BC30652: Reference required to assembly
'Brettle.Web.NeatUpload, Version=1.3.2469.19122, Culture=neutral,
PublicKeyToken=c95290d92c5893c8' containing the type
'Brettle.Web.NeatUpload.MultiFile'. Add one to your project.

The reference is definitely there and if I replace the reference with either
a reference to an unsigned assembly or with a signed assembly built from the
same source using VS 2008 Express SP1, the error goes away.  To sum up, all
of the following need to be true for the error to occur:

1. VB.NET Web Application project, not c# Web Application project or VB.NET
Web Site Project.
2. Assembly is signed.
3. Assembly is built/signed using Mono, not .NET.

Also, if I use .NET's sn.exe (with the -vf option) to verify the signature
on the assembly built/signed with Mono, it says it is valid.

Has anyone else run into this or doese anyone have any suggestions for ways
to diagnose/fix/workaround the problem?

Thanks,
--Dean



No virus found in this incoming message.
Checked by AVG - <A HREF="http://www.avg.com">http://www.avg.com</A>
Version: 8.0.169 / Virus Database: 270.7.1/1686 - Release Date: 28/09/2008
13:30

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080930/e40caa01/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080930/e40caa01/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029264.html">[Mono-dev] Strong-named assembly built with Linux Mono not	working with Windows VB Web Application
</A></li>
	<LI>Next message: <A HREF="029269.html">[Mono-dev] libgdiplus tutorials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29273">[ date ]</a>
              <a href="thread.html#29273">[ thread ]</a>
              <a href="subject.html#29273">[ subject ]</a>
              <a href="author.html#29273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
