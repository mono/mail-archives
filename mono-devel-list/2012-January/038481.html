<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] difference in performance between mono OSX and linux?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20difference%20in%20performance%20between%20mono%20OSX%20and%20linux%3F&In-Reply-To=%3CCACmR%2BBCRmqhKK7pqP1xd-f49g5GQX4L-q1WyJd6XNUx_310F3g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038485.html">
   <LINK REL="Next"  HREF="038483.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] difference in performance between mono OSX and linux?</H1>
    <B>Rodrigo Kumpera</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20difference%20in%20performance%20between%20mono%20OSX%20and%20linux%3F&In-Reply-To=%3CCACmR%2BBCRmqhKK7pqP1xd-f49g5GQX4L-q1WyJd6XNUx_310F3g%40mail.gmail.com%3E"
       TITLE="[Mono-dev] difference in performance between mono OSX and linux?">kumpera at gmail.com
       </A><BR>
    <I>Mon Jan 23 12:27:18 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="038485.html">[Mono-dev] difference in performance between mono OSX and linux?
</A></li>
        <LI>Next message: <A HREF="038483.html">[Mono-dev] difference in performance between mono OSX and linux?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38481">[ date ]</a>
              <a href="thread.html#38481">[ thread ]</a>
              <a href="subject.html#38481">[ subject ]</a>
              <a href="author.html#38481">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mono os OSX has some performance issues due to multiple factors, some
Reimer pointed out, but it's hard to tell without a good profiler run.

Boehm doesn't support the fast memory allocator on OSX.
The lack of compiler support for fast TLS is another pain point, this has
been mostly addressed on trunk so 2.12 will be closer.
Another issue is that OSX primitives are much worse than linux's. Things
like mutex'es and semephores perform much worse.
Finally, the 32 x 64 bits issue can make a huge difference depending on
your code. If you're doing a lot of 64bits math or your
code is register happy, 32bits will be slower.

Jonathan, if you could do an Instruments run on osx and perf on linux of
your add and send the decoded results, it would help a lot troubleshoot
the issue.



On Sat, Jan 21, 2012 at 5:28 PM, Jonathan Shore &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jonathan.shore at gmail.com</A>&gt;wrote:

&gt;<i> I am running a program that does millions of transactions on FIFO queues,
</I>&gt;<i> etc.   Running on my OSX box (which is on a dual CPU / 8 core Xeon E5520)
</I>&gt;<i> and on a linux box which is a core I7-950, I found a significant
</I>&gt;<i> performance difference which is difficult to explain.
</I>&gt;<i>
</I>&gt;<i> On a single threaded run, the OSX based E5520 took 21 seconds to process 8
</I>&gt;<i> million &quot;transactions&quot; and the linux box took only 8 seconds.   The i7-950
</I>&gt;<i> is marginally faster (~10% faster) in typical benchmarks that the E5520.
</I>&gt;<i>
</I>&gt;<i> Both runs were done with -llvm enabled and with the same garbage
</I>&gt;<i> collector.    There are probably 16 - 32 million small objects created
</I>&gt;<i> during the course of this evaluation, but generally with good locality, so
</I>&gt;<i> should be easy to GC.
</I>&gt;<i>
</I>&gt;<i> The *OSX-based mono performance for this app is 3x slower* than the linux
</I>&gt;<i> performance (whereas for typical programs, say in C, the difference would
</I>&gt;<i> be about 10%).   Both the linux and OSX boxes have significant memory (in
</I>&gt;<i> fact the OSX box has more memory).
</I>&gt;<i>
</I>&gt;<i> Finally, the OSX version is using 2.10.8 32bit  and the linux version
</I>&gt;<i> 2.10.6 64bit.  I doubt that there is a retrogression in performance between
</I>&gt;<i> 2.10.6.  Thinking is more likely to be an implementation difference between
</I>&gt;<i> OSX and linux?    I would also think that the 32bit vs 64bit would not make
</I>&gt;<i> all that much difference?
</I>&gt;<i>
</I>&gt;<i> So I am wondering whether there are differences in implementation between
</I>&gt;<i> mono on these platforms that could account for a significant performance
</I>&gt;<i> difference?
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i> Jonathan
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120123/3537a355/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120123/3537a355/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038485.html">[Mono-dev] difference in performance between mono OSX and linux?
</A></li>
	<LI>Next message: <A HREF="038483.html">[Mono-dev] difference in performance between mono OSX and linux?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38481">[ date ]</a>
              <a href="thread.html#38481">[ thread ]</a>
              <a href="subject.html#38481">[ subject ]</a>
              <a href="author.html#38481">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
