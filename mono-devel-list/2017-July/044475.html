<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] TLS 1.2 Client Certificate Authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20TLS%201.2%20Client%20Certificate%20Authentication&In-Reply-To=%3Ca5bad7ff-58c9-de0e-e01f-58dada241b74%40ashr.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="044474.html">
   <LINK REL="Next"  HREF="044477.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] TLS 1.2 Client Certificate Authentication</H1>
    <B>ashr</B> 
    <A HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20TLS%201.2%20Client%20Certificate%20Authentication&In-Reply-To=%3Ca5bad7ff-58c9-de0e-e01f-58dada241b74%40ashr.net%3E"
       TITLE="[Mono-dev] TLS 1.2 Client Certificate Authentication">ashr at ashr.net
       </A><BR>
    <I>Thu Jul 27 12:50:19 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="044474.html">[Mono-dev] Debug asp.net app or dot web service by attaching webserver process locally or remotely
</A></li>
        <LI>Next message (by thread): <A HREF="044477.html">[Mono-dev] Debug Dot net web-service hosted in XSP with mono Develop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44475">[ date ]</a>
              <a href="thread.html#44475">[ thread ]</a>
              <a href="subject.html#44475">[ subject ]</a>
              <a href="author.html#44475">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi guys,

I've been trying to connect to a threat repository to suck intel feeds
down with Mono. The interface use a client certificate and basic authto
validate the connection.

I've played with mono versions from the version that comes with Xenial,
all the way through to Mono JIT compiler version 5.0.1.1. The furthest
I've come was on the latest version, I can see it at least tries to
speak TLS 1.2, but something goes wrong before the Client Key Exchange,
(so I'm  guessing the Server Key exchange fails, wild guess from
wireshark caps, I'm not an expert in SSL handshakes).


This is the code I'm using to set this connection
up:*<A HREF="https://pastebin.com/Ei3bsjdF*">https://pastebin.com/Ei3bsjdF*</A>

* The MyRemoteCertificateValidationCallback validates the server cert
without errorand Mono seems to add the client certificate to the request
just fine as well.

A paste with the error that occurs during runtime (SecureChannelFailure
(Syscall)): *<A HREF="https://pastebin.com/sUXQf9KF*">https://pastebin.com/sUXQf9KF*</A>

Screenshot of wireshark cap of the connection process:
*<A HREF="https://imagebin.ca/v/3UjPy99nEI94*">https://imagebin.ca/v/3UjPy99nEI94*</A>

Screenshot of a wireshark cap of a working connection through python
(Using the same client side certificate connecting to same backend):
*<A HREF="https://imagebin.ca/v/3UjQdz43jKSQ*">https://imagebin.ca/v/3UjQdz43jKSQ*</A>

*
*

When I get some time tonight and during the weekend, I'll try set up a
server with client side auth and test it locally as well, but if any of
you gurus have an idea of what is going wrong or how to troubleshoot
further, please let me know ?


Many thanks

ash

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/mono-devel-list/attachments/20170727/af87d66a/attachment.html">http://lists.dot.net/pipermail/mono-devel-list/attachments/20170727/af87d66a/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="044474.html">[Mono-dev] Debug asp.net app or dot web service by attaching webserver process locally or remotely
</A></li>
	<LI>Next message (by thread): <A HREF="044477.html">[Mono-dev] Debug Dot net web-service hosted in XSP with mono Develop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44475">[ date ]</a>
              <a href="thread.html#44475">[ thread ]</a>
              <a href="subject.html#44475">[ subject ]</a>
              <a href="author.html#44475">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
