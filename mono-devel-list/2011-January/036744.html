<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] File not found error when using	Activator.CreateInstanceFrom()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20File%20not%20found%20error%20when%20using%0A%09Activator.CreateInstanceFrom%28%29&In-Reply-To=E7296238-5BD9-4A6D-8FCA-532FB0BD8764%40vt.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036660.html">
   <LINK REL="Next"  HREF="036745.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] File not found error when using	Activator.CreateInstanceFrom()</H1>
    <B>mike</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20File%20not%20found%20error%20when%20using%0A%09Activator.CreateInstanceFrom%28%29&In-Reply-To=E7296238-5BD9-4A6D-8FCA-532FB0BD8764%40vt.edu"
       TITLE="[Mono-dev] File not found error when using	Activator.CreateInstanceFrom()">mguman at knology.net
       </A><BR>
    <I>Mon Jan 17 11:58:00 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="036660.html">[Mono-dev] File not found error when using Activator.CreateInstanceFrom()
</A></li>
        <LI>Next message: <A HREF="036745.html">[Mono-dev] File not found error when using	Activator.CreateInstanceFrom()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36744">[ date ]</a>
              <a href="thread.html#36744">[ thread ]</a>
              <a href="subject.html#36744">[ subject ]</a>
              <a href="author.html#36744">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Hey John, thanks for the reply. I was compiling the c# test app and test
dlls above from within Visual Studio 2005, taking default options. Options
listed below, although seems this is OBE for you now....

The PATH variable was one of the first things that I checked when I first
ran into this issue. Setting this does indeed work for my small sample
application yet does *not* work for my 'real' application, which is more
complex. It performs the PInvokefrom a plug-in assembly which was loaded via
@Assembly.LoadFrom(). Maybe this is confusing win mono. Unfortunately, I
cannot post detailed code of the real application. I'll have to gin up
another 'test' example. I'll try to post a zip with new sample (see below).
I ran into issues posting attachments to this board. 

I had also hoped that the path specified by the DllImport() call would
suffice for the dependent dll to be found. Seems to work this way running
under .NET so why is this not working under mono 2.8? Wonder what exactly
the difference is between the two....??

---
The MSVS 2005 command line compile options for the C++ dlls are:  

Environ.dll:
/O2 /D &quot;_WINDLL&quot; /GF /FD /EHsc /MD /Gy /Fo&quot;.\Release/&quot; /Fd&quot;.\Release/&quot;
/nologo /c /TP /errorReport:prompt

Test_Native.dll:
/O2 /Ob1 /I &quot;..\Environ&quot; /D &quot;WIN32&quot; /D &quot;NDEBUG&quot; /D &quot;_WINDOWS&quot; /D &quot;_USRDLL&quot;
/D 

&quot;ENVIRONMENT_EXPORTS&quot; /D &quot;_CRT_SECURE_NO_DEPRECATE&quot; /D &quot;_WINDLL&quot; /D &quot;_MBCS&quot; 

/GF /FD /MD /Gy /Fo&quot;Debug\\&quot; /Fd&quot;Debug\vc80.pdb&quot; /W3 /nologo /c /TP 

/errorReport:prompt

The MSVS linker command line options are: 

Test_Native.dll:
/OUT:&quot;..\Release/Test_Native.dll&quot; /INCREMENTAL:NO /NOLOGO /LIBPATH:&quot;..

\release&quot; /DLL /MANIFEST /MANIFESTFILE:&quot;Debug

\Test_Native.dll.intermediate.manifest&quot; /ERRORREPORT:PROMPT Environ.lib  

kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib 

shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib

environ.dll:
/OUT:&quot;..\Release/Environ.dll&quot; /NOLOGO /DLL /MANIFEST
/MANIFESTFILE:&quot;.\Release\Environ.dll.intermediate.manifest&quot;
/ERRORREPORT:PROMPT kernel32.lib user32.lib gdi32.lib winspool.lib
comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib
odbc32.lib odbccp32.lib



-- 
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/File-not-found-error-when-using-Activator-CreateInstanceFrom-tp3064104p3221233.html">http://mono.1490590.n4.nabble.com/File-not-found-error-when-using-Activator-CreateInstanceFrom-tp3064104p3221233.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036660.html">[Mono-dev] File not found error when using Activator.CreateInstanceFrom()
</A></li>
	<LI>Next message: <A HREF="036745.html">[Mono-dev] File not found error when using	Activator.CreateInstanceFrom()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36744">[ date ]</a>
              <a href="thread.html#36744">[ thread ]</a>
              <a href="subject.html#36744">[ subject ]</a>
              <a href="author.html#36744">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
