<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] glibc detected *** mono: double free or corruption
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20glibc%20detected%20%2A%2A%2A%20mono%3A%20double%20free%20or%20corruption&In-Reply-To=013b01c80f2c%24b32c4620%241984d260%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025259.html">
   <LINK REL="Next"  HREF="025275.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] glibc detected *** mono: double free or corruption</H1>
    <B>StApostol</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20glibc%20detected%20%2A%2A%2A%20mono%3A%20double%20free%20or%20corruption&In-Reply-To=013b01c80f2c%24b32c4620%241984d260%24%40com"
       TITLE="[Mono-dev] glibc detected *** mono: double free or corruption">stapostol at gmail.com
       </A><BR>
    <I>Mon Oct 15 09:25:19 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="025259.html">[Mono-dev] glibc detected *** mono: double free or corruption
</A></li>
        <LI>Next message: <A HREF="025275.html">[Mono-dev] glibc detected *** mono: double free or corruption
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25260">[ date ]</a>
              <a href="thread.html#25260">[ thread ]</a>
              <a href="subject.html#25260">[ subject ]</a>
              <a href="author.html#25260">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am receiving the same error message, but in my case I think it is linked
to pinvoking an array of strings (string[]). The error occurs during garbage
collection/object disposal, at application shutdown.

I do have a somewhat simple test-case, but unfortunately it is part of a
larger project. You can download the source code and (release) binaries from
the following link:

<A HREF="https://sourceforge.net/project/platformdownload.php?group_id=177681&amp;sel_platform=4586">https://sourceforge.net/project/platformdownload.php?group_id=177681&amp;sel_platform=4586</A>

Execute Examples.exe and select &quot;Tutorial 10: GLSL Cube&quot; from the listbox.
The error occurs during applicaton shutdown.

The source code for the example can be found online at:
<A HREF="http://opentk.svn.sourceforge.net/viewvc/opentk/tags/0.3.12/Source/Examples/Tutorial/T10_GLSL_Cube.cs?revision=501&amp;view=markup(check">http://opentk.svn.sourceforge.net/viewvc/opentk/tags/0.3.12/Source/Examples/Tutorial/T10_GLSL_Cube.cs?revision=501&amp;view=markup(check</A>
the OnLoad and OnUnload functions).

It seems likely that the problem is linked with the marshalling of structs.
In my case, this happens with the GL.ShaderSource() function inside the
OnLoad method. Its pinvoke signature is as follows:

[DllImport(GL.Library, EntryPoint = &quot;glShaderSource&quot;, ExactSpelling = true),
SuppressUnmanagedCodeSecurity]
internal extern static unsafe void ShaderSource(UInt32 shader, Int32 count,
System.String[] @string, Int32* length);

The C signature is:

void glShaderSource(GLuint shader, GLsizei count, const GLchar **string,
const GLint *length)

Any ideas? I can provide more information as necessary, but I don't believe
I can rewrite a more minimal test-case.



On 10/15/07, Rolf Bjarne Kvinge &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">rolflists at ya.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>
</I>&gt;<i> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] On Behalf Of Abir
</I>&gt;<i> Bhattacharya
</I>&gt;<i> &gt;Sent: lunes, 15 de octubre de 2007 15:00
</I>&gt;<i> &gt;To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt;Subject: [Mono-dev] glibc detected *** mono: double free or corruption
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Hi All,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Am receiving an native crash error like : *** glibc detected *** mono:
</I>&gt;<i> double free or corruption (!prev): 0x08726100 ***. I am trying to call a
</I>&gt;<i> PInvoke to a 'C' method which returns me a struct. I am using Fedora (2.6)
</I>&gt;<i> and have &gt;installed mono from the standard installer :
</I>&gt;<i>
</I>&gt;<i> Could you attach the C and C# code necessary to reproduce this?
</I>&gt;<i>
</I>&gt;<i> Otherwise it's impossible to tell where the problem is.
</I>&gt;<i>
</I>&gt;<i> Rolf
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20071015/2ba64096/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20071015/2ba64096/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025259.html">[Mono-dev] glibc detected *** mono: double free or corruption
</A></li>
	<LI>Next message: <A HREF="025275.html">[Mono-dev] glibc detected *** mono: double free or corruption
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25260">[ date ]</a>
              <a href="thread.html#25260">[ thread ]</a>
              <a href="subject.html#25260">[ subject ]</a>
              <a href="author.html#25260">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
