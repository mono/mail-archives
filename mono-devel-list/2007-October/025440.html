<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] sigc++ signal C# wraper
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20sigc%2B%2B%20signal%20C%23%20wraper&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025515.html">
   <LINK REL="Next"  HREF="025444.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] sigc++ signal C# wraper</H1>
    <B>buhochileno at gmail.com</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20sigc%2B%2B%20signal%20C%23%20wraper&In-Reply-To="
       TITLE="[Mono-dev] sigc++ signal C# wraper">buhochileno at gmail.com
       </A><BR>
    <I>Mon Oct 29 19:58:50 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="025515.html">[Mono-dev] Mono version numbering
</A></li>
        <LI>Next message: <A HREF="025444.html">[Mono-dev] sigc++ signal C# wraper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25440">[ date ]</a>
              <a href="thread.html#25440">[ thread ]</a>
              <a href="subject.html#25440">[ subject ]</a>
              <a href="author.html#25440">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jon:

Sorry again for all the mail troubles and for write you directly to your 
mail, but I trying to resum the post from my previous mono-devel mail 
account.

About the sigc++ C# wraper, please be patient with me, I love 
programming and I really want to learn this kind of wraper (in other 
situation I write little wraper for common inpout/output function), and 
you must know that this is a very difcult subject to find 
documentation...and also recently I learn how manipulate signal/slot in 
C++ code (I know how to work and define Delegates and Events in C#).

First I try to write your test code only to see if I can understad and 
compile the code, so I write the aliendetector.cc class like:
struct AlienDetector { sigc::signal&lt;void&gt; signal_detected;};
extern &quot;C&quot; void* CreateAlienDetector (){ return new AlienDetector ();}
void (*SignalDetectedHandler) ();
extern &quot;C&quot; void AlienDetector_AddSignalDetected (AlienDetector* 
detector, SignalDetectedHandler handler)
{detector-&gt;signal_detected.connect (sigc::ptr_fun(handler));
}

And I add a little dummy &quot;main&quot; only to see if a traditional compiling 
command work:
g++ aliendetector.cc -o aliendetector `pkg-config --cflags --libs 
sigc++-2.0`
//I get...
aliendetector.cc:15: error: &#8216;SignalDetectedHandler&#8217; is not a type
aliendetector.cc: In function &#8216;void 
AlienDetector_AddSignalDetected(AlienDetector*, int)&#8217;:
aliendetector.cc:17: error: no matching function for call to &#8216;ptr_fun(int&amp;)&#8217;
The second error may be is related to the firs &#8216;SignalDetectedHandler&#8217; 
is not a type, I try diferent stuff, but I don't know exactly what can I 
change...
Anyway and only to move forward in the building procees of a shared 
library, I comment the &quot;void (*SignalDetectedHandler) ();&quot; stuff and the 
compilation work, but I have some doubts about it:

I use the following command to get the object code:
g++ -fpic -c aliendetector.cc -Wall -g `pkg-config --cflags --libs 
sigc++-2.0` //for the object code without main
gcc: -lsigc-2.0: linker input file unused because linking not done 
//warning output from the compiler
I think that the warning is correct becouse the linking part of the 
process is not done at this stage, or do I miss something??, becouse if 
I don't add the `pkg-config --cflags --libs sigc++-2.0` I don't get the 
.o file.
So later I do a :
g++ -o libaliendetector.so aliendetector.o -shared -Wl,-Bsymbolic -g 
-lsigc-2.0
At least later the C# code only claim about the
missing entry point &quot;AlienDetector_AddSignalDetected&quot; becouse is 
commented for compilation porpuses...

I'm doing the correct compilation steps?, how can I solve the 
&#8216;SignalDetectedHandler&#8217; is not a type problem?

Also I want to show you a little of my work:
I write this little test header WebCamOrbit.h:
#include &lt;sigc++/sigc++.h&gt;
class WebCamOrbit
{public:
WebCamOrbit(); virtual ~WebCamOrbit();
virtual void SetPanTilt(int, int);
//signal accessor:
typedef sigc::signal&lt;void, int, int&gt; type_OnMove;
type_OnMove OnMove();
protected:
type_OnMove m_OnMove;
};
and the implementation WebCamOrbit.cc:
#include &quot;WebCamOrbit.h&quot;
#include &lt;iostream&gt;
WebCamOrbit::WebCamOrbit(){}
WebCamOrbit::~WebCamOrbit(){}
WebCamOrbit::type_OnMove WebCamOrbit::OnMove()
{ return m_OnMove;}
void WebCamOrbit::SetPanTilt(int pan, int tilt)
{ std::cout &lt;&lt; &quot;WebCamOrbit::SetPanTilt(int, int) : &quot; &lt;&lt; pan &lt;&lt; &quot;, &quot; &lt;&lt; 
tilt &lt;&lt; std::endl;
m_OnMove.emit(pan, tilt);}

Then a &quot;Consumers&quot; class like this:

...//WebCamOrbit wcOrbit;
wcOrbit.OnMove().connect(sigc::mem_fun(this, 
&amp;ImageAnalysis::wcOrbit_OnMove));}
void ImageAnalysis::wcOrbit_OnMove(int pan, int tilt)
{ std::cout &lt;&lt; &quot;the class WebCamOrbit trigger the OnMove signal: &quot; &lt;&lt; 
pan &lt;&lt; &quot;, &quot; &lt;&lt; tilt &lt;&lt; std::endl;
}

this work like a charm in C++, and I need to write a wrapper for the 
signal exposed by the WebCamOrbit class, so I understend that I have to 
build a shared library with this class right?, and then in some how 
write the C# wrapper to allow to a C# programmer to access to this event 
in a traditional .NET/mono way (with delegates and events). Do you have 
any documentation?, sugestion?.
I understend that may be this is to much easy for someone with your 
experience, but this is a really dificult subject to find 
documentation...so Help me Obi-Wan Kenoby..you are my only hope :-).

sincerely, you new Padawan :-)

Mauricio



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025515.html">[Mono-dev] Mono version numbering
</A></li>
	<LI>Next message: <A HREF="025444.html">[Mono-dev] sigc++ signal C# wraper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25440">[ date ]</a>
              <a href="thread.html#25440">[ thread ]</a>
              <a href="subject.html#25440">[ subject ]</a>
              <a href="author.html#25440">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
