<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] libsigc++ signal wrapper
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20libsigc%2B%2B%20signal%20wrapper&In-Reply-To=472539CF.50307%40terra.cl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025428.html">
   <LINK REL="Next"  HREF="025322.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] libsigc++ signal wrapper</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20libsigc%2B%2B%20signal%20wrapper&In-Reply-To=472539CF.50307%40terra.cl"
       TITLE="[Mono-dev] libsigc++ signal wrapper">jonpryor at vt.edu
       </A><BR>
    <I>Sun Oct 28 22:05:05 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="025428.html">[Mono-dev] libsigc++ signal wrapper
</A></li>
        <LI>Next message: <A HREF="025322.html">[Mono-dev] Silverlight/Moonlight questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25429">[ date ]</a>
              <a href="thread.html#25429">[ thread ]</a>
              <a href="subject.html#25429">[ subject ]</a>
              <a href="author.html#25429">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 2007-10-28 at 22:39 -0300, Mauricio Henriquez wrote:
&gt;<i>   Currently, I need to write a wrapper to allow a C# program to connect 
</I>&gt;<i> to a signal exposed in a class that use the libsigc++ library, and I 
</I>&gt;<i> want to ask if you have any idea, suggestion or documentation related to 
</I>&gt;<i> this kind of stuff??
</I>
Events are classes of type sigc::signal, and new events are added via
sigc::signal::connect(const sigc::slot_type&amp;).  So you need to a way to
get a sigc::slot_type.

Conveniently enough, libsigc++ provides sigc::ptr_fun() which takes a
pointer to a function and creates a sigc::slot_type for it.

So something like this (untested) code should suffice:

	// C++
	struct AlienDetector {
	  sigc::signal&lt;void&gt; signal_detected;
	};

	extern &quot;C&quot; void* CreateAlienDetector ()
	{
	    return new AlienDetector ();
	}

	void (*SignalDetectedHandler) ();

	extern &quot;C&quot; void AlienDetector_AddSignalDetected (
		AlienDetector* detector,
		SignalDetectedHandler handler)
	{
	    detector-&gt;signal_detected.connect (sigc::ptr_fun(handler));
	}

	// C#
	using System.Runtime.InteropServices;
	delegate void SignalDetectedHandler ();
	class Demo {
	    [DllImport (&quot;...&quot;)] static extern IntPtr
	        CreateAlienDetector ();
	    [DllImport (&quot;...&quot;)] static extern void
	        AlienDetector_AddSignalDetected (
	            IntPtr detector, SignalDetectedHandler h);

	    static void MyHandler ()
	    {
	        Console.WriteLine (&quot;Managed Code Invoked!&quot;);
	    }

	    static void Main ()
	    {
	        IntPtr d = CreateAlienDetector ();
	        AlienDetector_AddSignalDetected (d, MyHandler);
	    }
	}

 - Jon



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025428.html">[Mono-dev] libsigc++ signal wrapper
</A></li>
	<LI>Next message: <A HREF="025322.html">[Mono-dev] Silverlight/Moonlight questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25429">[ date ]</a>
              <a href="thread.html#25429">[ thread ]</a>
              <a href="subject.html#25429">[ subject ]</a>
              <a href="author.html#25429">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
