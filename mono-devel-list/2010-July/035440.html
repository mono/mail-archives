<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Fwd: [Mono-patches] r160111 - trunk/mono/mono/mini
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Fwd%3A%20%5BMono-patches%5D%20r160111%20-%20trunk/mono/mono/mini&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035458.html">
   <LINK REL="Next"  HREF="035441.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Fwd: [Mono-patches] r160111 - trunk/mono/mono/mini</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Fwd%3A%20%5BMono-patches%5D%20r160111%20-%20trunk/mono/mono/mini&In-Reply-To="
       TITLE="[Mono-dev] Fwd: [Mono-patches] r160111 - trunk/mono/mono/mini">atsushieno at veritas-vos-liberabit.com
       </A><BR>
    <I>Tue Jul 13 02:13:58 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035458.html">[Mono-dev] Registering internal calls at runtime
</A></li>
        <LI>Next message: <A HREF="035441.html">[Mono-dev] Ambiguity between SoapTypeAttribute and SoapAttribute
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35440">[ date ]</a>
              <a href="thread.html#35440">[ thread ]</a>
              <a href="subject.html#35440">[ subject ]</a>
              <a href="author.html#35440">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Rolf,

Doesn't this change affect on all of those who build mono 
--with-moonlight=yes, even if they after all use the runtime as 
non-moonlight profile with this buffering? IMO, if the change is not 
harmful, this should be enabled regardless of the profile. If it in fact 
is, then there should be another approach to be taken e.g. run-time 
platform detection, or build different object for libmono and libmono-moon.

Oh, and it doesn't build on Windows. I disabled it so far.

Atsushi Eno

-------- Original Message --------
Subject: 	[Mono-patches] r160111 - trunk/mono/mono/mini
Date: 	Fri, 9 Jul 2010 05:44:32 -0400 (EDT)
From: 	Rolf Bjarne Kvinge (<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">rolfkvinge at ya.com</A>) 
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-patches-list at lists.ximian.com</A>&gt;
To: 	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-patches at lists.ximian.com</A>, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ximian.monolist at gmail.com</A>, 
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-svn-patches-garchive-20758 at googlegroups.com</A>



Author: rolf
Date: 2010-07-09 05:44:32 -0400 (Fri, 09 Jul 2010)
New Revision: 160111

Modified:
    trunk/mono/mono/mini/ChangeLog
    trunk/mono/mono/mini/driver.c
Log:
2010-07-09  Rolf Bjarne Kvinge&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">RKvinge at novell.com</A>&gt;

	* driver.c: Moonlight: Force line buffering for stdout.

Modified: trunk/mono/mono/mini/ChangeLog
===================================================================
--- trunk/mono/mono/mini/ChangeLog	2010-07-09 09:40:59 UTC (rev 160110)
+++ trunk/mono/mono/mini/ChangeLog	2010-07-09 09:44:32 UTC (rev 160111)
@@ -1,3 +1,7 @@
+2010-07-09  Rolf Bjarne Kvinge&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">RKvinge at novell.com</A>&gt;
+
+	* driver.c: Moonlight: Force line buffering for stdout.
+
  2010-07-09  Zoltan Varga&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vargaz at gmail.com</A>&gt;

  	* mini-llvm.c (emit_load): Revert the last changes, the load/store intrinsics

Modified: trunk/mono/mono/mini/driver.c
===================================================================
--- trunk/mono/mono/mini/driver.c	2010-07-09 09:40:59 UTC (rev 160110)
+++ trunk/mono/mono/mini/driver.c	2010-07-09 09:44:32 UTC (rev 160111)
@@ -1316,6 +1316,13 @@
  	int test_jit_info_table = FALSE;
  #endif

+#ifdef MOONLIGHT
+	/* stdout defaults to block buffering if it's not writing to a terminal, which
+	 * happens with our test harness: we redirect stdout to capture it. Force line
+	 * buffering in all cases. */
+	setlinebuf (stdout);
+#endif
+
  	setlocale (LC_ALL, &quot;&quot;);

  	vm_config = getenv (&quot;MONO_VM_CONFIG&quot;);

_______________________________________________
Mono-patches maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-patches at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-patches">http://lists.ximian.com/mailman/listinfo/mono-patches</A>




</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035458.html">[Mono-dev] Registering internal calls at runtime
</A></li>
	<LI>Next message: <A HREF="035441.html">[Mono-dev] Ambiguity between SoapTypeAttribute and SoapAttribute
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35440">[ date ]</a>
              <a href="thread.html#35440">[ thread ]</a>
              <a href="subject.html#35440">[ subject ]</a>
              <a href="author.html#35440">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
