<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Embedding Mono into C++
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Embedding%20Mono%20into%20C%2B%2B&In-Reply-To=4C4AD42E.7090601%40unity3d.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035503.html">
   <LINK REL="Next"  HREF="035505.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Embedding Mono into C++</H1>
    <B>Frank Fuchs</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Embedding%20Mono%20into%20C%2B%2B&In-Reply-To=4C4AD42E.7090601%40unity3d.com"
       TITLE="[Mono-dev] Embedding Mono into C++">fk.fuchs at googlemail.com
       </A><BR>
    <I>Sat Jul 24 09:11:57 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035503.html">[Mono-dev] Embedding Mono into C++
</A></li>
        <LI>Next message: <A HREF="035505.html">[Mono-dev] Embedding Mono into C++
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35504">[ date ]</a>
              <a href="thread.html#35504">[ thread ]</a>
              <a href="subject.html#35504">[ subject ]</a>
              <a href="author.html#35504">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Lucas,

thank you very much! 
Implementing your answer mad me stumble over this one <A HREF="https://bugzilla.novell.com/show_bug.cgi?id=624498.">https://bugzilla.novell.com/show_bug.cgi?id=624498.</A>
Did you find a workaround? Win7 is one of my deployment platforms.

On a related note is there a way to invoke the mcs compiler from within the code to compile some .cs file.
Of course one could try to invoke mcs with a system call or ExecuteProcess but is there something more convenient? 
As far as I read about the evaluator it seems not to so well suited for this purpose since i don't want/ need line-by-line action or repl.

-Frank


Am 24.07.2010 um 13:53 schrieb Lucas Meijer:

&gt;<i> Hey Frank,
</I>&gt;&gt;<i> I want to test mono for embedding it into my C++ application. I was following the articles <A HREF="http://www.mono-project.com/Scripting_With_Mono,">http://www.mono-project.com/Scripting_With_Mono,</A> <A HREF="http://www.mono-project.com/Embedding_Mono">http://www.mono-project.com/Embedding_Mono</A> and the examples here <A HREF="http://anonsvn.mono-project.com/viewvc/trunk/mono/samples/embed/.">http://anonsvn.mono-project.com/viewvc/trunk/mono/samples/embed/.</A>
</I>&gt;&gt;<i> So far everything worked well, although I don't understand the restriction for mono_jit_init to be callable just once.
</I>&gt;&gt;<i> So I'm able to load assemblies into the domain and run them, as well as expose some c methods to the Jit. It is possible to load different assemblies, but obviously each assembly can be loaded only once. If the assembly changes on disk after the first load calling mono_domain_assembly_open again, does not reload the changed assembly.
</I>&gt;&gt;<i> Is there any way to achieve the reloading?
</I>&gt;<i> You can only call mono_jit_init() once.  However you can achieve what you want by creating a new domain (mono_domain_create()),  and loading your assemblies in that domain.  when you decide you want to reload an assembly, you would need to unload your domain, and create a new one again in which you can load your updated assembly.   (on win32, you need to make sure you load your assembly into memory first, and ask mono to load it from memory, otherwise it will keep a lock on the on disk assembly, preventing another process from overwriting it).
</I>&gt;<i> 
</I>&gt;<i> This does mean that you basically loose all your instantiated objects and program state.   Depending on what problem you're trying to solve, you can try to somehow store your program's state,  then unload domain, recreate domain,  and then somehow restore your program's state.  that's what we do in unity.
</I>&gt;<i> 
</I>&gt;<i> Be aware that there's quite significant memory leaks currently when unloading a domain.  It's mostly leaking wrapper functions in marshall.c. Depending how on much code you've jitted it might or might not become enough to be a problem.
</I>&gt;<i> 
</I>&gt;<i> Bye, Lucas
</I>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035503.html">[Mono-dev] Embedding Mono into C++
</A></li>
	<LI>Next message: <A HREF="035505.html">[Mono-dev] Embedding Mono into C++
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35504">[ date ]</a>
              <a href="thread.html#35504">[ thread ]</a>
              <a href="subject.html#35504">[ subject ]</a>
              <a href="author.html#35504">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
