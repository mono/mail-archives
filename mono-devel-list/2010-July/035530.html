<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] The new world of Git -- what else can we change :-)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20The%20new%20world%20of%20Git%20--%20what%20else%20can%20we%20change%20%3A-%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035529.html">
   <LINK REL="Next"  HREF="035531.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] The new world of Git -- what else can we change :-)</H1>
    <B>Raja R Harinath</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20The%20new%20world%20of%20Git%20--%20what%20else%20can%20we%20change%20%3A-%29&In-Reply-To="
       TITLE="[Mono-dev] The new world of Git -- what else can we change :-)">harinath at hurrynot.org
       </A><BR>
    <I>Wed Jul 28 02:16:11 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035529.html">[Mono-dev] The new world of Git -- what else can we change :-)
</A></li>
        <LI>Next message: <A HREF="035531.html">[Mono-dev] The new world of Git -- what else can we change :-)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35530">[ date ]</a>
              <a href="thread.html#35530">[ thread ]</a>
              <a href="subject.html#35530">[ subject ]</a>
              <a href="author.html#35530">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Avery Pennarun &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">apenwarr at gmail.com</A>&gt; writes:

&gt;<i> On Tue, Jul 27, 2010 at 3:11 PM, Raja R Harinath &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">harinath at hurrynot.org</A>&gt; wrote:
</I>&gt;&gt;<i> * clean up the main repos
</I>[snip]
&gt;&gt;<i> My proposal is to
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; (a) create a read-only set of fork/clones at github.com/historic-mono
</I>&gt;&gt;<i> &#160; (b) remove all inactive branches from the repos in github.com/mono
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This might also reduce the cost of a fresh clone by a few MB :-)
</I>&gt;<i>
</I>&gt;<i> Removing stuff from the main repo is kind of a shame if you don't have
</I>&gt;<i> to do it.  On one project I was working on, we simply went through all
</I>&gt;<i> the dead branches and created tags under attic/ for each one, then
</I>&gt;<i> deleted the branches.  This leaves you with some cruddy tags, but tags
</I>&gt;<i> are much easier to ignore than branches because you're mostly not
</I>&gt;<i> looking at them.
</I>
I think we mostly have the tags in place.  So, deleting the branches
should be OK.

&gt;&gt;<i> Git allows a very nice workflow that works well if the tips of the
</I>&gt;&gt;<i> maintenance branches are ancestors of the tip of development branch.
</I>&gt;&gt;<i> Now, to enable this workflow, I propose to perform the following
</I>&gt;&gt;<i> commits -- these are one-time only, and enable the nice workflow.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; &#160; git checkout mono-2-6
</I>&gt;&gt;<i> &#160; &#160; &#160; git merge -s ours mono-2-4
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; &#160; git checkout master
</I>&gt;&gt;<i> &#160; &#160; &#160; git merge -s ours mono-2-6
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The '-s ours' ensures that the contents are not merged, only the branch
</I>&gt;&gt;<i> ancestry is fixed.
</I>&gt;<i>
</I>&gt;<i> Be very careful when using '-s ours'.  
</I>
Yep.  That's why I said &quot;one-time only&quot;.

&gt;<i> Usually git-svn isn't too bad about figuring out the branch history,
</I>&gt;<i> so it *may* be possible to do a merge without -s ours, then figure out
</I>&gt;<i> the conflicts, then move on.
</I>
True.  Even now, it's &quot;possible&quot;, but such a merge will show a lot more
conflicts since we have 100s of commits on the maintenance branches
since they forked off.

&gt;<i> That said, in general this can be an okay idea if you really want to
</I>&gt;<i> be able to do future merges from the release branches into master.
</I>
Exactly, it makes it easier on future merges.  Right now, if things are
as-is, we leave the burden to the first person who comes along and tries
the nice possibility.  The 100 commit merge conflict will teach the
wrong lesson, by scaring them away from using git the right way.

&gt;&gt;<i> Basically, the workflow is to never[1] commit directly on a branch tracking
</I>&gt;&gt;<i> an origin branch.
</I>[snip commands]
&gt;<i>
</I>&gt;<i> I've personally found this workflow to be a lot of extra work for
</I>&gt;<i> little gain, and certainly:
</I>
We've already seen issues with unintended (but safe) merges causing
confusion -- the confusion is exacerbated by the GitHub UI showing 'git
diff --first-parent' on merge commits, rather than something more symmetric.

There were also questions like: how to easily backport of the top three
_new_ commits on &quot;master&quot; to &quot;mono-2-6&quot;, etc.  Having the top three
commits on a branch instead of directly on master would've made it
easier to guess at the right answer

       git rebase --onto mono-2-6 master fix

So, the &quot;throwaway branch&quot;-oriented workflow is useful in itself, even
without other workflow changes.

&gt;&gt;<i> [2] The idea is that you should never[1] have a merge message that reads
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160;&quot;Merge from <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">git at github.com</A>/mono/mono:master&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160;That's useless. &#160;All merges should either be fast-forwards, or look like
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160;&quot;Merge from fix-bug-555555&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160;IOW, eminently readable
</I>&gt;<i>
</I>&gt;<i> This doesn't really make any difference.  Eventually you learn to
</I>&gt;<i> mostly just ignore merge commits anyway.  The real value isn't in the
</I>&gt;<i> merge commit, but in the stuff that it merges, and that's visible in
</I>&gt;<i> 'git log'.
</I>
That's why this is an aside ;-)  But, your comment highlights again the
main good thing about the &quot;fix on maint, merge to master&quot; workflow.

- Hari

</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035529.html">[Mono-dev] The new world of Git -- what else can we change :-)
</A></li>
	<LI>Next message: <A HREF="035531.html">[Mono-dev] The new world of Git -- what else can we change :-)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35530">[ date ]</a>
              <a href="thread.html#35530">[ thread ]</a>
              <a href="subject.html#35530">[ subject ]</a>
              <a href="author.html#35530">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
