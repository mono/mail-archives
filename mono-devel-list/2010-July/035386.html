<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Problem in SvcHttpHandler.cs ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problem%20in%20SvcHttpHandler.cs%20%3F&In-Reply-To=AANLkTimr94FH1PHPOy7SuWx-2XO15ckRJhlo4zuPBgXr%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035385.html">
   <LINK REL="Next"  HREF="035399.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Problem in SvcHttpHandler.cs ?</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problem%20in%20SvcHttpHandler.cs%20%3F&In-Reply-To=AANLkTimr94FH1PHPOy7SuWx-2XO15ckRJhlo4zuPBgXr%40mail.gmail.com"
       TITLE="[Mono-dev] Problem in SvcHttpHandler.cs ?">atsushieno at veritas-vos-liberabit.com
       </A><BR>
    <I>Fri Jul  2 14:54:17 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035385.html">[Mono-dev] Proposed Patch - Google Native Client
</A></li>
        <LI>Next message: <A HREF="035399.html">[Mono-dev] Problem in SvcHttpHandler.cs ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35386">[ date ]</a>
              <a href="thread.html#35386">[ thread ]</a>
              <a href="subject.html#35386">[ subject ]</a>
              <a href="author.html#35386">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Right, thanks for the analysis, that should be fixed, and I have an 
idea. Though I am now rewriting ASP.NET channel support based on our new 
HTTP (non-ASP.NET) channel stack and it does not use the code path you 
mentioned, I'd rather finish the rewrite first and then fix the actual 
issue.

The idea above is to use Uri comparison using UriComponents based on 
HostNameComparisonMode value (which is ignored so far).

Atsushi Eno

On 2010/06/29 21:46, Thiago Padilha wrote:
&gt;<i>     Hi,
</I>&gt;<i>
</I>&gt;<i>     I'm hosting a WCF service using asp.net/mono from trunk (r159644)
</I>&gt;<i> but encountered a problem when accessing the service from a virtual
</I>&gt;<i> machine :
</I>&gt;<i>
</I>&gt;<i> &quot;
</I>&gt;<i>    The argument HTTP context did not match any of the registered
</I>&gt;<i> listener manager (could be mismatch in URL, method etc.)
</I>&gt;<i> <A HREF="http://172.16.122.2:8080/Person.svc">http://172.16.122.2:8080/Person.svc</A>
</I>&gt;<i>
</I>&gt;<i> Description: HTTP 500. Error processing request.
</I>&gt;<i>
</I>&gt;<i> Stack Trace:
</I>&gt;<i>
</I>&gt;<i> System.InvalidOperationException: The argument HTTP context did not
</I>&gt;<i> match any of the registered listener manager (could be mismatch in
</I>&gt;<i> URL, method etc.) <A HREF="http://172.16.122.2:8080/Person.svc">http://172.16.122.2:8080/Person.svc</A>
</I>&gt;<i>    at System.ServiceModel.Channels.SvcHttpHandler.FindBestMatchListener
</I>&gt;<i> (System.Web.HttpContext ctx) [0x00120] in
</I>&gt;<i> /home/thiago/monotrunk/mcs/class/System.ServiceModel/System.ServiceModel.Channels/SvcHttpHandler.cs:141
</I>&gt;<i>    at System.ServiceModel.Channels.SvcHttpHandler.ProcessRequest
</I>&gt;<i> (System.Web.HttpContext context) [0x0000d] in
</I>&gt;<i> /home/thiago/monotrunk/mcs/class/System.ServiceModel/System.ServiceModel.Channels/SvcHttpHandler.cs:156
</I>&gt;<i>    at System.Web.HttpApplication+&lt;Pipeline&gt;c__Iterator2.MoveNext ()
</I>&gt;<i> [0x00ce5] in /home/thiago/monotrunk/mcs/class/System.Web/System.Web/HttpApplication.cs:1344
</I>&gt;<i>    at System.Web.HttpApplication.Tick () [0x00000] in
</I>&gt;<i> /home/thiago/monotrunk/mcs/class/System.Web/System.Web/HttpApplication.cs:914
</I>&gt;<i> &quot;
</I>&gt;<i>
</I>&gt;<i>   I think this happened because I tried to access the service trough
</I>&gt;<i> the &quot;172.16.122.0&quot; network which is the virtual network for my VMs.
</I>&gt;<i> The service works well if I access it on the local machine using the
</I>&gt;<i> &quot;<A HREF="http://127.0.0.1:8080/Person.svc&quot;">http://127.0.0.1:8080/Person.svc&quot;</A> Url, but fails with the same error
</I>&gt;<i> if I use &quot;<A HREF="http://localhost:8080/Person.svc&quot;.">http://localhost:8080/Person.svc&quot;.</A> After looking into the
</I>&gt;<i> source code I think the problem may be on the following conditionals
</I>&gt;<i> (method 'FindBestMatchListener') :
</I>&gt;<i>
</I>&gt;<i> &quot;
</I>&gt;<i> if (l.Uri.Equals (ctx.Request.Url)) {
</I>&gt;<i> 					best = l;
</I>&gt;<i> 					break;
</I>&gt;<i> 				}
</I>&gt;<i> //
</I>&gt;<i> if (!ctx.Request.Url.ToString ().StartsWith (l.Uri.ToString (),
</I>&gt;<i> StringComparison.Ordinal))
</I>&gt;<i> 					continue;
</I>&gt;<i> &quot;
</I>&gt;<i>
</I>&gt;<i> Maybe it should check the Uris for all the network interfaces?(I have
</I>&gt;<i> no idea on how to do that).
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>    
</I>
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035385.html">[Mono-dev] Proposed Patch - Google Native Client
</A></li>
	<LI>Next message: <A HREF="035399.html">[Mono-dev] Problem in SvcHttpHandler.cs ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35386">[ date ]</a>
              <a href="thread.html#35386">[ thread ]</a>
              <a href="subject.html#35386">[ subject ]</a>
              <a href="author.html#35386">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
