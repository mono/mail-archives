<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] How to improve Dataset Performance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20How%20to%20improve%20Dataset%20Performance&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033622.html">
   <LINK REL="Next"  HREF="033687.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] How to improve Dataset Performance</H1>
    <B>APS</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20How%20to%20improve%20Dataset%20Performance&In-Reply-To="
       TITLE="[Mono-dev] How to improve Dataset Performance">dev.malst at apsystems.it
       </A><BR>
    <I>Wed Dec  9 08:09:25 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033622.html">[Mono-dev] How to improve Dataset Performance
</A></li>
        <LI>Next message: <A HREF="033687.html">[Mono-dev] How to improve Dataset Performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33683">[ date ]</a>
              <a href="thread.html#33683">[ thread ]</a>
              <a href="subject.html#33683">[ subject ]</a>
              <a href="author.html#33683">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>For sure I can pass a test case, is better that I file a bug report? 
I think that Mono team already knows where datasets are slower than 
MS.Net and maybe can suggest me some &quot;best practice&quot;.
Btw with the code provided below with MS.Net on a standard developer 
machine and Mono on a bi-processor testing machine (with 2GB of ram):

1000 rows
MS.Net: 130ms
Mono 2.4.3:  1.2s
Mono 2.0.1:  3.5s

10.000 rows
MS.Net: less than a second
Mono 2.4.3: 114s
Mono 2.0.1: 361s

I have tables with more than 50.000 rows...I don't know how much it 
takes to perform the elaboration. RowFilter speed up only if applied 
on small rowsets.
The problem is in the .Select method, removing those lines the 
elaboration is quicker in Mono. Testing machines are not with the 
same resources but the difference is too much to think to an hardware 
difference.
Here is the code...

             DataSet ds1 = new DataSet();
             ds1.Tables.Add();
             ds1.Tables[0].Columns.Add(&quot;COL1&quot;, typeof(string));
             ds1.Tables[0].Columns.Add(&quot;COL2&quot;, typeof(int));
             ds1.Tables[0].Columns.Add(&quot;COL3&quot;, typeof(bool));
             for (int i = 0; i &lt; 10000; i++) {
                 ds1.Tables[0].Rows.Add(new object[] { &quot;test&quot;, i, true });
             }
             DataSet ds2 = new DataSet();
             ds2.Tables.Add();
             ds2.Tables[0].Columns.Add(&quot;COL1&quot;, typeof(string));
             ds2.Tables[0].Columns.Add(&quot;COL2&quot;, typeof(int));
             ds2.Tables[0].Columns.Add(&quot;COL3&quot;, typeof(bool));
             for (int i = 0; i &lt; 10000; i++) {
                 ds2.Tables[0].Rows.Add(new object[] { &quot;test&quot;, i, true });
             }
             DataSet ds3 = new DataSet();
             ds3.Tables.Add();
             ds3.Tables[0].Columns.Add(&quot;COL1&quot;, typeof(string));
             ds3.Tables[0].Columns.Add(&quot;COL2&quot;, typeof(int));
             ds3.Tables[0].Columns.Add(&quot;COL3&quot;, typeof(bool));
             for (int i = 0; i &lt; 10000; i++) {
                 ds3.Tables[0].Rows.Add(new object[] { &quot;test&quot;, i, true });
             }
             int idx=0;
             foreach (DataRow dr in ds1.Tables[0].Rows) {
                 DataRow[] dr2 = ds2.Tables[0].Select(&quot;COL2=&quot; + idx);
                 DataRow[] dr3 = ds3.Tables[0].Select(&quot;COL2=&quot; + idx);

                 idx++;
             }




At 21.59 02/12/2009, Nagappan Alagappan wrote:
&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>Do you have a test case to reproduce this issue, which you could 
</I>&gt;<i>share with the Mono team ?
</I>&gt;<i>
</I>&gt;<i>Thanks
</I>&gt;<i>Nagappan
</I>&gt;<i>
</I>&gt;<i>On Wed, Dec 2, 2009 at 4:05 AM, APS 
</I>&gt;<i>&lt;&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">dev.malst at apsystems.it</A>&gt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">dev.malst at apsystems.it</A>&gt; wrote:
</I>&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>I'm testing some old elaboration that cycles on a large datatable and
</I>&gt;<i>for every rows makes several selections on separated datatables.
</I>&gt;<i>This elaboration is really slow on mono and fast on 
</I>&gt;<i>&lt;<A HREF="http://MS.NET">http://MS.NET</A>&gt;MS.NET, let say
</I>&gt;<i>400secs vs 4 secs.
</I>&gt;<i>It seems that last rows are slower that first rows.
</I>&gt;<i>I made some test on datasets scroll and I saw that mono performance
</I>&gt;<i>is better than &lt;<A HREF="http://MS.NET">http://MS.NET</A>&gt;MS.NET so the delay is due to inner selections.
</I>&gt;<i>I changed datatable.select in defaultview.sort and I gained 200secs,
</I>&gt;<i>still too slow.
</I>&gt;<i>Now I've identified some datatable.compute as the main delay source.
</I>&gt;<i>I'll try to change them using Linq but the question is: there's some
</I>&gt;<i>known performance problem in dataset heavy usage, there's some best
</I>&gt;<i>pratice that you can suggest to speed up elaborations?
</I>&gt;<i>Thanks in advance.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-devel-list mailing list
</I>&gt;<i>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>Linux Desktop (GUI Application) Testing Project - 
</I>&gt;<i>&lt;<A HREF="http://ldtp.freedesktop.org">http://ldtp.freedesktop.org</A>&gt;<A HREF="http://ldtp.freedesktop.org">http://ldtp.freedesktop.org</A>
</I>&gt;<i><A HREF="http://nagappanal.blogspot.com">http://nagappanal.blogspot.com</A>
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>Il messaggio e' stato analizzato alla ricerca di virus o
</I>&gt;<i>contenuti pericolosi da &lt;<A HREF="http://www.mailscanner.info/">http://www.mailscanner.info/</A>&gt;MailScanner, ed e'
</I>&gt;<i>risultato non infetto.
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091209/3fec0d9d/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091209/3fec0d9d/attachment-0001.html</A> 
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033622.html">[Mono-dev] How to improve Dataset Performance
</A></li>
	<LI>Next message: <A HREF="033687.html">[Mono-dev] How to improve Dataset Performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33683">[ date ]</a>
              <a href="thread.html#33683">[ thread ]</a>
              <a href="subject.html#33683">[ subject ]</a>
              <a href="author.html#33683">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
