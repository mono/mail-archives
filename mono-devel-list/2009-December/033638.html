<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Bind d(n)gettext in Mono.Unix.Catalog
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Bind%20d%28n%29gettext%20in%20Mono.Unix.Catalog&In-Reply-To=1259842936.31042.96.camel%40dogbert.home">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033634.html">
   <LINK REL="Next"  HREF="033639.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Bind d(n)gettext in Mono.Unix.Catalog</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Bind%20d%28n%29gettext%20in%20Mono.Unix.Catalog&In-Reply-To=1259842936.31042.96.camel%40dogbert.home"
       TITLE="[Mono-dev] [PATCH] Bind d(n)gettext in Mono.Unix.Catalog">jonpryor at vt.edu
       </A><BR>
    <I>Thu Dec  3 13:09:30 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033634.html">[Mono-dev] [PATCH] Bind d(n)gettext in Mono.Unix.Catalog
</A></li>
        <LI>Next message: <A HREF="033639.html">[Mono-dev] [PATCH] Bind d(n)gettext in Mono.Unix.Catalog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33638">[ date ]</a>
              <a href="thread.html#33638">[ thread ]</a>
              <a href="subject.html#33638">[ subject ]</a>
              <a href="author.html#33638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 2009-12-03 at 13:22 +0100, Stephane Delcroix wrote:
&gt;<i> Here's a patch for Mono.Unix that P/Invoke d(n)gettext in addition to
</I>&gt;<i> (n)gettext. It's quite useful for writing libraries requiring
</I>&gt;<i> translations (think of Mono.Addins.Gui), esp. since GNU-gettext doesn't
</I>&gt;<i> support multiple domains.
</I>
One problem: you're *removing*
Catalog.GetPluralString(string,string.int).  That's bad. :-)

Also, for your new GetPluralString() method, instead of using
MarshalStrings() (with an _ignore argument) +
UnixMarshal.StringToHeap(), combine the two so that MarshalStrings()
isn't getting an _ignore argument.

That aside, it looks good, though I do wonder if the overloading here is
a good idea.

Basically, we'll wind up with this:

        public class Catalog {
                public static string GetPluralString (string s, string p, int n);
                public static string GetPluralString (string domain, string s, string p, int n);
                
                public static string GetString (string s);
                public static string GetString (string domain, string
                s);
                // ...
        }

Generally, when overloading a method the first arguments should have the
same meaning, and &quot;optional&quot; arguments should be last.  Thus:

        public class Catalog { 
                public static string GetPluralString (string s, string p, int n);
                public static string GetPluralString (string s, string p, int n, string domain);
                
                public static string GetString (string s);
                public static string GetString (string s, string
                domain);
                // ...
        }

&quot;Prior art,&quot; as it were, is System.Diagnostics.Trace.WriteLine[0]:

        public class Trace {
                public static void WriteLine (string message);
                public static void WriteLine (string message, string
                category);
        }

So I'm torn as to the &quot;proper&quot; thing to do here, as we have three
choices:

     1. Follow convention and make the 'domain' parameter last (above).
     2. Break convention and make the 'domain' parameter first
        (original).
     3. Use different method names, e.g. GetDomainString(),
        GetPluralDomainString(), and keep 'domain' as the first
        parameter.

Of these choices, I'm inclined toward (3) or (1), but could be argued
either way.

Thoughts?

 - Jon

[0]
<A HREF="http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.writeline.aspx">http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.writeline.aspx</A>

</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033634.html">[Mono-dev] [PATCH] Bind d(n)gettext in Mono.Unix.Catalog
</A></li>
	<LI>Next message: <A HREF="033639.html">[Mono-dev] [PATCH] Bind d(n)gettext in Mono.Unix.Catalog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33638">[ date ]</a>
              <a href="thread.html#33638">[ thread ]</a>
              <a href="subject.html#33638">[ subject ]</a>
              <a href="author.html#33638">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
