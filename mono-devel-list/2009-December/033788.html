<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Patch: implement mono_chain_signal for win32
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%3A%20implement%20mono_chain_signal%20for%20win32&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033787.html">
   <LINK REL="Next"  HREF="033789.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Patch: implement mono_chain_signal for win32</H1>
    <B>Lucas Meijer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%3A%20implement%20mono_chain_signal%20for%20win32&In-Reply-To="
       TITLE="[Mono-dev] Patch: implement mono_chain_signal for win32">lucas at lucasmeijer.com
       </A><BR>
    <I>Mon Dec 28 06:56:27 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033787.html">[Mono-dev] Confused about &quot;mono_array_to_lparray&quot; function
</A></li>
        <LI>Next message: <A HREF="033789.html">[Mono-dev] ASP.Net Ajax Json serialization problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33788">[ date ]</a>
              <a href="thread.html#33788">[ thread ]</a>
              <a href="subject.html#33788">[ subject ]</a>
              <a href="author.html#33788">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

Attached is a patch with an implementation for signal chaining on 
windows. We use this to make crashes in the mono runtime, or (much more 
often :) ), crashes in the Unity host, properly trickle down to our 
toplevel excetion filter, which invokes our BugReporter appliaction, 
which allows the user to send us the details of the crash.

at a glance, the changes are:

- have mono_chain_signal, call the old toplevel exception filter.
- exception filters (signal handler on win32) actually have a 
returntype, so we store the result, and return that result from mono's 
toplevel exception handler.
- not pass EXCEPTION_RECORD*, but EXCEPTION_POINTERS*, as that is 
required to create a minidump file, which can later on be reconstructed 
to a stacktrace if the original .pdb's are still around.

I haven't been able to test the amd64 implementation.

Let me know if something would need to change for this to go into mainline.

Bye, Lucas
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: signal_chaining_win32.patch
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091228/0d793529/attachment.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091228/0d793529/attachment.pl</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033787.html">[Mono-dev] Confused about &quot;mono_array_to_lparray&quot; function
</A></li>
	<LI>Next message: <A HREF="033789.html">[Mono-dev] ASP.Net Ajax Json serialization problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33788">[ date ]</a>
              <a href="thread.html#33788">[ thread ]</a>
              <a href="subject.html#33788">[ subject ]</a>
              <a href="author.html#33788">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
