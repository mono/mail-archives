<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono newbie - weird stack behaviour (possible bug)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20newbie%20-%20weird%20stack%20behaviour%20%28possible%20bug%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017533.html">
   <LINK REL="Next"  HREF="017536.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono newbie - weird stack behaviour (possible bug)</H1>
    <B>MrJ Man</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20newbie%20-%20weird%20stack%20behaviour%20%28possible%20bug%29&In-Reply-To="
       TITLE="[Mono-dev] Mono newbie - weird stack behaviour (possible bug)">auxsvr at yahoo.com
       </A><BR>
    <I>Fri Mar 10 17:19:12 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017533.html">[Mono-dev] mod-mono help
</A></li>
        <LI>Next message: <A HREF="017536.html">[Mono-dev] System warning removal.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17535">[ date ]</a>
              <a href="thread.html#17535">[ thread ]</a>
              <a href="subject.html#17535">[ subject ]</a>
              <a href="author.html#17535">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

First of all, this is my first program in C# (actually
an adaptation of a 
filter in beagle), so please forgive me if I am wrong
in any of the following 
or posting to the wrong maillist:

stack EnvironmentDataStack has .Count changed without
any pushes or pops 
taking place, as seen when running the filter using
ExtractContent.exe. The 
lines are marked with BUG. Did a quick search in
google and bugzilla without 
results.

Thanks in advance.

private ErrorCodes HandleControlWordArgument ()
                {
                        int aByte = -1;
                        char ch;
                        StringBuilder strCtrlWordArg =
new StringBuilder ();
                        string strTemp = null;
                        TeXControlWordType
ctrlWrdType; 
                        
                        aByte = SReaderTeX.Read ();
                        if (aByte == -1)
                                return
ErrorCodes.ERROR_TEX_EOF;
                        ch = (char) aByte;
                        
                        while (aByte != -1) {
                                strCtrlWordArg.Append
(ch);
                                aByte =
SReaderTeX.Peek ();
                                ch = (char) aByte;
                                if (Char.IsLetter
(ch)) {
                                        aByte =
SReaderTeX.Read ();
                                        ch = (char)
aByte;
                                }
                                else 
                                        break;
                        }
                        
                        if (EnvironmentDataStack.Count
&gt;<i> 0) {
</I>                                strTemp = (string)
EnvironmentDataStack.Pop();
                                if (String.Compare
(strTemp, &quot;begin&quot;) == 0) {
                                       
EnvironmentDataStack.Push (&quot;begin&quot;);
                                       
Console.WriteLine (&quot;Argument1: {0}&quot;,
strCtrlWordArg.ToString());
                                       
EnvironmentDataStack.Push (strCtrlWordArg.ToString());
                                         //Closing
block, stack handling
                                } else if
(String.Compare (strTemp, &quot;end&quot;) == 0) {
                                       
Console.WriteLine (&quot;Argument2: {0}, {1}&quot;,
strCtrlWordArg.ToString(), 
EnvironmentDataStack.Count);
                                
                                        // Check
whether there is an enclosing environment
                                        if
(EnvironmentDataStack.Count &gt; 3) {
                                               
strTemp = (string) EnvironmentDataStack.Pop ();
                                               
Console.WriteLine (&quot;Weirdness: {0}&quot;, strTemp);
                                                if
(String.Compare (strCtrlWordArg.ToString (), strTemp)
== 0) {
                                                      
 strCtrlWordArg.Remove (0, strCtrlWordArg.Length);
                                                      
 // Get rid of &quot;begin&quot;
                                                      
 strTemp = (string) EnvironmentDataStack.Pop ();
                                                      
 Console.WriteLine (&quot;assuming begin: {0}, {1}&quot;,
strTemp, 
EnvironmentDataStack.Count);
                                                      
 //Retrieve previous environment
                                                      
 strCtrlWordArg.Append ((string)
EnvironmentDataStack.Pop ());
                                                      
 //Reset bBlockBegin
                                                      
 //bBlockBegin = false;
                                                      
 // BUG: Difference from here
                                                      
 Console.WriteLine (&quot;...becomes: {0}, {1}&quot;
,strCtrlWordArg.ToString(), 
EnvironmentDataStack.Count);
                                                      
 //EnvironmentDataStack.Push (strCtrlWordArg);
                                                } else
                                                      
 Console.WriteLine (&quot;Reached the impossible!\n&quot;);
                                                      
 EnvironmentDataStack.Push (strTemp); //FIXME
Shouldn't reach it
                                        }
                                }
                        }
                        // BUG To here
                        Console.WriteLine (&quot;count:
{0}&quot;, EnvironmentDataStack.Count);

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
<A HREF="http://mail.yahoo.com">http://mail.yahoo.com</A> 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017533.html">[Mono-dev] mod-mono help
</A></li>
	<LI>Next message: <A HREF="017536.html">[Mono-dev] System warning removal.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17535">[ date ]</a>
              <a href="thread.html#17535">[ thread ]</a>
              <a href="subject.html#17535">[ subject ]</a>
              <a href="author.html#17535">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
