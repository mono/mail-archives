<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] New (faster) Implementaiton for managed CharCopy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20New%20%28faster%29%20Implementaiton%20for%20managed%20CharCopy&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017643.html">
   <LINK REL="Next"  HREF="017660.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] New (faster) Implementaiton for managed CharCopy</H1>
    <B>Andreas Nahr</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20New%20%28faster%29%20Implementaiton%20for%20managed%20CharCopy&In-Reply-To="
       TITLE="[Mono-dev] New (faster) Implementaiton for managed CharCopy">ClassDevelopment at A-SoftTech.com
       </A><BR>
    <I>Fri Mar 17 18:59:08 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017643.html">[Mono-dev] New (faster) Implementaiton for managed CharCopy
</A></li>
        <LI>Next message: <A HREF="017660.html">[Mono-dev] New (faster) Implementaiton for managed CharCopy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17644">[ date ]</a>
              <a href="thread.html#17644">[ thread ]</a>
              <a href="subject.html#17644">[ subject ]</a>
              <a href="author.html#17644">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>By the way, the timer is somewhat inaccurate, so here are somewhat more 
detailed results.

Z:\String&gt;mono test.exe
Test: Length: 0, Source: 0, Dest: 0
  memcopy      : 2703
  CharCopy     : 1875
  CC autoalign : 1953
  CC aligned   : 2094
Test: Length: 1, Source: 0, Dest: 0
  memcopy      : 2968
  CharCopy     : 1922
  CC autoalign : 2047
  CC aligned   : 2110
Test: Length: 100, Source: 0, Dest: 0
  memcopy      : 6484
  CharCopy     : 4641
  CC autoalign : 4656
  CC aligned   : 4656
Test: Length: 10000, Source: 0, Dest: 0
  memcopy      : 2719
  CharCopy     : 2609
  CC autoalign : 2625
  CC aligned   : 2610

Test: Length: 0, Source: 1, Dest: 0
  memcopy      : 3250
  CharCopy     : 1859
  CC autoalign : 2203
  CC aligned   : 2094
Test: Length: 1, Source: 1, Dest: 0
  memcopy      : 3422
  CharCopy     : 1922
  CC autoalign : 2140
  CC aligned   : 2188
Test: Length: 100, Source: 1, Dest: 0
  memcopy      : 11047
  CharCopy     : 5437
  CC autoalign : 5422
  CC aligned   : 7219
Test: Length: 10000, Source: 1, Dest: 0
  memcopy      : 6922
  CharCopy     : 3468
  CC autoalign : 3485
  CC aligned   : 5172

Test: Length: 0, Source: 1, Dest: 1
  memcopy      : 3109
  CharCopy     : 1875
  CC autoalign : 2187
  CC aligned   : 2094
Test: Length: 1, Source: 1, Dest: 1
  memcopy      : 3063
  CharCopy     : 1922
  CC autoalign : 2234
  CC aligned   : 2375
Test: Length: 100, Source: 1, Dest: 1
  memcopy      : 7250
  CharCopy     : 7984
  CC autoalign : 4797
  CC aligned   : 4969
Test: Length: 10000, Source: 1, Dest: 1
  memcopy      : 2734
  CharCopy     : 6328
  CC autoalign : 2610
  CC aligned   : 2625

Test: Length: 0, Source: 0, Dest: 1
  memcopy      : 3094
  CharCopy     : 1859
  CC autoalign : 2203
  CC aligned   : 2094
Test: Length: 1, Source: 0, Dest: 1
  memcopy      : 3234
  CharCopy     : 1922
  CC autoalign : 2141
  CC aligned   : 2187
Test: Length: 100, Source: 0, Dest: 1
  memcopy      : 9547
  CharCopy     : 6344
  CC autoalign : 6437
  CC aligned   : 8813
Test: Length: 10000, Source: 0, Dest: 1
  memcopy      : 5562
  CharCopy     : 4610
  CC autoalign : 4625
  CC aligned   : 6890



----- Original Message ----- 
From: &quot;Andreas Nahr&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ClassDevelopment at A-SoftTech.com</A>&gt;
To: &quot;Zac Bowling&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">zac at zacbowling.com</A>&gt;
Cc: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Saturday, March 18, 2006 12:33 AM
Subject: [Mono-dev] New (faster) Implementaiton for managed CharCopy


&gt;<i>I guess there is not much sense in discussing if we rely on the current
</I>&gt;<i> (somewhat slow) memcopy function, so I took my evening and my results from
</I>&gt;<i> back then (I remember that my CharCopy was REALLY tested for speed ;) - so
</I>&gt;<i> here are the results:
</I>&gt;<i>
</I>&gt;<i> Quick summary: with one exception (which I ABSOLUTELY don't understand 
</I>&gt;<i> why)
</I>&gt;<i> ALL new Implementations are always faster, sometimes more than twice as 
</I>&gt;<i> fast
</I>&gt;<i> as current. The best overall is CharCopy autoalign. However I'm not sure 
</I>&gt;<i> if
</I>&gt;<i> this would work on non-x86 Platforms, but CC aligned should always work if 
</I>&gt;<i> I
</I>&gt;<i> understand the alignment issues right.
</I>&gt;<i>
</I>&gt;<i> Z:\String&gt;mono test.exe
</I>&gt;<i> Test: Length: 0, Source: 0, Dest: 0
</I>&gt;<i>  memcopy      : 266
</I>&gt;<i>  CharCopy     : 187
</I>&gt;<i>  CC autoalign : 188
</I>&gt;<i>  CC aligned   : 219
</I>&gt;<i> Test: Length: 1, Source: 0, Dest: 0
</I>&gt;<i>  memcopy      : 485
</I>&gt;<i>  CharCopy     : 187
</I>&gt;<i>  CC autoalign : 219
</I>&gt;<i>  CC aligned   : 203
</I>&gt;<i> Test: Length: 100, Source: 0, Dest: 0
</I>&gt;<i>  memcopy      : 656
</I>&gt;<i>  CharCopy     : 454
</I>&gt;<i>  CC autoalign : 468
</I>&gt;<i>  CC aligned   : 469
</I>&gt;<i> Test: Length: 10000, Source: 0, Dest: 0
</I>&gt;<i>  memcopy      : 266
</I>&gt;<i>  CharCopy     : 265
</I>&gt;<i>  CC autoalign : 266
</I>&gt;<i>  CC aligned   : 266
</I>&gt;<i>
</I>&gt;<i> Test: Length: 0, Source: 1, Dest: 0
</I>&gt;<i>  memcopy      : 328
</I>&gt;<i>  CharCopy     : 187
</I>&gt;<i>  CC autoalign : 219
</I>&gt;<i>  CC aligned   : 203
</I>&gt;<i> Test: Length: 1, Source: 1, Dest: 0
</I>&gt;<i>  memcopy      : 375
</I>&gt;<i>  CharCopy     : 188
</I>&gt;<i>  CC autoalign : 218
</I>&gt;<i>  CC aligned   : 219
</I>&gt;<i> Test: Length: 100, Source: 1, Dest: 0
</I>&gt;<i>  memcopy      : 1141
</I>&gt;<i>  CharCopy     : 547
</I>&gt;<i>  CC autoalign : 546
</I>&gt;<i>  CC aligned   : 719
</I>&gt;<i> Test: Length: 10000, Source: 1, Dest: 0
</I>&gt;<i>  memcopy      : 688
</I>&gt;<i>  CharCopy     : 343
</I>&gt;<i>  CC autoalign : 344
</I>&gt;<i>  CC aligned   : 531
</I>&gt;<i>
</I>&gt;<i> Test: Length: 0, Source: 1, Dest: 1
</I>&gt;<i>  memcopy      : 313
</I>&gt;<i>  CharCopy     : 187
</I>&gt;<i>  CC autoalign : 219
</I>&gt;<i>  CC aligned   : 203
</I>&gt;<i> Test: Length: 1, Source: 1, Dest: 1
</I>&gt;<i>  memcopy      : 500
</I>&gt;<i>  CharCopy     : 203
</I>&gt;<i>  CC autoalign : 219
</I>&gt;<i>  CC aligned   : 235
</I>&gt;<i> Test: Length: 100, Source: 1, Dest: 1
</I>&gt;<i>  memcopy      : 734
</I>&gt;<i>  CharCopy     : 797
</I>&gt;<i>  CC autoalign : 484
</I>&gt;<i>  CC aligned   : 485
</I>&gt;<i> Test: Length: 10000, Source: 1, Dest: 1
</I>&gt;<i>  memcopy      : 281
</I>&gt;<i>  CharCopy     : 625
</I>&gt;<i>  CC autoalign : 265
</I>&gt;<i>  CC aligned   : 266
</I>&gt;<i>
</I>&gt;<i> Test: Length: 0, Source: 0, Dest: 1
</I>&gt;<i>  memcopy      : 313
</I>&gt;<i>  CharCopy     : 187
</I>&gt;<i>  CC autoalign : 219
</I>&gt;<i>  CC aligned   : 219
</I>&gt;<i> Test: Length: 1, Source: 0, Dest: 1
</I>&gt;<i>  memcopy      : 359
</I>&gt;<i>  CharCopy     : 203
</I>&gt;<i>  CC autoalign : 219
</I>&gt;<i>  CC aligned   : 219
</I>&gt;<i> Test: Length: 100, Source: 0, Dest: 1
</I>&gt;<i>  memcopy      : 984
</I>&gt;<i>  CharCopy     : 625
</I>&gt;<i>  CC autoalign : 641
</I>&gt;<i>  CC aligned   : 890                  &lt;----------------------------------
</I>&gt;<i> Already weired
</I>&gt;<i> Test: Length: 10000, Source: 0, Dest: 1
</I>&gt;<i>  memcopy      : 547
</I>&gt;<i>  CharCopy     : 469
</I>&gt;<i>  CC autoalign : 469
</I>&gt;<i>  CC aligned   : 687                  &lt;----------------------------------
</I>&gt;<i> Extremely strange
</I>&gt;<i>
</I>&gt;<i> However somebody who understands more about alignment than me (+ mono
</I>&gt;<i> unmanaged internals) has to look over it.
</I>&gt;<i> It should then be simple to replace the current implementation.
</I>&gt;<i> The Microbenchmark containing the Implementation is attached.
</I>&gt;<i>
</I>&gt;<i> Andreas
</I>&gt;<i>
</I>

--------------------------------------------------------------------------------


&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017643.html">[Mono-dev] New (faster) Implementaiton for managed CharCopy
</A></li>
	<LI>Next message: <A HREF="017660.html">[Mono-dev] New (faster) Implementaiton for managed CharCopy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17644">[ date ]</a>
              <a href="thread.html#17644">[ thread ]</a>
              <a href="subject.html#17644">[ subject ]</a>
              <a href="author.html#17644">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
