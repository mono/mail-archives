<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Questions about --profile=default:time
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Questions%20about%20--profile%3Ddefault%3Atime&In-Reply-To=dd99b8c80603260555s4f2813fdna54f1c508befa806%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017780.html">
   <LINK REL="Next"  HREF="017755.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Questions about --profile=default:time</H1>
    <B>Jacob Ils&#248; Christensen</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Questions%20about%20--profile%3Ddefault%3Atime&In-Reply-To=dd99b8c80603260555s4f2813fdna54f1c508befa806%40mail.gmail.com"
       TITLE="[Mono-dev] Questions about --profile=default:time">jacobilsoe at gmail.com
       </A><BR>
    <I>Sun Mar 26 09:02:42 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017780.html">[Mono-dev] Questions about --profile=default:time
</A></li>
        <LI>Next message: <A HREF="017755.html">[Mono-dev] Patch to support non-rectangular regions in libgdiplus
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17782">[ date ]</a>
              <a href="thread.html#17782">[ thread ]</a>
              <a href="subject.html#17782">[ subject ]</a>
              <a href="author.html#17782">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi.

Thanks for the detailed answer. I will give these issues a bit more thought.

/Jacob

On 3/26/06, Rafael Teixeira &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">monoman at gmail.com</A>&gt; wrote:
&gt;<i> Hi Jacob,
</I>&gt;<i>
</I>&gt;<i> On 3/24/06, Jacob Ils&#248; Christensen &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jacobilsoe at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have a few questions about the --profile=default:time in mono. I
</I>&gt;<i> &gt; have this program:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ----
</I>&gt;<i> &gt; using System.Threading;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; public class C
</I>&gt;<i> &gt; {
</I>&gt;<i> &gt;         public static void Main()
</I>&gt;<i> &gt;         {
</I>&gt;<i> &gt;                 AMethod();
</I>&gt;<i> &gt;                 BMethod();
</I>&gt;<i> &gt;         }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         public static void AMethod()
</I>&gt;<i> &gt;         {
</I>&gt;<i> &gt;                 Thread.Sleep(1000);
</I>&gt;<i> &gt;         }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         public static void BMethod()
</I>&gt;<i> &gt;         {
</I>&gt;<i> &gt;                 Thread.Sleep(500);
</I>&gt;<i> &gt;         }
</I>&gt;<i> &gt; }
</I>&gt;<i> &gt; ----
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This gives the attached profiler output. Among others these things puzzle me:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; * In:  &quot;3.409       3    1.136   System.Object::runtime_invoke...&quot; why
</I>&gt;<i> &gt; does the profiler output a count of 3 when the lines below show 2
</I>&gt;<i> &gt; calls? Is this due to the extra invocation show further up in the
</I>&gt;<i> &gt; file?
</I>&gt;<i>
</I>&gt;<i> Sure, a profiler counts a method each time it enters it, on any
</I>&gt;<i> instance or statically.
</I>&gt;<i>
</I>&gt;<i> &gt; * In: &quot;1503.045       2  751.523
</I>&gt;<i> &gt; System.Threading.Thread::Sleep(int)&quot; AMethod actually spends around
</I>&gt;<i> &gt; 1000 ms and BMethod 500 ms. What is the purpose of outputting 751.523
</I>&gt;<i> &gt; as an average when the two methods do not share the time but just the
</I>&gt;<i> &gt; number of calls?
</I>&gt;<i>
</I>&gt;<i> Well most profilers just agregate results, as that consumes less
</I>&gt;<i> memory and time and is generally more useful for optimization
</I>&gt;<i> purposes. A profiler I wrote on for VB6,  in another life, collected
</I>&gt;<i> the raw data and post-processed to give chained averages, like how was
</I>&gt;<i> the average of the Sleep call inside AMethod and inside BMethod, but
</I>&gt;<i> that took a lot of post-processing and yielded a much larger set of
</I>&gt;<i> results to try to figure out where the bottlenecks are.
</I>&gt;<i>
</I>&gt;<i> See that in that case, it is easier to simply use our minds and deduce
</I>&gt;<i> that if the mean time of AMethod is a little over 1000ms and BMethod a
</I>&gt;<i> little over 500ms, and both call Sleep, both are contributing equally
</I>&gt;<i> for the Sleep average. This is a constructed example, and profiling it
</I>&gt;<i> has little to add to what reading the code already tell us.
</I>&gt;<i>
</I>&gt;<i> Profiling is really useful when trying to identify bottlenecks on
</I>&gt;<i> complex code heavily affected by the data it receives or the
</I>&gt;<i> interactions with the user or other pieces of the system. In that
</I>&gt;<i> case, averages and standard deviation are good guides to find the
</I>&gt;<i> culprits.
</I>&gt;<i>
</I>&gt;<i> Profile MD launch for instance and you'll see how many threads do lots
</I>&gt;<i> of things, but some dependencies can't be avoided and thus force
</I>&gt;<i> sequential execution. Also some bottlenecks are beyond MD code into
</I>&gt;<i> the depths of GTK+ for instance, what makes them harder to overcome.
</I>&gt;<i>
</I>&gt;<i> &gt; Have I just misunderstood something, or is some information missing
</I>&gt;<i> &gt; from the profiler output?
</I>&gt;<i>
</I>&gt;<i> As I said, I think you are underestimating the poser of average times,
</I>&gt;<i> and the costs of having more detailed data both on producing and on
</I>&gt;<i> analizing it.
</I>&gt;<i>
</I>&gt;<i> &gt; /Jacob
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Rafael &quot;Monoman&quot; Teixeira
</I>&gt;<i> ---------------------------------------
</I>&gt;<i> As I'm currently working a lot with Java and even fixing Java VMs
</I>&gt;<i> (JamVM/Kaffe) and GNU Classpath code, I think I may partly borrow the
</I>&gt;<i> title (Javaman) from my friend Bruno Souza and become the
</I>&gt;<i> MonoNJavaMan. Yeah, I may currently be crazier than usual...
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017780.html">[Mono-dev] Questions about --profile=default:time
</A></li>
	<LI>Next message: <A HREF="017755.html">[Mono-dev] Patch to support non-rectangular regions in libgdiplus
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17782">[ date ]</a>
              <a href="thread.html#17782">[ thread ]</a>
              <a href="subject.html#17782">[ subject ]</a>
              <a href="author.html#17782">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
