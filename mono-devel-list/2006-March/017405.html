<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [ADO.NET] AutoIncrement fields,	unique constraints and updates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BADO.NET%5D%20AutoIncrement%20fields%2C%0A%09unique%20constraints%20and%20updates&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017398.html">
   <LINK REL="Next"  HREF="017414.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [ADO.NET] AutoIncrement fields,	unique constraints and updates</H1>
    <B>Marek Habersack</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BADO.NET%5D%20AutoIncrement%20fields%2C%0A%09unique%20constraints%20and%20updates&In-Reply-To="
       TITLE="[Mono-dev] [ADO.NET] AutoIncrement fields,	unique constraints and updates">grendel at caudium.net
       </A><BR>
    <I>Fri Mar  3 06:13:37 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017398.html">[Mono-dev] bug in datagrid
</A></li>
        <LI>Next message: <A HREF="017414.html">[Mono-dev] [ADO.NET] AutoIncrement fields, unique	constraints and updates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17405">[ date ]</a>
              <a href="thread.html#17405">[ thread ]</a>
              <a href="subject.html#17405">[ subject ]</a>
              <a href="author.html#17405">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everybody,

  I've got code that uses command builder for a typed dataset which contains
an auto-incremented field. Everything works fine until I try to update a row
and store the modified dataset back in the database. At this point,
UniqueConstraint throws an exception for the row being updated, claiming
that its auto-increment field's value is taken (which is, technically, true
as this field is the one that contains the &quot;non-unique value&quot;). I've been
looking in the Microsoft docs for a clue as to how UniqueConstraint (or
the command builder) should behave in such situation, but I've found nothing
about the subject. 
  Perhaps I'm missing something that is already present in ADO.NET that
handles the above situation, but I think that a common sense approach to
this would be to

  a) ignore the auto-increment fields in command builder when building
     queries (since setting their values doesn't make sense as the DBMS
     takes care of that)
  b) don't enforce unique constraint on a row when the row is in the
     changed state after making sure that this row is the only one with the
     value
  c) a form of the above, rewrite Index.HasDuplicates to somehow detect that
     the row with &quot;duplicate&quot; value is in fact just a modified version of
     the row in question and thus it is not a duplicate.

Please let me know if I'm totally wrong about the above and if there already
exists a solution that I've missed :)

thanks,

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: Digital signature
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060303/1b112387/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060303/1b112387/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017398.html">[Mono-dev] bug in datagrid
</A></li>
	<LI>Next message: <A HREF="017414.html">[Mono-dev] [ADO.NET] AutoIncrement fields, unique	constraints and updates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17405">[ date ]</a>
              <a href="thread.html#17405">[ thread ]</a>
              <a href="subject.html#17405">[ subject ]</a>
              <a href="author.html#17405">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
