<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] tailcall support in mcs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20tailcall%20support%20in%20mcs&In-Reply-To=000a01c37b15%24fb237340%24a20010ac%405dservices.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002063.html">
   <LINK REL="Next"  HREF="002065.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] tailcall support in mcs</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20tailcall%20support%20in%20mcs&In-Reply-To=000a01c37b15%24fb237340%24a20010ac%405dservices.com.au"
       TITLE="[Mono-devel-list] tailcall support in mcs">jonpryor at vt.edu
       </A><BR>
    <I>Sun Sep 14 21:25:22 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="002063.html">[Mono-devel-list] tailcall support in mcs
</A></li>
        <LI>Next message: <A HREF="002065.html">[Mono-devel-list] tailcall support in mcs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2064">[ date ]</a>
              <a href="thread.html#2064">[ thread ]</a>
              <a href="subject.html#2064">[ subject ]</a>
              <a href="author.html#2064">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Recursive iteration.  Or maybe, recursion implemented by iteration.  :-)

Yes, that's a mix of topics, but it's fairly close to the truth.

The classic problem with recursion is stack space -- you use more stack
space whenever you recurse, creating increased potential for a Stack
Overflow error.  This is, of course, bad.  Consider:

	// sum 1 .. n and return
	int sum_recursive (int n) {
		if (n == 1) return 1;
		return n + sum1 (n-1);
	}

You need &quot;n&quot; copies of sum_recursive() on the stack to complete the
computation.  So if &quot;n&quot; is big, you'll run out of stack space.

The classic solution is to use iteration (looping):

	int sum_iterative (int n) {
		int sum = 0;
		for (int i = 1; i != (n+1); ++i) {
			sum += i;
		}
		return i;
	}

However, not all languages support iteration, as it requires modifying a
loop control variable of some form.  (Some Lisp-derived languages are
the classic example of this form of language, as classical Lisp contains
no side effects and values are immutable.)

So, how do you use recursion without killing yourself?

The solution is simple: you only need to create a new stack entry when
you're actually using something from the previous stack entry, as seen
in sum_recursive.  If you can change the algorithm so that you don't
need the intermediate results from previous steps, you can just use the
same stack frame as you currently have.  What looks like a recursive
function call is transformed into an iterative algorithm, as far as
stack space is concerned:

	int sum_tailcall_impl (int current, int todo) {
		if (todo == 0) return current;
		return sum_tailcall_impl (current+todo, todo-1);
	}
	int sum_tailcall (int n) {
		return sum_tailcall_impl (n, n-1);
	}

That's the jist of it.

(Actually, I just showed an example of &quot;tail recursion,&quot; which is a
subset of &quot;tail calls,&quot; and easier for compilers to examine and
transform.)

You should also lookup &quot;tail call&quot; on google.  The first result
(&quot;Squawks of the Parrot: What the heck is: A tail call&quot;) is decent.

 - Jon

On Sun, 2003-09-14 at 19:14, Lloyd Dupont wrote:
&gt;<i> just a dumy question...
</I>&gt;<i> what's a tail call ?
</I>&gt;<i> 
</I>&gt;<i> ----- Original Message -----
</I>&gt;<i> From: &quot;Michal Moskal&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">malekith at pld-linux.org</A>&gt;
</I>&gt;<i> To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at ximian.com</A>&gt;
</I>&gt;<i> Sent: Monday, September 15, 2003 6:02 AM
</I>&gt;<i> Subject: [Mono-devel-list] tailcall support in mcs
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; Is outputting tallcalls done or planned in mcs? I'm working on
</I>&gt;<i> &gt; functional language implementation. I'm generating C# (for now, later
</I>&gt;<i> &gt; I'll switch to ilasm or bytecode), so lack of tailcalls is very
</I>&gt;<i> &gt; annoying.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; : Michal Moskal :: <A HREF="http://www.kernel.pl/~malekith">http://www.kernel.pl/~malekith</A> : GCS {C,UL}++++$ a? !tv
</I>&gt;<i> &gt; : When in doubt, use brute force. -- Ken Thompson : {E-,w}-- {b++,e}&gt;+++ h
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002063.html">[Mono-devel-list] tailcall support in mcs
</A></li>
	<LI>Next message: <A HREF="002065.html">[Mono-devel-list] tailcall support in mcs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2064">[ date ]</a>
              <a href="thread.html#2064">[ thread ]</a>
              <a href="subject.html#2064">[ subject ]</a>
              <a href="author.html#2064">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
