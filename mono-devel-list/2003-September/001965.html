<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] CoreLib's HashTable CalcPrime() new code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20CoreLib%27s%20HashTable%20CalcPrime%28%29%20new%20code&In-Reply-To=20030901222019.44272.qmail%40web80703.mail.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001961.html">
   <LINK REL="Next"  HREF="001962.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] CoreLib's HashTable CalcPrime() new code</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20CoreLib%27s%20HashTable%20CalcPrime%28%29%20new%20code&In-Reply-To=20030901222019.44272.qmail%40web80703.mail.yahoo.com"
       TITLE="[Mono-devel-list] CoreLib's HashTable CalcPrime() new code">lupus at ximian.com
       </A><BR>
    <I>Tue Sep  2 05:49:50 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001961.html">[Mono-devel-list] CoreLib's HashTable CalcPrime() new code
</A></li>
        <LI>Next message: <A HREF="001962.html">[Mono-devel-list] Rebuilding mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1965">[ date ]</a>
              <a href="thread.html#1965">[ thread ]</a>
              <a href="subject.html#1965">[ subject ]</a>
              <a href="author.html#1965">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/01/03 Yuri Astrakhan wrote:
&gt;<i> I have rewritten CalcPrime() in the
</I>&gt;<i> mcs\class\corlib\System.Collections\Hashtable.cs to fix several bugs (ie
</I>&gt;<i> 15 was shown as a prime and the result was sometimes below the original
</I>&gt;<i> value)  The speed has been improved almost 4.5 times according to the
</I>&gt;<i> 30 second tests, by skipping numbers divisible by 2 and 3. There is some
</I>&gt;<i> bits magic, but code is, hopefully, clear / enough commented. TestPrime()
</I>&gt;<i> is no longer needed and should be removed.
</I>
I would just remove both CalcPrime and TestPrime and extend the
precomputed size array, instead. There's no point computing the size
at runtime when we can easily do it offline.

&gt;<i> Also, there is a hardcoded prime number's table being used in
</I>&gt;<i> ToPrime(), which waistes lots of resources (IMHO) because it skips most
</I>&gt;<i> of the primes and new hash tables become overbloated. Why not use the
</I>
The point of the table is not only to find a prime number, but to also
allow the table to grow fast enough when it is filled without an
exponential factor in it. For example, if you just select each next
prime number the complexity is going to be O(n2) and we want it to
stay O(n) for insertion.

Thanks.

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001961.html">[Mono-devel-list] CoreLib's HashTable CalcPrime() new code
</A></li>
	<LI>Next message: <A HREF="001962.html">[Mono-devel-list] Rebuilding mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1965">[ date ]</a>
              <a href="thread.html#1965">[ thread ]</a>
              <a href="subject.html#1965">[ subject ]</a>
              <a href="author.html#1965">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
