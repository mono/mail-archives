<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Update on Build System
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Update%20on%20Build%20System&In-Reply-To=%3C7CF48B0CB8988E45AC776D68479B144697DEB72A4B%40MBX72.ad2.softcom.biz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042901.html">
   <LINK REL="Next"  HREF="042891.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Update on Build System</H1>
    <B>Chris Tacke</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Update%20on%20Build%20System&In-Reply-To=%3C7CF48B0CB8988E45AC776D68479B144697DEB72A4B%40MBX72.ad2.softcom.biz%3E"
       TITLE="[Mono-dev] Update on Build System">ctacke at opennetcf.com
       </A><BR>
    <I>Thu Apr  9 19:12:55 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="042901.html">[Mono-dev] Can't run mono-3.12.X on Windows XP
</A></li>
        <LI>Next message: <A HREF="042891.html">[Mono-dev] Update on Build System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42890">[ date ]</a>
              <a href="thread.html#42890">[ thread ]</a>
              <a href="subject.html#42890">[ subject ]</a>
              <a href="author.html#42890">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It&#8217;s been about a year and thought I&#8217;d loop back on this thread since it&#8217;s still something I could really use. Are we yet to a point where we can build Mono using the Microsoft compilers only?  If so, I can then start looking at modifying those projects to build using the Windows CE compilers.

-Chris Tacke

From: Miguel de Icaza [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">miguel at xamarin.com</A>]
Sent: Monday, May 26, 2014 10:23 AM
To: Chris Tacke
Cc: mono-devel
Subject: Re: [Mono-dev] Update on Build System

Hello Chris,

That is what I am trying to do with this work.

There are still a number of problems that I need to address:

 *   Installing the resulting binaries
 *   Signing (currently we are skipping this)
 *   Ensure the binaries produced are identical with Make and msbuild
 *   Add assertions to ensure that flags that we currently ignore are caught, in case we add new features in the future
 *   Fix the C# compiler build (currently disabled)
 *   Extend this to other components, so we can have the entire setup in a solution.
Then we would have something that works.

Miguel

On Mon, May 26, 2014 at 11:04 AM, Chris Tacke &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ctacke at opennetcf.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ctacke at opennetcf.com</A>&gt;&gt; wrote:
Miguel,

This is great news. Are there any plans to update the build system to allow us to compile the runtime itself using Visual Studio (i.e. a Microsoft compiler)?

Now before everyone starts with the eye rolling and &#8220;why the hell would you want to do that?&#8221; questions, let me explain.  As of today, we can create applications in C# that will run on Windows and a large array of Linux machines (including Android) but Windows CE has been orphaned.  Microsoft is not putting any effort into the Compact Framework, but there are still people developing for Windows CE devices.  I&#8217;d like to put a last nail in the coffin of the Compact Framework by getting Mono supported on Windows CE so we can all move into using technology from the current decade, not the last one.

I don&#8217;t see any real path for getting the runtimes to compile for Windows CE  for ARM and 586 (not 686, since we have new Intel processors now that are 586 based).  There is an old (last touch in 2009) CeGCC project that might be a step, but I was hoping for something a little simpler.  I&#8217;m up for any suggestions.

-Chris Tacke





From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>&gt; [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>&lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>&gt;] On Behalf Of Miguel de Icaza
Sent: Friday, May 23, 2014 9:59 PM
To: mono-devel
Subject: [Mono-dev] Update on Build System

Hey guys,

#1 Makefile Build System Update

So the clean staged setup has been added to mono/master and in practice most of you will never notice an improvement.

Those working on libraries that had cross dependencies will enjoy reliable and working builds.   If you make a change in say System, and you type &quot;make&quot; in mcs/class/System, it will make sure that all the dependencies are properly compiled and the result will be stable.

#2 MSBuild setup

Based on the work above, I have updated the MSBuild setup, and it is now possible to build most of the managed code with xbuild.   This means that you can use this from Visual Studio or Xamarin Studio.

Since xbuild does not support passing /keyfile to the C# compiler, I still have to fix about 6-7 assemblies that use -keyfile to be signed.

Once that happens, you should be able to build all of Mono's managed code with:

xbuild msvc/scripts/net_4_5.sln

Currently I disabled generating project files for profiles other than 4.5, just because it is easier to debug this way.

I am also a bit sad that our xbuild does not have any support for parallel builds, it would have been a neat hack to make the xbuild-based build system parallel and get this for free.

#3 Future Parallel Work - Makefiles

I tried to implement parallel builds for mcs/class/Facades, and while it works, it regressed some of the other standard targets that we have (the other -local).   I will have to revisit this later.

But the principle behind the patch that enabled this could be used for mcs/class and parallelize all the builds as well.   We only need to (a) generate the assembly dependencies [1] and (b) we need to figure out the -local target breakage (same stuff I broke for Facades).

[1]  (which we have from the xbuild work above)
Miguel

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150409/621364ec/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150409/621364ec/attachment-0001.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042901.html">[Mono-dev] Can't run mono-3.12.X on Windows XP
</A></li>
	<LI>Next message: <A HREF="042891.html">[Mono-dev] Update on Build System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42890">[ date ]</a>
              <a href="thread.html#42890">[ thread ]</a>
              <a href="subject.html#42890">[ subject ]</a>
              <a href="author.html#42890">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
