<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Assemblies in the CLR system directory and F# scripting.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Assemblies%20in%20the%20CLR%20system%20directory%20and%20F%23%0A%20scripting.&In-Reply-To=%3CDUB130-W13CFFA875A1502C858641E8E40%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042908.html">
   <LINK REL="Next"  HREF="042910.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Assemblies in the CLR system directory and F# scripting.</H1>
    <B>Alexander K&#246;plinger</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Assemblies%20in%20the%20CLR%20system%20directory%20and%20F%23%0A%20scripting.&In-Reply-To=%3CDUB130-W13CFFA875A1502C858641E8E40%40phx.gbl%3E"
       TITLE="[Mono-dev] Assemblies in the CLR system directory and F# scripting.">alex.koeplinger at outlook.com
       </A><BR>
    <I>Thu Apr 16 10:37:35 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="042908.html">[Mono-dev] Assemblies in the CLR system directory and F# scripting.
</A></li>
        <LI>Next message: <A HREF="042910.html">[Mono-dev] Assemblies in the CLR system directory and F#	scripting.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42909">[ date ]</a>
              <a href="thread.html#42909">[ thread ]</a>
              <a href="subject.html#42909">[ subject ]</a>
              <a href="author.html#42909">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>EntityFramework was already removed from the upcoming Mono 4.0.
I also just checked and on Windows I have System.Web.Razor.dll (Razor 2.0) in the GAC as well, so maybe there's some other issue here?
 
-- Alex
 
&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">matthi.d at googlemail.com</A>
</I>&gt;<i> Date: Thu, 16 Apr 2015 12:08:54 +0200
</I>&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> Subject: [Mono-dev] Assemblies in the CLR system directory and F# scripting.
</I>&gt;<i> 
</I>&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> TL;DR: We should remove System.Web.Razor.dll, EntityFramework.dll (and
</I>&gt;<i> possibly more) from &quot;/usr/lib/mono/4.5&quot;
</I>&gt;<i> 
</I>&gt;<i> I noticed that some assemblies (namely &quot;EntityFramework&quot; and
</I>&gt;<i> &quot;System.Web.Razor&quot; and possibly more) lead to problems when used within
</I>&gt;<i> a F# script file. The problem is the following:
</I>&gt;<i> 
</I>&gt;<i> Assume you use NuGet to download the latest Razor-3 package and then do
</I>&gt;<i> the following (in an F# script file):
</I>&gt;<i> 
</I>&gt;<i> #I &quot;packages/Microsoft.AspNet.Razor/lib/net45&quot;
</I>&gt;<i> #r &quot;System.Web.Razor.dll&quot;
</I>&gt;<i> 
</I>&gt;<i> Note that this is the usual way of loading assemblies in F# scripting
</I>&gt;<i> and it works fine on Windows/.NET.
</I>&gt;<i> 
</I>&gt;<i> However because this is the same as using
</I>&gt;<i> &quot;/lib:packages/Microsoft.AspNet.Razor/lib/net45
</I>&gt;<i> /reference:System.Web.Razor.dll&quot; on the C# compiler and because mono has
</I>&gt;<i> a &quot;System.Web.Razor.dll&quot; in its CLR system directory (/usr/lib/mono/4.5)
</I>&gt;<i> it will redirect the reference (CLR system directory is always
</I>&gt;<i> preferred, see <A HREF="https://msdn.microsoft.com/en-us/library/s5bac5fx.aspx">https://msdn.microsoft.com/en-us/library/s5bac5fx.aspx</A>).
</I>&gt;<i> 
</I>&gt;<i> This already hit me several times:
</I>&gt;<i>  - <A HREF="https://github.com/fsharp/FSharp.Compiler.Service/issues/313">https://github.com/fsharp/FSharp.Compiler.Service/issues/313</A>
</I>&gt;<i>  - <A HREF="https://github.com/tpetricek/FSharp.Formatting/pull/279">https://github.com/tpetricek/FSharp.Formatting/pull/279</A>
</I>&gt;<i> 
</I>&gt;<i> I'm not really sure why mono actually needs those file to live there.
</I>&gt;<i> For referencing the NuGet package should be fine. To load the correct
</I>&gt;<i> (mono compatible) version on runtime the GAC should do it.
</I>&gt;<i> IMHO we can just remove the System.Web.Razor.dll (and possibly others?)
</I>&gt;<i> from the runtime directory.
</I>&gt;<i> @akoeplinger noted the following in the gitter chat: It would be a
</I>&gt;<i> breaking change for people depending on &quot;/reference:System.Web.Razor&quot; to
</I>&gt;<i> just work.
</I>&gt;<i> But I'm not sure how common that is with the NuGet package in place.
</I>&gt;<i> IIRC xbuild and msbuild always use fully qualified references, so it
</I>&gt;<i> shouldn't be a problem for them.
</I>&gt;<i> 
</I>&gt;<i> So... Is removing those file something we can do? I just wanted to bring
</I>&gt;<i> attention to this issue as it can be *really* hard to debug. The
</I>&gt;<i> workarounds in place for this are required anyway to work with older
</I>&gt;<i> mono versions. The workaround in itself is simple you just need to use
</I>&gt;<i> the fully qualified reference instead:
</I>&gt;<i> 
</I>&gt;<i> #r &quot;packages/Microsoft.AspNet.Razor/lib/net45/System.Web.Razor.dll&quot;
</I>&gt;<i> 
</I>&gt;<i> However this can be a problem if you don't know in advance in which of
</I>&gt;<i> the included directories (&quot;#I&quot;) the file is living. (Because F# will
</I>&gt;<i> stop executing if the fully qualified reference doesn't exists).
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i>  Matthias
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I> 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150416/5dbc79a7/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20150416/5dbc79a7/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042908.html">[Mono-dev] Assemblies in the CLR system directory and F# scripting.
</A></li>
	<LI>Next message: <A HREF="042910.html">[Mono-dev] Assemblies in the CLR system directory and F#	scripting.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42909">[ date ]</a>
              <a href="thread.html#42909">[ thread ]</a>
              <a href="subject.html#42909">[ subject ]</a>
              <a href="author.html#42909">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
