<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Npgsql patch for binary types
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Npgsql%20patch%20for%20binary%20types&In-Reply-To=1066895320.19207.2.camel%40atreyu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002631.html">
   <LINK REL="Next"  HREF="002656.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Npgsql patch for binary types</H1>
    <B>Francisco Figueiredo Jr.</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Npgsql%20patch%20for%20binary%20types&In-Reply-To=1066895320.19207.2.camel%40atreyu"
       TITLE="[Mono-devel-list] Npgsql patch for binary types">fxjrlists at yahoo.com.br
       </A><BR>
    <I>Thu Oct 23 11:14:51 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="002631.html">[Mono-devel-list] Npgsql patch for binary types
</A></li>
        <LI>Next message: <A HREF="002656.html">[Mono-devel-list] Npgsql patch for binary types
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2641">[ date ]</a>
              <a href="thread.html#2641">[ thread ]</a>
              <a href="subject.html#2641">[ subject ]</a>
              <a href="author.html#2641">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jackson Harper wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>
Hi Jackson!

&gt;<i> 	Attached is a patch to NpgsqlTypes/NpgswlTypesHelper.cs that allows
</I>&gt;<i> binary types to be used as parameters. Is it ok to commit?
</I>&gt;<i> 
</I>
Thanks!

We now have two implementations for this.

This is the implementation which we already have in cvs:


private static String ConvertByteArrayToBytea(Byte[] byteArray)
         {
         NpgsqlEventLog.LogMethodEnter(LogLevel.Debug, CLASSNAME, 	 
&quot;ConvertByteArrayToBytea&quot;);
                 StringBuilder  result = new StringBuilder(&quot;&quot;); 


                 foreach(Byte byteToConvert in byteArray)
                 {
                         result.Append(&quot;\\\\&quot;);
                         result.Append((byteToConvert &amp; 0xC0) &gt;&gt; 6);
                         result.Append((byteToConvert &amp; 0x38) &gt;&gt; 3);
                         result.Append(byteToConvert &amp; 0x07);
                 }

                 return result.ToString();
         }


But I don't know yet if yours could be faster. We have to do somet 
tests. I know that the current implementation isn't so fast. I mean, it 
is using byte shifts and I don't know how much slower or faster it could 
be compared to &quot;ifs&quot;.


Also, we have the inverse operation and I'm sure this has a lot of space 
for optimizations. Please have a look in the ConvertyByteAToByteArray 
method. The problem there is to convert a string in octal form \\201 for 
example in its byte value. This method is very slow and consuming a lot 
of memory when the value to be converted is larger than 2 megabytes.

Does anybody know some good way of converting a string value in octal to 
its byte value?

&gt;<i> Thanks,
</I>
Thank you Jackson.

Regards,

Francisco Figueiredo Jr.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002631.html">[Mono-devel-list] Npgsql patch for binary types
</A></li>
	<LI>Next message: <A HREF="002656.html">[Mono-devel-list] Npgsql patch for binary types
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2641">[ date ]</a>
              <a href="thread.html#2641">[ thread ]</a>
              <a href="subject.html#2641">[ subject ]</a>
              <a href="author.html#2641">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
