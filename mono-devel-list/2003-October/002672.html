<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Re: Potential GAC implementation ideas.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20Potential%20GAC%20implementation%20ideas.&In-Reply-To=006101c399b1%2491eb8ba0%248500a8c0%40proton">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002664.html">
   <LINK REL="Next"  HREF="002668.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Re: Potential GAC implementation ideas.</H1>
    <B>Michal Moskal</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20Potential%20GAC%20implementation%20ideas.&In-Reply-To=006101c399b1%2491eb8ba0%248500a8c0%40proton"
       TITLE="[Mono-devel-list] Re: Potential GAC implementation ideas.">malekith at pld-linux.org
       </A><BR>
    <I>Thu Oct 23 18:18:38 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="002664.html">[Mono-devel-list] Re: Potential GAC implementation ideas.
</A></li>
        <LI>Next message: <A HREF="002668.html">[Mono-devel-list] Re: Potential GAC implementation ideas.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2672">[ date ]</a>
              <a href="thread.html#2672">[ thread ]</a>
              <a href="subject.html#2672">[ subject ]</a>
              <a href="author.html#2672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Oct 23, 2003 at 06:04:03PM -0400, Todd Berman wrote:
&gt;<i> &gt; You run gacutil --cache in relevant directories. It traverses them,
</I>&gt;<i> &gt; and puts somewhere in it's database that file.dll with version 1.0.0.0
</I>&gt;<i> &gt; (it takes this information from DLL meta data, it's much like soname in
</I>&gt;<i> &gt; UNIX) is in /foo/bar/file.dll.1.13. The runtime then asks gac library. It
</I>&gt;<i> &gt; checks its cache and returns proper filename. where's the problem?
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> So, instead of running a gacutil /i after installing an rpm, you now want to
</I>&gt;<i> run a gacutil --cache? Whats the difference?
</I>
The difference is that gacutil --cache doesn't need any arguments. It
just makes sure any internal GAC stuff is valid (assuming that what we
want in GAC in in correct locations).

&gt;<i> &gt; &gt; And what about crossplatform.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; This is platform neutral (you just need enough filenames :-)
</I>&gt;<i> 
</I>&gt;<i> This is *not* crossplatform, as right now we are building
</I>&gt;<i> Microsoft.Web.Services.1.dll and Microsoft.Web.Services.2.dll and it
</I>&gt;<i> prevents any crossplatform when the libraries are named such.
</I>
Is it *so* broken, that name of DLL isn't stored anywhere inside it? Is
it *just* file name ?

&gt;<i> &gt; &gt; When I compile an application on windows using
</I>&gt;<i> &gt; Microsoft.Web.Services.dll
</I>&gt;<i> &gt; &gt; and I tell it to use version 2.0.0.0 instead of version 1.0.0.0 (both of
</I>&gt;<i> &gt; &gt; which are installed, and in the GAC) it lists the assembly in the PE as
</I>&gt;<i> &gt; &gt; 'Microsoft.Web.Services' not as 'Microsoft.Web.Services.$version'.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; You seem to unify concepts of file name and library name. These need not
</I>&gt;<i> &gt; be the same -- that's what's GAC is for (think of directories as parts
</I>&gt;<i> &gt; of file names).
</I>&gt;<i> 
</I>&gt;<i> Correct me if I'm wrong (and I might very well be), but doesn't mono and
</I>&gt;<i> .net use syntax like this inside the assembly/exe?:
</I>&gt;<i> 
</I>&gt;<i> .assembly extern System
</I>&gt;<i> {
</I>&gt;<i>   .publickeytoken = (B7 7A 5C 56 19 34 E0 89 )
</I>&gt;<i>   .ver 1:0:3300:0
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> Again, I could be wrong, but currently, doesn't mono find these files by
</I>&gt;<i> tacking a .dll to the end of that and looking it is locations?
</I>&gt;<i> 
</I>&gt;<i> If instead, it goes through and somehow identifies and then opens all
</I>&gt;<i> possible assemblies in your assembly locations and compares whats it looking
</I>&gt;<i> for to the .assembly notation that defines said assembly, I was not aware.
</I>
I don't know what mono is doing. I'm sure that GAC *need* to open
assmebly, find the publictoken and version stuff and store information
that this and that version-publictoken is in file this and that. It
does that when running gacutil /i, right?

What I mean by gacutil --cache is something like:

rm -f /usr/lib/gac/internal.blah
for f in /usr/lib/gac/*.dll ; do
  gacutil /i $f
done

But of course more efficient.

When gacutil need to open DLL anyway, then filename shouldn't be of much
concern for it.

-- 
:<i> Michal Moskal :: <A HREF="http://www.kernel.pl/~malekith">http://www.kernel.pl/~malekith</A> : GCS {C,UL}++++$ a? !tv
</I>:<i> When in doubt, use brute force. -- Ken Thompson : {E-,w}-- {b++,e}&gt;+++ h
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002664.html">[Mono-devel-list] Re: Potential GAC implementation ideas.
</A></li>
	<LI>Next message: <A HREF="002668.html">[Mono-devel-list] Re: Potential GAC implementation ideas.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2672">[ date ]</a>
              <a href="thread.html#2672">[ thread ]</a>
              <a href="subject.html#2672">[ subject ]</a>
              <a href="author.html#2672">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
