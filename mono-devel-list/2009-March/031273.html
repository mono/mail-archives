<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [Mono-patches] r128544 - in trunk/mono/mono:	metadata mini
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BMono-patches%5D%20r128544%20-%20in%20trunk/mono/mono%3A%0A%09metadata%20mini&In-Reply-To=8cca42d80903040634t1987e9el904889904f22dd17%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031271.html">
   <LINK REL="Next"  HREF="031274.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [Mono-patches] r128544 - in trunk/mono/mono:	metadata mini</H1>
    <B>Martin Baulig</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BMono-patches%5D%20r128544%20-%20in%20trunk/mono/mono%3A%0A%09metadata%20mini&In-Reply-To=8cca42d80903040634t1987e9el904889904f22dd17%40mail.gmail.com"
       TITLE="[Mono-dev] [Mono-patches] r128544 - in trunk/mono/mono:	metadata mini">martin at ximian.com
       </A><BR>
    <I>Wed Mar  4 10:39:32 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="031271.html">[Mono-dev] [Mono-patches] r128544 - in trunk/mono/mono:	metadata mini
</A></li>
        <LI>Next message: <A HREF="031274.html">[Mono-dev] [Mono-patches] r128544 - in trunk/mono/mono:	metadata mini
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31273">[ date ]</a>
              <a href="thread.html#31273">[ thread ]</a>
              <a href="subject.html#31273">[ subject ]</a>
              <a href="author.html#31273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 2009-03-04 at 11:34 -0300, Rodrigo Kumpera wrote:

&gt;<i> On Wed, Mar 4, 2009 at 11:16 AM, Martin Baulig
</I>&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-patches-list at lists.ximian.com</A>&gt; wrote:
</I>&gt;<i>         Author: martin
</I>&gt;<i>         Date: 2009-03-04 09:16:55 -0500 (Wed, 04 Mar 2009)
</I>&gt;<i>         New Revision: 128544
</I>&gt;<i>         
</I>&gt;<i>         Modified:
</I>&gt;<i>           trunk/mono/mono/mini/exceptions-amd64.c
</I>&gt;<i>           trunk/mono/mono/mini/exceptions-x86.c
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Both these files have a nearly identical debugger_handle_exception
</I>&gt;<i> function. Please move it to an arch neutral file
</I>&gt;<i> and, if you need so, add new mono_arch calls to handle the
</I>&gt;<i> non-portable parts. If you're in doubt how to proceed with
</I>&gt;<i> this, please ask.
</I>
Hi Rodrigo,

I moved that into debug-mini.c and also cleaned up the API a lot and
added some more documentation.

There are now only two public API entry points:
mono_debugger_handle_exception() and
mono_debugger_call_exception_handler() and they also have some API
documentation.
&gt;<i> 
</I>&gt;<i> On a side note, most of this code deviates a lot from how a hard-mode
</I>&gt;<i> debugger operates, is it your intention to move
</I>&gt;<i> mdb to be a soft-mode debugger?
</I>
What do you mean by hard mode or soft mode ?

My intention was simply cleaning up and improving the badly broken old
API, which never really worked wrt unhandled exception.

For instance, in the old code, we were not telling the debugger the
correct %eip and %esp when calling it from inside
mono_handle_exception_internal() - because only the arch-specific code
could know that.

The other big change is that the debugger may now decide whether it
wants to stop when the exception is thrown or only if it's
user-unhandled - this was required by MonoVS.

Besides that, I also fixed all the race conditions where two or more
threads were throwing exceptions - or if the user did a func-eval while
stopped at the exception.

Martin


</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031271.html">[Mono-dev] [Mono-patches] r128544 - in trunk/mono/mono:	metadata mini
</A></li>
	<LI>Next message: <A HREF="031274.html">[Mono-dev] [Mono-patches] r128544 - in trunk/mono/mono:	metadata mini
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31273">[ date ]</a>
              <a href="thread.html#31273">[ thread ]</a>
              <a href="subject.html#31273">[ subject ]</a>
              <a href="author.html#31273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
