<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] DistCC and cross-compiling Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20DistCC%20and%20cross-compiling%20Mono&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031300.html">
   <LINK REL="Next"  HREF="031308.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] DistCC and cross-compiling Mono</H1>
    <B>bojanr at brandeis.edu</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20DistCC%20and%20cross-compiling%20Mono&In-Reply-To="
       TITLE="[Mono-dev] DistCC and cross-compiling Mono">bojanr at brandeis.edu
       </A><BR>
    <I>Thu Mar  5 23:57:10 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="031300.html">[Mono-dev] [PATCH] Update AuxV memcpy and icbi optimizations
</A></li>
        <LI>Next message: <A HREF="031308.html">[Mono-dev] DistCC and cross-compiling Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31301">[ date ]</a>
              <a href="thread.html#31301">[ thread ]</a>
              <a href="subject.html#31301">[ subject ]</a>
              <a href="author.html#31301">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Today I decided that I would try to get my x86_64 box to help out with
some compilation tasks (namely, compiling Mono--it's not particularly
slow, but any little bit helps). Both the server box and my laptop (the
host machine doing the compiling) are running Ubuntu, 8.10 on the server,
9.04 on the laptop, gcc 4.3.2, multiarch libs installed on the server box,
the works. Everything went swimmingly when compiling mono and libgc and
all the other C libs and tools, provided I included -m32 in CFLAGS and
LDFLAGS, except for compiling Jay.

I asked around in #mono, and was told that Jay was kind of hacked in--the
makefile is hand-written, and doesn't take into account many outside
parameters (none really, except for $prefix and maybe one other). In
search of a way to fix this, I stumbled upon the following section in
configure.in in the root of the mono source tree, which sets up
config.make for the mcs source tree based on what configure figured out
here in the mono source tree:

if test x$cross_compiling = xno &amp;&amp; test x$enable_mcs_build != xno; then
    echo &quot;prefix=$prefix&quot; &gt; $srcdir/$mcsdir/build/config.make
    echo &quot;exec_prefix=$exec_prefix&quot; &gt;&gt; $srcdir/$mcsdir/build/config.make
    echo &quot;sysconfdir=$sysconfdir&quot; &gt;&gt; $srcdir/$mcsdir/build/config.make
    echo 'mono_libdir=${exec_prefix}/lib' &gt;&gt; $srcdir/$mcsdir/build
    &lt;snip&gt;
fi

I patched this to pass on CFLAGS and LDFLAGS to the mcs makefile, so now
jay builds correctly when cross-compiling with distcc. The patch is
attached, and it's sort of a hack. It passes compilation, though it spews
out full screens of warnings because of all the warning flags that are
passed along to jay because they're passed to mono. If anyone has a better
solution to this issue, it'd be great to see it implemented.

Thanks,
Bojan Rajkovic
-------------- next part --------------
A non-text attachment was scrubbed...
Name: jay-cflags-ldflags-fix.patch
Type: text/x-patch
Size: 758 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090305/cab8c526/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090305/cab8c526/attachment.bin</A> 
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031300.html">[Mono-dev] [PATCH] Update AuxV memcpy and icbi optimizations
</A></li>
	<LI>Next message: <A HREF="031308.html">[Mono-dev] DistCC and cross-compiling Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31301">[ date ]</a>
              <a href="thread.html#31301">[ thread ]</a>
              <a href="subject.html#31301">[ subject ]</a>
              <a href="author.html#31301">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
