<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] bug in Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.LocalValidation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20bug%20in%0A%20Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.LocalValidation&In-Reply-To=%3Cdd816d63c5d648f98cf890b46011bdc0%40BL2PR08MB451.namprd08.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041349.html">
   <LINK REL="Next"  HREF="041411.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] bug in Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.LocalValidation</H1>
    <B>Edward Ned Harvey (mono)</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20bug%20in%0A%20Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.LocalValidation&In-Reply-To=%3Cdd816d63c5d648f98cf890b46011bdc0%40BL2PR08MB451.namprd08.prod.outlook.com%3E"
       TITLE="[Mono-dev] bug in Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.LocalValidation">edward.harvey.mono at clevertrove.com
       </A><BR>
    <I>Tue Apr  8 18:42:46 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="041349.html">[Mono-dev] Compiling Mono with Visual Studio 2013.
</A></li>
        <LI>Next message: <A HREF="041411.html">[Mono-dev] bug in Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.LocalValidation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41368">[ date ]</a>
              <a href="thread.html#41368">[ thread ]</a>
              <a href="subject.html#41368">[ subject ]</a>
              <a href="author.html#41368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have these two servers, identical in every way except for their ip, name, and certs.  The certs were created by exactly the same process for both machines.  I have done mozroots on the client.  Servers are running mono 3.2.8.

This server negotiates ssl just fine with windows or mac clients.  No problem.   (port 443) telefolder.vgocom.net
This server negotiates ssl fine for windows clients, and causes mac client to throw exception (UnknownCA).  Which is incorrect.  (port 443) telefolder.clevertrove.net

Code to reproduce the problem:

using System;
using System.Net;
using System.Net.Sockets;
using System.Net.Security;
using System.Security.Authentication;
using System.Diagnostics;

namespace FunWithSslCerts
{
    class MainClass
    {
        public static void Main(string[] args)
        {
            // const string hostname = &quot;telefolder.vgocom.net&quot;;    // works
            const string hostname = &quot;telefolder.clevertrove.net&quot;;
            const int port = 443;

            var client = new TcpClient();
            client.Connect(hostname, port);
            var mySslStream = new SslStream(client.GetStream(), leaveInnerStreamOpen: false);
            mySslStream.AuthenticateAsClient(
                targetHost: hostname,
                clientCertificates: null,
                enabledSslProtocols: SslProtocols.Tls,
                checkCertificateRevocation: false
            );
            // If we throw exception on the line above, we failed.
            // If we get here, we were successful.
            Debugger.Break();
        }
    }
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140408/542dcd6d/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140408/542dcd6d/attachment.html</A>&gt;
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041349.html">[Mono-dev] Compiling Mono with Visual Studio 2013.
</A></li>
	<LI>Next message: <A HREF="041411.html">[Mono-dev] bug in Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.LocalValidation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41368">[ date ]</a>
              <a href="thread.html#41368">[ thread ]</a>
              <a href="subject.html#41368">[ subject ]</a>
              <a href="author.html#41368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
