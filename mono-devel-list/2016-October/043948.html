<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Where can I find the offset setting place?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20Where%20can%20I%20find%20the%20offset%20setting%20place%3F&In-Reply-To=%3CCY1PR07MB2332C1682FB4440AB794B1A2A9D30%40CY1PR07MB2332.namprd07.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043937.html">
   <LINK REL="Next"  HREF="043955.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Where can I find the offset setting place?</H1>
    <B>Pin Cheng</B> 
    <A HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20Where%20can%20I%20find%20the%20offset%20setting%20place%3F&In-Reply-To=%3CCY1PR07MB2332C1682FB4440AB794B1A2A9D30%40CY1PR07MB2332.namprd07.prod.outlook.com%3E"
       TITLE="[Mono-dev] Where can I find the offset setting place?">pcheng at rocketsoftware.com
       </A><BR>
    <I>Tue Oct 18 08:29:59 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043937.html">[Mono-dev] Mono CI weather report 10/12
</A></li>
        <LI>Next message (by thread): <A HREF="043955.html">[Mono-dev] xbuild crash with mono 4.6.1?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43948">[ date ]</a>
              <a href="thread.html#43948">[ thread ]</a>
              <a href="subject.html#43948">[ subject ]</a>
              <a href="author.html#43948">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,
I found a test case generated IL code:
iconst r3 &lt;- [0]
storei4_membase_reg [sp + 0x34] &lt;- r3
...
add_imm r6 &lt;- sp [0x34]
...
call r3 &lt;- [r3 &lt;- R76] [r4 &lt;- R77] [r5 &lt;- R78] [r6 &lt;- R79] [r7 &lt;- R80] [r8 &lt;- R81] [r9 &lt;- R82] [r10 &lt;- R83] clobbers: c
I have traced actual executing instruction, I found that the offset 0x34 was not set correctly on my target
platform. the process is to use method to call a extern C function resides in shared library.
the signature is:
LIBTEST_API int STDCALL
mono_test_marshal_bool_ref (int arg, unsigned int expected, unsigned int testVal, unsigned int* bDefaultMarsh,
                         unsigned int* bBoolCustMarsh, char* bI1CustMarsh, unsigned char* bU1CustMarsh,
                         unsigned short* bVBCustMarsh)

It seems that the caller function set the wrong offset (0x34) to passing arguments and callee function overwrite
the memory so that passing parameter wrong.

Please tell me where could I find the offset setting place?

Thanks
Pin

================================
Rocket Software, Inc. and subsidiaries ? 77 Fourth Avenue, Waltham MA 02451 ? +1 877.328.2932 ? +1 781.577.4321
Unsubscribe from Marketing Messages/Manage Your Subscription Preferences - <A HREF="http://www.rocketsoftware.com/manage-your-email-preferences">http://www.rocketsoftware.com/manage-your-email-preferences</A>
Privacy Policy - <A HREF="http://www.rocketsoftware.com/company/legal/privacy-policy">http://www.rocketsoftware.com/company/legal/privacy-policy</A>
================================

This communication and any attachments may contain confidential information of Rocket Software, Inc. All unauthorized use, disclosure or distribution is prohibited. If you are not the intended recipient, please notify Rocket Software immediately and destroy all copies of this communication. Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/mono-devel-list/attachments/20161018/7eb2a4d8/attachment.html">http://lists.dot.net/pipermail/mono-devel-list/attachments/20161018/7eb2a4d8/attachment.html</A>&gt;
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043937.html">[Mono-dev] Mono CI weather report 10/12
</A></li>
	<LI>Next message (by thread): <A HREF="043955.html">[Mono-dev] xbuild crash with mono 4.6.1?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43948">[ date ]</a>
              <a href="thread.html#43948">[ thread ]</a>
              <a href="subject.html#43948">[ subject ]</a>
              <a href="author.html#43948">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
