<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] COM Interop Patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20COM%20Interop%20Patch&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020705.html">
   <LINK REL="Next"  HREF="020704.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] COM Interop Patch</H1>
    <B>Jon Chambers</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20COM%20Interop%20Patch&In-Reply-To="
       TITLE="[Mono-dev] COM Interop Patch">joncham at gmail.com
       </A><BR>
    <I>Fri Sep 29 23:27:39 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020705.html">[Mono-dev] [PATCH] Setting by Reflection a literal field
</A></li>
        <LI>Next message: <A HREF="020704.html">[Mono-dev] COM Interop Patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20702">[ date ]</a>
              <a href="thread.html#20702">[ thread ]</a>
              <a href="subject.html#20702">[ subject ]</a>
              <a href="author.html#20702">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Another patch for COM Interop. Details from ChangeLog:

    * domain.c, class-internals.h: Added ComInteropProxy class to
MonoDefaults.
    * marshal.c: Return correct unmanaged size for object when
MarshalAs.Struct.
    Emit exception rather than crash in case of COM Callable Wrapper (not
yet implemented).
    Handle marshalling of interfaces and VARIANTs contained in structs.

    Code is contributed under MIT/X11 license.

Just an update, at this point I'm hoping to start working on COM Callable
Wrappers (exposing managed objects to unmanaged code as COM objects). The
only other thing I was considering was moving as much COM Interop code as
possible to seperate files (cominterop.c/.h) and add a
marshal-internals.hfor some functionality that is needed. Is this
worthwhile? If not, I'm glad
to just continue working as is.

The code to marshal VARIANTs and interfaces is duplicated for within structs
and in emit_marshal_object. Any advice on the best way to have this code in
one place; perhaps a routine that assumes source/dest addresses are on the
stack, similar to what is done for struct marshalling? Or is the code
duplication just not that big of an issue?

Thanks,
Jonathan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060929/06a68e7f/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060929/06a68e7f/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: compatch.diff
Type: application/octet-stream
Size: 13337 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060929/06a68e7f/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060929/06a68e7f/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020705.html">[Mono-dev] [PATCH] Setting by Reflection a literal field
</A></li>
	<LI>Next message: <A HREF="020704.html">[Mono-dev] COM Interop Patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20702">[ date ]</a>
              <a href="thread.html#20702">[ thread ]</a>
              <a href="subject.html#20702">[ subject ]</a>
              <a href="author.html#20702">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
