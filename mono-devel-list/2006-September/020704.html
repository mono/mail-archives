<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] COM Interop Patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20COM%20Interop%20Patch&In-Reply-To=17c2d80b0609292027l2c7229feyef76462c476b44b7%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020702.html">
   <LINK REL="Next"  HREF="020703.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] COM Interop Patch</H1>
    <B>Zoltan Varga</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20COM%20Interop%20Patch&In-Reply-To=17c2d80b0609292027l2c7229feyef76462c476b44b7%40mail.gmail.com"
       TITLE="[Mono-dev] COM Interop Patch">vargaz at gmail.com
       </A><BR>
    <I>Sat Sep 30 07:05:45 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020702.html">[Mono-dev] COM Interop Patch
</A></li>
        <LI>Next message: <A HREF="020703.html">[Mono-dev] Suggestion: Mono.Collection really useful
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20704">[ date ]</a>
              <a href="thread.html#20704">[ thread ]</a>
              <a href="subject.html#20704">[ subject ]</a>
              <a href="author.html#20704">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>                   Hi,

  Some comments:
- cominterop_object_is_rcw should return a gboolean
- in the icall registration, the correct signature is &quot;int32 object&quot;

Other than that, I think this is ok to check in. About the reorg: we
have way too
many way too big files, so this will be useful, but I'm not sure this
is the right time
to do it, since 1.2 is close. But if we do it after the big release,
then we will
have problems merging changes back.

                               Zoltan

On 9/30/06, Jon Chambers &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">joncham at gmail.com</A>&gt; wrote:
&gt;<i> Another patch for COM Interop. Details from ChangeLog:
</I>&gt;<i>
</I>&gt;<i>     * domain.c, class-internals.h: Added ComInteropProxy class to
</I>&gt;<i> MonoDefaults.
</I>&gt;<i>     * marshal.c: Return correct unmanaged size for object when
</I>&gt;<i> MarshalAs.Struct .
</I>&gt;<i>     Emit exception rather than crash in case of COM Callable Wrapper (not
</I>&gt;<i> yet implemented).
</I>&gt;<i>     Handle marshalling of interfaces and VARIANTs contained in structs.
</I>&gt;<i>
</I>&gt;<i>     Code is contributed under MIT/X11 license.
</I>&gt;<i>
</I>&gt;<i> Just an update, at this point I'm hoping to start working on COM Callable
</I>&gt;<i> Wrappers (exposing managed objects to unmanaged code as COM objects). The
</I>&gt;<i> only other thing I was considering was moving as much COM Interop code as
</I>&gt;<i> possible to seperate files ( cominterop.c/.h) and add a marshal-internals.h
</I>&gt;<i> for some functionality that is needed. Is this worthwhile? If not, I'm glad
</I>&gt;<i> to just continue working as is.
</I>&gt;<i>
</I>&gt;<i> The code to marshal VARIANTs and interfaces is duplicated for within structs
</I>&gt;<i> and in emit_marshal_object. Any advice on the best way to have this code in
</I>&gt;<i> one place; perhaps a routine that assumes source/dest addresses are on the
</I>&gt;<i> stack, similar to what is done for struct marshalling? Or is the code
</I>&gt;<i> duplication just not that big of an issue?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Jonathan
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020702.html">[Mono-dev] COM Interop Patch
</A></li>
	<LI>Next message: <A HREF="020703.html">[Mono-dev] Suggestion: Mono.Collection really useful
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20704">[ date ]</a>
              <a href="thread.html#20704">[ thread ]</a>
              <a href="subject.html#20704">[ subject ]</a>
              <a href="author.html#20704">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
