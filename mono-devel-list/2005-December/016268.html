<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Embedded Mono and System.Diagnostics.Process
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Embedded%20Mono%20and%20System.Diagnostics.Process&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016266.html">
   <LINK REL="Next"  HREF="016269.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Embedded Mono and System.Diagnostics.Process</H1>
    <B>Mike Hull</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Embedded%20Mono%20and%20System.Diagnostics.Process&In-Reply-To="
       TITLE="[Mono-dev] Embedded Mono and System.Diagnostics.Process">mike.hull at coversant.net
       </A><BR>
    <I>Tue Dec 20 19:40:40 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="016266.html">[Mono-dev] mono-service
</A></li>
        <LI>Next message: <A HREF="016269.html">[Mono-dev] Dropping privileges in linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16268">[ date ]</a>
              <a href="thread.html#16268">[ thread ]</a>
              <a href="subject.html#16268">[ subject ]</a>
              <a href="author.html#16268">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Guys,

I have a C# application that runs inside of a C daemon.  It does not 
show up when I call System.Diagnostics.Process.GetProcesses();   I'm 
trying to avoid just using a lockfile.pid... 

Do I need to do something else to get this to work?

void main_thread_handler(gpointer userdata)
{
    MonoAssembly *assembly;
    MainThreadArgs *mainthreadargs = (MainThreadArgs *) userdata;

    /* load the server daemon assembly */
    assembly = 
mono_domain_assembly_open(mainthreadargs-&gt;domain,&quot;Coversant.SoapBox.Server.Daemon.exe&quot;);
    if (!assembly) exit(EXIT_ERRORLOADINGASSEMBLY);

    /* execute daemon.exe's static entry point */
    mono_jit_exec (mainthreadargs-&gt;domain, assembly, 
mainthreadargs-&gt;argc, mainthreadargs-&gt;argv);
}

int main(int argc, char* argv[])
{
    MonoDomain *domain;
    int retval;

    mono_set_defaults(0, mono_parse_default_optimizations(NULL));

    /* jit the daemon */
    domain = mono_jit_init (&quot;Coversant.SoapBox.Server.Daemon.exe&quot;);

    /* set the stuff that the main thread needs to know */
    MainThreadArgs mainargs;
    mainargs.domain = domain;
    mainargs.argc = argc;
    mainargs.argv = argv;

    /* parse config */
    mono_config_parse(NULL);

    /* transfer control to mono */
    mono_runtime_exec_managed_code(domain, main_thread_handler, &amp;mainargs);

    /* get exit code from mono */
    retval = mono_environment_exitcode_get ();

    mono_jit_cleanup (domain);
    return retval;
}

Thanks,
-- 
Mike Hull
Coversant, Inc.
Leader in XMPP Instant Messaging

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016266.html">[Mono-dev] mono-service
</A></li>
	<LI>Next message: <A HREF="016269.html">[Mono-dev] Dropping privileges in linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16268">[ date ]</a>
              <a href="thread.html#16268">[ thread ]</a>
              <a href="subject.html#16268">[ subject ]</a>
              <a href="author.html#16268">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
