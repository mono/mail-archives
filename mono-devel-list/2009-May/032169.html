<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Bug #360455
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Bug%20%23360455&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032191.html">
   <LINK REL="Next"  HREF="032223.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Bug #360455</H1>
    <B>Stefan Noack</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Bug%20%23360455&In-Reply-To="
       TITLE="[Mono-dev] Bug #360455">noackstefan at googlemail.com
       </A><BR>
    <I>Sun May 17 11:21:04 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032191.html">[Mono-dev] [Patch] gmcs considers bla&lt;T&gt; and bla{T} as illegal in a	cref
</A></li>
        <LI>Next message: <A HREF="032223.html">[Mono-dev] Bug #360455
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32169">[ date ]</a>
              <a href="thread.html#32169">[ thread ]</a>
              <a href="subject.html#32169">[ subject ]</a>
              <a href="author.html#32169">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been trying to fix <A HREF="https://bugzilla.novell.com/show_bug.cgi?id=360455.">https://bugzilla.novell.com/show_bug.cgi?id=360455.</A>

&quot;(g)mcs erroneously raises &quot;x is never used&quot; warning CS0067 with public events&quot;

This happens when the containing class is generic but the event does not use the
generic type in it's signature. Therre is another test case that
reproduces the bug
without generics but contains a class with an abstract event and a derived class
implementing and using it. Here the warning is uttered erroneously, too.

I looked into the mcs code but I could not quite find out, what's
going on here, though.
I believe the interesting part may be that one:

ecore.cs: line 5651, constructor of EventExpr class

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; public EventExpr (EventInfo ei, Location loc)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; EventInfo = ei;

                        // uninteresting code here

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (EventInfo is MyEventBuilder){
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MyEventBuilder eb = (MyEventBuilder) EventInfo;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; type = eb.EventType;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; eb.SetUsed (); // here the event is
flagged as used
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } else
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; type = EventInfo.EventHandlerType;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }

Here the event is flagged as used in the constructor of the EventExpr
that refers to it.
This is very elegant but as you can see there is nothing that sets the
flag in the
else branch of the second if clause. Looks to me like in the special
cases that trigger
the bug EventInfo is not a MyEventBuilder. (MyEventBuilder is declared
in class.cs,
you may want to look there and see what it does.)

I don't know how to cleanly set the flag in that case. Any Ideas?
Maybe I am completely wrong and the error is somewhere else in the code...

Best Regards,

Stefan
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032191.html">[Mono-dev] [Patch] gmcs considers bla&lt;T&gt; and bla{T} as illegal in a	cref
</A></li>
	<LI>Next message: <A HREF="032223.html">[Mono-dev] Bug #360455
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32169">[ date ]</a>
              <a href="thread.html#32169">[ thread ]</a>
              <a href="subject.html#32169">[ subject ]</a>
              <a href="author.html#32169">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
