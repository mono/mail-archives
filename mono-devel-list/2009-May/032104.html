<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Red Hat/Fedora packaging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Red%20Hat/Fedora%20packaging&In-Reply-To=C3253A86E7C2944BAE83EC757AB6FD4301F80D1D%40dsci-exch01.dsci.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032103.html">
   <LINK REL="Next"  HREF="032105.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Red Hat/Fedora packaging</H1>
    <B>Toshio Kuratomi</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Red%20Hat/Fedora%20packaging&In-Reply-To=C3253A86E7C2944BAE83EC757AB6FD4301F80D1D%40dsci-exch01.dsci.com"
       TITLE="[Mono-dev] Red Hat/Fedora packaging">a.badger at gmail.com
       </A><BR>
    <I>Tue May 12 08:43:24 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032103.html">[Mono-dev] Red Hat/Fedora packaging
</A></li>
        <LI>Next message: <A HREF="032105.html">[Mono-dev] Red Hat/Fedora packaging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32104">[ date ]</a>
              <a href="thread.html#32104">[ thread ]</a>
              <a href="subject.html#32104">[ subject ]</a>
              <a href="author.html#32104">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Vladimir Giszpenc wrote:
&gt;<i> The following was taken from <A HREF="https://fedoraproject.org/wiki/Packaging/Mono">https://fedoraproject.org/wiki/Packaging/Mono</A>
</I>&gt;<i> 
</I>&gt;<i> * *
</I>&gt;<i> 
</I>&gt;<i> *File Locations***
</I>&gt;<i> 
</I>&gt;<i> Mono packages should install assemblies to %{_libdir} rather than
</I>&gt;<i> /usr/lib or %{_datadir}. In most cases the preference is
</I>&gt;<i> for %{_libdir}/PACKAGENAME. We use %{_libdir} because we do not consider
</I>&gt;<i> mono packages to be noarch.
</I>&gt;<i> 
</I>&gt;<i> The main reason for this is that mono can ahead-of-time compile its
</I>&gt;<i> assemblies into ELF shared objects. These AOTs have to exist in the same
</I>&gt;<i> directory as their DLL/EXE counterparts otherwise mono cannot use them.
</I>&gt;<i> Even if we, as packagers, choose not to create the AOT files when we
</I>&gt;<i> build the mono rpms, the system administrator can choose to create them
</I>&gt;<i> after install. Since there's no way to place the mono assemblies into an
</I>&gt;<i> arch independent directory and the AOTs into arch dependent directories,
</I>&gt;<i> the whole thing has to go into an arch dependent tree.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> It really bothers me that Red Hat/Fedora considers CIL packages not to
</I>&gt;<i> be noarch.  I would like to propose using the config file to allow
</I>&gt;<i> relocating the aot-ed file to some arch dependent location.  The problem
</I>&gt;<i> they have is that the aot-ed code must be side-by-side with the pre
</I>&gt;<i> compiled assembly.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Could we use Foo.dll.config to have sections per architecture that tell
</I>&gt;<i> the runtime where to load the aot-ed file from?
</I>&gt;<i> 
</I>&gt;<i> I don&#8217;t actually use aot-ed code.  I just want to get my package (exe)
</I>&gt;<i> to be noarch.   Using Red Hat is not my choice so please don&#8217;t suggest
</I>&gt;<i> that I use another distribution.  Please help me get these packaging
</I>&gt;<i> guidelines changed.
</I>&gt;<i> 
</I>&gt;<i>  
</I>Note that there's two reasons to consider the packages arch specific and
one thing to consider if the packages are noarch:

Reasons for arch specific:
* aot compiled code has to live alongside the CIL files.
* No one in Fedora has devised a way of telling when a CIL file depends
on something architecture specific (like calling out to native code that
uses different word sizes on different architectures).  This one might
be a misunderstanding or something that's actually easy to do.

The noarch difficulty:
* According to the FHS, if CIL files are architecture independent they
should live under /usr/share/ instead of under /usr/lib.

Note: For those who are unfamiliar with multilib, %{_libdir} != /usr/lib
on all arches.  On x86_64, %{_libdir} == /usr/lib64.  /usr/lib exists
there and has 32 bit versions of libraries for running 32 bit programs.

I'd love for this to be figured out upstream as we presently have to
patch things that install in /usr/lib to go to %{_libdir} (although the
prospect of patching things to go to %{_datadir} instead isn't anymore
appetizing.)

-Toshio

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: OpenPGP digital signature
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090512/5fcfe853/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090512/5fcfe853/attachment.bin</A> 
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032103.html">[Mono-dev] Red Hat/Fedora packaging
</A></li>
	<LI>Next message: <A HREF="032105.html">[Mono-dev] Red Hat/Fedora packaging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32104">[ date ]</a>
              <a href="thread.html#32104">[ thread ]</a>
              <a href="subject.html#32104">[ subject ]</a>
              <a href="author.html#32104">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
