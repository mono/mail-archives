<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] About your changes to type initialization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20About%20your%20changes%20to%20type%20initialization&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034308.html">
   <LINK REL="Next"  HREF="034291.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] About your changes to type initialization</H1>
    <B>Rodrigo Kumpera</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20About%20your%20changes%20to%20type%20initialization&In-Reply-To="
       TITLE="[Mono-dev] About your changes to type initialization">kumpera at gmail.com
       </A><BR>
    <I>Thu Mar  4 10:14:50 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="034308.html">[Mono-dev] System.Threading.Monitor::Exit fails in latest trees
</A></li>
        <LI>Next message: <A HREF="034291.html">[Mono-dev] About your changes to type initialization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34289">[ date ]</a>
              <a href="thread.html#34289">[ thread ]</a>
              <a href="subject.html#34289">[ subject ]</a>
              <a href="author.html#34289">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Martin,

You change in r152558 is wrong, the test you committed doesn't work on MS.
Type constructors must no be run multiple time, even under a debugging
session, as
this is an assumption made by most developers that we can't break.

The solution for your problem is to tag the thread as doing a .cctor
invocation and do the abort
right after it finishes. This is cleaner, correct and use less memory.

You might ask what should happen is the .cctor blocks for way too long,
well, the solution then
is to interrupt the thread and accept the fact that the debugging session
went south.

I attached a reworked version of your test that has more console spew and
shows up clearly the issue.

If you could better state the problem you're trying to solve we'll be better
able to help you fixing it.

Thanks,
Rodrigo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20100304/eb85cbef/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20100304/eb85cbef/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: abort-invoke.cs
Type: application/octet-stream
Size: 1370 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20100304/eb85cbef/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20100304/eb85cbef/attachment.obj</A> 
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034308.html">[Mono-dev] System.Threading.Monitor::Exit fails in latest trees
</A></li>
	<LI>Next message: <A HREF="034291.html">[Mono-dev] About your changes to type initialization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34289">[ date ]</a>
              <a href="thread.html#34289">[ thread ]</a>
              <a href="subject.html#34289">[ subject ]</a>
              <a href="author.html#34289">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
