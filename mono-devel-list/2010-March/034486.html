<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] WCF more detail on Destination Unreachable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20WCF%20more%20detail%20on%20Destination%20Unreachable&In-Reply-To=F58CD3BF9A7E564C927975D9BF8486730C7467%40sbs.ShoutTelecoms.local">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034475.html">
   <LINK REL="Next"  HREF="034488.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] WCF more detail on Destination Unreachable</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20WCF%20more%20detail%20on%20Destination%20Unreachable&In-Reply-To=F58CD3BF9A7E564C927975D9BF8486730C7467%40sbs.ShoutTelecoms.local"
       TITLE="[Mono-dev] [PATCH] WCF more detail on Destination Unreachable">atsushieno at veritas-vos-liberabit.com
       </A><BR>
    <I>Thu Mar 25 00:12:13 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="034475.html">[Mono-dev] [PATCH] WCF more detail on Destination Unreachable
</A></li>
        <LI>Next message: <A HREF="034488.html">[Mono-dev] [PATCH] WCF more detail on Destination Unreachable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34486">[ date ]</a>
              <a href="thread.html#34486">[ thread ]</a>
              <a href="subject.html#34486">[ subject ]</a>
              <a href="author.html#34486">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the test, it cleared some things up :)

So - first, I cannot apply your HttpRequestChannel change. The code you
removed was introduced to fix real problem regarding HTTP 4xx; when
HTTP 4xx is returned, the response stream is inaccessible and the channel
should not try to read it.

Instead, the server code seems to have an issue that it should just
return 500. While it is set to 400 at HttpRequestContext with explicit
comment that &quot;it is what .NET does&quot;, I was likely wrong by seeing
response from WebHttpBinding, which likely has special error handling.

In general our fault handling is not well done yet and I'm seeing a
couple of issues to get correct fix there. Better fault handling is one
of the tasks on my stack, but it may be time to give priority than 
ongoing bugfix as it's blocking your patch that will help my ongoing work...

Atsushi Eno


On 2010/03/24 19:41, Matt Dargavel wrote:
&gt;<i> Apologies for the wait- it's the time difference! :-)
</I>&gt;<i>
</I>&gt;<i> I've come up with a test for the DestinationUnreachable patch.  When I
</I>&gt;<i> was doing my testing I was using a combination of a .NET client and
</I>&gt;<i> manually firing in requests using PuTTY and examining the reply.  When I
</I>&gt;<i> use a WCF Client in Mono the exception detail is currently lost in
</I>&gt;<i> HttpRequestChannel, with a WebException being returned instead.
</I>&gt;<i>
</I>&gt;<i> The patch I've attached changes HttpRequestChannel so that 400+ errors
</I>&gt;<i> are returned normally.  This results in a FaultException being returned
</I>&gt;<i> instead.  The FaultException includes the extra details my previous
</I>&gt;<i> patch added.
</I>&gt;<i>
</I>&gt;<i> Do you think this is acceptable and covers what you need?  Hopefully
</I>&gt;<i> you'll be able to add it to the NUnit tests fairly easily.
</I>&gt;<i>
</I>&gt;<i> 	Thanks,
</I>&gt;<i>
</I>&gt;<i> 		Matt.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: Atsushi Eno [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushieno at veritas-vos-liberabit.com</A>]
</I>&gt;&gt;<i> Sent: 24 March 2010 6:18 AM
</I>&gt;&gt;<i> To: Matt Dargavel
</I>&gt;&gt;<i> Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> Subject: Re: [Mono-dev] [PATCH] WCF more detail on Destination
</I>&gt;<i> Unreachable
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Instead of waiting for your reply, I've rather committed the patch
</I>&gt;<i> (with
</I>&gt;&gt;<i> a few change) and verify it later with a runnable repro. -&gt;
</I>&gt;&gt;<i> DestinationUnreachableInfo.patch is done
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Atsushi Eno
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 2010/03/24 14:35, Atsushi Eno wrote:
</I>&gt;&gt;&gt;<i> I still couldn't reproduce the detailed error message. Let's please
</I>&gt;<i> post
</I>&gt;&gt;&gt;<i> a runnable repro case instead of code-less explanation ;)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Atsushi Eno
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 2010/03/23 22:38, Matt Dargavel wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> You can reproduce it by requesting an operation that doesn't exist.
</I>&gt;<i> (It
</I>&gt;&gt;&gt;&gt;<i> was happening before I implemented the two Service Contracts on one
</I>&gt;<i> end
</I>&gt;&gt;&gt;&gt;<i> point change as the wrong channel dispatcher was getting the
</I>&gt;<i> request.)
</I>&gt;&gt;&gt;&gt;<i> So I should be able to write a test case for that...
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;&gt;&gt;&gt;<i> From: Atsushi Eno [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushieno at veritas-vos-liberabit.com</A>]
</I>&gt;&gt;&gt;&gt;&gt;<i> Sent: 23 March 2010 12:57 PM
</I>&gt;&gt;&gt;&gt;&gt;<i> To: Matt Dargavel
</I>&gt;&gt;&gt;&gt;&gt;<i> Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> Subject: Re: [PATCH] WCF more detail on Destination Unreachable
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> It's looking fine, but how did you check your change? (I know it
</I>&gt;<i> could
</I>&gt;&gt;&gt;&gt;&gt;<i> happen not always reproducible, so that's okay if it's not really
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> always
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> reproducible.)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> BTW I thank a lot for your properties change, that fixed a bug
</I>&gt;<i> that
</I>&gt;&gt;&gt;&gt;&gt;<i> annoyed me today ;-)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Atsushi Eno
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On 2010/03/23 20:28, Matt Dargavel wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> A patch to return more detail when an endpoint / operation isn't
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> found. Not sure if you'll want to apply this, but it helped in
</I>&gt;<i> some
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> service debugging I was doing.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Matt.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;<i>
</I>
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034475.html">[Mono-dev] [PATCH] WCF more detail on Destination Unreachable
</A></li>
	<LI>Next message: <A HREF="034488.html">[Mono-dev] [PATCH] WCF more detail on Destination Unreachable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34486">[ date ]</a>
              <a href="thread.html#34486">[ thread ]</a>
              <a href="subject.html#34486">[ subject ]</a>
              <a href="author.html#34486">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
