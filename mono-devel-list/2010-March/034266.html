<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Equivalent to LockFileEx on Linux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Equivalent%20to%20LockFileEx%20on%20Linux&In-Reply-To=1267584869.6725.75.camel%40lina.magi.jprl.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034265.html">
   <LINK REL="Next"  HREF="034270.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Equivalent to LockFileEx on Linux</H1>
    <B>Avery Pennarun</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Equivalent%20to%20LockFileEx%20on%20Linux&In-Reply-To=1267584869.6725.75.camel%40lina.magi.jprl.com"
       TITLE="[Mono-dev] Equivalent to LockFileEx on Linux">apenwarr at gmail.com
       </A><BR>
    <I>Tue Mar  2 22:14:50 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="034265.html">[Mono-dev] Equivalent to LockFileEx on Linux
</A></li>
        <LI>Next message: <A HREF="034270.html">[Mono-dev] Here's a patch for /dev/shm/mono.pid's piling up on Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34266">[ date ]</a>
              <a href="thread.html#34266">[ thread ]</a>
              <a href="subject.html#34266">[ subject ]</a>
              <a href="author.html#34266">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Mar 2, 2010 at 9:54 PM, Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jonpryor at vt.edu</A>&gt; wrote:
&gt;<i> In short, SQLite (1) uses advisory file locking (as FileStream.Lock()
</I>&gt;<i> provides under Mono), then (2) requires that all SQLite users actually
</I>&gt;<i> use libsqlite.so (otherwise they won't use the internal management).
</I>
Well, I'm guessing the developer of libsqlite.so was not expecting
there to be other conflicting implementations of sqlite that would all
be accessing the same database.

So if the managed sqlite clone is supposed to be 100% interoperable
with the real sqlite (which I doubt it very important), it needs to do
exactly the same kind of locking, ie. your solution #3.  Otherwise, it
needs to do its own locking however it likes, your solution #1 or #2.

So I suppose I'm agreeing with your facts, but not your opinions...
I'm not sure what's so ugly about this solution.

&gt;<i> So if someone re-implements SQLite (or just cat(1)'s the file), they
</I>&gt;<i> won't go through SQLites lock management, and they'll be none the wiser.
</I>
As it (arguably of course) should be.  People writing backup software
on Unix are much happier people than people writing backup software on
Windows.  And as a user, I'd prefer to have multiple
possibly-slightly-corrupted backups of my MS Exchange server or
virtual machine disks instead of the terrible surprise upon restoring
of finding out there were no backups (because mandatory locks rejected
me).

Mandatory locking isn't nearly as great as it sounds.

Have fun,

Avery
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034265.html">[Mono-dev] Equivalent to LockFileEx on Linux
</A></li>
	<LI>Next message: <A HREF="034270.html">[Mono-dev] Here's a patch for /dev/shm/mono.pid's piling up on Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34266">[ date ]</a>
              <a href="thread.html#34266">[ thread ]</a>
              <a href="subject.html#34266">[ subject ]</a>
              <a href="author.html#34266">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
