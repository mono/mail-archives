<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Problems with System.ServiceModel.Web
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problems%20with%20System.ServiceModel.Web&In-Reply-To=4CB0356B.5060904%40nowisys.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036016.html">
   <LINK REL="Next"  HREF="036054.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Problems with System.ServiceModel.Web</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problems%20with%20System.ServiceModel.Web&In-Reply-To=4CB0356B.5060904%40nowisys.de"
       TITLE="[Mono-dev] Problems with System.ServiceModel.Web">atsushieno at veritas-vos-liberabit.com
       </A><BR>
    <I>Tue Oct 12 07:30:23 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="036016.html">[Mono-dev] Problems with System.ServiceModel.Web
</A></li>
        <LI>Next message: <A HREF="036054.html">[Mono-dev] Problems with System.ServiceModel.Web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36039">[ date ]</a>
              <a href="thread.html#36039">[ thread ]</a>
              <a href="subject.html#36039">[ subject ]</a>
              <a href="author.html#36039">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>  Hello,

Thanks for the patch, I very much appreciate it. Though there were some 
problems in your patch.

     - your implementation had an assumptiopn that WebGetAttribute and
       WebInvokeAttribute has non-null UriTemplate. They can indeed be null.
     - Your change broke RejectTwoParametersWhenNotWrapped() in
       WebInvokeAttributeTest. It is because, in your 
WebHttpBehavior.Validate()
       change you just removed existing code that checked what this test 
exactly
       verifies i.e. invalid multiple arguments. You might think it is 
&quot;very strange&quot;
       and &quot;wrong&quot; but that's what .NET indeed does (looks like it is 
done in
       GetClientMessageFormatter() in current version of .NET though).
     - There was a couple of coding style fixage needed. You had right 
and wrong
       style, so I assume you might have already known the style, but in 
case you
       haven't, have a look at <A HREF="http://mono-project.com/Coding_Guidelines">http://mono-project.com/Coding_Guidelines</A>
       (I found this page was not linked from our &quot;Contributing&quot; page, 
which was
       our bad, just fixed it.)

I'm attaching the modified fix here. It includes some additional tests. 
I'll commit the changes unless you have further comments.

(As a cosmetic excuse, WebMessageBodyStyle.Bare was new in 3.5 SP1 
AFAIR, so it was left ignorant in our implementation from 3.5 era.)

Atsushi Eno

On 2010/10/09 18:27, Frank Wilhelm wrote:
&gt;<i>  Hello Mono devs,
</I>&gt;<i>
</I>&gt;<i> I tried running my web service on Mono and ran into several issues. I 
</I>&gt;<i> use the WebHttpBinding to create REST web services by hosting that 
</I>&gt;<i> with the ServiceHost class. This works fine on .NET but the Mono 
</I>&gt;<i> implementation of System.ServiceModel.Web shows very different, and 
</I>&gt;<i> very limiting, behavior. So I decided instead of waiting for a fix I 
</I>&gt;<i> try to track down the issues. Here is the first I discovered.
</I>&gt;<i>
</I>&gt;<i> The Validation of WebHttpBehavior is very limiting. If a POST 
</I>&gt;<i> operation has several parameters it will only host them if you define 
</I>&gt;<i> 'wrapped' body format. But this isn't required if the parameters are 
</I>&gt;<i> passed in the UriTemplate. Also the requirements for WrappedRequest 
</I>&gt;<i> and WrappedResponse look very strange. I have to wrap my response if I 
</I>&gt;<i> have multiple input parameters? That looks wrong.
</I>&gt;<i>
</I>&gt;<i> I looked up in the MSDN what the Validate method does for .NET, and 
</I>&gt;<i> then I tried to make the .NET implementation fail. It just doesn't 
</I>&gt;<i> behave like specified in the documentation, it never fails no matter 
</I>&gt;<i> what.
</I>&gt;<i>
</I>&gt;<i> I attach a patch that will make the Validate method less picky. It 
</I>&gt;<i> will look for placeholders in the URI template and only after that 
</I>&gt;<i> decides whether wrapping is needed or not. That is still more 
</I>&gt;<i> restrictive than the .NET implementation but for me it looks like the 
</I>&gt;<i> right thing to do. I also added a test that reproduces the problem.
</I>&gt;<i>
</I>&gt;<i> Please accept the patch and give me some feedback on what I can 
</I>&gt;<i> improve for further contributions.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: validate-bare-body-style-modified.patch
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20101012/88fa0e40/attachment-0001.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20101012/88fa0e40/attachment-0001.pl</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036016.html">[Mono-dev] Problems with System.ServiceModel.Web
</A></li>
	<LI>Next message: <A HREF="036054.html">[Mono-dev] Problems with System.ServiceModel.Web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36039">[ date ]</a>
              <a href="thread.html#36039">[ thread ]</a>
              <a href="subject.html#36039">[ subject ]</a>
              <a href="author.html#36039">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
