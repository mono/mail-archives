<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono and ASP.NET Security Vulnerability
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20and%20ASP.NET%20Security%20Vulnerability&In-Reply-To=1285956479.15305.3.camel%40mizar.home">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035966.html">
   <LINK REL="Next"  HREF="035963.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono and ASP.NET Security Vulnerability</H1>
    <B>dan witt</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20and%20ASP.NET%20Security%20Vulnerability&In-Reply-To=1285956479.15305.3.camel%40mizar.home"
       TITLE="[Mono-dev] Mono and ASP.NET Security Vulnerability">dan.witt at gmail.com
       </A><BR>
    <I>Fri Oct  1 17:46:06 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035966.html">[Mono-dev] Mono and ASP.NET Security Vulnerability
</A></li>
        <LI>Next message: <A HREF="035963.html">[Mono-dev] [PATCH] Enable sgen on sparc and Solaris
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35967">[ date ]</a>
              <a href="thread.html#35967">[ thread ]</a>
              <a href="subject.html#35967">[ subject ]</a>
              <a href="author.html#35967">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Based on code inspection it looks to me like Mono is partially vulnerable.

There are/were two basic problems with the MS implementation:

1) when an incorrect string is passed in the 'd' paramater to
WebResource.axd, which is processed by
System.Web.Handlers.WebResourceHandler.ProcessRequest, the exception that is
thrown depends on whether the padding in the decrypted string is correct or
not.  This is the padding oracle that lets an attacker encrypt (or decrypt)
arbitrary strings with the key used by the oracle.

Mono's implementation appears to also have this problem in
both WebResourceHandler and ScriptResourceHandler.

The fix for this is to include a MAC as part of the request string.


2) given an encrypted string representing a file ScriptResource.axd, which
is processed by System.Web.Handlers.ScriptResourceHandler.ProcessRequest,
allows for the download of arbitrary files from within the applications
Virtual Path.

Mono's implementation doesn't appear to allow for anything other than
embedded resources to be downloaded through this path and so isn't
vulnerable.

Dan Witt

On Fri, Oct 1, 2010 at 2:07 PM, Sebastien Pouliot &lt;
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sebastien.pouliot at gmail.com</A>&gt; wrote:

&gt;<i> My previous answer still stand. Watch the following link for updates:
</I>&gt;<i> <A HREF="http://www.mono-project.com/Vulnerabilities">http://www.mono-project.com/Vulnerabilities</A>
</I>&gt;<i>
</I>&gt;<i> On Fri, 2010-10-01 at 12:52 +0200, Tomi wrote:
</I>&gt;<i> &gt; Any update on this issue? The MS patch is already out. Some background
</I>&gt;<i> &gt; information:
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://blogs.technet.com/b/srd/archive/2010/09/17/understanding-the-asp-net-vulnerability.aspx">http://blogs.technet.com/b/srd/archive/2010/09/17/understanding-the-asp-net-vulnerability.aspx</A>
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://weblogs.asp.net/scottgu/archive/2010/09/30/asp-net-security-fix-now-on-windows-update.aspx">http://weblogs.asp.net/scottgu/archive/2010/09/30/asp-net-security-fix-now-on-windows-update.aspx</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 19 September 2010 11:47, Tomi &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bosak.tomas at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; Hi folks,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; is mono also affected by this security vulnerability? (ScottGu: &quot;This
</I>&gt;<i> &gt; &gt; vulnerability is in our ASP.NET implementation (and will be fixed in a
</I>&gt;<i> &gt; &gt; patch).  I'm not sure if Mono has the same bug.&quot;)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> <A HREF="http://weblogs.asp.net/scottgu/archive/2010/09/18/important-asp-net-security-vulnerability.aspx">http://weblogs.asp.net/scottgu/archive/2010/09/18/important-asp-net-security-vulnerability.aspx</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20101001/bd09d81a/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20101001/bd09d81a/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035966.html">[Mono-dev] Mono and ASP.NET Security Vulnerability
</A></li>
	<LI>Next message: <A HREF="035963.html">[Mono-dev] [PATCH] Enable sgen on sparc and Solaris
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35967">[ date ]</a>
              <a href="thread.html#35967">[ thread ]</a>
              <a href="subject.html#35967">[ subject ]</a>
              <a href="author.html#35967">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
