<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Re: Abcremoval
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20Abcremoval&In-Reply-To=41FE5348.1070708%40wpkrenn.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010212.html">
   <LINK REL="Next"  HREF="010211.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Re: Abcremoval</H1>
    <B>Massimiliano Mantione</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20Abcremoval&In-Reply-To=41FE5348.1070708%40wpkrenn.net"
       TITLE="[Mono-devel-list] Re: Abcremoval">massi at ximian.com
       </A><BR>
    <I>Tue Feb  1 04:37:02 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010212.html">[Mono-devel-list] Make distcheck failing...
</A></li>
        <LI>Next message: <A HREF="010211.html">[Mono-devel-list] Re: Abcremoval
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10205">[ date ]</a>
              <a href="thread.html#10205">[ thread ]</a>
              <a href="subject.html#10205">[ subject ]</a>
              <a href="author.html#10205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I cc the list because this could be of general interest, hope
you don't mind...

On Mon, 2005-01-31 at 16:48, Willibald Krenn wrote: 
&gt;<i> As you are the author of the abcrem, you can surely tell me what I have 
</I>&gt;<i> to change in the code blow in order to make abcrem remove the check in 
</I>&gt;<i> the Read method... Any hints greatly appreciated and thanks for your time!
</I>
You're out of luck :-(

&gt;<i> 	public int Read() {
</I>&gt;<i> 		return pos &lt; xml.Length ? (int) xml [pos++] : -1;
</I>&gt;<i> 	}
</I>
There are two issues:

- pos is not a local variable, and as such is not tracked by SSA
  (the problem is that its value could change at any method call,
  because also methods called on other objects could obtain a
  reference to &quot;this&quot; and alter it).
  It is true that there are no method calls here, but tracking it
  is a job for alias analysis (which is exactly what I'm doing).
  But in any case in the beginning I'll just focus on local
  variables.
  And honestly, when we'll have the linear IR representation, and
  redundancy elimination will work properly on address related
  operations as well (which now it cannot do because of the risk
  of aliasing), it is possible that this will &quot;just work&quot; :-)
  The reason I think so is that field addresses (the results of
  ldfld operations) will be local variables after all.

- Second issue: ABCREM works on arrays, not strings!
  If you look at the generated IR, you'll see strlen and getchar
  opcodes... in principle, you could modify 'abcrem.c' to handle
  them (instead of only ldlen and ldelema).
  This is much easier than the above, but since I made abcrem
  sort of &quot;type safe&quot; (see bug 71062) it is a bit harder seeing
  how to do it in a clean way (I plan to handle all sort of
  redundant checks in that file, so it is important that the
  symbolic analyzer stays clean).
  Moreover, currently there is a flag in MonoCompile that tracks
  the presence of ldelema operations, and abcrem is not even
  invoked on methods that lack them...
  Anyway this is easy, and I could do it quickly, I'm just giving
  priority to a nasty SSAPRE bug.

If you really want to work on it, read the doc file I wrote (it
is in 'docs/abc-removal.txt'), and the paper I reference there.

Then, ask for specific doubts ;-)

Ciao,
  Massi



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010212.html">[Mono-devel-list] Make distcheck failing...
</A></li>
	<LI>Next message: <A HREF="010211.html">[Mono-devel-list] Re: Abcremoval
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10205">[ date ]</a>
              <a href="thread.html#10205">[ thread ]</a>
              <a href="subject.html#10205">[ subject ]</a>
              <a href="author.html#10205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
