<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] MSVC port in progress, a couple questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20MSVC%20port%20in%20progress%2C%20a%20couple%20questions&In-Reply-To=3c06c3705021017596918acb6%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010399.html">
   <LINK REL="Next"  HREF="010403.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] MSVC port in progress, a couple questions</H1>
    <B>J Lothian</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20MSVC%20port%20in%20progress%2C%20a%20couple%20questions&In-Reply-To=3c06c3705021017596918acb6%40mail.gmail.com"
       TITLE="[Mono-devel-list] MSVC port in progress, a couple questions">rhalin at gmail.com
       </A><BR>
    <I>Thu Feb 10 22:16:52 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010399.html">[Mono-devel-list] MSVC port in progress, a couple questions
</A></li>
        <LI>Next message: <A HREF="010403.html">[Mono-devel-list] MSVC port in progress, a couple questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10400">[ date ]</a>
              <a href="thread.html#10400">[ thread ]</a>
              <a href="subject.html#10400">[ subject ]</a>
              <a href="author.html#10400">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Forget all about those errors, got it fixed!  It has something to do
with the SDK and the order that files need to be included in.  For
some reason MS decided not to include all the dependancies, and I had
to include windows.h before the include for wincrypt.h   I do have to
wonder why I didn't have to do this prior to the SDK...

I'll keep everyone posted if I have anymore problems, but hopefully
the next you hear from me while be a working compile!


On Thu, 10 Feb 2005 19:59:32 -0600, J Lothian &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">rhalin at gmail.com</A>&gt; wrote:
&gt;<i> On Thu, 10 Feb 2005 19:35:44 +0100, Paolo Molaro &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>&gt; wrote:
</I>&gt;<i> &gt; On 02/10/05 J Lothian wrote:
</I>&gt;<i> &gt; &gt; First, just wanted to let everyone know that I'm working on getting
</I>&gt;<i> &gt; &gt; Mono compiling in MSVC.  I've mainly been working in VC 6, but ran
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Great!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; into a couple conflicts with source that required the updated platform
</I>&gt;<i> &gt; &gt; SDK.  I get undefined errors without the SDK, and problems with some
</I>&gt;<i> &gt; &gt; of the SDK headers when it is included, something to due with defining
</I>&gt;<i> &gt; &gt; the platform your targetting, I believe.  I'll post errors if anyone
</I>&gt;<i> &gt; &gt; thinks they can help with it, but barring that I'll be trying it in
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Error messages may help or give a clue to people that might know the answer.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; To speed up my project creation though, I was wondering if anyone had
</I>&gt;<i> &gt; &gt; a dependancy tree for the libraries, and/or a list of the libraries
</I>&gt;<i> &gt; &gt; themselves.  I've been able to piece together most of it by reading
</I>&gt;<i> &gt; &gt; through makefiles, I just want to make sure I'm not missing anything.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You might want to read the toplevel configure.in and the win32 makefile
</I>&gt;<i> &gt; in libgc, too.
</I>&gt;<i> 
</I>&gt;<i> Gotcha, I believe I've got libgc compiling fine, no errors, but have
</I>&gt;<i> yet to test any of it.
</I>&gt;<i> 
</I>&gt;<i> &gt; With automake we use helper libraries, but there is no reason you need to
</I>&gt;<i> &gt; do the same: if you can, you should just build almost all the files into
</I>&gt;<i> &gt; a mono.dll shared lib. Anyway, the helper libs we use are:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; libgc/libmonogc.la
</I>&gt;<i> &gt; mono/utils/libmonoutils.la
</I>&gt;<i> &gt; mono/os/unix/libmonoos.la // you want the win32 version here
</I>&gt;<i> &gt; mono/os/libmonoos.la
</I>&gt;<i> &gt; mono/metadata/libmetadata.la
</I>&gt;<i> &gt; mono/metadata/libmonoruntime.la
</I>&gt;<i> &gt; mono/mini/libmono.la
</I>&gt;<i> 
</I>&gt;<i> Much much helpful, thanks!
</I>&gt;<i> 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You should just skip mint and the arch directory and the other libs that
</I>&gt;<i> &gt; aren't important for a first cut. The libs first on the list are
</I>&gt;<i> &gt; usually pre-reqs for libs further down.
</I>&gt;<i> 
</I>&gt;<i> Yeah, wishing I had skipped some of those non-essentials now, I had
</I>&gt;<i> everything in the metadata directory compiling just fine before I
</I>&gt;<i> installed the MS Platform SDK updates for a problem I had with the
</I>&gt;<i> dissassembler (which compiles with the updates), but now
</I>&gt;<i> mono/metadata/rand.c isn't very happy at all.  Here's an example of
</I>&gt;<i> what happens with the SDK directory being listed first in the include
</I>&gt;<i> path:
</I>&gt;<i> 
</I>&gt;<i> and.c
</I>&gt;<i> c:\program files\microsoft sdk\include\wincrypt.h(37) : error C2061:
</I>&gt;<i> syntax error : identifier 'HRESULT'
</I>&gt;<i> c:\program files\microsoft sdk\include\wincrypt.h(37) : error C2059:
</I>&gt;<i> syntax error : ';'
</I>&gt;<i> c:\program files\microsoft sdk\include\wincrypt.h(249) : error C2061:
</I>&gt;<i> syntax error : identifier 'HCRYPTPROV'
</I>&gt;<i> c:\program files\microsoft sdk\include\wincrypt.h(249) : error C2059:
</I>&gt;<i> syntax error : ';'
</I>&gt;<i> c:\program files\microsoft sdk\include\wincrypt.h(250) : error C2061:
</I>&gt;<i> syntax error : identifier 'HCRYPTKEY'
</I>&gt;<i> c:\program files\microsoft sdk\include\wincrypt.h(250) : error C2059:
</I>&gt;<i> syntax error : ';'
</I>&gt;<i> 
</I>&gt;<i> and so on, there's 102 of them
</I>&gt;<i> 
</I>&gt;<i> to give you an idea what it doesn't like, from wincrypt.h:
</I>&gt;<i> #ifdef __cplusplus
</I>&gt;<i> extern &quot;C&quot; {
</I>&gt;<i> #endif
</I>&gt;<i> 
</I>&gt;<i> #ifndef _HRESULT_DEFINED
</I>&gt;<i> #define _HRESULT_DEFINED
</I>&gt;<i> typedef LONG HRESULT;    //error here!
</I>&gt;<i> 
</I>&gt;<i> #endif // !_HRESULT_DEFINED
</I>&gt;<i> 
</I>&gt;<i> ----------------------------------------
</I>&gt;<i> with the sdk removed from the include path, I now get this:
</I>&gt;<i> 
</I>&gt;<i> rand.c
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(109) : error
</I>&gt;<i> C2065: 'HCRYPTPROV' : undeclared identifier
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(109) : error
</I>&gt;<i> C2146: syntax error : missing ';' before identifier 'provider'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(109) : error
</I>&gt;<i> C2065: 'provider' : undeclared identifier
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(116) : warning
</I>&gt;<i> C4013: 'CryptAcquireContext' undefined; assuming extern returning int
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(118) : error
</I>&gt;<i> C2065: 'PROV_RSA_FULL' : undeclared identifier
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(132) : warning
</I>&gt;<i> C4013: 'memcpy' undefined; assuming extern returning int
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(134) : warning
</I>&gt;<i> C4013: 'CryptGenRandom' undefined; assuming extern returning int
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(136) : warning
</I>&gt;<i> C4013: 'memset' undefined; assuming extern returning int
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(147) : error
</I>&gt;<i> C2146: syntax error : missing ';' before identifier 'provider'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(147) : error
</I>&gt;<i> C2146: syntax error : missing ';' before identifier 'handle'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(148) : error
</I>&gt;<i> C2275: 'guint32' : illegal use of this type as an expression
</I>&gt;<i>        h:\data\developement\vc\monovs\vsdependancies\include\glibconfig.h(42)
</I>&gt;<i> : see declaration of 'guint32'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(148) : error
</I>&gt;<i> C2146: syntax error : missing ';' before identifier 'len'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(148) : error
</I>&gt;<i> C2065: 'len' : undeclared identifier
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(149) : error
</I>&gt;<i> C2275: 'guchar' : illegal use of this type as an expression
</I>&gt;<i>        h:\data\developement\vc\monovs\vsdependancies\include\glib\gtypes.h(47)
</I>&gt;<i> : see declaration of 'guchar'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(149) : error
</I>&gt;<i> C2065: 'buf' : undeclared identifier
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(152) : warning
</I>&gt;<i> C4013: 'CryptReleaseContext' undefined; assuming extern returning int
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(154) : warning
</I>&gt;<i> C4047: '=' : 'int ' differs in levels of indirection from 'void *'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(166) : error
</I>&gt;<i> C2146: syntax error : missing ')' before identifier 'handle'
</I>&gt;<i> H:\Data\Developement\VC\MonoVS\mono\metadata\rand.c(166) : error
</I>&gt;<i> C2059: syntax error : ')'
</I>&gt;<i> Error executing cl.exe.
</I>&gt;<i> 
</I>&gt;<i> rand.obj - 13 error(s), 6 warning(s)
</I>&gt;<i> 
</I>&gt;<i> Keep in mind, this file compiled fine before I installed the platform
</I>&gt;<i> SDK.  I may try to figure out if I can remove it completely, but the
</I>&gt;<i> damage may already be done.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; At the end of the process there should be only one shared library,
</I>&gt;<i> &gt; mono.dll. All the others are just built only as temporary libs
</I>&gt;<i> &gt; used by the build tools like genmdesc.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; lupus
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; -----------------------------------------------------------------
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> One thing I think I should note, that while I can get it compiling
</I>&gt;<i> without error (or at least, I -had- at one point)  There were still a
</I>&gt;<i> good deal of warning messages (maybe a few hundred?), mostly
</I>&gt;<i> signed/unsigned mismatches, I'm assuming this isn't normal on the gcc
</I>&gt;<i> builds?
</I>&gt;<i> 
</I>&gt;<i> I'm trying to see how much of this build I can do without editing
</I>&gt;<i> source, so far, I've only had to change a few minor things here and
</I>&gt;<i> there, I'll make sure they work once I get this thing compiling again,
</I>&gt;<i> I'd rather avoid having to change the code as much as possible to
</I>&gt;<i> limit any trouble it may cause everyone else in the long run.
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010399.html">[Mono-devel-list] MSVC port in progress, a couple questions
</A></li>
	<LI>Next message: <A HREF="010403.html">[Mono-devel-list] MSVC port in progress, a couple questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10400">[ date ]</a>
              <a href="thread.html#10400">[ thread ]</a>
              <a href="subject.html#10400">[ subject ]</a>
              <a href="author.html#10400">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
