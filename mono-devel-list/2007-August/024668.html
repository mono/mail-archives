<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] anonymous delegates, gmcs,	and Microsoft.NET permissions checking problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20anonymous%20delegates%2C%20gmcs%2C%0A%09and%20Microsoft.NET%20permissions%20checking%20problems&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024681.html">
   <LINK REL="Next"  HREF="024679.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] anonymous delegates, gmcs,	and Microsoft.NET permissions checking problems</H1>
    <B>Avery Pennarun</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20anonymous%20delegates%2C%20gmcs%2C%0A%09and%20Microsoft.NET%20permissions%20checking%20problems&In-Reply-To="
       TITLE="[Mono-dev] anonymous delegates, gmcs,	and Microsoft.NET permissions checking problems">apenwarr at gmail.com
       </A><BR>
    <I>Thu Aug 23 17:26:19 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024681.html">[Mono-dev] Backport request
</A></li>
        <LI>Next message: <A HREF="024679.html">[Mono-dev] anonymous delegates, gmcs, and Microsoft.NET permissions checking problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24668">[ date ]</a>
              <a href="thread.html#24668">[ thread ]</a>
              <a href="subject.html#24668">[ subject ]</a>
              <a href="author.html#24668">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I'm using a copy of gmcs built on Linux from yesterday's mono svn
trunk.  The program listed below works fine when run under Linux, but
gives the following exception when run in Windows:

Unhandled Exception: System.MethodAccessException:
&lt;&gt;c__CompilerGenerated0.&lt;Main&gt;c__1()
   at MyClass.Main()

However, compiling it with Microsoft's csc.exe from .NET 2.0 results
in a binary that works in both Linux (mono) and Windows (.NET).

The command line I'm using to compile (under Cygwin) is:
   /c/WINDOWS/Microsoft.NET/Framework/v2.0.50727/csc.exe bug.cs
or in Linux:
   gmcs bug.cs

I also have gmcs (release) version 1.2.5.0 installed via
Ubuntu/dapper.  Compiling and running the binary with that version
works fine in both Linux and Windows.

Commenting out the two lines of code relating to the delegate in the
sample program also makes it work fine.  The crash occurs even if I
comment out the line calling the delegate (except I get an unused
variable warning, of course).

Thoughts?

Have fun,

Avery


using System;

public static class MyClass
{
    public delegate void Foo();

    public static void Main()
    {
	Console.WriteLine(&quot;hello&quot;);
	Foo x = delegate() {};
	x();
	Console.WriteLine(&quot;goodbye&quot;);
    }
}

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024681.html">[Mono-dev] Backport request
</A></li>
	<LI>Next message: <A HREF="024679.html">[Mono-dev] anonymous delegates, gmcs, and Microsoft.NET permissions checking problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24668">[ date ]</a>
              <a href="thread.html#24668">[ thread ]</a>
              <a href="subject.html#24668">[ subject ]</a>
              <a href="author.html#24668">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
