<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] SslStream implementation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SslStream%20implementation&In-Reply-To=1187869727.10123.103.camel%40poupou.home">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024661.html">
   <LINK REL="Next"  HREF="024653.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] SslStream implementation</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SslStream%20implementation&In-Reply-To=1187869727.10123.103.camel%40poupou.home"
       TITLE="[Mono-dev] SslStream implementation">atsushi at ximian.com
       </A><BR>
    <I>Thu Aug 23 08:59:04 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024661.html">[Mono-dev] SslStream implementation
</A></li>
        <LI>Next message: <A HREF="024653.html">[Mono-dev] Marshalling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24663">[ date ]</a>
              <a href="thread.html#24663">[ thread ]</a>
              <a href="subject.html#24663">[ subject ]</a>
              <a href="author.html#24663">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Sebastien,

Thanks for the lightning quick review :)

Sebastien Pouliot wrote:
&gt;<i> This is kind of strange as System.dll (v2) already depends on
</I>&gt;<i> Mono.Security.dll
</I>
Well, probably we didn't have such type comparison between
references to old X509 types in System.dll via Mono.Security.dll
and references to new X509 types in System.dll on the build
until now. This kind of use of extern alias also happened
in LocalFileSettingsProvider stuff.


&gt;&gt;<i> +	[MonoLimitation (&quot;Non-X509Certificate2 certificate is not supported&quot;)]
</I>&gt;<i> 
</I>&gt;<i> The original X509Certificate is busted, design-wise, wrt to the private
</I>&gt;<i> key.
</I>
Hmm, I may be kind of confused - continued below.

&gt;<i> Since it's an override over Stream.ReadTimeout can't the original (base)
</I>&gt;<i> do the job ?
</I>&gt;<i> 
</I>&gt;&gt;<i> +		public override int ReadTimeout {
</I>&gt;&gt;<i> +			get { return read_timeout; }
</I>&gt;&gt;<i> +			set { read_timeout = value; }
</I>
Oops, yes.

&gt;&gt;<i> +			// Due to the Mono.Security internal, it cannot reuse
</I>&gt;&gt;<i> +			// the delegated argument, as Mono.Security creates 
</I>&gt;&gt;<i> +			// another instance of X509Certificate which lacks 
</I>&gt;&gt;<i> +			// private key but is filled the private key via this
</I>&gt;&gt;<i> +			// delegate.
</I>&gt;<i> this could be changed, in the 2.0 profile, as the Mono.Security version
</I>&gt;<i> of X509Certificate is private-key aware.
</I>
So ... do you mean, changes could be introduced in 2.0 version of 
Mono.Security? Currently the argument X509Certificate is (not the
original X509Certificate2 but) automatically populated in the
Handshake process in Mono.Security side (but probably it is by
design as you wrote above?).

&gt;<i> The X509Chain inside System.dll is more RFC3280 compliant than the
</I>&gt;<i> (older) one provided in Mono.Security.dll and should be used.
</I>&gt;<i> 
</I>&gt;&gt;<i> +				s.ServerCertValidationDelegate = delegate (X509Certificate cert, int [] certErrors) {
</I>&gt;&gt;<i> +					// FIXME: X509Chain is not provided
</I>&gt;&gt;<i> +					// FIXME: SslPolicyErrors is incomplete
</I>&gt;&gt;<i> +					SslPolicyErrors errors = certErrors.Length &gt; 0 ? SslPolicyErrors.RemoteCertificateChainErrors : SslPolicyErrors.None;
</I>&gt;&gt;<i> +					return validation_callback (this, cert, null, errors);
</I>&gt;&gt;<i> +				};
</I>
Ah, okay. Actually I was misunderstanding that the verification is
already done inside Mono.Security and the results are in the &quot;errors&quot;
array, but it turned out to be &quot;Mono.Security.X509&quot; X509Chain ;-)

So, probably it will be duplicate verification? If there is a way
to skip it, I'd change the code.

Atsushi Eno

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024661.html">[Mono-dev] SslStream implementation
</A></li>
	<LI>Next message: <A HREF="024653.html">[Mono-dev] Marshalling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24663">[ date ]</a>
              <a href="thread.html#24663">[ thread ]</a>
              <a href="subject.html#24663">[ subject ]</a>
              <a href="author.html#24663">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
