<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Atomic semantics with Interlocked
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20Atomic%20semantics%20with%20Interlocked&In-Reply-To=%3CDAF76E23-EFE0-4F55-B7B9-5A18AF18AB45%40microsoft.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043785.html">
   <LINK REL="Next"  HREF="043787.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Atomic semantics with Interlocked</H1>
    <B>Vlad Brezae</B> 
    <A HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20Atomic%20semantics%20with%20Interlocked&In-Reply-To=%3CDAF76E23-EFE0-4F55-B7B9-5A18AF18AB45%40microsoft.com%3E"
       TITLE="[Mono-dev] Atomic semantics with Interlocked">vlbrez at microsoft.com
       </A><BR>
    <I>Thu Aug 18 10:03:00 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043785.html">[Mono-dev] TLS 1.2 Status Update
</A></li>
        <LI>Next message (by thread): <A HREF="043787.html">[Mono-dev] Atomic semantics with Interlocked
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43786">[ date ]</a>
              <a href="thread.html#43786">[ thread ]</a>
              <a href="subject.html#43786">[ subject ]</a>
              <a href="author.html#43786">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

        Lately I’ve been investigating a thread pool related hang on arm64 which I tracked it down to some missing memory barriers. It seems that, although the documentation doesn’t seem to imply memory fences for Interlocked functions, the thread pool MS code assumes it does.

        How should we proceed with the fix ? Get MS to follow their documentation in reference source and explicitly use a memory barrier where needed ? Add memory barriers explicitly on our own bcl ? Get the Interlocked icalls to do an additional memory barrier so we leave managed code intact ?

Vlad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/mono-devel-list/attachments/20160818/1d475b1e/attachment.html">http://lists.dot.net/pipermail/mono-devel-list/attachments/20160818/1d475b1e/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043785.html">[Mono-dev] TLS 1.2 Status Update
</A></li>
	<LI>Next message (by thread): <A HREF="043787.html">[Mono-dev] Atomic semantics with Interlocked
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43786">[ date ]</a>
              <a href="thread.html#43786">[ thread ]</a>
              <a href="subject.html#43786">[ subject ]</a>
              <a href="author.html#43786">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
