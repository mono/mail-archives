<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] HttpWorkerRequest
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20HttpWorkerRequest&In-Reply-To=20041215161355.79673.qmail%40web12821.mail.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009441.html">
   <LINK REL="Next"  HREF="009447.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] HttpWorkerRequest</H1>
    <B>Rafael Teixeira</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20HttpWorkerRequest&In-Reply-To=20041215161355.79673.qmail%40web12821.mail.yahoo.com"
       TITLE="[Mono-devel-list] HttpWorkerRequest">monoman at gmail.com
       </A><BR>
    <I>Wed Dec 15 14:37:42 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009441.html">[Mono-devel-list] HttpWorkerRequest
</A></li>
        <LI>Next message: <A HREF="009447.html">[Mono-devel-list] HttpWorkerRequest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9446">[ date ]</a>
              <a href="thread.html#9446">[ thread ]</a>
              <a href="subject.html#9446">[ subject ]</a>
              <a href="author.html#9446">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Well this is some internal class from the .NET implementation as it
isn't documented in MSDN.

In Mono we have some subclass of  MonoWorkerRequest (either
XSPWorkerRequest or ModMonoWorkerRequest). These classes are the ones
that return null for GetPreLoadedEntityBody().

Could you please fill a bugzilla, giving some more details of what is
expected to come in the byte array, and pointing to implement in those
classes (or the superclass), please. I would do it for you, by I run
out of time just now.

Thanks for helping us make Mono better.

Fun,

On Wed, 15 Dec 2004 08:13:54 -0800 (PST), Joe Audette
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">joe_audette at yahoo.com</A>&gt; wrote:
&gt;<i> Hi Rafael, 
</I>&gt;<i>   
</I>&gt;<i> When I do GetType().ToString()  I get
</I>&gt;<i> System.Web.Hosting.ISAPIWorkerRequestOutOfProc 
</I>&gt;<i>   
</I>&gt;<i> Does that help? 
</I>&gt;<i>   
</I>&gt;<i> Thanks, 
</I>&gt;<i>   
</I>&gt;<i> Joe
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Rafael Teixeira &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">monoman at gmail.com</A>&gt; wrote: 
</I>&gt;<i> Hi Joe, just a small thing, you may be pointing to the wrong class, see:
</I>&gt;<i> 
</I>&gt;<i> &gt; return (HttpWorkerRequest)provider.GetService(typeof(HttpWorkerRequest)); 
</I>&gt;<i> 
</I>&gt;<i> IServiceProvider.GetService() will return some instance of
</I>&gt;<i> HttpWorkerRequest or a subclass of it, what is probably the case. See,
</I>&gt;<i> it returns the first matching instance registered in the container
</I>&gt;<i> (HttpContext.Current in this case) that subclasses or implements (in
</I>&gt;<i> the more common case where you pass it the type of an interface
</I>&gt;<i> definition) the passed type.
</I>&gt;<i> 
</I>&gt;<i> Print the full type name of the returned instance in your code, to
</I>&gt;<i> tell us which subclass should we be returning. That subclass is the
</I>&gt;<i> one that has to override GetPreloadedEntityBody() to return something
</I>&gt;<i> more useful.
</I>&gt;<i> 
</I>&gt;<i> Hope it helps,
</I>&gt;<i> 
</I>&gt;<i> On Wed, 15 Dec 2004 06:28:03 -0800 (PST), Joe Audette
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; Gonzalo, 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; That may be true when you inherit from HttpWorkerRequest but when you call
</I>&gt;<i> &gt; it directly on windows GetPreloadedEntityBody returns a byte array not
</I>&gt;<i> null.
</I>&gt;<i> &gt; I step through the code to verify this and the code never raises an error
</I>&gt;<i> on
</I>&gt;<i> &gt; windows because it never returns null. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; This is the code that gets a reference to HttpWorkerRequest before it is
</I>&gt;<i> &gt; passed into the RequestStream class: 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; HttpWorkerRequest GetWorkerRequest(HttpContext context) 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; { 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; IServiceProvider provider = (IServiceProvider)HttpContext.Current; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; return (HttpWorkerRequest)provider.GetService(typeof(HttpWorkerRequest)); 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; } 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So in my observation mono does not produce the same behavior as windows
</I>&gt;<i> &gt; .net, therefore this code works on windows but not mono. On Windows if you
</I>&gt;<i> &gt; call directly HttpWorkerRequest.GetPreLoadedEntityBody it does not return
</I>&gt;<i> &gt; null. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I urge you to download the code and its sample project and see how it
</I>&gt;<i> works
</I>&gt;<i> &gt; under windows but not on mono. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; <A HREF="http://krystalware.com/files/SlickUpload.zip">http://krystalware.com/files/SlickUpload.zip</A> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; <A HREF="http://krystalware.com/files/AdvancedUploadSpike.zip">http://krystalware.com/files/AdvancedUploadSpike.zip</A> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Best Regards, 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Joe Audette 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Gonzalo Paniagua Javier wrote: 
</I>&gt;<i> &gt; [...]
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt;tempBuff will always be null until GetPreloadedEntityBody() is
</I>&gt;<i> &gt; &gt;implemented in HttpWorkerRequest &gt;Yes I could check for null and that
</I>&gt;<i> &gt; would get rid of the error but it &gt;would not make the code functional.
</I>&gt;<i> &gt; In fact if I did check for null and &gt;found null, my inclination would be
</I>&gt;<i> &gt; to throw an exception so why not &gt;windows .NET and should work under
</I>&gt;<i> &gt; mono at some point if I understa nd &gt;the goals of mono correctly. &gt;My
</I>&gt;<i> 
</I>&gt;<i> &gt; original question is only to inquire when the methods of
</I>&gt;<i> &gt; &gt;HttpWorkerRequest will be implemented. You said the methods are
</I>&gt;<i> &gt; &gt;implemented in XSP in classes derived from HttpWorkerRequest, but my
</I>&gt;<i> &gt; &gt;code refers directly to HttpWorkerRequest not to any derived class.
</I>&gt;<i> &gt; &gt;Will the methods ever be implemented directly on HttpWorkerRequest in
</I>&gt;<i> &gt; &gt;mono? 
</I>&gt;<i> &gt; I think you're misundertanding. That method is already implemented in
</I>&gt;<i> &gt; HttpWorkerRequest.cs. It just returns null. That's the implementation.
</I>&gt;<i> &gt; You can easilly test that is the behavior that MS NET has in that method
</I>&gt;<i> &gt; of HttpWorkerRequest class. How? Derive your own class from
</I>&gt;<i> &gt; HttpWorkerRequest and call GetPreloadedEntityBody(). You'll always get
</I>&gt;<i> &gt; null.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Moreover, you have HasEntityBody() and IsEntireEntityBodyIsPreloaded()
</I>&gt;<i> &gt; to know in advance if GetPreloadedEntityBody() can be null.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; -Gonzalo
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">joe_audette at yahoo.com</A>
</I>&gt;<i> &gt; <A HREF="http://www.joeaudette.com">http://www.joeaudette.com</A>
</I>&gt;<i> &gt; <A HREF="http://www.mojoportal.com">http://www.mojoportal.com</A> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Rafael &quot;Monoman&quot; Teixeira
</I>&gt;<i> ---------------------------------------
</I>&gt;<i> Just the 'crazy' me in a sane world, or would it be the reverse? I dunno...
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">joe_audette at yahoo.com</A>
</I>&gt;<i> <A HREF="http://www.joeaudette.com">http://www.joeaudette.com</A>
</I>&gt;<i> <A HREF="http://www.mojoportal.com">http://www.mojoportal.com</A> 
</I>

-- 
Rafael &quot;Monoman&quot; Teixeira
---------------------------------------
I'm trying to become a &quot;Rosh Gadol&quot; before my own eyes. 
See <A HREF="http://www.joelonsoftware.com/items/2004/12/06.html">http://www.joelonsoftware.com/items/2004/12/06.html</A> for enlightment.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009441.html">[Mono-devel-list] HttpWorkerRequest
</A></li>
	<LI>Next message: <A HREF="009447.html">[Mono-devel-list] HttpWorkerRequest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9446">[ date ]</a>
              <a href="thread.html#9446">[ thread ]</a>
              <a href="subject.html#9446">[ subject ]</a>
              <a href="author.html#9446">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
