<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Npgsql
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Npgsql&In-Reply-To=41CF7715.8020101%40yahoo.com.br">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009569.html">
   <LINK REL="Next"  HREF="009571.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Npgsql</H1>
    <B>Daniel Morgan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Npgsql&In-Reply-To=41CF7715.8020101%40yahoo.com.br"
       TITLE="[Mono-devel-list] Npgsql">danielmorgan at verizon.net
       </A><BR>
    <I>Sun Dec 26 21:51:01 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009569.html">[Mono-devel-list] Npgsql
</A></li>
        <LI>Next message: <A HREF="009571.html">[Mono-devel-list] Npgsql
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9570">[ date ]</a>
              <a href="thread.html#9570">[ thread ]</a>
              <a href="subject.html#9570">[ subject ]</a>
              <a href="author.html#9570">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey fxjr, 
Thanks for responding!

Here is a test case:

// mcs pgtest.cs /r:System.Data.dll /r:Npgsql.dll
using System;
using System.Data;
using Npgsql;

namespace TestNpgsqlStuff
{
	public class TestNpgsql 
	{
		NpgsqlConnection con;

		public void ReadData (string selectSql) 
		{
			NpgsqlCommand cmd = null;
			NpgsqlDataReader reader = null;
		
			cmd = con.CreateCommand();
			cmd.CommandText = selectSql;
			reader = cmd.ExecuteReader();
		
			Console.WriteLine(&quot;Results...&quot;);
			Console.WriteLine(&quot;Schema&quot;);
			DataTable table;
			table = reader.GetSchemaTable();
			for(int c = 0; c &lt; reader.FieldCount; c++) {
				Console.WriteLine(&quot;  Column &quot; +
c.ToString());
				DataRow row = table.Rows[c];
			
				string strColumnName =
row[&quot;ColumnName&quot;].ToString();
				string strColumnSize =
row[&quot;ColumnSize&quot;].ToString();
				string strNumericScale =
row[&quot;NumericScale&quot;].ToString();
				string strNumericPrecision =
row[&quot;NumericPrecision&quot;].ToString();
				string strDataType =
row[&quot;DataType&quot;].ToString();

				Console.WriteLine(&quot;    ColumnName: &quot; +
strColumnName);
				Console.WriteLine(&quot;    ColumnSize: &quot; +
strColumnSize);
				Console.WriteLine(&quot;    NumericScale: &quot; +
strNumericScale);
				Console.WriteLine(&quot;    NumericPrecision: &quot; +
strNumericPrecision);
				Console.WriteLine(&quot;    DataType: &quot; +
strDataType);
			}
		}

		public void DoTest () 
		{
			con = new
NpgsqlConnection(&quot;SERVER=localhost;DATABASE=test;USER
ID=daniel;PASSWORD=asdf1234&quot;);
			con.Open ();

			ReadData (&quot;SELECT numeric_value, char_value,
varchar_value FROM mono_postgres_test&quot;);

			con.Close ();
			con.Dispose ();
			con = null;
		}

		public static void Main (string[] args) {
			TestNpgsql test = new TestNpgsql ();
			test.DoTest ();
		}
	}
}


Here is the results:

$ mono pgtest.exe
Results...
Schema
  Column 0
    ColumnName: numeric_value
    ColumnSize: -1
    NumericScale: 0
    NumericPrecision: 0
    DataType: System.Decimal
  Column 1
    ColumnName: char_value
    ColumnSize: -1
    NumericScale: 0
    NumericPrecision: 0
    DataType: System.String
  Column 2
    ColumnName: varchar_value
    ColumnSize: -1
    NumericScale: 0
    NumericPrecision: 0
    DataType: System.String

Notice the ColumnSize is -1 for char_value and varchar_value and the scale
and precision is 0 for numeric_value.

You can see the program that created this table at
mcs/class/System.Data/Test/PostgresTest.cs

-----Original Message-----
From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-admin at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-admin at lists.ximian.com</A>] On Behalf Of Francisco
Figueiredo Jr.
Sent: Sunday, December 26, 2004 9:45 PM
To: Daniel Morgan
Cc: 'Mono Development List'
Subject: Re: [Mono-devel-list] Npgsql


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Daniel Morgan wrote:
|<i> I don't know if this has been reported or not.  Or if it has been 
</I>|<i> fixed or not.
</I>|<i>
</I>|<i> However, I am using the Npgsql provider with Mono 1.0.5 on Windows XP 
</I>|<i> Pro with SP2. I am using an alpha version of PostgreSQL 8.0 Win32.
</I>|<i>
</I>|<i> I am getting the wrong column size of character types of -1.
</I>|<i>
</I>
Hi Daniel,

Could you send a simple test case??

|<i>
</I>|<i>
</I>|<i> Also, the postmaster log shows &quot;unexpected EOF on client connection&quot;.
</I>  Here
|<i> is a test program.
</I>|<i>
</I>
Yeap, this is a side effect of connection pool. When you open the connection
and close it, it is sent back to pool. But if your application exits, I
didn't find a way of catching this event and clear the pool and so when
socket is finalized by runtime, the socket is closed unexpectedly by Npgsql
and server reports that.

But you can ignore that.

Thanks for feedback.


- --
Regards,

Francisco Figueiredo Jr.
Membro Fundador do Projeto MonoBrasil - MonoBrasil Project Founder Member
<A HREF="http://monobrasil.softwarelivre.org">http://monobrasil.softwarelivre.org</A>



- -------------
&quot;Science without religion is lame;
religion without science is blind.&quot;

~                  ~ Albert Einstein
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.6 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>

iQEVAwUBQc93Ff7iFmsNzeXfAQKGlQgAoFPXC49ZcaS8NlJQyQh1Kpdx7+iixVp0
nvAiYAOtbECX+9MfriZPOb06PL4+qYZt98aGAG/YOvxB5gsABucLasgRxRwxymXF
GT7LHsAU6nV3oq47W1YnMx/tHmasqAqCewCaIzTXy5nRo4V01twUV5XUs4YMVlDN
WGNMNmVB2/CmbsAO+2B1LnLo+UGHx+DKIcRcgvVMEWQKz1GlPj+olki8jZN8RWZ5
3gpYgeGyNBJLqqlnKFjWh8n4vx4bnqn3NxAShZV32BduX4EbFJRJxJCmzsNeALed
XkYJePJG/x8JYX7MC25yXhO1BgxwQ8I/610qADpU5FvniR4gtdb3ew==
=d1+5
-----END PGP SIGNATURE----- _______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009569.html">[Mono-devel-list] Npgsql
</A></li>
	<LI>Next message: <A HREF="009571.html">[Mono-devel-list] Npgsql
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9570">[ date ]</a>
              <a href="thread.html#9570">[ thread ]</a>
              <a href="subject.html#9570">[ subject ]</a>
              <a href="author.html#9570">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
