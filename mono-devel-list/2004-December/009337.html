<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Interop with Xine
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Interop%20with%20Xine&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009340.html">
   <LINK REL="Next"  HREF="009339.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Interop with Xine</H1>
    <B>Simon Ask Ulsnes</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Interop%20with%20Xine&In-Reply-To="
       TITLE="[Mono-devel-list] Interop with Xine">simon at ulsnes.dk
       </A><BR>
    <I>Thu Dec  9 19:19:33 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009340.html">[Mono-devel-list] (no subject)
</A></li>
        <LI>Next message: <A HREF="009339.html">[Mono-devel-list] Interop with Xine
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9337">[ date ]</a>
              <a href="thread.html#9337">[ thread ]</a>
              <a href="subject.html#9337">[ subject ]</a>
              <a href="author.html#9337">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi!
I'm developing yet another music player app for Linux. It's a bit like 
Muine, but more minimalistic and l33t... :-)
The whole idea, and the reason I bothered making another audio player, 
is the concept of a &quot;cut-the-crap&quot; GUI without *anything* but a 
playlist, a search box and a search bar.
I'm planning on using the Xine engine (xinelib), because 1) it's a very 
easy API and 2) I don't have to do format recognition or have anything 
to do with I/O except for file names.

The binding library for xinelib is written in C++ (because I find it 
easier and more comprehensible than C - practically it makes no 
difference except I use cout instead of printf... I should probably 
rewrite it in C when I get around to it). Now, I have a small testing 
app for testing new functions I implement in the library (so that I'll 
know when the library part works properly).

The library includes an initialization function that intializes (duh...) 
the Xine engine and creates the necessary objects and streams and so on. 
It goes something like this:

engine = new XineEngine;    // a struct for holding the objects, nothing 
special - engine is static in the .cpp file of the library
engine-&gt;ao_driver = &quot;auto&quot;;  // select audio output driver automatically
engine-&gt;xine = xine_new(); // create the xine object
xine_init(engine-&gt;xine);       // internal initialization of the xine 
object - xine_init is an API function
(... do some audio port opening and stream creating ...)

The thing is: My testing app runs initialization and creation and 
destruction of all objects just fine. But when I do *exactly* the same 
thing, same order, same parameters, from C# via Interop, I get this:

--- OUTPUT START ---
Initializing Engine (xine &#181; player)...
setting ao_driver...auto
creating xine object...
setting configfile...
loading config...
init'ing xine...

Unhandled Exception: System.NullReferenceException: Object reference not 
set to an instance of an object
in (unmanaged) (wrapper managed-to-native) Oiga.Xine:Init (string)
in &lt;0x00004&gt; (wrapper managed-to-native) Oiga.Xine:Init (string)
in &lt;0x00017&gt; Oiga.Xine:.ctor (string)
in &lt;0x0005c&gt; Oiga.MainApp:.ctor ()
in &lt;0x0001b&gt; Oiga.MainApp:Main (string[])

Segmentation Fault
--- OUTPUT END ---


What's that all about? No objects are being marshalled at all, since the 
Xine engine and the XineEngine struct containing the pointers only 
exists as a static object within unmanaged space. Any suggestions?

Oh, and one thing more: I took a peek in the Muine source, and as far as 
I could tell they do it exactly the same way as I do! Tell me if you 
need the source to say anything useful, I'll have to go to bed now.

Yours,
Simon Ask Ulsnes

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009340.html">[Mono-devel-list] (no subject)
</A></li>
	<LI>Next message: <A HREF="009339.html">[Mono-devel-list] Interop with Xine
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9337">[ date ]</a>
              <a href="thread.html#9337">[ thread ]</a>
              <a href="subject.html#9337">[ subject ]</a>
              <a href="author.html#9337">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
