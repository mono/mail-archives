<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] More updates on Mono (before the call)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20More%20updates%20on%20Mono%20%28before%20the%20call%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035886.html">
   <LINK REL="Next"  HREF="035890.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] More updates on Mono (before the call)</H1>
    <B>Sergei Dyshel</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20More%20updates%20on%20Mono%20%28before%20the%20call%29&In-Reply-To="
       TITLE="[Mono-dev] More updates on Mono (before the call)">qyron.private at gmail.com
       </A><BR>
    <I>Wed Sep 15 16:59:28 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035886.html">[Mono-dev] issue invoking member of ExpandoObject with C# REPL
</A></li>
        <LI>Next message: <A HREF="035890.html">[Mono-dev] More updates on Mono (before the call)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35887">[ date ]</a>
              <a href="thread.html#35887">[ thread ]</a>
              <a href="subject.html#35887">[ subject ]</a>
              <a href="author.html#35887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I've almost finished tuning Mono's Altivec performance. The results are , as
usual, in this table:
<A HREF="https://spreadsheets.google.com/ccc?key=0AhjvSAvEoHopdG1LUE9Zdkd1TTZIQ0FCWl82bU5Fa1E&amp;hl=en&amp;authkey=COqyrPMD">https://spreadsheets.google.com/ccc?key=0AhjvSAvEoHopdG1LUE9Zdkd1TTZIQ0FCWl82bU5Fa1E&amp;hl=en&amp;authkey=COqyrPMD</A>

&lt;<A HREF="https://spreadsheets.google.com/ccc?key=0AhjvSAvEoHopdG1LUE9Zdkd1TTZIQ0FCWl82bU5Fa1E&amp;hl=en&amp;authkey=COqyrPMD">https://spreadsheets.google.com/ccc?key=0AhjvSAvEoHopdG1LUE9Zdkd1TTZIQ0FCWl82bU5Fa1E&amp;hl=en&amp;authkey=COqyrPMD</A>&gt;There
are much more &quot;blue&quot; ratios now but there are still some optimization issues
I couldn't solve:

1) 'mmm_intrchage' uses a different expression for alignment checking
(versioning) and this expression is somehow isn't constand-folded during
JITing. This results in twice bigger code and register allocator just can't
act effectively there. By enabling full optimizations in Mono I could
partially solve this problem but is not the best solution (since this
increases compilation time).

2) 'video_dissolve_fp', 'saxpy_fp', 'dscal_fp' are all variations of simple
'a[i]=b*c[i]+d[i]' floating-point loop. The aligned version, generated by
vectorizer, looks (in Gimple) like: &quot;*(&amp;a+i) = b* (*(&amp;c+i)) + *(&amp;d+i)&quot; and
this is converted further to CIL. Since Mono has no inter-bb constant
propagation and all array's addresses are know at JIT time, all 3 addresses
are generated by Mono in each iteration (and it takes 3 PPC instruction for
each address). I think this is the reason for bad results but the ratios
these benchmarks behave rather differently. Anyway, it would be much better
if arrays' addresses were saved to locals in loop prolog and then used in
each iteration.

'video_dissolve_s8' and 'small_sad' still need to be implemented/analyzed.
Tommorow I'll update the numbers for SSE. I anticipate  an improvement after
recent tweaks I've added to Mono but it won't so good as with Altivec,
mostly because x87 instruction set is more stack-based so floating-point
code doesn't get optimized as simply as on PowerPC. Anyway, let's
wait until tomorrow's results...

That's all, folks! (c)
-- 
Regards,
Sergei Dyshel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20100915/02a32b19/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20100915/02a32b19/attachment.html</A> 
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035886.html">[Mono-dev] issue invoking member of ExpandoObject with C# REPL
</A></li>
	<LI>Next message: <A HREF="035890.html">[Mono-dev] More updates on Mono (before the call)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35887">[ date ]</a>
              <a href="thread.html#35887">[ thread ]</a>
              <a href="subject.html#35887">[ subject ]</a>
              <a href="author.html#35887">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
