<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Wapi handle leaks problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Wapi%20handle%20leaks%20problems&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027038.html">
   <LINK REL="Next"  HREF="026998.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Wapi handle leaks problems</H1>
    <B>Hubert FONGARNAND</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Wapi%20handle%20leaks%20problems&In-Reply-To="
       TITLE="[Mono-dev] Wapi handle leaks problems">informatique.internet at fiducial.fr
       </A><BR>
    <I>Wed Feb 20 03:51:33 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027038.html">[Mono-dev] getting error while installing mono.framework 1.2.6
</A></li>
        <LI>Next message: <A HREF="026998.html">[Mono-dev] Wapi handle leaks problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26981">[ date ]</a>
              <a href="thread.html#26981">[ thread ]</a>
              <a href="subject.html#26981">[ subject ]</a>
              <a href="author.html#26981">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

   Threads WAPI handle leaks has always caused problems with ASP.NET and
MONO. In the past, there has been many bugs related to this problem...
Now, we use mono to power our intranet (more than 4000 users...).

I'm monitoring the number of wapi handles using mono --wapi=hps | wc -l

During the day, the number of WAPI handles keeps stable. It seems that
the GC collect them correctly... 
but during the night when our intranet is inactive the number of WAPI
handles grows... 
and sometimes reach the limit of 4096... And crashes the
mod-mono-server's...

Two question :
-&gt; why the number of WAPI handles grows... when there's no activity on
the site (if the ASP.NET application has been very busy during the
day... it will grows faster during the night) ?

-&gt; don't you thing that a 4096 limit for WAPI handles is too small for
big production servers? (on windows the number of handles is often
&gt;<i>6000)?
</I>
Thanks for helping me fixing this issue

Hubert FONGARNAND

I've a workaround: I use my monitoring system to send a request (that do
a GC.Collect()) on each ASP.NET apps every 5 minutes

Some graphs (without the 5 minutes ping)






-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080220/8c516a5a/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080220/8c516a5a/attachment-0001.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: chart.php.png
Type: image/png
Size: 17368 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080220/8c516a5a/attachment-0001.png">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080220/8c516a5a/attachment-0001.png</A> 
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027038.html">[Mono-dev] getting error while installing mono.framework 1.2.6
</A></li>
	<LI>Next message: <A HREF="026998.html">[Mono-dev] Wapi handle leaks problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26981">[ date ]</a>
              <a href="thread.html#26981">[ thread ]</a>
              <a href="subject.html#26981">[ subject ]</a>
              <a href="author.html#26981">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
