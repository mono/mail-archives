<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] gdal/mono/linux; Native bindings, PInvoke, and tracking TypeLoader exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20gdal/mono/linux%3B%0A%20Native%20bindings%2C%20PInvoke%2C%20and%20tracking%20TypeLoader%20exceptions&In-Reply-To=17622978.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029716.html">
   <LINK REL="Next"  HREF="029637.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] gdal/mono/linux; Native bindings, PInvoke, and tracking TypeLoader exceptions</H1>
    <B>Floris Briolas</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20gdal/mono/linux%3B%0A%20Native%20bindings%2C%20PInvoke%2C%20and%20tracking%20TypeLoader%20exceptions&In-Reply-To=17622978.post%40talk.nabble.com"
       TITLE="[Mono-dev] gdal/mono/linux; Native bindings, PInvoke, and tracking TypeLoader exceptions">mono_nabble at briolas.nl
       </A><BR>
    <I>Tue Nov  4 04:28:22 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="029716.html">[Mono-dev] Mono 2.0 on Solaris//SPARC
</A></li>
        <LI>Next message: <A HREF="029637.html">[Mono-dev]  Dot Net apps to Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29636">[ date ]</a>
              <a href="thread.html#29636">[ thread ]</a>
              <a href="subject.html#29636">[ subject ]</a>
              <a href="author.html#29636">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

fevans wrote:
&gt;<i> 
</I>&gt;<i> *trim*
</I>&gt;<i> So when I run the command 'mono GDALInfo.exe' it returns a usage
</I>&gt;<i> statement. no errors. But when I run 'mono GDALinfo.exe foo.tif', I get a
</I>&gt;<i> type-loader exception.
</I>&gt;<i> *trim*
</I>&gt;<i> 
</I>
This is a yes, me too response, but I've done some analysis on my own. 

First I was stuck on the DllNotFoundException. My next step was to call
GDALAllRegister on gdal_fw (Gdal_wrap uses this one).
(*All code was not cut and pasted*)

[DllImport(&quot;gdal_fw&quot;)]
public static extern void GDALAllRegister();

And created a small console app that runs this. When run from command line
it runs just fine, but when run with mono it gave a DllNotFoundException
(startled). The DLL could be found just fine, the environment path was the
same, it pointed to the bin of gdal (I've used fwtools 2.2.8) ,.. so what
could have gone wrong?

I've PInvoked LoadLibrary from Kernel32

[DllImport(&quot;Kernel32&quot;), SetLastError = true)]
Public extern static int LoadLibrary(string name);

When you run :
Console.WriteLine(LoadLibrary(&quot;gdal_fw&quot;));
With normal .net it runs fine, a handle is returned. under mono it fails
with error code (getlasterror) 182 meaning invalid ordinal? 
I've checked the dll dependencies of gdal_fw,.. and long story short, it
seems the ssleay32.dll fails to load (182) when mono is run. The
dependencies of ssleay32 load just fine. btw folks these are all unmanaged
dll's.. 

Now it's time for me to give up. Hoping someone finds a solution, or an
explanation why this would occur with mono running.

regards

Floris Briolas

(used mono 2.0.1 on win xp)
-- 
View this message in context: <A HREF="http://www.nabble.com/gdal-mono-linux--Native-bindings%2C-PInvoke%2C-and-tracking-TypeLoader-exceptions-tp17622978p20318829.html">http://www.nabble.com/gdal-mono-linux--Native-bindings%2C-PInvoke%2C-and-tracking-TypeLoader-exceptions-tp17622978p20318829.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.

</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029716.html">[Mono-dev] Mono 2.0 on Solaris//SPARC
</A></li>
	<LI>Next message: <A HREF="029637.html">[Mono-dev]  Dot Net apps to Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29636">[ date ]</a>
              <a href="thread.html#29636">[ thread ]</a>
              <a href="subject.html#29636">[ subject ]</a>
              <a href="author.html#29636">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
