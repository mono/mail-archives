<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] appdomain-unload crashes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20appdomain-unload%20crashes&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029707.html">
   <LINK REL="Next"  HREF="029708.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] appdomain-unload crashes</H1>
    <B>Rodrigo Kumpera</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20appdomain-unload%20crashes&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] appdomain-unload crashes">kumpera at gmail.com
       </A><BR>
    <I>Fri Nov  7 10:32:22 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="029707.html">[Mono-dev]  Embedding mono in apache2 module
</A></li>
        <LI>Next message: <A HREF="029708.html">[Mono-dev] [PATCH] appdomain-unload crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29700">[ date ]</a>
              <a href="thread.html#29700">[ thread ]</a>
              <a href="subject.html#29700">[ subject ]</a>
              <a href="author.html#29700">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey guys,

The attached patch fixes the appdomain unloading problem. I can no longer
get the
test to crash here.


The patch tries to solve two issues:

1) Remove all pending jobs from the TP queue that belongs to the app domain
been shutdown.

2) Coordinate the shutdown of the app domain with TP threads. This must be
done because there
is a time window between the time the thread is spawn and
mono_thread_push_appdomain_ref.

The patch must be extended to handle async io threads as well, but it's
pretty much the
same fix, so if this one is ok, the other one should be as well.

Please review
Rodrigo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081107/90eea973/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081107/90eea973/attachment-0001.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: take1.diff
Type: text/x-patch
Size: 5574 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081107/90eea973/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081107/90eea973/attachment-0001.bin</A> 
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029707.html">[Mono-dev]  Embedding mono in apache2 module
</A></li>
	<LI>Next message: <A HREF="029708.html">[Mono-dev] [PATCH] appdomain-unload crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29700">[ date ]</a>
              <a href="thread.html#29700">[ thread ]</a>
              <a href="subject.html#29700">[ subject ]</a>
              <a href="author.html#29700">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
