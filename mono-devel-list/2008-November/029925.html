<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev]  COM Interop cleanup needed in mini_cleanup.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%20COM%20Interop%20cleanup%20needed%20in%20mini_cleanup.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029917.html">
   <LINK REL="Next"  HREF="029928.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev]  COM Interop cleanup needed in mini_cleanup.</H1>
    <B>Bill Holmes</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%20COM%20Interop%20cleanup%20needed%20in%20mini_cleanup.&In-Reply-To="
       TITLE="[Mono-dev]  COM Interop cleanup needed in mini_cleanup.">billholmes54 at gmail.com
       </A><BR>
    <I>Thu Nov 20 16:07:43 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="029917.html">[Mono-dev] Bug in configure script of gtksourceview-sharp
</A></li>
        <LI>Next message: <A HREF="029928.html">[Mono-dev] COM Interop cleanup needed in mini_cleanup.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29925">[ date ]</a>
              <a href="thread.html#29925">[ thread ]</a>
              <a href="subject.html#29925">[ subject ]</a>
              <a href="author.html#29925">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

We are seeing a problem with applications that host the mono and use
COM.  The attached patch includes code that will cause the runtime to
release all COM objects that are registered in the rcw hash map in
marshal.c.

-bill

2008-11-20  Bill Holmes  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">billholmes54 at gmail.com</A>&gt;

        * mini.c (mini_cleanup) : Adding a call to cominterop_release_all_rcws
          to release all runtime callable wrappers held by the runtime.

        * marshal.c : Adding cominterop_release_all_rcws to release all
          runtime callable wrappers held by the runtime.

        * marshal.h : Adding deceleration  for cominterop_release_all_rcws.

        Contributed under MIT/X11 license.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cominterop_release_all_rcws.diff
Type: application/octet-stream
Size: 4370 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081120/b3aac62b/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081120/b3aac62b/attachment.obj</A> 
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029917.html">[Mono-dev] Bug in configure script of gtksourceview-sharp
</A></li>
	<LI>Next message: <A HREF="029928.html">[Mono-dev] COM Interop cleanup needed in mini_cleanup.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29925">[ date ]</a>
              <a href="thread.html#29925">[ thread ]</a>
              <a href="subject.html#29925">[ subject ]</a>
              <a href="author.html#29925">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
