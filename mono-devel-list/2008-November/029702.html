<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Contributing Code for ObservableCollection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Contributing%20Code%20for%20ObservableCollection&In-Reply-To=1225842010.9186.77.camel%40lina.magi.jprl.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029633.html">
   <LINK REL="Next"  HREF="029678.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Contributing Code for ObservableCollection</H1>
    <B>Brian O'Keefe</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Contributing%20Code%20for%20ObservableCollection&In-Reply-To=1225842010.9186.77.camel%40lina.magi.jprl.com"
       TITLE="[Mono-dev] Contributing Code for ObservableCollection">zer0keefie at gmail.com
       </A><BR>
    <I>Tue Nov  4 23:39:29 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="029633.html">[Mono-dev] Contributing Code for ObservableCollection
</A></li>
        <LI>Next message: <A HREF="029678.html">[Mono-dev] Contributing Code for ObservableCollection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29702">[ date ]</a>
              <a href="thread.html#29702">[ thread ]</a>
              <a href="subject.html#29702">[ subject ]</a>
              <a href="author.html#29702">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've made the suggested changes:

1) Pulled the XML comments out to a separate file (but not in monodoc yet).

2) I moved the shared methods out to a static class.  At the same time, I
discovered that I forgot to add my test classes to
WindowsBase_test.dll.sources, so I did that too.

3) I added a test the calls BlockReentrancy twice.  The test passes on MS
.Net and Mono, so I assume the implementation is valid.  It does seem like a
fairly unintelligent implementation to me.  I suppose they're protected so
that OnCollectionChanged can be replaced in subclasses without needing a
separate reentrancy block, but it's not terribly obvious why that would be
useful.  The conclusion was that calling BlockReentrancy twice will indeed
give you the same object back, and it also prevents the CollectionChanged
event from firing.

I'll attach the replacement patch.

~Brian

On Tue, Nov 4, 2008 at 6:40 PM, Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jonpryor at vt.edu</A>&gt; wrote:

&gt;<i> On Tue, 2008-11-04 at 16:39 +0000, Alan McGovern wrote:
</I>&gt;<i> &gt; 1) Xml comments are a no-go in the source files. If you want to commit
</I>&gt;<i> &gt; documentation (which is always appreciated!) you should add it to
</I>&gt;<i> &gt; monodoc and submit it as a separate patch. It should be possible to
</I>&gt;<i> &gt; import your XML comments into monodoc automatically so you don't have
</I>&gt;<i> &gt; to re-type them. Once they've been imported to monodoc, you'll have to
</I>&gt;<i> &gt; strip them from the source files.
</I>&gt;<i>
</I>&gt;<i> Which brings up an interesting question... :-)
</I>&gt;<i>
</I>&gt;<i> We now have a `make doc-update` target in the makefiles, which will
</I>&gt;<i> generate/update the monodoc documentation into a Documentation directory
</I>&gt;<i> (at least in mcs; olive doesn't have that support, but iirc WindowsBase
</I>&gt;<i> will soon be moved into mcs so this still applies).
</I>&gt;<i>
</I>&gt;<i> Now, mdoc-update (which generates/updates monodoc documentation) has XML
</I>&gt;<i> documentation import support via the -import argument.
</I>&gt;<i>
</I>&gt;<i> And gmcs has the -doc flag to generate XML documentation.
</I>&gt;<i>
</I>&gt;<i> Putting these together, and it's quite trivial to always generate an XML
</I>&gt;<i> documentation file and have `make doc-update` import this file (~3 LOC
</I>&gt;<i> to the current build system, iirc).
</I>&gt;<i>
</I>&gt;<i> There is just one &quot;minor&quot; problem with it: importing is currently an
</I>&gt;<i> overwrite operation, not an appending operation.  Consequently, if you
</I>&gt;<i> have existing documentation, then import documentation for the *same*
</I>&gt;<i> member, you lost the original documentation.
</I>&gt;<i>
</I>&gt;<i> (Normally this is the right thing to do, as if you always appended you'd
</I>&gt;<i> always get duplicated documentation each time you imported...)
</I>&gt;<i>
</I>&gt;<i> The problem in this case is mscorlib (and possibly other assemblies; I
</I>&gt;<i> only looked at mscorlib): there is XML documentation on some members
</I>&gt;<i> within the source files that would replace the existing documentation
</I>&gt;<i> (which was imported from the ECMA standard), and the imported version is
</I>&gt;<i> *far* worse than the current documentation.
</I>&gt;<i>
</I>&gt;<i> Case in point: mcs/class/corlib/System.Reflection/CallingConventions.cs,
</I>&gt;<i> which contains &lt;summary/&gt; elements (i.e. an empty element), thus
</I>&gt;<i> replacing *actual* documentation with *nothing*.  Oops.
</I>&gt;<i>
</I>&gt;<i> So much as I would *love* to enable XML documentation importing by
</I>&gt;<i> default (thus allowing people to write documentation *either* within
</I>&gt;<i> monodoc format OR with XML documentation comments), this isn't currently
</I>&gt;<i> possible because the net result would be detrimental.
</I>&gt;<i>
</I>&gt;<i> The solution, obviously, is to go through the documentation and remove
</I>&gt;<i> all instances where the existing documentation is better than the XML
</I>&gt;<i> doc comments, and either move the documentation into doc comments or
</I>&gt;<i> remove the doc comments...
</I>&gt;<i>
</I>&gt;<i> But in the absence of anyone working on this (and I'm not currently
</I>&gt;<i> working on this), it's only a long term goal...
</I>&gt;<i>
</I>&gt;<i>  - Jon
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081104/f789143c/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081104/f789143c/attachment-0001.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: WindowsBase_bokeefe.diff
Type: application/octet-stream
Size: 68343 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081104/f789143c/attachment-0001.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081104/f789143c/attachment-0001.obj</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029633.html">[Mono-dev] Contributing Code for ObservableCollection
</A></li>
	<LI>Next message: <A HREF="029678.html">[Mono-dev] Contributing Code for ObservableCollection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29702">[ date ]</a>
              <a href="thread.html#29702">[ thread ]</a>
              <a href="subject.html#29702">[ subject ]</a>
              <a href="author.html#29702">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
