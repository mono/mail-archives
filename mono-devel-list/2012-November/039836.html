<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] DLR with Mono.CSharp.Evaluator: The predefined type Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20DLR%20with%20Mono.CSharp.Evaluator%3A%20The%20predefined%20type%0A%20Microsoft.CSharp.RuntimeBinder.Binder%27%20is%20not%20defined%20or%20imported&In-Reply-To=%3CCAPk8hznGdB303fwZ1qCyVbhGy03NZXGdjgJKs12WxLgYqbh9Kw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039832.html">
   <LINK REL="Next"  HREF="039838.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] DLR with Mono.CSharp.Evaluator: The predefined type Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported</H1>
    <B>Bartosz Przygoda</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20DLR%20with%20Mono.CSharp.Evaluator%3A%20The%20predefined%20type%0A%20Microsoft.CSharp.RuntimeBinder.Binder%27%20is%20not%20defined%20or%20imported&In-Reply-To=%3CCAPk8hznGdB303fwZ1qCyVbhGy03NZXGdjgJKs12WxLgYqbh9Kw%40mail.gmail.com%3E"
       TITLE="[Mono-dev] DLR with Mono.CSharp.Evaluator: The predefined type Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported">bprzygoda at gmail.com
       </A><BR>
    <I>Thu Nov 22 12:04:27 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="039832.html">[Mono-dev] Using console with embedded mono runtime
</A></li>
        <LI>Next message: <A HREF="039838.html">[Mono-dev] DLR with Mono.CSharp.Evaluator: The predefined type Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39836">[ date ]</a>
              <a href="thread.html#39836">[ thread ]</a>
              <a href="subject.html#39836">[ subject ]</a>
              <a href="author.html#39836">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm currently implementing REPL functionality in my app that embeds mono
runtime (3.0.1), and I've encountered some issues when evaluating code that
contains dynamic invocation.

For example, consider this simple dynamic class:

public class Foo : DynamicObject {
public override bool TryGetMember(GetMemberBinder binder, out object result)
 {
result = 5;
return true;
}
}

The following Evaluator initialization:

        var settings = new CompilerSettings();
        var printer = new ConsoleReportPrinter();
        eval = new Evaluator(new CompilerContext(settings, printer));
        eval.ReferenceAssembly(typeof(REPL).Assembly);
        eval.Run(&quot;using System;&quot;);

And the evaluation

        dynamic f = new Program.Foo();
        f.Whatever;

gives following error:

error CS0518: The predefined type Microsoft.CSharp.RuntimeBinder.Binder' is
not defined or imported (1,4): error CS1969: Dynamic operation cannot be
compiled without `Microsoft.CSharp.dll' assembly reference.

So I went off and added following:

eval.ReferenceAssembly(typeof(Microsoft.CSharp.RuntimeBinder.Binder).Assembly);

which now gave following warning:

warning CS1685: The predefined type `Microsoft.CSharp.RuntimeBinder.Binder'
is d
efined multiple times. Using definition from `Microsoft.CSharp.dll'

What I ended up using was to just use one of the types from
Microsoft.CSharp assembly in my code, before even calling Evaluator (to
force the runtime to load the types into the assembly), something like:

var r =
Microsoft.CSharp.RuntimeBinder.Binder.IsEvent(Microsoft.CSharp.RuntimeBinder.CSharpBinderFlags.BinaryOperationLogical,
&quot;gf&quot;, typeof(int)); // just do whatever involving those types

Am I missing some initialization option for Evaluator, or should I
reference Microsoft.CSharp assembly like in the above code and just ignore
the warning?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20121122/c1417141/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20121122/c1417141/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039832.html">[Mono-dev] Using console with embedded mono runtime
</A></li>
	<LI>Next message: <A HREF="039838.html">[Mono-dev] DLR with Mono.CSharp.Evaluator: The predefined type Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39836">[ date ]</a>
              <a href="thread.html#39836">[ thread ]</a>
              <a href="subject.html#39836">[ subject ]</a>
              <a href="author.html#39836">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
