<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] [Patch] System.Collections.Generic List	improvements
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPatch%5D%20System.Collections.Generic%20List%0A%09improvements&In-Reply-To=1119295645.29856.10.camel%40omega.maurer">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012668.html">
   <LINK REL="Next"  HREF="012663.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] [Patch] System.Collections.Generic List	improvements</H1>
    <B>David Waite</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPatch%5D%20System.Collections.Generic%20List%0A%09improvements&In-Reply-To=1119295645.29856.10.camel%40omega.maurer"
       TITLE="[Mono-devel-list] [Patch] System.Collections.Generic List	improvements">dwaite at gmail.com
       </A><BR>
    <I>Mon Jun 20 16:20:31 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012668.html">[Mono-devel-list] [Patch] System.Collections.Generic List	improvements
</A></li>
        <LI>Next message: <A HREF="012663.html">[Mono-devel-list] Contributing Mainsoft System.Web test suite
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12669">[ date ]</a>
              <a href="thread.html#12669">[ thread ]</a>
              <a href="subject.html#12669">[ subject ]</a>
              <a href="author.html#12669">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/20/05, Ben Maurer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bmaurer at ximian.com</A>&gt; wrote:
&gt;<i> On Mon, 2005-06-20 at 01:20 -0600, David Waite wrote:
</I>&gt;<i> &gt; +               static T[] EmptyArray = new T[0];
</I>&gt;<i> 
</I>&gt;<i> Can be `readonly'. Space between T and [].
</I>will-do

&gt;<i> &gt; +                       if (c != null)
</I>&gt;<i> &gt; +                       {
</I>&gt;<i> 
</I>&gt;<i> Coding style ;-). Also, since you have an else branch, make it if (c ==
</I>&gt;<i> null), its a bit easier to understand.
</I>
Already reviewed and fixed coding style errors (across _everything_ I
have changed, so this shouldn't be an issue going forward)


&gt;<i> &gt;                         if (size == data.Length)
</I>&gt;<i> &gt; -                               Capacity = Math.Max (Capacity * 2, DefaultCapacity);
</I>&gt;<i> &gt; -
</I>&gt;<i> &gt; +                               Capacity = GrowSize();
</I>&gt;<i> 
</I>&gt;<i> I'd make GrowSize set Capacity. Since this path is less likely, it'd be
</I>&gt;<i> nice for it to be shorter.
</I>
I'll review whether I need GrowSize anymore. Before there was a desire
to have the growth algorithm separate so that I could pre-compute the
final size of the array when adding a range of items, but Hari's input
on this led me to think that just matching the final size is fine if
it is more than double current capacity. GrowIfNeeded will just take a
count argument, return nothing, and be the only internal Grow*
function.

&gt;<i> &gt; +                       if (idx + count &gt; size)
</I>&gt;<i> &gt; +                               throw new ArgumentException(&quot;index and count exceed length of list&quot;);
</I>&gt;<i> 
</I>&gt;<i> Integer overflow ;-). Read sp's blog.
</I>
Will cast to uint :)

&gt;<i> Space between &lt;T&gt; and (
</I>
I wasn't aware this was part of style, will change.

&gt;<i> &gt;                         get {
</I>&gt;<i> &gt; -                               if ((uint) index &gt;= (uint) size)
</I>&gt;<i> &gt; -                                       throw new IndexOutOfRangeException ();
</I>&gt;<i> &gt; +                               CheckIndex(index);
</I>&gt;<i> &gt;                                 return data [index];
</I>&gt;<i> &gt;                         }
</I>&gt;<i> 
</I>&gt;<i> We should ensure that this is inlined by doing it manually.
</I>
Hmm, just CheckIndex or CheckRange as well?

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012668.html">[Mono-devel-list] [Patch] System.Collections.Generic List	improvements
</A></li>
	<LI>Next message: <A HREF="012663.html">[Mono-devel-list] Contributing Mainsoft System.Web test suite
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12669">[ date ]</a>
              <a href="thread.html#12669">[ thread ]</a>
              <a href="subject.html#12669">[ subject ]</a>
              <a href="author.html#12669">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
