<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Determine the name and/or kind of CLI runtime	environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Determine%20the%20name%20and/or%20kind%20of%20CLI%20runtime%0A%09environment&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012204.html">
   <LINK REL="Next"  HREF="012213.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Determine the name and/or kind of CLI runtime	environment</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Determine%20the%20name%20and/or%20kind%20of%20CLI%20runtime%0A%09environment&In-Reply-To="
       TITLE="[Mono-devel-list] Determine the name and/or kind of CLI runtime	environment">kornelpal at hotmail.com
       </A><BR>
    <I>Wed Jun  1 06:16:03 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012204.html">[Mono-devel-list] Web.Services TARGET_JVM specific changes
</A></li>
        <LI>Next message: <A HREF="012213.html">[Mono-devel-list] Determine the name and/or kind of CLI	runtimeenvironment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12205">[ date ]</a>
              <a href="thread.html#12205">[ thread ]</a>
              <a href="subject.html#12205">[ subject ]</a>
              <a href="author.html#12205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There seems not to be a good way to determine the name and version of the
runtime, but I think the above code is good enough.

&gt;<i> From: Ben Maurer
</I>&gt;<i> No, not today (other than my --version hack, which actually isn't all
</I>&gt;<i> that bad).
</I>
--version seems to be the only way to obtain the version of Mono runtime.
But using bash is not a good idea I think as it makes the code bash
dependent.

I tested this code on Windows and should work on Linux as well. Windows
executes the same mono.exe as Windows searches the directory of the
executable (mono.exe in this case) for the executable. I think this is not
the same on Linux. How could it be ensured to execute the same mono?

Korn&#233;l

string runtimeName = typeof(object).GetType().FullName;
Version runtimeVersion = Environment.Version;

switch (runtimeName)
{
 case &quot;System.RuntimeType&quot;:
  runtimeName = &quot;Microsoft .NET Framework&quot;;
  break;
 case &quot;System.MonoType&quot;:
 {
  runtimeName = &quot;Mono&quot;;
  try
  {
   ProcessStartInfo startInfo = new ProcessStartInfo(&quot;mono&quot;, &quot;--version&quot;);
   startInfo.UseShellExecute = false;
   startInfo.RedirectStandardOutput = true;
   startInfo.CreateNoWindow = true;

   Process runtimeProcess = null;
   try
   {
    runtimeProcess = Process.Start(startInfo);
    if (runtimeProcess != null)
    {
     Match versionMatch =
Regex.Match(runtimeProcess.StandardOutput.ReadLine(),
@&quot;\d{1,10}\.\d{1,10}\.\d{1,10}\.\d{1,10}&quot;, RegexOptions.CultureInvariant);
     if (versionMatch.Success)
      try
      {
       runtimeVersion = new Version(versionMatch.Value);
      }
      catch (OverflowException)
      {
      }
    }
   }
   catch (Win32Exception)
   {
   }
   finally
   {
    if (runtimeProcess != null)
     runtimeProcess.Close();
   }
  }
  catch (SecurityException)
  {
  }
  break;
 }
 case &quot;System.Reflection.ClrType&quot;:
  runtimeName = &quot;DotGNU Portable.NET&quot;;
  break;
 default:
  runtimeName = &quot;&lt;&quot; + runtimeName + &quot;&gt;&quot;;
  break;
}
Console.WriteLine(&quot;Runtime: {0} {1}&quot;, runtimeName, runtimeVersion);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012204.html">[Mono-devel-list] Web.Services TARGET_JVM specific changes
</A></li>
	<LI>Next message: <A HREF="012213.html">[Mono-devel-list] Determine the name and/or kind of CLI	runtimeenvironment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12205">[ date ]</a>
              <a href="thread.html#12205">[ thread ]</a>
              <a href="subject.html#12205">[ subject ]</a>
              <a href="author.html#12205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
