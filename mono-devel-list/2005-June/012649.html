<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] HTTPS Post
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20HTTPS%20Post&In-Reply-To=42B2FA2C.6050806%40jefftickle.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012628.html">
   <LINK REL="Next"  HREF="012616.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] HTTPS Post</H1>
    <B>Martin Hinks</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20HTTPS%20Post&In-Reply-To=42B2FA2C.6050806%40jefftickle.com"
       TITLE="[Mono-devel-list] HTTPS Post">mhinks at gmail.com
       </A><BR>
    <I>Mon Jun 20 03:55:38 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012628.html">Re: [Mono-devel-list] Mono f&#252;r Windows x64
</A></li>
        <LI>Next message: <A HREF="012616.html">[Mono-devel-list] HTTPS Post
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12649">[ date ]</a>
              <a href="thread.html#12649">[ thread ]</a>
              <a href="subject.html#12649">[ subject ]</a>
              <a href="author.html#12649">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Trusting all certs should work fine, but how were you doing cert
validation before? It is possible to select only valid certs as
opposed to trusting all....

Have you looked at the TLSTest application?

Martin

On 6/17/05, Jeff Tickle &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jeff at jefftickle.com</A>&gt; wrote:
&gt;<i> And now, here I am at work without my GPG key.  Oh well.
</I>&gt;<i> 
</I>&gt;<i> I did some more bug searching now that I've learned a bit more about
</I>&gt;<i> what's going on here through IRC and such.  Turns out certificate trust
</I>&gt;<i> seems to be a problem in mono.  I'll investigate it more, but for now,
</I>&gt;<i> the workaround is to simply trust all certificates.  Works fine when I
</I>&gt;<i> do that.
</I>&gt;<i> 
</I>&gt;<i> -Jeff
</I>&gt;<i> 
</I>&gt;<i> Jeff Tickle wrote:
</I>&gt;<i> &gt; Sorry, here's the exception:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; System.Net.WebException: Not connected ---&gt; System.IO.IOException: The
</I>&gt;<i> &gt; authentication or decryption has failed.
</I>&gt;<i> &gt; in &lt;0x001e1&gt;
</I>&gt;<i> &gt; Mono.Security.Protocol.Tls.SslClientStream:NegotiateHandshake ()
</I>&gt;<i> &gt; in (wrapper remoting-invoke-with-check)
</I>&gt;<i> &gt; Mono.Security.Protocol.Tls.SslClientStream:NegotiateHandshake ()
</I>&gt;<i> &gt; in &lt;0x000bb&gt; Mono.Security.Protocol.Tls.SslClientStream:BeginWrite
</I>&gt;<i> &gt; (System.Byte[] buffer, Int32 offset, Int32 count, System.AsyncCallback
</I>&gt;<i> &gt; callback, System.Object state)
</I>&gt;<i> &gt; in &lt;0x0001b&gt; Mono.Security.Protocol.Tls.SslClientStream:Write
</I>&gt;<i> &gt; (System.Byte[] buffer, Int32 offset, Int32 count)
</I>&gt;<i> &gt; in &lt;0x00035&gt; System.Net.WebConnection:Write (System.Byte[] buffer, Int32
</I>&gt;<i> &gt; offset, Int32 size)--- End of inner exception stack trace ---
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; in &lt;0x0013b&gt; System.Net.WebConnection:Write (System.Byte[] buffer, Int32
</I>&gt;<i> &gt; offset, Int32 size)
</I>&gt;<i> &gt; in &lt;0x00116&gt; System.Net.WebConnectionStream:WriteRequest ()
</I>&gt;<i> &gt; in (wrapper remoting-invoke-with-check)
</I>&gt;<i> &gt; System.Net.WebConnectionStream:WriteRequest ()
</I>&gt;<i> &gt; in &lt;0x00147&gt; System.Net.WebConnectionStream:Close ()
</I>&gt;<i> &gt; in &lt;0x000a6&gt; Test:Main (System.String[] args)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Also, this is the 1.1.7 packaged with Ubuntu.  Last night, I installed
</I>&gt;<i> &gt; the binary package of 1.1.8 on my Debian server, and the exception is
</I>&gt;<i> &gt; much more concise, perhaps less-helpful:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; System.Net.WebException: Error writing request.
</I>&gt;<i> &gt; in &lt;0x0020d&gt; System.Net.WebConnectionStream:WriteRequest ()
</I>&gt;<i> &gt; in (wrapper remoting-invoke-with-check)
</I>&gt;<i> &gt; System.Net.WebConnectionStream:WriteRequest ()
</I>&gt;<i> &gt; in &lt;0x00147&gt; System.Net.WebConnectionStream:Close ()
</I>&gt;<i> &gt; in &lt;0x000a6&gt; Test:Main (System.String[] args)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -Jeff
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Martin Hinks wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;What is the exact exception thrown - and where does the stack trace
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;say it originated - it does indeed sound like a certmgr thing, but
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;more information would help.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;Martin
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;On 6/17/05, Jeff Tickle &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jeff at jefftickle.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;Not sure if it's a bug or just my lack of understanding of
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; security, but
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;the fact is, this code works without fail in .NET, but not in Mono:
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;using System;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;using System.IO;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;using System.Net;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;public class Test {
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;   public static void Main(string[] args)
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;   {
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;       try {
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           WebRequest request =
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;WebRequest.Create(&quot;<A HREF="https://api.safepages.com/process.pl&quot;">https://api.safepages.com/process.pl&quot;</A>);
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           request.Method = &quot;POST&quot;;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           request.ContentType = &quot;application/x-www-form-urlencoded&quot;;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           byte[] bytes =
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;System.Text.Encoding.UTF8.GetBytes(&quot;action=dialup_add&amp;mode=test&quot;);
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           request.ContentLength = bytes.Length;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           Stream s = request.GetRequestStream();
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           s.Write(bytes,0,bytes.Length);
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           s.Close();
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           Console.WriteLine(new
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;StreamReader(request.GetResponse().GetResponseStream()).ReadToEnd());
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;       } catch (WebException e) {
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;           Console.WriteLine(e);
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;       }
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;   }
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;}
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;It should return an error saying that the login was invalid.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Instead it
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;throws an exception, and the stack trace suggests it has to do with a
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;failure to agree on security.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;I did read a bit on certmgr.  I tried importing the certificate of this
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;particular site, but it wouldn't go anywhere but the AddressBook and
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;didn't seem to make a difference.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;Thanks for any help!
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;-Jeff
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>

-- 
Martin Hinks

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012628.html">Re: [Mono-devel-list] Mono f&#252;r Windows x64
</A></li>
	<LI>Next message: <A HREF="012616.html">[Mono-devel-list] HTTPS Post
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12649">[ date ]</a>
              <a href="thread.html#12649">[ thread ]</a>
              <a href="subject.html#12649">[ subject ]</a>
              <a href="author.html#12649">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
