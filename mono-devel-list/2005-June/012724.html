<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] How to handle huge string collation resources?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20How%20to%20handle%20huge%20string%20collation%20resources%3F&In-Reply-To=1119492938.19577.6.camel%40linux.site">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012722.html">
   <LINK REL="Next"  HREF="012725.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] How to handle huge string collation resources?</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20How%20to%20handle%20huge%20string%20collation%20resources%3F&In-Reply-To=1119492938.19577.6.camel%40linux.site"
       TITLE="[Mono-devel-list] How to handle huge string collation resources?">atsushi at ximian.com
       </A><BR>
    <I>Wed Jun 22 23:41:49 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012722.html">[Mono-devel-list] How to handle huge string collation resources?
</A></li>
        <LI>Next message: <A HREF="012725.html">[Mono-devel-list] How to handle huge string collation resources?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12724">[ date ]</a>
              <a href="thread.html#12724">[ thread ]</a>
              <a href="subject.html#12724">[ subject ]</a>
              <a href="author.html#12724">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

Ben Maurer wrote:
&gt;<i> On Wed, 2005-06-22 at 04:26 +0900, Atsushi Eno wrote:
</I>&gt;&gt;<i> 	3. run &quot;make&quot;. It will automatically downloads some files
</I>&gt;&gt;<i> 	   from some sites. For now without this step the build
</I>&gt;&gt;<i> 	   b0rks.
</I>&gt;<i> 
</I>&gt;<i> Of course, this will need to be changed ;-).
</I>
duh ;-)  It will be checked in when we decide how to handle it.

&gt;&gt;<i> Here is a serious problem. In step 3 it makes 1.2MB of a C#
</I>&gt;&gt;<i> source file that results in 500KB increase of mscorlib.dll.
</I>&gt;<i> 
</I>&gt;<i> If you are generating a file in C#, you are going to be managing memory
</I>&gt;<i> badly. C# has no sense of a const array. When you say:
</I>&gt;<i> 
</I>&gt;<i> static readonly int [] x = {
</I>&gt;<i> 	...
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> This array is actually allocated in the GC *at runtime*.
</I>&gt;<i> 
</I>&gt;<i> Doing it in a header file would be an option. Not really ideal because
</I>&gt;<i> it gets into our package three times (once for the statically linked
</I>&gt;<i> mono binary, another for libmono.so, another for libmono.a).
</I>&gt;<i> 
</I>&gt;<i> The best option is to have it as a resource in a dll. The runtime memory
</I>&gt;<i> maps that.
</I>
Oh, I didn't know that resources are mmapped. Yeah, then that
sounds the best way.

BTW doesn't that mean all that kind of culture resources had better
become managed resources, unless they are required at runtime?
We also have huge culture-info-table.h and char-conversions.h
in metadata.

&gt;&gt;<i> And for about 200KB of data, they are just for CJK cultures
</I>&gt;&gt;<i> so they won't be used unless we use those cultures to handle
</I>&gt;&gt;<i> culture-sensitive CJK collation. That is mostly waste of memory.
</I>&gt;<i> 
</I>&gt;<i> Not if the data doesn't get paged in ;-).
</I>
&gt;<i> The memory system essentially does that via the mmap call, however it is
</I>&gt;<i> hidden from view.
</I>
Well, they will be hidden from view, but don't they still eat
memory when mscorlib.dll is loaded? Don't they still get paged?

Atsushi Eno


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012722.html">[Mono-devel-list] How to handle huge string collation resources?
</A></li>
	<LI>Next message: <A HREF="012725.html">[Mono-devel-list] How to handle huge string collation resources?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12724">[ date ]</a>
              <a href="thread.html#12724">[ thread ]</a>
              <a href="subject.html#12724">[ subject ]</a>
              <a href="author.html#12724">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
