<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] problems with Syscall.syslog
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20problems%20with%20Syscall.syslog&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012901.html">
   <LINK REL="Next"  HREF="012933.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] problems with Syscall.syslog</H1>
    <B>Vorobiev Maksim</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20problems%20with%20Syscall.syslog&In-Reply-To="
       TITLE="[Mono-devel-list] problems with Syscall.syslog">MVorobiev at croc.ru
       </A><BR>
    <I>Tue Jun 28 08:18:10 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012901.html">[Mono-devel-list] Problem with MSSQL server and GUID parameters...
</A></li>
        <LI>Next message: <A HREF="012933.html">[Mono-devel-list] problems with Syscall.syslog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12897">[ date ]</a>
              <a href="thread.html#12897">[ thread ]</a>
              <a href="subject.html#12897">[ subject ]</a>
              <a href="author.html#12897">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good day.

But it still has a problem in map.c for function int
Mono_Posix_FromSyslogFacility (int x, int *r).
It checks for constants via &amp;-mask: search for first occurrence. The
next code:
if ((x &amp; Mono_Posix_SyslogFacility_LOG_USRE) ==
Mono_Posix_SyslogFacility_LOG_USRE)
#ifdef LOG_USRE
		*r |= LOG_USRE;
#else /* def LOG_USRE */
		{errno = EINVAL; return -1;}

will be TRUE for all constants, which ends with &quot;8&quot;
(Mono_Posix_SyslogFacility_LOG_DAEMON and so on - &quot;even ones&quot;). Here
should be another way for testing. BTW, why to look throght all possible
constants? Since these are not flags, where could be only one possible
value. So, function should return after first found. And IMHO test
should be performed like this:

if ((x &amp; Mono_Posix_SyslogFacility_ALL) ==
Mono_Posix_SyslogFacility_LOG_USRE)
#ifdef LOG_USRE
		{*r = LOG_USRE;return 0;}
#else /* def LOG_USRE */
		{errno = EINVAL; return -1;}

Where Mono_Posix_SyslogFacility_ALL = Mono_Posix_SyslogFacility_LOG_KERN
|<i> Mono_Posix_SyslogFacility_LOG_USRE | ....
</I>
Thank you for your answer.


On Mon, 2005-06-27 at 18:35 +0400, Vorobiev Maksim wrote:
&gt;<i> I've started using Syscall.syslog method and encounted several 
</I>&gt;<i> problems. It may be errors in mono, or I just missed some details.
</I>&gt;<i> Please note, that I use Suse 9.2 linux distribute.
</I>
It's nice to know someone is testing it. :-)

&gt;<i> 1. In Syscall.cs enumeration SyslogFacility declared with members:
</I>&gt;<i> 
</I>&gt;<i> LOG_UUCP = 8 &lt;&lt; 3,
</I>&gt;<i> 
</I>&gt;<i> LOG_CRON = 8 &lt;&lt; 3
</I>&gt;<i> 
</I>&gt;<i> But under Suse the same constants declared in 
</I>&gt;<i> /usr/include/sys/syslog.h as LOG_UUCP = 8 &lt;&lt; 3, LOG_CRON = 9 &lt;&lt; 3
</I>
Oops, my bad.  Fixed in svn-trunk (r46637,r46638).

&gt;<i> 2. There is no constant LOG_USRE in syslog.h under Suse, but it's 
</I>&gt;<i> LOG_USER. So, in support/map.c there is a bug (?) - no such definition
</I>
&gt;<i> found and error returned then code execution steps in this branch. The
</I>
&gt;<i> question is the same: is it mono problem, or Suse-platform specific 
</I>&gt;<i> header file?
</I>
This was fixed on June 15 in svn-trunk.

&gt;<i> 3. It seems very strange that SyslogFacility enumeration declared with
</I>
&gt;<i> [Flag] attribute. Members of this enumeration are not &quot;powers of 2&quot;, 
</I>&gt;<i> so their combination via OR-mask is something incorrect. And these 
</I>&gt;<i> constants should be used independantly, not in combination. Is it true
</I>
&gt;<i> or I missed something?
</I>
No, it's my mistake.  Fixed in svn-trunk.

Thank you for the help.

 - Jon



_______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012901.html">[Mono-devel-list] Problem with MSSQL server and GUID parameters...
</A></li>
	<LI>Next message: <A HREF="012933.html">[Mono-devel-list] problems with Syscall.syslog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12897">[ date ]</a>
              <a href="thread.html#12897">[ thread ]</a>
              <a href="subject.html#12897">[ subject ]</a>
              <a href="author.html#12897">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
