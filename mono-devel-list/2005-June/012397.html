<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Oracle ORA-24374: Fetch errors only on solaris	but not linux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Oracle%20ORA-24374%3A%20Fetch%20errors%20only%20on%20solaris%0A%09but%20not%20linux&In-Reply-To=429E439D.7030706%40verizon.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012223.html">
   <LINK REL="Next"  HREF="012469.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Oracle ORA-24374: Fetch errors only on solaris	but not linux</H1>
    <B>Doug</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Oracle%20ORA-24374%3A%20Fetch%20errors%20only%20on%20solaris%0A%09but%20not%20linux&In-Reply-To=429E439D.7030706%40verizon.net"
       TITLE="[Mono-devel-list] Oracle ORA-24374: Fetch errors only on solaris	but not linux">dougpostman at yahoo.com
       </A><BR>
    <I>Wed Jun  8 14:35:23 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012223.html">[Mono-devel-list] Oracle ORA-24374: Fetch errors only on solaris	but not linux
</A></li>
        <LI>Next message: <A HREF="012469.html">[Mono-devel-list] Oracle ORA-24374: Fetch errors only on solaris	but not linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12397">[ date ]</a>
              <a href="thread.html#12397">[ thread ]</a>
              <a href="subject.html#12397">[ subject ]</a>
              <a href="author.html#12397">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>After some tracing and testing I am getting down to
what is causing problems of mono on Solaris and using
Oracle.  In the
mcs/class/System.Data.OracleClient/System.Data.OracleClient
directory, the file OracleCommand.cs has a private
class called IsNonQuery.  This class is used to
determine if a Statement being fed into the Oracle
connection is a query or a DML statement.  The
IsNonQuery is failing and ALWAYS returns false
(because OciStatementType statementType =
statementHandle.GetStatementType(); returns the number
 65536 instead of the word Select?) This causes all
statements to be treated like a DML statement even if
it is a SELECT statement.  That causes Oracle to
return an Error because a Select is treated different
than DML.
  If you are just using Selects to return data in
mono, then a quick fix is just to always return false
in the IsNonQuery function.  HOWEVER, if a DML
statement such as Create table is used, there will be
an Oracle Error returned with this approach.  Another
quick fix approach would just be to scan the statement
for Select and if it is found, then the IsNonQuery
will return False, otherwise will return True.  
   I am as yet unsure how to fix it correctly but if I
figure it out, I will post a fix.  If anyone else can
dig deeper and find the problem and the fix first,
please let me know.  

--- Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">danielmorgan at verizon.net</A>&gt; wrote:

&gt;<i> The problem might be with byte order - little-endian
</I>&gt;<i> vs. big-endian.  It 
</I>&gt;<i> works on Windows 2000/XP and Linux/x86.
</I>&gt;<i> 
</I>&gt;<i> There is a bug for for OracleClient not working on
</I>&gt;<i> PPC (Mac OS X).  At 
</I>&gt;<i> the end of the bug, someone mentions it does not
</I>&gt;<i> work on Solaris either.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=71318">http://bugzilla.ximian.com/show_bug.cgi?id=71318</A>
</I>&gt;<i> 
</I>&gt;<i> Patches are welcomed though.
</I>&gt;<i> 
</I>&gt;<i> Also, if you take Mono's
</I>&gt;<i> System.Data.OracleClient.dll and run it on 
</I>&gt;<i> Microsoft .NET, it will fail to retrieve data. 
</I>&gt;<i> Maybe it does not 
</I>&gt;<i> marshall the data the way it should be.
</I>&gt;<i> 
</I>&gt;<i> Doug wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;We have installed and tested Mono 1.1.7 on both
</I>&gt;<i> Linux
</I>&gt;<i> &gt;and Solaris and have windows forms working on both.
</I>&gt;<i> 
</I>&gt;<i> &gt;However the exact same code fails with a 
</I>&gt;<i> &gt;   ERROR: ORA-24374: define not done before fetch
</I>&gt;<i> or
</I>&gt;<i> &gt;execute and fetch
</I>&gt;<i> &gt;   on solaris but works fine on the Linux machine. 
</I>&gt;<i> &gt;Both machines have the same Oracle version and are
</I>&gt;<i> &gt;connecting to the same database.  Has anyone else
</I>&gt;<i> seen
</I>&gt;<i> &gt;this problem or have any ideas of how to resolve
</I>&gt;<i> it?
</I>&gt;<i> &gt;  thanks
</I>&gt;<i> &gt;_______________________________________________
</I>&gt;<i> &gt;Mono-devel-list mailing list
</I>&gt;<i> &gt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>
</I><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012223.html">[Mono-devel-list] Oracle ORA-24374: Fetch errors only on solaris	but not linux
</A></li>
	<LI>Next message: <A HREF="012469.html">[Mono-devel-list] Oracle ORA-24374: Fetch errors only on solaris	but not linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12397">[ date ]</a>
              <a href="thread.html#12397">[ thread ]</a>
              <a href="subject.html#12397">[ subject ]</a>
              <a href="author.html#12397">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
