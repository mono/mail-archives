<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Static fields initialization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Static%20fields%20initialization&In-Reply-To=20041104194823.25651.qmail%40ns.lyon-host.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008683.html">
   <LINK REL="Next"  HREF="008685.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Static fields initialization</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Static%20fields%20initialization&In-Reply-To=20041104194823.25651.qmail%40ns.lyon-host.com"
       TITLE="[Mono-devel-list] Static fields initialization">bmaurer at ximian.com
       </A><BR>
    <I>Thu Nov  4 15:42:34 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008683.html">[Mono-devel-list] Static fields initialization
</A></li>
        <LI>Next message: <A HREF="008685.html">[Mono-devel-list] [patch] URL Rewrite problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8684">[ date ]</a>
              <a href="thread.html#8684">[ thread ]</a>
              <a href="subject.html#8684">[ subject ]</a>
              <a href="author.html#8684">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 2004-11-04 at 20:48 +0100, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono at evain.net</A> wrote:
&gt;<i> Using Mono runtime, the output is 2, but with MS, it is 0.
</I>&gt;<i> If I found that Mono's behaviour is much more logical, here is a quote from 
</I>&gt;<i> the ECMA CLI Standard (line 14, page 85): 
</I>&gt;<i> 
</I>&gt;<i> &quot;The &lt;fieldInit&gt; information is stored in metadata and this information can 
</I>&gt;<i> be queried from metadata.  But the CLI does not use this information to 
</I>&gt;<i> automatically initialize the corresponding fields.&quot; 
</I>&gt;<i> 
</I>&gt;<i> And here is a quote from Inside MS.NET IL Assembler : 
</I>&gt;<i> 
</I>&gt;<i> &quot;What will the value of the field be when the class is loaded? Correct 
</I>&gt;<i> answer: 0. Why? Because default values specified in the Constant table are 
</I>&gt;<i> not used by the loader to initialize the items to which they are assigned. 
</I>&gt;<i> If we want to initialize a field to its default value, we must explicitly 
</I>&gt;<i> call the respective Reflection method to retrieve the value from metadata 
</I>&gt;<i> and then store this value in the field. This doesn't sound too nice, but, on 
</I>&gt;<i> the other hand, we should not forget that these are default values rather 
</I>&gt;<i> than initial values, so formally the loader might be right.&quot; 
</I>&gt;<i> 
</I>&gt;<i> I've already told that I do prefer Mono's behaviour here, but I would like 
</I>&gt;<i> to have some guru's opinions about this. 
</I>
This was probably from when we had allocated room for literal fields in
the static data area. But we don't do this any more. We can safely
remove the behavior.

The ECMA spec is final here...

-- 
Ben Maurer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bmaurer at ximian.com</A>&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008683.html">[Mono-devel-list] Static fields initialization
</A></li>
	<LI>Next message: <A HREF="008685.html">[Mono-devel-list] [patch] URL Rewrite problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8684">[ date ]</a>
              <a href="thread.html#8684">[ thread ]</a>
              <a href="subject.html#8684">[ subject ]</a>
              <a href="author.html#8684">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
