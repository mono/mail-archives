<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] [PATCH] Move of	Interlocked.Increment/Decrement/Exchange I4 to op codes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20Move%20of%0A%09Interlocked.Increment/Decrement/Exchange%20I4%20to%20op%20codes&In-Reply-To=20041129100156.GF2153%40debian.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009103.html">
   <LINK REL="Next"  HREF="009115.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] [PATCH] Move of	Interlocked.Increment/Decrement/Exchange I4 to op codes</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20Move%20of%0A%09Interlocked.Increment/Decrement/Exchange%20I4%20to%20op%20codes&In-Reply-To=20041129100156.GF2153%40debian.org"
       TITLE="[Mono-devel-list] [PATCH] Move of	Interlocked.Increment/Decrement/Exchange I4 to op codes">bmaurer at ximian.com
       </A><BR>
    <I>Mon Nov 29 07:19:41 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009103.html">[Mono-devel-list] [PATCH] Move of Interlocked.Increment/Decrement/Exchange I4 to op codes
</A></li>
        <LI>Next message: <A HREF="009115.html">[Mono-devel-list] [PATCH] Move of Interlocked.Increment/Decrement/Exchange I4 to op codes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9109">[ date ]</a>
              <a href="thread.html#9109">[ thread ]</a>
              <a href="subject.html#9109">[ subject ]</a>
              <a href="author.html#9109">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2004-11-29 at 11:01 +0100, Paolo Molaro wrote:
&gt;<i> On 11/27/04 Miguel de Icaza wrote:
</I>&gt;<i> &gt; &gt; We need to add the number of cpus in the aot file, so if that changes
</I>&gt;<i> &gt; &gt; we won't load it.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; We discussed on IRC a possible approach: there should be a few bits that
</I>&gt;<i> &gt; describe the CPU characteristics, and it should be possible to force the
</I>&gt;<i> &gt; AOT engine to build with these different bits set.
</I>&gt;<i> 
</I>&gt;<i> Of course we should remember to change the aot format every time we change
</I>&gt;<i> the internal data structures used in the code, or we should add to the file
</I>&gt;<i> a description of all the dependencies. For example, we embed in
</I>&gt;<i> the code the offsets of many fields in some runtime structures.
</I>&gt;<i> To make the representation compact we could take the md5sum of all the 
</I>&gt;<i> needed data and store that.
</I>
I think there is an easier way to do this. We need to make sure the GUID
of all the assemblies we depend on has not changed. Why? Field offsets
could have changed, also, with inlining we might have inlined a method
that has changed.

With our current system, every time you do a build, mscorlib.dll is
built, and thus has a different GUID. This will invalidate every aot'd
assembly. So no need to look at the runtime really, as the corlib change
will invalidate it for us.

Of course, this is a bit annoying for hackers as we effectively have to
aot stuff every time we change an assembly. But such is life.

-- Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009103.html">[Mono-devel-list] [PATCH] Move of Interlocked.Increment/Decrement/Exchange I4 to op codes
</A></li>
	<LI>Next message: <A HREF="009115.html">[Mono-devel-list] [PATCH] Move of Interlocked.Increment/Decrement/Exchange I4 to op codes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9109">[ date ]</a>
              <a href="thread.html#9109">[ thread ]</a>
              <a href="subject.html#9109">[ subject ]</a>
              <a href="author.html#9109">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
