<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Mono.LinuxDiagnostics
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Mono.LinuxDiagnostics&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009152.html">
   <LINK REL="Next"  HREF="009003.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Mono.LinuxDiagnostics</H1>
    <B>anthony whalley</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Mono.LinuxDiagnostics&In-Reply-To="
       TITLE="[Mono-devel-list] Mono.LinuxDiagnostics">tont at o2.ie
       </A><BR>
    <I>Tue Nov 23 10:54:40 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009152.html">[Mono-devel-list] Mono debugger
</A></li>
        <LI>Next message: <A HREF="009003.html">[Mono-devel-list] MWF building is broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9002">[ date ]</a>
              <a href="thread.html#9002">[ thread ]</a>
              <a href="subject.html#9002">[ subject ]</a>
              <a href="author.html#9002">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Jon. 
I will bare your comments in mind when I manage 
to get some processes to apply bridge design to ;-)

I was also looking for suggestions on whether
anyone would have any issues with running /proc 
system approach as it is my understanding 
that it should be left in a disused lavatory with a sign on the door saying &quot;Beware of the Leopard&quot;

I also had a look in the bug list and 
<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=51445">http://bugzilla.ximian.com/show_bug.cgi?id=51445</A>
seems related. Dick suggested using libproc but
Miguel seemed worried that this would create 
unwanted dependancies so the /proc file read would
be a compromise between the two.

Anyway I will let you know how I get on. 

PS. Mono.Appserver now has a load balancer and the web server is running from the CVS XSP. 
Brian and I need to merge our code trees and we may have something to look at. 

Regs

Tont 
 

----- Original Message -----
From: Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jonpryor at vt.edu</A>&gt;
Date: Tuesday, November 23, 2004 1:39 pm
Subject: Re: [Mono-devel-list] Mono.LinuxDiagnostics

&gt;<i> On Tue, 2004-11-23 at 10:19 +0000, anthony whalley wrote:
</I>&gt;<i> &gt; Hello Again.
</I>&gt;<i> &gt;     The Mono.AppServer needs 
</I>&gt;<i> System.Diagnostics.PerformanceCounter and
</I>&gt;<i> &gt; it is not yet implemented. 
</I>&gt;<i> &gt; I have searched around and I think the best approach
</I>&gt;<i> &gt; for now would be to create a name space Mono.LinuxDiagnostics which
</I>&gt;<i> &gt; would read directly from 
</I>&gt;<i> &gt; /proc like top or ps does. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Is there a better way to approach PerformanceCounter
</I>&gt;<i> &gt; implementations?
</I>&gt;<i> 
</I>&gt;<i> The *correct* approach is to implement the PerformanceCounter and
</I>&gt;<i> related classes so that it will work on both Windows and Linux.
</I>&gt;<i> Gratuitous incompatibilities should be avoided if at all possible.
</I>&gt;<i> 
</I>&gt;<i> This would likely be best done by using the Bridge design pattern:
</I>&gt;<i> 
</I>&gt;<i> 	internal interface IPerformanceCounter {/* ... */}
</I>&gt;<i> 
</I>&gt;<i> 	public class PerformanceCounter {
</I>&gt;<i>        	private IPerformanceCounter impl;
</I>&gt;<i> 
</I>&gt;<i>        	public PerformanceCounter ()
</I>&gt;<i>        	{
</I>&gt;<i>                	this.impl = 
</I>&gt;<i>                          
</I>&gt;<i> PerfCounterFactory.CreatePerformanceCounter();        	}
</I>&gt;<i> 
</I>&gt;<i>        	public long Decrement () {return impl.Decrement();}
</I>&gt;<i>        	// ...
</I>&gt;<i> 	}
</I>&gt;<i> 
</I>&gt;<i> 	internal class LinuxPerformaceCounter : IPerformanceCounter 
</I>&gt;<i> 	{/* ... */}
</I>&gt;<i> 
</I>&gt;<i> 	internal class WindowsPerformaceCounter : IPerformanceCounter 
</I>&gt;<i> 	{/* ... */}
</I>&gt;<i> 
</I>&gt;<i> 	internal sealed class PerfCounterFactory {
</I>&gt;<i>        	public IPerformancCounter CreatePerformaceCounter ()
</I>&gt;<i>        	{
</I>&gt;<i>                	// return appropriate IPerformaceCounter impl.
</I>&gt;<i>        	}
</I>&gt;<i> 	}
</I>&gt;<i> 
</I>&gt;<i> This will likely involve more work, but it will allow programs to be
</I>&gt;<i> portable between Windows &amp; Linux, increasing compatibility, and 
</I>&gt;<i> reducingany special-case portability considerations (such as using
</I>&gt;<i> PerformanceCounter on Windows but Mono.LinuxDiagnostics on Unix, which
</I>&gt;<i> is a consideration I'm sure most developers would rather avoid).
</I>&gt;<i> 
</I>&gt;<i> - Jon
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009152.html">[Mono-devel-list] Mono debugger
</A></li>
	<LI>Next message: <A HREF="009003.html">[Mono-devel-list] MWF building is broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9002">[ date ]</a>
              <a href="thread.html#9002">[ thread ]</a>
              <a href="subject.html#9002">[ subject ]</a>
              <a href="author.html#9002">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
