<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Mono on AIX  [Virus checked]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Mono%20on%20AIX%20%20%5BVirus%20checked%5D&In-Reply-To=OFF98E80F7.0CC09822-ONC1256F5C.0050189C%40G100.intern">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009145.html">
   <LINK REL="Next"  HREF="009150.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Mono on AIX  [Virus checked]</H1>
    <B>kangaroo</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Mono%20on%20AIX%20%20%5BVirus%20checked%5D&In-Reply-To=OFF98E80F7.0CC09822-ONC1256F5C.0050189C%40G100.intern"
       TITLE="[Mono-devel-list] Mono on AIX  [Virus checked]">grompf at sublimeintervention.com
       </A><BR>
    <I>Tue Nov 30 11:51:06 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009145.html">[Mono-devel-list] Mono on AIX  [Virus checked]
</A></li>
        <LI>Next message: <A HREF="009150.html">[Mono-devel-list] Mono on AIX  [Virus checked]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9148">[ date ]</a>
              <a href="thread.html#9148">[ thread ]</a>
              <a href="subject.html#9148">[ subject ]</a>
              <a href="author.html#9148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Winfried,

   Question, why are you setting JIT_SUPPORTED to NO?  Is the AIX ABI 
not SysV compatbile?  mint is all but unsupported and unmaintained 
these days so I'm not that surprised you're having issues with it; the 
way to go (imo)  would be to get the jit working on AIX.

   I'll google around today for the AIX PEM/ABI, I assume a jit port 
wouldn't be difficult.

-kangaroo

On 30-Nov-04, at 11:08 AM, 
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Winfried.Harbecke at Extern.Sparkassen-Informatik.de</A> wrote:

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> as a follow up to my status report I would appreciate if Paolo could 
</I>&gt;<i> have a
</I>&gt;<i> look
</I>&gt;<i> at the basic patches that will be required to start with the real work 
</I>&gt;<i> on
</I>&gt;<i> the AIX
</I>&gt;<i> port.
</I>&gt;<i>
</I>&gt;<i> It seems to me that I have arrived at a point where the real work can 
</I>&gt;<i> take
</I>&gt;<i> off, I get
</I>&gt;<i> assertion violations in mint:
</I>&gt;<i>
</I>&gt;<i> ============================================================
</I>&gt;<i> /bin/sh ../../mkinstalldirs /opt/freeware/lib/mono/1.0
</I>&gt;<i>  ../.././install-sh -c -m 644 mscorlib.dll
</I>&gt;<i> /opt/freeware/lib/mono/1.0/mscorlib.dll
</I>&gt;<i> MONO_PATH=. ../../mono/interpreter/mint --config ../../data/config
</I>&gt;<i> ./../gacutil.exe /i ./Accessibility.dll /f /package 1.0 /gacdir
</I>&gt;<i> /opt/freeware/lib /root /opt/freeware/lib
</I>&gt;<i>
</I>&gt;<i> ** (./../gacutil.exe:20402): WARNING **: Using non-atomic functions!
</I>&gt;<i>
</I>&gt;<i> ** ERROR **: file interp.c: line 4153 (add_signal_handler): assertion
</I>&gt;<i> failed: (sigaction (signo, &amp;sa, NULL) != -1)
</I>&gt;<i> aborting...
</I>&gt;<i> /bin/sh: 20402 IOT/Abbruch-Trap(coredump)
</I>&gt;<i> ============================================================
</I>&gt;<i>
</I>&gt;<i> I have been in touch with Bernard Solomon - it looks like he is tied 
</I>&gt;<i> down
</I>&gt;<i> with
</I>&gt;<i> other work, but he got my status report. In case I get tied down with 
</I>&gt;<i> other
</I>&gt;<i> work,
</I>&gt;<i> at least I could help preparing the ground. I did start looking at 
</I>&gt;<i> Power PC
</I>&gt;<i> instruction set and AIX linkage conventions, so in case someone else 
</I>&gt;<i> wants
</I>&gt;<i> to jump in, I can provide some pointers. Since the list archives don't
</I>&gt;<i> provide a
</I>&gt;<i> global search function, it might be a good idea to put my collection 
</I>&gt;<i> of AIX
</I>&gt;<i> experiences into an easily accessible place - any ideas? At least, I 
</I>&gt;<i> need
</I>&gt;<i> to
</I>&gt;<i> document the RPMs I used, the URLs where they were obtained, and
</I>&gt;<i> the configure and compile details.
</I>&gt;<i>
</I>&gt;<i> These are patches for GCC 3.3.4 running with native as and ld against 
</I>&gt;<i> AIX
</I>&gt;<i> 5.1
</I>&gt;<i> (you have to install bos.adt.libm from AIX installation CD 1 after
</I>&gt;<i> installing the plain OS).
</I>&gt;<i> For native xlc (Visual Age), it should suffice to replace &quot;-Wl,-brtl&quot; 
</I>&gt;<i> with
</I>&gt;<i> &quot;-brtl&quot; and drop
</I>&gt;<i> &quot;-Wa,-ppc&quot;.
</I>&gt;<i>
</I>&gt;<i> The patches themselves are trivial, tackling the environmental noise 
</I>&gt;<i> was
</I>&gt;<i> the hard
</I>&gt;<i> part - I had to find out all about AIX ld that I never wanted to know.
</I>&gt;<i> :-)
</I>&gt;<i>
</I>&gt;<i> ============================================================
</I>&gt;<i> /opt/freeware/bin/diff -crN ../mono-1.1.1/configure.in ./configure.in
</I>&gt;<i> *** ../mono-1.1.1/configure.in      2004-09-21 13:28:22.000000000 -0500
</I>&gt;<i> --- ./configure.in      2004-11-29 08:51:02.000000000 -0600
</I>&gt;<i> ***************
</I>&gt;<i> *** 171,176 ****
</I>&gt;<i> --- 171,187 ----
</I>&gt;<i>             libdl=
</I>&gt;<i>             libgc_threads=pthreads
</I>&gt;<i>             ;;
</I>&gt;<i> +     *-*-aix*)
</I>&gt;<i> +           platform_win32=no
</I>&gt;<i> +           CPPFLAGS=&quot; -D_REENTRANT -D_THREAD_SAFE 
</I>&gt;<i> -D_LINUX_SOURCE_COMPAT
</I>&gt;<i> -Wa,-mppc&quot;
</I>&gt;<i> +           libmono_cflags=&quot;-D_REENTRANT -D_THREAD_SAFE&quot;
</I>&gt;<i> +           libgc_threads=pthreads
</I>&gt;<i> +           LDFLAGS=&quot; -Wl,-brtl&quot;
</I>&gt;<i> +           libmono_ldflags=&quot;-Wl,-brtl&quot;
</I>&gt;<i> +           need_link_unlink=yes
</I>&gt;<i> +           libdl=
</I>&gt;<i> +           libgc_threads=pthreads
</I>&gt;<i> +           ;;
</I>&gt;<i>       *)
</I>&gt;<i>             AC_MSG_WARN([*** Please add $host to configure.in checks!])
</I>&gt;<i>             platform_win32=no
</I>&gt;<i> ***************
</I>&gt;<i> *** 1239,1244 ****
</I>&gt;<i> --- 1250,1260 ----
</I>&gt;<i>             JIT_SUPPORTED=yes
</I>&gt;<i>             jit_wanted=true
</I>&gt;<i>             ;;
</I>&gt;<i> +     powerpc-*-aix*)
</I>&gt;<i> +           TARGET=POWERPC;
</I>&gt;<i> +           arch_target=ppc;
</I>&gt;<i> +           JIT_SUPPORTED=no
</I>&gt;<i> +           ;;
</I>&gt;<i>       arm-*-linux-* | armv4l-*-linux-*)
</I>&gt;<i>             TARGET=ARM;
</I>&gt;<i>             arch_target=arm;
</I>&gt;<i> /opt/freeware/bin/diff -crN ../mono-1.1.1/mono/arch/ppc/Makefile.in
</I>&gt;<i> ./mono/arch/ppc/Makefile.in
</I>&gt;<i> *** ../mono-1.1.1/mono/arch/ppc/Makefile.in     2004-09-21
</I>&gt;<i> 14:00:52.000000000 -0500
</I>&gt;<i> --- ./mono/arch/ppc/Makefile.in     2004-11-30 07:42:02.000000000 -0600
</I>&gt;<i> ***************
</I>&gt;<i> *** 145,151 ****
</I>&gt;<i>
</I>&gt;<i>   test_SOURCES = test.c
</I>&gt;<i>   test_OBJECTS = test.$(OBJEXT)
</I>&gt;<i> ! test_LDADD = $(LDADD)
</I>&gt;<i>   test_DEPENDENCIES =
</I>&gt;<i>   test_LDFLAGS =
</I>&gt;<i>
</I>&gt;<i> --- 145,151 ----
</I>&gt;<i>
</I>&gt;<i>   test_SOURCES = test.c
</I>&gt;<i>   test_OBJECTS = test.$(OBJEXT)
</I>&gt;<i> ! test_LDADD = $(LDADD) $(GLIB_LIBS)
</I>&gt;<i>   test_DEPENDENCIES =
</I>&gt;<i>   test_LDFLAGS =
</I>&gt;<i>
</I>&gt;<i> /opt/freeware/bin/diff -crN ../mono-1.1.1/mono/io-layer/threads.h
</I>&gt;<i> ./mono/io-layer/threads.h
</I>&gt;<i> *** ../mono-1.1.1/mono/io-layer/threads.h 2004-06-03 13:58:23.000000000
</I>&gt;<i> -0500
</I>&gt;<i> --- ./mono/io-layer/threads.h 2004-11-29 08:46:48.000000000 -0600
</I>&gt;<i> ***************
</I>&gt;<i> *** 24,30 ****
</I>&gt;<i> --- 24,32 ----
</I>&gt;<i>   #define STILL_ACTIVE STATUS_PENDING
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> + #ifndef _AIX
</I>&gt;<i>   #define THREAD_TERMINATE          0x0001
</I>&gt;<i> + #endif /* _AIX */
</I>&gt;<i>   #define THREAD_SUSPEND_RESUME           0x0002
</I>&gt;<i>   #define THREAD_GET_CONTEXT        0x0008
</I>&gt;<i>   #define THREAD_SET_CONTEXT        0x0010
</I>&gt;<i> /opt/freeware/bin/diff -crN ../mono-1.1.1/mono/io-layer/misc.c
</I>&gt;<i> ./mono/io-layer/misc.c
</I>&gt;<i> *** ../mono-1.1.1/mono/io-layer/misc.c    2003-06-17 09:44:46.000000000
</I>&gt;<i> -0500
</I>&gt;<i> --- ./mono/io-layer/misc.c    2004-11-29 08:46:48.000000000 -0600
</I>&gt;<i> ***************
</I>&gt;<i> *** 10,15 ****
</I>&gt;<i> --- 10,20 ----
</I>&gt;<i>   #include &lt;config.h&gt;
</I>&gt;<i>   #include &lt;glib.h&gt;
</I>&gt;<i>   #include &lt;sys/time.h&gt;
</I>&gt;<i> +
</I>&gt;<i> + #ifdef _AIX
</I>&gt;<i> + #include &lt;time.h&gt;
</I>&gt;<i> + #endif /* _AIX */
</I>&gt;<i> +
</I>&gt;<i>   #include &lt;stdlib.h&gt;
</I>&gt;<i>
</I>&gt;<i>   #include &quot;misc-private.h&quot;
</I>&gt;<i> ============================================================
</I>&gt;<i>
</I>&gt;<i> AIX 5 requires fewer patches than AIX 4.3, apparently IBM has fixed the
</I>&gt;<i> IPV6 implementation
</I>&gt;<i> and the asychronous IO stuff in &lt;aio.h&gt;. They also now provide distinct
</I>&gt;<i> errno values when
</I>&gt;<i> compiling with -D_LINUX_SOURCE_COMPAT. If I find a lot of time, I might
</I>&gt;<i> look at the
</I>&gt;<i> AIX 4.3 environment again, but IBM is not committing to its Linux 
</I>&gt;<i> toolbox
</I>&gt;<i> ftp site for 4.3,
</I>&gt;<i> and the Gnome people at Bull have also drastically reduced their 
</I>&gt;<i> support
</I>&gt;<i> for 4.3.
</I>&gt;<i> In my opinion, it makes sense to concentrate on AIX 5, even to the 
</I>&gt;<i> point of
</I>&gt;<i> having &quot;*-*-aix5*)&quot; instead of '&quot;*-*-aix)&quot; in configure.in.
</I>&gt;<i>
</I>&gt;<i> Miguel has ben criticizing some of the patches that Eran Sandler has 
</I>&gt;<i> been
</I>&gt;<i> suggesting. Please let me know if I can improve my stuff so that it is
</I>&gt;<i> fully in line
</I>&gt;<i> with Mono general engineering priciples. I could also test any modified
</I>&gt;<i> patches
</I>&gt;<i> against the CVS version if that is a requirement. In a strict
</I>&gt;<i> interpretation of POSIX,
</I>&gt;<i> the &lt;sys/time.h&gt; in mono/io-layer/misc.c is a bug,
</I>&gt;<i>
</I>&gt;<i>       
</I>&gt;<i> <A HREF="http://www.opengroup.org/onlinepubs/009695399/basedefs/time.h.html">http://www.opengroup.org/onlinepubs/009695399/basedefs/time.h.html</A>
</I>&gt;<i>
</I>&gt;<i>       says:
</I>&gt;<i>             ... The &lt;time.h&gt; header shall declare the structure 
</I>&gt;<i> timespec,
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> The THREAD_* defines in mono/io-layer/misc.c are not being used 
</I>&gt;<i> anywhere
</I>&gt;<i> (except THREAD_ALL_ACCESS), it might make sense to reduce the potential
</I>&gt;<i> of name conflict by another prefix.
</I>&gt;<i>
</I>&gt;<i> The glib library reference in the arch/ppc Makefile is required 
</I>&gt;<i> because the
</I>&gt;<i> asm macros
</I>&gt;<i> are pulling in the glib trace function &quot;g_logv&quot;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Paolo, there is a collection of slides that you apparently presented 
</I>&gt;<i> to an
</I>&gt;<i> IBM
</I>&gt;<i> audience  (at least it it accessible from an IBM page) - what was the
</I>&gt;<i> reaction?
</I>&gt;<i> It looks like IBM is running some .NET integration projects, but I 
</I>&gt;<i> have a
</I>&gt;<i> feeling
</I>&gt;<i> that they have not made up their mind if they should put their 
</I>&gt;<i> resources
</I>&gt;<i> into
</I>&gt;<i> Open Source activities that (from their pserspective) support 
</I>&gt;<i> Microsoft.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Greetings
</I>&gt;<i> Winfried
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> !DSPAM:41ac99fc100942068513439!
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009145.html">[Mono-devel-list] Mono on AIX  [Virus checked]
</A></li>
	<LI>Next message: <A HREF="009150.html">[Mono-devel-list] Mono on AIX  [Virus checked]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9148">[ date ]</a>
              <a href="thread.html#9148">[ thread ]</a>
              <a href="subject.html#9148">[ subject ]</a>
              <a href="author.html#9148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
