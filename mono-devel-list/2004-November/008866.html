<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Re: [Mono-patches] r36124 - trunk/mono/mono/mini
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20%5BMono-patches%5D%20r36124%20-%20trunk/mono/mono/mini&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008874.html">
   <LINK REL="Next"  HREF="008867.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Re: [Mono-patches] r36124 - trunk/mono/mono/mini</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20%5BMono-patches%5D%20r36124%20-%20trunk/mono/mono/mini&In-Reply-To="
       TITLE="[Mono-devel-list] Re: [Mono-patches] r36124 - trunk/mono/mono/mini">bmaurer at ximian.com
       </A><BR>
    <I>Tue Nov 16 12:28:44 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008874.html">[Mono-devel-list] Flag-ing security actions
</A></li>
        <LI>Next message: <A HREF="008867.html">[Mono-devel-list] Installer Mono 1.1.2, Gtk# 1.0.4, 1.9 with Previews for Win32
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8866">[ date ]</a>
              <a href="thread.html#8866">[ thread ]</a>
              <a href="subject.html#8866">[ subject ]</a>
              <a href="author.html#8866">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Note that archiving mono-patches is also a poor man's workaround for
</I>&gt;<i> cvs' (and, alas, svn's) lack of distributed support, since
</I>&gt;<i> we acan access it while disconnected.
</I>svk could help with this, no?

&gt;&gt;<i> This last point obviates the need for a Changelog at all;  'svn log'
</I>&gt;&gt;<i> on  the root of a project *is* the Changelog.  It can be dynamically
</I>&gt;&gt;<i> generated at any time.
</I>&gt;<i>
</I>&gt;<i> Yes, some people do that with cvs, too. We require the changelogs
</I>&gt;<i> because that way they are available offline and in the tarballs we
</I>&gt;<i> distribute. Maybe you can make svn log work offline like the modern
</I>&gt;<i> distributed systems: in that case we might reconsider our changelog
</I>&gt;<i> policy.
</I>
We could make a script to generate changelogs in our tarballs.


&gt;<i> Once svn implements per-file comment logs and offline svn log it will
</I>&gt;<i> be better suited for our development policies and when it will have a
</I>
I think we could hack this in with the current system. Ben, can you tell
me if this is realistic:

Each tree has `unversioned properties' that we can set on it. Basically,
what this means is that we can attach an arbitrary datum to each tree
with a specific name. svn uses this to store the log files that are
written. So what we can do is to define our own property, `changelog'.
It would be an xml file, that looks something like:

&lt;change-set rev=&quot;36564&quot; author=&quot;benm&quot; time=&quot;some time format&quot;&gt;
   &lt;file-change file=&quot;source/trunk/mono/mono/mini/mini.c&quot;&gt;
       &lt;function-change name=&quot;mono_do_foo&quot;&gt;
            Make sure the foo does bar, to fix bug #65546
       &lt;/function-change&gt;
   &lt;/file-change&gt;

   (and so on)
&lt;/change-set&gt;

We'd need to find some way to make sure this file gets cached on the
local disk (if the user wants that -- so that they can do offline
browsing). We'd also need to write a tool to query this information. It
is probably possible to make svn generate a svn:log message for each
commit given this (just generate a regular changelog style message). SO
the svn log will still be messy, but we wont use that command.

Also, this would not work for old changes (unless maybe we parse our
changelogs with a script...but even if svn did add support for per file
logs, we would have the same problem.

One question is how to generate this xml file, as it is verbose. We'd
probably want a script to do it. Also, we'd probably need more fields,
say for a summery of changes in one changeset.

We would also need to enforce the use of this changelog format, prehaps
by pre-commit hooks.

Ben, does this sound realistic?

&gt;<i> usable svn annotate it will also better support our development
</I>&gt;<i> practices:-) Thanks.
</I>
I talked with Ben yesterday about the problem here. Basically here is what
happens (this is with a 1.1 client and server). The client asks for
r{1..99} of a file, in that order. However, the server has deltas that go
backwards from 99 to 1. So what it does is to generate teh full text
version of each file, starting with 1, by using the reverse deltas. Then
it does a difference, going forward, and sends these differences and r1 to
the client. The client reconstructs the revisions in order, adn then
creates an annotation. So yes, this is fairly slow (in fact, svn blaming
mini.c takes up 40 secodns of cpu time on the server). Ben said that they
have some ideas for this. I am not sure when such a feature would be
added.

-- Ben



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008874.html">[Mono-devel-list] Flag-ing security actions
</A></li>
	<LI>Next message: <A HREF="008867.html">[Mono-devel-list] Installer Mono 1.1.2, Gtk# 1.0.4, 1.9 with Previews for Win32
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8866">[ date ]</a>
              <a href="thread.html#8866">[ thread ]</a>
              <a href="subject.html#8866">[ subject ]</a>
              <a href="author.html#8866">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
