<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Re: Adding Custom Attributes to Assembly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20Adding%20Custom%20Attributes%20to%20Assembly&In-Reply-To=f9b7187a0602210604v43297492p6de063eba68e5f05%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017263.html">
   <LINK REL="Next"  HREF="017270.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Re: Adding Custom Attributes to Assembly</H1>
    <B>Jb Evain</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Re%3A%20Adding%20Custom%20Attributes%20to%20Assembly&In-Reply-To=f9b7187a0602210604v43297492p6de063eba68e5f05%40mail.gmail.com"
       TITLE="[Mono-dev] Re: Adding Custom Attributes to Assembly">mono at evain.net
       </A><BR>
    <I>Thu Feb 23 13:39:33 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017263.html">[Mono-dev] Re: Adding Custom Attributes to Assembly
</A></li>
        <LI>Next message: <A HREF="017270.html">[Mono-dev] libgdiplus bug?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17317">[ date ]</a>
              <a href="thread.html#17317">[ thread ]</a>
              <a href="subject.html#17317">[ subject ]</a>
              <a href="author.html#17317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Sadly, using Cecil requires a bit of knowledge about the metadata  
format and how the metadata is serialized.

To add a custom attribute, you have to import (ModuleDefinition.Import 
()) the type of the custom attribute into the assembly in which the  
custom attribute will be used.

Then you have to import the appropriate constructor of the custom  
attribute type, to get a MethodReference you will used to instantiate  
a CustomAttribute object. Once you have this custom attribute, you  
can add it to an ICustomAttributeProvider, wich holds a collection of  
custom attribute.

Finally, you can write back the assembly to the disk.

Jb

On Feb 21, 2006, at 3:04 PM, vijaya raghava mutharaju wrote:

&gt;<i>   Hi,
</I>&gt;<i>
</I>&gt;<i>             I was thinking if the following code would do what I  
</I>&gt;<i> was asking of
</I>&gt;<i>
</I>&gt;<i>                  1)  AssemblyDefinition assembly1 =  
</I>&gt;<i> AssemblyFactory.GetAssembly(&quot;MyAssembly.exe&quot;);
</I>&gt;<i>                       AssemblyDefinition assembly2 =
</I>&gt;<i>                                                                
</I>&gt;<i> AssemblyFactory.GetAssembly(&quot;AnotherAssembly.exe&quot;);
</I>&gt;<i>                       foreach(.........)
</I>&gt;<i>                        {     if(type is  MyAttribute)
</I>&gt;<i>                              {  // Import MyAttribute into assembly2
</I>&gt;<i>                          }}
</I>&gt;<i>                 2)  MyAttribute attribute = new MyAttribute(&quot;some  
</I>&gt;<i> arguments&quot;);
</I>&gt;<i>                      But it still leaves the issue of how to assign  
</I>&gt;<i> a proper parent(in my case a class in assembly2) to MyAttribute.
</I>&gt;<i>
</I>&gt;<i>               Excuse me if the above code is completely off target.  
</I>&gt;<i> Iam new to Cecil.
</I>&gt;<i>
</I>&gt;<i>           Thank you.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 2/21/06, vijaya raghava mutharaju &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">m.vijayaraghava at gmail.com</A>&gt;  
</I>&gt;<i> wrote:
</I>&gt;<i>        Hello,
</I>&gt;<i>
</I>&gt;<i>             I want to add custom attributes to an existing  
</I>&gt;<i> assembly. I want to do the following steps.
</I>&gt;<i>
</I>&gt;<i>                      1)  Refer the class MyAttribute which is in  
</I>&gt;<i> the assembly MyAssembly.exe, so that I can import into the current  
</I>&gt;<i> assembly - AnotherAssembly.exe
</I>&gt;<i>                       2)  Add this attribute (MyAttribute  
</I>&gt;<i> constructor with proper arguments) on top of some of the classes in  
</I>&gt;<i> AnotherAssembly.exe which is the one that is to be modified.
</I>&gt;<i>                       3) Save it back to disk - I know  
</I>&gt;<i> AssemblyDefinition.SaveAssembly() can be used for that.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>            Please can you tell me how these steps can be done using  
</I>&gt;<i> Mono.Cecil.
</I>&gt;<i>
</I>&gt;<i>            Thank you.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017263.html">[Mono-dev] Re: Adding Custom Attributes to Assembly
</A></li>
	<LI>Next message: <A HREF="017270.html">[Mono-dev] libgdiplus bug?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17317">[ date ]</a>
              <a href="thread.html#17317">[ thread ]</a>
              <a href="subject.html#17317">[ subject ]</a>
              <a href="author.html#17317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
