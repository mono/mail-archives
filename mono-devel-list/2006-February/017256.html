<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] 1003 Ways To Break A Runtime
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%201003%20Ways%20To%20Break%20A%20Runtime&In-Reply-To=20060220105217.GW25823%40debian.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017236.html">
   <LINK REL="Next"  HREF="017260.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] 1003 Ways To Break A Runtime</H1>
    <B>Jim Purbrick</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%201003%20Ways%20To%20Break%20A%20Runtime&In-Reply-To=20060220105217.GW25823%40debian.org"
       TITLE="[Mono-dev] 1003 Ways To Break A Runtime">jimpurbrick at yahoo.co.uk
       </A><BR>
    <I>Mon Feb 20 19:13:19 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017236.html">[Mono-dev] The State Of Mono Assembly Verification?
</A></li>
        <LI>Next message: <A HREF="017260.html">[Mono-dev] 1003 Ways To Break A Runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17256">[ date ]</a>
              <a href="thread.html#17256">[ thread ]</a>
              <a href="subject.html#17256">[ subject ]</a>
              <a href="author.html#17256">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Paolo/All,

I've started using templates parameterized by types
and opcodes as it makes the tests much easier to write
and check.

I've written tests for shifts, stack merging and
coercion this way and started converting the old tests
and now have 15 shell scripts which generate 1003
tests :-)

<A HREF="http://homepage.ntlworld.com/james.purbrick/VerifierTests3.tar">http://homepage.ntlworld.com/james.purbrick/VerifierTests3.tar</A>

&gt;<i> &gt; 1) It looks like object values should always 
</I>&gt;<i> &gt; merge as System.Object is always a supertype of 
</I>&gt;<i> &gt; both?
</I>&gt;<i> 
</I>&gt;<i> No. Say you have:
</I>&gt;<i> 
</I>&gt;<i> class A {}
</I>&gt;<i> class B : A {}
</I>&gt;<i> class C : B {}
</I>&gt;<i> 
</I>&gt;<i> Merging B and C will result in a B type, not Object.
</I>&gt;<i> The spec says: the closest common supertype.
</I>&gt;<i> If you need to merge C and string, then the closest
</I>&gt;<i> supertype is Object.
</I>
But, if all objects are subtypes of Object, any 2
object types will merge, so its always possible to
merge 2 stacks with equal numbers of object types?

If so, why all the special rules about compatibility
of arrays and interfaces etc.? Are they not objects
for the purposes of stack merges? Are the type
compatibility rules also used elsewhere? (If so,
where?)

&gt;<i> &gt; 2) Should shift op tests be based on &quot;Table 6:
</I>&gt;<i> &gt; Shift Operations&quot; (which makes sense) or &quot;Table 5:
</I>&gt;<i> &gt; Integer Operations&quot; (which 3.58 and 3.59 refer to 
</I>&gt;<i> &gt; under &quot;Correctness and Verifiability&quot;).
</I>&gt;<i> 
</I>&gt;<i> I'd say Table 6. 
</I>
Done.

&gt;<i> &gt; 6) How do i generate by-ref and ref any fields in
</I>&gt;<i> &gt; CIL for the 1.6 coercion tests for stfld?
</I>&gt;<i> 
</I>&gt;<i> Use:
</I>&gt;<i> 	.field int32&amp; val1
</I>&gt;<i> and
</I>&gt;<i> 	.field [mscorlib]System.TypedReference val2
</I>&gt;<i> 
</I>&gt;<i> They are not allowed, so I'm not sure ilasm will
</I>&gt;<i> compile them.
</I>
ILASM doesn't seem to like them.

&gt;<i> &gt; 7) When does coercion happen?
</I>&gt;<i>
</I>&gt;<i> Coercion should happens every time there is a store,
</I>&gt;<i> so calls, stloc, starg, stfld, stsfld, stelem, box, 
</I>&gt;<i> stobj, cpobj, stind.
</I>
OK, done. Are there other tests needed for these
opcodes? Do the slot type and stack type also have to
match according to the verification type compatibility
rules?

Cheers,

Jim.


		
___________________________________________________________ 
Win a BlackBerry device from O2 with Yahoo!. Enter now. <A HREF="http://www.yahoo.co.uk/blackberry">http://www.yahoo.co.uk/blackberry</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017236.html">[Mono-dev] The State Of Mono Assembly Verification?
</A></li>
	<LI>Next message: <A HREF="017260.html">[Mono-dev] 1003 Ways To Break A Runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17256">[ date ]</a>
              <a href="thread.html#17256">[ thread ]</a>
              <a href="subject.html#17256">[ subject ]</a>
              <a href="author.html#17256">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
