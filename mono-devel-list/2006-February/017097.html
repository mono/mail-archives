<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Async socket connection problem on FreeBSD
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Async%20socket%20connection%20problem%20on%20FreeBSD&In-Reply-To=43EDF76A.60109%40majestic12.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017092.html">
   <LINK REL="Next"  HREF="017098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Async socket connection problem on FreeBSD</H1>
    <B>Allan Hsu</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Async%20socket%20connection%20problem%20on%20FreeBSD&In-Reply-To=43EDF76A.60109%40majestic12.co.uk"
       TITLE="[Mono-dev] Async socket connection problem on FreeBSD">allan at counterpop.net
       </A><BR>
    <I>Sun Feb 12 22:20:51 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="017092.html">[Mono-dev] Async socket connection problem on FreeBSD
</A></li>
        <LI>Next message: <A HREF="017098.html">[Mono-dev]	Microsoft.VisualBasic.VBCodeProvider.CreateCompiler.CompileAssemblyFromSource	commandline options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17097">[ date ]</a>
              <a href="thread.html#17097">[ thread ]</a>
              <a href="subject.html#17097">[ subject ]</a>
              <a href="author.html#17097">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I used to have this same problem on OS X. You may want to try the  
latest release (1.1.13.2) to see if the problem still exists (it has  
at least been fixed on OS X).

	-Allan
--
Allan Hsu &lt;allan at counterpop dot net&gt;
1E64 E20F 34D9 CBA7 1300  1457 AC37 CBBB 0E92 C779


On Feb 11, 2006, at 6:40 AM, Alex Chudnovsky wrote:

&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> Apologies for not posting to FreeBSD specific list but my attempts  
</I>&gt;<i> to subscribe to it did not seem to have succeeded.
</I>&gt;<i>
</I>&gt;<i> The test case below is for an issue on Mono v1.1.12 running on  
</I>&gt;<i> FreeBSD - basically if asyncronous socket connection is being made  
</I>&gt;<i> then it never succeeds - it just hangs out there and callback never  
</I>&gt;<i> happens. Syncronous version of connect works fine - in the test  
</I>&gt;<i> case by default async connection will be attempted but if any  
</I>&gt;<i> command line arguements used then syncronous will be done.
</I>&gt;<i>
</I>&gt;<i> Any ideas would be appreciated.
</I>&gt;<i>
</I>&gt;<i> /* ************************************************************ */
</I>&gt;<i> using System;
</I>&gt;<i> using System.Net;
</I>&gt;<i> using System.Net.Sockets;
</I>&gt;<i>
</I>&gt;<i> namespace Majestic12
</I>&gt;<i> {
</I>&gt;<i>    /// &lt;summary&gt;
</I>&gt;<i>    /// SocketTest: test of socket connection failure on Mono  
</I>&gt;<i> running on FreeBSD
</I>&gt;<i>    /// &lt;/summary&gt;
</I>&gt;<i>    class SocketTest
</I>&gt;<i>    {
</I>&gt;<i>
</I>&gt;<i>        [STAThread]
</I>&gt;<i>        static void Main(string[] args)
</I>&gt;<i>        {
</I>&gt;<i>            bool bUseAsync=true;
</I>&gt;<i>
</I>&gt;<i>            if(args.Length==0)
</I>&gt;<i>                Console.WriteLine(&quot;No params detected, will use  
</I>&gt;<i> ASYNC socket operation, put anything to make it use SYNCronous  
</I>&gt;<i> request&quot;);
</I>&gt;<i>            else
</I>&gt;<i>                  bUseAsync=false;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>            // known high-uptime host: www.bbc.co.uk
</I>&gt;<i>            string sIP=&quot;212.58.224.125&quot;;
</I>&gt;<i>            int iPort=80;
</I>&gt;<i>
</I>&gt;<i>            SocketTest oST=new SocketTest();
</I>&gt;<i>            oST.Start(sIP,iPort,bUseAsync);
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i>        Socket oConn=null;
</I>&gt;<i>
</I>&gt;<i>        void Start(string sIP,int iPort,bool bUseAsync)
</I>&gt;<i>        {
</I>&gt;<i>            Console.WriteLine(&quot;Trying to connect to {0}:{1} using  
</I>&gt;<i> {2} IO&quot;,sIP,iPort,bUseAsync ? &quot;ASYNCronous&quot; : &quot;SYNCronous&quot;);
</I>&gt;<i>
</I>&gt;<i>            IPEndPoint oEP=new IPEndPoint(IPAddress.Parse(sIP),iPort);
</I>&gt;<i>
</I>&gt;<i>            oConn=new Socket 
</I>&gt;<i> (oEP.Address.AddressFamily,SocketType.Stream,ProtocolType.Tcp);
</I>&gt;<i>
</I>&gt;<i>            if(bUseAsync)
</I>&gt;<i>                oConn.BeginConnect(oEP,new AsyncCallback 
</I>&gt;<i> (EndConnect),this);
</I>&gt;<i>            else
</I>&gt;<i>            {
</I>&gt;<i>                oConn.Connect(oEP);
</I>&gt;<i>                Console.WriteLine(&quot;SYNC IO successfully worked!&quot;);
</I>&gt;<i>            }
</I>&gt;<i>
</I>&gt;<i>            Console.WriteLine(&quot;Press ENTER to exit - if you used  
</I>&gt;<i> ASYNC IO then wait for callback confirmation&quot;);
</I>&gt;<i>            Console.ReadLine();
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i>        /// &lt;summary&gt;
</I>&gt;<i>        /// This function will be called when using AsyncIO
</I>&gt;<i>        /// &lt;/summary&gt;
</I>&gt;<i>        void EndConnect(IAsyncResult oAR)
</I>&gt;<i>        {
</I>&gt;<i>            Console.WriteLine(&quot;ASYNC EndConnect callback received!&quot;);
</I>&gt;<i>
</I>&gt;<i>            try
</I>&gt;<i>            {
</I>&gt;<i>                SocketTest oThis=(SocketTest) oAR.AsyncState;
</I>&gt;<i>
</I>&gt;<i>                oThis.oConn.EndConnect(oAR);
</I>&gt;<i>            }
</I>&gt;<i>            catch(SocketException oEx)
</I>&gt;<i>            {
</I>&gt;<i>                Console.WriteLine(&quot;SOCKET ERROR: &quot;+oEx.ToString());
</I>&gt;<i>            }
</I>&gt;<i>            catch(Exception oEx)
</I>&gt;<i>            {
</I>&gt;<i>                Console.WriteLine(&quot;GENERAL ERROR: &quot;+oEx.ToString());
</I>&gt;<i>            }
</I>&gt;<i>        }
</I>&gt;<i>    }
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017092.html">[Mono-dev] Async socket connection problem on FreeBSD
</A></li>
	<LI>Next message: <A HREF="017098.html">[Mono-dev]	Microsoft.VisualBasic.VBCodeProvider.CreateCompiler.CompileAssemblyFromSource	commandline options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17097">[ date ]</a>
              <a href="thread.html#17097">[ thread ]</a>
              <a href="subject.html#17097">[ subject ]</a>
              <a href="author.html#17097">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
