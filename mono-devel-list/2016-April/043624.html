<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] PPC_64K_PAGES (Re: Running Mono on 32bits-big endian	PowerPC)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20PPC_64K_PAGES%20%28Re%3A%20Running%20Mono%20on%2032bits-big%20endian%0A%09PowerPC%29&In-Reply-To=%3CCA%2B7wUswXvs0Asv7kXXB3faz2T-z%3D_Gs_QWFaSSi0fPvL8E8aLA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043623.html">
   <LINK REL="Next"  HREF="043630.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] PPC_64K_PAGES (Re: Running Mono on 32bits-big endian	PowerPC)</H1>
    <B>Mathieu Malaterre</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20PPC_64K_PAGES%20%28Re%3A%20Running%20Mono%20on%2032bits-big%20endian%0A%09PowerPC%29&In-Reply-To=%3CCA%2B7wUswXvs0Asv7kXXB3faz2T-z%3D_Gs_QWFaSSi0fPvL8E8aLA%40mail.gmail.com%3E"
       TITLE="[Mono-dev] PPC_64K_PAGES (Re: Running Mono on 32bits-big endian	PowerPC)">malat at debian.org
       </A><BR>
    <I>Mon Apr 11 08:18:43 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="043623.html">[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux
</A></li>
        <LI>Next message: <A HREF="043630.html">[Mono-dev] Bug#819711: PPC_64K_PAGES (Re: Running Mono on 32bits-big endian PowerPC)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43624">[ date ]</a>
              <a href="thread.html#43624">[ thread ]</a>
              <a href="subject.html#43624">[ subject ]</a>
              <a href="author.html#43624">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE># set patch tag at least to get some attention, may need some tweaking
# since pagesize on buildd machine != user installed one
Control: tags -1 patch

On Thu, Mar 31, 2016 at 2:37 PM, Mathieu Malaterre &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">malat at debian.org</A>&gt; wrote:
&gt;<i> Dear all,
</I>&gt;<i>
</I>&gt;<i> I am currently trying to resurrect Mono debian package on PowerPC (32bits BE).
</I>&gt;<i>
</I>&gt;<i> I have two questions:
</I>&gt;<i>
</I>&gt;<i> - Is there a released version I should consider to start with if I
</I>&gt;<i> want to make mono work son PowerPC again ?
</I>&gt;<i>
</I>&gt;<i> - I see some big changes here at:
</I>&gt;<i> 99902cec93dfbc9e18e3fb6fa07b8770a3bd9adc so I am wondering if version
</I>&gt;<i> 4.2.1.102 (current debian package) is not a bit too old so get things
</I>&gt;<i> back in shape.
</I>
Answering my own post.

So the bug was really within sgen implementation details:
ARCH_MIN_MS_BLOCK* definitions.

Within debian infrstratucture, our buildd machines are setup using
default debian kernel, and the default kernel logical page size was
changed recently:

[debian/config/kernelarch-powerpc/config-arch-64: Set PPC_64K_PAGES.]
<A HREF="https://anonscm.debian.org/cgit/kernel/linux.git/commit/?id=aed63a56b189d771116f2d4b8fe10bbec528e6a2">https://anonscm.debian.org/cgit/kernel/linux.git/commit/?id=aed63a56b189d771116f2d4b8fe10bbec528e6a2</A>

The ppc32 buildd machine is setup on a ppc64 kernel. For some obscure
details (at least to me), one cannot run a debian ppc32 kernel on
ppc64 arch. Which means that the basic `mono` compiler is compiled
using ppc32 user space, but at C# compile time is executed on ppc64
kernel.

I am guessing another simple patch would be to run the bootstrap
process with gc=none and keep the default sgen 4K setting for ppc32
machine.

It would be nice that mono detect any incoherence at runtime, this
would make tracking this bug in the future *so* much easier.

-M
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ppc32.patch
Type: application/octet-stream
Size: 669 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20160411/67c442fe/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20160411/67c442fe/attachment.obj</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043623.html">[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux
</A></li>
	<LI>Next message: <A HREF="043630.html">[Mono-dev] Bug#819711: PPC_64K_PAGES (Re: Running Mono on 32bits-big endian PowerPC)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43624">[ date ]</a>
              <a href="thread.html#43624">[ thread ]</a>
              <a href="subject.html#43624">[ subject ]</a>
              <a href="author.html#43624">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
