<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Problem with parameters using Odbc/ADO.NET/Sybase	9.0.2 ASA
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problem%20with%20parameters%20using%20Odbc/ADO.NET/Sybase%0A%099.0.2%20ASA&In-Reply-To=200612221407.05609.mbd%40dbc.dk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021908.html">
   <LINK REL="Next"  HREF="021917.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Problem with parameters using Odbc/ADO.NET/Sybase	9.0.2 ASA</H1>
    <B>Daniel Morgan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problem%20with%20parameters%20using%20Odbc/ADO.NET/Sybase%0A%099.0.2%20ASA&In-Reply-To=200612221407.05609.mbd%40dbc.dk"
       TITLE="[Mono-dev] Problem with parameters using Odbc/ADO.NET/Sybase	9.0.2 ASA">monodanmorg at yahoo.com
       </A><BR>
    <I>Fri Dec 22 10:27:32 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021908.html">[Mono-dev] Problem with parameters using Odbc/ADO.NET/Sybase 9.0.2	ASA
</A></li>
        <LI>Next message: <A HREF="021917.html">[Mono-dev] System.IO or Mono.Unix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21913">[ date ]</a>
              <a href="thread.html#21913">[ thread ]</a>
              <a href="subject.html#21913">[ subject ]</a>
              <a href="author.html#21913">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm only guessing here.

Are you using an ODBC driver for Sybase ASA from
Sybase?

Have you tried using the FreeTDS ODBC driver?

What ODBC manager are you using?  unixODBC, iODBC?

To be honest, I don't think anyone has tested the
Mono's Odbc provider with Sybase ASA.

If there is not a bug for this already in bugzilla,
can you add it please?

<A HREF="http://bugzilla.ximian.com/">http://bugzilla.ximian.com/</A>


--- Mads Bondo Dydensborg &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mbd at dbc.dk</A>&gt; wrote:

&gt;<i> Hi there
</I>&gt;<i> 
</I>&gt;<i> I have a program using parameters for inserts using
</I>&gt;<i> Odbc on a Linux platform 
</I>&gt;<i> against a Sybase ASA 9.0.2 server. I have tried to
</I>&gt;<i> make a minimal program to 
</I>&gt;<i> illustrate the problem. It looks like the parameters
</I>&gt;<i> are not substituted?
</I>&gt;<i> 
</I>&gt;<i> The program below fails with:
</I>&gt;<i> 
</I>&gt;<i> $ mono --debug MinTestOdbc.exe
</I>&gt;<i> 
</I>&gt;<i> Unhandled Exception: System.Data.Odbc.OdbcException:
</I>&gt;<i> [Sybase][ODBC Driver]
</I>&gt;<i> [Adaptive Server Anywhere]Column '@p1' not found
</I>&gt;<i>   at System.Data.Odbc.OdbcCommand.ExecSQL
</I>&gt;<i> (System.String sql) [0x000a2] 
</I>&gt;<i> in
</I>&gt;<i>
</I>/home/madsdyd/xIntegra/MONOTRUNK/mcs/class/System.Data/System.Data.Odbc/OdbcCommand.cs:414
&gt;<i>   at System.Data.Odbc.OdbcCommand.ExecuteNonQuery
</I>&gt;<i> (Boolean freeHandle) 
</I>&gt;<i> [0x0002a] 
</I>&gt;<i> in
</I>&gt;<i>
</I>/home/madsdyd/xIntegra/MONOTRUNK/mcs/class/System.Data/System.Data.Odbc/OdbcCommand.cs:440
&gt;<i>   at System.Data.Odbc.OdbcCommand.ExecuteNonQuery ()
</I>&gt;<i> [0x00000] 
</I>&gt;<i> in
</I>&gt;<i>
</I>/home/madsdyd/xIntegra/MONOTRUNK/mcs/class/System.Data/System.Data.Odbc/OdbcCommand.cs:428
&gt;<i>   at MinOdbcTest.Main (System.String[] args)
</I>&gt;<i> [0x0004c] 
</I>&gt;<i> in
</I>&gt;<i>
</I>/home/madsdyd/xIntegra/SybaseTest/Odbc/MinTestOdbc.cs:23
&gt;<i> 
</I>&gt;<i> The Sybase server says :
</I>&gt;<i> 
</I>&gt;<i> ** REQUEST conn: 33    STMT_PREPARE           
</I>&gt;<i> &quot;insert into mono_sql_test ( 
</I>&gt;<i> char_value ) values ( @p1 )&quot;
</I>&gt;<i> ** DONE    conn: 33    STMT_PREPARE           
</I>&gt;<i> Stmt=65539
</I>&gt;<i> ** REQUEST conn: 33    STMT_DESCRIBE_OUTPUT   
</I>&gt;<i> Stmt=-1
</I>&gt;<i> ** DONE    conn: 33    STMT_DESCRIBE_OUTPUT
</I>&gt;<i> ** REQUEST conn: 33    STMT_DESCRIBE_INPUT    
</I>&gt;<i> Stmt=-1
</I>&gt;<i> ** DONE    conn: 33    STMT_DESCRIBE_INPUT
</I>&gt;<i> ** REQUEST conn: 33    STMT_EXECUTE           
</I>&gt;<i> Stmt=65539
</I>&gt;<i> ** ERROR   conn: 33    code: -143 &quot;Column '@p1' not
</I>&gt;<i> found&quot;
</I>&gt;<i> 
</I>&gt;<i> This is mono/mcs from current svn.
</I>&gt;<i> 
</I>&gt;<i> The program is this:
</I>&gt;<i> 
</I>&gt;<i> using System;
</I>&gt;<i> using System.Data;
</I>&gt;<i> using System.Data.Odbc;
</I>&gt;<i> using System.Text;
</I>&gt;<i> 
</I>&gt;<i> class MinOdbcTest {
</I>&gt;<i>   static void Main(string[] args) {
</I>&gt;<i> 
</I>&gt;<i>     OdbcConnection cnc = new OdbcConnection 
</I>&gt;<i> ( &quot;DSN=SybaseASA;UID=DBA;PWD=SQL&quot; );
</I>&gt;<i>     cnc.Open();
</I>&gt;<i> 
</I>&gt;<i>     OdbcCommand insertCommand = cnc.CreateCommand();
</I>&gt;<i>     insertCommand.CommandText 
</I>&gt;<i>       = &quot;insert into mono_sql_test ( char_value )
</I>&gt;<i> values ( @p1 )&quot;;
</I>&gt;<i>   
</I>&gt;<i>     OdbcParameterCollection parameters =
</I>&gt;<i> insertCommand.Parameters;
</I>&gt;<i>   
</I>&gt;<i>     parameters.Add ( &quot;@p1&quot;, OdbcType.Char );
</I>&gt;<i>     parameters [ &quot;@p1&quot; ].Value = &quot;This is a char&quot;;
</I>&gt;<i>     
</I>&gt;<i>     insertCommand.ExecuteNonQuery ();
</I>&gt;<i> 
</I>&gt;<i>     cnc.Close();
</I>&gt;<i>   }
</I>&gt;<i> }
</I>&gt;<i>
</I>
__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
<A HREF="http://mail.yahoo.com">http://mail.yahoo.com</A> 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021908.html">[Mono-dev] Problem with parameters using Odbc/ADO.NET/Sybase 9.0.2	ASA
</A></li>
	<LI>Next message: <A HREF="021917.html">[Mono-dev] System.IO or Mono.Unix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21913">[ date ]</a>
              <a href="thread.html#21913">[ thread ]</a>
              <a href="subject.html#21913">[ subject ]</a>
              <a href="author.html#21913">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
