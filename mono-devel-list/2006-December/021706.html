<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Connection to a sybase ASA database
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Connection%20to%20a%20sybase%20ASA%20database&In-Reply-To=457D223B.7020303%40novell.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021705.html">
   <LINK REL="Next"  HREF="021707.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Connection to a sybase ASA database</H1>
    <B>Mads Bondo Dydensborg</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Connection%20to%20a%20sybase%20ASA%20database&In-Reply-To=457D223B.7020303%40novell.com"
       TITLE="[Mono-dev] Connection to a sybase ASA database">mbd at dbc.dk
       </A><BR>
    <I>Mon Dec 11 04:58:10 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021705.html">[Mono-dev] Connection to a sybase ASA database
</A></li>
        <LI>Next message: <A HREF="021707.html">[Mono-dev] Connection to a sybase ASA database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21706">[ date ]</a>
              <a href="thread.html#21706">[ thread ]</a>
              <a href="subject.html#21706">[ subject ]</a>
              <a href="author.html#21706">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>mandag 11 december 2006 10:17 skrev Nagappan:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I tried with SqlSharp and connected to Sybase server
</I>
Thanks a lot for your help.

Could you perhaps let me know which version the Sybase server was/is?

Regards,

Mads


&gt;<i> 
</I>&gt;<i> SQL# \Provider Tds
</I>&gt;<i> The default Provider is LOADEXTPROVIDER
</I>&gt;<i> Assembly: Mono.Data.TdsClient, Version=1.0.5000.0, Culture=neutral,
</I>&gt;<i> PublicKeyToken=0738eb9f132ed756
</I>&gt;<i> Connection Class: Mono.Data.TdsClient.TdsConnection
</I>&gt;<i> 
</I>&gt;<i> SQL# \ConnectionString Server=mono-server,5000;Database=monotest;User
</I>&gt;<i> ID=monotester;Password=monotester
</I>&gt;<i> 
</I>&gt;<i> SQL# \open
</I>&gt;<i> Opening connection...
</I>&gt;<i> Loading external provider...
</I>&gt;<i> External provider loaded.
</I>&gt;<i> Open was successfull.
</I>&gt;<i> 
</I>&gt;<i> SQL# \ConnectionString Server=mono-server,5000;Database=monotest;User
</I>&gt;<i> ID=monotester;Password=monotester
</I>&gt;<i> 
</I>&gt;<i> SQL# \Provider Sybase
</I>&gt;<i> The default Provider is LOADEXTPROVIDER
</I>&gt;<i> Assembly: Mono.Data.SybaseClient, Version=1.0.5000.0, Culture=neutral,
</I>&gt;<i> PublicKeyToken=0738eb9f132ed756
</I>&gt;<i> Connection Class: Mono.Data.SybaseClient.SybaseConnection
</I>&gt;<i> 
</I>&gt;<i> SQL# \Open
</I>&gt;<i> Opening connection...
</I>&gt;<i> Loading external provider...
</I>&gt;<i> External provider loaded.
</I>&gt;<i> Open was successfull.
</I>&gt;<i> 
</I>&gt;<i> Thanks
</I>&gt;<i> Nagappan
</I>&gt;<i> 
</I>&gt;<i> Mads Bondo Dydensborg wrote:
</I>&gt;<i> &gt; mandag 11 december 2006 07:48 skrev Mads Bondo Dydensborg:
</I>&gt;<i> &gt;   
</I>&gt;<i> &gt;&gt; fredag 08 december 2006 17:44 skrev Daniel Morgan:
</I>&gt;<i> &gt;&gt;     
</I>&gt;<i> &gt;&gt;&gt; No one is maintaining the Mono.Data.TdsClient.
</I>&gt;<i> &gt;&gt;&gt; Mono.Data.SybaseClient might be better.  Both of these
</I>&gt;<i> &gt;&gt;&gt; including System.Data.SqlClient use Mono.Data.Tds
</I>&gt;<i> &gt;&gt;&gt; which implements the TDS protocol.
</I>&gt;<i> &gt;&gt;&gt;       
</I>&gt;<i> &gt;&gt; OK - I will try those instead.
</I>&gt;<i> &gt;&gt;     
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have now tried the sqlsharp program instead, which uses the SybaseClient 
</I>&gt;<i> &gt; implementation.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Here is a dump:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; SQL# \defaults
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The default Provider is LOADEXTPROVIDER
</I>&gt;<i> &gt;   Assembly: Mono.Data.SybaseClient, Version=1.0.5000.0, Culture=neutral, 
</I>&gt;<i> &gt; PublicKeyToken=0738eb9f132ed756
</I>&gt;<i> &gt;   Connection Class: Mono.Data.SybaseClient.SybaseConnection
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The default ConnectionString is:
</I>&gt;<i> &gt;     &quot;Server=localhost,2638;Database=asademo;User ID=DBA;Password=SQL&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; SQL# \open
</I>&gt;<i> &gt; Opening connection...
</I>&gt;<i> &gt; Loading external provider...
</I>&gt;<i> &gt; External provider loaded.
</I>&gt;<i> &gt; Exception Caught Opening. ASA Error -83: Specified database not found
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -------
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Now, here is what my sybase database says:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; TCP/IP: Received connection request from 127.0.0.1:37335.
</I>&gt;<i> &gt; Connection from 127.0.0.1:37335 assigned connection ID 2
</I>&gt;<i> &gt; TDS 2: connection created
</I>&gt;<i> &gt; TDS 2: login
</I>&gt;<i> &gt; TDS 2: using TDS version 5.0.0.0
</I>&gt;<i> &gt; TDS 2: login: user 'DBA', database '', application 'Mono SybaseClient Data 
</I>&gt;<i> &gt; Provide', host 'localhost.localdomain', host_pid '37876', charset 'iso_1'
</I>&gt;<i> &gt; TDS 2: request complete
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As you can see, the sybase database reckons that no database name is 
</I>passed.
&gt;<i> &gt;
</I>&gt;<i> &gt; I have seen this described earlier, but no resolution.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Running SybaseTest gives very much the same results.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I tried tracking the code in mono, and it does appear that the database 
</I>name 
&gt;<i> &gt; gets lost in there in my case. It should reside in &quot;ITds&quot;.parms which is a 
</I>&gt;<i> &gt; TDSConnectionParameters, but if I try dumping it, after calling open 
</I>(which 
&gt;<i> &gt; fails), no database is set. However, I find tracking the code to the Tds 
</I>&gt;<i> &gt; system a bit complex, so I can not at this point figure out why that would 
</I>be 
&gt;<i> &gt; the case.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any advice much appreciated.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Mads
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Nagappan A &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">anagappan at novell.com</A>&gt;
</I>&gt;<i> Novell Software Development (I) Pvt. Ltd.
</I>&gt;<i> Linux Desktop Testing Project - <A HREF="http://ldtp.freedesktop.org">http://ldtp.freedesktop.org</A>
</I>&gt;<i> <A HREF="http://nagappanal.blogspot.com/">http://nagappanal.blogspot.com/</A>
</I>&gt;<i> 
</I>&gt;<i> Novell, Inc.
</I>&gt;<i> SUSE&#174; Linux Enterprise 10
</I>&gt;<i> Your Linux is ready&#8482;
</I>&gt;<i> <A HREF="http://www.novell.com/linux">http://www.novell.com/linux</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-- 
Med venlig hilsen/Regards

Systemudvikler/Systemsdeveloper cand.scient.dat, Ph.d., Mads Bondo Dydensborg
Dansk BiblioteksCenter A/S, Tempovej 7-11, 2750 Ballerup, Tlf. +45 44 86 77 34


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021705.html">[Mono-dev] Connection to a sybase ASA database
</A></li>
	<LI>Next message: <A HREF="021707.html">[Mono-dev] Connection to a sybase ASA database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21706">[ date ]</a>
              <a href="thread.html#21706">[ thread ]</a>
              <a href="subject.html#21706">[ subject ]</a>
              <a href="author.html#21706">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
