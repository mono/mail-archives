<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] ObjectDisposedException etc lacks #ctor(String,	Exception)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20ObjectDisposedException%20etc%20lacks%20%23ctor%28String%2C%0A%09Exception%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021817.html">
   <LINK REL="Next"  HREF="021821.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] ObjectDisposedException etc lacks #ctor(String,	Exception)</H1>
    <B>Andy Hume</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20ObjectDisposedException%20etc%20lacks%20%23ctor%28String%2C%0A%09Exception%29&In-Reply-To="
       TITLE="[Mono-dev] ObjectDisposedException etc lacks #ctor(String,	Exception)">andyhume32 at yahoo.co.uk
       </A><BR>
    <I>Tue Dec 19 08:17:55 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021817.html">[Mono-dev] Inconsistent HResult setting in two BCL Exceptions
</A></li>
        <LI>Next message: <A HREF="021821.html">[Mono-dev] ObjectDisposedException etc lacks #ctor(String,	Exception)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21820">[ date ]</a>
              <a href="thread.html#21820">[ thread ]</a>
              <a href="subject.html#21820">[ subject ]</a>
              <a href="author.html#21820">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I was using 
    new ObjectDisposedException(&quot;...&quot;, caughtException)
in my code, and thus on Mono it fails at runtime with MissingMethodException as that exception has no &quot;#ctor(string message, Exception inner)&quot; in Mono.

The FDG (Framework Design Guidelines) says:
&quot;Do provide (at least) these common constructors on all exceptions.
[...]
public class SomeException: Exception, ISerializable {
  public SomeException();
  public SomeException(string message);
  public SomeException(string message, Exception inner);
 
  // this constructor is needed for serialization.
  protected SomeException(SerializationInfo info, StreamingContext context);
}&quot;

See <A HREF="http://blogs.msdn.com/kcwalina/archive/2006/07/05/657268.aspx,">http://blogs.msdn.com/kcwalina/archive/2006/07/05/657268.aspx,</A> <A HREF="http://msdn2.microsoft.com/en-gb/library/87cdya3t(vs.80">http://msdn2.microsoft.com/en-gb/library/87cdya3t(vs.80</A>).aspx


I've written some code to detect such differences from the MSFT runtime.  It is attached.  This highlights the following instances of that constructor missing:
In Corlib
* System.ArgumentOutOfRangeException
* System.DuplicateWaitObjectException
* System.NotFiniteNumberException
* System.ObjectDisposedException
In System
* System.ComponentModel.Design.CheckoutException


Other items are where certain constructors are missing in both producer's BCLs, e.g.
* System.Reflection.ReflectionTypeLoadException
and
* System.Reflection.TargetInvocationException

There are other inconsistencies in the results, but mostly unimportant: differences in messages usage, and two cases where there are *extra* constructors in Mono e.g. in MSFT &quot;ObjectDisposedException - Has NO default constructor&quot;, but does in Mono.


The attached code is for a command-line program that outputs cases where there is:
* No #ctor().
* No #ctor(String).
* No #ctor(String,Exception).
* No (public/protected) #ctor(SerializationInfo, StreamingContext).

And also for #ctor(String,Exception):
* Different 'message' than supplied.  The only cases seen being where the exception adds some prefix to the message.
* Diffent 'innerException' than supplied.  None seen.
* (HResults checking is done by code posted previously to mono-devel-list).

I run it on both the MSFT and Mono CLRs and then compare the two outputs.


Sadly I don't have a setup to build Mono, so can't send patches. :-(  I aim to set up building, but may be some time: Windows machine, christmas etc etc.
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: MonoBug05ExceptionCtorStringAndException.cs
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061219/cceca5c0/attachment.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061219/cceca5c0/attachment.pl</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021817.html">[Mono-dev] Inconsistent HResult setting in two BCL Exceptions
</A></li>
	<LI>Next message: <A HREF="021821.html">[Mono-dev] ObjectDisposedException etc lacks #ctor(String,	Exception)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21820">[ date ]</a>
              <a href="thread.html#21820">[ thread ]</a>
              <a href="subject.html#21820">[ subject ]</a>
              <a href="author.html#21820">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
