<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] PKCS12 and SecretBags
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20PKCS12%20and%20SecretBags&In-Reply-To=20061218230921.GA23351%40cryptofreak.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021809.html">
   <LINK REL="Next"  HREF="021810.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] PKCS12 and SecretBags</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20PKCS12%20and%20SecretBags&In-Reply-To=20061218230921.GA23351%40cryptofreak.org"
       TITLE="[Mono-dev] PKCS12 and SecretBags">sebastien.pouliot at gmail.com
       </A><BR>
    <I>Mon Dec 18 19:44:28 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021809.html">[Mono-dev] PKCS12 and SecretBags
</A></li>
        <LI>Next message: <A HREF="021810.html">[Mono-dev] estimate time of mono version which support ASP.NET 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21811">[ date ]</a>
              <a href="thread.html#21811">[ thread ]</a>
              <a href="subject.html#21811">[ subject ]</a>
              <a href="author.html#21811">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Jay,

Some important things to consider about PKCS12 (well Mono.Security.dll
in general)...

(a) some very core Mono tools (like SN) and libraries (including, even
if indirectly, mscorlib.dll) depends on this assembly. This imply that:

        i. we cannot break binary compatibility (we can add stuff, but
        we can't change it). Other (Mono/non-Mono) applications depends
        on it;
        
        ii. we do not want the assembly to get &quot;too big&quot; (as it gets
        loaded often). The Crimson project was created, in parts, to
        avoid &quot;bloat&quot; in Mono.Security.dll

(b) it exists because:

        * the BCL didn't expose enough functionality/details for some
        tools;
        
        and
        
        * we didn't feel &quot;hiding&quot; the extra classes (inside tools or
        other assemblies) was in the best interest of the community
        (some parts, like SSL/TLS and Authenticode, have proved very
        popular);

        
On Mon, 2006-12-18 at 16:09 -0700, Jay Miller wrote:
&gt;<i> I'm looking to make use of the SecretBag type in a PKCS12 file.  Mono
</I>&gt;<i> does not currently support SecretBags in any explicit sense, which is to
</I>&gt;<i> say that users cannot access them using the PKCS12 class.  This makes
</I>&gt;<i> some sense because SecretBags aren't really defined in the standard.
</I>&gt;<i> 
</I>&gt;<i> Nonetheless, I would like to make use of both the PKCS12 class *and*
</I>&gt;<i> SecretBags.  I was hoping I could run a couple of solutions by the
</I>&gt;<i> developers and perhaps submit a patch if one sounds good.
</I>&gt;<i> 
</I>&gt;<i> Solution 1)
</I>&gt;<i> 
</I>&gt;<i> Arbitrarily decide that SecretBags will be of type byte[].  Add
</I>&gt;<i> functions that mirror existing ones: AddSecretBag(), GetSecretBags(),
</I>&gt;<i> RemoveSecretBag(), etc.  Add a member _secretBags that stores the
</I>&gt;<i> current SecretBags.
</I>
I like this approach because:

1. everything converts into byte[]

2. it doesn't break anything and doesn't add too much stuff to the
class;

3. the class itself can (later) be updated to disallow adding/removing
some content (if that ever required);

&gt;<i> Solution 2)
</I>&gt;<i> 
</I>&gt;<i> Make the _safeBags member accessible outside the class to allow the user
</I>&gt;<i> low-level access to the various bags stored by the instance.  This way a
</I>&gt;<i> user could write her own GetXxx() class for SecretBags, CRLs, or
</I>&gt;<i> whatever, simply by traversing the _safeBags list.
</I>
No immediate problem, but this would make it hard (if required in the
future) to &quot;protect&quot; (e.g. ensure something exist, or doesn't get
deleted) some contents.

&gt;<i> Solution 3)
</I>&gt;<i> 
</I>&gt;<i> Make PKCS12 more friendly as a base class such that users can derive
</I>&gt;<i> PKCS12 and implement their own understandings of SecretBags, CRLs, or
</I>&gt;<i> whatever else.  Private members will need to be made protected, maybe
</I>&gt;<i> add a few 'virtual' keywords..
</I>
This will likely break binary compatibility.

&gt;<i> Hopefully one of these solutions (or another that I hadn't considered?)
</I>
Bring a copy of it into Crimson and experiment on it (e.g. like #3)
But I admit it's a lot more work ;-)

&gt;<i> will sound reasonable, as I really don't want to maintain an entire
</I>&gt;<i> PKCS12 class just to add SecretBags!
</I>
Make sense :)

&gt;<i> Thanks very much for your time and comments!
</I>
Be sure to include unit tests with any patches ;-)

-- 
Sebastien Pouliot  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sebastien at ximian.com</A>&gt;
Blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021809.html">[Mono-dev] PKCS12 and SecretBags
</A></li>
	<LI>Next message: <A HREF="021810.html">[Mono-dev] estimate time of mono version which support ASP.NET 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21811">[ date ]</a>
              <a href="thread.html#21811">[ thread ]</a>
              <a href="subject.html#21811">[ subject ]</a>
              <a href="author.html#21811">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
