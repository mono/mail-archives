<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Error handling for embedded Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Error%20handling%20for%20embedded%20Mono&In-Reply-To=7641.203.5.217.3.1164935415.squirrel%40203.5.217.3">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021626.html">
   <LINK REL="Next"  HREF="021632.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Error handling for embedded Mono</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Error%20handling%20for%20embedded%20Mono&In-Reply-To=7641.203.5.217.3.1164935415.squirrel%40203.5.217.3"
       TITLE="[Mono-dev] Error handling for embedded Mono">lupus at ximian.com
       </A><BR>
    <I>Mon Dec  4 13:54:19 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021626.html">[Mono-dev] System Icon For a File
</A></li>
        <LI>Next message: <A HREF="021632.html">[Mono-dev] Using MoMA on mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21631">[ date ]</a>
              <a href="thread.html#21631">[ thread ]</a>
              <a href="subject.html#21631">[ subject ]</a>
              <a href="author.html#21631">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/01/06 <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">luke at quinane.id.au</A> wrote:
&gt;<i> I had a look at making some changes to remove some of these calls but ran
</I>&gt;<i> into some problems. For example mono_init_internal calls exit (line 586 of
</I>&gt;<i> domain.c) but by that point the domain has been allocated and a lot of
</I>&gt;<i> things have been initialized. So my question is how does Mono handle such
</I>&gt;<i> errors? Is it possible to return NULL for the domain and just call
</I>&gt;<i> mono_jit_cleanup?
</I>
There are a few different cases where we have exit calls or asserts:
*) true-asserts: these should really never happen and they are there to
detect some errors, mostly in the internal usage of the API
*) asserts that hit incorrect uses of the embedding API: sometimes the
internal and embedding API overlap, so the same comment as above
applies, though we must make sure we have better error messages for
developers than asserts. In many cases here I think it's OK to exit,
because it compels the developer to fix his code (I always hate when
some gtk apps spwe lots of critical awarnings and they get never
fixed...)
*) basic configuration issues: a damaged corlib, or a corlib missing
System.Int32, say, would warrant an exit with an error. We need to take
some things for granted, otherwise we end up with half of the code doing
cleanup of a partially initialized runtime.
*) in all the other cases we should properly return an error indication:
work in this area is ongoing and help is highly appreciated.

&gt;<i> Also should mono_runtime_run_main (in object.c) set
</I>&gt;<i> mono_environment_exitcode_set and return -1 instead of calling exit?
</I>
Maybe, though in such case it's likely better to have
mono_utf8_from_external () fall-back to consider the string to be in
latin1 encoding and so avoid the need to handle the error case there.

Thanks!

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021626.html">[Mono-dev] System Icon For a File
</A></li>
	<LI>Next message: <A HREF="021632.html">[Mono-dev] Using MoMA on mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21631">[ date ]</a>
              <a href="thread.html#21631">[ thread ]</a>
              <a href="subject.html#21631">[ subject ]</a>
              <a href="author.html#21631">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
