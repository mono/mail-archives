<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] XScale?,  Mono-devel-list Digest, Vol 18, Issue 62
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20XScale%3F%2C%20%20Mono-devel-list%20Digest%2C%20Vol%2018%2C%20Issue%2062&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021106.html">
   <LINK REL="Next"  HREF="021109.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] XScale?,  Mono-devel-list Digest, Vol 18, Issue 62</H1>
    <B>cody at lodrige.com</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20XScale%3F%2C%20%20Mono-devel-list%20Digest%2C%20Vol%2018%2C%20Issue%2062&In-Reply-To="
       TITLE="[Mono-dev] XScale?,  Mono-devel-list Digest, Vol 18, Issue 62">cody at lodrige.com
       </A><BR>
    <I>Thu Oct 26 01:53:21 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021106.html">[Mono-dev] [PATCH] OS X MACHINE_THREAD_STATE patch for newer 10.4u	SDK
</A></li>
        <LI>Next message: <A HREF="021109.html">[Mono-dev] Mono Meeting slides are now available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21107">[ date ]</a>
              <a href="thread.html#21107">[ thread ]</a>
              <a href="subject.html#21107">[ subject ]</a>
              <a href="author.html#21107">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,

I know mono will run on OMAPs (nokia 770), and I managed to get the same binary to run a Cirrus Logic EP9302.
What is required to get mono to run on XScale. I have an application in mind that uses a PXA255, and I would love to use C#...
 Thanks!

 J.Cody

&gt;<i>-----Original Message-----
</I>&gt;<i>From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-request at lists.ximian.com</A> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-request at lists.ximian.com</A>]
</I>&gt;<i>Sent: Thursday, October 26, 2006 12:11 AM
</I>&gt;<i>To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Subject: Mono-devel-list Digest, Vol 18, Issue 62
</I>&gt;<i>
</I>&gt;<i>Send Mono-devel-list mailing list submissions to
</I>&gt;<i>	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i>To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>or, via email, send a message with subject or body 'help' to
</I>&gt;<i>	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-request at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i>You can reach the person managing the list at
</I>&gt;<i>	<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-owner at lists.ximian.com</A>
</I>&gt;<i>
</I>&gt;<i>When replying, please edit your Subject line so it is more specific
</I>&gt;<i>than &quot;Re: Contents of Mono-devel-list digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Today's Topics:
</I>&gt;<i>
</I>&gt;<i> 1. Re: Managed DirectX (Brian Crowell)
</I>&gt;<i> 2. Re: Managed DirectX (Stefan D?singer)
</I>&gt;<i> 3. Re: Managed DirectX (Brian Crowell)
</I>&gt;<i> 4. [PATCH] Optimize Encoding.GetByteCount (Ben Maurer)
</I>&gt;<i> 5. Re: [PATCH] Optimize Encoding.GetByteCount (Atsushi Eno)
</I>&gt;<i> 6. Re: [PATCH] Optimize Encoding.GetByteCount (Aaron Bockover)
</I>&gt;<i> 7. Re: [PATCH] Optimize Encoding.GetByteCount (Alan McGovern)
</I>&gt;<i> 8. Re: [PATCH] Optimize Encoding.GetByteCount (Atsushi Eno)
</I>&gt;<i> 9. Re: Managed DirectX (Miguel de Icaza)
</I>&gt;<i> 10. [PATCH] OS X MACHINE_THREAD_STATE patch for newer 10.4u	SDK
</I>&gt;<i> (Allan Hsu)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 1
</I>&gt;<i>Date: Wed, 25 Oct 2006 13:31:07 -0500
</I>&gt;<i>From: Brian Crowell &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel at fluggo.com</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] Managed DirectX
</I>&gt;<i>To: Michael Schurter &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">michael at synthesyssolutions.com</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">453FAD6B.5020509 at fluggo.com</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i>Michael Schurter wrote:
</I>&gt;&gt;<i> Careful what you do with ILDASM Brian, at least if you plan on 
</I>&gt;&gt;<i> contributing code to the mono project:
</I>&gt;<i>
</I>&gt;<i>Yes, I know. I mostly just wanted to figure out how they made calls; everything else in my own managed implementation is written from scratch using documentation. Better yet, I throw more useful exceptions.
</I>&gt;<i>
</I>&gt;<i>Anyhow, does anyone know of a good way to step around the hand-coded interop problem without using Managed C++ or C++/CLI?
</I>&gt;<i>
</I>&gt;<i>--Brian
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 2
</I>&gt;<i>Date: Wed, 25 Oct 2006 20:49:29 +0200
</I>&gt;<i>From: Stefan D?singer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">stefandoesinger at gmx.at</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] Managed DirectX
</I>&gt;<i>To: Brian Crowell &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel at fluggo.com</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">200610252049.35526.stefandoesinger at gmx.at</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i>
</I>&gt;<i>Am Mittwoch 25 Oktober 2006 19:02 schrieben Sie:
</I>&gt;&gt;<i> A practical example of building a wrapper by hand would be most helpful.
</I>&gt;&gt;<i> Late binding is not an option, and I haven't ever found interface
</I>&gt;&gt;<i> definition files for DirectX9.
</I>&gt;<i>As far as I know idl files for dx9 do not exist, only the d3d9.h, d3d9types.h 
</I>&gt;<i>and d3d9caps.h(simmilar for other dx parts), but with dx10 ms started using 
</I>&gt;<i>idl files.
</I>&gt;<i>
</I>&gt;<i>So from the other replies it sounds like you can use wine for dx, but mono 
</I>&gt;<i>needs some preparation work first. If you need any help just contact me or 
</I>&gt;<i>the wine-devel list :-)
</I>&gt;<i>
</I>&gt;<i>Stefan
</I>&gt;<i>-------------- next part --------------
</I>&gt;<i>A non-text attachment was scrubbed...
</I>&gt;<i>Name: not available
</I>&gt;<i>Type: application/pgp-signature
</I>&gt;<i>Size: 189 bytes
</I>&gt;<i>Desc: not available
</I>&gt;<i>Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/f9253082/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/f9253082/attachment-0001.bin</A> 
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 3
</I>&gt;<i>Date: Wed, 25 Oct 2006 14:08:14 -0500
</I>&gt;<i>From: Brian Crowell &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel at fluggo.com</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] Managed DirectX
</I>&gt;<i>To: Stefan D?singer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">stefandoesinger at gmx.at</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">453FB61E.6040705 at fluggo.com</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i>Stefan D?singer wrote:
</I>&gt;&gt;<i> So from the other replies it sounds like you can use wine for dx, but mono 
</I>&gt;&gt;<i> needs some preparation work first. If you need any help just contact me or 
</I>&gt;&gt;<i> the wine-devel list :-)
</I>&gt;<i>
</I>&gt;<i>Well, one option is to use a library written in C++/CLI, compile it with Microsoft's C++ compiler, and then use the resulting library with Mono. That should work. There's just no equivalent all-Mono method.
</I>&gt;<i>
</I>&gt;<i>Tell you what. Sometime this week I'll look to release what I have done regarding XNA. It won't be exactly what you want-- in particular, my library depends on a common primitives library-- but it could be a good starting point for a Managed DirectX 9 implementation.
</I>&gt;<i>
</I>&gt;<i>--Brian
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 4
</I>&gt;<i>Date: Wed, 25 Oct 2006 16:51:57 -0400 (EDT)
</I>&gt;<i>From: &quot;Ben Maurer&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bmaurer at ximian.com</A>&gt;
</I>&gt;<i>Subject: [Mono-dev] [PATCH] Optimize Encoding.GetByteCount
</I>&gt;<i>To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID:
</I>&gt;<i>	&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">37993.130.57.170.100.1161809517.squirrel at webmail.ximian.com</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i>
</I>&gt;<i>Hey guys,
</I>&gt;<i>
</I>&gt;<i>On the 2.0 profile, Encoding uses the char*/byte* version of encoding
</I>&gt;<i>methods to avoid allocating memory. One code path missed this
</I>&gt;<i>optimization, I've attached a fix.
</I>&gt;<i>
</I>&gt;<i>This code path ends up being used in Banshee quite a bit on their tree
</I>&gt;<i>view (basically, every time the model is queried, this method gets called
</I>&gt;<i>in passing String objects to char*).
</I>&gt;<i>
</I>&gt;<i>A few things to think about:
</I>&gt;<i>
</I>&gt;<i>- It might pay to do something on the 1.0 profile as well.
</I>&gt;<i>- Paolo, can you comment on how this kind of change works with the moving gc?
</I>&gt;<i>
</I>&gt;<i>-b
</I>&gt;<i>-------------- next part --------------
</I>&gt;<i>A non-text attachment was scrubbed...
</I>&gt;<i>Name: enc.patch
</I>&gt;<i>Type: text/x-patch
</I>&gt;<i>Size: 712 bytes
</I>&gt;<i>Desc: not available
</I>&gt;<i>Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/8d07183e/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/8d07183e/attachment-0001.bin</A> 
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 5
</I>&gt;<i>Date: Thu, 26 Oct 2006 06:06:28 +0900
</I>&gt;<i>From: Atsushi Eno &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushi at ximian.com</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] [PATCH] Optimize Encoding.GetByteCount
</I>&gt;<i>To: Ben Maurer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bmaurer at ximian.com</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">453FD1D4.6080500 at ximian.com</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i>Ben Maurer wrote:
</I>&gt;&gt;<i> Hey guys,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On the 2.0 profile, Encoding uses the char*/byte* version of encoding
</I>&gt;&gt;<i> methods to avoid allocating memory. One code path missed this
</I>&gt;&gt;<i> optimization, I've attached a fix.
</I>&gt;<i>
</I>&gt;<i>nice :-) Comment for patch below.
</I>&gt;<i>
</I>&gt;&gt;<i> - It might pay to do something on the 1.0 profile as well.
</I>&gt;&gt;<i> - Paolo, can you comment on how this kind of change works with the moving gc?
</I>&gt;<i>
</I>&gt;<i>To my understanding, fixed pointers do not participate GC target. And
</I>&gt;<i>- locally-allocated array anyways lives until its conversion finishes
</I>&gt;<i> (and probably immediately disposed depending on the JIT optimization)
</I>&gt;<i>- Usually this conversion do not take long time
</I>&gt;<i>So I guess fixed pointer would work better than possibly being moved
</I>&gt;<i>from nursery area.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> +	if (s == null)
</I>&gt;&gt;<i> throw new ArgumentNullException (&quot;s&quot;);
</I>&gt;&gt;<i> +#if NET_2_0
</I>&gt;&gt;<i> +	unsafe {
</I>&gt;&gt;<i> +	fixed (char* cptr = s) {
</I>&gt;&gt;<i> +	return GetByteCount (cptr, s.Length);
</I>&gt;&gt;<i> +	}
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i> +#else
</I>&gt;&gt;<i> +	char[] chars = s.ToCharArray ();
</I>&gt;&gt;<i> +	return GetByteCount (chars, 0, chars.Length);
</I>&gt;&gt;<i> +#endif
</I>&gt;<i>
</I>&gt;<i>Before fixing the pointer you have to make sure that s is non-zero length.
</I>&gt;<i>
</I>&gt;<i>Atsushi Eno
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 6
</I>&gt;<i>Date: Wed, 25 Oct 2006 17:19:53 -0400
</I>&gt;<i>From: Aaron Bockover &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">abockover at novell.com</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] [PATCH] Optimize Encoding.GetByteCount
</I>&gt;<i>To: Ben Maurer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bmaurer at ximian.com</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">1161811193.4788.14.camel at linux-0790.site</A>&gt;
</I>&gt;<i>Content-Type: text/plain
</I>&gt;<i>
</I>&gt;<i>Thanks Ben!
</I>&gt;<i>--Aaron
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>On Wed, 2006-10-25 at 16:51 -0400, Ben Maurer wrote:
</I>&gt;&gt;<i> Hey guys,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On the 2.0 profile, Encoding uses the char*/byte* version of encoding
</I>&gt;&gt;<i> methods to avoid allocating memory. One code path missed this
</I>&gt;&gt;<i> optimization, I've attached a fix.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This code path ends up being used in Banshee quite a bit on their tree
</I>&gt;&gt;<i> view (basically, every time the model is queried, this method gets called
</I>&gt;&gt;<i> in passing String objects to char*).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> A few things to think about:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> - It might pay to do something on the 1.0 profile as well.
</I>&gt;&gt;<i> - Paolo, can you comment on how this kind of change works with the moving gc?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> -b
</I>&gt;&gt;<i> _______________________________________________ Mono-devel-list mailing list <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 7
</I>&gt;<i>Date: Wed, 25 Oct 2006 22:53:51 +0100
</I>&gt;<i>From: &quot;Alan McGovern&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">alan.mcgovern at gmail.com</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] [PATCH] Optimize Encoding.GetByteCount
</I>&gt;<i>To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID:
</I>&gt;<i>	&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">117799f00610251453w3aa6c5abr127bd697ab55627b at mail.gmail.com</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i>
</I>&gt;&gt;<i> To my understanding, fixed pointers do not participate GC target. And
</I>&gt;&gt;<i> - locally-allocated array anyways lives until its conversion finishes
</I>&gt;&gt;<i> (and probably immediately disposed depending on the JIT optimization)
</I>&gt;&gt;<i> - Usually this conversion do not take long time
</I>&gt;&gt;<i> So I guess fixed pointer would work better than possibly being moved
</I>&gt;&gt;<i> from nursery area.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>It's better to not allocate a new array if it can be avoided. From my own
</I>&gt;<i>code i found that in one of my intensively used methods i allocated a
</I>&gt;<i>100byte array each time the method was called. By moving that variable
</I>&gt;<i>outside the method and just reinitialising it each time i used it (with
</I>&gt;<i>appropriate locking) memory usage reduced by a large %. Don't rely on the GC
</I>&gt;<i>to tidy up your mess if you can avoid creating it in the first place :p
</I>&gt;<i>-------------- next part --------------
</I>&gt;<i>An HTML attachment was scrubbed...
</I>&gt;<i>URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/be451a55/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061025/be451a55/attachment-0001.html</A> 
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 8
</I>&gt;<i>Date: Thu, 26 Oct 2006 07:02:02 +0900
</I>&gt;<i>From: Atsushi Eno &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushi at ximian.com</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] [PATCH] Optimize Encoding.GetByteCount
</I>&gt;<i>To: Alan McGovern &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">alan.mcgovern at gmail.com</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">453FDEDA.70306 at ximian.com</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>Well, the point of the Ben's question is, compacting GC is likely to
</I>&gt;<i>store array in nursery area (likely, since it could be regarded too
</I>&gt;<i>big to store in nursery area), so nursery allocation and releasing
</I>&gt;<i>might become faster than fixing string pointer which might slowdown GC.
</I>&gt;<i>
</I>&gt;<i>(That's why BenM asked Paolo, as only he would know the best answer ;-)
</I>&gt;<i>
</I>&gt;<i>Atsushi Eno
</I>&gt;<i>
</I>&gt;<i>Alan McGovern wrote:
</I>&gt;&gt;&gt;<i> To my understanding, fixed pointers do not participate GC target. And
</I>&gt;&gt;&gt;<i> - locally-allocated array anyways lives until its conversion finishes
</I>&gt;&gt;&gt;<i> (and probably immediately disposed depending on the JIT optimization)
</I>&gt;&gt;&gt;<i> - Usually this conversion do not take long time
</I>&gt;&gt;&gt;<i> So I guess fixed pointer would work better than possibly being moved
</I>&gt;&gt;&gt;<i> from nursery area.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> It's better to not allocate a new array if it can be avoided. From my own
</I>&gt;&gt;<i> code i found that in one of my intensively used methods i allocated a
</I>&gt;&gt;<i> 100byte array each time the method was called. By moving that variable
</I>&gt;&gt;<i> outside the method and just reinitialising it each time i used it (with
</I>&gt;&gt;<i> appropriate locking) memory usage reduced by a large %. Don't rely on 
</I>&gt;&gt;<i> the GC
</I>&gt;&gt;<i> to tidy up your mess if you can avoid creating it in the first place :p
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 9
</I>&gt;<i>Date: Wed, 25 Oct 2006 20:53:04 -0400
</I>&gt;<i>From: Miguel de Icaza &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">miguel at ximian.com</A>&gt;
</I>&gt;<i>Subject: Re: [Mono-dev] Managed DirectX
</I>&gt;<i>To: Stefan D?singer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">stefandoesinger at gmx.at</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">1161823984.5109.26.camel at erandi.dom</A>&gt;
</I>&gt;<i>Content-Type: text/plain
</I>&gt;<i>
</I>&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;&gt;<i> I am one of the programmers of the Wine Direct3D implementation, and I 
</I>&gt;&gt;<i> wondered if there are any plans to implement Managed DirectX in Mono, and if 
</I>&gt;&gt;<i> it is possible to share efforts between wine and mono?
</I>&gt;<i>
</I>&gt;<i>This would be fantastic.
</I>&gt;<i>
</I>&gt;&gt;<i> This is basically what the wine direct3d code looks like: We have 3 libraries 
</I>&gt;&gt;<i> for the various dx versions, ddraw.dll, d3d8.dll and d3d9.dll. Plans are 
</I>&gt;&gt;<i> going on for a d3d10.dll. Those libraries offer a binary and source 
</I>&gt;&gt;<i> compatible interface to Microsoft's Direct3D user mode interface. We do not 
</I>&gt;&gt;<i> implement the kernel-side DDI or gdientry/ddentry interface and we do not 
</I>&gt;&gt;<i> plan to do that.
</I>&gt;<i>
</I>&gt;<i>Does the library depend on the rest of Wine to run?
</I>&gt;<i>
</I>&gt;<i>Am curious if it is possible to write a C program that can just call
</I>&gt;<i>into these libraries directly?
</I>&gt;<i>
</I>&gt;<i>I mention this because Mono would be accessing the libraries by
</I>&gt;<i>dlopening them, looking up the addresses of methods with dlsym and
</I>&gt;<i>calling them.
</I>&gt;<i>
</I>&gt;<i>And the question is whether this means that we need to run side-by-side
</I>&gt;<i>with the Wine runtime, as that is currently not possible with Mono.
</I>&gt;<i>
</I>&gt;<i>Miguel.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 10
</I>&gt;<i>Date: Wed, 25 Oct 2006 20:22:32 -0700
</I>&gt;<i>From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">allan at counterpop.net</A> (Allan Hsu)
</I>&gt;<i>Subject: [Mono-dev] [PATCH] OS X MACHINE_THREAD_STATE patch for newer
</I>&gt;<i>	10.4u	SDK
</I>&gt;<i>To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>Message-ID: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">20061026032232.GA14592 at daybreaker.counterpop.net</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=&quot;us-ascii&quot;
</I>&gt;<i>
</I>&gt;<i>This patch fixes problems with building mono for i386 using the new
</I>&gt;<i>10.4u SDK that ships with Xcode 2.4. Current SVN builds for i386 under
</I>&gt;<i>the new SDK, but does not run properly due to changes in
</I>&gt;<i>MACHINE_THREAD_STATE. It looks like the breakage in source compatibility
</I>&gt;<i>is intentional on Apple's part and future headers will be similarly
</I>&gt;<i>broken.
</I>&gt;<i>
</I>&gt;<i>I will be submitting the same patch to libgc upstream.
</I>&gt;<i>
</I>&gt;<i>	-Allan
</I>&gt;<i>-- 
</I>&gt;<i>Allan Hsu &lt;allan at counterpop dot net&gt;
</I>&gt;<i>1E64 E20F 34D9 CBA7 1300 1457 AC37 CBBB 0E92 C779
</I>&gt;<i>-------------- next part --------------
</I>&gt;<i>Index: libgc/darwin_stop_world.c
</I>&gt;<i>===================================================================
</I>&gt;<i>--- libgc/darwin_stop_world.c	(revision 66738)
</I>&gt;<i>+++ libgc/darwin_stop_world.c	(working copy)
</I>&gt;<i>@@ -75,12 +75,14 @@
</I>&gt;<i> ptr_t lo, hi;
</I>&gt;<i> #if defined(POWERPC)
</I>&gt;<i> ppc_thread_state_t state;
</I>&gt;<i>+ mach_msg_type_number_t thread_state_count = PPC_THREAD_STATE_COUNT;
</I>&gt;<i> #elif defined(I386)
</I>&gt;<i> i386_thread_state_t state;
</I>&gt;<i>+ mach_msg_type_number_t thread_state_count = i386_THREAD_STATE_COUNT;
</I>&gt;<i> #else
</I>&gt;<i> # error FIXME for non-x86 || ppc architectures
</I>&gt;<i>+ mach_msg_type_number_t thread_state_count = MACHINE_THREAD_STATE_COUNT;
</I>&gt;<i> #endif
</I>&gt;<i>- mach_msg_type_number_t thread_state_count = MACHINE_THREAD_STATE_COUNT;
</I>&gt;<i> 
</I>&gt;<i> me = pthread_self();
</I>&gt;<i> if (!GC_thr_initialized) GC_thr_init();
</I>&gt;<i>@@ -94,7 +96,7 @@
</I>&gt;<i> /* Get the thread state (registers, etc) */
</I>&gt;<i> r = thread_get_state(
</I>&gt;<i> p-&gt;stop_info.mach_thread,
</I>&gt;<i>-	MACHINE_THREAD_STATE,
</I>&gt;<i>+	GC_MACH_THREAD_STATE_FLAVOR,
</I>&gt;<i> (natural_t*)&amp;state,
</I>&gt;<i> &amp;thread_state_count);
</I>&gt;<i> if(r != KERN_SUCCESS) ABORT(&quot;thread_get_state failed&quot;);
</I>&gt;<i>@@ -193,7 +195,7 @@
</I>&gt;<i> ppc_thread_state64_t info;
</I>&gt;<i> # endif
</I>&gt;<i> mach_msg_type_number_t outCount = THREAD_STATE_MAX;
</I>&gt;<i>-	r = thread_get_state(thread, MACHINE_THREAD_STATE,
</I>&gt;<i>+	r = thread_get_state(thread, GC_MACH_THREAD_STATE_FLAVOR,
</I>&gt;<i> (natural_t *)&amp;info, &amp;outCount);
</I>&gt;<i> if(r != KERN_SUCCESS) continue;
</I>&gt;<i> 
</I>&gt;<i>@@ -236,7 +238,7 @@
</I>&gt;<i> WARN(&quot;This is completely untested and likely will not work\n&quot;, 0);
</I>&gt;<i> i386_thread_state_t info;
</I>&gt;<i> mach_msg_type_number_t outCount = THREAD_STATE_MAX;
</I>&gt;<i>-	r = thread_get_state(thread, MACHINE_THREAD_STATE,
</I>&gt;<i>+	r = thread_get_state(thread, GC_MACH_THREAD_STATE_FLAVOR,
</I>&gt;<i> (natural_t *)&amp;info, &amp;outCount);
</I>&gt;<i> if(r != KERN_SUCCESS) continue;
</I>&gt;<i> 
</I>&gt;<i>Index: libgc/include/private/gc_priv.h
</I>&gt;<i>===================================================================
</I>&gt;<i>--- libgc/include/private/gc_priv.h	(revision 66738)
</I>&gt;<i>+++ libgc/include/private/gc_priv.h	(working copy)
</I>&gt;<i>@@ -366,6 +366,16 @@
</I>&gt;<i> # define BZERO(x,n) bzero((char *)(x),(int)(n))
</I>&gt;<i> # endif
</I>&gt;<i> 
</I>&gt;<i>+#if defined(DARWIN)
</I>&gt;<i>+#	if defined(POWERPC)
</I>&gt;<i>+#	define GC_MACH_THREAD_STATE_FLAVOR PPC_THREAD_STATE
</I>&gt;<i>+#	elif defined(I386)
</I>&gt;<i>+#	define GC_MACH_THREAD_STATE_FLAVOR i386_THREAD_STATE
</I>&gt;<i>+#	else
</I>&gt;<i>+#	define GC_MACH_THREAD_STATE_FLAVOR MACHINE_THREAD_STATE
</I>&gt;<i>+#	endif
</I>&gt;<i>+#endif
</I>&gt;<i>+
</I>&gt;<i> /* Delay any interrupts or signals that may abort this thread. Data	*/
</I>&gt;<i> /* structures are in a consistent state outside this pair of calls.	*/
</I>&gt;<i> /* ANSI C allows both to be empty (though the standard isn't very	*/
</I>&gt;<i>Index: libgc/os_dep.c
</I>&gt;<i>===================================================================
</I>&gt;<i>--- libgc/os_dep.c	(revision 66738)
</I>&gt;<i>+++ libgc/os_dep.c	(working copy)
</I>&gt;<i>@@ -3702,7 +3702,7 @@
</I>&gt;<i> mask,
</I>&gt;<i> GC_ports.exception,
</I>&gt;<i> EXCEPTION_DEFAULT,
</I>&gt;<i>- MACHINE_THREAD_STATE
</I>&gt;<i>+ GC_MACH_THREAD_STATE_FLAVOR
</I>&gt;<i> );
</I>&gt;<i> if(r != KERN_SUCCESS) ABORT(&quot;task_set_exception_ports failed&quot;);
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-devel-list mailing list
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>End of Mono-devel-list Digest, Vol 18, Issue 62
</I>&gt;<i>***********************************************
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061026/610c113e/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061026/610c113e/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021106.html">[Mono-dev] [PATCH] OS X MACHINE_THREAD_STATE patch for newer 10.4u	SDK
</A></li>
	<LI>Next message: <A HREF="021109.html">[Mono-dev] Mono Meeting slides are now available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21107">[ date ]</a>
              <a href="thread.html#21107">[ thread ]</a>
              <a href="subject.html#21107">[ subject ]</a>
              <a href="author.html#21107">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
