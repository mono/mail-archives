<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] VBNC uses too much CPU and RAM on Mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20VBNC%20uses%20too%20much%20CPU%20and%20RAM%20on%20Mono&In-Reply-To=001f01c6fd0a%245837a5a0%240100a8c0%40kornelpal.hu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021213.html">
   <LINK REL="Next"  HREF="021206.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] VBNC uses too much CPU and RAM on Mono</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20VBNC%20uses%20too%20much%20CPU%20and%20RAM%20on%20Mono&In-Reply-To=001f01c6fd0a%245837a5a0%240100a8c0%40kornelpal.hu"
       TITLE="[Mono-dev] VBNC uses too much CPU and RAM on Mono">lupus at ximian.com
       </A><BR>
    <I>Tue Oct 31 14:32:32 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021213.html">[Mono-dev] Type not found when IConfigurationSectionHandler in bin
</A></li>
        <LI>Next message: <A HREF="021206.html">[Mono-dev] VBNC uses too much CPU and RAM on Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21205">[ date ]</a>
              <a href="thread.html#21205">[ thread ]</a>
              <a href="subject.html#21205">[ subject ]</a>
              <a href="author.html#21205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[Not approving the 700KB mail message to the list, just replying to some
comments here]

On 10/31/06 Korn&#233;l P&#225;l wrote:
&gt;<i> &gt;Does the code properly dispose the file strem objects as sson as
</I>&gt;<i> &gt;tokenization is done?
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://svn.myrealbox.com/viewcvs/trunk/vbnc/vbnc/source/General/CodeFile.vb?rev=64447&amp;view=markup">http://svn.myrealbox.com/viewcvs/trunk/vbnc/vbnc/source/General/CodeFile.vb?rev=64447&amp;view=markup</A>
</I>&gt;<i> 
</I>&gt;<i> The entire file is read and then is stored as a string. (This was the same
</I>&gt;<i> before my UTF-8 detection patch.)
</I>
It looks like the file is closed on finally, so that's good.
It seems also that the token list is kept just while a single file is
parsed, so that should not be too bad. What is worrying is that it seems
the list is also used as an array, with indexing by integer and this may
have a significant impact on performance.
gain, we can't tell for sure until someone provides a sample program as
requested.

&gt;<i> &gt;Anyway, it would be better to have the binaries and sample programs so
</I>&gt;<i> &gt;that we can actually profile on linux and see where time is actually
</I>&gt;<i> &gt;spent instead of guessing. The token list might be a problem, but it
</I>&gt;<i> &gt;might also be a tiny part of the whole picture.
</I>&gt;<i> 
</I>&gt;<i> Is that a problem if the compilation cannot complete? Currently vbnc is able
</I>&gt;<i> to finish the resolve phase on Mono when bootstrapping and fails in early
</I>&gt;<i> define phase.
</I>
How much time does it take to complete the resolve phase? I thought that
was the issue given this thread subject. If there are other issues, they
should be discussed in another thread.
And yes, it is a problem if it makes the compiler so slow to be unusable
as you claim it is.

&gt;<i> You need Mono SVN HEAD. Microsoft.VisualBasic.dll can be used from Mono
</I>&gt;<i> 1.1.18 installer. And you need the corlib/runtime patch in
</I>&gt;<i> <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/2006-October/021093.html">http://lists.ximian.com/pipermail/mono-devel-list/2006-October/021093.html</A>
</I>&gt;<i> in order to finish resolve phase.
</I>&gt;<i> 
</I>&gt;<i> After resolve phase I have no experience because it takes too long time to
</I>&gt;<i> finish resolve and that makes quite impossible to debug the define phase on
</I>&gt;<i> Mono.
</I>
This is why I requested a sample program that can compile, instead of
trying to profile a program that never finishes.
When someone posts that we can start to profile, so far nobody did,
I guess we have to wait for some vb programmers to show up.

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021213.html">[Mono-dev] Type not found when IConfigurationSectionHandler in bin
</A></li>
	<LI>Next message: <A HREF="021206.html">[Mono-dev] VBNC uses too much CPU and RAM on Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21205">[ date ]</a>
              <a href="thread.html#21205">[ thread ]</a>
              <a href="subject.html#21205">[ subject ]</a>
              <a href="author.html#21205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
