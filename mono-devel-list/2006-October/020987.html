<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Fwd: Tests for System.Data.OracleClient
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Fwd%3A%20Tests%20for%20System.Data.OracleClient&In-Reply-To=23a15590610170640u1ad9872fp45f885f52fbc132d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020989.html">
   <LINK REL="Next"  HREF="020990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Fwd: Tests for System.Data.OracleClient</H1>
    <B>Konstantin Triger</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Fwd%3A%20Tests%20for%20System.Data.OracleClient&In-Reply-To=23a15590610170640u1ad9872fp45f885f52fbc132d%40mail.gmail.com"
       TITLE="[Mono-dev] Fwd: Tests for System.Data.OracleClient">kostat at mainsoft.com
       </A><BR>
    <I>Tue Oct 17 10:13:42 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020989.html">[Mono-dev] Fwd: Tests for System.Data.OracleClient
</A></li>
        <LI>Next message: <A HREF="020990.html">[Mono-dev] System.Data.OracleClient in Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20987">[ date ]</a>
              <a href="thread.html#20987">[ thread ]</a>
              <a href="subject.html#20987">[ subject ]</a>
              <a href="author.html#20987">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Could you explain to me why sometimes JVM specific code is included
</I>&gt;<i> through TARGET_JVM and sometimes it is placed in separate files? In
</I>&gt;<i> OracleClient this seems to cause some functionality to work only in
</I>&gt;<i> JVM, while sharing the code would bring fixes to other profiles. Would
</I>&gt;<i> such a merge be possible? And if yes, what would be the caveats?
</I>
When the code is shared between the java and non java profiles the JVM specific code is included through TARGET_JVM (or TARGET_J2EE). When the entire file is used only by the java profile it is postfixed with .jvm and placed in a separate file.

In cases when a separate file is used, usually, code sharing is practically impossible, because a java specific API is used. Probably the only exception is a System.Data.XXX connected mode tests, where sharing is possible, but historically was not done because &quot;someone was required to configure a database&quot; to run the tests. So all the data with readmes, sql scripts etc was put in svn waiting for someone to use it.

I think that such a merge is possible and very desirable. The caveats are probably bugs, since some of our tests are really sadistic.
 
Regards,
Konstantin Triger

-----Original Message-----
From: Leszek Ciesielski [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">skolima at gmail.com</A>] 
Sent: Tuesday, October 17, 2006 3:40 PM
To: Konstantin Triger; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Cc: Noam Lampert; Miguel de Icaza
Subject: Re: [Mono-dev] Fwd: Tests for System.Data.OracleClient

On 10/17/06, Konstantin Triger &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kostat at mainsoft.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> All the changes including DataProvider are fine. Feel free to commit.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Kosta
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Leszek Ciesielski [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">skolima at gmail.com</A>]
</I>&gt;<i> Sent: Tuesday, October 17, 2006 1:17 PM
</I>&gt;<i> To: Konstantin Triger
</I>&gt;<i> Subject: Re: [Mono-dev] Fwd: Tests for System.Data.OracleClient
</I>&gt;<i>
</I>&gt;<i> On 10/17/06, Leszek Ciesielski &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">skolima at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; On 10/17/06, Konstantin Triger &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kostat at mainsoft.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; Sure, any questions regarding java profile.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Regards,
</I>&gt;<i> &gt; &gt; Konstantin Triger
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] On Behalf Of Leszek Ciesielski
</I>&gt;<i> &gt; &gt; Sent: Tuesday, October 17, 2006 12:26 PM
</I>&gt;<i> &gt; &gt; To: Konstantin Triger
</I>&gt;<i> &gt; &gt; Cc: Noam Lampert; Miguel de Icaza; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; Subject: Re: [Mono-dev] Fwd: Tests for System.Data.OracleClient
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I will make this conditional, as I should probably from the start...
</I>&gt;<i> &gt; &gt; Can I contact you with further questions I have about the tests?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; On 10/17/06, Konstantin Triger &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kostat at mainsoft.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; Hello Leszek,
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; The tests under jvm folder fully pass in java and .Net (except those which were marked as not working up to revision 66739). So the failures are bugs in the OracleClient implementation.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Please either revert the commit marking additional tests as 'NotWorking' or make it conditional, i.e:
</I>&gt;<i> &gt; &gt; &gt; #if !TARGET_JVM
</I>&gt;<i> &gt; &gt; &gt;         [Category(&quot;NotWorking&quot;)]
</I>&gt;<i> &gt; &gt; &gt; #endif
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Please be very careful in excluding tests from the testsuite since they are part of our harness. Contact me if you have any additional questions.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Regards,
</I>&gt;<i> &gt; &gt; &gt; Konstantin Triger
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; &gt; From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] On Behalf Of Leszek Ciesielski
</I>&gt;<i> &gt; &gt; &gt; Sent: Saturday, October 14, 2006 7:44 PM
</I>&gt;<i> &gt; &gt; &gt; To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; &gt; Subject: [Mono-dev] Fwd: Tests for System.Data.OracleClient
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; On 9/25/06, Boris Kirzner &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">borisk at mainsoft.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; Hello Leszek
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; The tests are regular NUnit test suite, so you should not have any
</I>&gt;<i> &gt; &gt; &gt; &gt; problem running it just by adding the files to test sources file.
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Boris
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; &gt; &gt; From: Leszek Ciesielski [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">skolima at gmail.com</A>]
</I>&gt;<i> &gt; &gt; &gt; &gt; Sent: Wednesday, September 13, 2006 11:34
</I>&gt;<i> &gt; &gt; &gt; &gt; To: Boris Kirzner
</I>&gt;<i> &gt; &gt; &gt; &gt; Subject: Tests for System.Data.OracleClient
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Hi,
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; it seems to me you have maintained the jvm tests for quite a long
</I>&gt;<i> &gt; &gt; &gt; &gt; time. Would it be possible to rewrite the way they are launched and
</I>&gt;<i> &gt; &gt; &gt; &gt; incorporate them into main mcs testing path?
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Leszek Ciesielski
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Hi Mono,
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I have incorporated the tests from System.Data.Oracle.jvm into testing
</I>&gt;<i> &gt; &gt; &gt; of 'regular' OracleClient. There are hiccups, however: some tests
</I>&gt;<i> &gt; &gt; &gt; fail, some timeout while finalizing the tests domain, and some
</I>&gt;<i> &gt; &gt; &gt; segfault. I've marked those that time out or end with a segfault as
</I>&gt;<i> &gt; &gt; &gt; NotWorking, so they are not run. What should I do with those that
</I>&gt;<i> &gt; &gt; &gt; fail? For now, they are executed.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Boris: many (almost 50% , when counting the segfaulting and timeouting
</I>&gt;<i> &gt; &gt; &gt; ones) of test fail. Was this expected? Or maybe this is fault of them
</I>&gt;<i> &gt; &gt; &gt; being meant for jvm, or I messed something up?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; What bothers me the most is that some of the segfaults are
</I>&gt;<i> &gt; &gt; &gt; nondeterministic - they seem to depend on the order the test are run,
</I>&gt;<i> &gt; &gt; &gt; or some other random factor...
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Question to the list: should/can I commit this addition?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ok, I have conditional ignoring ready to commit. There's also a small
</I>&gt;<i> &gt; fix for TearDown in two tests - they did break when Assert.Ignore was
</I>&gt;<i> &gt; called during test.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Two questions:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Is it ok to commit? (I guess #if's are, but what about change to tests?)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Is my change in ConnectedDataProvider ok? (It was submitted earlier.
</I>&gt;<i> &gt; When connectionstring is requested I check if it is set in config, and
</I>&gt;<i> &gt; if not, call Assert.Ignore, as this means that the user did not
</I>&gt;<i> &gt; prepare the database for tests.)
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> My mistake, forgot the diff file.
</I>
Fixed. Sorry for your trouble.

Could you explain to me why sometimes JVM specific code is included
through TARGET_JVM and sometimes it is placed in separate files? In
OracleClient this seems to cause some functionality to work only in
JVM, while sharing the code would bring fixes to other profiles. Would
such a merge be possible? And if yes, what would be the caveats?

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020989.html">[Mono-dev] Fwd: Tests for System.Data.OracleClient
</A></li>
	<LI>Next message: <A HREF="020990.html">[Mono-dev] System.Data.OracleClient in Mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20987">[ date ]</a>
              <a href="thread.html#20987">[ thread ]</a>
              <a href="subject.html#20987">[ subject ]</a>
              <a href="author.html#20987">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
