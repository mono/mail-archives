<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Trying to use uno binding for mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Trying%20to%20use%20uno%20binding%20for%20mono&In-Reply-To=1161004153.10005.3.camel%40hublinux.fidudev.fr">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020958.html">
   <LINK REL="Next"  HREF="020985.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Trying to use uno binding for mono</H1>
    <B>Daniel Morgan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Trying%20to%20use%20uno%20binding%20for%20mono&In-Reply-To=1161004153.10005.3.camel%40hublinux.fidudev.fr"
       TITLE="[Mono-dev] Trying to use uno binding for mono">monodanmorg at yahoo.com
       </A><BR>
    <I>Mon Oct 16 15:54:22 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020958.html">[Mono-dev] Trying to use uno binding for mono
</A></li>
        <LI>Next message: <A HREF="020985.html">[Mono-dev] Trying to use uno binding for mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20962">[ date ]</a>
              <a href="thread.html#20962">[ thread ]</a>
              <a href="subject.html#20962">[ subject ]</a>
              <a href="author.html#20962">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You will not get much replies on the mono lists.  Try
the OpenOffice.org Ximian Edition mailing list.  

<A HREF="http://lists.ximian.com/mailman/listinfo/openoffice">http://lists.ximian.com/mailman/listinfo/openoffice</A>

As far as I know, the UNO Bridge for the CLI only
works on .NET/Windows.  You need a special UNO Bridge
for Mono which is only available via the ooo-build
680.  If you have Suse Linux 10, you may already have
it.  Other distros do not have it unless you build it
from your distros source of oo.  Vanilla oo source
from upstream may not have it.

Also, it may help to join IRC channels #go-oo and
#openoffice.org at irc.freenode.net.

Michael Meeks maybe able to help you.

I've tried using the CLI Bridge with Mono and it fails
for me too on Windows.  This is a shame since the only
way we are going to go to OpenOffice.org is if we get
all our .net code working on it.

Currently, Managed C++ is used to build the CLI
Bridge.  Michael Meeks suggested to re-write the
Mono/CLI Bridge to emit IL on-the-fly.  Maybe
Mono.Cecil could be used to do this.  Or CodeDom or
Reflection.Emit.

Zoltan has gotten Mono to work with the Mono Bridge in
the past.  I wonder if he could provide any ideas.

And Jonathon Chambers has added code to Mono for COM
Interop and is researching on how to get Mozilla XPCOM
to interop as well.  He maybe to provide insights into
getting Mono to interop with UNO.

Martin Kretzschmar was the original programmer who
created the Mono Bridge.


--- Hubert FONGARNAND
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">informatique.internet at fiducial.fr</A>&gt; wrote:

&gt;<i> I've installed UNO bindings for C#/mono on my dev
</I>&gt;<i> machine...
</I>&gt;<i> 
</I>&gt;<i> When i try to run this 
</I>&gt;<i> 		public static void Main(string[] args)
</I>&gt;<i> 		{
</I>&gt;<i> 			Console.WriteLine(&quot;Hello World!&quot;);
</I>&gt;<i> 			MainClass main=new MainClass();
</I>&gt;<i> 			main.Run();
</I>&gt;<i> 
</I>&gt;<i> 		}
</I>&gt;<i> 		
</I>&gt;<i> 		private void Run()
</I>&gt;<i> 		{
</I>&gt;<i> 						mxMSFactory = connect();
</I>&gt;<i> 			
</I>&gt;<i>          // Create a new spreadsheet document
</I>&gt;<i>          mxDocument = initDocument();
</I>&gt;<i> 		}
</I>&gt;<i> 		
</I>&gt;<i> 		
</I>&gt;<i> 	   private XMultiServiceFactory connect( )
</I>&gt;<i>       {
</I>&gt;<i>          
</I>&gt;<i>          m_xContext =
</I>&gt;<i> uno.util.Bootstrap.bootstrap();
</I>&gt;<i>          
</I>&gt;<i>          return (XMultiServiceFactory)
</I>&gt;<i> m_xContext.getServiceManager();
</I>&gt;<i>       }
</I>&gt;<i> 
</I>&gt;<i> I get:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>
</I>=================================================================
&gt;<i> Got a SIGSEGV while executing native code. This
</I>&gt;<i> usually indicates
</I>&gt;<i> a fatal error in the mono runtime or one of the
</I>&gt;<i> native libraries
</I>&gt;<i> used by your application.
</I>&gt;<i>
</I>=================================================================
&gt;<i> 
</I>&gt;<i> Stacktrace:
</I>&gt;<i> 
</I>&gt;<i>   at (wrapper managed-to-native)
</I>&gt;<i> uno.util.Bootstrap.native_bootstrap ()
</I>&gt;<i> &lt;0x00004&gt;
</I>&gt;<i>   at (wrapper managed-to-native)
</I>&gt;<i> uno.util.Bootstrap.native_bootstrap ()
</I>&gt;<i> &lt;0xffffffff&gt;
</I>&gt;<i>   at uno.util.Bootstrap.bootstrap () &lt;0x0000d&gt;
</I>&gt;<i>   at testoo.MainClass.connect () &lt;0x00012&gt;
</I>&gt;<i>   at testoo.MainClass.Run () &lt;0x00012&gt;
</I>&gt;<i>   at testoo.MainClass.Main (string[]) &lt;0x00036&gt;
</I>&gt;<i>   at (wrapper runtime-invoke)
</I>&gt;<i> System.Object.runtime_invoke_void_string[]
</I>&gt;<i> (object,intptr,intptr,intptr) &lt;0xffffffff&gt;
</I>&gt;<i> 
</I>&gt;<i> Native stacktrace:
</I>&gt;<i> 
</I>&gt;<i>         mono [0x8162486]
</I>&gt;<i>         mono [0x814c2a3]
</I>&gt;<i>         [0xb7f62440]
</I>&gt;<i>        
</I>&gt;<i>
</I>/usr/lib/openoffice/program/libcli_uno.so(uno_ext_getMapping
&gt;<i> +0xee) [0xb3f4307e]
</I>&gt;<i>         /usr/lib/openoffice/program/libuno_cppu.so.3
</I>&gt;<i> [0xb6fbf634]
</I>&gt;<i>         /usr/lib/openoffice/program/libuno_cppu.so.3
</I>&gt;<i> [0xb6fbfbb4]
</I>&gt;<i>         /usr/lib/openoffice/program/libuno_cppu.so.3
</I>&gt;<i> [0xb6fbfdac]
</I>&gt;<i>        
</I>&gt;<i>
</I>/usr/lib/openoffice/program/libuno_cppu.so.3(uno_getMapping
&gt;<i> +0x68c) [0xb6fc0938]
</I>&gt;<i>        
</I>&gt;<i>
</I>/usr/lib/openoffice/program/libuno_cppu.so.3(uno_getMappingByName+0x98)
&gt;<i> [0xb6fc0abc]
</I>&gt;<i>        
</I>&gt;<i> /usr/lib/openoffice/program/libcli_uno_glue.so
</I>&gt;<i> [0xb79f27c4]
</I>&gt;<i>        
</I>&gt;<i> /usr/lib/openoffice/program/libcli_uno_glue.so
</I>&gt;<i> [0xb79f235a]
</I>&gt;<i>        
</I>&gt;<i>
</I>/usr/lib/openoffice/program/libcli_uno_glue.so(native_bootstrap
&gt;<i> +0x26) [0xb79f2420]
</I>&gt;<i>         [0xb79fd261]
</I>&gt;<i>         [0xb79fd166]
</I>&gt;<i>         [0xb79fd08b]
</I>&gt;<i>         [0xb79fd03b]
</I>&gt;<i>         [0xb79f7877]
</I>&gt;<i>         [0xb79f77c3]
</I>&gt;<i>         mono(mono_runtime_exec_main+0x60)
</I>&gt;<i> [0x80d6730]
</I>&gt;<i>         mono(mono_runtime_run_main+0x21f)
</I>&gt;<i> [0x80d6a9f]
</I>&gt;<i>         mono(mono_main+0xf17) [0x8058d77]
</I>&gt;<i>         mono [0x805797e]
</I>&gt;<i>         /lib/libc.so.6(__libc_start_main+0xe6)
</I>&gt;<i> [0xb7d56866]
</I>&gt;<i>         mono(dl_iterate_phdr+0x191) [0x80578c1]
</I>&gt;<i> 
</I>&gt;<i> Debug info from gdb:
</I>&gt;<i> 
</I>&gt;<i> Using host libthread_db library
</I>&gt;<i> &quot;/lib/libthread_db.so.1&quot;.
</I>&gt;<i> [Thread debugging using libthread_db enabled]
</I>&gt;<i> [New Thread -1210882368 (LWP 11059)]
</I>&gt;<i> [New Thread -1267319904 (LWP 11485)]
</I>&gt;<i> [New Thread -1258861664 (LWP 11483)]
</I>&gt;<i> [New Thread -1249965152 (LWP 11063)]
</I>&gt;<i> [New Thread -1229464672 (LWP 11062)]
</I>&gt;<i> [New Thread -1221407840 (LWP 11061)]
</I>&gt;<i> [New Thread -1221391456 (LWP 11060)]
</I>&gt;<i> 0xb7f62410 in ?? ()
</I>&gt;<i>   7 Thread -1221391456 (LWP 11060)  0xb7f62410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   6 Thread -1221407840 (LWP 11061)  0xb7f62410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   5 Thread -1229464672 (LWP 11062)  0xb7f62410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   4 Thread -1249965152 (LWP 11063)  0xb7f62410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   3 Thread -1258861664 (LWP 11483)  0xb7f62410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   2 Thread -1267319904 (LWP 11485)  0xb7f62410 in ??
</I>&gt;<i> ()
</I>&gt;<i>   1 Thread -1210882368 (LWP 11059)  0xb7f62410 in ??
</I>&gt;<i> ()
</I>&gt;<i> 
</I>&gt;<i> Thread 7 (Thread -1221391456 (LWP 11060)):
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> #1  0xb7330438 in ?? ()
</I>&gt;<i> #2  0x081f0358 in ?? ()
</I>&gt;<i> #3  0x00000000 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Thread 6 (Thread -1221407840 (LWP 11061)):
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> #1  0xb732c238 in ?? ()
</I>&gt;<i> #2  0x00000001 in ?? ()
</I>&gt;<i> #3  0x00000000 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Thread 5 (Thread -1229464672 (LWP 11062)):
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> #1  0xb6b7d41c in ?? ()
</I>&gt;<i> #2  0x00000001 in ?? ()
</I>&gt;<i> #3  0x00000000 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Thread 4 (Thread -1249965152 (LWP 11063)):
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> #1  0xb57f0400 in ?? ()
</I>&gt;<i> #2  0x00000000 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Thread 3 (Thread -1258861664 (LWP 11483)):
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> #1  0xb4f7438c in ?? ()
</I>&gt;<i> #2  0x00000003 in ?? ()
</I>&gt;<i> #3  0x00000000 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Thread 2 (Thread -1267319904 (LWP 11485)):
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> #1  0xb47631a8 in ?? ()
</I>&gt;<i> #2  0xb718c0dc in ?? () from
</I>&gt;<i> /usr/lib/openoffice/program/libuno_sal.so.3
</I>&gt;<i> #3  0xb4763194 in ?? ()
</I>&gt;<i> #4  0xb7e89e78 in recv () from /lib/libpthread.so.0
</I>&gt;<i> #5  0xb6ff8363 in osl_receivePipe ()
</I>&gt;<i>    from /usr/lib/openoffice/program/libuno_sal.so.3
</I>&gt;<i> #6  0xb6ff8464 in osl_readPipe ()
</I>&gt;<i>    from /usr/lib/openoffice/program/libuno_sal.so.3
</I>&gt;<i> #7  0xb4fe34fa in component_getFactory ()
</I>&gt;<i>    from /usr/lib/openoffice/program/connector.uno.so
</I>&gt;<i> #8  0xb4fbd3b2 in component_getFactory ()
</I>&gt;<i>    from
</I>&gt;<i> /usr/lib/openoffice/program/remotebridge.uno.so
</I>&gt;<i> #9  0xb4fa5a55 in component_canUnload ()
</I>&gt;<i>    from /usr/lib/openoffice/program/liburp_uno.so
</I>&gt;<i> #10 0xb4fa34d0 in component_canUnload ()
</I>&gt;<i>    from /usr/lib/openoffice/program/liburp_uno.so
</I>&gt;<i> #11 0xb4f99885 in component_canUnload ()
</I>&gt;<i>    from /usr/lib/openoffice/program/liburp_uno.so
</I>&gt;<i> #12 0xb6ff07d3 in osl_yieldThread ()
</I>&gt;<i>    from /usr/lib/openoffice/program/libuno_sal.so.3
</I>&gt;<i> #13 0xb7e84512 in start_thread () from
</I>&gt;<i> /lib/libpthread.so.0
</I>&gt;<i> #14 0xb7df9fce in clone () from /lib/libc.so.6
</I>&gt;<i> 
</I>&gt;<i> Thread 1 (Thread -1210882368 (LWP 11059)):
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> #1  0xbfd2dff8 in ?? ()
</I>&gt;<i> #2  0x00000000 in ?? ()
</I>&gt;<i> #0  0xb7f62410 in ?? ()
</I>&gt;<i> 
</I>&gt;<i> Abandon
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Does these bindings are known to work with mono
</I>&gt;<i> 1.1.18?
</I>&gt;<i> 
</I>=== message truncated ===&gt;
_______________________________________________
&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>
</I><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
&gt;<i> 
</I>

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
<A HREF="http://mail.yahoo.com">http://mail.yahoo.com</A> 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020958.html">[Mono-dev] Trying to use uno binding for mono
</A></li>
	<LI>Next message: <A HREF="020985.html">[Mono-dev] Trying to use uno binding for mono
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20962">[ date ]</a>
              <a href="thread.html#20962">[ thread ]</a>
              <a href="subject.html#20962">[ subject ]</a>
              <a href="author.html#20962">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
