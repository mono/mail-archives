<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Parameter names and class status
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Parameter%20names%20and%20class%20status&In-Reply-To=002d01c6f448%24fea5f6f0%240100a8c0%40kornelpal.hu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021044.html">
   <LINK REL="Next"  HREF="021054.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Parameter names and class status</H1>
    <B>Leszek Ciesielski</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Parameter%20names%20and%20class%20status&In-Reply-To=002d01c6f448%24fea5f6f0%240100a8c0%40kornelpal.hu"
       TITLE="[Mono-dev] Parameter names and class status">skolima at gmail.com
       </A><BR>
    <I>Fri Oct 20 16:44:13 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021044.html">[Mono-dev] Parameter names and class status
</A></li>
        <LI>Next message: <A HREF="021054.html">[Mono-dev] Parameter names and class status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21052">[ date ]</a>
              <a href="thread.html#21052">[ thread ]</a>
              <a href="subject.html#21052">[ subject ]</a>
              <a href="author.html#21052">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/20/06, Korn&#233;l P&#225;l &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt; wrote:
&gt;<i> &gt; Though I really want to use passing by name, I'm not convinced
</I>&gt;<i> &gt; it's a good idea.
</I>
OK. The patch I submitted in the beginning works, I've just tested it
on Microsoft.Build.Tasks. The glitch is that it requires regenerating
the masterfiles (without this, every method with parameters is
reported as an error). And I was unable to test the whole Class Status
page, because this procedure :
<A HREF="http://www.mono-project.com/Class_Status">http://www.mono-project.com/Class_Status</A> aborts with
no rules to make 'src/class-status-Microsoft.VisualBasic.src' required
by 'deploy/ado-net.html'.
I generated a per-assembly status following this guide:
<A HREF="http://www.mono-project.com/Generating_class_status_pages">http://www.mono-project.com/Generating_class_status_pages</A>

As to the number of differences: as I said, I could not generate the
whole status page. In the assembly I tested, there was one new
inconsistency uncovered, which bodes well for the code in general.

After I read what Korn&#233;l P&#225;l wrote about public metadata, I made
another change to the corcompare/class-status generation feature.
Class status used to check whether attributes match, I extended it to
check if the values of the attributes match. Sometimes the differences
reported are of small consequence (eg. different CompanyName), but
other, such as attribute parameters from System.Xml.Serialization, may
have an important impact on interoperability. Patch is attached,
please review. Also attached is a simplified Makefile for producing
masterfiles / api-info files.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Makefile
Type: application/octet-stream
Size: 1198 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061020/f27d5637/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061020/f27d5637/attachment.obj</A> 
-------------- next part --------------
Index: mono-api-info.cs
===================================================================
--- mono-api-info.cs	(wersja 66839)
+++ mono-api-info.cs	(kopia robocza)
@@ -910,9 +910,12 @@
 					continue;
 
 				XmlNode node = document.CreateElement (&quot;attribute&quot;);
-				AddAttribute (node, &quot;name&quot;, t.ToString ());
+				StringBuilder name = new StringBuilder();
+				name.Append (t.ToString ());
+				name.Append (&quot;(&quot;);
 
 				XmlNode properties = null;
+				bool hasProperties = false;
 				foreach (PropertyInfo pi in TypeData.GetProperties (t)) {
 					if (pi.Name == &quot;TypeId&quot;)
 						continue;
@@ -931,17 +934,31 @@
 							AddAttribute (n, &quot;null&quot;, &quot;true&quot;);
 							continue;
 						}
+						
+						name.Append (pi.Name);
+						name.Append (&quot; = &quot;);
+						hasProperties = true;
 
 						string value = o.ToString ();
 						if (t == typeof (GuidAttribute))
 							value = value.ToUpper ();
 
 						AddAttribute (n, &quot;value&quot;, value);
+						name.AppendFormat (&quot;{0}, &quot;, value);
 					}
 					catch (TargetInvocationException) {
 						continue;
 					}
 				}
+				
+				if (hasProperties)
+					name.Length -= 2; // remove &quot;, &quot;
+				name.Append (&quot;)&quot;);
+				
+				if (t.Name.EndsWith (&quot;TODOAttribute&quot;)) //ignore MonoTODO
+					AddAttribute (node, &quot;name&quot;, t.ToString ());
+				else				
+					AddAttribute (node, &quot;name&quot;, name.ToString ());
 
 				natts.AppendChild (node);
 			}
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021044.html">[Mono-dev] Parameter names and class status
</A></li>
	<LI>Next message: <A HREF="021054.html">[Mono-dev] Parameter names and class status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21052">[ date ]</a>
              <a href="thread.html#21052">[ thread ]</a>
              <a href="subject.html#21052">[ subject ]</a>
              <a href="author.html#21052">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
