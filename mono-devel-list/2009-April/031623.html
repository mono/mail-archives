<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Implement support for compiled regular expressions in profile 1.x
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Implement%20support%20for%20compiled%20regular%0A%20expressions%20in%20profile%201.x&In-Reply-To=8cca42d80904031450q7592922enf5c5d93a3ad8b957%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031816.html">
   <LINK REL="Next"  HREF="031632.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Implement support for compiled regular expressions in profile 1.x</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Implement%20support%20for%20compiled%20regular%0A%20expressions%20in%20profile%201.x&In-Reply-To=8cca42d80904031450q7592922enf5c5d93a3ad8b957%40mail.gmail.com"
       TITLE="[Mono-dev] [PATCH] Implement support for compiled regular expressions in profile 1.x">kornelpal at gmail.com
       </A><BR>
    <I>Fri Apr  3 18:58:54 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="031816.html">[Mono-dev] Compiling Mono v2.4 RC2 (Solaris 10 SPARCv9)
</A></li>
        <LI>Next message: <A HREF="031632.html">[Mono-dev] [PATCH] Implement support for compiled regular	expressions in profile 1.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31623">[ date ]</a>
              <a href="thread.html#31623">[ thread ]</a>
              <a href="subject.html#31623">[ subject ]</a>
              <a href="author.html#31623">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I think that using public fields instead of private ones costs no work.
Parts of this patch related to dynamic assemblies are just a few lines 
that is complete and needs no maintenace. I didn't have to change a 
single character in the code generator so the part that really needs 
maintenance is not affected by this solution.

On the other hand maintaining implementations using generic and 
non-generic hashtables needs maintenance.

Most of the things is about introducing non-generic Hashtables and 
getting rid of GetEvalMethod and CreateEvalMethod methods and making 
EmitEvalMethodBody return boolean instead of the single DynamicMethod 
instance ever created in the flow or null. These latter things help 
maintaining code but most likely won't be accepted either because are 
not required if we don't want support without DynamicMethods.

Anyway I'm not going to push this patch, I just implemented this because 
this was very straightforward to implement and this solution (at least 
to me) seems to be very straightforward.

Korn&#233;l

Rodrigo Kumpera wrote:
&gt;<i> Korn&#233;l,
</I>&gt;<i> 
</I>&gt;<i> Using dynamic assemblies will increase the maintenance burden for no 
</I>&gt;<i> good advantage. It should be done with dynamic methods, if at all.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 2009/4/3 Korn&#233;l P&#225;l &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt;&gt;
</I>&gt;<i> 
</I>&gt;<i>     Hi,
</I>&gt;<i> 
</I>&gt;<i>     The runtime has support for generic types in profile 1.0 as well,
</I>&gt;<i>     OnDeserializedAttribute could also be used, just like new case
</I>&gt;<i>     insensitive and culture invariant string operations/comparison,
</I>&gt;<i>     static classes could be supported by profile 1.0 C# compiler because
</I>&gt;<i>     no runtime support is needed, and this is just some examples of
</I>&gt;<i>     possible 2.0 suff for internal use in 1.0 class library.
</I>&gt;<i> 
</I>&gt;<i>     As far as I know none of them or any other 2.0 features are used
</I>&gt;<i>     outside of mscorlib.dll.
</I>&gt;<i> 
</I>&gt;<i>     Also note that this is a complete patch including replacing the
</I>&gt;<i>     generic Dictionaries with non-generic Hashtables.
</I>&gt;<i> 
</I>&gt;<i>     Attached a more recent version of the patch with some minor updates.
</I>&gt;<i> 
</I>&gt;<i>     Korn&#233;l
</I>&gt;<i> 
</I>&gt;<i>     Rodrigo Kumpera wrote:
</I>&gt;<i> 
</I>&gt;<i>         I think a better approach instead of using dynamic assemblies is
</I>&gt;<i>         to use dynamic methods on 1.0 as well.
</I>&gt;<i>         They can be exposed as internal stuff from mscorlib to System
</I>&gt;<i>         and most of the work will replacing the generic
</I>&gt;<i>         stuff.
</I>&gt;<i> 
</I>&gt;<i>         2009/4/2 Korn&#233;l P&#225;l &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>
</I>&gt;<i>         &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt; &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>
</I>&gt;<i>         &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>&gt;&gt;&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>            Hi,
</I>&gt;<i> 
</I>&gt;<i>            Because of the restrictions of 1.x I modified visibility so I
</I>&gt;<i>         also would
</I>&gt;<i>            like to set skipVisibility = false in DynamicMethod
</I>&gt;<i>         constructor (not
</I>&gt;<i>            included in the patch) to avoid 1.x only bugs because of this.
</I>&gt;<i> 
</I>&gt;<i>            Korn&#233;l
</I>&gt;<i> 
</I>&gt;<i>            Korn&#233;l P&#225;l wrote:
</I>&gt;<i>             &gt; Hi,
</I>&gt;<i>             &gt;
</I>&gt;<i>             &gt; I've implement support for compiled regular expressions in
</I>&gt;<i>            profile 1.x
</I>&gt;<i>             &gt; using dynamic assemblies.
</I>&gt;<i>             &gt;
</I>&gt;<i>             &gt; I also have cleaned up the code by removing GetEvalMethod and
</I>&gt;<i>             &gt; CreateEvalMethod methods and moving their functionality to
</I>&gt;<i>             &gt; GetMachineFactory.
</I>&gt;<i>             &gt;
</I>&gt;<i>             &gt; I also modified the signature of EmitEvalMethodBody and
</I>&gt;<i>         replaced
</I>&gt;<i>            generic
</I>&gt;<i>             &gt; dictionaries with hashtables in profile 1.x that results
</I>&gt;<i>         in a larger
</I>&gt;<i>             &gt; patch but I haven't modify the actual code generator.
</I>&gt;<i>             &gt;
</I>&gt;<i>             &gt; I also had to modify some visibility levels to pass
</I>&gt;<i>         runtime type
</I>&gt;<i>            checks.
</I>&gt;<i>             &gt;
</I>&gt;<i>             &gt; Please review the attached patch.
</I>&gt;<i>             &gt;
</I>&gt;<i>             &gt; Korn&#233;l
</I>&gt;<i>             &gt;
</I>&gt;<i>            _______________________________________________
</I>&gt;<i>            Mono-devel-list mailing list
</I>&gt;<i>            <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I></PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031816.html">[Mono-dev] Compiling Mono v2.4 RC2 (Solaris 10 SPARCv9)
</A></li>
	<LI>Next message: <A HREF="031632.html">[Mono-dev] [PATCH] Implement support for compiled regular	expressions in profile 1.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31623">[ date ]</a>
              <a href="thread.html#31623">[ thread ]</a>
              <a href="subject.html#31623">[ subject ]</a>
              <a href="author.html#31623">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
