<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Monoco, couroutines and Mono.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Monoco%2C%20couroutines%20and%20Mono.&In-Reply-To=49E632D6.5000401%40mansionfamily.plus.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031799.html">
   <LINK REL="Next"  HREF="031806.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Monoco, couroutines and Mono.</H1>
    <B>Tomi Valkeinen</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Monoco%2C%20couroutines%20and%20Mono.&In-Reply-To=49E632D6.5000401%40mansionfamily.plus.com"
       TITLE="[Mono-dev] Monoco, couroutines and Mono.">tomba at iki.fi
       </A><BR>
    <I>Thu Apr 16 01:41:02 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="031799.html">[Mono-dev] Monoco, couroutines and Mono.
</A></li>
        <LI>Next message: <A HREF="031806.html">[Mono-dev] Monoco, couroutines and Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31804">[ date ]</a>
              <a href="thread.html#31804">[ thread ]</a>
              <a href="subject.html#31804">[ subject ]</a>
              <a href="author.html#31804">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On Wed, 15 Apr 2009, James Mansion wrote:

&gt;<i> Tomi Valkeinen wrote:
</I>&gt;&gt;<i> I think you mean OS thread. The coroutines are nothing special, they are 
</I>&gt;&gt;<i> similar to any other jitted code that mono produces.
</I>&gt;<i> Well, except that the core has some knowledge of them now, right?
</I>
Well, some, of course. But a continuation is just a piece of stack, stored 
somewhere. The jitted code itself is the same as normally.

&gt;&gt;<i> And thus the stack has to be the normal continuous OS stack.
</I>&gt;<i> Thus?  Why? You probably need to pin stack areas, but why can't you malloc 
</I>&gt;<i> (or mmap) some new space
</I>&gt;<i> and place a stack in it?  I think you'll find that Steve Dekorte's libcoro 
</I>&gt;<i> does that. If you are prepared to
</I>&gt;<i> forgo guard pages and the like (or roll your own handler) then I don't see 
</I>&gt;<i> why the stack pointer absolutely
</I>&gt;<i> has to be where you expect.  And in fact the gubbins that normally gets 
</I>&gt;<i> pushed to the main CPU stack
</I>&gt;<i> can get pushed to a fully software stack anyway, just as you do on RISC 
</I>&gt;<i> systems with no push/pop
</I>&gt;<i> abstraction.  The stack pointer is just a pointer, after all.
</I>
The stack must be able to grow, otherwise we may run out of stack. If we 
want to manage a proper stack for each continuation, we need to allocate 
it in page sized chunks, and we need the guard pages. This would increase 
the required memory needed for each continuation quite a bit.

Also, the stack contains pointers to variables in the stack, so the stack 
has to be in the same memory location.

  Tomi
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031799.html">[Mono-dev] Monoco, couroutines and Mono.
</A></li>
	<LI>Next message: <A HREF="031806.html">[Mono-dev] Monoco, couroutines and Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31804">[ date ]</a>
              <a href="thread.html#31804">[ thread ]</a>
              <a href="subject.html#31804">[ subject ]</a>
              <a href="author.html#31804">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
