<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Using mdoc for internal documentation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Using%20mdoc%20for%20internal%20documentation&In-Reply-To=E828FE7A-1B1A-4100-975B-B66ABACBBE25%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031646.html">
   <LINK REL="Next"  HREF="031656.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Using mdoc for internal documentation</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Using%20mdoc%20for%20internal%20documentation&In-Reply-To=E828FE7A-1B1A-4100-975B-B66ABACBBE25%40gmail.com"
       TITLE="[Mono-dev] Using mdoc for internal documentation">jonpryor at vt.edu
       </A><BR>
    <I>Mon Apr  6 23:56:39 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="031646.html">[Mono-dev] Using mdoc for internal documentation
</A></li>
        <LI>Next message: <A HREF="031656.html">[Mono-dev] Using mdoc for internal documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31647">[ date ]</a>
              <a href="thread.html#31647">[ thread ]</a>
              <a href="subject.html#31647">[ subject ]</a>
              <a href="author.html#31647">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2009-04-06 at 17:06 -0700, Casey Marshall wrote:
&gt;<i> Sometime ago, though, it looks like `monodocer' became an alias for  
</I>&gt;<i> `mdoc update'. I'm having trouble getting mdoc-update to do the right  
</I>&gt;<i> thing.
</I>
This happened with Mono 2.0.

&gt;<i> I tried this, in makefile syntax (DOC_TARGETS is a list of targets doc- 
</I>&gt;<i> *, for each project in our tree, and all-* targets build each project):
</I>&gt;<i> 
</I>&gt;<i>    docs: $(DOC_TARGETS)
</I>&gt;<i> 	mdoc assemble --out=monodoc/fish monodoc
</I>&gt;<i> 
</I>&gt;<i>    $(DOC_TARGETS): doc-%: all-%
</I>&gt;<i> 	-mdoc update --out=monodoc --import=xmldoc/`$(shell echo $* |  
</I>&gt;<i> tr / .).xml $*/bin/Debug/*.dll
</I>&gt;<i> 
</I>&gt;<i> This doesn't seem to work; in particular, lots of classes from the  
</I>&gt;<i> assemblies are omitted.
</I>&gt;<i> 
</I>&gt;<i> One common error I get from `mdoc update' is:
</I>&gt;<i> 
</I>&gt;<i>    mdoc: Could not resolve: foo.dll, Version=XXX, Culture=neutral,  
</I>&gt;<i> PublicKeyToken=XXX
</I>
I suspect that the missing classes are due to the above resolving error.

Which version of Mono are you using?  Specifically, Mono 2.4 or earlier?
In Mono 2.4 mdoc-update was changed to use Cecil, while previous
releases (and monodocer) used Reflection.  If you're running Mono 2.4
this could be a bug introduced by the migration.

Also, what is 'foo.dll'?  Is it a library that you built, or a
GAC-located assembly?  If you're using Mono 2.4, Cecil will only check
the GAC and the directories of assemblies specified on the command line.

It's possible that placing all of your assemblies into the same
directory will fix this, instead of placing them into separate
directories (e.g. build into a common bin/Debug directory, instead of
into multiple */bin/Debug directories).  If this is the case, please let
me know so that I can fix a future release (along with details of the
assembly dependencies, etc., as when I try this locally it works as
expected.)

&gt;<i> for various assemblies that I both specify in the assemblies list on  
</I>&gt;<i> the command line, AND are in a directory listed in MONO_PATH.
</I>
Hm, this might be the problem: MONO_PATH isn't searched in Mono 2.4 (as
Cecil doesn't check it).  If you're using Mono 2.4 AND you built from
source, try applying the attached patch from mcs and rebuilding mdoc.
(The patch causes mdoc-update to add MONO_PATH directories to the
assembly search directories.)  This _may_ fix it...

&gt;<i> My question, then, is: what's the right way to do this -- assemble a  
</I>&gt;<i> bunch of assemblies and XML documentation files into a  
</I>&gt;<i> single .tree/.zip file for monodoc?
</I>
What you're doing should be working (i.e. it's a bug in mdoc).  Alas,
I'll need to figure out what the bug is in order to fix it...

Furthermore, it isn't necessary to bundle everything together in a
single set of .tree/.zip files (though it may be more convenient for
you).  Since Mono 2.4 (2.2?), the .source file format allows you to
specify &quot;parent&quot; nodes, which allows multiple sets of .source/.tree/.zip
files to have the same &quot;logical&quot; parent node.  This is currently done
with the Gendarme documentation (each assembly has its own set of files)
and with Mono.* and mono-addins-docs.*, e.g. Mono.source:

        &lt;monodoc&gt;
          &lt;node label=&quot;Mono Libraries&quot; name=&quot;classlib-mono&quot;
            parent=&quot;libraries&quot; /&gt;
          &lt;source provider=&quot;ecma&quot; basefile=&quot;Mono&quot; path=&quot;classlib-mono&quot;/&gt;
        &lt;/monodoc&gt;

and mono-addins-docs.source:

        &lt;monodoc&gt;
          &lt;node label=&quot;Mono Libraries&quot; name=&quot;classlib-mono&quot;
            parent=&quot;libraries&quot; /&gt;
          &lt;source provider=&quot;ecma&quot; basefile=&quot;mono-addins-docs&quot; 
            path=&quot;classlib-mono&quot;/&gt;
        &lt;/monodoc&gt;

If you're able to run 'mdoc-update' separately for each assembly without
error (while running 'mdoc-update' for all assemblies at once does
produce errors), then it may be an option to assemble all the docs
separately and merge them into the same tree using the .source file.
The mdoc-assemble(1) man page provides documentation for the .source
file XML.

 - Jon

-------------- next part --------------
A non-text attachment was scrubbed...
Name: mdoc-update-MONO_PATH.patch
Type: text/x-patch
Size: 1160 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090406/6b05e2aa/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20090406/6b05e2aa/attachment.bin</A> 
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031646.html">[Mono-dev] Using mdoc for internal documentation
</A></li>
	<LI>Next message: <A HREF="031656.html">[Mono-dev] Using mdoc for internal documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31647">[ date ]</a>
              <a href="thread.html#31647">[ thread ]</a>
              <a href="subject.html#31647">[ subject ]</a>
              <a href="author.html#31647">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
