<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Random mono apache errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Random%20mono%20apache%20errors&In-Reply-To=%3C521B2AF5.4050801%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="040753.html">
   <LINK REL="Next"  HREF="040762.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Random mono apache errors</H1>
    <B>Vladimir Dimitrov</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Random%20mono%20apache%20errors&In-Reply-To=%3C521B2AF5.4050801%40gmail.com%3E"
       TITLE="[Mono-dev] Random mono apache errors">vlad.dimitrov at gmail.com
       </A><BR>
    <I>Mon Aug 26 10:16:21 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="040753.html">[Mono-dev] Random mono apache errors
</A></li>
        <LI>Next message: <A HREF="040762.html">[Mono-dev] Random mono apache errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40761">[ date ]</a>
              <a href="thread.html#40761">[ thread ]</a>
              <a href="subject.html#40761">[ subject ]</a>
              <a href="author.html#40761">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Almost the same thing just happened again. I got this error when calling 
a web service on the apache/mono server:

System.Exception: INTERNAL configuration error: failed to get 
configuration 'system.diagnostics'
   at System.Diagnostics.DiagnosticsConfiguration.get_Settings () 
[0x00000] in &lt;filename unknown&gt;:0
   at System.Diagnostics.TraceImpl.InitOnce () [0x00000] in &lt;filename 
unknown&gt;:0
   at System.Diagnostics.TraceImpl.get_Listeners () [0x00000] in 
&lt;filename unknown&gt;:0
   at System.Diagnostics.TraceImpl.get_ListenersSyncRoot () [0x00000] in 
&lt;filename unknown&gt;:0
   at System.Diagnostics.TraceImpl.WriteLine (System.String message) 
[0x00000] in &lt;filename unknown&gt;:0
   at System.Diagnostics.Debug.WriteLine (System.String format, 
System.Object[] args) [0x00000] in &lt;filename unknown&gt;:0
   at Warehouse.Data.Str.WriteDebugMessage (System.String message, 
System.Object[] args) [0x00000] in &lt;filename unknown&gt;:0
   at Warehouse.Portal.Sync.Api.SyncPoll.GetCommand (System.Byte[] 
encIV, System.Byte[] encKey, System.Byte[] encParams) [0x00000] in 
&lt;filename unknown&gt;:0
   at (wrapper managed-to-native) 
System.Reflection.MonoMethod:InternalInvoke 
(System.Reflection.MonoMethod,object,object[],System.Exception&amp;)
   at System.Reflection.MonoMethod.Invoke (System.Object obj, 
BindingFlags invokeAttr, System.Reflection.Binder binder, 
System.Object[] parameters, System.Globalization.CultureInfo culture) 
[0x00000] in &lt;filename unknown&gt;:0

after &quot;sudo service apache2 restart&quot; everything continued to work properly.
Something causes the configuration to become messed up in (what looks 
like) random or heavy load situations and this makes everything go south.

Unfortunately it looks like this part of mono is not in the primary (or 
maybe in no) focus for the Xamarin team so my best bet here is to:
1. Use the open source way, find and fix it myself and hope that we will 
have this change in the official mono one day.
2. Move to a Windows server with IIS which I know is not a secondary 
focus for MS.

- Vladimir

On 21.8.2013 &#1075;. 16:16 &#1095;., Vladimir Dimitrov wrote:
&gt;<i> I got to this point in the sources too, but I have no idea what I can 
</I>&gt;<i> do or why didn't many other people got the same problem?
</I>&gt;<i>
</I>&gt;<i> On 21.8.2013 &#1075;. 15:20 &#1095;., Rafael Teixeira wrote:
</I>&gt;&gt;<i> From sources 
</I>&gt;&gt;<i> (<A HREF="https://github.com/mono/mono/blob/master/mcs/class/System.Web.Services/System.Web.Services.Protocols/SoapDocumentationHandler.cs">https://github.com/mono/mono/blob/master/mcs/class/System.Web.Services/System.Web.Services.Protocols/SoapDocumentationHandler.cs</A>):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     if (key == &quot;wsdl&quot; || key == &quot;schema&quot; || key == &quot;code&quot; || key ==
</I>&gt;&gt;<i>     &quot;disco&quot;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     return;
</I>&gt;&gt;<i>     #if NET_2_0
</I>&gt;&gt;<i>     string help = WebServicesSection.Current.WsdlHelpGenerator.Href;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     string path = Path.GetDirectoryName
</I>&gt;&gt;<i>     (ConfigurationManager.OpenMachineConfiguration().FilePath);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     #else
</I>&gt;&gt;<i>     string help = WSConfig.Instance.WsdlHelpPage;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     string path = Path.GetDirectoryName
</I>&gt;&gt;<i>     (WSConfig.Instance.ConfigFilePath);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     #endif
</I>&gt;&gt;<i>     *...*
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     string physPath = Path.Combine (path, help);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So probably WebServicesSection.Current.WsdlHelpGenerator.Href is 
</I>&gt;&gt;<i> returning null or 
</I>&gt;&gt;<i> ConfigurationManager.OpenMachineConfiguration().FilePath is returning 
</I>&gt;&gt;<i> null.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For the first case, as this is read from current configuration which 
</I>&gt;&gt;<i> can be reread from time to time as any part of the configuration 
</I>&gt;&gt;<i> chain changes it is possible that either some of those MonoTodos in 
</I>&gt;&gt;<i> <A HREF="https://github.com/mono/mono/blob/master/mcs/class/System.Web.Services/System.Web.Services.Configuration/WsdlHelpGeneratorElement.cs?source=cc">https://github.com/mono/mono/blob/master/mcs/class/System.Web.Services/System.Web.Services.Configuration/WsdlHelpGeneratorElement.cs?source=cc</A> are 
</I>&gt;&gt;<i> making things flaky:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [MonoTODO (&quot;probably verifies the Href property here, after 
</I>&gt;&gt;<i> deserializing?&quot;)]
</I>&gt;&gt;<i> protected override void DeserializeElement (XmlReader reader, bool 
</I>&gt;&gt;<i> serializeCollectionKey)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i> base.DeserializeElement (reader, serializeCollectionKey);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i> [MonoTODO]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> protected override void Reset (ConfigurationElement parentElement)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> {
</I>&gt;&gt;<i> base.Reset (parentElement);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> or some locking is missing to avoid reading an incomplete current 
</I>&gt;&gt;<i> configuration instance...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As for the second case after much navigating through sources it comes 
</I>&gt;&gt;<i> down to calling an internal call 'string get_machine_config_path ()' 
</I>&gt;&gt;<i> which I don't have time now to try to explore...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hope it helps,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Rafael Teixeira
</I>&gt;&gt;<i> O..:.)oooo
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, Aug 21, 2013 at 8:05 AM, Vladimir Dimitrov 
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vlad.dimitrov at gmail.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vlad.dimitrov at gmail.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Hey guys,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     I have worked with mono for almost 7 years but I recently got
</I>&gt;&gt;<i>     involved in a project that used mono web services and apache
</I>&gt;&gt;<i>     together on Linux.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     The problem is that as the load on the service started to rise we
</I>&gt;&gt;<i>     started getting different errors which appear in random intervals.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     One of the errors is described here:
</I>&gt;&gt;<i>     <A HREF="https://bugzilla.novell.com/show_bug.cgi?id=522631">https://bugzilla.novell.com/show_bug.cgi?id=522631</A> (not by me).
</I>&gt;&gt;<i>     And attempting to fix it I added some configuration that caused
</I>&gt;&gt;<i>     another error to appear once:
</I>&gt;&gt;<i>     <A HREF="http://img577.imageshack.us/img577/4473/44in.png">http://img577.imageshack.us/img577/4473/44in.png</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     The only common spot between the errors seem to be the
</I>&gt;&gt;<i>     configuration. Looks like at some point it becomes invalid. This
</I>&gt;&gt;<i>     sometimes happens after the service gets restarted, but sometimes
</I>&gt;&gt;<i>     it happens while the service is running normally. A restart of
</I>&gt;&gt;<i>     apache usually fixes the problem.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Does anybody else encountered something similar or have an idea
</I>&gt;&gt;<i>     what can be the problem?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Thanks,
</I>&gt;&gt;<i>      Vladimir
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     _______________________________________________
</I>&gt;&gt;<i>     Mono-devel-list mailing list
</I>&gt;&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i>     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20130826/f143e02f/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20130826/f143e02f/attachment-0001.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="040753.html">[Mono-dev] Random mono apache errors
</A></li>
	<LI>Next message: <A HREF="040762.html">[Mono-dev] Random mono apache errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40761">[ date ]</a>
              <a href="thread.html#40761">[ thread ]</a>
              <a href="subject.html#40761">[ subject ]</a>
              <a href="author.html#40761">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
