<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Control-C handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Control-C%20handler&In-Reply-To=1201558423.25514.263.camel%40lina.magi.jprl.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026739.html">
   <LINK REL="Next"  HREF="026684.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Control-C handler</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Control-C%20handler&In-Reply-To=1201558423.25514.263.camel%40lina.magi.jprl.com"
       TITLE="[Mono-dev] Control-C handler">jonpryor at vt.edu
       </A><BR>
    <I>Mon Jan 28 20:02:35 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="026739.html">[Mono-dev] Control-C handler
</A></li>
        <LI>Next message: <A HREF="026684.html">[Mono-dev] Control-C handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26743">[ date ]</a>
              <a href="thread.html#26743">[ thread ]</a>
              <a href="subject.html#26743">[ subject ]</a>
              <a href="author.html#26743">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2008-01-28 at 17:13 -0500, Jonathan Pryor wrote:
&gt;<i> On Mon, 2008-01-28 at 21:10 +0100, Paolo Molaro wrote:
</I>&gt;<i> &gt; Deregistration is handled incorrectly: if there are two handlers for the
</I>&gt;<i> &gt; same signal it gets disabled at the first uninstall.
</I>
This has been fixed.

&gt;<i> &gt; &gt; The only other major change is the addition of a
</I>&gt;<i> &gt; &gt; UnixSignal.WaitAny(UnixSignal[]) method, which allows waiting on more
</I>&gt;<i> &gt; &gt; than one handle (since WaitHandle.WaitAny() can't currently be used with
</I>&gt;<i> &gt; &gt; WaitHandle subclasses like UnixSignal).
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I suggest using params in the array argument.
</I>&gt;<i> 
</I>&gt;<i> I'm not sure this is a good idea, as WaitAny() is overloaded:
</I>&gt;<i> 
</I>&gt;<i> 	static bool WaitAny(params UnixSignal[] signals);
</I>&gt;<i> 	static bool WaitAny(UnixSignal[] signals, TimeSpan timeout);
</I>&gt;<i> 	static bool WaitAny(UnixSignal[] signals, int timeout);
</I>&gt;<i> 
</I>&gt;<i> Consequently, moving from WaitAny(UnixSignal[]) to one of the other
</I>&gt;<i> overloads would result in inconsistent usage (adding `new
</I>&gt;<i> UnixSignal[]{...}', etc.).
</I>&gt;<i> 
</I>&gt;<i> Alternatively, we could alter the ordering so that things are always
</I>&gt;<i> consistent, though this would result in a different order from the
</I>&gt;<i> WaitHandle.WaitAny() methods:
</I>&gt;<i> 
</I>&gt;<i> 	static bool WaitAny(params UnixSignal[] signals);
</I>&gt;<i> 	static bool WaitAny(TimeSpan timeout, params UnixSignal[] signals);
</I>&gt;<i> 	static bool WaitAny(int timeout, params UnixSignal[] signals);
</I>&gt;<i> 
</I>&gt;<i> Consequently, I'm conflicted: we either keep things as they are,
</I>&gt;<i> allowing consistency with WaitHandle.WaitAny() and making it easy to
</I>&gt;<i> change the overload used, or provide params everywhere, and differ from
</I>&gt;<i> WaitHandle.
</I>
Still not sure about this; would appreciate some additional feedback
before making this change.

&gt;<i> &gt; An extensive test program that shows this stuff works before being
</I>&gt;<i> &gt; committed would also help.
</I>
Attached.  I should probably migrate it to NUnit and add it to the
Mono.Posix tests code...

So the only remaining question, to me, is the type and ordering of the
UnixSignal.WaitAny() methods (i.e. the 'params' question).

Thanks,
 - Jon

-------------- next part --------------
A non-text attachment was scrubbed...
Name: support-v5.diff
Type: text/x-patch
Size: 6699 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080128/b91a5975/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080128/b91a5975/attachment.bin</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Mono.Posix-v5.diff
Type: text/x-patch
Size: 8439 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080128/b91a5975/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080128/b91a5975/attachment-0001.bin</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: us-test.cs
Type: text/x-csharp
Size: 3017 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080128/b91a5975/attachment-0002.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080128/b91a5975/attachment-0002.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026739.html">[Mono-dev] Control-C handler
</A></li>
	<LI>Next message: <A HREF="026684.html">[Mono-dev] Control-C handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26743">[ date ]</a>
              <a href="thread.html#26743">[ thread ]</a>
              <a href="subject.html#26743">[ subject ]</a>
              <a href="author.html#26743">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
