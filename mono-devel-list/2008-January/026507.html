<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [Fwd: [Mono-patches] r92329	-trunk/mcs/class/System.Web/System.Web.Util]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BFwd%3A%20%5BMono-patches%5D%20r92329%0A%09-trunk/mcs/class/System.Web/System.Web.Util%5D&In-Reply-To=DA63C6E8B207E748B20D46DFED7B772D04A51FDF%40dhost002-45.dex002.intermedia.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026506.html">
   <LINK REL="Next"  HREF="026508.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [Fwd: [Mono-patches] r92329	-trunk/mcs/class/System.Web/System.Web.Util]</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BFwd%3A%20%5BMono-patches%5D%20r92329%0A%09-trunk/mcs/class/System.Web/System.Web.Util%5D&In-Reply-To=DA63C6E8B207E748B20D46DFED7B772D04A51FDF%40dhost002-45.dex002.intermedia.net"
       TITLE="[Mono-dev] [Fwd: [Mono-patches] r92329	-trunk/mcs/class/System.Web/System.Web.Util]">atsushi at ximian.com
       </A><BR>
    <I>Mon Jan  7 04:43:35 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="026506.html">[Mono-dev] [Fwd: [Mono-patches] r92329	-trunk/mcs/class/System.Web/System.Web.Util]
</A></li>
        <LI>Next message: <A HREF="026508.html">[Mono-dev] [Fwd: [Mono-patches] r92329	-trunk/mcs/class/System.Web/System.Web.Util]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26507">[ date ]</a>
              <a href="thread.html#26507">[ thread ]</a>
              <a href="subject.html#26507">[ subject ]</a>
              <a href="author.html#26507">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Kosta,

Well, I should have exactly indicated what I saw problematic.
It is not about why you guys introduced TARGET_DOTNET (I guessed it
is for such necessary case to differentiate .NET and mono runtimes),
but about why you guys needed to avoid
RuntimeEnvironment.SystemConfigurationFile in mono (!TARGET_DOTNET).

I agree that you'd need TARGET_DOTNET while am glad to hear that it
does not happen much.

Atsushi Eno


Konstantin Triger wrote:
&gt;<i> Hey Eno,
</I>&gt;<i> 
</I>&gt;<i> I did not completely understand your comment, but let me explain the background, so you will understand what Igor meant by this patch.
</I>&gt;<i> 
</I>&gt;<i> Usually we develop Web-related stuff in MS.Net environment, we take XSP, Sys.Web from mono trunk and all the rest from MS and run 'usual' console application. This perfectly works until there is something incorrect from MS.Net point of view. Fortunately this does not happen much, but when it does, we used TARGET_NET ifdef to differentiate. Thus, under TARGET_NET ifdef we put not always production ready, but MS.Net-correct code for development purposes only.
</I>&gt;<i> 
</I>&gt;<i> Can you please explain your point, what would you propose to put in ICalls.cs? If you see an option to combine paths, so the code will be common for mono.Net and MS.Net it would be great.
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> Konstantin Triger
</I>&gt;<i> 
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:mono-devel-list-
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bounces at lists.ximian.com</A>] On Behalf Of Atsushi Eno
</I>&gt;&gt;<i> Sent: Monday, January 07, 2008 9:15 AM
</I>&gt;&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> Subject: [Mono-dev] [Fwd: [Mono-patches] r92329 -
</I>&gt;&gt;<i> trunk/mcs/class/System.Web/System.Web.Util]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is there any reason to differentiate runtime environment shown like
</I>&gt;&gt;<i> this patch? I don't think we like such approach very much, especially
</I>&gt;&gt;<i> since our implementation of RuntimeEnvironment.SystemConfigurationFile
</I>&gt;&gt;<i> is implemented as:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --------
</I>&gt;&gt;<i> public static string SystemConfigurationFile {
</I>&gt;&gt;<i> 	get {
</I>&gt;&gt;<i> 		// GetMachineConfigPath is internal and not protected by
</I>&gt;&gt;<i> CAS
</I>&gt;&gt;<i> 		string path = Environment.GetMachineConfigPath ();
</I>&gt;&gt;<i> 		if (SecurityManager.SecurityEnabled) {
</I>&gt;&gt;<i> 			new FileIOPermission
</I>&gt;&gt;<i> (FileIOPermissionAccess.PathDiscovery,
</I>&gt;&gt;<i> path).Demand ();
</I>&gt;&gt;<i> 		}
</I>&gt;&gt;<i> 		return path;
</I>&gt;&gt;<i> 	}
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i> --------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To me it looks that it just tries to skip security assertion.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Atsushi Eno
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -------- Original Message --------
</I>&gt;&gt;<i> Subject: [Mono-patches] r92329 -
</I>&gt;&gt;<i> trunk/mcs/class/System.Web/System.Web.Util
</I>&gt;&gt;<i> Date: Sun,  6 Jan 2008 03:14:55 -0500 (EST)
</I>&gt;&gt;<i> From: Igor Zalmanovich (<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">igorz at mainsoft.com</A>)
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-patches-list at lists.ximian.com</A>&gt;
</I>&gt;&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-patches at lists.ximian.com</A>, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ximian.monolist at gmail.com</A>,
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-svn-patches-garchive-20758 at googlegroups.com</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Author: igorz
</I>&gt;&gt;<i> Date: 2008-01-06 03:14:55 -0500 (Sun, 06 Jan 2008)
</I>&gt;&gt;<i> New Revision: 92329
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Modified:
</I>&gt;&gt;<i>     trunk/mcs/class/System.Web/System.Web.Util/ICalls.cs
</I>&gt;&gt;<i> Log:
</I>&gt;&gt;<i> added #if TARGET_DOTNET
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Modified: trunk/mcs/class/System.Web/System.Web.Util/ICalls.cs
</I>&gt;&gt;<i> ===================================================================
</I>&gt;&gt;<i> --- trunk/mcs/class/System.Web/System.Web.Util/ICalls.cs	2008-01-06
</I>&gt;&gt;<i> 08:11:36 UTC (rev 92328)
</I>&gt;&gt;<i> +++ trunk/mcs/class/System.Web/System.Web.Util/ICalls.cs	2008-01-06
</I>&gt;&gt;<i> 08:14:55 UTC (rev 92329)
</I>&gt;&gt;<i> @@ -35,8 +35,14 @@
</I>&gt;&gt;<i>   	{
</I>&gt;&gt;<i>   		private ICalls () {}
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> +#if TARGET_DOTNET
</I>&gt;&gt;<i> +		static public string GetMachineConfigPath () {
</I>&gt;&gt;<i> +			return
</I>&gt;&gt;<i> System.Runtime.InteropServices.RuntimeEnvironment.SystemConfigurationFi
</I>&gt;&gt;<i> le;
</I>&gt;&gt;<i> +		}
</I>&gt;&gt;<i> +#else
</I>&gt;&gt;<i>   		[MethodImplAttribute(MethodImplOptions.InternalCall)]
</I>&gt;&gt;<i>   		extern static public string GetMachineConfigPath ();
</I>&gt;&gt;<i> +#endif
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   		[MethodImplAttribute(MethodImplOptions.InternalCall)]
</I>&gt;&gt;<i>   		extern static public string GetMachineInstallDirectory ();
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-patches maillist  -  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-patches at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-patches">http://lists.ximian.com/mailman/listinfo/mono-patches</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026506.html">[Mono-dev] [Fwd: [Mono-patches] r92329	-trunk/mcs/class/System.Web/System.Web.Util]
</A></li>
	<LI>Next message: <A HREF="026508.html">[Mono-dev] [Fwd: [Mono-patches] r92329	-trunk/mcs/class/System.Web/System.Web.Util]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26507">[ date ]</a>
              <a href="thread.html#26507">[ thread ]</a>
              <a href="subject.html#26507">[ subject ]</a>
              <a href="author.html#26507">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
