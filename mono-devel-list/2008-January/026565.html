<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Control-C handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Control-C%20handler&In-Reply-To=1199847755.8432.129.camel%40lina.magi.jprl.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026549.html">
   <LINK REL="Next"  HREF="026568.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Control-C handler</H1>
    <B>Avery Pennarun</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Control-C%20handler&In-Reply-To=1199847755.8432.129.camel%40lina.magi.jprl.com"
       TITLE="[Mono-dev] Control-C handler">apenwarr at gmail.com
       </A><BR>
    <I>Wed Jan  9 11:52:45 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="026549.html">[Mono-dev] Control-C handler
</A></li>
        <LI>Next message: <A HREF="026568.html">[Mono-dev] Control-C handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26565">[ date ]</a>
              <a href="thread.html#26565">[ thread ]</a>
              <a href="subject.html#26565">[ subject ]</a>
              <a href="author.html#26565">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/01/2008, Jonathan Pryor &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jonpryor at vt.edu</A>&gt; wrote:
&gt;<i> I don't see why we need a new API to support this.  It seems that we
</I>&gt;<i> could retrofit the existing Stdlib.signal() API to use the
</I>&gt;<i> implementation you described, with one difference: a runtime internal
</I>&gt;<i> thread could be used to block on the internal pipe, and when the pipe is
</I>&gt;<i> readable it could dispatch the appropriate signal via delegate
</I>&gt;<i> registered with Stdlib.signal().  No polling, and no new public API
</I>&gt;<i> would be required.
</I>
It seems to me that lupus's suggestion is more general than this.  In
other words, you could implement your desired API above on top of his
without any extra overhead (ie. the overhead is inherent to the
interface), while you couldn't implement his on top of yours without
doing a lot of unnecessary work (ie. bouncing into a thread and then
back again).

Since mono's signal API is already (presumably) non-standard, it
should be harmless to correct it by introducing a new nonstandard one
that works properly.

Note that polling a variable is a fine way to handle signals in many C
programs.  I often write mainloops of the form &quot;while (!want_to_die)&quot;,
where want_to_die is set by my SIGTERM/SIGINT/etc handler.  Involving
a thread for this purpose would be overkill.  While this method does
count as &quot;polling&quot;, it is syscall-free polling and only happens at the
places where you would want to shut down cleanly anyway.

This reminds me, though: what happens to things like socket
read/write/connect system calls in mono when a signal comes in?  In C,
they get interrupted and return EINTR/EAGAIN, which is why you pop
back to the mainloop and get a chance to poll your signal variable.
But if the .Net API requires that there's no EAGAIN-style return code
for file operations, then they'll have to silently retry and a simple
signal variable won't work in any real-life program.

Have fun,

Avery

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026549.html">[Mono-dev] Control-C handler
</A></li>
	<LI>Next message: <A HREF="026568.html">[Mono-dev] Control-C handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26565">[ date ]</a>
              <a href="thread.html#26565">[ thread ]</a>
              <a href="subject.html#26565">[ subject ]</a>
              <a href="author.html#26565">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
