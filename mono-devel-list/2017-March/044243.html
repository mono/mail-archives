<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] GSOC 2017 Microsoft .NET and Mono integration - Import ThreadPool from CoreRT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20GSOC%202017%20Microsoft%20.NET%20and%20Mono%20integration%20-%0A%20Import%20ThreadPool%20from%20CoreRT&In-Reply-To=%3C9F214507-8553-4225-8752-B9F539FB3CBF%40microsoft.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="044233.html">
   <LINK REL="Next"  HREF="044251.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] GSOC 2017 Microsoft .NET and Mono integration - Import ThreadPool from CoreRT</H1>
    <B>Ludovic Henry</B> 
    <A HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20GSOC%202017%20Microsoft%20.NET%20and%20Mono%20integration%20-%0A%20Import%20ThreadPool%20from%20CoreRT&In-Reply-To=%3C9F214507-8553-4225-8752-B9F539FB3CBF%40microsoft.com%3E"
       TITLE="[Mono-dev] GSOC 2017 Microsoft .NET and Mono integration - Import ThreadPool from CoreRT">luhenry at microsoft.com
       </A><BR>
    <I>Mon Mar 27 17:07:44 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="044233.html">[Mono-dev] GSOC 2017 Microsoft .NET and Mono integration - Import ThreadPool from CoreRT
</A></li>
        <LI>Next message (by thread): <A HREF="044251.html">[Mono-dev] GSOC 2017 Microsoft .NET and Mono integration - Import ThreadPool from CoreRT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44243">[ date ]</a>
              <a href="thread.html#44243">[ thread ]</a>
              <a href="subject.html#44243">[ subject ]</a>
              <a href="author.html#44243">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alexander,

Integrating the CoreRT threadpool into Mono will be more of an experiment than a project that we envision merging by the end of GSoC into Mono. If that's find by you, then it's perfectly fine by us. Another project that would have more impact and that we are looking forward to merge would be importing System.Threading.Mutex, System.Threading.Semaphore and System.Threading.EventWaitHandle from CoreRT into Mono. Whichever project you choose is definitely up to you, and whichever you choose, it will be of great use for us.

To discuss each project in more details, importing System.Threading.ThreadPool would consist in getting <A HREF="https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/System/Threading/ThreadPool.cs">https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/System/Threading/ThreadPool.cs</A> and its dependencies from CoreRT, and adapting it to the use of Mono. Some features are not supported by the CoreRT ThreadPool such as SetMinThreads, SetMaxThreads, GetMinThreads, GetMaxThreads, or other APIs, and because we cannot just drop the support for these, we need to make sure they are implemented and supported. Right now, our ThreadPool implementation is coming from ReferenceSource for the managed part and we reimplemented the native part into Mono from CoreCLR (<A HREF="https://github.com/mono/mono/blob/master/mono/metadata/threadpool.c">https://github.com/mono/mono/blob/master/mono/metadata/threadpool.c</A> and <A HREF="https://github.com/mono/mono/blob/master/mono/metadata/threadpool-worker-default.c">https://github.com/mono/mono/blob/master/mono/metadata/threadpool-worker-default.c</A>).

For System.Threading.Mutex, System.Threading.Semaphore and System.Threading.EventWaitHandle, the project would consist in replacing our implementation of these classes with the one from CoreRT. Our implementation resides in <A HREF="https://github.com/mono/mono/blob/master/mcs/class/corlib/System.Threading/Mutex.cs,">https://github.com/mono/mono/blob/master/mcs/class/corlib/System.Threading/Mutex.cs,</A> <A HREF="https://github.com/mono/mono/blob/master/mcs/class/referencesource/System/sys/system/threading/semaphore.cs">https://github.com/mono/mono/blob/master/mcs/class/referencesource/System/sys/system/threading/semaphore.cs</A> and <A HREF="https://github.com/mono/mono/blob/master/mcs/class/referencesource/mscorlib/system/threading/eventwaithandle.cs">https://github.com/mono/mono/blob/master/mcs/class/referencesource/mscorlib/system/threading/eventwaithandle.cs</A> respectively.

For both these projects, as well as the other integration of .NET sources into Mono, we need to ensure that we keep supporting the same platforms as before, thus fixing or extending the CoreRT implementations.

If you have any more question, I will be more than happy to answer them! :)

Thank you very much!
Ludovic



On 24 Mar 2017, at 12:16, dampir &lt;<A HREF="http://lists.dot.net/mailman/listinfo/mono-devel-list">aedampir at gmail.com</A>&lt;mailto:<A HREF="http://lists.dot.net/mailman/listinfo/mono-devel-list">aedampir at gmail.com</A>&gt;&gt; wrote:

Hi,

I’m Alexander Efremov and I’m interested in GSOC projects of Mono.

Particulary I'm interested in &quot;Import ThreadPool from CoreRT&quot; (mentor
Ludovic Henry).

I successfully builded mono on my PC and now I think how to write a good
proposal devoted to import ThreadPool from CoreRT.
I have read 2 topics devoted to  Microsoft .NET and Mono integration:
<A HREF="http://lists.dot.net/pipermail/mono-devel-list/2017-March/044200.html">http://lists.dot.net/pipermail/mono-devel-list/2017-March/044200.html</A>
<A HREF="http://mono.1490590.n4.nabble.com/Microsoft-NET-and-Mono-integration-GSOC-2017-td4670288.html">http://mono.1490590.n4.nabble.com/Microsoft-NET-and-Mono-integration-GSOC-2017-td4670288.html</A>

but they mainly devoted to two other integration tasks (Import
System.IO.FileStream from CoreFX,
Import Process from CoreFX).

From there I got some common understanding what is supposed to do in these
tasks, exactly:
* Replace Mono's ThreadPool implementation on CoreFx one.
* Add support of some unsupported platforms to CoreFx.
* Add/edit a bunch of unit tests.

But my intention is integrate ThreadPool class from CoreFx. And in order to
write good and clear proposal I started to dig into source code connected to
Mono's ThreadPool. But I think that my knownledge about it is not enough to
create appropriate time schedule (week-by-week) in my proposal.

So my quesion is: Ludovic could you please describe in some details what
stages the integration of CoreFx ThreadPool is entail (like you describe in
<A HREF="http://mono.1490590.n4.nabble.com/Re-Interest-in-GSoC-NET-and-Mono-integration-td4670260.html">http://mono.1490590.n4.nabble.com/Re-Interest-in-GSoC-NET-and-Mono-integration-td4670260.html</A>
for System.IO.FileStream integration)?

I'm going to use this infromation to dig in right direction.

Thank you.



--
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/GSOC-2017-Microsoft-NET-and-Mono-integration-Import-ThreadPool-from-CoreRT-tp4670332.html">http://mono.1490590.n4.nabble.com/GSOC-2017-Microsoft-NET-and-Mono-integration-Import-ThreadPool-from-CoreRT-tp4670332.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.
_______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.dot.net/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.dot.net</A>
<A HREF="http://lists.dot.net/mailman/listinfo/mono-devel-list">http://lists.dot.net/mailman/listinfo/mono-devel-list</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/mono-devel-list/attachments/20170327/ffa558bd/attachment.html">http://lists.dot.net/pipermail/mono-devel-list/attachments/20170327/ffa558bd/attachment.html</A>&gt;
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="044233.html">[Mono-dev] GSOC 2017 Microsoft .NET and Mono integration - Import ThreadPool from CoreRT
</A></li>
	<LI>Next message (by thread): <A HREF="044251.html">[Mono-dev] GSOC 2017 Microsoft .NET and Mono integration - Import ThreadPool from CoreRT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44243">[ date ]</a>
              <a href="thread.html#44243">[ thread ]</a>
              <a href="subject.html#44243">[ subject ]</a>
              <a href="author.html#44243">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
