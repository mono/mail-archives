<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Unity - patching methods
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20Unity%20-%20patching%20methods&In-Reply-To=%3C1485002777576-4669765.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="044119.html">
   <LINK REL="Next"  HREF="044123.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Unity - patching methods</H1>
    <B>pardeike</B> 
    <A HREF="mailto:mono-devel-list%40lists.dot.net?Subject=Re%3A%20%5BMono-dev%5D%20Unity%20-%20patching%20methods&In-Reply-To=%3C1485002777576-4669765.post%40n4.nabble.com%3E"
       TITLE="[Mono-dev] Unity - patching methods">andreas at pardeike.net
       </A><BR>
    <I>Sat Jan 21 12:46:17 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="044119.html">[Mono-dev] Mono CI weather report 1/19
</A></li>
        <LI>Next message (by thread): <A HREF="044123.html">[Mono-dev] Unity - patching methods
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44122">[ date ]</a>
              <a href="thread.html#44122">[ thread ]</a>
              <a href="subject.html#44122">[ subject ]</a>
              <a href="author.html#44122">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I am trying to replace methods during runtime. Lots of existing ways do this
by 
simply inserting a jump at assembler level from the original to the new
method. 
I want to do this too but with the new method being a DynamicMethod (or a 
delegate to it).

I did solve the IL part of it but testing it with a game (RimWorld) that
uses Unity 
I find it crashes when I try my code with more than one method. I am no
expert 
in when mono jitts its methods and vaguely know about trampolines and it
looks 
like the memory area that you get with GetFunctionPtr() does change compared 
to when I write a jump to it into the original and that changed assembler
gives 
me all sort of crashes. Interestingly, the other method using exactly the
same way 
to patch it works.

So any pointers, ideas or suggestions welcome. I am in general an
experienced 
developer but just not familiar with the specific area. I can read c# and c
and 
tried to understand the mono repository code and will continue to do so. I
though 
it would be nice to ask in parallel here.

Thanks,
Andreas

PS: my (not complete project) is here: <A HREF="https://github.com/pardeike/Harmony">https://github.com/pardeike/Harmony</A>



--
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/Unity-patching-methods-tp4669765.html">http://mono.1490590.n4.nabble.com/Unity-patching-methods-tp4669765.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="044119.html">[Mono-dev] Mono CI weather report 1/19
</A></li>
	<LI>Next message (by thread): <A HREF="044123.html">[Mono-dev] Unity - patching methods
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44122">[ date ]</a>
              <a href="thread.html#44122">[ thread ]</a>
              <a href="subject.html#44122">[ subject ]</a>
              <a href="author.html#44122">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
