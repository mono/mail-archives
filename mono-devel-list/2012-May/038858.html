<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Submitting patch?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Submitting%20patch%3F&In-Reply-To=%3C4FAC5F68.1010706%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038833.html">
   <LINK REL="Next"  HREF="038824.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Submitting patch?</H1>
    <B>Rob Wilkens</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Submitting%20patch%3F&In-Reply-To=%3C4FAC5F68.1010706%40gmail.com%3E"
       TITLE="[Mono-dev] Submitting patch?">robwilkens at gmail.com
       </A><BR>
    <I>Fri May 11 00:38:00 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="038833.html">[Mono-dev] Submitting patch?
</A></li>
        <LI>Next message: <A HREF="038824.html">[Mono-dev] build error (No rule to make target `../../../external/cecil/Mono.Collections.Generic/Collection.cs')
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38858">[ date ]</a>
              <a href="thread.html#38858">[ thread ]</a>
              <a href="subject.html#38858">[ subject ]</a>
              <a href="author.html#38858">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Well, i added the test about a week ago.  The test works for me, it 
demonstrates failure (a null reference exception) in the case where the 
patch i wrote isn't applied, and it passes when the patch is applied.  I 
realize i'm the only one to report this problem, so it's low priority, 
but i wanted to mention to whomever is responsible that if they have any 
questions, i'm here for now (that is: I still subscribe to the list).

To me, again, the patch is straightforward and obviously needed -- 
There's a retry point and the first thing it checks in retry is if 
'result==null' (to enter the while loop) and that retry point is only 
hit under one circumstance, and in that circumstance, result is never 
null, so as a result, if the intention was for it to be anything other 
than null the retry point would be elsewhere.  Therefore, it should be 
blatantly obvious to anyone reading the code, that setting result to 
null so the check at the retry point can enter the while loop at the 
retry point, is the only thing that is needed to make it work.

To debug this originally, i inserted trace points to confirm what was 
going on.  It was stuck endlessly jumping to the retry point and not 
doing anything other than jumping directly to the retry point again and 
again until it got tired of that and failed, and every time after the 
first, it never enterred the while loop at the retry point, begging the 
question, if null wasn't intended (which it was), why not move the retry 
point elsewhere below the while loop.

If someone thinks this breaks something else, please let me know.

It's on github - <A HREF="https://github.com/mono/mono/pull/283">https://github.com/mono/mono/pull/283</A> ...  I understand 
if my nunit test is the reason it is rejected, it was the most 
quick/straightforward way to do the tests, it was extracted from 
sqlconnection.open() extracting only the code that was required to set 
up the TdsConnectionPool GetConnection() call it uses.

--rob

On 05/02/2012 07:28 AM, Rodrigo Kumpera wrote:
&gt;<i> Patches are much more likely to be accepted if they include tests. 
</I>&gt;<i> It's up to the TDS driver maintainers.
</I>&gt;<i>
</I>&gt;<i> On Wed, May 2, 2012 at 8:26 AM, Rob Wilkens &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">robwilkens at gmail.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">robwilkens at gmail.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     [resending reply via reply to list only, left off list in previous
</I>&gt;<i>     reply]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     I already did the pull request on github -- and i'm not sure how
</I>&gt;<i>     to include the tests (I only commented that i ran the tests on
</I>&gt;<i>     github in the pull comments).  Or do you mean i have to somehow
</I>&gt;<i>     generate my own tests, which would be difficult because this
</I>&gt;<i>     requires, i think, a functional microsoft sql server for it to
</I>&gt;<i>     have access to to reproduce the error.
</I>&gt;<i>
</I>&gt;<i>     -Rob
</I>&gt;<i>
</I>&gt;<i>     On 05/02/2012 07:21 AM, Rodrigo Kumpera wrote:
</I>&gt;&gt;<i>     Please make it a pull request on github with tests included.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     On Tue, May 1, 2012 at 12:55 PM, Rob Wilkens
</I>&gt;&gt;<i>     &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">robwilkens at gmail.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">robwilkens at gmail.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Ok, I looked up the 'selfish' way to submit a patch from the
</I>&gt;&gt;<i>         contributing section, and i think the below suffices as a
</I>&gt;&gt;<i>         patch, does anyone disagree?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         I am referring to : <A HREF="http://www.mono-project.com/Contributing">http://www.mono-project.com/Contributing</A>
</I>&gt;&gt;<i>         towards the bottom of the page where it simply says to submit
</I>&gt;&gt;<i>         the patch to the mailing list.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Does the below suffice as a &quot;patch&quot; or should i figure out
</I>&gt;&gt;<i>         the 'github' way which i thought i saw elsewhere.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         -Rob
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         On 05/01/2012 11:49 AM, Rob Wilkens wrote:
</I>&gt;&gt;&gt;<i>         I found out the fix for the error i reported with multiple invalid
</I>&gt;&gt;&gt;<i>         login attempts...  It's very simple...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         Mono.Data.TdsClient.TdsConnectionPool.cs
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         In the above file, in GetConnection(), either before:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         goto retry
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         or after the initial
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         retry:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         (either place should be fine)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         result needs to be set to null -- that is:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         result=null;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         (in my testing, i put it before goto retry)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         Otherwise, it keeps retrying because result has never been reset
</I>&gt;&gt;&gt;<i>         before the while loop you are trying to enter.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         I guess my next step is figuring out how to navigate github so i can submit it.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         Sorry for being so public and crowding the mailing list with this.  If
</I>&gt;&gt;&gt;<i>         someone else wants to volunteer to submit the patch for me, please
</I>&gt;&gt;&gt;<i>         speak up.  I'll otherwise figure it out.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         -Rob
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         _______________________________________________
</I>&gt;&gt;<i>         Mono-devel-list mailing list
</I>&gt;&gt;<i>         <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i>         &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;&gt;<i>         <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     Mono-devel-list mailing list
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120510/9cd795c7/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120510/9cd795c7/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038833.html">[Mono-dev] Submitting patch?
</A></li>
	<LI>Next message: <A HREF="038824.html">[Mono-dev] build error (No rule to make target `../../../external/cecil/Mono.Collections.Generic/Collection.cs')
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38858">[ date ]</a>
              <a href="thread.html#38858">[ thread ]</a>
              <a href="subject.html#38858">[ subject ]</a>
              <a href="author.html#38858">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
