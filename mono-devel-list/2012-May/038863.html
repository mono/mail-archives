<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] problem every 8k with using Microsoft Exchange Web Services Managed API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20problem%20every%208k%20with%20using%20Microsoft%20Exchange%20Web%0A%20Services%20Managed%20API&In-Reply-To=%3C1502166295705340B3F94F2480FEA3153E19B21C23%40EXCHANGE%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038861.html">
   <LINK REL="Next"  HREF="038864.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] problem every 8k with using Microsoft Exchange Web Services Managed API</H1>
    <B>Belis, Joeri</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20problem%20every%208k%20with%20using%20Microsoft%20Exchange%20Web%0A%20Services%20Managed%20API&In-Reply-To=%3C1502166295705340B3F94F2480FEA3153E19B21C23%40EXCHANGE%3E"
       TITLE="[Mono-dev] problem every 8k with using Microsoft Exchange Web Services Managed API">j.belis at be.pgz.eu
       </A><BR>
    <I>Tue May 15 13:35:00 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="038861.html">[Mono-dev] problem every 8k with using Microsoft Exchange Web Services Managed API
</A></li>
        <LI>Next message: <A HREF="038864.html">[Mono-dev] Regression with Linux update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38863">[ date ]</a>
              <a href="thread.html#38863">[ thread ]</a>
              <a href="subject.html#38863">[ subject ]</a>
              <a href="author.html#38863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Doing some more investigation i found that the soap messages contains a base64 encoded string which is the attachment .

When i decode it manualy from the soap messages , i get the correct file.

Is there a base64 decode problem with mono?

Van: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] Namens Belis, Joeri
Verzonden: maandag 14 mei 2012 17:04
Aan: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Onderwerp: [Mono-dev] problem every 8k with using Microsoft Exchange Web Services Managed API

Using the Microsoft Exchange Web Services Managed API on linux with mono te extract attachments from exchange server gives an error in the extracted attachment every 8K
At byte 8192 and 16384 ( and i guess after every 8k block ) it is loosing data.

I got only my code working in linux/mono because the TimeZoneInfo did not work on windows/mono

Example code

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Exchange.WebServices.Data;
using System.Net;

namespace Exchange_SDP_Attachment_Extracter
{
    public class PgzExchangeService
    {
        public void Extract()
        {
            ExchangeService service = new ExchangeService  (ExchangeVersion.Exchange2007_SP1,TimeZoneInfo.CreateCustomTimeZone(&quot;Central Standard Time&quot;,new TimeSpan(-6, 0, 0),&quot;(GMT-06:00) Central Time (US &amp; Canada)&quot;,&quot;Central Standard Time&quot;));
            service.Credentials = new NetworkCredential(&quot;user&quot;, &quot;pass&quot;, &quot;domain&quot;);
            service.Url = new Uri(&quot;<A HREF="https://xx.xx.xx.xx/EWS/Exchange.asmx">https://xx.xx.xx.xx/EWS/Exchange.asmx</A>&quot;);
            ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };

            FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, new ItemView(10));
            foreach (Item item in findResults.Items)
            {
                EmailMessage e = EmailMessage.Bind
                                 (service,
                                   item.Id,
                                   new PropertySet(BasePropertySet.IdOnly, ItemSchema.Attachments));
                foreach ( Attachment att in e.Attachments )
                {

                    if (att is FileAttachment)
                    {
                        FileAttachment fileAttachment = (FileAttachment)att;
                        fileAttachment.Load(@&quot;/tmp/testsdp/&quot; + fileAttachment.Name);
                    }
                }

            }
        }
    }

    class Program
    {
         static void Main(string[] args)
         {
             PgzExchangeService pgz = new PgzExchangeService();
             pgz.Extract();
         }
      }
}

________________________________
Please consider the environment before printing this e-mail

The information as contained in this communication is confidential and may be legally privileged. It is intended solely for the use of the individual or entity to whom it is addressed and others authorized to receive it. If you are not the intended recipient you are hereby (a): notified that any disclosure, copying, distribution or taking any action with respect to the content of this information is strictly prohibited and may be unlawful, and (b): kindly requested to inform the sender immediately and destroy any copies.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120515/b2a9284c/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120515/b2a9284c/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038861.html">[Mono-dev] problem every 8k with using Microsoft Exchange Web Services Managed API
</A></li>
	<LI>Next message: <A HREF="038864.html">[Mono-dev] Regression with Linux update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38863">[ date ]</a>
              <a href="thread.html#38863">[ thread ]</a>
              <a href="subject.html#38863">[ subject ]</a>
              <a href="author.html#38863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
