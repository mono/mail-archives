<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] XML deserialization - System.FormatException	on System.DateTime.ParseExact()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20XML%20deserialization%20-%20System.FormatException%0A%09on%20System.DateTime.ParseExact%28%29&In-Reply-To=98EF19D4430ACA4399BA1F75E761F8AA03326371%40dubexchmb01.bseu.bsroot.bear.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012103.html">
   <LINK REL="Next"  HREF="012108.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] XML deserialization - System.FormatException	on System.DateTime.ParseExact()</H1>
    <B>Lluis Sanchez</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20XML%20deserialization%20-%20System.FormatException%0A%09on%20System.DateTime.ParseExact%28%29&In-Reply-To=98EF19D4430ACA4399BA1F75E761F8AA03326371%40dubexchmb01.bseu.bsroot.bear.com"
       TITLE="[Mono-devel-list] XML deserialization - System.FormatException	on System.DateTime.ParseExact()">lluis at ximian.com
       </A><BR>
    <I>Mon May 30 03:43:06 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012103.html">[Mono-devel-list] XML deserialization - System.FormatException	on	System.DateTime.ParseExact()
</A></li>
        <LI>Next message: <A HREF="012108.html">[Fwd: Re: [Mono-devel-list] Re: [Mono-patches] r44988 -	in	trunk/mcs/class/System.Data: System.Data Test/System.Data]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12148">[ date ]</a>
              <a href="thread.html#12148">[ thread ]</a>
              <a href="subject.html#12148">[ subject ]</a>
              <a href="author.html#12148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Can you please file a bug report in bugzilla.ximian.com, attaching a
simple test application that can be used to reproduce the issue?

The solution will be to be compatible with MS.NET, even if that means
not being fully compatible with the specs.

Lluis.

On dj, 2005-05-26 at 16:05 +0100, Hickey, Damian (Exchange) wrote:
&gt;<i> Hi All,
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> This is my first foray into the land of Mono after a few years on
</I>&gt;<i> MS .Net. and am very happy with the level of compatibility. I've just
</I>&gt;<i> subbed to this mailing list, so if I break any rules do let me know...
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> I'm having a problem with XML deserialization and am wondering if it&#8217;s
</I>&gt;<i> a bug related to 71290 (<A HREF="http://bugzilla.ximian.com/show_bug.cgi?">http://bugzilla.ximian.com/show_bug.cgi?</A>
</I>&gt;<i> id=71290) or not and if anyone can help? The code works under MS.Net
</I>&gt;<i> 1.1, but not Mono 1.1.7 (on Windows XP).
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> So I have this simple piece of xml:
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> &lt;InventoryPositionBase
</I>&gt;<i> xmlns=&quot;urn:company.com:Application.Messages:v1.0&quot;&gt;
</I>&gt;<i> 
</I>&gt;<i>   &lt;ProductId&gt;9496&lt;/ProductId&gt;
</I>&gt;<i> 
</I>&gt;<i>   &lt;PortfolioId&gt;175&lt;/PortfolioId&gt;
</I>&gt;<i> 
</I>&gt;<i>   &lt;PublishDate&gt;2005-05-25-04:00&lt;/PublishDate&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;/InventoryPositionBase&gt;
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> And during deserialization the following exception is thrown:
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> System.Reflection.TargetInvocationException: Exception has been thrown
</I>&gt;<i> by the target of an invocation. ---&gt; System.FormatException: Invalid
</I>&gt;<i> format.
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x000fe&gt; System.DateTime:ParseExact (System.String s,
</I>&gt;<i> System.String[] formats, IFormatProvider fp, DateTimeStyles style)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00040&gt; System.DateTime:ParseExact (System.String s,
</I>&gt;<i> System.String format, IFormatProvider fp, DateTimeStyles style)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00019&gt; System.DateTime:ParseExact (System.String s,
</I>&gt;<i> System.String format, IFormatProvider fp)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x0050f&gt;
</I>&gt;<i> Mono.GeneratedSerializers.Literal.GeneratedReader:ReadObject_InventoryPositionBaseData (Boolean isNullable, Boolean checkType)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00086&gt;
</I>&gt;<i> Mono.GeneratedSerializers.Literal.GeneratedReader:ReadRoot_InventoryPositionBaseData ()
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00000&gt; &lt;unknown method&gt;
</I>&gt;<i> 
</I>&gt;<i> in (wrapper managed-to-native)
</I>&gt;<i> System.Reflection.MonoMethod:InternalInvoke (object,object[])
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x0006f&gt; System.Reflection.MonoMethod:Invoke (System.Object obj,
</I>&gt;<i> BindingFlags invokeAttr, System.Reflection.Binder binder ,
</I>&gt;<i> System.Object[] parameters, System.Globalization.CultureInfo culture)
</I>&gt;<i> 
</I>&gt;<i> --- End of inner exception stack trace ---
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00104&gt; System.Reflection.MonoMethod:Invoke (System.Object obj,
</I>&gt;<i> BindingFlags invokeAttr, System.Reflection.Binder binder,
</I>&gt;<i> System.Object[] parameters, System.Globalization.CultureInfo culture)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00017&gt; System.Reflection.MethodBase:Invoke (System.Object obj,
</I>&gt;<i> System.Object[] parameters)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00073&gt; System.Xml.Serialization.XmlSerializer:Deserialize
</I>&gt;<i> (System.Xml.Serialization.XmlSerializationReader reader)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x0004a&gt; System.Xml.Serialization.XmlSerializer:Deserialize
</I>&gt;<i> (System.Xml.XmlReader xmlReader)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x0003c&gt; System.Xml.Serialization.XmlSerializer:Deserialize
</I>&gt;<i> (System.IO.TextReader textReader)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00091&gt; Messages.Utility:Deserialize (System.Byte[] msg,
</I>&gt;<i> System.Type type)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x0009c&gt; &#8230;
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> I managed to grab the emitted code that performs the xml to object
</I>&gt;<i> parsing and it looks like the problem occurs when parsing the
</I>&gt;<i> &lt;PublishDate&gt; element during the ReadObject_InventoryPositionBaseData
</I>&gt;<i> method.  The offending line of code:
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ob. at PublishDate</A> = DateTime.ParseExact(Reader.ReadElementString (),
</I>&gt;<i> &quot;yyyy-MM-dd&quot;, CultureInfo.InvariantCulture);
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> The problem here is that the datetime in the xml does not, and
</I>&gt;<i> probably never will, match the format (2nd parameter) in the above
</I>&gt;<i> statement. This format does not take into account a time or timezone
</I>&gt;<i> component i.e. 2005-05-26T16:01:36+01:00
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Is this a bug or have I done something completely wrong?
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Help and ideas appreciated.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> All the best,
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Damian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> fitxer adjunt Document de text pla (Disclaimer.txt)
</I>&gt;<i> 
</I>&gt;<i> **********************************************************************
</I>&gt;<i> Please be aware that, notwithstanding the fact that the person sending
</I>&gt;<i> this communication has an address in Bear Stearns' e-mail system, this
</I>&gt;<i> person is not an employee, agent or representative of Bear Stearns.
</I>&gt;<i> Accordingly, this person has no power or authority to represent, make
</I>&gt;<i> any recommendation, solicitation, offer or statements or disclose
</I>&gt;<i> information on behalf of or in any way bind Bear Stearns or any of its
</I>&gt;<i> affiliates.
</I>&gt;<i> **********************************************************************
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012103.html">[Mono-devel-list] XML deserialization - System.FormatException	on	System.DateTime.ParseExact()
</A></li>
	<LI>Next message: <A HREF="012108.html">[Fwd: Re: [Mono-devel-list] Re: [Mono-patches] r44988 -	in	trunk/mcs/class/System.Data: System.Data Test/System.Data]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12148">[ date ]</a>
              <a href="thread.html#12148">[ thread ]</a>
              <a href="subject.html#12148">[ subject ]</a>
              <a href="author.html#12148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
