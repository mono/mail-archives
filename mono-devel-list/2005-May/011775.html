<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] export &quot;C&quot; issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20export%20%22C%22%20issues&In-Reply-To=20050501034229.79443.qmail%40web51902.mail.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="011776.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] export &quot;C&quot; issues</H1>
    <B>Marcus</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20export%20%22C%22%20issues&In-Reply-To=20050501034229.79443.qmail%40web51902.mail.yahoo.com"
       TITLE="[Mono-devel-list] export &quot;C&quot; issues">mathpup at mylinuxisp.com
       </A><BR>
    <I>Sun May  1 00:56:42 EDT 2005</I>
    <P><UL>
        
        <LI>Next message: <A HREF="011776.html">[Mono-devel-list] Can you ..!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11775">[ date ]</a>
              <a href="thread.html#11775">[ thread ]</a>
              <a href="subject.html#11775">[ subject ]</a>
              <a href="author.html#11775">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I do not fully understand what you are asking, but I can try to help. I'm not 
familiar with directive 'export &quot;C&quot; ', although I have used `extern &quot;C&quot;'.

In any case, when a library is compiled as C++, the symbols in the resulting 
binary will be mangled. For example, _Z16freyjaCSharpTestv looks like the 
kind of mangled name that GCC &gt;= 3.0 generates. It varies from compiler to 
compiler. The Mono runtime does not know about mangling, so with

[DllImport(libname, EntryPoint=&quot;freyjaSpawn&quot;)]
public extern static void run();

the runtime looks for a name &quot;freyjaSpawn&quot; and does not find it because the 
actual symbol in the library appears as _Z.... [mangled name].

The mangling varies from compiler to compiler (MS's C++ compilers mangle 
symbols very differently from GCC) and from version to version. GCC prior to 
3.0 mangled symbols in a completely different way from GCC since 3.0. But 
even within the 3.x series of GCC there have been changes to mangling (due to 
misinterpretations of the mangling documentation, as far as I know).

Marcus



On Saturday 30 April 2005 10:42 pm, Mongoose wrote:
&gt;<i> I have confirmed it.  C export won't work with
</I>&gt;<i> DllImport.
</I>&gt;<i>
</I>&gt;<i> C#
</I>&gt;<i> ------------
</I>&gt;<i> 	[DllImport(libname,
</I>&gt;<i> EntryPoint=&quot;_Z16freyjaCSharpTestv&quot;)]
</I>&gt;<i> 	public extern static void run2();
</I>&gt;<i>
</I>&gt;<i> 	[DllImport(libname, EntryPoint=&quot;freyjaSpawn&quot;)]
</I>&gt;<i> 	public extern static void run();
</I>&gt;<i>
</I>&gt;<i> C++
</I>&gt;<i> -------------
</I>&gt;<i> export &quot;C&quot; {
</I>&gt;<i>    void freyjaSpawn();
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> void freyjaCSharpTest();
</I>&gt;<i>
</I>&gt;<i> Test() imports and Spawn() doesn't.  Test is actually
</I>&gt;<i> a C++ function that calls Spawn, so I guess I can use
</I>&gt;<i> mangled symbols for binary releases until mono is
</I>&gt;<i> fixed.  I may write an auto demangler in C# if it's
</I>&gt;<i> too much work to resymbol every build.  =)
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="011776.html">[Mono-devel-list] Can you ..!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11775">[ date ]</a>
              <a href="thread.html#11775">[ thread ]</a>
              <a href="subject.html#11775">[ subject ]</a>
              <a href="author.html#11775">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
