<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] XML deserialization - System.FormatException	on	System.DateTime.ParseExact()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20XML%20deserialization%20-%20System.FormatException%0A%09on%09System.DateTime.ParseExact%28%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012122.html">
   <LINK REL="Next"  HREF="012147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] XML deserialization - System.FormatException	on	System.DateTime.ParseExact()</H1>
    <B>Hickey, Damian (Exchange)</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20XML%20deserialization%20-%20System.FormatException%0A%09on%09System.DateTime.ParseExact%28%29&In-Reply-To="
       TITLE="[Mono-devel-list] XML deserialization - System.FormatException	on	System.DateTime.ParseExact()">DHickey at Bear.com
       </A><BR>
    <I>Fri May 27 06:46:58 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012122.html">[Mono-devel-list] Do we really need &quot;related location&quot; for CS0136?
</A></li>
        <LI>Next message: <A HREF="012147.html">[Mono-devel-list] XML deserialization - System.FormatException	on	System.DateTime.ParseExact()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12123">[ date ]</a>
              <a href="thread.html#12123">[ thread ]</a>
              <a href="subject.html#12123">[ subject ]</a>
              <a href="author.html#12123">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Atsushi,

Thank you for your reply :)

I do have an XSD that describes that piece of XML and the type is
xs:date, I am using a codegen tool (a modified xsd.exe) to create
classes from the XSD; the output of which, &quot;PublishedDate&quot; type is
System.DateTime, and has an attribute
[System.Xml.Serialization.XmlElementAttribute(DataType=&quot;date&quot;)]. 

According to W3C, xs:date can have an optional timezone property
(<A HREF="http://www.w3.org/TR/xmlschema-2/#date">http://www.w3.org/TR/xmlschema-2/#date</A>) so &quot;yyyy-MM-dd&quot; pattern will
fail if a timezone is present.

Your patch seems resemble the output from MS.NET serializer on my class,
which is:

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">o. at PublishDate</A> = ToDate(Reader.ReadElementString());

Thanks again, looking forward to 1.1.8!

- Damian



-----Original Message-----
From: Atsushi Eno [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushi at ximian.com</A>] 
Sent: 26 May 2005 17:17
To: Hickey, Damian (Exchange)
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>; Lluis Sanchez
Subject: Re: [Mono-devel-list] XML deserialization -
System.FormatException on System.DateTime.ParseExact()

Hello,

&gt;<i> System.Reflection.TargetInvocationException: Exception has been thrown
</I>&gt;<i> by the target of an invocation. ---&gt; System.FormatException: Invalid
</I>&gt;<i> format.
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x000fe&gt; System.DateTime:ParseExact (System.String s,
</I>&gt;<i> System.String[] formats, IFormatProvider fp, DateTimeStyles style)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00040&gt; System.DateTime:ParseExact (System.String s,
</I>System.String
&gt;<i> format, IFormatProvider fp, DateTimeStyles style)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x00019&gt; System.DateTime:ParseExact (System.String s,
</I>System.String
&gt;<i> format, IFormatProvider fp)
</I>&gt;<i> 
</I>&gt;<i> in &lt;0x0050f&gt;
</I>&gt;<i>
</I>Mono.GeneratedSerializers.Literal.GeneratedReader:ReadObject_InventoryPo
&gt;<i> sitionBaseData (Boolean isNullable, Boolean checkType)
</I>
&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ob. at PublishDate</A> = DateTime.ParseExact (Reader.ReadElementString (),
</I>&gt;<i> &quot;yyyy-MM-dd&quot;, CultureInfo.InvariantCulture);
</I>&gt;<i> 
</I>&gt;<i> The problem here is that the datetime in the xml does not, and
</I>probably
&gt;<i> never will, match the format (2nd parameter) in the above statement.
</I>&gt;<i> This format does not take into account a time or timezone component
</I>i.e.
&gt;<i> 2005-05-26T16:01:36+01:00
</I>
Maybe your &quot;PublishedDate&quot; is xs:date, since &quot;yyyy-MM-dd&quot; pattern
is used only for xs:date type. If the type is xs:dateTime, then
XmlConert.ToDateTime() will be used (and it allows many more
patterns). If it is allowed in MS.NET, maybe attached patch will
fix it.

Lluis: maybe you can check the patch sanity?

Atsushi Eno





**********************************************************************
Please be aware that, notwithstanding the fact that the person sending
this communication has an address in Bear Stearns' e-mail system, this
person is not an employee, agent or representative of Bear Stearns.
Accordingly, this person has no power or authority to represent, make
any recommendation, solicitation, offer or statements or disclose
information on behalf of or in any way bind Bear Stearns or any of its
affiliates.
**********************************************************************


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012122.html">[Mono-devel-list] Do we really need &quot;related location&quot; for CS0136?
</A></li>
	<LI>Next message: <A HREF="012147.html">[Mono-devel-list] XML deserialization - System.FormatException	on	System.DateTime.ParseExact()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12123">[ date ]</a>
              <a href="thread.html#12123">[ thread ]</a>
              <a href="subject.html#12123">[ subject ]</a>
              <a href="author.html#12123">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
