<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Patch for Mono returns bigint as decimal in	SqlClient
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Patch%20for%20Mono%20returns%20bigint%20as%20decimal%20in%0A%09SqlClient&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011946.html">
   <LINK REL="Next"  HREF="011940.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Patch for Mono returns bigint as decimal in	SqlClient</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Patch%20for%20Mono%20returns%20bigint%20as%20decimal%20in%0A%09SqlClient&In-Reply-To="
       TITLE="[Mono-devel-list] Patch for Mono returns bigint as decimal in	SqlClient">kornelpal at hotmail.com
       </A><BR>
    <I>Fri May 13 18:30:39 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011946.html">[Mono-devel-list] Re: glibc not Making on Solaris 2.9 so can't	get mono working correctly
</A></li>
        <LI>Next message: <A HREF="011940.html">[Mono-devel-list] Better Patch for Mono returns bigint as decimal	in SqlClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11939">[ date ]</a>
              <a href="thread.html#11939">[ thread ]</a>
              <a href="subject.html#11939">[ subject ]</a>
              <a href="author.html#11939">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

The bug is reported very often:

<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=53169">http://bugzilla.ximian.com/show_bug.cgi?id=53169</A>
<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=62390">http://bugzilla.ximian.com/show_bug.cgi?id=62390</A>
<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=69768">http://bugzilla.ximian.com/show_bug.cgi?id=69768</A>
<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=74856">http://bugzilla.ximian.com/show_bug.cgi?id=74856</A>

This means that this should be corrected.

The problem is that Mono uses TDS 7.0 and it returns bigint as
decimal(19,0).

This could be solved by implementing a TDS 8.0 client but it requires
time...:)

The bug reports pointed out that the problem occurs when using SqlDataReader
with typed result processing to get the best performance.

Bigint should be get using GetSqlInt64 or GetInt64 but on Mono it isn't
Int64.

I attached a patch that works around the limitation of TDS 7.0 by enabling
GetSqlInt64 and GetInt64 on decimals that can be bigint (the original type
cannot be determined).

If you think this is a good solution please post it to SVN otherwise pleas
comment the code.

Sincerely,
Korn&#233;l
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SqlDataReader.diff
Type: application/octet-stream
Size: 1136 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050514/75525bc0/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050514/75525bc0/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011946.html">[Mono-devel-list] Re: glibc not Making on Solaris 2.9 so can't	get mono working correctly
</A></li>
	<LI>Next message: <A HREF="011940.html">[Mono-devel-list] Better Patch for Mono returns bigint as decimal	in SqlClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11939">[ date ]</a>
              <a href="thread.html#11939">[ thread ]</a>
              <a href="subject.html#11939">[ subject ]</a>
              <a href="author.html#11939">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
