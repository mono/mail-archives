<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Patch for environment specific location for .mono folder
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%20for%20environment%20specific%20location%20for%20.mono%20folder&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035142.html">
   <LINK REL="Next"  HREF="035144.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Patch for environment specific location for .mono folder</H1>
    <B>Tom Philpot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%20for%20environment%20specific%20location%20for%20.mono%20folder&In-Reply-To="
       TITLE="[Mono-dev] Patch for environment specific location for .mono folder">tom.philpot at logos.com
       </A><BR>
    <I>Tue Jun  1 12:44:42 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035142.html">[Mono-dev] _wapi_connect stuck in poll()
</A></li>
        <LI>Next message: <A HREF="035144.html">[Mono-dev] Patch for environment specific location for .mono folder
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35143">[ date ]</a>
              <a href="thread.html#35143">[ thread ]</a>
              <a href="subject.html#35143">[ subject ]</a>
              <a href="author.html#35143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Attached is a patch that allows the user (or an embedded application) to set MONO_USER_CONFIG to specify a directory location for the .mono folder, similar to the MONO_CONFIG environment variable for mono configuration folder.

We have an app which embeds Mono and we'd like to be certain that other Mono apps won't be tinkering with our configuration. This also allows us to make sure that the .mono folder can be created/updated as certain users don't have write access to their home folder, but do have access to sub-folders. We'd prefer not to have to ask for elevated permissions just to create a hidden config folder. Finally, this allows our application not to scatter configuration information throughout the file system as we can put all our configuration under an application specific folder.

This patch is MIT/X11 licensed.


Index: mono-config.c
===================================================================
--- mono-config.c	(revision 158291)
+++ mono-config.c	(working copy)
@@ -560,7 +560,9 @@
 	g_free (mono_cfg);
 
 #ifndef TARGET_WIN32
-	home = g_get_home_dir ();
+	home = g_getenv (&quot;MONO_USER_CONFIG&quot;);
+	if (home == NULL)
+		home = g_get_home_dir ();
 	user_cfg = g_strconcat (home, G_DIR_SEPARATOR_S, &quot;.mono/config&quot;, NULL);
 	mono_config_parse_file (user_cfg);
 	g_free (user_cfg);

Thanks,
Tom
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035142.html">[Mono-dev] _wapi_connect stuck in poll()
</A></li>
	<LI>Next message: <A HREF="035144.html">[Mono-dev] Patch for environment specific location for .mono folder
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35143">[ date ]</a>
              <a href="thread.html#35143">[ thread ]</a>
              <a href="subject.html#35143">[ subject ]</a>
              <a href="author.html#35143">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
