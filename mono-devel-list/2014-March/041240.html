<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Library path bug in Makefile?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Library%20path%20bug%20in%20Makefile%3F&In-Reply-To=%3Ccdb93a7fb0aa45e3a62e1608485d1732%40BL2PR08MB451.namprd08.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041238.html">
   <LINK REL="Next"  HREF="041241.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Library path bug in Makefile?</H1>
    <B>Edward Ned Harvey (mono)</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Library%20path%20bug%20in%20Makefile%3F&In-Reply-To=%3Ccdb93a7fb0aa45e3a62e1608485d1732%40BL2PR08MB451.namprd08.prod.outlook.com%3E"
       TITLE="[Mono-dev] Library path bug in Makefile?">edward.harvey.mono at clevertrove.com
       </A><BR>
    <I>Thu Mar  6 02:09:45 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="041238.html">[Mono-dev] Library path bug in Makefile?
</A></li>
        <LI>Next message: <A HREF="041241.html">[Mono-dev] Library path bug in Makefile?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41240">[ date ]</a>
              <a href="thread.html#41240">[ thread ]</a>
              <a href="subject.html#41240">[ subject ]</a>
              <a href="author.html#41240">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:mono-devel-list-
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bounces at lists.ximian.com</A>] On Behalf Of Robert Jordan
</I>&gt;<i> 
</I>&gt;<i> Non-default Mono installations still need LD_LIBRARY_PATH, otherwise
</I>&gt;<i> p/invoke of Mono libraries (libgdiplus, libMonoPosixHelper) won't
</I>&gt;<i> work because p/invoke is obeying the CLR rules of library look-up
</I>&gt;<i> that know nothing about ELF RPATH attributes.
</I>
If you install packages that depend on mono with the package manager (yum, apt, whatever) they will be dependent on the packaged version of mono (emphasis on &quot;packaged version&quot;), because the dependent packages were built linking against that particular build of mono in that particular location.  You won't be able to install such dependent packages, unless you *also* install the packaged version of mono.  (And you'll consequently be limited to whatever version of mono is available in that OS distribution, which I've mentioned, is 2.4.3 for RHEL/Centos, and 2.10.8 for Ubuntu 1204 LTS).  

If you build mono from source, intending to actually use it and not install the old distribution package, then of course you won't be able to use the dependent packages from the package manager - you'll have to also build the dependent packages from source if you want them.  In which case, the dependent package ./configure script won't be able to find mono, they'll complain and ask you to specify ./configure --mono-path=PATH 


&gt;<i> Moreover, things like pkg-config need to be configured as well,
</I>&gt;<i> because they also know nothing about mono's executable RPATH.
</I>
Isn't this relevant only when/if building a packaged version of something dependent on the mono package?

One thing here I'll definitely agree with:  It is best to manage packages with a package manager.  Roll your own mono-3.2.6 rpm or deb file, and later, roll your own mono-3.2.8, and &quot;rpm update&quot; or &quot;deb update.&quot;  But I have to say, learning to roll your own packages is difficult.  Building from source is easy.  (At least for mono.)


&gt;<i> The only thing you'd achieve by setting the RPATH attribute:
</I>&gt;<i> you won't be able to safely relocate Mono anymore, as RPATH
</I>&gt;<i> takes precedence over LD_LIBRARY_PATH.
</I>
So ...  <A HREF="http://blog.tremily.us/posts/rpath/">http://blog.tremily.us/posts/rpath/</A>

I wasn't talking about setting RPATH.  I was talking about setting RUN_PATH.  Which you could override, if you wanted to, by setting the LD_LIBRARY_PATH.

Also, what do you mean &quot;relocate?&quot;  It seems, without setting it, you're expected to never relocate to any location other than the system root.  (/lib, /usr/lib, /usr/local/lib).

The thing that would be achieved by setting the RUN_PATH of the mono executable is that mono itself would be able to run without problem.

I reiterate:

If you build mono with --prefix=PATH, then you can safely assume, the mono binary installed in PATH/bin will require the libraries in PATH/lib.

If a user adds PATH to their PATH, it would be desirable that they could simply run mono without it failing.  Or, if they specify on the command line, /PATH/bin/mono, then again, it would be desirable for mono to be able to run without failing.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041238.html">[Mono-dev] Library path bug in Makefile?
</A></li>
	<LI>Next message: <A HREF="041241.html">[Mono-dev] Library path bug in Makefile?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41240">[ date ]</a>
              <a href="thread.html#41240">[ thread ]</a>
              <a href="subject.html#41240">[ subject ]</a>
              <a href="author.html#41240">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
