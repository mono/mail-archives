<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Sgen SIGSEGV
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Sgen%20SIGSEGV&In-Reply-To=%3CCAC9RQtheY%3D6bu69ad8CXZWs32Ph5y89pFZNU2%3Dcx52PgyoVQWg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041217.html">
   <LINK REL="Next"  HREF="041218.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Sgen SIGSEGV</H1>
    <B>Greg Young</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Sgen%20SIGSEGV&In-Reply-To=%3CCAC9RQtheY%3D6bu69ad8CXZWs32Ph5y89pFZNU2%3Dcx52PgyoVQWg%40mail.gmail.com%3E"
       TITLE="[Mono-dev] Sgen SIGSEGV">gregoryyoung1 at gmail.com
       </A><BR>
    <I>Sat Mar  1 13:24:15 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="041217.html">[Mono-dev] Sgen SIGSEGV
</A></li>
        <LI>Next message: <A HREF="041218.html">[Mono-dev] Crash on build
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41220">[ date ]</a>
              <a href="thread.html#41220">[ thread ]</a>
              <a href="subject.html#41220">[ subject ]</a>
              <a href="author.html#41220">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>testing back to 3.2.8 there are some other errors as well (I can't get
3.2.7 to build).

sgen used to be quite stable for our uses. I'm not sure what has happened.
We can normally get it to fail within a few minutes of running under load.

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7fffed5f1700 (LWP 16236)]
0x00000000005e1270 in alloc_obj (vtable=0x7ffff662e0e8, size=-1450344072,
    pinned=0, has_references=1) at sgen-marksweep.c:740
740 int size_index = MS_BLOCK_OBJ_SIZE_INDEX (size);
(gdb) backtrace
#0  0x00000000005e1270 in alloc_obj (vtable=0x7ffff662e0e8,
size=-1450344072,
    pinned=0, has_references=1) at sgen-marksweep.c:740
#1  0x00000000005fb5f4 in alloc_for_promotion (has_references=1,
    objsize=2844623224, obj=0x7ffff662df90 &quot;\350\340b\366\377\177&quot;,
    vtable=0x7ffff662e0e8) at sgen-simple-nursery.c:35
#2  copy_object_no_checks (obj=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">obj at entry</A>=0x7ffff662df90,
    queue=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">queue at entry</A>=0x983120 &lt;gray_queue&gt;) at sgen-copy-object.h:112
#3  0x00000000005fc382 in simple_nursery_serial_copy_object_from_obj (
    queue=0x983120 &lt;gray_queue&gt;, obj_slot=0x7fffd5fac5b0)
    at sgen-minor-copy-object.h:206
#4  simple_nursery_serial_scan_object (start=&lt;optimized out&gt;,
    queue=0x983120 &lt;gray_queue&gt;) at sgen-scan-object.h:64
#5  0x00000000005d8a6f in sgen_drain_gray_stack (max_objs=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">max_objs at entry</A>
=-1,
    ctx=...) at sgen-gc.c:1194
#6  0x00000000005de27e in collect_nursery (unpin_queue=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">unpin_queue at entry</A>
=0x0,
    finish_up_concurrent_mark=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">finish_up_concurrent_mark at entry</A>=0)
    at sgen-gc.c:2631
#7  0x00000000005de749 in collect_nursery (finish_up_concurrent_mark=0,
    unpin_queue=0x0) at sgen-gc.c:3547
#8  sgen_perform_collection (requested_size=4096, generation_to_collect=0,
    reason=0x70b51a &quot;Nursery full&quot;, wait_to_finish=0) at sgen-gc.c:3483
#9  0x00000000005f4b49 in mono_gc_alloc_obj_nolock (vtable=0x195aed8,
size=32)
    at sgen-alloc.c:288
#10 0x00000000005f4c14 in mono_gc_alloc_obj (vtable=0x195aed8, size=32)
    at sgen-alloc.c:465


and

Program received signal SIGABRT, Aborted.
[Switching to Thread 0x7fffee1f7700 (LWP 16125)]
0x00007ffff711bf77 in __GI_raise (sig=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sig at entry</A>=6)
    at ../nptl/sysdeps/unix/sysv/linux/raise.c:56
56 ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.
(gdb) backtrace
#0  0x00007ffff711bf77 in __GI_raise (sig=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sig at entry</A>=6)
    at ../nptl/sysdeps/unix/sysv/linux/raise.c:56
#1  0x00007ffff711f5e8 in __GI_abort () at abort.c:90
#2  0x0000000000638995 in monoeg_g_logv (log_domain=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">log_domain at entry</A>=0x0,
    log_level=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">log_level at entry</A>=G_LOG_LEVEL_ERROR,
    format=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">format at entry</A>=0x6418f8 &quot;* Assertion: should not be reached at
%s:%d\n&quot;, args=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">args at entry</A>=0x7fffee1f5da8) at goutput.c:175
#3  0x0000000000638ad6 in monoeg_assertion_message (
    format=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">format at entry</A>=0x6418f8 &quot;* Assertion: should not be reached at
%s:%d\n&quot;) at goutput.c:195
#4  0x00000000005fc6a6 in simple_nursery_serial_scan_object (
    start=&lt;optimized out&gt;, queue=0x983120 &lt;gray_queue&gt;)
    at sgen-scan-object.h:111
#5  0x00000000005d8a6f in sgen_drain_gray_stack (max_objs=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">max_objs at entry</A>
=-1,
    ctx=...) at sgen-gc.c:1194
#6  0x00000000005de27e in collect_nursery (unpin_queue=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">unpin_queue at entry</A>
=0x0,
    finish_up_concurrent_mark=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">finish_up_concurrent_mark at entry</A>=0)
    at sgen-gc.c:2631
#7  0x00000000005de749 in collect_nursery (finish_up_concurrent_mark=0,
    unpin_queue=0x0) at sgen-gc.c:3547
#8  sgen_perform_collection (requested_size=4096, generation_to_collect=0,
    reason=0x70b51a &quot;Nursery full&quot;, wait_to_finish=0) at sgen-gc.c:3483
#9  0x00000000005f4b49 in mono_gc_alloc_obj_nolock (
    vtable=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vtable at entry</A>=0xa1ec28, size=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">size at entry</A>=48) at sgen-alloc.c:288
#10 0x00000000005f4d44 in mono_gc_alloc_vector (vtable=0xa1ec28, size=48,
    max_length=16) at sgen-alloc.c:491
#11 0x00000000400141c9 in ?? ()


On Sat, Mar 1, 2014 at 2:12 PM, Greg Young &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">gregoryyoung1 at gmail.com</A>&gt; wrote:

&gt;<i> I should add that this is on trunk.
</I>&gt;<i>
</I>&gt;<i>  <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">greg at goblin</A>:~/src/EventStore/bin/eventstore/release/anycpu$ mono
</I>&gt;<i> --version
</I>&gt;<i> Mono JIT compiler version 3.4.0 (master/9c4c295 Pn Vas 28 17:26:05 EET
</I>&gt;<i> 2014)
</I>&gt;<i>
</I>&gt;<i> Vas=Feb
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Sat, Mar 1, 2014 at 2:03 PM, Greg Young &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">gregoryyoung1 at gmail.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> We can reproduce this reasonably easily under load.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> from gdb.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Program received signal SIGSEGV, Segmentation fault.
</I>&gt;&gt;<i> [Switching to Thread 0x7fffed7f2700 (LWP 3886)]
</I>&gt;&gt;<i> copy_object_no_checks (obj=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">obj at entry</A>=0x7ffff6683150,
</I>&gt;&gt;<i>     queue=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">queue at entry</A>=0x9831c0 &lt;gray_queue&gt;) at sgen-copy-object.h:110
</I>&gt;&gt;<i> 110 gboolean has_references = SGEN_VTABLE_HAS_REFERENCES (vt);
</I>&gt;&gt;<i> (gdb) backtrace
</I>&gt;&gt;<i> #0  copy_object_no_checks (obj=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">obj at entry</A>=0x7ffff6683150,
</I>&gt;&gt;<i>     queue=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">queue at entry</A>=0x9831c0 &lt;gray_queue&gt;) at sgen-copy-object.h:110
</I>&gt;&gt;<i> #1  0x00000000005fdec3 in simple_nursery_serial_copy_object_from_obj (
</I>&gt;&gt;<i>     queue=0x9831c0 &lt;gray_queue&gt;, obj_slot=0x7fffcc8c09c0)
</I>&gt;&gt;<i>     at sgen-minor-copy-object.h:206
</I>&gt;&gt;<i> #2  simple_nursery_serial_scan_object (start=&lt;optimized out&gt;,
</I>&gt;&gt;<i>     queue=0x9831c0 &lt;gray_queue&gt;) at sgen-scan-object.h:64
</I>&gt;&gt;<i> #3  0x00000000005d9aff in sgen_drain_gray_stack (max_objs=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">max_objs at entry</A>
</I>&gt;&gt;<i> =-1,
</I>&gt;&gt;<i>     ctx=...) at sgen-gc.c:1194
</I>&gt;&gt;<i> #4  0x00000000005df36e in collect_nursery (unpin_queue=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">unpin_queue at entry</A>
</I>&gt;&gt;<i> =0x0,
</I>&gt;&gt;<i>     finish_up_concurrent_mark=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">finish_up_concurrent_mark at entry</A>=0)
</I>&gt;&gt;<i>     at sgen-gc.c:2638
</I>&gt;&gt;<i> #5  0x00000000005df839 in collect_nursery (finish_up_concurrent_mark=0,
</I>&gt;&gt;<i>     unpin_queue=0x0) at sgen-gc.c:3554
</I>&gt;&gt;<i> #6  sgen_perform_collection (requested_size=4096,
</I>&gt;&gt;<i> generation_to_collect=0,
</I>&gt;&gt;<i>     reason=0x70b2e9 &quot;Nursery full&quot;, wait_to_finish=0) at sgen-gc.c:3490
</I>&gt;&gt;<i> #7  0x00000000005f5dd9 in mono_gc_alloc_obj_nolock (
</I>&gt;&gt;<i>     vtable=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">vtable at entry</A>=0xab8680, size=<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">size at entry</A>=576) at
</I>&gt;&gt;<i> sgen-alloc.c:288
</I>&gt;&gt;<i> #8  0x00000000005f5fe3 in mono_gc_alloc_vector (vtable=0xab8680,
</I>&gt;&gt;<i> size=576,
</I>&gt;&gt;<i>     max_length=270) at sgen-alloc.c:499
</I>&gt;&gt;<i> #9  0x00000000400147f9 in ?? ()
</I>&gt;&gt;<i> #10 0x00007fffb40025d0 in ?? ()
</I>&gt;&gt;<i> #11 0x0000000000000000 in ?? ()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Le doute n'est pas une condition agr&#233;able, mais la certitude est absurde.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Le doute n'est pas une condition agr&#233;able, mais la certitude est absurde.
</I>&gt;<i>
</I>


-- 
Le doute n'est pas une condition agr&#233;able, mais la certitude est absurde.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140301/1be44765/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140301/1be44765/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041217.html">[Mono-dev] Sgen SIGSEGV
</A></li>
	<LI>Next message: <A HREF="041218.html">[Mono-dev] Crash on build
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41220">[ date ]</a>
              <a href="thread.html#41220">[ thread ]</a>
              <a href="subject.html#41220">[ subject ]</a>
              <a href="author.html#41220">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
