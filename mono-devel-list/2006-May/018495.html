<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [WARNING : A/V UNSCANNABLE] RE:[Mono-dev]System.Web.UI.Pagepatch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BWARNING%20%3A%20A/V%20UNSCANNABLE%5D%20RE%3A%5BMono-dev%5DSystem.Web.UI.Pagepatch&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018489.html">
   <LINK REL="Next"  HREF="018496.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[WARNING : A/V UNSCANNABLE] RE:[Mono-dev]System.Web.UI.Pagepatch</H1>
    <B>Andrew Skiba</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BWARNING%20%3A%20A/V%20UNSCANNABLE%5D%20RE%3A%5BMono-dev%5DSystem.Web.UI.Pagepatch&In-Reply-To="
       TITLE="[WARNING : A/V UNSCANNABLE] RE:[Mono-dev]System.Web.UI.Pagepatch">andrews at mainsoft.com
       </A><BR>
    <I>Sun May  7 04:47:09 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018489.html">[Mono-dev] Mono Trace Leak patch
</A></li>
        <LI>Next message: <A HREF="018496.html">[Mono-dev] framework for system.web tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18495">[ date ]</a>
              <a href="thread.html#18495">[ thread ]</a>
              <a href="subject.html#18495">[ subject ]</a>
              <a href="author.html#18495">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Chris.

This website is cutted-down version of Personal Web Site starter kit
(<A HREF="http://msdn.microsoft.com/vstudio/express/vwd/starterkit/#personal">http://msdn.microsoft.com/vstudio/express/vwd/starterkit/#personal</A>).
Are you able to open this starter kit on your IIS? 
Somehow on my machine, login control is considering me as already logged
in. It's clear that in your case the login view went to
AnonymousTemplate and used Login1 control. Probably this asp:login needs
an edit control with ID UserName. I copied controls with IDs UserName,
Password and RememberMe to the attached website. Please try now.

Thank you.
Andrew.

&gt;<i> 
</I>&gt;<i> I wasn't running the test case on xsp at all.  This was with IIS.
</I>&gt;<i> 
</I>&gt;<i> also, the stack trace is interesting in that they're 
</I>&gt;<i> obviously using generics in asp.net 2.0.
</I>&gt;<i> 
</I>&gt;<i> Chris
</I>&gt;<i> 
</I>&gt;<i> On Thu, 2006-05-04 at 00:23 -0700, Andrew Skiba wrote:
</I>&gt;<i> &gt; I see. Sorry you did not write if the patch causes the problems, or 
</I>&gt;<i> &gt; unpatched XSP also fails. Can you at least test 
</I>&gt;<i> Page.Web.Config.patch?
</I>&gt;<i> &gt; This patch waits almost 2 weeks. It allows to assign the 
</I>&gt;<i> default theme 
</I>&gt;<i> &gt; or stylesheet theme for all pages in web.config. In the mean time I 
</I>&gt;<i> &gt; will see what's the problem with the testcase.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thank you.
</I>&gt;<i> &gt; Andrew.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; From: Chris Toshok [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">toshok at ximian.com</A>]
</I>&gt;<i> &gt; &gt; Sent: Monday, May 01, 2006 20:45
</I>&gt;<i> &gt; &gt; To: Andrew Skiba
</I>&gt;<i> &gt; &gt; Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; Subject: RE: [WARNING : A/V UNSCANNABLE] RE: 
</I>&gt;<i> &gt; &gt; [Mono-dev]System.Web.UI.Pagepatch
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; I have yet to successfully test your patch.  Hacking it 
</I>&gt;<i> together on 
</I>&gt;<i> &gt; &gt; windows gets me this (this is without using your custom 
</I>&gt;<i> controls.  
</I>&gt;<i> &gt; &gt; just the vanilla Default/master page):
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; [HttpException (0x80004005): Login1: LayoutTemplate does 
</I>&gt;<i> not contain 
</I>&gt;<i> &gt; &gt; an IEditableTextControl with ID UserName for the username.]
</I>&gt;<i> &gt; &gt;    
</I>&gt;<i> &gt; &gt; System.Web.UI.WebControls.GenericContainer`1.FindControl(Strin
</I>&gt;<i> &gt; &gt; g id, Boolean required, String errorResourceKey) +1716147
</I>&gt;<i> &gt; &gt;    System.Web.UI.WebControls.Login.get_UserNameInternal() +91
</I>&gt;<i> &gt; &gt;    
</I>&gt;<i> System.Web.UI.WebControls.Login.SetEditableChildProperties() +26
</I>&gt;<i> &gt; &gt;    System.Web.UI.WebControls.Login.CreateChildControls() +179
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.EnsureChildControls() +87
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.PreRenderRecursiveInternal() +41
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.PreRenderRecursiveInternal() +161
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.PreRenderRecursiveInternal() +161
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.PreRenderRecursiveInternal() +161
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.PreRenderRecursiveInternal() +161
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.PreRenderRecursiveInternal() +161
</I>&gt;<i> &gt; &gt;    System.Web.UI.Control.PreRenderRecursiveInternal() +161
</I>&gt;<i> &gt; &gt;    System.Web.UI.Page.ProcessRequestMain(Boolean
</I>&gt;<i> &gt; &gt; includeStagesBeforeAsyncPoint, Boolean
</I>&gt;<i> &gt; &gt; includeStagesAfterAsyncPoint) +1360
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Chris
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; On Sat, 2006-04-29 at 23:16 -0700, Andrew Skiba wrote:
</I>&gt;<i> &gt; &gt; &gt;  Hello, Chris.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; So can I commit these patches yet?
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Thank you.
</I>&gt;<i> &gt; &gt; &gt; Andrew.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; &gt; &gt; From: Chris Toshok [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">toshok at ximian.com</A>]
</I>&gt;<i> &gt; &gt; &gt; &gt; Sent: Tuesday, April 25, 2006 20:51
</I>&gt;<i> &gt; &gt; &gt; &gt; To: Andrew Skiba
</I>&gt;<i> &gt; &gt; &gt; &gt; Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; &gt; &gt; Subject: Re: [WARNING : A/V UNSCANNABLE] RE: [Mono-dev] 
</I>&gt;<i> &gt; &gt; &gt; &gt; System.Web.UI.Pagepatch
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; On Tue, 2006-04-25 at 02:16 -0700, Andrew Skiba wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; I'd like to see the test used for this as well.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Did you see the standalone test that I sent yesterday? For 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; convenience, I attach it to this message, too. It covers
</I>&gt;<i> &gt; &gt; &gt; &gt; the following patches:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; ApplyTheme.patch
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Page.Web.Config.patch
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; PageTheme.patch
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; At first blush the theme change looks ok, but I 
</I>&gt;<i> really don't 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; like the idea of adding the ApplyTheme behavior to OnInit.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; Unless, of course, this is what actually happens in MS's 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; implementation.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; It's not OnInit, it's in CreateChildControls flow. To
</I>&gt;<i> &gt; &gt; &gt; &gt; figure that out
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; in MS implementation I made this:
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; ah, sorry - I wasn't looking at the line numbers, I just 
</I>&gt;<i> &gt; &gt; &gt; &gt; searched for the surrounding patch context.
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 	public class MyLogin:Login
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 	{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		protected override void OnInit (EventArgs e)
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine (&quot;before Login.OnInit&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			base.OnInit (e);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine (&quot;after Login.OnInit&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		protected override void AddedControl
</I>&gt;<i> &gt; &gt; &gt; &gt; (System.Web.UI.Control control,
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; int index)
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine (&quot;before
</I>&gt;<i> &gt; &gt; Login.AddedControl&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			base.AddedControl (control, index);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine (&quot;after
</I>&gt;<i> &gt; &gt; Login.AddedControl&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		protected override void  CreateChildControls()
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine (&quot;before
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Login.CreateChildControls&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			base.CreateChildControls ();
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine (&quot;after
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Login.CreateChildControls&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 	}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 	public class MyImageButton:ImageButton
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 	{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		protected override void OnInit (EventArgs e)
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine (&quot;ImageButton.OnInit&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			base.OnInit (e);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		public override void ApplyStyleSheetSkin
</I>&gt;<i> &gt; &gt; &gt; &gt; (System.Web.UI.Page page)
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			Trace.WriteLine
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; (&quot;ImageButton.ApplyStyleSheetSkin&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			base.ApplyStyleSheetSkin (page);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		public override string ImageUrl
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			get
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 				return base.ImageUrl;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			set
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			{
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 				Trace.WriteLine (&quot;Set
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; ImageButton.ImageURL&quot;);
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 				base.ImageUrl = value;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 			}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 		}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 	}
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 	
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; and changed in aspx &lt;asp:login&gt; and &lt;asp:imagebutton&gt; to
</I>&gt;<i> &gt; &gt; &gt; &gt; &lt;my:MyLogin&gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; and &lt;my:MyImageButton&gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; the output looked like:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; before Login.OnInit
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; after Login.OnInit
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; before Login.CreateChildControls
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; ImageButton.ApplyStyleSheetSkin  	
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Set ImageButton.ImageURL		
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; before Login.AddedControl
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; ImageButton.OnInit
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; after Login.AddedControl
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; after Login.CreateChildControls
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; Also, the master page change doesn't seem 
</I>&gt;<i> necessary to me, 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; in the scope of the greater change. The controls 
</I>&gt;<i> will have 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; their OnInit methods's called properly when 
</I>&gt;<i> they're added to 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; the
</I>&gt;<i> &gt; &gt; &gt; &gt; already Init'ed
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; controls.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; If you do ApplyMasterPage after InitRecursive, then
</I>&gt;<i> &gt; &gt; &gt; &gt; elements defined
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; on master page do not get their themes. Just try the
</I>&gt;<i> &gt; &gt; &gt; &gt; standalone test I
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; sent, the difference is clear.
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; My comment was made under the assumption that the ApplyTheme 
</I>&gt;<i> &gt; &gt; &gt; &gt; call was in OnInit (as above.)
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; I'll take a look at this further tonight probably.
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; Chris
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>-------------- next part --------------
A non-text attachment was scrubbed...
Name: PageLinks.zip
Type: application/x-zip-compressed
Size: 12602 bytes
Desc: PageLinks.zip
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060507/a393bc90/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060507/a393bc90/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018489.html">[Mono-dev] Mono Trace Leak patch
</A></li>
	<LI>Next message: <A HREF="018496.html">[Mono-dev] framework for system.web tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18495">[ date ]</a>
              <a href="thread.html#18495">[ thread ]</a>
              <a href="subject.html#18495">[ subject ]</a>
              <a href="author.html#18495">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
