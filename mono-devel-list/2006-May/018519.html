<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] typeof(Byte[]).GetInterfacesMap
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20typeof%28Byte%5B%5D%29.GetInterfacesMap&In-Reply-To=6C1E68A331B0BB44B23EC9A74A896D24025E1AEF%40bac-exc-01.wylehou.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018499.html">
   <LINK REL="Next"  HREF="018520.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] typeof(Byte[]).GetInterfacesMap</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20typeof%28Byte%5B%5D%29.GetInterfacesMap&In-Reply-To=6C1E68A331B0BB44B23EC9A74A896D24025E1AEF%40bac-exc-01.wylehou.com"
       TITLE="[Mono-dev] typeof(Byte[]).GetInterfacesMap">jonpryor at vt.edu
       </A><BR>
    <I>Mon May  8 07:50:27 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018499.html">[Mono-dev] typeof(Byte[]).GetInterfacesMap
</A></li>
        <LI>Next message: <A HREF="018520.html">[Mono-dev] typeof(Byte[]).GetInterfacesMap
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18519">[ date ]</a>
              <a href="thread.html#18519">[ thread ]</a>
              <a href="subject.html#18519">[ subject ]</a>
              <a href="author.html#18519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2006-05-02 at 17:54 -0500, Voigt, Benjamin wrote:
&gt;<i> Would someone please be so kind as to run the following unit test on
</I>&gt;<i> Mono?
</I>
A similar test would likely be this:

        using System;
        using System.Reflection;
        
        class GetInterfaceMap
        {
            public static void Main ()
            {
                System.Type baseType = typeof(System.Byte[]);
                foreach (System.Type iface in baseType.GetInterfaces())
                {
                    Console.WriteLine(iface.FullName);
                    Console.WriteLine (baseType.GetInterfaceMap
        (iface));
                }
            }
        }

The above test prints out _nothing_.  This is because System.Byte[]
doesn't implement any interfaces, rather it's System.Byte[]'s _base_
type which implements all the interfaces, and Mono's
Type.GetInterfaces() method doesn't return the interfaces implemented by
the base type, but just the interfaces implemented by the specified
type.

Perhaps this is a bug (I don't have a .NET runtime to test against),
though it makes sense to me.

If we alter the test slightly to look through System.Byte[]'s _base_
type:

        using System;
        using System.Reflection;
        
        class GetInterfaceMap
        {
            public static void Main ()
            {
                System.Type baseType = typeof(System.Byte[]);
                foreach (System.Type iface in
                        baseType.BaseType.GetInterfaces())
                {
                    Console.WriteLine(iface.FullName);
                    InterfaceMapping map = 
                        baseType.GetInterfaceMap (iface);
                    Console.WriteLine(&quot;{0} ==&gt; {1}&quot;, 
                        map.TargetType, map.InterfaceType);
                }
            }
        }

This produces some actual output:

        System.Collections.Generic.IList`1[[System.Byte, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]
        System.Byte[] ==&gt; System.Collections.Generic.IList`1[System.Byte]
        System.Collections.Generic.ICollection`1[[System.Byte, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]
        System.Byte[] ==&gt; System.Collections.Generic.ICollection`1[System.Byte]
        System.Collections.Generic.IEnumerable`1[[System.Byte, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]
        System.Byte[] ==&gt; System.Collections.Generic.IEnumerable`1[System.Byte]
        System.Collections.IEnumerable
        System.Byte[] ==&gt; System.Collections.IEnumerable
        System.ICloneable
        System.Byte[] ==&gt; System.ICloneable
        System.Collections.ICollection
        System.Byte[] ==&gt; System.Collections.ICollection
        System.Collections.IList
        System.Byte[] ==&gt; System.Collections.IList

(The above output generated when the test program is compiled with gmcs,
so that .NET 2.0 interfaces are displayed.)

&gt;<i> System.Collections.Generic.IList`1[[System.Byte, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]
</I>&gt;<i> TestCase 'M:GetInterfaceMap.ByteArray' failed: Interface not found.
</I>&gt;<i> 	System.ArgumentException: Interface not found.
</I>&gt;<i> 	at System.RuntimeTypeHandle.GetFirstSlotForInterface(IntPtr interfaceHandle)
</I>&gt;<i> 	at System.RuntimeTypeHandle.GetFirstSlotForInterface(RuntimeTypeHandle interfaceHandle)
</I>&gt;<i> 	at System.RuntimeType.GetInterfaceMap(Type ifaceType)
</I>&gt;<i> 	Realtime\RealTimeTests\GetInterfaceMap.cs(13,0): at GetInterfaceMap.ByteArray()
</I>&gt;<i> 
</I>
Mono doesn't generate this exception.

 - Jon



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018499.html">[Mono-dev] typeof(Byte[]).GetInterfacesMap
</A></li>
	<LI>Next message: <A HREF="018520.html">[Mono-dev] typeof(Byte[]).GetInterfacesMap
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18519">[ date ]</a>
              <a href="thread.html#18519">[ thread ]</a>
              <a href="subject.html#18519">[ subject ]</a>
              <a href="author.html#18519">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
