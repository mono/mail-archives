<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] The first	(attempt	to	checkin)	managed	collation	patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20The%20first%09%28attempt%09to%09checkin%29%09managed%09collation%0A%09patch&In-Reply-To=1122225018.29721.79.camel%40linux.site">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013366.html">
   <LINK REL="Next"  HREF="013373.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] The first	(attempt	to	checkin)	managed	collation	patch</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20The%20first%09%28attempt%09to%09checkin%29%09managed%09collation%0A%09patch&In-Reply-To=1122225018.29721.79.camel%40linux.site"
       TITLE="[Mono-devel-list] The first	(attempt	to	checkin)	managed	collation	patch">atsushi at ximian.com
       </A><BR>
    <I>Sun Jul 24 14:26:48 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013366.html">[Mono-devel-list] The first	(attempt	to	checkin)	managed	collation patch
</A></li>
        <LI>Next message: <A HREF="013373.html">[Mono-devel-list] The	first	(attempt	to	checkin)	managed	collation patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13368">[ date ]</a>
              <a href="thread.html#13368">[ thread ]</a>
              <a href="subject.html#13368">[ subject ]</a>
              <a href="author.html#13368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

&gt;<i> Notice that I suggested &quot;GetManifestResourceInternal&quot;, not the similarly
</I>&gt;<i> named &quot;GetManifestStream&quot;.  The managed collaction code uses a Stream
</I>&gt;<i> interface.
</I>&gt;<i> 
</I>&gt;<i> What am suggesting is that instead of adding a new icall whose purpose
</I>&gt;<i> is to return an IntPtr + the size of a special-cased resource, you can
</I>&gt;<i> use GetManifestResourceInternal which does exactly the same thing.  The
</I>&gt;<i> difference is that the GetManifestResourceInternal works with resources,
</I>&gt;<i> while the new icall uses a new framework for fetching values.
</I>
Ok, I didn't notice that GetManifestResourceInternal() already exists,
so I made another change to use that directly.

&gt;<i> System.Web already has a framework for including resources, see
</I>&gt;<i> mcs/class/System.Web/Makefile for more details and this should be
</I>&gt;<i> working on both Windows and Linux (it seems very simple).
</I>
Oops, actually I might have experienced incorrect test that
csc looked to reject such options like /resource:unixpath/filename.
It actually worked, so there is no problem. I'd put those
resources to another directory then.

(BTW sys.web does not use resources for 1.x build. They are
only added when the profile is net_2_0).


Here are the new profile results for managed resource, without
stream, without BinaryReader, without managed array:

<A HREF="http://monkey.workarea.jp/tmp/20050725/prof-no-collation.txt">http://monkey.workarea.jp/tmp/20050725/prof-no-collation.txt</A>
<A HREF="http://monkey.workarea.jp/tmp/20050725/prof-managed-collation.txt">http://monkey.workarea.jp/tmp/20050725/prof-managed-collation.txt</A>

--- no-collation ---
Time(ms) Count   P/call(ms) Method name
41982.000   10228    4.105   Mono.CSharp.Block::Resolve(EmitContext)
Total memory allocated: 54110 KB

--- managed-collation ---
Time(ms) Count   P/call(ms) Method name
43226.000   10228    4.226   Mono.CSharp.Block::Resolve(EmitContext)
Total memory allocated: 54125 KB

The result looks good I guess :-)

Atsushi Eno

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013366.html">[Mono-devel-list] The first	(attempt	to	checkin)	managed	collation patch
</A></li>
	<LI>Next message: <A HREF="013373.html">[Mono-devel-list] The	first	(attempt	to	checkin)	managed	collation patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13368">[ date ]</a>
              <a href="thread.html#13368">[ thread ]</a>
              <a href="subject.html#13368">[ subject ]</a>
              <a href="author.html#13368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
