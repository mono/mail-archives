<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] malloc and free on CLI
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20malloc%20and%20free%20on%20CLI&In-Reply-To=20050719094713.wspkhenoxuusc84g%40kottalam.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013236.html">
   <LINK REL="Next"  HREF="013204.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] malloc and free on CLI</H1>
    <B>Jeyasankar Kottalam</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20malloc%20and%20free%20on%20CLI&In-Reply-To=20050719094713.wspkhenoxuusc84g%40kottalam.net"
       TITLE="[Mono-devel-list] malloc and free on CLI">mono at jey.kottalam.net
       </A><BR>
    <I>Tue Jul 19 12:58:10 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013236.html">[Mono-devel-list] malloc and free on CLI
</A></li>
        <LI>Next message: <A HREF="013204.html">[Mono-devel-list] [PATCH] Fix parsing of sort strings in DataTable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13237">[ date ]</a>
              <a href="thread.html#13237">[ thread ]</a>
              <a href="subject.html#13237">[ subject ]</a>
              <a href="author.html#13237">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;<i> Think of the following scenario: a library (say zlib) is compiled
</I>&gt;&gt;<i> to managed code (so we have zlib.dll).
</I>&gt;&gt;<i> Another existing C program that we want to compile to managed code
</I>&gt;&gt;<i> uses zlib (which means its sources include the zlib headers).
</I>&gt;&gt;<i> Now, the zlib headers do not contain any mapping attribute (and
</I>&gt;&gt;<i> IMHO they should stay as they are), so we need another way to tell
</I>&gt;&gt;<i> the C compiler how to map those calls.
</I>&gt;&gt;<i> I presume the C compiler generates a class with a lot of static
</I>&gt;&gt;<i> methods, one for each C function.
</I>&gt;&gt;<i> One easy way to specify the mapping outside of the header files
</I>&gt;&gt;<i> would be to tell the compiler &quot;all the static methods of these
</I>&gt;&gt;<i> classes are managed C functions, and they have precedence over
</I>&gt;&gt;<i> their unmanaged dllimported ones&quot;.
</I>&gt;&gt;<i> Since the C namespace (for linking) is flat, this should work very
</I>&gt;&gt;<i> well.
</I>&gt;<i>
</I>&gt;<i> My current plan is to use the linker to automatically determine and
</I>&gt;<i> resolve such
</I>&gt;<i> cases by generating the appropriate P/Invoke declarations. This is on my TODO
</I>&gt;<i> list for this week.
</I>&gt;<i>
</I>
I meant: generating P/Invoke declarations for the native calls, and the
appropriate 'metadata references' for the managed functions. We can 
address the
issue of conflicting unmanaged and managed libraries by specifying 
precedence to
the linker, but typically that problem should not occur, since you probably
would not specify both the managed and unmanaged zlib libraries to the linker
when linking your application.

-Jey Kottalam



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013236.html">[Mono-devel-list] malloc and free on CLI
</A></li>
	<LI>Next message: <A HREF="013204.html">[Mono-devel-list] [PATCH] Fix parsing of sort strings in DataTable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13237">[ date ]</a>
              <a href="thread.html#13237">[ thread ]</a>
              <a href="subject.html#13237">[ subject ]</a>
              <a href="author.html#13237">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
