<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] [PATCH] Detach console when executing	IMAGE_SUBSYSTEM_WINDOWS_GUI on win32
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20Detach%20console%20when%20executing%0A%09IMAGE_SUBSYSTEM_WINDOWS_GUI%20on%20win32&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013191.html">
   <LINK REL="Next"  HREF="013177.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] [PATCH] Detach console when executing	IMAGE_SUBSYSTEM_WINDOWS_GUI on win32</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20Detach%20console%20when%20executing%0A%09IMAGE_SUBSYSTEM_WINDOWS_GUI%20on%20win32&In-Reply-To="
       TITLE="[Mono-devel-list] [PATCH] Detach console when executing	IMAGE_SUBSYSTEM_WINDOWS_GUI on win32">kornelpal at hotmail.com
       </A><BR>
    <I>Sat Jul 16 09:24:02 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013191.html">[Mono-devel-list] Windows Build of Mono/Mcs
</A></li>
        <LI>Next message: <A HREF="013177.html">[Mono-devel-list] About bug 75566
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13176">[ date ]</a>
              <a href="thread.html#13176">[ thread ]</a>
              <a href="subject.html#13176">[ subject ]</a>
              <a href="author.html#13176">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

The expected behaviour for a windowed application on Win32 is to have no
console unless you attach one either by calling AllocConsole or
AttachConsole.

The problem is that console will be attached when the application has
IMAGE_SUBSYSTEM_WINDOWS_CUI and no console will be attached when it has
IMAGE_SUBSYSTEM_WINDOWS_GUI.

As mono.exe is the executable it's flags are in effect. When it is a CUI
application the console window will be crated anyway and if it's detached it
will be flicker. This is looks lame but this is the best solution. Note that
the Win32 installer creates .bat files that are executing mono.exe so a
console window would be crated anyway.

If it were a GUI application a no console were attached by default so there
were no flickering console windows. AttachConsole could be used but it
requires Windows XP, 2003 or later. And cmd.exe for example will not wait
for the application if the console is not attached by the operating system
(CUI flag). AllocConsole creates a new console window so this is not a
solution.

The only proper solution could be to use two separate mono.exe files. One
for CUI and one for GUI. But this is too complicated and Windows is not the
primary platform for Mono so I think detaching the console for GUI
applications is the best solution.

Please review the patch.

Korn&#233;l
-------------- next part --------------
A non-text attachment was scrubbed...
Name: driver.c.diff
Type: application/octet-stream
Size: 566 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050716/2989ddd7/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050716/2989ddd7/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013191.html">[Mono-devel-list] Windows Build of Mono/Mcs
</A></li>
	<LI>Next message: <A HREF="013177.html">[Mono-devel-list] About bug 75566
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13176">[ date ]</a>
              <a href="thread.html#13176">[ thread ]</a>
              <a href="subject.html#13176">[ subject ]</a>
              <a href="author.html#13176">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
