<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] malloc and free on CLI
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20malloc%20and%20free%20on%20CLI&In-Reply-To=BAY22-DAV33436AE4F9464D6249633A3D30%40phx.gbl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013181.html">
   <LINK REL="Next"  HREF="013183.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] malloc and free on CLI</H1>
    <B>Jeyasankar Kottalam</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20malloc%20and%20free%20on%20CLI&In-Reply-To=BAY22-DAV33436AE4F9464D6249633A3D30%40phx.gbl"
       TITLE="[Mono-devel-list] malloc and free on CLI">mono at jey.kottalam.net
       </A><BR>
    <I>Sat Jul 16 17:01:10 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013181.html">[Mono-devel-list] malloc and free on CLI
</A></li>
        <LI>Next message: <A HREF="013183.html">[Mono-devel-list] malloc and free on CLI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13182">[ date ]</a>
              <a href="thread.html#13182">[ thread ]</a>
              <a href="subject.html#13182">[ subject ]</a>
              <a href="author.html#13182">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Quoting Korn&#233;l P&#225;l &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at hotmail.com</A>&gt;:

&gt;<i> I think the libc should be written in C and compiled into a fully managed
</I>&gt;<i> assembly that could be part of Mono Class Library and could be installed to
</I>&gt;<i> the GAC. You were talking about C# in your previous message. I think it's
</I>&gt;<i> much easier and pretty to write it in C. Of course this will need a C
</I>&gt;<i> compiler but I think it's worth to wait until the compiler will be at least
</I>&gt;<i> partially complete. And it's much easier to port an existing libc to managed
</I>&gt;<i> C than to C#.
</I>
Yes, I agree. However, I still need a mechanism to implement a heap. Even if
porting an existing libc, that libc will need *some* mechanism to get memory
from the runtime. What is the recommended way of doing that?

I only referenced C# as a possible candidate to implement the malloc() and
free() in because it's easy to interface with the Mono Class Libraries using
C#. Then we could use whatever mechanisms are available in the Mono Class
Libraries to implement the heap. Otherwise I would need to implement the
mechanism to interface with CLI classes from C/C++ before I could even have a
functioning heap.

The backend is complete enough to start wondering about these things. 
It has not
been fully tested and has a number of known bugs, but it mostly works.

&gt;<i> The compiler and C runtime library are two different things and I think you
</I>&gt;<i> shouldn't be forced to forge a libc just to can compile an application that
</I>&gt;<i> uses libc. I think in the early stage the Mono Class Library should be used
</I>&gt;<i> instead of a libc. And of course implementing a libc is just as much work as
</I>&gt;<i> implementing a C compiler.
</I>
I agree, I won't be implementing an entire libc. I'm only interested in
implementing a subset of the libc for my own use. The heap is the only thing
really troubling me. I could simply use a statically allocated array as a pool
and do allocations from that for now... but that doesn't scale enough to try
any interesting applications.

When I have the time, I'll look into porting one of the small libc
implementations (e.g. newlib, uclibc) to Mono.

&gt;<i> So I think your implementation should not require libc and should link libc
</I>&gt;<i> as a managed assembly using metadata references to be platform independent.
</I>
If by &quot;not require libc&quot; you mean &quot;not require the native libc&quot;, that's what I
have in mind. Otherwise I would have used P/Invoke to make calls to the native
library. (and the heap problem would be a non-issue)

-Jey Kottalam



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013181.html">[Mono-devel-list] malloc and free on CLI
</A></li>
	<LI>Next message: <A HREF="013183.html">[Mono-devel-list] malloc and free on CLI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13182">[ date ]</a>
              <a href="thread.html#13182">[ thread ]</a>
              <a href="subject.html#13182">[ subject ]</a>
              <a href="author.html#13182">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
