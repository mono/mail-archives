<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] poor PPC JIT output
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20poor%20PPC%20JIT%20output&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013172.html">
   <LINK REL="Next"  HREF="013167.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] poor PPC JIT output</H1>
    <B>Allan Hsu</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20poor%20PPC%20JIT%20output&In-Reply-To="
       TITLE="[Mono-devel-list] poor PPC JIT output">allan at counterpop.net
       </A><BR>
    <I>Thu Jul 14 22:02:28 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013172.html">[Mono-devel-list] mono and cyrillic symbols
</A></li>
        <LI>Next message: <A HREF="013167.html">[Mono-devel-list] poor PPC JIT output
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13164">[ date ]</a>
              <a href="thread.html#13164">[ thread ]</a>
              <a href="subject.html#13164">[ subject ]</a>
              <a href="author.html#13164">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Code generated by the PPC code emitter performs very poorly in  
comparison to the same code emitted for other platforms (most  
notably, x86). I had a brief conversation about this with Miguel in  
#mono today and he suggested that I post some examples.

Preliminary profiling with Shark (a profiling tool that is part of  
the Apple CHUD tools) shows some heinously inefficient JIT output on  
both G4 and G5 machines. Here's some sample Shark analysis on the  
code emitted by mono 1.1.8.1 from  
System.Security.Cryptography.RijndaelTransform.ECB(byte[], byte[])  
and System.Security.Cryptography.RijndaelTransform.ShiftRow(bool):

<A HREF="http://strangecargo.org/~allan/mono/">http://strangecargo.org/~allan/mono/</A>

Information on how to read Shark analysis comes with Shark (available  
for free from the Apple Developer Connection website). (A summary:  
numerous and frequent pipeline stalls, unoptimized loops).

Is there any active effort to optimize the PPC code emitter? The  
above two methods account for the majority of CPU time on a pegged  
2Ghz G5 while decrypting AES blocks coming off the wire. The x86  
machine encrypting the data (also running mono) doesn't even break a  
sweat.

     -Allan
--
Allan Hsu &lt;allan at counterpop dot net&gt;
1E64 E20F 34D9 CBA7 1300  1457 AC37 CBBB 0E92 C779



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013172.html">[Mono-devel-list] mono and cyrillic symbols
</A></li>
	<LI>Next message: <A HREF="013167.html">[Mono-devel-list] poor PPC JIT output
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13164">[ date ]</a>
              <a href="thread.html#13164">[ thread ]</a>
              <a href="subject.html#13164">[ subject ]</a>
              <a href="author.html#13164">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
