<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Fwd: MethodCall target not working on Windows?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Fwd%3A%20MethodCall%20target%20not%20working%20on%20Windows%3F&In-Reply-To=cbf838b405072304012913419c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013573.html">
   <LINK REL="Next"  HREF="013562.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Fwd: MethodCall target not working on Windows?</H1>
    <B>Valient Gough</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Fwd%3A%20MethodCall%20target%20not%20working%20on%20Windows%3F&In-Reply-To=cbf838b405072304012913419c%40mail.gmail.com"
       TITLE="[Mono-devel-list] Fwd: MethodCall target not working on Windows?">valient at gmail.com
       </A><BR>
    <I>Fri Jul 29 12:34:08 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="013573.html">[Mono-devel-list] mcs
</A></li>
        <LI>Next message: <A HREF="013562.html">[Mono-devel-list] Using RSA optimally with both Mono and MS .Net
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13559">[ date ]</a>
              <a href="thread.html#13559">[ thread ]</a>
              <a href="subject.html#13559">[ subject ]</a>
              <a href="author.html#13559">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>When building NLog (<A HREF="http://nlog.sf.net">http://nlog.sf.net</A>) with Mono, the resulting dll
works on Mono but not on Windows .NET.  If the .dll is built with csc,
then it works both on .NET and Mono (both Windows and Linux).

The symptom is that the simple test program can't run.  But I don't
understand what's causing it -- missing metadata (see the last part of
the error message)?

Valient
  

---------- Forwarded message ----------
From: Valient Gough &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">valient at gmail.com</A>&gt;
Date: Jul 23, 2005 1:01 PM
Subject: MethodCall target not working on Windows?
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">nlog-list at lists.sourceforge.net</A>


I'm using a MethodCall target in order to capture log messages within
my program.  It works under Mono on Linux, but fails on Windows with
DotNet 1.1.

I've created a simple example.  Attached is logtest.cs and
logtest.exe.nlog.  When run under Windows, an exception dialog pops up
saying an unhandled exception was caught and if I let it terminate
then I get the following log on the console:



Unhandled Exception: System.TypeInitializationException: The type
initializer for &quot;Foo.Test&quot; threw an exception. ---&gt;
System.IO.FileLoadException: The located assembly's manifest
definition with name 'NLog' does not match the assembly reference.
File name: &quot;NLog&quot;
   at System.Reflection.CustomAttribute.CreateCAObject(Int32&amp; propNum,
Assembly&amp; assembly)
   at System.Reflection.CustomAttribute.GetObject()
   at System.Reflection.CustomAttribute.CheckConsistencyAndCreateArray(CustomAttribute
caItem, Type caType)
   at System.Reflection.CustomAttribute.GetCustomAttributes(MemberInfo
member, Type caType, Boolean inherit)
   at System.Reflection.RuntimePropertyInfo.GetCustomAttributes(Type
attributeType, Boolean inherit)
   at NLog.Internal.PropertyHelper.BuildPropertyInfoDictionary(Type t)
   at NLog.Internal.PropertyHelper.GetPropertyInfo(Type targetType,
String propertyName)
   at NLog.Internal.PropertyHelper.IsArrayProperty(Type t, String name)
   at NLog.Config.XmlLoggingConfiguration.ConfigureTargetFromXmlElement(Target
target, XmlElement element)
   at NLog.Config.XmlLoggingConfiguration.ConfigureTargetsFromElement(XmlElement
element)
   at NLog.Config.XmlLoggingConfiguration.ConfigureFromXmlElement(XmlElement
configElement, String baseDirectory)
   at NLog.Config.XmlLoggingConfiguration.ConfigureFromFile(String fileName)
   at NLog.Config.XmlLoggingConfiguration..ctor(String fileName)
   at NLog.LogManager.get_Configuration()
   at NLog.LogManager.GetLogger(String name)
   at NLog.LogManager.GetCurrentClassLogger()
   at Foo.Test..cctor()

=== Pre-bind state information ===
LOG: DisplayName = NLog, Version=0.0.0.0, Culture=neutral,
PublicKeyToken=null (Fully-specified)
LOG: Appbase = C:\INCOMING\
LOG: Initial PrivatePath = NULL
Calling assembly : (Unknown).
===

LOG: Policy not being applied to reference at this time (private,
custom, partial, or location-based assembly bind).
LOG: Post-policy reference: NLog, Version=0.0.0.0, Culture=neutral,
PublicKeyToken=null
LOG: Attempting download of new URL <A HREF="file:///C:/INCOMING/NLog.DLL.">file:///C:/INCOMING/NLog.DLL.</A>
WRN: Comparing the assembly name resulted in the mismatch: PUBLIC KEY TOKEN

   --- End of inner exception stack trace ---
   at Foo.Test.Main()


Any ideas?  I don't know what that &quot;post-policy reference&quot; stuff is
about.  The NLog was built normally and does contain a public key
token.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logtest.cs
Type: application/octet-stream
Size: 404 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050729/7195fd6a/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050729/7195fd6a/attachment.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logtest.exe.nlog
Type: application/octet-stream
Size: 362 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050729/7195fd6a/attachment-0001.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050729/7195fd6a/attachment-0001.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013573.html">[Mono-devel-list] mcs
</A></li>
	<LI>Next message: <A HREF="013562.html">[Mono-devel-list] Using RSA optimally with both Mono and MS .Net
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13559">[ date ]</a>
              <a href="thread.html#13559">[ thread ]</a>
              <a href="subject.html#13559">[ subject ]</a>
              <a href="author.html#13559">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
