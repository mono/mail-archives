<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Performance issue with DataTable.Load on &quot;large&quot; data	sets
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Performance%20issue%20with%20DataTable.Load%20on%20%22large%22%20data%0A%09sets&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037366.html">
   <LINK REL="Next"  HREF="037359.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Performance issue with DataTable.Load on &quot;large&quot; data	sets</H1>
    <B>Nicklas Overgaard</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Performance%20issue%20with%20DataTable.Load%20on%20%22large%22%20data%0A%09sets&In-Reply-To="
       TITLE="[Mono-dev] Performance issue with DataTable.Load on &quot;large&quot; data	sets">nicklas at isharp.dk
       </A><BR>
    <I>Thu Apr  7 08:58:53 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037366.html">[Mono-dev] Mono-devel-list Digest, Vol 72, Issue 10
</A></li>
        <LI>Next message: <A HREF="037359.html">[Mono-dev] Performance issue with DataTable.Load on &quot;large&quot; data sets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37357">[ date ]</a>
              <a href="thread.html#37357">[ thread ]</a>
              <a href="subject.html#37357">[ subject ]</a>
              <a href="author.html#37357">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi mono-devers!

I'm currently working on a rather large webproject, where we are using a
combination of mono 2.10.1 and MySQL.

Over the past week, I have observed that loading &quot;large&quot; datasets (5000+
rows) from mysql into a DataTable takes a very long time. 

It's done somewhat like this:
&lt;code&gt;

comm.CommandText = query;
comm.CommandTimeout = MySQLConnection.timeout;
MySqlDataReader reader = (MySqlDataReader)comm.ExecuteReader();
DataTable dt = new DataTable();
dt.Load(reader); // &lt;- this is killing mono
reader.Close();

&lt;/code&gt;

I have created a small testprogram, compiled it on my linux machine and
executed it.

It takes 15 seconds to do such operation under mono - but on windows it
takes only 0.4 seconds (with the same executable, fetching the same
data). I have profiled the application on windows, and it seems that
the .net framework is using specialized methods for loading data from a
datareader.

I have been looking through the implementation in mono, in regard to
DataTable.Load, and I can see that a lot of validation and other stuff
is going on, which could explain the huge difference. I'm also working
on a mono log profile trace, to dig a little deeper.

Would it be OK, if I tried to patch the current mono implementation to
gain the same speeds as .net? The reason for asking, is that I know that
I cannot contribute to Mono if I have seen the actual code in .NET (but
does a profile result count as &quot;seeing the code&quot;?)

Best regards,

Nicklas Overgaard

</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037366.html">[Mono-dev] Mono-devel-list Digest, Vol 72, Issue 10
</A></li>
	<LI>Next message: <A HREF="037359.html">[Mono-dev] Performance issue with DataTable.Load on &quot;large&quot; data sets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37357">[ date ]</a>
              <a href="thread.html#37357">[ thread ]</a>
              <a href="subject.html#37357">[ subject ]</a>
              <a href="author.html#37357">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
