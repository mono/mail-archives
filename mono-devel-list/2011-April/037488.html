<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Status of COM interop
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Status%20of%20COM%20interop&In-Reply-To=BANLkTin9tBvuMgt-pNvEDhcbVkKu4%3DW2ng%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037487.html">
   <LINK REL="Next"  HREF="037489.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Status of COM interop</H1>
    <B>Jonathan Chambers</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Status%20of%20COM%20interop&In-Reply-To=BANLkTin9tBvuMgt-pNvEDhcbVkKu4%3DW2ng%40mail.gmail.com"
       TITLE="[Mono-dev] Status of COM interop">joncham at gmail.com
       </A><BR>
    <I>Tue Apr 26 20:47:40 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037487.html">[Mono-dev] Status of COM interop
</A></li>
        <LI>Next message: <A HREF="037489.html">[Mono-dev] undefined reference to `libiconv'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37488">[ date ]</a>
              <a href="thread.html#37488">[ thread ]</a>
              <a href="subject.html#37488">[ subject ]</a>
              <a href="author.html#37488">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Joe,

I can't find the bug # right now, but I'm assuming you are talking about
Release being called on the finalizer thread instead of the correct
creating/apartment of the COM object? I understand how it
can especially cause problems with UI controls requiring access on only the
UI thread. This is a very difficult bug to fix, due to the fact that if the
apartment of the COM object does not pump messages the application will
deadlock. Even more complicated is what message loop to use in the non-Win32
case.

I'm willing to take a look at solutions to this issue, but I can't think of
any easy ones. There are multiple blog posts on how tricky it was for MS to
avoid deadlock in their runtime, including things like randomly pumping
messages.

Ivo, Joe is right to mention this. I've made all my COM objects free
threaded to avoid this issue. If your COM objects rely on STA behavior,
you're going to run into troubles.

Thanks,
Jonathan

On Tue, Apr 26, 2011 at 8:20 PM, Joe Dluzen &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jdluzen at gmail.com</A>&gt; wrote:

&gt;<i> I was under the impression that XPCOM is broken due to a GC bug. Is this
</I>&gt;<i> still the case?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Joe
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20110426/975a7539/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20110426/975a7539/attachment.html</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037487.html">[Mono-dev] Status of COM interop
</A></li>
	<LI>Next message: <A HREF="037489.html">[Mono-dev] undefined reference to `libiconv'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37488">[ date ]</a>
              <a href="thread.html#37488">[ thread ]</a>
              <a href="subject.html#37488">[ subject ]</a>
              <a href="author.html#37488">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
