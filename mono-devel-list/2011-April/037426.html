<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] gtksourceview: compilation error and strange runtime	behaviour/errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20gtksourceview%3A%20compilation%20error%20and%20strange%20runtime%0A%09behaviour/errors&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037424.html">
   <LINK REL="Next"  HREF="037427.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] gtksourceview: compilation error and strange runtime	behaviour/errors</H1>
    <B>Quandary</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20gtksourceview%3A%20compilation%20error%20and%20strange%20runtime%0A%09behaviour/errors&In-Reply-To="
       TITLE="[Mono-dev] gtksourceview: compilation error and strange runtime	behaviour/errors">quandary82 at hailmail.net
       </A><BR>
    <I>Sun Apr 17 04:31:11 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037424.html">[Mono-dev] Mono 2.8 (trunk) compiling on Mac OS X 10.6 (SL)
</A></li>
        <LI>Next message: <A HREF="037427.html">[Mono-dev] gtksourceview: compilation error and strange runtime behaviour/errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37426">[ date ]</a>
              <a href="thread.html#37426">[ thread ]</a>
              <a href="subject.html#37426">[ subject ]</a>
              <a href="author.html#37426">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm now trying to get SQL Syntax highlighting to work with GTK.
And I already had 2  problems just getting the gtksourceview sample to
work...

Problem 1 (file: gtksourceview/generated/SourcePrintJob.cs):
[Obsolete]
protected SourcePrintJob(GLib.GType gtype) : base(gtype) {}

This gives a compilation error, because this constructor still is used
(in the sample, I guess)...
Now obsolete or not, as long as it still is used, this has to be:
public SourcePrintJob(GLib.GType gtype) : base(gtype) {}

or else:
---------------
/usr/local/bin/mcs -out:PrintSample.exe ./PrintSample.cs
-r:../gtksourceview/gtksourceview-sharp.dll -pkg:gtk-sharp-2.0
-pkg:gnome-sharp-2.0
./PrintSample.cs(47,38): error CS0122:
`GtkSourceView.SourcePrintJob.SourcePrintJob(GLib.GType)' is
inaccessible due to its protection level
/root/sources/mono/2.10/gtksourceview-sharp-2.0-0.12/gtksourceview/gtksourceview-sharp.dll
(Location of the symbol related to previous error)
./PrintSample.cs(65,23): error CS0234: The type or namespace name
`PrintJob' does not exist in the namespace `Gnome'. Are you missing an
assembly reference?
./PrintSample.cs(68,17): error CS0246: The type or namespace name
`PrintDialog' could not be found. Are you missing a using directive or
an assembly reference?
./PrintSample.cs(69,17): error CS0841: A local variable `dialog' cannot
be used before it is declared
./PrintSample.cs(70,17): error CS0841: A local variable `dialog' cannot
be used before it is declared
./PrintSample.cs(71,17): error CS0841: A local variable `dialog' cannot
be used before it is declared
./PrintSample.cs(72,32): error CS0841: A local variable `dialog' cannot
be used before it is declared
./PrintSample.cs(74,39): error CS0103: The name `PrintButtons' does not
exist in the current context
./PrintSample.cs(76,25): error CS0841: A local variable `dialog' cannot
be used before it is declared
./PrintSample.cs(77,25): error CS0841: A local variable `dialog' cannot
be used before it is declared
./PrintSample.cs(82,36): error CS0103: The name `PrintButtons' does not
exist in the current context
./PrintSample.cs(85,36): error CS0103: The name `PrintButtons' does not
exist in the current context
./PrintSample.cs(93,17): error CS0841: A local variable `dialog' cannot
be used before it is declared
./PrintSample.cs(94,17): error CS0841: A local variable `dialog' cannot
be used before it is declared
Compilation failed: 14 error(s), 0 warnings
make[1]: *** [PrintSample.exe] Error 1
make[1]: Leaving directory
`/root/sources/mono/2.10/gtksourceview-sharp-2.0-0.12/sample'
make: *** [all-recursive] Error 1
--------------------------


Problem 2:
Does the example use the 2.0 version of gtksourceview-sharp ?
Without looking into the makefile: it doesn't seem that way.

********
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">root at IS1300-1</A>:/etc/ld.so.conf.d# cat gtksource*

# mono needs you
/usr/local/lib/mono/gtksourceview-sharp-2.0

# mono needs you
/usr/local/lib/mono/gac/gtksourceview-sharp

# mono needs you
/usr/local/lib/mono/gac/gtksourceview-sharp/1.0.0.2__35e10195dab3c99f

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">root at IS1300-1</A>:/etc/ld.so.conf.d# /sbin/ldconfig
********

And it still doesn't find the dll.
Furthermore, if I copy
/usr/local/lib/mono/gac/gtksourceview-sharp/1.0.0.2__35e10195dab3c99f/1gtksourceview-sharp.dll
into the sample directory, it starts working.

This is strange, because this should have started working the moment the
directory was included in /etc/ld.so.conf.d/ and /sbin/ldconfig was run.
Besides, the dll always was in the gac...

It seems to require localcopy, even if the dll is in the gac and/or in
the ld-paths.


My interpretation is that:
A) The sample is compiled referencing an old version of gtksourceview

B) Mono seems to ignore ldconfig settings, at least for non-native dll's.

and since it looks like it doesn't consider
/usr/local/lib/mono/gac.
but only
/usr/lib/mono/gac

C) that either the install directory or the lookup of it is wrong.

and

D) that it (=mono/ld-linux) gladly ignores export
LD_PRELOAD=&quot;/usr/local/lib/mono/gac/gtksourceview-sharp/1.0.0.2__35e10195dab3c99f/1gtksourceview-sharp.dll&quot;


Which results in this
--------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">root at IS1300-1</A>:~/sources/mono/2.10/gtksourceview-sharp-2.0-0.12/sample#
export
LD_PRELOAD=&quot;/usr/local/lib/mono/gac/gtksourceview-sharp/1.0.0.2__35e10195dab3c99f/1gtksourceview-sharp.dll&quot;
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">root at IS1300-1</A>:~/sources/mono/2.10/gtksourceview-sharp-2.0-0.12/sample#
./SourceViewTest.exe SourceViewTest.cs

ERROR: ld.so: object
'/usr/local/lib/mono/gac/gtksourceview-sharp/1.0.0.2__35e10195dab3c99f/1gtksourceview-sharp.dll'
from LD_PRELOAD cannot be preloaded: ignored.
ERROR: ld.so: object
'/usr/local/lib/mono/gac/gtksourceview-sharp/1.0.0.2__35e10195dab3c99f/1gtksourceview-sharp.dll'
from LD_PRELOAD cannot be preloaded: ignored.
ERROR: ld.so: object
'/usr/local/lib/mono/gac/gtksourceview-sharp/1.0.0.2__35e10195dab3c99f/1gtksourceview-sharp.dll'
from LD_PRELOAD cannot be preloaded: ignored.


** (SourceViewTest:4267): WARNING **: The following assembly referenced
from
/root/sources/mono/2.10/gtksourceview-sharp-2.0-0.12/sample/SourceViewTest.exe
could not be loaded:
     Assembly:   gtksourceview-sharp    (assemblyref_index=2)
     Version:    1.0.0.2
     Public Key: 35e10195dab3c99f
The assembly was not found in the Global Assembly Cache, a path listed
in the MONO_PATH environment variable, or in the location of the
executing assembly
(/root/sources/mono/2.10/gtksourceview-sharp-2.0-0.12/sample/).


** (SourceViewTest:4267): WARNING **: Could not load file or assembly
'gtksourceview-sharp, Version=1.0.0.2, Culture=neutral,
PublicKeyToken=35e10195dab3c99f' or one of its dependencies.

Unhandled Exception: System.IO.FileNotFoundException: Could not load
file or assembly 'gtksourceview-sharp, Version=1.0.0.2, Culture=neutral,
PublicKeyToken=35e10195dab3c99f' or one of its dependencies.
File name: 'gtksourceview-sharp, Version=1.0.0.2, Culture=neutral,
PublicKeyToken=35e10195dab3c99f'
  at SourceViewTest..ctor () [0x00000] in &lt;filename unknown&gt;:0
  at SourceViewTest.Main (System.String[] args) [0x00000] in &lt;filename
unknown&gt;:0
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">root at IS1300-1</A>:~/sources/mono/2.10/gtksourceview-sharp-2.0-0.12/sample#
-----------------
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037424.html">[Mono-dev] Mono 2.8 (trunk) compiling on Mac OS X 10.6 (SL)
</A></li>
	<LI>Next message: <A HREF="037427.html">[Mono-dev] gtksourceview: compilation error and strange runtime behaviour/errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37426">[ date ]</a>
              <a href="thread.html#37426">[ thread ]</a>
              <a href="subject.html#37426">[ subject ]</a>
              <a href="author.html#37426">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
