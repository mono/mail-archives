<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] GAC (design) issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20GAC%20%28design%29%20issues&In-Reply-To=1083573865.1903.38.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005296.html">
   <LINK REL="Next"  HREF="005303.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] GAC (design) issues</H1>
    <B>Ian MacLean</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20GAC%20%28design%29%20issues&In-Reply-To=1083573865.1903.38.camel%40localhost.localdomain"
       TITLE="[Mono-devel-list] GAC (design) issues">ianm at ActiveState.com
       </A><BR>
    <I>Mon May  3 08:59:50 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="005296.html">[Mono-devel-list] GAC (design) issues
</A></li>
        <LI>Next message: <A HREF="005303.html">[Mono-devel-list] GAC (design) issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5301">[ date ]</a>
              <a href="thread.html#5301">[ thread ]</a>
              <a href="subject.html#5301">[ subject ]</a>
              <a href="author.html#5301">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Todd Berman wrote:

&gt;<i> &lt;&gt;On Mon, 2004-03-05 at 10:14 +0200, Gert Driesen wrote:
</I>&gt;<i>
</I>&gt;<i>or just mcs /r:System.Data
</I>&gt;<i>have you guys even tested this? I can say that MonoDevelop (arguably the
</I>&gt;<i>largest mono project available right now) compiles, and runs *perfectly*
</I>&gt;<i>with this gac setup. the build system required *no* changes, and the
</I>&gt;<i>only changes required to the runtime was *changing* gac assumptions that
</I>&gt;<i>#D makes about the windows GAC.
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I> From my understanding of things .net compiler references should 
*always* be file paths. The assembly probing mechanism is intended for 
*runtime* resolution of assemblies not compile time references. The 
probing algorithm is quite a complex beast designed to always find the 
most appropriate assembly on variously configured deployment machines. 
At build time you should know where on disk the referenced assemblies 
reside so that you can guarentee repeatable builds - the same way you 
tell a c compiler where to find .h files at build time but resolution of 
shared libraries depends on the target machines setup.
Using assembly full ( or partial ) names at compile time seems to me to 
be an abuse of the assembly probing mechanism. Why do all the MS 
compilers insist on file paths for references if this is not the case ?

The only reason /r:System.dll works in ms.net is because System.dll 
resides in the same directory as csc.exe. If it didn't then you would 
need to specify either a relative or full path to that assembly ( or you 
could setup the response file appropriatly ). What I'm saying is that 
specifying a full path as a reference is the *normal* case on ms.net and 
its by design - not just an incidental implementation detail - thats why 
Gert is wanting to use a full path. Note that neither  /r:System.Data 
nor  /r:System.Data, Version=...,Culture=....,PublicKeyToken=... work 
with csc.exe. Again by design as the assembly probing mechanism was not 
intended for this purpose.

The same goes for the gac. Its designed to be a central store for 
locating shared assemblies at *runtime* but not for referencing them at 
compile time. All the ms documentation around it reccommends that you do 
not rely on the fact that the current implementation uses the filesystem 
and treat it as a black box. That is the reason for having all the 
system assemblies mirrored in c:\windows. The way I look at is - the 
copies in \WINDOWS\Microsoft.NET\Framework\v1.1.4322\  are the 
equivalent of .h files ie there only purpose is to be referenced for 
metadata at compile time and the copies in the gac are the equivalent of 
shared libraries ( .dll or .so ). The fact that in .net the two 
functions are combined in the same physical file is a convenience that 
shouldn't lull you into thinking that the gac is a suitable place to 
reference assemblies.

Ian



&gt;&gt;&gt;<i>And if you *dont* know what version you want, how can you be picky about
</I>&gt;&gt;&gt;<i>what you get back?
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>Ofcourse you need to know what version you want ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Well, then do: mcs /r:System.Data, Version=whatever when (and not if)
</I>&gt;<i>that gets implemented. For now its not there, but it will be.
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I really get the impression that the GAC implementation was rushed in
</I>&gt;&gt;&gt;&gt;<i>        
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>...
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I dont believe it is being rushed in at all, however waiting any longer
</I>&gt;&gt;&gt;<i>would have been a bad idea as well.
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>My point is : why implement it different from MS ?  Are you really sure that
</I>&gt;&gt;<i>the Mono implementation of the GAC is better, and easier to manage than the
</I>&gt;&gt;<i>MS implementation ?  And even if it is : what happened to compatbility ?
</I>&gt;&gt;<i>And lets not forget : for any other existing .NET tool which works with
</I>&gt;&gt;<i>assembly references developers will need to specifiy the full path to an
</I>&gt;&gt;<i>assembly (or the fully qualified assembly name) anyway ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Ok, here is what I don't get. We implement it the same as MS, what we
</I>&gt;<i>dont do is replicate every implementation detail of their SDK. Note,
</I>&gt;<i>thats the SDK not the framework itself.
</I>&gt;<i>
</I>&gt;<i>And no, any other existing .NET tool that operates on assembly
</I>&gt;<i>references will not be affected assuming they are writing proper code.
</I>&gt;<i>In fact, MCS itself is most likely going to change from using that
</I>&gt;<i>LoadFromGac method to something else to be even more correct, however
</I>&gt;<i>the implementation itself is being worked out.
</I>&gt;<i>
</I>&gt;<i>For the 7th time (slight exaggeration), will you *PLEASE* explain why
</I>&gt;<i>getting the absolute path to the assembly is so important to you? You
</I>&gt;<i>keep explaining that you need it, without explaining why you need it. In
</I>&gt;<i>my (intentionally uninformed, as you wont explain) opinion, you are
</I>&gt;<i>doing something that takes advantage of the ms.net sdk's implementation
</I>&gt;<i>details (like pathing) and are irritated that you might have to refit
</I>&gt;<i>that code to actually work properly. I would love to be wrong, please
</I>&gt;<i>help me understand.
</I>&gt;<i>
</I>&gt;<i>--Todd
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>Gert
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Mono-devel-list mailing list
</I>&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Mono-devel-list mailing list
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>  
</I>&gt;<i>
</I>

-- 
Ian MacLean, Developer, 
ActiveState, a division of Sophos
<A HREF="http://www.ActiveState.com">http://www.ActiveState.com</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005296.html">[Mono-devel-list] GAC (design) issues
</A></li>
	<LI>Next message: <A HREF="005303.html">[Mono-devel-list] GAC (design) issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5301">[ date ]</a>
              <a href="thread.html#5301">[ thread ]</a>
              <a href="subject.html#5301">[ subject ]</a>
              <a href="author.html#5301">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
