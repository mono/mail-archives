<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Reuse parts of MCS in Class Libraries?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Reuse%20parts%20of%20MCS%20in%20Class%20Libraries%3F&In-Reply-To=409DB18F.1020202%40cox.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005552.html">
   <LINK REL="Next"  HREF="005563.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Reuse parts of MCS in Class Libraries?</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Reuse%20parts%20of%20MCS%20in%20Class%20Libraries%3F&In-Reply-To=409DB18F.1020202%40cox.net"
       TITLE="[Mono-devel-list] Reuse parts of MCS in Class Libraries?">jonpryor at vt.edu
       </A><BR>
    <I>Sun May  9 09:13:08 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="005552.html">[Mono-devel-list] Reuse parts of MCS in Class Libraries?
</A></li>
        <LI>Next message: <A HREF="005563.html">[Mono-devel-list] Reuse parts of MCS in Class Libraries?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5554">[ date ]</a>
              <a href="thread.html#5554">[ thread ]</a>
              <a href="subject.html#5554">[ subject ]</a>
              <a href="author.html#5554">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 2004-05-09 at 00:20, Mark wrote:
&gt;<i> Mono hackers,
</I>&gt;<i> 
</I>&gt;<i> First, I apologize for the length. Because of this I'm going to try to 
</I>&gt;<i> keep it in sections to make skimming it easier.
</I>&gt;<i> 
</I>&gt;<i> Summary:
</I>&gt;<i> ====================
</I>&gt;<i> I have a question about the Mono compiler and re-using some of the MCS 
</I>&gt;<i> code in the class libraries. Can we use parts of the MCS in the Class 
</I>&gt;<i> Libraries to parse C# to the CodeDom through the ICodeParser interface? 
</I>&gt;<i> My concern is really about the licenses. I would also like feedback on 
</I>&gt;<i> how it could best be accomplished.
</I>
Every now and then I think we should split up the CVS repositories more,
so that the C# class library is in a different module than MCS.  It
would certainly clear up the licensing questions...

To answer an unstated question: The C# class libraries (mscorlib.dll,
System.dll, etc.) are under the MIT/X11 license (like BSD without the
advertising clause), NOT GPL/LGPL.  The mcs compiler *is* GPL.  The
tools in the &quot;tools&quot; directory have a variety of licenses, mostly GPL.

It's the mono runtime libraries (libmono.so and related; basically the
JIT, internal calls, and anything written in C) which are LGPL.

&gt;<i> CodeDom Interest:
</I>&gt;<i> =====================
</I>&gt;<i> To be up front, I have plans for creating CodeDom-based projects in both 
</I>&gt;<i> GPL and commercial markets. That said, I am very interested in the 
</I>&gt;<i> .NetFramework's CodeDom objects. I have some great ideas for how it 
</I>&gt;<i> could really be taken advantage of. I've also noticed that MS has not 
</I>&gt;<i> provided any implementations of the ICodeParser interface. Additionally, 
</I>&gt;<i> I don't know of any such thing in Mono. So, in order to use the CodeDom, 
</I>&gt;<i> you must either provide a text parser for a given language or create the 
</I>&gt;<i> CodeDom objects at runtime. Once created you can convert to code or an 
</I>&gt;<i> assembly.
</I>
You should be very careful about what you expect to be able to do with
CodeDom.  What you've stated shows that you might know what it's
presently capable of, but I'm not entirely sure.

To clarify, CodeDom is not used to parse existing code.  It's used to
generate source code, which can then be handed to an external compiler
to be compiled into an assembly.

&gt;<i> License Issues?
</I>&gt;<i> ======================
</I>&gt;<i> I would like to reuse the work done in the Mono compiler to provide an 
</I>&gt;<i> implementation of the ICodeParser. However, I believe there is an issue 
</I>&gt;<i> with licenses because the Mono compiler is GPL and the class libraries 
</I>&gt;<i> are LGPL. Am I wrong on this? I don't know of any way to satisfy the 
</I>&gt;<i> needs of both and still use any MCS code.
</I>
As stated above, the class libraries are MIT/X11.  Mcs is GPL.

Regardless, you could use mcs to implement the ICodeParser interface,
but the resulting ICodeParser implementation could only be used in GPL
projects.  It would also likely be frowned upon by some of the
developers.

&gt;<i> CodeDom Sample Usage:
</I>&gt;<i> =======================
</I>&gt;<i> I believe that the existing system of CodeDom can be a foundation for 
</I>&gt;<i> things like the &quot;Compilers for dynamic languages&quot; listed on the 
</I>&gt;<i> mono-todo list &lt;<A HREF="http://www.go-mono.com/mono-todo.html">http://www.go-mono.com/mono-todo.html</A>&gt;. Most scriping 
</I>&gt;<i> languages can easily be condensed to the things in CodeDom. Wouldn't it 
</I>&gt;<i> be neat if you could convert from Perl to Python to Ruby and vise versa?
</I>
This suggests a mis-understanding of CodeDom's intent.

CodeDom is used by e.g. VisualStudio for generating templates: you
would describe, via CodeDom, that you want a class (MyClass), with a
method (Main), and some comments (&quot;Do something here&quot;).  This CodeDom
description could then be used to generate the template code in VB.NET,
C#, JavaScript...  Anything that has a CodeDom provider.  It's to
generate *human readable* source code.

This was discussed -- in excruciating depth because of perceived GPL
&quot;backdoor&quot; -- in May 2002, when miguel noted:

        The System.CodeDOM API is a mechanism to &quot;build&quot; source code 
        through an API.  It is just an abstraction so that ASP.NET can
        &quot;create&quot; pages built on a number of languages.

        Once you have constructed your &quot;CodeDOM&quot;, it is written into a
        file, and an external compiler is invoked.  So there are no
        licensing problems.

See:    <A HREF="http://lists.ximian.com/archives/public/mono-list/2002-May/005929.html">http://lists.ximian.com/archives/public/mono-list/2002-May/005929.html</A>

As is, CodeDom could only be used by dynamic language compilers if the
dynamic language compiler were to translate the language into C# and
execute the resulting C# code.  This would likely not be a performance
optimal solution, given that you'd be generating source code and
compiling it before you could begin execution.  There would be lots of
latency in such an approach, and it likely wouldn't perform well.

System.Reflection.Emit is a better bet for dynamic languages, and some
of the enhancements in .NET 2.0 such as DynamicMethods will make this
easier:

	<A HREF="http://longhorn.msdn.microsoft.com/lhsdk/ref/ns/system.reflection.emit/c/dynamicmethod/dynamicmethod.aspx">http://longhorn.msdn.microsoft.com/lhsdk/ref/ns/system.reflection.emit/c/dynamicmethod/dynamicmethod.aspx</A>

See:
	<A HREF="http://lists.ximian.com/archives/public/mono-devel-list/2004-February/004016.html">http://lists.ximian.com/archives/public/mono-devel-list/2004-February/004016.html</A>
	<A HREF="http://lists.ximian.com/archives/public/mono-devel-list/2004-February/004021.html">http://lists.ximian.com/archives/public/mono-devel-list/2004-February/004021.html</A>

Optimization of the Reflection classes would likely also help dynamic
languages.

&gt;<i> Reuse or Recode?
</I>&gt;<i> ========================
</I>&gt;<i> I would love to be able to build on the great work that has already been 
</I>&gt;<i> done. I don't want to recreate all the logic for parsing and tokenizing 
</I>&gt;<i> a language if an existing solution can either be built on or extended to 
</I>&gt;<i> satisfy the issue.
</I>
As stated before, this is fine as long as the licensing conditions can
be met.  As you're looking for something that can be used in proprietary
software, you can't use mcs for this.

 - Jon



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005552.html">[Mono-devel-list] Reuse parts of MCS in Class Libraries?
</A></li>
	<LI>Next message: <A HREF="005563.html">[Mono-devel-list] Reuse parts of MCS in Class Libraries?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5554">[ date ]</a>
              <a href="thread.html#5554">[ thread ]</a>
              <a href="subject.html#5554">[ subject ]</a>
              <a href="author.html#5554">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
