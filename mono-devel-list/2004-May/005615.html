<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Bride of GAC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Bride%20of%20GAC&In-Reply-To=40A144D4.9000809%40users.sourceforge.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005614.html">
   <LINK REL="Next"  HREF="005616.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Bride of GAC</H1>
    <B>Todd Berman</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Bride%20of%20GAC&In-Reply-To=40A144D4.9000809%40users.sourceforge.net"
       TITLE="[Mono-devel-list] Bride of GAC">tberman at sevenl.net
       </A><BR>
    <I>Tue May 11 17:26:42 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="005614.html">[Mono-devel-list] Bride of GAC
</A></li>
        <LI>Next message: <A HREF="005616.html">[Mono-devel-list] Bride of GAC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5615">[ date ]</a>
              <a href="thread.html#5615">[ thread ]</a>
              <a href="subject.html#5615">[ subject ]</a>
              <a href="author.html#5615">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2004-11-05 at 17:25 -0400, John Luke wrote:
&gt;<i> Mike Kestner wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;In the interest of trying to drive the GAC installation discussion
</I>&gt;<i> &gt;forward, the following are my thoughts on the current proposal from
</I>&gt;<i> &gt;Miguel.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;We are in complete agreement that a -pkg switch to mcs would be a good
</I>&gt;<i> &gt;thing for development on *nix platforms.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Miguel also wants to eliminate the use of symlinks and does not want to
</I>&gt;<i> &gt;replace symlinks with assembly copying.  I agree that both are good
</I>&gt;<i> &gt;objectives. Unfortunately, I can't come up with any &quot;beautiful&quot;
</I>&gt;<i> &gt;approaches to prefixed installation that don't include symlinks or
</I>&gt;<i> &gt;copying, given our filesystem-based GAC implementation.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Miguel's proposal is to install assemblies to the gac, and add a switch
</I>&gt;<i> &gt;to gacutil to obtain the path that an assembly will be installed to so
</I>&gt;<i> &gt;that we can put fully qual'd paths to assemblies in the /r: references
</I>&gt;<i> &gt;in our .pc files.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;This approach makes it basically impossible to install without
</I>&gt;<i> &gt;privileges for the mono directory with our current GAC implementation.
</I>&gt;<i> &gt;Even if we add a fallback to the user gac for failed gacutil /i
</I>&gt;<i> &gt;attempts, doing the fallback could result in a broken install, since an
</I>&gt;<i> &gt;install to a group shared prefix wouldn't produce a shared installation
</I>&gt;<i> &gt;due to the user gac not being &quot;shared&quot;.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;So basically, taking this approach, we are forcing installation into the
</I>&gt;<i> &gt;mono prefix with permissions for that prefix.  For Gtk#, the only things
</I>&gt;<i> &gt;which would actually be installed to the prefix under a prefixed build
</I>&gt;<i> &gt;would be the .pc files, glue, and the gapi binaries/scripts.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;To produce .pc files with a fully-qual'd path to the assemblies, we'll
</I>&gt;<i> &gt;have to delay the pc file creation until &quot;make&quot; time by adding rules
</I>&gt;<i> &gt;which depend on the assembly, since gacutil will need a built assembly
</I>&gt;<i> &gt;in order to tell us where it will be installed.  I've typically liked
</I>&gt;<i> &gt;being able to build my pc files at configure time, but Miguel tells me
</I>&gt;<i> &gt;there's a reason I probably shouldn't be doing this anyway.  The result
</I>&gt;<i> &gt;is additional rules needing to be written to produce something that Just
</I>&gt;<i> &gt;Worked (TM) before with config substitutions from my perspective.  I
</I>&gt;<i> &gt;don't see any other way to do this though, if we have to have
</I>&gt;<i> &gt;one-and-only-one-file-reference representing an assembly.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;So, my least of all evils proposal given the constraints above is to
</I>&gt;<i> &gt;enhance Miguel's proposal with the addition of a MONO_GAC_PATH
</I>&gt;<i> &gt;environment variable.  MONO_GAC_PATH would be searched *after* the
</I>&gt;<i> &gt;system GAC in the interest of protecting against malicious or accidental
</I>&gt;<i> &gt;&quot;replacements&quot; of a system assembly as a user.  MONO_GAC_PATH would
</I>&gt;<i> &gt;allow for true prefixed installation, where all files, assemblies
</I>&gt;<i> &gt;included, are installed to the specified prefix.  This would facilitate
</I>&gt;<i> &gt;multiple-prefixed installations and installation with user priviledges.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;For development purposes it's sometimes nice/necessary to be able to
</I>&gt;<i> &gt;just rm -r $(prefix)/* to be able to start over with a development
</I>&gt;<i> &gt;version of a package.  Currently, removing a gtk-sharp install would
</I>&gt;<i> &gt;involve a lot of painstaking work picking through the system GAC.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Yes I know that an ENV variable solution could never be called
</I>&gt;<i> &gt;&quot;beautiful&quot;, but we have lots of precedents around, including
</I>&gt;<i> &gt;LD_LIBRARY_PATH which is clearly relevant in this context.  It's
</I>&gt;<i> &gt;obviously good enough for ld.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Now everyone can point out to me why it would suck for the GAC. ;-)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  
</I>&gt;<i> &gt;
</I>&gt;<i> I will apologize in advance for asking this, I should probably not send 
</I>&gt;<i> it and leave it up to those implementing it, but I hope it helps.
</I>&gt;<i> 
</I>&gt;<i> I read everything posted on this subject (GAC) I still don't get why 
</I>&gt;<i> fully qualified paths to the assemblies are needed.  People keep saying 
</I>&gt;<i> they need that, but I saw no explanation of why and what it 
</I>&gt;<i> accomplishes.  I can't help but think for whatever reason they do we 
</I>&gt;<i> could solve that differently.  If we don't really need that we can 
</I>&gt;<i> return to having the GAC resolve it for us like we had in cvs for a 
</I>&gt;<i> brief time that I liked and the rest of these things are unneeded, correct?
</I>&gt;<i> 
</I>
The best explanation I got from Gert was because of how nant works.

However, the resolving from the GAC is fairly broken in general.

How do you specify versions? like 1.1 vs 2.0 or in the future, gtk-sharp
1.0 vs whatever.

&gt;<i>  I am not trying to stir things up, just understand why that assumption 
</I>&gt;<i> is needed.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005614.html">[Mono-devel-list] Bride of GAC
</A></li>
	<LI>Next message: <A HREF="005616.html">[Mono-devel-list] Bride of GAC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5615">[ date ]</a>
              <a href="thread.html#5615">[ thread ]</a>
              <a href="subject.html#5615">[ subject ]</a>
              <a href="author.html#5615">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
