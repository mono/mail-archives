<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Windows Shell
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Windows%20Shell&In-Reply-To=8f851ec20611300636jd69d748u3cdefeef43fce5e1%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021586.html">
   <LINK REL="Next"  HREF="021588.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Windows Shell</H1>
    <B>Charlie Poole</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Windows%20Shell&In-Reply-To=8f851ec20611300636jd69d748u3cdefeef43fce5e1%40mail.gmail.com"
       TITLE="[Mono-dev] Windows Shell">charlie at nunit.com
       </A><BR>
    <I>Thu Nov 30 14:08:27 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021586.html">[Mono-dev] Windows Shell
</A></li>
        <LI>Next message: <A HREF="021588.html">[Mono-dev] Windows Shell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21587">[ date ]</a>
              <a href="thread.html#21587">[ thread ]</a>
              <a href="subject.html#21587">[ subject ]</a>
              <a href="author.html#21587">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Would it be useful to first have a hypothetical common interface, with a
definition of what the
semantics would be under different desktops?
 
I've done a lot of Shell programming, so maybe I'm thinking at too detailed
a level, but is sounds
to me like a Windows-specific thing to start out with. That's OK, but it
would be good to know
what parts are likely to be cross-platform, since you might want to package
them separately.
 
Just a thought :-)

Charlie


  _____  

From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] On Behalf Of Steve K
Sent: Thursday, November 30, 2006 6:37 AM
To: Miguel de Icaza
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: Re: [Mono-dev] Windows Shell


I have created a first iteration of the windows implementation, attached. I
have not integrated this into the mono build system, or indeed tried
compiling it with mcs yet, as I am having difficulty building mono under
cygwin. 

Here's a brief overview of the API:

interface IShellItem - 
This acts as a common interface for ShellFolder and ShellItem. It exposes
properties such as DisplayName, SmallIcon, LargeIcon, Parent, Path.

class ShellFolder - 
Represents a folder in the Windows Shell Namepsace. ShellFolder can be
constructed with an Environment.SpecialFolder value, or from a path. It
implements IEnumerable, which allows a user to iterate over the folder's
ShellItems. 

class ShellItem - 
Represents an item in a ShellFolder. If the item is itself a folder,
ToShellFolder() will create a ShellFolder representation of the item.

I have used the namespace Mono.WindowsShell for the moment. 

An example of a program using the API:

        static void Main(string[] args) {
            ShellFolder folder = 
                new ShellFolder(Environment.SpecialFolder.Desktop);

            foreach (ShellItem item in folder) { 
                if (item.IsFolder) Console.Write(&quot;d &quot;);
                Console.WriteLine(item.DisplayName);
            }

            ShellItem windows = new ShellItem(@&quot;c:\progra~1&quot;); 
            Console.WriteLine();
            Console.WriteLine(windows.DisplayName);
            Console.WriteLine(windows.LargeIcon.Width);
        }

Comments welcome!

Cheers
Steve


On 11/29/06, Miguel de Icaza &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">miguel at ximian.com</A>&gt; wrote: 

Hello,

&gt;<i> Yes, I agree with your assesment.
</I>&gt;<i>
</I>&gt;<i> As for duplicating the Windows Shell API, it would need to be
</I>&gt;<i> abstracted quite significantly, as it is the single worst API I have
</I>&gt;<i> used, and very much tied to the win32 implementation. 
</I>
I would create an abstraction for what you are trying to solve, and have
one implementation call into the Windows space, and another that we do
to map into the Linux world.

This is what we have in mind. 

Miguel.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061130/fc6a093e/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061130/fc6a093e/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021586.html">[Mono-dev] Windows Shell
</A></li>
	<LI>Next message: <A HREF="021588.html">[Mono-dev] Windows Shell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21587">[ date ]</a>
              <a href="thread.html#21587">[ thread ]</a>
              <a href="subject.html#21587">[ subject ]</a>
              <a href="author.html#21587">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
