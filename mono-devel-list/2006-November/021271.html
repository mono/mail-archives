<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] ARM PInvoke issue when using long
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20ARM%20PInvoke%20issue%20when%20using%20long&In-Reply-To=OF3F014A78.83F90DCF-ON86257220.005273ED-86257220.00539598%40us.ibm.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021268.html">
   <LINK REL="Next"  HREF="021296.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] ARM PInvoke issue when using long</H1>
    <B>D M</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20ARM%20PInvoke%20issue%20when%20using%20long&In-Reply-To=OF3F014A78.83F90DCF-ON86257220.005273ED-86257220.00539598%40us.ibm.com"
       TITLE="[Mono-dev] ARM PInvoke issue when using long">dm_mono_dev at yahoo.com
       </A><BR>
    <I>Wed Nov  8 13:49:32 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021268.html">[Mono-dev] ARM PInvoke issue when using long
</A></li>
        <LI>Next message: <A HREF="021296.html">[Mono-dev] ARM PInvoke issue when using long
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21271">[ date ]</a>
              <a href="thread.html#21271">[ thread ]</a>
              <a href="subject.html#21271">[ subject ]</a>
              <a href="author.html#21271">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes, that seems to work.

Dan

Bill Seurer &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">seurer at us.ibm.com</A>&gt; wrote: I am not familiar with ARM but I had to change a setting in order to get
the JIT to use the right registers for long longs on power on AIX.  Some
architectures require that things too long to fit in a register be passed
starting in only even (or was it odd?) registers.  If you insert another
int between the two long longs (n2 and n3) in your test and it works that
is probably the problem.

I looked and it was the define ALIGN_DOUBLES in mini-ppc.c.  There's no
such thing in mini-arm.c but maybe the same sort of thing is happening or
not happening as the case may be.
--
Bill Seurer     IBM System i5 internal compiler development   Rochester, MN
Business: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">seurer at us.ibm.com</A>                         Home: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Bill at seurer.net</A>
<A HREF="http://w3.rchland.ibm.com/~seurer/">http://w3.rchland.ibm.com/~seurer/</A>                  <A HREF="http://www.seurer.net">http://www.seurer.net</A>


<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> wrote on 11/07/2006 06:32:14 PM:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> It seems there is an issue with mono PInvoke on a 32 bit ARM platform.
</I>&gt;<i> If I have a native method declared as:
</I>&gt;<i>
</I>&gt;<i> [DllImport(&quot;MyDll&quot;)]
</I>&gt;<i> static extern long Test1(int n1, long n2, long n3, int n4, long n5);
</I>&gt;<i>
</I>&gt;<i> extern &quot;C&quot;
</I>&gt;<i> long long Test1(int n1, long long n2, long long n3, int n4, long long n5)
</I>&gt;<i> {
</I>&gt;<i>     printf(&quot;Test1 %d,%lld,%lld,%d,%lld\n&quot;,
</I>&gt;<i>             n1,
</I>&gt;<i>             n2,
</I>&gt;<i>             n3,
</I>&gt;<i>             n4,
</I>&gt;<i>             n5);
</I>&gt;<i>
</I>&gt;<i>     return 12345;
</I>&gt;<i> }
</I>&gt;<i> and I invoke with the following parameters:
</I>&gt;<i>
</I>&gt;<i> Test1(1, 2, 3, 4, 5);
</I>&gt;<i>
</I>&gt;<i> the result is:
</I>&gt;<i>
</I>&gt;<i> Test1 1,2,12884901888,0,21474836484
</I>&gt;<i>
</I>&gt;<i> 12884901888 = 0x300000000
</I>&gt;<i> 21474836484 = 0x500000004
</I>&gt;<i>
</I>&gt;<i> Dan
</I>&gt;<i>  Get your email and see which of your friends are online - Right on the
</I>&gt;<i> new Yahoo.com _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
_______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>


 
---------------------------------
Sponsored Link

$200,000 mortgage for $660/mo - 30/15 yr fixed, reduce debt, home equity - Click now for info
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061108/9abd72f5/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20061108/9abd72f5/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021268.html">[Mono-dev] ARM PInvoke issue when using long
</A></li>
	<LI>Next message: <A HREF="021296.html">[Mono-dev] ARM PInvoke issue when using long
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21271">[ date ]</a>
              <a href="thread.html#21271">[ thread ]</a>
              <a href="subject.html#21271">[ subject ]</a>
              <a href="author.html#21271">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
