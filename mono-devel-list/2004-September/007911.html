<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Exception using ASP.NET (XSP) and OleDb cla	ss
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Exception%20using%20ASP.NET%20%28XSP%29%20and%20OleDb%20cla%0A%09ss&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007918.html">
   <LINK REL="Next"  HREF="007912.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Exception using ASP.NET (XSP) and OleDb cla	ss</H1>
    <B>Gomez Aragoneses, Andres</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Exception%20using%20ASP.NET%20%28XSP%29%20and%20OleDb%20cla%0A%09ss&In-Reply-To="
       TITLE="[Mono-devel-list] Exception using ASP.NET (XSP) and OleDb cla	ss">agomez at wke.es
       </A><BR>
    <I>Wed Sep 15 05:30:52 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007918.html">[Mono-devel-list] Permission Request Sets - Encoding
</A></li>
        <LI>Next message: <A HREF="007912.html">[Mono-devel-list] Exception using ASP.NET (XSP) and OleDb cla	ss
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7911">[ date ]</a>
              <a href="thread.html#7911">[ thread ]</a>
              <a href="subject.html#7911">[ subject ]</a>
              <a href="author.html#7911">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for your comments.
 
I haven't found any file with the letters &quot;gda&quot; on my Mono directory, so I
believe the lib is not available (yet?). And if it existed there, why
wouldn't Mono installation set it by default on the config file? Is this
going to be implemented in the future? Should we submit a bug (RFE) report
about this?
 
I am going to test now the access with ODBC, as you recommend. I will tell
you when I have the results.
 
    Regards,
 
        Andrew
 

-----Mensaje original-----
De: Simon Bain [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sibain at tendotzero.com</A>]
Enviado el: martes, 14 de septiembre de 2004 18:15
Para: Gomez Aragoneses, Andres
CC: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Asunto: Re: [Mono-devel-list] Exception using ASP.NET (XSP) and OleDb class



Hi.

A partial help (sorry not the full).
The message is often due to a dll mapping not being found. If you look in
the mono config file 
Mono Install Directory/etc/mono/config  
you will see it there. What you will need to do is map the required dll to
the linux file. Eg for odbc connections you would normally have to add a
line in the config file like

&lt;dllmap dll=&quot;odbc32&quot; target=&quot;libodbc.so&quot;/&gt;

In this instance you may need (only may) something like
&lt;dllmapp dll=&quot;gda-2&quot; target=&quot;libgda-2.so.1&quot;/&gt;
You will need to get teh correct mapping for the windows file version.

I hope thsi helps, even if only a little.

Failing that you could try an ODBC connection, which you will need to have
unixODBC installed. I have used it with great success and speed across a
range of different databases. It may seem like a backward step from OleDb
but it does still work well, and there are a lot of drivers available.

In case you have not used it here is a connection example.
  public string callQuery(string strConnection, string strSQL)
  {
   string strReturn = &quot; &lt;results connectionstring=\&quot;&quot; + strConnection +
&quot;\&quot;&gt;\n&quot;;
   OdbcConnection dbcon = new OdbcConnection(strConnection);
   try
   {
    stringFunctions strClass = new stringFunctions();
               dbcon.Open();
               OdbcCommand dbcmd = new OdbcCommand(strSQL,dbcon);
               OdbcDataReader sqlreader = dbcmd.ExecuteReader();
    while (sqlreader.Read()){
            //Do something
     }
     //Carry on
Again I hope that this helps.

All the best
Simon
-- 
Simon Bain 
TENdotZERO 
---------- 
XML Open Conference Speaker:- Data Integration with XML and Mono 
<A HREF="http://www.xmlopen.org">http://www.xmlopen.org</A> 
---------- 
XML 2004 Conference Speaker:- e-Voting 
<A HREF="http://www.xmlconference.org/xmlusa/">http://www.xmlconference.org/xmlusa/</A> 

&gt;<i> Hello guys. 
</I>&gt;<i> 
</I>&gt;<i> I am developing an ASP.NET application and I have problems connecting to 
</I>&gt;<i> the 
</I>&gt;<i> database. No compilation errors but I catch this exception: 
</I>&gt;<i> 
</I>&gt;<i> System.DllNotFoundException: gda-2 in &lt;0x00050&gt; (wrapper 
</I>&gt;<i> managed-to-native) 
</I>&gt;<i> System.Data.OleDb.libgda:gda_init (string,string,int,string[]) in 
</I>&gt;<i> &lt;0x0003e&gt; 
</I>&gt;<i> System.Data.OleDb.OleDbConnection:.ctor () in &lt;0x0000a&gt; 
</I>&gt;<i> System.Data.OleDb.OleDbConnection:.ctor (string) in &lt;0x00053&gt; (wrapper 
</I>&gt;<i> remoting-invoke-with-check) System.Data.OleDb.OleDbConnection:.ctor 
</I>&gt;<i> (string) 
</I>&gt;<i> in &lt;0x00065&gt; ConexionDB:prueba () 
</I>&gt;<i> 
</I>&gt;<i> My block of code is: 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> public class ConexionDB { 
</I>&gt;<i> 
</I>&gt;<i> const string sCon = &quot;DSN=cronos_geac_oracle;PASSWORD=xxxxx;UID=user;&quot;; 
</I>&gt;<i> 
</I>&gt;<i> public string prueba () { 
</I>&gt;<i> 
</I>&gt;<i> OleDbConnection oCon; 
</I>&gt;<i> 
</I>&gt;<i> try { 
</I>&gt;<i> oCon = new OleDbConnection(this.sCon); 
</I>&gt;<i> } 
</I>&gt;<i> catch (Exception e) { 
</I>&gt;<i> return e+&quot;&quot;; 
</I>&gt;<i> } 
</I>&gt;<i> 
</I>&gt;<i> } 
</I>&gt;<i> } 
</I>&gt;<i> 
</I>&gt;<i> The thing is that I have already found one person that has had my problem,
</I>
&gt;<i> but it seems no one replied his message (thread formed by only one 
</I>&gt;<i> message): 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.mail-archive.com/mono-list@lists.ximian.com/msg09588.html">http://www.mail-archive.com/mono-list@lists.ximian.com/msg09588.html</A> 
</I>&gt;<i> 
</I>&gt;<i> The unique difference, I think, is that I am on Windows XP and he is on 
</I>&gt;<i> Linux. Version of Mono: 1.0.1. 
</I>&gt;<i> 
</I>&gt;<i> Anyone could comment anything about this? Thanks very much in advance. 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Regards, 
</I>&gt;<i> 
</I>&gt;<i> Andrew 
</I>&gt;<i> _______________________________________________ 
</I>&gt;<i> Mono-devel-list mailing list 
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A> 
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A> 
</I>&gt;<i> 
</I>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040915/c50b5ba3/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040915/c50b5ba3/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007918.html">[Mono-devel-list] Permission Request Sets - Encoding
</A></li>
	<LI>Next message: <A HREF="007912.html">[Mono-devel-list] Exception using ASP.NET (XSP) and OleDb cla	ss
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7911">[ date ]</a>
              <a href="thread.html#7911">[ thread ]</a>
              <a href="subject.html#7911">[ subject ]</a>
              <a href="author.html#7911">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
