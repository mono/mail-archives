<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Using assembly in GAC fails but runs okay in same path	as	executable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Using%20assembly%20in%20GAC%20fails%20but%20runs%20okay%20in%20same%20path%0A%09as%09executable&In-Reply-To=43D579DE.2060708%40verizon.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016774.html">
   <LINK REL="Next"  HREF="016776.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Using assembly in GAC fails but runs okay in same path	as	executable</H1>
    <B>Daniel Morgan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Using%20assembly%20in%20GAC%20fails%20but%20runs%20okay%20in%20same%20path%0A%09as%09executable&In-Reply-To=43D579DE.2060708%40verizon.net"
       TITLE="[Mono-dev] Using assembly in GAC fails but runs okay in same path	as	executable">danielmorgan at verizon.net
       </A><BR>
    <I>Mon Jan 23 20:12:51 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="016774.html">[Mono-dev] Using assembly in GAC fails but runs okay in same path as	executable
</A></li>
        <LI>Next message: <A HREF="016776.html">[Mono-dev] how can I send an arping?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16775">[ date ]</a>
              <a href="thread.html#16775">[ thread ]</a>
              <a href="subject.html#16775">[ subject ]</a>
              <a href="author.html#16775">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I will answer myself.

Using app.config for an assembly in Microsoft .net 1.1 GAC requires the 
fully-qualified assembly name while mono 1.1 does not.

Modifing the section to include the fully-qualified name works.

&lt;section name=&quot;providers&quot; 
type=&quot;Mono.Data.ProviderSectionHandler,Mono.Data, Version=1.0.5000.0, 
Culture=neutral, PublicKeyToken=0738eb9f132ed756&quot; /&gt;

Daniel Morgan wrote:

&gt;<i> I'm having a problem with Mono.Data.dll on Dot NET 1.1.
</I>&gt;<i>
</I>&gt;<i> You can use the DLL compiled with mcs or csc:
</I>&gt;<i> - both will fail when run from the GAC
</I>&gt;<i> - both will work when run from the same subdirectory the executable 
</I>&gt;<i> assembly is run
</I>&gt;<i>
</I>&gt;<i> This is how I build on Dot Net:
</I>&gt;<i> cd mcs\class\Mono.Data
</I>&gt;<i> csc /target:library /out:Mono.Data.dll *.cs 
</I>&gt;<i> ..\..\build\common\Consts.cs /r:System.Data.dll /r:System.Xml.dll 
</I>&gt;<i> /d:NET_1_1
</I>&gt;<i> sn.exe -R Mono.Data.dll ../mono.snk
</I>&gt;<i>
</I>&gt;<i> So, in order to get sqlsharpgtk to work on Dot Net, I had to place 
</I>&gt;<i> Mono.Data.dll wherever sqlsharpgtk.exe is located.
</I>&gt;<i>
</I>&gt;<i> I do not know why Mono.Data.dll fails when loaded from the Dot Net 
</I>&gt;<i> GAC.  It works fine from Mono's GAC.
</I>&gt;<i>
</I>&gt;<i> sqlsharpgtk.exe uses the ProviderFactory in Mono.Data and 
</I>&gt;<i> sqlsharpgtk.exe.config to list and load data providers.
</I>&gt;<i>
</I>&gt;<i> Any idea why?
</I>&gt;<i>
</I>&gt;<i> E:\cygwin\home\Administrator\monosvn\sqlsharpgtk\sqlsharpgtk&gt;sqlsharpgtk
</I>&gt;<i>
</I>&gt;<i> Unhandled Exception: System.TypeInitializationException: The type 
</I>&gt;<i> initializer fo
</I>&gt;<i> r &quot;Mono.Data.ProviderFactory&quot; threw an exception. ---&gt; 
</I>&gt;<i> System.Configuration.Conf
</I>&gt;<i> igurationException: Could not create 
</I>&gt;<i> Mono.Data.ProviderSectionHandler,Mono.Data
</I>&gt;<i>  at System.Configuration.ConfigurationRecord.GetFactory(String configKey)
</I>&gt;<i>  at System.Configuration.ConfigurationRecord.Evaluate(String configKey)
</I>&gt;<i>  at System.Configuration.ConfigurationRecord.ResolveConfig(String 
</I>&gt;<i> configKey)
</I>&gt;<i>  at System.Configuration.ConfigurationRecord.GetConfig(String configKey)
</I>&gt;<i>  at 
</I>&gt;<i> System.Configuration.DefaultConfigurationSystem.System.Configuration.IConf 
</I>&gt;<i>
</I>&gt;<i> igurationSystem.GetConfig(String configKey)
</I>&gt;<i>  at System.Configuration.ConfigurationSettings.GetConfig(String 
</I>&gt;<i> sectionName)
</I>&gt;<i>  at Mono.Data.ProviderFactory..cctor()
</I>&gt;<i>  --- End of inner exception stack trace ---
</I>&gt;<i>  at Mono.Data.ProviderFactory.get_Providers()
</I>&gt;<i>  at Mono.Data.SqlSharp.GtkSharp.LoginDialog.PopulateProviders()
</I>&gt;<i>  at Mono.Data.SqlSharp.GtkSharp.LoginDialog..ctor(SqlSharpGtk 
</I>&gt;<i> sqlSharpGtk)
</I>&gt;<i>  at Mono.Data.SqlSharp.GtkSharp.SqlSharpGtk.Main(String[] args)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016774.html">[Mono-dev] Using assembly in GAC fails but runs okay in same path as	executable
</A></li>
	<LI>Next message: <A HREF="016776.html">[Mono-dev] how can I send an arping?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16775">[ date ]</a>
              <a href="thread.html#16775">[ thread ]</a>
              <a href="subject.html#16775">[ subject ]</a>
              <a href="author.html#16775">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
