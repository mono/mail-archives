<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] RE: Com Interop Patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20RE%3A%20Com%20Interop%20Patch&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016491.html">
   <LINK REL="Next"  HREF="016506.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] RE: Com Interop Patch</H1>
    <B>Jonathan S. Chambers</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20RE%3A%20Com%20Interop%20Patch&In-Reply-To="
       TITLE="[Mono-dev] RE: Com Interop Patch">Jonathan.Chambers at ansys.com
       </A><BR>
    <I>Fri Jan  6 12:59:02 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="016491.html">[Mono-dev] [PATCH] MS.NET compatible Path.GetTempFileName
</A></li>
        <LI>Next message: <A HREF="016506.html">[Mono-dev] RE: Com Interop Patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16494">[ date ]</a>
              <a href="thread.html#16494">[ thread ]</a>
              <a href="subject.html#16494">[ subject ]</a>
              <a href="author.html#16494">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The patch was too big. Attached is the patch to mono. The next email
will have the patch to mcs.

-----Original Message-----
From: Jonathan S. Chambers 
Sent: Friday, January 06, 2006 11:33 AM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: Com Interop Patch

	Here's a first attempt at a patch for COM Interop. This only
provides support for RCWs (Runtime Callable Wrappers), i.e. using
unmanaged COM components from managed code. This should support both
classes used from Interop Assemblies (where metadata is known), as well
as bare interface pointers (with no metadata) who are wrapped using
__ComObject.

	The patch doesn't seem to introduce any regression failures, and
theoretically no code in this patch should even be hit unless you are
using COM Interop functionality.

	Just as a quick update, as much functionality as possible has
been moved to managed code (either in the Marshal or COMInteropHelpers
classes). This helps maintenance, doesn't bloat the runtime with
component specific code, removes compile time dependencies, etc. I'm
hoping for all code in the runtime to be generic component support code.
All specific component code (COM, XPCOM, Mainwin COM) will be in
managed. 

	There's lots left to do, but this provides basic functionality.
I'm sure the patch needs cleanup before commit, so please let me know
what needs changed.

Thanks,
Jonathan

-------------- next part --------------
A non-text attachment was scrubbed...
Name: com_interop_mono.diff
Type: application/octet-stream
Size: 48248 bytes
Desc: com_interop_mono.diff
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060106/02dd0c74/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060106/02dd0c74/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016491.html">[Mono-dev] [PATCH] MS.NET compatible Path.GetTempFileName
</A></li>
	<LI>Next message: <A HREF="016506.html">[Mono-dev] RE: Com Interop Patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16494">[ date ]</a>
              <a href="thread.html#16494">[ thread ]</a>
              <a href="subject.html#16494">[ subject ]</a>
              <a href="author.html#16494">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
