<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] SqlDataAdapter Update Problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SqlDataAdapter%20Update%20Problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016601.html">
   <LINK REL="Next"  HREF="016602.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] SqlDataAdapter Update Problem</H1>
    <B>Scaramella Luca</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20SqlDataAdapter%20Update%20Problem&In-Reply-To="
       TITLE="[Mono-dev] SqlDataAdapter Update Problem">sluca at hotmail.com
       </A><BR>
    <I>Thu Jan 12 06:49:28 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="016601.html">Re: [Mono-dev] Lazy man&#180;s Command Line Parser - Revisited
</A></li>
        <LI>Next message: <A HREF="016602.html">[Mono-dev] SqlDataAdapter Update Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16598">[ date ]</a>
              <a href="thread.html#16598">[ thread ]</a>
              <a href="subject.html#16598">[ subject ]</a>
              <a href="author.html#16598">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everybody,
I'm using Mono 1.1.13.
Adding multiple records to a tables i've got the following error.
The thing i don't understand is why if i add 1 record everything goes Ok ??
The problem seems to be the Update method when i insert more than 1 row.
The code i use is like this
-----------------------------------------------------------------------------------------------------------------------------
	DataSet dsSql = new DataSet();
	tblDa = new SqlDataAdapter(&quot;SELECT * FROM test&quot;,Test.Gcon_ConnectLDB);

	SqlCommandBuilder cb = new SqlCommandBuilder(tblDa);
	tblDa.Fill(dsSql,&quot;test&quot;);

	row_rsInput = dsSql.Tables[0].NewRow();

	row_rsInput[&quot;tmp01_idcard&quot;] = &quot;1111&quot;;
	row_rsInput[&quot;tmp01_iduser&quot;] = &quot;111&quot;;

	dsSql.Tables[0].Rows.Add(row_rsInput);

	row_rsInput = dsSql.Tables[0].NewRow();


	row_rsInput[&quot;tmp01_idcard&quot;] = &quot;2222&quot;;
	row_rsInput[&quot;tmp01_iduser&quot;] = &quot;222&quot;;

	dsSql.Tables[0].Rows.Add(row_rsInput);

	tblDa.Update(dsSql,&quot;test&quot;);

--------------------------------------------------------------------------------------



System.Data.SqlClient.SqlException: The variable name '@p1' has already been 
declared. Variable names must be unique within a query batch or stored 
procedure.
in &lt;0x000a0&gt; System.Data.SqlClient.SqlConnection:ErrorHandler (System.Object 
sender, Mono.Data.Tds.Protocol.TdsInternalErrorMessageEventArgs e)
in (wrapper delegate-invoke) 
System.MulticastDelegate:invoke_void_object_TdsInternalErrorMessageEventArgs 
(object,Mono.Data.Tds.Protocol.TdsInternalErrorMessageEventArgs)
in &lt;0x0001d&gt; Mono.Data.Tds.Protocol.Tds:OnTdsErrorMessage 
(Mono.Data.Tds.Protocol.TdsInternalErrorMessageEventArgs e)
in &lt;0x001aa&gt; Mono.Data.Tds.Protocol.Tds:ProcessMessage (TdsPacketSubType 
subType)
in &lt;0x0010e&gt; Mono.Data.Tds.Protocol.Tds:ProcessSubPacket ()
in &lt;0x00045&gt; Mono.Data.Tds.Protocol.Tds:NextResult ()
in &lt;0x0004b&gt; System.Data.SqlClient.SqlDataReader:NextResult ()
in (wrapper remoting-invoke-with-check) 
System.Data.SqlClient.SqlDataReader:NextResult ()
in &lt;0x0007f&gt; System.Data.SqlClient.SqlDataReader:.ctor 
(System.Data.SqlClient.SqlCommand command)
in (wrapper remoting-invoke-with-check) 
System.Data.SqlClient.SqlDataReader:.ctor (System.Data.SqlClient.SqlCommand)
in &lt;0x00061&gt; System.Data.SqlClient.SqlCommand:ExecuteReader (CommandBehavior 
behavior)



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016601.html">Re: [Mono-dev] Lazy man&#180;s Command Line Parser - Revisited
</A></li>
	<LI>Next message: <A HREF="016602.html">[Mono-dev] SqlDataAdapter Update Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16598">[ date ]</a>
              <a href="thread.html#16598">[ thread ]</a>
              <a href="subject.html#16598">[ subject ]</a>
              <a href="author.html#16598">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
