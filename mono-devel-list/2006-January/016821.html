<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Ldap and Threading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ldap%20and%20Threading&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016826.html">
   <LINK REL="Next"  HREF="016824.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Ldap and Threading</H1>
    <B>JD Conley</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Ldap%20and%20Threading&In-Reply-To="
       TITLE="[Mono-dev] Ldap and Threading">jd.conley at coversant.net
       </A><BR>
    <I>Thu Jan 26 12:37:55 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="016826.html">[Mono-dev] Web.Config thoughts and a few quick bugs..
</A></li>
        <LI>Next message: <A HREF="016824.html">[Mono-dev] XSP Server Erorr Severity one
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16821">[ date ]</a>
              <a href="thread.html#16821">[ thread ]</a>
              <a href="subject.html#16821">[ subject ]</a>
              <a href="author.html#16821">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt; 2. The rest of the patch deals with correct catching and
</I>&gt;<i> &gt; passing of the
</I>&gt;<i> &gt; exceptions thrown in the &quot;working&quot; thread to the &quot;user&quot; thread. This
</I>&gt;<i> &gt; definitely solves the &quot;hang&quot; issue, but does nothing with the cause
</I>of
&gt;<i> &gt; those exceptions. So the route bug(s) remain (correct me if
</I>&gt;<i> &gt; I'm wrong).
</I>&gt;<i> 
</I>&gt;<i> I believe you are correct to the limits of my understanding, but I do
</I>see
&gt;<i> some
</I>&gt;<i> changes in the MessageAgent.cs and MessageVector.cs classes that are
</I>&gt;<i> locking
</I>&gt;<i> related. Mostly around using the collections SyncRoot instead of the
</I>&gt;<i> collection
</I>&gt;<i> object itself for the lock. My assumption when I reviewed the code was
</I>&gt;<i> that
</I>&gt;<i> these changes provided a more reliable lock on the collection and as
</I>such
&gt;<i> prevented the race when accessing the returned messages.
</I>&gt;<i> 
</I>
I used the SycRoot so that I could cleanly use a synchronized internal
list in MessageVector and still have critical sections around loops.
This was very important. One of the exceptions was caused due to that
collection being changed by an add or remove operation while another
thread was doing a loop.

For better understanding of relevant changes I found my original patch
to the Novell library. It's attached. Again, this was to the previous
version of the lib, so you shouldn't apply it directly any current tree.
I submitted this in August and started some threads here about getting
it integrated, but that went nowhere. Here's the link to the Novell
Forge item:
<A HREF="http://forge.novell.com/modules/xfmod/tracker/index.php?func=detail&amp;aid=">http://forge.novell.com/modules/xfmod/tracker/index.php?func=detail&amp;aid=</A>
1271&amp;group_id=1318&amp;atid=1364

To summarize, most of the relevant changes were for better background
error handling, moving around critical sections slightly to fix some
race conditions, and properly synchronizing the MessageVector
collection.

-JD Conley
-------------- next part --------------
A non-text attachment was scrubbed...
Name: jd-ldap.diff
Type: application/octet-stream
Size: 16514 bytes
Desc: jd-ldap.diff
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060126/bc72b6a9/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060126/bc72b6a9/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016826.html">[Mono-dev] Web.Config thoughts and a few quick bugs..
</A></li>
	<LI>Next message: <A HREF="016824.html">[Mono-dev] XSP Server Erorr Severity one
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16821">[ date ]</a>
              <a href="thread.html#16821">[ thread ]</a>
              <a href="subject.html#16821">[ subject ]</a>
              <a href="author.html#16821">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
