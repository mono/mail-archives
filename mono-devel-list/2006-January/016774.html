<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Using assembly in GAC fails but runs okay in same path as	executable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Using%20assembly%20in%20GAC%20fails%20but%20runs%20okay%20in%20same%20path%20as%0A%09executable&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016772.html">
   <LINK REL="Next"  HREF="016775.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Using assembly in GAC fails but runs okay in same path as	executable</H1>
    <B>Daniel Morgan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Using%20assembly%20in%20GAC%20fails%20but%20runs%20okay%20in%20same%20path%20as%0A%09executable&In-Reply-To="
       TITLE="[Mono-dev] Using assembly in GAC fails but runs okay in same path as	executable">danielmorgan at verizon.net
       </A><BR>
    <I>Mon Jan 23 19:50:38 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="016772.html">[Mono-dev] Problem building mono / mcs from SVN
</A></li>
        <LI>Next message: <A HREF="016775.html">[Mono-dev] Using assembly in GAC fails but runs okay in same path	as	executable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16774">[ date ]</a>
              <a href="thread.html#16774">[ thread ]</a>
              <a href="subject.html#16774">[ subject ]</a>
              <a href="author.html#16774">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm having a problem with Mono.Data.dll on Dot NET 1.1.

You can use the DLL compiled with mcs or csc:
- both will fail when run from the GAC
- both will work when run from the same subdirectory the executable 
assembly is run

This is how I build on Dot Net:
cd mcs\class\Mono.Data
csc /target:library /out:Mono.Data.dll *.cs ..\..\build\common\Consts.cs 
/r:System.Data.dll /r:System.Xml.dll /d:NET_1_1
sn.exe -R Mono.Data.dll ../mono.snk

So, in order to get sqlsharpgtk to work on Dot Net, I had to place 
Mono.Data.dll wherever sqlsharpgtk.exe is located.

I do not know why Mono.Data.dll fails when loaded from the Dot Net GAC.  
It works fine from Mono's GAC.

sqlsharpgtk.exe uses the ProviderFactory in Mono.Data and 
sqlsharpgtk.exe.config to list and load data providers.

Any idea why?

E:\cygwin\home\Administrator\monosvn\sqlsharpgtk\sqlsharpgtk&gt;sqlsharpgtk

Unhandled Exception: System.TypeInitializationException: The type 
initializer fo
r &quot;Mono.Data.ProviderFactory&quot; threw an exception. ---&gt; 
System.Configuration.Conf
igurationException: Could not create 
Mono.Data.ProviderSectionHandler,Mono.Data
  at System.Configuration.ConfigurationRecord.GetFactory(String configKey)
  at System.Configuration.ConfigurationRecord.Evaluate(String configKey)
  at System.Configuration.ConfigurationRecord.ResolveConfig(String 
configKey)
  at System.Configuration.ConfigurationRecord.GetConfig(String configKey)
  at 
System.Configuration.DefaultConfigurationSystem.System.Configuration.IConf
igurationSystem.GetConfig(String configKey)
  at System.Configuration.ConfigurationSettings.GetConfig(String 
sectionName)
  at Mono.Data.ProviderFactory..cctor()
  --- End of inner exception stack trace ---
  at Mono.Data.ProviderFactory.get_Providers()
  at Mono.Data.SqlSharp.GtkSharp.LoginDialog.PopulateProviders()
  at Mono.Data.SqlSharp.GtkSharp.LoginDialog..ctor(SqlSharpGtk sqlSharpGtk)
  at Mono.Data.SqlSharp.GtkSharp.SqlSharpGtk.Main(String[] args)



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016772.html">[Mono-dev] Problem building mono / mcs from SVN
</A></li>
	<LI>Next message: <A HREF="016775.html">[Mono-dev] Using assembly in GAC fails but runs okay in same path	as	executable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16774">[ date ]</a>
              <a href="thread.html#16774">[ thread ]</a>
              <a href="subject.html#16774">[ subject ]</a>
              <a href="author.html#16774">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
