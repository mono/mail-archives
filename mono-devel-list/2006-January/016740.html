<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Reverted patch 55895
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Reverted%20patch%2055895&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016739.html">
   <LINK REL="Next"  HREF="016742.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Reverted patch 55895</H1>
    <B>Miguel de Icaza</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Reverted%20patch%2055895&In-Reply-To="
       TITLE="[Mono-dev] Reverted patch 55895">miguel at novell.com
       </A><BR>
    <I>Sun Jan 22 14:28:55 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="016739.html">[Mono-dev] #pragmas in source code.
</A></li>
        <LI>Next message: <A HREF="016742.html">[Mono-dev] Reverted patch 55895
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16740">[ date ]</a>
              <a href="thread.html#16740">[ thread ]</a>
              <a href="subject.html#16740">[ subject ]</a>
              <a href="author.html#16740">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Konstantin,

   I reverted the patch 55895 because it has a severe performance
impact, and in Mono, it has a severe memory impact.   You inserted a
ToLower in a routine that is called numerous times on each request,
creating a problem for our runtime.

   I realize that you were trying to fix a bug, but given the delicate
nature of this routine, we must fix this bug in a different way.

   My suggestion is that you add at the end of the routine a call to
capitalize the string properly, so if we fail to find a match for a
string, say &quot;content-lenght&quot;, it then capitalizes it properly and tries
the switch again (there is one special case to handle, header &quot;TE&quot;, but
that is all).

   This means that the code in our libraries (the main consumer of it)
never hits the slow path, nor does it create unnecessary strings, and
user code that might use a different casing for those variables will
work as expected.

Miguel.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016739.html">[Mono-dev] #pragmas in source code.
</A></li>
	<LI>Next message: <A HREF="016742.html">[Mono-dev] Reverted patch 55895
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16740">[ date ]</a>
              <a href="thread.html#16740">[ thread ]</a>
              <a href="subject.html#16740">[ subject ]</a>
              <a href="author.html#16740">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
