<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Uri.cs and UriParser.cs - .NET 2.0 changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Uri.cs%20and%20UriParser.cs%20-%20.NET%202.0%20changes&In-Reply-To=117799f00810311009l1ea1c2f8ja439fc563ecf411d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029591.html">
   <LINK REL="Next"  HREF="029593.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Uri.cs and UriParser.cs - .NET 2.0 changes</H1>
    <B>Alan McGovern</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Uri.cs%20and%20UriParser.cs%20-%20.NET%202.0%20changes&In-Reply-To=117799f00810311009l1ea1c2f8ja439fc563ecf411d%40mail.gmail.com"
       TITLE="[Mono-dev] Uri.cs and UriParser.cs - .NET 2.0 changes">alan.mcgovern at gmail.com
       </A><BR>
    <I>Fri Oct 31 14:05:34 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="029591.html">[Mono-dev] [PATCH] Add .desktop file to gsharp
</A></li>
        <LI>Next message: <A HREF="029593.html">[Mono-dev] eglib patch to implement some unicode stuff
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29592">[ date ]</a>
              <a href="thread.html#29592">[ thread ]</a>
              <a href="subject.html#29592">[ subject ]</a>
              <a href="author.html#29592">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

In .NET 2.0, Uri parsing has been moved to designated classes all derived
from UriParser. This makes it possible to have custom parsers for new Uri
schemes. Currently mono doesn't support this properly.

What I think would be the best thing to do would be to change parsing under
all profiles to use this new API. In the .NET 1.1 profile, we'd just mark
these classes as internal, so this gives one codepath to maintain.

In .NET 1.1 Uri.Parse () would would be replaced by calls to the new parser
classes so that existing behaviour isn't changed. Under .NET 2.0, I believe
an approach similar to what I've prototyped in the attached patch should be
what is implemented. Basically each of the properties of Uri will call into
the parser to get the required component. The results of this call could be
cached locally for increased performance.

The other benefit is that it should also reduce the shotgun approach to
parsing, i.e. the special casing in the parse logic for different schemes.
This might make things more maintainable.

An example parser is also attached in Test.cs and is implemented as a
console app. If you apply the above patch to mono, you can parse the &quot;pack&quot;
schema. Note, the patch *will* break all other Uri parsing as i hardcoded a
&quot;pack&quot; parser.

Does anyone have any thoughts on this?

Alan.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081031/6b5fcd38/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081031/6b5fcd38/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: UriParserChanges.cs
Type: text/x-csharp
Size: 4237 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081031/6b5fcd38/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081031/6b5fcd38/attachment.bin</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Test.cs
Type: text/x-csharp
Size: 3725 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081031/6b5fcd38/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081031/6b5fcd38/attachment-0001.bin</A> 
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029591.html">[Mono-dev] [PATCH] Add .desktop file to gsharp
</A></li>
	<LI>Next message: <A HREF="029593.html">[Mono-dev] eglib patch to implement some unicode stuff
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29592">[ date ]</a>
              <a href="thread.html#29592">[ thread ]</a>
              <a href="subject.html#29592">[ subject ]</a>
              <a href="author.html#29592">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
