<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Connecting to a db using OleDbConnection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Connecting%20to%20a%20db%20using%20OleDbConnection&In-Reply-To=d24465cb05010309481b898438%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009640.html">
   <LINK REL="Next"  HREF="009642.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Connecting to a db using OleDbConnection</H1>
    <B>Rafael Teixeira</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Connecting%20to%20a%20db%20using%20OleDbConnection&In-Reply-To=d24465cb05010309481b898438%40mail.gmail.com"
       TITLE="[Mono-devel-list] Connecting to a db using OleDbConnection">monoman at gmail.com
       </A><BR>
    <I>Mon Jan  3 13:56:19 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="009640.html">[Mono-devel-list] Connecting to a db using OleDbConnection
</A></li>
        <LI>Next message: <A HREF="009642.html">[Mono-devel-list] Connecting to a db using OleDbConnection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9641">[ date ]</a>
              <a href="thread.html#9641">[ thread ]</a>
              <a href="subject.html#9641">[ subject ]</a>
              <a href="author.html#9641">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm not sure what may be causing the error, but I sure recommend to
use the specific providers (NPgSQL for PostgreSQL...) that are more
exercised, because they have better performance and deal better with
the database peculiarities.

If you are looking after OLEBD for easing multidatabase support, I
think some other approach like Canuto's Advanced Data Provider
(<A HREF="http://sourceforge.net/projects/advanced-ado/">http://sourceforge.net/projects/advanced-ado/</A>) is better suited, and
more portable.

Hope it helps,


On Mon, 3 Jan 2005 23:18:46 +0530, Ankit Jain &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">radical at gmail.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I'm trying to compile a simple test program available at
</I>&gt;<i> <A HREF="http://www.go-mono.com/oledb.html">http://www.go-mono.com/oledb.html</A> to connect to a db. I believe
</I>&gt;<i> OleDbConnection uses libgda as the backend to make the actual
</I>&gt;<i> connection to the database. My installation of libgda is working fine.
</I>&gt;<i> I've tried adding entries for a PostgreSQL and a MySQL server in the
</I>&gt;<i> config file and it works fine(tested via gda-test, it can connect ..
</I>&gt;<i> fetch data etc).
</I>&gt;<i> 
</I>&gt;<i> But the C# program is not being able to connect. The code:
</I>&gt;<i> 
</I>&gt;<i> using System;
</I>&gt;<i> using System.Data;
</I>&gt;<i> using System.Data.OleDb;
</I>&gt;<i> 
</I>&gt;<i> public class Test
</I>&gt;<i> {
</I>&gt;<i>         public static void Main(string[] args)
</I>&gt;<i>         {
</I>&gt;<i>                 try{
</I>&gt;<i>                         // there is a libgda PostgreSQL provider
</I>&gt;<i>                         string connectionString =
</I>&gt;<i>                                 &quot;Provider=PostgreSQL;&quot; +
</I>&gt;<i>                                 &quot;Addr=127.0.0.1;&quot; +
</I>&gt;<i>                                 &quot;Database=test;&quot; +
</I>&gt;<i>                                 &quot;User ID=postgres;&quot; +
</I>&gt;<i>                                 &quot;Password=&quot;;
</I>&gt;<i> 
</I>&gt;<i>                         IDbConnection dbcon;
</I>&gt;<i>                         dbcon = new OleDbConnection(connectionString);
</I>&gt;<i>                         dbcon.Open();
</I>&gt;<i> 
</I>&gt;<i>                         //IDbCommand dbcmd = dbcon.CreateCommand();
</I>&gt;<i> 
</I>&gt;<i>                         string sql =
</I>&gt;<i>                                 &quot;SELECT firstname, lastname &quot; +
</I>&gt;<i>                                 &quot;FROM employee&quot;;
</I>&gt;<i>                         IDbCommand dbcmd = new OleDbCommand(sql,
</I>&gt;<i> (OleDbConnection)dbcon);
</I>&gt;<i> 
</I>&gt;<i>                         Console.WriteLine(&quot;CmdText= {0}\n&quot;, dbcmd.CommandText);
</I>&gt;<i>                         //dbcmd.CommandText = sql;
</I>&gt;<i>                         IDataReader reader = dbcmd.ExecuteReader();
</I>&gt;<i>                         while(reader.Read()) {
</I>&gt;<i>                                 string FirstName = (string) reader[&quot;firstname&quot;];
</I>&gt;<i>                                 string LastName = (string) reader[&quot;lastname&quot;];
</I>&gt;<i>                                 Console.WriteLine(&quot;Name: &quot; +
</I>&gt;<i>                                                 FirstName + &quot; &quot; + LastName);
</I>&gt;<i>                         }
</I>&gt;<i>                         // clean up
</I>&gt;<i>                         reader.Close();
</I>&gt;<i>                         reader = null;
</I>&gt;<i>                         dbcmd.Dispose();
</I>&gt;<i>                         dbcmd = null;
</I>&gt;<i>                         dbcon.Close();
</I>&gt;<i>                         dbcon = null;
</I>&gt;<i>                 }catch(Exception e){
</I>&gt;<i>                         Console.WriteLine(&quot;Exception : {0}\n&quot;, e.Message);
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> And this is the output:
</I>&gt;<i> 
</I>&gt;<i> Unhandled Exception: System.InvalidOperationException: State != Open
</I>&gt;<i> in &lt;0x00088&gt; System.Data.OleDb.OleDbCommand:ExecuteReader
</I>&gt;<i> (System.Data.CommandBehavior)
</I>&gt;<i> in &lt;0x00048&gt; (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.Data.OleDb.OleDbCommand:ExecuteReader
</I>&gt;<i> (System.Data.CommandBehavior)
</I>&gt;<i> in &lt;0x0000f&gt; System.Data.OleDb.OleDbCommand:ExecuteReader ()
</I>&gt;<i> in &lt;0x0003b&gt; (wrapper remoting-invoke-with-check)
</I>&gt;<i> System.Data.OleDb.OleDbCommand:ExecuteReader ()
</I>&gt;<i> in &lt;0x0000d&gt; System.Data.OleDb.OleDbCommand:System.Data.IDbCommand.ExecuteReader
</I>&gt;<i> ()
</I>&gt;<i> in [0x00037] (at /home/radical/dev/mono/Test.cs:45) Test:Main (string[])
</I>&gt;<i> 
</I>&gt;<i> Basically, its not being able to make the actual connection, but it
</I>&gt;<i> doesnt give the error at dbcon.Open(). It throws the exception when I
</I>&gt;<i> try to execute a query..
</I>&gt;<i> 
</I>&gt;<i> What could be the problem here? What am i missing?
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> -Anks
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>

-- 
Rafael &quot;Monoman&quot; Teixeira
---------------------------------------
I'm trying to become a &quot;Rosh Gadol&quot; before my own eyes. 
See <A HREF="http://www.joelonsoftware.com/items/2004/12/06.html">http://www.joelonsoftware.com/items/2004/12/06.html</A> for enlightment.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009640.html">[Mono-devel-list] Connecting to a db using OleDbConnection
</A></li>
	<LI>Next message: <A HREF="009642.html">[Mono-devel-list] Connecting to a db using OleDbConnection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9641">[ date ]</a>
              <a href="thread.html#9641">[ thread ]</a>
              <a href="subject.html#9641">[ subject ]</a>
              <a href="author.html#9641">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
