<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] VM differences with java
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20VM%20differences%20with%20java&In-Reply-To=9ac79a71050111115152b3912%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009730.html">
   <LINK REL="Next"  HREF="009741.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] VM differences with java</H1>
    <B>Massimiliano Mantione</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20VM%20differences%20with%20java&In-Reply-To=9ac79a71050111115152b3912%40mail.gmail.com"
       TITLE="[Mono-devel-list] VM differences with java">massi at ximian.com
       </A><BR>
    <I>Wed Jan 12 04:04:33 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="009730.html">[Mono-devel-list] VM differences with java
</A></li>
        <LI>Next message: <A HREF="009741.html">[Mono-devel-list] VM differences with java
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9738">[ date ]</a>
              <a href="thread.html#9738">[ thread ]</a>
              <a href="subject.html#9738">[ subject ]</a>
              <a href="author.html#9738">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>My two cents, others will give better answers...
If I say stupid things please somebody correct me, I'm also
testing if I got things right ;-)

On Tue, 2005-01-11 at 20:51, Peter Gerdes wrote:
&gt;<i> 1)  Is there any reason not to have the JIT compiler cache the native
</I>&gt;<i> code snippets/SSA tree after being run and then reload them if
</I>&gt;<i> appropriate?
</I>
Do you mean for inlining?
Caching native code would not be appropriate, the point of inlining
is not only to avoid the call, but also to be able to optimize the
&quot;called&quot; (now inlined) code *inside* the calling code.
On the other hand, caching the IR would be technically feasible, but
not necessarily such a big advantage IMHO.
The cached IR would need to be &quot;merged&quot; with the IR of the caller,
including local variables and basic blocks... at the very least
memory management would be a mess (the current use of memory pools
is quite clean and simple).
And since inlined methods are small, recompiling them from CIL is
not that bad, and no memory overhead is wasted keeping MonoInst
trees around.

If, on the other hand, by &quot;caching&quot; you mean AOT, well, that works
already.

&gt;<i> 2) Does anyone have any advice on what are the best papers to read on
</I>&gt;<i> the code generation system.  I have been plowing through several BURS
</I>&gt;<i> related papers but figured some advice from people who know might be
</I>&gt;<i> helpfull.
</I>
Sorry, I'm not an expert on this, I just read the Fraser book...

&gt;<i> 3) Did any of the dynamic/profiling  optimizations ever make it into
</I>&gt;<i> the code generation?
</I>
Not yet, but Paolo just committed the statistical profiler (without
an on line profiler you simply cannot do those things...).

&gt;<i> Finally, out of curiosity since the CIL instruction set seems so
</I>&gt;<i> similar to the JVM bytecodes what was the motivation to write your own
</I>&gt;<i> full JIT system rather than expanding an existing JVM or even
</I>&gt;<i> translating CIL instructions to java bytecodes?  Since you now seem to
</I>&gt;<i> be faster than any opensource JVM implementation it is all irrelevant
</I>&gt;<i> now but I'm just curious if there was any particular reason which
</I>&gt;<i> would have made this impractical.
</I>
About translating CIL to Java bytecode... I think we would have
had a very hard time at least with the following, in random order:
- unsafe pointers
- delegates
- marshalling
- p/invoke
- value types
- low level remoting things (the way remoting proxies work)
- also appdomain behaviour would have been hard to do IMHO
I'm not saying it is impossible, probably the guys at Mainsoft
solved exactly those issues...
I'm just saying it's hard, and (likely) suboptimal.
And then in order to have a free (libre) system you would need to
have a free JVM, which brings us to the next point...

About the decision to start from scratch instead of taking an
existing open source JVM and modify it... I wasn't here when it
all begun, but I remember the quality of open source JVMs was
really, really low, and at most you could reuse part of the jit
and code generator, the class loader, verifier and so on had to
be rewritten anyway to work with CIL, and so all the .NET class
libraries, high level (C#, VB, EcmaScript) compilers...

Hope this helps...

Ciao,
  Massi



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009730.html">[Mono-devel-list] VM differences with java
</A></li>
	<LI>Next message: <A HREF="009741.html">[Mono-devel-list] VM differences with java
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9738">[ date ]</a>
              <a href="thread.html#9738">[ thread ]</a>
              <a href="subject.html#9738">[ subject ]</a>
              <a href="author.html#9738">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
