<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] [PATCH] (With test cases) asp.net's ListControl.cs fixes.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20%28With%20test%20cases%29%20asp.net%27s%20ListControl.cs%20fixes.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001774.html">
   <LINK REL="Next"  HREF="001777.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] [PATCH] (With test cases) asp.net's ListControl.cs fixes.</H1>
    <B>Yaacov Akiba Slama</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%5BPATCH%5D%20%28With%20test%20cases%29%20asp.net%27s%20ListControl.cs%20fixes.&In-Reply-To="
       TITLE="[Mono-devel-list] [PATCH] (With test cases) asp.net's ListControl.cs fixes.">ya at slamail.org
       </A><BR>
    <I>Thu Aug 14 06:23:39 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001774.html">[Mono-devel-list] [PATCH] Fix for SqlDataReader.GetChars
</A></li>
        <LI>Next message: <A HREF="001777.html">[Mono-devel-list] [PATCH] (With test cases) asp.net's	ListControl.cs fixes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1775">[ date ]</a>
              <a href="thread.html#1775">[ thread ]</a>
              <a href="subject.html#1775">[ subject ]</a>
              <a href="author.html#1775">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Below is a patch fixing some bugs in
mcs/class/System.Web/System.Web.UI.WebControls/ListControl.cs

[ The work was done by Yaron Shkop &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">yaronsh at mainsoft.com</A>&gt; ]

1) &quot;DataSource&quot; property (set). A null value is legal.

The enclosed test1.asx is a small test case with two buttons Clear and 
Fill. Clear puts null in Datasource. That's work in MS's asp.net but not 
in mono without this patch.

2) Add a &quot;CachedSelectedValue&quot; private variable and its use in property
&quot;SelectedValue&quot; and in &quot;the OnDataBinding&quot; method. Its purpose is to
give the control a selected value before binding it to data (the same
mechanism is already here for &quot;CachedSelectedindex&quot;).

The enclosed test2.aspx set &quot;SelectedValue&quot; before defining and binding 
the datasource and it choose the right value in the datasource as soon 
the binding is done in MS asp.net.

3) Fix in &quot;OnDataBinding&quot; the case when exactly one of DataTextField and
DataValueField has a lenght &gt; 0.

test3.aspx uses only datavaluefield and works in MS's asp.net but not in 
mono witjout this patch.

The patch seems to work here and IMHO can be applied to your tree.

Thanks,
Yaacov Akiba Slama


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ListControl.cs.diff
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment.pl</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: test1.aspx
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment-0001.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment-0001.pl</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: test2.aspx
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment-0002.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment-0002.pl</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: test3.aspx
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment-0003.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030814/747857c7/attachment-0003.pl</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001774.html">[Mono-devel-list] [PATCH] Fix for SqlDataReader.GetChars
</A></li>
	<LI>Next message: <A HREF="001777.html">[Mono-devel-list] [PATCH] (With test cases) asp.net's	ListControl.cs fixes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1775">[ date ]</a>
              <a href="thread.html#1775">[ thread ]</a>
              <a href="subject.html#1775">[ subject ]</a>
              <a href="author.html#1775">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
