<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Embeding MONO and (p)threads
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Embeding%20MONO%20and%20%28p%29threads&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001767.html">
   <LINK REL="Next"  HREF="001761.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Embeding MONO and (p)threads</H1>
    <B>Francisco Puentes</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Embeding%20MONO%20and%20%28p%29threads&In-Reply-To="
       TITLE="[Mono-devel-list] Embeding MONO and (p)threads">fran at cic-online.net
       </A><BR>
    <I>Tue Aug 12 19:05:36 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001767.html">RES: [Mono-devel-list] compiling from CVS
</A></li>
        <LI>Next message: <A HREF="001761.html">[Mono-devel-list] Embeding MONO and (p)threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1759">[ date ]</a>
              <a href="thread.html#1759">[ thread ]</a>
              <a href="subject.html#1759">[ subject ]</a>
              <a href="author.html#1759">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Is it possible to make a function in mono to include a pre build thread
in the GC threads list?
 
I suppose &quot;mono_thread_attach(MonoDomain*)&quot; do this, but it hangs when
it is called from a thread :-(
 
Something like &quot;mono_thread_attach_prebuild(MonoDomain*, pthread_t)&quot;.
 
AND
 
Is it necessary call the function &quot;mono_runtime_xxx_code()&quot; to init
assembly 
                                                ^^^
                               I don't remember the real name yet ;-)
 
from a thread? It seems like a trick, but it is not a good trick in long
time.
 
The perfect execution for an embedded MONO is init it and run the
assembly from a unique thread (or several) and support that the extern
thread can control all the execution of the code.
 
For example: My project creates a lot of execution environments (with
fork), and each one of this can create a lot of threads, each one with a
different MONO domain. When an IP packet arrives it is sending to the
correct code (MONO code) and performs process over this one (perhaps
generating more IP packets). To allow more than one code type, each
thread (can) load a library which contains the execution control so I
can have a .so for dotNet, other for Java, etc... So pre compile the
code with GC is a lack.
 
It is an exigent environment to test mono in a complex surrounding. And
MONO seems like it isn't able to support that requirements.
 
I think that is most useful to have got a garbage collector simpler
(although slower) but more independent to allow a powerful MONO. And in
long term support a more complex (and efficient) garbage collector. I
think so because MONO is limited to be embedded in very simple
applications which have got the control inside the portable code and
*not* inside the native code (which is a powerful tool to powerful
applications). 
 
Well, they are some ideas ;-)
 
Can anybody send me an example of MONO embed into threads? Something
more complex than the example in CVS:/mono/samples/embed
 
Thanks in advance: Fran
 
-----Mensaje original-----
De: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-admin at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-admin at lists.ximian.com</A>] En nombre de Dick Porter
Enviado el: martes, 12 de agosto de 2003 11:55
Para: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Asunto: Re: [Mono-devel-list] Embeding MONO and (p)threads
 
On Tue, 2003-08-12 at 04:25, David Jeske wrote:
&gt;<i> On Mon, Aug 11, 2003 at 04:38:53PM +0100, Dick Porter wrote:
</I>&gt;<i> &gt; You need to make sure your whole embedded application is using the 
</I>&gt;<i> &gt; libgc-wrapped pthreads calls, not just the mono part.  See 
</I>&gt;<i> &gt;  &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;
</I><A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>
 for more details. 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; While this seems
acceptable for now, in the long term this seems like 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; a problem. As
someone else pointed out, this will prevent Mono from 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; being embeddable
inside any pre-built applications.
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; Can someone
elaborate more about what causes this problem, and what we 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; might do about it
in the future? For example:
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;  
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; Its a libgc
requisite.
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;  
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; Why does libgc
need to override pthread functions?
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;  
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; It needs to be able
to stop all the threads when it does a collection, and therefore it
needs to know about all threads.  Theres some documentation about why
its done by cpp tricks rather than dynamic linker tricks, but I can't
remember the details offhand.
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;  
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; What is the
problem with having some code talk directly to pthreads, 
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; &gt; and some code talk
to libgc's pthread overrides?
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;  
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; Segmentation faults.
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;  
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; - Dick
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;  
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;
_______________________________________________
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt; Mono-devel-list
mailing list
 &lt;<A HREF="http://bugzilla.ximian.com/show_bug.cgi?id=46137">http://bugzilla.ximian.com/show_bug.cgi?id=46137</A>&gt;
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
 &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>&gt;  
 &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>&gt;  
 &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>&gt;  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030813/73fd6f58/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030813/73fd6f58/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001767.html">RES: [Mono-devel-list] compiling from CVS
</A></li>
	<LI>Next message: <A HREF="001761.html">[Mono-devel-list] Embeding MONO and (p)threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1759">[ date ]</a>
              <a href="thread.html#1759">[ thread ]</a>
              <a href="subject.html#1759">[ subject ]</a>
              <a href="author.html#1759">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
