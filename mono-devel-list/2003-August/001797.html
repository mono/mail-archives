<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] (no subject)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%28no%20subject%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001799.html">
   <LINK REL="Next"  HREF="001848.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] (no subject)</H1>
    <B>J&#246;rg Rosenkranz</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%28no%20subject%29&In-Reply-To="
       TITLE="[Mono-devel-list] (no subject)">joergr at voelcker.com
       </A><BR>
    <I>Mon Aug 18 09:37:09 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001799.html">[Mono-devel-list] new interp.c
</A></li>
        <LI>Next message: <A HREF="001848.html">[Mono-devel-list] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1797">[ date ]</a>
              <a href="thread.html#1797">[ thread ]</a>
              <a href="subject.html#1797">[ subject ]</a>
              <a href="author.html#1797">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I have attached two patches to solve bug #40315
(SqlCommand::ExecuteNonQuery always returns 0).

1) I have changed ExecuteNonQuery to return Connection.Tds.RecordsAffected
if it is successfull. 

2) RecordsAffected was not filled correctly by Tds.ProcessEndToken. 
I've found out that the record count was submitted for 
TdsPacketSubType.Done. So I changed the behaviour to include this
(without deeper knowledge of the TDS protocol).

Could someone please review these patches and commit them if there
are no objections against them?

Thanks,
Joerg
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Mono.Data.Tds.Protocol_40315.diff
Type: application/octet-stream
Size: 824 bytes
Desc: Mono.Data.Tds.Protocol_40315.diff
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030818/ae987485/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030818/ae987485/attachment.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: System.Data.SqlClient_40315.diff
Type: application/octet-stream
Size: 609 bytes
Desc: System.Data.SqlClient_40315.diff
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030818/ae987485/attachment-0001.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030818/ae987485/attachment-0001.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001799.html">[Mono-devel-list] new interp.c
</A></li>
	<LI>Next message: <A HREF="001848.html">[Mono-devel-list] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1797">[ date ]</a>
              <a href="thread.html#1797">[ thread ]</a>
              <a href="subject.html#1797">[ subject ]</a>
              <a href="author.html#1797">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
