<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mac Boehm CG question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mac%20Boehm%20CG%20question&In-Reply-To=97710563-C3DC-4545-A952-04C452E7B49C%40logos.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033968.html">
   <LINK REL="Next"  HREF="033951.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mac Boehm CG question</H1>
    <B>Geoff Norton</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mac%20Boehm%20CG%20question&In-Reply-To=97710563-C3DC-4545-A952-04C452E7B49C%40logos.com"
       TITLE="[Mono-dev] Mac Boehm CG question">gnorton at novell.com
       </A><BR>
    <I>Fri Jan 29 13:59:07 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="033968.html">[Mono-dev] Mac Boehm CG question
</A></li>
        <LI>Next message: <A HREF="033951.html">[Mono-dev] mono crash on exits when using COM.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34001">[ date ]</a>
              <a href="thread.html#34001">[ thread ]</a>
              <a href="subject.html#34001">[ subject ]</a>
              <a href="author.html#34001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This patch is now in trunk, thanks!

-g

On 2010-01-22, at 5:05 PM, Tom Philpot wrote:

&gt;<i> While investigating some performance problems in our application which uses the embedded Mono runtime on Mac OS X targeting 10.5 and 10.6, I noticed that several operations spent an extreme amount of time in GC_lock. That code lead me back to gcconfig.h where NO_PTHREAD_TRYLOCK is defined. I've commented out that #define it on my local Mono build and things seem MUCH faster. In fact I'm now able to do real work on more than 2 threads without a ton of overhead.
</I>&gt;<i> 
</I>&gt;<i> The question is now, does this check still need to be there for later versions of Mac OS X? The original commit was back in August 2003, which was probably around the timeframe of 10.2 and 10.3 and definitely before the Intel Macs. Also, since I don't have a PPC to test on, I didn't comment that #define.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ws1048-snow:mono tom.philpot$ svn diff libgc/include/private/gcconfig.h 
</I>&gt;<i> Index: libgc/include/private/gcconfig.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- libgc/include/private/gcconfig.h	(revision 150077)
</I>&gt;<i> +++ libgc/include/private/gcconfig.h	(working copy)
</I>&gt;<i> @@ -329,7 +329,7 @@
</I>&gt;<i> #    define GETPAGESIZE() getpagesize()
</I>&gt;<i>       /* There seems to be some issues with trylock hanging on darwin. This
</I>&gt;<i>          should be looked into some more */
</I>&gt;<i> -#     define NO_PTHREAD_TRYLOCK
</I>&gt;<i> +//#     define NO_PTHREAD_TRYLOCK
</I>&gt;<i> #   elif defined(__arm__)
</I>&gt;<i> #    define ARM
</I>&gt;<i> #    define mach_type_known
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033968.html">[Mono-dev] Mac Boehm CG question
</A></li>
	<LI>Next message: <A HREF="033951.html">[Mono-dev] mono crash on exits when using COM.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34001">[ date ]</a>
              <a href="thread.html#34001">[ thread ]</a>
              <a href="subject.html#34001">[ subject ]</a>
              <a href="author.html#34001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
