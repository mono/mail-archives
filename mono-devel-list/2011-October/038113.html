<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] sgen + ConditionalWeakTable&lt;,&gt; crashes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20sgen%20%2B%20ConditionalWeakTable%3C%2C%3E%20crashes&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="038118.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] sgen + ConditionalWeakTable&lt;,&gt; crashes</H1>
    <B>Brian Luczkiewicz</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20sgen%20%2B%20ConditionalWeakTable%3C%2C%3E%20crashes&In-Reply-To="
       TITLE="[Mono-dev] sgen + ConditionalWeakTable&lt;,&gt; crashes">brian at sooloos.com
       </A><BR>
    <I>Sat Oct  1 00:51:34 EDT 2011</I>
    <P><UL>
        
        <LI>Next message: <A HREF="038118.html">[Mono-dev] sgen + ConditionalWeakTable&lt;,&gt; crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38113">[ date ]</a>
              <a href="thread.html#38113">[ thread ]</a>
              <a href="subject.html#38113">[ subject ]</a>
              <a href="author.html#38113">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Before I track down a tiny repro case for this and file a formal bug report,
I wanted to check and see if these stack traces look like any known bugs.

We've recently added usage of ConditionalWeakTable&lt;,&gt; api to our codebase.
We are now seeing some crashes in the mono runtime. The crashes appear to be
sgen specific.

The stack traces look like this:

Stacktrace:

  at (wrapper managed-to-native)
object.__icall_wrapper_mono_object_castclass (object,intptr) &lt;IL
0x00022, 0xffffffff&gt;
  at System.Runtime.CompilerServices.ConditionalWeakTable`2.TryGetValue
(TKey,TValue&amp;) [0x00083] in
/private/tmp/monobuild/build/BUILD/mono-2.10.5/mcs/cl... stack frames
of our application code ...
  at Application.Main (string[]) [0x00622] in
/Projects/sooloos/sooloos/Client/Desktop/main.cs:266
  at (wrapper runtime-invoke) &lt;Module&gt;.runtime_invoke_void_object
(object,intptr,intptr,intptr) &lt;IL 0x00050, 0xffffffff&gt;

Native stacktrace:

    0   Sooloos                             0x000bc1d6
mono_handle_native_sigsegv + 422
    1   Sooloos                             0x000049fe
mono_sigsegv_signal_handler + 334
    2   libsystem_c.dylib                   0x98cd559b _sigtramp + 43
    3   ???                                 0xffffffff 0x0 + 4294967295
    4   Sooloos                             0x0016be1c mono_image_lock + 29
    5   Sooloos                             0x0016bf55
mono_image_property_insert + 17
    6   Sooloos                             0x00135659
mono_class_set_failure + 84
    7   Sooloos                             0x0012c745 mono_class_init + 709
    8   Sooloos                             0x001331c4
mono_class_is_assignable_from + 109
    9   Sooloos                             0x001cc1bf mono_object_isinst + 118
    10  Sooloos                             0x0007b549
mono_object_castclass + 57
    11  ???                                 0x004bb8e8 0x0 + 4962536
    12  ???                                 0x0c848794 0x0 + 210012052
    13  ???                                 0x096fc710 0x0 + 158320400
    14  ???                                 0x077aaa80 0x0 + 125479552
    15  ???                                 0x109fdf74 0x0 + 278912884
    16  ???                                 0x109fdf34 0x0 + 278912820
    17  ???                                 0x109b5b8b 0x0 + 278616971
    18  ???                                 0x109b42e8 0x0 + 278610664
    19  ???                                 0x109dfb8e 0x0 + 278789006
    20  ???                                 0x109fb090 0x0 + 278900880
    21  ???                                 0x109fae70 0x0 + 278900336
    22  ???                                 0x109dfb8e 0x0 + 278789006
    23  ???                                 0x109fb090 0x0 + 278900880
    24  ???                                 0x109fae70 0x0 + 278900336
    25  ???                                 0x109dfb8e 0x0 + 278789006
    26  ???                                 0x109fb090 0x0 + 278900880
    27  ???                                 0x137edc24 0x0 + 327080996
    28  ???                                 0x109dfb8e 0x0 + 278789006
    29  ???                                 0x109fb090 0x0 + 278900880
    30  ???                                 0x109fae70 0x0 + 278900336
    31  ???                                 0x109dfb8e 0x0 + 278789006
    32  ???                                 0x109fb090 0x0 + 278900880
    33  ???                                 0x109fae70 0x0 + 278900336
    34  ???                                 0x109dfb8e 0x0 + 278789006
    35  ???                                 0x109fb090 0x0 + 278900880
    36  ???                                 0x109fae70 0x0 + 278900336
    37  ???                                 0x109dfb8e 0x0 + 278789006
    38  ???                                 0x109fb090 0x0 + 278900880
    39  ???                                 0x109fae70 0x0 + 278900336
    40  ???                                 0x109dfb8e 0x0 + 278789006
    41  ???                                 0x109fb090 0x0 + 278900880
    42  ???                                 0x109dfb8e 0x0 + 278789006
    43  ???                                 0x109fb090 0x0 + 278900880
    44  ???                                 0x109fae70 0x0 + 278900336
    45  ???                                 0x109dfb8e 0x0 + 278789006
    46  ???                                 0x109de264 0x0 + 278782564
    47  ???                                 0x0ca05744 0x0 + 211834692
    48  ???                                 0x0ca05506 0x0 + 211834118
    49  ???                                 0x004b32b4 0x0 + 4928180
    50  ???                                 0x004b35a3 0x0 + 4928931
    51  Sooloos                             0x00010724
mono_jit_runtime_invoke + 164
    52  Sooloos                             0x001c7815 mono_runtime_invoke + 137
    53  Sooloos                             0x001ca0f4
mono_runtime_exec_main + 669
    54  Sooloos                             0x001c942e
mono_runtime_run_main + 843
    55  Sooloos                             0x0008caf0 mono_main + 8576
    56  Sooloos                             0x00002eb5 start + 53
    57  ???
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20111001/19d01a28/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20111001/19d01a28/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="038118.html">[Mono-dev] sgen + ConditionalWeakTable&lt;,&gt; crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38113">[ date ]</a>
              <a href="thread.html#38113">[ thread ]</a>
              <a href="subject.html#38113">[ subject ]</a>
              <a href="author.html#38113">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
