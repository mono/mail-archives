<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Crypto inconsistency between Mono and MS.NET
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Crypto%20inconsistency%20between%20Mono%20and%20MS.NET&In-Reply-To=1098304606.3514.34.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008399.html">
   <LINK REL="Next"  HREF="008427.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Crypto inconsistency between Mono and MS.NET</H1>
    <B>Jon Larimer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Crypto%20inconsistency%20between%20Mono%20and%20MS.NET&In-Reply-To=1098304606.3514.34.camel%40localhost.localdomain"
       TITLE="[Mono-devel-list] Crypto inconsistency between Mono and MS.NET">jlarimer at gmail.com
       </A><BR>
    <I>Thu Oct 21 14:13:46 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008399.html">[Mono-devel-list] Crypto inconsistency between Mono and MS.NET
</A></li>
        <LI>Next message: <A HREF="008427.html">[Mono-devel-list] Crypto inconsistency between Mono and MS.NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8413">[ date ]</a>
              <a href="thread.html#8413">[ thread ]</a>
              <a href="subject.html#8413">[ subject ]</a>
              <a href="author.html#8413">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> However I expect that the &quot;official&quot; answer will be like &quot;results of
</I>&gt;<i> calling TransformFinalBlock more than one time is undefined&quot; (i.e.
</I>&gt;<i> expect this to change in future versions but not patched in existing
</I>&gt;<i> frameworks).
</I>&gt;<i> 
</I>&gt;<i> In this case Mono and MS implementation will probably keep their
</I>&gt;<i> different behaviors (as I like Mono results much better ;-) unless I (or
</I>&gt;<i> someone else) find a case which leads to serious problems.
</I>
I got this reply to my usenet post (below). It seems that it's
intentional. In Mono, ICryptoTransform.CanReuseTransform returns
false, and in Microsoft.NET it returns true, so I guess both
implementations are behaving correctly based on that.

-jon
Jon Larimer
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jlarimer at gmail.com</A>
-------

From: Rob Teixeira
Date Posted: 10/21/2004 12:23:00 AM

The behaviour you described is correct. TransformFinalBlock does indeed
reset the feedback.
I believe this is consistent with the intent of the class. The
CanReuseTransform property returns true, which means the feedback should at
some point be reset so the class can be reused.
You have to look at this from the perspective of individual messages. Once
you end a message, you must call TransformFinalBlock, and this resets the
feedback register to the IV for the next message. You have to remember that
message reception may or may not be synchronous, so for example, you can
encrypt various files and they will simply sit somewhere until you decrypt
one of them. You can't assume that you are shipping a bunch of message
around and they will all be dealt with in the same order. If the feedback
isn't reset, that's the only way you could ever decrypt them.

Also, CBC mode induces feedback. This means that subsequent strings of
similar plain text will be affected by previous blocks of cipher text. So,
for example, if you had repeating sets of the letter &quot;E&quot; in your message,
the blocks containing that repetition couldn't be detected from the cipher
text because of the CBC feedback. CBC doesn't guarantee that entirely
similar messages won't look the same after decryption, especially if you are
using the same IV. If you have a scenario like this (where you are sending
the same message over and over using the same IV), you should salt the
message - add a block of random bits to the beginning of the message. On the
receiving end, you can safly ignore the first block, and that guarantees
each message will be different due to the CBC feedback.

-Rob Teixeira

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008399.html">[Mono-devel-list] Crypto inconsistency between Mono and MS.NET
</A></li>
	<LI>Next message: <A HREF="008427.html">[Mono-devel-list] Crypto inconsistency between Mono and MS.NET
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8413">[ date ]</a>
              <a href="thread.html#8413">[ thread ]</a>
              <a href="subject.html#8413">[ subject ]</a>
              <a href="author.html#8413">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
