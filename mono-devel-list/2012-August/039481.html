<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Patches for mono-winforms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Patches%20for%20mono-winforms&In-Reply-To=%3C1344303120.78305.YahooMailNeo%40web164601.mail.gq1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039471.html">
   <LINK REL="Next"  HREF="039482.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Patches for mono-winforms</H1>
    <B>Steven Boswell II</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Patches%20for%20mono-winforms&In-Reply-To=%3C1344303120.78305.YahooMailNeo%40web164601.mail.gq1.yahoo.com%3E"
       TITLE="[Mono-dev] Patches for mono-winforms">ulatekh at yahoo.com
       </A><BR>
    <I>Tue Aug  7 01:32:00 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="039471.html">[Mono-dev] Patches for mono-winforms
</A></li>
        <LI>Next message: <A HREF="039482.html">[Mono-dev] Patches for mono-winforms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39481">[ date ]</a>
              <a href="thread.html#39481">[ thread ]</a>
              <a href="subject.html#39481">[ subject ]</a>
              <a href="author.html#39481">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://github.com/mono/mono/commit/ecef298bcaf571a3d50e022318b20117f9d0388c">https://github.com/mono/mono/commit/ecef298bcaf571a3d50e022318b20117f9d0388c</A> introduced another bug that I found today. &#160;Enclosed is the fix.


DataGridViewTextBoxCell was creating a single (as in static) instance of&#160;DataGridViewTextBoxEditingControl to do all editing. &#160;This fails if one edits two text-box cells, because ending the first edit calls Dispose() on the static instance, and the second attempt to edit throws an ObjectDisposedException.

The solution is to use the control created by DataGridView, instead of maintaining a single static control.

Incidentally, this also fixes a bug that I hadn't yet taken the time to track down. &#160;<A HREF="http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.editingcontrolshowing.aspx&#160;mentions">http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.editingcontrolshowing.aspx&#160;mentions</A> that DataGridView&#160;reuses the editing control whenever the cell type does not change between edits, and so any event-handlers placed on the control during the EditingControlShowing event should be removed. &#160;For this to work, control reuse could not be across multiple instances of DataGridView -- the event-handlers put onto editing-controls by other DataGridView instances would be unknowable. &#160;The previous static-instance code had this flaw; I noticed that event-handlers seemed to accumulate on text-box editing controls across data-grid-views when using Mono, even though I was following the recommended procedure, and that it wasn't happening under .NET and MS Windows. &#160;But no one would have noticed this
 until&#160;<A HREF="https://github.com/mono/mono/commit/f9bea537f1ac41753f2204b8528a6292bb547111">https://github.com/mono/mono/commit/f9bea537f1ac41753f2204b8528a6292bb547111</A> (about 2 months ago), when the EditingControlShowing event was posted for the first time. :-)

Steven Boswell
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120806/0625bc6d/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120806/0625bc6d/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mwf-20-DataGridViewTextBoxCell-InitializeEditingControl.patch
Type: application/octet-stream
Size: 1403 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120806/0625bc6d/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120806/0625bc6d/attachment.obj</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039471.html">[Mono-dev] Patches for mono-winforms
</A></li>
	<LI>Next message: <A HREF="039482.html">[Mono-dev] Patches for mono-winforms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39481">[ date ]</a>
              <a href="thread.html#39481">[ thread ]</a>
              <a href="subject.html#39481">[ subject ]</a>
              <a href="author.html#39481">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
