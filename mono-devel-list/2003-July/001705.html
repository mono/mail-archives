<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Questions on DllImport failures
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Questions%20on%20DllImport%20failures&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001701.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Questions on DllImport failures</H1>
    <B>Bernie Solomon</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Questions%20on%20DllImport%20failures&In-Reply-To="
       TITLE="[Mono-devel-list] Questions on DllImport failures">bernard at ugsolutions.com
       </A><BR>
    <I>Thu Jul 31 18:58:58 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001701.html">[Mono-devel-list] nothing really patch
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1705">[ date ]</a>
              <a href="thread.html#1705">[ thread ]</a>
              <a href="subject.html#1705">[ subject ]</a>
              <a href="author.html#1705">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have been looking at trying to get failed DllImports to raise the correct
exceptions (System.DllNotFoundException &amp;
System.EntryPointNotFoundException) and have a couple of questions.

1) The obvious thing to do is just call mono_raise_exception with an
appropriate exception in mono_lookup_pinvoke_call. But that routine is in
loader.c which is in libmetadata which doesn't have access to the runtime
routines for creating and raising exceptions. In my tests I have moved the
routine to marshal.c (because that is where one caller is). Is this
reasonable? Also is raising the exception directly here reasonable - it is
the best place in order to get substitutions in the message. I did move the
mono_lookup_pinvoke_call in marshal.c to avoid a leak in case of the
exception being thrown.

2) What is the proper way to create the exception from C with a message with
subtitutions in it so it is localizable properly yet preserving the precise
methods in classes like DllNotFoundException which match Microsoft's - or
can a new constructor be added which can pass in the file name or entry
point so the formatting is done in C#? Or should it invoke a C# mono
specific helper to construct the exception doing the formatting in C#? I
note that FileNotFoundException builds the message in its Message get method
but that is not translateable the way it is done. These sort of messages are
much more useful with info about what was not found so I'd like to get this
info in if at all possible.

Thanks for any pointers on these.

Bernie Solomon


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001701.html">[Mono-devel-list] nothing really patch
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1705">[ date ]</a>
              <a href="thread.html#1705">[ thread ]</a>
              <a href="subject.html#1705">[ subject ]</a>
              <a href="author.html#1705">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
