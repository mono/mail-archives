<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] overriding return type
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20overriding%20return%20type&In-Reply-To=200307261506.47329.Alan.Jenkins%40phonecoop.coop">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001659.html">
   <LINK REL="Next"  HREF="001664.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] overriding return type</H1>
    <B>Thong (Tum) Nguyen</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20overriding%20return%20type&In-Reply-To=200307261506.47329.Alan.Jenkins%40phonecoop.coop"
       TITLE="[Mono-devel-list] overriding return type">tum at veridicus.com
       </A><BR>
    <I>Sat Jul 26 19:25:55 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001659.html">[Mono-devel-list] overriding return type
</A></li>
        <LI>Next message: <A HREF="001664.html">[Mono-devel-list] overriding return type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1662">[ date ]</a>
              <a href="thread.html#1662">[ thread ]</a>
              <a href="subject.html#1662">[ subject ]</a>
              <a href="author.html#1662">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The feature you're talking about is called covariant return types and it
is a great OO feature that has been left out of both Java and C#.  It
has been a java RFE for yonks.

<A HREF="http://developer.java.sun.com/developer/bugParade/bugs/4144488.html">http://developer.java.sun.com/developer/bugParade/bugs/4144488.html</A>


^Tum


&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-admin at lists.ximian.com</A> [mailto:mono-devel-list-
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">admin at lists.ximian.com</A>] On Behalf Of Alan Jenkins
</I>&gt;<i> Sent: Sunday, 27 July 2003 3:07 a.m.
</I>&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> Subject: [Mono-devel-list] overriding return type
</I>&gt;<i> 
</I>&gt;<i> I totally agree that neither of us are OO experts, and I'd like to add
</I>that
&gt;<i> I've not exactly been an expert communicator either.  Thanks for
</I>taking the
&gt;<i> time to disagree with me, especially as you've done all the code in
</I>your
&gt;<i> head.
</I>&gt;<i> 
</I>&gt;<i> 5,000 .cs files, you say! Thats a lot of code.  I didn't mean to imply
</I>that
&gt;<i> the class library would be written or compiled using this feature -
</I>&gt;<i> implementing a compatable clone of a class library must be hard enough
</I>&gt;<i> without having to use a slightly different language to the original.
</I>Mono
&gt;<i> might strike off in its own direction at some point, but diverging
</I>from MS
&gt;<i> .NET is not a good idea at the moment.  Leave that for later, when
</I>Mono has
&gt;<i> become the standard implementation of .NET (smile, but don't laugh -
</I>look at
&gt;<i> GNU/Linux and Unix).  Thats why I didn't say &quot;please consider adding
</I>this
&gt;<i> feature in the next version&quot; - I am interested in it mainly for
</I>selfish
&gt;<i> reasons, and it could well break the ECMA standard.
</I>&gt;<i> 
</I>&gt;<i> I accept that any idea like this is potentially dangerous, and must be
</I>&gt;<i> examined carefully - but thats one of the reasons why it would be an
</I>&gt;<i> extremely good idea to make it an optional feature.  I don't think
</I>there are
&gt;<i> (bad) implications which would only become obvious with multiple
</I>derivatives,
&gt;<i> and the additional complexity caused by extra derivative classes would
</I>not
&gt;<i> become execessive.
</I>&gt;<i> 
</I>&gt;<i> I agree that there must be a reason why this feature is not present in
</I>the C#
&gt;<i> (and Java) compiler, even though CIL does support it.  I've done some
</I>&gt;<i> serching on the web, and I think C++ will let you do this, but thats
</I>not
&gt;<i> saying much (what doesn't C++ let you do?):
</I>&gt;<i> 
</I>&gt;<i> //test.cpp - compiles sucessfully on my computer.
</I>&gt;<i> int main() {	}
</I>&gt;<i> 
</I>&gt;<i> class Example1 {
</I>&gt;<i> 	virtual Example1 *Method() {
</I>&gt;<i> 		return new Example1();
</I>&gt;<i> 	}
</I>&gt;<i> };
</I>&gt;<i> 
</I>&gt;<i> class B : public A {
</I>&gt;<i> 	virtual Example2 *Method() {
</I>&gt;<i> 		return new Example2();
</I>&gt;<i> 	}
</I>&gt;<i> };
</I>&gt;<i> //test.cpp ends
</I>&gt;<i> 
</I>&gt;<i> ---
</I>&gt;<i> 
</I>&gt;<i> Could you please clarify some of your comments?
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt; // This works because IList2 implements IList
</I>&gt;<i> &gt;&gt; IList list = GetList.NewList();
</I>&gt;<i> 
</I>&gt;<i> don't you mean &quot;because IList3 implements IList&quot;?
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt; // This causes a casting error because our list is an IList3
</I>&gt;<i> &gt;&gt; // and its Iterator() method returns an IIterator3 object. The
</I>&gt;<i> &gt;&gt; // correct thing is for Iterator to return an IIterator object, and
</I>&gt;<i> &gt;&gt; // check to see if it can be upcast to IIterator2
</I>&gt;<i> &gt;&gt; IIterator2 iterator2 = list.Iterator();
</I>&gt;<i> 
</I>&gt;<i> Did you mean a runtime or a compile time error?  I assume you mean a
</I>runtime
&gt;<i> error, from the way you put it, and from your other comments.
</I>&gt;<i> I would have thought you would get a compile time error, because what
</I>you are
&gt;<i> doing is implicitly upcasting IIterator to IIterator2.
</I>&gt;<i> 
</I>&gt;<i> I think I understand the detail of your example, but not the reason
</I>for coding
&gt;<i> it this way.
</I>&gt;<i> 
</I>&gt;<i> Your last line implicitly assumes that the return value of
</I>GetList.New() is an
&gt;<i> IList2 - thats why it fails.  Surely its better to express this
</I>assumption
&gt;<i> explicitly:
</I>&gt;<i> 
</I>&gt;<i> //results in compile time cast error: implicit upcast
</I>&gt;<i> IList2 list = GetList.NewList();
</I>&gt;<i> 
</I>&gt;<i> //results in runtime error: explicit upcast failure
</I>&gt;<i> IList2 list = (IList2) GetList.NewList();
</I>&gt;<i> 
</I>&gt;<i> Neither do I understand why GetList.NewList() has a return type of
</I>IList, when
&gt;<i> it always returns an object of type IList3.  I would have thought that
</I>it
&gt;<i> would have made more sense to give it a return type of IList3, so that
</I>it was
&gt;<i> both obvious and certain that it would return an IList3 object.
</I>&gt;<i> 
</I>&gt;<i> GetList.NewList() doesn't return a suitable list for the operations
</I>performed
&gt;<i> on it - NewList(), and/or the code using it is flawed.  You assert
</I>that the
&gt;<i> correct fix is to change the return type of IList2.Iterator() and
</I>&gt;<i> IList3.Iterator() to IIterator, and for calling code to upcast the
</I>result.
&gt;<i> Essentially, you remove the strict obligation on implementors of
</I>&gt;<i> IList2.Iterator() and IList3.Iterator() to return an appropriate
</I>iterator,
&gt;<i> and presumably make the obligation known through comments or
</I>attributes.
&gt;<i> Surely this is more error prone, not less, just as the requirement in
</I>Java to
&gt;<i> explicity define the exceptions thrown by specific methods eases
</I>development
&gt;<i> (esp. debugging).
</I>&gt;<i> 
</I>&gt;<i> The assumptions made by the calling code are expressed (as far as I
</I>can see)
&gt;<i> in such a way as to cause a compile time error.  I understand that if
</I>similar
&gt;<i> assumptions caused runtime errors they could be difficult to fix, but
</I>I think
&gt;<i> it would be fairly easy to avoid them altogether.  I would have
</I>thought that
&gt;<i> your solution is more likely to result in runtime errors (when
</I>explicitly
&gt;<i> upcasting the return value of a method), whereas if you can override
</I>return
&gt;<i> types, you are more likely to catch the errors at compile time
</I>(implicit
&gt;<i> upcasts).
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001659.html">[Mono-devel-list] overriding return type
</A></li>
	<LI>Next message: <A HREF="001664.html">[Mono-devel-list] overriding return type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1662">[ date ]</a>
              <a href="thread.html#1662">[ thread ]</a>
              <a href="subject.html#1662">[ subject ]</a>
              <a href="author.html#1662">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
