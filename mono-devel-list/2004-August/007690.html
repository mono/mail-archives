<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] daily(?) /doc patches
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20daily%28%3F%29%20/doc%20patches&In-Reply-To=412E274D.2050507%40seznam.cz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007701.html">
   <LINK REL="Next"  HREF="007693.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] daily(?) /doc patches</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20daily%28%3F%29%20/doc%20patches&In-Reply-To=412E274D.2050507%40seznam.cz"
       TITLE="[Mono-devel-list] daily(?) /doc patches">atsushi at ximian.com
       </A><BR>
    <I>Thu Aug 26 20:32:15 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007701.html">[Mono-devel-list] Mono runtime for C compilation problem
</A></li>
        <LI>Next message: <A HREF="007693.html">[Mono-devel-list] some strangeness with  CustomAttributes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7690">[ date ]</a>
              <a href="thread.html#7690">[ thread ]</a>
              <a href="subject.html#7690">[ subject ]</a>
              <a href="author.html#7690">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Marek Safar wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> It looks that nothing from my previous recommendations has been accepted.
</I>&gt;<i> In this stage is the patch too &quot;buggy&quot;.
</I>
Mmm, sorry but it seems like I haven't received your mail. I haven't
seen the message.

Please post to the list as well.

I once wrote to you why I keep the patch as is, after receiving your
list of warnings numbers:

 &gt; Well, as for existing patch, Miguel has already reviewed and approved
 &gt; with some comments, immediate before I met breakage. So I'll first
 &gt; commit (if it is said OK) existing stuff without improving those
 &gt; errors. They will be improved on the second stage.

It is OK for me but not sure if I had better modify the patch heavily.
The last one seems not trivial though.

Atsushi Eno

&gt;&gt;<i>Since we have missed almost all the chances to commit /doc patches
</I>&gt;&gt;<i>because it had been soon obsolete against the latest CVS HEAD, I
</I>&gt;&gt;<i>decided to put the patches here. If the patch is not applicable for
</I>&gt;&gt;<i>the latest HEAD, tell me and I'll make diff and upload it onto this
</I>&gt;&gt;<i>directory:
</I>&gt;&gt;<i><A HREF="http://primates.ximian.com/~atsushi/mcs-doc-patches/">http://primates.ximian.com/~atsushi/mcs-doc-patches/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I won't modify (and hadn't made) the change content of the patches.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Atsushi Eno
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Mono-devel-list mailing list
</I>&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> Subject:
</I>&gt;<i> Re: [Mono-devel-list] the latest /doc patch
</I>&gt;<i> From:
</I>&gt;<i> Marek Safar &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">marek.safar at seznam.cz</A>&gt;
</I>&gt;<i> Date:
</I>&gt;<i> Tue, 10 Aug 2004 17:35:59 +0100
</I>&gt;<i> To:
</I>&gt;<i> Atsushi Eno &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushi at ximian.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> To:
</I>&gt;<i> Atsushi Eno &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushi at ximian.com</A>&gt;
</I>&gt;<i> CC:
</I>&gt;<i> Martin Baulig &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">martin at ximian.com</A>&gt;, Miguel de Icaza &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">miguel at ximian.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hello Eno,
</I>&gt;<i> 
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Since mcs got more stable than last week, I made the latest patch
</I>&gt;&gt;<i> for /doc support. I modified a bit (as Miguel asked me for the
</I>&gt;&gt;<i> previous patch; added some commends, removed --options) but basic
</I>&gt;&gt;<i> part of patch is unchanged.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have had no problem  for a month or so since the last trouble
</I>&gt;&gt;<i> that prevented me from commiting the last ready-to-go patch.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I also added some tests wrt doc comments. It however just tests
</I>&gt;&gt;<i> if it does not break compilation (i.e. not checking result docs).
</I>&gt;&gt;<i>  
</I>&gt;&gt;<i>
</I>&gt;<i> What is missing on the tests are test
</I>&gt;<i> My suggestion is to create for every xml-???.cs also
</I>&gt;<i> xml-???.xml.expected and add to every Main method test whether generated
</I>&gt;<i> xml is same as expected.
</I>&gt;<i> To be sure that this patch is still working with same results.
</I>&gt;<i> 
</I>&gt;<i> Tip: Use &quot;// Compiler options: &quot; syntax for /doc compiler option
</I>&gt;<i> 
</I>&gt;&gt;<i> I've received a list of to-be-supported warning messages from
</I>&gt;&gt;<i> Marek (thanks to him) and those works will be done later.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  
</I>&gt;&gt;<i>
</I>&gt;<i> 1,
</I>&gt;<i> 
</I>&gt;<i> Error message for 2006 should be better explanatory e.g.  &quot;Command-line
</I>&gt;<i> syntax error:  Missing ':&lt;text&gt;' for '/doc' switch&quot;
</I>&gt;<i> 
</I>&gt;<i> 2,
</I>&gt;<i> 
</I>&gt;<i> You cannot write simple Report.Warning. You always have to test
</I>&gt;<i> WarningLevel for your Warning. Use IF or Warning method with Message
</I>&gt;<i> parameter.
</I>&gt;<i> 
</I>&gt;<i> To Miguel: It is that I was talking about !
</I>&gt;<i> 
</I>&gt;<i> +    } catch (XmlException ex) {
</I>&gt;<i> +        Report.Warning (1570, Lexer.Location, &quot;XML comment is not
</I>&gt;<i> well-formed: &quot; + ex.Message);
</I>&gt;<i> +        XmlComment com = doc.CreateComment (&quot;FIXME: Invalid
</I>&gt;<i> documentation markup was found for member &quot; + fullyQualifiedName);
</I>&gt;<i> +        doc.DocumentElement.LastChild.AppendChild (com);
</I>&gt;<i> +    }
</I>&gt;<i> 
</I>&gt;<i> +void WarnIncorrectXmlComment (string token_type)
</I>&gt;<i> +{
</I>&gt;<i> +    Report.Warning (1587, Lexer.Location, &quot;XML comment is not
</I>&gt;<i> acceptable on  &quot; + token_type);
</I>&gt;<i> +    Lexer.ConsumeXmlComment ();
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> 3,
</I>&gt;<i> 
</I>&gt;<i> For this cases can be better use StringBuilder or String.Format. It is
</I>&gt;<i> extremely memory consuming especially on windows.
</I>&gt;<i> 
</I>&gt;<i> +    Documentation.SetAttribute (&quot;name&quot;, &quot;M:&quot; + container.Name + &quot;.&quot; + 
</I>&gt;<i> Name + &quot;(&quot; + para1 + (para2 != null ? &quot;,&quot; + para2 : null) +
</I>&gt;<i> 
</I>&gt;<i> or this
</I>&gt;<i> 
</I>&gt;<i> +                string paramSpec = null;
</I>&gt;<i> +                Parameter [] plist = Parameters.FixedParameters;
</I>&gt;<i> +                if (plist != null) {
</I>&gt;<i> +                    foreach (Parameter p in plist)
</I>&gt;<i> +                        paramSpec += (paramSpec != null ? &quot;,&quot; : &quot;(&quot;) +
</I>&gt;<i> container.ResolveType (p.TypeName, false, Location).FullName;
</I>&gt;<i> +                }
</I>&gt;<i> 
</I>&gt;<i> BTW: This code is really buggy. See point 6 for further hints and please
</I>&gt;<i> be aware of FullName usage because it uses &quot;+&quot; instead of &quot;.&quot; separator.
</I>&gt;<i> You can use methods GetSignatureForError either we will have same
</I>&gt;<i> troubles (like special handling for operators, indexers, ref &amp; out
</I>&gt;<i> params, __arglist params, etc...) twice because your code seems to do
</I>&gt;<i> exactly same.
</I>&gt;<i> 
</I>&gt;<i> Try this code
</I>&gt;<i> 
</I>&gt;<i>    public class Test
</I>&gt;<i>    {
</I>&gt;<i>         public class A {}
</I>&gt;<i> 
</I>&gt;<i>        public static void Main ()
</I>&gt;<i>        {
</I>&gt;<i>        }
</I>&gt;<i> 
</I>&gt;<i>        /// here is a documentation
</I>&gt;<i>        public static void Foo (A a)
</I>&gt;<i>        {
</I>&gt;<i>        }
</I>&gt;<i>    }
</I>&gt;<i> 
</I>&gt;<i> 4,
</I>&gt;<i> Why don't create for &quot;M:&quot;, &quot;F:&quot; etc, some nice constants ?
</I>&gt;<i> 
</I>&gt;<i> 5,
</I>&gt;<i> This code generate buggy xml.
</I>&gt;<i> BTW: your xml-017.cs test
</I>&gt;<i> 
</I>&gt;<i>    public class Test
</I>&gt;<i>    {
</I>&gt;<i>        public static void Main ()
</I>&gt;<i>        {
</I>&gt;<i>        }
</I>&gt;<i> 
</I>&gt;<i>        /// here is a documentation with parameters (and has same name)
</I>&gt;<i>        public static void Foo (params string [] param)
</I>&gt;<i>        {
</I>&gt;<i>        }
</I>&gt;<i>    }
</I>&gt;<i> 
</I>&gt;<i> 6,
</I>&gt;<i> The most important problem. Why do you call RootContext.FixupDocument ()
</I>&gt;<i> before types are Defined. This is very dangerous and you will have to
</I>&gt;<i> duplicate code what is in Define methods.
</I>&gt;<i> And this simple code now crash compiler.
</I>&gt;<i> 
</I>&gt;<i>    public class Test
</I>&gt;<i>    {
</I>&gt;<i>        /// here is a documentation with parameters (and has same name)
</I>&gt;<i>        public static void Foo (BadType t)
</I>&gt;<i>        {
</I>&gt;<i>        }
</I>&gt;<i>    }
</I>&gt;<i> 
</I>&gt;<i> Why do not reuse bool Define () methods or DefineContainerMembers method
</I>&gt;<i> where you can simply share a lot of code and don't traverse thought
</I>&gt;<i> whole code tree.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I hope, I didn't flood you ;-)
</I>&gt;<i> 
</I>&gt;<i> Marek
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007701.html">[Mono-devel-list] Mono runtime for C compilation problem
</A></li>
	<LI>Next message: <A HREF="007693.html">[Mono-devel-list] some strangeness with  CustomAttributes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7690">[ date ]</a>
              <a href="thread.html#7690">[ thread ]</a>
              <a href="subject.html#7690">[ subject ]</a>
              <a href="author.html#7690">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
