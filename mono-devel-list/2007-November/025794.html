<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Remoting Server Events problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Remoting%20Server%20Events%20problem&In-Reply-To=4749CB0B.7010205%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025793.html">
   <LINK REL="Next"  HREF="025801.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Remoting Server Events problem</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Remoting%20Server%20Events%20problem&In-Reply-To=4749CB0B.7010205%40gmail.com"
       TITLE="[Mono-dev] Remoting Server Events problem">robertj at gmx.net
       </A><BR>
    <I>Sun Nov 25 18:14:02 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="025793.html">[Mono-dev] Remoting Server Events problem
</A></li>
        <LI>Next message: <A HREF="025801.html">[Mono-dev] Remoting Server Events problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25794">[ date ]</a>
              <a href="thread.html#25794">[ thread ]</a>
              <a href="subject.html#25794">[ subject ]</a>
              <a href="author.html#25794">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">buhochileno at gmail.com</A> wrote:
&gt;<i> Thanks Robert, I very confuse with this, becouse I read a lote of 
</I>&gt;<i> diferent approach (event broadcast engines, shared objects, etc) to do 
</I>&gt;<i> this, but most of them don't work :-S ,  I wondore if you have a simple 
</I>&gt;<i> working example of the correct way to do this?
</I>

Events only make sense in local cross appdomain contexts.
Anything else is a world of pain. See
<A HREF="http://www.thinktecture.com/resourcearchive/net-remoting-faq/remotingusecases">http://www.thinktecture.com/resourcearchive/net-remoting-faq/remotingusecases</A>

The attached sample is still using events on the server side but
it requires that clients implement a certain interface that
was declared in the shared assembly.

The server is using a special &quot;AsyncEvent&quot; that doesn't have the
drawbacks of a simple CLI event:

- the clients are notified sequentially. This doesn't scale

- if a client doesn't respond, the next clients won't be called
   back anymore. This is far from being reliable.

AsyncEvent is calling the clients in parallel and it also disconnects
failing clients. This is still not optimal because it doesn't scale
at large: Imagine you have 1000 connected clients ...

Robert

&gt;<i> 
</I>&gt;<i> in advance, thank you very much.
</I>&gt;<i> 
</I>&gt;<i> Mauricio
</I>&gt;<i> 
</I>&gt;<i> Robert Jordan wrote:
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">buhochileno at gmail.com</A> wrote:
</I>&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i> Hi:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I know that is very possible that this is a basic remoting question, but 
</I>&gt;&gt;&gt;<i> I read some info about the native .NET approach used with remoting and I 
</I>&gt;&gt;&gt;<i> think that my code is supose it to work:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I write a class with a method to trigger some event (this is the object 
</I>&gt;&gt;&gt;<i> resgitered by the remoting server):
</I>&gt;&gt;&gt;<i> [Serializable]
</I>&gt;&gt;&gt;<i> public class Camera: MarshalByRefObject
</I>&gt;&gt;&gt;<i> ...
</I>&gt;&gt;&gt;<i>    public void SetZoom(int amount)
</I>&gt;&gt;&gt;<i>    {...//zoom code
</I>&gt;&gt;&gt;<i>        SomeDelegate h = this.SomeEvent; //some test event triger, the 
</I>&gt;&gt;&gt;<i> SomeDelegate is public...
</I>&gt;&gt;&gt;<i>        if ((h != null) &amp;&amp; (SomeEvent != null))
</I>&gt;&gt;&gt;<i>                h (this, new EventArgs());
</I>&gt;&gt;&gt;<i>        else
</I>&gt;&gt;&gt;<i>                Console.WriteLine(&quot;null then?&quot;); //allways is null
</I>&gt;&gt;&gt;<i>       }
</I>&gt;&gt;&gt;<i> ...On the client side I use a special &quot;RemoteCamera&quot;, this class deal 
</I>&gt;&gt;&gt;<i> with all the remoting stuff related to get the object from the 
</I>&gt;&gt;&gt;<i> server...something like:
</I>&gt;&gt;&gt;<i> [Serializable]
</I>&gt;&gt;&gt;<i> public class RemoteCamera: MarshalByRefObject
</I>&gt;&gt;&gt;<i>        public RemoteOrbitKit()
</I>&gt;&gt;&gt;<i>        { .../channel registration, etc...
</I>&gt;&gt;&gt;<i>             
</I>&gt;&gt;&gt;<i> camera(ICamerat)Activator.GetObject(typeof(ICamera),_fullObjectURLPath); 
</I>&gt;&gt;&gt;<i> //....
</I>&gt;&gt;&gt;<i>            camera.SomeEvent += new SomeDelegate(SomeMethod);
</I>&gt;&gt;&gt;<i>             ...
</I>&gt;&gt;&gt;<i>             camera.SetZoom(50); //this work, but the event is not 
</I>&gt;&gt;&gt;<i> triggered...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>        }
</I>&gt;&gt;&gt;<i>        public SomeMethod(object sender, EventArgs e)
</I>&gt;&gt;&gt;<i>        {
</I>&gt;&gt;&gt;<i>             Console.WriteLine(&quot;method called&quot;); //This methis is never 
</I>&gt;&gt;&gt;<i> called becouse the Event/method asociation allways is null
</I>&gt;&gt;&gt;<i>        }
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Do you see what is my mistake?
</I>&gt;&gt;&gt;<i> sugestions?, ideas?
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. The server must know the type &quot;RemoteCamera&quot;, because the delegate
</I>&gt;&gt;<i>     is containing a reference to an instance of this class.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     You can circumvent this by using a public static method as
</I>&gt;&gt;<i>     an event handler.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2. The client must start a listener as well. This is done with
</I>&gt;&gt;<i>     &quot;new TcpChannel (0)&quot; or &quot;new HttpChannel (0)&quot; or with a
</I>&gt;&gt;<i>     corresponding remoting configuration setting.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 3. The client must not be firewalled because it is
</I>&gt;&gt;<i>     called back by the server.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Robert
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: remoting-events.tar.gz
Type: application/x-gzip
Size: 1856 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20071126/f21e2fa8/attachment.gz">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20071126/f21e2fa8/attachment.gz</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025793.html">[Mono-dev] Remoting Server Events problem
</A></li>
	<LI>Next message: <A HREF="025801.html">[Mono-dev] Remoting Server Events problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25794">[ date ]</a>
              <a href="thread.html#25794">[ thread ]</a>
              <a href="subject.html#25794">[ subject ]</a>
              <a href="author.html#25794">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
