<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Win32 Shell Icons in MWF with high level	systemicon abstraction layer in XplatUI
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Win32%20Shell%20Icons%20in%20MWF%20with%20high%20level%0A%09systemicon%20abstraction%20layer%20in%20XplatUI&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014905.html">
   <LINK REL="Next"  HREF="014889.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Win32 Shell Icons in MWF with high level	systemicon abstraction layer in XplatUI</H1>
    <B>Peter Dennis Bartok</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Win32%20Shell%20Icons%20in%20MWF%20with%20high%20level%0A%09systemicon%20abstraction%20layer%20in%20XplatUI&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] Win32 Shell Icons in MWF with high level	systemicon abstraction layer in XplatUI">peter at novonyx.com
       </A><BR>
    <I>Thu Sep 22 11:29:48 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014905.html">[Mono-dev] Implicit Polymorphy Question
</A></li>
        <LI>Next message: <A HREF="014889.html">[Mono-dev] [PATCH] Win32 Shell Icons in MWF with high	levelsystemicon abstraction layer in XplatUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14884">[ date ]</a>
              <a href="thread.html#14884">[ thread ]</a>
              <a href="subject.html#14884">[ subject ]</a>
              <a href="author.html#14884">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Kornel,

Thanks for all the work you put into the patch. I did a quick review, I will 
need more time before approving it. One thing that already know needs to be 
different is where the special icons are pulled from. We need to allow 
themes to provide the special icons to be used, so the file dialog will need 
to call into the theme to get them. The theme then has the choice of pulling 
it from the driver or from somewhere else. But, we possibly might go one 
step further and move the complete composition of the file dialog into the 
theme, which could allow a theme using the native openfile dialog (assuming 
the theme finds a way to have a match in features)

Also, I think the methods for the icons in the driver are not 
straightforward enough. I want something along the lines of &quot;Image 
GetIcon(string path)&quot; or maybe &quot;Image GetIcon(string path, bool 
wantLargeIcon)&quot;. The rest should be hidden underneath. There's no reason to 
pass in a bool whether or not the path is a directory, the code returning 
the icon can check that itself. Returning an index instead of the actual 
image just makes it more complicated to use above.

More later when I had some time to review.

Cheers,
  Peter


-----Original Message-----
From: &quot;Korn&#233;l P&#225;l&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at hotmail.com</A>&gt;
To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Date: 22 September, 2005 05:54
Subject: [Mono-dev] [PATCH] Win32 Shell Icons in MWF with high level 
systemicon abstraction layer in XplatUI


&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>Originally I only wanted to create a shell icon handler for Windows but it
</I>&gt;<i>figured out that the current abstraction of icon handling is not abstract
</I>&gt;<i>enough. So I created a new abstraction in XplatUI that is based on file 
</I>&gt;<i>name
</I>&gt;<i>rather than on MIME type. And I added special icon handling that can 
</I>&gt;<i>provide
</I>&gt;<i>system specific icons for OpenFileDialog for example.
</I>&gt;<i>
</I>&gt;<i>Please review the patch and please approve it.
</I>&gt;<i>
</I>&gt;<i>Note that special icons should either mapped to KDE and GNOME icons or
</I>&gt;<i>resources from Default handler should be used in MimeIconEngine. I didn't
</I>&gt;<i>implement this. Unless it will be implemented unknown/unknown icon will be
</I>&gt;<i>used for undefined special icons. Optionally and open folter icon could be
</I>&gt;<i>implemented in MimeIconEngine as well by using directory/open for example.
</I>&gt;<i>
</I>&gt;<i>This is the expected behaviour of ImageList and is required by the other
</I>&gt;<i>patch:
</I>&gt;<i>
</I>&gt;<i>ImageList.cs: Modified to copy Images when adding or getting them.
</I>&gt;<i>
</I>&gt;<i>ChangeLog:
</I>&gt;<i>
</I>&gt;<i>System.Windows.Forms.dll.sources: Added SizedIcons.cs and
</I>&gt;<i>Win32ShellIcons.cs.
</I>&gt;<i>
</I>&gt;<i>XplatUIStructs.cs: Added SpecialIcons enumeration.
</I>&gt;<i>
</I>&gt;<i>XplatUIDriver.cs: Added LargeIcons, SmallIcons, GetIconIndex and
</I>&gt;<i>GetSpecialIconIndex for system icon handling. Default implementation uses
</I>&gt;<i>MimeIconEngine.
</I>&gt;<i>
</I>&gt;<i>XplatUI.cs: Added LargeIcons, SmallIcons, GetIconIndex and
</I>&gt;<i>GetSpecialIconIndex.
</I>&gt;<i>
</I>&gt;<i>Win32ShellIcons.cs: New shell icon handler for Windows. Supports 32-bit
</I>&gt;<i>icons with alpha channel and caches system image list icons in managed
</I>&gt;<i>ImageLists to provide compatibility with ListView.
</I>&gt;<i>
</I>&gt;<i>XplatUIWin32.cs: Implemented LargeIcons, SmallIcons, GetIconIndex and
</I>&gt;<i>GetSpecialIconIndex using Win32ShellIcons.
</I>&gt;<i>
</I>&gt;<i>SizedIcons.cs: New icon handler that wraps XplatUI icon handler and 
</I>&gt;<i>provides
</I>&gt;<i>ImageLists with constant size.
</I>&gt;<i>
</I>&gt;<i>FileDialog.cs: Modified to use XplatUI and SizedIcons instead of
</I>&gt;<i>MimeIconEngine and GetResource.
</I>&gt;<i>
</I>&gt;<i>MimeIcon.cs: Removed GetIconForMimeTypeAndSize as it is superseded by
</I>&gt;<i>SizedIcons. Removed code that prevented MIME types returned other than
</I>&gt;<i>inode/directory and unknown/unknown when using PlatformDefaultHandler. 
</I>&gt;<i>Added
</I>&gt;<i>special icons to PlatformDefaultHandler.
</I>&gt;<i>
</I>&gt;<i>Mime.cs: Removed code that assumed it is used on Windows.
</I>&gt;<i>
</I>&gt;<i>Korn&#233;l
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014905.html">[Mono-dev] Implicit Polymorphy Question
</A></li>
	<LI>Next message: <A HREF="014889.html">[Mono-dev] [PATCH] Win32 Shell Icons in MWF with high	levelsystemicon abstraction layer in XplatUI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14884">[ date ]</a>
              <a href="thread.html#14884">[ thread ]</a>
              <a href="subject.html#14884">[ subject ]</a>
              <a href="author.html#14884">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
