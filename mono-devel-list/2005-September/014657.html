<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] CAS changes for System.Drawing.dll
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20CAS%20changes%20for%20System.Drawing.dll&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014656.html">
   <LINK REL="Next"  HREF="014807.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] CAS changes for System.Drawing.dll</H1>
    <B>Sebastien Pouliot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20CAS%20changes%20for%20System.Drawing.dll&In-Reply-To="
       TITLE="[Mono-dev] [PATCH] CAS changes for System.Drawing.dll">sebastien at ximian.com
       </A><BR>
    <I>Fri Sep  9 10:39:10 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014656.html">[Mono-dev] Right MCS in Path, Configure Gets Wrong MCS
</A></li>
        <LI>Next message: <A HREF="014807.html">[Mono-dev] [PATCH] CAS changes for System.Drawing.dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14657">[ date ]</a>
              <a href="thread.html#14657">[ thread ]</a>
              <a href="subject.html#14657">[ subject ]</a>
              <a href="author.html#14657">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Oops, attachments were bigger than I expected (and refused by the list).
-------- Forwarded Message --------
From: Sebastien Pouliot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sebastien.pouliot at gmail.com</A>&gt;
Reply-To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sebastien.pouliot at gmail.com</A>
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: [PATCH] CAS changes for System.Drawing.dll
Date: Fri, 9 Sep 2005 10:25:50 -0400

Hello,

System.Drawing provides a (mostly) &quot;safe&quot; API, which means that you can
call it's methods without having the UnmanagedCode permission (even if
most of it's code is unmanaged). Currently this isn't the case on Mono,
i.e. if you activate the security manager (mono --security) then you
would need UnmanagedCode permission to run any code using
System.Drawing.

The first patch is on the class library.
a. It add the required security attributes to the classes (mostly some
LinkDemands for &quot;unsafe&quot; calls);
b. It add the [SuppressUnmanagedCodeSecurity] attribute to all p/invoke
calls so that UnmanagedCode isn't required to use System.Drawing.

The second patch is for the unit tests.
a. It denies UnmanagedCode permission before running the existing tests
- which works on MS implementation and also works on Mono with the
previous patch applied.
b. It add new tests for class/methods protected with LinkDemands (which
requires reflection to test properly).

Both patches shouldn't change the current behaviour when the security
manager isn't active (default).

-- 
Sebastien Pouliot
email: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">sebastien at ximian.com</A>
blog: <A HREF="http://pages.infinit.net/ctech/">http://pages.infinit.net/ctech/</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sd.20050909.tar.gz
Type: application/x-compressed-tar
Size: 7127 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050909/17549c82/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050909/17549c82/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014656.html">[Mono-dev] Right MCS in Path, Configure Gets Wrong MCS
</A></li>
	<LI>Next message: <A HREF="014807.html">[Mono-dev] [PATCH] CAS changes for System.Drawing.dll
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14657">[ date ]</a>
              <a href="thread.html#14657">[ thread ]</a>
              <a href="subject.html#14657">[ subject ]</a>
              <a href="author.html#14657">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
