<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] System.Data.DataSet ReadXml question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20System.Data.DataSet%20ReadXml%20question&In-Reply-To=43211AFF.7010300%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014649.html">
   <LINK REL="Next"  HREF="014662.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] System.Data.DataSet ReadXml question</H1>
    <B>Atsushi Eno</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20System.Data.DataSet%20ReadXml%20question&In-Reply-To=43211AFF.7010300%40ximian.com"
       TITLE="[Mono-dev] System.Data.DataSet ReadXml question">atsushi at ximian.com
       </A><BR>
    <I>Fri Sep  9 03:00:20 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014649.html">[Mono-dev] System.Data.DataSet ReadXml question
</A></li>
        <LI>Next message: <A HREF="014662.html">[Mono-dev] System.Data.DataSet ReadXml question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14650">[ date ]</a>
              <a href="thread.html#14650">[ thread ]</a>
              <a href="subject.html#14650">[ subject ]</a>
              <a href="author.html#14650">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi again,

I found an interesting fact that MS.NET 1.x treats such row values
of inconvertible columns as System.String. The attached example
shows you what happens there on MS.NET 1.x

On .NET 2.0 it throws an exception as Mono does. So it really
seems MS bug in 1.x.

Atsushi Eno


Atsushi Eno wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Chris Micacchi wrote:
</I>&gt;&gt;<i> I have a program that creates a DataTable with a column of type 
</I>&gt;&gt;<i> System.Version, and then writes out the dataset containing the table 
</I>&gt;&gt;<i> to an XML file using DataSet.WriteXml().  The resulting file looks 
</I>&gt;&gt;<i> fine, but when I then use DataSet.ReadXml() to re-read the data back 
</I>&gt;&gt;<i> into the dataset, I get this:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Unhandled Exception: System.InvalidCastException: Unknown target 
</I>&gt;&gt;<i> conversion type
</I>&gt;&gt;<i> in &lt;0x0065c&gt; System.Convert:ToType (System.Object value, System.Type 
</I>&gt;&gt;<i> conversionType, IFormatProvider provider)
</I>&gt;&gt;<i> in &lt;0x00032&gt; System.Convert:ChangeType (System.Object value, 
</I>&gt;&gt;<i> System.Type conversionType)
</I>&gt;&gt;<i> in &lt;0x0030e&gt; System.Data.XmlDataReader:StringToObject (System.Type 
</I>&gt;&gt;<i> type, System.String value)
</I>&gt;&gt;<i> in &lt;0x001d3&gt; System.Data.XmlDataReader:ReadElementElement 
</I>&gt;&gt;<i> (System.Data.DataRow row)
</I>&gt;&gt;<i> ....
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It looks like it's trying to convert the stringified version number 
</I>&gt;&gt;<i> back to a System.Version and hitting a brick wall.  Am I doing 
</I>&gt;&gt;<i> something wrong here?  I've attached a small sample program that hits 
</I>&gt;&gt;<i> this problem for me, in case it helps.  Compile it with
</I>&gt;&gt;<i>     mcs datasettest.cs -out:datasettest.exe -r:System.Data
</I>&gt;<i> 
</I>&gt;<i> Yes, kinda wrong. System.Version is not documented as a supported
</I>&gt;<i> datatype:
</I>&gt;<i> <A HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/</A>
</I>&gt;<i> cpref/html/frlrfsystemdatadatacolumnclassdatatypetopic.asp
</I>&gt;<i> 
</I>&gt;<i> My guess is that for such input type that is not listed on the
</I>&gt;<i> list shown in above page MS.NET checks whether the type has a
</I>&gt;<i> constructor which takes a string.
</I>&gt;<i> 
</I>&gt;<i> I'll take care it and possibly fix the code after 1.1.9 release.
</I>&gt;<i> 
</I>&gt;<i> Atsushi Eno
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: really-typed.cs
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050909/0fa633b3/attachment.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050909/0fa633b3/attachment.pl</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014649.html">[Mono-dev] System.Data.DataSet ReadXml question
</A></li>
	<LI>Next message: <A HREF="014662.html">[Mono-dev] System.Data.DataSet ReadXml question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14650">[ date ]</a>
              <a href="thread.html#14650">[ thread ]</a>
              <a href="subject.html#14650">[ subject ]</a>
              <a href="author.html#14650">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
