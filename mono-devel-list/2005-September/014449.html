<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] C++ to C# to C++ interop,	how can I do this in a mono-compliant way?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20C%2B%2B%20to%20C%23%20to%20C%2B%2B%20interop%2C%0A%09how%20can%20I%20do%20this%20in%20a%20mono-compliant%20way%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014448.html">
   <LINK REL="Next"  HREF="014458.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] C++ to C# to C++ interop,	how can I do this in a mono-compliant way?</H1>
    <B>Ring, Kevin</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20C%2B%2B%20to%20C%23%20to%20C%2B%2B%20interop%2C%0A%09how%20can%20I%20do%20this%20in%20a%20mono-compliant%20way%3F&In-Reply-To="
       TITLE="[Mono-dev] C++ to C# to C++ interop,	how can I do this in a mono-compliant way?">kring at agi.com
       </A><BR>
    <I>Thu Sep  1 10:39:06 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014448.html">[Mono-dev] __ComObject should not be public
</A></li>
        <LI>Next message: <A HREF="014458.html">[Mono-dev] Type.GetType inside of dynamic assembly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14449">[ date ]</a>
              <a href="thread.html#14449">[ thread ]</a>
              <a href="subject.html#14449">[ subject ]</a>
              <a href="author.html#14449">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jason,

 

I have a similar situation, except that I'm planning to address it on
Windows using COM interop rather than mixed-mode C++.  I posted to this
list last week asking for advice on how to best do something similar
with Mono.

 

Jonathan Pryor pointed me to the Mono embedding API
(<A HREF="http://www.mono-project.com/Embedding_Mono">http://www.mono-project.com/Embedding_Mono</A>), which can probably be used
to do exactly what you want.  The page describes a way to call managed
methods from C and also to call back into C from the managed world.  It
is quite a bit clunkier than either mixed-mode C++ or COM interop,
though.  He also pointed me to a Mono utility called cilc which can be
used to generate C wrappers for the classes and methods in an assembly,
which helps with some of the clunkyness.  Eventually I'd like to extend
cilc to generate full C++ wrappers, complete with marshalling between
CLR and C++ types, to create something a lot like COM interop for Mono.
Even better, I'd like to arrange for my company to pay an interested
person to create something like this, as it is pretty far outside of our
core area of expertise.

 

Some other folks had some interesting suggestions as well.  Check the
August archives of this list for a thread called &quot;COM Interop, or
something like it&quot;.

 

Hope this helps!

Kevin Ring

 

 

________________________________

From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>
[mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] On Behalf Of J
Sent: Monday, August 29, 2005 7:02 PM
To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Subject: [Mono-dev] C++ to C# to C++ interop,how can I do this in a
mono-compliant way?

 

Hello, 

 

I am looking for a way of having a C++ exe integrate with a .NET dll.  I
have a solution working under Windows (Microsoft.NET 1.1) however I
would like to make this function under Mono.

 

Here are the details:

 

I currently am writing a C# wrapper of a C++ game engine.  (T2D by
garagegames)  I wrote this on Windows (CLR v1.1) and the main way this
works is by adding Managed code to the C++ engine (so now it is mixed
Managed/Unmanaged C++) so it can directly call into my C# DLL, and using
PInvoke to have the C# DLL talk balk to the C++ engine.

 

The C++ engine itself is OS agnostic (it works on windows, linux and
mac), and I would love to make this C# wrapper work under mono, so that
it is OS agnostic as well.

 

However, <A HREF="http://www.go-mono.com/faq.html#63">http://www.go-mono.com/faq.html#63</A>  informs me that Mixed mode
assemblies do not work under mono.

 

Is there any way to have this work under Mono?   Please realize that the
basic need is to have 1 instance of a C++ exe call into a .NET dll, and
have that DLL be able to then execute functions in the C++ exe that
called it.     So this requires a mono-equivlant of PInvoke, plus a way
to have the C++ app call the C# app. 

 

Help on this would be appreciated, otherwise it'll be Windows only!

 

-Jason

__________________________________________________
Do You Yahoo!?
Tired of spam? Yahoo! Mail has the best spam protection around 
<A HREF="http://mail.yahoo.com">http://mail.yahoo.com</A> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050901/738e5ab5/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050901/738e5ab5/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014448.html">[Mono-dev] __ComObject should not be public
</A></li>
	<LI>Next message: <A HREF="014458.html">[Mono-dev] Type.GetType inside of dynamic assembly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14449">[ date ]</a>
              <a href="thread.html#14449">[ thread ]</a>
              <a href="subject.html#14449">[ subject ]</a>
              <a href="author.html#14449">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
