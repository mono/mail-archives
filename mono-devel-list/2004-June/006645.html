<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Re: [mono-vb] VB Class status
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20%5Bmono-vb%5D%20VB%20Class%20status&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006644.html">
   <LINK REL="Next"  HREF="006651.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Re: [mono-vb] VB Class status</H1>
    <B>A Rafael D Teixeira</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Re%3A%20%5Bmono-vb%5D%20VB%20Class%20status&In-Reply-To="
       TITLE="[Mono-devel-list] Re: [mono-vb] VB Class status">rafaelteixeirabr at hotmail.com
       </A><BR>
    <I>Thu Jun 24 10:58:06 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="006644.html">[Mono-devel-list] Re: [mono-vb] VB Class status
</A></li>
        <LI>Next message: <A HREF="006651.html">[Mono-devel-list] Re: [mono-vb] VB Class status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6645">[ date ]</a>
              <a href="thread.html#6645">[ thread ]</a>
              <a href="subject.html#6645">[ subject ]</a>
              <a href="author.html#6645">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Kudos Raja, you went right to the point.

The problem is (besides the MonoTODO) that if C# doesn't have the syntax to 
support it, we may have to rewrite part, or the whole, of our library in 
VB.NET, or put an option in mcs to specifically allow such extension of 
syntax (Miguel probably wouldn't like that).

Also there is some special handling of default-values for complex types like 
DateTime see 
(<A HREF="http://www1.cs.columbia.edu/~lok/csharp/refdocs/System.Runtime.CompilerServices/types/DateTimeConstantAttribute.html">http://www1.cs.columbia.edu/~lok/csharp/refdocs/System.Runtime.CompilerServices/types/DateTimeConstantAttribute.html</A> 
or 
<A HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemruntimecompilerservicesdatetimeconstantattributeclasstopic.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemruntimecompilerservicesdatetimeconstantattributeclasstopic.asp</A>)

Let's study it a bit more,

Rafael &quot;Monoman&quot; Teixeira
Mono Hacker since 16 Jul 2001 - <A HREF="http://www.go-mono.org/">http://www.go-mono.org/</A>
MonoBrasil Founding Member - Membro Fundador do MonoBrasil 
<A HREF="http://monobrasil.softwarelivre.org">http://monobrasil.softwarelivre.org</A>
English Blog: <A HREF="http://monoblog.blogspot.com/">http://monoblog.blogspot.com/</A>
Brazilian Portuguese Blog: <A HREF="http://monoblog.weblogger.terra.com.br/">http://monoblog.weblogger.terra.com.br/</A>

&gt;<i>From: Raja R Harinath &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">rharinath at novell.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>Hi Jambu,
</I>&gt;<i>
</I>&gt;<i>&quot;Jambunathan Jambunathan&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kjambunathan at novell.com</A>&gt; writes:
</I>&gt;<i>
</I>&gt;<i> &gt;&gt; What makes that .param [n] appear there?
</I>&gt;<i> &gt;&gt; [opt]  comes from the Optional attribute? it seems so, but ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ( All these observations based on Windows XP box)
</I>&gt;<i> &gt; [opt] does get generated by [Optional]
</I>&gt;<i> &gt; .param does get generated by System.ComponentModel.DefaultValue.
</I>&gt;<i> &gt; Interestingly however, for the HasDefault flag to be turned on
</I>&gt;<i> &gt; the compiler apparently looks for &quot;.param[] =  &quot; construct.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Not sure what would segment of C# code would force
</I>&gt;<i> &gt; emitting of &quot;.param[] = &quot; construct. I believe that there is no such
</I>&gt;<i> &gt; construct in C# though.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Anyways the functionality is not broken ( if you use vbc as opposed to 
</I>&gt;<i>mbas )
</I>&gt;<i> &gt; only that the MSVB class status page simply refuse to recognize all the
</I>&gt;<i> &gt; good effort that we have put in ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Should corcompare be changed to accomodate this ? Shouldn't be a big 
</I>&gt;<i>deal
</I>&gt;<i> &gt; I think.
</I>&gt;<i>
</I>&gt;<i>System.ComponentModel.DefaultValue probably has nothing to do with
</I>&gt;<i>this.  AFAIK, it is an informational attribute for visual class
</I>&gt;<i>designer GUIs, and not used for codegen.
</I>&gt;<i>
</I>&gt;<i>The HasDefault flag and the .param[...] = ... will be emitted when the
</I>&gt;<i>compiler calls ParameterBuilder.SetConstant().  This function is a
</I>&gt;<i>[MonoTODO] in Mono, so it won't actually work ;-)
</I>&gt;<i>
</I>&gt;<i>So, the &quot;fix&quot; is to
</I>&gt;<i>
</I>&gt;<i>   1. Implement ParameterBuilder.SetConstant ()
</I>&gt;<i>   2. Update mbas to call it when you use the &quot;Optional ByVal foo = 10&quot;
</I>&gt;<i>      syntax for a parameter.
</I>&gt;<i>
</I>&gt;<i>I don't know if C# has a corresponding syntax.
</I>&gt;<i>
</I>&gt;<i>- Hari
</I>
_________________________________________________________________
MSN Messenger: instale gr&#225;tis e converse com seus amigos. 
<A HREF="http://messenger.msn.com.br">http://messenger.msn.com.br</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006644.html">[Mono-devel-list] Re: [mono-vb] VB Class status
</A></li>
	<LI>Next message: <A HREF="006651.html">[Mono-devel-list] Re: [mono-vb] VB Class status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6645">[ date ]</a>
              <a href="thread.html#6645">[ thread ]</a>
              <a href="subject.html#6645">[ subject ]</a>
              <a href="author.html#6645">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
