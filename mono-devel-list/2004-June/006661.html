<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] ABC removal rewrite for performance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20ABC%20removal%20rewrite%20for%20performance&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006711.html">
   <LINK REL="Next"  HREF="006662.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] ABC removal rewrite for performance</H1>
    <B>Massimiliano Mantione</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20ABC%20removal%20rewrite%20for%20performance&In-Reply-To="
       TITLE="[Mono-devel-list] ABC removal rewrite for performance">massi at ximian.com
       </A><BR>
    <I>Fri Jun 25 05:59:49 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="006711.html">[PATCH] Re: [Mono-devel-list] Building Mono under Cygwin on	WinXP
</A></li>
        <LI>Next message: <A HREF="006662.html">[Mono-devel-list] Re: [mono-vb] VB Class status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6661">[ date ]</a>
              <a href="thread.html#6661">[ thread ]</a>
              <a href="subject.html#6661">[ subject ]</a>
              <a href="author.html#6661">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>/me is very happy :-)

ABC removal runs well.
I still do not consider it ready for prime time (more testing is
needed), but it is definitely working, and not crashing.

There are some corner cases that I must verify (the new code is
more effective that the previous one, so there are more potential
problems), and yet another theoretical issue with loops...
And there's always the problem of over/under-flow...

Now, the nice thing: the new code is more effective (removes 337
checks from mscorlib.dll, the old one removed 269 checks) and I
can easily gain some more without affecting compilation time (but
I still have to test that all these removals are correct :-( ).
But despite being more effective, the new code is also faster.

These are the min and max compilation times I get with this cmd:
time mono --compile-all -O=xxxxxx /usr/lib/mscorlib.dll

Options:     -O=deadce        -O=deadce,abcrem
Old code:    1.416s - 1.442s  2.638s - 2.646s
New code:    1.404s - 1.426s  1.416s - 1.433s

Basically, with the new code, abcrem could be turned on by default
whenever SSA is used (the overhead is very low)!

The &quot;sparse approach&quot; outlined in the ABCD paper is really
effective... too bad this code will not make it for for 1.0 :-(

Ciao,
  Massi

P.S. With the spirit &quot;release early, release often&quot;, in case
anybody is interested and/or has some time to have a look at it,
I put the relevant files (still buggy) here:

<A HREF="http://primates.ximian.com/~massi/abcremoval.tar.gz">http://primates.ximian.com/~massi/abcremoval.tar.gz</A>

(no patch because it does not make sense, the rewrite is massive,
and sorry, it is not commented yet, I kept changing it too quickly
and keeping comments up to date would have been a pain)

One &quot;bad&quot; open issue is related to over/under-flows in arithmetical
operations, which can fool the optimizer.
See this file to understand what I mean:

<A HREF="http://primates.ximian.com/~massi/overflow.cs">http://primates.ximian.com/~massi/overflow.cs</A>

I have some idea on how to handle this, but they are just hacks :-(



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006711.html">[PATCH] Re: [Mono-devel-list] Building Mono under Cygwin on	WinXP
</A></li>
	<LI>Next message: <A HREF="006662.html">[Mono-devel-list] Re: [mono-vb] VB Class status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6661">[ date ]</a>
              <a href="thread.html#6661">[ thread ]</a>
              <a href="subject.html#6661">[ subject ]</a>
              <a href="author.html#6661">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
