<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] different behavior in MS.NET and MONO in System.Type.GetElementType()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20different%20behavior%20in%20MS.NET%20and%20MONO%20in%20System.Type.GetElementType%28%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002970.html">
   <LINK REL="Next"  HREF="002972.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] different behavior in MS.NET and MONO in System.Type.GetElementType()</H1>
    <B>Eran Domb</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20different%20behavior%20in%20MS.NET%20and%20MONO%20in%20System.Type.GetElementType%28%29&In-Reply-To="
       TITLE="[Mono-devel-list] different behavior in MS.NET and MONO in System.Type.GetElementType()">erand at mainsoft.com
       </A><BR>
    <I>Sun Nov 16 10:25:40 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="002970.html">[Mono-devel-list] Very slow connection via Npgsql from mono 0.26, 0.28
</A></li>
        <LI>Next message: <A HREF="002972.html">[Mono-devel-list] URGENT: AAAAAAAARGH !!! XSP or MONO BUGS !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2971">[ date ]</a>
              <a href="thread.html#2971">[ thread ]</a>
              <a href="subject.html#2971">[ subject ]</a>
              <a href="author.html#2971">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,
I found a difference in the behavior of MS.NET and mono.
System.Type.GetElementType() :
 
In MS.NET the method behave the following way:
 - If the instance is the type of an array, it returns the type of the
objects in the array (String for an array of String etc.)
 - In any other case it returns null.
In Mono it behaves the same with arrays, but in Enums it returns the
underlying type of the enum and in all other types it returns itself
instead of null.
 
The question is what should be the behavior in Mono ? As it is now or as
it is in MS .net ? 
 
If we modify the behavior to be the same as MS .NET's one there may be a
lot of impacts.
 
For example:
 
System.Xml.Serialization.XmlSerializationWriterInterpreter.MemberHasValu
e(XmlTypeMapMember member, object ob, bool isValueList)
if (val != null &amp;&amp; val.GetType().IsEnum)
{
                              
            if (val.Equals (member.DefaultValue)) return false;
                              
            val = Convert.ChangeType (val, val.GetType().GetElementType
());
}
 
This piece of code expects the GetElementType() to return the underlying
type of the enum, while in MS.NET it will return null. If we modify
GetElementType(), the code needs to be modified to use
Enum.GetUnderlyingType(Type type).
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20031116/1ffd556c/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20031116/1ffd556c/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002970.html">[Mono-devel-list] Very slow connection via Npgsql from mono 0.26, 0.28
</A></li>
	<LI>Next message: <A HREF="002972.html">[Mono-devel-list] URGENT: AAAAAAAARGH !!! XSP or MONO BUGS !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2971">[ date ]</a>
              <a href="thread.html#2971">[ thread ]</a>
              <a href="subject.html#2971">[ subject ]</a>
              <a href="author.html#2971">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
