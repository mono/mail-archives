<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Building Mono on Windows - And Having a Windows	Installer again
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Building%20Mono%20on%20Windows%20-%20And%20Having%20a%0A%20Windows%09Installer%20again&In-Reply-To=%3C547878B9.3000807%40dynamicdevices.co.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042445.html">
   <LINK REL="Next"  HREF="042447.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Building Mono on Windows - And Having a Windows	Installer again</H1>
    <B>Alex J Lennon</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Building%20Mono%20on%20Windows%20-%20And%20Having%20a%0A%20Windows%09Installer%20again&In-Reply-To=%3C547878B9.3000807%40dynamicdevices.co.uk%3E"
       TITLE="[Mono-dev] Building Mono on Windows - And Having a Windows	Installer again">ajlennon at dynamicdevices.co.uk
       </A><BR>
    <I>Fri Nov 28 13:29:29 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="042445.html">[Mono-dev] Building Mono on Windows - And Having a	Windows	Installer again
</A></li>
        <LI>Next message: <A HREF="042447.html">[Mono-dev] Building Mono on Windows - And Having a Windows Installer again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42446">[ date ]</a>
              <a href="thread.html#42446">[ thread ]</a>
              <a href="subject.html#42446">[ subject ]</a>
              <a href="author.html#42446">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Daniel,

On 30/11/2014 02:13, Edward Ned Harvey (mono) wrote:
&gt;&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:mono-devel-list-
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bounces at lists.ximian.com</A>] On Behalf Of Daniel Morgan
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I see the latest version of Mono's Windows installer is 3.2.3.  Can this be used
</I>&gt;&gt;<i> to build the latest from git?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I see a link for binaries for 3.4.0, but they are not official binaries.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am going to try build Mono on Windows using Cygwin.  Not sure how web
</I>&gt;&gt;<i> the visual studio stuff works.
</I>&gt;<i> Search this list for Appveyor.  I know Alex Lennon was putting some effort in, and I think got to the point of having a reliable automated build process - but check with folks to be sure (I haven't followed very closely and I could be wrong).  At some point, Miguel pulled Duncan Mak into the conversation, so I would guess maybe Duncan is involved with distributing windows builds...  All of this occurred within the last ~ 1 month or so.
</I>&gt;<i>
</I>
As Edward says, I did put a bit of time into this and we do have what I
think is a reliable automated build process on the Windows platform,
although as ever there are improvements that can be made,

Stepping back for a second there's a couple of documents that I've been
maintaining on building Mono under Windows with Cygwin (prior to being
introduced to Appveyor CI)

This covers 3.4.0 - 3.6.0,
<A HREF="http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows">http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows</A>

And this covers 3.8.0+
<A HREF="http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows">http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows</A>

It gets you to the point you can just about use Mono but there are some
remaining issues I have yet to address,

e.g.

- understanding how the Mono installer works
- dealing with hard coded library references in the build (I think the
installer may do some of this)
- ensuring that Windows batch files for e.g. mcs, mono, xbuild are
correcly created (Again I think the installer may do some of this)

...

Further to that I then created a build script for the Appveyor build
platform, based on work and suggestions from Mladen Mihajlovic, which is
currently automatically building Mono on commits to the repo

You can see the build history here:
<A HREF="https://ci.appveyor.com/project/ajlennon/mono-817">https://ci.appveyor.com/project/ajlennon/mono-817</A>

The output &quot;artifact&quot; from any of these builds is currently a set of
Mono binaries which you _should_ be able to download and use straight
away (would love some feedback on any issues here)

e.g. <A HREF="https://ci.appveyor.com/project/ajlennon/mono-817/build/artifacts">https://ci.appveyor.com/project/ajlennon/mono-817/build/artifacts</A>

You should also be able to take the script I created and use this to
build your own build of Mono, independently of the instruction documents
I reference above. In particular there's a useful line there that
automates installation of needed Cygwin packages.

See here: <A HREF="https://github.com/mono/mono/blob/master/appveyor.yml">https://github.com/mono/mono/blob/master/appveyor.yml</A>
(build_script section)

What I'd like to do next is to modify this script to take the bones of
the Windows installer and generate an output artifact which was an MSI
installer.

Unfortunately this is not trivial (to me at least!), and also requires
pulling in some GTK# dependencies and so forth. I want to progress this
but have not yet had time due to work commitments.

Also, and perhaps more importantly the Cygwin build may all become
somewhat deprecated as Jo Shields appears to be doing some excellent
work to make Mono build under MSVC.

Once this is achievable, to my mind it will be a vastly superior way to
build Mono, instead of the 2 hour+ Cygwin build with all the faff.

&gt;&gt;<i> Also, what is the best Linux distro to build mono?  OpenSUSE?  Debian,
</I>&gt;&gt;<i> Ubuntu?  It has been awhile for me.  Not starting a flame war here - just
</I>&gt;&gt;<i> wanting the easiest route to get the dependencies on linux  in order to build
</I>&gt;&gt;<i> the latest mono from git.
</I>&gt;<i> On basically any system I've seen so far, building is easy.  The basic process of &quot;./configure &amp;&amp; make &amp;&amp; make install&quot; usually works.  If it doesn't, then add &quot;make get-monolite-latest&quot; before &quot;make EXTERNAL_MCS=...&quot;  as below...
</I>&gt;<i>
</I>&gt;<i> On every redhat-based or debian-based (or even mac) system I've ever used, one of these two variants has always worked.
</I>&gt;<i>
</I>&gt;<i> OSX
</I>&gt;<i> export BUILDDIR=/Users/whatever/Projects/mono-build
</I>&gt;<i> export NUMPROC=3 ; time ( test -d $BUILDDIR &amp;&amp; rm -rf $BUILDDIR ; mkdir -p $BUILDDIR ; ./autogen.sh --prefix=$BUILDDIR --disable-bcl-opt --enable-nls=no &amp;&amp; make -j $NUMPROC &amp;&amp; make install &amp;&amp; echo &quot;&quot; &amp;&amp; echo &quot;    Done&quot; &amp;&amp; echo &quot;&quot;)
</I>&gt;<i>
</I>&gt;<i> Ubuntu 14.04
</I>&gt;<i> export BUILDDIR=/home/whatever/Projects/mono-build
</I>&gt;<i> export NUMPROC=3 ; time ( test -d $BUILDDIR &amp;&amp; rm -rf $BUILDDIR ; mkdir -p $BUILDDIR ; ./autogen.sh --prefix=$BUILDDIR --disable-bcl-opt --enable-nls=no &amp;&amp; make get-monolite-latest &amp;&amp; make -j $NUMPROC EXTERNAL_MCS=&quot;${PWD}/mcs/class/lib/monolite/gmcs.exe&quot; &amp;&amp; make install &amp;&amp; echo &quot;&quot; &amp;&amp; echo &quot;    Done&quot; &amp;&amp; echo &quot;&quot;)
</I>&gt;<i>
</I>
Possibly a bit off-topic but fwiw I maintain and use Yocto for Embedded
Linux with meta-mono layer. The recipes for building Mono are here,

<A HREF="http://git.yoctoproject.org/cgit/cgit.cgi/meta-mono/tree/recipes-mono/mono?h=master">http://git.yoctoproject.org/cgit/cgit.cgi/meta-mono/tree/recipes-mono/mono?h=master</A>

Cheers,

Alex
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042445.html">[Mono-dev] Building Mono on Windows - And Having a	Windows	Installer again
</A></li>
	<LI>Next message: <A HREF="042447.html">[Mono-dev] Building Mono on Windows - And Having a Windows Installer again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42446">[ date ]</a>
              <a href="thread.html#42446">[ thread ]</a>
              <a href="subject.html#42446">[ subject ]</a>
              <a href="author.html#42446">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
