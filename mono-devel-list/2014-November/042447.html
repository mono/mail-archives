<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Building Mono on Windows - And Having a Windows Installer again
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Building%20Mono%20on%20Windows%20-%20And%20Having%20a%20Windows%0A%20Installer%20again&In-Reply-To=%3CDUB130-W23EE00C82B7A9C0CA2A455E87C0%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042446.html">
   <LINK REL="Next"  HREF="042448.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Building Mono on Windows - And Having a Windows Installer again</H1>
    <B>Alexander K&#246;plinger</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Building%20Mono%20on%20Windows%20-%20And%20Having%20a%20Windows%0A%20Installer%20again&In-Reply-To=%3CDUB130-W23EE00C82B7A9C0CA2A455E87C0%40phx.gbl%3E"
       TITLE="[Mono-dev] Building Mono on Windows - And Having a Windows Installer again">alex.koeplinger at outlook.com
       </A><BR>
    <I>Sun Nov 30 14:09:23 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="042446.html">[Mono-dev] Building Mono on Windows - And Having a Windows	Installer again
</A></li>
        <LI>Next message: <A HREF="042448.html">[Mono-dev] Building Mono on Windows - And Having a Windows Installer again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42447">[ date ]</a>
              <a href="thread.html#42447">[ thread ]</a>
              <a href="subject.html#42447">[ subject ]</a>
              <a href="author.html#42447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Alex,
 
Jo Shields is currently working on revamping the Windows Installer in his repo: <A HREF="https://github.com/directhex/newbuilder">https://github.com/directhex/newbuilder</A>
I contributed the WiX setup files for creating an MSI installer. Jo sent me this link for a preview build (the usual caveats apply): <A HREF="https://drive.google.com/file/d/0Bz6-k9ELOQf3YTE1RHV3Y0dNaFU/view">https://drive.google.com/file/d/0Bz6-k9ELOQf3YTE1RHV3Y0dNaFU/view</A>
 
Btw. while developing the WiX setup I used the binaries from your AppVeyor build, it all worked fine :)
 
Can you maybe also make changes to <A HREF="http://www.mono-project.com/docs/compiling-mono/windows/">http://www.mono-project.com/docs/compiling-mono/windows/</A> (just click the &quot;edit page on github&quot; link), so it reflects what is necessary right now to build Mono on Windows? I think that page is pretty outdated right now.
 
-- Alex
 
 
&gt;<i> Date: Fri, 28 Nov 2014 14:29:29 +0100
</I>&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ajlennon at dynamicdevices.co.uk</A>
</I>&gt;<i> To: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">monodanmorg at yahoo.com</A>
</I>&gt;<i> CC: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> Subject: Re: [Mono-dev] Building Mono on Windows - And Having a Windows	Installer again
</I>&gt;<i> 
</I>&gt;<i> Hi Daniel,
</I>&gt;<i> 
</I>&gt;<i> On 30/11/2014 02:13, Edward Ned Harvey (mono) wrote:
</I>&gt;<i> &gt;&gt; From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:mono-devel-list-
</I>&gt;<i> &gt;&gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bounces at lists.ximian.com</A>] On Behalf Of Daniel Morgan
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I see the latest version of Mono's Windows installer is 3.2.3.  Can this be used
</I>&gt;<i> &gt;&gt; to build the latest from git?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I see a link for binaries for 3.4.0, but they are not official binaries.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I am going to try build Mono on Windows using Cygwin.  Not sure how web
</I>&gt;<i> &gt;&gt; the visual studio stuff works.
</I>&gt;<i> &gt; Search this list for Appveyor.  I know Alex Lennon was putting some effort in, and I think got to the point of having a reliable automated build process - but check with folks to be sure (I haven't followed very closely and I could be wrong).  At some point, Miguel pulled Duncan Mak into the conversation, so I would guess maybe Duncan is involved with distributing windows builds...  All of this occurred within the last ~ 1 month or so.
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> As Edward says, I did put a bit of time into this and we do have what I
</I>&gt;<i> think is a reliable automated build process on the Windows platform,
</I>&gt;<i> although as ever there are improvements that can be made,
</I>&gt;<i> 
</I>&gt;<i> Stepping back for a second there's a couple of documents that I've been
</I>&gt;<i> maintaining on building Mono under Windows with Cygwin (prior to being
</I>&gt;<i> introduced to Appveyor CI)
</I>&gt;<i> 
</I>&gt;<i> This covers 3.4.0 - 3.6.0,
</I>&gt;<i> <A HREF="http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows">http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows</A>
</I>&gt;<i> 
</I>&gt;<i> And this covers 3.8.0+
</I>&gt;<i> <A HREF="http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows">http://www.codeproject.com/Articles/769292/How-to-build-Mono-on-Windows</A>
</I>&gt;<i> 
</I>&gt;<i> It gets you to the point you can just about use Mono but there are some
</I>&gt;<i> remaining issues I have yet to address,
</I>&gt;<i> 
</I>&gt;<i> e.g.
</I>&gt;<i> 
</I>&gt;<i> - understanding how the Mono installer works
</I>&gt;<i> - dealing with hard coded library references in the build (I think the
</I>&gt;<i> installer may do some of this)
</I>&gt;<i> - ensuring that Windows batch files for e.g. mcs, mono, xbuild are
</I>&gt;<i> correcly created (Again I think the installer may do some of this)
</I>&gt;<i> 
</I>&gt;<i> ...
</I>&gt;<i> 
</I>&gt;<i> Further to that I then created a build script for the Appveyor build
</I>&gt;<i> platform, based on work and suggestions from Mladen Mihajlovic, which is
</I>&gt;<i> currently automatically building Mono on commits to the repo
</I>&gt;<i> 
</I>&gt;<i> You can see the build history here:
</I>&gt;<i> <A HREF="https://ci.appveyor.com/project/ajlennon/mono-817">https://ci.appveyor.com/project/ajlennon/mono-817</A>
</I>&gt;<i> 
</I>&gt;<i> The output &quot;artifact&quot; from any of these builds is currently a set of
</I>&gt;<i> Mono binaries which you _should_ be able to download and use straight
</I>&gt;<i> away (would love some feedback on any issues here)
</I>&gt;<i> 
</I>&gt;<i> e.g. <A HREF="https://ci.appveyor.com/project/ajlennon/mono-817/build/artifacts">https://ci.appveyor.com/project/ajlennon/mono-817/build/artifacts</A>
</I>&gt;<i> 
</I>&gt;<i> You should also be able to take the script I created and use this to
</I>&gt;<i> build your own build of Mono, independently of the instruction documents
</I>&gt;<i> I reference above. In particular there's a useful line there that
</I>&gt;<i> automates installation of needed Cygwin packages.
</I>&gt;<i> 
</I>&gt;<i> See here: <A HREF="https://github.com/mono/mono/blob/master/appveyor.yml">https://github.com/mono/mono/blob/master/appveyor.yml</A>
</I>&gt;<i> (build_script section)
</I>&gt;<i> 
</I>&gt;<i> What I'd like to do next is to modify this script to take the bones of
</I>&gt;<i> the Windows installer and generate an output artifact which was an MSI
</I>&gt;<i> installer.
</I>&gt;<i> 
</I>&gt;<i> Unfortunately this is not trivial (to me at least!), and also requires
</I>&gt;<i> pulling in some GTK# dependencies and so forth. I want to progress this
</I>&gt;<i> but have not yet had time due to work commitments.
</I>&gt;<i> 
</I>&gt;<i> Also, and perhaps more importantly the Cygwin build may all become
</I>&gt;<i> somewhat deprecated as Jo Shields appears to be doing some excellent
</I>&gt;<i> work to make Mono build under MSVC.
</I>&gt;<i> 
</I>&gt;<i> Once this is achievable, to my mind it will be a vastly superior way to
</I>&gt;<i> build Mono, instead of the 2 hour+ Cygwin build with all the faff.
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt; Also, what is the best Linux distro to build mono?  OpenSUSE?  Debian,
</I>&gt;<i> &gt;&gt; Ubuntu?  It has been awhile for me.  Not starting a flame war here - just
</I>&gt;<i> &gt;&gt; wanting the easiest route to get the dependencies on linux  in order to build
</I>&gt;<i> &gt;&gt; the latest mono from git.
</I>&gt;<i> &gt; On basically any system I've seen so far, building is easy.  The basic process of &quot;./configure &amp;&amp; make &amp;&amp; make install&quot; usually works.  If it doesn't, then add &quot;make get-monolite-latest&quot; before &quot;make EXTERNAL_MCS=...&quot;  as below...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On every redhat-based or debian-based (or even mac) system I've ever used, one of these two variants has always worked.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; OSX
</I>&gt;<i> &gt; export BUILDDIR=/Users/whatever/Projects/mono-build
</I>&gt;<i> &gt; export NUMPROC=3 ; time ( test -d $BUILDDIR &amp;&amp; rm -rf $BUILDDIR ; mkdir -p $BUILDDIR ; ./autogen.sh --prefix=$BUILDDIR --disable-bcl-opt --enable-nls=no &amp;&amp; make -j $NUMPROC &amp;&amp; make install &amp;&amp; echo &quot;&quot; &amp;&amp; echo &quot;    Done&quot; &amp;&amp; echo &quot;&quot;)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ubuntu 14.04
</I>&gt;<i> &gt; export BUILDDIR=/home/whatever/Projects/mono-build
</I>&gt;<i> &gt; export NUMPROC=3 ; time ( test -d $BUILDDIR &amp;&amp; rm -rf $BUILDDIR ; mkdir -p $BUILDDIR ; ./autogen.sh --prefix=$BUILDDIR --disable-bcl-opt --enable-nls=no &amp;&amp; make get-monolite-latest &amp;&amp; make -j $NUMPROC EXTERNAL_MCS=&quot;${PWD}/mcs/class/lib/monolite/gmcs.exe&quot; &amp;&amp; make install &amp;&amp; echo &quot;&quot; &amp;&amp; echo &quot;    Done&quot; &amp;&amp; echo &quot;&quot;)
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> Possibly a bit off-topic but fwiw I maintain and use Yocto for Embedded
</I>&gt;<i> Linux with meta-mono layer. The recipes for building Mono are here,
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://git.yoctoproject.org/cgit/cgit.cgi/meta-mono/tree/recipes-mono/mono?h=master">http://git.yoctoproject.org/cgit/cgit.cgi/meta-mono/tree/recipes-mono/mono?h=master</A>
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> 
</I>&gt;<i> Alex
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I> 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20141130/93cf4422/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20141130/93cf4422/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042446.html">[Mono-dev] Building Mono on Windows - And Having a Windows	Installer again
</A></li>
	<LI>Next message: <A HREF="042448.html">[Mono-dev] Building Mono on Windows - And Having a Windows Installer again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42447">[ date ]</a>
              <a href="thread.html#42447">[ thread ]</a>
              <a href="subject.html#42447">[ subject ]</a>
              <a href="author.html#42447">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
