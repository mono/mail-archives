<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] WCF Fail with System.Net.Sockets.SocketException: Connection reset by peer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20WCF%20Fail%20with%20System.Net.Sockets.SocketException%3A%0A%20Connection%20reset%20by%20peer&In-Reply-To=%3C4FEE030E.8080201%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039292.html">
   <LINK REL="Next"  HREF="039291.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] WCF Fail with System.Net.Sockets.SocketException: Connection reset by peer</H1>
    <B>Rob Wilkens</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20WCF%20Fail%20with%20System.Net.Sockets.SocketException%3A%0A%20Connection%20reset%20by%20peer&In-Reply-To=%3C4FEE030E.8080201%40gmail.com%3E"
       TITLE="[Mono-dev] WCF Fail with System.Net.Sockets.SocketException: Connection reset by peer">robwilkens at gmail.com
       </A><BR>
    <I>Fri Jun 29 19:33:34 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="039292.html">[Mono-dev] WCF Fail with System.Net.Sockets.SocketException: Connection reset by peer
</A></li>
        <LI>Next message: <A HREF="039291.html">[Mono-dev] WCF Fail with System.Net.Sockets.SocketException: Connection reset by peer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39293">[ date ]</a>
              <a href="thread.html#39293">[ thread ]</a>
              <a href="subject.html#39293">[ subject ]</a>
              <a href="author.html#39293">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256


Getting something that is consistently reproducible would be ideal.

I've got something else on front of my priority queue at the moment, and
may not get back to this right away.


- -Rob

On 06/29/2012 02:26 PM, Ali Shahbour wrote:
&gt;<i> In my real application , I got a collection out of 300 000 record and I do
</I>&gt;<i> search on it and send the result or top 30 items. Also I got a request
</I>&gt;<i> approximately every 5 second.
</I>&gt;<i>
</I>&gt;<i> We can try this also
</I>&gt;<i>
</I>&gt;<i> BR
</I>&gt;<i> Shabour
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 6/29/12 1:23 PM, &quot;Rob Wilkens&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">robwilkens at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Shahbour,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I think this is a lucky timing issue.. That is: The Thread.Sleep makes
</I>&gt;&gt;<i> the SocketException happen in between when we are receiving or
</I>&gt;&gt;<i> sending... In your stacktraces, it's always WHILE we are sending or
</I>&gt;&gt;<i> receiving that the disconnect happens and the crash occurs.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> One way to reproduce this might be to spawn copies that send LOTS of
</I>&gt;&gt;<i> data (could be a bunch of zeroes) and receives back a bunch of data
</I>&gt;&gt;<i> (again could be a bunch of zeroes), and while we spawn those copies,
</I>&gt;&gt;<i> wait just long enough for the connection to start, then kill the client
</I>&gt;&gt;<i> process externally (equivalent of kill -9 proc).... And then just have
</I>&gt;&gt;<i> this whole spawn and kill thing in a loop until it fails.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> One way to send lots of zeroes or whatever, would be to send a string,
</I>&gt;&gt;<i> but before we send that string, continually append to that string in a
</I>&gt;&gt;<i> loop so it becomes very long..
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What do you think?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Rob
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 06/28/2012 06:35 PM, shahbour wrote:
</I>&gt;&gt;&gt;<i> <A HREF="http://mono.1490590.n4.nabble.com/file/n4650235/TestWCFServer.zip">http://mono.1490590.n4.nabble.com/file/n4650235/TestWCFServer.zip</A>
</I>&gt;&gt;&gt;<i> TestWCFServer.zip
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hello Rob
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I am attaching a simple application to demonstrate the error we are
</I>&gt;&gt;&gt;<i> getting.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Unfortunately using the above example the server is not crashing but
</I>&gt;&gt;&gt;<i> still
</I>&gt;&gt;&gt;<i> it raise the error (note that in my live app , some time it do the same
</I>&gt;&gt;&gt;<i> but
</I>&gt;&gt;&gt;<i> crash more)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If you run the server like below you will notice the error
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> mono --debug --trace=N:nothing TestWCFServer.exe
</I>&gt;&gt;&gt;<i> Press enter to exit
</I>&gt;&gt;&gt;<i> [0xb0a7d000:] EXCEPTION handling: System.Net.Sockets.SocketException:
</I>&gt;&gt;&gt;<i> Connection reset by peer
</I>&gt;&gt;&gt;<i> [0xb0a7d000:] EXCEPTION handling: System.IO.IOException: EndRead failure
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> To run the example just start the server , then start the client and
</I>&gt;&gt;&gt;<i> before
</I>&gt;&gt;&gt;<i> getting the result back from server close it (Ctrl+C)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I put a delay in the server to demonstrate the request over internet
</I>&gt;&gt;&gt;<i> and to
</I>&gt;&gt;&gt;<i> have time to close it. After you close it by small time the application
</I>&gt;&gt;&gt;<i> will
</I>&gt;&gt;&gt;<i> raise the above error .
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Tomorrow I will change the client to a silver light application to
</I>&gt;&gt;&gt;<i> simulate
</I>&gt;&gt;&gt;<i> exactly my application because the server crash approximately every
</I>&gt;&gt;&gt;<i> time I
</I>&gt;&gt;&gt;<i> close the browser before getting the result in my live example.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> BR
</I>&gt;&gt;&gt;<i> Shahbour
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> View this message in context:
</I>&gt;&gt;&gt;<i>
</I><A HREF="http://mono.1490590.n4.nabble.com/WCF-Fail-with-System-Net-Sockets-Socket">http://mono.1490590.n4.nabble.com/WCF-Fail-with-System-Net-Sockets-Socket</A>
&gt;&gt;&gt;<i> Exception-Connection-reset-by-peer-tp4650173p4650235.html
</I>&gt;&gt;&gt;<i> Sent from the Mono - Dev mailing list archive at Nabble.com.
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org/">http://enigmail.mozdev.org/</A>

iF4EAREIAAYFAk/uAw4ACgkQcefeIla2m80pagD/VfovrNfU4IyB0P0i2ExarMOH
xfI+KsLTh3dKI2mJhkwA/jF+DqVbbKI2GiCTZbaluEgEZfTJksBe+LwdhM8zGnsJ
=xZUa
-----END PGP SIGNATURE-----

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039292.html">[Mono-dev] WCF Fail with System.Net.Sockets.SocketException: Connection reset by peer
</A></li>
	<LI>Next message: <A HREF="039291.html">[Mono-dev] WCF Fail with System.Net.Sockets.SocketException: Connection reset by peer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39293">[ date ]</a>
              <a href="thread.html#39293">[ thread ]</a>
              <a href="subject.html#39293">[ subject ]</a>
              <a href="author.html#39293">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
