<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono runtime on ARM920t with many assertions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Mono%20runtime%20on%20ARM920t%20with%20many%20assertions&In-Reply-To=%3C4FC8AB0F.103%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038922.html">
   <LINK REL="Next"  HREF="038924.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono runtime on ARM920t with many assertions</H1>
    <B>Rob Wilkens</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Mono%20runtime%20on%20ARM920t%20with%20many%20assertions&In-Reply-To=%3C4FC8AB0F.103%40gmail.com%3E"
       TITLE="[Mono-dev] Mono runtime on ARM920t with many assertions">robwilkens at gmail.com
       </A><BR>
    <I>Fri Jun  1 11:44:15 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="038922.html">[Mono-dev] Mono runtime on ARM920t with many assertions
</A></li>
        <LI>Next message: <A HREF="038924.html">[Mono-dev] Mono runtime on ARM920t with many assertions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38923">[ date ]</a>
              <a href="thread.html#38923">[ thread ]</a>
              <a href="subject.html#38923">[ subject ]</a>
              <a href="author.html#38923">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I don't have a similar failure with the same version as build by the 
debian package that ubuntu ships with (which is the same version 
2.10.8.1)....  But i'm on a different platform i believe (x86-64).

I looked at the ubuntu source, and it appears to be failing here for you:
  g_return_val_if_fail (hash != NULL, FALSE);

In Line 293 it's at method:
g_hash_table_lookup_extended (GHashTable *hash, gconstpointer key, 
gpointer *orig_key, gpointer *value)

In line 236 it's at method:
g_hash_table_insert_replace (GHashTable *hash, gpointer key, gpointer 
value, gboolean replace)

You could try to debug that with gdb or something, but It looks like 
eglib (from the README in that directory) is a compatible glib that is 
built separately and not always installed except under conditions where 
novell needs a custom glib that is compatible with the regular glib but 
under a different license.  Is there a reason you are using eglib?  Is 
the regular glib not installed?  Maybe try instead apt-get source 
libglib2.0-dev and build and install that instead?  (and don't use eglib 
unless necessary?)



On 06/01/2012 06:29 AM, Dennis Krzyzaniak wrote:
&gt;<i>
</I>&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I am trying to get Mono running on a spider III device including an 
</I>&gt;<i> ARM920t processor with Linux as OS.
</I>&gt;<i>
</I>&gt;<i> /host $ uname -a
</I>&gt;<i>
</I>&gt;<i> Linux Spider-III 2.6.17.3-axo-s07.2 #1425 Fri Jul 25 10:59:30 CEST 
</I>&gt;<i> 2008 armv4tl unknown
</I>&gt;<i>
</I>&gt;<i> When I try to invoke a simple hello_world.exe I get 399 assertions in 
</I>&gt;<i> eglib (always the same asserts):
</I>&gt;<i>
</I>&gt;<i> /host $ ./mono hello_world.exe
</I>&gt;<i>
</I>&gt;<i> ../../../../eglib/src/ghashtable.c:293: assertion 'hash != NULL' failed
</I>&gt;<i>
</I>&gt;<i> ../../../../eglib/src/ghashtable.c:236: assertion 'hash != NULL' failed
</I>&gt;<i>
</I>&gt;<i> ../../../../eglib/src/ghashtable.c:293: assertion 'hash != NULL' failed
</I>&gt;<i>
</I>&gt;<i> ../../../../eglib/src/ghashtable.c:236: assertion 'hash != NULL' failed
</I>&gt;<i>
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> The 'Hello World' is also displayed:
</I>&gt;<i>
</I>&gt;<i> ../../../../eglib/src/ghashtable.c:293: assertion 'hash != NULL' failed
</I>&gt;<i>
</I>&gt;<i> ../../../../eglib/src/ghashtable.c:236: assertion 'hash != NULL' failed
</I>&gt;<i>
</I>&gt;<i> Hello World../../../../eglib/src/ghashtable.c:293: assertion 'hash != 
</I>&gt;<i> NULL' failed
</I>&gt;<i>
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> The hello world code:
</I>&gt;<i>
</I>&gt;<i> using System;
</I>&gt;<i>
</I>&gt;<i> namespace foobar {
</I>&gt;<i>
</I>&gt;<i>    public class foo {
</I>&gt;<i>
</I>&gt;<i>       public static void Main(string[] args) {
</I>&gt;<i>
</I>&gt;<i>          Console.WriteLine(&quot;Hello World&quot;);
</I>&gt;<i>
</I>&gt;<i>       }
</I>&gt;<i>
</I>&gt;<i>    }
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> I am absolutely new to Mono and completely lost with this behavior. 
</I>&gt;<i> Maybe someone knows the reason or can point me to a direction to find 
</I>&gt;<i> the issue?
</I>&gt;<i>
</I>&gt;<i> I attached a trace (./mono --trace hello_world.exe), maybe this helps? 
</I>&gt;<i> The trace is cut to fit into this mail, please let me know if a full 
</I>&gt;<i> trace is needed.
</I>&gt;<i>
</I>&gt;<i> I am using the debian source package of Mono 2_10_8.1-1 because in the 
</I>&gt;<i> official release a unittest fails.
</I>&gt;<i>
</I>&gt;<i> To get Mono build with the 'old' ARM  toolchain provided by the vendor 
</I>&gt;<i> I made a few changes in the project please see below.
</I>&gt;<i>
</I>&gt;<i> I am calling configure with the following parameters:
</I>&gt;<i>
</I>&gt;<i> configure  --build=i686-pc-linux-gnu --host=arm-axotec-linux-gnu 
</I>&gt;<i> LD=arm-axotec-linux-gnu-ld OBJDUMP=arm-axotec-linux-gnu-objdump 
</I>&gt;<i> --prefix=/host --disable-mcs-build --srcdir=../..
</I>&gt;<i>
</I>&gt;<i> configure.in:
</I>&gt;<i>
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> +dnl
</I>&gt;<i>
</I>&gt;<i> +dnl BEGIN Conworx Spider III ARMv4t settings
</I>&gt;<i>
</I>&gt;<i> +dnl there are already arm-*-linux* settings below but the place is to 
</I>&gt;<i> late, checks which
</I>&gt;<i>
</I>&gt;<i> +dnl tested before fails. So I added my specific stuff here without 
</I>&gt;<i> changing the old
</I>&gt;<i>
</I>&gt;<i> +dnl settings.
</I>&gt;<i>
</I>&gt;<i> +dnl
</I>&gt;<i>
</I>&gt;<i> +if test &quot;x$host&quot; = &quot;xarm-axotec-linux-gnu&quot;; then
</I>&gt;<i>
</I>&gt;<i> +dnl looks like this are all needed settings, the rest is redundant.
</I>&gt;<i>
</I>&gt;<i> +  TARGET=ARM;
</I>&gt;<i>
</I>&gt;<i> +  cross_compiling=yes
</I>&gt;<i>
</I>&gt;<i> +  dnl which defines are needed? just copied some
</I>&gt;<i>
</I>&gt;<i> +  dnl CPPFLAGS=&quot;$CPPFLAGS -DGC_LINUX_THREADS -D_GNU_SOURCE 
</I>&gt;<i> -D_REENTRANT -DARM_FPU_NONE -D__ARM_EABI__&quot;
</I>&gt;<i>
</I>&gt;<i> +  CPPFLAGS=&quot;$CPPFLAGS -D_GNU_SOURCE -D_REENTRANT -DARM_FPU_NONE 
</I>&gt;<i> -mcpu=arm920t -D__ARM_ARCH_4__&quot;
</I>&gt;<i>
</I>&gt;<i> +  CPPFLAGS=&quot;$CPPFLAGS -DNO_THUMB2_INSTRUCTIONS&quot;
</I>&gt;<i>
</I>&gt;<i> +  arch_target=arm;
</I>&gt;<i>
</I>&gt;<i> +  ACCESS_UNALIGNED=&quot;no&quot;
</I>&gt;<i>
</I>&gt;<i> +  JIT_SUPPORTED=yes
</I>&gt;<i>
</I>&gt;<i> +  jit_wanted=true
</I>&gt;<i>
</I>&gt;<i> +  sgen_supported=true
</I>&gt;<i>
</I>&gt;<i> +  dnl Can't use tls, since it depends on the runtime detection of tls 
</I>&gt;<i> offsets
</I>&gt;<i>
</I>&gt;<i> +  dnl  in mono-compiler.h
</I>&gt;<i>
</I>&gt;<i> +  libgc_threads=pthreads
</I>&gt;<i>
</I>&gt;<i> +  with_tls=pthread
</I>&gt;<i>
</I>&gt;<i> +  use_sigposix=yes
</I>&gt;<i>
</I>&gt;<i> +  dnl Enable support for using sigaltstack for SIGSEGV and
</I>&gt;<i>
</I>&gt;<i> +  dnl stack overflow handling (TODO not sure if it works on my arm)
</I>&gt;<i>
</I>&gt;<i> +  with_sigaltstack=no
</I>&gt;<i>
</I>&gt;<i> +  dnl to bypass the underscore linker check, can't work when 
</I>&gt;<i> cross-compiling
</I>&gt;<i>
</I>&gt;<i> +  mono_cv_uscore=yes
</I>&gt;<i>
</I>&gt;<i> +  dnl support ahead of time compilation
</I>&gt;<i>
</I>&gt;<i> +  AOT_SUPPORTED=&quot;yes&quot;
</I>&gt;<i>
</I>&gt;<i> +  libdl=&quot;-ldl&quot;
</I>&gt;<i>
</I>&gt;<i> +  dnl I need some define to enable my hacks oO
</I>&gt;<i>
</I>&gt;<i> +  AC_DEFINE(PLATFORM_AXOTEC_LINUX,1,[Targeting axotec linux on arm920t])
</I>&gt;<i>
</I>&gt;<i> +fi
</I>&gt;<i>
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> +# Added LT_OUTPUT to generate libtool script by config.lt before 
</I>&gt;<i> calling it.
</I>&gt;<i>
</I>&gt;<i> +LT_OUTPUT
</I>&gt;<i>
</I>&gt;<i> export_ldflags=`(./libtool --config; echo eval echo 
</I>&gt;<i> \\$export_dynamic_flag_spec) | sh`
</I>&gt;<i>
</I>&gt;<i> AC_SUBST(export_ldflags)
</I>&gt;<i>
</I>&gt;<i> +dnl the check for cross compiling is included in the mono release but 
</I>&gt;<i> removed
</I>&gt;<i>
</I>&gt;<i> +dnl in the debian source package because for the debian distribution 
</I>&gt;<i> no cross
</I>&gt;<i>
</I>&gt;<i> +dnl compiling is used.
</I>&gt;<i>
</I>&gt;<i> +if test ${TARGET} = ARM &amp;&amp; test x$cross_compiling = xno; then
</I>&gt;<i>
</I>&gt;<i>    dnl ******************************************
</I>&gt;<i>
</I>&gt;<i>    dnl *** Check to see what FPU is available ***
</I>&gt;<i>
</I>&gt;<i>    dnl ******************************************
</I>&gt;<i>
</I>&gt;<i> mono/metadata/sgen-archdep.h:
</I>&gt;<i>
</I>&gt;<i> /* We dont store ip, sp */
</I>&gt;<i>
</I>&gt;<i> #define ARCH_NUM_REGS 14
</I>&gt;<i>
</I>&gt;<i> +/* arm920t does not support thumb2 instructions */
</I>&gt;<i>
</I>&gt;<i> +#if !defined (NO_THUMB2_INSTRUCTIONS)
</I>&gt;<i>
</I>&gt;<i> +/* THUMB2 instuctions */
</I>&gt;<i>
</I>&gt;<i> #define ARCH_STORE_REGS(ptr)    \
</I>&gt;<i>
</I>&gt;<i>    __asm__ __volatile__(         \
</I>&gt;<i>
</I>&gt;<i>       &quot;push {lr}\n&quot;           \
</I>&gt;<i>
</I>&gt;<i> @@ -145,6 +148,17 @@
</I>&gt;<i>
</I>&gt;<i>       :                    \
</I>&gt;<i>
</I>&gt;<i>       : &quot;r&quot; (ptr)             \
</I>&gt;<i>
</I>&gt;<i>    )
</I>&gt;<i>
</I>&gt;<i> +#else /* NO_THUMB2_INSTRUCTIONS */
</I>&gt;<i>
</I>&gt;<i> +/* ARM instuctions */
</I>&gt;<i>
</I>&gt;<i> +#define ARCH_STORE_REGS(ptr) \
</I>&gt;<i>
</I>&gt;<i> +   __asm__ __volatile__( \
</I>&gt;<i>
</I>&gt;<i> +         &quot;stmfd sp!, {lr}\n&quot; \
</I>&gt;<i>
</I>&gt;<i> +         &quot;mov lr, %0\n&quot; \
</I>&gt;<i>
</I>&gt;<i> +         &quot;stmia lr!, {r0-r12}\n&quot; \
</I>&gt;<i>
</I>&gt;<i> +         &quot;ldmfd sp!, {lr}\n&quot; \
</I>&gt;<i>
</I>&gt;<i> +         : \
</I>&gt;<i>
</I>&gt;<i> +         : &quot;r&quot; (ptr))
</I>&gt;<i>
</I>&gt;<i> +#endif /* NO_THUMB2_INSTRUCTIONS */
</I>&gt;<i>
</I>&gt;<i> mono/mini/jit-icalls.c:
</I>&gt;<i>
</I>&gt;<i> #if defined(__arm__) &amp;&amp; MONO_ARCH_SOFT_FLOAT
</I>&gt;<i>
</I>&gt;<i> +#if defined (PLATFORM_AXOTEC_LINUX)
</I>&gt;<i>
</I>&gt;<i> +   /* ULLONG_MAX is not defined, just define here the max size of an 
</I>&gt;<i> unsigend
</I>&gt;<i>
</I>&gt;<i> +    * long long int. */
</I>&gt;<i>
</I>&gt;<i> +#ifndef ULLONG_MAX
</I>&gt;<i>
</I>&gt;<i> +#define ULLONG_MAX   18446744073709551615ULL
</I>&gt;<i>
</I>&gt;<i> +#endif /* !ULLONG_MAX */
</I>&gt;<i>
</I>&gt;<i> +#endif /* PLATFORM_AXOTEC_LINUX */
</I>&gt;<i>
</I>&gt;<i>    if (isnan (v) || !(v &gt;= -0.5 &amp;&amp; v &lt;= ULLONG_MAX+0.5)) {
</I>&gt;<i>
</I>&gt;<i>       mono_raise_exception (mono_get_exception_overflow ());
</I>&gt;<i>
</I>&gt;<i> Would be great to get some help!
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i>
</I>&gt;<i> Dennis Krzyzaniak
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120601/55564a2d/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20120601/55564a2d/attachment-0001.html</A>&gt;
</PRE>














































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038922.html">[Mono-dev] Mono runtime on ARM920t with many assertions
</A></li>
	<LI>Next message: <A HREF="038924.html">[Mono-dev] Mono runtime on ARM920t with many assertions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38923">[ date ]</a>
              <a href="thread.html#38923">[ thread ]</a>
              <a href="subject.html#38923">[ subject ]</a>
              <a href="author.html#38923">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
