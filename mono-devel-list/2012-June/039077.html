<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] .net winforms and windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20.net%20winforms%20and%20windows&In-Reply-To=%3C4FD90FE9.9070407%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039076.html">
   <LINK REL="Next"  HREF="039079.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] .net winforms and windows</H1>
    <B>Rob Wilkens</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20.net%20winforms%20and%20windows&In-Reply-To=%3C4FD90FE9.9070407%40gmail.com%3E"
       TITLE="[Mono-dev] .net winforms and windows">robwilkens at gmail.com
       </A><BR>
    <I>Wed Jun 13 22:10:49 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="039076.html">[Mono-dev] .net winforms and windows
</A></li>
        <LI>Next message: <A HREF="039079.html">[Mono-dev] .net winforms and windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39077">[ date ]</a>
              <a href="thread.html#39077">[ thread ]</a>
              <a href="subject.html#39077">[ subject ]</a>
              <a href="author.html#39077">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Ok - My fault.  I referred to .NET as the technology, not the version of 
its implementation.  I'll try to refer to either Windows.NET or 
Microsoft.NET when i specifically mean microsoft's implementation.

I'm torn as to whether or not to re-open my pull request right away or 
not.  The sample in the bug report code is freezing trying to create a 
window in the second thread, which we established yesterday is against 
mono design for winforms.

My sample code does not do that, but it is occasionally crashing in 
areas where invoke is being used on windows mono.

-Rob

On 06/13/2012 05:45 PM, Stifu wrote:
&gt;<i> &quot;My test code (attached) runs fine in Windows .net, doesn't crash once, and i
</I>&gt;<i> just ran it from the command prompt about 30-40 times in a row in .net.  So
</I>&gt;<i> that should run in mono, no?&quot;
</I>&gt;<i>
</I>&gt;<i> Yes, I was just confused by your original post: &quot;In my testing of .net
</I>&gt;<i> winforms on windows i received a lot of gdi+ object busy errors&quot;, which made
</I>&gt;<i> it sound like the errors were .NET ones.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Rob Wilkens wrote
</I>&gt;&gt;<i> [long story short: Got to troubleshoot some more, but the answer is that
</I>&gt;&gt;<i> these apps are functional in windows, attached a sample]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In Windows.NET it definitely works, both the code sample from the bug
</I>&gt;&gt;<i> report (which, incidentally, is not running for me right now, so i've
</I>&gt;&gt;<i> pulled back my pull request while i investigate, if i figure out why i
</I>&gt;&gt;<i> will reopen it, i haven't troubleshot that yet)..  My test code
</I>&gt;&gt;<i> (attached) runs fine in Windows .net, doesn't crash once, and i just ran
</I>&gt;&gt;<i> it from the command prompt about 30-40 times in a row in .net.  So that
</I>&gt;&gt;<i> should run in mono, no?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In unpatched mono in windows, my code leaves two windows open, and after
</I>&gt;&gt;<i> you close that it will say 'error' because the would-be assertions fail.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In mono with my patch, it passed, but it crashed every 5-10 runs,
</I>&gt;&gt;<i> unrelated, i beleive, to my patch but more to the rest of the code now
</I>&gt;&gt;<i> being run because of the patch.  Yesterday i was getting GDI+ Object
</I>&gt;&gt;<i> Busy, I can't reproduce that now, but that could be any number of things
</I>&gt;&gt;<i> such as timing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The crash I'm occasionally getting in my app now may have something to
</I>&gt;&gt;<i> do with the change in response to your message yesterday about needing
</I>&gt;&gt;<i> to call invoke (the form was created in thread 1, invoke is being called
</I>&gt;&gt;<i> in thread 3[the 2nd thread]).  But the form was shown with a call to
</I>&gt;&gt;<i> Application.Run(form2) in thread 2, because i couldn't figure another
</I>&gt;&gt;<i> easy way to make the application.run loop to exit on its own at the end
</I>&gt;&gt;<i> of execution (I tried several methods, none worked).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The crash I've traced twice to here (again in Windows .NET this does not
</I>&gt;&gt;<i> crash) using gdb:..
</I>&gt;&gt;<i> #8  0x02733612 in ?? ()
</I>&gt;&gt;<i> #9  0x027333c1 in ?? ()
</I>&gt;&gt;<i> #10 0x659cb7ac in mono_jit_runtime_invoke (method=0x5bee70, obj=0x2f709d8,
</I>&gt;&gt;<i>       params=0x393ff44, exc=0x0) at mini.c:5897
</I>&gt;&gt;<i> #11 0x65b235d2 in mono_runtime_invoke (method=0x5bee70, obj=0x2f709d8,
</I>&gt;&gt;<i>       params=0x393ff44, exc=0x0) at object.c:2809
</I>&gt;&gt;<i> #12 0x65b24237 in mono_runtime_delegate_invoke (delegate=0x2f709d8,
</I>&gt;&gt;<i>       params=0x393ff44, exc=0x0) at object.c:3489
</I>&gt;&gt;<i> #13 0x65b4ef76 in start_wrapper (data=0x2ff3d68) at threads.c:577
</I>&gt;&gt;<i> #14 0x65b7452a in inner_start_thread (arg=0x2ff3990)
</I>&gt;&gt;<i>     at mono-threads-windows.c:86
</I>&gt;&gt;<i> #15 0x7670339a in KERNEL32!BaseCleanupAppcompatCacheSupport ()
</I>&gt;&gt;<i>      from /cygdrive/c/Windows/syswow64/kernel32.dll
</I>&gt;&gt;<i> #16 0x02ff3990 in ?? ()
</I>&gt;&gt;<i> #17 0x770f9ef2 in ntdll!RtlpNtSetValueKey ()
</I>&gt;&gt;<i> ---Type&lt;return&gt;  to continue, or q&lt;return&gt;  to quit---ls ~
</I>&gt;&gt;<i>      from /cygdrive/c/Windows/system32/ntdll.dll
</I>&gt;&gt;<i> #18 0x02ff3990 in ?? ()
</I>&gt;&gt;<i> #19 0x770f9ec5 in ntdll!RtlpNtSetValueKey ()
</I>&gt;&gt;<i>      from /cygdrive/c/Windows/system32/ntdll.dll
</I>&gt;&gt;<i> #20 0x65b744e0 in mono_threads_platform_free ()
</I>&gt;&gt;<i>      from
</I>&gt;&gt;<i> /cygdrive/c/cygwin/home/RobWilkens/new-mono-local/bin/mono-2.0.dll
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But again, this doesn't seem to crash every or most times, and is
</I>&gt;&gt;<i> unrelated to my patch, only to my test.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> And i still have to first debug the original sample code..
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'll try to make sure my code sample and the sample from the bug report
</I>&gt;&gt;<i> work before i re-open my pull request.  Both run fine on Windows 7 with
</I>&gt;&gt;<i> MS .NET.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at .ximian</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/net-winforms-and-windows-tp4649922p4649928.html">http://mono.1490590.n4.nabble.com/net-winforms-and-windows-tp4649922p4649928.html</A>
</I>&gt;<i> Sent from the Mono - Dev mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
</PRE>


































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039076.html">[Mono-dev] .net winforms and windows
</A></li>
	<LI>Next message: <A HREF="039079.html">[Mono-dev] .net winforms and windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39077">[ date ]</a>
              <a href="thread.html#39077">[ thread ]</a>
              <a href="subject.html#39077">[ subject ]</a>
              <a href="author.html#39077">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
