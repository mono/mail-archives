<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] OracleClient.Oci and GC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20OracleClient.Oci%20and%20GC&In-Reply-To=%3CCFEEDBC0-226F-4EC5-8B21-504553390F06%40verizon.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041855.html">
   <LINK REL="Next"  HREF="041857.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] OracleClient.Oci and GC</H1>
    <B>Neale Ferguson</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20OracleClient.Oci%20and%20GC&In-Reply-To=%3CCFEEDBC0-226F-4EC5-8B21-504553390F06%40verizon.net%3E"
       TITLE="[Mono-dev] OracleClient.Oci and GC">NealeFerguson at verizon.net
       </A><BR>
    <I>Thu Aug 21 22:58:19 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="041855.html">[Mono-dev] Announcing &quot;Mono for Sailfish&quot;
</A></li>
        <LI>Next message: <A HREF="041857.html">[Mono-dev] OracleClient.Oci and GC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41856">[ date ]</a>
              <a href="thread.html#41856">[ thread ]</a>
              <a href="subject.html#41856">[ subject ]</a>
              <a href="author.html#41856">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been looking at OciDefineHandle and the OciDefineByPos call it uses in particular. Currently two of the parameters passed to this call are short variables. They are passed as &quot;ref&quot; fields as Oracle uses their address to put size and indicator data once the data is fetched. However, being defined as short means that they are eligible for being moved during garbage collection. Thus if that field is moved between the OciDefineByPos call and the fetch of the data then what Oracle is pointing to may no longer be variable. I'm thinking it may be better to define these fields as IntPtr and allocate them and retrieve their values via Marshal.ReadInt16. I'm currently testing these changes and so far I'm not getting the failures I had been encountering. If this is a valid analysis then the OciBindxxxx calls will also need attention as it uses a ref indp parameter as well - these appear to be used in OracleParameter.cs. 

Neale
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041855.html">[Mono-dev] Announcing &quot;Mono for Sailfish&quot;
</A></li>
	<LI>Next message: <A HREF="041857.html">[Mono-dev] OracleClient.Oci and GC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41856">[ date ]</a>
              <a href="thread.html#41856">[ thread ]</a>
              <a href="subject.html#41856">[ subject ]</a>
              <a href="author.html#41856">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
