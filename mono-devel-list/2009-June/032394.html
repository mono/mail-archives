<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] PATH: PostgreSQL Linq2Sql provider fix
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20PATH%3A%20PostgreSQL%20Linq2Sql%20provider%20fix&In-Reply-To=1244794757.4477.6.camel%40erin">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032392.html">
   <LINK REL="Next"  HREF="032395.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] PATH: PostgreSQL Linq2Sql provider fix</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20PATH%3A%20PostgreSQL%20Linq2Sql%20provider%20fix&In-Reply-To=1244794757.4477.6.camel%40erin"
       TITLE="[Mono-dev] PATH: PostgreSQL Linq2Sql provider fix">jonpryor at vt.edu
       </A><BR>
    <I>Fri Jun 12 09:32:07 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032392.html">[Mono-dev] PATH: PostgreSQL Linq2Sql provider fix
</A></li>
        <LI>Next message: <A HREF="032395.html">[Mono-dev] PATH: PostgreSQL Linq2Sql provider fix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32394">[ date ]</a>
              <a href="thread.html#32394">[ thread ]</a>
              <a href="subject.html#32394">[ subject ]</a>
              <a href="author.html#32394">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2009-06-12 at 10:19 +0200, Federico Di Gregorio wrote:
&gt;<i> Currently it is impossible to use the DbLinqProvider  and
</I>&gt;<i> DbLinqConnectionType connection parameters with PostgreSQL because
</I>&gt;<i> Npgsql does not like extra aguments. The attached patch fixes this.
</I>
Four comments.

1. It would likely be easier to integrate if you worked against upstream
DbLinq, if at all possible.

	<A HREF="http://code.google.com/p/dblinq2007/source/checkout">http://code.google.com/p/dblinq2007/source/checkout</A>

2. The resulting behavior of Vendor.CreateDbConnection() is broken.  If
the connection string contains only DbLinqProvider but not
DbLinqConnectionType, it'll use the DbLinqProvider value as the
DbLinqConnectionType value.  This isn't bad, necessarily, though it will
result in a confusing error message (complaining about
DbLinqConnectionType when it isn't present).

The worse behavior is that if *both* DbLinqConnectionType and
DbLinqProvider are specified, the regex will extract the *first* one
specified.  Given a connection string of:

	DbLinqProvider=PostgreSQL; DbLinqConnectionType=SomeType

it will try to use PostgreSQL as the ConnectionType, NOT SomeType, which
will be wrong.

3. My bigger problem is a conceptual one.  Usually it is preferable for
the code that is parsing for a given parameter to remove it (if
necessary), so that the entire code base doesn't need to be known to
understand a local method.

Specifically, I'm leery about Vendor needing to know about -- and remove
-- the DbLinqProvider parameter, as Vendor doesn't actually care about
that parameter (DbLinqProvider is needed in order to get the Vendor in
the first place).  If we add additional DbLinq parameters in the future,
it means that we'll need to modify Vendor again as well, further
spreading the logic for handling the parameter throughout the code base.

Consequently, I would far prefer that the DbLinqProvider removal code be
within DataContext, as that's where the parameter is searched for and
used.

4. You should add unit tests to check the removal logic
to .../src/DbLinq/Test/DataContextTest.cs, which also contains other
tests for DbLinqConnectionType behavior.

 - Jon


</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032392.html">[Mono-dev] PATH: PostgreSQL Linq2Sql provider fix
</A></li>
	<LI>Next message: <A HREF="032395.html">[Mono-dev] PATH: PostgreSQL Linq2Sql provider fix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32394">[ date ]</a>
              <a href="thread.html#32394">[ thread ]</a>
              <a href="subject.html#32394">[ subject ]</a>
              <a href="author.html#32394">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
