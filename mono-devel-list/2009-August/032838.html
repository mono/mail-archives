<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] .NET / Mono runtime multi-cast differences.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20.NET%20/%20Mono%20runtime%20multi-cast%20differences.&In-Reply-To=117799f00908240056t4af8dd7ahe6b464c4123b8a7e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032836.html">
   <LINK REL="Next"  HREF="032835.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] .NET / Mono runtime multi-cast differences.</H1>
    <B>James P Michels III</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20.NET%20/%20Mono%20runtime%20multi-cast%20differences.&In-Reply-To=117799f00908240056t4af8dd7ahe6b464c4123b8a7e%40mail.gmail.com"
       TITLE="[Mono-dev] .NET / Mono runtime multi-cast differences.">james.p.michels at gmail.com
       </A><BR>
    <I>Mon Aug 24 08:54:02 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032836.html">[Mono-dev] .NET / Mono runtime multi-cast differences.
</A></li>
        <LI>Next message: <A HREF="032835.html">[Mono-dev] Cross platform USB programming
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32838">[ date ]</a>
              <a href="thread.html#32838">[ thread ]</a>
              <a href="subject.html#32838">[ subject ]</a>
              <a href="author.html#32838">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The central problem is described in the sentence &quot;Unless the Socket.Bind
operation is modified to bind to a different end
point based on the runtime, no packets will be received.&quot;

The meaning of listenChannel and listenEndpoint can be inferred from
their use in subsequent statements, but for sake of clarity, I should
have explained them better.

listenChannel = An end point containing the multicast address / port
combination which you are interested in joining / subscribing to.
listenEndpoint = An end point containing the interface address /
multicast port combination of the network interface on which you would
like to receive the packets.

Thanks
Jim

Alan McGovern wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Unless I'm missing something, you haven't actually described what the
</I>&gt;<i> problem is. Nor have you mentioned what exactly happens on windows,
</I>&gt;<i> what happens on linux and what you actually expected to happen. Your
</I>&gt;<i> example also appears to be missing information which might help figure
</I>&gt;<i> out what issue it is you're seeing, what are listenChannel and
</I>&gt;<i> listenEndpoint?
</I>&gt;<i>
</I>&gt;<i> Alan.
</I>&gt;<i>
</I>&gt;<i> On Mon, Aug 24, 2009 at 3:20 AM, James P Michels III
</I>&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">james.p.michels at gmail.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">james.p.michels at gmail.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     I have observed a difference in behavior between the Mono runtime and
</I>&gt;<i>     .NET runtime with respect to multi-cast support.
</I>&gt;<i>
</I>&gt;<i>     Unless the Socket.Bind operation is modified to bind to a
</I>&gt;<i>     different end
</I>&gt;<i>     point based on the runtime, no packets will be received. The
</I>&gt;<i>     workaround
</I>&gt;<i>     that I am using is shown in the attached code section.
</I>&gt;<i>
</I>&gt;<i>     I took a look at Mono's source code. Additionally, I wrote a short C
</I>&gt;<i>     program with the equivalent functionality. The C version for Linux
</I>&gt;<i>     exhibits the same behavior. It is my impression that the behavior
</I>&gt;<i>     is due
</I>&gt;<i>     to differences between the Windows socket implementation and the Linux
</I>&gt;<i>     socket implementation. It is also my impression that these differences
</I>&gt;<i>     are being realized by both the .NET and Mono runtime which ultimately
</I>&gt;<i>     consume them.
</I>&gt;<i>
</I>&gt;<i>     I have 2 questions.
</I>&gt;<i>
</I>&gt;<i>     1) Am I wrong? Is there a runtime agnostic way to do this? (Binding to
</I>&gt;<i>     IPAddress.Any does not work on Windows to my knowledge)
</I>&gt;<i>
</I>&gt;<i>     2) If I am not wrong, what steps, if any, should be taken to resolve
</I>&gt;<i>     these differences?
</I>&gt;<i>
</I>&gt;<i>     Thanks
</I>&gt;<i>     Jim
</I>&gt;<i>
</I>&gt;<i>     ---------begin code sample------------
</I>&gt;<i>
</I>&gt;<i>            listenSocket = new Socket(AddressFamily.InterNetwork,
</I>&gt;<i>     SocketType.Dgram, ProtocolType.Udp);
</I>&gt;<i>            listenSocket.SetSocketOption(SocketOptionLevel.Socket,
</I>&gt;<i>     SocketOptionName.ReuseAddress, true);
</I>&gt;<i>
</I>&gt;<i>            if (IsMonoRuntime())
</I>&gt;<i>            {
</I>&gt;<i>                listenSocket.Bind(listenChannel);
</I>&gt;<i>            }
</I>&gt;<i>            else
</I>&gt;<i>            {
</I>&gt;<i>                listenSocket.Bind(listenEndpoint);
</I>&gt;<i>            }
</I>&gt;<i>
</I>&gt;<i>            listenSocket.SetSocketOption(SocketOptionLevel.IP,
</I>&gt;<i>     SocketOptionName.MulticastInterface,
</I>&gt;<i>     listenInterface.GetAddressBytes());
</I>&gt;<i>            listenSocket.SetSocketOption(SocketOptionLevel.IP,
</I>&gt;<i>     SocketOptionName.AddMembership, new
</I>&gt;<i>     MulticastOption(listenChannel.Address, listenInterface));
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     ---------end code sample------------
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     Mono-devel-list mailing list
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032836.html">[Mono-dev] .NET / Mono runtime multi-cast differences.
</A></li>
	<LI>Next message: <A HREF="032835.html">[Mono-dev] Cross platform USB programming
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32838">[ date ]</a>
              <a href="thread.html#32838">[ thread ]</a>
              <a href="subject.html#32838">[ subject ]</a>
              <a href="author.html#32838">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
