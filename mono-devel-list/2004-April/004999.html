<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Proposal: Library Loading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Proposal%3A%20Library%20Loading&In-Reply-To=20040414112840.GB5921%40debian.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004990.html">
   <LINK REL="Next"  HREF="004996.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Proposal: Library Loading</H1>
    <B>Michal Moskal</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Proposal%3A%20Library%20Loading&In-Reply-To=20040414112840.GB5921%40debian.org"
       TITLE="[Mono-devel-list] Proposal: Library Loading">malekith at pld-linux.org
       </A><BR>
    <I>Wed Apr 14 13:20:31 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="004990.html">[Mono-devel-list] Proposal: Library Loading
</A></li>
        <LI>Next message: <A HREF="004996.html">[Mono-devel-list] Proposal: Library Loading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4999">[ date ]</a>
              <a href="thread.html#4999">[ thread ]</a>
              <a href="subject.html#4999">[ subject ]</a>
              <a href="author.html#4999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Apr 14, 2004 at 01:28:40PM +0200, Paolo Molaro wrote:
&gt;<i> &gt; &gt; The benefit is that Mono only needs to open *one* configuration file
</I>&gt;<i> &gt; &gt; instead of having to get a directory listing, and load multiple files,
</I>&gt;<i> &gt; &gt; which impacts startup time. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Premature optmization is root of all evil :-)
</I>&gt;<i> [...]
</I>&gt;<i> &gt; I run this program against directory with 1000 small files. It took
</I>&gt;<i> &gt; 0.03s on my athlon box and 0.15s on Pentium 266 (with heavy load). Now
</I>&gt;<i> &gt; consider that you will have 50 not 1000 files there, so it will take
</I>&gt;<i> &gt; 1ms on modern box.  Nowhere near other startup costs.
</I>&gt;<i> 
</I>&gt;<i> That's no reason to add up to them, though:-) Especially when a
</I>&gt;<i> perfectly fine way of doing things doesn't need to. Also, your numbers
</I>&gt;<i> are with a warm cache 
</I>
Why should I use the cold cache? It will be hot after the first
application using mono starts, and will remain hot if there are more
such startups. The hot cache is simply the typical case when we care
about startup performance.

&gt;<i> and you don't consider the memory usage given by
</I>&gt;<i> loading the info from 50 configuration files when you either don't need
</I>&gt;<i> it at all or maybe just one.
</I>
I believe the memory requirements are no bigger then for single
configuration file. You just need to concatenate the files (using custom
file reading function for XML parser) and parse the result. Of course
spawning separate XML parser for each file would eat more memory.

Anyhow, there are two problems with separate program: a) it needs to be
written and maintained :-), b) you need to run it from %post script in
case of RPM (or whatever else for other packagers). These scripts are 
now empty, so packaging is a bit easier (no extra dependencies etc).

Having said all that, if there will be need to run gacutil from %post
anyway, then maybe it is possible to join mlibmap into gacutil, making
it simply GAC implementation detail. Maybe even there is no need for
separate .libmap files -- we can use custom attribute in assembly
itself.

BTW the generated file should not be kept in /etc, since users shall
not edit it.

-- 
:<i> Michal Moskal :: <A HREF="http://www.kernel.pl/~malekith">http://www.kernel.pl/~malekith</A> :: GCS !tv h e&gt;+++ b++
</I>:<i> When in doubt, use brute force. -- Ken Thompson :: UL++++$ C++ E--- a?
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004990.html">[Mono-devel-list] Proposal: Library Loading
</A></li>
	<LI>Next message: <A HREF="004996.html">[Mono-devel-list] Proposal: Library Loading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4999">[ date ]</a>
              <a href="thread.html#4999">[ thread ]</a>
              <a href="subject.html#4999">[ subject ]</a>
              <a href="author.html#4999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
