<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] asynchronous exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20asynchronous%20exceptions&In-Reply-To=200806181525.34297.bastian.schmitz%40udo.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028261.html">
   <LINK REL="Next"  HREF="028262.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] asynchronous exceptions</H1>
    <B>Konstantin Triger</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20asynchronous%20exceptions&In-Reply-To=200806181525.34297.bastian.schmitz%40udo.edu"
       TITLE="[Mono-dev] asynchronous exceptions">kostat at gmail.com
       </A><BR>
    <I>Wed Jun 18 12:09:43 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028261.html">[Mono-dev] asynchronous exceptions
</A></li>
        <LI>Next message: <A HREF="028262.html">[Mono-dev] asynchronous exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28263">[ date ]</a>
              <a href="thread.html#28263">[ thread ]</a>
              <a href="subject.html#28263">[ subject ]</a>
              <a href="author.html#28263">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/6/18 Bastian Schmitz &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bastian.schmitz at udo.edu</A>&gt;:

&gt;<i> Hello Kosta,
</I>&gt;<i> thanks for your reply. I asked myself again what I really need and arrived
</I>&gt;<i> at
</I>&gt;<i> the conclusion that resource leaks are not tolerable. You mentioned that a
</I>&gt;<i> reduction of the program's possibilities could result in safe &quot;hard&quot; abort.
</I>&gt;<i> What do I have to restrict or is this only a theoretical approach?
</I>

Consider the following code:
using (Stream s = FileStream.Create()) {
...
}

If you abort the thread just after the file handle is opened, but before
that function returned, the stream will remain opened. In some cases even
Finalizer won't close it. Thus you must restrict anything that may need
explicit disposing. (In general same is true even with lock statement. As
far I know MS CLR explicitly frees all the locks held by the aborted thread,
but I don't know how mono CLR behaves in this case).

Now consider this:

Object x = null;
try {
  x = new Something();
}
finally {
  x.Whatever();
}

If Something ctor never throws, normally, the user code will always run
without exceptions. Now you come and abort it inside Something ctor -&gt;
NullRef Exception is thrown!

So the generalization is that you must restrict usage of try/catch/finally
blocks. This will imply restriction on objects that need explicit disposing,
since without try/catch/finally blocks they cannot be correctly implemented.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I suppose i'd like the program to react to certain conditions with an
</I>&gt;<i> exception within a (preferably bounded) short amout of time. Of course this
</I>&gt;<i> assumes that scheduling and garbage collection are somehow playing along.
</I>

&gt;<i>
</I>&gt;<i> To use &quot;soft&quot; aborts and control points respectively in a thread, I
</I>&gt;<i> probably
</I>&gt;<i> have to make sure that no code is called that has either no control points
</I>&gt;<i> or
</I>&gt;<i> may take too long to complete. I suppose this also implies not using
</I>&gt;<i> blocking
</I>&gt;<i> functions (apart from those i can interrupt myself).
</I>

Agree. I think that if you will be able to inject very intelegenetly the
&quot;control points&quot;, you will be able to use &quot;hard&quot; aborts more often. For
example, you may add some special &quot;control points&quot; before and after each
try/catch/finally block, so they will specify entrance/exit to the &quot;unsafe
for hard abort&quot; area by setting some global flag.

Kosta


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Bastian Schmitz
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Wednesday 18 June 2008, you wrote:
</I>&gt;<i> &gt; Hello Bastian,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Eventually I would ask what kind of abortion you need &quot;soft&quot; or &quot;hard&quot;.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hard abortion means that it will happen regardless of what the thread is
</I>&gt;<i> &gt; doing and can be achieved using Thread.Abort(). It's considered unsafe
</I>&gt;<i> &gt; since it can lead to resource leaks. Note, that &quot;hard&quot; abort is
</I>&gt;<i> inherently
</I>&gt;<i> &gt; unsafe regardless of the platform you use (clr,java,native or whatever)
</I>&gt;<i> &gt; until you restrict the program possibilities.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  Soft abortion means that in some &quot;control points&quot; the thread itself
</I>&gt;<i> checks
</I>&gt;<i> &gt; for some condition and if it's not fullfilled &quot;soft&quot; aborts itself by
</I>&gt;<i> &gt; throwing an exception (for example). This kind of abortion is safe since
</I>&gt;<i> &gt; the thread controls in which points the condition is checked. In the same
</I>&gt;<i> &gt; time if the thread does not reach the control point, it won't be aborted.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You may consider &quot;hard&quot;, &quot;soft&quot; abortion or a combination of them (e.g.
</I>&gt;<i> &gt; soft and later hard after some timeout). For &quot;control points&quot; you may
</I>&gt;<i> &gt; consider using aspect oriented techniques.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hope this helps,
</I>&gt;<i> &gt; Kosta
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 2008/6/18 Bastian Schmitz &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bastian.schmitz at udo.edu</A>&gt;:
</I>&gt;<i> &gt; &gt; Hello list.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Within the scope of my diploma thesis, I am going to create a (or
</I>&gt;<i> extend
</I>&gt;<i> &gt; &gt; an existing) programming language (+compiler) for the control of
</I>&gt;<i> &gt; &gt; automated vehicles. Right now I am evaluating the use of mono as a
</I>&gt;<i> &gt; &gt; runtime platform.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I am planning to have a language element, which ensures that a given
</I>&gt;<i> &gt; &gt; condition
</I>&gt;<i> &gt; &gt; stays fulfilled during the execution of block of code. If the condition
</I>&gt;<i> &gt; &gt; is violated an exception should be risen. The condition is (probably)
</I>&gt;<i> &gt; &gt; going to be checked/evaluated by another thread, who should inform the
</I>&gt;<i> &gt; &gt; first one in case of violation of the condition.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; This pattern resembles to the asynchronous exception used by the
</I>&gt;<i> &gt; &gt; Thread.Abort() method being triggered by an external thread, catching
</I>&gt;<i> the
</I>&gt;<i> &gt; &gt; ThreadAbortException and canceling the abort afterwards.
</I>&gt;<i> &gt; &gt; I am wondering if there is a safe way to achieve this functionality
</I>&gt;<i> with
</I>&gt;<i> &gt; &gt; the
</I>&gt;<i> &gt; &gt; crl/mono runtime.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Best regards,
</I>&gt;<i> &gt; &gt; Bastian Schmitz
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Regards,
Konstantin Triger
RSS: <A HREF="http://feeds.feedburner.com/ktriger">http://feeds.feedburner.com/ktriger</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080618/e92c175d/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20080618/e92c175d/attachment.html</A> 
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028261.html">[Mono-dev] asynchronous exceptions
</A></li>
	<LI>Next message: <A HREF="028262.html">[Mono-dev] asynchronous exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28263">[ date ]</a>
              <a href="thread.html#28263">[ thread ]</a>
              <a href="subject.html#28263">[ subject ]</a>
              <a href="author.html#28263">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
