<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev]  gdal/mono/linux; Native bindings, PInvoke, and tracking TypeLoader exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%20gdal/mono/linux%3B%0A%20Native%20bindings%2C%20PInvoke%2C%20and%20tracking%20TypeLoader%20exceptions&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028124.html">
   <LINK REL="Next"  HREF="028126.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev]  gdal/mono/linux; Native bindings, PInvoke, and tracking TypeLoader exceptions</H1>
    <B>fevans</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%20gdal/mono/linux%3B%0A%20Native%20bindings%2C%20PInvoke%2C%20and%20tracking%20TypeLoader%20exceptions&In-Reply-To="
       TITLE="[Mono-dev]  gdal/mono/linux; Native bindings, PInvoke, and tracking TypeLoader exceptions">fevans at harris.com
       </A><BR>
    <I>Tue Jun  3 08:59:28 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028124.html">[Mono-dev] X509Certificate problem
</A></li>
        <LI>Next message: <A HREF="028126.html">[Mono-dev] [PATCH] Mono DTrace provider v2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28146">[ date ]</a>
              <a href="thread.html#28146">[ thread ]</a>
              <a href="subject.html#28146">[ subject ]</a>
              <a href="author.html#28146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
First I want to express how impressed I am with how well mono performs (both
speed and stability). 


I'm trying to get native bindings working for gdal 1.5.1  (or any version of
gdal) in Linux.  If anyone has knowledge of gdal/mono/linux bindings that
would be great.  

If not, then I suppose a general discussion of native bindings is the next
step.  I'm outside my comfort zone, and struggling to even phrase the
question. But here are my observations. When I compile gdal in linux it
creates libraries and executables such as: 

gdalconst_csharp.dll
gdal_csharp.dll
ogr_csharp.dll
osr_csharp.dll
GDALInfo.exe

So when I run the command 'mono GDALInfo.exe' it returns a usage statement.
no errors. But when I run 'mono GDALinfo.exe foo.tif', I get a type-loader
exception.

===================
ANALYSIS
===================
Each library has a dllmap config mapping. For anyone who is interested in
getting gdal to work in mono/linux I believe that the dllmap  generated by
the GNUMakefile has an error.  The build process generates the following...
&lt;dllmap dll=&quot;gdal_wrap&quot; target=&quot;libgdalcsharp.la&quot; &gt;

But this is missing the closing &quot;/&quot; for the Xml tag, so it should look like
this.
&lt;dllmap dll=&quot;gdal_wrap&quot; target=&quot;libgdalcsharp.la&quot; /&gt;

============================
?WHAT's MISSING?
============================
The build also creates gdal_wrap.lo, ogr_wrap.lo, etc. But it doesn't
produce a .so file for these, it doesn't produce a gdal_wrap.dll or a
dllmap. I'm pretty sure this is a problem, because those are the libraries
which contain the native bindings. At least, they do in Windows.

I tried creating gdal_wrap.so
gcc -shared -Wl,-soname,libgdal_wrap.so.1 -o libgdal_wrap.so.1.0.1 
gdal_wrap.o

It didn't help. 

I ran the command with 'mono -verbose'. See attached file.
<A HREF="http://www.nabble.com/file/p17622978/output3.txt">http://www.nabble.com/file/p17622978/output3.txt</A> output3.txt 


I ran the command 'mono-shlib-cop gdal_csharp.dll'. It produced the
following.

error: in OSGeo.GDAL.GdalPINVOKE.UseExceptions: Could not load library
`gdal_wrap': ./libgdal_wrap.so: cannot open shared object file: No such file
or directory
error: in OSGeo.GDAL.GdalPINVOKE.DontUseExceptions: Could not load library
`gdal_wrap': ./libgdal_wrap.so: cannot open shared object file: No such file
or directory
error: in OSGeo.GDAL.GdalPINVOKE.Debug: Could not load library `gdal_wrap':
./libgdal_wrap.so: cannot 



============================
CONCLUSIONS
============================
&gt;<i>From what I've read if the library is named properly (libgdal_wrap.so in
</I>linux, gdal_wrap.dll in windows), and if the file exists in the path (PATH
in Windows, LD_LIBRARY_PATH in Linux) the native bindings should work.

If anyone has advice on gdal, on native-bindings, or on tracking down
type-loader-exceptions help is appreciated. Thanks...

 
-- 
View this message in context: <A HREF="http://www.nabble.com/gdal-mono-linux--Native-bindings%2C-PInvoke%2C-and-tracking-TypeLoader-exceptions-tp17622978p17622978.html">http://www.nabble.com/gdal-mono-linux--Native-bindings%2C-PInvoke%2C-and-tracking-TypeLoader-exceptions-tp17622978p17622978.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028124.html">[Mono-dev] X509Certificate problem
</A></li>
	<LI>Next message: <A HREF="028126.html">[Mono-dev] [PATCH] Mono DTrace provider v2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28146">[ date ]</a>
              <a href="thread.html#28146">[ thread ]</a>
              <a href="subject.html#28146">[ subject ]</a>
              <a href="author.html#28146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
