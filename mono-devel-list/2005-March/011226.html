<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Memory management for long running processes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Memory%20management%20for%20long%20running%20processes&In-Reply-To=1112039156.5240.14.camel%40omega.maurer">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011223.html">
   <LINK REL="Next"  HREF="011227.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Memory management for long running processes</H1>
    <B>Alex Chudnovsky</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Memory%20management%20for%20long%20running%20processes&In-Reply-To=1112039156.5240.14.camel%40omega.maurer"
       TITLE="[Mono-devel-list] Memory management for long running processes">alexc at majestic12.co.uk
       </A><BR>
    <I>Mon Mar 28 15:19:58 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011223.html">[Mono-devel-list] Memory management for long running processes
</A></li>
        <LI>Next message: <A HREF="011227.html">[Mono-devel-list] Memory management for long running processes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11226">[ date ]</a>
              <a href="thread.html#11226">[ thread ]</a>
              <a href="subject.html#11226">[ subject ]</a>
              <a href="author.html#11226">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for quick response Ben. I was indeed using --profile command that 
generated nice list of calls to functions + memory usage. Am I correct 
thinking that default behavior of --profile would be to give combined 
data on memory usage during whole of runtime rather than max live usage? 
Come to think of that it would be strange for this tool to work 
otherwise as it gives only one snapshot which should contain combined 
totals. Therefore my conclusions over GC not willing to release memory 
based on profiler's output might not be correct.

Memory leaking issue however does appear to be present as app leaked 
memory so much that it locked up Linux box :-/

Your help would be much appreciated, you can get application here:

<A HREF="http://www.majestic12.co.uk/files/mj12node/mono/mj12node_mono_0987.tgz">http://www.majestic12.co.uk/files/mj12node/mono/mj12node_mono_0987.tgz</A>

Main executable is MJ12nodeMono.exe, once you run it you should see menu 
and you will need to start webserver (press S) and then use your browser 
to displayed webserver's address to configure a few parameters before 
software starts working. You will need to go to Options screen and 
register (only few details needed) and after you do this the node will 
start working and it leaks memory on at least one Linux box. It 
transpired that switching away from Mono.Data.SqliteClient to ADO.NET 
from SourceForge helped plug leaks, however it was still leaking.

I am currently engaged in discussion with people who try to run port of 
the app to Linux here <A HREF="http://www.majestic12.co.uk/forum/viewforum.php?f=6">http://www.majestic12.co.uk/forum/viewforum.php?f=6</A>
if you have any questions on how to setup software or any details about 
configs then please just post there -- thread about Linux's port is the 
longest we ever had :)

While we are on the subject I noticed that I was not able to determine 
amount of memory used by my process from the process itself using the 
following code that works fine on Windows but not on Linux:

        // returns memory used in MegaBytes
        public static int GetMemoryUsage()
        {
            return 
System.Diagnostics.Process.GetCurrentProcess().WorkingSet/(1024*1024);
        }

cheers,

Alex

-- 
regards,

Alex Chudnovsky
Majestic-12: Distributed Search Engine
<A HREF="http://www.majestic12.co.uk">http://www.majestic12.co.uk</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011223.html">[Mono-devel-list] Memory management for long running processes
</A></li>
	<LI>Next message: <A HREF="011227.html">[Mono-devel-list] Memory management for long running processes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11226">[ date ]</a>
              <a href="thread.html#11226">[ thread ]</a>
              <a href="subject.html#11226">[ subject ]</a>
              <a href="author.html#11226">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
