<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Possible Mono networking problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Possible%20Mono%20networking%20problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010774.html">
   <LINK REL="Next"  HREF="010776.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Possible Mono networking problem</H1>
    <B>Ronnie Holm</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Possible%20Mono%20networking%20problem&In-Reply-To="
       TITLE="[Mono-devel-list] Possible Mono networking problem">r_holmes at yahoo.com
       </A><BR>
    <I>Tue Mar  1 11:13:56 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010774.html">[Mono-devel-list] VTable &amp; Interfaces
</A></li>
        <LI>Next message: <A HREF="010776.html">[Mono-devel-list] [PATCH] Bug Fix for GetTickCount in WAPI IO Layer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10775">[ date ]</a>
              <a href="thread.html#10775">[ thread ]</a>
              <a href="subject.html#10775">[ subject ]</a>
              <a href="author.html#10775">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm writing a simple application in C# that logs into a Yahoo Mail account by 
simulating a browser. 

During the login process, it is redirected (through the http header) through a 
number of servers until it finally reaches the inbox, if successful. To each 
server it feeds the cookies received so far.

However, I can't get the login process to work with Mono (1.0.5, debian 
unstable). With .Net-runtime on Windows, it works perfectly.

If we look at the trace() output running the application on Windows, it 
reaches my inbox at step 14:

1: Logging into Yahoo Mail with username 'r_holmes' and password 'xxxx'
2: Opening 
'<A HREF="http://mail.yahoo.com/config/login?.intl=us&amp;.us=ym&amp;.tries=1&amp;.src=ym&amp;login=r_holmes&amp;passwd=xxxx'">http://mail.yahoo.com/config/login?.intl=us&amp;.us=ym&amp;.tries=1&amp;.src=ym&amp;login=r_holmes&amp;passwd=xxxx'</A>
3: UpdateCookieCollection()
4: No previous cookies stored. Store all cookies
5:    B 4fuqucl12920k&amp;b=2
6:    F a=J06ons0sva8HnAxcQd0gGflizzgSbIkvrjqtKkO_UelR1SmfYg.SzWz1NeVd&amp;b=_DjV
7:    Y v=1&amp;n=frfgoo6e3klnv&amp;l=h_7ebc4i/o&amp;p=m2evvdk013000000&amp;jb=16|23|
3&amp;ig=0f1kb&amp;iz=5932&amp;r=2d&amp;lg=us&amp;intl=us&amp;np=1
8:    T 
z=UgIJCBUmdJCBBifXWTwKl.iMjMxBjYzMTYxNE8xNw--&amp;a=QAE&amp;sk=DAAhBq4AhwE.1m&amp;d=c2wBTlRRMkFURTBOakUyTXpnMk1BLS0BYQFRQUUBaWcBVjNTVEJBAXRpcAFRZEtfaEQBenoBVWdJSkNCZ1dB
9: Redirecting to 
'<A HREF="http://login.yahoo.com/config/verify?.done=http%3a//us.f546.mail.yahoo.com/ym/login%3f.rand=01gj9h49dpaih'">http://login.yahoo.com/config/verify?.done=http%3a//us.f546.mail.yahoo.com/ym/login%3f.rand=01gj9h49dpaih'</A>
10: Setting up cookies to sent with the request
11: Opening 
'<A HREF="http://login.yahoo.com/config/verify?.done=http://us.f546.mail.yahoo.com/ym/login?.rand=01gj9h49dpaih'">http://login.yahoo.com/config/verify?.done=http://us.f546.mail.yahoo.com/ym/login?.rand=01gj9h49dpaih'</A>
12: Redirecting to 
'<A HREF="http://us.f546.mail.yahoo.com/ym/login?.rand=01gj9h49dpaih'">http://us.f546.mail.yahoo.com/ym/login?.rand=01gj9h49dpaih'</A>
13: Setting up cookies to sent with the request
14: Opening '<A HREF="http://us.f546.mail.yahoo.com/ym/login?.rand=01gj9h49dpaih'">http://us.f546.mail.yahoo.com/ym/login?.rand=01gj9h49dpaih'</A>
15: UpdateCookieCollection()
16:    Adding new key/value pair: 
'YM.Gen'/'i=vaJ46Ur8iCyUC6SohqziJVP0lrSkYKjdTmsYzl0doCY2i3KytxJ_HAyp6w7V.c98W1bFLdoH8iGPyhITUWD1wuAX_q2.1hYj4gEQ38OFhLh1mTwwK.Ylm.ZmUV_NPIyjjO74ehM_uuYUTNPQFWkpvNbMNte.Bfd98jAMYAjUbQYm_kFVlNAESrPdnINBKBULD1_zSe0.Q7OE.iI5WGhXBrrYlo0GN44ZcwK3t1v0P_5Ryl1MSiuxuzuFvByz1R4YQ0EJ3Y_BrJHAH6Jom0LbcdtPnstLOHShR6_bgAp_WHGZM8Aa8uMALYZNO7_t5ziChZD5eDy9EPEZMC725W_KIGJfyjmyRRaAwm_z5oWl3vTcyo7dM8K2OiHOmq7jybrbqK92bEJMQw1yhoywCa2i1725CWTyRF6FEvyQLcH3ETmOG7oIVStFQ5hhRvmW5bToznLdm62ddmz1Cg9o5p_7mT5Mwh18M78Ve9Gl3trJUSHknsKYTmsWNgb2WhOOuhDvChQ_X7IP4rek_vXhJ6QNyyAhGSzN5XuxP1pYZeFfH7VjXaSENOOsdagnyPE3Stvz.5JDWsigL.SHgCPdFprBCl7GWertr02iLBBic_0nd3NL8fGDlicXxz6MM4uyhtUolJKWg_BcQL_u.Axc3R190_njne4Ty4OdiH3JdxcHqqc8YMUxcHvz_jGjZ8v3qW5mmoJs.hguE9Fl4bi5cVvPfqtPOFATXLPqCH8Ue4_MK1pH9Bdg2D3Lj35qRTujPib_rqtTUKyb_tsDb6yGKwTO_ZxzI1WjG39j3cCNMSdVn4Dl7JRsl3cxUD.KQIwNuatBxiARtIx31gBPOKXSqO_iOW1Ki9H.E8gCckwQQl6zkPBxibd_FNslukBXiSiGa7BW66r_d7LEYeoiEtxsF7gWmmB_4GiU3eCThkTNmWFpJ4Pm430kDC_Q5j3gtPsOdeBDJbfiL0ILhC060d0mwP6bAbqBKv1n_go7OM0E9EeErxQhNv7W0S6T5NyphbU40AJ5sJkjvNi8yk9Kaq3rrRBnGjq2uPsrFzhXAE1rdWMZWbScjWTD1hdcsayzVL7jMifCzE3cnGLpSkMcdKHMQPvLd2dX9SVQlhV2u.zHmBECpiRUYT6WGpMBzvfAML7SFt0BCHztoHyHxeLeoPvFKiurzTPe3eroy.SQtvR0lsJ4e4k30dxqWFYxuHJ2dblV3YJLnnW5v4l7xcKEIDFe0Y.WsVEH9PmA_Ojw4BCi8BI17IDNCG_lZ40XEu557ihM94z9biQg8XkhkjGtjNw9ys9T1heRI50L9K8OoODxxdyCFPYa1n4i51oiymPpTicfMZ5vGHvC8pr5PLN8qEQJ5aWo0zCKRIcESW..8cCi815aZL9QHCB70GYMusTEJtykLLkIaIVxnBtkpSiOEfQYQJbZd1wu.SP.qNQ-&amp;v=1'

And then running the same application on linux:

1: Logging into Yahoo Mail with username 'r_holmes' and password 'xxxx'
2: Opening 
'<A HREF="http://mail.yahoo.com/config/login?.intl=us&amp;.us=ym&amp;.tries=1&amp;.src=ym&amp;login=r_holmes&amp;passwd=xxxx'">http://mail.yahoo.com/config/login?.intl=us&amp;.us=ym&amp;.tries=1&amp;.src=ym&amp;login=r_holmes&amp;passwd=xxxx'</A>
3: UpdateCookieCollection()
4: No previous cookies stored. Store all cookies
5:    B 18dft0h12937r&amp;b=2
6:    F a=J06ons0sva8HnAxcQd0gGflizzgSbIkvrjqtKkO_UelR1SmfYg.SzWz1NeVd&amp;b=_DjV
7:    Y v=1&amp;n=frfgoo6e3klnv&amp;l=h_7ebc4i/o&amp;p=m2evvdk013000000&amp;jb=16|23|
3&amp;ig=0f1kb&amp;iz=5932&amp;r=2d&amp;lg=us&amp;intl=us&amp;np=1
8:    T 
z=7zIJCB75dJCBIjtUO2esw7qMjMxBjYzMTYxNE8xNw--&amp;a=QAE&amp;sk=DAA.qR.7d3F3JI&amp;d=c2wBTlRRMkFURTBOakUyTXpnMk1BLS0BYQFRQUUBaWcBVjNTVEJBAXRpcAFRZEtfaEQBenoBN3pJSkNCZ1dB
9: Redirecting to 
'<A HREF="http://login.yahoo.com/config/verify?.done=http%3a//us.f546.mail.yahoo.com/ym/login%3f.rand=8eb8bof6cj070'">http://login.yahoo.com/config/verify?.done=http%3a//us.f546.mail.yahoo.com/ym/login%3f.rand=8eb8bof6cj070'</A>
10: Setting up cookies to sent with the request
11: Opening 
'<A HREF="http://login.yahoo.com/config/verify?.done=http://us.f546.mail.yahoo.com/ym/login?.rand=8eb8bof6cj070'">http://login.yahoo.com/config/verify?.done=http://us.f546.mail.yahoo.com/ym/login?.rand=8eb8bof6cj070'</A>

Step 11 sends me back to the login page instead of to my inbox. The Yahoo 
error message viewing the URL of step 11 is &quot;The browser you're using refuses 
to sign in. (cookies rejected)&quot;. I'm not sure this really is a cookie 
problem, though.

I've inspected what is actually going on with Ethereal. As a response to 
opening the URL of step 9 of the linux output, the Yahoo server responds 
with:

HTTP/1.1 200 OK[Unreassembled Packet]

On Windows, the response is:

HTTP/1.1 302 Found (text/html)

Is something wrong with my application or is it the Mono runtime? 

I've attached a stripped down version of my application. Obviously my password 
isn't xxxx, so running the application will fail on Windows as well :O)

Ronnie
-------------- next part --------------
A non-text attachment was scrubbed...
Name: YahooDrive.cs
Type: text/x-c++src
Size: 3756 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050301/9b8a9961/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20050301/9b8a9961/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010774.html">[Mono-devel-list] VTable &amp; Interfaces
</A></li>
	<LI>Next message: <A HREF="010776.html">[Mono-devel-list] [PATCH] Bug Fix for GetTickCount in WAPI IO Layer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10775">[ date ]</a>
              <a href="thread.html#10775">[ thread ]</a>
              <a href="subject.html#10775">[ subject ]</a>
              <a href="author.html#10775">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
