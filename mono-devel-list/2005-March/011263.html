<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Memory management for long running processes	(desc-heap profiler)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Memory%20management%20for%20long%20running%20processes%0A%09%28desc-heap%20profiler%29&In-Reply-To=4249C519.3010206%40majestic12.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011262.html">
   <LINK REL="Next"  HREF="011265.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Memory management for long running processes	(desc-heap profiler)</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Memory%20management%20for%20long%20running%20processes%0A%09%28desc-heap%20profiler%29&In-Reply-To=4249C519.3010206%40majestic12.co.uk"
       TITLE="[Mono-devel-list] Memory management for long running processes	(desc-heap profiler)">bmaurer at ximian.com
       </A><BR>
    <I>Tue Mar 29 16:38:22 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011262.html">[Mono-devel-list] Memory management for long running processes (desc-heap profiler)
</A></li>
        <LI>Next message: <A HREF="011265.html">[Mono-devel-list] Memory management for long running processes (desc-heap profiler)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11263">[ date ]</a>
              <a href="thread.html#11263">[ thread ]</a>
              <a href="subject.html#11263">[ subject ]</a>
              <a href="author.html#11263">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2005-03-29 at 22:14 +0100, Alex Chudnovsky wrote:
&gt;<i> Ben Maurer wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;Does the heapsize = xxxxx bytes grow without bound (ie, does it leak?).
</I>&gt;<i> &gt;If not, than managed memory is *not* your issue.
</I>&gt;<i> &gt;  
</I>&gt;<i> &gt;
</I>&gt;<i> It appears I have located at least one place in software that results in 
</I>&gt;<i> huge memory consumption
</I>&gt;<i> and it appears to be close to what I got reported by users of my 
</I>&gt;<i> software. Here is GC printout:
</I>&gt;<i> 
</I>&gt;<i> --------------------------------------------------------------------------------
</I>&gt;<i> Initiating full world-stop collection 65 after 32676644 allocd bytes
</I>&gt;<i> --&gt; Marking for collection 65 after 32676644 allocd bytes + 618028 
</I>&gt;<i> wasted bytes
</I>&gt;<i> Collection 64 finished ---&gt; heapsize = 56414208 bytes
</I>&gt;<i> World-stopped marking took 50 msecs
</I>&gt;<i> Complete collection took 80 msecs
</I>&gt;<i> Initiating full world-stop collection 66 after 29583120 allocd bytes
</I>&gt;<i> --&gt; Marking for collection 66 after 29583120 allocd bytes + 516520 
</I>&gt;<i> wasted bytes
</I>&gt;<i> Collection 65 finished ---&gt; heapsize = 56414208 bytes
</I>&gt;<i> World-stopped marking took 60 msecs
</I>&gt;<i> Complete collection took 80 msecs
</I>&gt;<i> Increasing heap size by 8388608 after 10701492 allocated bytes
</I>&gt;<i> Initiating full world-stop collection 67 after 26805540 allocd bytes
</I>&gt;<i> --&gt; Marking for collection 67 after 26805540 allocd bytes + 662452 
</I>&gt;<i> wasted bytes
</I>&gt;<i> Collection 66 finished ---&gt; heapsize = 64802816 bytes
</I>&gt;<i> World-stopped marking took 50 msecs
</I>&gt;<i> Complete collection took 70 msecs
</I>&gt;<i> Increasing heap size by 58474496 after 0 allocated bytes 
</I>&gt;<i> &lt;------------------ PROBLEM
</I>&gt;<i> Initiating full world-stop collection 68 after 42697296 allocd bytes
</I>&gt;<i> --&gt; Marking for collection 68 after 42697296 allocd bytes + 36000 wasted 
</I>&gt;<i> bytes
</I>&gt;<i> Collection 67 finished ---&gt; heapsize = 123277312 bytes
</I>&gt;<i> World-stopped marking took 60 msecs
</I>&gt;<i> Complete collection took 80 msecs
</I>&gt;<i> Increasing heap size by 87617536 after 0 allocated bytes 
</I>&gt;<i> &lt;------------------ PROBLEM
</I>&gt;<i> Initiating full world-stop collection 69 after 71215316 allocd bytes
</I>&gt;<i> --&gt; Marking for collection 69 after 71215316 allocd bytes + 4580 wasted 
</I>&gt;<i> bytes
</I>&gt;<i> Collection 68 finished ---&gt; heapsize = 210894848 bytes
</I>&gt;<i> World-stopped marking took 60 msecs
</I>&gt;<i> Complete collection took 70 msecs
</I>&gt;<i> Increasing heap size by 87617536 after 0 allocated bytes 
</I>&gt;<i> &lt;------------------ PROBLEM
</I>&gt;<i> Increasing heap size by 52305920 after 70980096 allocated bytes
</I>&gt;<i> --------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> Note last few iterations -- memory usage grown BIG time all of a sudden, 
</I>&gt;<i> and what I find
</I>&gt;<i> interesting is that GC says that it increased heap after allocating 0 
</I>&gt;<i> (zero) bytes!!! 8-O
</I>
Maybe right after a gc somebody is trying to allocate LOTS of memory?

&gt;<i> 
</I>&gt;<i> I am digging in now to try to get more information about where in my 
</I>&gt;<i> software exactly it happens and
</I>&gt;<i> any possible explanations to whether what happens is expected (you never 
</I>&gt;<i> know, maybe my
</I>&gt;<i> code tried to allocated gigabyte of RAM?)
</I>
Are you making allocations larger than say 10 mb. Doing that is a really
bad idea today.

-- Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011262.html">[Mono-devel-list] Memory management for long running processes (desc-heap profiler)
</A></li>
	<LI>Next message: <A HREF="011265.html">[Mono-devel-list] Memory management for long running processes (desc-heap profiler)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11263">[ date ]</a>
              <a href="thread.html#11263">[ thread ]</a>
              <a href="subject.html#11263">[ subject ]</a>
              <a href="author.html#11263">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
