<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Should we replace MemoryStream?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Should%20we%20replace%20MemoryStream%3F&In-Reply-To=23a15590911100421n49904fb5sd31ab20e019c567f%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033475.html">
   <LINK REL="Next"  HREF="033478.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Should we replace MemoryStream?</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Should%20we%20replace%20MemoryStream%3F&In-Reply-To=23a15590911100421n49904fb5sd31ab20e019c567f%40mail.gmail.com"
       TITLE="[Mono-dev] Should we replace MemoryStream?">robertj at gmx.net
       </A><BR>
    <I>Tue Nov 10 08:48:46 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033475.html">[Mono-dev] Should we replace MemoryStream?
</A></li>
        <LI>Next message: <A HREF="033478.html">[Mono-dev] Should we replace MemoryStream?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33476">[ date ]</a>
              <a href="thread.html#33476">[ thread ]</a>
              <a href="subject.html#33476">[ subject ]</a>
              <a href="author.html#33476">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Leszek Ciesielski wrote:
&gt;<i> Choice is not always good, and I think this is one of the cases when 
</I>&gt;<i> the default (i.e. the MemoryStream implementation) should make the 
</I>&gt;<i> choices instead presenting them to the user. Though I agree that the 
</I>&gt;<i> case of constructing a MemoryStream from an existing byte[] would 
</I>&gt;<i> require a special path in the code, as this is a stream that most 
</I>&gt;<i> likely won't be resized and in this case users are expecting the 
</I>&gt;<i> constructor to have a complexity of O(1) and GetBuffer to also be 
</I>&gt;<i> O(1). The same expectation is probably also true with a fixed size 
</I>&gt;<i> MemoryStream.
</I>
MemoryStream.GetBuffer's docs indirectly suggest that no copy
will be performed:

&quot;Note that the buffer contains allocated bytes which might be unused.
For example, if the string &quot;test&quot; is written into the MemoryStream
object, the length of the buffer returned from GetBuffer is 256, not 4,
with 252 bytes unused. To obtain only the data in the buffer, use the
ToArray method; however, ToArray creates a copy of the data in memory.&quot;

So MemoryStream.GetBuffer must remain an O(1) operation in any case,
defeating any kind of optimization a chunked memory stream
implementation may introduce.

Robert

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033475.html">[Mono-dev] Should we replace MemoryStream?
</A></li>
	<LI>Next message: <A HREF="033478.html">[Mono-dev] Should we replace MemoryStream?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33476">[ date ]</a>
              <a href="thread.html#33476">[ thread ]</a>
              <a href="subject.html#33476">[ subject ]</a>
              <a href="author.html#33476">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
