<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] FW:  Patch for Processes.c on Mac OSX
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20FW%3A%20%20Patch%20for%20Processes.c%20on%20Mac%20OSX&In-Reply-To=C732F938.18E7%25tom.philpot%40logos.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033570.html">
   <LINK REL="Next"  HREF="033571.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] FW:  Patch for Processes.c on Mac OSX</H1>
    <B>Tom Philpot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20FW%3A%20%20Patch%20for%20Processes.c%20on%20Mac%20OSX&In-Reply-To=C732F938.18E7%25tom.philpot%40logos.com"
       TITLE="[Mono-dev] FW:  Patch for Processes.c on Mac OSX">tom.philpot at logos.com
       </A><BR>
    <I>Mon Nov 30 13:03:14 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033570.html">[Mono-dev] Patch for Processes.c on Mac OSX
</A></li>
        <LI>Next message: <A HREF="033571.html">[Mono-dev] Patch for Atom10{Item,	Feed}Formatter for writing element extensions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33595">[ date ]</a>
              <a href="thread.html#33595">[ thread ]</a>
              <a href="subject.html#33595">[ subject ]</a>
              <a href="author.html#33595">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Has anyone had a chance to review this patch for Mac OS X?

Basically, enumerating processes on Mac OS X doesn't work correctly in Mono
without this patch, but also doesn't always crash because we're malloc'ing
some large random number of bytes pulled from a garbage location in memory.
If that number is huge, we crash, if it's small enough, we silently and
erroneously succeed.

Tom

------ Forwarded Message
From: Tom Philpot &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">tom.philpot at logos.com</A>&gt;
Date: Wed, 25 Nov 2009 15:09:41 -0800
To: &quot;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at ximian.com</A>&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at ximian.com</A>&gt;
Subject: [Mono-dev] Patch for Processes.c on Mac OSX

We have a patch for io-layer/processes.c where Mono on Mac OSX crashes if
trying to lock a named mutex which is not owned by the current process. The
problem is that Mono on Mac does not correctly know how to enumerate
processes.

The attached program assumes that you have built it, it then launches itself
and takes a lock on a named mutex. The first instance also tries to acquire
the lock and crashes.

The attached patch fixes the issue for us.

Again, props to Martin Potter for the discovery and the patch.

Tom

This patch is MIT/X11 licensed.

_______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>

------ End of Forwarded Message

-------------- next part --------------
A non-text attachment was scrubbed...
Name: MutexTest.cs
Type: application/octet-stream
Size: 1345 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091130/8add5dd4/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091130/8add5dd4/attachment.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: processes-patch.txt
Type: application/octet-stream
Size: 2226 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091130/8add5dd4/attachment-0001.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091130/8add5dd4/attachment-0001.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033570.html">[Mono-dev] Patch for Processes.c on Mac OSX
</A></li>
	<LI>Next message: <A HREF="033571.html">[Mono-dev] Patch for Atom10{Item,	Feed}Formatter for writing element extensions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33595">[ date ]</a>
              <a href="thread.html#33595">[ thread ]</a>
              <a href="subject.html#33595">[ subject ]</a>
              <a href="author.html#33595">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
