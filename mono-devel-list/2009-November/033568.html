<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] WaitAny does not consistently return when waiting on more than one WaitHandle
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WaitAny%20does%20not%20consistently%20return%20when%20waiting%20on%0A%20more%20than%20one%20WaitHandle&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033567.html">
   <LINK REL="Next"  HREF="033572.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] WaitAny does not consistently return when waiting on more than one WaitHandle</H1>
    <B>Tom Philpot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WaitAny%20does%20not%20consistently%20return%20when%20waiting%20on%0A%20more%20than%20one%20WaitHandle&In-Reply-To="
       TITLE="[Mono-dev] WaitAny does not consistently return when waiting on more than one WaitHandle">tom.philpot at logos.com
       </A><BR>
    <I>Wed Nov 25 18:01:42 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033567.html">[Mono-dev] A bug? On Mono we can't use delegate as the	dictionary key
</A></li>
        <LI>Next message: <A HREF="033572.html">[Mono-dev] WaitAny does not consistently return when waiting on	more than one WaitHandle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33568">[ date ]</a>
              <a href="thread.html#33568">[ thread ]</a>
              <a href="subject.html#33568">[ subject ]</a>
              <a href="author.html#33568">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We've written a small test case against Mono 2.7 (r146315) that confirms
that WaitAny() does not return in a consistent amount of time, or sometimes
at all when waiting on more than one WaitHandle. It also appears that there
are no test cases in Mono for this case.

Our attached program takes 2 arguments. The first is the number of
milliseconds to wait before the wait handles are set, the second is the
number of milliseconds to wait in before exiting to give the thread pool
time to notify.

We're running these tests on Mac OS X, if that helps.



Example of Failure case:

ws1048:Mono Patches tom.philpot$ /opt/mono/bin/mono WaitAnyTest.exe 35000
10000
Setup wait handles, sleeping for 35s...
Wait2: Calling WaitAny with 2 WaitHandles
Wait1: Calling WaitAny with 1 WaitHandle
done sleeping.
Setting event 2.
Sleeping for 10s to see if wait handles respond.
Wait1: WaitAny(1) returned 0.


Example of Successful case:

ws1048:Mono Patches tom.philpot$ /opt/mono/bin/mono WaitAnyTest.exe 5000
10000
Setup wait handles, sleeping for 5s...
Wait1: Calling WaitAny with 1 WaitHandle
Wait2: Calling WaitAny with 2 WaitHandles
done sleeping.
Setting event 2.
Sleeping for 10s to see if wait handles respond.
Wait1: WaitAny(1) returned 0.
Wait2: WaitAny(2) returned 1.
RegisteredWaitForSingleObjectCallback called.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: WaitAnyTest.cs
Type: application/octet-stream
Size: 2261 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091125/2d697ae9/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091125/2d697ae9/attachment.obj</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033567.html">[Mono-dev] A bug? On Mono we can't use delegate as the	dictionary key
</A></li>
	<LI>Next message: <A HREF="033572.html">[Mono-dev] WaitAny does not consistently return when waiting on	more than one WaitHandle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33568">[ date ]</a>
              <a href="thread.html#33568">[ thread ]</a>
              <a href="subject.html#33568">[ subject ]</a>
              <a href="author.html#33568">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
