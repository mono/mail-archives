<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] System.Timers.Timer bug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20System.Timers.Timer%20bug&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018964.html">
   <LINK REL="Next"  HREF="018977.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] System.Timers.Timer bug</H1>
    <B>Jakubec Vojtech</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20System.Timers.Timer%20bug&In-Reply-To="
       TITLE="[Mono-dev] System.Timers.Timer bug">vojtech.jakubec at strom.cz
       </A><BR>
    <I>Tue Jun 13 12:44:35 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018964.html">[Mono-dev] Re: databinder works?
</A></li>
        <LI>Next message: <A HREF="018977.html">[Mono-dev] Re: System.Timers.Timer bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18931">[ date ]</a>
              <a href="thread.html#18931">[ thread ]</a>
              <a href="subject.html#18931">[ subject ]</a>
              <a href="author.html#18931">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I found a multi-threading problem in implementation of System.Timers.Timer class. In our application we are using Timer.Enabled property inside of ElapsedEventHandler method to prevent timer from raising the Elapsed event again while previous handler is still running. In some cases Timer can be disabled and enabled again very fast. 

 

The problem under Mono is with member ManualResetEvent wait. In some cases new thread created by enabling Timer starts and creates instance of wait object before the old thread ends. Then the old thread dispose wait object and new thread throws unhandled NullRefrenceException.

 

I'm attaching modified System.Timers.Timer class from Mono-1.1.15 sources with possible solution.

 

Regards,

Vojtech Jakubec

Telco software development (VAS)

 

STROM telecom, a.s.

 

 

Tel.: +420 211 029 248

BB Cenrum - Beta, Vysko&#269;ilova 1461/2a, 140 00  Praha 4, Czech Republic

www.strom.cz &lt;<A HREF="http://www.strom.cz/">http://www.strom.cz/</A>&gt; 


DISCLAIMER
This e-mail may be privileged and/or confidential, and the sender does not waive any related rights and obligations. Any distribution, use or copying of this e-mail or the information it contains by other than an intended recipient is unauthorized. If you received this e-mail in error, please advise me (by return e-mail or otherwise) immediately.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060613/6f78e491/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060613/6f78e491/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Timer.cs
Type: application/octet-stream
Size: 5376 bytes
Desc: Timer.cs
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060613/6f78e491/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060613/6f78e491/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018964.html">[Mono-dev] Re: databinder works?
</A></li>
	<LI>Next message: <A HREF="018977.html">[Mono-dev] Re: System.Timers.Timer bug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18931">[ date ]</a>
              <a href="thread.html#18931">[ thread ]</a>
              <a href="subject.html#18931">[ subject ]</a>
              <a href="author.html#18931">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
