<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] R:  Transfer-Encoding: chunked + Connection: close
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20R%3A%20%20Transfer-Encoding%3A%20chunked%20%2B%20Connection%3A%20close&In-Reply-To=003001c69a0d%24851a8d40%240100a8c0%40kornelpal.hu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019114.html">
   <LINK REL="Next"  HREF="019125.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] R:  Transfer-Encoding: chunked + Connection: close</H1>
    <B>subscription.sapi</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20R%3A%20%20Transfer-Encoding%3A%20chunked%20%2B%20Connection%3A%20close&In-Reply-To=003001c69a0d%24851a8d40%240100a8c0%40kornelpal.hu"
       TITLE="[Mono-dev] R:  Transfer-Encoding: chunked + Connection: close">subscription.sapi at apsystems.it
       </A><BR>
    <I>Wed Jun 28 07:15:46 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="019114.html">[Mono-dev] Transfer-Encoding: chunked + Connection: close
</A></li>
        <LI>Next message: <A HREF="019125.html">[Mono-dev] R:  Transfer-Encoding: chunked + Connection: close
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19123">[ date ]</a>
              <a href="thread.html#19123">[ thread ]</a>
              <a href="subject.html#19123">[ subject ]</a>
              <a href="author.html#19123">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Solution:
Our web page inherit from a base class web page with some initialization code. One of the line in base class is the following:

Response.Cache.SetCacheability(System.Web.HttpCacheability.NoCache);


This line is the blame of the problem.

Someone know why ?
and why the different behaviour with IIS and Apache+Mono ?
and more, why different behaviour with Internet Explorer and Firefox ?

Thank you.


-----Messaggio originale-----
Da: Korn&#233;l P&#225;l [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">kornelpal at gmail.com</A>] 
Inviato: marted&#236; 27 giugno 2006 19.17
A: subscription.sapi; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Oggetto: Re: [Mono-dev] Transfer-Encoding: chunked + Connection: close

Hi,

The attached example works fine for me with mod_mono and Apache. Note that 
when
doing this you don't need chunked encoding because you know the actual 
content length.

Korn&#233;l

----- Original Message ----- 
From: &quot;subscription.sapi&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">subscription.sapi at apsystems.it</A>&gt;
To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Tuesday, June 27, 2006 6:41 PM
Subject: [Mono-dev] Transfer-Encoding: chunked + Connection: close


We have problem to retrieve an attachment from a Web Page. We use the
following code:



Response.ClearContent();

Response.ClearHeaders();

Response.Clear();

Response.ContentType=ContentType;

Response.AppendHeader(&quot;content-disposition&quot;, &quot;filename=&quot; +
NomeAllegatoOriginale);

Response.BinaryWrite(FileBytes);

Response.Flush();

Response.End();



This code works well on IIS+.NET, for Internet Explorer and Firefox.

During porting operations we have noticed that doesn't work on
Apache+Mono.



More precisely: work fine for firefox (it downloads the file and ask to
save the file), but give an error on Internet Explorer (it downloads the
file, but probably does not complete correctly the operation).

We noticed in the http response header from server, that in the
Apache+Mono version, there is &quot;Connection: close&quot; (not present in
IIS-.NET version). This is a &quot;Transfer-Encoding: chunked&quot;, probably this
creates the problem. For same strange reason, this is not a problem for
Firefox, but Internet Explorer can't handle correctly the file (web
stream).

I've read the patch of Gonzalo:



Author: gonzalo
Date: 2005-06-26 01:51:18 -0400 (Sun, 26 Jun 2005)
New Revision: 46512



But this doesn't seems to work. I Like also to know if this patch is
already in the compilation monocharge-20060627.tar.gz
&lt;<A HREF="http://mono.ximian.com/daily/monocharge-20060627.tar.gz">http://mono.ximian.com/daily/monocharge-20060627.tar.gz</A>&gt;  at
<A HREF="http://mono.ximian.com/daily/,">http://mono.ximian.com/daily/,</A> we like to create a compilation
environment in the near future,but forn now we depend on the compiled
version only.



Thank you.






--------------------------------------------------------------------------------


&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019114.html">[Mono-dev] Transfer-Encoding: chunked + Connection: close
</A></li>
	<LI>Next message: <A HREF="019125.html">[Mono-dev] R:  Transfer-Encoding: chunked + Connection: close
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19123">[ date ]</a>
              <a href="thread.html#19123">[ thread ]</a>
              <a href="subject.html#19123">[ subject ]</a>
              <a href="author.html#19123">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
