<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] [PATCH] Re: mono-service possible bug fix
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Re%3A%20mono-service%20possible%20bug%20fix&In-Reply-To=09d901c68a22%2443b19330%24c900a8c0%40beardtongue">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018816.html">
   <LINK REL="Next"  HREF="018819.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] [PATCH] Re: mono-service possible bug fix</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%5BPATCH%5D%20Re%3A%20mono-service%20possible%20bug%20fix&In-Reply-To=09d901c68a22%2443b19330%24c900a8c0%40beardtongue"
       TITLE="[Mono-dev] [PATCH] Re: mono-service possible bug fix">robertj at gmx.net
       </A><BR>
    <I>Wed Jun  7 07:51:59 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="018816.html">[Mono-dev] mono-service possible bug fix
</A></li>
        <LI>Next message: <A HREF="018819.html">[Mono-dev] [PATCH] mono-service: Use AppDomain.ExecuteAssembly	instead of MethodInfo.Invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18818">[ date ]</a>
              <a href="thread.html#18818">[ thread ]</a>
              <a href="subject.html#18818">[ subject ]</a>
              <a href="author.html#18818">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A> wrote:
&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> Sorry for my previous thread hijacking. Didn't realize about it.
</I>&gt;<i> 
</I>&gt;<i> Well, it seems there is a bug in mono-service. Whenever it tries to
</I>&gt;<i> launch a service application it raises an exception in mono-service.cs
</I>&gt;<i> at method StartService.
</I>&gt;<i> 
</I>&gt;<i> The code is doing something like:
</I>&gt;<i> 
</I>&gt;<i> string [] service_args = new string [0];
</I>&gt;<i> 
</I>&gt;<i> entry.Invoke(null, service_args);
</I>&gt;<i> 
</I>&gt;<i> return 0;
</I>&gt;<i> 
</I>&gt;<i> And it raises the exception &quot;Number of parameter does not match expected 
</I>&gt;<i> count&quot;
</I>&gt;<i> 
</I>&gt;<i> Doing the following changes the problem seems to be solved.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> string [] service_args = new string [0];
</I>&gt;<i> 
</I>&gt;<i> object[] obj = new object[1];
</I>&gt;<i> 
</I>&gt;<i> obj[0] = service_args;
</I>&gt;<i> 
</I>&gt;<i> entry.Invoke(null, obj);
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> return 0;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I replaced the mono-service.exe on my Fedora4/mono-1.1.15 and now it works.
</I>
It might work with your service but it fails if the service
assembly has an entry point with an empty parameter list
(static void Main ()).

The attached patch works for both entry points.

Robert

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: mono-service.diff
Url: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060607/4e4cc392/attachment.pl">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20060607/4e4cc392/attachment.pl</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018816.html">[Mono-dev] mono-service possible bug fix
</A></li>
	<LI>Next message: <A HREF="018819.html">[Mono-dev] [PATCH] mono-service: Use AppDomain.ExecuteAssembly	instead of MethodInfo.Invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18818">[ date ]</a>
              <a href="thread.html#18818">[ thread ]</a>
              <a href="subject.html#18818">[ subject ]</a>
              <a href="author.html#18818">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
