<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] help building mono x86_64 on OS X 10.9
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20help%20building%20mono%20x86_64%20on%20OS%20X%2010.9&In-Reply-To=%3C436A6423-EEFF-4BE9-A627-F05FC09B16AB%40wolfereiter.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="040974.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] help building mono x86_64 on OS X 10.9</H1>
    <B>Brian Reiter</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20help%20building%20mono%20x86_64%20on%20OS%20X%2010.9&In-Reply-To=%3C436A6423-EEFF-4BE9-A627-F05FC09B16AB%40wolfereiter.com%3E"
       TITLE="[Mono-dev] help building mono x86_64 on OS X 10.9">breiter at wolfereiter.com
       </A><BR>
    <I>Wed Dec  4 10:47:48 UTC 2013</I>
    <P><UL>
        
        <LI>Next message: <A HREF="040974.html">[Mono-dev] Updated Mono class status pages?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40977">[ date ]</a>
              <a href="thread.html#40977">[ thread ]</a>
              <a href="subject.html#40977">[ subject ]</a>
              <a href="author.html#40977">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I want to build mono-3.2.5 and mono-3.2.6-branch from git. I&#8217;m using libgdiplus built by MacPorts.

I&#8217;m attempting to use the x86_64 libraries from MacPorts but my own build of mono/llvm into prefix /opt/mono64. My build dies while linking to libmonoruntime.a. 

clang --version
Apple LLVM version 5.0 (clang-500.2.79) (based on LLVM 3.3svn)
Target: x86_64-apple-darwin13.0.0
Thread model: posix

[master] $ git checkout mono-3.2.5
[(mono-3.2.5)] $ MONO_USE_LLVM=1 CPPFLAGS=&quot;-I/opt/local/include&quot; LDFLAGS=&quot;-L/opt/local/lib -lintl -lcharset&quot; PATH=/opt/mono64/bin:/opt/local/lib/pkgconfig:$PATH ./autogen.sh --prefix=/opt/mono64 --enable-llvm=yes --with-gc=sgen --enable-nls=no --with-libgdiplus=/opt/local/

...

[(mono-3.2.5)] $ make 

...

  CC       pedump.o
  CCLD     pedump
Undefined symbols for architecture x86_64:
  &quot;_mono_gc_add_memory_pressure&quot;, referenced from:
      _icall_functions in libmonoruntime.a(libmonoruntime_la-icall.o)
  &quot;_mono_gc_alloc_fixed&quot;, referenced from:
      _mono_domain_create in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_foreach in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_add_class_static_data in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_alloc_static_data in libmonoruntime.a(libmonoruntime_la-threads.o)
      _mono_class_vtable_full in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_image_build_metadata in libmonoruntime.a(libmonoruntime_la-reflection.o)
      _collect_types in libmonoruntime.a(libmonoruntime_la-reflection.o)
      ...
  &quot;_mono_gc_base_init&quot;, referenced from:
      _mono_init_internal in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_debug_init in libmonoruntime.a(libmonoruntime_la-mono-debug.o)
      _mono_runtime_init in libmonoruntime.a(libmonoruntime_la-appdomain.o)
      _mono_gc_init in libmonoruntime.a(libmonoruntime_la-gc.o)
      _mono_profiler_load in libmonoruntime.a(libmonoruntime_la-profiler.o)
  &quot;_mono_gc_clear_domain&quot;, referenced from:
      _mono_domain_free in libmonoruntime.a(libmonoruntime_la-domain.o)
  &quot;_mono_gc_collect&quot;, referenced from:
      _unload_thread_main in libmonoruntime.a(libmonoruntime_la-appdomain.o)
      _mono_domain_finalize in libmonoruntime.a(libmonoruntime_la-gc.o)
      _ves_icall_System_GC_InternalCollect in libmonoruntime.a(libmonoruntime_la-gc.o)
      _ves_icall_System_GC_GetTotalMemory in libmonoruntime.a(libmonoruntime_la-gc.o)
  &quot;_mono_gc_collection_count&quot;, referenced from:
      _icall_functions in libmonoruntime.a(libmonoruntime_la-icall.o)
  &quot;_mono_gc_deregister_root&quot;, referenced from:
      _mono_domain_free in libmonoruntime.a(libmonoruntime_la-domain.o)
      _thread_cleanup in libmonoruntime.a(libmonoruntime_la-threads.o)
      _mono_dynamic_image_free in libmonoruntime.a(libmonoruntime_la-reflection.o)
      _mono_reflection_free_dynamic_generic_class in libmonoruntime.a(libmonoruntime_la-reflection.o)
      _mono_cq_destroy in libmonoruntime.a(libmonoruntime_la-mono-cq.o)
      _mono_wsq_destroy in libmonoruntime.a(libmonoruntime_la-mono-wsq.o)
  &quot;_mono_gc_enable_events&quot;, referenced from:
      _mono_profiler_install_gc in libmonoruntime.a(libmonoruntime_la-profiler.o)
  &quot;_mono_gc_free_fixed&quot;, referenced from:
      _mono_domain_create in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_foreach in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_free in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_add_class_static_data in libmonoruntime.a(libmonoruntime_la-domain.o)
      _thread_cleanup in libmonoruntime.a(libmonoruntime_la-threads.o)
      _mono_image_build_metadata in libmonoruntime.a(libmonoruntime_la-reflection.o)
      _collect_types in libmonoruntime.a(libmonoruntime_la-reflection.o)
      ...
  &quot;_mono_gc_get_generation&quot;, referenced from:
      _icall_functions in libmonoruntime.a(libmonoruntime_la-icall.o)
  &quot;_mono_gc_get_los_limit&quot;, referenced from:
      _ves_icall_System_String_GetLOSLimit in libmonoruntime.a(libmonoruntime_la-string-icalls.o)
  &quot;_mono_gc_get_used_size&quot;, referenced from:
      _ves_icall_System_GC_GetTotalMemory in libmonoruntime.a(libmonoruntime_la-gc.o)
  &quot;_mono_gc_get_vtable_bits&quot;, referenced from:
      _mono_class_vtable_full in libmonoruntime.a(libmonoruntime_la-object.o)
  &quot;_mono_gc_invoke_finalizers&quot;, referenced from:
      _finalizer_thread in libmonoruntime.a(libmonoruntime_la-gc.o)
  &quot;_mono_gc_invoke_with_gc_lock&quot;, referenced from:
      _rehash in libmonoruntime.a(libmonoruntime_la-mono-hash.o)
  &quot;_mono_gc_is_disabled&quot;, referenced from:
      _mono_gc_init in libmonoruntime.a(libmonoruntime_la-gc.o)
  &quot;_mono_gc_is_moving&quot;, referenced from:
      _mono_class_layout_fields in libmonoruntime.a(libmonoruntime_la-class.o)
      _mono_init_internal in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_free in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_add_class_static_data in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_delegate_to_ftnptr in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_ftnptr_to_delegate in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_delegate_free_ftnptr in libmonoruntime.a(libmonoruntime_la-marshal.o)
      ...
  &quot;_mono_gc_make_descr_for_array&quot;, referenced from:
      _mono_class_compute_gc_descriptor in libmonoruntime.a(libmonoruntime_la-object.o)
  &quot;_mono_gc_make_descr_for_object&quot;, referenced from:
      _mono_class_compute_gc_descriptor in libmonoruntime.a(libmonoruntime_la-object.o)
  &quot;_mono_gc_make_descr_for_string&quot;, referenced from:
      _mono_class_compute_gc_descriptor in libmonoruntime.a(libmonoruntime_la-object.o)
  &quot;_mono_gc_make_descr_from_bitmap&quot;, referenced from:
      _mono_domain_create in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_class_vtable_full in libmonoruntime.a(libmonoruntime_la-object.o)
  &quot;_mono_gc_make_root_descr_all_refs&quot;, referenced from:
      _mono_domain_add_class_static_data in libmonoruntime.a(libmonoruntime_la-domain.o)
      _emit_invoke_call in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_thread_set_main in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_class_vtable_full in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_runtime_run_main in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_image_build_metadata in libmonoruntime.a(libmonoruntime_la-reflection.o)
      _mono_image_get_method_info in libmonoruntime.a(libmonoruntime_la-reflection.o)
      ...
  &quot;_mono_gc_make_root_descr_user&quot;, referenced from:
      _mono_alloc_static_data in libmonoruntime.a(libmonoruntime_la-threads.o)
  &quot;_mono_gc_max_generation&quot;, referenced from:
      _icall_functions in libmonoruntime.a(libmonoruntime_la-icall.o)
      _unload_thread_main in libmonoruntime.a(libmonoruntime_la-appdomain.o)
      _mono_domain_finalize in libmonoruntime.a(libmonoruntime_la-gc.o)
      _ves_icall_System_GC_GetTotalMemory in libmonoruntime.a(libmonoruntime_la-gc.o)
  &quot;_mono_gc_pending_finalizers&quot;, referenced from:
      _ves_icall_System_GC_WaitForPendingFinalizers in libmonoruntime.a(libmonoruntime_la-gc.o)
  &quot;_mono_gc_pthread_detach&quot;, referenced from:
      _thread_start_routine in libwapi.a(wthreads.o)
  &quot;_mono_gc_pthread_exit&quot;, referenced from:
      _thread_start_routine in libwapi.a(wthreads.o)
      _ExitThread in libwapi.a(wthreads.o)
      _thread_exit in libwapi.a(wthreads.o)
  &quot;_mono_gc_register_root&quot;, referenced from:
      _mono_domain_create in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_init_internal in libmonoruntime.a(libmonoruntime_la-domain.o)
      _emit_invoke_call in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_thread_create_internal in libmonoruntime.a(libmonoruntime_la-threads.o)
      _handle_store in libmonoruntime.a(libmonoruntime_la-threads.o)
      _mono_thread_attach_full in libmonoruntime.a(libmonoruntime_la-threads.o)
      _ves_icall_System_Threading_Thread_Thread_internal in libmonoruntime.a(libmonoruntime_la-threads.o)
      ...
  &quot;_mono_gc_register_thread&quot;, referenced from:
      _mono_thread_attach_full in libmonoruntime.a(libmonoruntime_la-threads.o)
  &quot;_mono_gc_set_allow_synchronous_major&quot;, referenced from:
      _ves_icall_Mono_Runtime_SetGCAllowSynchronousMajor in libmonoruntime.a(libmonoruntime_la-gc.o)
  &quot;_mono_gc_set_current_thread_appdomain&quot;, referenced from:
      _mono_init_internal in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_unset in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_domain_set_internal_with_options in libmonoruntime.a(libmonoruntime_la-domain.o)
  &quot;_mono_gc_set_skip_thread&quot;, referenced from:
      _async_invoke_thread in libmonoruntime.a(libmonoruntime_la-threadpool.o)
      _tp_poll_wait in libmonoruntime.a(libmonoruntime_la-threadpool.o)
  &quot;_mono_gc_set_stack_end&quot;, referenced from:
      _start_wrapper in libmonoruntime.a(libmonoruntime_la-threads.o)
  &quot;_mono_gc_user_markers_supported&quot;, referenced from:
      _thread_cleanup in libmonoruntime.a(libmonoruntime_la-threads.o)
      _mono_alloc_static_data in libmonoruntime.a(libmonoruntime_la-threads.o)
  &quot;_mono_gc_wbarrier_arrayref_copy&quot;, referenced from:
      _ves_icall_System_Array_FastCopy in libmonoruntime.a(libmonoruntime_la-icall.o)
      _ves_icall_System_Reflection_Assembly_GetTypes in libmonoruntime.a(libmonoruntime_la-icall.o)
  &quot;_mono_gc_wbarrier_generic_nostore&quot;, referenced from:
      _mono_marshal_init in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _ves_icall_System_Threading_Interlocked_Exchange_Object in libmonoruntime.a(libmonoruntime_la-threads.o)
      _ves_icall_System_Threading_Interlocked_CompareExchange_Object in libmonoruntime.a(libmonoruntime_la-threads.o)
      _ves_icall_System_Threading_Interlocked_CompareExchange_T in libmonoruntime.a(libmonoruntime_la-threads.o)
      _ves_icall_System_Threading_Interlocked_Exchange_T in libmonoruntime.a(libmonoruntime_la-threads.o)
      _ves_icall_System_Threading_Volatile_Write_T in libmonoruntime.a(libmonoruntime_la-threads.o)
  &quot;_mono_gc_wbarrier_generic_store&quot;, referenced from:
      _ves_icall_System_Threading_Thread_VolatileWriteObject in libmonoruntime.a(libmonoruntime_la-threads.o)
      _set_value in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_method_return_message_restore in libmonoruntime.a(libmonoruntime_la-object.o)
      _ves_icall_System_Array_SetGenericValueImpl in libmonoruntime.a(libmonoruntime_la-icall.o)
      _ves_icall_System_CurrentSystemTimeZone_GetTimeZoneData in libmonoruntime.a(libmonoruntime_la-icall.o)
      _ves_icall_get_enum_info in libmonoruntime.a(libmonoruntime_la-icall.o)
      _ves_icall_System_Reflection_Assembly_GetManifestResourceInternal in libmonoruntime.a(libmonoruntime_la-icall.o)
      ...
  &quot;_mono_gc_wbarrier_object_copy&quot;, referenced from:
      _mono_object_clone in libmonoruntime.a(libmonoruntime_la-object.o)
  &quot;_mono_gc_wbarrier_set_arrayref&quot;, referenced from:
      _mono_marshal_xdomain_copy_value in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_marshal_xdomain_copy_out_value in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_perfcounter_category_names in libmonoruntime.a(libmonoruntime_la-mono-perfcounters.o)
      _mono_perfcounter_counter_names in libmonoruntime.a(libmonoruntime_la-mono-perfcounters.o)
      _mono_perfcounter_instance_names in libmonoruntime.a(libmonoruntime_la-mono-perfcounters.o)
      _get_string_array in libmonoruntime.a(libmonoruntime_la-mono-perfcounters.o)
      _mono_runtime_get_main_args in libmonoruntime.a(libmonoruntime_la-object.o)
      ...
  &quot;_mono_gc_wbarrier_set_field&quot;, referenced from:
      _mono_domain_set_internal_with_options in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_context_set in libmonoruntime.a(libmonoruntime_la-domain.o)
      _mono_string_builder_to_utf8 in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_string_builder_to_utf16 in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_string_utf8_to_builder in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_delegate_begin_invoke in libmonoruntime.a(libmonoruntime_la-marshal.o)
      _mono_delegate_end_invoke in libmonoruntime.a(libmonoruntime_la-marshal.o)
      ...
  &quot;_mono_gc_wbarrier_value_copy&quot;, referenced from:
      _set_value in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_nullable_box in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_nullable_init in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_value_copy in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_value_copy_array in libmonoruntime.a(libmonoruntime_la-object.o)
      _mono_method_return_message_restore in libmonoruntime.a(libmonoruntime_la-object.o)
      _ves_icall_System_Array_SetGenericValueImpl in libmonoruntime.a(libmonoruntime_la-icall.o)
      ...
  &quot;_mono_gc_weak_link_add&quot;, referenced from:
      _ves_icall_System_GCHandle_GetTargetHandle in libmonoruntime.a(libmonoruntime_la-gc.o)
      _alloc_handle in libmonoruntime.a(libmonoruntime_la-gc.o)
      _mono_monitor_try_enter_internal in libmonoruntime.a(libmonoruntime_la-monitor.o)
  &quot;_mono_gc_weak_link_get&quot;, referenced from:
      _mono_gchandle_get_target in libmonoruntime.a(libmonoruntime_la-gc.o)
      _alloc_handle in libmonoruntime.a(libmonoruntime_la-gc.o)
      _mono_locks_dump in libmonoruntime.a(libmonoruntime_la-monitor.o)
  &quot;_mono_gc_weak_link_remove&quot;, referenced from:
      _ves_icall_System_GCHandle_GetTargetHandle in libmonoruntime.a(libmonoruntime_la-gc.o)
      _mono_gchandle_free in libmonoruntime.a(libmonoruntime_la-gc.o)
      _alloc_handle in libmonoruntime.a(libmonoruntime_la-gc.o)
      _mono_gchandle_free_domain in libmonoruntime.a(libmonoruntime_la-gc.o)
      _mono_monitor_try_enter_internal in libmonoruntime.a(libmonoruntime_la-monitor.o)
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [pedump] Error 1
make[2]: *** [all-recursive] Error 1
make[1]: *** [all-recursive] Error 1
make: *** [all] Error 2

All of the object files are x86_64:
[(mono-3.2.5)] $ find . -name *.o | xargs file | grep -v x86_64 | wc -l
       0

Thanks.

//brian reiter
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 841 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20131204/d3dd33a0/attachment.pgp">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20131204/d3dd33a0/attachment.pgp</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="040974.html">[Mono-dev] Updated Mono class status pages?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40977">[ date ]</a>
              <a href="thread.html#40977">[ thread ]</a>
              <a href="subject.html#40977">[ subject ]</a>
              <a href="author.html#40977">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
