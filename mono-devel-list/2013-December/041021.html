<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Size of thread in Mono (65MB per thread?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Size%20of%20thread%20in%20Mono%20%2865MB%20per%20thread%3F%29&In-Reply-To=%3CCAPNzd9buVN2ftQ6s_UtiszuYQDrO6PmAvwuQ2DZGDP35Kp%2Ba4Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041020.html">
   <LINK REL="Next"  HREF="041022.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Size of thread in Mono (65MB per thread?)</H1>
    <B>Nicolas Antoniazzi</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Size%20of%20thread%20in%20Mono%20%2865MB%20per%20thread%3F%29&In-Reply-To=%3CCAPNzd9buVN2ftQ6s_UtiszuYQDrO6PmAvwuQ2DZGDP35Kp%2Ba4Q%40mail.gmail.com%3E"
       TITLE="[Mono-dev] Size of thread in Mono (65MB per thread?)">nicolas.antoniazzi at gmail.com
       </A><BR>
    <I>Fri Dec 20 08:10:05 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="041020.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
        <LI>Next message: <A HREF="041022.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41021">[ date ]</a>
              <a href="thread.html#41021">[ thread ]</a>
              <a href="subject.html#41021">[ subject ]</a>
              <a href="author.html#41021">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am not using OpenVZ but a solution that we developed based on Linux
kernel calls because we really need to bootstrap a virtual environment in
less than 50ms.
I tested the same program on a .Net platform and after 1000 threads
created, the whole application used 48MB of RAM. It sounds really strange
to me that a Thread, that in theory should be a light process, takes 65MB
of virtual memory.

In the meantime, I am not expert in differences between virtual and
physical memory, but, does your answer mean that if mono would detects that
my system only has 500MB of physical memory, it would reserve less amount
of memory per thread?

Maybe there is a way to send some parameters to mono or to change some
content in /proc to simulate a smaller amount of physical memory?

Thanks for your answer!



2013/12/20 Nikita Tsukanov &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">keks9n at gmail.com</A>&gt;

&gt;<i> Don't use OpenVZ, it limits _virtual_ memory, not physical. Mono threads
</I>&gt;<i> use a small amount of physical memory, but might reserve high of virtual
</I>&gt;<i> memory space. You'd rather try KVM/Xen virtualization.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Nikita
</I>&gt;<i>
</I>&gt;<i> 2013/12/19 Nicolas Antoniazzi &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">nicolas.antoniazzi at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am using Mono in a virtualized environment with 512MB of RAM.
</I>&gt;&gt;<i> I made a very simple program which starts 10 threads in a loop and
</I>&gt;&gt;<i> apparently, every time that I start a new thread, approximately 65MB of
</I>&gt;&gt;<i> memory is used.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In my case, I can run 5 threads, but for the 6th, the program crashes
</I>&gt;&gt;<i> (without any exception). 150MB are already consumed without the use of any
</I>&gt;&gt;<i> thread.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is it a normal behavior?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> P.S: Sorry I double posted this message on mono-list because I did not
</I>&gt;&gt;<i> understood that third party programmers also had to come on this devel list.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks!
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Nicolas Antoniazzi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20131220/ff16d61b/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20131220/ff16d61b/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041020.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
	<LI>Next message: <A HREF="041022.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41021">[ date ]</a>
              <a href="thread.html#41021">[ thread ]</a>
              <a href="subject.html#41021">[ subject ]</a>
              <a href="author.html#41021">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
