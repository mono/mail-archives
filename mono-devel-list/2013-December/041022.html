<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Size of thread in Mono (65MB per thread?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Size%20of%20thread%20in%20Mono%20%2865MB%20per%20thread%3F%29&In-Reply-To=%3CCAPH5wFqta5_En9O67QrikPKVUNiKARP3aV6tu8Q3pPZGTEuPvQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041021.html">
   <LINK REL="Next"  HREF="041023.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Size of thread in Mono (65MB per thread?)</H1>
    <B>Nikita Tsukanov</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Size%20of%20thread%20in%20Mono%20%2865MB%20per%20thread%3F%29&In-Reply-To=%3CCAPH5wFqta5_En9O67QrikPKVUNiKARP3aV6tu8Q3pPZGTEuPvQ%40mail.gmail.com%3E"
       TITLE="[Mono-dev] Size of thread in Mono (65MB per thread?)">keks9n at gmail.com
       </A><BR>
    <I>Fri Dec 20 08:34:24 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="041021.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
        <LI>Next message: <A HREF="041023.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41022">[ date ]</a>
              <a href="thread.html#41022">[ thread ]</a>
              <a href="subject.html#41022">[ subject ]</a>
              <a href="author.html#41022">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In normal circumstances (i. e. physical machine, right type of
virtualization, etc) virtual memory address space is almost free, so many
applications reserve large amounts of it. However, until they really need
that memory, no physical memory is used. OpenVZ and such solutions are
using virtual memory limit (that's why you'll have problems using apache2
on 100MB OpenVZ VPS and it'll run fine on Xen/KVM with the same amount of
memory).

So the only thing you could do is changing your virtualization software.
Try to play with mono runtime options, but I'm not sure that'll be
effective.

Regards,
Nikits


2013/12/20 Nicolas Antoniazzi &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">nicolas.antoniazzi at gmail.com</A>&gt;

&gt;<i> I am not using OpenVZ but a solution that we developed based on Linux
</I>&gt;<i> kernel calls because we really need to bootstrap a virtual environment in
</I>&gt;<i> less than 50ms.
</I>&gt;<i> I tested the same program on a .Net platform and after 1000 threads
</I>&gt;<i> created, the whole application used 48MB of RAM. It sounds really strange
</I>&gt;<i> to me that a Thread, that in theory should be a light process, takes 65MB
</I>&gt;<i> of virtual memory.
</I>&gt;<i>
</I>&gt;<i> In the meantime, I am not expert in differences between virtual and
</I>&gt;<i> physical memory, but, does your answer mean that if mono would detects that
</I>&gt;<i> my system only has 500MB of physical memory, it would reserve less amount
</I>&gt;<i> of memory per thread?
</I>&gt;<i>
</I>&gt;<i> Maybe there is a way to send some parameters to mono or to change some
</I>&gt;<i> content in /proc to simulate a smaller amount of physical memory?
</I>&gt;<i>
</I>&gt;<i> Thanks for your answer!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2013/12/20 Nikita Tsukanov &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">keks9n at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;&gt;<i> Don't use OpenVZ, it limits _virtual_ memory, not physical. Mono threads
</I>&gt;&gt;<i> use a small amount of physical memory, but might reserve high of virtual
</I>&gt;&gt;<i> memory space. You'd rather try KVM/Xen virtualization.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i> Nikita
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2013/12/19 Nicolas Antoniazzi &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">nicolas.antoniazzi at gmail.com</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I am using Mono in a virtualized environment with 512MB of RAM.
</I>&gt;&gt;&gt;<i> I made a very simple program which starts 10 threads in a loop and
</I>&gt;&gt;&gt;<i> apparently, every time that I start a new thread, approximately 65MB of
</I>&gt;&gt;&gt;<i> memory is used.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In my case, I can run 5 threads, but for the 6th, the program crashes
</I>&gt;&gt;&gt;<i> (without any exception). 150MB are already consumed without the use of any
</I>&gt;&gt;&gt;<i> thread.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Is it a normal behavior?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> P.S: Sorry I double posted this message on mono-list because I did not
</I>&gt;&gt;&gt;<i> understood that third party programmers also had to come on this devel list.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks!
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> Nicolas Antoniazzi
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mono-devel-list mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20131220/6ac0f489/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20131220/6ac0f489/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041021.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
	<LI>Next message: <A HREF="041023.html">[Mono-dev] Size of thread in Mono (65MB per thread?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41022">[ date ]</a>
              <a href="thread.html#41022">[ thread ]</a>
              <a href="subject.html#41022">[ subject ]</a>
              <a href="author.html#41022">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
