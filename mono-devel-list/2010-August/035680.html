<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] News about Bug 623477?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20News%20about%20Bug%20623477%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035679.html">
   <LINK REL="Next"  HREF="035682.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] News about Bug 623477?</H1>
    <B>Torello Querci</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20News%20about%20Bug%20623477%3F&In-Reply-To="
       TITLE="[Mono-dev] News about Bug 623477?">tquerci at gmail.com
       </A><BR>
    <I>Sun Aug 15 01:54:29 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="035679.html">[Mono-dev] [Mono-patches] [mono/mono] b9d711fa: Add a null check to LDFLDA, the spec requires it.
</A></li>
        <LI>Next message: <A HREF="035682.html">[Mono-dev] News about Bug 623477?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35680">[ date ]</a>
              <a href="thread.html#35680">[ thread ]</a>
              <a href="subject.html#35680">[ subject ]</a>
              <a href="author.html#35680">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi to all,

I'm asking news about the Bug 623477
(<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=623477#c1">https://bugzilla.novell.com/show_bug.cgi?id=623477#c1</A>).

I already post a patch but I have no answer about this.
The proposal solution is not the best because I prefer to have the
possibility to change the minimum quantity of memory assignment to the
thread stack size, but give the same behaviour between Windows and
Linux.

Since the patch is very short, I put below (P.S. this patch was
generated in the pre-git era so use the SVN revision number).


Best Regards, Torello.



Index: class/corlib/System.Threading/Thread.cs
===================================================================
--- class/corlib/System.Threading/Thread.cs    (revisione 159957)
+++ class/corlib/System.Threading/Thread.cs    (copia locale)
@@ -976,8 +976,12 @@
         {
             if (start == null)
                 throw new ArgumentNullException (&quot;start&quot;);
-            if (maxStackSize &lt; 131072)
-                throw new ArgumentException (&quot;&lt; 128 kb&quot;, &quot;maxStackSize&quot;);
+            if (maxStackSize &lt; 0)
+                throw new ArgumentException (&quot;&lt; 0 kb&quot;, &quot;maxStackSize&quot;);
+            if (maxStackSize &lt; 262144)
+                maxStackSize = 262144;
+            if ((maxStackSize | 0xffff) != 0)
+                maxStackSize = (maxStackSize | 0xffff)+0xffff;

             threadstart = start;
             Internal.stack_size = maxStackSize;
@@ -995,8 +999,12 @@
         {
             if (start == null)
                 throw new ArgumentNullException (&quot;start&quot;);
-            if (maxStackSize &lt; 131072)
-                throw new ArgumentException (&quot;&lt; 128 kb&quot;, &quot;maxStackSize&quot;);
+            if (maxStackSize &lt; 0)
+                throw new ArgumentException (&quot;&lt; 0 kb&quot;, &quot;maxStackSize&quot;);
+            if (maxStackSize &lt; 262144)
+                maxStackSize = 262144;
+            if ((maxStackSize | 0xffff) != 0)
+                maxStackSize = (maxStackSize | 0xffff)+0xffff;

             threadstart = start;
             Internal.stack_size = maxStackSize;
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035679.html">[Mono-dev] [Mono-patches] [mono/mono] b9d711fa: Add a null check to LDFLDA, the spec requires it.
</A></li>
	<LI>Next message: <A HREF="035682.html">[Mono-dev] News about Bug 623477?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35680">[ date ]</a>
              <a href="thread.html#35680">[ thread ]</a>
              <a href="subject.html#35680">[ subject ]</a>
              <a href="author.html#35680">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
