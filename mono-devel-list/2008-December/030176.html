<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono C# + IOCTL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20C%23%20%2B%20IOCTL&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030175.html">
   <LINK REL="Next"  HREF="030052.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono C# + IOCTL</H1>
    <B>Alex</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20C%23%20%2B%20IOCTL&In-Reply-To="
       TITLE="[Mono-dev] Mono C# + IOCTL">rdynm at yahoo.com
       </A><BR>
    <I>Sat Dec 13 22:56:47 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="030175.html">[Mono-dev] Mono C# + IOCTL
</A></li>
        <LI>Next message: <A HREF="030052.html">[Mono-dev] mono+linux C# Hugh performance timer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30176">[ date ]</a>
              <a href="thread.html#30176">[ thread ]</a>
              <a href="subject.html#30176">[ subject ]</a>
              <a href="author.html#30176">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yea I just used pseudo code. The problem is that mono c# does not support PF_PACKET so the only way around it
is to pretty much implement it from scratch using marshaling and unamanged code imports. I'm half way there my code looks
something like that for now:
[DllImport(&quot;libc.so.6&quot;)]
    public static extern int socket(int domain, int type, int protocol);
    [DllImport(&quot;libc.so.6&quot;)]
    public static extern int send(int s, [MarshalAs(UnmanagedType.LPArray)] byte[] buf, int len, int flags);
    [DllImport(&quot;libc.so.6&quot;)]
    public static extern int recv(int s, [MarshalAs(UnmanagedType.LPArray)] byte[] buf, int len, int flags);

This allows me to create the socket and send/recv data. Still need to implement bind. 
I wish there was a way to link that fd returned by socket to the native c# socket class but up to my knowledge there isn't.

-Alex





________________________________
From: Gonzalo Paniagua Javier &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">gonzalo.mono at gmail.com</A>&gt;
To: Alex &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">rdynm at yahoo.com</A>&gt;
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Sent: Saturday, December 13, 2008 10:38:37 PM
Subject: Re: [Mono-dev] Mono C# + IOCTL

On Thu, 2008-12-11 at 19:26 -0800, Alex wrote:
&gt;<i> Just tried it out, it produced an exception.
</I>&gt;<i> 
</I>&gt;<i> Unhandled Exception: System.Net.Sockets.SocketException: Bad address
</I>&gt;<i>          
</I>&gt;<i>  Socket s = new Socket(AddressFamily.InterNetwork, SocketType.Raw,
</I>&gt;<i> ProtocolType.Ggp);
</I>&gt;<i>  s.IOControl(0x8933, null, null);
</I>
This is not the way to use ioctl in C. You need additional parameters.
See netdevice(7).

-Gonzalo


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081213/56d22626/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20081213/56d22626/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030175.html">[Mono-dev] Mono C# + IOCTL
</A></li>
	<LI>Next message: <A HREF="030052.html">[Mono-dev] mono+linux C# Hugh performance timer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30176">[ date ]</a>
              <a href="thread.html#30176">[ thread ]</a>
              <a href="subject.html#30176">[ subject ]</a>
              <a href="author.html#30176">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
