<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono svn and ppc
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20svn%20and%20ppc&In-Reply-To=494B0682.5050608%40us.ibm.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030263.html">
   <LINK REL="Next"  HREF="030277.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono svn and ppc</H1>
    <B>Andreas F&#228;rber</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20svn%20and%20ppc&In-Reply-To=494B0682.5050608%40us.ibm.com"
       TITLE="[Mono-dev] Mono svn and ppc">andreas.faerber at web.de
       </A><BR>
    <I>Fri Dec 19 07:05:18 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="030263.html">[Mono-dev] Mono svn and ppc
</A></li>
        <LI>Next message: <A HREF="030277.html">[Mono-dev] Mono svn and ppc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30271">[ date ]</a>
              <a href="thread.html#30271">[ thread ]</a>
              <a href="subject.html#30271">[ subject ]</a>
              <a href="author.html#30271">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Am 19.12.2008 um 03:27 schrieb Steven Munroe:

&gt;<i> Paul wrote:
</I>&gt;&gt;<i> Is mono svn working yet with ppc (not ppc64)? I had to disable it for
</I>&gt;&gt;<i> fedora rawhide as there is a signing problem on PPC which looks to  
</I>&gt;&gt;<i> have
</I>&gt;&gt;<i> come from a revision at 121203.
</I>&gt;<i>
</I>&gt;<i> found the bug. The update to mini-ppc.c (emit_memcpy) replaced  
</I>&gt;<i> ppc_lwzu
</I>&gt;<i> macro with ppc_load_reg_update, but the definition of
</I>&gt;<i> ppc_load_reg_update for PPC32 in ppc-codegen.h did not account for
</I>&gt;<i> reorders parms (ppc_lwz (c, Rd, d, Ra) vs lwzu (c, Rd, Ra, d)).
</I>
That's odd. In my Git tree I was able to bootstrap ppc32 on OSX and  
Fedora with my macros, no signing issues.

I had notified Mark that some macros were not committed to SVN in  
their final MIT-licensed form (e.g., ppc_ld/std with ugly ds field),  
but I didn't have time to look into it since then.

As for the argument order, I originally had the new macros with  
instruction field order and then in the non-indented version fixed  
them to reflect assembler field order, as was done for most other  
macros. At least one existing but unused macro was wrong in that  
aspect and fixed in my tree.
For compatibility, I think it's best to keep/use assembler argument  
order for instruction macros to allow interchange with real assembler  
code. The meta-macros are up to us but were intended as drop-in  
replacements for the 32-bit macros.

Andreas

&gt;<i> Net: ppc_lwz is in assembler operand order while ppc_lwzu is  
</I>&gt;<i> instuction
</I>&gt;<i> field order. The lhzu, lhau, lha, lbzu follow the lwzu form. The  
</I>&gt;<i> rest of
</I>&gt;<i> the loads and stores follow the ppc_pwz form.
</I>&gt;<i>
</I>&gt;<i> In the long run we should make these consistent but in the short term
</I>&gt;<i> the attached patch will get the PPC32 mono build working again.
</I>&gt;<i> diff -urN mono-svn-20081216/mono/mono/arch/ppc/ppc-codegen.h mono- 
</I>&gt;<i> svn64/mono/mono/arch/ppc/ppc-codegen.h
</I>&gt;<i> --- mono-svn-20081216/mono/mono/arch/ppc/ppc-codegen.h	2008-12-16  
</I>&gt;<i> 10:45:37.000000000 -0600
</I>&gt;<i> +++ mono-svn64/mono/mono/arch/ppc/ppc-codegen.h	2008-12-18  
</I>&gt;<i> 19:41:31.000000000 -0600
</I>&gt;<i> @@ -150,7 +150,7 @@
</I>&gt;<i> #define ppc_load_func(c,D,V)	      ppc_load_sequence ((c), (D), (V))
</I>&gt;<i>
</I>&gt;<i> #define ppc_load_reg(c,D,d,A)         ppc_lwz  ((c), (D), (d), (A))
</I>&gt;<i> -#define ppc_load_reg_update(c,D,d,A)  ppc_lwzu ((c), (D), (d), (A))
</I>&gt;<i> +#define ppc_load_reg_update(c,D,d,A)  ppc_lwzu ((c), (D), (A), (d))
</I>&gt;<i> #define ppc_load_reg_indexed(c,D,A,B)        ppc_lwzx ((c), (D),  
</I>&gt;<i> (A), (B))
</I>&gt;<i> #define ppc_load_reg_update_indexed(c,D,A,B) ppc_lwzux ((c), (D),  
</I>&gt;<i> (A), (B))
</I>&gt;<i> #define ppc_load_multiple_regs(c,D,A,d)      ppc_lmw   ((c), (D),  
</I>&gt;<i> (A), (d))
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030263.html">[Mono-dev] Mono svn and ppc
</A></li>
	<LI>Next message: <A HREF="030277.html">[Mono-dev] Mono svn and ppc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30271">[ date ]</a>
              <a href="thread.html#30271">[ thread ]</a>
              <a href="subject.html#30271">[ subject ]</a>
              <a href="author.html#30271">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
