<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Multiplatform support with P/Invoke
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Multiplatform%20support%20with%20P/Invoke&In-Reply-To=%3C5685D346.1040803%40arcor.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="043438.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Multiplatform support with P/Invoke</H1>
    <B>Jason Curl</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Multiplatform%20support%20with%20P/Invoke&In-Reply-To=%3C5685D346.1040803%40arcor.de%3E"
       TITLE="[Mono-dev] Multiplatform support with P/Invoke">jcurlnews at arcor.de
       </A><BR>
    <I>Fri Jan  1 01:15:50 UTC 2016</I>
    <P><UL>
        
        <LI>Next message: <A HREF="043438.html">[Mono-dev] Multiplatform support with P/Invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43437">[ date ]</a>
              <a href="thread.html#43437">[ thread ]</a>
              <a href="subject.html#43437">[ subject ]</a>
              <a href="author.html#43437">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you Mr. Icaza.

Is there more information on what uses the MapAttribute than what's in 
Syscall.cs? Even though it's internal and I won't use it, I'd like to 
understand how you solve the problem of ABI compatibility.

I'd like to set up a solution where copying the files from one 
architecture to another simply works (assuming all dependencies from the 
runtime are present), and the runtime/mylib chooses the most appropriate 
native library (based on OSVersion and Syscall.uname) for all supported 
platforms. Something like:
* MyLib.dll (assembly)
* MyNativeLib.Linux.x86.so
* MyNativeLib.Linux.x64.so
* MyNativeLib.FreeBSD.x86.so
* MyNativeLib.Darwin.x86.so
* MyNativeLib.Win.x86.dll (windows native)
* MyNativeLib.Win.x64.dll (windows native)
* MyNativeLib.[dll|so] (backup for local builds)

Your solution (Mono.Unix.Native) looks different, more compact, but I'm 
not sure if/how it supports side-by-side. My solution requires a lot of 
work, duplicate code with small changes in defining the 
structs/DllImports with different offsets and library names.

I've yet to look into the Dll mapping mechanism of Mono if that's also 
suitable.

Thank you very much and for giving me the opportunity to use Mono.

Regards,
Jason.

On 2015-12-31 02:04, Miguel de Icaza wrote:
&gt;<i> For something like libc, you can use an approach similar to what 
</I>&gt;<i> Mono.Posix does, where an intermediate C glue file acts as a bridge 
</I>&gt;<i> between the API differences.
</I>&gt;<i>
</I>&gt;<i> See the P/Invokes for the Mono.Posix assembly, and its supporting glue 
</I>&gt;<i> code in mono/support/
</I>&gt;<i>
</I>&gt;<i> On Wed, Dec 30, 2015 at 5:58 AM, Jason Curl &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jcurlnews at arcor.de</A> 
</I>&gt;<i> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jcurlnews at arcor.de</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     Hello,
</I>&gt;<i>
</I>&gt;<i>     I'm investigating the best way on how to support multiplatform
</I>&gt;<i>     software especially when using P/Invokes, but have not found any
</I>&gt;<i>     reasonable advice on the Wiki.
</I>&gt;<i>
</I>&gt;<i>     Can someone point to me on how to handle different architectures,
</I>&gt;<i>     especially when the underlying libc might use different structures
</I>&gt;<i>     or API signatures?
</I>&gt;<i>
</I>&gt;<i>     Thanks,
</I>&gt;<i>     Jason.
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     Mono-devel-list mailing list
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20160101/067c6af3/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20160101/067c6af3/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="043438.html">[Mono-dev] Multiplatform support with P/Invoke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43437">[ date ]</a>
              <a href="thread.html#43437">[ thread ]</a>
              <a href="subject.html#43437">[ subject ]</a>
              <a href="author.html#43437">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
