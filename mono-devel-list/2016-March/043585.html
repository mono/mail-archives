<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Cross%20Platform%20on%20Linux/Windows%20with%20Mono.Posix%0A%20reference%20on%20Linux&In-Reply-To=%3CBN3PR0801MB115404ACAFB0B7A8165D399BFA870%40BN3PR0801MB1154.namprd08.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043578.html">
   <LINK REL="Next"  HREF="043586.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux</H1>
    <B>Edward Ned Harvey (mono)</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Cross%20Platform%20on%20Linux/Windows%20with%20Mono.Posix%0A%20reference%20on%20Linux&In-Reply-To=%3CBN3PR0801MB115404ACAFB0B7A8165D399BFA870%40BN3PR0801MB1154.namprd08.prod.outlook.com%3E"
       TITLE="[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux">edward.harvey.mono at clevertrove.com
       </A><BR>
    <I>Tue Mar 29 03:27:10 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="043578.html">[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux
</A></li>
        <LI>Next message: <A HREF="043586.html">[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43585">[ date ]</a>
              <a href="thread.html#43585">[ thread ]</a>
              <a href="subject.html#43585">[ subject ]</a>
              <a href="author.html#43585">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> From: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:mono-devel-list-
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bounces at lists.ximian.com</A>] On Behalf Of Greg Young
</I>&gt;<i> 
</I>&gt;<i> &lt;Reference Include=&quot;Mono.Posix&quot; Condition=&quot; '$(OS)' != 'Windows_NT' &quot; /&gt;
</I>
That doesn't do the trick all by itself, because then your code won't compile on windows, in all the places where something references Mono.Posix. If you want to use this as a solution, you'll need to define a compiler symbol in the project, and maintain different project files (or different build configurations) when building on windows or mono, and then #if to remove references to Mono.Posix, when built in windows. While this technique works, it would result in binaries that are not cross-platform compatible (maybe you don't care). And you have to maintain the separate project files, which is annoying.

The other way is to build a factory, and do a run-time check to load the appropriate assembly. For example, you can put the abstract StuffDoer class in a common assembly, which is available to all your platform agnostic code. Then write a StuffDoerWin derivative class in a windows-only assembly, and a StuffDoerMono class in a mono-only assembly. Choose which one to instantiate using a run-time check, like:

// This is defined in a common assembly
public static abstract class StuffDoer {
	public static StuffDoer CreateInstance() {
		if (Type.GetType(&quot;Mono.Runtime&quot;) == null) {
			// running on windows
			// Use Activator.CreateInstance to return an object of type StuffDoerWin, from my Windows assembly
			return newStuffDoer;
		} else {
			// running on mono
			// Use Activator.CreateInstance to return an object of type StuffDoerMono, from my Mono assembly
			return newStuffDoer;		}
	}
	public abstract void DoStuff();  // Must be overridden in derivative class
}

// This is defined in a windows-only assembly
public static class StuffDoerWin : StuffDoer {
	...
}

// This is defined in a mono-only assembly
public static class StuffDoerMono : StuffDoer {
	// Here, I can use Mono.Posix stuff
	...
}
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043578.html">[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux
</A></li>
	<LI>Next message: <A HREF="043586.html">[Mono-dev] Cross Platform on Linux/Windows with Mono.Posix reference on Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43585">[ date ]</a>
              <a href="thread.html#43585">[ thread ]</a>
              <a href="subject.html#43585">[ subject ]</a>
              <a href="author.html#43585">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
