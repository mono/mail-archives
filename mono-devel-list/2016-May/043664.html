<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] TCP connects
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20TCP%20connects&In-Reply-To=%3CCAC9RQtidMJGqAM_DYVXZR5uVAF2zAWn84Zc7emx33FMsxSKx7w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043661.html">
   <LINK REL="Next"  HREF="043669.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] TCP connects</H1>
    <B>Greg Young</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20TCP%20connects&In-Reply-To=%3CCAC9RQtidMJGqAM_DYVXZR5uVAF2zAWn84Zc7emx33FMsxSKx7w%40mail.gmail.com%3E"
       TITLE="[Mono-dev] TCP connects">gregoryyoung1 at gmail.com
       </A><BR>
    <I>Fri May 27 08:18:39 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="043661.html">[Mono-dev] TCP connects
</A></li>
        <LI>Next message: <A HREF="043669.html">[Mono-dev] Mono crashes on copying of running profiler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43664">[ date ]</a>
              <a href="thread.html#43664">[ thread ]</a>
              <a href="subject.html#43664">[ subject ]</a>
              <a href="author.html#43664">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK I spent some more time looking through this. There is a ton of not
really async stuff happening in async methods also
cancellations/timeouts/etc don't work properly. Moral of the story for
people searching this in the future etc, use the PCL version which
seems to work thus far.



On Thu, May 26, 2016 at 5:36 PM, Greg Young &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">gregoryyoung1 at gmail.com</A>&gt; wrote:
&gt;<i> In looking through a recent issue, when a node disappears we end up with:
</I>&gt;<i>
</I>&gt;<i> &quot;Threadpool worker&quot; at &lt;unknown&gt; &lt;0xffffffff&gt;
</I>&gt;<i> at (wrapper managed-to-native)
</I>&gt;<i> System.Net.Sockets.Socket.Connect_internal
</I>&gt;<i> (intptr,System.Net.SocketAddress,int&amp;) &lt;0xffffffff&gt;
</I>&gt;<i> at System.Net.Sockets.Socket.Connect (System.Net.EndPoint) &lt;0x00135&gt;
</I>&gt;<i> at System.Net.WebConnection.Connect (System.Net.HttpWebRequest) &lt;0x00615&gt;
</I>&gt;<i> at System.Net.WebConnection.InitConnection (object) &lt;0x0031a&gt;
</I>&gt;<i> at System.Net.WebConnection.&lt;WebConnection&gt;m__0 (object) &lt;0x00024&gt;
</I>&gt;<i> at (wrapper runtime-invoke)
</I>&gt;<i> &lt;Module&gt;.runtime_invoke_void__this___object
</I>&gt;<i> (object,intptr,intptr,intptr) &lt;0xffffffff&gt;
</I>&gt;<i>
</I>&gt;<i> &quot;Threadpool worker&quot; at &lt;unknown&gt; &lt;0xffffffff&gt;
</I>&gt;<i> at (wrapper managed-to-native)
</I>&gt;<i> System.Net.Sockets.Socket.Connect_internal
</I>&gt;<i> (intptr,System.Net.SocketAddress,int&amp;) &lt;0xffffffff&gt;
</I>&gt;<i> at System.Net.Sockets.Socket.Connect (System.Net.EndPoint) &lt;0x00135&gt;
</I>&gt;<i> at System.Net.WebConnection.Connect (System.Net.HttpWebRequest) &lt;0x00615&gt;
</I>&gt;<i> at System.Net.WebConnection.InitConnection (object) &lt;0x0031a&gt;
</I>&gt;<i> at System.Net.WebConnection.&lt;WebConnection&gt;m__0 (object) &lt;0x00024&gt;
</I>&gt;<i> at (wrapper runtime-invoke)
</I>&gt;<i> &lt;Module&gt;.runtime_invoke_void__this___object
</I>&gt;<i> (object,intptr,intptr,intptr) &lt;0xffffffff&gt;
</I>&gt;<i>
</I>&gt;<i> On every thread from our async code. As the connection is timing out
</I>&gt;<i> the entire ThreadPool very quickly blocks.
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://github.com/mono/mono/blob/master/mcs/class/System/System.Net/WebConnection.cs#L195">https://github.com/mono/mono/blob/master/mcs/class/System/System.Net/WebConnection.cs#L195</A>
</I>&gt;<i>
</I>&gt;<i> I am guessing the right fix here would be to use async connect?
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> Greg
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Studying for the Turing test
</I>


-- 
Studying for the Turing test
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043661.html">[Mono-dev] TCP connects
</A></li>
	<LI>Next message: <A HREF="043669.html">[Mono-dev] Mono crashes on copying of running profiler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43664">[ date ]</a>
              <a href="thread.html#43664">[ thread ]</a>
              <a href="subject.html#43664">[ subject ]</a>
              <a href="author.html#43664">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
