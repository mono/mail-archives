<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] culture info patches
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20culture%20info%20patches&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004587.html">
   <LINK REL="Next"  HREF="004599.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] culture info patches</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20culture%20info%20patches&In-Reply-To="
       TITLE="[Mono-devel-list] culture info patches">05mauben at hawken.edu
       </A><BR>
    <I>Tue Mar 16 10:07:04 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="004587.html">[Mono-devel-list] MonoDevelop on Windows
</A></li>
        <LI>Next message: <A HREF="004599.html">[Mono-devel-list] culture info patches
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4589">[ date ]</a>
              <a href="thread.html#4589">[ thread ]</a>
              <a href="subject.html#4589">[ subject ]</a>
              <a href="author.html#4589">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

In general this looks very nice. One specific comment I had from looking
at the code:

So in the tables we have stuff like:
static const CultureInfoEntry culture_entries [] = {

{0x0009, &quot;English&quot;, &quot;English&quot;, &quot;English&quot;, &quot;eng&quot;, &quot;en&quot;, -1, -1},

{0x1009, &quot;English (Canada)&quot;, &quot;English (Canada)&quot;, &quot;English (Canada)&quot;,
&quot;eng&quot;, &quot;en&quot;, 0, 0},

{0x0409, &quot;English (United States)&quot;, &quot;English (United States)&quot;, &quot;English
(United States)&quot;, &quot;eng&quot;, &quot;en&quot;, 1, 1},

As I understand it, a string like &quot;English&quot; gets created multiple times
when you create the culture info. Maybe you need some interning here.
This would help in other places too: for example, all the english
varients use the same names for the days of the week, so you save a
creation there.

Also, can you open up monodevelop and do stuff. I know that requires
culture info stuff.

-- Ben

&gt;&gt;&gt;<i> Jackson Harper &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jackson at ximian.com</A>&gt; 03/16/04 03:53 AM &gt;&gt;&gt;
</I>Here is a semi-finished set of patches to our CultureInfo
implementation. These patches move the data into the runtime so ICU is
not needed. The data is generated from the open18n xml files and the
generator is configurable so we can easily &quot;patch&quot; data without editing
the existing xml files (so we can stay in sync easily). I was able to do
a full bootstrap (in en_CA, and en_US) and run xsp with these patches
applied.

I've only included a small subset of the generated data to keep the
patch small and to make testing a little easier. cultures supported are
en_CA, en_US, es_ES, and ja_JP. I also haven't included the
locale-builder tool.

To use the existing CultureInfo w/ICU implementation instead of the new
one you can set the env var MONO_ICU_CULTURE_INFO to TRUE.

There is still some work to do but feedback is appreciated.

Love,
Jackson


TODO: 
- Still not getting all the data into tables, lots of String.Emptys
right now
- Only generate the CultureMap in CultureInfo.cs for supported cultures
- Make generated tables more prettier
- Add headers to Makefile.am

ChangeLog:
icall.c: New icall for constructing CultureInfo's from lcid.
locales.c: Fill in CultureInfo objects from culture table data.
culture-info.h: CultureInfo data structs. Each culture info entry has an
index into the number format table, and the date time format table
unless the entry is a neutral culture, then it has -1 for its indexes.
culture-info-tables.h: Generated locale data. This file is generated by
locale-builder.exe

CultureInfo.cs: Construct culture infos using the new from_lcid method
unless an env var is set.





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004587.html">[Mono-devel-list] MonoDevelop on Windows
</A></li>
	<LI>Next message: <A HREF="004599.html">[Mono-devel-list] culture info patches
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4589">[ date ]</a>
              <a href="thread.html#4589">[ thread ]</a>
              <a href="subject.html#4589">[ subject ]</a>
              <a href="author.html#4589">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
