<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Interoperatbility between Unmanaged and Managed Programs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Interoperatbility%20between%20Unmanaged%20and%20Managed%20Programs&In-Reply-To=opr4na91i4hx8kav%40email.uni-linz.ac.at">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004481.html">
   <LINK REL="Next"  HREF="004519.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Interoperatbility between Unmanaged and Managed Programs</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Interoperatbility%20between%20Unmanaged%20and%20Managed%20Programs&In-Reply-To=opr4na91i4hx8kav%40email.uni-linz.ac.at"
       TITLE="[Mono-devel-list] Interoperatbility between Unmanaged and Managed Programs">lupus at ximian.com
       </A><BR>
    <I>Fri Mar 12 10:14:34 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="004481.html">[Mono-devel-list] Interoperatbility between Unmanaged and	Managed Programs
</A></li>
        <LI>Next message: <A HREF="004519.html">[Mono-devel-list] Interoperatbility between Unmanaged and	Managed Programs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4513">[ date ]</a>
              <a href="thread.html#4513">[ thread ]</a>
              <a href="subject.html#4513">[ subject ]</a>
              <a href="author.html#4513">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/10/04 Friedrich Priewasser wrote:
&gt;<i> For my thesis I have to implement a runtime mechanism that allows managed 
</I>&gt;<i> programs to use unmanaged objects and vice versa. If I'm rigth the best 
</I>&gt;<i> way to do this is to implement COM, XPCOM or ORBit.
</I>&gt;<i> My questions about that are:
</I>&gt;<i> Which of these technologies is the best to solve my problem (if you think 
</I>&gt;<i> I should use one of this)?
</I>&gt;<i> Has there be done any work in mono to use unmanaged objects?
</I>
I described the process in a mail to the list some time ago, you may
want to google for it. Basically, apart from the other options mentioned
already, the runtime support would involve (for COM, XPCOM and the
like):
*) a tool to export COM/XPCOM/etc interfaces to a managed assembly
(using the import flag for types and methods).
*) an interface in the C runtime to enable the loading of C modules
which implement the support for one of COM, XPCOM, etc. The
implementation should go into a loadable module to avoid bloating the
runtime and keeping a clean design for the different object technologies.
The interface would allow for detection (which module implements a given
type/interface), creation of objects and creation of the marshaling
methods from managed to unmanaged world (in a similar way it's done for
P/Invoke methods now in metadata/marshal.c).
*) changes to the jit so that when a method with the import flag needs
to be compiled, control is transfered to the modules that handles the
type (typically identified by a GUID): the module will create the IL
code on the fly and the jit will compile that.

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004481.html">[Mono-devel-list] Interoperatbility between Unmanaged and	Managed Programs
</A></li>
	<LI>Next message: <A HREF="004519.html">[Mono-devel-list] Interoperatbility between Unmanaged and	Managed Programs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4513">[ date ]</a>
              <a href="thread.html#4513">[ thread ]</a>
              <a href="subject.html#4513">[ subject ]</a>
              <a href="author.html#4513">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
