<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] culture info patches
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20culture%20info%20patches&In-Reply-To=s056d1f1.063%40gm004.hawken.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004616.html">
   <LINK REL="Next"  HREF="004601.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] culture info patches</H1>
    <B>Jackson Harper</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20culture%20info%20patches&In-Reply-To=s056d1f1.063%40gm004.hawken.edu"
       TITLE="[Mono-devel-list] culture info patches">jackson at ximian.com
       </A><BR>
    <I>Tue Mar 16 10:30:48 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="004616.html">[Mono-devel-list] mod_mono, xsp and apache 2.0
</A></li>
        <LI>Next message: <A HREF="004601.html">[Mono-devel-list] culture info patches
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4593">[ date ]</a>
              <a href="thread.html#4593">[ thread ]</a>
              <a href="subject.html#4593">[ subject ]</a>
              <a href="author.html#4593">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

	Yeah originally I wanted to do that but for the sake of keeping the
code clean for now I've decided to let the data be duplicated. One nice
thing with the setup I have now is that the date format and number
format tables can be 'compressed' by eliminating duplicate rows and
having culture info entries share the same indexes.

Jackson


On Tue, 2004-03-16 at 07:07, Ben Maurer wrote:
&gt;<i> Hey,
</I>&gt;<i> 
</I>&gt;<i> In general this looks very nice. One specific comment I had from looking
</I>&gt;<i> at the code:
</I>&gt;<i> 
</I>&gt;<i> So in the tables we have stuff like:
</I>&gt;<i> static const CultureInfoEntry culture_entries [] = {
</I>&gt;<i> 
</I>&gt;<i> {0x0009, &quot;English&quot;, &quot;English&quot;, &quot;English&quot;, &quot;eng&quot;, &quot;en&quot;, -1, -1},
</I>&gt;<i> 
</I>&gt;<i> {0x1009, &quot;English (Canada)&quot;, &quot;English (Canada)&quot;, &quot;English (Canada)&quot;,
</I>&gt;<i> &quot;eng&quot;, &quot;en&quot;, 0, 0},
</I>&gt;<i> 
</I>&gt;<i> {0x0409, &quot;English (United States)&quot;, &quot;English (United States)&quot;, &quot;English
</I>&gt;<i> (United States)&quot;, &quot;eng&quot;, &quot;en&quot;, 1, 1},
</I>&gt;<i> 
</I>&gt;<i> As I understand it, a string like &quot;English&quot; gets created multiple times
</I>&gt;<i> when you create the culture info. Maybe you need some interning here.
</I>&gt;<i> This would help in other places too: for example, all the english
</I>&gt;<i> varients use the same names for the days of the week, so you save a
</I>&gt;<i> creation there.
</I>&gt;<i> 
</I>&gt;<i> Also, can you open up monodevelop and do stuff. I know that requires
</I>&gt;<i> culture info stuff.
</I>&gt;<i> 
</I>&gt;<i> -- Ben
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt;&gt; Jackson Harper &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jackson at ximian.com</A>&gt; 03/16/04 03:53 AM &gt;&gt;&gt;
</I>&gt;<i> Here is a semi-finished set of patches to our CultureInfo
</I>&gt;<i> implementation. These patches move the data into the runtime so ICU is
</I>&gt;<i> not needed. The data is generated from the open18n xml files and the
</I>&gt;<i> generator is configurable so we can easily &quot;patch&quot; data without editing
</I>&gt;<i> the existing xml files (so we can stay in sync easily). I was able to do
</I>&gt;<i> a full bootstrap (in en_CA, and en_US) and run xsp with these patches
</I>&gt;<i> applied.
</I>&gt;<i> 
</I>&gt;<i> I've only included a small subset of the generated data to keep the
</I>&gt;<i> patch small and to make testing a little easier. cultures supported are
</I>&gt;<i> en_CA, en_US, es_ES, and ja_JP. I also haven't included the
</I>&gt;<i> locale-builder tool.
</I>&gt;<i> 
</I>&gt;<i> To use the existing CultureInfo w/ICU implementation instead of the new
</I>&gt;<i> one you can set the env var MONO_ICU_CULTURE_INFO to TRUE.
</I>&gt;<i> 
</I>&gt;<i> There is still some work to do but feedback is appreciated.
</I>&gt;<i> 
</I>&gt;<i> Love,
</I>&gt;<i> Jackson
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> TODO: 
</I>&gt;<i> - Still not getting all the data into tables, lots of String.Emptys
</I>&gt;<i> right now
</I>&gt;<i> - Only generate the CultureMap in CultureInfo.cs for supported cultures
</I>&gt;<i> - Make generated tables more prettier
</I>&gt;<i> - Add headers to Makefile.am
</I>&gt;<i> 
</I>&gt;<i> ChangeLog:
</I>&gt;<i> icall.c: New icall for constructing CultureInfo's from lcid.
</I>&gt;<i> locales.c: Fill in CultureInfo objects from culture table data.
</I>&gt;<i> culture-info.h: CultureInfo data structs. Each culture info entry has an
</I>&gt;<i> index into the number format table, and the date time format table
</I>&gt;<i> unless the entry is a neutral culture, then it has -1 for its indexes.
</I>&gt;<i> culture-info-tables.h: Generated locale data. This file is generated by
</I>&gt;<i> locale-builder.exe
</I>&gt;<i> 
</I>&gt;<i> CultureInfo.cs: Construct culture infos using the new from_lcid method
</I>&gt;<i> unless an env var is set.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004616.html">[Mono-devel-list] mod_mono, xsp and apache 2.0
</A></li>
	<LI>Next message: <A HREF="004601.html">[Mono-devel-list] culture info patches
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4593">[ date ]</a>
              <a href="thread.html#4593">[ thread ]</a>
              <a href="subject.html#4593">[ subject ]</a>
              <a href="author.html#4593">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
