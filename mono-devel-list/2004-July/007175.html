<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] VB.NET runtime
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20VB.NET%20runtime&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007174.html">
   <LINK REL="Next"  HREF="007176.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] VB.NET runtime</H1>
    <B>Rob.Tillie at Student.tUL.EDU</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20VB.NET%20runtime&In-Reply-To="
       TITLE="[Mono-devel-list] VB.NET runtime">Rob.Tillie at Student.tUL.EDU
       </A><BR>
    <I>Fri Jul 23 15:24:00 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007174.html">[Mono-devel-list] Security enhancement in Framework 2.0 Plans
</A></li>
        <LI>Next message: <A HREF="007176.html">[Mono-devel-list] Idea: Bittorrent and Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7175">[ date ]</a>
              <a href="thread.html#7175">[ thread ]</a>
              <a href="subject.html#7175">[ subject ]</a>
              <a href="author.html#7175">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Dave,

Everything now has a DefaultValueAttribute in the MS.VB namespace, but this
is the wrong one, that's why it is in System.ComponentModel. It is primarily
used for IDEs. In short, the thing doesn't emit the IL code for an optional
parameter, and shouldn't do this either.
Please look in the archives of the list, this already has been discussed.

(PS: I know it is bad programming, but since we want to be API compatible we
need the correct signature, we can't accomplish this by using overloads...)

Thanks for the input!

Greetz,
-- Rob.

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Dave Mertens [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">dmertens at zyprexia.com</A>]
</I>&gt;<i> Sent: Wednesday, July 21, 2004 1:19 PM
</I>&gt;<i> To: 'Iain McCoy'; 'A Rafael D Teixeira'
</I>&gt;<i> Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-vb-list at lists.ximian.com</A>
</I>&gt;<i> Subject: RE: [Mono-devel-list] VB.NET runtime
</I>&gt;<i> 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  On Tue, 2004-07-20 at 04:48, A Rafael D Teixeira wrote:
</I>&gt;<i> &gt;  &gt; That is true, but what is missing is how to create the
</I>&gt;<i> &gt;  defaultvalue
</I>&gt;<i> &gt;  &gt; metadata. That feature is not available as an attribute. There are
</I>&gt;<i> &gt;  &gt; attributes to govern how non-simple values (DateTimes and
</I>&gt;<i> &gt;  Decimals,
</I>&gt;<i> &gt;  &gt; for
</I>&gt;<i> &gt;  &gt; example) are stored as default values, but not to say the default
</I>&gt;<i> &gt;  &gt; value itself.
</I>&gt;<i> &gt;  Sure, it's not, but is there any reason why it *can't* be
</I>&gt;<i> &gt;  available as an attribute?
</I>&gt;<i> 
</I>&gt;<i> There is actually an attribute for setting the defaultvalue. It's simply
</I>&gt;<i> called DefaultValueAttribute	and can be found in the
</I>&gt;<i> System.ComponentModel namespace.
</I>&gt;<i> 
</I>&gt;<i> A call with an optional argument with a default value would be like this:
</I>&gt;<i> Public static function abc(def as string,
</I>&gt;<i> &lt;Optional&gt;&lt;DefaultValue(&quot;xyz&quot;)&gt;klm
</I>&gt;<i> as string) as string
</I>&gt;<i> ...
</I>&gt;<i> End function
</I>&gt;<i> 
</I>&gt;<i> Another way of 'simulating' optional parameters with a default value is
</I>&gt;<i> creating an overloaded function with the specifec argument missing which
</I>&gt;<i> calls on his turn the 'original' with the specific argument hardcoded in
</I>&gt;<i> the
</I>&gt;<i> call.
</I>&gt;<i> Whenever a value is given for the optional value, the CLR will use
</I>&gt;<i> directly
</I>&gt;<i> the original method.
</I>&gt;<i> 
</I>&gt;<i> An example:
</I>&gt;<i> Public static function abc(def as string) as string
</I>&gt;<i> 	return abc(def, &quot;xyz&quot;)	'xyz is here the default value
</I>&gt;<i> End function
</I>&gt;<i> Public static function abc(def as string, klm as string) as string
</I>&gt;<i> ...
</I>&gt;<i> End function
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Both OptionalAttribute and DefaultValueAttribute classes are CLS
</I>&gt;<i> compliant.
</I>&gt;<i> But the use of them is discouraged because method overloading is a far
</I>&gt;<i> better way for implementing default values. Still using the optional
</I>&gt;<i> keyword
</I>&gt;<i> in VB.Net is just bad programming..
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt;  A few random ideas:
</I>&gt;<i> &gt;  * A utility that takes an assembly using the attribute,
</I>&gt;<i> &gt;  removes the attribute and adds the relevant IL.
</I>&gt;<i> &gt;  * This is the class libraries, so presumably they only need
</I>&gt;<i> &gt;  to run on the mono runtime. I believe you could make the
</I>&gt;<i> &gt;  runtime recognize the attribute.
</I>&gt;<i> It's not only the Mono runtime. If an feature called 'optional values'
</I>&gt;<i> will
</I>&gt;<i> be introduced to mono runtime.  But I guess for then only programming for
</I>&gt;<i> Mono and not cross-platform. I want to use the binairies on BOTH windows
</I>&gt;<i> and
</I>&gt;<i> linux and don't want the install mono under windows, because I already
</I>&gt;<i> have
</I>&gt;<i> the MS runtimme..
</I>&gt;<i> 
</I>&gt;<i> Aside from that, it should be the VB.NET compiler which needs to make the
</I>&gt;<i> changes. This would also mean that the binary is cross-platform. But all
</I>&gt;<i> of
</I>&gt;<i> that is unnessacery because .NET already have those features.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> Dave Mertens
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007174.html">[Mono-devel-list] Security enhancement in Framework 2.0 Plans
</A></li>
	<LI>Next message: <A HREF="007176.html">[Mono-devel-list] Idea: Bittorrent and Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7175">[ date ]</a>
              <a href="thread.html#7175">[ thread ]</a>
              <a href="subject.html#7175">[ subject ]</a>
              <a href="author.html#7175">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
