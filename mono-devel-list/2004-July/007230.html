<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] problem execution exe files with mono
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%3D%3Fiso-8859-1%3FQ%3Fproblem_execution_exe_files_with_mono%3F%3D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007228.html">
   <LINK REL="Next"  HREF="007234.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] problem execution exe files with mono</H1>
    <B>rosier_a@oreka.com</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20%3D%3Fiso-8859-1%3FQ%3Fproblem_execution_exe_files_with_mono%3F%3D&In-Reply-To="
       TITLE="[Mono-devel-list] problem execution exe files with mono">rosier_a at oreka.com
       </A><BR>
    <I>Wed Jul 28 10:11:31 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007228.html">[Mono-devel-list] [Patch] the bug 61671 -	OdbcExecuteNonQuery bug
</A></li>
        <LI>Next message: <A HREF="007234.html">[Mono-devel-list] Idea: Bittorrent and Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7230">[ date ]</a>
              <a href="thread.html#7230">[ thread ]</a>
              <a href="subject.html#7230">[ subject ]</a>
              <a href="author.html#7230">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hello,

I try to execute this code :

using System;
using System.Net;
using System.Text;

namespace ExchangeSDK.Snippets.CSharp
{
   class CreatingAnAppointmentWebDAV
   {
      [STAThread]
      static void Main(string[] args)
      {
         // Variables.
         string strExchSvrName = &quot;&quot;;
         string strMailbox = &quot;&quot;;
         string strCalendarUri = &quot;&quot;;
         string strApptItem = &quot;&quot;;
         string strDomain = &quot;&quot;;
         string strUserName = &quot;&quot;;
         string strPassword = &quot;&quot;;
         string strApptRequest = &quot;&quot;;
         string strMailInfo = &quot;&quot;;
				 string strMailInfoVal = &quot;&quot;;
         string strCalInfo = &quot;&quot;;
         string strXMLNSInfo = &quot;&quot;;
         string strHeaderInfo = &quot;&quot;;
				 string strDate = &quot;&quot;;
         System.Net.HttpWebRequest PROPPATCHRequest = null;
         System.Net.WebResponse PROPPATCHResponse = null;
         System.Net.CredentialCache MyCredentialCache = null;
         byte[] bytes = null; 
         System.IO.Stream PROPPATCHRequestStream = null;

         try
         {
				 
				
						 strDate= &quot;2004-07-17&quot;;
						 
						 strMailInfoVal = args[0];
						// strDate = args[1];
						 
            // Exchange server name;
            strExchSvrName = &quot;100.100.1.10&quot;;

            // Mailbox folder name.
            strMailbox = &quot;toto.titi&quot;;

            // Appointment item.
            strApptItem = &quot;testappointment.eml&quot;;

            // URI of the user's calendar folder.
            strCalendarUri = &quot;<A HREF="http://&quot;">http://&quot;</A> + strExchSvrName + &quot;/exchange/&quot;
            + strMailbox + &quot;/Calendrier/&quot;;
						
						Console.WriteLine(strCalendarUri);

            // User name and password of appointment creator.
            strUserName = &quot;titi.toto&quot;;
            strDomain = &quot;Domainname&quot;;
            strPassword = &quot;paswd&quot;;

            // XML namespace info for the WebDAV request.
            strXMLNSInfo = &quot;xmlns:g=\&quot;DAV:\&quot; &quot;
            + &quot;xmlns:e=\&quot;<A HREF="http://schemas.microsoft.com/exchange/\&quot;">http://schemas.microsoft.com/exchange/\&quot;</A> &quot;
            + &quot;xmlns:mapi=\&quot;<A HREF="http://schemas.microsoft.com/mapi/\&quot;">http://schemas.microsoft.com/mapi/\&quot;</A> &quot;
            + &quot;xmlns:mapit=\&quot;<A HREF="http://schemas.microsoft.com/mapi/proptag/\&quot;">http://schemas.microsoft.com/mapi/proptag/\&quot;</A> &quot;
            + &quot;xmlns:x=\&quot;xml:\&quot; xmlns:cal=\&quot;urn:schemas:calendar:\&quot; &quot;
            + &quot;xmlns:dt=\&quot;urn:uuid:c2f41010-65b3-11d1-a29f-00aa00c14882/\&quot; &quot;
            + &quot;xmlns:header=\&quot;urn:schemas:mailheader:\&quot; &quot;
            + &quot;xmlns:mail=\&quot;urn:schemas:httpmail:\&quot;&quot;;

            // Set the appointment item properties.  See the documentation on the properties
	    // in the urn:schemas:calendar: for more information.
            strCalInfo = &quot;&lt;cal:location&gt;meetappt Location&lt;/cal:location&gt;&quot;
            + &quot;&lt;cal:dtstart dt:dt=\&quot;dateTime.tz\&quot;&gt;&quot;+ strDate +&quot;T23:00:00.000Z&lt;/cal:dtstart&gt;&quot;
            + &quot;&lt;cal:dtend dt:dt=\&quot;dateTime.tz\&quot;&gt;&quot;+ strDate +&quot;T23:30:00.000Z&lt;/cal:dtend&gt;&quot;
            + &quot;&lt;cal:instancetype dt:dt=\&quot;int\&quot;&gt;0&lt;/cal:instancetype&gt;&quot;
            + &quot;&lt;cal:busystatus&gt;BUSY&lt;/cal:busystatus&gt;&quot;
            + &quot;&lt;cal:meetingstatus&gt;CONFIRMED&lt;/cal:meetingstatus&gt;&quot;
            + &quot;&lt;cal:alldayevent dt:dt=\&quot;boolean\&quot;&gt;0&lt;/cal:alldayevent&gt;&quot;
            + &quot;&lt;cal:responserequested dt:dt=\&quot;boolean\&quot;&gt;1&lt;/cal:responserequested&gt;&quot;;

            // Set the required attendee of the appointment.
            strHeaderInfo = &quot;&lt;header:to&gt;&quot; + strMailbox + &quot;&lt;/header:to&gt;&quot;;

            // Set the subject of the appointment.
            strMailInfo = &quot;&lt;mail:subject&gt;&quot;+ strMailInfoVal +&quot;&lt;/mail:subject&gt;&quot;
            + &quot;&lt;mail:htmldescription&gt;Let's meet here&lt;/mail:htmldescription&gt;&quot;;

            // Build the XML body of the PROPPATCH request.
            strApptRequest = &quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;&quot;
            + &quot;&lt;g:propertyupdate &quot; + strXMLNSInfo + &quot;&gt;&quot;
            + &quot;&lt;g:set&gt;&lt;g:prop&gt;&quot;
            + &quot;&lt;g:contentclass&gt;urn:content-classes:appointment&lt;/g:contentclass&gt;&quot;
            + &quot;&lt;e:outlookmessageclass&gt;IPM.Appointment&lt;/e:outlookmessageclass&gt;&quot;
            + strMailInfo
            + strCalInfo
            + strHeaderInfo
            + &quot;&lt;mapi:finvited dt:dt=\&quot;boolean\&quot;&gt;1&lt;/mapi:finvited&gt;&quot;
            + &quot;&lt;/g:prop&gt;&lt;/g:set&gt;&quot;
            + &quot;&lt;/g:propertyupdate&gt;&quot;;

            // Create a new CredentialCache object and fill it with the network
            // credentials required to access the server.
            MyCredentialCache = new System.Net.CredentialCache();
            MyCredentialCache.Add( new System.Uri(strCalendarUri),
                                   &quot;NTLM&quot;,
                                   new System.Net.NetworkCredential(strUserName, strPassword, strDomain)
                                  );

            // Create the HttpWebRequest object.
            PROPPATCHRequest = (System.Net.HttpWebRequest)HttpWebRequest.Create(strCalendarUri + strApptItem);

            // Add the network credentials to the request.
            PROPPATCHRequest.Credentials = MyCredentialCache;

            // Specify the PROPPATCH method.
           PROPPATCHRequest.Method = &quot;PROPPATCH&quot;;

            // Encode the body using UTF-8.
            bytes = Encoding.UTF8.GetBytes((string)strApptRequest);

            // Set the content header length.  This must be
            // done before writing data to the request stream.
            PROPPATCHRequest.ContentLength = bytes.Length;

            // Get a reference to the request stream.
            PROPPATCHRequestStream = PROPPATCHRequest.GetRequestStream();

            // Write the message body to the request stream.
            PROPPATCHRequestStream.Write(bytes, 0, bytes.Length);

            // Close the Stream object to release the connection
            // for further use.
            PROPPATCHRequestStream.Close();

            // Set the content type header.
            PROPPATCHRequest.ContentType = &quot;text/xml&quot;;

            // Create the appointment in the Calendar folder of the
            // user's mailbox.
            PROPPATCHResponse = (System.Net.HttpWebResponse)PROPPATCHRequest.GetResponse();

            // Clean up.
            PROPPATCHResponse.Close();

            Console.WriteLine(&quot;Appointment successfully created.&quot;);

         }
         catch(Exception ex)
         {
            // Catch any exceptions. Any error codes from the PROPPATCH
            // method request on the server will be caught
            // here, also.
            Console.WriteLine(ex.Message);
         }

      }
   }
}

I compile with mono in windows 2000.
If i execute test.exe --&gt; OK
But if  I execute
	Mono test.exe, an excetion occured : Request Started
			Unhandled Exception: System.InvalidOperationException: request started
in &lt;0x00033&gt; System.Net.HttpWebRequest:CheckRequestStarted ()
in &lt;0x0004c&gt; (wrapper remoting-invoke-with-check) System.Net.HttpWebRequest:Chec
kRequestStarted ()
in &lt;0x00011&gt; System.Net.HttpWebRequest:set_ContentType (string)
in &lt;0x004fb&gt; ExchangeSDK.Snippets.CSharp.CreatingAnAppointmentWebDAV:Main (strin
g[])

the problem provides of the lines :                
               PROPPATCHRequest.ContentType = &quot;text/xml&quot;;

can you help me ?


////////////////////////////////////////////////////////////
// Webmail Oreka : <A HREF="http://www.oreka.com">http://www.oreka.com</A>
////////////////////////////////////////////////////////////



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007228.html">[Mono-devel-list] [Patch] the bug 61671 -	OdbcExecuteNonQuery bug
</A></li>
	<LI>Next message: <A HREF="007234.html">[Mono-devel-list] Idea: Bittorrent and Mono.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7230">[ date ]</a>
              <a href="thread.html#7230">[ thread ]</a>
              <a href="subject.html#7230">[ subject ]</a>
              <a href="author.html#7230">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
