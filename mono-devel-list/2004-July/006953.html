<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] XmlSerializer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20XmlSerializer&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006945.html">
   <LINK REL="Next"  HREF="006957.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] XmlSerializer</H1>
    <B>radek polak</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20XmlSerializer&In-Reply-To="
       TITLE="[Mono-devel-list] XmlSerializer">psonek2 at seznam.cz
       </A><BR>
    <I>Sat Jul 10 17:45:47 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="006945.html">[Mono-devel-list] Mono/Mcs Install on Cygwin/XP ( for first timeusers )
</A></li>
        <LI>Next message: <A HREF="006957.html">[Mono-devel-list] XmlSerializer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6953">[ date ]</a>
              <a href="thread.html#6953">[ thread ]</a>
              <a href="subject.html#6953">[ subject ]</a>
              <a href="author.html#6953">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,
this code works under MS.NET, but throws following exception on mono beta3:

System.InvalidOperationException: SerializationTest.MyList cannot be serialized because it does not have a default public constructor

Exception under Mono seems logical to me. I am trying to serialize MyList class, that has no public constructor. But how is it possible to work under MS.NET? The reason must be, that MyList inherits from ArrayList.

Any ideas? Thanks. Radek.

using System;
using System.IO;
using System.Collections;
using System.Xml.Serialization;

namespace SerializationTest
{
	[Serializable]
	public class MyList : ArrayList
	{
		Container container;	// in real implementation i need to know &quot;my container&quot;

		// NOTE: MyList has no public constructor
		public MyList(Container container) : base() {
			this.container = container;
		}
	}

	[Serializable]
	public class Container
	{
		public MyList Items;

		public Container() {
			Items = new MyList(this);
		}

		public void Save(Stream s) {
			XmlSerializer serializer = new XmlSerializer(this.GetType());
			serializer.Serialize(s, this);
		}

		public static Container FromStream(Stream s) {
			XmlSerializer serializer = new XmlSerializer(typeof(Container));
			Container c = (Container) serializer.Deserialize(s);
			return c;
		}

		public static void Main()
		{
			Container c = new Container();
			c.Items.Add(1);
			using(FileStream fs = new FileStream(&quot;container.xml&quot;, FileMode.Create)) {
				c.Save(fs);
			}

			Container fromFile = Container.FromStream(File.OpenRead(&quot;container.xml&quot;));
			Console.WriteLine(&quot;It works, first item is &quot; + fromFile.Items[0]);
			Console.ReadLine();
		}
	}
}
____________________________________________________________
P&#345;&#237;jemn&#253; design. P&#345;&#237;jemn&#283;j&#353;&#237; cena. SONY ERICSSON T105 ji&#382; od 577 K&#269;
<A HREF="http://ad.seznam.cz/clickthru?spotId=75826">http://ad.seznam.cz/clickthru?spotId=75826</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SerializationTest.cs
Type: text/x-csharp
Size: 1196 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040710/a2cfe29e/attachment.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040710/a2cfe29e/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006945.html">[Mono-devel-list] Mono/Mcs Install on Cygwin/XP ( for first timeusers )
</A></li>
	<LI>Next message: <A HREF="006957.html">[Mono-devel-list] XmlSerializer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6953">[ date ]</a>
              <a href="thread.html#6953">[ thread ]</a>
              <a href="subject.html#6953">[ subject ]</a>
              <a href="author.html#6953">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
