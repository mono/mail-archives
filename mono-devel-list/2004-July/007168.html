<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] VB.NET runtime
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20VB.NET%20runtime&In-Reply-To=1090300422.2634.3.camel%40shakespeare">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007078.html">
   <LINK REL="Next"  HREF="007165.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] VB.NET runtime</H1>
    <B>Dave Mertens</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20VB.NET%20runtime&In-Reply-To=1090300422.2634.3.camel%40shakespeare"
       TITLE="[Mono-devel-list] VB.NET runtime">dmertens at zyprexia.com
       </A><BR>
    <I>Wed Jul 21 07:18:48 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007078.html">[Mono-devel-list] VB.NET runtime
</A></li>
        <LI>Next message: <A HREF="007165.html">[Mono-devel-list] Suse 9.1 XSP error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7168">[ date ]</a>
              <a href="thread.html#7168">[ thread ]</a>
              <a href="subject.html#7168">[ subject ]</a>
              <a href="author.html#7168">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>  
</I>&gt;<i>  On Tue, 2004-07-20 at 04:48, A Rafael D Teixeira wrote:
</I>&gt;<i>  &gt; That is true, but what is missing is how to create the 
</I>&gt;<i>  defaultvalue 
</I>&gt;<i>  &gt; metadata. That feature is not available as an attribute. There are 
</I>&gt;<i>  &gt; attributes to govern how non-simple values (DateTimes and 
</I>&gt;<i>  Decimals, 
</I>&gt;<i>  &gt; for
</I>&gt;<i>  &gt; example) are stored as default values, but not to say the default 
</I>&gt;<i>  &gt; value itself.
</I>&gt;<i>  Sure, it's not, but is there any reason why it *can't* be 
</I>&gt;<i>  available as an attribute?
</I>
There is actually an attribute for setting the defaultvalue. It's simply
called DefaultValueAttribute	and can be found in the
System.ComponentModel namespace.

A call with an optional argument with a default value would be like this:
Public static function abc(def as string, &lt;Optional&gt;&lt;DefaultValue(&quot;xyz&quot;)&gt;klm
as string) as string
...
End function

Another way of 'simulating' optional parameters with a default value is
creating an overloaded function with the specifec argument missing which
calls on his turn the 'original' with the specific argument hardcoded in the
call.
Whenever a value is given for the optional value, the CLR will use directly
the original method.

An example:
Public static function abc(def as string) as string
	return abc(def, &quot;xyz&quot;)	'xyz is here the default value
End function
Public static function abc(def as string, klm as string) as string
...
End function


Both OptionalAttribute and DefaultValueAttribute classes are CLS compliant.
But the use of them is discouraged because method overloading is a far
better way for implementing default values. Still using the optional keyword
in VB.Net is just bad programming..



&gt;<i>  A few random ideas:
</I>&gt;<i>  * A utility that takes an assembly using the attribute, 
</I>&gt;<i>  removes the attribute and adds the relevant IL.
</I>&gt;<i>  * This is the class libraries, so presumably they only need 
</I>&gt;<i>  to run on the mono runtime. I believe you could make the 
</I>&gt;<i>  runtime recognize the attribute.
</I>It's not only the Mono runtime. If an feature called 'optional values' will
be introduced to mono runtime.  But I guess for then only programming for
Mono and not cross-platform. I want to use the binairies on BOTH windows and
linux and don't want the install mono under windows, because I already have
the MS runtimme..

Aside from that, it should be the VB.NET compiler which needs to make the
changes. This would also mean that the binary is cross-platform. But all of
that is unnessacery because .NET already have those features.


Regards, 
Dave Mertens


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007078.html">[Mono-devel-list] VB.NET runtime
</A></li>
	<LI>Next message: <A HREF="007165.html">[Mono-devel-list] Suse 9.1 XSP error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7168">[ date ]</a>
              <a href="thread.html#7168">[ thread ]</a>
              <a href="subject.html#7168">[ subject ]</a>
              <a href="author.html#7168">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
