<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] AppActivate and System.Windows.Forms.SendKeys on	Ubuntu 10.10
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20AppActivate%20and%20System.Windows.Forms.SendKeys%20on%0A%09Ubuntu%2010.10&In-Reply-To=4D80AF12.9070907%40hailmail.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037148.html">
   <LINK REL="Next"  HREF="037152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on	Ubuntu 10.10</H1>
    <B>Bojan Rajkovic</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20AppActivate%20and%20System.Windows.Forms.SendKeys%20on%0A%09Ubuntu%2010.10&In-Reply-To=4D80AF12.9070907%40hailmail.net"
       TITLE="[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on	Ubuntu 10.10">severedcross at gmail.com
       </A><BR>
    <I>Wed Mar 16 15:07:35 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037148.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu	10.10
</A></li>
        <LI>Next message: <A HREF="037152.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37151">[ date ]</a>
              <a href="thread.html#37151">[ thread ]</a>
              <a href="subject.html#37151">[ subject ]</a>
              <a href="author.html#37151">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 16, 2011, at 8:37 AM, Quandary wrote:

&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Question: 
</I>&gt;<i> Is System.Windows.Forms.SendKeys implemented and working on Ubuntu Linux ?
</I>&gt;<i> 
</I>&gt;<i> I try to control JD-GUI with it, but the keys don't arrive, neither do they arrive in gedit.
</I>&gt;<i> They do arrive in Notepad on Windows using the same program, and they work with JD-GUI on Windows, using the same program. 
</I>&gt;<i> 
</I>&gt;<i> Or does it need any library installed, such as XTest/XFakeEvent ?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And BTW, Microsoft.VisualBasic.Interaction.AppActivate(&quot;Window Title&quot;) throws not implemented...
</I>&gt;<i> 
</I>&gt;<i> You can use the functions:
</I>&gt;<i>      static Window FindWindow(Window top, char *name)
</I>&gt;<i>      static void GetFocusedWindow(void)
</I>&gt;<i> From xvkbd -&gt; in file xvkbd.c
</I>&gt;<i> Basically, all you need to do is save the mouse position, find the target window position &amp; rectangle, and press the left mousebutton somewhere on it with mousedown &amp; mouseup via xsendevent, then restore the mouse position.
</I>&gt;<i> 
</I>&gt;<i> I can supply left + right mousedown + mouseup,
</I>&gt;<i> I have appended cMouse.cs and the dependencies: XorgAPI + XorgStructs.
</I>&gt;<i> 
</I>&gt;<i> And when I loop through all processes, as shown below, I don't get a WindowTitle anywhere...
</I>&gt;<i> (using mono 2.10.1 on Ubuntu)
</I>&gt;<i> --------------------------------------------
</I>&gt;<i> 
</I>&gt;<i>         public void GetProcesses()
</I>&gt;<i>         { 
</I>&gt;<i>             System.Diagnostics.Process[] processlist = System.Diagnostics.Process.GetProcesses();
</I>&gt;<i> 
</I>&gt;<i>             string str = &quot;&quot;;
</I>&gt;<i>             foreach(System.Diagnostics.Process theprocess in processlist)
</I>&gt;<i>             {
</I>&gt;<i>                 Console.WriteLine(&quot;Process: {0} ID: {1} WindowTitle: {2}&quot;, theprocess.ProcessName, theprocess.Id, theprocess.MainWindowTitle);
</I>&gt;<i>                 str += string.Format(&quot;Process: {0} ID: {1} WindowTitle: {2}&quot;, theprocess.ProcessName, theprocess.Id, theprocess.MainWindowTitle);
</I>&gt;<i>                 str += Environment.NewLine;
</I>&gt;<i>             }
</I>&gt;<i>             MessageBox.Show(str);
</I>&gt;<i>         }
</I>&gt;<i> 
</I>&gt;<i> --------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> &lt;cMouse.cs&gt;&lt;cXorgAPI.cs&gt;&lt;Structs.cs&gt;_______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
Erm, I don't think SendKeys for WinForms is going to work against !WinForms apps on Linux. gEdit is GTK+, so the mainloops don't match at all, and gEdit likely isn't expecting any keys from Mono.

&#8212;Bojan
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037148.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu	10.10
</A></li>
	<LI>Next message: <A HREF="037152.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37151">[ date ]</a>
              <a href="thread.html#37151">[ thread ]</a>
              <a href="subject.html#37151">[ subject ]</a>
              <a href="author.html#37151">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
