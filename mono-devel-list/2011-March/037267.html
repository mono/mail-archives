<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] WebBrowser Thumbnail
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WebBrowser%20Thumbnail&In-Reply-To=1301089871.10074.11878.camel%40erandi.site">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037266.html">
   <LINK REL="Next"  HREF="037231.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] WebBrowser Thumbnail</H1>
    <B>Quandary</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20WebBrowser%20Thumbnail&In-Reply-To=1301089871.10074.11878.camel%40erandi.site"
       TITLE="[Mono-dev] WebBrowser Thumbnail">quandary82 at hailmail.net
       </A><BR>
    <I>Sat Mar 26 04:14:42 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037266.html">[Mono-dev] Minimal required set to Redistribute Mono
</A></li>
        <LI>Next message: <A HREF="037231.html">[Mono-dev] mono wcf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37267">[ date ]</a>
              <a href="thread.html#37267">[ thread ]</a>
              <a href="subject.html#37267">[ subject ]</a>
              <a href="author.html#37267">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Question: Why does the below code (to take a thumbnail of a website)
hang forever at:

    while (wb.ReadyState != WebBrowserReadyState.Complete) { Application.DoEvents(); }


? It works with .NET on Windows.

And furthermore, is it possible to take a WebSite Thumbnail with
webkit-sharp ?
I have not found a way.

I'm now resorting to khtml2png.


Code:




public Bitmap GenerateScreenshot(string url)
{
    // This method gets a screenshot of the webpage
    // rendered at its full size (height and width)
    return GenerateScreenshot(url, -1, -1);
}

public Bitmap GenerateScreenshot(string url, int width, int height)
{
    // Load the webpage into a WebBrowser control
    WebBrowser wb = new WebBrowser();
    wb.ScrollBarsEnabled = false;
    wb.ScriptErrorsSuppressed = true;
    wb.Navigate(url);
    while (wb.ReadyState != WebBrowserReadyState.Complete) { Application.DoEvents(); }


    // Set the size of the WebBrowser control
    wb.Width = width;
    wb.Height = height;

    if (width == -1)
    {
        // Take Screenshot of the web pages full width
        wb.Width = wb.Document.Body.ScrollRectangle.Width;
    }

    if (height == -1)
    {
        // Take Screenshot of the web pages full height
        wb.Height = wb.Document.Body.ScrollRectangle.Height;
    }

    // Get a Bitmap representation of the webpage as it's rendered in the WebBrowser control
    Bitmap bitmap = new Bitmap(wb.Width, wb.Height);
    wb.DrawToBitmap(bitmap, new Rectangle(0, 0, wb.Width, wb.Height));
    wb.Dispose();

    return bitmap;
}


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20110326/993cc566/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20110326/993cc566/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037266.html">[Mono-dev] Minimal required set to Redistribute Mono
</A></li>
	<LI>Next message: <A HREF="037231.html">[Mono-dev] mono wcf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37267">[ date ]</a>
              <a href="thread.html#37267">[ thread ]</a>
              <a href="subject.html#37267">[ subject ]</a>
              <a href="author.html#37267">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
