<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Process.Start and WaitForExit on MacOS X
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Process.Start%20and%20WaitForExit%20on%20MacOS%20X&In-Reply-To=C9A5246A.818F%25tom.philpot%40logos.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037146.html">
   <LINK REL="Next"  HREF="037148.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Process.Start and WaitForExit on MacOS X</H1>
    <B>Tom Philpot</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Process.Start%20and%20WaitForExit%20on%20MacOS%20X&In-Reply-To=C9A5246A.818F%25tom.philpot%40logos.com"
       TITLE="[Mono-dev] Process.Start and WaitForExit on MacOS X">tom.philpot at logos.com
       </A><BR>
    <I>Tue Mar 15 19:48:41 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037146.html">[Mono-dev] Process.Start and WaitForExit on MacOS X
</A></li>
        <LI>Next message: <A HREF="037148.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu	10.10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37147">[ date ]</a>
              <a href="thread.html#37147">[ thread ]</a>
              <a href="subject.html#37147">[ subject ]</a>
              <a href="author.html#37147">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Apparently, the bug I filed was marked as a duplicate of this WONTFIX bug:
<A HREF="https://bugzilla.novell.com/show_bug.cgi?id=668867">https://bugzilla.novell.com/show_bug.cgi?id=668867</A>

According to the resolution of that bug, I just need to enable shared
handles. Unless I'm doing something wrong, enabling shared handles should
be as simple as &quot;MONO_ENABLE_SHM=1 mono ProcessTest.exe&quot;, right?

That doesn't seem to fix the issue.

We're finding that running CruiseControl.Net under Mono creates zombies
because the processes aren't waited for, and this happened even in 2.6,
where IIRC, shared handles were enabled by default.

Thanks,
Tom

On 3/15/11 2:15 PM, &quot;Tom Philpot&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">tom.philpot at logos.com</A>&gt; wrote:

&gt;<i>Submitted bug with a reproducible test case:
</I>&gt;<i><A HREF="https://bugzilla.novell.com/show_bug.cgi?id=679936">https://bugzilla.novell.com/show_bug.cgi?id=679936</A>
</I>&gt;<i>
</I>&gt;<i>On 3/15/11 12:26 PM, &quot;Jonathan Pryor&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">jonpryor at vt.edu</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>On Mar 15, 2011, at 2:57 PM, Tom Philpot wrote:
</I>&gt;&gt;&gt;<i> I've discovered that Process.Start(ProcessStartInfo info) leaves child
</I>&gt;&gt;&gt;<i>processes hanging around until the parent process dies, unless you call
</I>&gt;&gt;&gt;<i>WaitForExit() on the child process.
</I>&gt;&gt;<i>...
</I>&gt;&gt;&gt;<i> Is this a bug or by design?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>The problem is the Process.ExitCode property. There's no way to retrieve
</I>&gt;&gt;<i>this value except through the waitpid(2) (and related) system calls, so
</I>&gt;&gt;<i>the process can't be fully disposed just in case the ExitCode property
</I>&gt;&gt;<i>will be accessed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>That said, once the instance has been disposed, it shouldn't be necessary
</I>&gt;&gt;<i>to keep anything open, and the child handles should be closed. Given that
</I>&gt;&gt;<i>you _are_ using a `using` block, and thus disposing of the instance, it
</I>&gt;&gt;<i>seems that this is likely a bug and that Process.Dispose() isn't fully
</I>&gt;&gt;<i>closing all resources as it should.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>(For that matter, the Process finalizer should also be disposing of
</I>&gt;&gt;<i>unmanaged resources, and it looks like that isn't the case either).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Could you please file a bug?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Thanks,
</I>&gt;&gt;<i> - Jon
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>
</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037146.html">[Mono-dev] Process.Start and WaitForExit on MacOS X
</A></li>
	<LI>Next message: <A HREF="037148.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu	10.10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37147">[ date ]</a>
              <a href="thread.html#37147">[ thread ]</a>
              <a href="subject.html#37147">[ subject ]</a>
              <a href="author.html#37147">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
