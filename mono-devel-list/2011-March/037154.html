<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20AppActivate%20and%20System.Windows.Forms.SendKeys%20on%0A%20Ubuntu%2010.10&In-Reply-To=4D81186A.9000507%40hailmail.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037152.html">
   <LINK REL="Next"  HREF="037210.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10</H1>
    <B>Jonathan Pryor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20AppActivate%20and%20System.Windows.Forms.SendKeys%20on%0A%20Ubuntu%2010.10&In-Reply-To=4D81186A.9000507%40hailmail.net"
       TITLE="[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10">jonpryor at vt.edu
       </A><BR>
    <I>Wed Mar 16 22:19:52 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="037152.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10
</A></li>
        <LI>Next message: <A HREF="037210.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37154">[ date ]</a>
              <a href="thread.html#37154">[ thread ]</a>
              <a href="subject.html#37154">[ subject ]</a>
              <a href="author.html#37154">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 16, 2011, at 4:07 PM, Quandary wrote:
&gt;<i> What, only SendKeys to WinForms, are you serious ?
</I>&gt;<i> That doesn't make much sense.
</I>
It makes perfect sense.

&gt;<i> It sends KeyEvents to the Windowing system, which happens to be the
</I>&gt;<i> WinAPI on Windows, or X11 on Linux for all intents and purposes.
</I>&gt;<i> GTK has nothing to do with it.
</I>&gt;<i> 
</I>&gt;<i> You send the keyboard keys as simulated input to X11, and before that,
</I>&gt;<i> you set the focus window.
</I>
The problem is that there is no such mechanism in X11, at least not in a way that can be used in a straightforward fashion.

For example, Microsoft's SendKeys.Send() method is _probably_ implemented in terms of the SendInput() WinAPI function:

	<A HREF="http://msdn.microsoft.com/en-us/library/ms646310(VS.85">http://msdn.microsoft.com/en-us/library/ms646310(VS.85</A>).aspx

So SendKeys.Send() presumably maps the input string into a set of INPUT structures, then sends the structures to SendInput() so that the operating system will interpret them. Note that this is _very_ low level, working at the keyboard level, not the thread event loop level.

One of the things that this allows is that SendKeys.Send(&quot;%{TAB}&quot;) (aka Alt+Tab) will change the active window.

Now, what does X11 provide? A cursory glance shows XSendEvent:

	<A HREF="http://tronche.com/gui/x/xlib/event-handling/XSendEvent.html">http://tronche.com/gui/x/xlib/event-handling/XSendEvent.html</A>

This allows passing an XEvent, such as an XKeyEvent, to a given window.

Problem: In Windows, it's the operating system which handles the input, which thus allows OS &quot;capturing&quot; of Alt+Tab so that the active application is switched. In X11, XSendEvent() requires that you explicitly specify both the Display and Window that the event is being passed to. Consequently, there is NO MECHANISM to have Alt+Tab &quot;captured&quot; by the OS and thus change windows (even if Alt+Tab _will_ change windows when typed via the keyboard). This is because the WIndow Manager is grabbing Alt+Tab, but the Window Manager is a completely separate process, and there's not necessarily an easy way to grab the Display+Window for the Window Manager (which might not have a Window to begin with).

In short, you can't get there from here, as the entire X11 architecture is ~completely different.

&gt;<i> At least on Windows.
</I>
Exactly. On Windows, everything uses the same WinAPI message looping mechanism. On X11, very little is consistent across toolkits, and X11 doesn't specify much (leaving it up to the Window Manager + applications + ... to work out the details).

Then there's OSX, which uses yet another completely different mechanism. SendKeys.Send() is inherently Windows specific; you should be glad it works for System.Windows.Forms apps at all.

 - Jon

</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037152.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10
</A></li>
	<LI>Next message: <A HREF="037210.html">[Mono-dev] AppActivate and System.Windows.Forms.SendKeys on Ubuntu 10.10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37154">[ date ]</a>
              <a href="thread.html#37154">[ thread ]</a>
              <a href="subject.html#37154">[ subject ]</a>
              <a href="author.html#37154">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
