<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] another corcompare patch to hide extraneous	&quot;IsVirtual&quot;differences
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20another%20corcompare%20patch%20to%20hide%20extraneous%0A%09%22IsVirtual%22differences&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015552.html">
   <LINK REL="Next"  HREF="015602.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] another corcompare patch to hide extraneous	&quot;IsVirtual&quot;differences</H1>
    <B>Korn&#233;l P&#225;l</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20another%20corcompare%20patch%20to%20hide%20extraneous%0A%09%22IsVirtual%22differences&In-Reply-To="
       TITLE="[Mono-dev] another corcompare patch to hide extraneous	&quot;IsVirtual&quot;differences">kornelpal at hotmail.com
       </A><BR>
    <I>Thu Nov  3 15:23:32 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="015552.html">[Mono-dev] another corcompare patch to hide extraneous &quot;IsVirtual&quot;	differences
</A></li>
        <LI>Next message: <A HREF="015602.html">[Mono-dev] another corcompare patch to hide extraneous	&quot;IsVirtual&quot;differences
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15596">[ date ]</a>
              <a href="thread.html#15596">[ thread ]</a>
              <a href="subject.html#15596">[ subject ]</a>
              <a href="author.html#15596">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I understand your point of view why this case could be treated as OK but
there is big difference between virtual and non-virtual methods. The most
important and most relevant difference is that compilers (should) generate
virtual calls for virtual methods and non-virtual calls for non-virtual
methods even for sealed classes. If corcompare ignores this difference that
will result in different code for calling the methods that is something bad.
In addition if these classes become non-sealed in later MS.NET versions
(there are some such classes in MS.NET 2.0 that are non-sealed but were
sealed in 1.x) or non-virtual methods become virtual the code will behave
differently as virtual functions can be called using non-virtual IL code
that results in the specified method instead of the virtual method that is
something very bad.

So I think we should implement interface methods using the same syntax
(using full name privately or using public methods with the same name) for
full MS.NET compatibility.

Korn&#233;l

----- Original Message -----
From: &quot;Atsushi Eno&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">atsushi at ximian.com</A>&gt;
To: &quot;mono-devel mailing list&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>&gt;
Sent: Tuesday, November 01, 2005 11:07 AM
Subject: [Mono-dev] another corcompare patch to hide extraneous
&quot;IsVirtual&quot;differences


&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> As implemented in the previous patch, corcompare now shows
</I>&gt;<i> abstract/virtual/static differnces on methods (including property
</I>&gt;<i> accessors).
</I>&gt;<i>
</I>&gt;<i> Now it uncovered the difference on how we implement interface
</I>&gt;<i> methods on each class. Say, there is only one Clear in our
</I>&gt;<i> System.CodeDom.NamespaceImportCollection.Clear(), while MS.NET
</I>&gt;<i> has two Clear() (one is an implicit implementation).
</I>&gt;<i>
</I>&gt;<i> One another case, there are some internal interfaces that
</I>&gt;<i> commonize some members (for example, ConfigXmlDocument that implements
</I>&gt;<i> IConfigXmlNode, in System.Configuration, has different IsVirtual
</I>&gt;<i> attribute on Filename property).
</I>&gt;<i>
</I>&gt;<i> Those differeces come from the fact that a MethodBase.IsVirtual is
</I>&gt;<i> True for such a method that is part of an interface implementation.
</I>&gt;<i>
</I>&gt;<i> They are not significant differences that we should care.
</I>&gt;<i>
</I>&gt;<i> Thus, the only differences we should care is whether they are
</I>&gt;<i> overridable or not. It prints &quot;should (not) Overridable&quot; instead of
</I>&gt;<i> &quot;should (not) be Virtual&quot;.
</I>&gt;<i>
</I>&gt;<i> Based on the premise above, I created another corcompare patch.
</I>&gt;<i> This time it won't show such annoying differences.
</I>&gt;<i>
</I>&gt;<i> Does it sound fine?
</I>&gt;<i>
</I>&gt;<i> Atsushi Eno
</I>&gt;<i>
</I>

--------------------------------------------------------------------------------


&gt;<i> Index: mono-api-diff.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- mono-api-diff.cs (revision 52436)
</I>&gt;<i> +++ mono-api-diff.cs (working copy)
</I>&gt;<i> @@ -1607,7 +1607,7 @@
</I>&gt;<i>  {
</I>&gt;<i>  None = 0,
</I>&gt;<i>  Abstract = 1,
</I>&gt;<i> - Virtual = 2,
</I>&gt;<i> + Overridable = 2,
</I>&gt;<i>  Static = 4
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i> @@ -1626,8 +1626,8 @@
</I>&gt;<i>  flags |= SignatureFlags.Abstract;
</I>&gt;<i>  if (((XmlElement) node).GetAttribute (&quot;static&quot;) == &quot;true&quot;)
</I>&gt;<i>  flags |= SignatureFlags.Static;
</I>&gt;<i> - if (((XmlElement) node).GetAttribute (&quot;virtual&quot;) == &quot;true&quot;)
</I>&gt;<i> - flags |= SignatureFlags.Virtual;
</I>&gt;<i> + if (((XmlElement) node).GetAttribute (&quot;overridable&quot;) == &quot;true&quot;)
</I>&gt;<i> + flags |= SignatureFlags.Overridable;
</I>&gt;<i>  if (flags != SignatureFlags.None) {
</I>&gt;<i>  if (signatureFlags == null)
</I>&gt;<i>  signatureFlags = new Hashtable ();
</I>&gt;<i> Index: mono-api-info.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- mono-api-info.cs (revision 52436)
</I>&gt;<i> +++ mono-api-info.cs (working copy)
</I>&gt;<i> @@ -759,8 +759,8 @@
</I>&gt;<i>
</I>&gt;<i>  if (mbase.IsAbstract)
</I>&gt;<i>  AddAttribute (p, &quot;abstract&quot;, &quot;true&quot;);
</I>&gt;<i> - if (mbase.IsVirtual)
</I>&gt;<i> - AddAttribute (p, &quot;virtual&quot;, &quot;true&quot;);
</I>&gt;<i> + if (mbase.IsVirtual &amp;&amp; !mbase.IsFinal)
</I>&gt;<i> + AddAttribute (p, &quot;overridable&quot;, &quot;true&quot;);
</I>&gt;<i>  if (mbase.IsStatic)
</I>&gt;<i>  AddAttribute (p, &quot;static&quot;, &quot;true&quot;);
</I>&gt;<i>
</I>&gt;<i>
</I>

--------------------------------------------------------------------------------


&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015552.html">[Mono-dev] another corcompare patch to hide extraneous &quot;IsVirtual&quot;	differences
</A></li>
	<LI>Next message: <A HREF="015602.html">[Mono-dev] another corcompare patch to hide extraneous	&quot;IsVirtual&quot;differences
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15596">[ date ]</a>
              <a href="thread.html#15596">[ thread ]</a>
              <a href="subject.html#15596">[ subject ]</a>
              <a href="author.html#15596">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
