<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Problem with regression test of exceptions.exe
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problem%20with%20regression%20test%20of%20exceptions.exe&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032700.html">
   <LINK REL="Next"  HREF="032689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Problem with regression test of exceptions.exe</H1>
    <B>Neale Ferguson</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Problem%20with%20regression%20test%20of%20exceptions.exe&In-Reply-To="
       TITLE="[Mono-dev] Problem with regression test of exceptions.exe">NealeFerguson at verizon.net
       </A><BR>
    <I>Mon Jul 27 13:37:57 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032700.html">[Mono-dev] [PATCH] ParallelFx initial code drop
</A></li>
        <LI>Next message: <A HREF="032689.html">[Mono-dev] ADO.NET Data Services (project astoria) plans ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32684">[ date ]</a>
              <a href="thread.html#32684">[ thread ]</a>
              <a href="subject.html#32684">[ subject ]</a>
              <a href="author.html#32684">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I&#185;m having problems with Pastebin at the moment so I was unable to place the
following there and use IRC:

Strange situation running regression test for exceptions.exe. I am crashing
as the following call returns NULL:

                case OP_START_HANDLER: {
                        MonoInst *spvar = mono_find_spvar_for_region (cfg,
bb-&gt;region);

I have traced the code and it shows bb-&gt;region = 258. I traced
mono_create_spvar_for_region and it shows and entry being placed in the hash
table for region 258. However, in the find routine we have:

        if ((region &amp; (0xf &lt;&lt; 4)) == MONO_REGION_TRY) {
                MonoMethodHeader *header = mono_method_get_header
(cfg-&gt;method);

                /*
                 * This can happen if a try clause is nested inside a
finally clause.
                 */
                int clause_index = (region &gt;&gt; 8) - 1;
                g_assert (clause_index &gt;= 0 &amp;&amp; clause_index &lt;
header-&gt;num_clauses);
                region = mono_find_block_region_notry (cfg, header-&gt;clauses
[clause_index].try_offs
et);               
        }          

A trace shows that 258 passes the == MONO_REGION_TRY test and so we get a
new region number (530) and when we do a g_hash_table_lookup() using that
region we get null. I see no inserts using that (530) region number.

Also, MONO_REGION_TRY is 0. Is the test supposed to be against this value or
for checking bit 0?

I am confused as to what is happening.

Neale


</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032700.html">[Mono-dev] [PATCH] ParallelFx initial code drop
</A></li>
	<LI>Next message: <A HREF="032689.html">[Mono-dev] ADO.NET Data Services (project astoria) plans ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32684">[ date ]</a>
              <a href="thread.html#32684">[ thread ]</a>
              <a href="subject.html#32684">[ subject ]</a>
              <a href="author.html#32684">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
