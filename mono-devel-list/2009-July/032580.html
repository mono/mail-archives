<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] sending smtp email under SSL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20sending%20smtp%20email%20under%20SSL&In-Reply-To=BLU119-W8A6CD65B65086A9FF7E7CDE540%40phx.gbl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032552.html">
   <LINK REL="Next"  HREF="032553.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] sending smtp email under SSL</H1>
    <B>_KD_</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20sending%20smtp%20email%20under%20SSL&In-Reply-To=BLU119-W8A6CD65B65086A9FF7E7CDE540%40phx.gbl"
       TITLE="[Mono-dev] sending smtp email under SSL">kd-boss at yahoo.com.tw
       </A><BR>
    <I>Thu Jul  9 21:56:21 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032552.html">[Mono-dev] [PATCH] Squash 444388 and catch miss on 323096
</A></li>
        <LI>Next message: <A HREF="032553.html">[Mono-dev]  [PATCH] ShellExecuteEx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32580">[ date ]</a>
              <a href="thread.html#32580">[ thread ]</a>
              <a href="subject.html#32580">[ subject ]</a>
              <a href="author.html#32580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>


gedw99 wrote:
&gt;<i> 
</I>&gt;<i> Hey,
</I>&gt;<i>  
</I>&gt;<i> i am trying to send an email using a gmail account.
</I>&gt;<i> According to the docs, Network Credentials does not support SSL.
</I>&gt;<i> <A HREF="http://www.go-mono.com/docs/index.aspx?link=T%3ASystem.Net.NetworkCredential%2F*">http://www.go-mono.com/docs/index.aspx?link=T%3ASystem.Net.NetworkCredential%2F*</A>
</I>&gt;<i>  
</I>&gt;<i> I am using the latest mono 1.2, and XPS2 !
</I>&gt;<i> Is there an alternative way to send email under SSL ????
</I>&gt;<i>  
</I>&gt;<i> Code and error below::::
</I>&gt;<i>  
</I>&gt;<i>  
</I>&gt;<i> SmtpClient mailClient = new SmtpClient();
</I>&gt;<i> mailClient.EnableSsl = true;
</I>&gt;<i> mailClient.DeliveryMethod = SmtpDeliveryMethod.Network;
</I>&gt;<i> mailClient.Host = &quot;smtp.gmail.com&quot;;
</I>&gt;<i> mailClient.Port = 587;
</I>&gt;<i> mailClient.Credentials = new NetworkCredential(Config.GMAIL_UserName,
</I>&gt;<i> Config.GMAIL_PassWord);
</I>&gt;<i> mailClient.Send(this._from, this._to, this._subject, this._body);
</I>&gt;<i>  
</I>&gt;<i> THis fails with:
</I>&gt;<i>  
</I>&gt;<i> Server Error in '/' Application
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> SSL authentication error: RemoteCertificateChainErrors
</I>&gt;<i> Description: Error processing request.
</I>&gt;<i> Error Message: HTTP 500. System.InvalidOperationException: SSL
</I>&gt;<i> authentication error: RemoteCertificateChainErrors 
</I>&gt;<i> Stack Trace: 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> System.InvalidOperationException: SSL authentication error:
</I>&gt;<i> RemoteCertificateChainErrors  at
</I>&gt;<i> System.Net.Mail.SmtpClient.&lt;SmtpClient&gt;c__38 (System.Object sender,
</I>&gt;<i> System.Security.Cryptography.X509Certificates.X509Certificate certificate,
</I>&gt;<i> System.Security.Cryptography.X509Certificates.X509Chain chain,
</I>&gt;<i> SslPolicyErrors sslPolicyErrors) [0x00000]   at
</I>&gt;<i> System.Net.Security.SslStream+&lt;&gt;c__CompilerGenerated13.&lt;BeginAuthenticateAsClient&gt;c__44
</I>&gt;<i> (System.Security.Cryptography.X509Certificates.X509Certificate cert,
</I>&gt;<i> System.Int32[] certErrors) [0x00000]   at
</I>&gt;<i> Mono.Security.Protocol.Tls.SslClientStream.OnRemoteCertificateValidation
</I>&gt;<i> (System.Security.Cryptography.X509Certificates.X509Certificate
</I>&gt;<i> certificate, System.Int32[] errors) [0x00000]   at
</I>&gt;<i> Mono.Security.Protocol.Tls.SslStreamBase.RaiseRemoteCertificateValidation
</I>&gt;<i> (System.Security.Cryptography.X509Certificates.X509Certificate
</I>&gt;<i> certificate, System.Int32[] errors) [0x00000]   at
</I>&gt;<i> Mono.Security.Protocol.Tls.SslClientStream.RaiseServerCertificateValidation
</I>&gt;<i> (System.Security.Cryptography.X509Certificates.X509Certificate
</I>&gt;<i> certificate, System.Int32[] certificateErrors) [0x00000]   at
</I>&gt;<i> Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.validateCertificates
</I>&gt;<i> (Mono.Security.X509.X509CertificateCollection certificates) [0x00000]   at
</I>&gt;<i> Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.ProcessAsTls1
</I>&gt;<i> () [0x00000]   at
</I>&gt;<i> Mono.Security.Protocol.Tls.Handshake.HandshakeMessage.Process () [0x00000]  
</I>&gt;<i> at (wrapper remoting-invoke-with-check)
</I>&gt;<i> Mono.Security.Protocol.Tls.Handshake.HandshakeMessage:Process ()  at
</I>&gt;<i> Mono.Security.Protocol.Tls.ClientRecordProtocol.ProcessHandshakeMessage
</I>&gt;<i> (Mono.Security.Protocol.Tls.TlsStream handMsg) [0x00000]   at
</I>&gt;<i> Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback
</I>&gt;<i> (IAsyncResult asyncResult) [0x00000] 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
I myself am experiencing a similar error

my code::
 TcpClient client = new TcpClient(&quot;login.yahoo.com&quot;, 443);

            SslStream sslStream = new SslStream(
client.GetStream(),
false,
new RemoteCertificateValidationCallback(ValidateServerCertificate),
null
);

            sslStream.AuthenticateAsClient(&quot;login.yahoo.com&quot;);

it returns ::
Certificate error: RemoteCertificateChainErrors

Though the exact same code authenticates in Windows. Im not shure if mono
builds against the currently installed OpenSSL libs or not, but if it does
it could be an error in the OpenSSL libs. I dunno, but help with this issue
would be appreciated by the both of us. :working: 
-- 
View this message in context: <A HREF="http://www.nabble.com/sending-smtp-email-under-SSL-tp14518813p24420639.html">http://www.nabble.com/sending-smtp-email-under-SSL-tp14518813p24420639.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032552.html">[Mono-dev] [PATCH] Squash 444388 and catch miss on 323096
</A></li>
	<LI>Next message: <A HREF="032553.html">[Mono-dev]  [PATCH] ShellExecuteEx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32580">[ date ]</a>
              <a href="thread.html#32580">[ thread ]</a>
              <a href="subject.html#32580">[ subject ]</a>
              <a href="author.html#32580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
