<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Array and IEnumerable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Array%20and%20IEnumerable&In-Reply-To=948F8825-58D0-4EF9-824A-BA3B51FC6EE5%40mac.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032525.html">
   <LINK REL="Next"  HREF="032528.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Array and IEnumerable</H1>
    <B>Michael Hutchinson</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Array%20and%20IEnumerable&In-Reply-To=948F8825-58D0-4EF9-824A-BA3B51FC6EE5%40mac.com"
       TITLE="[Mono-dev] Array and IEnumerable">m.j.hutchinson at gmail.com
       </A><BR>
    <I>Wed Jul  1 02:40:57 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032525.html">[Mono-dev] Array and IEnumerable
</A></li>
        <LI>Next message: <A HREF="032528.html">[Mono-dev] [PATCH] Simple implementation of network interface properties for Mac OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32527">[ date ]</a>
              <a href="thread.html#32527">[ thread ]</a>
              <a href="subject.html#32527">[ subject ]</a>
              <a href="author.html#32527">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jul 1, 2009 at 1:13 AM, Trouve Antoine&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">trouve.antoine at mac.com</A>&gt; wrote:
&gt;&gt;&gt;<i> This is incorrect. List&lt;Subclass&gt; cannot be cast to List&lt;Superclass&gt; on
</I>&gt;&gt;&gt;<i> .NET.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Some examples like this can be solved by generic
</I>&gt;&gt;&gt;<i> covariance/contravariance in .NET 4.0. See
</I>&gt;&gt;&gt;<i> <A HREF="http://themonkeysgrinder.blogspot.com/2009/02/c-4-is-now.html">http://themonkeysgrinder.blogspot.com/2009/02/c-4-is-now.html</A> for some
</I>&gt;&gt;&gt;<i> explanations. However, since System.Generic.Collections.List&lt;T&gt; both
</I>&gt;&gt;&gt;<i> accepts and returns objects of type T, I don't believe it could be
</I>&gt;&gt;&gt;<i> made variant.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ho, you're right. I think this behaviour has changed since .NET 2.0.
</I>&gt;&gt;<i> I've just checked and one of my old project do not compile anymore.
</I>&gt;&gt;<i> ... or I might have missed something.
</I>&gt;<i>
</I>&gt;<i> I have missed something and written too fast: this projects works in the
</I>&gt;<i> case I use my old interfaces (e.g. IList instead of List)
</I>&gt;<i> It the point explained in your link as &quot;variance&quot; right ? By the way I
</I>&gt;<i> remember it was not supported by Mono 1.3 or something.
</I>&gt;<i> I tested and it works with gmcs 2.4 (and 1.9 since I've just tested).
</I>
What I said is true for &quot;normal&quot; (nonvariant) generic types.

However, arrays aren't really generic types. They are treated
&quot;specially&quot; by the runtime, so that they can be cast to IList&lt;T&gt; /
ICollection&lt;T&gt; / IEnumerable&lt;T&gt;, where T is the array element type or
any supertype. Presumably your problem was a bug in this feature, in
an older version of Mono.

This is demonstrated by the following sample.

using System;
using System.Collections.Generic;

class Program
{
	class A {}
	class B : A {}

	static void Main (string[] args)
	{
		B[] foo = new B[0];
		Console.WriteLine (foo is IList&lt;B&gt;); // true
		Console.WriteLine (foo is IList&lt;A&gt;); // true

		List&lt;B&gt; bar = new List&lt;B&gt; ();
		Console.WriteLine (bar is IList&lt;B&gt;); // true
		Console.WriteLine (bar is IList&lt;A&gt;); // FALSE
	}
}


Covariance and contravariance are interesting because they make this
kind of casting possible for generic types. They're in .NET 4.0, which
is not yet released, and hence are not yet supported by Mono either.
There are plenty of explanations on the web, so I won't got into
details here.

-- 
Michael Hutchinson
<A HREF="http://mjhutchinson.com">http://mjhutchinson.com</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032525.html">[Mono-dev] Array and IEnumerable
</A></li>
	<LI>Next message: <A HREF="032528.html">[Mono-dev] [PATCH] Simple implementation of network interface properties for Mac OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32527">[ date ]</a>
              <a href="thread.html#32527">[ thread ]</a>
              <a href="subject.html#32527">[ subject ]</a>
              <a href="author.html#32527">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
