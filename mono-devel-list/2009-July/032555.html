<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] ** ERROR **: Type System.DateTime which is passed to unmanaged code must have a StructLayout attribute aborting...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%2A%2A%20ERROR%20%2A%2A%3A%20Type%20System.DateTime%20which%20is%20passed%20to%0A%20unmanaged%20code%20must%20have%20a%20StructLayout%20attribute%20aborting...&In-Reply-To=24361243.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032534.html">
   <LINK REL="Next"  HREF="032535.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] ** ERROR **: Type System.DateTime which is passed to unmanaged code must have a StructLayout attribute aborting...</H1>
    <B>Robert Jordan</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%2A%2A%20ERROR%20%2A%2A%3A%20Type%20System.DateTime%20which%20is%20passed%20to%0A%20unmanaged%20code%20must%20have%20a%20StructLayout%20attribute%20aborting...&In-Reply-To=24361243.post%40talk.nabble.com"
       TITLE="[Mono-dev] ** ERROR **: Type System.DateTime which is passed to unmanaged code must have a StructLayout attribute aborting...">robertj at gmx.net
       </A><BR>
    <I>Sat Jul 11 18:05:14 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032534.html">[Mono-dev] ** ERROR **: Type System.DateTime which is passed to unmanaged code must have a StructLayout attribute aborting...
</A></li>
        <LI>Next message: <A HREF="032535.html">[Mono-dev] [PATCH] System.Web ParseError - API Compatibility (added	3 missing members)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32555">[ date ]</a>
              <a href="thread.html#32555">[ thread ]</a>
              <a href="subject.html#32555">[ subject ]</a>
              <a href="author.html#32555">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Darrek wrote:
&gt;<i> I get this message when trying to run a project in Mono while using a COM
</I>&gt;<i> dll.  It errors whenever the constructor is called.  Is there any way to get
</I>&gt;<i> around this?
</I>
Mono does not support DateTime marshaling for COM interop. The only way
to fix this is to change the signature from DateTime to double and
use DateTime's ToOADate() and FromOADate() members:

Declaration:

from

	void SomeMethod(DateTime dt)

to
	void SomeMethod(double dt)


Call site:

from
	foo.SomeMethod (someDateTime);

to
	foo.SomeMethod (someDateTime.ToOADate());

Robert

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032534.html">[Mono-dev] ** ERROR **: Type System.DateTime which is passed to unmanaged code must have a StructLayout attribute aborting...
</A></li>
	<LI>Next message: <A HREF="032535.html">[Mono-dev] [PATCH] System.Web ParseError - API Compatibility (added	3 missing members)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32555">[ date ]</a>
              <a href="thread.html#32555">[ thread ]</a>
              <a href="subject.html#32555">[ subject ]</a>
              <a href="author.html#32555">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
