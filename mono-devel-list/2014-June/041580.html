<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Patch for NetworkInformation on OSX
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Patch%20for%20NetworkInformation%20on%20OSX&In-Reply-To=%3CCFB682DF30F39E4B8028F48CC5CF1AFA0516C23A%40MB03.mailcluster.haw-hamburg.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041578.html">
   <LINK REL="Next"  HREF="041581.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Patch for NetworkInformation on OSX</H1>
    <B>H&#252;ning, Christian</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Patch%20for%20NetworkInformation%20on%20OSX&In-Reply-To=%3CCFB682DF30F39E4B8028F48CC5CF1AFA0516C23A%40MB03.mailcluster.haw-hamburg.de%3E"
       TITLE="[Mono-dev] Patch for NetworkInformation on OSX">Christian.Huening at haw-hamburg.de
       </A><BR>
    <I>Thu Jun  5 11:56:49 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="041578.html">[Mono-dev] Patch for NetworkInformation on OSX
</A></li>
        <LI>Next message: <A HREF="041581.html">[Mono-dev] Patch for NetworkInformation on OSX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41580">[ date ]</a>
              <a href="thread.html#41580">[ thread ]</a>
              <a href="subject.html#41580">[ subject ]</a>
              <a href="author.html#41580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I did not change the windows and linux behaviour. I wasn&#8217;t aware there were issues as well?

 

 

Von: Bryan Crotaz [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">bryan.crotaz at silvercurve.co.uk</A>] 
Gesendet: Donnerstag, 5. Juni 2014 12:43
An: H&#252;ning, Christian
Cc: <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list at lists.ximian.com</A>
Betreff: Re: [Mono-dev] Patch for NetworkInformation on OSX

 

Does it work on Linux and windows? Or does it fall back to the old behaviour? Or does it throw nasty errors?

Bryan Crotaz

Silver Curve


On 5 Jun 2014, at 11:41, &quot;H&#252;ning, Christian&quot; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Christian.Huening at haw-hamburg.de</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Christian.Huening at haw-hamburg.de</A>&gt; &gt; wrote:

Hi everybody,

 

I just ran into a problem regarding the usage of System.Net.NetworkInformation.NetworkInterface.cs on OSX. Especially the Properties &#8222;SupportsMulticast&#8220; and &#8222;OperationalStatus&#8220; were not implemented properly (always returning false / unknown). So I just fixed that. 

 

On <A HREF="http://mono-project.com/Contributing#Ways_to_Contribute">http://mono-project.com/Contributing#Ways_to_Contribute</A> it&#8217;s written to post patches to this mailing list, so I do :)

 

My solution basically works by extracting the ifa_flags via getifaddrs and storing the flags in the MacOsNetworkInterface class inside of NetworkInterface.cs. I can then implement the two properties like so:

 

            public override OperationalStatus OperationalStatus {
            get {
                if(((MacOsInterfaceFlags)_ifa_flags &amp; MacOsInterfaceFlags.IFF_UP) == MacOsInterfaceFlags.IFF_UP){
                    return OperationalStatus.Up;
                }
                return OperationalStatus.Unknown;
            }
        }

        public override bool SupportsMulticast {
            get {
                return ((MacOsInterfaceFlags)_ifa_flags &amp; MacOsInterfaceFlags.IFF_MULTICAST) == MacOsInterfaceFlags.IFF_MULTICAST;
            }
        } 

 

MacOsInterfaceFlags is an Enum residing in MacOsNetworkInterfaceMarshal.cs: 

    internal enum MacOsInterfaceFlags {
        IFF_UP = 0x1,                /* interface is up */
        IFF_BROADCAST = 0x2,        /* broadcast address valid */
        IFF_DEBUG = 0x4,            /* turn on debugging */
        IFF_LOOPBACK = 0x8,            /* is a loopback net */
        IFF_POINTOPOINT = 0x10,        /* interface is point-to-point link */
        IFF_NOTRAILERS = 0x20,        /* avoid use of trailers */
        IFF_RUNNING = 0x40,            /* resources allocated */
        IFF_NOARP = 0x80,            /* no address resolution protocol */
        IFF_PROMISC = 0x100,        /* receive all packets */
        IFF_ALLMULTI = 0x200,        /* receive all multicast packets */
        IFF_OACTIVE = 0x400,        /* transmission in progress */
        IFF_SIMPLEX = 0x800,        /* can't hear own transmissions */
        IFF_LINK0 = 0x1000,            /* per link layer defined bit */
        IFF_LINK1 = 0x2000,            /* per link layer defined bit */
        IFF_LINK2 = 0x4000,            /* per link layer defined bit */
        IFF_MULTICAST = 0x8000        /* supports multicast */
    } 

 

So is this a valid solution? It works well in my project and the corresponding test cases. 

 

Cheers,

Christian

 

-----------------------------------------------

Christian H&#252;ning, BSc.

Fakult&#228;t Technik und Informatik, Department Informatik

Berliner Tor 7

20099 Hamburg

Tel.: +49 40 / 42875 - 8436 

Mobil: +49 40 / 180 55 44 5

Web: <A HREF="http://www.mars-group.org">http://www.mars-group.org</A>

 

_______________________________________________
Mono-devel-list mailing list
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt; 
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140605/ff4b48bc/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140605/ff4b48bc/attachment-0001.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 5684 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140605/ff4b48bc/attachment-0001.bin">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140605/ff4b48bc/attachment-0001.bin</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041578.html">[Mono-dev] Patch for NetworkInformation on OSX
</A></li>
	<LI>Next message: <A HREF="041581.html">[Mono-dev] Patch for NetworkInformation on OSX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41580">[ date ]</a>
              <a href="thread.html#41580">[ thread ]</a>
              <a href="subject.html#41580">[ subject ]</a>
              <a href="author.html#41580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
