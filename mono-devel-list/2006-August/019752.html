<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Keep-alive connection with Remoting?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Keep-alive%20connection%20with%20Remoting%3F&In-Reply-To=dd99b8c80608091301h5ad196ebjad43b36a4d36adcc%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019744.html">
   <LINK REL="Next"  HREF="019755.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Keep-alive connection with Remoting?</H1>
    <B>Ympostor</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Keep-alive%20connection%20with%20Remoting%3F&In-Reply-To=dd99b8c80608091301h5ad196ebjad43b36a4d36adcc%40mail.gmail.com"
       TITLE="[Mono-dev] Keep-alive connection with Remoting?">ympostor at clix.pt
       </A><BR>
    <I>Thu Aug 10 09:30:11 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="019744.html">[Mono-dev] Keep-alive connection with Remoting?
</A></li>
        <LI>Next message: <A HREF="019755.html">[Mono-dev] Keep-alive connection with Remoting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19752">[ date ]</a>
              <a href="thread.html#19752">[ thread ]</a>
              <a href="subject.html#19752">[ subject ]</a>
              <a href="author.html#19752">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Rafael Teixeira wrote:
&gt;<i> You have to choose the server state-model and configure the Lifetime
</I>&gt;<i> policy in the server. The default even for the singleton state-model
</I>&gt;<i> is to kill the server object after a few minutes and recreate on the
</I>&gt;<i> next request from the client.
</I>
Thanks for the guidance. I said that I had overriden the LifeTimeService 
method in the clients. I made it on the server with no luck, but after 
that I realised that I had to do it also on the MarshalByRefObject 
object used in the Reachability sources, then all time-out problems 
disappeared.

&gt;<i> It is a design-for-scalability decision MS did for remoting, as
</I>&gt;<i> long-living server objects (and also connections) are some of the
</I>&gt;<i> worst enemies of scalability.
</I>&gt;<i> 
</I>&gt;<i> As you said scalability is a concern for you, I need to warn that you
</I>&gt;<i> are actively working against it by choosing persistent connections,
</I>&gt;<i> and long-living server objects.
</I>&gt;<i> 
</I>&gt;<i> My experience is that persistent connections put a ceiling (and a
</I>&gt;<i> really low one) on how much you can scale, something like a few
</I>&gt;<i> hundred to a thousand simultaneous connections depending in the OS and
</I>&gt;<i> network I/O efficiency of the hardware.
</I>&gt;<i> 
</I>&gt;<i> Long-living server objects strain memory usage and thus garbage
</I>&gt;<i> collection (even causing server hiccups), when you try to scale up,
</I>&gt;<i> but surely, how fast it breaks is dependent on the memory consumption
</I>&gt;<i> of all the chain of objects needed by your server object to service a
</I>&gt;<i> request, so it is more tied to your specific implementation than the
</I>&gt;<i> persistent connections issue.
</I>&gt;<i> 
</I>&gt;<i> Just some facts I learned from a long life is this business, and that
</I>&gt;<i> I teach my post-graduation students in return.
</I>
Really interesting thoughts but I have some questions:

- If long-living service is used, are you saying that its dead objects 
won't never be collected until the service dies for any reason?
- If I had to deal with scalability issues, how could I use a not 
long-living service without loosing the connection with the clients? I 
am thinking of ordering them to disconnect and reconnect again but, 
wouldn't this consume so many resources and processor cycles (and time 
in which the server is not available for incoming connections) if we are 
treating with ~1000 clients...?

However, my main concern now is to make it work and then lately solve 
any scalability issues. And then, my update about the progress, if 
anyone is interested:

As I said, I already changed the sources to 2.0 API and to work with 
long-living connections, but now I am stuck with a very stupid problem: 
I just want to implement a similar method to &quot;SendMessage&quot; but that 
sends a file to the client, but I don't know why it works only sometimes:

- In the same host, one client and one server, it works (the file is 
received).
- Same host, two clients and one server, one client receives the file 
and the other client receives the first notification but doesn't end the 
method to save the file. :?
- Host A with server, host B with client. If I send a normal message the 
communication works, but if I try to send the file, there is no 
communication. :?

I am becoming crazy... Perhaps in the end this is not a very stable 
solution.

BTW I have found two more solutions:

a) PeerChannel [ 
<A HREF="http://www.mailframe.net/Products/PeerChannel/default.aspx">http://www.mailframe.net/Products/PeerChannel/default.aspx</A> ]

It seems to be free but:
- I haven't managed to make it work yet (NullReferenceException thrown 
at the middleware channels, not in the client or server...? perhaps 
again due to 1.1 vs 2.0 problems...).
- Not all source is attached in the ZIP. There is a 
MailFrameDataStructures.dll that doesn't come with the source!


b) DotNetRemoting SDK [ <A HREF="http://www.dotnetremoting.com/">http://www.dotnetremoting.com/</A> ]

Again, commercial, and seems not to be very popular (I have read some 
criticism about this library...).


Regards.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019744.html">[Mono-dev] Keep-alive connection with Remoting?
</A></li>
	<LI>Next message: <A HREF="019755.html">[Mono-dev] Keep-alive connection with Remoting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19752">[ date ]</a>
              <a href="thread.html#19752">[ thread ]</a>
              <a href="subject.html#19752">[ subject ]</a>
              <a href="author.html#19752">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
