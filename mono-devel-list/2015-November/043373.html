<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] certmgr - #35064
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20certmgr%20-%20%2335064&In-Reply-To=%3CD266201F.4A4E3%25neale%40sinenomine.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043411.html">
   <LINK REL="Next"  HREF="043374.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] certmgr - #35064</H1>
    <B>Neale Ferguson</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20certmgr%20-%20%2335064&In-Reply-To=%3CD266201F.4A4E3%25neale%40sinenomine.net%3E"
       TITLE="[Mono-dev] certmgr - #35064">neale at sinenomine.net
       </A><BR>
    <I>Mon Nov  9 15:04:17 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="043411.html">[Mono-dev] self hosted WCF service with client certificates?
</A></li>
        <LI>Next message: <A HREF="043374.html">[Mono-dev] Debugging Mono applications under GDB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43373">[ date ]</a>
              <a href="thread.html#43373">[ thread ]</a>
              <a href="subject.html#43373">[ subject ]</a>
              <a href="author.html#43373">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
 I still haven&#8217;t found a solution to the problem #35064 (see below). Is
there another way on Linux to achieve the same result - i.e. Import a
private key into the right place required?

Neale

MONO_PATH=$MCS/class/lib/net_4_x:$HOME/Mono/xsp/src/lib
$MONO/mono/mini/mono-sgen $MCS/tools/security/certmgr.exe --importKey -c
-v -m
My MonoTestCert.pfx
Mono Certificate Manager - version 4.3.0.0
Manage X.509 certificates and CRL from stores.
Copyright 2002, 2003 Motus Technologies. Copyright 2004-2008 Novell. BSD
licensed.
 
Unhandled Exception:
System.Security.Cryptography.CryptographicException: Invalid MAC - file may
have been tampered!
  at Mono.Security.X509.PKCS12.Decode (System.Byte[] data) &lt;0x3fffcca5378
0x00fd0&gt; in &lt;filename unknown&gt;:0
  at Mono.Security.X509.PKCS12..ctor (System.Byte[] data) &lt;0x3fffcca4cb0
0x0005e&gt; in &lt;filename unknown&gt;:0
  at Mono.Security.X509.PKCS12.LoadFromFile (System.String filename)
&lt;0x3fffcca47e8  0x0006e&gt; in &lt;filename unknown&gt;:0
  at Mono.Tools.CertificateManager.LoadCertificates (System.String
filename,
System.String password, Boolean verbose) &lt;0x3fffcca2fa8  0x0046e&gt; in
&lt;filename
unknown&gt;:0 
  at Mono.Tools.CertificateManager.ImportKey (ObjectType type, Boolean
machine,
System.String file, System.String password, Boolean verbose)
&lt;0x3fffcca2488 
0x000b2&gt; in &lt;filename unknown&gt;:0
  at Mono.Tools.CertificateManager.Main (System.String[] args)
&lt;0x3fffac5d120 
0x007d4&gt; in &lt;filename unknown&gt;:0
[ERROR] FATAL UNHANDLED EXCEPTION:
System.Security.Cryptography.CryptographicException: Invalid MAC - file may
have been tampered!
  at Mono.Security.X509.PKCS12.Decode (System.Byte[] data) &lt;0x3fffcca5378
0x00fd0&gt; in &lt;filename unknown&gt;:0
  at Mono.Security.X509.PKCS12..ctor (System.Byte[] data) &lt;0x3fffcca4cb0
0x0005e&gt; in &lt;filename unknown&gt;:0
  at Mono.Security.X509.PKCS12.LoadFromFile (System.String filename)
&lt;0x3fffcca47e8  0x0006e&gt; in &lt;filename unknown&gt;:0
  at Mono.Tools.CertificateManager.LoadCertificates (System.String
filename,
System.String password, Boolean verbose) &lt;0x3fffcca2fa8  0x0046e&gt; in
&lt;filename
unknown&gt;:0 
  at Mono.Tools.CertificateManager.ImportKey (ObjectType type, Boolean
machine,
System.String file, System.String password, Boolean verbose)
&lt;0x3fffcca2488 
0x000b2&gt; in &lt;filename unknown&gt;:0
  at Mono.Tools.CertificateManager.Main (System.String[] args)
&lt;0x3fffac5d120 
0x007d4&gt; in &lt;filename unknown&gt;:0
 
This happens either 3.10.1 or head (as at 19 Oct 2015). I added some debug
code
just to see what was happening:
 
password:  iterations: 2000
MAC does not match calculated MAC
    Lengths: 20 20
47 0D 4F D5 B3 2B D6 62 45 C7 53 8C 33 89 C8 6C B1 DB C5 DA &lt;--- MAC from
key
8B 3D 08 E3 F5 CE 37 AB 64 D1 A6 CE F6 B8 86 75 C1 07 4F BE &lt;---
Calculated MAC

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043411.html">[Mono-dev] self hosted WCF service with client certificates?
</A></li>
	<LI>Next message: <A HREF="043374.html">[Mono-dev] Debugging Mono applications under GDB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43373">[ date ]</a>
              <a href="thread.html#43373">[ thread ]</a>
              <a href="subject.html#43373">[ subject ]</a>
              <a href="author.html#43373">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
