<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Error handling longs on Mono SPARC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Error%20handling%20longs%20on%20Mono%20SPARC&In-Reply-To=4AE7179A.3070703%40terra.es">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033340.html">
   <LINK REL="Next"  HREF="033344.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Error handling longs on Mono SPARC</H1>
    <B>Zoltan Varga</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Error%20handling%20longs%20on%20Mono%20SPARC&In-Reply-To=4AE7179A.3070703%40terra.es"
       TITLE="[Mono-dev] Error handling longs on Mono SPARC">vargaz at gmail.com
       </A><BR>
    <I>Tue Oct 27 14:29:22 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033340.html">[Mono-dev] Error handling longs on Mono SPARC
</A></li>
        <LI>Next message: <A HREF="033344.html">[Mono-dev] Error handling longs on Mono SPARC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33342">[ date ]</a>
              <a href="thread.html#33342">[ thread ]</a>
              <a href="subject.html#33342">[ subject ]</a>
              <a href="author.html#33342">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

  A small testcase would be very useful, it can usually be generated by
taking the code
which exhibits the problem, and removing stuff from it. Also, does it happen
with 2.4
too ?

                        Zoltan

On Tue, Oct 27, 2009 at 4:54 PM, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A> &lt;
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A>&gt; wrote:

&gt;<i> Hi Zoltan,
</I>&gt;<i>
</I>&gt;<i> Should we file a bug on bugzilla?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> pablo
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A> wrote:
</I>&gt;<i> &gt; Hi Zoltan,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It's the daily tarball (the date is in the version string) which I
</I>&gt;<i> &gt; believe is svn trunk.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; pablo
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Zoltan Varga wrote:
</I>&gt;<i> &gt;&gt; Hi,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;   Is this the 2.6 prerelease, or using the code from the mono-2-6 branch
</I>&gt;<i> &gt;&gt; ? The latter has
</I>&gt;<i> &gt;&gt; some sparc fixes.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;                              Zoltan
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On Mon, Oct 26, 2009 at 1:11 PM, <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A>
</I>&gt;<i> &gt;&gt; &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A>&gt; &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A>
</I>&gt;<i> &gt;&gt; &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A>&gt;&gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     Hi there,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     This is our configuration:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     -bash-3.00$ uname -a
</I>&gt;<i> &gt;&gt;     SunOS atenea 5.11 snv_34 sun4u sparc SUNW,Sun-Blade-1000
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     -bash-3.00$ mono --version
</I>&gt;<i> &gt;&gt;     Mono JIT compiler version 20091021 (tarball Wed Oct 21 19:04:28 CEST
</I>&gt;<i> &gt;&gt;     2009)
</I>&gt;<i> &gt;&gt;     Copyright (C) 2002-2009 Novell, Inc and Contributors.
</I>&gt;<i> &gt;&gt;     www.mono-project.com &lt;<A HREF="http://www.mono-project.com">http://www.mono-project.com</A>&gt;
</I>&gt;<i> &gt;&gt;            TLS:           normal
</I>&gt;<i> &gt;&gt;            GC:            Included Boehm (with typed GC and Parallel
</I>&gt;<i> Mark)
</I>&gt;<i> &gt;&gt;            SIGSEGV:       normal
</I>&gt;<i> &gt;&gt;            Notification:  Thread + polling
</I>&gt;<i> &gt;&gt;            Architecture:  sparc
</I>&gt;<i> &gt;&gt;            Disabled:      none
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     We're using a Mono 2.6 compiled at our test box.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     We've a code like this:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     long dstBrId = GetBranchNumber(brId);
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     log.DebugFormat(&quot;Branch {0} -&gt; {1}&quot;, brId, dstBrId);
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     Calling this method:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;            private long GetBranchNumber(long brId)
</I>&gt;<i> &gt;&gt;            {
</I>&gt;<i> &gt;&gt;                Branch br = (Branch) mFetchBranches[brId];
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;                if( br != null )
</I>&gt;<i> &gt;&gt;                {
</I>&gt;<i> &gt;&gt;                    return br.ObjId;
</I>&gt;<i> &gt;&gt;                }
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;                log.DebugFormat(&quot;GetBranchNumber returning {0}&quot;, brId);
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;                return brId;
</I>&gt;<i> &gt;&gt;            }
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     And that's the log it is showing:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;      - GetBranchNumber returning 4
</I>&gt;<i> &gt;&gt;      - Branch 4 -&gt; 17179869188
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     It looks like, for some reason, this 4 is &quot;magically&quot; becoming a
</I>&gt;<i> &gt;&gt;     17179869188!!!!!!
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     17179869188 is -&gt; 400000004 in hex!!!!
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     And, it *gets fixed by building disabling the &quot;optimize&quot; mode*
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     Of course, a test app like this:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     using System;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     class Hello
</I>&gt;<i> &gt;&gt;     {
</I>&gt;<i> &gt;&gt;        public static void Main()
</I>&gt;<i> &gt;&gt;        {
</I>&gt;<i> &gt;&gt;            Hello t = new Hello();
</I>&gt;<i> &gt;&gt;            long myval = 4;
</I>&gt;<i> &gt;&gt;            long longVal = t.GetValue(myval);
</I>&gt;<i> &gt;&gt;            Console.WriteLine(longVal);
</I>&gt;<i> &gt;&gt;        }
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;        private long GetValue(long v)
</I>&gt;<i> &gt;&gt;        {
</I>&gt;<i> &gt;&gt;            return v;
</I>&gt;<i> &gt;&gt;        }
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     }
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     Does not fail.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     Any idea?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     Thanks,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     pablo
</I>&gt;<i> &gt;&gt;     _______________________________________________
</I>&gt;<i> &gt;&gt;     Mono-devel-list mailing list
</I>&gt;<i> &gt;&gt;     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt;&gt;     &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>&gt;
</I>&gt;<i> &gt;&gt;     <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mono-devel-list mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091027/61bf5d10/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20091027/61bf5d10/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033340.html">[Mono-dev] Error handling longs on Mono SPARC
</A></li>
	<LI>Next message: <A HREF="033344.html">[Mono-dev] Error handling longs on Mono SPARC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33342">[ date ]</a>
              <a href="thread.html#33342">[ thread ]</a>
              <a href="subject.html#33342">[ subject ]</a>
              <a href="author.html#33342">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
