<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev]  Mono 2.4 on IA-64 SGI Altix 4700
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%20Mono%202.4%20on%20IA-64%20SGI%20Altix%204700&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033372.html">
   <LINK REL="Next"  HREF="033377.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev]  Mono 2.4 on IA-64 SGI Altix 4700</H1>
    <B>d-a-z-z-a</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20%20Mono%202.4%20on%20IA-64%20SGI%20Altix%204700&In-Reply-To="
       TITLE="[Mono-dev]  Mono 2.4 on IA-64 SGI Altix 4700">darryl at cain.com.au
       </A><BR>
    <I>Thu Oct 29 20:59:10 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033372.html">[Mono-dev] Mono and WSDL with SSL
</A></li>
        <LI>Next message: <A HREF="033377.html">[Mono-dev] Mono 2.4 on IA-64 SGI Altix 4700
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33376">[ date ]</a>
              <a href="thread.html#33376">[ thread ]</a>
              <a href="subject.html#33376">[ subject ]</a>
              <a href="author.html#33376">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

I am trying to get Mono 2.4 running on a SGI Altix 4700 (96-way Itanium 2
box) running SUSE Linux Enterprise Server 10.  It compiles successfully
using default configuration settings however upon testing it fails at simple
locking (n threads incrementing a shared counter produces race conditions). 
I have tried;

  -&gt; Changing &quot;--with-tls&quot; between both &quot;__thread&quot; and &quot;pthread&quot;
  -&gt; Changing CFLAGS, CCASFLAGS, CXXFLAGS and FFLAGS to exclude
optimizations (removed -O2)
  -&gt; Altering versions of glib (between glib-2.16.5 and glib-2.20.5) - there
is a gthread dependence but I am not sure how that impacts matters.

Unfortunately none of the above made any difference.  Is anybody out there
running Mono on anything similar hardware wise (IA-64 at least)?  Any ideas? 
Any help would be greatly appreciated.

It should be noted that this all works fine on a 8-way AMD64 box with the
test program producing correct results (to exclude test program as a
possible problem).

Some more details:
  Using: glib-2.20.5, libunwind-0.99, gcc version 4.1.2 20070115 (SUSE
Linux)

Test App &quot;core&quot; (C#) - n threads executing Worker() followed by join:

public static void Worker()
{
  int steps = increments / n_threads;
  for (int i = 0; i &lt; steps; i++)
  {
    lock (shared_lock)
    {
       shared_counter++;
    }
  }
}

Test App results:

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">user at host</A>:~/code/tests&gt; mono SharedCounter.exe 1000000 10
1000000 increments over 10 threads
Counter value: 999023

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">user at host</A>:~/code/tests&gt; mono SharedCounter.exe 1000000 10
1000000 increments over 10 threads
Counter value: 999087

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">user at host</A>:~/code/tests&gt; mono SharedCounter.exe 1000000 10
1000000 increments over 10 threads
Counter value: 999211

<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">user at host</A>:~/code/tests&gt; mono SharedCounter.exe 1000000 10
1000000 increments over 10 threads
Counter value: 999219

Please let me know if you need any additional information. Thanks in
advance,

Darryl
-- 
View this message in context: <A HREF="http://www.nabble.com/Mono-2.4-on-IA-64-SGI-Altix-4700-tp26123445p26123445.html">http://www.nabble.com/Mono-2.4-on-IA-64-SGI-Altix-4700-tp26123445p26123445.html</A>
Sent from the Mono - Dev mailing list archive at Nabble.com.

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033372.html">[Mono-dev] Mono and WSDL with SSL
</A></li>
	<LI>Next message: <A HREF="033377.html">[Mono-dev] Mono 2.4 on IA-64 SGI Altix 4700
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33376">[ date ]</a>
              <a href="thread.html#33376">[ thread ]</a>
              <a href="subject.html#33376">[ subject ]</a>
              <a href="author.html#33376">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
