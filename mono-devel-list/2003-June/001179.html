<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] cmove patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20cmove%20patch&In-Reply-To=1055923243.18223.17.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001169.html">
   <LINK REL="Next"  HREF="001195.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] cmove patch</H1>
    <B>Paolo Molaro</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20cmove%20patch&In-Reply-To=1055923243.18223.17.camel%40localhost.localdomain"
       TITLE="[Mono-devel-list] cmove patch">lupus at ximian.com
       </A><BR>
    <I>Thu Jun 19 04:52:39 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001169.html">[Mono-devel-list] cmove patch
</A></li>
        <LI>Next message: <A HREF="001195.html">[Mono-devel-list] cmove patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1179">[ date ]</a>
              <a href="thread.html#1179">[ thread ]</a>
              <a href="subject.html#1179">[ subject ]</a>
              <a href="author.html#1179">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/18/03 dietmar wrote:
&gt;<i> if (cond) a = x; else a = y;
</I>&gt;<i> 
</I>&gt;<i> which could be translated into 2 conditional movex
</I>&gt;<i> 
</I>&gt;<i> cmove (cond, a, x)
</I>&gt;<i> cmove (!cond, a, y)
</I>&gt;<i> 
</I>&gt;<i> but x and y can be expression, so they can set the EFALGS. Sure, we can
</I>&gt;<i> avoid that if we first compute them, but IMO thats a bit clumsy.
</I>
We need to add that kind of info to the machine descriptions: which
instructions modify the flags and so on: with that in place it's easy to
check for this case.

&gt;<i> any better ideas, suggestion?
</I>
Note: the use of conditional move instructions needs to be dependent on
the MONO_OPT_CMOV optimization flag.
The main issue with your patch is that we can't do the conditional moves at 
the point you inserted them in the compilation process: it needs to
happen after instruction selection and also probably after local
register allocation, since it would be very complex otherwise to
take into account conditional moves in some optimizations (copy prop,
instruction scheduling, register allocation itself).

lupus

-- 
-----------------------------------------------------------------
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at debian.org</A>                                     debian/rules
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">lupus at ximian.com</A>                             Monkeys do it better

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001169.html">[Mono-devel-list] cmove patch
</A></li>
	<LI>Next message: <A HREF="001195.html">[Mono-devel-list] cmove patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1179">[ date ]</a>
              <a href="thread.html#1179">[ thread ]</a>
              <a href="subject.html#1179">[ subject ]</a>
              <a href="author.html#1179">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
