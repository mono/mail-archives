<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Hashtable serialization issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Hashtable%20serialization%20issue&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001222.html">
   <LINK REL="Next"  HREF="001224.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Hashtable serialization issue</H1>
    <B>Lluis Sanchez</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Hashtable%20serialization%20issue&In-Reply-To="
       TITLE="[Mono-devel-list] Hashtable serialization issue">lluis at ideary.com
       </A><BR>
    <I>Tue Jun 24 13:03:28 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="001222.html">[Mono-devel-list] XML (de)serialization
</A></li>
        <LI>Next message: <A HREF="001224.html">[Mono-devel-list] Hashtable serialization issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1223">[ date ]</a>
              <a href="thread.html#1223">[ thread ]</a>
              <a href="subject.html#1223">[ subject ]</a>
              <a href="author.html#1223">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

There is one problem when serializing a hashtable from which an element has been removed. 

The current implementation uses a special value to mark slots as deleted. It is an Object instance, defined in the constant REMOVED_MARKER. When the hashtable is serialized, it also serializes those Object instances. The problem is that when the hashtable is deserialized, the Object instance that the serializer constructs is not the same as the internal REMOVED_MARKER instance, so it thinks it is valid value slot.

The attached patch solves the problem. However, I don't know if this is the best approach, I don't fully understand why this REMOVED_MARKER is needed.

If there aren't any objections, I'll commit the patch.

Regards,
Lluis.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030624/8569c445/attachment.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030624/8569c445/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Hashtable.diff
Type: application/octet-stream
Size: 856 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030624/8569c445/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20030624/8569c445/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001222.html">[Mono-devel-list] XML (de)serialization
</A></li>
	<LI>Next message: <A HREF="001224.html">[Mono-devel-list] Hashtable serialization issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1223">[ date ]</a>
              <a href="thread.html#1223">[ thread ]</a>
              <a href="subject.html#1223">[ subject ]</a>
              <a href="author.html#1223">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
