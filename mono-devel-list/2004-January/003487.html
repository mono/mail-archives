<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] SystemBrushes and SystemPens - resending
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20SystemBrushes%20and%20SystemPens%20-%20resending&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003485.html">
   <LINK REL="Next"  HREF="003488.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] SystemBrushes and SystemPens - resending</H1>
    <B>Ravindra Kumar</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20SystemBrushes%20and%20SystemPens%20-%20resending&In-Reply-To="
       TITLE="[Mono-devel-list] SystemBrushes and SystemPens - resending">rkumar at novell.com
       </A><BR>
    <I>Wed Jan  7 09:24:06 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="003485.html">[Mono-devel-list] Any new dailies anywhere?
</A></li>
        <LI>Next message: <A HREF="003488.html">[Mono-devel-list] Managed implementation of OracleClient?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3487">[ date ]</a>
              <a href="thread.html#3487">[ thread ]</a>
              <a href="subject.html#3487">[ subject ]</a>
              <a href="author.html#3487">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
Please ignore my previous mail and kindly review the attached patches.
Sorry for the inconvenience.

As I was going through S.D code I came across following statement in
.NET docs,
*************
SystemColors class:
	Remarks: Better performance is achieved through the use of the
SystemPens object or 
	SystemBrushes object rather than creating a new pen or brush
based on a value from 
	the SystemColors object. For example, use SystemBrushes.Control
because it is a 
	brush that already exists, whereas new
SolidBrush(SystemColors.Control) creates a 
	new brush.
**************
Given this remark, I think the current implementation of SystemBrushes
is not correct as we are creating objects whenever a property is
requested. Please find attached my patch for correcting the same. I have
modified SystemPens also.Additionally, I have added support for
&quot;FromSystemColor(Color)&quot; method and few other missing properties in both
of the classes.

I have two issues here,
1. I have noticed that SystemColors vary with theme on Windows.
Therefore, I don't think current implementation of SystemColors is going
to give us proper values, as it has hardcoded values. May be we should
look at some option of getting these values from desktop or we can use
values of windows classic theme(?).
2. On .NET, I have noticed that Pen/Brush color cannot be modified, if
a pen/brush is obtained from SystemPens or SystemBrushes. I get
following exception,

********************************************************
[code]
	Pen pen = SystemPens.ActiveCaptionText;
	Console.WriteLine(&quot;color: &quot; + pen.Color);
	pen.Color = Color.Red;
	Console.WriteLine(&quot;color: &quot; + pen.Color);
[code]

E:\Projects\Mono\Tests\System.Drawing\new&gt;TestSystemPens.exe
color: Color [ActiveCaptionText]

Unhandled Exception: System.ArgumentException: You may not change this
Pen because
 it does not belong to you.
   at System.Drawing.Pen.set_Color(Color value)
   at MonoTests.System.Drawing.TestSystemPens.Main()
*********************************************************
I don't know how can I achieve this behavior on Mono. Please give me
some idea to get the same behavior.
Please comment on my changes, if I can commit. However, I think if it
is not possible to achieve this behavior on Mono, existing
implementation of SystemBrushes would be a good choice even for
SystemPens.

Thanks
Ravi
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SystemBrushes.patch2
Type: application/octet-stream
Size: 5993 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040107/90ab8119/attachment.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040107/90ab8119/attachment.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SystemPens.patch2
Type: application/octet-stream
Size: 4654 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040107/90ab8119/attachment-0001.obj">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20040107/90ab8119/attachment-0001.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003485.html">[Mono-devel-list] Any new dailies anywhere?
</A></li>
	<LI>Next message: <A HREF="003488.html">[Mono-devel-list] Managed implementation of OracleClient?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3487">[ date ]</a>
              <a href="thread.html#3487">[ thread ]</a>
              <a href="subject.html#3487">[ subject ]</a>
              <a href="author.html#3487">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
