<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] StringBuilder patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20StringBuilder%20patch&In-Reply-To=20040113164730.GK7092%40debian.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003581.html">
   <LINK REL="Next"  HREF="003606.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] StringBuilder patch</H1>
    <B>Ben Maurer</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20StringBuilder%20patch&In-Reply-To=20040113164730.GK7092%40debian.org"
       TITLE="[Mono-devel-list] StringBuilder patch">bmaurer at users.sourceforge.net
       </A><BR>
    <I>Tue Jan 13 16:32:21 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="003581.html">[Mono-devel-list] StringBuilder patch
</A></li>
        <LI>Next message: <A HREF="003606.html">[Mono-devel-list] StringBuilder patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3591">[ date ]</a>
              <a href="thread.html#3591">[ thread ]</a>
              <a href="subject.html#3591">[ subject ]</a>
              <a href="author.html#3591">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2004-01-13 at 11:47, Paolo Molaro wrote:
&gt;<i> On 01/12/04 Ben Maurer wrote:
</I>&gt;<i> &gt; One other thing we should do is to preserve the old source. The old
</I>&gt;<i> &gt; stringbuilder is actually VERY useful, and highly performant as a
</I>&gt;<i> &gt; `string buffer'. For example, if you allocate one static stringbuilder,
</I>&gt;<i> &gt; and use it multiple times, the cost of the extra slack on the end of
</I>&gt;<i> &gt; strings is more than what is lost by having the extra char [] buffer.
</I>&gt;<i> [...]
</I>&gt;<i> &gt; In this case, it is MUCH more efficient to do it the old way (assuming
</I>&gt;<i> &gt; you have a pretty big number of strings.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So, it would be nice if we could publish the old source as a utility
</I>&gt;<i> &gt; class. We should rename it something like Mono.StringBuffer.
</I>&gt;<i> 
</I>&gt;<i> The new code already creates a new string if the string buffer is unused
</I>&gt;<i> for the most part. Maybe the code can be changed in the future to use
</I>&gt;<i> some different criteria, like, don't waste more than x bytes etc.
</I>&gt;<i> I don't see any reason to keep the old code around: it's much more a
</I>&gt;<i> waste to keep it maintained and have two copies of mostly the same code
</I>&gt;<i> jitted in the same application.
</I>
The real issue is when you create long lasting strings. Lets say you
create 10 k strings each with a length of 17 bytes. If the buffer is 32
bytes, you end up wasting 150 kb.

In the MCS tokenizer, for large programs such as corlib, we could end up
taking a megabyte or more extra memory and holding it.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003581.html">[Mono-devel-list] StringBuilder patch
</A></li>
	<LI>Next message: <A HREF="003606.html">[Mono-devel-list] StringBuilder patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3591">[ date ]</a>
              <a href="thread.html#3591">[ thread ]</a>
              <a href="subject.html#3591">[ subject ]</a>
              <a href="author.html#3591">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
