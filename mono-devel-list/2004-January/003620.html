<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] mono and .net web services
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20mono%20and%20.net%20web%20services&In-Reply-To=1074170214.23659.21.camel%40melchior.magi">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003615.html">
   <LINK REL="Next"  HREF="003656.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] mono and .net web services</H1>
    <B>Daniel Pinto de Mello e Silva</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20mono%20and%20.net%20web%20services&In-Reply-To=1074170214.23659.21.camel%40melchior.magi"
       TITLE="[Mono-devel-list] mono and .net web services">dsilva at ccs.neu.edu
       </A><BR>
    <I>Thu Jan 15 11:40:45 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="003615.html">[Mono-devel-list] mono and .net web services
</A></li>
        <LI>Next message: <A HREF="003656.html">[Mono-devel-list] mono and .net web services
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3620">[ date ]</a>
              <a href="thread.html#3620">[ thread ]</a>
              <a href="subject.html#3620">[ subject ]</a>
              <a href="author.html#3620">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 2004-01-15 at 07:36, Jonathan Pryor wrote:
&gt;<i> Alas, I can only answer one of your questions...
</I>&gt;<i> 
</I>&gt;<i> On Wed, 2004-01-14 at 22:26, Daniel Pinto de Mello e Silva wrote:
</I>&gt;<i> &lt;snip/&gt;
</I>&gt;<i> &gt; The web-service ASMX file is being interpreted just fine in the first
</I>&gt;<i> &gt; IIS server.  From its WSDL file Mono's wsdl tool created a client
</I>&gt;<i> &gt; proxy.  The proxy library (compiled with Mono's mcs) is placed in the
</I>&gt;<i> &gt; second IIS server.
</I>&gt;<i> 
</I>&gt;<i> &lt;snip/&gt;
</I>&gt;<i> 
</I>&gt;<i> &gt; Are .Net assemblies compiled with Mono's mcs supposed to work under
</I>&gt;<i> &gt; Microsoft's VM and IIS?
</I>&gt;<i> 
</I>&gt;<i> The answer is a resounding maybe.
</I>&gt;<i> 
</I>&gt;<i> Yes, the IL generated by mcs will execute properly under .NET and IIS.
</I>&gt;<i> 
</I>&gt;<i> Unfortunately, IL isn't the only concern.  The other concern (and the
</I>&gt;<i> primary concern in this case) is the behavior with shared assemblies.
</I>&gt;<i> 
</I>&gt;<i> First of all, mcs doesn't (AFAIK) place the public key token from the
</I>&gt;<i> assemblies it's linked against into the generated file.  Which means you
</I>&gt;<i> can't have two shared Foo.dll's, signed by different companies, and have
</I>&gt;<i> Mono/mcs load the correct Foo.dll.  (Not that this is a problem, as with
</I>&gt;<i> the current design of Mono -- with no GAC -- there could only be one
</I>&gt;<i> Foo.dll in $prefix/lib, which is the default search directory, so you
</I>&gt;<i> can't really have two Foo.dll's installed anyway...)
</I>&gt;<i> 
</I>&gt;<i> Even if this were fixed, there's the second issue.  You're compiling
</I>&gt;<i> under Linux, so you'll be compiling against Mono's
</I>&gt;<i> System.Web.Services.dll, which will (most assuredly) have a different
</I>&gt;<i> public key token than Microsoft's System.Web.Services.dll.  Thus, even
</I>&gt;<i> with properly generated IL referencing the &quot;correct&quot; strongly-named
</I>&gt;<i> Assembly, you'd be referencing Mono's assembly, not Microsoft's.
</I>
Thanks for the explanation.  That's too bad...

&gt;<i> There are two solutions to your problem:
</I>&gt;<i> (1) Copy Mono's System.Web.Services.dll into the same directory as the
</I>&gt;<i> proxy library.  Since Mono's System.Web.Services.dll is a private
</I>&gt;<i> Assembly and is in the same directory as your proxy library (which is
</I>&gt;<i> effectively referencing a private assembly, as it lacks the public key
</I>&gt;<i> token information needed for shared assemblies), your proxy should now
</I>&gt;<i> load properly.  The (possible) problem is that you'll be using Mono's
</I>&gt;<i> System.Web.Services.dll, not Microsoft's, which may not be desired.
</I>&gt;<i> 
</I>
Unfortunately, this doesn't seem to work.  Another error shows up when I
copy Mono's System.Web.Services.dll to ./bin:

&quot;&quot;&quot;
Exception Details: System.NullReferenceException: Object reference not
set to an instance of an object.

Source Error: 
Line 43:     public void OnSubmit(Object sender, EventArgs e)
Line 44:       {
Line 45:       Calc.CalculatorSoap service = new Calc.CalculatorSoap();

Source File: d:\iishome\dsilva\calculator-client.aspx    Line: 45 

Stack Trace: 

[NullReferenceException: Object reference not set to an instance of an
object.]
   System.Reflection.CustomAttribute.GetObject() +287

[CustomAttributeFormatException: ParameterStyle property specified was
not found.]
   System.Reflection.CustomAttribute.GetObject() +358
  
System.Reflection.CustomAttribute.CheckConsistencyAndCreateArray(CustomAttribute caItem, Type caType) +539
   System.Reflection.CustomAttribute.GetCustomAttributes(MemberInfo
member, Type caType, Boolean inherit) +453
   System.Reflection.RuntimeMethodInfo.GetCustomAttributes(Type
attributeType, Boolean inherit) +54
  
System.Web.Services.Protocols.LogicalMethodInfo.GetCustomAttributes(Type
type) +120
  
System.Web.Services.Protocols.SoapReflector.GetSoapMethodAttribute(LogicalMethodInfo methodInfo) +49
  
System.Web.Services.Protocols.SoapReflector.ReflectMethod(LogicalMethodInfo methodInfo, Boolean client, XmlReflectionImporter xmlImporter, SoapReflectionImporter soapImporter, String defaultNs) +133

[InvalidOperationException: Method CalculatorSoap.Div can not be
reflected.]
  
System.Web.Services.Protocols.SoapReflector.ReflectMethod(LogicalMethodInfo methodInfo, Boolean client, XmlReflectionImporter xmlImporter, SoapReflectionImporter soapImporter, String defaultNs) +5419
   System.Web.Services.Protocols.SoapClientType..ctor(Type type) +828
   System.Web.Services.Protocols.SoapHttpClientProtocol..ctor() +151
   Calc.CalculatorSoap..ctor() +10
   ASP.calculator_client_aspx.OnSubmit(Object sender, EventArgs e) in
d:\iishome\dsilva\calculator-client.aspx:45
   System.Web.UI.HtmlControls.HtmlInputButton.OnServerClick(EventArgs e)
+108
  
System.Web.UI.HtmlControls.HtmlInputButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +57
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler
sourceControl, String eventArgument) +18
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)
+33
   System.Web.UI.Page.ProcessRequestMain() +1277
&quot;&quot;&quot;


&gt;<i> (2) Compile all your code with csc.exe on a Windows box.  csc.exe knows
</I>&gt;<i> about shared assemblies, and will properly reference against the
</I>&gt;<i> appropriate .NET libraries.
</I>
Hmm ok.

&gt;<i> This is likely to remain a problem into the future, even after mcs gets
</I>&gt;<i> proper public-key-token support and Mono gets a GAC.  As long as
</I>&gt;<i> Microsoft and Mono use different public/private keys for assembly
</I>&gt;<i> signing, .NET will want to use the Mono assemblies when executing
</I>&gt;<i> mono/mcs-generated assemblies.  Such is the price of strong versioning. 
</I>&gt;<i> Compatibility is largely one-way: Mono can execute most .NET-generated
</I>&gt;<i> programs, but .NET might not be able to handle the Mono-generated ones.
</I>&gt;<i> 
</I>
Thanks for your quick response.

Daniel



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003615.html">[Mono-devel-list] mono and .net web services
</A></li>
	<LI>Next message: <A HREF="003656.html">[Mono-devel-list] mono and .net web services
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3620">[ date ]</a>
              <a href="thread.html#3620">[ thread ]</a>
              <a href="subject.html#3620">[ subject ]</a>
              <a href="author.html#3620">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
