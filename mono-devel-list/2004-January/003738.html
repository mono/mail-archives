<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] Corlib test cases
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Corlib%20test%20cases&In-Reply-To=20040122220510.GK31772%40ox.compsoc.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003735.html">
   <LINK REL="Next"  HREF="003739.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] Corlib test cases</H1>
    <B>David Sheldon</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20Corlib%20test%20cases&In-Reply-To=20040122220510.GK31772%40ox.compsoc.net"
       TITLE="[Mono-devel-list] Corlib test cases">dave-monolist at earth.li
       </A><BR>
    <I>Thu Jan 22 18:43:31 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="003735.html">[Mono-devel-list] Corlib test cases
</A></li>
        <LI>Next message: <A HREF="003739.html">[Mono-devel-list] Corlib test cases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3738">[ date ]</a>
              <a href="thread.html#3738">[ thread ]</a>
              <a href="subject.html#3738">[ subject ]</a>
              <a href="author.html#3738">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jan 22, 2004 at 10:05:10PM +0000, David Sheldon wrote:
&gt;<i> I have been trying to assign bug numbers to the tests that I can see
</I>&gt;<i> failing. 
</I>
Here are my notes on the next 10. There are some interesting ones here
that I cannot duplicate outside of the test case framework (yet they
happen every time I run the tests), and some that I just don't really
understand.

David

&gt;<i> 11) MonoTests.System.DoubleFormatterTest.TestFormatStringsN1 : DblFn1 #7 
</I>&gt;<i> 	String lengths are both 78.
</I>&gt;<i> 	Strings differ at index 13.
</I>&gt;<i> 	
</I>&gt;<i> 	expected:&lt;&quot;99.999,99999960000000000000000000000000000000000...&quot;&gt;
</I>&gt;<i> 	 but was:&lt;&quot;99.999,99999959998400000000000000000000000000000...&quot;&gt;
</I>&gt;<i> 	-----------------------^
</I>&gt;<i> 	
</I>&gt;<i>                       
</I>&gt;<i> in [0x0000d] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System/DoubleFormatterTest.cs:51) MonoTests.System.DoubleFormatterTest:FormatStringTest (string,System.Globalization.NumberFormatInfo,double,string,string)
</I>&gt;<i> in [0x000fa] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System/DoubleFormatterTest.cs:138) MonoTests.System.DoubleFormatterTest:TestFormatStringsN1 ()
</I>
&gt;<i> 12) MonoTests.System.DoubleFormatterTest.TestFormatStringsN2 : DblFn2 #6 
</I>&gt;<i> 	String lengths are both 17.
</I>&gt;<i> 	Strings differ at index 13.
</I>&gt;<i> 	
</I>&gt;<i> 	expected:&lt;&quot;99,999.999999600$&quot;&gt;
</I>&gt;<i> 	 but was:&lt;&quot;99,999.999999599$&quot;&gt;
</I>&gt;<i> 	-----------------------^
</I>
Do we use less accurate Doubles or something? These look like a floating-point
accuracy bug. 


&gt;<i> 13) MonoTests.System.DoubleTest.TestToString : ToString Failed: '1.2' Should be &quot;1.2&quot; with &quot;#.##&quot; 
</I>&gt;<i> 	String lengths differ.  Expected length=3, but was length=4.
</I>&gt;<i> 	Strings differ at index 2.
</I>&gt;<i> 	
</I>&gt;<i> 	expected:&lt;&quot;1.2&quot;&gt;
</I>&gt;<i> 	 but was:&lt;&quot;1.19&quot;&gt;
</I>&gt;<i> 	------------^
</I>&gt;<i>                       
</I>&gt;<i> in [0x01414] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System/DoubleTest.cs:443) MonoTests.System.DoubleTest:CustomFormatHelper ()
</I>&gt;<i> in [0x00050] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System/DoubleTest.cs:221) MonoTests.System.DoubleTest:TestToString ()
</I>
&gt;<i> 14) MonoTests.System.FloatingPointFormatterTest.Format1 : F2 
</I>&gt;<i> 	String lengths differ.  Expected length=5, but was length=16.
</I>&gt;<i> 	Strings differ at index 1.
</I>&gt;<i> 	
</I>&gt;<i> 	expected:&lt;&quot;1E+15&quot;&gt;
</I>&gt;<i> 	 but was:&lt;&quot;1000000000000000&quot;&gt;
</I>&gt;<i> 	-----------^
</I>&gt;<i> 	
</I>&gt;<i>                       
</I>&gt;<i> in [0x0003b] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System/FloatingPointFormatterTest.cs:23) MonoTests.System.FloatingPointFormatterTest:Format1 ()
</I>
Hmm. I cannot duplicate these problems in stand-alone code, so I cannot narrow
the problem down any further.


&gt;<i> 15) MonoTests.System.Int32Test.TestToString : #D06(3) 
</I>&gt;<i> 	String lengths differ.  Expected length=14, but was length=12.
</I>&gt;<i> 	Strings differ at index 12.
</I>&gt;<i> 	
</I>&gt;<i> 	expected:&lt;&quot;-2147483648.00&quot;&gt;
</I>&gt;<i> 	 but was:&lt;&quot;-2147483648.&quot;&gt;
</I>&gt;<i> 	----------------------^
</I>&gt;<i> 	
</I>&gt;<i>                       
</I>&gt;<i> in [0x0014b] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System/Int32Test.cs:212) MonoTests.System.Int32Test:TestToString ()
</I>
&gt;<i> 16) MonoTests.System.Int64Test.TestToString : MyInt64_2.ToString(Formats1[3]) 
</I>&gt;<i> 	String lengths differ.  Expected length=23, but was length=21.
</I>&gt;<i> 	Strings differ at index 21.
</I>&gt;<i> 	
</I>&gt;<i> 	expected:&lt;&quot;-9223372036854775808.00&quot;&gt;
</I>&gt;<i> 	 but was:&lt;&quot;-9223372036854775808.&quot;&gt;
</I>&gt;<i> 	-------------------------------^
</I>&gt;<i> 	
</I>&gt;<i>                       
</I>&gt;<i> in [0x00108] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System/Int64Test.cs:300) MonoTests.System.Int64Test:TestToString ()
</I>
More of the Culture problems in bug 53022.

&gt;<i> 17) MonoTests.System.IO.BinaryReaderTest.ReadDecimal : test#01 
</I>&gt;<i> 	expected:&lt;-18295873486192640&gt;
</I>&gt;<i> 	 but was:&lt;18295873486192640&gt;
</I>&gt;<i>                           
</I>&gt;<i> in [0x00043] (at /home/sheldon/hacking/mono/raw_cvs/mcs/class/corlib/Test/System.IO/BinaryReaderTest.cs:977) MonoTests.System.IO.BinaryReaderTest:ReadDecimal ()
</I>
Oh, this is an interesting one. If I run the following code on MS.NET I get: 

d is -18295873486192640
d != -18295873486192640

If I run it on mono I get:

d is 18295873486192640
d != -18295873486192640

So there is definitely a difference, but it reveals that there might be a more
fundamental problem with the test case.

The code is: 

using System;                                                                   
using System.IO;
 
namespace p {                                                                   
   public class m {                                                             
                                                                                
      public static void Main (string [] args) {
	        MemoryStream stream = null;
                BinaryReader reader = null;
                try {
                        stream = new MemoryStream (new byte [] {0, 0, 0, 0, 0, 0, 65, 0, 0, 0, 0, 0, 0, 0, 0 ,87, 98, 0, 0, 0, 0});
                        reader = new BinaryReader (stream);
   
                        Decimal d = reader.ReadDecimal();
                        Console.WriteLine(&quot;d is &quot; + d);
                        if (d != -18295873486192640) {
                           Console.WriteLine(&quot;d != -18295873486192640&quot;);
			}
                } finally {
                        reader.Close ();
                        stream.Close ();
                }    

}                                                                         
   }                                                                            
}                                          


&gt;<i> 18) MonoTests.System.IO.BufferedStreamTest.CtorOutOfRangeException2 : ObjectDisposedException was expected
</I>
For this one (constructing a BufferedStream from a closed stream), we don't
throw the exception on construction, but on the first read, as we do not read
from the underlying stream in the constructor. 

If we want to throw the ObjectDisposedException in the constructor, then we
will need to change the way that buffering happens. Is this something important
to solve, or should we remove the test?


&gt;<i> 19) MonoTests.System.IO.FileInfoTest.OpenReadIOException : IOException was expected
</I>
I don't really understand this I'm afraid. It seems that on windows you cannot
open the file both to get info and to read it, or something. Is this a locking
test? Is it desirable to throw the exception that is expected?


-- 
&quot;There is no statute of limitations on stupidity.&quot;
-- Randomly produced by a computer program called Markov3.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003735.html">[Mono-devel-list] Corlib test cases
</A></li>
	<LI>Next message: <A HREF="003739.html">[Mono-devel-list] Corlib test cases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3738">[ date ]</a>
              <a href="thread.html#3738">[ thread ]</a>
              <a href="subject.html#3738">[ subject ]</a>
              <a href="author.html#3738">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
