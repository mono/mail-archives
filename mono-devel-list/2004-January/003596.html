<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-devel-list] StringBuilder patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20StringBuilder%20patch&In-Reply-To=20040113130228.GH7092%40debian.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003573.html">
   <LINK REL="Next"  HREF="003603.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-devel-list] StringBuilder patch</H1>
    <B>Piers Haken</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-devel-list%5D%20StringBuilder%20patch&In-Reply-To=20040113130228.GH7092%40debian.org"
       TITLE="[Mono-devel-list] StringBuilder patch">piersh at friskit.com
       </A><BR>
    <I>Tue Jan 13 18:35:02 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="003573.html">[Mono-devel-list] StringBuilder patch
</A></li>
        <LI>Next message: <A HREF="003603.html">[Mono-devel-list] StringBuilder patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3596">[ date ]</a>
              <a href="thread.html#3596">[ thread ]</a>
              <a href="subject.html#3596">[ subject ]</a>
              <a href="author.html#3596">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> On 01/12/04 Piers Haken wrote:
</I>&gt;<i> &gt; - how easy would it be to implement support for this kind of 
</I>&gt;<i> &gt; optimization in the current JIT framework.
</I>&gt;<i> 
</I>&gt;<i> It's not hard to implement. In the peephole pass, when a cond 
</I>&gt;<i> branch is found, you can look at the true and false basic blocks.
</I>&gt;<i> One should look like:
</I>&gt;<i> 	iconst %reg // or storei4_membase_imm
</I>&gt;<i> and the other:
</I>&gt;<i> 	iconst %reg // or storei4_membase_imm
</I>&gt;<i> 	br
</I>
Yeah, you could certainly apply this optimization in a few limited cases
during peephole. However, I believe you'd be able to do this (and similar
optimizations) in more complex cases like...

	if (c == 7)
		return obj.method (1);
	else
		return obj.method (19);

...if you had some kind of higher-level branch analysis that occurred
earlier in the process. I'm not sure if burg would be useful for this or
not, but imagine you had some tuples that represented operation on sets of
basic blocks, for example:
	IF_ELSE (&lt;cond&gt;,&lt;if tree&gt;,&lt;else tree&gt;)
	WHILE (&lt;cond&gt;,&lt;tree&gt;)
	DO (&lt;cond&gt;,&lt;tree&gt;)
	TREES (&lt;tree&gt;, &lt;tree&gt;)

Then, instead of thinking of a method as a set of basic blocks, each of
which is a forest of tuple-trees, then you think of the method as a single
tuple-tree. Then, doing things like common subexpression elimination, loop
invariance, the above ternary extractions, etc... would just be a question
of moving nodes of the tree upwards as far as they can go while retaining
their store dependancies.

Obviously this isn't really well thought out within the context of the mono
JIT which I'm not really familiar with. It's just a concept I was using a
while ago when I was working on a decompiler (same idea, different results).

Piers.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003573.html">[Mono-devel-list] StringBuilder patch
</A></li>
	<LI>Next message: <A HREF="003603.html">[Mono-devel-list] StringBuilder patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3596">[ date ]</a>
              <a href="thread.html#3596">[ thread ]</a>
              <a href="subject.html#3596">[ subject ]</a>
              <a href="author.html#3596">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
