<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono.Posix Cross Compiling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Mono.Posix%20Cross%20Compiling&In-Reply-To=%3CBN3PR0801MB115407C5D1BE2E9C7DB767FCFA590%40BN3PR0801MB1154.namprd08.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="042575.html">
   <LINK REL="Next"  HREF="042577.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono.Posix Cross Compiling</H1>
    <B>Edward Ned Harvey (mono)</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Mono.Posix%20Cross%20Compiling&In-Reply-To=%3CBN3PR0801MB115407C5D1BE2E9C7DB767FCFA590%40BN3PR0801MB1154.namprd08.prod.outlook.com%3E"
       TITLE="[Mono-dev] Mono.Posix Cross Compiling">edward.harvey.mono at clevertrove.com
       </A><BR>
    <I>Tue Jan  6 16:12:03 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="042575.html">[Mono-dev] Mono.Posix Cross Compiling
</A></li>
        <LI>Next message: <A HREF="042577.html">[Mono-dev] Mono.Posix Cross Compiling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42576">[ date ]</a>
              <a href="thread.html#42576">[ thread ]</a>
              <a href="subject.html#42576">[ subject ]</a>
              <a href="author.html#42576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> From: Dave Curylo [mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">dacurylo at gmail.com</A>] On Behalf Of David Curylo
</I>&gt;<i> 
</I>&gt;<i> You have to use conditional compilation for the code that uses the
</I>&gt;<i> conditional reference, in this case Mono.Posix.  The reference appears with a
</I>&gt;<i> warning in Visual Studio and you get a compiler warning, &quot;The referenced
</I>&gt;<i> component 'Mono.Posix' could not be found&quot; but this is to be expected on
</I>&gt;<i> Windows/.NET.  This may be an annoyance, but it allows developers to be
</I>&gt;<i> productive developers on either platform, so I consider this to be a functional
</I>&gt;<i> solution.
</I>&gt;<i> 
</I>&gt;<i> I created an example here on github:
</I>&gt;<i> <A HREF="https://github.com/ninjarobot/MonoConditionalReference">https://github.com/ninjarobot/MonoConditionalReference</A>
</I>&gt;<i> 
</I>&gt;<i> This builds fine on Xamarin Studio on OS X and Visual Studio on Windows,
</I>&gt;<i> although given the conditional compilation, the resulting assembly is
</I>&gt;<i> different.  We take this approach in my organization so that some developers
</I>&gt;<i> can work on Windows with Visual Studio and other developers work entirely
</I>&gt;<i> on mono (our target platform).
</I>
That's cool, but - You don't need to add the &quot;Conditional&quot; clause to the &lt;Reference&gt; tag of the csproj.  I just checked out your project, and got rid of the conditional clause in the csproj, so the reference to Mono.Posix is unconditional.  The behavior is the same.  It compiles fine and gives warning about the unused and broken reference.  The reason it works is because of the #if __MonoCS__ which eliminates any calls to the missing assembly.

As long as you can eliminate any calls to the missing assembly via #if or [Conditional], then you don't actually need the assembly and it's ok to ignore the warning about broken reference, missing assembly.

The time when a real problem occurs is when you actually *do* need the assembly.  For example, if I copy Mono.Security.dll over to windows, and create a project that uses it in both windows &amp; mono, then I have something like this in the windows csproj:

    &lt;Reference Include=&quot;Mono.Security&quot;&gt;
      &lt;HintPath&gt;..\..\libs\mono\Mono.Security.dll&lt;/HintPath&gt;
    &lt;/Reference&gt;

Which will not compile on mono.  So in mono, I have to modify the csproj to be like this:

    &lt;Reference Include=&quot;Mono.Security&quot; /&gt;

Which will not compile on Windows.

As far as I can tell, any attempt to use Conditional property in the &lt;Reference&gt; tag is simply ignored.  So I settle on using the kludgy hack of using different csproj files on windows &amp; mono.  It works so I didn't spend more time on it - but if there's a more elegant solution, I'd like to know.
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="042575.html">[Mono-dev] Mono.Posix Cross Compiling
</A></li>
	<LI>Next message: <A HREF="042577.html">[Mono-dev] Mono.Posix Cross Compiling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42576">[ date ]</a>
              <a href="thread.html#42576">[ thread ]</a>
              <a href="subject.html#42576">[ subject ]</a>
              <a href="author.html#42576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
