<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Update on Build System
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Update%20on%20Build%20System&In-Reply-To=%3CCANqeOFo0Dqep_KoXNF5YXG6zzGHmaNmNxNWDZ1roxd17ORjQpw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041552.html">
   <LINK REL="Next"  HREF="041554.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Update on Build System</H1>
    <B>Miguel de Icaza</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-dev%5D%20Update%20on%20Build%20System&In-Reply-To=%3CCANqeOFo0Dqep_KoXNF5YXG6zzGHmaNmNxNWDZ1roxd17ORjQpw%40mail.gmail.com%3E"
       TITLE="[Mono-dev] Update on Build System">miguel at xamarin.com
       </A><BR>
    <I>Mon May 26 15:23:28 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="041552.html">[Mono-dev] Update on Build System
</A></li>
        <LI>Next message: <A HREF="041554.html">[Mono-dev] Update on Build System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41553">[ date ]</a>
              <a href="thread.html#41553">[ thread ]</a>
              <a href="subject.html#41553">[ subject ]</a>
              <a href="author.html#41553">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Chris,

That is what I am trying to do with this work.

There are still a number of problems that I need to address:

   - Installing the resulting binaries
   - Signing (currently we are skipping this)
   - Ensure the binaries produced are identical with Make and msbuild
   - Add assertions to ensure that flags that we currently ignore are
   caught, in case we add new features in the future
   - Fix the C# compiler build (currently disabled)
   - Extend this to other components, so we can have the entire setup in a
   solution.

Then we would have something that works.

Miguel


On Mon, May 26, 2014 at 11:04 AM, Chris Tacke &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">ctacke at opennetcf.com</A>&gt; wrote:

&gt;<i> Miguel,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is great news. Are there any plans to update the build system to
</I>&gt;<i> allow us to compile the runtime itself using Visual Studio (i.e. a
</I>&gt;<i> Microsoft compiler)?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Now before everyone starts with the eye rolling and &#8220;why the hell would
</I>&gt;<i> you want to do that?&#8221; questions, let me explain.  As of today, we can
</I>&gt;<i> create applications in C# that will run on Windows and a large array of
</I>&gt;<i> Linux machines (including Android) but Windows CE has been orphaned.
</I>&gt;<i> Microsoft is not putting any effort into the Compact Framework, but there
</I>&gt;<i> are still people developing for Windows CE devices.  I&#8217;d like to put a last
</I>&gt;<i> nail in the coffin of the Compact Framework by getting Mono supported on
</I>&gt;<i> Windows CE so we can all move into using technology from the current
</I>&gt;<i> decade, not the last one.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I don&#8217;t see any real path for getting the runtimes to compile for Windows
</I>&gt;<i> CE  for ARM and 586 (not 686, since we have new Intel processors now that
</I>&gt;<i> are 586 based).  There is an old (last touch in 2009) CeGCC project that
</I>&gt;<i> might be a step, but I was hoping for something a little simpler.  I&#8217;m up
</I>&gt;<i> for any suggestions.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Chris Tacke
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A> [mailto:
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">mono-devel-list-bounces at lists.ximian.com</A>] *On Behalf Of *Miguel de Icaza
</I>&gt;<i> *Sent:* Friday, May 23, 2014 9:59 PM
</I>&gt;<i> *To:* mono-devel
</I>&gt;<i> *Subject:* [Mono-dev] Update on Build System
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hey guys,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #1 Makefile Build System Update
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> So the clean staged setup has been added to mono/master and in practice
</I>&gt;<i> most of you will never notice an improvement.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Those working on libraries that had cross dependencies will enjoy reliable
</I>&gt;<i> and working builds.   If you make a change in say System, and you type
</I>&gt;<i> &quot;make&quot; in mcs/class/System, it will make sure that all the dependencies are
</I>&gt;<i> properly compiled and the result will be stable.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #2 MSBuild setup
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Based on the work above, I have updated the MSBuild setup, and it is now
</I>&gt;<i> possible to build most of the managed code with xbuild.   This means that
</I>&gt;<i> you can use this from Visual Studio or Xamarin Studio.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Since xbuild does not support passing /keyfile to the C# compiler, I still
</I>&gt;<i> have to fix about 6-7 assemblies that use -keyfile to be signed.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Once that happens, you should be able to build all of Mono's managed code
</I>&gt;<i> with:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> xbuild msvc/scripts/net_4_5.sln
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Currently I disabled generating project files for profiles other than 4.5,
</I>&gt;<i> just because it is easier to debug this way.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I am also a bit sad that our xbuild does not have any support for parallel
</I>&gt;<i> builds, it would have been a neat hack to make the xbuild-based build
</I>&gt;<i> system parallel and get this for free.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #3 Future Parallel Work - Makefiles
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I tried to implement parallel builds for mcs/class/Facades, and while it
</I>&gt;<i> works, it regressed some of the other standard targets that we have (the
</I>&gt;<i> other -local).   I will have to revisit this later.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> But the principle behind the patch that enabled this could be used for
</I>&gt;<i> mcs/class and parallelize all the builds as well.   We only need to (a)
</I>&gt;<i> generate the assembly dependencies [1] and (b) we need to figure out the
</I>&gt;<i> -local target breakage (same stuff I broke for Facades).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [1]  (which we have from the xbuild work above)
</I>&gt;<i>
</I>&gt;<i> Miguel
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140526/779ac870/attachment-0001.html">http://lists.ximian.com/pipermail/mono-devel-list/attachments/20140526/779ac870/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041552.html">[Mono-dev] Update on Build System
</A></li>
	<LI>Next message: <A HREF="041554.html">[Mono-dev] Update on Build System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41553">[ date ]</a>
              <a href="thread.html#41553">[ thread ]</a>
              <a href="subject.html#41553">[ subject ]</a>
              <a href="author.html#41553">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
