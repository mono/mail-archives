<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Mono hangs on shutdown when /dev/ttySx ports were opened.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20hangs%20on%20shutdown%20when%20/dev/ttySx%20ports%20were%0A%20opened.&In-Reply-To=23a15590909170228u4ae8bbbfs566367af433118f9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033070.html">
   <LINK REL="Next"  HREF="033072.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Mono hangs on shutdown when /dev/ttySx ports were opened.</H1>
    <B>Christian Hoff</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Mono%20hangs%20on%20shutdown%20when%20/dev/ttySx%20ports%20were%0A%20opened.&In-Reply-To=23a15590909170228u4ae8bbbfs566367af433118f9%40mail.gmail.com"
       TITLE="[Mono-dev] Mono hangs on shutdown when /dev/ttySx ports were opened.">christian_hoff at gmx.net
       </A><BR>
    <I>Mon Sep 21 04:07:45 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033070.html">[Mono-dev] Mono hangs on shutdown when /dev/ttySx ports were	opened.
</A></li>
        <LI>Next message: <A HREF="033072.html">[Mono-dev] Mono hangs on shutdown when /dev/ttySx ports were	opened.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33071">[ date ]</a>
              <a href="thread.html#33071">[ thread ]</a>
              <a href="subject.html#33071">[ subject ]</a>
              <a href="author.html#33071">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Leszek Ciesielski wrote:
&gt;<i> I am experiencing Mono hangup when my application should terminate.
</I>&gt;<i> The application opens multiple serial ports, but the bug has also
</I>&gt;<i> manifested when network sockets were hanging on reads or writes - it
</I>&gt;<i> seems to be related to a pending I/O operation, asynchronous
</I>&gt;<i> networking helps somewhat. Anyway, the managed code exits, Mono CPU
</I>&gt;<i> usage jumps to 100%, /proc/PID/status shows 4 threads and the
</I>&gt;<i> application never exits. 
</I>&gt;<i>   
</I>Great to see that this issue is being actively worked on! I'm 
experiencing the same problem with my application which uses serial 
ports. The workaround I'm using so far is to set the read timeout to 
something about 500.

As you have probably figured out already, the problem seems to be that 
Mono does not abort calls to native API. SerialPort.ReadByte pinvokes a 
blocking function in MonoPosixHelper.

I'm not sure if native API calls should be aborted by the Mono runtime. 
Maybe the best solution here is to see how the func is implemented in 
MonoPosixHelper and see if we possibly avoid the blocking native call.


Christian
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033070.html">[Mono-dev] Mono hangs on shutdown when /dev/ttySx ports were	opened.
</A></li>
	<LI>Next message: <A HREF="033072.html">[Mono-dev] Mono hangs on shutdown when /dev/ttySx ports were	opened.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33071">[ date ]</a>
              <a href="thread.html#33071">[ thread ]</a>
              <a href="subject.html#33071">[ subject ]</a>
              <a href="author.html#33071">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
