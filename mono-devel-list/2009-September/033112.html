<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Patch for HttpRuntime and HttpServerUtility to bring API in sync with .NET 2.0 SP2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%20for%20HttpRuntime%20and%20HttpServerUtility%20to%20bring%0A%20API%20in%20sync%20with%20.NET%202.0%20SP2&In-Reply-To=f1c2e2880909240702tf14c213xf0bbf3f218606e85%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033108.html">
   <LINK REL="Next"  HREF="033113.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Patch for HttpRuntime and HttpServerUtility to bring API in sync with .NET 2.0 SP2</H1>
    <B>Marek Habersack</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Patch%20for%20HttpRuntime%20and%20HttpServerUtility%20to%20bring%0A%20API%20in%20sync%20with%20.NET%202.0%20SP2&In-Reply-To=f1c2e2880909240702tf14c213xf0bbf3f218606e85%40mail.gmail.com"
       TITLE="[Mono-dev] Patch for HttpRuntime and HttpServerUtility to bring API in sync with .NET 2.0 SP2">grendel at twistedcode.net
       </A><BR>
    <I>Thu Sep 24 14:32:10 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033108.html">[Mono-dev] Patch for HttpRuntime and HttpServerUtility to bring	API in sync with .NET 2.0 SP2
</A></li>
        <LI>Next message: <A HREF="033113.html">[Mono-dev] Patch for HttpRuntime and HttpServerUtility to bring	API in sync with .NET 2.0 SP2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33112">[ date ]</a>
              <a href="thread.html#33112">[ thread ]</a>
              <a href="subject.html#33112">[ subject ]</a>
              <a href="author.html#33112">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nick Berardi wrote:
&gt;<i> Hi Marek,
</I>Hello,

&gt;<i> I am a little hesitant to to implement this for Mono for the following 
</I>&gt;<i> reasons. 
</I>&gt;<i> 
</I>&gt;<i> /Number 1/ is the description Microsoft provides for it
</I>&gt;<i> &quot;Gets a value that indicates whether the current application is running 
</I>&gt;<i> *in the integrated-pipeline mode of IIS 7.0*.&quot;
</I>You can ignore this particular part of the description. As I wrote in the previous mail, Mono 
effectively implements what was introduced in IIS 7 and termed &quot;integrated-pipeline mode&quot;. Therefore 
it's perfectly fine to implement that in Mono.

&gt;<i> /Number 2/ is that the key feature of the integrated-pipeline is that 
</I>&gt;<i> outside processes still run through the .NET framework first, such as, 
</I>&gt;<i> you can use IHttpModules to process request/response data from for 
</I>&gt;<i> example PHP code, I don't know enough about Mono/XPS to get something 
</I>&gt;<i> like this working. 
</I>XSP doesn't implement that and it doesn't have to, it's just a development server. Apache, otoh, 
provides a full filter/pipelining infrastructure with which Mono should work just fine (i.e. you can 
define a module to act as a filter and pass its output to another module, etc etc) - I have never 
tried it, but I mod_mono is no different to other modules and it should work just fine. It will NOT 
use IHttpModules, of course, because Apache (being IIS counterpart) doesn't have that notion, but 
functionality is exactly the same. We might (just might) approach it at some point and extend 
mod_mono (or create an auxiliary module) in the way which will expose IHttpModules etc to Apache, 
but it's definitely not a priority. Mono/mod_mono/XSP is much more flexible than .NET + IIS combo, 
so the elements are more losely coupled but they can be arranged to work in the same way as IIS.

&gt;<i> Many developers use the UsingIntegratedPipeline flag to indicate if they 
</I>&gt;<i> are running in IIS 7.0 integrated mode or the older &quot;classic mode.&quot;  I 
</I>&gt;<i> really feel that getting both the &quot;classic mode&quot; and integrated mode 
</I>&gt;<i> working under Mono would be a huge undertaking, especially in regards to 
</I>&gt;<i> some of the built in support for their Rewriter Module that they have 
</I>We don't have to aim for 1:1 compatibility in this regard - Apache has rewriter modules which can 
easily replace their IIS counterpart, and we do not aim to make Mono a replacement for .NET under 
IIS. Therefore, if a developer deploys an ASP.NET application to Mono/Apache/mod_mono they should be 
aware of architectural differences. But, again, that doesn't stop us from supporting the APIs (and 
other &quot;integrated pipeline&quot; ones) for the benefit of applications and developers.

&gt;<i> added in to the .NET 2.0 SP2 framework.  Also because a number of 
</I>&gt;<i> sub-routines change in ASP.NET &lt;<A HREF="http://ASP.NET">http://ASP.NET</A>&gt; depending on this one 
</I>&gt;<i> flag. 
</I>Nothing prevents us from defaulting to false for UsingIntegratedPipeline and providing a mechanism 
to turn it on (by e.g. providing a MonoServerEnableIntegratedPipeline AppSettings entry - we already 
have a number of them, documented in the xsp and mod_mono manpages)

&gt;<i> I would like to commit the patch as is for now, to complete some of the 
</I>&gt;<i> missing parts of the API, and I will look in to what it will take to 
</I>&gt;<i> really get this supported in the Mono framework. 
</I>What the patch generally does is provide stub implementations of the API (with, perhaps, the 
exception of the property) which we don't generally like to do, especially if the functionality is 
relatively easy to implement as in this case. I'd rather vote on not commiting the patch in this 
state, but rather wait till you (or somebody else, perhaps even me) provides full support for the 
APIs together with tests etc.

best regards,

marek

&gt;<i> Thanks,
</I>&gt;<i> Nick
</I>&gt;<i> 
</I>&gt;<i> P.S. I know of a dozen places where having integrated mode turned on 
</I>&gt;<i> will allow you to do things that you weren't allowed to before.  For 
</I>&gt;<i> example when integrated mode is enabled you can directly add headers 
</I>&gt;<i> using /HttpRequest.Headers.Add/, instead of getting an exception thrown.
</I>You can do it just fine with Mono as well. As said before, we treat Mono as working in the 
integrated pipeline mode. There's nothing wrong in not having full support for all of its features 
right away, we can implement it step by step.


&gt;<i> 
</I>&gt;<i> On Thu, Sep 24, 2009 at 4:56 AM, Marek Habersack 
</I>&gt;<i> &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">grendel at twistedcode.net</A> &lt;mailto:<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">grendel at twistedcode.net</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     Nick Berardi wrote:
</I>&gt;<i> 
</I>&gt;<i>         Hello group,
</I>&gt;<i> 
</I>&gt;<i>     Hello,
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>         This is my first time submitting a patch.  So if anything I have
</I>&gt;<i>         done is out of the norm, please let me know so that I can
</I>&gt;<i>         correct it.  
</I>&gt;<i>         There are two API's related to IIS 7.0 that were added as part
</I>&gt;<i>         of the .NET 2.0 SP2 release that I need supported for an Open
</I>&gt;<i>         Source project that I work on (<A HREF="http://urlrewriter.codeplex.com">http://urlrewriter.codeplex.com</A>).
</I>&gt;<i>          (<A HREF="http://urlrewriter.codeplex.com/WorkItem/View.aspx?WorkItemId=7187">http://urlrewriter.codeplex.com/WorkItem/View.aspx?WorkItemId=7187</A>)
</I>&gt;<i> 
</I>&gt;<i>         The patch that I am submitting is for the following APIs:
</I>&gt;<i> 
</I>&gt;<i>            * HttpRuntime.UsingIntegratedPipeline { get; }
</I>&gt;<i>            *
</I>&gt;<i>         HttpServerUtility.TransferRequest(string,[bool],[string],[NameValueCollection])
</I>&gt;<i> 
</I>&gt;<i>         Since both of these API's are IIS 7.0+ specific and that they
</I>&gt;<i>         require the Integrated Pipeline to function.  I have the first
</I>&gt;<i>         property UsingIntegratedPipeline always returning false, since
</I>&gt;<i>         it is currently impossible to put Mono in to the core of IIS
</I>&gt;<i>         7.0, so Integrated Pipeline
</I>&gt;<i> 
</I>&gt;<i>     Technically Mono has always been using what IIS 7 calls &quot;integrated
</I>&gt;<i>     pipeline&quot; - there are no plans to make Mono run in the IIS core, so
</I>&gt;<i>     we should try to implement whatever functionality makes sense in
</I>&gt;<i>     Mono context without looking whether or not it works in this or that
</I>&gt;<i>     IIS mode. I'd say UsingIntegratedPipeline could return 'true'
</I>&gt;<i>     without harm.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>         can't currently be supported.  So I hoped to achieve the 2nd
</I>&gt;<i>         best option of API completeness.  The second method
</I>&gt;<i>         TransferRequest relies on the Integrated Pipeline so again it
</I>&gt;<i>         will not be supported.  So I have the method just throwing the
</I>&gt;<i>         publically available exceptions shows on MSDN.  This second
</I>&gt;<i>         method will always throw PlatformNotSupported, for API
</I>&gt;<i>         completeness with the .NET 2.0 SP2 framework.
</I>&gt;<i> 
</I>&gt;<i>     This method, as well, can be implemented to perform its function on
</I>&gt;<i>     Mono just fine. If you feel like giving it a try, I'd welcome a new
</I>&gt;<i>     patch which implements it. If not, I will accept the patch as it is
</I>&gt;<i>     now and implement the API fully at some point.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>         Please let me know what the next steps are or if there is
</I>&gt;<i>         anything that I need to change in order to get this patch moved
</I>&gt;<i>         into production.
</I>&gt;<i> 
</I>&gt;<i>         Thanks,
</I>&gt;<i>         Nick
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     best regards,
</I>&gt;<i> 
</I>&gt;<i>     marek
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-devel-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">Mono-devel-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">http://lists.ximian.com/mailman/listinfo/mono-devel-list</A>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033108.html">[Mono-dev] Patch for HttpRuntime and HttpServerUtility to bring	API in sync with .NET 2.0 SP2
</A></li>
	<LI>Next message: <A HREF="033113.html">[Mono-dev] Patch for HttpRuntime and HttpServerUtility to bring	API in sync with .NET 2.0 SP2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33112">[ date ]</a>
              <a href="thread.html#33112">[ thread ]</a>
              <a href="subject.html#33112">[ subject ]</a>
              <a href="author.html#33112">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
