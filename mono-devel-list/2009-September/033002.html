<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-dev] Compacting GC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Compacting%20GC&In-Reply-To=4AABA31B.2050709%40terra.es">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033001.html">
   <LINK REL="Next"  HREF="033003.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-dev] Compacting GC</H1>
    <B>psantosl at codicesoftware.com</B> 
    <A HREF="mailto:mono-devel-list%40lists.ximian.com?Subject=%5BMono-dev%5D%20Compacting%20GC&In-Reply-To=4AABA31B.2050709%40terra.es"
       TITLE="[Mono-dev] Compacting GC">psantosl at codicesoftware.com
       </A><BR>
    <I>Sat Sep 12 09:38:21 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033001.html">[Mono-dev] Compacting GC
</A></li>
        <LI>Next message: <A HREF="033003.html">[Mono-dev] Compacting GC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33002">[ date ]</a>
              <a href="thread.html#33002">[ thread ]</a>
              <a href="subject.html#33002">[ subject ]</a>
              <a href="author.html#33002">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Trying again I got some more info:


MCS     [net_1_1] System.dll
**
ERROR:sgen-gc.c:3491:mono_gc_alloc_obj: assertion failed: (*p == NULL)
Stacktrace:

  at (wrapper managed-to-native)
object.__icall_wrapper_mono_array_new_specific (intptr,int) &lt;0x0004b&gt;
  at (wrapper managed-to-native)
object.__icall_wrapper_mono_array_new_specific (intptr,int) &lt;0xffffffff&gt;
  at System.Activator.CreateInstance (System.Type,object[]) &lt;0x0001a&gt;
  at System.Security.Cryptography.CryptoConfig.CreateFromName
(string,object[]) &lt;0x000e7&gt;
  at System.Security.Cryptography.CryptoConfig.CreateFromName (string)
&lt;0x0000e&gt;
  at System.Security.Cryptography.HashAlgorithm.Create (string) &lt;0x0000f&gt;
  at Mono.Security.StrongName.get_PublicKeyToken () &lt;0x00068&gt;
  at System.Reflection.Emit.AssemblyBuilder..ctor
(System.Reflection.AssemblyName,string,System.Reflection.Emit.AssemblyBuilderAccess,bool)
&lt;0x003b5&gt;
  at System.AppDomain.DefineDynamicAssembly
(System.Reflection.AssemblyName,System.Reflection.Emit.AssemblyBuilderAccess,string,System.Security.Policy.Evidence,System.Security.PermissionSet,System.Security.PermissionSet,System.Security.PermissionSet,bool)
&lt;0x0005c&gt;
  at (wrapper remoting-invoke-with-check)
System.AppDomain.DefineDynamicAssembly
(System.Reflection.AssemblyName,System.Reflection.Emit.AssemblyBuilderAccess,string,System.Security.Policy.Evidence,System.Security.PermissionSet,System.Security.PermissionSet,System.Security.PermissionSet,bool)
&lt;0xffffffff&gt;
  at System.AppDomain.DefineDynamicAssembly
(System.Reflection.AssemblyName,System.Reflection.Emit.AssemblyBuilderAccess,string)
&lt;0x00053&gt;
  at (wrapper remoting-invoke-with-check)
System.AppDomain.DefineDynamicAssembly
(System.Reflection.AssemblyName,System.Reflection.Emit.AssemblyBuilderAccess,string)
&lt;0xffffffff&gt;
  at Mono.CSharp.CodeGen.Init
(string,string,bool,Mono.CSharp.CompilerContext) &lt;0x0021c&gt;
  at Mono.CSharp.Driver.Compile () &lt;0x00293&gt;
  at Mono.CSharp.Driver.Main (string[]) &lt;0x000bb&gt;
  at (wrapper runtime-invoke) &lt;Module&gt;.runtime_invoke_int_object
(object,intptr,intptr,intptr) &lt;0xffffffff&gt;

Native stacktrace:

 /home/plastic/monosrc/mono/mono/mini/mono [0x485f16]
 /lib64/libpthread.so.0 [0x2b7b7e3c2a90]
 /lib64/libc.so.6(gsignal+0x35) [0x2b7b7e859645]
 /lib64/libc.so.6(abort+0x183) [0x2b7b7e85ac33]
 /usr/lib64/libglib-2.0.so.0(g_assertion_message+0x113) [0x2b7b7dd41203]
 /usr/lib64/libglib-2.0.so.0 [0x2b7b7dd416a2]
 /home/plastic/monosrc/mono/mono/mini/mono [0x5793f8]
 /home/plastic/monosrc/mono/mono/mini/mono(mono_array_new_specific+0x59)
[0x520449]
 [0x4164e75b]

Debug info from gdb:

[Thread debugging using libthread_db enabled]
[New Thread 0x2aaaab852950 (LWP 7297)]
[New Thread 0x2aaaab401950 (LWP 7296)]
0x00002b7b7e3c187b in read () from /lib64/libpthread.so.0
  3 Thread 0x2aaaab401950 (LWP 7296)  0x00002b7b7e3c21b1 in nanosleep ()
from /lib64/libpthread.so.0
  2 Thread 0x2aaaab852950 (LWP 7297)  0x00002b7b7e3c0c71 in sem_wait ()
from /lib64/libpthread.so.0
* 1 Thread 0x2b7b7edb10f0 (LWP 7283)  0x00002b7b7e3c187b in read () from
/lib64/libpthread.so.0

Thread 3 (Thread 0x2aaaab401950 (LWP 7296)):
#0  0x00002b7b7e3c21b1 in nanosleep () from /lib64/libpthread.so.0
#1  0x000000000058ce22 in collection_thread (unused=&lt;value optimized
out&gt;) at collection.c:34
#2  0x00002b7b7e3bb070 in start_thread () from /lib64/libpthread.so.0
#3  0x00002b7b7e8fa0ed in clone () from /lib64/libc.so.6
#4  0x0000000000000000 in ?? ()

Thread 2 (Thread 0x2aaaab852950 (LWP 7297)):
#0  0x00002b7b7e3c0c71 in sem_wait () from /lib64/libpthread.so.0
#1  0x0000000000507a4b in finalizer_thread (unused=&lt;value optimized
out&gt;) at gc.c:1014
#2  0x00000000004f6588 in start_wrapper (data=&lt;value optimized out&gt;) at
threads.c:657
#3  0x000000000057ff2b in thread_start_routine (args=0x8d1088) at
wthreads.c:286
#4  0x00000000005742a2 in gc_start_thread (arg=&lt;value optimized out&gt;) at
sgen-gc.c:5186
#5  0x00002b7b7e3bb070 in start_thread () from /lib64/libpthread.so.0
#6  0x00002b7b7e8fa0ed in clone () from /lib64/libc.so.6
#7  0x0000000000000000 in ?? ()

Thread 1 (Thread 0x2b7b7edb10f0 (LWP 7283)):
#0  0x00002b7b7e3c187b in read () from /lib64/libpthread.so.0
#1  0x0000000000486081 in mono_handle_native_sigsegv (signal=&lt;value
optimized out&gt;, ctx=&lt;value optimized out&gt;) at mini-exceptions.c:1560
#2  &lt;signal handler called&gt;
#3  0x00002b7b7e859645 in raise () from /lib64/libc.so.6
#4  0x00002b7b7e85ac33 in abort () from /lib64/libc.so.6
#5  0x00002b7b7dd41203 in g_assertion_message () from
/usr/lib64/libglib-2.0.so.0
#6  0x00002b7b7dd416a2 in g_assertion_message_expr () from
/usr/lib64/libglib-2.0.so.0
#7  0x00000000005793f8 in mono_gc_alloc_obj (vtable=0x2aaaac014ce8,
size=32) at sgen-gc.c:3491
#8  0x0000000000520449 in mono_array_new_specific
(vtable=0x2aaaac014ce8, n=0) at object.c:3782
#9  0x000000004164e75b in ?? ()
#10 0x00000000008b64b0 in ?? ()
#11 0x00002aaaac0ba8c0 in ?? ()
#12 0x0000000000000001 in ?? ()
#13 0x00000000000000a0 in ?? ()
#14 0x00002aaaab5870c0 in ?? ()
#15 0x00007fff2d1ea6b0 in ?? ()
#16 0x00007fff2d1ea5c0 in ?? ()
#17 0x00002aaaab5864a8 in ?? ()
#18 0x00002aaaabe5c5a0 in ?? ()
#19 0x00002aaaabe5b7a0 in ?? ()
#20 0x00002aaaab411cf8 in ?? ()
#21 0x00002aaaaae2d3db in System.Activator:CreateInstance
(type=@0x2aaaabe5b7a0, args=0x0) from
/home/plastic/monosrc/mcs/class/lib/net_1_1/mscorlib.dll.so
#22 0x00002aaaaaef5f98 in
System.Security.Cryptography.CryptoConfig:CreateFromName
(name=0x2aaaac014ce8, args=0x0)
   from /home/plastic/monosrc/mcs/class/lib/net_1_1/mscorlib.dll.so
#23 0x00002aaaaaef5e9f in
System.Security.Cryptography.CryptoConfig:CreateFromName
(name=0x2aaaab411cf8)
   from /home/plastic/monosrc/mcs/class/lib/net_1_1/mscorlib.dll.so
#24 0x00002aaaaaefa620 in
System.Security.Cryptography.HashAlgorithm:Create (hashName=0x0) from
/home/plastic/monosrc/mcs/class/lib/net_1_1/mscorlib.dll.so
#25 0x0000000040370f89 in ?? ()
#26 0x00002aaaab5870c0 in ?? ()
#27 0x00002aaaab5864a8 in ?? ()
#28 0x0000000000000003 in ?? ()
#29 0x00002aaaab586f88 in ?? ()
#30 0x0000000000000000 in ?? ()

=================================================================
Got a SIGABRT while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries
used by your application.
=================================================================

/bin/sh: line 1:  7283 Aborted
MONO_PATH=&quot;./../../class/lib/net_1_1:$MONO_PATH&quot;
/home/plastic/monosrc/mono/runtime/mono-wrapper
./../../class/lib/net_1_1/mcs.exe /codepage:65001 -optimize -d:NET_1_1
-d:ONLY_1_1 -debug /noconfig -d:XML_DEP -r:System.Xml.dll
-target:library -out:../../class/lib/net_1_1/tmp/System.dll
@System.dll.sources
make[8]: *** [../../class/lib/net_1_1/tmp/System.dll] Error 134
make[8]: Leaving directory `/home/plastic/monosrc/mcs/class/System'
make[7]: *** [do-all] Error 2
make[7]: Leaving directory `/home/plastic/monosrc/mcs/class/System'
make[6]: *** [all-recursive] Error 1
make[6]: Leaving directory `/home/plastic/monosrc/mcs/class'
make[5]: *** [all-recursive] Error 1
make[5]: Leaving directory `/home/plastic/monosrc/mcs'
make[4]: *** [profile-do--net_1_1--all] Error 2
make[4]: Leaving directory `/home/plastic/monosrc/mcs'
make[3]: *** [profiles-do--all] Error 2
make[3]: Leaving directory `/home/plastic/monosrc/mcs'
make[2]: *** [all-local] Error 2
make[2]: Leaving directory `/home/plastic/monosrc/mono/runtime'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/plastic/monosrc/mono'
make: *** [all] Error 2


<A HREF="http://lists.ximian.com/mailman/listinfo/mono-devel-list">pablosantosluac at terra.es</A> wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I've just downloaded the latest SVN. This is what I get when I try to build:
</I>&gt;<i> 
</I>&gt;<i> MCS     [net_1_1] Mono.CompilerServices.SymbolWriter.dll
</I>&gt;<i> Assembly
</I>&gt;<i> ../../class/lib/net_1_1/tmp/Mono.CompilerServices.SymbolWriter.dll signed.
</I>&gt;<i> Assembly ../../class/lib/net_1_1/Mono.CompilerServices.SymbolWriter.dll
</I>&gt;<i> is strongnamed.
</I>&gt;<i> make[8]: Leaving directory
</I>&gt;<i> `/home/plastic/monosrc/mcs/class/Mono.CompilerServices.SymbolWriter'
</I>&gt;<i> make[7]: Leaving directory
</I>&gt;<i> `/home/plastic/monosrc/mcs/class/Mono.CompilerServices.SymbolWriter'
</I>&gt;<i> make[7]: Entering directory `/home/plastic/monosrc/mcs/class/Mono.Posix'
</I>&gt;<i> Creating ../../build/deps/net_1_1_Mono.Posix.dll.makefrag ...
</I>&gt;<i> Creating ../../build/deps/Mono.Posix_test_net_1_1.dll.response ...
</I>&gt;<i> Creating ../../build/deps/Mono.Posix_test_net_1_1.dll.makefrag ...
</I>&gt;<i> make[7]: Leaving directory `/home/plastic/monosrc/mcs/class/Mono.Posix'
</I>&gt;<i> make[7]: Entering directory `/home/plastic/monosrc/mcs/class/Mono.Posix'
</I>&gt;<i> make all-local
</I>&gt;<i> make[8]: Entering directory `/home/plastic/monosrc/mcs/class/Mono.Posix'
</I>&gt;<i> MCS     [net_1_1] Mono.Posix.dll
</I>&gt;<i> Stacktrace:
</I>&gt;<i> 
</I>&gt;<i> /bin/sh: line 1: 29810 Segmentation fault     
</I>&gt;<i> MONO_PATH=&quot;./../../class/lib/net_1_1:$MONO_PATH&quot;
</I>&gt;<i> /home/plastic/monosrc/mono/runtime/mono-wrapper
</I>&gt;<i> ./../../class/lib/net_1_1/mcs.exe /codepage:65001 -optimize -d:NET_1_1
</I>&gt;<i> -d:ONLY_1_1 -debug /noconfig /unsafe /r:mscorlib.dll /r:System.dll
</I>&gt;<i> /nowarn:0618,612 -target:library
</I>&gt;<i> -out:../../class/lib/net_1_1/Mono.Posix.dll @Mono.Posix.dll.sources
</I>&gt;<i> make[8]: *** [../../class/lib/net_1_1/Mono.Posix.dll] Error 139
</I>&gt;<i> make[8]: Leaving directory `/home/plastic/monosrc/mcs/class/Mono.Posix'
</I>&gt;<i> make[7]: *** [do-all] Error 2
</I>&gt;<i> make[7]: Leaving directory `/home/plastic/monosrc/mcs/class/Mono.Posix'
</I>&gt;<i> make[6]: *** [all-recursive] Error 1
</I>&gt;<i> make[6]: Leaving directory `/home/plastic/monosrc/mcs/class'
</I>&gt;<i> make[5]: *** [all-recursive] Error 1
</I>&gt;<i> make[5]: Leaving directory `/home/plastic/monosrc/mcs'
</I>&gt;<i> make[4]: *** [profile-do--net_1_1--all] Error 2
</I>&gt;<i> make[4]: Leaving directory `/home/plastic/monosrc/mcs'
</I>&gt;<i> make[3]: *** [profiles-do--all] Error 2
</I>&gt;<i> make[3]: Leaving directory `/home/plastic/monosrc/mcs'
</I>&gt;<i> make[2]: *** [all-local] Error 2
</I>&gt;<i> make[2]: Leaving directory `/home/plastic/monosrc/mono/runtime'
</I>&gt;<i> make[1]: *** [all-recursive] Error 1
</I>&gt;<i> make[1]: Leaving directory `/home/plastic/monosrc/mono'
</I>&gt;<i> make: *** [all] Error 2
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Miguel de Icaza wrote:
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i> Is is possible to try the upcoming compacting GC? Is it in a status
</I>&gt;&gt;&gt;<i> close to be usable?
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You can try it, but it is not finished.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Compile Mono with:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 	./configure --with-gc=sgen
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Miguel
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033001.html">[Mono-dev] Compacting GC
</A></li>
	<LI>Next message: <A HREF="033003.html">[Mono-dev] Compacting GC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33002">[ date ]</a>
              <a href="thread.html#33002">[ thread ]</a>
              <a href="subject.html#33002">[ subject ]</a>
              <a href="author.html#33002">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-devel-list">More information about the Mono-devel-list
mailing list</a><br>
</body></html>
