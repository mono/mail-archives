<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] First go at unit tests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20First%20go%20at%20unit%20tests&In-Reply-To=1133616349.6174.37.camel%40portatil.aticatac">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002820.html">
   <LINK REL="Next"  HREF="002832.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] First go at unit tests</H1>
    <B>Jacob Ils&#248; Christensen</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20First%20go%20at%20unit%20tests&In-Reply-To=1133616349.6174.37.camel%40portatil.aticatac"
       TITLE="[MonoDevelop] First go at unit tests">jacobilsoe at gmail.com
       </A><BR>
    <I>Sat Dec  3 08:58:41 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002820.html">[MonoDevelop] First go at unit tests
</A></li>
        <LI>Next message: <A HREF="002832.html">[MonoDevelop] First go at unit tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2821">[ date ]</a>
              <a href="thread.html#2821">[ thread ]</a>
              <a href="subject.html#2821">[ subject ]</a>
              <a href="author.html#2821">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/3/05, Lluis Sanchez &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at ximian.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; On 12/2/05, Lluis Sanchez &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at ximian.com</A>&gt; wrote:
</I>&gt;<i> &gt;         Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &gt; Ok, I tried testing the SourceViewTextIterator class in
</I>&gt;<i> &gt;         &gt; SourceEditorDisplayBinding.cs. The class is private and this
</I>&gt;<i> &gt;         turned
</I>&gt;<i> &gt;         &gt; out to be quite problematic. I had to start up a lot of MD
</I>&gt;<i> &gt;         &gt; infrastructure in the test to even get this class
</I>&gt;<i> &gt;         instantiated. This
</I>&gt;<i> &gt;         &gt; is a bad smell IMO.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         That was expected.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Well, for this particular class maybe it was. But I am sure it is easy
</I>&gt;<i> &gt; to unit test a lot of other code this way.
</I>&gt;<i>
</I>&gt;<i> Core assemblies which are not related to the IDE can be probably tested
</I>&gt;<i> in this way. There may also be other classes in MonoDevelop.Ide that can
</I>&gt;<i> be easily tested. But in general most of classes rely on a properly
</I>&gt;<i> initalized infrastructure, and you'll find the same problems with those.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &gt;
</I>&gt;<i> &gt;         &gt; I do not think it is feasible to do it this way. So how do I
</I>&gt;<i> &gt;         go about
</I>&gt;<i> &gt;         &gt; testing this class? I see a couple of options:
</I>&gt;<i> &gt;         &gt;
</I>&gt;<i> &gt;         &gt; * Put the test in the class.
</I>&gt;<i>
</I>&gt;<i> First of all, I don't like the idea of fatting up the assemblies with
</I>&gt;<i> code that is not needed at runtime. Although yes, you can use
</I>&gt;<i> conditional compilation for this.
</I>&gt;<i>
</I>&gt;<i> But the main reason is that it won't help in building up a test
</I>&gt;<i> framework for Monodevelop. Your test would only be testing a particular
</I>&gt;<i> implementation of the search engine, not the *MonoDevelop* search
</I>&gt;<i> engine. If that is what you want to do, ok, but I don't think it is the
</I>&gt;<i> correct path.
</I>

That is actually what I wanted to do. Test a particular implementation with
a unit test.
And we then know that *MonoDevelop* search works if all the particular
implementations are tested individually.

If we next month decide to drop the GtkSourceView based editor and
&gt;<i> implement our own manged editor, all those tests will be useless, and
</I>&gt;<i> we'll have nothing to ensure that the new editor does the search in the
</I>&gt;<i> same way as the old did, and that there are not regressions.
</I>

 It is true that they will be useless but that argument goes for all code
that is thrown away.
But as long as we use the GtkSourceView based editor they will not be
useless.

&gt;<i>         &gt; * Make the class public.
</I>&gt;<i>
</I>&gt;<i> Making a class public is a very serious decision. You are adding the
</I>&gt;<i> class to the public API, which means that users of that library may use
</I>&gt;<i> that class, so you can't change it without breaking the binary
</I>&gt;<i> compatiblity.
</I>&gt;<i>
</I>&gt;<i> So, if you make public an internal implementation class, it means that
</I>&gt;<i> changing the internal implementation might break assembly compatibility.
</I>&gt;<i> And that's really bad.
</I>

I agree, it is also the option I like the least.

&gt;<i>         &gt; * Move the class somewhere else.
</I>&gt;<i>
</I>&gt;<i> I don't see how this can help. If you move the class to another assembly
</I>&gt;<i> you'll have to make it public so the original assembly can use it, and
</I>&gt;<i> you'll have yet another assembly dependency.
</I>

The reason I added this option was that I did not think the search algorithm
belonged in a GUI class.
So moving it to another class that was not so bound to the GUI might make it
easier to test.

&gt;<i>
</I>&gt;<i> &gt;         None of those options are acceptable.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Could you elaborate on that, please?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &gt;
</I>&gt;<i> &gt;         &gt; It ought not be so hard to unit test a search algorithm.
</I>&gt;<i> &gt;         Maybe the
</I>&gt;<i> &gt;         &gt; algorithm should be moved somewhere else?
</I>&gt;<i> &gt;         &gt;
</I>&gt;<i> &gt;         &gt; Any good ideas out there? :-)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         I think that the best solution would be to implement a Tester
</I>&gt;<i> &gt;         add-in,
</I>&gt;<i> &gt;         which once loaded in MD would use the public API to test
</I>&gt;<i> &gt;         whatever needs
</I>&gt;<i> &gt;         to be tested.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         You would not directly test the SourceViewTextIterator class,
</I>&gt;<i> &gt;         but
</I>&gt;<i> &gt;         instead you would use the MonoDevelop.Ide.Gui.Search api,
</I>&gt;<i> &gt;         which
</I>&gt;<i> &gt;         internaly relies on that class.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I am not very fond of this approach. First of all I would like to run
</I>&gt;<i> &gt; by tests as part of the build process. I would not like to have to
</I>&gt;<i> &gt; start MonoDevelop to be able to run my unit tests.
</I>&gt;<i>
</I>&gt;<i> I already said it many times, but here is it again: many of the
</I>&gt;<i> MonoDevelop classes won't work without a properly initialized
</I>&gt;<i> MonoDevelop runtime. So you must 'start' MonoDevelop to unit test them.
</I>&gt;<i> It doesn't mean that you have to do it manually, and I don't see the
</I>&gt;<i> reason why it could not be part of the build.
</I>

Ok, so if I made some Test AddIn, I would like something like make test to
do something like this:

1. Build the test AddIn and copy it to the AddIn directory.
2. Launch MonoDevelop.
3. Execute the code in the Test AddIn.
4. Quit MonoDevelop.

Is this possible to do automatically? I am thinking of step 3.

&gt;<i>  Secondly it might be hard to test the internals of a class using only
</I>&gt;<i> &gt; some public API.
</I>&gt;<i>
</I>&gt;<i> Mono has around 13000 unit tests, all of them using exclusively public
</I>&gt;<i> API, so it's not so hard...
</I>

Nope, it's not hard, we just need to find the right way to do it. :-)

&gt;<i>
</I>&gt;<i> &gt; /Jacob
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         Lluis.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodevelop-list mailing list
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">Monodevelop-list at lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">http://lists.ximian.com/mailman/listinfo/monodevelop-list</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monodevelop-list/attachments/20051203/beae959b/attachment-0001.html">http://lists.ximian.com/pipermail/monodevelop-list/attachments/20051203/beae959b/attachment-0001.html</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002820.html">[MonoDevelop] First go at unit tests
</A></li>
	<LI>Next message: <A HREF="002832.html">[MonoDevelop] First go at unit tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2821">[ date ]</a>
              <a href="thread.html#2821">[ thread ]</a>
              <a href="subject.html#2821">[ subject ]</a>
              <a href="author.html#2821">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
