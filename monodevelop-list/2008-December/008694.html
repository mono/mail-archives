<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] XML Entity Completion Patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20XML%20Entity%20Completion%20Patch&In-Reply-To=1229271202.6915.60.camel%40europa">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008693.html">
   <LINK REL="Next"  HREF="008695.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] XML Entity Completion Patch</H1>
    <B>Michael Hutchinson</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20XML%20Entity%20Completion%20Patch&In-Reply-To=1229271202.6915.60.camel%40europa"
       TITLE="[MonoDevelop] XML Entity Completion Patch">m.j.hutchinson at gmail.com
       </A><BR>
    <I>Sun Dec 14 19:18:18 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008693.html">[MonoDevelop] XML Entity Completion Patch
</A></li>
        <LI>Next message: <A HREF="008695.html">[MonoDevelop] Trouble with type conversions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8694">[ date ]</a>
              <a href="thread.html#8694">[ thread ]</a>
              <a href="subject.html#8694">[ subject ]</a>
              <a href="author.html#8694">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Dec 14, 2008 at 11:13 AM, David A Knight
&lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">david at ritter.demon.co.uk</A>&gt; wrote:
&gt;<i> The attached patch is a first shot at implementing auto completion of
</I>&gt;<i> entities in xml documents.
</I>
Thanks for looking at this! I've been wondering about strategies for
entity completion for a while, but never got around to hacking on
it...

FWIW, I'd call your approach &quot;autoconversion&quot; rather than &quot;completion&quot;.

&gt;<i> 1) Typing &quot;&amp;&quot; will result in &quot;&amp;;&quot; being inserted and the cursor being
</I>&gt;<i> placed between the two chars.
</I>
Why insert the semicolon? This means the user has to use the cursor
keys to get past it.

There are 2 possible solutions for this:
a) if the user types a semicolon before an entity's semicolon,
interpret this as a move rightwards. This way it doesn't affect typing
flow.
b) only insert the semicolon when autocompleting the contents of the entity

&gt;<i> 2) If the cursor is between &quot;&amp;;&quot; and the pressed key isn't a control
</I>&gt;<i> character, or a &quot;#&quot; then the entity will be expanded automatically, e.g.
</I>&gt;<i> typing &#8364; will result in the text becoming &quot;&amp;#8364;&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The default setting is for this to be turned off.
</I>
With some tweaks, I think it could be on by default.

For example, user types &quot;&amp;&quot; then &quot;&lt;&quot;. MD replaces the &quot;&lt;&quot; with &quot;lt;&quot;
and moves the cursor after the semicolon. Since &amp;&lt; isn't a valid thing
to have in XML, this won't interfere with valid typing.

&gt;<i> To be more robust it probably should be checking if it is in a CDATA
</I>&gt;<i> section or &lt;% %&gt; etc.
</I>
Definitely, and this will be much easier when the XML editor is ported
to the new BaseXmlEditorExtension that the HTML, ASP.NET completion
extensions subclass. They maintain a &quot;context engine&quot; that can tell
you what context you're in, so you'd just handle entity completion
when in the &quot;free&quot; or attributevalue&quot; contexts. Right now, your patch
doesn't do anything for the editors that use the newer system anyway.

This port is on my queue for 2.2, unless you want to do it before then :)

&gt;<i> There is a downside with html documents.  If you want to type &amp;quot; for
</I>&gt;<i> example you will end up with &amp;#113; if q is typed.  A possible solution
</I>&gt;<i> for this would be to only do the auto insertion if the character value
</I>&gt;<i> is &gt; 127 or if it is a special char, &lt;,&gt;,&quot;,', &amp;
</I>
I think that's a must. Completion should never interfere with normal typing.

It would also be nice to have a completion list for named entities
from external DTDs.

&gt;<i> There is no auto mapping to the standard xml named entities, e.g. &lt;
</I>&gt;<i> doesn't become &amp;lt; etc.
</I>
I imagine that's not hard to special-case for the common ones. Using
entities from DTDs probably isn't worth the effort at this point.
Since the common ones are... common... I think it's important that
the're supported in the first pass.

Another possible activation for entity completion would be to convert
invalid characters directly into entities automatically. This would be
very convenient for the characters that have no valid use, but
wouldn't work for things like ampersands, so we'd still need to
implement the other kinds of completion/conversion.

-- 
Michael Hutchinson
<A HREF="http://mjhutchinson.com">http://mjhutchinson.com</A>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008693.html">[MonoDevelop] XML Entity Completion Patch
</A></li>
	<LI>Next message: <A HREF="008695.html">[MonoDevelop] Trouble with type conversions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8694">[ date ]</a>
              <a href="thread.html#8694">[ thread ]</a>
              <a href="subject.html#8694">[ subject ]</a>
              <a href="author.html#8694">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
