<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] Patch allowing support for MonoXNA addin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Patch%20allowing%20support%20for%20MonoXNA%20addin&In-Reply-To=9027496d1001240848q7d9aa8epbd66ab783e574623%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011173.html">
   <LINK REL="Next"  HREF="011175.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] Patch allowing support for MonoXNA addin</H1>
    <B>Lluis Sanchez Gual</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Patch%20allowing%20support%20for%20MonoXNA%20addin&In-Reply-To=9027496d1001240848q7d9aa8epbd66ab783e574623%40mail.gmail.com"
       TITLE="[MonoDevelop] Patch allowing support for MonoXNA addin">slluis.devel at gmail.com
       </A><BR>
    <I>Mon Jan 25 11:47:02 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="011173.html">[MonoDevelop] Patch allowing support for MonoXNA addin
</A></li>
        <LI>Next message: <A HREF="011175.html">[MonoDevelop] Patch allowing support for MonoXNA addin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11174">[ date ]</a>
              <a href="thread.html#11174">[ thread ]</a>
              <a href="subject.html#11174">[ subject ]</a>
              <a href="author.html#11174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>El dg 24 de 01 de 2010 a les 17:48 +0100, en/na Lars Magnusson va
escriure:
&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> This patch has been written as a result of many hours of frustration
</I>&gt;<i> trying to achieve the functionality needed to develop a MonoXNA addin
</I>&gt;<i> for MD. I've made a post here in the mailing list
</I>&gt;<i> (<A HREF="http://lists.ximian.com/pipermail/monodevelop-list/2010-January/011008.html">http://lists.ximian.com/pipermail/monodevelop-list/2010-January/011008.html</A>)
</I>
I was on holidays when you sent this mail and I somehow forgot about it,
sorry.

&gt;<i> and bothered lluis numerous times on the irc channel. But I decided
</I>&gt;<i> not to wait for help anymore and make some changes to MD myself. These
</I>&gt;<i> changes makes the development of a MonoXNA possible (or at least much
</I>&gt;<i> easier)
</I>&gt;<i> 
</I>&gt;<i> Most of the changes is in the MonoDevelop.Projects assembly, but some
</I>&gt;<i> changes have also been made in MonoDevelop.Ide. The changes have been
</I>&gt;<i> described in the Changelog entries, but common for all of them is that
</I>&gt;<i> they should not change the current behavior of MD, it should only add
</I>&gt;<i> additional flexibility)
</I>
The changes in MonoDevelop.Projects.Formats.MSBuild are mostly ok, but
there is a major issue. In MD there are several DotNetProjectNode nodes,
one for each supported .net language (c#, vb.net, boo, etc). Each
DotNetProjectNode defines an extension (csproj, vbproj, booproj...).
When loading a project, the extension of the file is used to match files
to DotNetProjectNode instances. The problem with nested project is that
they always use the extension contentproj, so the file extension can't
be used anymore to find the corresponding DotNetProjectNode. Your
implementation of DotNetProjectNode.CanHandleFile is not correct because
it is going to match any DotNetProjectNode it finds, no matter what's
the language of the project.

To properly find the language, some additional work is required. msbuild
files contain the project type guid in the ProjectTypeGuids property. So
when no direct match of extension is found, MD could try to read that
guid from the file, and use it to find a matching DotNetProjectNode.

The changes in MD.Projects don't look good to me. You say that they
should not change the current behavior of MD, but that's not really
true. Introducing a new Visible property means that all code in MD that
iterates through solution items has to deal with that property, ignoring
the item when visible=false. You patched a couple of files, but there
are many other files that would need to be patched. So this is actually
an important change in behavior.

I think there is a less intrusive solution. I added a new protected
method to SolutionItem: RegisterInternalChild (item). With this method
you can register a nested solution item, and events like file add/remove
should flow up to the workspace, yet this child won't be included in any
items collection in the solution. I haven't really tested it, so tell me
if you find any issue with it.

Lluis.


</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011173.html">[MonoDevelop] Patch allowing support for MonoXNA addin
</A></li>
	<LI>Next message: <A HREF="011175.html">[MonoDevelop] Patch allowing support for MonoXNA addin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11174">[ date ]</a>
              <a href="thread.html#11174">[ thread ]</a>
              <a href="subject.html#11174">[ subject ]</a>
              <a href="author.html#11174">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
