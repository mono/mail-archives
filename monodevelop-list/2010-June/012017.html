<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] Loading unmanaged shared library
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Loading%20unmanaged%20shared%20library&In-Reply-To=380-2201066502229117%40M2W111.mail2web.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012014.html">
   <LINK REL="Next"  HREF="012024.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] Loading unmanaged shared library</H1>
    <B>karen</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Loading%20unmanaged%20shared%20library&In-Reply-To=380-2201066502229117%40M2W111.mail2web.com"
       TITLE="[MonoDevelop] Loading unmanaged shared library">karen at desertdakini.com
       </A><BR>
    <I>Sat Jun  5 01:55:58 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="012014.html">[MonoDevelop] Loading unmanaged shared library
</A></li>
        <LI>Next message: <A HREF="012024.html">[MonoDevelop] Loading unmanaged shared library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12017">[ date ]</a>
              <a href="thread.html#12017">[ thread ]</a>
              <a href="subject.html#12017">[ subject ]</a>
              <a href="author.html#12017">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I'll try to be more specific. ;)

The shared library on Linux, is a derived from a Windows DLL. Apparently the 
Linux version was (that I can gleam from the release notes) written in C, 
compiled on Linux on GCC 3.3.1. I have real little information on its 
construction, aside from that, the header files, and the documentation for 
the APIs. Calling method is still specified as WINAPI (i.e., stdcall).

It in turn provides an API to access a USB driver. I have it installed, as I 
said in /usr/local/lib, also /usr/lib. I have no trouble accessing it using 
natively compiled C code. The problem is in it being located by my managed 
wrapper, written in C# and compiled with the MonoDevelop compiler. Written 
originally on Windows, .Net 3.5, where it runs fine. The problem is in 
porting it to Linux, with Mono 2.6.

Functions are declared as:

[DllImport(&quot;FTD2XX.dll&quot;)]
static extern FT_STATUS FT_Open(UInt32 uiPort, ref FT_HANDLE ftHandle);

Following <A HREF="http://www.mono-project.com/Interop_with_Native_Libraries,">http://www.mono-project.com/Interop_with_Native_Libraries,</A> I 
created a .config file (in the same directory as the wrappers assembly to 
map the original DLL name to the Linux library name:

&lt;configuration&gt;
    &lt;dllmap dll=&quot;FTD2XX.dll&quot; target=&quot;libftd2xx.so&quot; /&gt;
&lt;/configuration&gt;

With no avail. I tried with the full version library name as well, 
libftd2xx.so.0.4.16.

I also rewrote the function declarations to explicitly reference the Linux 
specific library name. In each case the result is the same, 
DllNotFoundException is thrown. In the attempt with the .config file 
approach, the error message indicates FTD2XX.dll is not found; with the 
revised function declarations, the error message indicates libftd2xx.so is 
not found.

Some dots are not being connected. Perhaps some suggestions? What else needs 
be done to allow it to access the Linux version of the library?

Thank you...

----- Original Message ----- 
From: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">dbj at dbj.org</A>&gt;
To: &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">karen at desertdakini.com</A>&gt;
Sent: Friday, June 04, 2010 6:22 PM
Subject: RE: [MonoDevelop] Loading unmanaged shared library



 How is this &quot;Linux flavoured&quot; &quot;DLL&quot; (?) developed ?
 Which compiler, language, etc ...

DBJ

Original Message:
-----------------
From: karen <A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">karen at desertdakini.com</A>
Date: Fri, 4 Jun 2010 16:37:30 -0600
To: <A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">monodevelop-list at lists.ximian.com</A>
Subject: [MonoDevelop] Loading unmanaged shared library


Hi,

Maybe some insight will arise from the collective here. I'm fairly new to
this (especially with Linux, as I have most exclusively developed for
Windows alone), and have often relied on the &quot;smarter guy down the hall...&quot;
as it were anyway. ;)

I have an unmanaged shared library, both in Windows and Linux flavors, and
am developing managed libraries for an application to run on both platforms
(possibly also on OSX 10 down the road, but that bridge will be crossed in
due course...). I am currently testing a CLI wrapper for the shared
library. On Windows with .NET 3.5, there is no problem, of course. Works as
designed (its a pretty thin wrapper). The plan is to then port it to Linux
using Mono.

I am testing it on Linux, using the OpenSUSE/Mono virtual machine. On Linux
the wrapper is unable to load the shared library. I've tried it with the
dll mapping through a .config file, as the interoperability documentation
on the Mono site describes, and have also built a Linux version of the
wrapper with the platform specific naming in the DLLIMPORTs, both with and
without the complete versioning.

The Linux version of the shared library is in /usr/local/lib, and also
/usr/lib. Should there be a different location for Mono to make the
connection? Other suggestions?

Thanks in advance ;)

karen

--------------------------------------------------------------------
mail2web.com - What can On Demand Business Solutions do for you?
<A HREF="http://link.mail2web.com/Business/SharePoint">http://link.mail2web.com/Business/SharePoint</A>


</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012014.html">[MonoDevelop] Loading unmanaged shared library
</A></li>
	<LI>Next message: <A HREF="012024.html">[MonoDevelop] Loading unmanaged shared library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12017">[ date ]</a>
              <a href="thread.html#12017">[ thread ]</a>
              <a href="subject.html#12017">[ subject ]</a>
              <a href="author.html#12017">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
