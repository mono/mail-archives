<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] RefactoringCommands: Encapsulate Fields initial	implementation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20RefactoringCommands%3A%20Encapsulate%20Fields%20initial%0A%09implementation&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005851.html">
   <LINK REL="Next"  HREF="005855.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] RefactoringCommands: Encapsulate Fields initial	implementation</H1>
    <B>Miguel &#193;ngel P&#233;rez</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20RefactoringCommands%3A%20Encapsulate%20Fields%20initial%0A%09implementation&In-Reply-To="
       TITLE="[MonoDevelop] RefactoringCommands: Encapsulate Fields initial	implementation">mangelp at gmail.com
       </A><BR>
    <I>Tue Apr 24 07:40:54 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="005851.html">[MonoDevelop] Local copy reference
</A></li>
        <LI>Next message: <A HREF="005855.html">[MonoDevelop] RefactoringCommands: Encapsulate Fields initial	implementation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5854">[ date ]</a>
              <a href="thread.html#5854">[ thread ]</a>
              <a href="subject.html#5854">[ subject ]</a>
              <a href="author.html#5854">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all!

I have been doing some coding with the encapsulate field command and i have
got an initial implementation that generates the code for the property and
changes the visibility for the field if its public or protected to private.

To do the code generation I've created an internal helper class named
CodeGeneratorHelper in the class CodeRefactorer (
Monodevelop.Ide.Projects.CodeGeneration namespace) that implements it.
I don't know if there is already some class that can generate CodeDom
namespace objects from an IMember so i have implemented something.

What i haven't done is renaming the references to the property, since is a
thing that Lluis must know better than nobody, can you suggest how it could
be done?

I've also done some changes to BaseRefactorer class to allow a parameter
with the buffer to modify so the change is done to the editor buffer instead
of the file in disk. This makes necessary to call the methods with an
unboxing instead of using the interface IRefactorer.
It's look like this class could be improved with changes like this that
helps in the operations needed to implement more refactoring commands.

I also did a change to avoid a null exception that i was getting when
creating a new property because a BodyRegion property was null.

Attached is the diff against svn 76173. file with my initial implementation.
Please Lluis and everyone review and comment about it.

-- Best regards --
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.ximian.com/pipermail/monodevelop-list/attachments/20070424/0486219d/attachment-0001.html">http://lists.ximian.com/pipermail/monodevelop-list/attachments/20070424/0486219d/attachment-0001.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: RefactorCommands-EncapsulateFields-initial.diff
Type: text/x-patch
Size: 21980 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/monodevelop-list/attachments/20070424/0486219d/attachment-0001.bin">http://lists.ximian.com/pipermail/monodevelop-list/attachments/20070424/0486219d/attachment-0001.bin</A> 
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005851.html">[MonoDevelop] Local copy reference
</A></li>
	<LI>Next message: <A HREF="005855.html">[MonoDevelop] RefactoringCommands: Encapsulate Fields initial	implementation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5854">[ date ]</a>
              <a href="thread.html#5854">[ thread ]</a>
              <a href="subject.html#5854">[ subject ]</a>
              <a href="author.html#5854">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
