<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] PATCH: Enable filering in open dialog
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20PATCH%3A%20Enable%20filering%20in%20open%20dialog&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003406.html">
   <LINK REL="Next"  HREF="003408.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] PATCH: Enable filering in open dialog</H1>
    <B>&quot;David Makovsk&#253; (Yakeen)&quot;</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20PATCH%3A%20Enable%20filering%20in%20open%20dialog&In-Reply-To="
       TITLE="[MonoDevelop] PATCH: Enable filering in open dialog">yakeen at sannyas-on.net
       </A><BR>
    <I>Thu Mar 16 04:15:13 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="003406.html">[MonoDevelop] Bug 77604
</A></li>
        <LI>Next message: <A HREF="003408.html">[MonoDevelop] PATCH: Enable filering in open dialog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3407">[ date ]</a>
              <a href="thread.html#3407">[ thread ]</a>
              <a href="subject.html#3407">[ subject ]</a>
              <a href="author.html#3407">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

can someone look at it? Any suggestions?
Does someone have idea how to add other types like HTML which has not
Language Binding?
Or should be code files be grouped?

Regards,
David

-------------- next part --------------
Index: Core/src/MonoDevelop.Projects/MonoDevelop.Projects/ILanguageBinding.cs
===================================================================
--- Core/src/MonoDevelop.Projects/MonoDevelop.Projects/ILanguageBinding.cs	(revision 57975)
+++ Core/src/MonoDevelop.Projects/MonoDevelop.Projects/ILanguageBinding.cs	(working copy)
@@ -23,6 +23,11 @@
 		/// The language for this language binding.
 		/// &lt;/returns&gt;
 		string Language { get; }
+
+		/// &lt;returns&gt;
+		/// Supported MIME Types by this language binding.
+		/// &lt;/returns&gt;
+		string[] MimeTypes { get; }
 		
 		/// &lt;summary&gt;
 		/// Used by Comment and Uncomment operations and by Centaurus Addin.
Index: Core/src/MonoDevelop.Projects/ChangeLog
===================================================================
--- Core/src/MonoDevelop.Projects/ChangeLog	(revision 57975)
+++ Core/src/MonoDevelop.Projects/ChangeLog	(working copy)
@@ -1,3 +1,7 @@
+2006-03-16 David Makovsk&#253; (Yakeen) &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">yakeen at sannyas-on.net</A>&gt;
+
+	* MonoDevelop.Projects/ILanguageBinding.cs: Added MimeTypes property to interface
+
 2006-03-08 Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at novell.com</A>&gt;
 
 	* MonoDevelop.Projects.Text/TextFile.cs: Some small improvements.
Index: Core/src/MonoDevelop.Ide/MonoDevelop.Ide.Commands/FileCommands.cs
===================================================================
--- Core/src/MonoDevelop.Ide/MonoDevelop.Ide.Commands/FileCommands.cs	(revision 57975)
+++ Core/src/MonoDevelop.Ide/MonoDevelop.Ide.Commands/FileCommands.cs	(working copy)
@@ -84,37 +84,35 @@
 	{
 		protected override void Run()
 		{
-			//string[] fileFilters  = (string[])(AddInTreeSingleton.AddInTree.GetTreeNode(&quot;/SharpDevelop/Workbench/FileFilter&quot;).BuildChildItems(this)).ToArray(typeof(string));
-			//bool foundFilter      = false;
-			// search filter like in the current selected project
-			/*
-			IProjectService projectService = (IProjectService)MonoDevelop.Core.ServiceManager.GetService(typeof(IProjectService));
-			
-			if (projectService.CurrentSelectedProject != null) {
-				LanguageBindingService languageBindingService = (LanguageBindingService)MonoDevelop.Core.ServiceManager.GetService(typeof(LanguageBindingService));
+			using (FileSelector fs = new FileSelector (GettextCatalog.GetString (&quot;File to Open&quot;))) {
 				
-				LanguageBindingCodon languageCodon = languageBindingService.GetCodonPerLanguageName(projectService.CurrentSelectedProject.ProjectType);
-				for (int i = 0; !foundFilter &amp;&amp; i &lt; fileFilters.Length; ++i) {
-					for (int j = 0; !foundFilter &amp;&amp; j &lt; languageCodon.Supportedextensions.Length; ++j) {
-						if (fileFilters[i].IndexOf(languageCodon.Supportedextensions[j]) &gt;= 0) {
-							break;
-						}
-					}
+				// Soluton/Project Files Filter
+				Gtk.FileFilter projectsFilter = new Gtk.FileFilter ();
+				projectsFilter.Name = GettextCatalog.GetString (&quot;Solution/Project Files&quot;);
+				projectsFilter.AddPattern (&quot;*.mds&quot;);
+				projectsFilter.AddPattern (&quot;*.mdp&quot;);
+				fs.AddFilter (projectsFilter);
+				
+				// Supported Language Files
+				LanguageBindingService languageBindingService = (LanguageBindingService)MonoDevelop.Core.ServiceManager.GetService (typeof (LanguageBindingService));
+				ILanguageBinding[] languageBindings = languageBindingService.GetLanguageBindings ();
+				foreach (ILanguageBinding lb in languageBindings)
+				{
+					Gtk.FileFilter filter = new Gtk.FileFilter ();
+					filter.Name = String.Format (GettextCatalog.GetString (&quot;{0} Files&quot;), lb.Language);
+					filter.AddPattern (lb.GetFileName (&quot;*&quot;));
+					foreach (string mimeType in lb.MimeTypes)
+						filter.AddMimeType (mimeType);
+					fs.AddFilter (filter);
 				}
-			}
-			
-			// search filter like in the current open file
-			if (!foundFilter) {
-				IWorkbenchWindow window = WorkbenchSingleton.Workbench.ActiveWorkbenchWindow;
-				if (window != null) {
-					for (int i = 0; i &lt; fileFilters.Length; ++i) {
-						if (fileFilters[i].IndexOf(Path.GetExtension(window.ViewContent.ContentName == null ? window.ViewContent.UntitledName : window.ViewContent.ContentName)) &gt;= 0) {
-							break;
-						}
-					}
-				}
-			}*/
-			using (FileSelector fs = new FileSelector (GettextCatalog.GetString (&quot;File to Open&quot;))) {
+
+				// Show All Files
+				Gtk.FileFilter allFilter = new Gtk.FileFilter ();
+				allFilter.Name = GettextCatalog.GetString (&quot;All Files&quot;);
+				allFilter.AddPattern (&quot;*&quot;);
+				fs.AddFilter (allFilter);
+
+
 				int response = fs.Run ();
 				string name = fs.Filename;
 				fs.Hide ();
Index: Core/src/MonoDevelop.Ide/ChangeLog
===================================================================
--- Core/src/MonoDevelop.Ide/ChangeLog	(revision 57975)
+++ Core/src/MonoDevelop.Ide/ChangeLog	(working copy)
@@ -1,3 +1,7 @@
+2006-03-16 David Makovsk&#253; (Yakeen) &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">yakeen at sannyas-on.net</A>&gt;
+
+	* MonoDevelop.Ide.Commands/FileCommands.cs: Added filtering to Open dialog.
+
 2006-03-14 Michael Hutchinson  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">m.j.hutchinson at gmail.com</A>&gt;
 
 	* MonoDevelop.Ide.Gui.Dialogs/IncludeFilesDialog.cs:
Index: Extras/ILAsmBinding/ChangeLog
===================================================================
--- Extras/ILAsmBinding/ChangeLog	(revision 57975)
+++ Extras/ILAsmBinding/ChangeLog	(working copy)
@@ -1,3 +1,7 @@
+2006-03-16 David Makovsk&#253; (Yakeen) &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">yakeen at sannyas-on.net</A>&gt;
+
+	* ILAsmLanguageBinding.cs: Track changes in ILanguageBinding.
+
 2005-12-13  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at novell.com</A>&gt; 
 
 	* ILAsmLanguageBinding.cs: Implemented the new methods in
Index: Extras/ILAsmBinding/ILAsmLanguageBinding.cs
===================================================================
--- Extras/ILAsmBinding/ILAsmLanguageBinding.cs	(revision 57975)
+++ Extras/ILAsmBinding/ILAsmLanguageBinding.cs	(working copy)
@@ -26,6 +26,7 @@
 	public class ILAsmLanguageBinding : IDotNetLanguageBinding
 	{
 		public const string LanguageName = &quot;ILAsm&quot;;
+		private static readonly string[] mimeTypes = { &quot;text/x-msil&quot; };
 		
 		ILAsmCompilerManager  compilerManager  = new ILAsmCompilerManager();
 		
@@ -34,6 +35,12 @@
 				return LanguageName;
 			}
 		}
+
+		public string[] MimeTypes {
+				get {
+					return mimeTypes;
+				}
+		}
 		
 		public bool IsSourceCodeFile (string fileName)
 		{
Index: Extras/VBNetBinding/ChangeLog
===================================================================
--- Extras/VBNetBinding/ChangeLog	(revision 57975)
+++ Extras/VBNetBinding/ChangeLog	(working copy)
@@ -1,3 +1,7 @@
+2006-03-16 David Makovsk&#253; (Yakeen) &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">yakeen at sannyas-on.net</A>&gt;
+
+	* VBLanguageBinding.cs: Track changes in ILanguageBinding.
+
 2006-01-30 Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at novell.com</A>&gt;   
 
 	* VBBindingCompilerServices.cs:
Index: Extras/VBNetBinding/VBLanguageBinding.cs
===================================================================
--- Extras/VBNetBinding/VBLanguageBinding.cs	(revision 57975)
+++ Extras/VBNetBinding/VBLanguageBinding.cs	(working copy)
@@ -23,7 +23,8 @@
 {
 	public class VBLanguageBinding : IDotNetLanguageBinding
 	{
-		public const string LanguageName = &quot;VBNet&quot;;
+		public const string LanguageName = &quot;VBNet&quot;;
+		private static readonly string[] mimeTypes = { &quot;text/x-vb&quot; };
 		
 		VBBindingCompilerServices   compilerServices  = new VBBindingCompilerServices();
 		VBCodeProvider provider;
@@ -33,6 +34,12 @@
 			get {
 				return LanguageName;
 			}
+		}
+
+		public string[] MimeTypes {
+				get {
+					return mimeTypes;
+				}
 		}
 		
 		public bool IsSourceCodeFile (string fileName)
Index: Extras/CSharpBinding/CSharpLanguageBinding.cs
===================================================================
--- Extras/CSharpBinding/CSharpLanguageBinding.cs	(revision 57975)
+++ Extras/CSharpBinding/CSharpLanguageBinding.cs	(working copy)
@@ -28,6 +28,7 @@
 	public class CSharpLanguageBinding : IDotNetLanguageBinding
 	{
 		public const string LanguageName = &quot;C#&quot;;
+		private static readonly string[] mimeTypes = { &quot;text/x-csharp&quot; };
 		
 		CSharpBindingCompilerManager   compilerManager  = new CSharpBindingCompilerManager();
 		CSharpCodeProvider provider;
@@ -38,6 +39,12 @@
 			}
 		}
 		
+		public string[] MimeTypes {
+				get {
+					return mimeTypes;
+				}
+		}
+
 		public bool IsSourceCodeFile (string fileName)
 		{
 			Debug.Assert(compilerManager != null);
Index: Extras/CSharpBinding/ChangeLog
===================================================================
--- Extras/CSharpBinding/ChangeLog	(revision 57975)
+++ Extras/CSharpBinding/ChangeLog	(working copy)
@@ -1,3 +1,7 @@
+2006-03-16 David Makovsk&#253; (Yakeen) &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">yakeen at sannyas-on.net</A>&gt;
+
+	* CSharpLanguageBinding.cs: Track changes in ILanguageBinding.
+
 2006-03-08 Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at novell.com</A>&gt;   
 
 	* Parser/CodeGenerator.cs: Fixed issues when finding class
Index: Extras/JavaBinding/JavaLanguageBinding.cs
===================================================================
--- Extras/JavaBinding/JavaLanguageBinding.cs	(revision 57975)
+++ Extras/JavaBinding/JavaLanguageBinding.cs	(working copy)
@@ -29,6 +29,8 @@
 	public class JavaLanguageBinding : IDotNetLanguageBinding
 	{
 		internal const string LanguageName = &quot;Java&quot;;
+		private static readonly string[] mimeTypes = { &quot;text/x-java&quot; };
+
 		JavaBindingCompilerServices compilerServices = new JavaBindingCompilerServices ();
 		
 		static GlobalProperties props = new GlobalProperties ();
@@ -42,6 +44,12 @@
 				return LanguageName;
 			}
 		}
+
+		public string[] MimeTypes {
+				get {
+					return mimeTypes;
+				}
+		}
 		
 		public bool IsSourceCodeFile (string fileName)
 		{
Index: Extras/JavaBinding/ChangeLog
===================================================================
--- Extras/JavaBinding/ChangeLog	(revision 57975)
+++ Extras/JavaBinding/ChangeLog	(working copy)
@@ -1,3 +1,7 @@
+2006-03-16 David Makovsk&#253; (Yakeen) &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">yakeen at sannyas-on.net</A>&gt;
+
+	* JavaLanguageBinding.cs: Track changes in ILanguageBinding.
+
 2006-01-30 Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at novell.com</A>&gt;   
 
 	* Parser/Resolver.cs:
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003406.html">[MonoDevelop] Bug 77604
</A></li>
	<LI>Next message: <A HREF="003408.html">[MonoDevelop] PATCH: Enable filering in open dialog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3407">[ date ]</a>
              <a href="thread.html#3407">[ thread ]</a>
              <a href="subject.html#3407">[ subject ]</a>
              <a href="author.html#3407">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
