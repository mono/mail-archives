<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] The new solution pad
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:lluis%40ximian.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="001687.html">
   <LINK REL="Next"  HREF="001680.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] The new solution pad
   </H1>
    <B>Lluis Sanchez
    </B> 
    <A HREF="mailto:lluis%40ximian.com"
       TITLE="[MonoDevelop] The new solution pad">lluis@ximian.com
       </A><BR>
    <I>Fri, 18 Feb 2005 16:34:15 +0100</I>
    <P><UL>
        <LI> Previous message: <A HREF="001687.html">[MonoDevelop] The new solution pad
</A></li>
        <LI> Next message: <A HREF="001680.html">[MonoDevelop] Casting Delegates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1688">[ date ]</a>
              <a href="thread.html#1688">[ thread ]</a>
              <a href="subject.html#1688">[ subject ]</a>
              <a href="author.html#1688">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On dv, 2005-02-18 at 15:44 +0100, Michael Lausch wrote:
&gt;<i> On Mon, 2005-02-14 at 15:17 +0100, Lluis Sanchez wrote:
</I>&gt;<i> &gt; Hi!
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I'm working on the new solution pad, and I'd like to explain how I think
</I>&gt;<i> &gt; it should work.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The first design idea is to have a hierarchy of TreeNode classes, so we
</I>&gt;<i> &gt; would have ProjectNode, CombineNode, FileNode, AspFileNode and so on.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; There are two reasons why I think this design is not so good.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;       * This model is not extensible enough. It can be vertically
</I>&gt;<i> &gt;         extended easily, by adding new subclasses in the hierarchy (e.g.
</I>&gt;<i> &gt;         new project or file types), but it's difficult to extend
</I>&gt;<i> &gt;         horizontally. For example, an SVN addin would need to show a
</I>&gt;<i> &gt;         special icon overlay for ALL files locally modified, and there
</I>&gt;<i> &gt;         isn't an easy way to add this functionality to all existing
</I>&gt;<i> &gt;         FileNode classes.
</I>&gt;<i> 
</I>&gt;<i> &gt;       * With this design, for every node in the tree we have three
</I>&gt;<i> &gt;         objects: the internal gtk data structure, the data object that
</I>&gt;<i> &gt;         the node represents (e.g. the ProjectFile), and the TreeNode
</I>&gt;<i> &gt;         that links both. I think the last one is not necessary and we
</I>&gt;<i> &gt;         can save some memory avoiding it.
</I>&gt;<i> 
</I>&gt;<i> one possibility to reduce the number of objects is to implement the
</I>&gt;<i> TreeModel Interface in the solutionpad.  All you ned is the node and the
</I>&gt;<i> internal gtk data structures. And the solution tree *is* the model for
</I>&gt;<i> the gtk treeview, eliminating the conversion step from the solution tree
</I>&gt;<i> to the gtk treemodel.
</I>
The solution pad is just a view of the solution tree, and it doesn't
need to have the same tree structure, which means that a conversion is
always needed. Is that bad? no. The best tree structure for displaying a
solution in the pad is not necessarily the best structure for storing
and managing projects internally.

&gt;<i> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So, my idea is to have a set of Node Builders, instead of a hierarchy of
</I>&gt;<i> &gt; nodes. NodeBuilders can handle one specific type of data, or multiple
</I>&gt;<i> &gt; types of data, and can be chained to provide composite functionality.
</I>&gt;<i> &gt; NodeBuilder would have the following interface:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; public abstract class NodeBuilder
</I>&gt;<i> &gt; {
</I>&gt;<i> &gt; 	protected ITreeBuilderContext Context { get {...} }
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 	public abstract bool CanBuildNode (Type dataType);
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 	public Gdk.Pixbuf BuildIcon (Gdk.Pixbuf icon, object dataObject) {...}
</I>&gt;<i> &gt; 	
</I>&gt;<i> &gt; 	public string BuildLabel (string label, object dataObject) {...}
</I>&gt;<i> &gt; 	
</I>&gt;<i> &gt; 	public void BuildChildNodes (BuildContext ctx, object dataObject) {...}
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 	public DragOperation CanDrag (object dataObject) {...}
</I>&gt;<i> &gt; 	
</I>&gt;<i> &gt; 	public bool CanDrop (object dataObject, DragOperation operation) {...}
</I>&gt;<i> &gt; 	
</I>&gt;<i> &gt; 	public void OnDrop (object dataObject, DragOperation operation) {...}
</I>&gt;<i> &gt; 	
</I>&gt;<i> &gt; 	public virtual void OnSelect (object dataObject) {...}
</I>&gt;<i> &gt; 	
</I>&gt;<i> &gt; 	public virtual void OnAction (object dataObject) {...}
</I>&gt;<i> &gt; 	
</I>&gt;<i> &gt; }
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> the code first has to determine the type of the node to be built. how is
</I>&gt;<i> this done? or is the type parameter of the CanBuild() function something
</I>&gt;<i> like e.g. System.IO.File for filesystem based objects?
</I>
The type of the node is the type of the object that the node represents:
Combine, Project, ProjectFile, ProjectReference, etc.

&gt;<i> 
</I>&gt;<i> &gt; By implementing the CanBuildNode method, a NodeBuilder specifies the
</I>&gt;<i> &gt; kind of data to which it will be applied. The solution pad will create
</I>&gt;<i> &gt; and cache a chain of NodeBuilder objects for each data type (not for
</I>&gt;<i> &gt; each data object). All builders in a chain will be used to build the
</I>&gt;<i> 
</I>&gt;<i> who and how is the order in the chain defined? the NodeBuilder
</I>&gt;<i> generating the SVN icon overlay should do it's work after the
</I>&gt;<i> NodeBuilder generating the file icon has prepared the pixmap for the
</I>&gt;<i> icon. 
</I>
We'll need to add some kind of priority property to the builder for
this.

&gt;<i> 
</I>&gt;<i> &gt; node. For example, to build the tree node label, it will call BuildLabel
</I>&gt;<i> &gt; in sequence for all builders, so all of them will have a chance of
</I>&gt;<i> &gt; adding text to the label.
</I>&gt;<i> 
</I>&gt;<i> [deleted]
</I>&gt;<i> 
</I>&gt;<i> &gt; That's all for now. Comments are welcome.
</I>&gt;<i> &gt; Lluis.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Monodevelop-list mailing list
</I>&gt;<i> &gt; <A HREF="mailto:Monodevelop-list@lists.ximian.com">Monodevelop-list@lists.ximian.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">http://lists.ximian.com/mailman/listinfo/monodevelop-list</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodevelop-list mailing list
</I>&gt;<i> <A HREF="mailto:Monodevelop-list@lists.ximian.com">Monodevelop-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">http://lists.ximian.com/mailman/listinfo/monodevelop-list</A>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="001687.html">[MonoDevelop] The new solution pad
</A></li>
	<LI> Next message: <A HREF="001680.html">[MonoDevelop] Casting Delegates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1688">[ date ]</a>
              <a href="thread.html#1688">[ thread ]</a>
              <a href="subject.html#1688">[ subject ]</a>
              <a href="author.html#1688">[ author ]</a>
         </LI>
       </UL>
</body></html>
