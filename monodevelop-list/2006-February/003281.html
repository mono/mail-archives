<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] Re: [PATCH] Mono.Data.Sql - remove refereces to data
	providers and use Mono.Data.ProviderFactory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Re%3A%20%5BPATCH%5D%20Mono.Data.Sql%20-%20remove%20refereces%20to%20data%0A%09providers%20and%20use%20Mono.Data.ProviderFactory&In-Reply-To=43FD49E6.5040409%40verizon.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003280.html">
   <LINK REL="Next"  HREF="003290.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] Re: [PATCH] Mono.Data.Sql - remove refereces to data
	providers and use Mono.Data.ProviderFactory</H1>
    <B>Christian Hergert</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Re%3A%20%5BPATCH%5D%20Mono.Data.Sql%20-%20remove%20refereces%20to%20data%0A%09providers%20and%20use%20Mono.Data.ProviderFactory&In-Reply-To=43FD49E6.5040409%40verizon.net"
       TITLE="[MonoDevelop] Re: [PATCH] Mono.Data.Sql - remove refereces to data
	providers and use Mono.Data.ProviderFactory">christian.hergert at gmail.com
       </A><BR>
    <I>Thu Feb 23 01:31:59 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="003280.html">[MonoDevelop] [PATCH] Mono.Data.Sql - remove refereces to data
 providers and use Mono.Data.ProviderFactory
</A></li>
        <LI>Next message: <A HREF="003290.html">[MonoDevelop] Using Monodevelop with Glade-3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3281">[ date ]</a>
              <a href="thread.html#3281">[ thread ]</a>
              <a href="subject.html#3281">[ subject ]</a>
              <a href="author.html#3281">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I would like to see the provider factory stuff move into mono.data.sql
if we can do so.

-- Christian

On 2/22/06, Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt; wrote:
&gt;<i> The patch is just for research purposes to move Mono.Data.Sql forward.
</I>&gt;<i>
</I>&gt;<i> The filename is diff.txt
</I>&gt;<i>
</I>&gt;<i> I've only tested it with Oracle though.  Can you test the Npsql provider
</I>&gt;<i> please?
</I>&gt;<i>
</I>&gt;<i> Your thoughts on this?
</I>&gt;<i>
</I>&gt;<i> Right now, I'm using the Mono.Data.ProviderFactory within
</I>&gt;<i> Mono.Data.Sql.  Maybe, I should just merge the Mono.Data.ProviderFactory
</I>&gt;<i> stuff into Mono.Data.Sql?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Index: tests/test-oracle-1.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- tests/test-oracle-1.cs      (revision 57083)
</I>&gt;<i> +++ tests/test-oracle-1.cs      (working copy)
</I>&gt;<i> @@ -1,38 +1,74 @@
</I>&gt;<i>  // test-oracle-1.cs
</I>&gt;<i>  //
</I>&gt;<i> -// $ mcs test-oracle-1.cs /r:System.Data /r:System.Data.OracleClient /r:Mono.Data.Sql
</I>&gt;<i> +// $ mcs test-oracle-1.cs /r:System.Data /r:Mono.Data.Sql /r:Mono.Data
</I>&gt;<i>  //
</I>&gt;<i>
</I>&gt;<i>  using System;
</I>&gt;<i> +using System.Collections;
</I>&gt;<i>  using System.Data;
</I>&gt;<i> -using System.Data.OracleClient;
</I>&gt;<i> +using System.Data.Common;
</I>&gt;<i> +using System.Data.SqlTypes;
</I>&gt;<i>  using System.Text;
</I>&gt;<i>  using Mono.Data.Sql;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql.Tests
</I>&gt;<i>  {
</I>&gt;<i>         public class CreateProviderTest
</I>&gt;<i>         {
</I>&gt;<i> -               static OracleDbProvider provider = null;
</I>&gt;<i> +               static DbProviderBase provider = null;
</I>&gt;<i>
</I>&gt;<i>                 static TableSchema[] tables = null;
</I>&gt;<i>                 static ViewSchema[] views = null;
</I>&gt;<i> +
</I>&gt;<i> +               public static void Main(string[] args)
</I>&gt;<i> +               {
</I>&gt;<i> +                       Test2();
</I>&gt;<i> +                       Test1();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public static void Test2()
</I>&gt;<i> +               {
</I>&gt;<i> +                       Console.WriteLine(&quot;Test2 Oracle Meta Data Provider using MetaDataProviderFactory...&quot;);
</I>&gt;<i> +
</I>&gt;<i> +                       string setting = &quot;OraConnStr&quot;;
</I>&gt;<i> +                       provider = MetaDataProviderFactory.GetDbProviderBaseFromSetting(setting);
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ provider.ConnectionString: &quot; + provider.ConnectionString);
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ provider.Provider.Name: &quot; + provider.Provider.Name);
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ provider.ProviderName: &quot; + provider.ProviderName);
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ Open()...&quot;);
</I>&gt;<i> +                       provider.Open();
</I>&gt;<i> +
</I>&gt;<i> +                       ListTables ();
</I>&gt;<i> +
</I>&gt;<i> +                       tables = null;
</I>&gt;<i> +
</I>&gt;<i> +                       provider.Close();
</I>&gt;<i> +                       provider = null;
</I>&gt;<i> +
</I>&gt;<i> +                       Console.WriteLine(&quot;Test Done.&quot;);
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i> -               public static void Main(string[] args)
</I>&gt;<i> +               public static void Test1()
</I>&gt;<i>                 {
</I>&gt;<i> -                       Console.WriteLine(&quot;Test Oracle Meta Data Provider...&quot;);
</I>&gt;<i> +                       Console.WriteLine(&quot;Test1 Oracle Meta Data Provider...&quot;);
</I>&gt;<i>
</I>&gt;<i> -                       provider = new OracleDbProvider ();
</I>&gt;<i> +                       provider = (DbProviderBase) new OracleDbProvider ();
</I>&gt;<i>                         provider.ConnectionString = &quot;Data Source=palis;user id=scott;password=tiger&quot;;
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ provider.ConnectionString: &quot; + provider.ConnectionString);
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ provider.Provider.Name: &quot; + provider.Provider.Name);
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ provider.ProviderName: &quot; + provider.ProviderName);
</I>&gt;<i> +                       Console.Error.WriteLine(&quot;+++ Open()...&quot;);
</I>&gt;<i>                         provider.Open ();
</I>&gt;<i>
</I>&gt;<i>                         ListTables ();
</I>&gt;<i> -                       ListViews ();
</I>&gt;<i> +                       //ListViews ();
</I>&gt;<i>
</I>&gt;<i>                         tables = null;
</I>&gt;<i>                         views = null;
</I>&gt;<i>
</I>&gt;<i>                         provider.Close();
</I>&gt;<i> +                       provider = null;
</I>&gt;<i>
</I>&gt;<i>                         Console.WriteLine(&quot;Test Done.&quot;);
</I>&gt;<i>                 }
</I>&gt;<i> Index: tests/test-oracle-1.exe.config
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- tests/test-oracle-1.exe.config      (revision 0)
</I>&gt;<i> +++ tests/test-oracle-1.exe.config      (revision 0)
</I>&gt;<i> @@ -0,0 +1,149 @@
</I>&gt;<i> +&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
</I>&gt;<i> +&lt;configuration&gt;
</I>&gt;<i> +       &lt;configSections&gt;
</I>&gt;<i> +               &lt;sectionGroup name=&quot;mono.data&quot;&gt;
</I>&gt;<i> +                       &lt;section name=&quot;providers&quot; type=&quot;Mono.Data.ProviderSectionHandler,Mono.Data&quot; /&gt;
</I>&gt;<i> +               &lt;/sectionGroup&gt;
</I>&gt;<i> +               &lt;sectionGroup name=&quot;mono.data.sql&quot;&gt;
</I>&gt;<i> +                       &lt;section name=&quot;metadataproviders&quot; type=&quot;Mono.Data.Sql.MetaDataProviderSectionHandler,Mono.Data.Sql&quot; /&gt;
</I>&gt;<i> +               &lt;/sectionGroup&gt;
</I>&gt;<i> +       &lt;/configSections&gt;
</I>&gt;<i> +       &lt;appSettings&gt;
</I>&gt;<i> +               &lt;add key=&quot;PubsConnStr&quot; value=&quot;factory=System.Data.SqlClient;server=localhost;database=testdb;uid=sa;pwd=mypassword&quot; /&gt;
</I>&gt;<i> +               &lt;add key=&quot;OraConnStr&quot; value=&quot;factory=System.Data.OracleClient;data source=palis;user id=scott;password=tiger&quot; /&gt;
</I>&gt;<i> +               &lt;add key=&quot;PgConnStr&quot; value=&quot;factory=Npgsql;Server=localhost;Database=monotest;User ID=monotest;Password=monotest&quot; /&gt;
</I>&gt;<i> +               &lt;!--&lt;add key=&quot;MySqlByteFXConnStr&quot; value=&quot;factory=ByteFX.Data.MySqlClient;Database=test&quot; /&gt;--&gt;
</I>&gt;<i> +               &lt;!--&lt;add key=&quot;FireConnStr&quot; value=&quot;factory=FirebirdSql.Data.Firebird;Database=E:\FIREBIRD\EXAMPLES\EMPLOYEE.FDB;User=SYSDBA;Password=masterkey;Dialect=3;Server=localhost&quot; /&gt;--&gt;
</I>&gt;<i> +               &lt;add key=&quot;Sqlite2ConnStr&quot; value=&quot;factory=Mono.Data.SqliteClient;URI=file:sqlitetest2.db&quot; /&gt;
</I>&gt;<i> +               &lt;add key=&quot;Sqlite3ConnStr&quot; value=&quot;factory=Mono.Data.SqliteClient;URI=file:sqlitetest3.db,Version=3&quot; /&gt;
</I>&gt;<i> +               &lt;add key=&quot;SybaseConnStr&quot; value=&quot;factory=Mono.Data.SybaseClient;Server=MYSERVER,5000;Database=testdb;User ID=sa;Password=;&quot; /&gt;
</I>&gt;<i> +               &lt;!--&lt;add key=&quot;MySqlConnStr&quot; value=&quot;factory=MySql.Data;server=localhost;user id=userl;password=pass;database=mysql;pooling=false&quot; /&gt;--&gt;
</I>&gt;<i> +       &lt;/appSettings&gt;
</I>&gt;<i> +       &lt;mono.data&gt;
</I>&gt;<i> +               &lt;providers&gt;
</I>&gt;<i> +                       &lt;provider
</I>&gt;<i> +                               name=&quot;System.Data.SqlClient&quot;
</I>&gt;<i> +                               connection=&quot;System.Data.SqlClient.SqlConnection&quot;
</I>&gt;<i> +                               adapter=&quot;System.Data.SqlClient.SqlDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;System.Data.SqlClient.SqlCommand&quot;
</I>&gt;<i> +                               assembly=&quot;System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;
</I>&gt;<i> +                               description=&quot;Microsoft SQL Server 7.0/2000/2005&quot;
</I>&gt;<i> +                               parameterprefix=&quot;at&quot;
</I>&gt;<i> +                               commandbuilder=&quot;System.Data.SqlClient.SqlCommandBuilder&quot;  /&gt;
</I>&gt;<i> +                       &lt;provider
</I>&gt;<i> +                               name=&quot;System.Data.OleDb&quot;
</I>&gt;<i> +                               connection=&quot;System.Data.OleDb.OleDbConnection&quot;
</I>&gt;<i> +                               adapter=&quot;System.Data.OleDb.OleDbDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;System.Data.OleDb.OleDbCommand&quot;
</I>&gt;<i> +                               assembly=&quot;System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;
</I>&gt;<i> +                               description=&quot;OLE DB&quot; /&gt;
</I>&gt;<i> +                       &lt;provider
</I>&gt;<i> +                               name=&quot;System.Data.Odbc&quot;
</I>&gt;<i> +                               connection=&quot;System.Data.Odbc.OdbcConnection&quot;
</I>&gt;<i> +                               adapter=&quot;System.Data.Odbc.OdbcDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;System.Data.Odbc.OdbcCommand&quot;
</I>&gt;<i> +                               assembly=&quot;System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;
</I>&gt;<i> +                               description=&quot;ODBC&quot;
</I>&gt;<i> +                               parameterprefix=&quot;questionmark&quot;
</I>&gt;<i> +                               commandbuilder=&quot;System.Data.Odbc.OdbcCommandBuilder&quot; /&gt;
</I>&gt;<i> +                       &lt;provider
</I>&gt;<i> +                               name=&quot;System.Data.OracleClient&quot;
</I>&gt;<i> +                               connection=&quot;System.Data.OracleClient.OracleConnection&quot;
</I>&gt;<i> +                               adapter=&quot;System.Data.OracleClient.OracleDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;System.Data.OracleClient.OracleCommand&quot;
</I>&gt;<i> +                               assembly=&quot;System.Data.OracleClient, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;
</I>&gt;<i> +                               description=&quot;Oracle&quot;
</I>&gt;<i> +                               parameterprefix=&quot;colon&quot;
</I>&gt;<i> +                               commandbuilder=&quot;System.Data.OracleClient.OracleCommandBuilder&quot; /&gt;
</I>&gt;<i> +                       &lt;!--&lt;provider
</I>&gt;<i> +                               name=&quot;ByteFX.Data.MySqlClient&quot;
</I>&gt;<i> +                               connection=&quot;ByteFX.Data.MySqlClient.MySqlConnection&quot;
</I>&gt;<i> +                               adapter=&quot;ByteFX.Data.MySqlClient.MySqlDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;ByteFX.Data.MySqlClient.MySqlCommand&quot;
</I>&gt;<i> +                               assembly=&quot;ByteFX.Data, Version=0.7.6.1, Culture=neutral, PublicKeyToken=0738eb9f132ed756&quot;
</I>&gt;<i> +                               description=&quot;MySQL (ByteFX)&quot; /&gt;--&gt;
</I>&gt;<i> +                       &lt;provider
</I>&gt;<i> +                               name=&quot;Npgsql&quot;
</I>&gt;<i> +                               connection=&quot;Npgsql.NpgsqlConnection&quot;
</I>&gt;<i> +                               adapter=&quot;Npgsql.NpgsqlDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;Npgsql.NpgsqlCommand&quot;
</I>&gt;<i> +                               assembly=&quot;Npgsql, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=5d8b90d52f46fda7&quot;
</I>&gt;<i> +                               description=&quot;PostgreSQL&quot;
</I>&gt;<i> +                               parameterprefix=&quot;at&quot;
</I>&gt;<i> +                               commandbuilder=&quot;Npgsql.NpgsqlCommandBuilder&quot; /&gt;
</I>&gt;<i> +                       &lt;provider
</I>&gt;<i> +                               name=&quot;Mono.Data.SqliteClient&quot;
</I>&gt;<i> +                               connection=&quot;Mono.Data.SqliteClient.SqliteConnection&quot;
</I>&gt;<i> +                               adapter=&quot;Mono.Data.SqliteClient.SqliteDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;Mono.Data.SqliteClient.SqliteCommand&quot;
</I>&gt;<i> +                               assembly=&quot;Mono.Data.SqliteClient, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=0738eb9f132ed756&quot;
</I>&gt;<i> +                               description=&quot;SQL Lite&quot;
</I>&gt;<i> +                               parameterprefix=&quot;colon&quot; /&gt;
</I>&gt;<i> +                       &lt;provider
</I>&gt;<i> +                               name=&quot;Mono.Data.SybaseClient&quot;
</I>&gt;<i> +                               connection=&quot;Mono.Data.SybaseClient.SybaseConnection&quot;
</I>&gt;<i> +                               adapter=&quot;Mono.Data.SybaseClient.SybaseDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;Mono.Data.SybaseClient.SybaseCommand&quot;
</I>&gt;<i> +                               assembly=&quot;Mono.Data.SybaseClient, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=0738eb9f132ed756&quot;
</I>&gt;<i> +                               description=&quot;Sybase&quot;
</I>&gt;<i> +                               parameterprefix=&quot;at&quot; /&gt;
</I>&gt;<i> +                       &lt;!--&lt;provider
</I>&gt;<i> +                               name=&quot;FirebirdSql.Data.Firebird&quot;
</I>&gt;<i> +                               connection=&quot;FirebirdSql.Data.Firebird.FbConnection&quot;
</I>&gt;<i> +                               adapter=&quot;FirebirdSql.Data.Firebird.FbDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;FirebirdSql.Data.Firebird.FbCommand&quot;
</I>&gt;<i> +                               assembly=&quot;FirebirdSql.Data.Firebird, Version=1.6.3.0, Culture=neutral, PublicKeyToken=e1b4f92304d7b12f&quot;
</I>&gt;<i> +                               description=&quot;Firebird&quot;
</I>&gt;<i> +                               parameterprefix=&quot;at&quot;
</I>&gt;<i> +                               commandbuilder=&quot;FirebirdSql.Data.Firebird.FbCommandBuilder&quot; /&gt;--&gt;
</I>&gt;<i> +                       &lt;!--&lt;provider
</I>&gt;<i> +                               name=&quot;IBM.Data.DB2&quot;
</I>&gt;<i> +                               connection=&quot;IBM.Data.DB2.DB2Connection&quot;
</I>&gt;<i> +                               adapter=&quot;IBM.Data.DB2.DB2DataAdapter&quot;
</I>&gt;<i> +                               command=&quot;IBM.Data.DB2.DB2Command&quot;
</I>&gt;<i> +                               assembly=&quot;IBM.Data.DB2, Version=1.0.1728.9997, Culture=neutral, PublicKeyToken=7c307b91aa13d208&quot;
</I>&gt;<i> +                               description=&quot;IBM DB2 Universal Database&quot; /&gt;--&gt;
</I>&gt;<i> +                       &lt;!--&lt;provider
</I>&gt;<i> +                               name=&quot;MySql.Data&quot;
</I>&gt;<i> +                               connection=&quot;MySql.Data.MySqlClient.MySqlConnection&quot;
</I>&gt;<i> +                               adapter=&quot;MySql.Data.MySqlClient.MySqlDataAdapter&quot;
</I>&gt;<i> +                               command=&quot;MySql.Data.MySqlClient.MySqlCommand&quot;
</I>&gt;<i> +                               assembly=&quot;MySql.Data, Version=1.0.7.30073, Culture=neutral, PublicKeyToken=8e323390df8d9ed4&quot;
</I>&gt;<i> +                               description=&quot;MySQL (MySQL AB)&quot;
</I>&gt;<i> +                               parameterprefix=&quot;at&quot;
</I>&gt;<i> +                               commandbuilder=&quot;MySql.Data.MySqlClient.MySqlCommandBuilder&quot; /&gt;--&gt;
</I>&gt;<i> +               &lt;/providers&gt;
</I>&gt;<i> +       &lt;/mono.data&gt;
</I>&gt;<i> +       &lt;mono.data.sql&gt;
</I>&gt;<i> +               &lt;metadataproviders&gt;
</I>&gt;<i> +                       &lt;metaprovider
</I>&gt;<i> +                               providername=&quot;System.Data.SqlClient&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.SqlDbProvider&quot; /&gt;
</I>&gt;<i> +                       &lt;metaprovider
</I>&gt;<i> +                               providername=&quot;System.Data.Odbc&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.OdbcDbProvider&quot;  /&gt;
</I>&gt;<i> +                       &lt;metaprovider
</I>&gt;<i> +                               providername=&quot;System.Data.OracleClient&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.OracleDbProvider&quot;  /&gt;
</I>&gt;<i> +                       &lt;metaprovider
</I>&gt;<i> +                               providername=&quot;Npgsql&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.NpgsqlDbProvider&quot;  /&gt;
</I>&gt;<i> +                       &lt;metaprovider
</I>&gt;<i> +                               providername=&quot;Mono.Data.SqliteClient&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.SqliteDbProvider&quot; /&gt;
</I>&gt;<i> +                       &lt;metaprovider
</I>&gt;<i> +                               providername=&quot;Mono.Data.SybaseClient&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.SybaseDbProvider&quot; /&gt;
</I>&gt;<i> +                       &lt;!--&lt;metaprovider
</I>&gt;<i> +                               providername=&quot;FirebirdSql.Data.Firebird&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.FirebirdDbProvider&quot; /&gt;--&gt;
</I>&gt;<i> +                       &lt;!--&lt;metaprovider
</I>&gt;<i> +                               providername=&quot;MySql.Data&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.MySqlDbProvider&quot; /&gt;--&gt;
</I>&gt;<i> +                       &lt;!--&lt;metaprovider
</I>&gt;<i> +                               providername=&quot;ByteFX.Data.MySqlClient&quot;
</I>&gt;<i> +                               metaprovidername=&quot;Mono.Data.Sql.MySqlDbProvider&quot;  /&gt;--&gt;
</I>&gt;<i> +               &lt;/metadataproviders&gt;
</I>&gt;<i> +       &lt;/mono.data.sql&gt;
</I>&gt;<i> +&lt;/configuration&gt;
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> Property changes on: tests/test-oracle-1.exe.config
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Name: svn:executable
</I>&gt;<i>    + *
</I>&gt;<i>
</I>&gt;<i> Index: Mono.Data.Sql/Providers/DbProviderBase.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/DbProviderBase.cs   (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/DbProviderBase.cs   (working copy)
</I>&gt;<i> @@ -3,8 +3,10 @@
</I>&gt;<i>  //
</I>&gt;<i>  // Authors:
</I>&gt;<i>  // Christian Hergert   &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">chris at mosaix.net</A>&gt;
</I>&gt;<i> +// Daniel Morgan        &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt;
</I>&gt;<i>  //
</I>&gt;<i>  // Copyright (C) 2005 Mosaix Communications, Inc.
</I>&gt;<i> +// Copyright (C) 2006 Daniel Morgan
</I>&gt;<i>  //
</I>&gt;<i>  // Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i>  // a copy of this software and associated documentation files (the
</I>&gt;<i> @@ -31,6 +33,8 @@
</I>&gt;<i>  using System.Data;
</I>&gt;<i>  using System.Threading;
</I>&gt;<i>
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i> +
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i>         public delegate void DbProviderChangedEventHandler (object sender, DbProviderChangedArgs args);
</I>&gt;<i> @@ -47,13 +51,13 @@
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         [Serializable]
</I>&gt;<i> -       public abstract class DbProviderBase
</I>&gt;<i> -       {
</I>&gt;<i> +       public abstract class DbProviderBase {
</I>&gt;<i>                 public event DbProviderChangedEventHandler NameChanged;
</I>&gt;<i>                 public event DbProviderChangedEventHandler StateChanged;
</I>&gt;<i>                 public event DbProviderChangedEventHandler Refreshed;
</I>&gt;<i>
</I>&gt;<i>                 protected string name = String.Empty;
</I>&gt;<i> +               Provider provider = null;
</I>&gt;<i>
</I>&gt;<i>                 #region // Threading objects
</I>&gt;<i>                 Object ThreadSync = new Object ();
</I>&gt;<i> @@ -64,13 +68,27 @@
</I>&gt;<i>                 String ThreadedSQLText = String.Empty;
</I>&gt;<i>                 #endregion // End of Threading objects
</I>&gt;<i>
</I>&gt;<i> -               public DbProviderBase ()
</I>&gt;<i> +               public DbProviderBase ()
</I>&gt;<i>                 {
</I>&gt;<i> +                       provider = GetMonoDataProvider ();
</I>&gt;<i>                 }
</I>&gt;<i> +
</I>&gt;<i> +               public DbProviderBase (Provider provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       this.provider = provider;
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public Provider Provider {
</I>&gt;<i> +                       get {
</I>&gt;<i> +                               if (provider == null)
</I>&gt;<i> +                                       provider = GetMonoDataProvider ();
</I>&gt;<i> +                               return provider;
</I>&gt;<i> +                       }
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i>                 public virtual string ProviderName {
</I>&gt;<i>                         get {
</I>&gt;<i> -                               return &quot;Unknown Provider&quot;;
</I>&gt;<i> +                               return provider.Name;
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> @@ -117,30 +135,30 @@
</I>&gt;<i>                                 return true;
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> -               public virtual bool Open ()
</I>&gt;<i> +
</I>&gt;<i> +               private Provider GetMonoDataProvider()
</I>&gt;<i>                 {
</I>&gt;<i> +                       return MetaDataProviderFactory.GetProvider (this);
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public virtual bool Open () {
</I>&gt;<i>                         return IsOpen;
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void Close ()
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void Close () {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void Refresh ()
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void Refresh () {
</I>&gt;<i>                         if (Refreshed != null)
</I>&gt;<i>                                 Refreshed (this, new DbProviderChangedArgs (this));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual bool SupportsSchemaType (Type type)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual bool SupportsSchemaType (Type type) {
</I>&gt;<i>                         return false;
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void ExecuteSQL (string SQLText, SQLCallback Callback)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void ExecuteSQL (string SQLText, SQLCallback Callback) {
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i>                                 ThreadedSQLText = SQLText;
</I>&gt;<i> @@ -149,13 +167,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual DataTable ExecuteSQL (string SQLText)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual DataTable ExecuteSQL (string SQLText) {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void ExplainSQL (string SQLText, SQLCallback Callback)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void ExplainSQL (string SQLText, SQLCallback Callback) {
</I>&gt;<i>                         if (CanExplain != true)
</I>&gt;<i>                                 return;
</I>&gt;<i>
</I>&gt;<i> @@ -167,16 +183,14 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual DataTable ExplainSQL (string SQLText)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual DataTable ExplainSQL (string SQLText) {
</I>&gt;<i>                         if (CanExplain == false)
</I>&gt;<i>                                 return null;
</I>&gt;<i>
</I>&gt;<i>                         return ExecuteSQL (String.Format (&quot;EXPLAIN {0}&quot;, SQLText));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetTables (SQLCallback Callback)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetTables (SQLCallback Callback) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -185,13 +199,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual TableSchema[] GetTables ()
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual TableSchema[] GetTables () {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetTableColumns (SQLCallback Callback, TableSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetTableColumns (SQLCallback Callback, TableSchema schema) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -201,13 +213,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual ColumnSchema[] GetTableColumns (TableSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual ColumnSchema[] GetTableColumns (TableSchema schema) {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetTableConstraints (SQLCallback Callback, TableSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetTableConstraints (SQLCallback Callback, TableSchema schema) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -217,13 +227,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual ConstraintSchema[] GetTableConstraints (TableSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual ConstraintSchema[] GetTableConstraints (TableSchema schema) {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetViews (SQLCallback Callback)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetViews (SQLCallback Callback) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -232,13 +240,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual ViewSchema[] GetViews ()
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual ViewSchema[] GetViews () {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetViewColumns (SQLCallback Callback, ViewSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetViewColumns (SQLCallback Callback, ViewSchema schema) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -248,13 +254,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual ColumnSchema[] GetViewColumns (ViewSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual ColumnSchema[] GetViewColumns (ViewSchema schema) {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetProcedures (SQLCallback Callback)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetProcedures (SQLCallback Callback) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -263,13 +267,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual ProcedureSchema[] GetProcedures ()
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual ProcedureSchema[] GetProcedures () {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetProcedureColumns (SQLCallback Callback, ProcedureSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetProcedureColumns (SQLCallback Callback, ProcedureSchema schema) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -280,13 +282,11 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual ColumnSchema[] GetProcedureColumns (ProcedureSchema schema)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual ColumnSchema[] GetProcedureColumns (ProcedureSchema schema) {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual void GetUsers (SQLCallback Callback)
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual void GetUsers (SQLCallback Callback) {
</I>&gt;<i>                         Thread eThread = null;
</I>&gt;<i>                         lock (ThreadSync) {
</I>&gt;<i>                                 ThreadedSQLCallback = Callback;
</I>&gt;<i> @@ -295,87 +295,75 @@
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               public virtual UserSchema[] GetUsers ()
</I>&gt;<i> -               {
</I>&gt;<i> +               public virtual UserSchema[] GetUsers () {
</I>&gt;<i>                         throw new NotImplementedException ();
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void OnOpen ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void OnOpen () {
</I>&gt;<i>                         if (StateChanged != null)
</I>&gt;<i>                                 StateChanged (this, new DbProviderChangedArgs (this));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void OnClose ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void OnClose () {
</I>&gt;<i>                         if (StateChanged != null)
</I>&gt;<i>                                 StateChanged (this, new DbProviderChangedArgs (this));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void ExecuteSQLThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void ExecuteSQLThreadStart () {
</I>&gt;<i>                         string SQLText = ThreadedSQLText;
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         Callback (this, ExecuteSQL (SQLText));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void ExplainSQLThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void ExplainSQLThreadStart () {
</I>&gt;<i>                         string SQLText = ThreadedSQLText;
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         Callback (this, ExplainSQL (SQLText));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetTablesThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetTablesThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         Callback (this, GetTables ());
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetTableColumnsThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetTableColumnsThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         TableSchema Table = ThreadedTableSchema;
</I>&gt;<i>                         Callback (this, GetTableColumns (Table));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetTableConstraintsThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetTableConstraintsThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         TableSchema Table = ThreadedTableSchema;
</I>&gt;<i>                         Callback (this, GetTableConstraints (Table));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetViewsThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetViewsThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         Callback (this, GetViews ());
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetViewColumnsThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetViewColumnsThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         ViewSchema view = ThreadedViewSchema;
</I>&gt;<i>                         Callback (this, GetViewColumns (view));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetProceduresThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetProceduresThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         Callback (this, GetProcedures ());
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetProcedureColumnsThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetProcedureColumnsThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         ProcedureSchema schema = ThreadedProcedureSchema;
</I>&gt;<i>                         Callback (this, GetProcedureColumns (schema));
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i> -               protected virtual void GetUsersThreadStart ()
</I>&gt;<i> -               {
</I>&gt;<i> +               protected virtual void GetUsersThreadStart () {
</I>&gt;<i>                         SQLCallback Callback = ThreadedSQLCallback;
</I>&gt;<i>                         Callback (this, GetUsers ());
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i> -}
</I>&gt;<i> \ No newline at end of file
</I>&gt;<i> +}
</I>&gt;<i> +
</I>&gt;<i> Index: Mono.Data.Sql/Providers/MetaDataProviderSectionHandler.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/MetaDataProviderSectionHandler.cs   (revision 0)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/MetaDataProviderSectionHandler.cs   (revision 0)
</I>&gt;<i> @@ -0,0 +1,96 @@
</I>&gt;<i> +//
</I>&gt;<i> +// Mono.Data.Sql.MeataDataProviderSectionHandler
</I>&gt;<i> +//
</I>&gt;<i> +// Authors:
</I>&gt;<i> +//   Brian Ritchie (<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">brianlritchie at hotmail.com</A>)
</I>&gt;<i> +//   Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt;
</I>&gt;<i> +//
</I>&gt;<i> +//
</I>&gt;<i> +// Copyright (C) Brian Ritchie, 2002
</I>&gt;<i> +// Copyright (C) Daniel Morgan, 2006
</I>&gt;<i> +//
</I>&gt;<i> +
</I>&gt;<i> +//
</I>&gt;<i> +// Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i> +// a copy of this software and associated documentation files (the
</I>&gt;<i> +// &quot;Software&quot;), to deal in the Software without restriction, including
</I>&gt;<i> +// without limitation the rights to use, copy, modify, merge, publish,
</I>&gt;<i> +// distribute, sublicense, and/or sell copies of the Software, and to
</I>&gt;<i> +// permit persons to whom the Software is furnished to do so, subject to
</I>&gt;<i> +// the following conditions:
</I>&gt;<i> +//
</I>&gt;<i> +// The above copyright notice and this permission notice shall be
</I>&gt;<i> +// included in all copies or substantial portions of the Software.
</I>&gt;<i> +//
</I>&gt;<i> +// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</I>&gt;<i> +// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</I>&gt;<i> +// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</I>&gt;<i> +// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</I>&gt;<i> +// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</I>&gt;<i> +// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</I>&gt;<i> +// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</I>&gt;<i> +//
</I>&gt;<i> +
</I>&gt;<i> +using System;
</I>&gt;<i> +using System.Collections;
</I>&gt;<i> +using System.Xml;
</I>&gt;<i> +using System.Configuration;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i> +using System.Reflection;
</I>&gt;<i> +
</I>&gt;<i> +namespace Mono.Data.Sql
</I>&gt;<i> +{
</I>&gt;<i> +       public class MetaDataProviderSectionHandler : IConfigurationSectionHandler
</I>&gt;<i> +       {
</I>&gt;<i> +               public virtual object Create (object parent, object configContext, XmlNode section)
</I>&gt;<i> +               {
</I>&gt;<i> +                       if (section == null)
</I>&gt;<i> +                               throw new System.ArgumentNullException (&quot;section&quot;);
</I>&gt;<i> +
</I>&gt;<i> +                       ArrayList providers = new ArrayList();
</I>&gt;<i> +                       Assembly assembly = Assembly.GetExecutingAssembly();
</I>&gt;<i> +
</I>&gt;<i> +                       XmlNodeList ProviderList = section.SelectNodes (&quot;./metaprovider&quot;);
</I>&gt;<i> +                       foreach (XmlNode ProviderNode in ProviderList) {
</I>&gt;<i> +                               string providername = GetStringValue (ProviderNode, &quot;providername&quot;, true);
</I>&gt;<i> +                               string metaprovidername = GetStringValue (ProviderNode, &quot;metaprovidername&quot;, true);
</I>&gt;<i> +
</I>&gt;<i> +                               // get provider instance
</I>&gt;<i> +                               Provider provider = null;
</I>&gt;<i> +                               try {
</I>&gt;<i> +                                       provider = ProviderFactory.Providers[providername];
</I>&gt;<i> +                               }
</I>&gt;<i> +                               catch(ArgumentOutOfRangeException ae) {
</I>&gt;<i> +                                       throw new Exception(&quot;Can not find a Provider that matches providername in config file.&quot;);
</I>&gt;<i> +
</I>&gt;<i> +                               }
</I>&gt;<i> +
</I>&gt;<i> +                               // get meata data provider (dbprovider)
</I>&gt;<i> +                               Type dbprovidertype = assembly.GetType(metaprovidername);
</I>&gt;<i> +                               if (dbprovidertype == null)
</I>&gt;<i> +                                       throw new Exception(&quot;Can not find a DbProvider that matches metaprovidername in the config file.&quot;);
</I>&gt;<i> +                               object[] parms = new object [] { provider };
</I>&gt;<i> +                               object obj = Activator.CreateInstance (dbprovidertype, parms);
</I>&gt;<i> +                               DbProviderBase dbprovider = (DbProviderBase) obj;
</I>&gt;<i> +
</I>&gt;<i> +                               // add dbprovider to collection of dbproviders
</I>&gt;<i> +                               providers.Add (dbprovider);
</I>&gt;<i> +                       }
</I>&gt;<i> +
</I>&gt;<i> +                       return (DbProviderBase[]) providers.ToArray(typeof(DbProviderBase));
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               private string GetStringValue(XmlNode _node, string _attribute, bool required)
</I>&gt;<i> +               {
</I>&gt;<i> +                       XmlNode a = _node.Attributes.RemoveNamedItem(_attribute);
</I>&gt;<i> +                       if (a == null) {
</I>&gt;<i> +                               if (required)
</I>&gt;<i> +                                       throw new ConfigurationException(&quot;Attribute required: &quot; + _attribute);
</I>&gt;<i> +                               else
</I>&gt;<i> +                                       return null;
</I>&gt;<i> +                       }
</I>&gt;<i> +                       return a.Value;
</I>&gt;<i> +               }
</I>&gt;<i> +       }
</I>&gt;<i> +}
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> Property changes on: Mono.Data.Sql/Providers/MetaDataProviderSectionHandler.cs
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Name: svn:executable
</I>&gt;<i>    + *
</I>&gt;<i>
</I>&gt;<i> Index: Mono.Data.Sql/Providers/SqlDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/SqlDbProvider.cs    (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/SqlDbProvider.cs    (working copy)
</I>&gt;<i> @@ -7,6 +7,8 @@
</I>&gt;<i>  //   Sureshkumar T &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">tsureshkumar at novell.com</A>&gt;
</I>&gt;<i>  //
</I>&gt;<i>  // Copyright (C) 2005 Mosaix Communications, Inc.
</I>&gt;<i> +// Copyright (C) 2005, 2006 Daniel Morgan
</I>&gt;<i> +// Copyright (C) 2005 Novell
</I>&gt;<i>  //
</I>&gt;<i>  // Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i>  // a copy of this software and associated documentation files (the
</I>&gt;<i> @@ -34,7 +36,7 @@
</I>&gt;<i>  using System.Text;
</I>&gt;<i>  using System.Text.RegularExpressions;
</I>&gt;<i>
</I>&gt;<i> -using System.Data.SqlClient;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i> @@ -44,8 +46,8 @@
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class SqlDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected SqlConnection connection = null;
</I>&gt;<i> -               protected SqlDataAdapter adapter = new SqlDataAdapter();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i> @@ -53,21 +55,28 @@
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public SqlDbProvider () : base ()
</I>&gt;<i>                 {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> -               public override string ProviderName {
</I>&gt;<i> -                       get {
</I>&gt;<i> -                               return &quot;SQL Server Database&quot;;
</I>&gt;<i> -                       }
</I>&gt;<i> +
</I>&gt;<i> +               public SqlDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> +
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// Constructor with ADO.NET Sql connection.
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i> -               public SqlDbProvider (SqlConnection conn)
</I>&gt;<i> +               public SqlDbProvider (IDbConnection conn)
</I>&gt;<i>                 {
</I>&gt;<i>                         connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> +
</I>&gt;<i> +               public override string ProviderName {
</I>&gt;<i> +                       get {
</I>&gt;<i> +                               return &quot;Microsoft SQL Server Database&quot;;
</I>&gt;<i> +                       }
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// ADO.NET Connection
</I>&gt;<i> @@ -75,7 +84,7 @@
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 if (connection == null)
</I>&gt;<i> -                                       connection = new SqlConnection();
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i> @@ -167,8 +176,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL(string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               SqlCommand command = new SqlCommand();
</I>&gt;<i> -                               command.Connection = connection;
</I>&gt;<i> +                               IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i>                                 DataSet resultSet = new DataSet ();
</I>&gt;<i> @@ -194,8 +202,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       SqlCommand command = new SqlCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT su.name AS owner, so.name as table_name, so.id as table_id, &quot; +
</I>&gt;<i>                                 &quot; so.crdate as created_date, so.xtype as table_type &quot; +
</I>&gt;<i> @@ -203,7 +210,7 @@
</I>&gt;<i>                                 &quot;WHERE xtype IN ('S','U') &quot; +
</I>&gt;<i>                                 &quot;AND su.uid = so.uid &quot; +
</I>&gt;<i>                                 &quot;ORDER BY 1, 2&quot;;
</I>&gt;<i> -                       SqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 TableSchema table = new TableSchema();
</I>&gt;<i> @@ -259,10 +266,10 @@
</I>&gt;<i>                                 throw new InvalidOperationException (&quot;Invalid connection&quot;);
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i> -                       SqlConnection con2 = (SqlConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i> +                       IDbConnection con2 = (IDbConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i>                         if (con2.State == ConnectionState.Closed)
</I>&gt;<i>                                 con2.Open();
</I>&gt;<i> -                       SqlCommand command = con2.CreateCommand ();
</I>&gt;<i> +                       IDbCommand command = con2.CreateCommand ();
</I>&gt;<i>
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT su.name as owner, so.name as table_name, &quot; +
</I>&gt;<i> @@ -279,7 +286,7 @@
</I>&gt;<i>                                 &quot;AND sc.xusertype = st.xusertype &quot; +
</I>&gt;<i>                                 &quot;AND su.uid = so.uid &quot; +
</I>&gt;<i>                                 &quot;ORDER BY sc.colid&quot;;
</I>&gt;<i> -                       SqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -321,10 +328,10 @@
</I>&gt;<i>                 private string GetSource (string objectName)
</I>&gt;<i>                 {
</I>&gt;<i>                         string sql = String.Format (&quot;EXEC [master].[dbo].[sp_helptext] '{0}', null&quot;, objectName);
</I>&gt;<i> -                       SqlConnection con2 = (SqlConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i> +                       IDbConnection con2 = (IDbConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i>                         if (con2.State == ConnectionState.Closed)
</I>&gt;<i>                                 con2.Open();
</I>&gt;<i> -                       SqlCommand cmd = con2.CreateCommand ();
</I>&gt;<i> +                       IDbCommand cmd = con2.CreateCommand ();
</I>&gt;<i>                         cmd.CommandText = sql;
</I>&gt;<i>                         IDataReader reader = cmd.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i> @@ -352,8 +359,7 @@
</I>&gt;<i>                 {
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       SqlCommand command = new SqlCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT su.name AS owner, so.name as table_name, so.id as table_id, &quot; +
</I>&gt;<i>                                 &quot; so.crdate as created_date, so.xtype as table_type &quot; +
</I>&gt;<i> @@ -361,7 +367,7 @@
</I>&gt;<i>                                 &quot;WHERE xtype = 'V' &quot; +
</I>&gt;<i>                                 &quot;AND su.uid = so.uid &quot; +
</I>&gt;<i>                                 &quot;ORDER BY 1, 2&quot;;
</I>&gt;<i> -                       SqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ViewSchema view = new ViewSchema();
</I>&gt;<i> @@ -402,15 +408,15 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       SqlConnection con2 = (SqlConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i> +                       IDbConnection con2 = (IDbConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i>                         if (con2.State == ConnectionState.Closed)
</I>&gt;<i>                                 con2.Open();
</I>&gt;<i> -                       SqlCommand command = con2.CreateCommand ();
</I>&gt;<i> +                       IDbCommand command = con2.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT * &quot; +
</I>&gt;<i>                                 &quot; FROM &quot; + view.Name +
</I>&gt;<i>                                 &quot; WHERE 1 = 0&quot;;
</I>&gt;<i> -                       SqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         for (int i = 0; i &lt; r.FieldCount; i++) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -463,14 +469,14 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (SqlCommand cmd = connection.CreateCommand ()) {
</I>&gt;<i> +                       using (IDbCommand cmd = Connection.CreateCommand ()) {
</I>&gt;<i>                                 cmd.CommandText = &quot;SELECT su.name AS owner, so.name as proc_name, so.id as proc_id, &quot; +
</I>&gt;<i>                                         &quot; so.crdate as created_date, so.xtype as proc_type &quot; +
</I>&gt;<i>                                         &quot;FROM dbo.sysobjects so, dbo.sysusers su &quot; +
</I>&gt;<i>                                         &quot;WHERE xtype = 'P' &quot; +
</I>&gt;<i>                                         &quot;AND su.uid = so.uid &quot; +
</I>&gt;<i>                                         &quot;ORDER BY 1, 2&quot;;
</I>&gt;<i> -                               using (SqlDataReader reader = cmd.ExecuteReader ()) {
</I>&gt;<i> +                               using (IDataReader reader = cmd.ExecuteReader ()) {
</I>&gt;<i>                                         while (reader.Read ()) {
</I>&gt;<i>                                                 ProcedureSchema proc = new ProcedureSchema ();
</I>&gt;<i>                                                 proc.Provider = this;
</I>&gt;<i> @@ -486,10 +492,13 @@
</I>&gt;<i>                                 // get procedure text
</I>&gt;<i>                                 cmd.CommandType = CommandType.StoredProcedure;
</I>&gt;<i>                                 cmd.CommandText = &quot;sp_helptext&quot;;
</I>&gt;<i> -                               SqlParameter param = cmd.Parameters.Add (&quot;@objname&quot;, SqlDbType.VarChar);
</I>&gt;<i> +                               IDataParameter param = cmd.CreateParameter ();
</I>&gt;<i> +                               param.ParameterName = &quot;@objname&quot;;
</I>&gt;<i> +                               param.DbType = DbType.String;
</I>&gt;<i> +                               cmd.Parameters.Add (param);
</I>&gt;<i>                                 foreach (ProcedureSchema proc in collection) {
</I>&gt;<i>                                         param.Value = proc.Name;
</I>&gt;<i> -                                       using (SqlDataReader reader = cmd.ExecuteReader ()) {
</I>&gt;<i> +                                       using (IDataReader reader = cmd.ExecuteReader ()) {
</I>&gt;<i>                                                 if (reader.Read ())
</I>&gt;<i>                                                         proc.Definition = (string) reader [0];
</I>&gt;<i>                                         }
</I>&gt;<i> @@ -506,14 +515,23 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (SqlCommand cmd = connection.CreateCommand ()) {
</I>&gt;<i> +                       using (IDbCommand cmd = Connection.CreateCommand ()) {
</I>&gt;<i>                                 cmd.CommandType = CommandType.StoredProcedure;
</I>&gt;<i>                                 cmd.CommandText = &quot;sp_sproc_columns&quot;;
</I>&gt;<i> -                               SqlParameter owner = cmd.Parameters.Add (&quot;@procedure_owner&quot;, SqlDbType.VarChar);
</I>&gt;<i> -                               SqlParameter name = cmd.Parameters.Add (&quot;@procedure_name&quot;, SqlDbType.VarChar);
</I>&gt;<i> +
</I>&gt;<i> +                               IDataParameter owner = cmd.CreateParameter ();
</I>&gt;<i> +                               owner.ParameterName = &quot;@procedure_owner&quot;;
</I>&gt;<i> +                               owner.DbType = DbType.String;
</I>&gt;<i> +                               cmd.Parameters.Add (owner);
</I>&gt;<i> +
</I>&gt;<i> +                               IDataParameter name = cmd.CreateParameter ();
</I>&gt;<i> +                               name.ParameterName = &quot;@procedure_name&quot;;
</I>&gt;<i> +                               name.DbType = DbType.String;
</I>&gt;<i> +                               cmd.Parameters.Add (name);
</I>&gt;<i> +
</I>&gt;<i>                                 owner.Value = schema.OwnerName;
</I>&gt;<i>                                 name.Value = schema.Name;
</I>&gt;<i> -                               using (SqlDataReader reader = cmd.ExecuteReader ()) {
</I>&gt;<i> +                               using (IDataReader reader = cmd.ExecuteReader ()) {
</I>&gt;<i>                                         while (reader.Read ()) {
</I>&gt;<i>                                                 ColumnSchema column = new ColumnSchema ();
</I>&gt;<i>                                                 column.Provider = this;
</I>&gt;<i> @@ -529,3 +547,4 @@
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i>  }
</I>&gt;<i> +
</I>&gt;<i> Index: Mono.Data.Sql/Providers/SqliteDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/SqliteDbProvider.cs (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/SqliteDbProvider.cs (working copy)
</I>&gt;<i> @@ -31,27 +31,43 @@
</I>&gt;<i>  using System.Collections;
</I>&gt;<i>  using System.Data;
</I>&gt;<i>
</I>&gt;<i> -using Mono.Data.SqliteClient;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class SqliteDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected SqliteConnection connection = null;
</I>&gt;<i> -               protected SqliteDataAdapter adapter = new SqliteDataAdapter ();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i> +
</I>&gt;<i> +               public SqliteDbProvider () : base ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i> +               public SqliteDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public SqliteDbProvider (IDbConnection conn) : base ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i>                 public override string ProviderName {
</I>&gt;<i>                         get {
</I>&gt;<i> -                               return &quot;SQLite Database&quot;;
</I>&gt;<i> +                               return &quot;SQL Lite Database&quot;;
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 if (connection == null)
</I>&gt;<i> -                                       connection = new SqliteConnection ();
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i> @@ -115,7 +131,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL (string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               SqliteCommand command = new SqliteCommand ();
</I>&gt;<i> +                               IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                                 command.Connection = connection;
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i> @@ -144,11 +160,10 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (SqliteCommand command = new SqliteCommand ()) {
</I>&gt;<i> +                       using (IDbCommand command = Connection.CreateCommand ()) {
</I>&gt;<i>                                 command.CommandText = &quot;select * from sqlite_master&quot;;
</I>&gt;<i> -                               command.Connection = this.connection;
</I>&gt;<i>
</I>&gt;<i> -                               SqliteDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                               IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                                 while (r.Read ()) {
</I>&gt;<i>                                         TableSchema table = new TableSchema ();
</I>&gt;<i> @@ -171,11 +186,11 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (SqliteCommand command = new SqliteCommand()) {
</I>&gt;<i> +                       using (IDbCommand command = Connection.CreateCommand ()) {
</I>&gt;<i>                                 command.CommandText = &quot;PRAGMA table_info('&quot; +  table.Name + &quot;')&quot;;
</I>&gt;<i>                                 command.Connection = this.connection;
</I>&gt;<i>
</I>&gt;<i> -                               SqliteDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                               IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                                 while (r.Read ()) {
</I>&gt;<i>                                         ColumnSchema column = new ColumnSchema ();
</I>&gt;<i> @@ -207,3 +222,4 @@
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i>  }
</I>&gt;<i> +
</I>&gt;<i> Index: Mono.Data.Sql/Providers/MetaDataProviderFactory.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/MetaDataProviderFactory.cs  (revision 0)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/MetaDataProviderFactory.cs  (revision 0)
</I>&gt;<i> @@ -0,0 +1,153 @@
</I>&gt;<i> +//
</I>&gt;<i> +// Mono.Data.Sql.MetaDataProviderFactory
</I>&gt;<i> +//
</I>&gt;<i> +// Authors:
</I>&gt;<i> +//   Brian Ritchie (<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">brianlritchie at hotmail.com</A>)
</I>&gt;<i> +//   Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt;
</I>&gt;<i> +//
</I>&gt;<i> +//
</I>&gt;<i> +// Copyright (C) Brian Ritchie, 2002
</I>&gt;<i> +// Copyright (C) Daniel Morgan, 2006
</I>&gt;<i> +//
</I>&gt;<i> +
</I>&gt;<i> +//
</I>&gt;<i> +// Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i> +// a copy of this software and associated documentation files (the
</I>&gt;<i> +// &quot;Software&quot;), to deal in the Software without restriction, including
</I>&gt;<i> +// without limitation the rights to use, copy, modify, merge, publish,
</I>&gt;<i> +// distribute, sublicense, and/or sell copies of the Software, and to
</I>&gt;<i> +// permit persons to whom the Software is furnished to do so, subject to
</I>&gt;<i> +// the following conditions:
</I>&gt;<i> +//
</I>&gt;<i> +// The above copyright notice and this permission notice shall be
</I>&gt;<i> +// included in all copies or substantial portions of the Software.
</I>&gt;<i> +//
</I>&gt;<i> +// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</I>&gt;<i> +// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</I>&gt;<i> +// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</I>&gt;<i> +// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</I>&gt;<i> +// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</I>&gt;<i> +// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</I>&gt;<i> +// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</I>&gt;<i> +//
</I>&gt;<i> +
</I>&gt;<i> +using System;
</I>&gt;<i> +using System.Data;
</I>&gt;<i> +using System.Reflection;
</I>&gt;<i> +using System.Runtime.Remoting;
</I>&gt;<i> +using System.Configuration;
</I>&gt;<i> +using System.Xml;
</I>&gt;<i> +using System.Collections;
</I>&gt;<i> +using System.Collections.Specialized;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i> +
</I>&gt;<i> +namespace Mono.Data.Sql {
</I>&gt;<i> +       public class MetaDataProviderFactory {
</I>&gt;<i> +               private static DbProviderBase[] dbproviders;
</I>&gt;<i> +
</I>&gt;<i> +               static MetaDataProviderFactory()
</I>&gt;<i> +               {
</I>&gt;<i> +                       dbproviders = (DbProviderBase[]) ConfigurationSettings.GetConfig (&quot;mono.data.sql/metadataproviders&quot;);
</I>&gt;<i> +                       if (dbproviders == null) {
</I>&gt;<i> +                               dbproviders = new DbProviderBase[0];
</I>&gt;<i> +                               // warn the developer or administrator that the provider list is empty
</I>&gt;<i> +                               System.Diagnostics.Debug.Listeners.Add (new System.Diagnostics.TextWriterTraceListener (Console.Out));
</I>&gt;<i> +                               System.Diagnostics.Debug.WriteLine (&quot;No meta data providers found. Did you set up a mono.data.sql/metadataproviders area in your app.config or in machine.config?&quot;);
</I>&gt;<i> +                       }
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               static public DbProviderBase[] MetaDataProviders {
</I>&gt;<i> +                       get {
</I>&gt;<i> +                               return dbproviders;
</I>&gt;<i> +                       }
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               static public DbProviderBase GetMetaDataProvider (Provider provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       for (int p = 0; p &lt; MetaDataProviders.Length; p++)
</I>&gt;<i> +                               if (provider.Name.Equals(MetaDataProviders[p].Provider.Name))
</I>&gt;<i> +                                       return MetaDataProviders[p];
</I>&gt;<i> +
</I>&gt;<i> +                       return null;
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               static public Provider GetProvider (DbProviderBase dbprovider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       for (int p = 0; p &lt; MetaDataProviders.Length; p++) {
</I>&gt;<i> +                               DbProviderBase dbp = MetaDataProviders[p];
</I>&gt;<i> +
</I>&gt;<i> +                               if (dbp.GetType().ToString().Equals(dbprovider.GetType().ToString()))
</I>&gt;<i> +                                       return MetaDataProviders[p].Provider;
</I>&gt;<i> +                       }
</I>&gt;<i> +                       return null;
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               static public string GetProviderNameFromSetting (string Setting)
</I>&gt;<i> +               {
</I>&gt;<i> +                       string ConnectionString = ConfigurationSettings.AppSettings [Setting];
</I>&gt;<i> +                       string [] ConnectionAttributes = ConnectionString.Split (new Char [1] { ';' });
</I>&gt;<i> +                       string providerName = null;
</I>&gt;<i> +
</I>&gt;<i> +                       foreach (string s in ConnectionAttributes) {
</I>&gt;<i> +                               string [] AttributeParts = s.Split (new Char [1] { '=' });
</I>&gt;<i> +                               if (AttributeParts [0].ToLower ().Trim () == &quot;factory&quot;)
</I>&gt;<i> +                                       providerName = AttributeParts [1].Trim ();
</I>&gt;<i> +                       }
</I>&gt;<i> +                       return providerName;
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               static public Mono.Data.Provider GetProviderFromSetting (string Setting)
</I>&gt;<i> +               {
</I>&gt;<i> +                       string ConnectionString = ConfigurationSettings.AppSettings [Setting];
</I>&gt;<i> +                       string [] ConnectionAttributes = ConnectionString.Split (new Char [1] { ';' });
</I>&gt;<i> +                       string providerName = null;
</I>&gt;<i> +
</I>&gt;<i> +                       foreach (string s in ConnectionAttributes) {
</I>&gt;<i> +                               string [] AttributeParts = s.Split (new Char [1] { '=' });
</I>&gt;<i> +                               if (AttributeParts [0].ToLower ().Trim () == &quot;factory&quot;)
</I>&gt;<i> +                                       providerName = AttributeParts [1].Trim ();
</I>&gt;<i> +                       }
</I>&gt;<i> +                       Mono.Data.ProviderCollection pc = Mono.Data.ProviderFactory.Providers;
</I>&gt;<i> +                       Mono.Data.Provider provider = pc[providerName];
</I>&gt;<i> +                       return provider;
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               static public string GetConnectionStringFromSetting (string Setting)
</I>&gt;<i> +               {
</I>&gt;<i> +                       string ConnectionString = ConfigurationSettings.AppSettings [Setting];
</I>&gt;<i> +                       string [] ConnectionAttributes = ConnectionString.Split (new Char [1] { ';' });
</I>&gt;<i> +                       string NewConnectionString = &quot;&quot;;
</I>&gt;<i> +                       foreach (string s in ConnectionAttributes) {
</I>&gt;<i> +                               string [] AttributeParts = s.Split (new Char [1] { '=' });
</I>&gt;<i> +                               if (!AttributeParts [0].ToLower ().Trim ().Equals(&quot;factory&quot;))
</I>&gt;<i> +                                       NewConnectionString += &quot;;&quot; + s;
</I>&gt;<i> +                       }
</I>&gt;<i> +                       NewConnectionString = NewConnectionString.Remove (0, 1); // remove the initial semicolon
</I>&gt;<i> +                       return NewConnectionString;
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               static public DbProviderBase GetDbProviderBaseFromSetting (string Setting)
</I>&gt;<i> +               {
</I>&gt;<i> +                       string ConnectionString = ConfigurationSettings.AppSettings [Setting];
</I>&gt;<i> +                       string [] ConnectionAttributes = ConnectionString.Split (new Char [1] { ';' });
</I>&gt;<i> +                       string providerName = null;
</I>&gt;<i> +                       string NewConnectionString = &quot;&quot;;
</I>&gt;<i> +                       foreach (string s in ConnectionAttributes) {
</I>&gt;<i> +                               string [] AttributeParts = s.Split (new Char [1] { '=' });
</I>&gt;<i> +                               if (AttributeParts [0].ToLower ().Trim () == &quot;factory&quot;)
</I>&gt;<i> +                                       providerName = AttributeParts [1].Trim ();
</I>&gt;<i> +                               else
</I>&gt;<i> +                                       NewConnectionString += &quot;;&quot; + s;
</I>&gt;<i> +                       }
</I>&gt;<i> +                       NewConnectionString = NewConnectionString.Remove (0, 1); // remove the initial semicolon
</I>&gt;<i> +
</I>&gt;<i> +                       Mono.Data.ProviderCollection pc = Mono.Data.ProviderFactory.Providers;
</I>&gt;<i> +                       Mono.Data.Provider provider = pc[providerName];
</I>&gt;<i> +
</I>&gt;<i> +                       DbProviderBase dbprovider = GetMetaDataProvider(provider);
</I>&gt;<i> +                       dbprovider.ConnectionString = NewConnectionString;
</I>&gt;<i> +                       return dbprovider;
</I>&gt;<i> +               }
</I>&gt;<i> +       }
</I>&gt;<i> +}
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> Property changes on: Mono.Data.Sql/Providers/MetaDataProviderFactory.cs
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Name: svn:executable
</I>&gt;<i>    + *
</I>&gt;<i>
</I>&gt;<i> Index: Mono.Data.Sql/Providers/NpgsqlDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/NpgsqlDbProvider.cs (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/NpgsqlDbProvider.cs (working copy)
</I>&gt;<i> @@ -31,8 +31,9 @@
</I>&gt;<i>  using System.Data;
</I>&gt;<i>  using System.Text;
</I>&gt;<i>  using System.Text.RegularExpressions;
</I>&gt;<i> +using System.Reflection;
</I>&gt;<i>
</I>&gt;<i> -using Npgsql;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i> @@ -42,8 +43,8 @@
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class NpgsqlDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected NpgsqlConnection connection = null;
</I>&gt;<i> -               protected NpgsqlDataAdapter adapter = new NpgsqlDataAdapter();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i> @@ -51,7 +52,19 @@
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public NpgsqlDbProvider () : base ()
</I>&gt;<i>                 {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> +
</I>&gt;<i> +               public NpgsqlDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public NpgsqlDbProvider (IDbConnection conn) : base ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i>                 public override string ProviderName {
</I>&gt;<i>                         get {
</I>&gt;<i> @@ -60,20 +73,12 @@
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i> -               /// Constructor with ADO.NET Npgsql connection.
</I>&gt;<i> -               /// &lt;/summary&gt;
</I>&gt;<i> -               public NpgsqlDbProvider (NpgsqlConnection conn)
</I>&gt;<i> -               {
</I>&gt;<i> -                       connection = conn;
</I>&gt;<i> -               }
</I>&gt;<i> -
</I>&gt;<i> -               /// &lt;summary&gt;
</I>&gt;<i>                 /// ADO.NET Connection
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 if (connection == null)
</I>&gt;<i> -                                       connection = new NpgsqlConnection();
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i> @@ -119,8 +124,8 @@
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 protected int LastSystemOID {
</I>&gt;<i>                         get {
</I>&gt;<i> -                               int major = connection.ServerVersion.Major;
</I>&gt;<i> -                               int minor = connection.ServerVersion.Minor;
</I>&gt;<i> +                               int major = GetServerVersion ().Major;
</I>&gt;<i> +                               int minor = GetServerVersion ().Minor;
</I>&gt;<i>
</I>&gt;<i>                                 if (major == 8)
</I>&gt;<i>                                         return 17137;
</I>&gt;<i> @@ -136,6 +141,12 @@
</I>&gt;<i>                                         return 17137;
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i> +
</I>&gt;<i> +               public Version GetServerVersion ()
</I>&gt;<i> +               {
</I>&gt;<i> +                               PropertyInfo conPropertyInfo = Connection.GetType ().GetProperty (&quot;ServerVersion&quot;);
</I>&gt;<i> +                               return (Version) conPropertyInfo.GetValue (Connection, null);
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// Open the connection. Returns true on success.
</I>&gt;<i> @@ -205,8 +216,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL(string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               NpgsqlCommand command = new NpgsqlCommand();
</I>&gt;<i> -                               command.Connection = connection;
</I>&gt;<i> +                               IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i>                                 DataSet resultSet = new DataSet ();
</I>&gt;<i> @@ -232,8 +242,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT c.relname, n.nspname, u.usename, d.description &quot;
</I>&gt;<i>                                 + &quot;FROM pg_class c &quot;
</I>&gt;<i> @@ -245,7 +254,7 @@
</I>&gt;<i>                                 + &quot;   (SELECT 1 FROM pg_rewrite r &quot;
</I>&gt;<i>                                 + &quot;      WHERE r.ev_class = c.oid AND r.ev_type = '1') &quot;
</I>&gt;<i>                                 + &quot;ORDER BY relname;&quot;;
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 TableSchema table = new TableSchema();
</I>&gt;<i> @@ -304,8 +313,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText = &quot;SELECT a.attname, a.attnotnull, a.attlen, &quot;
</I>&gt;<i>                                 + &quot;typ.typname, adef.adsrc &quot;
</I>&gt;<i>                                 + &quot;FROM &quot;
</I>&gt;<i> @@ -321,7 +329,7 @@
</I>&gt;<i>                                 + &quot;AND a.attnum &gt; 0 AND NOT a.attisdropped &quot;
</I>&gt;<i>                                 + &quot;AND a.atttypid = typ.oid &quot;
</I>&gt;<i>                                 + &quot;ORDER BY a.attnum;&quot;;
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -361,8 +369,7 @@
</I>&gt;<i>                 {
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT v.schemaname, v.viewname, v.viewowner, v.definition,&quot;
</I>&gt;<i>                                 + &quot; (c.oid &lt;= &quot; + LastSystemOID + &quot;), &quot;
</I>&gt;<i> @@ -372,7 +379,7 @@
</I>&gt;<i>                                 + &quot;FROM pg_views v, pg_class c &quot;
</I>&gt;<i>                                 + &quot;WHERE v.viewname = c.relname &quot;
</I>&gt;<i>                                 + &quot;ORDER BY viewname&quot;;
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ViewSchema view = new ViewSchema();
</I>&gt;<i> @@ -414,7 +421,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand ();
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.Connection = connection;
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT attname, typname, attlen, attnotnull &quot;
</I>&gt;<i> @@ -428,7 +435,7 @@
</I>&gt;<i>                                 + view.Name + &quot;') &quot;
</I>&gt;<i>                                 + &quot;  AND a.attnum &gt; 0 AND NOT a.attisdropped &quot;
</I>&gt;<i>                                 + &quot;     ORDER BY a.attnum;&quot;;
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -463,8 +470,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand ();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText = String.Format (
</I>&gt;<i>                                 &quot;SELECT &quot;
</I>&gt;<i>                                 + &quot;pc.conname, &quot;
</I>&gt;<i> @@ -493,7 +499,7 @@
</I>&gt;<i>                                 + &quot;     WHERE nspname='{1}')) &quot;
</I>&gt;<i>                                 + &quot;ORDER BY &quot;
</I>&gt;<i>                                 + &quot;1;&quot;, table.Name, table.SchemaName);
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read ()) {
</I>&gt;<i>                                 ConstraintSchema constraint = null;
</I>&gt;<i> @@ -534,10 +540,9 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand ();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText = &quot;SELECT * FROM pg_user;&quot;;
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read ()) {
</I>&gt;<i>                                 UserSchema user = new UserSchema ();
</I>&gt;<i> @@ -583,8 +588,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand ();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                   &quot;SELECT pc.proname, pc.oid::integer, pl.lanname, pc.prosrc &quot;
</I>&gt;<i>                                 + &quot;FROM &quot;
</I>&gt;<i> @@ -605,7 +609,7 @@
</I>&gt;<i>                                 + &quot;WHERE pc.proowner = pu.usesysid &quot;
</I>&gt;<i>                                 + &quot;AND pc.prorettype = 0 &quot;
</I>&gt;<i>                                 + &quot;AND pc.prolang = pl.oid;&quot;;
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read ()) {
</I>&gt;<i>                                 ProcedureSchema procedure = new ProcedureSchema ();
</I>&gt;<i> @@ -638,14 +642,13 @@
</I>&gt;<i>                         // FIXME: Won't work properly with overload functions.
</I>&gt;<i>                         // Maybe check the number of columns in the parameters for
</I>&gt;<i>                         // proper match.
</I>&gt;<i> -                       NpgsqlCommand command = new NpgsqlCommand ();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText = String.Format (
</I>&gt;<i>                                   &quot;SELECT format_type (prorettype, NULL) &quot;
</I>&gt;<i>                                 + &quot;FROM pg_proc pc, pg_language pl &quot;
</I>&gt;<i>                                 + &quot;WHERE pc.prolang = pl.oid &quot;
</I>&gt;<i>                                 + &quot;AND pc.proname = '{0}';&quot;, schema.Name);
</I>&gt;<i> -                       NpgsqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read ()) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema ();
</I>&gt;<i> @@ -663,3 +666,4 @@
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i>  }
</I>&gt;<i> +
</I>&gt;<i> Index: Mono.Data.Sql/Providers/MySqlDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/MySqlDbProvider.cs  (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/MySqlDbProvider.cs  (working copy)
</I>&gt;<i> @@ -30,17 +30,35 @@
</I>&gt;<i>  using System.Collections;
</I>&gt;<i>  using System.Data;
</I>&gt;<i>
</I>&gt;<i> -using ByteFX.Data.MySqlClient;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class MySqlDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected MySqlConnection connection = null;
</I>&gt;<i> -               protected MySqlDataAdapter adapter = new MySqlDataAdapter ();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i> +
</I>&gt;<i> +               public MySqlDbProvider () : base ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +               public MySqlDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public MySqlDbProvider (IDbConnection conn) : base ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i> +
</I>&gt;<i>                 public override string ProviderName {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 return &quot;MySQL Database&quot;;
</I>&gt;<i> @@ -50,7 +68,7 @@
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 if (connection == null)
</I>&gt;<i> -                                       connection = new MySqlConnection ();
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i> @@ -115,8 +133,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL (string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               MySqlCommand command = new MySqlCommand ();
</I>&gt;<i> -                               command.Connection = Connection;
</I>&gt;<i> +                               IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i>                                 DataSet resultSet = null;
</I>&gt;<i> @@ -139,11 +156,10 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (MySqlCommand command = new MySqlCommand ()) {
</I>&gt;<i> -                               command.Connection = Connection;
</I>&gt;<i> +                       using (IDbCommand command = Connection.CreateCommand ()) {
</I>&gt;<i>                                 command.CommandText =
</I>&gt;<i>                                         &quot;SHOW TABLES;&quot;;
</I>&gt;<i> -                               MySqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                               IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                                 while (r.Read ()) {
</I>&gt;<i>                                         TableSchema table = new TableSchema ();
</I>&gt;<i> @@ -167,13 +183,12 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (MySqlCommand command = new MySqlCommand ()) {
</I>&gt;<i> -                               command.Connection = Connection;
</I>&gt;<i> +                       using (IDbCommand command = Connection.CreateCommand()) {
</I>&gt;<i>
</I>&gt;<i>                                 // XXX: Use String.Format cause mysql parameters suck assmar.
</I>&gt;<i>                                 command.CommandText =
</I>&gt;<i>                                         String.Format (&quot;DESCRIBE {0}&quot;, table.Name);
</I>&gt;<i> -                               MySqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                               IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                                 while (r.Read ()) {
</I>&gt;<i>                                         ColumnSchema column = new ColumnSchema ();
</I>&gt;<i> @@ -201,11 +216,9 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (MySqlCommand command = new MySqlCommand ()) {
</I>&gt;<i> -                               command.Connection = Connection;
</I>&gt;<i> -                               command.CommandText =
</I>&gt;<i> -                                       &quot;&quot;;
</I>&gt;<i> -                               MySqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                       using (IDbCommand command = Connection.CreateCommand ()) {
</I>&gt;<i> +                               command.CommandText = &quot;&quot;;
</I>&gt;<i> +                               IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                                 while (r.Read ()) {
</I>&gt;<i>                                         ConstraintSchema constraint = new ConstraintSchema ();
</I>&gt;<i> @@ -230,11 +243,10 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       using (MySqlCommand command = new MySqlCommand ()) {
</I>&gt;<i> -                               command.Connection = connection;
</I>&gt;<i> +                       using (IDbCommand command = Connection.CreateCommand ()) {
</I>&gt;<i>                                 command.CommandText =
</I>&gt;<i>                                         &quot;SELECT DISTINCT user from mysql.user where user != '';&quot;;
</I>&gt;<i> -                               MySqlDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                               IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                                 while (r.Read ()) {
</I>&gt;<i>                                         UserSchema user = new UserSchema ();
</I>&gt;<i> @@ -251,3 +263,4 @@
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i>  }
</I>&gt;<i> +
</I>&gt;<i> Index: Mono.Data.Sql/Providers/OracleDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/OracleDbProvider.cs (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/OracleDbProvider.cs (working copy)
</I>&gt;<i> @@ -6,7 +6,7 @@
</I>&gt;<i>  //   Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt;
</I>&gt;<i>  //
</I>&gt;<i>  // Copyright (C) 2005 Mosaix Communications, Inc.
</I>&gt;<i> -// Copyright (C) 2005 Daniel Morgan
</I>&gt;<i> +// Copyright (C) 2005, 2006 Daniel Morgan
</I>&gt;<i>  //
</I>&gt;<i>  // Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i>  // a copy of this software and associated documentation files (the
</I>&gt;<i> @@ -34,8 +34,6 @@
</I>&gt;<i>  using System.Text;
</I>&gt;<i>  using System.Text.RegularExpressions;
</I>&gt;<i>
</I>&gt;<i> -using System.Data.OracleClient;
</I>&gt;<i> -
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i>         /// &lt;summary&gt;
</I>&gt;<i> @@ -44,29 +42,41 @@
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class OracleDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected OracleConnection connection = null;
</I>&gt;<i> -               protected OracleDataAdapter adapter = new OracleDataAdapter();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i>
</I>&gt;<i> +               public OracleDbProvider () : base ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public OracleDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public OracleDbProvider (IDbConnection conn) : base ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i>                 public override string ProviderName {
</I>&gt;<i>                         get {
</I>&gt;<i> -                               return &quot;Oracle 8i/9i/10g&quot;;
</I>&gt;<i> +                               return &quot;Oracle&quot;;
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> -               /// &lt;summary&gt;
</I>&gt;<i> -               /// ADO.NET Connection
</I>&gt;<i> -               /// &lt;/summary&gt;
</I>&gt;<i> +
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i> -                               if (connection == null) {
</I>&gt;<i> -                                       connection = new OracleConnection();
</I>&gt;<i> -                               }
</I>&gt;<i> +                               if (connection == null)
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> +
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// Connection String
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i> @@ -153,8 +163,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL(string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               OracleCommand command = new OracleCommand();
</I>&gt;<i> -                               command.Connection = connection;
</I>&gt;<i> +                               IDbCommand command = connection.CreateCommand();
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i>                                 DataSet resultSet = new DataSet ();
</I>&gt;<i> @@ -196,13 +205,12 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       OracleCommand command = new OracleCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = connection.CreateCommand();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT OWNER, TABLE_NAME, TABLESPACE_NAME &quot; +
</I>&gt;<i>                                 &quot;FROM ALL_TABLES &quot; +
</I>&gt;<i>                                 &quot;ORDER BY OWNER, TABLE_NAME&quot;;
</I>&gt;<i> -                       OracleDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 TableSchema table = new TableSchema();
</I>&gt;<i> @@ -263,9 +271,8 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       OracleCommand command = new OracleCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> -                       command.CommandText =
</I>&gt;<i> +                       IDbCommand command = connection.CreateCommand();
</I>&gt;<i> +                       command.CommandText =
</I>&gt;<i>                                 &quot;SELECT OWNER, TABLE_NAME, COLUMN_NAME, &quot; +
</I>&gt;<i>                                 &quot;       DATA_TYPE, DATA_LENGTH, DATA_PRECISION, DATA_SCALE, &quot; +
</I>&gt;<i>                                 &quot;       NULLABLE, COLUMN_ID, DEFAULT_LENGTH, DATA_DEFAULT &quot; +
</I>&gt;<i> @@ -273,7 +280,7 @@
</I>&gt;<i>                                 &quot;WHERE OWNER = '&quot; + table.OwnerName + &quot;' &quot; +
</I>&gt;<i>                                 &quot;AND TABLE_NAME = '&quot; + table.Name + &quot;' &quot; +
</I>&gt;<i>                                 &quot;ORDER BY OWNER, TABLE_NAME, COLUMN_ID&quot;;
</I>&gt;<i> -                       OracleDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -320,13 +327,12 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       OracleCommand command = new OracleCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = connection.CreateCommand();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT OWNER, VIEW_NAME, TEXT &quot; +
</I>&gt;<i>                                 &quot;FROM ALL_VIEWS &quot; +
</I>&gt;<i>                                 &quot;ORDER BY OWNER, VIEW_NAME&quot;;
</I>&gt;<i> -                       OracleDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ViewSchema view = new ViewSchema();
</I>&gt;<i> @@ -358,13 +364,12 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       OracleCommand command = new OracleCommand ();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = connection.CreateCommand();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT * &quot; +
</I>&gt;<i>                                 &quot; FROM &quot; + view.Name +
</I>&gt;<i>                                 &quot; WHERE 1 = 0&quot;;
</I>&gt;<i> -                       OracleDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         for (int i = 0; i &lt; r.FieldCount; i++) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -392,8 +397,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       OracleCommand command = new OracleCommand ();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = connection.CreateCommand();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT k.owner, k.table_name, k.constraint_name, &quot; +
</I>&gt;<i>                                 &quot;       k.constraint_type, k.status, k.validated &quot; +
</I>&gt;<i> @@ -401,7 +405,7 @@
</I>&gt;<i>                                 &quot;WHERE k.owner = '&quot; + table.OwnerName + &quot;' &quot; +
</I>&gt;<i>                                 &quot;AND k.table_name = '&quot; + table.Name + &quot;' &quot; +
</I>&gt;<i>                                 &quot;and k.constraint_type = 'P'&quot;;
</I>&gt;<i> -                       OracleDataReader r = command.ExecuteReader ();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read ()) {
</I>&gt;<i>                                 ConstraintSchema constraint = null;
</I>&gt;<i> Index: Mono.Data.Sql/Providers/FirebirdDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/FirebirdDbProvider.cs       (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/FirebirdDbProvider.cs       (working copy)
</I>&gt;<i> @@ -6,7 +6,7 @@
</I>&gt;<i>  //   Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt;
</I>&gt;<i>  //
</I>&gt;<i>  // Copyright (C) 2005 Mosaix Communications, Inc.
</I>&gt;<i> -// Copyright (C) 2005 Daniel Morgan
</I>&gt;<i> +// Copyright (C) 2005, 2006 Daniel Morgan
</I>&gt;<i>  //
</I>&gt;<i>  // Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i>  // a copy of this software and associated documentation files (the
</I>&gt;<i> @@ -33,8 +33,9 @@
</I>&gt;<i>  using System.Data;
</I>&gt;<i>  using System.Text;
</I>&gt;<i>  using System.Text.RegularExpressions;
</I>&gt;<i> +using System.Reflection;
</I>&gt;<i>
</I>&gt;<i> -using FirebirdSql.Data.Firebird;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i> @@ -44,17 +45,31 @@
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class FirebirdDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected FbConnection connection = null;
</I>&gt;<i> -               protected FbDataAdapter adapter = new FbDataAdapter();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i> +
</I>&gt;<i> +               static MethodInfo schemaMethod = null;
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// Default Constructor
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public FirebirdDbProvider () : base ()
</I>&gt;<i>                 {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> +
</I>&gt;<i> +               public FirebirdDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +               public FirebirdDbProvider (IDbConnection conn)
</I>&gt;<i> +               {
</I>&gt;<i> +                       connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i>                 public override string ProviderName {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 return &quot;Firebird Database&quot;;
</I>&gt;<i> @@ -62,20 +77,12 @@
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i> -               /// Constructor with ADO.NET Npgsql connection.
</I>&gt;<i> -               /// &lt;/summary&gt;
</I>&gt;<i> -               public FirebirdDbProvider (FbConnection conn)
</I>&gt;<i> -               {
</I>&gt;<i> -                       connection = conn;
</I>&gt;<i> -               }
</I>&gt;<i> -
</I>&gt;<i> -               /// &lt;summary&gt;
</I>&gt;<i>                 /// ADO.NET Connection
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 if (connection == null)
</I>&gt;<i> -                                       connection = new FbConnection();
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i> @@ -183,8 +190,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL(string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               FbCommand command = new FbCommand();
</I>&gt;<i> -                               command.Connection = connection;
</I>&gt;<i> +                               IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i>                                 DataSet resultSet = new DataSet ();
</I>&gt;<i> @@ -210,7 +216,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       DataTable dataTable = connection.GetSchema (&quot;Tables&quot;, new string[] {null, null, null, &quot;TABLE&quot;});
</I>&gt;<i> +                       DataTable dataTable = GetSchema (&quot;Tables&quot;, new string[] {null, null, null, &quot;TABLE&quot;});
</I>&gt;<i>
</I>&gt;<i>                         for (int r = 0; r &lt; dataTable.Rows.Count; r++) {
</I>&gt;<i>                                 DataRow row = dataTable.Rows[r];
</I>&gt;<i> @@ -268,7 +274,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       DataTable table2 = connection.GetSchema (&quot;Columns&quot;, new string[] {null, null, table.Name, null});
</I>&gt;<i> +                       DataTable table2 = GetSchema (&quot;Columns&quot;, new string[] {null, null, table.Name, null});
</I>&gt;<i>                         for (int r = 0; r &lt; table2.Rows.Count; r++) {
</I>&gt;<i>                                 DataRow row2 = table2.Rows[r];
</I>&gt;<i>
</I>&gt;<i> @@ -336,7 +342,7 @@
</I>&gt;<i>                 {
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       DataTable table2 = connection.GetSchema (&quot;Views&quot;, new string[] {null, null, null});
</I>&gt;<i> +                       DataTable table2 = GetSchema (&quot;Views&quot;, new string[] {null, null, null});
</I>&gt;<i>                         for (int r = 0; r &lt; table2.Rows.Count; r++) {
</I>&gt;<i>                                 DataRow row2 = table2.Rows[r];
</I>&gt;<i>                                 string viewName = row2[&quot;VIEW_NAME&quot;].ToString();
</I>&gt;<i> @@ -414,7 +420,7 @@
</I>&gt;<i>
</I>&gt;<i>                         DataTable table2 = null;
</I>&gt;<i>                         DataRow row2 = null;
</I>&gt;<i> -                       table2 = connection.GetSchema (&quot;Procedures&quot;, new string[] {null, null, null});
</I>&gt;<i> +                       table2 = GetSchema (&quot;Procedures&quot;, new string[] {null, null, null});
</I>&gt;<i>                         for (int r = 0; r &lt; table2.Rows.Count; r++) {
</I>&gt;<i>                                 row2 = table2.Rows[r];
</I>&gt;<i>                                 ProcedureSchema procedure = new ProcedureSchema ();
</I>&gt;<i> @@ -428,7 +434,7 @@
</I>&gt;<i>                         }
</I>&gt;<i>                         table2 = null;
</I>&gt;<i>
</I>&gt;<i> -                       table2 = connection.GetSchema (&quot;Functions&quot;, new string[] {null, null, null, null});
</I>&gt;<i> +                       table2 = GetSchema (&quot;Functions&quot;, new string[] {null, null, null, null});
</I>&gt;<i>                         for (int r = 0; r &lt; table2.Rows.Count; r++) {
</I>&gt;<i>                                 row2 = table2.Rows[r];
</I>&gt;<i>                                 ProcedureSchema procedure = new ProcedureSchema ();
</I>&gt;<i> @@ -456,5 +462,37 @@
</I>&gt;<i>
</I>&gt;<i>                         return (ColumnSchema[]) collection.ToArray (typeof (ColumnSchema));
</I>&gt;<i>                 }
</I>&gt;<i> +
</I>&gt;<i> +               public DataTable GetSchema (string sCollectionName, string[] sRestrictions)
</I>&gt;<i> +               {
</I>&gt;<i> +                       if (schemaMethod == null) {
</I>&gt;<i> +                               // get the proper GetSchema method on the FbConnection object
</I>&gt;<i> +                               MethodInfo [] conMethodInfo = Connection.GetType ().GetMethods ();
</I>&gt;<i> +
</I>&gt;<i> +                               for (int m = 0; m &lt; conMethodInfo.Length; m++) {
</I>&gt;<i> +                                       if (conMethodInfo[m].Name.Equals (&quot;GetSchema&quot;)) {
</I>&gt;<i> +                                               ParameterInfo[] parms = conMethodInfo[m].GetParameters ();
</I>&gt;<i> +
</I>&gt;<i> +                                               if (parms.Length == 2) {
</I>&gt;<i> +                                                       if (parms[0].ParameterType.ToString ().Equals (&quot;System.String&quot;) &amp;&amp;
</I>&gt;<i> +                                                               parms[1].ParameterType.ToString ().Equals (&quot;System.String[]&quot;)) {
</I>&gt;<i> +                                                               schemaMethod = conMethodInfo [m];
</I>&gt;<i> +                                                               m = conMethodInfo.Length;
</I>&gt;<i> +                                                       }
</I>&gt;<i> +                                               }
</I>&gt;<i> +                                       }
</I>&gt;<i> +                               }
</I>&gt;<i> +                       }
</I>&gt;<i> +
</I>&gt;<i> +                       object parm0 = (object) sCollectionName;
</I>&gt;<i> +                       object parm1 = (object) sRestrictions;
</I>&gt;<i> +
</I>&gt;<i> +                       object[] oParms = new object[2];
</I>&gt;<i> +                       oParms[0] = parm0;
</I>&gt;<i> +                       oParms[1] = parm1;
</I>&gt;<i> +
</I>&gt;<i> +                       // invoke GetSchema method
</I>&gt;<i> +                       return (DataTable) schemaMethod.Invoke (Connection, oParms);
</I>&gt;<i> +               }
</I>&gt;<i>         }
</I>&gt;<i>  }
</I>&gt;<i> Index: Mono.Data.Sql/Providers/SybaseDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/SybaseDbProvider.cs (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/SybaseDbProvider.cs (working copy)
</I>&gt;<i> @@ -5,7 +5,7 @@
</I>&gt;<i>  //   Christian Hergert &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">chris at mosaix.net</A>&gt;
</I>&gt;<i>  //   Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt;
</I>&gt;<i>  //
</I>&gt;<i> -// Copyright (C) 2005 Mosaix Communications, Inc.
</I>&gt;<i> +// Copyright (C) 2005, 2006 Mosaix Communications, Inc.
</I>&gt;<i>  //
</I>&gt;<i>  // Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i>  // a copy of this software and associated documentation files (the
</I>&gt;<i> @@ -33,7 +33,7 @@
</I>&gt;<i>  using System.Text;
</I>&gt;<i>  using System.Text.RegularExpressions;
</I>&gt;<i>
</I>&gt;<i> -using Mono.Data.SybaseClient;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i> @@ -43,8 +43,8 @@
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class SybaseDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected SybaseConnection connection = null;
</I>&gt;<i> -               protected SybaseDataAdapter adapter = new SybaseDataAdapter();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i> @@ -52,21 +52,28 @@
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public SybaseDbProvider () : base ()
</I>&gt;<i>                 {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> -               public override string ProviderName {
</I>&gt;<i> -                       get {
</I>&gt;<i> -                               return &quot;Sybase ASE Database&quot;;
</I>&gt;<i> -                       }
</I>&gt;<i> +
</I>&gt;<i> +               public SybaseDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> +
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// Constructor with ADO.NET Sql connection.
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i> -               public SybaseDbProvider (SybaseConnection conn)
</I>&gt;<i> +               public SybaseDbProvider (IDbConnection conn)
</I>&gt;<i>                 {
</I>&gt;<i>                         connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> +
</I>&gt;<i> +               public override string ProviderName {
</I>&gt;<i> +                       get {
</I>&gt;<i> +                               return &quot;Sybase ASE Database&quot;;
</I>&gt;<i> +                       }
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// ADO.NET Connection
</I>&gt;<i> @@ -74,7 +81,7 @@
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 if (connection == null)
</I>&gt;<i> -                                       connection = new SybaseConnection();
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i> @@ -166,7 +173,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL(string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               SybaseCommand command = new SybaseCommand();
</I>&gt;<i> +                               IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                                 command.Connection = connection;
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i> @@ -193,8 +200,7 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList ();
</I>&gt;<i>
</I>&gt;<i> -                       SybaseCommand command = new SybaseCommand();
</I>&gt;<i> -                       command.Connection = connection;
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT su.name AS owner, so.name as table_name, so.id as table_id, &quot; +
</I>&gt;<i>                                 &quot; so.crdate as created_date, so.type as table_type &quot; +
</I>&gt;<i> @@ -202,7 +208,7 @@
</I>&gt;<i>                                 &quot;WHERE type IN ('S','U') &quot; +
</I>&gt;<i>                                 &quot;AND su.uid = so.uid &quot; +
</I>&gt;<i>                                 &quot;ORDER BY 1, 2&quot;;
</I>&gt;<i> -                       SybaseDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 TableSchema table = new TableSchema();
</I>&gt;<i> @@ -258,10 +264,10 @@
</I>&gt;<i>                                 throw new InvalidOperationException (&quot;Invalid connection&quot;);
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i> -                       SybaseConnection con2 = (SybaseConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i> +                       IDbConnection con2 = (IDbConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i>                         if (con2.State == ConnectionState.Closed)
</I>&gt;<i>                                 con2.Open();
</I>&gt;<i> -                       SybaseCommand command = con2.CreateCommand ();
</I>&gt;<i> +                       IDbCommand command = con2.CreateCommand ();
</I>&gt;<i>
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;select su.name as owner, so.name as table_name, sc.name as column_name,  &quot; +
</I>&gt;<i> @@ -278,7 +284,7 @@
</I>&gt;<i>                                         &quot;and sc.usertype = st.usertype &quot; +
</I>&gt;<i>                                         &quot;order by sc.colid&quot;;
</I>&gt;<i>
</I>&gt;<i> -                       SybaseDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -320,10 +326,10 @@
</I>&gt;<i>                 private string GetSource (string objectName)
</I>&gt;<i>                 {
</I>&gt;<i>                         string sql = String.Format (&quot;EXEC [master].[dbo].[sp_helptext] '{0}', null&quot;, objectName);
</I>&gt;<i> -                       SybaseConnection con2 = (SybaseConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i> +                       IDbConnection con2 = (IDbConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i>                         if (con2.State == ConnectionState.Closed)
</I>&gt;<i>                                 con2.Open();
</I>&gt;<i> -                       SybaseCommand cmd = con2.CreateCommand ();
</I>&gt;<i> +                       IDbCommand cmd = con2.CreateCommand ();
</I>&gt;<i>                         cmd.CommandText = sql;
</I>&gt;<i>                         IDataReader reader = cmd.ExecuteReader ();
</I>&gt;<i>
</I>&gt;<i> @@ -351,7 +357,7 @@
</I>&gt;<i>                 {
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       SybaseCommand command = new SybaseCommand();
</I>&gt;<i> +                       IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                         command.Connection = connection;
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT su.name AS owner, so.name as table_name, so.id as table_id, &quot; +
</I>&gt;<i> @@ -360,7 +366,7 @@
</I>&gt;<i>                                 &quot;WHERE type = 'V' &quot; +
</I>&gt;<i>                                 &quot;AND su.uid = so.uid &quot; +
</I>&gt;<i>                                 &quot;ORDER BY 1, 2&quot;;
</I>&gt;<i> -                       SybaseDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         while (r.Read()) {
</I>&gt;<i>                                 ViewSchema view = new ViewSchema();
</I>&gt;<i> @@ -401,15 +407,15 @@
</I>&gt;<i>
</I>&gt;<i>                         ArrayList collection = new ArrayList();
</I>&gt;<i>
</I>&gt;<i> -                       SybaseConnection con2 = (SybaseConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i> +                       IDbConnection con2 = (IDbConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i>                         if (con2.State == ConnectionState.Closed)
</I>&gt;<i>                                 con2.Open();
</I>&gt;<i> -                       SybaseCommand command = con2.CreateCommand ();
</I>&gt;<i> +                       IDbCommand command = con2.CreateCommand ();
</I>&gt;<i>                         command.CommandText =
</I>&gt;<i>                                 &quot;SELECT * &quot; +
</I>&gt;<i>                                 &quot; FROM &quot; + view.Name +
</I>&gt;<i>                                 &quot; WHERE 1 = 0&quot;;
</I>&gt;<i> -                       SybaseDataReader r = command.ExecuteReader();
</I>&gt;<i> +                       IDataReader r = command.ExecuteReader();
</I>&gt;<i>
</I>&gt;<i>                         for (int i = 0; i &lt; r.FieldCount; i++) {
</I>&gt;<i>                                 ColumnSchema column = new ColumnSchema();
</I>&gt;<i> @@ -442,9 +448,9 @@
</I>&gt;<i>
</I>&gt;<i>  //                     ArrayList collection = new ArrayList ();
</I>&gt;<i>  //
</I>&gt;<i> -//                     SybaseConnection con2 = (SybaseConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i> +//                     IDbConnection con2 = (IDbConnection) (((ICloneable) connection).Clone ());
</I>&gt;<i>  //                     con2.Open();
</I>&gt;<i> -//                     SybaseCommand command = con2.CreateCommand ();
</I>&gt;<i> +//                     IDbCommand command = con2.CreateCommand ();
</I>&gt;<i>
</I>&gt;<i>                         // TODO: get constraints
</I>&gt;<i>                         return new ConstraintSchema[0];
</I>&gt;<i> @@ -461,3 +467,4 @@
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i>  }
</I>&gt;<i> +
</I>&gt;<i> Index: Mono.Data.Sql/Providers/OdbcDbProvider.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Providers/OdbcDbProvider.cs   (revision 57083)
</I>&gt;<i> +++ Mono.Data.Sql/Providers/OdbcDbProvider.cs   (working copy)
</I>&gt;<i> @@ -6,7 +6,7 @@
</I>&gt;<i>  //   Daniel Morgan &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">danielmorgan at verizon.net</A>&gt;
</I>&gt;<i>  //
</I>&gt;<i>  // Copyright (C) 2005 Mosaix Communications, Inc.
</I>&gt;<i> -// Copyright (C) 2005 Daniel Morgan
</I>&gt;<i> +// Copyright (C) 2005, 2006 Daniel Morgan
</I>&gt;<i>  //
</I>&gt;<i>  // Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i>  // a copy of this software and associated documentation files (the
</I>&gt;<i> @@ -34,7 +34,7 @@
</I>&gt;<i>  using System.Text;
</I>&gt;<i>  using System.Text.RegularExpressions;
</I>&gt;<i>
</I>&gt;<i> -using System.Data.Odbc;
</I>&gt;<i> +using Mono.Data;
</I>&gt;<i>
</I>&gt;<i>  namespace Mono.Data.Sql
</I>&gt;<i>  {
</I>&gt;<i> @@ -44,8 +44,8 @@
</I>&gt;<i>         [Serializable]
</I>&gt;<i>         public class OdbcDbProvider : DbProviderBase
</I>&gt;<i>         {
</I>&gt;<i> -               protected OdbcConnection connection = null;
</I>&gt;<i> -               protected OdbcDataAdapter adapter = new OdbcDataAdapter();
</I>&gt;<i> +               protected IDbConnection connection = null;
</I>&gt;<i> +               protected IDbDataAdapter adapter;
</I>&gt;<i>                 protected bool isConnectionStringWrong = false;
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i> @@ -53,21 +53,28 @@
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public OdbcDbProvider () : base ()
</I>&gt;<i>                 {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> -               public override string ProviderName {
</I>&gt;<i> -                       get {
</I>&gt;<i> -                               return &quot;Provider for ODBC Data Sources&quot;;
</I>&gt;<i> -                       }
</I>&gt;<i> +
</I>&gt;<i> +               public OdbcDbProvider (Mono.Data.Provider provider) : base (provider)
</I>&gt;<i> +               {
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> -
</I>&gt;<i> +
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// Constructor with ADO.NET ODBC connection.
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i> -               public OdbcDbProvider (OdbcConnection conn)
</I>&gt;<i> +               public OdbcDbProvider (IDbConnection conn)
</I>&gt;<i>                 {
</I>&gt;<i>                         connection = conn;
</I>&gt;<i> +                       adapter = Provider.CreateDataAdapter ();
</I>&gt;<i>                 }
</I>&gt;<i> +
</I>&gt;<i> +               public override string ProviderName {
</I>&gt;<i> +                       get {
</I>&gt;<i> +                               return &quot;Provider for ODBC Data Sources&quot;;
</I>&gt;<i> +                       }
</I>&gt;<i> +               }
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i>                 /// ADO.NET Connection
</I>&gt;<i> @@ -75,7 +82,7 @@
</I>&gt;<i>                 public override IDbConnection Connection {
</I>&gt;<i>                         get {
</I>&gt;<i>                                 if (connection == null)
</I>&gt;<i> -                                       connection = new OdbcConnection();
</I>&gt;<i> +                                       connection = Provider.CreateConnection ();
</I>&gt;<i>
</I>&gt;<i>                                 return (IDbConnection) connection;
</I>&gt;<i>                         }
</I>&gt;<i> @@ -143,38 +150,7 @@
</I>&gt;<i>                 /// &lt;/summary&gt;
</I>&gt;<i>                 public override bool SupportsSchemaType(Type type)
</I>&gt;<i>                 {
</I>&gt;<i> -                       if (type == typeof(TableSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(ViewSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(ProcedureSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(AggregateSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(GroupSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(UserSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(LanguageSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(OperatorSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(RoleSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(SequenceSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(DataTypeSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(TriggerSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(ColumnSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(ConstraintSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else if (type == typeof(RuleSchema))
</I>&gt;<i> -                               return true;
</I>&gt;<i> -                       else
</I>&gt;<i> -                               return false;
</I>&gt;<i> +                       return false;
</I>&gt;<i>                 }
</I>&gt;<i>
</I>&gt;<i>                 /// &lt;summary&gt;
</I>&gt;<i> @@ -183,8 +159,7 @@
</I>&gt;<i>                 public override DataTable ExecuteSQL(string SQLText)
</I>&gt;<i>                 {
</I>&gt;<i>                         try {
</I>&gt;<i> -                               OdbcCommand command = new OdbcCommand();
</I>&gt;<i> -                               command.Connection = connection;
</I>&gt;<i> +                               IDbCommand command = Connection.CreateCommand ();
</I>&gt;<i>                                 command.CommandText = SQLText;
</I>&gt;<i>
</I>&gt;<i>                                 DataSet resultSet = new DataSet ();
</I>&gt;<i> Index: Mono.Data.Sql/Makefile.Win32
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- Mono.Data.Sql/Makefile.Win32        (revision 57190)
</I>&gt;<i> +++ Mono.Data.Sql/Makefile.Win32        (working copy)
</I>&gt;<i> @@ -31,7 +31,6 @@
</I>&gt;<i>  Schema/AggregateSchema.cs \
</I>&gt;<i>  Schema/TableSchema.cs \
</I>&gt;<i>  Schema/ProcedureSchema.cs \
</I>&gt;<i> -Providers/MySqlDbProvider.cs \
</I>&gt;<i>  Providers/DbProviderBase.cs \
</I>&gt;<i>  Providers/NpgsqlDbProvider.cs \
</I>&gt;<i>  Providers/SqliteDbProvider.cs \
</I>&gt;<i> @@ -43,21 +42,23 @@
</I>&gt;<i>  Providers/MetaDataProviderFactory.cs \
</I>&gt;<i>  AssemblyInfo.cs
</I>&gt;<i>
</I>&gt;<i> -# Providers/FirebirdDbProvider.cs
</I>&gt;<i> -
</I>&gt;<i> +#Providers/MySqlDbProvider.cs \
</I>&gt;<i> +#Providers/FirebirdDbProvider.cs \
</I>&gt;<i> +
</I>&gt;<i>  #build_sources = $(addprefix $(srcdir)/, $(FILES))
</I>&gt;<i>  build_sources=$(FILES)
</I>&gt;<i>
</I>&gt;<i>  REFS = \
</I>&gt;<i>  -r:System.Data \
</I>&gt;<i> --r:Mono.Data \
</I>&gt;<i> --r:Npgsql \
</I>&gt;<i> --r:ByteFX.Data \
</I>&gt;<i> --r:Mono.Data.SqliteClient \
</I>&gt;<i> --r:Mono.Data.SybaseClient \
</I>&gt;<i> --r:System.Data.OracleClient
</I>&gt;<i> +-r:Mono.Data
</I>&gt;<i>
</I>&gt;<i> -# -r:FirebirdSql.Data.Firebird.dll
</I>&gt;<i> +#-r:Npgsql
</I>&gt;<i> +#-r:ByteFX.Data
</I>&gt;<i> +#-r:Mono.Data.SqliteClient
</I>&gt;<i> +#-r:Mono.Data.SybaseClient
</I>&gt;<i> +#-r:System.Data.OracleClient
</I>&gt;<i> +#-r:FirebirdSql.Data.Firebird.dll
</I>&gt;<i> +
</I>&gt;<i>  # -r:$(top_srcdir)/contrib/FirebirdSql.Data.Firebird.dll
</I>&gt;<i>
</I>&gt;<i>  ADDIN_BUILD = $(top_builddir)/build/AddIns/MonoQuery
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

--
Christian Hergert
Medsphere Systems Corporation
Software Programmer
C: 253 906 2115
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003280.html">[MonoDevelop] [PATCH] Mono.Data.Sql - remove refereces to data
 providers and use Mono.Data.ProviderFactory
</A></li>
	<LI>Next message: <A HREF="003290.html">[MonoDevelop] Using Monodevelop with Glade-3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3281">[ date ]</a>
              <a href="thread.html#3281">[ thread ]</a>
              <a href="subject.html#3281">[ subject ]</a>
              <a href="author.html#3281">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
