<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] [Fwd: Re:  patch for 4 minor files (gpl -&gt; mit)]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20%5BFwd%3A%20Re%3A%20%20patch%20for%204%20minor%20files%20%28gpl%20-%3E%20mit%29%5D&In-Reply-To=4847FE4C.3030707%40carlo-kok.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007802.html">
   <LINK REL="Next"  HREF="007801.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] [Fwd: Re:  patch for 4 minor files (gpl -&gt; mit)]</H1>
    <B>Lluis Sanchez Gual</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20%5BFwd%3A%20Re%3A%20%20patch%20for%204%20minor%20files%20%28gpl%20-%3E%20mit%29%5D&In-Reply-To=4847FE4C.3030707%40carlo-kok.com"
       TITLE="[MonoDevelop] [Fwd: Re:  patch for 4 minor files (gpl -&gt; mit)]">lluis at novell.com
       </A><BR>
    <I>Thu Jun  5 11:12:06 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="007802.html">[MonoDevelop] [Fwd: Re:  patch for 4 minor files (gpl -&gt; mit)]
</A></li>
        <LI>Next message: <A HREF="007801.html">[MonoDevelop] Stetic crash on lfrench linux distrib (Patch include )
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7803">[ date ]</a>
              <a href="thread.html#7803">[ thread ]</a>
              <a href="subject.html#7803">[ subject ]</a>
              <a href="author.html#7803">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
El dj 05 de 06 del 2008 a les 16:55 +0200, en/na Carlo Kok va escriure:
&gt;<i> Lluis Sanchez Gual wrote:
</I>&gt;<i> &gt; El dv 30 de 05 del 2008 a les 09:46 +0200, en/na Carlo Kok va escriure:
</I>&gt;<i> &gt;&gt; Carlo Kok wrote:
</I>&gt;<i> &gt;&gt;&gt; Rewrote them from scratch while keeping the public/protected interface 
</I>&gt;<i> &gt;&gt;&gt; compatible.
</I>&gt;<i> &gt;&gt; fixed spacing and layout according to the guidelines.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; * Dropped IService &amp; all references to it replacing them with a base
</I>&gt;<i> &gt;&gt; &quot;AbstractService&quot; class.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Please use just 'Service'. The 'Abstract' prefix does not convey any
</I>&gt;<i> &gt; useful information here.
</I>&gt;<i> 
</I>&gt;<i> Fixed.
</I>&gt;<i> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Also, InitializeService and UnloadService should be 'internal
</I>&gt;<i> &gt; protected', since they are not meant to be called by classes other than
</I>&gt;<i> &gt; the ServiceManager.
</I>&gt;<i> 
</I>&gt;<i> Hm. GuiService (.Core.Gui) seems to call them too for the platform 
</I>&gt;<i> services, so internal/prot won't work.
</I>
PlatformService doesn't need to be a Service subclass, since it is not
created through the ServiceManager.

&gt;<i> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;&gt; * dropped IDocumentationService
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Why drop it? just remove the ISevice inheritance, which never should
</I>&gt;<i> &gt; have been there anyway.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;&gt; * created a new AbstractDocumentationService class that descends from
</I>&gt;<i> &gt;&gt; AbstractService
</I>&gt;<i> 
</I>&gt;<i> Of course, undid that change.
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; * Fixed all references to IDocumentationService and replaced them with
</I>&gt;<i> &gt;&gt; the AbstractDocumentationService
</I>&gt;<i> &gt;&gt; * Dropped GuiSyncAbstractService as nothing was using it
</I>&gt;<i> &gt;&gt; * Introduced a new static ServiceManager class
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; With the above changes, it looks good. Thanks!
</I>
I will commit after branching for 1.9. Thanks!

&gt;<i> &gt; Lluis.
</I>&gt;<i> 
</I>&gt;<i> cool
</I>&gt;<i> 
</I>&gt;<i> attached again, without the internal protected change.
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> Carlo Kok
</I>&gt;<i> RemObjects Software
</I>&gt;<i> fitxer adjunt document de text pla (patch04.txt)
</I>&gt;<i> Index: main/src/addins/MonoDevelop.DesignerSupport/MonoDevelop.DesignerSupport/DesignerSupportService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/addins/MonoDevelop.DesignerSupport/MonoDevelop.DesignerSupport/DesignerSupportService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/addins/MonoDevelop.DesignerSupport/MonoDevelop.DesignerSupport/DesignerSupportService.cs	(working copy)
</I>&gt;<i> @@ -44,7 +44,7 @@
</I>&gt;<i>  {
</I>&gt;<i>  	
</I>&gt;<i>  	
</I>&gt;<i> -	public class DesignerSupportService : AbstractService
</I>&gt;<i> +	public class DesignerSupportService : Service
</I>&gt;<i>  	{
</I>&gt;<i>  		PropertyPad propertyPad = null;
</I>&gt;<i>  		ToolboxService toolboxService = null;
</I>&gt;<i> Index: main/src/addins/NUnit/Services/NUnitService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/addins/NUnit/Services/NUnitService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/addins/NUnit/Services/NUnitService.cs	(working copy)
</I>&gt;<i> @@ -43,7 +43,7 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.NUnit
</I>&gt;<i>  {
</I>&gt;<i> -	public class NUnitService : AbstractService
</I>&gt;<i> +	public class NUnitService : Service
</I>&gt;<i>  	{
</I>&gt;<i>  		ArrayList providers = new ArrayList ();
</I>&gt;<i>  		UnitTest[] rootTests;
</I>&gt;<i> Index: main/src/core/MonoDevelop.Documentation/MonoDevelop.Documentation/DocumentationService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Documentation/MonoDevelop.Documentation/DocumentationService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Documentation/MonoDevelop.Documentation/DocumentationService.cs	(working copy)
</I>&gt;<i> @@ -36,23 +36,20 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.Documentation
</I>&gt;<i>  {
</I>&gt;<i> -	internal class DocumentationService : IDocumentationService
</I>&gt;<i> +	internal class DocumentationService : Service, IDocumentationService
</I>&gt;<i>  	{
</I>&gt;<i>  
</I>&gt;<i>  		RootTree helpTree;
</I>&gt;<i>  
</I>&gt;<i> -		public void InitializeService ()
</I>&gt;<i> +		public override void InitializeService ()
</I>&gt;<i>  		{
</I>&gt;<i>  			helpTree = RootTree.LoadTree ();
</I>&gt;<i>  		}
</I>&gt;<i>  
</I>&gt;<i> -		public void UnloadService()
</I>&gt;<i> +		public override void UnloadService()
</I>&gt;<i>  		{
</I>&gt;<i>  		}
</I>&gt;<i>  		
</I>&gt;<i> -		public event EventHandler Initialize;
</I>&gt;<i> -		public event EventHandler Unload;
</I>&gt;<i> -		
</I>&gt;<i>  		public RootTree HelpTree {
</I>&gt;<i>  			get { return helpTree; }
</I>&gt;<i>  		}
</I>&gt;<i> Index: main/src/core/MonoDevelop.Projects/MonoDevelop.Projects.Ambience/AmbienceService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Projects/MonoDevelop.Projects.Ambience/AmbienceService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Projects/MonoDevelop.Projects.Ambience/AmbienceService.cs	(working copy)
</I>&gt;<i> @@ -26,7 +26,7 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.Projects.Ambience
</I>&gt;<i>  {
</I>&gt;<i> -	public class AmbienceService : AbstractService
</I>&gt;<i> +	public class AmbienceService : Service
</I>&gt;<i>  	{
</I>&gt;<i>  		static readonly string ambienceProperty       = &quot;SharpDevelop.UI.CurrentAmbience&quot;;
</I>&gt;<i>  		static readonly string codeGenerationProperty = &quot;SharpDevelop.UI.CodeGenerationOptions&quot;;
</I>&gt;<i> Index: main/src/core/MonoDevelop.Projects/MonoDevelop.Projects.Documentation/IDocumentationService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Projects/MonoDevelop.Projects.Documentation/IDocumentationService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Projects/MonoDevelop.Projects.Documentation/IDocumentationService.cs	(working copy)
</I>&gt;<i> @@ -25,7 +25,7 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.Projects.Documentation
</I>&gt;<i>  {
</I>&gt;<i> -	public interface IDocumentationService : IService
</I>&gt;<i> +	public interface IDocumentationService
</I>&gt;<i>  	{
</I>&gt;<i>  		XmlDocument GetHelpXml (string type);
</I>&gt;<i>  		RootTree HelpTree { get; }
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core.Gui/MonoDevelop.Core.Gui/GuiSyncAbstractService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core.Gui/MonoDevelop.Core.Gui/GuiSyncAbstractService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core.Gui/MonoDevelop.Core.Gui/GuiSyncAbstractService.cs	(working copy)
</I>&gt;<i> @@ -1,64 +0,0 @@
</I>&gt;<i> -// GuiSyncAbstractService.cs
</I>&gt;<i> -//
</I>&gt;<i> -// Author:
</I>&gt;<i> -//   Lluis Sanchez Gual &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at novell.com</A>&gt;
</I>&gt;<i> -//
</I>&gt;<i> -// Copyright (c) 2005 Novell, Inc (<A HREF="http://www.novell.com">http://www.novell.com</A>)
</I>&gt;<i> -//
</I>&gt;<i> -// Permission is hereby granted, free of charge, to any person obtaining a copy
</I>&gt;<i> -// of this software and associated documentation files (the &quot;Software&quot;), to deal
</I>&gt;<i> -// in the Software without restriction, including without limitation the rights
</I>&gt;<i> -// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
</I>&gt;<i> -// copies of the Software, and to permit persons to whom the Software is
</I>&gt;<i> -// furnished to do so, subject to the following conditions:
</I>&gt;<i> -//
</I>&gt;<i> -// The above copyright notice and this permission notice shall be included in
</I>&gt;<i> -// all copies or substantial portions of the Software.
</I>&gt;<i> -//
</I>&gt;<i> -// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
</I>&gt;<i> -// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
</I>&gt;<i> -// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
</I>&gt;<i> -// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
</I>&gt;<i> -// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
</I>&gt;<i> -// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
</I>&gt;<i> -// THE SOFTWARE.
</I>&gt;<i> -//
</I>&gt;<i> -//
</I>&gt;<i> -
</I>&gt;<i> -using System;
</I>&gt;<i> -using MonoDevelop.Core;
</I>&gt;<i> -
</I>&gt;<i> -namespace MonoDevelop.Core.Gui
</I>&gt;<i> -{
</I>&gt;<i> -	public class GuiSyncAbstractService : GuiSyncObject, IService
</I>&gt;<i> -	{
</I>&gt;<i> -		[FreeDispatch]
</I>&gt;<i> -		public virtual void InitializeService()
</I>&gt;<i> -		{
</I>&gt;<i> -			OnInitialize(EventArgs.Empty);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		
</I>&gt;<i> -		public virtual void UnloadService()
</I>&gt;<i> -		{
</I>&gt;<i> -			OnUnload(EventArgs.Empty);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		protected virtual void OnInitialize(EventArgs e)
</I>&gt;<i> -		{
</I>&gt;<i> -			if (Initialize != null) {
</I>&gt;<i> -				Initialize(this, e);
</I>&gt;<i> -			}
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		protected virtual void OnUnload(EventArgs e)
</I>&gt;<i> -		{
</I>&gt;<i> -			if (Unload != null) {
</I>&gt;<i> -				Unload(this, e);
</I>&gt;<i> -			}
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		public event EventHandler Initialize;
</I>&gt;<i> -		public event EventHandler Unload;
</I>&gt;<i> -	}
</I>&gt;<i> -}
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core.Gui/MonoDevelop.Core.Gui/PlatformService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core.Gui/MonoDevelop.Core.Gui/PlatformService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core.Gui/MonoDevelop.Core.Gui/PlatformService.cs	(working copy)
</I>&gt;<i> @@ -39,7 +39,7 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.Core.Gui
</I>&gt;<i>  {
</I>&gt;<i> -	public abstract class PlatformService : AbstractService
</I>&gt;<i> +	public abstract class PlatformService : Service
</I>&gt;<i>  	{
</I>&gt;<i>  		Gdk.Pixbuf defaultIcon;
</I>&gt;<i>  		Hashtable iconHash = new Hashtable ();
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core.Gui/Makefile.am
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core.Gui/Makefile.am	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core.Gui/Makefile.am	(working copy)
</I>&gt;<i> @@ -59,7 +59,6 @@
</I>&gt;<i>  	MonoDevelop.Core.Gui/FreeDispatchAttribute.cs \
</I>&gt;<i>  	MonoDevelop.Core.Gui/GLibLogging.cs \
</I>&gt;<i>  	MonoDevelop.Core.Gui/GuiService.cs \
</I>&gt;<i> -	MonoDevelop.Core.Gui/GuiSyncAbstractService.cs \
</I>&gt;<i>  	MonoDevelop.Core.Gui/GuiSyncContext.cs \
</I>&gt;<i>  	MonoDevelop.Core.Gui/GuiSyncObject.cs \
</I>&gt;<i>  	MonoDevelop.Core.Gui/IMementoCapable.cs \
</I>&gt;<i> Index: main/src/core/MonoDevelop.Projects.Gui/MonoDevelop.Projects.Gui/IconService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Projects.Gui/MonoDevelop.Projects.Gui/IconService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Projects.Gui/MonoDevelop.Projects.Gui/IconService.cs	(working copy)
</I>&gt;<i> @@ -34,7 +34,7 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.Projects.Gui
</I>&gt;<i>  {
</I>&gt;<i> -	public class IconService : AbstractService {
</I>&gt;<i> +	public class IconService : Service {
</I>&gt;<i>  		Hashtable extensionHashtable   = new Hashtable ();
</I>&gt;<i>  		Hashtable projectFileHashtable = new Hashtable ();
</I>&gt;<i>  		
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core.AddIns/ServiceExtensionNode.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core.AddIns/ServiceExtensionNode.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core.AddIns/ServiceExtensionNode.cs	(working copy)
</I>&gt;<i> @@ -35,7 +35,7 @@
</I>&gt;<i>  	{
</I>&gt;<i>  		protected override void OnAddinLoaded ()
</I>&gt;<i>  		{
</I>&gt;<i> -			ServiceManager.AddService ((IService) base.CreateInstance ());
</I>&gt;<i> +			ServiceManager.AddService ((Service) base.CreateInstance ());
</I>&gt;<i>  		}
</I>&gt;<i>  	}
</I>&gt;<i>  }
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core.Execution/ProcessService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core.Execution/ProcessService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core.Execution/ProcessService.cs	(working copy)
</I>&gt;<i> @@ -44,7 +44,7 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.Core.Execution
</I>&gt;<i>  {
</I>&gt;<i> -	public class ProcessService : AbstractService
</I>&gt;<i> +	public class ProcessService : Service
</I>&gt;<i>  	{
</I>&gt;<i>  		ProcessHostController externalProcess;
</I>&gt;<i>  		List&lt;ExtensionNode&gt; executionHandlers;
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/Makefile.am
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/Makefile.am	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/Makefile.am	(working copy)
</I>&gt;<i> @@ -47,7 +47,7 @@
</I>&gt;<i>  	MonoDevelop.Core.ProgressMonitoring/NullProgressMonitor.cs \
</I>&gt;<i>  	MonoDevelop.Core.ProgressMonitoring/ProgressTracker.cs \
</I>&gt;<i>  	MonoDevelop.Core.ProgressMonitoring/SynchronizedProgressMonitor.cs \
</I>&gt;<i> -	MonoDevelop.Core/AbstractService.cs \
</I>&gt;<i> +	MonoDevelop.Core/Service.cs \
</I>&gt;<i>  	MonoDevelop.Core/ClrVersion.cs \
</I>&gt;<i>  	MonoDevelop.Core/DefaultAddinLocalizer.cs \
</I>&gt;<i>  	MonoDevelop.Core/FileEventArgs.cs \
</I>&gt;<i> @@ -56,7 +56,6 @@
</I>&gt;<i>  	MonoDevelop.Core/IAsyncOperation.cs \
</I>&gt;<i>  	MonoDevelop.Core/ICustomXmlSerializer.cs \
</I>&gt;<i>  	MonoDevelop.Core/IProgressMonitor.cs \
</I>&gt;<i> -	MonoDevelop.Core/IService.cs \
</I>&gt;<i>  	MonoDevelop.Core/LoggingService.cs \
</I>&gt;<i>  	MonoDevelop.Core/Properties.cs \
</I>&gt;<i>  	MonoDevelop.Core/PropertyChangedEventArgs.cs \
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core/GettextCatalog.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core/GettextCatalog.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core/GettextCatalog.cs	(working copy)
</I>&gt;<i> @@ -1,88 +1,91 @@
</I>&gt;<i> -/*
</I>&gt;<i> - * Copyright (C) 2004 Jorn Baayen &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">jorn at nl.linux.org</A>&gt;
</I>&gt;<i> - * 
</I>&gt;<i> - * Modified by Todd Berman &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">tberman at sevenl.net</A>&gt; to fit with MonoDevelop.
</I>&gt;<i> - *
</I>&gt;<i> - * This program is free software; you can redistribute it and/or
</I>&gt;<i> - * modify it under the terms of the GNU General Public License as
</I>&gt;<i> - * published by the Free Software Foundation; either version 2 of the
</I>&gt;<i> - * License, or (at your option) any later version.
</I>&gt;<i> - *
</I>&gt;<i> - * This program is distributed in the hope that it will be useful,
</I>&gt;<i> - * but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;<i> - * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
</I>&gt;<i> - * General Public License for more details.
</I>&gt;<i> - *
</I>&gt;<i> - * You should have received a copy of the GNU General Public
</I>&gt;<i> - * License along with this program; if not, write to the
</I>&gt;<i> - * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
</I>&gt;<i> - * Boston, MA 02111-1307, USA.
</I>&gt;<i> - *
</I>&gt;<i> - * !!! Note that this class has to have the same API as the one
</I>&gt;<i> - *     from GNU.Gettext.dll, because otherwise the strings won't
</I>&gt;<i> - *     be picked up by update-po.
</I>&gt;<i> - */
</I>&gt;<i> -
</I>&gt;<i> -using System;
</I>&gt;<i> -using System.IO;
</I>&gt;<i> -using System.Runtime.InteropServices;
</I>&gt;<i> -
</I>&gt;<i> -using MonoDevelop.Core;
</I>&gt;<i> -
</I>&gt;<i> -using Mono.Unix;
</I>&gt;<i> -
</I>&gt;<i> -namespace MonoDevelop.Core
</I>&gt;<i> -{
</I>&gt;<i> -
</I>&gt;<i> -	public class GettextCatalog
</I>&gt;<i> -	{
</I>&gt;<i> -		static GettextCatalog ()
</I>&gt;<i> -		{
</I>&gt;<i> -			//variable can be used to override where Gettext looks for the catalogues
</I>&gt;<i> -			string catalog = System.Environment.GetEnvironmentVariable (&quot;MONODEVELOP_LOCALE_PATH&quot;);
</I>&gt;<i> -			
</I>&gt;<i> -			if (string.IsNullOrEmpty (catalog)) {
</I>&gt;<i> -				string location = System.Reflection.Assembly.GetExecutingAssembly ().Location;
</I>&gt;<i> -				location = Path.GetDirectoryName (location);
</I>&gt;<i> -				// MD is located at $prefix/lib/monodevelop/bin
</I>&gt;<i> -				// adding &quot;../../..&quot; should give us $prefix
</I>&gt;<i> -				string prefix = Path.Combine (Path.Combine (Path.Combine (location, &quot;..&quot;), &quot;..&quot;), &quot;..&quot;);
</I>&gt;<i> -				//normalise it
</I>&gt;<i> -				prefix = Path.GetFullPath (prefix);
</I>&gt;<i> -				//catalogue is installed to &quot;$prefix/share/locale&quot; by default
</I>&gt;<i> -				catalog = Path.Combine (Path.Combine (prefix, &quot;share&quot;), &quot;locale&quot;);
</I>&gt;<i> -			}
</I>&gt;<i> -			Catalog.Init (&quot;monodevelop&quot;, catalog);
</I>&gt;<i> -		}
</I>&gt;<i> -	
</I>&gt;<i> -		private GettextCatalog ()
</I>&gt;<i> -		{
</I>&gt;<i> -		}
</I>&gt;<i> -
</I>&gt;<i> -		public static string GetString (string str)
</I>&gt;<i> -		{
</I>&gt;<i> -			return str != null ? Catalog.GetString (str) : null;
</I>&gt;<i> -		}
</I>&gt;<i> -	
</I>&gt;<i> -		public static string GetString (string str, params object[] arguments)
</I>&gt;<i> -		{
</I>&gt;<i> -			return string.Format (GetString (str), arguments);
</I>&gt;<i> -		}
</I>&gt;<i> -	
</I>&gt;<i> -		public static string GetPluralString (string singular,
</I>&gt;<i> -			    	 	              string plural,
</I>&gt;<i> -					              int n)
</I>&gt;<i> -		{
</I>&gt;<i> -			return Catalog.GetPluralString (singular, plural, n);
</I>&gt;<i> -		}
</I>&gt;<i> -
</I>&gt;<i> -		public static string GetPluralString (string singular,
</I>&gt;<i> -			    	 	              string plural,
</I>&gt;<i> -					              int n,
</I>&gt;<i> -						      params object[] arguments)
</I>&gt;<i> -		{
</I>&gt;<i> -			return string.Format(GetPluralString (singular, plural, n), arguments);
</I>&gt;<i> -		}
</I>&gt;<i> -
</I>&gt;<i> -	}
</I>&gt;<i> -}
</I>&gt;<i> +&#65279;//
</I>&gt;<i> +// GettextCatalog.cs
</I>&gt;<i> +//
</I>&gt;<i> +// Author:
</I>&gt;<i> +//   Michael Hutchinson &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">m.j.hutchinson at gmail.com</A>&gt;
</I>&gt;<i> +//   Carlo Kok &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">ck at carlo-kok.com</A>&gt;
</I>&gt;<i> +//
</I>&gt;<i> +// Copyright (C) 2008
</I>&gt;<i> +//
</I>&gt;<i> +// Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i> +// a copy of this software and associated documentation files (the
</I>&gt;<i> +// &quot;Software&quot;), to deal in the Software without restriction, including
</I>&gt;<i> +// without limitation the rights to use, copy, modify, merge, publish,
</I>&gt;<i> +// distribute, sublicense, and/or sell copies of the Software, and to
</I>&gt;<i> +// permit persons to whom the Software is furnished to do so, subject to
</I>&gt;<i> +// the following conditions:
</I>&gt;<i> +// 
</I>&gt;<i> +// The above copyright notice and this permission notice shall be
</I>&gt;<i> +// included in all copies or substantial portions of the Software.
</I>&gt;<i> +// 
</I>&gt;<i> +// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</I>&gt;<i> +// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</I>&gt;<i> +// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</I>&gt;<i> +// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</I>&gt;<i> +// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</I>&gt;<i> +// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</I>&gt;<i> +// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</I>&gt;<i> +//
</I>&gt;<i> +using System;
</I>&gt;<i> +using System.IO;
</I>&gt;<i> +using Mono.Unix;
</I>&gt;<i> +
</I>&gt;<i> +namespace MonoDevelop.Core
</I>&gt;<i> +{
</I>&gt;<i> +	public static class GettextCatalog
</I>&gt;<i> +	{
</I>&gt;<i> +        
</I>&gt;<i> +		// function by mhutch from the original source
</I>&gt;<i> +               static GettextCatalog ()
</I>&gt;<i> +               {
</I>&gt;<i> +                       //variable can be used to override where Gettext looks for the catalogues
</I>&gt;<i> +                       string catalog = System.Environment.GetEnvironmentVariable (&quot;MONODEVELOP_LOCALE_PATH&quot;);
</I>&gt;<i> +
</I>&gt;<i> +                       if (string.IsNullOrEmpty (catalog)) {
</I>&gt;<i> +                               string location = System.Reflection.Assembly.GetExecutingAssembly ().Location;
</I>&gt;<i> +                               location = Path.GetDirectoryName (location);
</I>&gt;<i> +                               // MD is located at $prefix/lib/monodevelop/bin
</I>&gt;<i> +                               // adding &quot;../../..&quot; should give us $prefix
</I>&gt;<i> +                               string prefix = Path.Combine (Path.Combine (Path.Combine (location, &quot;..&quot;), &quot;..&quot;), &quot;..&quot;);
</I>&gt;<i> +                               //normalise it
</I>&gt;<i> +                               prefix = Path.GetFullPath (prefix);
</I>&gt;<i> +                               //catalogue is installed to &quot;$prefix/share/locale&quot; by default
</I>&gt;<i> +                               catalog = Path.Combine (Path.Combine (prefix, &quot;share&quot;), &quot;locale&quot;);
</I>&gt;<i> +                       }
</I>&gt;<i> +                       Catalog.Init (&quot;monodevelop&quot;, catalog);
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +		public static string GetString (string s, params object[] args)
</I>&gt;<i> +		{
</I>&gt;<i> +			string val = GetString (s);
</I>&gt;<i> +			
</I>&gt;<i> +			if (val == null) 
</I>&gt;<i> +				return null;
</I>&gt;<i> +
</I>&gt;<i> +			return String.Format (val, args);
</I>&gt;<i> +		}
</I>&gt;<i> +
</I>&gt;<i> +		public static string GetString(string s)
</I>&gt;<i> +		{
</I>&gt;<i> +			if (s == null) 
</I>&gt;<i> +				return null;
</I>&gt;<i> +
</I>&gt;<i> +			return Catalog.GetString (s);
</I>&gt;<i> +		}
</I>&gt;<i> +
</I>&gt;<i> +		public static string GetPluralString (string singular, string plural, int n, params object[] args)
</I>&gt;<i> +		{
</I>&gt;<i> +			string val = GetPluralString (singular, plural, n);
</I>&gt;<i> +
</I>&gt;<i> +			if (val == null)
</I>&gt;<i> +				return null;
</I>&gt;<i> +
</I>&gt;<i> +			return String.Format (val, args);
</I>&gt;<i> +		}
</I>&gt;<i> +
</I>&gt;<i> +		public static string GetPluralString (string singular, string plural, int n)
</I>&gt;<i> +		{
</I>&gt;<i> +			return Catalog.GetPluralString (singular, plural, n); 
</I>&gt;<i> +		}
</I>&gt;<i> +	}
</I>&gt;<i> +}
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core/AbstractService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core/AbstractService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core/AbstractService.cs	(working copy)
</I>&gt;<i> @@ -1,58 +0,0 @@
</I>&gt;<i> -//  AbstractService.cs
</I>&gt;<i> -//
</I>&gt;<i> -//  This file was derived from a file from #Develop. 
</I>&gt;<i> -//
</I>&gt;<i> -//  Copyright (C) 2001-2007 Mike Kr&#252;ger &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">mkrueger at novell.com</A>&gt;
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is free software; you can redistribute it and/or modify
</I>&gt;<i> -//  it under the terms of the GNU General Public License as published by
</I>&gt;<i> -//  the Free Software Foundation; either version 2 of the License, or
</I>&gt;<i> -//  (at your option) any later version.
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is distributed in the hope that it will be useful,
</I>&gt;<i> -//  but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;<i> -//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
</I>&gt;<i> -//  GNU General Public License for more details.
</I>&gt;<i> -//  
</I>&gt;<i> -//  You should have received a copy of the GNU General Public License
</I>&gt;<i> -//  along with this program; if not, write to the Free Software
</I>&gt;<i> -//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
</I>&gt;<i> -
</I>&gt;<i> -using System;
</I>&gt;<i> -
</I>&gt;<i> -using Mono.Addins;
</I>&gt;<i> -using MonoDevelop.Core;
</I>&gt;<i> -
</I>&gt;<i> -namespace MonoDevelop.Core
</I>&gt;<i> -{
</I>&gt;<i> -	public class AbstractService : IService
</I>&gt;<i> -	{
</I>&gt;<i> -		public virtual void InitializeService()
</I>&gt;<i> -		{
</I>&gt;<i> -			OnInitialize(EventArgs.Empty);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		
</I>&gt;<i> -		public virtual void UnloadService()
</I>&gt;<i> -		{
</I>&gt;<i> -			OnUnload(EventArgs.Empty);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		protected virtual void OnInitialize(EventArgs e)
</I>&gt;<i> -		{
</I>&gt;<i> -			if (Initialize != null) {
</I>&gt;<i> -				Initialize(this, e);
</I>&gt;<i> -			}
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		protected virtual void OnUnload(EventArgs e)
</I>&gt;<i> -		{
</I>&gt;<i> -			if (Unload != null) {
</I>&gt;<i> -				Unload(this, e);
</I>&gt;<i> -			}
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		public event EventHandler Initialize;
</I>&gt;<i> -		public event EventHandler Unload;
</I>&gt;<i> -	}
</I>&gt;<i> -}
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core/ServiceManager.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core/ServiceManager.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core/ServiceManager.cs	(working copy)
</I>&gt;<i> @@ -1,132 +1,104 @@
</I>&gt;<i> -//  ServiceManager.cs
</I>&gt;<i> -//
</I>&gt;<i> -//  This file was derived from a file from #Develop. 
</I>&gt;<i> -//
</I>&gt;<i> -//  Copyright (C) 2001-2007 Mike Kr&#252;ger &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">mkrueger at novell.com</A>&gt;
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is free software; you can redistribute it and/or modify
</I>&gt;<i> -//  it under the terms of the GNU General Public License as published by
</I>&gt;<i> -//  the Free Software Foundation; either version 2 of the License, or
</I>&gt;<i> -//  (at your option) any later version.
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is distributed in the hope that it will be useful,
</I>&gt;<i> -//  but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;<i> -//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
</I>&gt;<i> -//  GNU General Public License for more details.
</I>&gt;<i> -//  
</I>&gt;<i> -//  You should have received a copy of the GNU General Public License
</I>&gt;<i> -//  along with this program; if not, write to the Free Software
</I>&gt;<i> -//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
</I>&gt;<i> -
</I>&gt;<i> -using System;
</I>&gt;<i> -using System.Collections.Generic;
</I>&gt;<i> -
</I>&gt;<i> -using Mono.Addins;
</I>&gt;<i> -using MonoDevelop.Core;
</I>&gt;<i> -
</I>&gt;<i> -namespace MonoDevelop.Core
</I>&gt;<i> -{
</I>&gt;<i> -	/// &lt;summary&gt;
</I>&gt;<i> -	/// This class does basic service handling for you.
</I>&gt;<i> -	/// &lt;/summary&gt;
</I>&gt;<i> -	public class ServiceManager
</I>&gt;<i> -	{
</I>&gt;<i> -		List&lt;IService&gt;             serviceList         = new List&lt;IService&gt; ();
</I>&gt;<i> -		Dictionary&lt;Type, IService&gt; servicesHashtable   = new Dictionary&lt;Type, IService&gt; ();
</I>&gt;<i> -		List&lt;IService&gt;             initializedServices = new List&lt;IService&gt; ();
</I>&gt;<i> -		
</I>&gt;<i> -		static ServiceManager defaultServiceManager = new ServiceManager ();
</I>&gt;<i> -
</I>&gt;<i> -		protected ServiceManager ()
</I>&gt;<i> -		{
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		public static void Initialize ()
</I>&gt;<i> -		{
</I>&gt;<i> -			// Ensure service extension nodes are created
</I>&gt;<i> -			AddinManager.GetExtensionNodes (&quot;/MonoDevelop/Core/Services&quot;);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		public static IService GetService (Type serviceType) {
</I>&gt;<i> -			return defaultServiceManager.FetchService (serviceType);
</I>&gt;<i> -		}
</I>&gt;<i> -			
</I>&gt;<i> -
</I>&gt;<i> -		public IService this [Type index] {
</I>&gt;<i> -			get {
</I>&gt;<i> -				return FetchService (index);
</I>&gt;<i> -			}
</I>&gt;<i> -		}		
</I>&gt;<i> -		
</I>&gt;<i> -		/// &lt;summary&gt;
</I>&gt;<i> -		/// Don't create ServiceManager objects, only have ONE per application.
</I>&gt;<i> -		/// &lt;/summary&gt;
</I>&gt;<i> -		static ServiceManager()
</I>&gt;<i> -		{
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		/// &lt;remarks&gt;
</I>&gt;<i> -		/// Calls UnloadService on all services. This method must be called ONCE.
</I>&gt;<i> -		/// &lt;/remarks&gt;
</I>&gt;<i> -		public static void UnloadAllServices()
</I>&gt;<i> -		{
</I>&gt;<i> -			foreach (IService service in defaultServiceManager.serviceList) 
</I>&gt;<i> -				service.UnloadService();
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		public static void AddService(IService service)
</I>&gt;<i> -		{
</I>&gt;<i> -			defaultServiceManager.serviceList.Add(service);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		public static void AddServices(IService[] services)
</I>&gt;<i> -		{
</I>&gt;<i> -			foreach (IService service in services) 
</I>&gt;<i> -				AddService(service);
</I>&gt;<i> -		}
</I>&gt;<i> -
</I>&gt;<i> -		// HACK: MONO BUGFIX
</I>&gt;<i> -		// this doesn't work on mono:serviceType.IsInstanceOfType(service)
</I>&gt;<i> -		bool IsInstanceOfType(Type type, IService service)
</I>&gt;<i> -		{
</I>&gt;<i> -			Type serviceType = service.GetType();
</I>&gt;<i> -
</I>&gt;<i> -			foreach (Type iface in serviceType.GetInterfaces()) {
</I>&gt;<i> -				if (iface == type) {
</I>&gt;<i> -					return true;
</I>&gt;<i> -				}
</I>&gt;<i> -			}
</I>&gt;<i> -			
</I>&gt;<i> -			while (serviceType != typeof(System.Object)) {
</I>&gt;<i> -				if (type == serviceType) {
</I>&gt;<i> -					return true;
</I>&gt;<i> -				}
</I>&gt;<i> -				serviceType = serviceType.BaseType;
</I>&gt;<i> -			}
</I>&gt;<i> -			return false;
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		/// &lt;remarks&gt;
</I>&gt;<i> -		/// Requestes a specific service, may return null if this service is not found.
</I>&gt;<i> -		/// &lt;/remarks&gt;
</I>&gt;<i> -		IService FetchService(Type serviceType)
</I>&gt;<i> -		{
</I>&gt;<i> -			if (servicesHashtable.ContainsKey (serviceType)) 
</I>&gt;<i> -				return servicesHashtable[serviceType];
</I>&gt;<i> -			
</I>&gt;<i> -			foreach (IService service in serviceList) {
</I>&gt;<i> -				if (IsInstanceOfType(serviceType, service)) {
</I>&gt;<i> -					servicesHashtable[serviceType] = service;
</I>&gt;<i> -					if (!initializedServices.Contains (service)) {
</I>&gt;<i> -						LoggingService.LogInfo (GettextCatalog.GetString (&quot;Initializing service: &quot;) + serviceType);
</I>&gt;<i> -						service.InitializeService();
</I>&gt;<i> -						initializedServices.Add (service);
</I>&gt;<i> -					}
</I>&gt;<i> -					return service;
</I>&gt;<i> -				}
</I>&gt;<i> -			}
</I>&gt;<i> -			
</I>&gt;<i> -			return null;
</I>&gt;<i> -		}
</I>&gt;<i> -	}
</I>&gt;<i> -}
</I>&gt;<i> +&#65279;//
</I>&gt;<i> +// ServiceManager.cs
</I>&gt;<i> +//
</I>&gt;<i> +// Author:
</I>&gt;<i> +//   Carlo Kok &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">ck at carlo-kok.com</A>&gt;
</I>&gt;<i> +//
</I>&gt;<i> +// Copyright (C) 2008
</I>&gt;<i> +//
</I>&gt;<i> +// Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i> +// a copy of this software and associated documentation files (the
</I>&gt;<i> +// &quot;Software&quot;), to deal in the Software without restriction, including
</I>&gt;<i> +// without limitation the rights to use, copy, modify, merge, publish,
</I>&gt;<i> +// distribute, sublicense, and/or sell copies of the Software, and to
</I>&gt;<i> +// permit persons to whom the Software is furnished to do so, subject to
</I>&gt;<i> +// the following conditions:
</I>&gt;<i> +// 
</I>&gt;<i> +// The above copyright notice and this permission notice shall be
</I>&gt;<i> +// included in all copies or substantial portions of the Software.
</I>&gt;<i> +// 
</I>&gt;<i> +// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</I>&gt;<i> +// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</I>&gt;<i> +// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</I>&gt;<i> +// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</I>&gt;<i> +// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</I>&gt;<i> +// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</I>&gt;<i> +// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</I>&gt;<i> +//
</I>&gt;<i> +
</I>&gt;<i> +using System;
</I>&gt;<i> +using System.Collections.Generic;
</I>&gt;<i> +using Mono.Addins;
</I>&gt;<i> +
</I>&gt;<i> +namespace MonoDevelop.Core
</I>&gt;<i> +{
</I>&gt;<i> +	public sealed class ServiceManager {
</I>&gt;<i> +
</I>&gt;<i> +		static Dictionary&lt;Type, Service&gt; servicecache = new Dictionary&lt;Type, Service&gt; ();
</I>&gt;<i> +		static List&lt;Service&gt; allservices = new List&lt;Service&gt; ();
</I>&gt;<i> +		static List&lt;Service&gt; initializedservices = new List&lt;Service&gt; ();
</I>&gt;<i> +
</I>&gt;<i> +		ServiceManager ()
</I>&gt;<i> +		{
</I>&gt;<i> +		} 
</I>&gt;<i> +
</I>&gt;<i> +		public static void Initialize ()
</I>&gt;<i> +		{
</I>&gt;<i> +			AddinManager.GetExtensionNodes (&quot;/MonoDevelop/Core/Services&quot;);
</I>&gt;<i> +		}
</I>&gt;<i> +	
</I>&gt;<i> +		public static void AddService (Service service)
</I>&gt;<i> +		{
</I>&gt;<i> +			if (service != null)
</I>&gt;<i> +				allservices.Add (service);
</I>&gt;<i> +		}
</I>&gt;<i> +        
</I>&gt;<i> +		public static void AddServices (params Service[] services)
</I>&gt;<i> +		{
</I>&gt;<i> +			if (services == null) 
</I>&gt;<i> +				return;
</I>&gt;<i> +
</I>&gt;<i> +			for (int i = 0; i &lt; services.Length; i++)
</I>&gt;<i> +			{
</I>&gt;<i> +				if (services[i] != null)
</I>&gt;<i> +					allservices.Add (services [i]);
</I>&gt;<i> +			}
</I>&gt;<i> +		}
</I>&gt;<i> +        
</I>&gt;<i> +		public static Service GetService (Type type)
</I>&gt;<i> +		{
</I>&gt;<i> +			if (type == null) 
</I>&gt;<i> +				return null;
</I>&gt;<i> +
</I>&gt;<i> +			Service res;
</I>&gt;<i> +			if (servicecache.TryGetValue (type, out res)) 
</I>&gt;<i> +				return res;
</I>&gt;<i> +
</I>&gt;<i> +			for (int i = 0; i &lt; allservices.Count; i++)
</I>&gt;<i> +			{
</I>&gt;<i> +				res = allservices[i];
</I>&gt;<i> +				if (type.IsInstanceOfType (res))
</I>&gt;<i> +				{
</I>&gt;<i> +					servicecache.Add (type, res);
</I>&gt;<i> +					if (!initializedservices.Contains (res))
</I>&gt;<i> +					{
</I>&gt;<i> +						LoggingService.LogInfo (GettextCatalog.GetString (&quot;Initializing service: &quot;) + type);
</I>&gt;<i> +						initializedservices.Add	(res);
</I>&gt;<i> +						res.InitializeService ();
</I>&gt;<i> +					}
</I>&gt;<i> +					return res;
</I>&gt;<i> +				}
</I>&gt;<i> +			}
</I>&gt;<i> +			return null;
</I>&gt;<i> +		}
</I>&gt;<i> +
</I>&gt;<i> +		public static void UnloadAllServices ()
</I>&gt;<i> +		{
</I>&gt;<i> +			for (int i = 0; i &lt; initializedservices.Count; i++)
</I>&gt;<i> +				initializedservices[i].UnloadService();
</I>&gt;<i> +
</I>&gt;<i> +			initializedservices.Clear();
</I>&gt;<i> +			servicecache.Clear();
</I>&gt;<i> +		}
</I>&gt;<i> +	}
</I>&gt;<i> +}
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core/Service.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core/Service.cs	(revision 104437)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core/Service.cs	(working copy)
</I>&gt;<i> @@ -1,58 +1,47 @@
</I>&gt;<i> -//  AbstractService.cs
</I>&gt;<i> -//
</I>&gt;<i> -//  This file was derived from a file from #Develop. 
</I>&gt;<i> -//
</I>&gt;<i> -//  Copyright (C) 2001-2007 Mike Kr&#252;ger &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">mkrueger at novell.com</A>&gt;
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is free software; you can redistribute it and/or modify
</I>&gt;<i> -//  it under the terms of the GNU General Public License as published by
</I>&gt;<i> -//  the Free Software Foundation; either version 2 of the License, or
</I>&gt;<i> -//  (at your option) any later version.
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is distributed in the hope that it will be useful,
</I>&gt;<i> -//  but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;<i> -//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
</I>&gt;<i> -//  GNU General Public License for more details.
</I>&gt;<i> -//  
</I>&gt;<i> -//  You should have received a copy of the GNU General Public License
</I>&gt;<i> -//  along with this program; if not, write to the Free Software
</I>&gt;<i> -//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
</I>&gt;<i> -
</I>&gt;<i> -using System;
</I>&gt;<i> -
</I>&gt;<i> -using Mono.Addins;
</I>&gt;<i> -using MonoDevelop.Core;
</I>&gt;<i> -
</I>&gt;<i> -namespace MonoDevelop.Core
</I>&gt;<i> -{
</I>&gt;<i> -	public class AbstractService : IService
</I>&gt;<i> -	{
</I>&gt;<i> -		public virtual void InitializeService()
</I>&gt;<i> -		{
</I>&gt;<i> -			OnInitialize(EventArgs.Empty);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		
</I>&gt;<i> -		public virtual void UnloadService()
</I>&gt;<i> -		{
</I>&gt;<i> -			OnUnload(EventArgs.Empty);
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		protected virtual void OnInitialize(EventArgs e)
</I>&gt;<i> -		{
</I>&gt;<i> -			if (Initialize != null) {
</I>&gt;<i> -				Initialize(this, e);
</I>&gt;<i> -			}
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		protected virtual void OnUnload(EventArgs e)
</I>&gt;<i> -		{
</I>&gt;<i> -			if (Unload != null) {
</I>&gt;<i> -				Unload(this, e);
</I>&gt;<i> -			}
</I>&gt;<i> -		}
</I>&gt;<i> -		
</I>&gt;<i> -		public event EventHandler Initialize;
</I>&gt;<i> -		public event EventHandler Unload;
</I>&gt;<i> -	}
</I>&gt;<i> -}
</I>&gt;<i> +&#65279;//
</I>&gt;<i> +// Service.cs
</I>&gt;<i> +//
</I>&gt;<i> +// Author:
</I>&gt;<i> +//   Carlo Kok &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">ck at carlo-kok.com</A>&gt;
</I>&gt;<i> +//
</I>&gt;<i> +// Copyright (C) 2008
</I>&gt;<i> +//
</I>&gt;<i> +// Permission is hereby granted, free of charge, to any person obtaining
</I>&gt;<i> +// a copy of this software and associated documentation files (the
</I>&gt;<i> +// &quot;Software&quot;), to deal in the Software without restriction, including
</I>&gt;<i> +// without limitation the rights to use, copy, modify, merge, publish,
</I>&gt;<i> +// distribute, sublicense, and/or sell copies of the Software, and to
</I>&gt;<i> +// permit persons to whom the Software is furnished to do so, subject to
</I>&gt;<i> +// the following conditions:
</I>&gt;<i> +// 
</I>&gt;<i> +// The above copyright notice and this permission notice shall be
</I>&gt;<i> +// included in all copies or substantial portions of the Software.
</I>&gt;<i> +// 
</I>&gt;<i> +// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</I>&gt;<i> +// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</I>&gt;<i> +// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</I>&gt;<i> +// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</I>&gt;<i> +// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</I>&gt;<i> +// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</I>&gt;<i> +// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</I>&gt;<i> +//
</I>&gt;<i> +
</I>&gt;<i> +using System;
</I>&gt;<i> +
</I>&gt;<i> +namespace MonoDevelop.Core
</I>&gt;<i> +{
</I>&gt;<i> +	// base class for all services
</I>&gt;<i> +	public class Service
</I>&gt;<i> +	{
</I>&gt;<i> +	
</I>&gt;<i> +		// called when the service is first used; called by ServiceManager
</I>&gt;<i> +		public virtual void InitializeService ()
</I>&gt;<i> +		{
</I>&gt;<i> +		}
</I>&gt;<i> +
</I>&gt;<i> +		// called when the service manager unloads the service
</I>&gt;<i> +		public virtual void UnloadService ()
</I>&gt;<i> +		{
</I>&gt;<i> +		}
</I>&gt;<i> +	}
</I>&gt;<i> +}
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core/SystemAssemblyService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core/SystemAssemblyService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core/SystemAssemblyService.cs	(working copy)
</I>&gt;<i> @@ -41,7 +41,7 @@
</I>&gt;<i>  
</I>&gt;<i>  namespace MonoDevelop.Core
</I>&gt;<i>  {
</I>&gt;<i> -	public class SystemAssemblyService : AbstractService
</I>&gt;<i> +	public class SystemAssemblyService : Service
</I>&gt;<i>  	{
</I>&gt;<i>  		Dictionary&lt;string, SystemPackage&gt; assemblyPathToPackage = new Dictionary&lt;string, SystemPackage&gt; ();
</I>&gt;<i>  		Dictionary&lt;string, string&gt; assemblyFullNameToPath = new Dictionary&lt;string, string&gt; ();
</I>&gt;<i> Index: main/src/core/MonoDevelop.Core/MonoDevelop.Core/IService.cs
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- main/src/core/MonoDevelop.Core/MonoDevelop.Core/IService.cs	(revision 105032)
</I>&gt;<i> +++ main/src/core/MonoDevelop.Core/MonoDevelop.Core/IService.cs	(working copy)
</I>&gt;<i> @@ -1,46 +0,0 @@
</I>&gt;<i> -//  IService.cs
</I>&gt;<i> -//
</I>&gt;<i> -//  This file was derived from a file from #Develop. 
</I>&gt;<i> -//
</I>&gt;<i> -//  Copyright (C) 2001-2007 Mike Kr&#252;ger &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">mkrueger at novell.com</A>&gt;
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is free software; you can redistribute it and/or modify
</I>&gt;<i> -//  it under the terms of the GNU General Public License as published by
</I>&gt;<i> -//  the Free Software Foundation; either version 2 of the License, or
</I>&gt;<i> -//  (at your option) any later version.
</I>&gt;<i> -// 
</I>&gt;<i> -//  This program is distributed in the hope that it will be useful,
</I>&gt;<i> -//  but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;<i> -//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
</I>&gt;<i> -//  GNU General Public License for more details.
</I>&gt;<i> -//  
</I>&gt;<i> -//  You should have received a copy of the GNU General Public License
</I>&gt;<i> -//  along with this program; if not, write to the Free Software
</I>&gt;<i> -//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
</I>&gt;<i> -
</I>&gt;<i> -using System;
</I>&gt;<i> -
</I>&gt;<i> -using Mono.Addins;
</I>&gt;<i> -using MonoDevelop.Core;
</I>&gt;<i> -
</I>&gt;<i> -namespace MonoDevelop.Core
</I>&gt;<i> -{
</I>&gt;<i> -	/// &lt;summary&gt;
</I>&gt;<i> -	/// This interface must be implemented by all services.
</I>&gt;<i> -	/// &lt;/summary&gt;
</I>&gt;<i> -	public interface IService
</I>&gt;<i> -	{
</I>&gt;<i> -		/// &lt;summary&gt;
</I>&gt;<i> -		/// This method is called after the services are loaded.
</I>&gt;<i> -		/// &lt;/summary&gt;
</I>&gt;<i> -		void InitializeService();
</I>&gt;<i> -		
</I>&gt;<i> -		/// &lt;summary&gt;
</I>&gt;<i> -		/// This method is called before the service is unloaded.
</I>&gt;<i> -		/// &lt;/summary&gt;
</I>&gt;<i> -		void UnloadService();
</I>&gt;<i> -		
</I>&gt;<i> -		event EventHandler Initialize;
</I>&gt;<i> -		event EventHandler Unload;
</I>&gt;<i> -	}
</I>&gt;<i> -}
</I>
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007802.html">[MonoDevelop] [Fwd: Re:  patch for 4 minor files (gpl -&gt; mit)]
</A></li>
	<LI>Next message: <A HREF="007801.html">[MonoDevelop] Stetic crash on lfrench linux distrib (Patch include )
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7803">[ date ]</a>
              <a href="thread.html#7803">[ thread ]</a>
              <a href="subject.html#7803">[ subject ]</a>
              <a href="author.html#7803">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
