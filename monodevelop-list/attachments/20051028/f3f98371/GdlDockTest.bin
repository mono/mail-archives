using System;
using Gtk;
using Gdl;

using Gecko;
class T
{
	DockLayout layout;

	static void Main (string[] args)
	{
		new T (args);
	}

	T (string[] args)
	{
		Application.Init ();
		Window app = new Window ("test");
		app.SetDefaultSize (400, 400);
		app.WindowPosition = WindowPosition.Center;
		app.DeleteEvent += new DeleteEventHandler (OnAppDelete);

		Dock dock = new Dock ();		
		layout = new DockLayout (dock);
		layout.LoadFromFile ("layout.xml");
		DockBar dockbar = new DockBar (dock);

		Box box = new HBox (false, 5);
		app.Add (box);
		box.PackStart (dockbar, false, false, 0);
		box.PackEnd (dock, true, true, 0);

		// create WebControl dock item
		DockItem di = new DockItem ("item1", "WebControl", DockItemBehavior.Locked);
		Frame mozFrame = new Frame ();
		mozFrame.SetSizeRequest (200, 400);			
		Gecko.WebControl moz = new WebControl ();
		mozFrame.Add (moz);

		//It also happens if content is external
		//moz.LoadUrl ("http://www.google.com");

		string greeting =  
			"<html><head><title>Browser</title></head>" +
			"<body><h1>Hello!</h1><p>Welcome.</p></body></html>";

		di.Add (mozFrame);	
		dock.AddItem (di, DockPlacement.Top);

		DockItem di2 = new DockItem ("item2", "UnDock this.",
				Gtk.Stock.Execute, DockItemBehavior.Normal);
		di2.Add (new Button ("Button 2"));
		dock.AddItem (di2, DockPlacement.Right);

		app.ShowAll ();

		moz.RenderData (greeting, "file:///tmp", "text/html");

		Application.Run ();
	}

	private void OnAppDelete (object o, DeleteEventArgs args)
	{
		Application.Quit ();
	}
}
