Index: Extras/ChangeLogAddIn/CommitDialogExtensionWidget.cs
===================================================================
--- Extras/ChangeLogAddIn/CommitDialogExtensionWidget.cs	(revision 80552)
+++ Extras/ChangeLogAddIn/CommitDialogExtensionWidget.cs	(working copy)
@@ -21,7 +21,9 @@
 		Label msgLabel;
 		Label pathLabel;
 		bool notConfigured;
-		
+		const string changeLogAddInNameProperty = "ChangeLogAddIn.Name";
+		const string changeLogAddInEmailProperty = "ChangeLogAddIn.Email";
+				
 		public CommitDialogExtensionWidget()
 		{
 			if (!IntegrationEnabled)
@@ -70,10 +72,9 @@
 			if (!IntegrationEnabled)
 				Remove (box);
 
-			string name = Runtime.Properties.GetProperty ("ChangeLogAddIn.Name", "");
-			string email = Runtime.Properties.GetProperty ("ChangeLogAddIn.Email", "");
-			string logf = GetChangelogFile (cset.BaseLocalPath);
-			
+			string name = Runtime.Properties.GetProperty (changeLogAddInNameProperty, "");
+			string email = Runtime.Properties.GetProperty (changeLogAddInEmailProperty, "");
+						
 			if (name.Length == 0 || email.Length == 0) {
 				msgLabel.Markup = "<b><span foreground='red'>" + GettextCatalog.GetString ("ChangeLog entries can't be generated.") + "</span></b>";
 				pathLabel.Text = GettextCatalog.GetString ("The name or e-mail of the user has not been configured.");
@@ -85,6 +86,9 @@
 			
 			optionsButton.Visible = true;
 			logButton.Label = GettextCatalog.GetString ("View ChangeLog...");
+			
+			string logf = GetChangelogFile (new DirectoryInfo(cset.BaseLocalPath));
+			
 			if (logf == null) {
 				msgLabel.Markup = "<b><span foreground='red'>" + GettextCatalog.GetString ("There is no ChangeLog file in the path:") + "</span></b>";
 				pathLabel.Text = cset.BaseLocalPath;
@@ -104,7 +108,7 @@
 			if (!IntegrationEnabled)
 				return true;
 				
-			string logf = GetChangelogFile (changeSet.BaseLocalPath);
+			string logf = GetChangelogFile (new DirectoryInfo(changeSet.BaseLocalPath));
 			if (logf == null)
 				return true;
 
@@ -142,7 +146,7 @@
 				
 			if (!success) {
 				if (tmpFile != null && File.Exists (tmpFile)) {
-					string logf = GetChangelogFile (changeSet.BaseLocalPath);
+					string logf = GetChangelogFile (new DirectoryInfo(changeSet.BaseLocalPath));
 					Runtime.FileService.CopyFile (tmpFile, logf);
 				}
 			}
@@ -177,11 +181,14 @@
 			UpdateStatus ();
 		}
 		
-		string GetChangelogFile (string basePath)
-		{
-			string logfile = System.IO.Path.Combine (basePath, "ChangeLog");
+		string GetChangelogFile (DirectoryInfo baseDirectory)
+		{					
+			string logfile = System.IO.Path.Combine (baseDirectory.FullName, "ChangeLog");
+						
 			if (File.Exists (logfile))
 				return logfile;
+			else if (baseDirectory.Parent != null)
+				return GetChangelogFile(baseDirectory.Parent);
 			else
 				return null;
 		}
@@ -192,8 +199,8 @@
 			if (msg.Length == 0)
 				msg = cset.GenerateGlobalComment (75);
 
-			string name = Runtime.Properties.GetProperty ("ChangeLogAddIn.Name", "");
-			string email = Runtime.Properties.GetProperty ("ChangeLogAddIn.Email", "");
+			string name = Runtime.Properties.GetProperty (changeLogAddInNameProperty, "");
+			string email = Runtime.Properties.GetProperty (changeLogAddInEmailProperty, "");
 			string date = DateTime.Now.ToString("yyyy-MM-dd");
 			string text = date + "  " + name + " <" + email + "> " + Environment.NewLine + Environment.NewLine;
 			