Index: Mono.TextEditor.Vi/ViActionMaps.cs
===================================================================
--- Mono.TextEditor.Vi/ViActionMaps.cs	(revision 138186)
+++ Mono.TextEditor.Vi/ViActionMaps.cs	(working copy)
@@ -208,12 +208,22 @@
 			return null;
 		}
 		
-		public static Action<TextEditorData> GetCommandCharAction (char c)
+		public static Action<TextEditorData> GetCommandCharAction (Gdk.Key key, Gdk.ModifierType modifier)
 		{
-			switch (c) {
-			case 'u':
-				return MiscActions.Undo;
+			if ((modifier & Gdk.ModifierType.ControlMask) != 0)
+			{
+				switch (key) {
+				case Gdk.Key.r:
+					return MiscActions.Redo;
+				}
 			}
+			else
+			{
+				switch (key) {
+				case Gdk.Key.u:
+					return MiscActions.Undo;
+				}
+			}
 			return null;
 		}
 	}
Index: Mono.TextEditor.Vi/ViMode.cs
===================================================================
--- Mono.TextEditor.Vi/ViMode.cs	(revision 138186)
+++ Mono.TextEditor.Vi/ViMode.cs	(working copy)
@@ -354,7 +354,7 @@
 				if (action == null)
 					action = ViActionMaps.GetDirectionKeyAction (key, modifier);
 				if (action == null)
-					action = ViActionMaps.GetCommandCharAction ((char)unicodeKey);
+					action = ViActionMaps.GetCommandCharAction (key, modifier);
 				
 				if (action != null)
 					RunAction (action);
@@ -466,7 +466,7 @@
 					action = ViActionMaps.GetDirectionKeyAction (key, modifier);
 				}
 				if (action == null) {
-					action = ViActionMaps.GetCommandCharAction ((char)unicodeKey);
+					action = ViActionMaps.GetCommandCharAction (key, modifier);
 				}
 				if (action != null) {
 					RunAction (SelectionActions.LineActionFromMoveAction (action));
@@ -490,7 +490,7 @@
 					action = ViActionMaps.GetDirectionKeyAction (key, modifier);
 				}
 				if (action == null) {
-					action = ViActionMaps.GetCommandCharAction ((char)unicodeKey);
+					action = ViActionMaps.GetCommandCharAction (key, modifier);
 				}
 				if (action != null) {
 					RunAction (SelectionActions.FromMoveAction (action));
Index: ChangeLog
===================================================================
--- ChangeLog	(revision 138186)
+++ ChangeLog	(working copy)
@@ -1,3 +1,9 @@
+2009-07-19  Adam Petaccia  <mighmos@mighmos.org>
+
+	* Mono.TextEditor.Vi/ViMode.cs: 
+	* Mono.TextEditor.Vi/ViActionMaps.cs: 
+	Add support for "redo" in Vi mode.
+
 2009-07-17  Mike Kr√ºger  <mkrueger@novell.com>
 
 	* Mono.TextEditor/ISearchEngine.cs: Fixed search & replace bug

