Index: ChangeLog
===================================================================
--- ChangeLog	(revision 82314)
+++ ChangeLog	(working copy)
@@ -1,3 +1,8 @@
+2007-07-19  Ben Motmans <ben.motmans@gmail.com>
+
+	* MonoDevelop.DesignerSupport.Toolbox/Toolbox.cs: overwrite the
+	node_hash field with a fixed hashtable [fixes #81942]
+
 2007-07-17  Lluis Sanchez Gual <lluis@novell.com> 
 
 	* MonoDevelop.DesignerSupport.Toolbox/CompactToolboxView.cs: Improve
Index: MonoDevelop.DesignerSupport.Toolbox/Toolbox.cs
===================================================================
--- MonoDevelop.DesignerSupport.Toolbox/Toolbox.cs	(revision 82314)
+++ MonoDevelop.DesignerSupport.Toolbox/Toolbox.cs	(working copy)
@@ -29,7 +29,8 @@
  */
 
 using System;
-using Gtk;
+using Gtk;
+using System.Reflection;
 using System.Collections;
 using System.Drawing.Design;
 using System.ComponentModel.Design;
@@ -111,6 +112,9 @@
 			
 			store = new ToolboxStore ();
 			
+			FixedIDHashtable node_hash = new FixedIDHashtable ();
+			typeof (ToolboxStore).GetField ("node_hash", BindingFlags.Instance | BindingFlags.NonPublic).SetValue (store, node_hash);
+			
 			//initialise view
 			nodeView = new NodeView (store);
 			nodeView.Selection.Mode = SelectionMode.Single;
@@ -334,6 +338,28 @@
 		void OnDragDataDelete (object o, Gtk.DragDataDeleteArgs arg)
 		{
 		}
-		#endregion	
+		#endregion
+		
+		//HACK: see #81942 (caused by #82087)
+		class FixedIDHashtable : Hashtable {
+                	class FixedIDComparer : IComparer {
+                        	public int Compare (object x, object y)
+                        	{
+                                	if (x is int && y is int && (int) x == (int) y)
+                                        	return 0;
+                                	else
+                                        	return 1;
+                        	}
+                	}
+
+                	class FixedIDHashCodeProvider : IHashCodeProvider {
+				public int GetHashCode (object o)
+				{
+					return (int) o;
+				}
+			}
+
+                	public FixedIDHashtable () : base (new FixedIDHashCodeProvider (), new FixedIDComparer ()) {}
+        	}
 	}
 }