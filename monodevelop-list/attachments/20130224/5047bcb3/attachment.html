<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;style&gt;After&nbsp;looking&nbsp;around&nbsp;a&nbsp;bit&nbsp;in&nbsp;code,&nbsp;the&nbsp;solution&nbsp;looks&nbsp;to&nbsp;be&nbsp;pleasantly&nbsp;simple&lt;/div&gt;&lt;div&nbsp;style&gt;(for&nbsp;the&nbsp;default&nbsp;policy):&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;---&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
using&nbsp;Mono.Addins;&lt;/div&gt;&lt;div&gt;using&nbsp;MonoDevelop.CSharp.Formatting;&lt;/div&gt;&lt;div&gt;using&nbsp;MonoDevelop.Projects.Policies;&lt;/div&gt;&lt;div&gt;using&nbsp;NUnit.Framework;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;namespace&nbsp;TestFormatter&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt; &nbsp;class&nbsp;MainClass&lt;/div&gt;<br>
&lt;div&gt; &nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;public&nbsp;static&nbsp;void&nbsp;Main&nbsp;(string[]&nbsp;args)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;Mono.Addins.AddinManager.Initialize&nbsp;();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;var&nbsp;input&nbsp;=&nbsp;&quot;class&nbsp;Test&nbsp;{}&quot;;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;var&nbsp;formatter&nbsp;=&nbsp;new&nbsp;CSharpFormatter&nbsp;();&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;//&nbsp;CSharpFormatter.MimeType&nbsp;is&nbsp;internal&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;var&nbsp;mimeTypeChain&nbsp;=&nbsp;new&nbsp;string[]&nbsp;{&nbsp;&quot;text/x-csharp&quot;&nbsp;};&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;var&nbsp;policies&nbsp;=&nbsp;PolicyService.DefaultPolicies;&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;var&nbsp;result&nbsp;=&nbsp;formatter.FormatText&nbsp;(policies,&nbsp;mimeTypeChain,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;input,&nbsp;0,&nbsp;input.Length);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;Assert.AreEqual&nbsp;(result,&nbsp;&quot;class&nbsp;Test\n{\n}&quot;);&lt;/div&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;}&lt;/div&gt;&lt;div&gt; &nbsp;}&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;---&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;However,&nbsp;this&nbsp;results&nbsp;in&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;---&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; [ERROR]&nbsp;FATAL&nbsp;UNHANDLED&nbsp;EXCEPTION:&lt;/div&gt;<br>
&lt;div&gt; System.Reflection.TargetInvocationException:&nbsp;Exception&nbsp;has&nbsp;been&lt;/div&gt;&lt;div&gt; thrown&nbsp;by&nbsp;the&nbsp;target&nbsp;of&nbsp;an&nbsp;invocation.&nbsp;---&gt;&lt;/div&gt;&lt;div&gt; System.TypeInitializationException:&nbsp;An&nbsp;exception&nbsp;was&nbsp;thrown&nbsp;by&lt;/div&gt;&lt;div&gt; the&nbsp;type&nbsp;initializer&nbsp;for&lt;/div&gt;<br>
&lt;div&gt; MonoDevelop.CSharp.Formatting.CSharpFormattingPolicy&nbsp;---&gt;&lt;/div&gt;&lt;div&gt; System.InvalidOperationException:&nbsp;This&nbsp;PolicyContainer&nbsp;can&#39;t&nbsp;be&lt;/div&gt;&lt;div&gt; modified&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;---&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;<br>
It&#39;s&nbsp;a&nbsp;bit&nbsp;hard&nbsp;to&nbsp;debug&nbsp;as&nbsp;the&nbsp;debugger&nbsp;does&nbsp;not&nbsp;catch&nbsp;the&nbsp;exception,&nbsp;so&nbsp;I&nbsp;didn&#39;t&nbsp;dig&nbsp;into&nbsp;it&nbsp;too&nbsp;deeply.&lt;/div&gt;&lt;div&nbsp;style&gt;Does&nbsp;anyone&nbsp;have&nbsp;any&nbsp;idea&nbsp;what&#39;s&nbsp;causing&nbsp;this&nbsp;from&nbsp;the&nbsp;first&nbsp;glance?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;But&nbsp;generally,&nbsp;wouldn&#39;t&nbsp;having&nbsp;`mdtool applypolicy -p&nbsp;Mono&nbsp;-r&nbsp;.`&nbsp;in&nbsp;the&nbsp;git&nbsp;pre-commit&nbsp;hook&nbsp;be&lt;/div&gt;&lt;div&nbsp;style&gt;really&nbsp;nice&nbsp;for&nbsp;cleaning&nbsp;up&nbsp;code&nbsp;automagically?&nbsp;I&nbsp;personally&nbsp;miss&nbsp;this&nbsp;a&nbsp;lot,&nbsp;MonoDevelop&#39;s&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;policies&nbsp;are&nbsp;much&nbsp;more&nbsp;powerful&nbsp;than&nbsp;e.g.&nbsp;NArrange&nbsp;(although&nbsp;I&#39;ve&nbsp;not&nbsp;used&nbsp;the&nbsp;latter).&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;div&gt;(See&nbsp;e.g. &lt;a&nbsp;href=&quot;https://metacpan.org/module/Code::TidyAll::Git::Precommit&quot;&gt;https://metacpan.org/module/Code::TidyAll::Git::Precommit&lt;/a&gt;&nbsp;).&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;As&nbsp;for&nbsp;general&nbsp;usefulness,&nbsp;there&nbsp;are&nbsp;a&nbsp;number&nbsp;of&nbsp;people&nbsp;who&nbsp;are&nbsp;looking&nbsp;for&nbsp;this:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt; *&nbsp;&lt;a&nbsp;href=&quot;http://haacked.com/archive/2011/05/22/an-obsessive-compulsive-guide-to-source-code-formatting.aspx&quot;&gt;http://haacked.com/archive/2011/05/22/an-obsessive-compulsive-guide-to-source-code-formatting.aspx&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style&gt; * &lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/30101/is-there-an-automatic-code-formatter-for-c&quot;&gt;http://stackoverflow.com/questions/30101/is-there-an-automatic-code-formatter-for-c&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;And&nbsp;the&nbsp;issue&nbsp;has&nbsp;been&nbsp;raised&nbsp;in&nbsp;mono-devel&nbsp;list&nbsp;already&nbsp;back&nbsp;in&nbsp;2008:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt; * &lt;a&nbsp;href=&quot;http://lists.ximian.com/pipermail/mono-devel-list/2008-August/028863.html&quot;&gt;http://lists.ximian.com/pipermail/mono-devel-list/2008-August/028863.html&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;So,&nbsp;besides&nbsp;being&nbsp;useful&nbsp;for&nbsp;the&nbsp;wider&nbsp;world,&nbsp;I&nbsp;guess&nbsp;this&nbsp;would&nbsp;also&nbsp;help&nbsp;in&nbsp;keeping&nbsp;both&nbsp;Mono&nbsp;and&nbsp;Monodevelop&nbsp;code&nbsp;clean.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Best,&lt;/div&gt;&lt;div&nbsp;style&gt;MS&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jan&nbsp;29,&nbsp;2013&nbsp;at&nbsp;5:07&nbsp;PM,&nbsp;Mart&nbsp;Sõmermaa&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:mrts.pydev@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;mrts.pydev@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Have&nbsp;there&nbsp;been&nbsp;any&nbsp;discussions&nbsp;around&nbsp;running&nbsp;the&nbsp;MonoDevelop&nbsp;policy&nbsp;tool&lt;/div&gt;<br>
&lt;div&gt;from&nbsp;the&nbsp;command&nbsp;line?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;is&nbsp;an&nbsp;excellent&nbsp;tool&nbsp;and&nbsp;a&nbsp;it&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;apply&nbsp;consistent&nbsp;code&nbsp;formatting&nbsp;and&lt;/div&gt;<br>
&lt;div&gt;other&nbsp;policies&nbsp; across&nbsp;a&nbsp;project&nbsp;automatically&nbsp;where&nbsp;not&nbsp;all&nbsp;people&nbsp;use&nbsp;MonoDevelop&lt;/div&gt;&lt;div&gt;as&nbsp;the&nbsp;main&nbsp;developer&nbsp;UI.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Perhaps&nbsp;something&nbsp;in&nbsp;the&nbsp;lines&nbsp;of&lt;/div&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;mdtool&nbsp;applypolicy&nbsp;file.cs&nbsp;#&nbsp;apply&nbsp;default&nbsp;policy&nbsp;to&nbsp;file.cs&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;mdtool applypolicy -r&nbsp;dir&nbsp;#&nbsp;recursively&nbsp;apply&nbsp;default&nbsp;policy&nbsp;to&nbsp;all&nbsp;files&nbsp;in&nbsp;directory&nbsp;dir&lt;/div&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;mdtool applypolicy -f&nbsp;policyfile&nbsp;file.cs&nbsp;#&nbsp;apply&nbsp;policy&nbsp;from&nbsp;file&nbsp;policyfile&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;mdtool applypolicy -p&nbsp;Mono&nbsp;file.cs&nbsp;#&nbsp;apply&nbsp;the&nbsp;stock&nbsp;or&nbsp;custom&nbsp;policy&nbsp;labeled&nbsp;&#39;Mono&#39;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;not&nbsp;and&nbsp;someone&nbsp;cares&nbsp;to&nbsp;point&nbsp;me&nbsp;to&nbsp;the&nbsp;right&nbsp;direction&nbsp;(what&nbsp;modules&nbsp;to&nbsp;look&nbsp;into,&lt;/div&gt;&lt;div&gt;any&nbsp;concerns&nbsp;that&nbsp;you&nbsp;foresee&nbsp;etc)&nbsp;I&nbsp;might&nbsp;look&nbsp;into&nbsp;this&nbsp;myself.&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;good&nbsp;work!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best,&lt;/div&gt;&lt;div&gt;Mart&nbsp;Sõmermaa&lt;/div&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
