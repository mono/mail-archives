<tt>
Thanks&nbsp;for&nbsp;the&nbsp;comments!&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;2007/4/24,&nbsp;Lluis&nbsp;Sanchez&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:lluis@ximian.com&quot;&gt;lluis@ximian.com&lt;/a&gt;&amp;gt;:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
El&nbsp;dt&nbsp;24&nbsp;de&nbsp;04&nbsp;del&nbsp;2007&nbsp;a&nbsp;les&nbsp;13:40&nbsp;+0200,&nbsp;en/na&nbsp;Miguel&nbsp;Ángel&nbsp;Pérez&nbsp;va&lt;br&gt;escriure:&lt;br&gt;&amp;gt;&nbsp;Hello&nbsp;all!&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;I&nbsp;have&nbsp;been&nbsp;doing&nbsp;some&nbsp;coding&nbsp;with&nbsp;the&nbsp;encapsulate&nbsp;field&nbsp;command&nbsp;and&nbsp;i&lt;br&gt;&amp;gt;&nbsp;have&nbsp;got&nbsp;an&nbsp;initial&nbsp;implementation&nbsp;that&nbsp;generates&nbsp;the&nbsp;code&nbsp;for&nbsp;the<br>
&lt;br&gt;&amp;gt;&nbsp;property&nbsp;and&nbsp;changes&nbsp;the&nbsp;visibility&nbsp;for&nbsp;the&nbsp;field&nbsp;if&nbsp;its&nbsp;public&nbsp;or&lt;br&gt;&amp;gt;&nbsp;protected&nbsp;to&nbsp;private.&lt;br&gt;&lt;br&gt;Thanks&nbsp;for&nbsp;the&nbsp;patch!&lt;br&gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;To&nbsp;do&nbsp;the&nbsp;code&nbsp;generation&nbsp;I&amp;#39;ve&nbsp;created&nbsp;an&nbsp;internal&nbsp;helper&nbsp;class&nbsp;named<br>
&lt;br&gt;&amp;gt;&nbsp;CodeGeneratorHelper&nbsp;in&nbsp;the&nbsp;class&nbsp;CodeRefactorer&lt;br&gt;&amp;gt;&nbsp;(Monodevelop.Ide.Projects.CodeGeneration&nbsp;namespace)&nbsp;that&nbsp;implements&lt;br&gt;&amp;gt;&nbsp;it.&lt;br&gt;&amp;gt;&nbsp;I&nbsp;don&amp;#39;t&nbsp;know&nbsp;if&nbsp;there&nbsp;is&nbsp;already&nbsp;some&nbsp;class&nbsp;that&nbsp;can&nbsp;generate&nbsp;CodeDom<br>
&lt;br&gt;&amp;gt;&nbsp;namespace&nbsp;objects&nbsp;from&nbsp;an&nbsp;IMember&nbsp;so&nbsp;i&nbsp;have&nbsp;implemented&nbsp;something.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;What&nbsp;i&nbsp;haven&amp;#39;t&nbsp;done&nbsp;is&nbsp;renaming&nbsp;the&nbsp;references&nbsp;to&nbsp;the&nbsp;property,&nbsp;since&lt;br&gt;&amp;gt;&nbsp;is&nbsp;a&nbsp;thing&nbsp;that&nbsp;Lluis&nbsp;must&nbsp;know&nbsp;better&nbsp;than&nbsp;nobody,&nbsp;can&nbsp;you&nbsp;suggest<br>
&lt;br&gt;&amp;gt;&nbsp;how&nbsp;it&nbsp;could&nbsp;be&nbsp;done?&lt;br&gt;&lt;br&gt;You&nbsp;can&nbsp;use&nbsp;CodeRefactorer.FindMemberReferences&nbsp;to&nbsp;get&nbsp;a&nbsp;list&nbsp;of&lt;br&gt;references.&nbsp;However,&nbsp;this&nbsp;is&nbsp;not&nbsp;about&nbsp;renaming&nbsp;references,&nbsp;but&nbsp;about&lt;br&gt;changing&nbsp;a&nbsp;field&nbsp;reference&nbsp;by&nbsp;a&nbsp;property&nbsp;reference,&nbsp;and&nbsp;this&nbsp;is&nbsp;a<br>
&lt;br&gt;language-specific&nbsp;operation.&lt;br&gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;I&amp;#39;ve&nbsp;also&nbsp;done&nbsp;some&nbsp;changes&nbsp;to&nbsp;BaseRefactorer&nbsp;class&nbsp;to&nbsp;allow&nbsp;a&lt;br&gt;&amp;gt;&nbsp;parameter&nbsp;with&nbsp;the&nbsp;buffer&nbsp;to&nbsp;modify&nbsp;so&nbsp;the&nbsp;change&nbsp;is&nbsp;done&nbsp;to&nbsp;the&lt;br&gt;&amp;gt;&nbsp;editor&nbsp;buffer&nbsp;instead&nbsp;of&nbsp;the&nbsp;file&nbsp;in&nbsp;disk.&nbsp;This&nbsp;makes&nbsp;necessary&nbsp;to<br>
&lt;br&gt;&amp;gt;&nbsp;call&nbsp;the&nbsp;methods&nbsp;with&nbsp;an&nbsp;unboxing&nbsp;instead&nbsp;of&nbsp;using&nbsp;the&nbsp;interface&lt;br&gt;&amp;gt;&nbsp;IRefactorer.&lt;br&gt;&amp;gt;&nbsp;It&amp;#39;s&nbsp;look&nbsp;like&nbsp;this&nbsp;class&nbsp;could&nbsp;be&nbsp;improved&nbsp;with&nbsp;changes&nbsp;like&nbsp;this&lt;br&gt;&amp;gt;&nbsp;that&nbsp;helps&nbsp;in&nbsp;the&nbsp;operations&nbsp;needed&nbsp;to&nbsp;implement&nbsp;more&nbsp;refactoring<br>
&lt;br&gt;&amp;gt;&nbsp;commands.&lt;br&gt;&lt;br&gt;CodeRefactorer&nbsp;has&nbsp;a&nbsp;TextFileProvider&nbsp;property&nbsp;which&nbsp;allows&nbsp;setting&nbsp;an&lt;br&gt;ITextFileProvider&nbsp;implementation.&nbsp;This&nbsp;interface&nbsp;implementation&nbsp;will&lt;br&gt;then&nbsp;be&nbsp;used&nbsp;by&nbsp;CodeRefactorer&nbsp;and&nbsp;RefactorerContext&nbsp;to&nbsp;get&nbsp;the&nbsp;files&nbsp;to<br>
&lt;br&gt;read&nbsp;or&nbsp;modify.&lt;br&gt;&lt;br&gt;Notice&nbsp;that&nbsp;the&nbsp;follow&nbsp;method&nbsp;signature&nbsp;in&nbsp;BaseRefactorer&nbsp;is&nbsp;incorrect:&lt;br&gt;&lt;br&gt;public&nbsp;CodeTypeMember&nbsp;RenameMember&nbsp;(RefactorerContext&nbsp;ctx,&nbsp;IClass&nbsp;cls,&nbsp;IMember&nbsp;member,&nbsp;string&nbsp;newName,&nbsp;IEditableTextFile&nbsp;file)<br>
&lt;br&gt;&lt;br&gt;because&nbsp;the&nbsp;location&nbsp;of&nbsp;an&nbsp;IClass&nbsp;is&nbsp;language&nbsp;dependent.&nbsp;For&nbsp;example,&nbsp;if&lt;br&gt;cls&nbsp;is&nbsp;a&nbsp;partial&nbsp;class,&nbsp;RenameMember&nbsp;should&nbsp;rename&nbsp;the&nbsp;class&nbsp;in&nbsp;all&lt;br&gt;files&nbsp;that&nbsp;implement&nbsp;that&nbsp;class,&nbsp;so&nbsp;the&nbsp;&amp;#39;file&amp;#39;&nbsp;parameter&nbsp;here&nbsp;doesn&amp;#39;t<br>
&lt;br&gt;help.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Right,&nbsp;I&amp;#39;ll&nbsp;undo&nbsp;those&nbsp;changes.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;If&nbsp;you&nbsp;want&nbsp;CodeRefactorer&nbsp;to&nbsp;modify&nbsp;files&nbsp;from&nbsp;the&nbsp;editor,&nbsp;you&nbsp;should<br>
&lt;br&gt;create&nbsp;a&nbsp;ITextFileProvider&nbsp;implementation&nbsp;which&nbsp;returns&nbsp;such&nbsp;files.&nbsp;You&lt;br&gt;can&nbsp;look&nbsp;in&nbsp;MonoDevelop.GtkCore&nbsp;for&nbsp;an&nbsp;example.&nbsp;Look&nbsp;for&nbsp;the&nbsp;class&lt;br&gt;OpenDocumentFileProvider.&nbsp;Maybe&nbsp;we&nbsp;should&nbsp;move&nbsp;this&nbsp;class&nbsp;to&lt;br&gt;MonoDevelop.Ide.Gui<br>
,&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;reused.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;can&nbsp;copy&nbsp;the&nbsp;class&nbsp;somewhere&nbsp;so&nbsp;if&nbsp;it&amp;#39;s&nbsp;moved&nbsp;i&nbsp;only&nbsp;have&nbsp;to&nbsp;include&nbsp;the&nbsp;namespace&nbsp;to&nbsp;rehuse&nbsp;it.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
I&nbsp;also&nbsp;agree&nbsp;with&nbsp;the&nbsp;comments&nbsp;by&nbsp;Ben.&nbsp;Also,&nbsp;it&nbsp;looks&nbsp;like&nbsp;the&nbsp;indenting&lt;br&gt;of&nbsp;the&nbsp;code&nbsp;is&nbsp;not&nbsp;consistent,&nbsp;maybe&nbsp;you&nbsp;are&nbsp;mixing&nbsp;tabs&nbsp;and&nbsp;spaces&nbsp;for&lt;br&gt;indenting?&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes&nbsp;i&nbsp;have&nbsp;mixed&nbsp;tabs&nbsp;and&nbsp;spaces&nbsp;:S,&nbsp;I&amp;#39;ll&nbsp;fix&nbsp;it&nbsp;in&nbsp;the&nbsp;next&nbsp;path.<br>
&lt;br&gt;&lt;br&gt;For&nbsp;the&nbsp;next&nbsp;patch&nbsp;i&nbsp;will&nbsp;follow&nbsp;Ben&nbsp;comments&nbsp;and&nbsp;do&nbsp;some&nbsp;dialog&nbsp;to&nbsp;let&nbsp;the&nbsp;user&nbsp;configure&nbsp;the&nbsp;behaviour&nbsp;and&nbsp;do&nbsp;some&nbsp;more&nbsp;intelligent&nbsp;refactoring&nbsp;work.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Thanks!&lt;br&gt;Lluis.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;br&gt;--&nbsp;Regards&nbsp;--&lt;br&gt;<br>

</tt>
