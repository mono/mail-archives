<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] Trying to Load assemblyes &quot;on-the-fly&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:carlos.prado%40hispalinux.es">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <LINK REL="Previous"  HREF="000671.html">
   <LINK REL="Next"  HREF="000673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] Trying to Load assemblyes &quot;on-the-fly&quot;
   </H1>
    <B>Carlos Prado García
    </B> 
    <A HREF="mailto:carlos.prado%40hispalinux.es"
       TITLE="[MonoDevelop] Trying to Load assemblyes &quot;on-the-fly&quot;">carlos.prado@hispalinux.es
       </A><BR>
    <I>Thu, 29 Apr 2004 01:53:50 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000671.html">[MonoDevelop] Trying to Load assemblyes &quot;on-the-fly&quot;
</A></li>
        <LI> Next message: <A HREF="000673.html">[MonoDevelop] Trying to Load assemblyes &quot;on-the-fly&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#672">[ date ]</a>
              <a href="thread.html#672">[ thread ]</a>
              <a href="subject.html#672">[ subject ]</a>
              <a href="author.html#672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--=-JeMGvg/B6+vNxEM4Ypum
Content-Type: text/plain; charset=iso-8859-15
Content-Transfer-Encoding: 8bit

hi,

Try this:
            Assembly a =
Assembly.Load(System.IO.Path.GetFullPath(&quot;DLLImport.dll&quot;));
            Type[] types = a.GetTypes(  );
            foreach(Type t in types)
            {
                    Console.WriteLine(&quot;Type is {0}&quot;, t);
            }
            Console.WriteLine(
               &quot;{0} types found&quot;, types.Length);


El jue, 29-04-2004 a las 00:37, +0000, Paulo Aboim Pinto escribió:

&gt;<i> Hello
</I>&gt;<i> 
</I>&gt;<i> i'm trying to make a program that should load some DLL &quot;on-the-fly&quot; like 
</I>&gt;<i> plugins.
</I>&gt;<i> 
</I>&gt;<i> I'm having the problem with, where to put the DLLs do Load. I've try in 
</I>&gt;<i> the root directory of the program, or even in the same directory of the 
</I>&gt;<i> EXE, i also try the plugin directory and i get the same error:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="mailto:esqueleto@hercules">esqueleto@hercules</A> Debug $ ll
</I>&gt;<i> total 12K
</I>&gt;<i> -rwxr-xr-x    1 esqueleto wheel        4,0K Abr 29 00:10 DLLImport.dll
</I>&gt;<i> -rwxr-xr-x    1 esqueleto wheel        4,5K Abr 29 00:31 LoadDLL.exe
</I>&gt;<i> <A HREF="mailto:esqueleto@hercules">esqueleto@hercules</A> Debug $ mono LoadDLL.exe
</I>&gt;<i>                                                                                 
</I>&gt;<i> 
</I>&gt;<i> Unhandled Exception: System.IO.FileNotFoundException: File 
</I>&gt;<i> 'DLLImport.dll' not found.
</I>&gt;<i> in (unmanaged) /usr/lib/libmono.so.0(mono_raise_exception+0x1f) [0x400a60bf]
</I>&gt;<i> in (unmanaged) /usr/lib/libmono.so.0 [0x400cd998]
</I>&gt;<i> in &lt;0x0006c&gt; (wrapper remoting-invoke-with-check) 
</I>&gt;<i> System.AppDomain:LoadAssembly (string,System.Security.Policy.Evidence)
</I>&gt;<i> in &lt;0x0006b&gt; System.AppDomain:Load (string)
</I>&gt;<i> in &lt;0x00058&gt; (wrapper remoting-invoke-with-check) System.AppDomain:Load 
</I>&gt;<i> (string)in &lt;0x0001d&gt; System.Reflection.Assembly:Load (string)
</I>&gt;<i> in &lt;0x0002b&gt; MainClass:Main (string[])
</I>&gt;<i>                                                                                 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="mailto:esqueleto@hercules">esqueleto@hercules</A> Debug $
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> As you can see, i have the DLL in the same directory of the EXE, and i 
</I>&gt;<i> get the error that the DLL is not there .. :(
</I>&gt;<i> 
</I>&gt;<i> this is the code that i'm using           
</I>&gt;<i>             Assembly a = Assembly.Load(&quot;DLLImport.dll&quot;);
</I>&gt;<i>             Type[] types = a.GetTypes(  );
</I>&gt;<i>             foreach(Type t in types)
</I>&gt;<i>             {
</I>&gt;<i>                     Console.WriteLine(&quot;Type is {0}&quot;, t);
</I>&gt;<i>             }
</I>&gt;<i>             Console.WriteLine(
</I>&gt;<i>                &quot;{0} types found&quot;, types.Length);
</I>&gt;<i> 
</I>&gt;<i> The DLL that i'm trying to import is a test one, with and method that 
</I>&gt;<i> return one number.
</I>&gt;<i> Anyone can help me ????
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> (())
</I>&gt;<i> Paulo Aboim Pinto
</I>&gt;<i> From: Portugal
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Monodevelop-list mailing list
</I>&gt;<i> <A HREF="mailto:Monodevelop-list@lists.ximian.com">Monodevelop-list@lists.ximian.com</A>
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">http://lists.ximian.com/mailman/listinfo/monodevelop-list</A>
</I>
--=-JeMGvg/B6+vNxEM4Ypum
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: 7bit

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 TRANSITIONAL//EN&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
  &lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; CHARSET=UTF-8&quot;&gt;
  &lt;META NAME=&quot;GENERATOR&quot; CONTENT=&quot;GtkHTML/3.1.10&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
hi,&lt;BR&gt;
&lt;BR&gt;
Try this:&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Assembly a = Assembly.Load(&lt;B&gt;System.IO.Path.GetFullPath(&lt;/B&gt;&amp;quot;DLLImport.dll&amp;quot;&lt;B&gt;)&lt;/B&gt;);&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Type[] types = a.GetTypes(&amp;nbsp; );&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach(Type t in types)&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine(&amp;quot;Type is {0}&amp;quot;, t);&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Console.WriteLine(&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;quot;{0} types found&amp;quot;, types.Length);&lt;BR&gt;
&lt;BR&gt;
&lt;BR&gt;
El jue, 29-04-2004 a las 00:37, +0000, Paulo Aboim Pinto escribi&amp;#243;:
&lt;BLOCKQUOTE TYPE=CITE&gt;
&lt;PRE&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;Hello&lt;/FONT&gt;

&lt;FONT COLOR=&quot;#000000&quot;&gt;i'm trying to make a program that should load some DLL &amp;quot;on-the-fly&amp;quot; like &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;plugins.&lt;/FONT&gt;

&lt;FONT COLOR=&quot;#000000&quot;&gt;I'm having the problem with, where to put the DLLs do Load. I've try in &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;the root directory of the program, or even in the same directory of the &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;EXE, i also try the plugin directory and i get the same error:&lt;/FONT&gt;

&lt;FONT COLOR=&quot;#000000&quot;&gt;<A HREF="mailto:esqueleto@hercules">esqueleto@hercules</A> Debug $ ll&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;total 12K&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;-rwxr-xr-x    1 esqueleto wheel        4,0K Abr 29 00:10 DLLImport.dll&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;-rwxr-xr-x    1 esqueleto wheel        4,5K Abr 29 00:31 LoadDLL.exe&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;<A HREF="mailto:esqueleto@hercules">esqueleto@hercules</A> Debug $ mono LoadDLL.exe&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;                                                                                &lt;/FONT&gt;

&lt;FONT COLOR=&quot;#000000&quot;&gt;Unhandled Exception: System.IO.FileNotFoundException: File &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;'DLLImport.dll' not found.&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;in (unmanaged) /usr/lib/libmono.so.0(mono_raise_exception+0x1f) [0x400a60bf]&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;in (unmanaged) /usr/lib/libmono.so.0 [0x400cd998]&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;in &amp;lt;0x0006c&amp;gt; (wrapper remoting-invoke-with-check) &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;System.AppDomain:LoadAssembly (string,System.Security.Policy.Evidence)&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;in &amp;lt;0x0006b&amp;gt; System.AppDomain:Load (string)&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;in &amp;lt;0x00058&amp;gt; (wrapper remoting-invoke-with-check) System.AppDomain:Load &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;(string)in &amp;lt;0x0001d&amp;gt; System.Reflection.Assembly:Load (string)&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;in &amp;lt;0x0002b&amp;gt; MainClass:Main (string[])&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;                                                                                &lt;/FONT&gt;

&lt;FONT COLOR=&quot;#000000&quot;&gt;<A HREF="mailto:esqueleto@hercules">esqueleto@hercules</A> Debug $&lt;/FONT&gt;


&lt;FONT COLOR=&quot;#000000&quot;&gt;As you can see, i have the DLL in the same directory of the EXE, and i &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;get the error that the DLL is not there .. :(&lt;/FONT&gt;

&lt;FONT COLOR=&quot;#000000&quot;&gt;this is the code that i'm using           &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;            Assembly a = Assembly.Load(&amp;quot;DLLImport.dll&amp;quot;);&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;            Type[] types = a.GetTypes(  );&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;            foreach(Type t in types)&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;            {&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;                    Console.WriteLine(&amp;quot;Type is {0}&amp;quot;, t);&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;            }&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;            Console.WriteLine(&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;               &amp;quot;{0} types found&amp;quot;, types.Length);&lt;/FONT&gt;

&lt;FONT COLOR=&quot;#000000&quot;&gt;The DLL that i'm trying to import is a test one, with and method that &lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;return one number.&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;Anyone can help me ????&lt;/FONT&gt;


&lt;FONT COLOR=&quot;#000000&quot;&gt;(())&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;Paulo Aboim Pinto&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;From: Portugal&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;_______________________________________________&lt;/FONT&gt;
&lt;FONT COLOR=&quot;#000000&quot;&gt;Monodevelop-list mailing list&lt;/FONT&gt;
&lt;A HREF=&quot;mailto:<A HREF="mailto:Monodevelop-list@lists.ximian.com">Monodevelop-list@lists.ximian.com</A>&quot;&gt;<A HREF="mailto:Monodevelop-list@lists.ximian.com">Monodevelop-list@lists.ximian.com</A>&lt;/A&gt;
&lt;A HREF=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list"">http://lists.ximian.com/mailman/listinfo/monodevelop-list&quot;</A>&gt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list</A">http://lists.ximian.com/mailman/listinfo/monodevelop-list&lt;/A</A>&gt;
&lt;/PRE&gt;
&lt;/BLOCKQUOTE&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

--=-JeMGvg/B6+vNxEM4Ypum--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000671.html">[MonoDevelop] Trying to Load assemblyes &quot;on-the-fly&quot;
</A></li>
	<LI> Next message: <A HREF="000673.html">[MonoDevelop] Trying to Load assemblyes &quot;on-the-fly&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#672">[ date ]</a>
              <a href="thread.html#672">[ thread ]</a>
              <a href="subject.html#672">[ subject ]</a>
              <a href="author.html#672">[ author ]</a>
         </LI>
       </UL>
</body></html>
