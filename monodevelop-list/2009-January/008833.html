<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] CopyToOutputDirectory for external files
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20CopyToOutputDirectory%20for%20external%20files&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008832.html">
   <LINK REL="Next"  HREF="008838.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] CopyToOutputDirectory for external files</H1>
    <B>Sam Chuparkoff</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20CopyToOutputDirectory%20for%20external%20files&In-Reply-To="
       TITLE="[MonoDevelop] CopyToOutputDirectory for external files">sdc at sadach.org
       </A><BR>
    <I>Thu Jan 15 00:09:49 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="008832.html">[MonoDevelop] How to debug MD in MD?
</A></li>
        <LI>Next message: <A HREF="008838.html">[MonoDevelop] CopyToOutputDirectory for external files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8833">[ date ]</a>
              <a href="thread.html#8833">[ thread ]</a>
              <a href="subject.html#8833">[ subject ]</a>
              <a href="author.html#8833">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The fix for Bug 459311 - Copying files to output directory in
MonoDevelop breaks copies of &quot;linked&quot; files or &quot;External files&quot; for
me.

Here is is a patch that adds a couple of new files to the unit tests
to demonstrate this problem. Prior to r123145, these checks would have
passed. Post r123145, I instead see files getting copied outside of
the output directory, like this:

bin/Release/foo/bar.txt
bin/Release/TextFile1.txt
bin/Release/ClassLibrary1.dll
bin/Release/ClassLibrary2.dll
bin/Release/ClassLibrary4.dll
bin/Release/VSLocalCopyTest.exe
bin/Release/folder/baz.txt
bin/solution-folder/app.config
bin/solution-folder/quux.txt

sdc

---
 .../MonoDevelop.Projects/LocalCopyTests.cs         |    4 ++++
 .../VSLocalCopyTest/VSLocalCopyTest.csproj         |    8 ++++++++
 .../vs-local-copy/solution-folder/app.config       |    3 +++
 .../vs-local-copy/solution-folder/quux.txt         |    1 +
 4 files changed, 16 insertions(+), 0 deletions(-)
 create mode 100644 main/tests/test-projects/vs-local-copy/solution-folder/app.config
 create mode 100644 main/tests/test-projects/vs-local-copy/solution-folder/quux.txt

diff --git a/main/tests/UnitTests/MonoDevelop.Projects/LocalCopyTests.cs b/main/tests/UnitTests/MonoDevelop.Projects/LocalCopyTests.cs
index a29a196..4497abb 100644
--- a/main/tests/UnitTests/MonoDevelop.Projects/LocalCopyTests.cs
+++ b/main/tests/UnitTests/MonoDevelop.Projects/LocalCopyTests.cs
@@ -63,6 +63,8 @@ namespace MonoDevelop.Projects
 				&quot;TextFile1.txt&quot;,
 				&quot;folder/baz.txt&quot;,
 				&quot;foo/bar.txt&quot;,
+				&quot;quux.txt&quot;,
+				&quot;VSLocalCopyTest.exe.config&quot;,
 			});
 			
 			//FIXME: all of these should have mdb files in release mode.
@@ -75,6 +77,8 @@ namespace MonoDevelop.Projects
 				&quot;TextFile1.txt&quot;,
 				&quot;folder/baz.txt&quot;,
 				&quot;foo/bar.txt&quot;,
+				&quot;quux.txt&quot;,
+				&quot;VSLocalCopyTest.exe.config&quot;,
 			});
 			
 			AssertOutputFiles (sol, &quot;ClassLibrary1&quot;, &quot;Debug&quot;, new string[] {
diff --git a/main/tests/test-projects/vs-local-copy/VSLocalCopyTest/VSLocalCopyTest.csproj b/main/tests/test-projects/vs-local-copy/VSLocalCopyTest/VSLocalCopyTest.csproj
index aae3c01..1a06466 100755
--- a/main/tests/test-projects/vs-local-copy/VSLocalCopyTest/VSLocalCopyTest.csproj
+++ b/main/tests/test-projects/vs-local-copy/VSLocalCopyTest/VSLocalCopyTest.csproj
@@ -49,6 +49,14 @@
       &lt;CopyToOutputDirectory&gt;Always&lt;/CopyToOutputDirectory&gt;
     &lt;/Content&gt;
   &lt;/ItemGroup&gt;
+  &lt;ItemGroup&gt;
+    &lt;None Include=&quot;..\solution-folder\app.config&quot;&gt;
+      &lt;CopyToOutputDirectory&gt;Always&lt;/CopyToOutputDirectory&gt;
+    &lt;/None&gt;
+    &lt;Content Include=&quot;..\solution-folder\quux.txt&quot;&gt;
+      &lt;CopyToOutputDirectory&gt;Always&lt;/CopyToOutputDirectory&gt;
+    &lt;/Content&gt;
+  &lt;/ItemGroup&gt;
   &lt;Import Project=&quot;$(MSBuildToolsPath)\Microsoft.CSharp.targets&quot; /&gt;
   &lt;!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
        Other similar extension points exist, see Microsoft.Common.targets.
diff --git a/main/tests/test-projects/vs-local-copy/solution-folder/app.config b/main/tests/test-projects/vs-local-copy/solution-folder/app.config
new file mode 100644
index 0000000..8675ceb
--- /dev/null
+++ b/main/tests/test-projects/vs-local-copy/solution-folder/app.config
@@ -0,0 +1,3 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
+&lt;configuration&gt;
+&lt;/configuration&gt;
\ No newline at end of file
diff --git a/main/tests/test-projects/vs-local-copy/solution-folder/quux.txt b/main/tests/test-projects/vs-local-copy/solution-folder/quux.txt
new file mode 100644
index 0000000..1bc3822
--- /dev/null
+++ b/main/tests/test-projects/vs-local-copy/solution-folder/quux.txt
@@ -0,0 +1 @@
+This is quux.txt
-- 
1.6.1

</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008832.html">[MonoDevelop] How to debug MD in MD?
</A></li>
	<LI>Next message: <A HREF="008838.html">[MonoDevelop] CopyToOutputDirectory for external files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8833">[ date ]</a>
              <a href="thread.html#8833">[ thread ]</a>
              <a href="subject.html#8833">[ subject ]</a>
              <a href="author.html#8833">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
