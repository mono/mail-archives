<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] &quot;Open for Edit&quot; command [VersionControl]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20%22Open%20for%20Edit%22%20command%20%5BVersionControl%5D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007938.html">
   <LINK REL="Next"  HREF="008030.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] &quot;Open for Edit&quot; command [VersionControl]</H1>
    <B>Casey Marshall</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20%22Open%20for%20Edit%22%20command%20%5BVersionControl%5D&In-Reply-To="
       TITLE="[MonoDevelop] &quot;Open for Edit&quot; command [VersionControl]">cmarshall at pacificbiosciences.com
       </A><BR>
    <I>Tue Jul  8 20:50:00 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="007938.html">[MonoDevelop] Third part widgets
</A></li>
        <LI>Next message: <A HREF="008030.html">[MonoDevelop] &quot;Open for Edit&quot; command [VersionControl]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7936">[ date ]</a>
              <a href="thread.html#7936">[ thread ]</a>
              <a href="subject.html#7936">[ subject ]</a>
              <a href="author.html#7936">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Attached is a patch I'm using locally to better support my Perforce
VersionControl add-in, which I've had some good success with. This
change adds an &quot;Open for Edit&quot; command to the contextual menu, and adds
some new methods/properties to Repository to let version control systems
tell whether or not they need to support an edit command, and adds the
edit command itself. I don't know if the command appears for the SVN
addin, and don't know how these commands appear or not in the menu.

This change also adds a `RepositoryPath' property to ChangeSet, which is
hugely useful for generating perforce changelists.

I'll note a couple of things that were less than helpful in the
implementation:

  * GetPathToBaseText. Perforce doesn't keep local copies of the base
version (at least, I don't think it does), so I need to write a
temporary file to implement this. That's not too bad, but I don't know
how to get notified when that file isn't being used any more, and can be
deleted.

  * Incomplete (?) support for the RequestFileWritePermission part,
which makes opening and using a project a pain. I would settle for a way
to run the &quot;open for edit&quot; command on the project or solution, by
right-clicking on the project or solution entry in the solution browser.
Those are, I think, the only things you can't interact with in that
view.

  * (not related to MD, I'm just mentioning this) The Perforce C++ API
seems to dump the output of the &quot;diff&quot; command to the console, with no
way to intercept it. This makes implementing PathDiff more work than it
should be.

Also, on an entirely unrelated topic, I see that for MSBuild files, MD
considers a TargetFrameworkVersion of 3.5 to mean 2.0, which means that
when it writes out these files again, it will replace 3.5 with 2.0,
which is very undesirable.

Changelog for this patch:

2008-07-08  Casey Marshall  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">cmarshall at pacificbiosciences.com</A>&gt;

        * Makefile.am (FILES): add
        `MonoDevelop.VersionControl/EditCommand.cs'.
        * MonoDevelop.VersionControl.mdp: add
        `MonoDevelop.VersionControl/EditCommand'.
        * MonoDevelop.VersionControl/ChangeSet.cs
        (RepositoryPath): new property.
        * MonoDevelop.VersionControl/Commands.cs (Edit): new enum value.
        * MonoDevelop.VersionControl/EditCommand.cs: new file.
        * MonoDevelop.VersionControl/Repository.cs
        (CanEdit, EditFile): new methods.
        (EditCommandRequired): new property.
        * MonoDevelop.VersionControl/VersionControlNodeExtension.cs
        (OnEdit, UpdateEdit): new methods.
        (RunCommand): handle Commands.Edit.
        * VersionControl.addin.xml: add &quot;Open for Edit&quot; command.

These changes are released under the MIT/X11 license.

Comments or suggested changes are appreciated!

Thanks.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: editcommand.patch
Type: text/x-patch
Size: 9902 bytes
Desc: not available
Url : <A HREF="http://lists.ximian.com/pipermail/monodevelop-list/attachments/20080708/3411d728/attachment-0001.bin">http://lists.ximian.com/pipermail/monodevelop-list/attachments/20080708/3411d728/attachment-0001.bin</A> 
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007938.html">[MonoDevelop] Third part widgets
</A></li>
	<LI>Next message: <A HREF="008030.html">[MonoDevelop] &quot;Open for Edit&quot; command [VersionControl]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7936">[ date ]</a>
              <a href="thread.html#7936">[ thread ]</a>
              <a href="subject.html#7936">[ subject ]</a>
              <a href="author.html#7936">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
