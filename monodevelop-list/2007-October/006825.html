<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [MonoDevelop] Build reorganization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Build%20reorganization&In-Reply-To=aec34c770710291228m2b8aad2ehb7b31df46f7d78ba%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006804.html">
   <LINK REL="Next"  HREF="006776.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MonoDevelop] Build reorganization</H1>
    <B>Lluis Sanchez</B> 
    <A HREF="mailto:monodevelop-list%40lists.ximian.com?Subject=%5BMonoDevelop%5D%20Build%20reorganization&In-Reply-To=aec34c770710291228m2b8aad2ehb7b31df46f7d78ba%40mail.gmail.com"
       TITLE="[MonoDevelop] Build reorganization">lluis at ximian.com
       </A><BR>
    <I>Wed Oct 31 05:14:57 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="006804.html">[MonoDevelop] Build reorganization
</A></li>
        <LI>Next message: <A HREF="006776.html">[MonoDevelop] monodevelop build from svn?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6825">[ date ]</a>
              <a href="thread.html#6825">[ thread ]</a>
              <a href="subject.html#6825">[ subject ]</a>
              <a href="author.html#6825">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>El dl 29 de 10 del 2007 a les 15:28 -0400, en/na Michael Hutchinson va
escriure:
&gt;<i> On 10/23/07, Lluis Sanchez &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-list">lluis at ximian.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Now that we are approaching the 1.0 release it would be good to
</I>&gt;<i> &gt; reorganize a bit our build system to make it more flexible and better
</I>&gt;<i> &gt; fit our release plans.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; My idea is to remove some of the add-ins from the main MD build, and
</I>&gt;<i> &gt; move them to a new &quot;Extras&quot; directory. Each add-in there would have its
</I>&gt;<i> &gt; own configuration script and build files, and we would publish an
</I>&gt;<i> &gt; independent tarball and package for each of them.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Which kind of add-ins would be moved to Extras?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;       * Add-ins which are not used by most of people and that have
</I>&gt;<i> &gt;         uncommon dependencies.
</I>&gt;<i> &gt;       * Add-ins which are not stable enough for a 1.0 release, and which
</I>&gt;<i> &gt;         we may want to ship independently.
</I>&gt;<i> &gt;       * Add-ins which are not arch-independent (we don't have them right
</I>&gt;<i> &gt;         now, but maybe in the future).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The idea is to keep a Core MD build, with a limited and controlled
</I>&gt;<i> &gt; number of dependencies, fully managed and stable. On the other hand keep
</I>&gt;<i> &gt; a directory with add-ins with rare dependencies, or which are under
</I>&gt;<i> &gt; development.
</I>&gt;<i> 
</I>&gt;<i> IMO we should move to a three level system -- Core, Main and Extras.
</I>&gt;<i> Core would contain the addins that are used as dependencies -- so they
</I>&gt;<i> need to have a stable API, assembly versioning, API documentation
</I>&gt;<i> and.pc files.
</I>&gt;<i> 
</I>&gt;<i> Main would be for addins that are supported/stable, and don't have
</I>&gt;<i> unusual dependencies.
</I>&gt;<i> 
</I>&gt;<i> Extras would be as you describe.
</I>&gt;<i> 
</I>&gt;<i> &gt; I think this setup is more convenient than what we have now to make MD
</I>&gt;<i> &gt; grow after the 1.0 release. The current way of adding new add-ins, which
</I>&gt;<i> &gt; involves changing the main configuration script to add add-in specific
</I>&gt;<i> &gt; checks and a new configuration flag for enabling/disabling the add-in is
</I>&gt;<i> &gt; anything but flexible and scalable.
</I>&gt;<i> 
</I>&gt;<i> Agreed. However, it does have one nice advantage -- &quot;make run&quot;, which
</I>&gt;<i> is incredibly useful while working on MD. It may be hard to duplicate
</I>&gt;<i> this properly with a fragmented build.
</I>
I think we can still easily support it.

&gt;<i> 
</I>&gt;<i> &gt; Following this idea, the Core MD build might include:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;       * MonoDevelop.Core
</I>&gt;<i> &gt;       * MonoDevelop.Core.Gui
</I>&gt;<i> &gt;       * MonoDevelop.Projects
</I>&gt;<i> &gt;       * MonoDevelop.Projects.Gui
</I>&gt;<i> &gt;       * MonoDevelop.Ide
</I>&gt;<i> &gt;       * MonoDevelop.Deployment
</I>&gt;<i> &gt;       * MonoDevelop.Autotools
</I>&gt;<i> &gt;       * MonoDevelop.DesignerSupport
</I>&gt;<i> + NRefactory
</I>&gt;<i> 
</I>&gt;<i> And in Main:
</I>&gt;<i> &gt;       * AspNetAddIn
</I>&gt;<i> &gt;       * CBinding
</I>&gt;<i> &gt;       * ChangeLogAddIn
</I>&gt;<i> &gt;       * CSharpBinding
</I>&gt;<i> &gt;       * VBNetBinding
</I>&gt;<i> &gt;       * ILAsmBinding
</I>&gt;<i> &gt;       * VersionControl
</I>&gt;<i> &gt;       * WelcomePage
</I>&gt;<i> &gt;       * MonoDevelop.Gettext
</I>&gt;<i> &gt;       * MonoDevelop.GtkCore
</I>&gt;<i> &gt;       * MonoDevelop.RegexToolkit
</I>&gt;<i> &gt;       * MonoDevelop.SourceEditor
</I>&gt;<i> &gt;       * MonoDevelop.WebReferences
</I>&gt;<i> &gt;       * NUnit
</I>&gt;<i> &gt;       * MonoDeveloperExtensions
</I>&gt;<i> &gt;       * prj2make-sharp-lib
</I>&gt;<i>  * MonoDevelop.Database
</I>&gt;<i> 
</I>&gt;<i> &gt; And we would move to the new Extras directory:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;       * AspNetEdit
</I>&gt;<i> &gt;       * BooBinding
</I>&gt;<i> &gt;       * GtkSharpLibs
</I>&gt;<i> &gt;       * JavaBinding
</I>&gt;<i> &gt;       * NemerleBinding
</I>&gt;<i> &gt;       * PythonBinding
</I>&gt;<i> * MonoDevelop.Database database and designer addins
</I>&gt;<i> 
</I>&gt;<i> &gt; I still don't know what's the best way of implement this new build
</I>&gt;<i> &gt; system, but in any case, this split should not make MD more difficult to
</I>&gt;<i> &gt; build or package.
</I>&gt;<i> 
</I>&gt;<i> or develop :)
</I>&gt;<i> 
</I>&gt;<i> &gt; Ideas are welcome!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Here is mine:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In the MD SVN module create this directory structure:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; /MonoDevelop
</I>&gt;<i> &gt;     Main
</I>&gt;<i> &gt;         Core (current src/Core)
</I>&gt;<i> &gt;         Addins (core add-ins listed above)
</I>&gt;<i> 
</I>&gt;<i> Well, I should have read this bit more carefully before re-proposing a
</I>&gt;<i> three-level system :-) That said, I still suggest we move some stuff
</I>&gt;<i> into Core. Dependency tracking within the build is bound to be a
</I>&gt;<i> problem -- one thing I'd like to have is for addins to depend upon the
</I>&gt;<i> dlls of their references, so that we don't get broken builds due to
</I>&gt;<i> API changes.
</I>
The problem with that is that you may end much many assemblies than
needed, even when it's not necessary.

&gt;<i> 
</I>&gt;<i> &gt;     Extras
</I>&gt;<i> &gt;         all other add-ins
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Move the current main config script and makefile to Main. Create a new
</I>&gt;<i> &gt; config script and makefiles for each add-in in Extras.
</I>&gt;<i> 
</I>&gt;<i> Okay, makes sense. The Extras need to have a configurable MD location
</I>&gt;<i> to build against so that they can be integrated cleanly into the main
</I>&gt;<i> build.
</I>&gt;<i> 
</I>&gt;<i> They should also have a command to build an mpack file and install it
</I>&gt;<i> into the user's .config directory.
</I>&gt;<i> 
</I>&gt;<i> I propose we have a bunch of helper scripts and M4 macros (see
</I>&gt;<i> banshee's macros for an example).
</I>
I rather prefer using simple makefiles not based on autotools.

&gt;<i> 
</I>&gt;<i> There may also be problems with opening the MD solution with Extras
</I>&gt;<i> addins in it. It would be nice to have a local .pc file directory
</I>&gt;<i> within the build directory, so that the Extras addins could have their
</I>&gt;<i> own solutions that would be opened independently, while referencing
</I>&gt;<i> the locally built dlls rather than the installed/system dlls.
</I>
or we can just use assembly references.

&gt;<i> 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Create a new global config script and makefile. This script would take
</I>&gt;<i> &gt; as parameter a build profile name, which would also be the name of a
</I>&gt;<i> &gt; file containing a list of 'packages' to build. For example a 'core'
</I>&gt;<i> &gt; profile would contain only Main. A 'dist' profile would contain Main and
</I>&gt;<i> &gt; all add-ins in Extras we usually publish. An 'all' profile would include
</I>&gt;<i> &gt; everything.
</I>&gt;<i> 
</I>&gt;<i> Sounds good. We could put the profiles in a &quot;profiles&quot; dir. There
</I>&gt;<i> should also be a command to publish a set of mpacks to a repository.
</I>&gt;<i> 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; After configuring the build, 'make' would build all directories included
</I>&gt;<i> &gt; in the profile, 'make dist' would create a tarball for each of those
</I>&gt;<i> &gt; directories, and so on.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This setup may not be very common. I don't know how other applications
</I>&gt;<i> &gt; based on add-ins do it, so feedback is welcome.
</I>&gt;<i> 
</I>&gt;<i> Anything addin-based is bound to have problems integrating with distro
</I>&gt;<i> package management. It would be really cool if we could generate and
</I>&gt;<i> install RPMs and DEBs directly, both for MD core and for the extras.
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006804.html">[MonoDevelop] Build reorganization
</A></li>
	<LI>Next message: <A HREF="006776.html">[MonoDevelop] monodevelop build from svn?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6825">[ date ]</a>
              <a href="thread.html#6825">[ thread ]</a>
              <a href="subject.html#6825">[ subject ]</a>
              <a href="author.html#6825">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-list">More information about the Monodevelop-list
mailing list</a><br>
</body></html>
