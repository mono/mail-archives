<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r2572 - in trunk/MonoDevelop/Core/src:	MonoDevelop.Base MonoDevelop.Base/Gui/Workbench/Layouts	MonoDevelop.Base/Services MonoDevelop.Core MonoDevelop.Core/Services
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2572%20-%20in%20trunk/MonoDevelop/Core/src%3A%0A%09MonoDevelop.Base%20MonoDevelop.Base/Gui/Workbench/Layouts%0A%09MonoDevelop.Base/Services%20MonoDevelop.Core%20MonoDevelop.Core/Services&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002171.html">
   <LINK REL="Next"  HREF="002173.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r2572 - in trunk/MonoDevelop/Core/src:	MonoDevelop.Base MonoDevelop.Base/Gui/Workbench/Layouts	MonoDevelop.Base/Services MonoDevelop.Core MonoDevelop.Core/Services</H1>
    <B>Jacob Ils&#248; Christensen &lt;jacobilsoe@gmail.com&gt;</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2572%20-%20in%20trunk/MonoDevelop/Core/src%3A%0A%09MonoDevelop.Base%20MonoDevelop.Base/Gui/Workbench/Layouts%0A%09MonoDevelop.Base/Services%20MonoDevelop.Core%20MonoDevelop.Core/Services&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r2572 - in trunk/MonoDevelop/Core/src:	MonoDevelop.Base MonoDevelop.Base/Gui/Workbench/Layouts	MonoDevelop.Base/Services MonoDevelop.Core MonoDevelop.Core/Services">jacobilsoe at mono-cvs.ximian.com
       </A><BR>
    <I>Wed Jun  1 09:41:24 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002171.html">[Monodevelop-patches-list] r2571 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: .	Gui/Dialogs/ReferenceDialog
</A></li>
        <LI>Next message: <A HREF="002173.html">[Monodevelop-patches-list] r2573 - in trunk/MonoDevelop/Core/src:	MonoDevelop.Base MonoDevelop.Base/Gui/Pads/FileScout	MonoDevelop.Base/Gui/Workbench/Layouts MonoDevelop.Gui.Utils	MonoDevelop.Gui.Utils/FileIcons MonoDevelop.Gui.Widgets	MonoDevelop.Gui.Widgets/FileBrowser
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2172">[ date ]</a>
              <a href="thread.html#2172">[ thread ]</a>
              <a href="subject.html#2172">[ subject ]</a>
              <a href="author.html#2172">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jacobilsoe
Date: 2005-06-01 09:41:24 -0400 (Wed, 01 Jun 2005)
New Revision: 2572

Modified:
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/MessageService.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Core/ChangeLog
   trunk/MonoDevelop/Core/src/MonoDevelop.Core/Services/IMessageService.cs
Log:
Added a cancel option when trying to close a modified file

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog	2005-06-01 13:35:49 UTC (rev 2571)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog	2005-06-01 13:41:24 UTC (rev 2572)
@@ -1,5 +1,12 @@
 2005-06-01  Jacob Ils&#248; Christensen  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jacobilsoe at gmail.com</A>&gt;
 
+	* Services/MessageService.cs: Added methods to ask a question
+	with a cancel option.
+	* Gui/Workbench/Layouts/SdiWorkspaceWindow.cs: Added a cancel
+	option when trying to close a modified file.
+
+2005-06-01  Jacob Ils&#248; Christensen  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jacobilsoe at gmail.com</A>&gt;
+
 	* Gui/Dialogs/ReferenceDialog/SelectReferenceDialog.cs:
 	* Gui/Dialogs/ReferenceDialog/ProjectReferencePanel.cs:
 	* Gui/Dialogs/ReferenceDialog/GacReferencePanel.cs:

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs	2005-06-01 13:35:49 UTC (rev 2571)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs	2005-06-01 13:41:24 UTC (rev 2572)
@@ -209,9 +209,13 @@
 		{
 			if (!force &amp;&amp; ViewContent != null &amp;&amp; ViewContent.IsDirty) {
 				
-				bool save = Runtime.MessageService.AskQuestion (GettextCatalog.GetString (&quot;Do you want to save the current changes&quot;));
+				QuestionResponse response = Runtime.MessageService.AskQuestionWithCancel (GettextCatalog.GetString (&quot;Do you want to save the current changes&quot;));
 				
-				if (save) {
+				if (response == QuestionResponse.Cancel) {
+					return;
+				}
+
+				if (response == QuestionResponse.Yes) {
 					if (content.ContentName == null) {
 						while (true) {
 							Runtime.FileService.SaveFileAs (this);

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/MessageService.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/MessageService.cs	2005-06-01 13:35:49 UTC (rev 2571)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/MessageService.cs	2005-06-01 13:41:24 UTC (rev 2572)
@@ -116,7 +116,50 @@
 		{
 			return AskQuestion(stringParserService.Parse(question), GettextCatalog.GetString (&quot;Question&quot;));
 		}
+
+		public QuestionResponse AskQuestionWithCancel(string question, string caption)
+		{
+			using (Gtk.MessageDialog md = new Gtk.MessageDialog ((Gtk.Window) WorkbenchSingleton.Workbench, Gtk.DialogFlags.Modal | Gtk.DialogFlags.DestroyWithParent, Gtk.MessageType.Question, Gtk.ButtonsType.None, question)) {
+				
+				md.AddActionWidget (new Button (Gtk.Stock.No), ResponseType.No);
+				md.AddActionWidget (new Button (Gtk.Stock.Cancel), ResponseType.Cancel);
+				md.AddActionWidget (new Button (Gtk.Stock.Yes), ResponseType.Yes);
+				md.ActionArea.ShowAll ();
+				
+				Gtk.ResponseType response = (Gtk.ResponseType)md.Run ();
+				md.Hide ();
+
+				if (response == Gtk.ResponseType.Yes) {
+					return QuestionResponse.Yes;
+				}
+
+				if (response == Gtk.ResponseType.No) {
+					return QuestionResponse.No;
+				}
+
+				if (response == Gtk.ResponseType.Cancel) {
+					return QuestionResponse.Cancel;
+				}
+
+				return QuestionResponse.Cancel;
+			}
+		}
 		
+		public QuestionResponse AskQuestionFormattedWithCancel(string caption, string formatstring, params string[] formatitems)
+		{
+			return AskQuestionWithCancel(String.Format(stringParserService.Parse(formatstring), formatitems), caption);
+		}
+		
+		public QuestionResponse AskQuestionFormattedWithCancel(string formatstring, params string[] formatitems)
+		{
+			return AskQuestionWithCancel(String.Format(stringParserService.Parse(formatstring), formatitems));
+		}
+		
+		public QuestionResponse AskQuestionWithCancel(string question)
+		{
+			return AskQuestionWithCancel(stringParserService.Parse(question), GettextCatalog.GetString (&quot;Question&quot;));
+		}
+		
 		public int ShowCustomDialog(string caption, string dialogText, params string[] buttontexts)
 		{
 			// TODO

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Core/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Core/ChangeLog	2005-06-01 13:35:49 UTC (rev 2571)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Core/ChangeLog	2005-06-01 13:41:24 UTC (rev 2572)
@@ -1,3 +1,8 @@
+2005-06-01  Jacob Ils&#248; Christensen  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jacobilsoe at gmail.com</A>&gt;
+
+	* Services/IMessageService.cs: Added methods to ask a question
+	with a cancel option.
+
 2005-04-25  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at novell.com</A>&gt;
 
 	* AddIns/AddIn.cs: Added GetType method.

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Core/Services/IMessageService.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Core/Services/IMessageService.cs	2005-06-01 13:35:49 UTC (rev 2571)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Core/Services/IMessageService.cs	2005-06-01 13:41:24 UTC (rev 2572)
@@ -12,6 +12,13 @@
 
 namespace MonoDevelop.Core.Services
 {
+	public enum QuestionResponse
+	{
+		Yes,
+		No,
+		Cancel
+	}
+	
 	/// &lt;summary&gt;
 	/// This interface must be implemented by all services.
 	/// &lt;/summary&gt;
@@ -41,6 +48,11 @@
 		bool AskQuestionFormatted(string formatstring, params string[] formatitems);
 		bool AskQuestion(string question, string caption);
 		bool AskQuestionFormatted(string caption, string formatstring, params string[] formatitems);
+
+		QuestionResponse AskQuestionWithCancel(string question);
+		QuestionResponse AskQuestionFormattedWithCancel(string formatstring, params string[] formatitems);
+		QuestionResponse AskQuestionWithCancel(string question, string caption);
+		QuestionResponse AskQuestionFormattedWithCancel(string caption, string formatstring, params string[] formatitems);
 		
 		// used to return text input from a user in response to a question
 		string GetTextResponse(string question, string caption, string initialValue);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002171.html">[Monodevelop-patches-list] r2571 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: .	Gui/Dialogs/ReferenceDialog
</A></li>
	<LI>Next message: <A HREF="002173.html">[Monodevelop-patches-list] r2573 - in trunk/MonoDevelop/Core/src:	MonoDevelop.Base MonoDevelop.Base/Gui/Pads/FileScout	MonoDevelop.Base/Gui/Workbench/Layouts MonoDevelop.Gui.Utils	MonoDevelop.Gui.Utils/FileIcons MonoDevelop.Gui.Widgets	MonoDevelop.Gui.Widgets/FileBrowser
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2172">[ date ]</a>
              <a href="thread.html#2172">[ thread ]</a>
              <a href="subject.html#2172">[ subject ]</a>
              <a href="author.html#2172">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
