<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1697 - in trunk/MonoDevelop: gdldock/test src/Libraries src/Libraries/Gdl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1697%20-%20in%20trunk/MonoDevelop%3A%20gdldock/test%20src/Libraries%20src/Libraries/Gdl&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001303.html">
   <LINK REL="Next"  HREF="001305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1697 - in trunk/MonoDevelop: gdldock/test src/Libraries src/Libraries/Gdl</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1697%20-%20in%20trunk/MonoDevelop%3A%20gdldock/test%20src/Libraries%20src/Libraries/Gdl&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1697 - in trunk/MonoDevelop: gdldock/test src/Libraries src/Libraries/Gdl">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sun Jun  6 15:34:37 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001303.html">[Monodevelop-patches-list] r1696 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: . Gui
</A></li>
        <LI>Next message: <A HREF="001305.html">[Monodevelop-patches-list] r1698 - in trunk/MonoDevelop/src/Libraries/MonoDevelop.Gui.Widgets: . TabLabel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1304">[ date ]</a>
              <a href="thread.html#1304">[ thread ]</a>
              <a href="subject.html#1304">[ subject ]</a>
              <a href="author.html#1304">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-06-06 15:34:37 -0400 (Sun, 06 Jun 2004)
New Revision: 1697

Added:
   trunk/MonoDevelop/src/Libraries/Gdl/
   trunk/MonoDevelop/src/Libraries/Gdl/AssemblyInfo.cs
   trunk/MonoDevelop/src/Libraries/Gdl/Dock.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockItemBehavior.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockItemFlags.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockMaster.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockObject.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockObjectFlags.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockParamFlags.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockPlacement.cs
   trunk/MonoDevelop/src/Libraries/Gdl/DockRequest.cs
   trunk/MonoDevelop/src/Libraries/Gdl/Gdl.cmbx
   trunk/MonoDevelop/src/Libraries/Gdl/Gdl.mdsx
   trunk/MonoDevelop/src/Libraries/Gdl/Gdl.prjx
   trunk/MonoDevelop/src/Libraries/Gdl/Makefile.Gdl
   trunk/MonoDevelop/src/Libraries/Gdl/Makefile.solution.Gdl
   trunk/MonoDevelop/src/Libraries/Gdl/Stock.cs
   trunk/MonoDevelop/src/Libraries/Gdl/make.sh
Modified:
   trunk/MonoDevelop/gdldock/test/GdlDockTest.cs
   trunk/MonoDevelop/gdldock/test/Makefile
Log:
The start of the managed GdlDock, it doesnt compile at all, so dont expect it to i just need toget it the fuck off my HD, cause i trust this fucker about as far as i can throw it.

Also, some Makefile/other updates to the existing GdlDockTest stuff.


Modified: trunk/MonoDevelop/gdldock/test/GdlDockTest.cs
===================================================================
--- trunk/MonoDevelop/gdldock/test/GdlDockTest.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/gdldock/test/GdlDockTest.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -25,19 +25,19 @@
 		Dock dock = new Dock ();
 		DockLayout layout = new DockLayout (dock);
 		
-		DockItem di = new DockItem (&quot;item1&quot;, &quot;Item #1&quot;, DockItemBehavior.Locked);
+		DockItem di = new DockItem (&quot;item1&quot;, &quot;Item #1&quot;, DockItemBehavior.Normal);
 		di.Add (new Label (&quot;test&quot;));
 		dock.AddItem (di, DockPlacement.Right);
 		
-		DockItem di2 = new DockItem (&quot;item2&quot;, &quot;Item #2&quot;, DockItemBehavior.Locked);
+		DockItem di2 = new DockItem (&quot;item2&quot;, &quot;Item #2&quot;, DockItemBehavior.Normal);
 		di2.Add (new Label (&quot;test2&quot;));
-		dock.AddItem (di2, DockPlacement.Bottom);
+		dock.AddItem (di2, DockPlacement.Right);
 		
-		DockItem di3 = new DockItem (&quot;item3&quot;, &quot;Item #3&quot;, DockItemBehavior.Locked);
+		DockItem di3 = new DockItem (&quot;item3&quot;, &quot;Item #3&quot;, DockItemBehavior.Normal);
 		di3.Add (new Label (&quot;test3&quot;));
-		dock.AddItem (di3, DockPlacement.Left);
+		dock.AddItem (di3, DockPlacement.Right);
 		
-		DockItem di4 = new DockItem (&quot;item4&quot;, &quot;Item #4&quot;, DockItemBehavior.Locked);
+		DockItem di4 = new DockItem (&quot;item4&quot;, &quot;Item #4&quot;, DockItemBehavior.Normal);
 		di4.Add (new Label (&quot;test4&quot;));
 		dock.AddItem (di4, DockPlacement.Top);
 		

Modified: trunk/MonoDevelop/gdldock/test/Makefile
===================================================================
--- trunk/MonoDevelop/gdldock/test/Makefile	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/gdldock/test/Makefile	2004-06-06 19:34:37 UTC (rev 1697)
@@ -1,7 +1,7 @@
 ASSEMBLY = ../../build/bin/GdlDockTest.exe
 
 all:
-	mcs -g GdlDockTest.cs /r:gtk-sharp.dll /r:../../build/bin/gdl-sharp.dll /r:gnome-sharp.dll -o $(ASSEMBLY)
+	mcs -g GdlDockTest.cs /pkg:gnome-sharp /r:../../build/bin/gdl-sharp.dll -o $(ASSEMBLY)
 
 run:
 	LD_LIBRARY_PATH=&quot;../../build/bin&quot; mono --debug $(ASSEMBLY)


Property changes on: trunk/MonoDevelop/src/Libraries/Gdl
___________________________________________________________________
Name: svn:ignore
   + Gdl.pidb


Added: trunk/MonoDevelop/src/Libraries/Gdl/AssemblyInfo.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/AssemblyInfo.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/AssemblyInfo.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,32 @@
+using System.Reflection;
+using System.Runtime.CompilerServices;
+
+// Information about this assembly is defined by the following
+// attributes.
+//
+// change them to the information which is associated with the assembly
+// you compile.
+
+[assembly: AssemblyTitle(&quot;&quot;)]
+[assembly: AssemblyDescription(&quot;&quot;)]
+[assembly: AssemblyConfiguration(&quot;&quot;)]
+[assembly: AssemblyCompany(&quot;&quot;)]
+[assembly: AssemblyProduct(&quot;&quot;)]
+[assembly: AssemblyCopyright(&quot;&quot;)]
+[assembly: AssemblyTrademark(&quot;&quot;)]
+[assembly: AssemblyCulture(&quot;&quot;)]
+
+// The assembly version has following format :
+//
+// Major.Minor.Build.Revision
+//
+// You can specify all values by your own or you can build default build and revision
+// numbers with the '*' character (the default):
+
+[assembly: AssemblyVersion(&quot;1.0.*&quot;)]
+
+// The following attributes specify the key for the sign of your assembly. See the
+// .NET Framework documentation for more information about signing.
+// This is not required, if you don't want signing let these attributes like they're.
+[assembly: AssemblyDelaySign(false)]
+[assembly: AssemblyKeyFile(&quot;&quot;)]

Added: trunk/MonoDevelop/src/Libraries/Gdl/Dock.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/Dock.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/Dock.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,270 @@
+// created on 05/06/2004 at 11:21 A
+
+using System;
+using Gtk;
+
+namespace Gdl
+{
+	public class Dock : DockObject
+	{
+		private DockObject root = null;
+		private bool floating;
+		private Widget window;
+		private bool auto_title;
+		private int float_x;
+		private int float_y;
+		private int width = -1;
+		private int height = -1;
+		private Gdk.GC xor_gc;
+		
+		public bool Floating {
+			get { return floating; }
+			set { floating = value; }
+		}
+		
+		public string DefaultTitle {
+			get {
+				if (this.Master != null)
+					return this.Master.DefaultTitle;
+				return null;
+			}
+			set {
+				if (this.Master != null)
+					this.Master.DefaultTitle = value;
+			}
+		}
+		
+		public int Width {
+			get { return width; }
+			set {
+				width = value;
+				if (this.floating &amp;&amp; this.window != null &amp;&amp; this.window is Gtk.Window)
+					((Gtk.Window)this.window).Resize (width, height);
+			}
+		}
+		
+		public int Height {
+			get { return height; }
+			set {
+				height = value;
+				if (this.floating &amp;&amp; this.window != null &amp;&amp; this.window is Gtk.Window)
+					((Gtk.Window)this.window).Resize (width, height);
+			}
+		}
+		
+		public int FloatX {
+			get { return float_x; }
+			set {
+				float_x = value;
+				if (this.floating &amp;&amp; this.window != null &amp;&amp; this.window is Gtk.Window)
+					((Gtk.Window)this.window).Resize (width, height);
+			}
+		}
+		
+		public int FloatY {
+			get { return float_y; }
+			set {
+				float_y = value;
+				if (this.floating &amp;&amp; this.window != null &amp;&amp; this.window is Gtk.Window)
+					((Gtk.Window)this.window).Resize (width, height);
+			}
+		}
+		
+		protected void OnSizeRequested (ref Gtk.Requisition requisition)
+		{
+			int border_width = this.BorderWidth;
+			if (this.root != null &amp;&amp; this.root.Visible)
+				this.root.SizeRequest (requisition);
+			else {
+				requisition.Width = 0;
+				requisition.Height = 0;
+			}
+			
+			requisition.Width += 2 * border_width;
+			requisition.Height += 2 * border_width;
+		}
+		
+		protected void OnSizeAllocated (ref Gdk.Rectangle allocation)
+		{
+			int border_width = this.BorderWidth;
+			allocation.X += border_width;
+			allocation.Y += border_width;
+			allocation.Width = Math.Max (1, allocation.Width - 2 * border_width);
+			allocation.Height = Math.Max (1, allocation.Height - 2 * border_width);
+			
+			if (this.root != null &amp;&amp; this.root.Visible)
+				this.root.SizeAllocate (allocation);
+		}
+		
+		protected void OnMapped ()
+		{
+			base.OnMapped ();
+			if (this.root != null) {
+				if (this.root.Visible &amp;&amp; !this.root.IsMapped)
+					this.root.Map ();
+			}
+		}
+		
+		protected void OnUnmapped ()
+		{
+			base.OnUnmapped ();
+			if (this.root != null) {
+				if (this.root.Visible &amp;&amp; this.root.IsMapped)
+					this.root.Unmap ();
+			}
+			if (this.window != null)
+				window.Unmap ();
+		}
+		
+		public override void Show ()
+		{
+			base.Show ();
+			if (this.floating &amp;&amp; this.window != null)
+				this.window.Show ();
+			/*PORT:
+			    if (GDL_DOCK_IS_CONTROLLER (dock)) {
+        gdl_dock_master_foreach_toplevel (GDL_DOCK_OBJECT_GET_MASTER (dock),
+                                          FALSE, (GFunc) gdl_dock_foreach_automatic,
+                                          gtk_widget_show);
+    			}
+			*/
+		}
+		
+		public override void Hide ()
+		{
+			base.Hide ();
+			if (this.floating &amp;&amp; this.window != null)
+				this.window.Hide ();
+			/*PORT:
+			    if (GDL_DOCK_IS_CONTROLLER (dock)) {
+        gdl_dock_master_foreach_toplevel (GDL_DOCK_OBJECT_GET_MASTER (dock),
+                                          FALSE, (GFunc) gdl_dock_foreach_automatic,
+                                          gtk_widget_hide);
+    		}*/
+		}
+		
+		protected override void OnAdded (Gtk.Widget widget)
+		{
+			DockItem child = widget as DockItem;
+			if (child == null)
+				return;
+			
+			AddItem (child, DockPlacement.Top);
+		}
+		
+		protected override void OnRemoved (Gtk.Widget widget)
+		{
+			bool was_visible = widget.Visible;
+			if (this.root == widget) {
+				this.root = null;
+				((DockObject)widget).DockObjectFlags &amp;= ~(DockObjectFlags.Attached);
+				widget.Unparent ();
+				if (was_visible &amp;&amp; this.Visible)
+					this.QueueResize ();
+			}
+		}
+		
+		protected override void ForAll (bool include_internals, CallbackInvoker invoker)
+		{
+			if (this.root)
+				invoker.Invoke (this.root);
+		}
+		
+		/*PORT THIS CODE: its an override of Container.ChildType
+		static GtkType
+gdl_dock_child_type (GtkContainer *container)
+{
+    return GDL_TYPE_DOCK_ITEM;
+}*/
+		
+		public override void Detach (bool recursive)
+		{
+			if (recursive &amp;&amp; this.root != null)
+				this.root.Detach (recursive);
+			this.DockObjectFlags &amp;= ~(DockObjectFlags.Attached);
+		}
+		
+		public override void Reduce ()
+		{
+			if (this.root != null)
+				return;
+			
+			if (this.IsAutomatic)
+				this.Destroy ();
+			else if (!(this.IsAttached)) {
+				if (this.floating)
+					this.Hide ();
+				else {
+					if (this.Parent &amp;&amp; this.Parent is Gtk.Container)
+						((Gtk.Container)this.Parent).Remove (this);
+				}
+			}
+		}
+		
+		public override bool DockRequest (int x, int y, DockRequest request)
+		{
+			Gdk.Rectangle alloc = this.Allocation;
+			uint bw = this.BorderWidth;
+			int rel_x = x - alloc.X;
+			int rel_y = y - alloc.Y;
+			DockRequest my_request = null;
+			bool may_dock = false;
+			
+			if (request != null)
+				my_request = request;
+				
+			if (rel_x &gt; 0 &amp;&amp; rel_x &lt; alloc.Width &amp;&amp; rel_y &gt; 0 &amp;&amp; rel_y &lt; alloc.Height) {
+				may_dock = true;
+				Gdk.Rectangle req_rect = new Gdk.Rectangle ();
+				req_rect.X = alloc.X + bw;
+				req_rect.Y = alloc.Y + bw;
+				req_rect.Width = alloc.Width - 2 * bw;
+				req_rect.Height = alloc.Height - 2 * bw;
+				my_request.Rect = req_rect;
+				
+				if (this.root == null) {
+					my_request.Position = DockPlacement.Top;
+					my_request.Target = this;
+				} else {
+					my_request.Target = this.root;
+					
+					if (rel_x &lt; bw) {
+						my_request.Position = DockPlacement.Left;
+						req_rect.Width *= 0.3;
+						my_request.Rect = req_rect;
+					} else if (rel_x &gt; alloc.Width - bw) {
+						my_request.Position = DockPlacement.Right;
+						req_rect.X += req_rect.Width * (1 - 0.3);
+						req_rect.Width *= 0.3;
+						my_request.Rect = req_rect;
+					} else if (rel_y &lt; bw) {
+						my_request.Position = DockPlacement.Top;
+						req_rect.Height *= 0.3;
+						my_request.Rect = req_rect;
+					} else if (rel_y &gt; alloc.Height - bw) {
+						my_request.Position = DockPlacement.Bottom;
+						req_rect.y += req_rect.Height * (1 - 0.3;
+						req_rect.Height *= 0.3;
+						my_request.Rect = req_rect;
+					} else {
+						may_dock = this.root.DockRequest (x, y, my_request);
+					}
+				}
+			}
+			
+			if (may_dock &amp;&amp; request != null)
+				request = my_request;
+			return may_dock;
+		}
+		
+		private void AddItem (DockItem item, DockPlacement placement)
+		{
+		}
+		
+		private bool IsController {
+			get {
+				return (this.Master.Controller == this); 
+			}
+		}
+	}
+}
\ No newline at end of file

Added: trunk/MonoDevelop/src/Libraries/Gdl/DockItemBehavior.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/DockItemBehavior.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/DockItemBehavior.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,27 @@
+// This file was generated by the Gtk# code generator.
+// Any changes made will be lost if regenerated.
+
+namespace Gdl {
+
+	using System;
+
+
+	[Flags]
+#region Autogenerated code
+	public enum DockItemBehavior {
+
+		Normal,
+		NeverFloating = 1 &lt;&lt; 0,
+		NeverVertical = 1 &lt;&lt; 1,
+		NeverHorizontal = 1 &lt;&lt; 2,
+		Locked = 1 &lt;&lt; 3,
+		CantDockTop = 1 &lt;&lt; 4,
+		CantDockBottom = 1 &lt;&lt; 5,
+		CantDockLeft = 1 &lt;&lt; 6,
+		CantDockRight = 1 &lt;&lt; 7,
+		CantDockCenter = 1 &lt;&lt; 8,
+		CantClose = 1 &lt;&lt; 9,
+		CantIconify = 1 &lt;&lt; 10,
+	}
+#endregion
+}

Copied: trunk/MonoDevelop/src/Libraries/Gdl/DockItemFlags.cs (from rev 1688, trunk/MonoDevelop/gdldock/gdl/DockItemFlags.cs)

Added: trunk/MonoDevelop/src/Libraries/Gdl/DockMaster.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/DockMaster.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/DockMaster.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,27 @@
+// created on 05/06/2004 at 11:14 A
+using System;
+using System.Collections;
+
+using Gtk;
+
+namespace Gdl
+{
+	public class DockMaster
+	{
+		private object obj;
+		private Hashtable dock_objects;
+		private ArrayList toplevel_docks;
+		private DockObject controller;
+		private int dock_number;
+		private int number;
+		private string default_title;
+		private Gdk.GC root_xor_gc;
+		private bool rect_drawn;
+		private Dock rect_owner;
+		private DockRequest drag_request;
+		private uint idle_layout_changed_id;
+		private Hashtable locked_items;
+		private Hashtable unlocked_items;
+		
+	}
+}
\ No newline at end of file

Added: trunk/MonoDevelop/src/Libraries/Gdl/DockObject.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/DockObject.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/DockObject.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,244 @@
+// project created on 04/06/2004 at 6:37 P
+using System;
+using Gtk;
+
+//FIXME: need to figure out how to handle reduce vmethod vs real_reduce vs
+//reduce public api... fucking gobject.
+
+//FIXME: Event emitting doesnt happen, and it needs to.
+namespace Gdl
+{
+	public class DockObject : Gtk.Container
+	{
+	
+		private static bool is_compound = true;
+	
+		private Gtk.Container container;
+		private Gdl.DockObjectFlags flags;
+		private int freeze_count;
+		private DockMaster master;
+		private string name;
+		private string long_name;
+		private string stock_id;
+		private bool reduce_pending;
+		
+		public string Name {
+			get { return name; }
+			set { name = value; }
+		}
+		
+		public string LongName {
+			get { return long_name; }
+			set { long_name = value; }
+		}
+		
+		public string StockId {
+			get { return stock_id; }
+			set { stock_id = value; }
+		}
+		
+		public DockMaster Master {
+			get { return master; }
+			set {
+				if (value != null)
+					this.Bind (master);
+				else
+					this.Unbind ();
+			}
+		}
+		
+		public virtual void Show ()
+		{
+			if (this.IsCompound) {
+				foreach (Gtk.Widget child in this.Children) {
+					child.Show ();
+				}
+			}
+			base.Show ();
+		}
+		
+		public virtual void Hide ()
+		{
+			if (this.IsCompound) {
+				foreach (Gtk.Widget child in this.Children) {
+					child.Hide ();
+				}
+			}
+			base.Hide ();
+		}
+		
+		public virtual void Detach (bool recursive)
+		{
+			//Detach children
+			if (recursive &amp;&amp; this.IsCompound) {
+				foreach (DockObject child in this.Children) {
+					child.Detach (recursive);
+				}
+			}
+			//Detach object itself.
+			this.flags &amp;= ~(DockObjectFlags.Attached);
+			DockObject parent = this.ParentObject;
+			if (this.Parent != null &amp;&amp; this.Parent is Gtk.Container) {
+				((Gtk.Container)this.Parent).Remove (this);
+			}
+			if (parent != null)
+				parent.Reduce ();
+		}
+		
+		
+		public virtual void Reduce ()
+		{
+			if (!this.IsCompound)
+				return
+				
+			Gdl.DockObject parent = this.ParentObject;
+			Gtk.Widget[] children = this.Children ();
+			if (children.Length &lt;= 1) {
+				if (parent != null)
+					parent.Freeze ();
+				this.Freeze ();
+				this.Detach (false);
+				foreach (Gtk.Widget widget in children) {
+					Gdl.DockObject child = widget as Gdl.DockObject;
+					if (child == null) continue;
+					child.flags |= Gdl.DockObjectFlags.InReflow;
+					child.Detach (false);
+					if (parent != null)
+						parent.Add (child);
+					child.flags &amp;= ~(Gdl.DockObjectFlags.InReflow);
+				}
+				reduce_pending = false;
+				this.Thaw ();
+				if (parent != null)
+					parent.Thaw ();
+			}
+		}
+		
+		public abstract bool DockRequest (int x, int y, DockRequest request);
+		
+		public virtual void Dock (Gdl.DockObject requestor, DockPlacement position, object other_data)
+		{
+			Gdl.DockObject parent;
+			if (requestor == null)
+				return;
+				
+			if (requestor == this)
+				return;
+			
+			if (this.master == null) {
+				Console.WriteLine (&quot;Dock operation requested in a non-bound object.&quot;);
+				Console.WriteLine (&quot;This might break.&quot;);
+			}
+			if (!requestor.IsBound ())
+				requestor.Bind (this.master);
+			if (requestor.Master != this.master) {
+				Console.WriteLine (&quot;Cannot complete dock as they belong to different masters.&quot;);
+				return;
+			}
+			//Attempt to optimize the placement with reordering (heh)
+			if (position != DockPlacement.None) {
+				if (this.Reorder (requestor, position, other_data) || (this.ParentObject != null &amp;&amp; this.ParentObject.Reorder (requestor, position, other_data)))
+					return;
+			}
+			this.Freeze ();
+			if (requestor.IsAttached)
+				requestor.Detach (false);
+			if (position != Gdl.DockPlacement.None) {
+				/*FIXME: port this code: 
+				g_signal_emit (object, gdl_dock_object_signals [DOCK], 0,
+				requestor, position, other_data);
+				*/
+			}
+			this.Thaw ();
+		}
+		
+		public abstract bool Reorder (DockObject child, DockPlacement new_position, object other_data);
+		
+		public virtual void Present (DockObject child)
+		{
+			this.Show ();
+		}
+		
+		public abstract bool ChildPlacement (DockObject child, DockPlacement placement);
+		
+		public bool IsCompound {
+			get {
+				return is_compound;
+			}
+		}
+		
+		public DockObject ParentObject {
+			get {
+				Widget parent = this.Parent;
+				while (parent != null &amp;&amp; !(parent is DockObject)) {
+					parent = parent.Parent;
+				}
+				return parent != null ? parent : null;
+			}
+		}
+		
+		public bool IsAttached {
+			get {
+				return ((this.flags &amp; Gdl.DockObjectFlags.Attached) != 0);
+			}
+		}
+		
+		public bool IsAutomatic {
+			get {
+				return ((this.flags &amp; Gdl.DockObjectFlags.Automatic) != 0);
+			}
+		}
+		
+		public void Freeze ()
+		{
+			freeze_count++;
+		}
+		
+		public void Thaw ()
+		{
+			freeze_count--;
+			if (freeze_count == 0 &amp;&amp; reduce_pending) {
+				reduce_pending = false;
+				this.Reduce ();
+			}
+		}
+		
+		public void Bind (DockMaster _master)
+		{
+			if (_master == null)
+				return;
+			if (this.master == _master)
+				return;
+			if (this._master != null) {
+				Console.WriteLine (&quot;Attempt to bind an already bound object&quot;);
+				return;
+			}
+			_master.Add (this);
+			this.master = _master;
+			//g_object_notify (G_OBJECT (object) /*this*/, &quot;master&quot;);
+		}
+		
+		public void Unbind ()
+		{
+			if (this.IsAttached)
+				this.Detach (true);
+			if (this.master != null) {
+				DockMaster _master = this.master;
+				this.master = null;
+				_master.Remove (this);
+				//g_object_notify (G_OBJECT (object) /*this*/, &quot;master&quot;);
+			}
+		}
+		
+		public bool IsBound {
+			get {
+				return this.master != null;
+			}
+		}
+		
+		public DockObjectFlags DockObjectFlags {
+			get { return this.flags; }
+			set { this.flags = value; }
+		}
+	}
+}
\ No newline at end of file

Added: trunk/MonoDevelop/src/Libraries/Gdl/DockObjectFlags.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/DockObjectFlags.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/DockObjectFlags.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,19 @@
+// This file was generated by the Gtk# code generator.
+// Any changes made will be lost if regenerated.
+
+namespace Gdl {
+
+	using System;
+
+
+	[Flags]
+#region Autogenerated code
+	public enum DockObjectFlags {
+
+		Automatic = 1 &lt;&lt; 0,
+		Attached = 1 &lt;&lt; 1,
+		InReflow = 1 &lt;&lt; 2,
+		InDetach = 1 &lt;&lt; 3,
+	}
+#endregion
+}

Copied: trunk/MonoDevelop/src/Libraries/Gdl/DockParamFlags.cs (from rev 1688, trunk/MonoDevelop/gdldock/gdl/DockParamFlags.cs)

Added: trunk/MonoDevelop/src/Libraries/Gdl/DockPlacement.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/DockPlacement.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/DockPlacement.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,20 @@
+// This file was generated by the Gtk# code generator.
+// Any changes made will be lost if regenerated.
+
+namespace Gdl {
+
+	using System;
+
+#region Autogenerated code
+	public enum DockPlacement {
+
+		None,
+		Top,
+		Bottom,
+		Right,
+		Left,
+		Center,
+		Floating,
+	}
+#endregion
+}

Added: trunk/MonoDevelop/src/Libraries/Gdl/DockRequest.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/DockRequest.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/DockRequest.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,42 @@
+// created on 04/06/2004 at 6:59 P
+
+using System;
+using Gtk;
+using Gdk;
+
+namespace Gdl
+{
+	public class DockRequest
+	{
+		private DockObject applicant;
+		private DockObject target;
+		private DockPlacement position;
+		private Rectangle rect;
+		private object extra;
+		
+		public DockObject Applicant {
+			get { return applicant; }
+			set { applicant = value; }
+		}
+		
+		public DockObject Target {
+			get { return target; }
+			set { target = value; }
+		}
+		
+		public DockPlacement Position {
+			get { return position; }
+			set { position = value; }
+		}
+		
+		public Rectangle Rect {
+			get { return rect; }
+			set { rect = value; }
+		}
+		
+		public object Extra {
+			get { return extra; }
+			set { extra = value; }
+		}
+	}
+}
\ No newline at end of file

Added: trunk/MonoDevelop/src/Libraries/Gdl/Gdl.cmbx
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/Gdl.cmbx	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/Gdl.cmbx	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,16 @@
+&lt;Combine fileversion=&quot;1.0&quot; name=&quot;Gdl&quot; description=&quot;&quot;&gt;
+  &lt;StartMode startupentry=&quot;Gdl&quot; single=&quot;True&quot;&gt;
+    &lt;Execute entry=&quot;Gdl&quot; type=&quot;None&quot; /&gt;
+  &lt;/StartMode&gt;
+  &lt;Entries&gt;
+    &lt;Entry filename=&quot;./Gdl.prjx&quot; /&gt;
+  &lt;/Entries&gt;
+  &lt;Configurations active=&quot;Debug&quot;&gt;
+    &lt;Configuration name=&quot;Release&quot;&gt;
+      &lt;Entry name=&quot;Gdl&quot; configurationname=&quot;Debug&quot; build=&quot;False&quot; /&gt;
+    &lt;/Configuration&gt;
+    &lt;Configuration name=&quot;Debug&quot;&gt;
+      &lt;Entry name=&quot;Gdl&quot; configurationname=&quot;Debug&quot; build=&quot;False&quot; /&gt;
+    &lt;/Configuration&gt;
+  &lt;/Configurations&gt;
+&lt;/Combine&gt;
\ No newline at end of file

Added: trunk/MonoDevelop/src/Libraries/Gdl/Gdl.mdsx
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/Gdl.mdsx	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/Gdl.mdsx	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,3 @@
+&lt;MonoDevelopSolution fileversion=&quot;1.0&quot;&gt;
+  &lt;RelativeOutputPath&gt;./build/bin&lt;/RelativeOutputPath&gt;
+&lt;/MonoDevelopSolution&gt;
\ No newline at end of file

Added: trunk/MonoDevelop/src/Libraries/Gdl/Gdl.prjx
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/Gdl.prjx	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/Gdl.prjx	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,37 @@
+&lt;Project name=&quot;Gdl&quot; description=&quot;&quot; newfilesearch=&quot;None&quot; enableviewstate=&quot;True&quot; version=&quot;1.1&quot; projecttype=&quot;C#&quot;&gt;
+  &lt;Contents&gt;
+    &lt;File name=&quot;./DockObject.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./AssemblyInfo.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./DockItemBehavior.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./DockItemFlags.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./DockObjectFlags.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./DockParamFlags.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./Stock.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./DockPlacement.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./DockRequest.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./DockMaster.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;./Dock.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+  &lt;/Contents&gt;
+  &lt;References&gt;
+    &lt;Reference type=&quot;Gac&quot; refto=&quot;gtk-sharp, Version=1.0.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f&quot; localcopy=&quot;True&quot; /&gt;
+    &lt;Reference type=&quot;Gac&quot; refto=&quot;gdk-sharp, Version=1.0.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f&quot; localcopy=&quot;True&quot; /&gt;
+  &lt;/References&gt;
+  &lt;DeploymentInformation target=&quot;&quot; script=&quot;&quot; strategy=&quot;File&quot; /&gt;
+  &lt;Configuration runwithwarnings=&quot;False&quot; name=&quot;Debug&quot;&gt;
+    &lt;CodeGeneration runtime=&quot;MsNet&quot; compiler=&quot;Csc&quot; warninglevel=&quot;4&quot; nowarn=&quot;&quot; includedebuginformation=&quot;True&quot; optimize=&quot;True&quot; unsafecodeallowed=&quot;False&quot; generateoverflowchecks=&quot;True&quot; mainclass=&quot;&quot; target=&quot;Library&quot; definesymbols=&quot;&quot; generatexmldocumentation=&quot;False&quot; win32Icon=&quot;&quot; /&gt;
+    &lt;Execution commandlineparameters=&quot;&quot; consolepause=&quot;False&quot; /&gt;
+    &lt;Output directory=&quot;./bin/Debug&quot; assembly=&quot;Gdl&quot; executeScript=&quot;&quot; executeBeforeBuild=&quot;&quot; executeAfterBuild=&quot;&quot; /&gt;
+  &lt;/Configuration&gt;
+  &lt;Configurations active=&quot;Debug&quot;&gt;
+    &lt;Configuration runwithwarnings=&quot;False&quot; name=&quot;Debug&quot;&gt;
+      &lt;CodeGeneration runtime=&quot;MsNet&quot; compiler=&quot;Csc&quot; warninglevel=&quot;4&quot; nowarn=&quot;&quot; includedebuginformation=&quot;True&quot; optimize=&quot;True&quot; unsafecodeallowed=&quot;False&quot; generateoverflowchecks=&quot;True&quot; mainclass=&quot;&quot; target=&quot;Library&quot; definesymbols=&quot;&quot; generatexmldocumentation=&quot;False&quot; win32Icon=&quot;&quot; /&gt;
+      &lt;Execution commandlineparameters=&quot;&quot; consolepause=&quot;False&quot; /&gt;
+      &lt;Output directory=&quot;./bin/Debug&quot; assembly=&quot;Gdl&quot; executeScript=&quot;&quot; executeBeforeBuild=&quot;&quot; executeAfterBuild=&quot;&quot; /&gt;
+    &lt;/Configuration&gt;
+    &lt;Configuration runwithwarnings=&quot;False&quot; name=&quot;Release&quot;&gt;
+      &lt;CodeGeneration runtime=&quot;MsNet&quot; compiler=&quot;Csc&quot; warninglevel=&quot;4&quot; nowarn=&quot;&quot; includedebuginformation=&quot;True&quot; optimize=&quot;True&quot; unsafecodeallowed=&quot;False&quot; generateoverflowchecks=&quot;True&quot; mainclass=&quot;&quot; target=&quot;Library&quot; definesymbols=&quot;&quot; generatexmldocumentation=&quot;False&quot; win32Icon=&quot;&quot; /&gt;
+      &lt;Execution commandlineparameters=&quot;&quot; consolepause=&quot;False&quot; /&gt;
+      &lt;Output directory=&quot;./bin/Release&quot; assembly=&quot;Gdl&quot; executeScript=&quot;&quot; executeBeforeBuild=&quot;&quot; executeAfterBuild=&quot;&quot; /&gt;
+    &lt;/Configuration&gt;
+  &lt;/Configurations&gt;
+&lt;/Project&gt;
\ No newline at end of file

Added: trunk/MonoDevelop/src/Libraries/Gdl/Makefile.Gdl
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/Makefile.Gdl	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/Makefile.Gdl	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,47 @@
+# This makefile is autogenerated by MonoDevelop
+# Do not modify this file
+
+SOURCES = \
+./DockObject.cs \
+./AssemblyInfo.cs \
+./DockItemBehavior.cs \
+./DockItemFlags.cs \
+./DockObjectFlags.cs \
+./DockParamFlags.cs \
+./Stock.cs \
+./DockPlacement.cs \
+./DockRequest.cs \
+./DockMaster.cs \
+./Dock.cs
+
+PKG_REFERENCES = \
+gtk-sharp
+
+PKG_REFERENCES_BUILD = $(addprefix -pkg:, $(PKG_REFERENCES))
+
+PKG_REFERENCES_CHECK = $(addsuffix .pkgcheck, $(PKG_REFERENCES))
+
+MCS_OPTIONS = 
+
+all: Gdl.dll
+
+Gdl.dll: $(SOURCES)
+	mcs $(MCS_OPTIONS) -target:library -out:&quot;Gdl.dll&quot; $(PKG_REFERENCES_BUILD) $(SOURCES) \
+	&amp;&amp; cp &quot;Gdl.dll&quot; ./build/bin
+
+clean:
+	rm -f Gdl.dll
+
+depcheck: PKG_depcheck 
+
+PKG_depcheck: $(PKG_REFERENCES_CHECK)
+
+%.pkgcheck:
+	@echo -n Checking for package $(subst .pkgcheck,,$@)...
+	@if pkg-config --libs $(subst .pkgcheck,,$@) &amp;&gt; /dev/null; then \
+		echo yes; \
+	else \
+		echo no; \
+		exit 1; \
+	fi
+

Added: trunk/MonoDevelop/src/Libraries/Gdl/Makefile.solution.Gdl
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/Makefile.solution.Gdl	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/Makefile.solution.Gdl	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,20 @@
+# This file is autogenerated by MonoDevelop
+# Do not edit it.
+
+OUTPUTDIR := ./build/bin
+
+all: depcheck __init Makefile.Gdl.all 
+
+__init:
+	mkdir -p $(OUTPUTDIR)
+
+clean: Makefile.Gdl.clean 
+
+depcheck: Makefile.Gdl.depcheck 
+
+run: all
+	cd $(OUTPUTDIR) &amp;&amp; mono Gdl.dll
+
+Makefile.Gdl.%:
+	@cd ./ &amp;&amp; $(MAKE) -f $(subst .$*,,$@) $*
+

Added: trunk/MonoDevelop/src/Libraries/Gdl/Stock.cs
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/Stock.cs	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/Stock.cs	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,24 @@
+// This file was generated by the Gtk# code generator.
+// Any changes made will be lost if regenerated.
+
+namespace Gdl {
+
+	using System;
+	using System.Collections;
+	using System.Runtime.InteropServices;
+
+#region Autogenerated code
+	public class Stock {
+
+		public static string Close {
+			 get { return &quot;gdl-close&quot;; }
+		}
+		public static string MenuLeft {
+			 get { return &quot;gdl-menu-left&quot;; }
+		}
+		public static string MenuRight {
+			 get { return &quot;gdl-menu-right&quot;; }
+		}
+#endregion
+	}
+}

Added: trunk/MonoDevelop/src/Libraries/Gdl/make.sh
===================================================================
--- trunk/MonoDevelop/src/Libraries/Gdl/make.sh	2004-06-06 17:27:22 UTC (rev 1696)
+++ trunk/MonoDevelop/src/Libraries/Gdl/make.sh	2004-06-06 19:34:37 UTC (rev 1697)
@@ -0,0 +1,5 @@
+#!/bin/sh
+# This file is autogenerated by MonoDevelop
+# Do not edit it.
+
+make -f Makefile.solution.Gdl &quot;$@&quot;


Property changes on: trunk/MonoDevelop/src/Libraries/Gdl/make.sh
___________________________________________________________________
Name: svn:executable
   + *


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001303.html">[Monodevelop-patches-list] r1696 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: . Gui
</A></li>
	<LI>Next message: <A HREF="001305.html">[Monodevelop-patches-list] r1698 - in trunk/MonoDevelop/src/Libraries/MonoDevelop.Gui.Widgets: . TabLabel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1304">[ date ]</a>
              <a href="thread.html#1304">[ thread ]</a>
              <a href="subject.html#1304">[ subject ]</a>
              <a href="author.html#1304">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
