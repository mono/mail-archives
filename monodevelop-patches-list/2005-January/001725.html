<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r2121 - in trunk/MonoDevelop/Extras/MonoQuery: . Collection Gui/Forms Gui/Forms/Glade Gui/MonoQueryTree SchemaClass
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2121%20-%20in%20trunk/MonoDevelop/Extras/MonoQuery%3A%20.%20Collection%20Gui/Forms%20Gui/Forms/Glade%20Gui/MonoQueryTree%20SchemaClass&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001724.html">
   <LINK REL="Next"  HREF="001726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r2121 - in trunk/MonoDevelop/Extras/MonoQuery: . Collection Gui/Forms Gui/Forms/Glade Gui/MonoQueryTree SchemaClass</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2121%20-%20in%20trunk/MonoDevelop/Extras/MonoQuery%3A%20.%20Collection%20Gui/Forms%20Gui/Forms/Glade%20Gui/MonoQueryTree%20SchemaClass&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r2121 - in trunk/MonoDevelop/Extras/MonoQuery: . Collection Gui/Forms Gui/Forms/Glade Gui/MonoQueryTree SchemaClass">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sat Jan  8 04:51:12 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001724.html">[Monodevelop-patches-list] r2120 - trunk/MonoDevelop/po
</A></li>
        <LI>Next message: <A HREF="001726.html">[Monodevelop-patches-list] r2122 - in trunk/MonoDevelop: Extras/MonoQuery Extras/MonoQuery/Gui/Forms build/data/resources/icons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1725">[ date ]</a>
              <a href="thread.html#1725">[ thread ]</a>
              <a href="subject.html#1725">[ subject ]</a>
              <a href="author.html#1725">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: chergert
Date: 2005-01-08 04:51:12 -0500 (Sat, 08 Jan 2005)
New Revision: 2121

Removed:
   trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/Glade/monoquery.glade
Modified:
   trunk/MonoDevelop/Extras/MonoQuery/ChangeLog
   trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryListDictionary.cs
   trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryStringDictionary.cs
   trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/CreateConnectionDruid.cs
   trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryDataNodes.cs
   trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryNodesRoot.cs
   trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryTree.cs
   trunk/MonoDevelop/Extras/MonoQuery/Makefile.am
   trunk/MonoDevelop/Extras/MonoQuery/SchemaClass/MonoQuerySchemaClass.cs
Log:
MonoQuery makefile fixes. Fixed the Create connection druid so that it
doesnt crash (this was caused by missing icons). Also updated the druid
to use an interface more like danmorg's sqlsharpgtk. Warning fixes during
the build.


Modified: trunk/MonoDevelop/Extras/MonoQuery/ChangeLog
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/ChangeLog	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/ChangeLog	2005-01-08 09:51:12 UTC (rev 2121)
@@ -1,3 +1,13 @@
+2005-01-08  Christian Hergert &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">chris at mosaix.net</A>&gt;
+	
+	* Following Makefile.am fixes
+	* Copy .addin.xml if it changes
+	* Fix setup to work if layout changes in the future
+	* If .addin.xml changes, only copy addin and not rebuild the dll
+	* Get package references from configure rather than statically
+	* Added files with GetString to the PO .in file
+	* Fixed a few warnings from build stage
+	
 2005-01-06  Christian Hergert &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">chris at mosaix.net</A>&gt;
 
 	* Initial creation of MonoQuery AddIn

Modified: trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryListDictionary.cs
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryListDictionary.cs	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryListDictionary.cs	2005-01-08 09:51:12 UTC (rev 2121)
@@ -49,7 +49,7 @@
 	   }
 	
 	   protected override void OnInsert( object key, object value )  {
-	      StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//	      StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 	      if ( !(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	
@@ -58,13 +58,13 @@
 	   }
 	
 	   protected override void OnRemove( object key, object value )  {
-		StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//		StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 	      if ( !(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	      }
 	
 	   protected override void OnSet( object key, object oldValue, object newValue )  {
-		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	 
+//		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	 
 	 	  if (!(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	
@@ -73,7 +73,7 @@
 	   }
 	
 	   protected override void OnValidate( object key, object value )  {
-		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	   	
+//		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	   	
 	      if ( !(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	   	

Modified: trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryStringDictionary.cs
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryStringDictionary.cs	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Collection/MonoQueryStringDictionary.cs	2005-01-08 09:51:12 UTC (rev 2121)
@@ -47,7 +47,7 @@
 	   }
 	
 	   protected override void OnInsert( object key, object value )  {
-	      StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//	      StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 	      if ( !(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	
@@ -56,13 +56,13 @@
 	   }
 	
 	   protected override void OnRemove( object key, object value )  {
-		StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//		StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 	      if ( !(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	      }
 	
 	   protected override void OnSet( object key, object oldValue, object newValue )  {
-		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	 
+//		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	 
 	 	  if (!(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	
@@ -71,7 +71,7 @@
 	   }
 	
 	   protected override void OnValidate( object key, object value )  {
-		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	   	
+//		  StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));	   	
 	      if ( !(key is string) )
 	         throw new ArgumentException( GettextCatalog.GetString( &quot;Wrong Key Type&quot; ), &quot;key&quot; );
 	   	

Modified: trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/CreateConnectionDruid.cs
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/CreateConnectionDruid.cs	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/CreateConnectionDruid.cs	2005-01-08 09:51:12 UTC (rev 2121)
@@ -1,115 +1,165 @@
+// This program is free software; you can redistribute it and/or modify
+// it under the terms of the GNU General Public License as published by
+// the Free Software Foundation; either version 2 of the License, or
+// (at your option) any later version.
+//
+// This program is distributed in the hope that it will be useful,
+// but WITHOUT ANY WARRANTY; without even the implied warranty of
+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+// GNU Library General Public License for more details.
+//
+// You should have received a copy of the GNU General Public License
+// along with this program; if not, write to the Free Software
+// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA
 
 using System;
 
-using Gnome;
-using Glade;
-using Gtk;
-
-using MonoDevelop.Core.Services;
-using MonoDevelop.Services;
-
-using MonoQuery.Gui.TreeView;
-using MonoQuery.Collections;
-using MonoQuery.Connection;
-using MonoQuery.Services;
-
 namespace MonoQuery.Gui
 {
+	using Gtk;
+	using Gnome;
+	
+	using MonoDevelop.Services;
+	using MonoDevelop.Core.Services;
+	
+	using MonoQuery.Gui.TreeView;
+	using MonoQuery.Services;
+	using MonoQuery.Collections;
+	using MonoQuery.Connection;
+	
 	public class CreateConnectionDruid
 	{
-		/// &lt;summary&gt;Window container&lt;/summary&gt;
-		[Widget]
-		private Gtk.Window winAddconnectionDruid = null;
+		#region // Properties
+		Gnome.Druid druid = null;
+		Gnome.DruidPageEdge		startPage = null;
+		Gnome.DruidPageEdge		endPage = null;
+		Gnome.DruidPageStandard	settingsPage = null;
+		Gtk.ListStore			store = null;
+		Gtk.ComboBox			providers = null;
+		Gtk.Button				testButton = null;
+		Gtk.Entry				connStringEntry = null;
+		Gtk.Entry				serverEntry = null;
+		Gtk.Entry				databaseEntry = null;
+		Gtk.Entry				userEntry = null;
+		Gtk.Entry				passEntry = null;
+		Gtk.Entry				otherEntry = null;
+		MonoQueryNodeDatabaseRoot rootNode = null;
+		#endregion // End Properties
 		
-		/// &lt;summary&gt;druid widget&lt;/summary&gt;
-		[Widget]
-		private Gnome.Druid druidAddconnection = null;
-		
-		/// &lt;summary&gt;&lt;/summary&gt;
-		[Widget]
-		private Gnome.DruidPageEdge pageAddconnectionStart = null;
-		
-		/// &lt;summary&gt;&lt;/summary&gt;
-		[Widget]
-		private Gnome.DruidPageStandard druidAddconnectionPage1 = null;
-		
-		/// &lt;summary&gt;&lt;/summary&gt;
-		[Widget]
-		private Gtk.ComboBox cmbProviders = null;
-		
-		/// &lt;summary&gt;&lt;/summary&gt;
-		[Widget]
-		private Gtk.TextView textview1 = null;
-		
-		/// &lt;summary&gt;&lt;/summary&gt;
-		[Widget]
-		private Gnome.DruidPageEdge druidpagefinish1 = null;
-		
-		/// &lt;summary&gt;
-		/// Root node of the TreeView
-		/// &lt;/summary&gt;
-		private MonoQueryNodeDatabaseRoot rootNode = null;
-		
-		/// &lt;summary&gt;
-		/// List store for providers
-		/// &lt;/summary&gt;
-		private ListStore store = null;
-		
-		/// &lt;summary&gt;
-		/// Constructor. Loads our druid for display.
-		/// &lt;/summary&gt;
-		public CreateConnectionDruid( MonoQuery.Gui.TreeView.MonoQueryNodeDatabaseRoot node )
+		#region // Constructors
+		public CreateConnectionDruid( MonoQueryNodeDatabaseRoot root )
 		{
-			this.rootNode = node;
-			Glade.XML gxml = new Glade.XML( null, &quot;monoquery.glade&quot;, &quot;winAddconnectionDruid&quot;, null );
-			gxml.Autoconnect( this );
+			rootNode = root;
 			
-			this.pageAddconnectionStart.ShowAll();
-			this.druidAddconnectionPage1.ShowAll();
-			this.druidpagefinish1.ShowAll();
+			druid = new Druid(
+					GettextCatalog.GetString( &quot;Create Database Connection&quot; ),
+					true
+				);
+			druid.Cancel += new EventHandler( OnCancelClicked );
 			
+			startPage = new DruidPageEdge( EdgePosition.Start,
+					true,
+					GettextCatalog.GetString( &quot;Create Database Connection&quot; ),
+					GettextCatalog.GetString( &quot;This wizard will help you create&quot;
+						+ &quot; a new database connection for use within &quot;
+						+ &quot;MonoDevelop. You will need your connection string as&quot;
+						+ &quot; well as a supported database.&quot; ),
+					null, null, null
+				);
+			
+			settingsPage = new DruidPageStandard();
+			settingsPage.Title = GettextCatalog.GetString(
+				&quot;Connection Settings&quot; );
+			VBox vbox1 = new VBox();
+			HBox hbox1 = new HBox();
+			VBox vbox2 = new VBox();
+			VBox vbox3 = new VBox();
+			hbox1.PackStart( vbox2, false, false, 2 );
+			HBox hbox4 = new HBox();
+			hbox4.PackStart( new Label(GettextCatalog.GetString(&quot;Provider&quot;)), false, false, 0 );
+			hbox4.PackStart( new Label() );
+			vbox2.PackStart( hbox4 );
+			HBox hbox5 = new HBox();
+			hbox5.PackStart( new Label(GettextCatalog.GetString(&quot;Connection String&quot;)), false, false, 0 );
+			hbox5.PackStart( new Label() );
+			vbox2.PackStart( hbox5 );
+			HBox hbox6 = new HBox();
+			hbox6.PackStart( new Label(GettextCatalog.GetString(&quot;Server&quot;)), false, false, 0 );
+			hbox6.PackStart( new Label() );
+			vbox2.PackStart( hbox6 );
+			HBox hbox7 = new HBox();
+			hbox7.PackStart( new Label(GettextCatalog.GetString(&quot;Database&quot;)), false, false, 0 );
+			hbox7.PackStart( new Label() );
+			vbox2.PackStart( hbox7 );
+			HBox hbox8 = new HBox();
+			hbox8.PackStart( new Label(GettextCatalog.GetString(&quot;User ID&quot;)), false, false, 0 );
+			hbox8.PackStart( new Label() );
+			vbox2.PackStart( hbox8 );
+			HBox hbox9 = new HBox();
+			hbox9.PackStart( new Label(GettextCatalog.GetString(&quot;Password&quot;)), false, false, 0 );
+			hbox9.PackStart( new Label() );
+			vbox2.PackStart( hbox9 );
+			HBox hbox10 = new HBox();
+			hbox10.PackStart( new Label(GettextCatalog.GetString(&quot;Other&quot;)), false, false, 0 );
+			vbox2.PackStart( hbox10 );
+			hbox1.PackStart( vbox3, true, true, 2 );
+			providers = new Gtk.ComboBox();
+			connStringEntry = new Gtk.Entry();
+			serverEntry = new Gtk.Entry();
+			databaseEntry = new Gtk.Entry();
+			userEntry = new Gtk.Entry();
+			passEntry = new Gtk.Entry();
+			otherEntry = new Gtk.Entry();
+			serverEntry.Changed += new EventHandler( OnSettingsChanged );
+			databaseEntry.Changed += new EventHandler( OnSettingsChanged );
+			userEntry.Changed += new EventHandler( OnSettingsChanged );
+			passEntry.Changed += new EventHandler( OnSettingsChanged );
+			otherEntry.Changed += new EventHandler( OnSettingsChanged );
+			vbox3.PackStart( providers, false, false, 2 );
+			vbox3.PackStart( connStringEntry, false, false, 2 );
+			vbox3.PackStart( serverEntry, false, false, 2 );
+			vbox3.PackStart( databaseEntry, false, false, 2 );
+			vbox3.PackStart( userEntry, false, false, 2 );
+			vbox3.PackStart( passEntry, false, false, 2 );
+			vbox3.PackStart( otherEntry, false, false, 2 );
+			vbox1.PackStart( hbox1, false, false, 0 );
+			testButton = new Button( GettextCatalog.GetString(
+					&quot;Test Connection&quot; ) );
+			testButton.Clicked += new EventHandler( OnTestConnectionClicked );
+			HBox hbox2 = new HBox();
+			hbox2.PackStart( new Label(), true, true, 0 );
+			hbox2.PackStart( testButton, false, false, 0 );
+			vbox1.PackStart( hbox2, false, false, 2 );
+			settingsPage.AppendItem( &quot;&quot;, vbox1, &quot;&quot; );
+			
+			endPage = new DruidPageEdge( EdgePosition.Finish,
+					true,
+					GettextCatalog.GetString( &quot;Create Database Connection&quot; ),
+					GettextCatalog.GetString( &quot;We are now ready to create your&quot;
+						+ &quot; new connection. Press Finish to create the &quot;
+						+ &quot;connection.&quot; ),
+					null, null, null
+				);
+			endPage.FinishClicked += new FinishClickedHandler( OnFinishClicked );
+			
+			druid.AppendPage( startPage );
+			druid.AppendPage( settingsPage );
+			druid.AppendPage( endPage );
+			
 			BuildProviderList();
+			
+			druid.ShowAll();
 		}
+		#endregion // End Constructors
 		
-		#region // Private Methods
-		private void OnCancelClicked( object o, EventArgs e )
+		#region // Methods
+		private void OnCancelClicked( object sender, EventArgs args )
 		{
-			this.winAddconnectionDruid.Destroy();
+			druid.Destroy();
 		}
 		
-		/// &lt;summary&gt;
-		/// This method will get our list of providers and enter them into the
-		/// combo box.
-		/// &lt;/summary&gt;
-		private void BuildProviderList()
+		private void OnTestConnectionClicked( object sender, EventArgs args )
 		{
-			MonoQueryService monoQueryService = (MonoQueryService)
-				ServiceManager.GetService( typeof( MonoQueryService ) );
-			
-			store = new ListStore( typeof( string ),
-				typeof( ConnectionProviderDescriptor ) );
-			
-			foreach( ConnectionProviderDescriptor descriptor in monoQueryService.Providers )
-			{
-				store.AppendValues( descriptor.Name, descriptor );
-			}
-			
-			CellRendererText colr = new CellRendererText();
-			this.cmbProviders.Model = store;
-			this.cmbProviders.PackStart( colr, true );
-			this.cmbProviders.AddAttribute( colr, &quot;text&quot;, 0 );
-			
-			// Set to first provider
-			// This is where we could put some autolearning
-			this.cmbProviders.Active = 0;
-		}
-		
-		/// &lt;summary&gt;
-		/// Event handler for when we should test the connection to the
-		/// database.
-		/// &lt;/summary&gt;
-		private void OnTestConnection( object o, EventArgs e )
-		{
 			MessageService service = (MessageService)ServiceManager.GetService(
 				typeof( MessageService ) );
 			
@@ -118,12 +168,12 @@
 			try
 			{
 				TreeIter iter;
-				this.cmbProviders.GetActiveIter( out iter );
+				this.providers.GetActiveIter( out iter );
 				ConnectionProviderDescriptor descriptor = (ConnectionProviderDescriptor)
 					store.GetValue( iter, 1 );
 				IConnection conn = CreateConnectionObject(
 					descriptor.ProviderType,
-					this.textview1.Buffer.Text );
+					this.connStringEntry.Text );
 				successful = conn.Open(); // returns true on success
 			}
 			catch ( Exception err )
@@ -138,64 +188,320 @@
 				service.ShowError( GettextCatalog.GetString(
 						&quot;Error connecting to server.&quot; )
 					+ &quot;\n------------------------------\n&quot;
-					+ this.textview1.Buffer.Text );
+					+ this.connStringEntry.Text );
 			}
 		}
 		
-		/// &lt;summary&gt;
-		/// Creates an instance of a connection from a few settings.
-		/// &lt;/summary&gt;
-		private IConnection CreateConnectionObject( System.Type type, string connString )
+		private void OnSettingsChanged( object sender, EventArgs args )
 		{
-			System.Reflection.Assembly ass = System.Reflection.Assembly.GetExecutingAssembly();
-			IConnection conn = (IConnection)ass.CreateInstance( type.FullName );
-			try
-			{
-				conn.ConnectionString = connString;
-			}
-			catch ( Exception e ) {}
-			
-			return conn;
+			connStringEntry.Text = &quot;Server=&quot; + serverEntry.Text + &quot;;&quot;
+				+ &quot;Database=&quot; + databaseEntry.Text + &quot;;&quot;
+				+ (userEntry.Text.Equals( &quot;&quot; ) ? &quot;&quot; : &quot;User ID=&quot; + userEntry.Text + &quot;;&quot;)
+				+ (passEntry.Text.Equals( &quot;&quot; ) ? &quot;&quot; : &quot;Password=&quot; + passEntry.Text + &quot;;&quot;)
+				+ otherEntry.Text;
 		}
 		
-		/// &lt;summary&gt;
-		/// Create our node and connection objects. Add them to the root node
-		/// of our treeview.
-		/// &lt;/summary&gt;
-		private void OnFinishClicked( object o, FinishClickedArgs e )
+		private void OnFinishClicked( object sender, FinishClickedArgs args )
 		{
-			TreeIter iter;
-			MonoQueryNodeConnection node = null;
+			MessageService service = (MessageService)ServiceManager.GetService(
+				typeof( MessageService ) );
 			
+			bool successful = false;
+			IConnection conn = null;
+			
 			try
 			{
-				this.cmbProviders.GetActiveIter( out iter );
+				TreeIter iter;
+				this.providers.GetActiveIter( out iter );
 				ConnectionProviderDescriptor descriptor = (ConnectionProviderDescriptor)
 					store.GetValue( iter, 1 );
-				IConnection conn = CreateConnectionObject(
+				conn = CreateConnectionObject(
 					descriptor.ProviderType,
-					this.textview1.Buffer.Text );
-			
-			
-				node = new MonoQueryNodeConnection( conn );
-			
-				rootNode.Nodes.Add( node as MonoDevelop.Gui.Widgets.TreeNode );
-				
-				conn.Open();
-				node.Expand();
+					this.connStringEntry.Text );
+				successful = conn.Open();
 			}
 			catch ( Exception err )
 			{
-				MessageService service = (MessageService)ServiceManager.GetService(typeof(MessageService));
-				service.ShowError( GettextCatalog.GetString(&quot;There was an error adding your connection. &quot;
-					+ &quot;Please check your connection string.&quot;) );
+				successful = false;
 			}
 			finally
 			{
-				this.druidAddconnection.Destroy();
-				this.winAddconnectionDruid.Destroy();
+				if ( successful ) {
+					MonoQueryNodeConnection node = new MonoQueryNodeConnection( conn );
+					if ( (node as MonoDevelop.Gui.Widgets.TreeNode) != null ) {
+						rootNode.Nodes.Add( node as MonoDevelop.Gui.Widgets.TreeNode );
+					}
+				} else {
+					service.ShowMessage( GettextCatalog.GetString(
+						&quot;Your connection string or provider was invalid&quot; ) );
+				}
 			}
+			
+			druid.Destroy();
 		}
-		#endregion // End Private Methods
+
+		private void BuildProviderList()
+		{
+			MonoQueryService monoQueryService = (MonoQueryService)
+				ServiceManager.GetService( typeof( MonoQueryService ) );
+			
+			store = new ListStore( typeof( string ),
+				typeof( ConnectionProviderDescriptor ) );
+			
+			foreach( ConnectionProviderDescriptor descriptor in monoQueryService.Providers )
+			{
+				store.AppendValues( descriptor.Name, descriptor );
+			}
+			
+			CellRendererText colr = new CellRendererText();
+			this.providers.Model = store;
+			this.providers.PackStart( colr, true );
+			this.providers.AddAttribute( colr, &quot;text&quot;, 0 );
+			
+			// Set to first provider
+			// This is where we could put some autolearning
+			this.providers.Active = 0;
+		}
+		
+		private IConnection CreateConnectionObject( System.Type type, string connString )
+		{
+			System.Reflection.Assembly ass = System.Reflection.Assembly.GetExecutingAssembly();
+			IConnection conn = (IConnection)ass.CreateInstance( type.FullName );
+			try
+			{
+				conn.ConnectionString = connString;
+			}
+			catch ( Exception e )
+			{}
+			
+			return conn;
+		}
+		#endregion // End Methods
 	}
-}
\ No newline at end of file
+}
+
+
+//
+//using System;
+//
+//using Gnome;
+//using Glade;
+//using Gtk;
+//
+//using MonoDevelop.Core.Services;
+//using MonoDevelop.Services;
+//
+//using MonoQuery.Gui.TreeView;
+//using MonoQuery.Collections;
+//using MonoQuery.Connection;
+//using MonoQuery.Services;
+//
+//namespace MonoQuery.Gui
+//{
+//	public class CreateConnectionDruid
+//	{
+//		[Widget]
+//		private Gtk.Window winAddconnectionDruid = null;
+//		
+//		[Widget]
+//		private Druid druidAddconnection = null;
+//		
+//		[Widget]
+//		private DruidPageEdge pageAddconnectionStart = null;
+//		
+//		[Widget]
+//		private Gnome.DruidPageStandard druidAddconnectionPage1 = null;
+//		
+//		[Widget]
+//		private Gtk.ComboBox comboProviders = null;
+//		
+//		[Widget]
+//		private Gtk.Entry txtConnString = null;
+//		
+//		[Widget]
+//		private Gtk.Entry txtServer = null;
+//		
+//		[Widget]
+//		private Gtk.Entry txtDatabase = null;
+//		
+//		[Widget]
+//		private Gtk.Entry txtUserID = null;
+//		
+//		[Widget]
+//		private Gtk.Entry txtOthers = null;
+//		
+//		[Widget]
+//		private DruidPageEdge druidpagefinish1 = null;
+//
+//		[Widget]
+//		private Gtk.Button btnTest = null;
+//
+//		[Widget]
+//		private Gtk.Entry txtPass = null;
+//		
+//		private MonoQueryNodeDatabaseRoot rootNode = null;
+//		
+//		private ListStore store = null;
+//
+//		private TreeIter cur;
+//		
+//		/// &lt;summary&gt;
+//		/// Constructor. Loads our druid for display.
+//		/// &lt;/summary&gt;
+//		public CreateConnectionDruid( MonoQuery.Gui.TreeView.MonoQueryNodeDatabaseRoot node )
+//		{
+//			this.rootNode = node;
+//			Glade.XML gxml = new Glade.XML( null, &quot;monoquery.glade&quot;, &quot;winAddconnectionDruid&quot;, null );
+//			gxml.Autoconnect( this );
+//			
+//			this.pageAddconnectionStart.ShowAll();
+//			this.druidAddconnectionPage1.ShowAll();
+//			this.druidpagefinish1.ShowAll();
+//			
+//			BuildProviderList();
+//		}
+//		
+//		#region // Private Methods
+//		private void OnCancelClicked( object o, EventArgs args )
+//		{
+//			this.winAddconnectionDruid.Destroy();
+//		}
+//		
+//		private void OnEntryChanged( object o, EventArgs args )
+//		{
+//			if ( this.txtConnString != null )
+//				this.txtConnString.Text = 
+//					  &quot;Server=&quot; + this.txtServer.Text + &quot;;&quot;
+//					+ &quot;Database=&quot; + this.txtDatabase.Text + &quot;;&quot;
+//					+ &quot;User ID=&quot; + this.txtUserID.Text + &quot;;&quot;
+//					+ &quot;Password=&quot; + this.txtPass.Text + &quot;;&quot;
+//					+ this.txtOthers.Text;
+//		}
+//
+//		/// &lt;summary&gt;
+//		/// This method will get our list of providers and enter them into the
+//		/// combo box.
+//		/// &lt;/summary&gt;
+//		private void BuildProviderList()
+//		{
+//			MonoQueryService monoQueryService = (MonoQueryService)
+//				ServiceManager.GetService( typeof( MonoQueryService ) );
+//			
+//			store = new ListStore( typeof( string ),
+//				typeof( ConnectionProviderDescriptor ) );
+//			
+//			foreach( ConnectionProviderDescriptor descriptor in monoQueryService.Providers )
+//			{
+//				store.AppendValues( descriptor.Name, descriptor );
+//			}
+//			
+//			CellRendererText colr = new CellRendererText();
+//			this.comboProviders.Model = store;
+//			this.comboProviders.PackStart( colr, true );
+//			this.comboProviders.AddAttribute( colr, &quot;text&quot;, 0 );
+//			
+//			// Set to first provider
+//			// This is where we could put some autolearning
+//			this.comboProviders.Active = 0;
+//		}
+//		
+//		/// &lt;summary&gt;
+//		/// Event handler for when we should test the connection to the
+//		/// database.
+//		/// &lt;/summary&gt;
+//		private void OnTestConnection( object o, EventArgs e )
+//		{
+//			MessageService service = (MessageService)ServiceManager.GetService(
+//				typeof( MessageService ) );
+//			
+//			bool successful = false;
+//			
+//			try
+//			{
+//				TreeIter iter;
+//				this.comboProviders.GetActiveIter( out iter );
+//				ConnectionProviderDescriptor descriptor = (ConnectionProviderDescriptor)
+//					store.GetValue( iter, 1 );
+//				IConnection conn = CreateConnectionObject(
+//					descriptor.ProviderType,
+//					this.txtConnString.Text );
+//				successful = conn.Open(); // returns true on success
+//			}
+//			catch ( Exception err )
+//			{
+//				successful = false;
+//			}
+//			
+//			if ( successful ) {
+//				service.ShowMessage( GettextCatalog.GetString(
+//					&quot;Connection was successful.&quot; ) );
+//			} else {
+//				service.ShowError( GettextCatalog.GetString(
+//						&quot;Error connecting to server.&quot; )
+//					+ &quot;\n------------------------------\n&quot;
+//					+ this.txtConnString.Text );
+//			}
+//		}
+//		
+//		/// &lt;summary&gt;
+//		/// Creates an instance of a connection from a few settings.
+//		/// &lt;/summary&gt;
+//		private IConnection CreateConnectionObject( System.Type type, string connString )
+//		{
+//			System.Reflection.Assembly ass = System.Reflection.Assembly.GetExecutingAssembly();
+//			IConnection conn = (IConnection)ass.CreateInstance( type.FullName );
+//			try
+//			{
+//				conn.ConnectionString = connString;
+//			}
+//			catch ( Exception e ) {}
+//			
+//			return conn;
+//		}
+//
+//		/// &lt;summary&gt;
+//		/// Save the provider iter so it can be used later.
+//		/// &lt;/summary&gt;
+//		private void OnProvidersChanged( object o, EventArgs args )
+//		{
+//			this.comboProviders.GetActiveIter( out cur );
+//		}
+//		
+//		/// &lt;summary&gt;
+//		/// Create our node and connection objects. Add them to the root node
+//		/// of our treeview.
+//		/// &lt;/summary&gt;
+//		private void OnFinishClicked( object o, FinishClickedArgs e )
+//		{
+//			MonoQueryNodeConnection node = null;
+//			
+//			try
+//			{
+//				ConnectionProviderDescriptor descriptor = (ConnectionProviderDescriptor)
+//				store.GetValue( cur, 1 );
+//				IConnection conn = CreateConnectionObject(
+//					descriptor.ProviderType,
+//					this.txtConnString.Text );
+//				conn.Open();
+//			
+//				node = new MonoQueryNodeConnection( conn );
+//				rootNode.Nodes.Add( node );
+//				node.Expand();
+//			}
+//			catch ( Exception err )
+//			{
+//				MessageService service = (MessageService)ServiceManager.GetService(typeof(MessageService));
+//				service.ShowError( GettextCatalog.GetString(&quot;There was an error adding your connection. &quot;
+//					+ &quot;Please check your connection string.&quot;) );
+//				Console.WriteLine( err.Message + &quot;\n\n&quot; + err );
+//			}
+//			finally
+//			{
+//				this.druidAddconnection.Destroy();
+//				this.winAddconnectionDruid.Destroy();
+//			}
+//		}
+//		#endregion // End Private Methods
+//	}
+//}
+//
\ No newline at end of file

Deleted: trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/Glade/monoquery.glade
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/Glade/monoquery.glade	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Gui/Forms/Glade/monoquery.glade	2005-01-08 09:51:12 UTC (rev 2121)
@@ -1,278 +0,0 @@
-&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
-&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd&quot;">http://glade.gnome.org/glade-2.0.dtd&quot;</A>&gt;
-
-&lt;glade-interface&gt;
-&lt;requires lib=&quot;gnome&quot;/&gt;
-
-&lt;widget class=&quot;GtkWindow&quot; id=&quot;winAddconnectionDruid&quot;&gt;
-  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Add Connection Wizard&lt;/property&gt;
-  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
-  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
-  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
-  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
-  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_NORMAL&lt;/property&gt;
-  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
-
-  &lt;child&gt;
-    &lt;widget class=&quot;GnomeDruid&quot; id=&quot;druidAddconnection&quot;&gt;
-      &lt;property name=&quot;border_width&quot;&gt;4&lt;/property&gt;
-      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-      &lt;property name=&quot;show_help&quot;&gt;False&lt;/property&gt;
-      &lt;signal name=&quot;cancel&quot; handler=&quot;OnCancelClicked&quot; last_modification_time=&quot;Sun, 07 Nov 2004 07:27:30 GMT&quot;/&gt;
-
-      &lt;child&gt;
-	&lt;widget class=&quot;GnomeDruidPageEdge&quot; id=&quot;pageAddconnectionStart&quot;&gt;
-	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	  &lt;property name=&quot;position&quot;&gt;GNOME_EDGE_START&lt;/property&gt;
-	  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Add new connection&lt;/property&gt;
-	  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;This wizard will help you create a new connection for use within MonoDevelop. You will need to select your connection provider as well as your proper connection string.&lt;/property&gt;
-	&lt;/widget&gt;
-      &lt;/child&gt;
-
-      &lt;child&gt;
-	&lt;widget class=&quot;GnomeDruidPageStandard&quot; id=&quot;druidAddconnectionPage1&quot;&gt;
-	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Select connection provider&lt;/property&gt;
-
-	  &lt;child internal-child=&quot;vbox&quot;&gt;
-	    &lt;widget class=&quot;GtkVBox&quot; id=&quot;druid-vbox1&quot;&gt;
-	      &lt;property name=&quot;border_width&quot;&gt;16&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;spacing&quot;&gt;6&lt;/property&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox1&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label1&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Select your connection provider&lt;/property&gt;
-		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;cmbProviders&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;padding&quot;&gt;12&lt;/property&gt;
-		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkScrolledWindow&quot; id=&quot;scrolledwindow1&quot;&gt;
-		      &lt;property name=&quot;height_request&quot;&gt;75&lt;/property&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;hscrollbar_policy&quot;&gt;GTK_POLICY_NEVER&lt;/property&gt;
-		      &lt;property name=&quot;vscrollbar_policy&quot;&gt;GTK_POLICY_NEVER&lt;/property&gt;
-		      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
-		      &lt;property name=&quot;window_placement&quot;&gt;GTK_CORNER_TOP_LEFT&lt;/property&gt;
-
-		      &lt;child&gt;
-			&lt;widget class=&quot;GtkTextView&quot; id=&quot;textview1&quot;&gt;
-			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;overwrite&quot;&gt;False&lt;/property&gt;
-			  &lt;property name=&quot;accepts_tab&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;justification&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-			  &lt;property name=&quot;wrap_mode&quot;&gt;GTK_WRAP_NONE&lt;/property&gt;
-			  &lt;property name=&quot;cursor_visible&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;pixels_above_lines&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;pixels_below_lines&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;pixels_inside_wrap&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;left_margin&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;right_margin&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;indent&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
-			&lt;/widget&gt;
-		      &lt;/child&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;lblSpacer1&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
-		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox1&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
-
-		      &lt;child&gt;
-			&lt;widget class=&quot;GtkLabel&quot; id=&quot;label3&quot;&gt;
-			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
-			  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-			&lt;/widget&gt;
-			&lt;packing&gt;
-			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-			&lt;/packing&gt;
-		      &lt;/child&gt;
-
-		      &lt;child&gt;
-			&lt;widget class=&quot;GtkButton&quot; id=&quot;cmdTestConnection&quot;&gt;
-			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
-			  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-			  &lt;signal name=&quot;clicked&quot; handler=&quot;OnTestConnection&quot; last_modification_time=&quot;Sun, 07 Nov 2004 22:54:55 GMT&quot;/&gt;
-
-			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment1&quot;&gt;
-			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-			      &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
-
-			      &lt;child&gt;
-				&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox2&quot;&gt;
-				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-				  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-				  &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
-
-				  &lt;child&gt;
-				    &lt;widget class=&quot;GtkImage&quot; id=&quot;image1&quot;&gt;
-				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-				      &lt;property name=&quot;stock&quot;&gt;gtk-execute&lt;/property&gt;
-				      &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
-				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-				      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-				      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-				    &lt;/widget&gt;
-				    &lt;packing&gt;
-				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-				    &lt;/packing&gt;
-				  &lt;/child&gt;
-
-				  &lt;child&gt;
-				    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label2&quot;&gt;
-				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-				      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Test Connection&lt;/property&gt;
-				      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
-				      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-				      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-				      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-				      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-				      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-				    &lt;/widget&gt;
-				    &lt;packing&gt;
-				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-				    &lt;/packing&gt;
-				  &lt;/child&gt;
-				&lt;/widget&gt;
-			      &lt;/child&gt;
-			    &lt;/widget&gt;
-			  &lt;/child&gt;
-			&lt;/widget&gt;
-			&lt;packing&gt;
-			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-			&lt;/packing&gt;
-		      &lt;/child&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-	    &lt;/widget&gt;
-	  &lt;/child&gt;
-	&lt;/widget&gt;
-      &lt;/child&gt;
-
-      &lt;child&gt;
-	&lt;widget class=&quot;GnomeDruidPageEdge&quot; id=&quot;druidpagefinish1&quot;&gt;
-	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	  &lt;property name=&quot;position&quot;&gt;GNOME_EDGE_FINISH&lt;/property&gt;
-	  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Ready to create connection&lt;/property&gt;
-	  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;We are now ready to create the connection. Click Apply to create and start using the connection.&lt;/property&gt;
-	  &lt;signal name=&quot;finish&quot; handler=&quot;OnFinishClicked&quot; last_modification_time=&quot;Sun, 07 Nov 2004 23:29:49 GMT&quot;/&gt;
-	&lt;/widget&gt;
-      &lt;/child&gt;
-    &lt;/widget&gt;
-  &lt;/child&gt;
-&lt;/widget&gt;
-
-&lt;/glade-interface&gt;

Modified: trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryDataNodes.cs
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryDataNodes.cs	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryDataNodes.cs	2005-01-08 09:51:12 UTC (rev 2121)
@@ -139,8 +139,8 @@
 		/// &lt;/summary&gt;
 		protected override MonoQuerySchemaClassCollection OnExecute( CancelEventArgs e )
 		{
-			MonoQuerySchemaClassCollection tmp = this.SchemaClass.GetSchemaParameters();
-			MonoQueryParameterCollection parameters = null;			
+//			MonoQuerySchemaClassCollection tmp = this.SchemaClass.GetSchemaParameters();
+//			MonoQueryParameterCollection parameters = null;			
 			MonoQuerySchemaClassCollection returnValue = null;
 			
 //			if ( tmp.Count == 1 &amp;&amp; tmp[0] is MonoQueryNotSupported )

Modified: trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryNodesRoot.cs
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryNodesRoot.cs	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryNodesRoot.cs	2005-01-08 09:51:12 UTC (rev 2121)
@@ -32,7 +32,7 @@
 		{
 			get
 			{
-				StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//				StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 				return GettextCatalog.GetString( &quot;Database Connections&quot; ); 
 			}
 		}
@@ -117,7 +117,7 @@
 				}
 				IMessageService messageService =(IMessageService)ServiceManager.GetService(typeof(IMessageService));
 				messageService.ShowError( e.Message );															
-			}*/	
+			}*/
 		}
 		
 		/// &lt;summary&gt;
@@ -200,7 +200,7 @@
 			}
 		}
 						
-		public MonoQueryNodeConnection( IConnection dataConnection ) : base( null )
+		public MonoQueryNodeConnection( IConnection dataConnection ) : base()
 		{								
 			this.pConnection = dataConnection;
 			this.Image = &quot;md-mono-query-database&quot;;

Modified: trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryTree.cs
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryTree.cs	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Gui/MonoQueryTree/MonoQueryTree.cs	2005-01-08 09:51:12 UTC (rev 2121)
@@ -35,7 +35,7 @@
 		///&lt;/summary&gt;			
 		public MonoQueryTree() : base()
 		{		
-			IconService iconService = (IconService)ServiceManager.GetService(typeof(IconService));
+//			IconService iconService = (IconService)ServiceManager.GetService(typeof(IconService));
 			
 			this.menuService = (MenuService)ServiceManager.GetService(typeof(MenuService));
 			

Modified: trunk/MonoDevelop/Extras/MonoQuery/Makefile.am
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/Makefile.am	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/Makefile.am	2005-01-08 09:51:12 UTC (rev 2121)
@@ -1,7 +1,3 @@
-
-monoquerydir = $(libdir)/monodevelop/AddIns/MonoQuery
-monoquery_DATA = $(ASSEMBLY) MonoQuery.addin.xml
-
 FILES = \
 AssemblyInfo.cs \
 Codons/MonoQueryConnectionCodon.cs \
@@ -37,43 +33,43 @@
 Gui/SqlQueryView/SqlQueryView.cs \
 Services/MonoQueryService.cs
 
-ASSEMBLY = MonoQuery.dll
+build_sources = $(addprefix $(srcdir)/, $(FILES))
 
-REFERENCES = \
-System.Data \
-Npgsql \
-ByteFX.Data \
-../../build/bin/MonoDevelop.Base.dll \
-../../build/bin/MonoDevelop.Core.dll \
-../../build/bin/MonoDevelop.Gui.Widgets.dll
+REFS = /r:$(top_builddir)/build/bin/MonoDevelop.Core.dll \
+       /r:$(top_builddir)/build/bin/MonoDevelop.Base.dll \
+       /r:$(top_builddir)/build/bin/MonoDevelop.Gui.Widgets.dll \
+       /r:Npgsql.dll \
+       /r:System.Data.dll \
+       /r:ByteFX.Data.dll \
+       $(GTK_SHARP_LIBS) \
+       $(GLADE_SHARP_LIBS) \
+       $(GCONF_SHARP_LIBS) \
+       $(GTKSOURCEVIEW_SHARP_LIBS)
 
-RESOURCES = \
-Gui/Forms/Glade/monoquery.glade
+ADDIN = MonoQuery.addin.xml
 
-PACKAGES = \
-gtk-sharp-2.0 \
-gnome-sharp-2.0 \
-glade-sharp-2.0 \
-gtksourceview-sharp
+ADDIN_BUILD = $(top_builddir)/build/AddIns/MonoQuery
 
-BUILD_SOURCES = $(addprefix $(srcdir)/, $(FILES))
-BUILD_REFERENCES = $(addprefix /r:, $(REFERENCES))
-BUILD_PACKAGES = $(addprefix /pkg:, $(PACKAGES))
-BUILD_RESOURCES = $(addprefix /resource:, $(RESOURCES))
+DLL = MonoQuery.dll
 
-all: $(ASSEMBLY)
+DLL_BUILD = $(top_builddir)/build/AddIns/MonoQuery
 
-$(ASSEMBLY): mkdirs $(BUILD_SOURCES) ../../build/AddIns/MonoQuery/MonoQuery.addin.xml
-	mcs -out:MonoQuery.dll -target:library $(BUILD_SOURCES) \
-	$(BUILD_REFERENCES) $(BUILD_PACKAGES) $(BUILD_RESOURCES) \
-	&amp;&amp; cp MonoQuery.dll ../../build/AddIns/MonoQuery/
+all: $(DLL_BUILD)/$(DLL) $(ADDIN_BUILD)/$(ADDIN)
 
-../../build/AddIns/MonoQuery/MonoQuery.addin.xml:
-	cp MonoQuery.addin.xml ../../build/AddIns/MonoQuery/
+$(ADDIN_BUILD)/$(ADDIN): $(srcdir)/$(ADDIN)
+	mkdir -p $(ADDIN_BUILD)
+	cp $(srcdir)/$(ADDIN) $(ADDIN_BUILD)/$(ADDIN)
 
-mkdirs:
-	mkdir -p ../../build/AddIns/MonoQuery
+$(DLL): $(build_sources) $(srcdir)/$(GLADEFILE)
+	mcs -target:library -out:$(DLL) $(build_sources) $(REFS)
 
-CLEANFILES=$(ASSEMBLY) $(ASSEMBLY).mdb
+$(DLL_BUILD)/$(DLL): $(srcdir)/$(DLL)
+	mkdir -p $(DLL_BUILD)
+	cp $(srcdir)/$(DLL) $(DLL_BUILD)/$(DLL)
 
-EXTRADIST=$(FILES) MonoQuery.addin.xml
+CLEANFILES=$(DLL) $(DLL_BUILD)/$(DLL) $(ADDIN_BUILD)/$(ADDIN)
+
+EXTRADIST=$(FILES)
+
+monoquerydir = $(libdir)/monodevelop/AddIns/MonoQuery
+monoquery_DATA = $(DLL_BUILD)/$(DLL) $(ADDIN_BUILD)/$(ADDIN)

Modified: trunk/MonoDevelop/Extras/MonoQuery/SchemaClass/MonoQuerySchemaClass.cs
===================================================================
--- trunk/MonoDevelop/Extras/MonoQuery/SchemaClass/MonoQuerySchemaClass.cs	2005-01-08 09:47:23 UTC (rev 2120)
+++ trunk/MonoDevelop/Extras/MonoQuery/SchemaClass/MonoQuerySchemaClass.cs	2005-01-08 09:51:12 UTC (rev 2121)
@@ -541,7 +541,7 @@
 		
 		public MonoQueryNotSupported( IConnection connection, string catalogName, string schemaName, string ownerName, string name  ) : base(connection, catalogName, schemaName, ownerName, name )
 		{			
-			StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//			StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 			this.pName += &quot; &quot; + GettextCatalog.GetString( &quot;Not Supported&quot; )  + &quot; &quot; + connection.Provider;			
 
 		}
@@ -615,7 +615,7 @@
 		
 		public MonoQueryViews( IConnection connection, string catalogName, string schemaName, string ownerName, string name  ) : base(connection, catalogName, schemaName, ownerName, name )
 		{			
-			StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//			StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 			this.pName = GettextCatalog.GetString( &quot;Views&quot; );
 		}
 		
@@ -651,7 +651,7 @@
 		
 		public MonoQueryProcedures( IConnection connection, string catalogName, string schemaName, string ownerName, string name  ) : base(connection, catalogName, schemaName, ownerName, name )
 		{			
-			StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
+//			StringParserService stringParserService = (StringParserService)ServiceManager.GetService(typeof(StringParserService));
 			this.pName = GettextCatalog.GetString( &quot;Procedures&quot; );
 		}
 		


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001724.html">[Monodevelop-patches-list] r2120 - trunk/MonoDevelop/po
</A></li>
	<LI>Next message: <A HREF="001726.html">[Monodevelop-patches-list] r2122 - in trunk/MonoDevelop: Extras/MonoQuery Extras/MonoQuery/Gui/Forms build/data/resources/icons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1725">[ date ]</a>
              <a href="thread.html#1725">[ thread ]</a>
              <a href="subject.html#1725">[ subject ]</a>
              <a href="author.html#1725">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
