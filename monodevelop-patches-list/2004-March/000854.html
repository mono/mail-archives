<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1247 - in trunk/MonoDevelop/src/AddIns/BackendBindings: . JavaBinding JavaBinding/FormatingStrategy JavaBinding/Gui JavaBinding/Project JavaBinding/ProjectTreeBuilder
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1247%20-%20in%20trunk/MonoDevelop/src/AddIns/BackendBindings%3A%20.%20JavaBinding%20JavaBinding/FormatingStrategy%20JavaBinding/Gui%20JavaBinding/Project%20JavaBinding/ProjectTreeBuilder&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000853.html">
   <LINK REL="Next"  HREF="000855.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1247 - in trunk/MonoDevelop/src/AddIns/BackendBindings: . JavaBinding JavaBinding/FormatingStrategy JavaBinding/Gui JavaBinding/Project JavaBinding/ProjectTreeBuilder</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1247%20-%20in%20trunk/MonoDevelop/src/AddIns/BackendBindings%3A%20.%20JavaBinding%20JavaBinding/FormatingStrategy%20JavaBinding/Gui%20JavaBinding/Project%20JavaBinding/ProjectTreeBuilder&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1247 - in trunk/MonoDevelop/src/AddIns/BackendBindings: . JavaBinding JavaBinding/FormatingStrategy JavaBinding/Gui JavaBinding/Project JavaBinding/ProjectTreeBuilder">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Thu Mar 25 17:19:12 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000853.html">[Monodevelop-patches-list] r1246 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: . CodeCompletion
</A></li>
        <LI>Next message: <A HREF="000855.html">[Monodevelop-patches-list] r1248 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: . Gui Gui/OptionPanels Properties
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#854">[ date ]</a>
              <a href="thread.html#854">[ thread ]</a>
              <a href="subject.html#854">[ subject ]</a>
              <a href="author.html#854">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jluke
Date: 2004-03-25 17:19:12 -0500 (Thu, 25 Mar 2004)
New Revision: 1247

Added:
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ChangeLog
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/FormatingStrategy/
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/FormatingStrategy/JavaFormattingStrategy.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Gui/
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Gui/ProjectConfigurationPropertyPanel.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBinding.prjx
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingCompilerServices.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingExecutionServices.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaLanguageBinding.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Makefile.am
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaCompilerParameters.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaProject.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ProjectTreeBuilder/
   trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ProjectTreeBuilder/JavaNodeBuilder.cs
Log:
import from SD so I can play around with it



Property changes on: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.am
*.dll


Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ChangeLog
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ChangeLog	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ChangeLog	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,4 @@
+2004-03-25  John Luke  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jluke at cfl.rr.com</A>&gt;
+	
+	import from SD and make it build with our
+	namespaces and SourceEditor

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/FormatingStrategy/JavaFormattingStrategy.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/FormatingStrategy/JavaFormattingStrategy.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/FormatingStrategy/JavaFormattingStrategy.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,246 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.Collections;
+using System.Diagnostics;
+using System.Drawing;
+using System.Text;
+
+using MonoDevelop.TextEditor;
+using MonoDevelop.TextEditor.Document;
+using MonoDevelop.Core.Properties;
+using MonoDevelop.Core.Services;
+using MonoDevelop.Services;
+using MonoDevelop.EditorBindings.FormattingStrategy;
+
+namespace JavaBinding.FormattingStrategy
+{
+	/// &lt;summary&gt;
+	/// This class handles the auto and smart indenting in the textbuffer while
+	/// you type.
+	/// &lt;/summary&gt;
+	public class JavaFormattingStrategy : DefaultFormattingStrategy
+	{
+		public JavaFormattingStrategy()
+		{
+		}
+				
+		/// &lt;summary&gt;
+		/// Define Java specific smart indenting for a line :)
+		/// &lt;/summary&gt;
+		protected override int SmartIndentLine(IFormattableDocument textArea, int lineNr)
+		{
+/*
+			if (lineNr &gt; 0) {
+				LineSegment lineAbove    = textArea.Document.GetLineSegment(lineNr - 1);
+				string  lineAboveText = textArea.Document.GetText(lineAbove.Offset, lineAbove.Length).Trim();
+				
+				LineSegment curLine = textArea.Document.GetLineSegment(lineNr);
+				string  curLineText = textArea.Document.GetText(curLine.Offset, curLine.Length).Trim();
+				
+				if (lineAboveText.EndsWith(&quot;)&quot;) &amp;&amp; curLineText.StartsWith(&quot;{&quot;)) {
+					string indentation = GetIndentation(textArea, lineNr - 1);
+					textArea.Document.Replace(curLine.Offset, curLine.Length, indentation + curLineText);
+					return indentation.Length;
+				}
+				
+				if (curLineText.StartsWith(&quot;}&quot;)) { // indent closing bracket.
+					int closingBracketOffset = TextUtilities.SearchBracketBackward(textArea.Document, curLine.Offset + textArea.Document.GetText(curLine.Offset, curLine.Length).IndexOf('}') - 1, '{', '}');
+					if (closingBracketOffset == -1) {  // no closing bracket found -&gt; autoindent
+						return AutoIndentLine(textArea, lineNr);
+					}
+					
+					string indentation = GetIndentation(textArea, textArea.Document.GetLineNumberForOffset(closingBracketOffset));
+					
+					textArea.Document.Replace(curLine.Offset, curLine.Length, indentation + curLineText);
+					return indentation.Length;
+				}
+				
+				if (lineAboveText.EndsWith(&quot;;&quot;)) { // expression ended, reset to valid indent.
+					int closingBracketOffset = TextUtilities.SearchBracketBackward(textArea.Document, curLine.Offset + textArea.Document.GetText(curLine.Offset, curLine.Length).IndexOf('}') - 1, '{', '}');
+					
+					if (closingBracketOffset == -1) {  // no closing bracket found -&gt; autoindent
+						return AutoIndentLine(textArea, lineNr);
+					}
+					
+					int closingBracketLineNr = textArea.Document.GetLineNumberForOffset(closingBracketOffset);
+					LineSegment closingBracketLine = textArea.Document.GetLineSegment(closingBracketLineNr);
+					string  closingBracketLineText = textArea.Document.GetText(closingBracketLine.Offset, closingBracketLine.Length).Trim();
+					
+					string indentation = GetIndentation(textArea, closingBracketLineNr);
+					
+					// special handling for switch statement formatting.
+					if (closingBracketLineText.StartsWith(&quot;switch&quot;)) {
+						if (lineAboveText.StartsWith(&quot;break;&quot;) || 
+						    lineAboveText.StartsWith(&quot;goto&quot;)   || 
+						    lineAboveText.StartsWith(&quot;return&quot;)) {
+					    } else {
+					    	indentation += ICSharpCode.TextEditor.Actions.Tab.GetIndentationString(textArea.Document);
+					    }
+					}
+			    	indentation += ICSharpCode.TextEditor.Actions.Tab.GetIndentationString(textArea.Document);
+					
+					textArea.Document.Replace(curLine.Offset, curLine.Length, indentation + curLineText);
+					return indentation.Length;
+				}
+				
+				if (lineAboveText.EndsWith(&quot;{&quot;) || // indent opening bracket.
+				    lineAboveText.EndsWith(&quot;:&quot;) || // indent case xyz:
+				    (lineAboveText.EndsWith(&quot;)&quot;) &amp;&amp;  // indent single line if, for ... etc
+			    	(lineAboveText.StartsWith(&quot;if&quot;) ||
+			    	 lineAboveText.StartsWith(&quot;while&quot;) ||
+			    	 lineAboveText.StartsWith(&quot;for&quot;))) ||
+			    	 lineAboveText.EndsWith(&quot;else&quot;)) {
+			    	 	string indentation = GetIndentation(textArea, lineNr - 1) + ICSharpCode.TextEditor.Actions.Tab.GetIndentationString(textArea.Document);
+						textArea.Document.Replace(curLine.Offset, curLine.Length, indentation + curLineText);
+						return indentation.Length;
+			    } else {
+			    	// try to indent linewrap
+			    	ArrayList bracketPos = new ArrayList();
+			    	for (int i = 0; i &lt; lineAboveText.Length; ++i) { // search for a ( bracket that isn't closed
+						switch (lineAboveText[i]) {
+							case '(':
+								bracketPos.Add(i);
+								break;
+							case ')':
+								if (bracketPos.Count &gt; 0) {
+									bracketPos.RemoveAt(bracketPos.Count - 1);
+								}
+								break;
+						}
+			    	}
+			    	if (bracketPos.Count &gt; 0) {
+			    		int bracketIndex = (int)bracketPos[bracketPos.Count - 1];
+			    		string indentation = GetIndentation(textArea, lineNr - 1);
+			    		
+			    		for (int i = 0; i &lt;= bracketIndex; ++i) { // insert enough spaces to match
+			    			indentation += &quot; &quot;;                   // brace start in the next line
+			    		}
+			    		
+						textArea.Document.Replace(curLine.Offset, curLine.Length, indentation + curLineText);
+						return indentation.Length;
+			    	}
+			    }
+			}
+			return AutoIndentLine(textArea, lineNr);*/
+			return 0;
+		}
+		
+		bool NeedCurlyBracket(string text) 
+		{
+			int curlyCounter = 0;
+			
+			bool inString = false;
+			bool inChar   = false;
+			
+			bool lineComment  = false;
+			bool blockComment = false;
+			
+			for (int i = 0; i &lt; text.Length; ++i) {
+				switch (text[i]) {
+					case '\r':
+					case '\n':
+						lineComment = false;
+						break;
+					case '/':
+						if (blockComment) {
+							Debug.Assert(i &gt; 0);
+							if (text[i - 1] == '*') {
+								blockComment = false;
+							}
+						}
+						if (!inString &amp;&amp; !inChar &amp;&amp; i + 1 &lt; text.Length) {
+							if (!blockComment &amp;&amp; text[i + 1] == '/') {
+								lineComment = true;
+							}
+							if (!lineComment &amp;&amp; text[i + 1] == '*') {
+								blockComment = true;
+							}
+						}
+						break;
+					case '&quot;':
+						inString = !inString;
+						break;
+					case '\'':
+						inChar = !inChar;
+						break;
+					case '{':
+						if (!(inString || inChar || lineComment || blockComment)) {
+							++curlyCounter;
+						}
+						break;
+					case '}':
+						if (!(inString || inChar || lineComment || blockComment)) {
+							--curlyCounter;
+						}
+						break;
+				}
+			}
+			return curlyCounter &gt; 0;
+		}
+		
+		public override int FormatLine(IFormattableDocument textArea,int lineNr, int cursorOffset, char ch) // used for comment tag formater/inserter
+		{
+/*
+			switch (ch) {
+				case '}':
+				case '{':
+					return textArea.Document.FormattingStrategy.IndentLine(textArea, lineNr);
+				case '\n':
+					if (lineNr &lt;= 0) {
+						return IndentLine(textArea, lineNr);
+					}
+					
+					if (textArea.TextEditorProperties.AutoInsertCurlyBracket) {
+						string oldLineText = TextUtilities.GetLineAsString(textArea.Document, lineNr - 1);
+						if (oldLineText.EndsWith(&quot;{&quot;)) {
+							if (NeedCurlyBracket(textArea.Document.TextContent)) {
+								textArea.Document.Insert(textArea.Caret.Offset, &quot;\n}&quot;);
+								IndentLine(textArea, lineNr + 1);
+							}
+						}
+					}
+					
+					LineSegment    lineAbove     = textArea.Document.GetLineSegment(lineNr - 1);
+					string  lineAboveText = textArea.Document.GetText(lineAbove.Offset, lineAbove.Length);
+					
+					LineSegment    curLine       = textArea.Document.GetLineSegment(lineNr);
+			
+					LineSegment    nextLine      = lineNr + 1 &lt; textArea.Document.TotalNumberOfLines ? textArea.Document.GetLineSegment(lineNr + 1) : null;
+					string  nextLineText  = lineNr + 1 &lt; textArea.Document.TotalNumberOfLines ? textArea.Document.GetText(nextLine.Offset, nextLine.Length) : &quot;&quot;;
+					
+					if (lineAbove.HighlightSpanStack != null &amp;&amp; lineAbove.HighlightSpanStack.Count &gt; 0) {				
+						if (!((Span)lineAbove.HighlightSpanStack.Peek()).StopEOL) {	// case for /* style comments
+							int index = lineAboveText.IndexOf(&quot;/*&quot;);
+							
+							if (index &gt; 0) {
+								string indentation = GetIndentation(textArea, lineNr - 1);
+								for (int i = indentation.Length; i &lt; index; ++ i) {
+									indentation += ' ';
+								}
+								textArea.Document.Replace(curLine.Offset, cursorOffset - curLine.Offset, indentation + &quot; * &quot;);
+								return indentation.Length + 3;
+							}
+							
+							index = lineAboveText.IndexOf(&quot;*&quot;);
+							if (index &gt; 0) {
+								string indentation = GetIndentation(textArea, lineNr - 1);
+								for (int i = indentation.Length; i &lt; index; ++ i) {
+									indentation += ' ';
+								}
+								textArea.Document.Replace(curLine.Offset, cursorOffset - curLine.Offset, indentation + &quot;* &quot;);
+								return indentation.Length + 2;
+							}
+						}
+					}
+					return IndentLine(textArea, lineNr);
+			}*/
+			return 0;
+		}
+	}
+}

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Gui/ProjectConfigurationPropertyPanel.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Gui/ProjectConfigurationPropertyPanel.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Gui/ProjectConfigurationPropertyPanel.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,338 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.Drawing;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Internal.ExternalTool;
+using MonoDevelop.Gui.Dialogs;
+using MonoDevelop.Core.Services;
+using MonoDevelop.Core.Properties;
+using MonoDevelop.Core.AddIns.Codons;
+
+namespace JavaBinding
+{
+	/// &lt;summary&gt;
+	/// Summary description for Form5.
+	/// &lt;/summary&gt;
+	public class ProjectConfigurationPropertyPanel : AbstractOptionPanel
+	{
+		/*private System.Windows.Forms.GroupBox groupBox1;
+		private System.Windows.Forms.GroupBox groupBox2;		
+		private System.Windows.Forms.Label label4;
+		private System.Windows.Forms.Label label5;
+
+		private System.Windows.Forms.TextBox textBox2;
+		private System.Windows.Forms.TextBox textBox3;				
+		private System.Windows.Forms.Button button1;
+		
+		private System.Windows.Forms.CheckBox checkBox3;
+		private System.Windows.Forms.CheckBox checkBox5;
+		private System.Windows.Forms.CheckBox checkBox6;
+		private System.Windows.Forms.CheckBox checkBox7;
+		
+		private System.Windows.Forms.Label label6;
+		private System.Windows.Forms.Label label7;
+		private System.Windows.Forms.Label label8;
+
+		private System.Windows.Forms.TextBox textBox5;	//Compiler Path
+		private System.Windows.Forms.TextBox textBox6;	//Classpath
+		private System.Windows.Forms.TextBox textBox7;	//MainClass
+		
+		/// &lt;summary&gt;
+		/// Required designer variable.
+		/// &lt;/summary&gt;
+		private System.ComponentModel.Container components = null;
+		ResourceService resourceService = (ResourceService)ServiceManager.Services.GetService(typeof(IResourceService));
+		JavaCompilerParameters compilerParameters = null;
+		
+		public override bool ReceiveDialogMessage(DialogMessage message)
+		{
+			if (message == DialogMessage.OK) {
+				if (compilerParameters == null)
+					return true;
+				compilerParameters.GenWarnings = checkBox7.Checked;			
+				compilerParameters.Deprecation = checkBox6.Checked;			
+				compilerParameters.Debugmode = checkBox5.Checked;			
+				compilerParameters.Optimize = checkBox3.Checked;						
+				compilerParameters.OutputAssembly = textBox2.Text;
+				compilerParameters.OutputDirectory = textBox3.Text;
+				
+				compilerParameters.CompilerPath = textBox5.Text;
+				compilerParameters.ClassPath = textBox6.Text;
+				compilerParameters.MainClass = textBox7.Text;
+			}
+			return true;
+		}
+		
+		void SetValues(object sender, EventArgs e)
+		{
+			this.compilerParameters = (JavaCompilerParameters)((IProperties)CustomizationObject).GetProperty(&quot;Config&quot;);
+			
+			checkBox3.Checked = compilerParameters.Optimize;
+			checkBox5.Checked = compilerParameters.Debugmode;
+			checkBox6.Checked = compilerParameters.Deprecation;
+			checkBox7.Checked = compilerParameters.GenWarnings;
+			textBox2.Text = compilerParameters.OutputAssembly;
+			textBox3.Text = compilerParameters.OutputDirectory;				
+			
+			textBox5.Text = compilerParameters.CompilerPath;
+			textBox6.Text = compilerParameters.ClassPath;				
+			textBox7.Text = compilerParameters.MainClass;				
+		}
+		
+		void SelectFolder(object sender, EventArgs e)
+		{
+			FolderDialog fdiag = new  FolderDialog();
+			
+			if (fdiag.DisplayDialog(resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.FolderBrowserDescription&quot;)) == DialogResult.OK) {
+				textBox3.Text = fdiag.Path;
+			}
+		}
+		
+		public ProjectConfigurationPropertyPanel()
+		{
+			InitializeComponent();						
+			CustomizationObjectChanged += new EventHandler(SetValues);
+		}
+		
+		/// &lt;summary&gt;
+		/// Clean up any resources being used.
+		/// &lt;/summary&gt;
+		protected override void Dispose( bool disposing )
+		{
+			if( disposing )
+				{
+					if(components != null)
+						{
+							components.Dispose();
+						}
+				}
+				base.Dispose( disposing );
+		}
+		
+		#region Windows Form Designer generated code
+		/// &lt;summary&gt;
+		/// Required method for Designer support - do not modify
+		/// the contents of this method with the code editor.
+		/// &lt;/summary&gt;
+		private void InitializeComponent()
+		{
+			this.groupBox1 = new System.Windows.Forms.GroupBox();
+			this.checkBox6 = new System.Windows.Forms.CheckBox();
+			this.checkBox5 = new System.Windows.Forms.CheckBox();
+
+			this.checkBox3 = new System.Windows.Forms.CheckBox();
+			
+			this.groupBox2 = new System.Windows.Forms.GroupBox();
+			this.button1 = new System.Windows.Forms.Button();
+			this.textBox3 = new System.Windows.Forms.TextBox();
+			this.label5 = new System.Windows.Forms.Label();
+			this.textBox2 = new System.Windows.Forms.TextBox();
+			this.label4 = new System.Windows.Forms.Label();
+			
+			this.checkBox7 = new System.Windows.Forms.CheckBox();
+			this.textBox5 = new System.Windows.Forms.TextBox();
+			this.textBox6 = new System.Windows.Forms.TextBox();
+			this.textBox7 = new System.Windows.Forms.TextBox();
+			
+			this.label6 = new System.Windows.Forms.Label();			
+			this.label7 = new System.Windows.Forms.Label();
+			this.label8 = new System.Windows.Forms.Label();
+			
+			this.groupBox1.SuspendLayout();
+			this.groupBox2.SuspendLayout();
+			this.SuspendLayout();
+			// 
+			// groupBox1
+			//
+			this.groupBox1.Controls.AddRange(new System.Windows.Forms.Control[] {	this.textBox5,
+			                                 this.textBox6,
+			                                 this.textBox7,
+			                                 this.label6,
+			                                 this.label7,
+			                                 this.label8,
+			                                 this.checkBox5,
+			                                 this.checkBox6,
+			                                 this.checkBox7,
+			                                 this.checkBox3});
+			this.groupBox1.Location = new System.Drawing.Point(8, 8);
+			this.groupBox1.Name = &quot;groupBox1&quot;;
+			this.groupBox1.Size = new System.Drawing.Size(376, 232);
+			this.groupBox1.TabIndex = 0;
+			this.groupBox1.TabStop = false;
+			this.groupBox1.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.CodeGenerationGroupBox&quot;);
+			
+			//
+			// checkBox6
+			// 
+			this.checkBox6.Location = new System.Drawing.Point(192, 128);
+			this.checkBox6.Name = &quot;checkBox6&quot;;
+			this.checkBox6.Size = new System.Drawing.Size(176, 16);
+			this.checkBox6.TabIndex = 8;
+			this.checkBox6.Text = &quot;Deprecation&quot;;
+			//this.checkBox5.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.DebugInformationCheckBox&quot;);
+			
+			//
+			// checkBox7
+			// 
+			this.checkBox7.Location = new System.Drawing.Point(192, 146);
+			this.checkBox7.Name = &quot;checkBox7&quot;;
+			this.checkBox7.Size = new System.Drawing.Size(176, 16);
+			this.checkBox7.TabIndex = 8;
+			this.checkBox7.Text = &quot;Generate Warnings&quot;;
+			//this.checkBox5.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.DebugInformationCheckBox&quot;);
+			
+			//
+			// checkBox5
+			// 
+			this.checkBox5.Location = new System.Drawing.Point(192, 112);
+			this.checkBox5.Name = &quot;checkBox5&quot;;
+			this.checkBox5.Size = new System.Drawing.Size(176, 16);
+			this.checkBox5.TabIndex = 8;
+			this.checkBox5.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.DebugInformationCheckBox&quot;);
+			
+			//
+			// checkBox3
+			// 
+			this.checkBox3.Location = new System.Drawing.Point(192, 96);
+			this.checkBox3.Name = &quot;checkBox3&quot;;
+			this.checkBox3.Size = new System.Drawing.Size(176, 16);
+			this.checkBox3.TabIndex = 7;
+			this.checkBox3.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.OptimizeCheckBox&quot;);
+			
+			// 
+			// label6
+			// 
+			this.label6.Location = new System.Drawing.Point(18, 50);
+			this.label6.Name = &quot;label6&quot;;
+			this.label6.Size = new System.Drawing.Size(80, 23);
+			this.label6.TabIndex = 99;
+			this.label6.Text = &quot;Compiler Path&quot;;	//resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.OutputPathLabel&quot;);
+			
+			//
+			// textBox5
+			// 
+			this.textBox5.Location = new System.Drawing.Point(186, 50);
+			this.textBox5.Name = &quot;textBox5&quot;;
+			this.textBox5.Size = new System.Drawing.Size(182, 20);
+			this.textBox5.TabIndex = 1;
+			this.textBox5.Text = &quot;&quot;;
+			
+			//
+			// label7
+			// 
+			this.label7.Location = new System.Drawing.Point(18, 70);
+			this.label7.Name = &quot;label7&quot;;
+			this.label7.Size = new System.Drawing.Size(80, 23);
+			this.label7.TabIndex = 99;
+			this.label7.Text = &quot;Class Path&quot;; 	//resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.OutputPathLabel&quot;);
+			
+			//
+			// textBox6
+			// 
+			this.textBox6.Location = new System.Drawing.Point(186, 70);
+			this.textBox6.Name = &quot;textBox6&quot;;
+			this.textBox6.Size = new System.Drawing.Size(182, 20);
+			this.textBox6.TabIndex = 1;
+			this.textBox6.Text = &quot;&quot;;
+			
+			//
+			// label8
+			// 
+			this.label8.Location = new System.Drawing.Point(18, 170);
+			this.label8.Name = &quot;label7&quot;;
+			this.label8.Size = new System.Drawing.Size(80, 23);
+			this.label8.TabIndex = 99;
+			this.label8.Text = &quot;Main Class&quot;; 	//resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.OutputPathLabel&quot;);
+			
+			
+			//
+			// textBox7
+			// 
+			this.textBox7.Location = new System.Drawing.Point(186, 170);
+			this.textBox7.Name = &quot;textBox7&quot;;
+			this.textBox7.Size = new System.Drawing.Size(182, 20);
+			this.textBox7.TabIndex = 1;
+			this.textBox7.Text = &quot;&quot;;
+			
+			// 
+			// groupBox2
+			// 
+			this.groupBox2.Controls.AddRange(new System.Windows.Forms.Control[] {   //this.checkBox4,
+																					this.button1,
+																					this.textBox3,
+																					this.label5,
+																					this.textBox2,
+																					this.label4});
+			this.groupBox2.Location = new System.Drawing.Point(8, 240);			
+			this.groupBox2.Name = &quot;groupBox2&quot;;
+			this.groupBox2.Size = new System.Drawing.Size(376, 96);
+			this.groupBox2.TabIndex = 2;
+			this.groupBox2.TabStop = false;
+			this.groupBox2.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.OutputGroupBox&quot;);
+			
+			//
+			// button1
+			// 
+			this.button1.Location = new System.Drawing.Point(344, 40);
+			this.button1.Name = &quot;button1&quot;;
+			this.button1.Size = new System.Drawing.Size(24, 24);
+			this.button1.TabIndex = 3;
+			this.button1.Text = &quot;...&quot;;
+			this.button1.Click += new EventHandler(SelectFolder);
+			// 
+			// textBox3
+			// 
+			this.textBox3.Location = new System.Drawing.Point(96, 40);
+			this.textBox3.Name = &quot;textBox3&quot;;
+			this.textBox3.Size = new System.Drawing.Size(240, 20);
+			this.textBox3.TabIndex = 2;
+			this.textBox3.Text = &quot;&quot;;
+			// 
+			// label5
+			// 
+			this.label5.Location = new System.Drawing.Point(8, 40);
+			this.label5.Name = &quot;label5&quot;;
+			this.label5.Size = new System.Drawing.Size(80, 23);
+			this.label5.TabIndex = 99;
+			this.label5.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.OutputPathLabel&quot;);
+			
+			//
+			// textBox2
+			// 
+			this.textBox2.Location = new System.Drawing.Point(96, 16);
+			this.textBox2.Name = &quot;textBox2&quot;;
+			this.textBox2.Size = new System.Drawing.Size(272, 20);
+			this.textBox2.TabIndex = 1;
+			this.textBox2.Text = &quot;&quot;;
+			// 
+			// label4
+			// 
+			this.label4.Location = new System.Drawing.Point(8, 16);
+			this.label4.Name = &quot;label4&quot;;
+			this.label4.Size = new System.Drawing.Size(88, 16);
+			this.label4.TabIndex = 99;
+			this.label4.Text = resourceService.GetString(&quot;Dialog.Options.PrjOptions.Configuration.WarningsAsErrorsCheckBox&quot;);
+			
+			//
+			// Form5
+			// 
+			this.ClientSize = new System.Drawing.Size(392, 341);
+			this.Controls.AddRange(new System.Windows.Forms.Control[] {   this.groupBox2,
+																		  this.groupBox1});
+			this.Name = &quot;Form5&quot;;
+			this.groupBox1.ResumeLayout(false);
+			this.groupBox2.ResumeLayout(false);
+			this.ResumeLayout(false);
+
+		}
+		#endregion
+		*/
+	}
+}

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBinding.prjx
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBinding.prjx	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBinding.prjx	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,37 @@
+&lt;Project name=&quot;JavaBinding&quot; standardNamespace=&quot;NewProject&quot; description=&quot;&quot; newfilesearch=&quot;None&quot; enableviewstate=&quot;True&quot; version=&quot;1.1&quot; projecttype=&quot;C#&quot;&gt;
+  &lt;Contents&gt;
+    &lt;File name=&quot;.\JavaBindingCompilerServices.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;.\JavaLanguageBinding.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;.\Gui\ProjectConfigurationPropertyPanel.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;.\Project\JavaProject.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;.\Project\JavaCompilerParameters.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;.\JavaBindingExecutionServices.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;.\FormatingStrategy\JavaFormattingStrategy.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+    &lt;File name=&quot;.\ProjectTreeBuilder\JavaNodeBuilder.cs&quot; subtype=&quot;Code&quot; buildaction=&quot;Compile&quot; dependson=&quot;&quot; data=&quot;&quot; /&gt;
+  &lt;/Contents&gt;
+  &lt;References&gt;
+    &lt;Reference type=&quot;Assembly&quot; refto=&quot;..\..\..\..\bin\SharpDevelop.Base.dll&quot; localcopy=&quot;False&quot; /&gt;
+    &lt;Reference type=&quot;Assembly&quot; refto=&quot;..\..\..\..\bin\ICSharpCode.Core.dll&quot; localcopy=&quot;False&quot; /&gt;
+    &lt;Reference type=&quot;Assembly&quot; refto=&quot;..\..\..\..\bin\ICSharpCode.TextEditor.dll&quot; localcopy=&quot;False&quot; /&gt;
+    &lt;Reference type=&quot;Assembly&quot; refto=&quot;..\..\..\..\bin\ICSharpCode.XmlForms.dll&quot; localcopy=&quot;False&quot; /&gt;
+    &lt;Reference type=&quot;Assembly&quot; refto=&quot;..\..\..\..\bin\ICSharpCode.Debugger.dll&quot; localcopy=&quot;True&quot; /&gt;
+  &lt;/References&gt;
+  &lt;DeploymentInformation target=&quot;&quot; script=&quot;&quot; strategy=&quot;File&quot; /&gt;
+  &lt;Configuration runwithwarnings=&quot;False&quot; name=&quot;Debug&quot;&gt;
+    &lt;CodeGeneration runtime=&quot;MsNet&quot; compiler=&quot;Csc&quot; warninglevel=&quot;4&quot; nowarn=&quot;&quot; includedebuginformation=&quot;True&quot; optimize=&quot;True&quot; unsafecodeallowed=&quot;True&quot; generateoverflowchecks=&quot;True&quot; mainclass=&quot;&quot; target=&quot;Library&quot; definesymbols=&quot;&quot; generatexmldocumentation=&quot;False&quot; win32Icon=&quot;&quot; /&gt;
+    &lt;Execution commandlineparameters=&quot;&quot; consolepause=&quot;False&quot; /&gt;
+    &lt;Output directory=&quot;..\..\..\..\AddIns\AddIns\BackendBindings&quot; assembly=&quot;JavaBinding&quot; executeScript=&quot;&quot; executeBeforeBuild=&quot;&quot; executeAfterBuild=&quot;&quot; /&gt;
+  &lt;/Configuration&gt;
+  &lt;Configurations active=&quot;Debug&quot;&gt;
+    &lt;Configuration runwithwarnings=&quot;False&quot; name=&quot;Debug&quot;&gt;
+      &lt;CodeGeneration runtime=&quot;MsNet&quot; compiler=&quot;Csc&quot; warninglevel=&quot;4&quot; nowarn=&quot;&quot; includedebuginformation=&quot;True&quot; optimize=&quot;True&quot; unsafecodeallowed=&quot;True&quot; generateoverflowchecks=&quot;True&quot; mainclass=&quot;&quot; target=&quot;Library&quot; definesymbols=&quot;&quot; generatexmldocumentation=&quot;False&quot; win32Icon=&quot;&quot; /&gt;
+      &lt;Execution commandlineparameters=&quot;&quot; consolepause=&quot;False&quot; /&gt;
+      &lt;Output directory=&quot;..\..\..\..\AddIns\AddIns\BackendBindings&quot; assembly=&quot;JavaBinding&quot; executeScript=&quot;&quot; executeBeforeBuild=&quot;&quot; executeAfterBuild=&quot;&quot; /&gt;
+    &lt;/Configuration&gt;
+    &lt;Configuration runwithwarnings=&quot;False&quot; name=&quot;Release&quot;&gt;
+      &lt;CodeGeneration runtime=&quot;MsNet&quot; compiler=&quot;Csc&quot; warninglevel=&quot;4&quot; nowarn=&quot;&quot; includedebuginformation=&quot;True&quot; optimize=&quot;True&quot; unsafecodeallowed=&quot;True&quot; generateoverflowchecks=&quot;True&quot; mainclass=&quot;&quot; target=&quot;Exe&quot; definesymbols=&quot;&quot; generatexmldocumentation=&quot;False&quot; win32Icon=&quot;&quot; /&gt;
+      &lt;Execution commandlineparameters=&quot;&quot; consolepause=&quot;True&quot; /&gt;
+      &lt;Output directory=&quot;..\..\..\..\AddIns\AddIns\BackendBindings&quot; assembly=&quot;JavaBinding&quot; executeScript=&quot;&quot; executeBeforeBuild=&quot;&quot; executeAfterBuild=&quot;&quot; /&gt;
+    &lt;/Configuration&gt;
+  &lt;/Configurations&gt;
+&lt;/Project&gt;
\ No newline at end of file

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingCompilerServices.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingCompilerServices.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingCompilerServices.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,189 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.IO;
+using System.CodeDom.Compiler;
+
+using MonoDevelop.Core.Services;
+using MonoDevelop.Internal.Project;
+
+namespace JavaBinding
+{
+	/// &lt;summary&gt;
+	/// This class controls the compilation of C Sharp files and C Sharp projects
+	/// &lt;/summary&gt;
+	public class JavaBindingCompilerServices
+	{	
+		public bool CanCompile(string fileName)
+		{
+			return Path.GetExtension(fileName) == &quot;.java&quot;;
+		}
+		
+		public ICompilerResult CompileFile(string filename)
+		{
+			string output = &quot;&quot;;
+			string error  = &quot;&quot;;
+			string options = &quot;&quot;;
+			
+			JavaCompilerParameters cparam = new JavaCompilerParameters();
+			
+			if (cparam.Debugmode) {
+				options += &quot; -g &quot;;
+			} else {
+				options += &quot; -g:none &quot;;
+			}
+			
+			if (cparam.Optimize) {
+				options += &quot; -O &quot;;
+			}
+			
+			if (cparam.GenWarnings) {
+				options += &quot; -nowarn &quot;;
+			}
+			options += &quot; -encoding utf8 &quot;;
+			
+			TempFileCollection  tf = new TempFileCollection();					
+			
+			string outstr = &quot;javac \&quot;&quot; + filename + &quot;\&quot; -classpath &quot; + cparam.ClassPath + options;
+			Executor.ExecWaitWithCapture(outstr, tf, ref error , ref output);
+			
+			ICompilerResult cr = ParseOutput(tf, output);
+			
+			File.Delete(output);
+			File.Delete(error);
+			
+			return cr;	
+		}
+		
+		public string GetCompiledOutputName(string fileName)
+		{
+			return Path.ChangeExtension(fileName, &quot;.class&quot;);
+		}
+		FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
+		public string GetCompiledOutputName(IProject project)
+		{
+			JavaProject p = (JavaProject)project;
+			JavaCompilerParameters compilerparameters = (JavaCompilerParameters)p.ActiveConfiguration;
+			
+			string exe         = fileUtilityService.GetDirectoryNameWithSeparator(compilerparameters.OutputDirectory) + compilerparameters.OutputAssembly + &quot;.class&quot;;
+			return exe;
+		}
+		
+		public ICompilerResult CompileProject(IProject project)
+		{
+			JavaProject p = (JavaProject)project;
+			JavaCompilerParameters compilerparameters = (JavaCompilerParameters)p.ActiveConfiguration;
+			
+			string exe         = fileUtilityService.GetDirectoryNameWithSeparator(compilerparameters.OutputDirectory) + compilerparameters.OutputAssembly + &quot;.class&quot;;
+			string options   = &quot;&quot;;
+			
+			if (compilerparameters.Debugmode) 
+				options += &quot; -g &quot;;
+			else
+				options += &quot; -g:none &quot;;
+			
+			if (compilerparameters.Optimize)
+				options += &quot; -O &quot;;
+			
+			if (compilerparameters.Deprecation)
+				options += &quot; -deprecation &quot;;
+			
+			if (compilerparameters.GenWarnings)
+				options += &quot; -nowarn &quot;;
+			
+			if (compilerparameters.ClassPath == null)
+				options += &quot; -classpath &quot; + compilerparameters.ClassPath;
+			
+			options += &quot; -encoding utf8 &quot;;
+			
+			string output = &quot;&quot;;
+			string error  = &quot;&quot;;
+			string files  = &quot;&quot;;
+			
+			foreach (ProjectFile finfo in p.ProjectFiles) {
+				if (finfo.Subtype != Subtype.Directory) {
+					switch (finfo.BuildAction) {
+						case BuildAction.Compile:
+							files = files + &quot; \&quot;&quot; + finfo.Name + &quot;\&quot;&quot;;
+						break;
+					}
+				}
+			}
+
+			TempFileCollection  tf = new TempFileCollection ();			
+			
+			//string CurrentDir = Directory.GetCurrentDirectory();
+			//Directory.SetCurrentDirectory(compilerparameters.OutputDirectory);
+			
+			//string outstr = compilerparameters.CompilerPath + &quot;&quot; + files + &quot; -classpath &quot; + compilerparameters.ClassPath + options;
+			//string outstr = compilerparameters.CompilerPath + &quot;&quot; + files + &quot; -classpath &quot; + compilerparameters.ClassPath + options;
+			string outstr = compilerparameters.CompilerPath + &quot; &quot; + files + options;			
+			Executor.ExecWaitWithCapture(outstr, tf, ref error , ref output);			
+			ICompilerResult cr = ParseOutput(tf, output);			
+			
+			File.Delete(output);
+			File.Delete(error);
+			
+			//Directory.SetCurrentDirectory(CurrentDir);			
+			
+//			TempFileCollection  tf = new TempFileCollection ();
+//			string output = &quot;&quot;;
+//			string error  = &quot;&quot;;
+//			//string outstr = compilerparameters.CompilerPath + &quot; &quot; + compilerparameters.OutputDirectory+&quot;untitled.java -classpath &quot; + compilerparameters.ClassPath + options;
+//			string outstr = compilerparameters.CompilerPath + &quot; &quot; + compilerparameters.OutputDirectory + finfo.Name;					
+//			Executor.ExecWaitWithCapture(outstr, tf, ref error , ref output);												
+//			CompilerResults cr = ParseOutput(tf, output);
+//			File.Delete(output);
+//			File.Delete(error);
+			
+			return cr;
+		}
+		
+		ICompilerResult ParseOutput(TempFileCollection tf, string file)
+		{
+			string compilerOutput = &quot;&quot;;		
+			StreamReader sr = new StreamReader(file, System.Text.Encoding.Default);
+			CompilerResults cr = new CompilerResults(tf);
+			
+			while (true) 
+				{
+				string next = sr.ReadLine();									
+				
+				if (next == null)
+					break;
+				
+				compilerOutput += next + &quot;\n&quot;;
+					
+				CompilerError error = new CompilerError();
+				
+				int index1 = next.IndexOf(&quot;.java:&quot;);
+				if (index1 &lt; 0)
+					continue;				
+				
+				string s1 = next.Substring(0, index1);
+				string s2 = next.Substring(index1 + 6);									
+				int index2  = s2.IndexOf(&quot;:&quot;);				
+				int line = Int32.Parse(next.Substring(index1 + 6,index2));
+					
+//				error.Column = Int32.Parse(pos2[1]);
+//				error.IsWarning   = what[0] == &quot;warning&quot;;
+//				error.ErrorNumber = what[what.Length - 1];				
+								
+				error.Column = 25;
+				error.Line   	= line;
+				error.ErrorText = next.Substring(index1 + index2 + 7);
+				error.FileName  = Path.GetFullPath(next.Substring(0, index1) + &quot;.java&quot;); //Path.GetFileName(filename);
+				cr.Errors.Add(error);
+				
+			}
+			sr.Close();			
+			return new DefaultCompilerResult(cr, compilerOutput);
+
+		}
+	}
+}

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingExecutionServices.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingExecutionServices.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaBindingExecutionServices.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,79 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.IO;
+using System.Diagnostics;
+using System.Collections;
+using System.Reflection;
+using System.Resources;
+using System.Xml;
+using System.CodeDom.Compiler;
+using System.Threading;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Gui;
+using MonoDevelop.Core.Services;
+
+namespace JavaBinding
+{
+	/// &lt;summary&gt;
+	/// This class controls the compilation of C Sharp files and C Sharp projects
+	/// &lt;/summary&gt;
+	public class JavaBindingExecutionServices
+	{	
+		
+		public void Execute(string filename)
+		{
+			string exe = Path.GetFileNameWithoutExtension(filename);
+			ProcessStartInfo psi = new ProcessStartInfo(Environment.GetEnvironmentVariable(&quot;ComSpec&quot;), &quot;/c java &quot; + &quot;\&quot;&quot; + exe + &quot;\&quot;&quot; + &quot; &amp; pause&quot;);
+			psi.WorkingDirectory = Path.GetDirectoryName(filename);
+			psi.UseShellExecute = false;
+			try {
+				Process p = new Process();
+				p.StartInfo = psi;
+				p.Start();
+			} catch (Exception) {
+				throw new ApplicationException(&quot;Can't execute &quot; + &quot;\&quot;&quot; + exe + &quot;\&quot;\n(.NET bug? Try restaring SD or manual start)&quot;);
+			}
+		}
+		
+		public void Execute(IProject project)
+		{
+			JavaCompilerParameters parameters = (JavaCompilerParameters)project.ActiveConfiguration;
+			FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
+			string directory = fileUtilityService.GetDirectoryNameWithSeparator(((JavaCompilerParameters)project.ActiveConfiguration).OutputDirectory);
+			
+			string CurrentDir = Directory.GetCurrentDirectory();
+			Directory.SetCurrentDirectory(parameters.OutputDirectory);
+			ProcessStartInfo psi;
+			if(((JavaCompilerParameters)project.ActiveConfiguration).MainClass==null) {
+				psi = new ProcessStartInfo(Environment.GetEnvironmentVariable(&quot;ComSpec&quot;), &quot;/c java &quot; + ((JavaCompilerParameters)project.ActiveConfiguration).OutputAssembly +  &quot; &amp; pause&quot;);
+			} else {
+				if (parameters.PauseConsoleOutput) {
+					psi = new ProcessStartInfo(Environment.GetEnvironmentVariable(&quot;ComSpec&quot;), &quot;/c java &quot; + ((JavaCompilerParameters)project.ActiveConfiguration).MainClass +  &quot; &amp; pause&quot;);
+				} else {
+					psi = new ProcessStartInfo(Environment.GetEnvironmentVariable(&quot;ComSpec&quot;), &quot;/c java &quot; + ((JavaCompilerParameters)project.ActiveConfiguration).MainClass);
+				}
+			}
+			
+			try {
+				psi.WorkingDirectory = parameters.OutputDirectory;
+				psi.UseShellExecute = false;
+			
+				Process p = new Process();
+				p.StartInfo = psi;
+				p.Start();
+			} catch (Exception) {
+				throw new ApplicationException(&quot;Can't execute&quot;);
+			}
+			
+			Directory.SetCurrentDirectory(CurrentDir);		
+		}
+				
+	}
+}

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaLanguageBinding.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaLanguageBinding.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/JavaLanguageBinding.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,95 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.IO;
+using System.Diagnostics;
+using System.Collections;
+using System.Reflection;
+using System.Resources;
+using System.Xml;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Internal.Templates;
+using MonoDevelop.Gui;
+
+namespace JavaBinding
+{
+	/// &lt;summary&gt;
+	/// This class describes the main functionalaty of a language binding
+	/// &lt;/summary&gt;
+	public class JavaLanguageBinding : ILanguageBinding
+	{
+		public const string LanguageName = &quot;Java&quot;;
+		
+		JavaBindingCompilerServices   compilerServices  = new JavaBindingCompilerServices();
+		JavaBindingExecutionServices  executionServices = new JavaBindingExecutionServices();
+		
+		public string Language {
+			get {
+				return LanguageName;
+			}
+		}
+		
+		public void Execute (string filename)
+		{
+			Debug.Assert(executionServices != null);
+			executionServices.Execute(filename);
+		}
+		
+		public void Execute (IProject project)
+		{
+			Debug.Assert (executionServices != null);
+			executionServices.Execute (project);
+		}
+		
+		public string GetCompiledOutputName(string fileName)
+		{
+			Debug.Assert(compilerServices != null);
+			return compilerServices.GetCompiledOutputName(fileName);
+		}
+		
+		public string GetCompiledOutputName(IProject project)
+		{
+			Debug.Assert(compilerServices != null);
+			return compilerServices.GetCompiledOutputName(project);
+		}
+		
+		public bool CanCompile(string fileName)
+		{
+			Debug.Assert(compilerServices != null);
+			return compilerServices.CanCompile(fileName);
+		}
+		
+		public ICompilerResult CompileFile(string fileName)
+		{
+			Debug.Assert(compilerServices != null);
+			return compilerServices.CompileFile(fileName);
+		}
+		
+		public ICompilerResult CompileProject(IProject project)
+		{
+			Debug.Assert(compilerServices != null);
+			return compilerServices.CompileProject(project);
+		}
+		
+		public ICompilerResult RecompileProject(IProject project)
+		{
+			return CompileProject(project);
+		}
+		
+		public IProject CreateProject(ProjectCreateInformation info, XmlElement projectOptions)
+		{
+			return new JavaProject(info, projectOptions);
+		}
+
+		public void DebugProject (IProject project)
+		{
+			//executionManager.Debug (project);
+		}
+	}
+}

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Makefile.am
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Makefile.am	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Makefile.am	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,30 @@
+
+CSC = mcs /debug
+ASSEMBLY = JavaBinding.dll
+ADDIN = JavaBinding.addin
+
+DLLS = /r:System.Drawing.dll \
+	/r:../../../../build/bin/MonoDevelop.Core.dll \
+	/r:../../../../build/bin/MonoDevelop.SourceEditor.dll \
+	/r:../../../../build/bin/MonoDevelop.Base.dll \
+	/r:../../../../build/bin/ICSharpCode.SharpRefactory.dll \
+	/r:../../../../build/bin/MonoDevelop.Gui.Widgets.dll \
+	/r:gtk-sharp.dll
+
+FILES = ./Gui/ProjectConfigurationPropertyPanel.cs \
+./Project/JavaCompilerParameters.cs \
+./Project/JavaProject.cs \
+./JavaBindingCompilerServices.cs \
+./JavaLanguageBinding.cs \
+./FormatingStrategy/JavaFormattingStrategy.cs \
+./JavaBindingExecutionServices.cs \
+./ProjectTreeBuilder/JavaNodeBuilder.cs
+
+all: $(ASSEMBLY)
+
+$(ASSEMBLY): $(FILES)
+	$(CSC) $(DLLS) $(FILES) /out:$(ASSEMBLY) /target:library
+
+CLEANFILES = $(ASSEMBLY)
+EXTRA_DIST = $(FILES) $(ADDIN)
+

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaCompilerParameters.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaCompilerParameters.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaCompilerParameters.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,140 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.Xml;
+using System.Diagnostics;
+
+using MonoDevelop.Internal.Project;
+
+namespace JavaBinding
+{
+	/// &lt;summary&gt;
+	/// This class handles project specific compiler parameters
+	/// &lt;/summary&gt;
+	public class JavaCompilerParameters : AbstractProjectConfiguration
+	{
+		[XmlNodeName(&quot;CodeGeneration&quot;)]
+		class CodeGeneration 
+		{
+			[XmlAttribute(&quot;includedebuginformation&quot;)]
+			public bool debugmode          = true;
+			
+			[XmlAttribute(&quot;deprecation&quot;)]
+			public bool deprecation        = true;
+			
+			[XmlAttribute(&quot;optimize&quot;)]
+			public bool optimize           = true;
+			
+			[XmlAttribute(&quot;mainclass&quot;)]
+			public string         mainclass     = null;
+			
+			[XmlAttribute(&quot;definesymbols&quot;)]
+			public string         definesymbols = String.Empty;
+			
+			[XmlAttribute(&quot;classpath&quot;)]
+			public string         classpath = String.Empty;
+			
+			[XmlAttribute(&quot;compilerpath&quot;)]
+			public string         compilerpath  = &quot;javac.exe&quot;;		
+			
+			[XmlAttribute(&quot;genwarnings&quot;)]
+			public bool genwarnings = false;
+		}
+		
+		[XmlNodeName(&quot;Execution&quot;)]
+		class Execution
+		{
+			[XmlAttribute(&quot;consolepause&quot;)]
+			public bool    pauseconsoleoutput = true;
+		}
+		
+		CodeGeneration codeGeneration = new CodeGeneration();
+		
+		Execution      execution      = new Execution();
+		
+		public bool GenWarnings {
+			get {
+				return codeGeneration.genwarnings;
+			}
+			set {
+				codeGeneration.genwarnings = value;
+			}
+		}
+		
+		public string ClassPath {
+			get {
+				return codeGeneration.classpath;
+			}
+			set {
+				codeGeneration.classpath = value;
+			}
+		}
+		
+		public string CompilerPath {
+			get {
+				return codeGeneration.compilerpath;
+			}
+			set {
+				codeGeneration.compilerpath = value;
+			}
+		}
+		
+		public bool Debugmode {
+			get {
+				return codeGeneration.debugmode;
+			}
+			set {
+				codeGeneration.debugmode = value;
+			}
+		}
+		
+		public bool Deprecation {
+			get {
+				return codeGeneration.deprecation;
+			}
+			set {
+				codeGeneration.deprecation = value;
+			}
+		}
+		
+		public bool Optimize {
+			get {
+				return codeGeneration.optimize;
+			}
+			set {
+				codeGeneration.optimize = value;
+			}
+		}
+		
+		public string MainClass {
+			get {
+				return codeGeneration.mainclass;
+			}
+			set {
+				codeGeneration.mainclass = value;
+			}
+		}
+		
+		public bool PauseConsoleOutput {
+			get {
+				return execution.pauseconsoleoutput;
+			}
+			set {
+				execution.pauseconsoleoutput = value;
+			}
+		}
+		
+		public JavaCompilerParameters()
+		{
+		}
+		public JavaCompilerParameters(string name)
+		{
+			this.name = name;
+		}
+	}
+}

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaProject.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaProject.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/Project/JavaProject.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,70 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#195;&#188;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.IO;
+using System.Collections;
+using System.Diagnostics;
+using System.ComponentModel;
+using System.Xml;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Internal.Templates;
+
+namespace JavaBinding
+{
+	
+	/// &lt;summary&gt;
+	/// This class describes a C Sharp project and it compilation options.
+	/// &lt;/summary&gt;
+	public class JavaProject : AbstractProject
+	{		
+		public override string ProjectType {
+			get {
+				return JavaLanguageBinding.LanguageName;
+			}
+		}
+		
+		public override IConfiguration CreateConfiguration()
+		{
+			return new JavaCompilerParameters();
+		}
+		
+		public JavaProject()
+		{
+		}
+		
+		public JavaProject(ProjectCreateInformation info, XmlElement projectOptions)
+		{
+			if (info != null) {
+				Name = info.ProjectName;
+				
+				Configurations.Add(CreateConfiguration(&quot;Debug&quot;));
+				Configurations.Add(CreateConfiguration(&quot;Release&quot;));
+				
+				XmlElement el = projectOptions;
+				
+				foreach (JavaCompilerParameters parameter in Configurations) {
+					parameter.OutputDirectory = info.BinPath;
+					parameter.OutputAssembly  = Name;
+					
+					if (el != null) {
+						if (el.Attributes[&quot;MainClass&quot;] != null) {
+							parameter.MainClass = el.Attributes[&quot;MainClass&quot;].InnerText;
+						}
+						if (el.Attributes[&quot;PauseConsoleOutput&quot;] != null) {
+							parameter.PauseConsoleOutput = Boolean.Parse(el.Attributes[&quot;PauseConsoleOutput&quot;].InnerText);
+						}
+						if (el.Attributes[&quot;ClassPath&quot;] != null) {
+							parameter.ClassPath = el.Attributes[&quot;ClassPath&quot;].InnerText;
+						}
+					}
+				}
+			}
+		}
+	}
+}

Added: trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ProjectTreeBuilder/JavaNodeBuilder.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ProjectTreeBuilder/JavaNodeBuilder.cs	2004-03-25 21:55:04 UTC (rev 1246)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/JavaBinding/ProjectTreeBuilder/JavaNodeBuilder.cs	2004-03-25 22:19:12 UTC (rev 1247)
@@ -0,0 +1,151 @@
+&#65279;// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.IO;
+using System.Diagnostics;
+using System.Collections;
+using System.Reflection;
+using System.Resources;
+using System.Xml;
+
+using MonoDevelop.Core.Properties;
+using MonoDevelop.Core.Services;
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Gui;
+using MonoDevelop.Gui.Pads.ProjectBrowser;
+
+namespace JavaBinding
+{
+	public class JavaNodeBuilder : IProjectNodeBuilder
+	{
+		FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
+		ResourceService resourceService = (ResourceService)ServiceManager.Services.GetService(typeof(IResourceService));
+		IconService iconService = (IconService)ServiceManager.Services.GetService(typeof(IconService));
+		
+		public bool CanBuildProjectTree(IProject project)
+		{
+			return project.ProjectType == JavaLanguageBinding.LanguageName;
+		}
+		
+		public AbstractBrowserNode BuildProjectTreeNode(IProject project)
+		{
+/*
+			ProjectBrowserNode projectNode = new ProjectBrowserNode(project);
+			
+			projectNode.IconImage = iconService.GetImageForProjectType(project.ProjectType);
+			
+			// create 'empty' directories			
+			for (int i = 0; i &lt; project.ProjectFiles.Count; ++i) {
+				if (project.ProjectFiles[i].Subtype == Subtype.Directory) {
+					string directoryName   = fileUtilityService.AbsoluteToRelativePath(project.BaseDirectory, project.ProjectFiles[i].Name);
+
+					// if directoryname starts with ./ oder .\
+					if (directoryName.StartsWith(&quot;.&quot;)) {
+						directoryName =  directoryName.Substring(2);
+					}
+					
+					string parentDirectory = Path.GetFileName(directoryName);
+					
+					AbstractBrowserNode currentPathNode = GetPath(directoryName, projectNode, true);
+					
+					DirectoryNode newFolderNode  = new DirectoryNode(project.ProjectFiles[i].Name);
+					newFolderNode.OpenedImage = resourceService.GetBitmap(&quot;Icons.16x16.OpenFolderBitmap&quot;);
+					newFolderNode.ClosedImage = resourceService.GetBitmap(&quot;Icons.16x16.ClosedFolderBitmap&quot;);
+					
+					currentPathNode.Nodes.Add(newFolderNode);
+				
+				}
+			}
+			
+			// create file tree
+			for (int i = 0; i &lt; project.ProjectFiles.Count; ++i) {
+				if (project.ProjectFiles[i].Subtype != Subtype.Directory) {
+					ProjectFile fileInformation = project.ProjectFiles[i];
+					
+					string relativeFile = fileUtilityService.AbsoluteToRelativePath(project.BaseDirectory, fileInformation.Name);
+					
+					string fileName     = Path.GetFileName(fileInformation.Name);
+					
+					switch (fileInformation.BuildAction) {
+						
+						case BuildAction.Exclude:
+							break;
+						
+						default:
+							AbstractBrowserNode currentPathNode = GetPath(relativeFile, projectNode, true);
+							
+							AbstractBrowserNode newNode = new FileNode(fileInformation);
+							newNode.ContextmenuAddinTreePath = FileNode.ProjectFileContextMenuPath;
+							currentPathNode.Nodes.Add(newNode);
+							break;
+					}
+				}
+			}
+			
+			return projectNode;
+*/
+			return null;
+		}
+
+/*		
+		AbstractBrowserNode GetNodeFromCollection (TreeNodeCollection collection, string title)
+		{
+			foreach (AbstractBrowserNode node in collection) {
+				if (node.Text == title) {
+					return node;
+				}
+			}
+			return null;
+		}
+*/
+		
+		public AbstractBrowserNode GetPath(string filename, AbstractBrowserNode root, bool create)
+		{
+			string directory    = Path.GetDirectoryName(filename);
+			string[] treepath   = directory.Split(new char[] { Path.DirectorySeparatorChar });
+			AbstractBrowserNode curpathnode = root;
+			
+			foreach (string path in treepath) {
+				if (path.Length == 0 || path[0] == '.') {
+					continue;
+				}
+				
+				AbstractBrowserNode node = null;
+				//AbstractBrowserNode node = GetNodeFromCollection(curpathnode.Nodes, path);
+				
+				if (node == null) {
+					if (create) {
+						DirectoryNode newFolderNode  = new DirectoryNode(fileUtilityService.GetDirectoryNameWithSeparator(ConstructFolderName(curpathnode)) + path);
+						curpathnode.Nodes.Add(newFolderNode);
+						curpathnode = newFolderNode;
+						continue;
+					} else {
+						return null;
+					}
+				}
+				curpathnode = node;
+			}
+			
+			return curpathnode;
+		}
+		
+		public string ConstructFolderName(AbstractBrowserNode folderNode)
+		{
+			if (folderNode is DirectoryNode) {
+				return ((DirectoryNode)folderNode).FolderName;
+			}
+			
+			if (folderNode is ProjectBrowserNode) {
+				return ((ProjectBrowserNode)folderNode).Project.BaseDirectory;
+			}
+			
+			throw new ApplicationException(&quot;Folder name construction failed, got unexpected parent node :&quot; +  folderNode);
+		}
+		
+	}
+}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000853.html">[Monodevelop-patches-list] r1246 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: . CodeCompletion
</A></li>
	<LI>Next message: <A HREF="000855.html">[Monodevelop-patches-list] r1248 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: . Gui Gui/OptionPanels Properties
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#854">[ date ]</a>
              <a href="thread.html#854">[ thread ]</a>
              <a href="subject.html#854">[ subject ]</a>
              <a href="author.html#854">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
