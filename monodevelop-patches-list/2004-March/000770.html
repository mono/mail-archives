<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1164 - in trunk/MonoDevelop: . gdldock/sources/gdl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1164%20-%20in%20trunk/MonoDevelop%3A%20.%20gdldock/sources/gdl&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000769.html">
   <LINK REL="Next"  HREF="000771.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1164 - in trunk/MonoDevelop: . gdldock/sources/gdl</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1164%20-%20in%20trunk/MonoDevelop%3A%20.%20gdldock/sources/gdl&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1164 - in trunk/MonoDevelop: . gdldock/sources/gdl">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Fri Mar 12 14:01:15 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000769.html">[Monodevelop-patches-list] r1163 - trunk/MonoDevelop/src/Main/Base/Gui/Pads/HelpBrowser
</A></li>
        <LI>Next message: <A HREF="000771.html">[Monodevelop-patches-list] r1165 - in trunk/MonoDevelop: . gdldock/sources/gdl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#770">[ date ]</a>
              <a href="thread.html#770">[ thread ]</a>
              <a href="subject.html#770">[ subject ]</a>
              <a href="author.html#770">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ggiraldez
Date: 2004-03-12 14:01:15 -0500 (Fri, 12 Mar 2004)
New Revision: 1164

Modified:
   trunk/MonoDevelop/ChangeLog
   trunk/MonoDevelop/configure.in
   trunk/MonoDevelop/gdldock/sources/gdl/
   trunk/MonoDevelop/gdldock/sources/gdl/Makefile.am
Log:
2004-03-12  Gustavo Gir?\195?\161ldez  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">gustavo.giraldez at gmx.net</A>&gt;

	* gdldock/sources/gdl/Makefile.am: Build libgdldock.so using
	automake builtin rules for shared libraries instead of a hackish,
	home made solution.

	* configure.in: Add GDLDOCK_{CFLAGS,LIBS} variables for building
	GdlDock.



Modified: trunk/MonoDevelop/ChangeLog
===================================================================
--- trunk/MonoDevelop/ChangeLog	2004-03-12 15:36:23 UTC (rev 1163)
+++ trunk/MonoDevelop/ChangeLog	2004-03-12 19:01:15 UTC (rev 1164)
@@ -1,3 +1,12 @@
+2004-03-12  Gustavo Gir&#225;ldez  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">gustavo.giraldez at gmx.net</A>&gt;
+
+	* gdldock/sources/gdl/Makefile.am: Build libgdldock.so using
+	automake builtin rules for shared libraries instead of a hackish,
+	home made solution.
+
+	* configure.in: Add GDLDOCK_{CFLAGS,LIBS} variables for building
+	GdlDock.
+
 2004-03-05  John BouAntoun  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jba-mono at optusnet.com.au</A>&gt;
 	
 	* src/Main/Base/Commands/ProjectBrowserCommands/CombineNodeCommands.cs:

Modified: trunk/MonoDevelop/configure.in
===================================================================
--- trunk/MonoDevelop/configure.in	2004-03-12 15:36:23 UTC (rev 1163)
+++ trunk/MonoDevelop/configure.in	2004-03-12 19:01:15 UTC (rev 1164)
@@ -2,6 +2,8 @@
 AC_CANONICAL_SYSTEM
 AM_INIT_AUTOMAKE(monodevelop, 0.2)
 AM_MAINTAINER_MODE
+
+AM_DISABLE_STATIC
 AM_PROG_LIBTOOL
 
 AC_PATH_PROG(MONO, mono)
@@ -47,6 +49,24 @@
 GNOMEVFS_REQUIRED_VERSION=2.0
 PKG_CHECK_MODULES(BASE_DEPENDENCIES, gnome-vfs-2.0 &gt;= $GNOMEVFS_REQUIRED_VERSION, enable_gnomevfs=yes, enable_gnomevfs=no)
 
+dnl GdlDock requirements and configuration
+GTK_REQUIRED=2.2.0
+LIBXML_REQUIRED=2.2.8
+LIBGLADE_REQUIRED=2.0.0
+PKG_CHECK_MODULES(GDLDOCK, 
+	gtk+-2.0 &gt;= $GTK_REQUIRED 
+	libglade-2.0 &gt;= $LIBGLADE_REQUIRED
+	libxml-2.0 &gt;= $LIBXML_REQUIRED)
+AC_SUBST(GDLDOCK_CFLAGS)
+AC_SUBST(GDLDOCK_LIBS)
+
+dnl marshal and enum generators
+GLIB_GENMARSHAL=&quot;`$PKG_CONFIG --variable=glib_genmarshal glib-2.0`&quot;
+AC_SUBST(GLIB_GENMARSHAL)
+GLIB_MKENUMS=&quot;`$PKG_CONFIG --variable=glib_mkenums glib-2.0`&quot;
+AC_SUBST(GLIB_MKENUMS)
+
+
 dnl should this be a hard dep?
 dnl ORBIT2_REQUIRED_VERSION=2.8.3
 


Property changes on: trunk/MonoDevelop/gdldock/sources/gdl
___________________________________________________________________
Name: svn:ignore
   - libgdldock.so
libgdltypebuiltins.*
libgdlmarshal.*
Makefile
Makefile.in

   + libgdldock.so
libgdltypebuiltins.*
libgdlmarshal.*
Makefile
Makefile.in
.libs
.deps


Modified: trunk/MonoDevelop/gdldock/sources/gdl/Makefile.am
===================================================================
--- trunk/MonoDevelop/gdldock/sources/gdl/Makefile.am	2004-03-12 15:36:23 UTC (rev 1163)
+++ trunk/MonoDevelop/gdldock/sources/gdl/Makefile.am	2004-03-12 19:01:15 UTC (rev 1164)
@@ -1,21 +1,18 @@
-srcdir = .
-
-CFLAGS = -g -Wall -O2
-LDFLAGS = -g -shared
-
-GLIB_GENMARSHAL = $(shell which glib-genmarshal)
-GLIB_MKENUMS = $(shell which glib-mkenums)
-
-GDL_REQUIREMENTS = gtk+-2.0 libglade-2.0 libxml-2.0
-GDL_DEPENDENCIES_CFLAGS = $(shell pkg-config --cflags $(GDL_REQUIREMENTS))
-GDL_DEPENDENCIES_LIBS = $(shell pkg-config --libs $(GDL_REQUIREMENTS))
-
 INCLUDES = \
 	-DG_LOG_DOMAIN=\&quot;GdlDock\&quot; -I..	-I.	\
 	-DGDL_GLADEDIR=\&quot;.\&quot;			\
 	-DGDL_IMAGESDIR=\&quot;.\&quot;			\
-	$(GDL_DEPENDENCIES_CFLAGS)
+	$(GDLDOCK_CFLAGS)
 
+gdldocklibdir = $(prefix)/lib/monodevelop/bin
+
+gdldocklib_LTLIBRARIES = libgdldock.la
+
+dist_gdldocklib_DATA = \
+	stock-close-12.png \
+	stock-menu-left-12.png \
+	stock-menu-right-12.png
+
 libgdldock_headers = \
 	gdl-dock-bar.h \
 	gdl-dock-object.h \
@@ -30,7 +27,7 @@
 	gdl-dock-placeholder.h \
 	gdl-stock.h
 
-libgdldock_SOURCE = \
+libgdldock_la_SOURCES = \
 	$(libgdldock_headers) \
 	gdl-i18n.h \
 	gdl-dock-bar.c \
@@ -45,29 +42,34 @@
 	gdl-dock-layout.c \
 	gdl-dock-placeholder.c \
 	gdl-stock.c \
+	gdl-tools.h \
 	libgdltypebuiltins.c \
 	libgdlmarshal.c
 
-libgdldock_OBJECTS = $(filter-out %.h,$(patsubst %.c,%.o,$(libgdldock_SOURCE)))
+libgdldock_la_LIBADD = $(GDLDOCK_LIBS)
+libgdldock_la_LDFLAGS = -avoid-version
 
-GENERATED_SOURCE = \
+BUILT_SOURCES = \
 	libgdltypebuiltins.h \
 	libgdltypebuiltins.c \
 	libgdlmarshal.h \
 	libgdlmarshal.c
 
-all: libgdldock.so
+EXTRA_DIST = libgdlmarshal.list layout.glade
 
-$(libgdldock_OBJECTS): $(libgdldock_headers) libgdltypebuiltins.h libgdlmarshal.h
+CLEANFILES = $(BUILT_SOURCES)
 
-libgdldock.so: $(libgdldock_OBJECTS)
-	$(CC) $(LDFLAGS) -shared -fPIC -o libgdldock.so $+ &amp;&amp; \
-	cp libgdldock.so ../../../build/bin &amp;&amp; \
-	cp *.png ../../../build/bin
+# Install built library to build/bin
 
-%.o: %.c
-	$(CC) $(CFLAGS) $(INCLUDES) -c $&lt;
-	
+# The `pwd` is a hack, but libtool wants an absolute path, and
+# top_builddir is apparently always relative to the current dir.
+# When we depend on Autoconf 2.53 we can use @abs_top_builddir@
+# instead.
+
+all-local:
+	$(LIBTOOL) --mode=install $(INSTALL) libgdldock.la `pwd`/$(top_builddir)/build/bin
+	$(INSTALL_DATA) $(dist_gdldocklib_DATA) $(top_builddir)/build/bin
+
 # enumerations code generation
 
 libgdltypebuiltins.c: $(libgdldock_headers)
@@ -115,15 +117,3 @@
 	&amp;&amp; cp xgen-gmc $(@F) \
 	&amp;&amp; rm -f xgen-gmc
 
-gdldocklibdir = $(prefix)/lib/monodevelop/bin
-gdldocklib_DATA = libgdldock.so stock-close-12.png \
-	stock-menu-left-12.png stock-menu-right-12.png
-
-clean:
-	rm -f libgdldock.so $(libgdldock_OBJECTS) $(GENERATED_SOURCE)
-
-CLEANFILES = libgdldock.so
-
-.PHONY: clean
-
-EXTRA_DIST = $(libgdldock_SOURCE) $(libgdldock_headers) stock-close-12.png stock-menu-left-12.png stock-menu-right-12.png libgdlmarshal.list gdl-tools.h


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000769.html">[Monodevelop-patches-list] r1163 - trunk/MonoDevelop/src/Main/Base/Gui/Pads/HelpBrowser
</A></li>
	<LI>Next message: <A HREF="000771.html">[Monodevelop-patches-list] r1165 - in trunk/MonoDevelop: . gdldock/sources/gdl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#770">[ date ]</a>
              <a href="thread.html#770">[ thread ]</a>
              <a href="subject.html#770">[ subject ]</a>
              <a href="author.html#770">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
