<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1155 - in trunk/MonoDevelop: . build/data/templates/project/CSharp src/AddIns/DisplayBindings/SourceEditor src/AddIns/DisplayBindings/SourceEditor/CodeCompletion src/AddIns/DisplayBindings/SourceEditor/Codons src/AddIns/DisplayBindings/SourceEditor/Commands src/AddIns/DisplayBindings/SourceEditor/Gui src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels src/Main/Base/Gui/Components/StatusBar src/Main/Base/Services/StatusBar
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1155%20-%20in%20trunk/MonoDevelop%3A%20.%20build/data/templates/project/CSharp%20src/AddIns/DisplayBindings/SourceEditor%20src/AddIns/DisplayBindings/SourceEditor/CodeCompletion%20src/AddIns/DisplayBindings/SourceEditor/Codons%20src/AddIns/DisplayBindings/SourceEditor/Commands%20src/AddIns/DisplayBindings/SourceEditor/Gui%20src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs%20src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels%20src/Main/Base/Gui/Components/StatusBar%20src/Main/Base/Services/StatusBar&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000760.html">
   <LINK REL="Next"  HREF="000762.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1155 - in trunk/MonoDevelop: . build/data/templates/project/CSharp src/AddIns/DisplayBindings/SourceEditor src/AddIns/DisplayBindings/SourceEditor/CodeCompletion src/AddIns/DisplayBindings/SourceEditor/Codons src/AddIns/DisplayBindings/SourceEditor/Commands src/AddIns/DisplayBindings/SourceEditor/Gui src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels src/Main/Base/Gui/Components/StatusBar src/Main/Base/Services/StatusBar</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1155%20-%20in%20trunk/MonoDevelop%3A%20.%20build/data/templates/project/CSharp%20src/AddIns/DisplayBindings/SourceEditor%20src/AddIns/DisplayBindings/SourceEditor/CodeCompletion%20src/AddIns/DisplayBindings/SourceEditor/Codons%20src/AddIns/DisplayBindings/SourceEditor/Commands%20src/AddIns/DisplayBindings/SourceEditor/Gui%20src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs%20src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels%20src/Main/Base/Gui/Components/StatusBar%20src/Main/Base/Services/StatusBar&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1155 - in trunk/MonoDevelop: . build/data/templates/project/CSharp src/AddIns/DisplayBindings/SourceEditor src/AddIns/DisplayBindings/SourceEditor/CodeCompletion src/AddIns/DisplayBindings/SourceEditor/Codons src/AddIns/DisplayBindings/SourceEditor/Commands src/AddIns/DisplayBindings/SourceEditor/Gui src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels src/Main/Base/Gui/Components/StatusBar src/Main/Base/Services/StatusBar">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Thu Mar 11 19:15:29 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000760.html">[Monodevelop-patches-list] r1154 - trunk/MonoDevelop/src/Libraries/CsVbRefactory
</A></li>
        <LI>Next message: <A HREF="000762.html">[Monodevelop-patches-list] r1156 - trunk/MonoDevelop/build/data/templates/file/CSharp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#761">[ date ]</a>
              <a href="thread.html#761">[ thread ]</a>
              <a href="subject.html#761">[ subject ]</a>
              <a href="author.html#761">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jluke
Date: 2004-03-11 19:15:29 -0500 (Thu, 11 Mar 2004)
New Revision: 1155

Added:
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/EditTemplateGroupDialog.cs
Removed:
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/EditTemplateGroupDialog.cs
Modified:
   trunk/MonoDevelop/ChangeLog
   trunk/MonoDevelop/build/data/templates/project/CSharp/Makefile.am
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionData.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionDataProvider.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CommentCompletionDataProvider.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/DeclarationViewWindow.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TemplateCompletionDataProvider.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TextUtilities.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Codons/EditActionCodon.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/BookmarkCommands.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CodeActions.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CommentRegionCommand.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/FoldingCommands.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/IEditAction.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ProjectCommands.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/SearchCommands.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/TextAreaContextmenuCommands.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ToolCommands.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Makefile.am
   trunk/MonoDevelop/src/Main/Base/Gui/Components/StatusBar/SdStatusBar.cs
   trunk/MonoDevelop/src/Main/Base/Services/StatusBar/DefaultStatusBarService.cs
   trunk/MonoDevelop/src/Main/Base/Services/StatusBar/IStatusBarService.cs
Log:
code formatting changes while reading through the SourceEditor
simplify the StatusBar Cursor position to work off of 3 ints

partially port ExportProjectToHtml and fix the Makefile.am
to have the right files in the Dialog subdir

and maybe something else I forgot



Modified: trunk/MonoDevelop/ChangeLog
===================================================================
--- trunk/MonoDevelop/ChangeLog	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/ChangeLog	2004-03-12 00:15:29 UTC (rev 1155)
@@ -1,3 +1,22 @@
+2004-03-11  John Luke  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jluke at cfl.rr.com</A>&gt;
+
+	* src/AddIns/DisplayBindings/SourceEditor/:
+	CompletionWindow: subclass properly and
+	remove KeyRelease for CompletionWindow
+
+	partially port ExportToProjectHtml and add it to Makefile.am
+
+	mv EditTemplateGroupDialog to Dialogs subdir
+	and update Makefile.am
+
+	* src/Main/Base/Services/StatusBar:
+	make statusbar accept 3 ints
+	do the work in the service
+
+	* src/Libraries/CsVbParser:
+	import CsVbParser from SD, in hopes of fixing our
+	horribly broken one
+
 2004-03-10  John Luke  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jluke at cfl.rr.com</A>&gt;
 
 	* README: add monodoc and debugger to list of deps

Modified: trunk/MonoDevelop/build/data/templates/project/CSharp/Makefile.am
===================================================================
--- trunk/MonoDevelop/build/data/templates/project/CSharp/Makefile.am	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/build/data/templates/project/CSharp/Makefile.am	2004-03-12 00:15:29 UTC (rev 1155)
@@ -2,7 +2,8 @@
 monodevelopdir = $(prefix)/lib/monodevelop
 cstemplatedir = $(monodevelopdir)/data/templates/project/CSharp
 
-cstemplate_DATA = ConsoleProject.xpt \
+cstemplate_DATA = AspNetProject.xpt \
+	ConsoleProject.xpt \
 	GnomeSharpProject.xpt \
 	Library.xpt \
 	EmptyProject.xpt \
@@ -14,3 +15,4 @@
 	
 
 EXTRA_DIST = $(cstemplate_DATA)
+

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionData.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionData.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionData.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -14,26 +14,28 @@
 using SharpDevelop.Internal.Parser;
 using MonoDevelop.Services;
 using MonoDevelop.Core.Services;
-
 using MonoDevelop.SourceEditor.Gui;
 
-namespace MonoDevelop.SourceEditor.CodeCompletion {
-	class CodeCompletionData : ICompletionDataWithMarkup {
-		static ClassBrowserIconsService classBrowserIconService = (ClassBrowserIconsService)ServiceManager.Services.GetService(typeof(ClassBrowserIconsService));
-		static IParserService           parserService           = (IParserService)MonoDevelop.Core.Services.ServiceManager.Services.GetService(typeof(IParserService));
-		static AmbienceService          ambienceService = (AmbienceService)ServiceManager.Services.GetService(typeof(AmbienceService));
+namespace MonoDevelop.SourceEditor.CodeCompletion
+{
+	class CodeCompletionData : ICompletionDataWithMarkup
+	{
+		ClassBrowserIconsService classBrowserIconService = (ClassBrowserIconsService) ServiceManager.Services.GetService (typeof (ClassBrowserIconsService));
+		IParserService parserService = (IParserService) MonoDevelop.Core.Services.ServiceManager.Services.GetService (typeof (IParserService));
+		static AmbienceService ambienceService = (AmbienceService) ServiceManager.Services.GetService (typeof (AmbienceService));
 		
-		string   image;
-		int      overloads;
-		string   text;
-		string   description;
-		string   pango_description;
-		string   documentation;
-		string   completionString;
-		IClass   c;
-		bool     convertedDocumentation = false;
+		string image;
+		int overloads;
+		string text;
+		string description;
+		string pango_description;
+		string documentation;
+		string completionString;
+		IClass c;
+		bool convertedDocumentation = false;
 		
-		static IAmbience PangoAmbience {
+		static IAmbience PangoAmbience
+		{
 			get {
 				IAmbience asvc = ambienceService.CurrentAmbience;
 				asvc.ConversionFlags |= ConversionFlags.IncludePangoMarkup;
@@ -41,7 +43,8 @@
 			}
 		}
 		
-		public int Overloads {
+		public int Overloads
+		{
 			get {
 				return overloads;
 			}
@@ -50,7 +53,8 @@
 			}
 		}
 		
-		public string Image {
+		public string Image
+		{
 			get {
 				return image;
 			}
@@ -59,7 +63,8 @@
 			}
 		}
 		
-		public string[] Text {
+		public string[] Text
+		{
 			get {
 				return new string[] { text };
 			}
@@ -67,7 +72,9 @@
 				text = value[0];
 			}
 		}
-		public string Description {
+		
+		public string Description
+		{
 			get {
 				// get correct delegate description (when description is requested)
 				// in the classproxies aren't methods saved, therefore delegate methods
@@ -105,7 +112,8 @@
 			}
 		}
 		
-		public string DescriptionPango {
+		public string DescriptionPango
+		{
 			get {
 				// get correct delegate description (when description is requested)
 				// in the classproxies aren't methods saved, therefore delegate methods
@@ -143,7 +151,7 @@
 			}
 		}
 		
-		public CodeCompletionData(string s, string image)
+		public CodeCompletionData (string s, string image)
 		{
 			description = pango_description = documentation = String.Empty;
 			text = s;
@@ -151,7 +159,7 @@
 			this.image = image;
 		}
 		
-		public CodeCompletionData(IClass c)
+		public CodeCompletionData (IClass c)
 		{
 			// save class (for the delegate description shortcut
 			this.c = c;
@@ -163,7 +171,7 @@
 			documentation = c.Documentation;
 		}
 		
-		public CodeCompletionData(IMethod method)
+		public CodeCompletionData (IMethod method)
 		{
 			image  = classBrowserIconService.GetIcon(method);
 			text        = method.Name;
@@ -173,7 +181,7 @@
 			documentation = method.Documentation;
 		}
 		
-		public CodeCompletionData(IField field)
+		public CodeCompletionData (IField field)
 		{
 			image  = classBrowserIconService.GetIcon(field);
 			text        = field.Name;
@@ -183,7 +191,7 @@
 			documentation = field.Documentation;
 		}
 		
-		public CodeCompletionData(IProperty property)
+		public CodeCompletionData (IProperty property)
 		{
 			image  = classBrowserIconService.GetIcon(property);
 			text        = property.Name;
@@ -193,7 +201,7 @@
 			documentation = property.Documentation;
 		}
 		
-		public CodeCompletionData(IEvent e)
+		public CodeCompletionData (IEvent e)
 		{
 			image  = classBrowserIconService.GetIcon(e);
 			text        = e.Name;
@@ -203,12 +211,12 @@
 			documentation = e.Documentation;
 		}
 		
-		public void InsertAction(SourceEditorView control)
+		public void InsertAction (SourceEditorView control)
 		{
 			control.Buffer.InsertAtCursor (completionString);
 		}
 
-		public static string GetDocumentation(string doc)
+		public static string GetDocumentation (string doc)
 		{
 			System.IO.StringReader reader = new System.IO.StringReader(&quot;&lt;docroot&gt;&quot; + doc + &quot;&lt;/docroot&gt;&quot;);
 			XmlTextReader xml   = new XmlTextReader(reader);
@@ -247,18 +255,24 @@
 					} else if (xml.NodeType == XmlNodeType.Text) {
 						ret.Append(whitespace.Replace(xml.Value, &quot; &quot;));
 					}
-				} while(xml.Read());
+				} while (xml.Read ());
 			} catch {
 				return doc;
 			}
-			return ret.ToString();
+			return ret.ToString ();
 		}
 		
-		static string GetCref(string cref)
+		static string GetCref (string cref)
 		{
-			if (cref == null) return &quot;&quot;;
-			if (cref.Length &lt; 2) return cref;
-			if (cref.Substring(1, 1) == &quot;:&quot;) return cref.Substring(2, cref.Length - 2);
+			if (cref == null)
+				return &quot;&quot;;
+			
+			if (cref.Length &lt; 2)
+				return cref;
+			
+			if (cref.Substring(1, 1) == &quot;:&quot;)
+				return cref.Substring (2, cref.Length - 2);
+			
 			return cref;
 		}
 	

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionDataProvider.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionDataProvider.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CodeCompletionDataProvider.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -46,8 +46,8 @@
 		{
 			//FIXME: THIS IS A HACK
 			string lang = &quot;C#&quot;;
-			Console.WriteLine (&quot;resolve &quot; + lang);
-			Console.WriteLine (&quot;nm &quot; + fileName);
+			//Console.WriteLine (&quot;resolve &quot; + lang);
+			//Console.WriteLine (&quot;nm &quot; + fileName);
 			completionData = new ArrayList();
 			this.fileName = fileName;
 		
@@ -63,6 +63,7 @@
 			if (expression.Length == 0) {
 				return null;
 			}
+			
 			IParserService           parserService           = (IParserService)MonoDevelop.Core.Services.ServiceManager.Services.GetService(typeof(IParserService));
 			if (charTyped == ' ') {
 				if (expression == &quot;using&quot; || expression.EndsWith(&quot; using&quot;) || expression.EndsWith(&quot;\tusing&quot;)|| expression.EndsWith(&quot;\nusing&quot;)|| expression.EndsWith(&quot;\rusing&quot;)) {
@@ -89,7 +90,7 @@
 			} else {
 				//FIXME: I added the null check, #D doesnt need it, why do we?
 				if (fileName != null) {
-					Console.WriteLine (&quot;resolve &quot; + lang);
+					//Console.WriteLine (&quot;resolve &quot; + lang);
 					results = parserService.Resolve(expression, 
 				                                caretLineNumber,
 				                                caretColumn,
@@ -100,10 +101,10 @@
 				}
 			}
 			
-			return (ICompletionData[])completionData.ToArray(typeof(ICompletionData));
+			return (ICompletionData[]) completionData.ToArray (typeof (ICompletionData));
 		}
 		
-		void AddResolveResults(ResolveResult results)
+		void AddResolveResults (ResolveResult results)
 		{
 			if (results != null) {
 				completionData.Capacity += results.Namespaces.Count +
@@ -111,31 +112,31 @@
 				
 				if (results.Namespaces != null &amp;&amp; results.Namespaces.Count &gt; 0) {
 					foreach (string s in results.Namespaces) {
-						completionData.Add(new CodeCompletionData(s, Stock.NameSpace));
+						completionData.Add (new CodeCompletionData (s, Stock.NameSpace));
 					}
 				}
 				if (results.Members != null &amp;&amp; results.Members.Count &gt; 0) {
 					foreach (object o in results.Members) {
 						if (o is IClass) {
-							completionData.Add(new CodeCompletionData((IClass)o));
+							completionData.Add (new CodeCompletionData ((IClass)o));
 						} else if (o is IProperty) {
-							IProperty property = (IProperty)o;
+							IProperty property = (IProperty) o;
 							if (property.Name != null &amp;&amp; insertedPropertiesElements[property.Name] == null) {
-								completionData.Add(new CodeCompletionData(property));
+								completionData.Add (new CodeCompletionData (property));
 								insertedPropertiesElements[property.Name] = property;
 							}
 						} else if (o is IMethod) {
-							IMethod method = (IMethod)o;
+							IMethod method = (IMethod) o;
 							if (method.Name != null &amp;&amp; insertedElements[method.Name] == null &amp;&amp; !method.IsConstructor) {
-								completionData.Add(new CodeCompletionData(method));
+								completionData.Add (new CodeCompletionData(method));
 								insertedElements[method.Name] = method;
 							}
 						} else if (o is IField) {
-							completionData.Add(new CodeCompletionData((IField)o));
+							completionData.Add (new CodeCompletionData ((IField)o));
 						} else if (o is IEvent) {
-							IEvent e = (IEvent)o;
+							IEvent e = (IEvent) o;
 							if (e.Name != null &amp;&amp; insertedEventElements[e.Name] == null) {
-								completionData.Add(new CodeCompletionData(e));
+								completionData.Add (new CodeCompletionData (e));
 								insertedEventElements[e.Name] = e;
 							}
 						}

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CommentCompletionDataProvider.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CommentCompletionDataProvider.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CommentCompletionDataProvider.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -20,11 +20,13 @@
 using MonoDevelop.SourceEditor.Gui;
 using Stock = MonoDevelop.Gui.Stock;
 
-namespace MonoDevelop.SourceEditor.CodeCompletion {
+namespace MonoDevelop.SourceEditor.CodeCompletion
+{
 	/// &lt;summary&gt;
 	/// Data provider for code completion.
 	/// &lt;/summary&gt;
-	public class CommentCompletionDataProvider : ICompletionDataProvider {
+	public class CommentCompletionDataProvider : ICompletionDataProvider
+	{
 		static ClassBrowserIconsService classBrowserIconService = (ClassBrowserIconsService)ServiceManager.Services.GetService(typeof(ClassBrowserIconsService));
 		static IParserService           parserService           = (IParserService)MonoDevelop.Core.Services.ServiceManager.Services.GetService(typeof(IParserService));
 		
@@ -56,12 +58,12 @@
 		/// &lt;remarks&gt;
 		/// Returns true, if the given coordinates (row, column) are in the region.
 		/// &lt;/remarks&gt;
-		bool IsBetween(int row, int column, IRegion region)
+		bool IsBetween (int row, int column, IRegion region)
 		{
 			return row &gt;= region.BeginLine &amp;&amp; (row &lt;= region.EndLine || region.EndLine == -1);
 		}
 		
-		public ICompletionData[] GenerateCompletionData(string fileName, SourceEditorView textArea, char charTyped)
+		public ICompletionData[] GenerateCompletionData (string fileName, SourceEditorView textArea, char charTyped)
 		{
 			/*caretLineNumber = textArea.Caret.Line;
 			caretColumn     = textArea.Caret.Column;
@@ -71,11 +73,11 @@
 				return null;
 			}
 			*/
-			ArrayList completionData = new ArrayList();
+			ArrayList completionData = new ArrayList ();
 			/*foreach (string[] tag in commentTags) {
 				completionData.Add(new CommentCompletionData(tag[0], tag[1]));
 			}*/
-			return (ICompletionData[])completionData.ToArray(typeof(ICompletionData));
+			return (ICompletionData[])completionData.ToArray (typeof (ICompletionData));
 		}
 		
 		class CommentCompletionData : ICompletionData
@@ -83,32 +85,35 @@
 			string text;
 			string description;
 			
-			public string Image {
+			public string Image
+			{
 				get {
 					return Stock.Method;
 				}
 			}
 			
-			public string[] Text {
+			public string[] Text
+			{
 				get {
 					return new string[] { text };
 				}
 			}
 			
-			public string Description {
+			public string Description
+			{
 				get {
 					return description;
 				}
 			}
 			
-			public void InsertAction(SourceEditorView control)
+			public void InsertAction (SourceEditorView control)
 			{
 				//((SharpDevelopTextAreaControl)control).ActiveTextAreaControl.TextArea.InsertString(text);
 			}
 			
-			public CommentCompletionData(string text, string description) 
+			public CommentCompletionData (string text, string description) 
 			{
-				this.text        = text;
+				this.text = text;
 				this.description = description;
 			}
 		}

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -7,12 +7,9 @@
 
 using System;
 using System.Drawing;
-using System.Reflection;
 using System.Collections;
 
 using Gtk;
-using GtkSharp;
-
 using MonoDevelop.SourceEditor.Gui;
 
 namespace MonoDevelop.SourceEditor.CodeCompletion
@@ -20,24 +17,23 @@
 	public class CompletionWindow : Window
 	{
 		const  int  DeclarationIndent  = 1;
-		static GLib.GType type;
-		Gtk.TreeViewColumn complete_column;
+		private static GLib.GType gtype;
+		TreeViewColumn complete_column;
 		
 		ICompletionDataProvider completionDataProvider;
-		SourceEditorView        control;
-		Gtk.TreeView            listView;
-		Gtk.TreeStore		store;
-		DeclarationViewWindow   declarationviewwindow = new DeclarationViewWindow();
-		Gdk.Pixbuf[]		imgList;		
-		int    insertLength = 0;
+		SourceEditorView control;
+		TreeView listView;
+		TreeStore store;
+		DeclarationViewWindow declarationviewwindow = new DeclarationViewWindow ();		
+		int insertLength = 0;
 		
-		string GetTypedString()
+		string GetTypedString ()
 		{
 			TextIter startIter = control.Buffer.GetIterAtMark (control.Buffer.InsertMark);
 			TextIter offsetIter = control.Buffer.GetIterAtOffset (startIter.Offset - insertLength);
 			return control.Buffer.GetText (offsetIter, startIter, true);
 		}
-		
+  
 		void DeleteInsertion()
 		{
 			if (insertLength &gt; 0) {
@@ -48,23 +44,6 @@
 				control.Buffer.MoveMark (control.Buffer.InsertMark, control.Buffer.GetIterAtOffset (newPos));
 			}
 		}
-		
-		// Lame fix. The backspace press event is not being caught. The release event yes, though
-		// ???
-		void ListKeyreleaseEvent(object sender, KeyReleaseEventArgs ex) {
-			if (ex.Event.Key == Gdk.Key.BackSpace) {
-				//Console.WriteLine(&quot;Got BackSpace on key release&quot;);
-				TextIter insertIter = control.Buffer.GetIterAtMark (control.Buffer.InsertMark);
-				TextIter oneCharBackIter = control.Buffer.GetIterAtOffset (insertIter.Offset == 0 ? insertIter.Offset : insertIter.Offset- 1);
-				control.Buffer.Delete (insertIter, oneCharBackIter);
-				if (insertLength &gt; 0) {
-					--insertLength;
-				} else {
-					// no need to delete here (insertLength &lt;= 0)
-					LostFocusListView(null, null);
-				}
-			}
-		}
 
 		protected override bool OnKeyPressEvent (Gdk.EventKey e)
 		{
@@ -81,7 +60,7 @@
 			return base.OnKeyPressEvent (e);
 		}
 		
-		void ListKeypressEvent(object sender, KeyPressEventArgs ex)
+		void ListKeypressEvent (object sender, KeyPressEventArgs ex)
 		{
 			Gdk.Key key = ex.Event.Key;
 			char val = (char) key;
@@ -95,16 +74,16 @@
 					return;
 					
 				case Gdk.Key.Escape:
-					LostFocusListView(null, null);
+					LostFocusListView (null, null);
 					ex.RetVal = true;
 					return;
 					
 				default:
-					if (val != '_' &amp;&amp; !Char.IsLetterOrDigit(val)) {
-						if (listView.Selection.CountSelectedRows() &gt; 0) {
-							ActivateItem(null, null);
+					if (val != '_' &amp;&amp; !Char.IsLetterOrDigit (val)) {
+						if (listView.Selection.CountSelectedRows () &gt; 0) {
+							ActivateItem (null, null);
 						} else {
-							LostFocusListView(null, null);
+							LostFocusListView (null, null);
 						}
 						
 						//control.Buffer.InsertAtCursor (val.ToString ());
@@ -121,13 +100,13 @@
 			int lastSelected = -1;
 			int capitalizationIndex = -1;
 			
-			string typedString = GetTypedString();
+			string typedString = GetTypedString ();
 			TreeIter iter;
 			int i = 0;
-			for (store.GetIterFirst(out iter); store.IterNext(out iter) == true; i++) {
-				string text = (string)store.GetValue(iter, 0);
+			for (store.GetIterFirst (out iter); store.IterNext (out iter) == true; i++) {
+				string text = (string) store.GetValue (iter, 0);
 				
-				if (text.ToUpper().StartsWith(typedString.ToUpper())) {
+				if (text.ToUpper ().StartsWith (typedString.ToUpper ())) {
 					int currentCapitalizationIndex = 0;
 					for (int j = 0; j &lt; typedString.Length &amp;&amp; j &lt; text.Length; ++j) {
 						if (typedString[j] == text[j]) {
@@ -142,18 +121,18 @@
 				}
 			}
 			
-			listView.Selection.UnselectAll();
+			listView.Selection.UnselectAll ();
 			if (lastSelected != -1) {
-				TreePath path = new TreePath(&quot;&quot; + (lastSelected + 1));
-				listView.Selection.SelectPath(path);
+				TreePath path = new TreePath (&quot;&quot; + (lastSelected + 1));
+				listView.Selection.SelectPath (path);
 				listView.SetCursor (path, complete_column, false);
-				listView.ScrollToCell(path, null, false, 0, 0);
+				listView.ScrollToCell (path, null, false, 0, 0);
 			}
 			
 			ex.RetVal =  true;
 		}
 		
-		void InitializeControls()
+		void InitializeControls ()
 		{
 			Decorated = false;
 			SkipPagerHint = true;
@@ -162,10 +141,9 @@
 			
 			store = new Gtk.TreeStore (typeof (string), typeof (string), typeof(ICompletionData));
 			listView = new Gtk.TreeView (store);
-
 			listView.HeadersVisible = false;
 
-			complete_column = new Gtk.TreeViewColumn ();
+			complete_column = new TreeViewColumn ();
 			complete_column.Title = &quot;completion&quot;;
 
 			Gtk.CellRendererPixbuf pix_render = new Gtk.CellRendererPixbuf ();
@@ -185,25 +163,25 @@
 
 			Gtk.Frame frame = new Gtk.Frame ();
 			frame.Add (scroller);
-			this.Add(frame);
+			this.Add (frame);
 			
-			listView.KeyPressEvent += new KeyPressEventHandler(ListKeypressEvent);
-			listView.KeyReleaseEvent += new KeyReleaseEventHandler(ListKeyreleaseEvent);
-			listView.FocusOutEvent += new FocusOutEventHandler(LostFocusListView);
-			listView.RowActivated += new RowActivatedHandler(ActivateItem);
+			listView.KeyPressEvent += new KeyPressEventHandler (ListKeypressEvent);
+			//listView.KeyReleaseEvent += new KeyReleaseEventHandler(ListKeyreleaseEvent);
+			listView.FocusOutEvent += new FocusOutEventHandler (LostFocusListView);
+			listView.RowActivated += new RowActivatedHandler (ActivateItem);
 			listView.AddEvents ((int) (Gdk.EventMask.KeyPressMask));
 		}
 	
 		/// &lt;remarks&gt;
 		/// Shows the filled completion window, if it has no items it isn't shown.
 		/// &lt;/remarks&gt;
-		public void ShowCompletionWindow(char firstChar)
+		public void ShowCompletionWindow (char firstChar)
 		{
-			FillList(true, firstChar);
+			FillList (true, firstChar);
 
 			TreeIter iter;
-			if (store.GetIterFirst(out iter) == false) {
-				control.GrabFocus();
+			if (store.GetIterFirst (out iter) == false) {
+				control.GrabFocus ();
 				return;
 			}
 
@@ -217,65 +195,71 @@
 			control.BufferToWindowCoords (Gtk.TextWindowType.Widget, rect.X + rect.Width, rect.Y + rect.Height, out wx, out wy);
 			
 			int tx, ty;
-			control.GdkWindow.GetOrigin(out tx, out ty);
-			Move(tx + wx, ty + wy);
+			control.GdkWindow.GetOrigin (out tx, out ty);
+			Move (tx + wx, ty + wy);
 			listView.Selection.Changed += new EventHandler (RowActivated);
 			ShowAll ();
 		}
+		
 		string fileName;
 		
-		static CompletionWindow ()
+		public static new GLib.GType GType
 		{
-			type = RegisterGType (typeof (CompletionWindow));
+			get
+			{
+				if (gtype == GLib.GType.Invalid)
+					gtype = RegisterGType (typeof (CompletionWindow));
+				return gtype;
+			}
 		}
 		
 		/// &lt;remarks&gt;
 		/// Creates a new Completion window and puts it location under the caret
 		/// &lt;/remarks&gt;
-		public CompletionWindow (SourceEditorView control, string fileName, ICompletionDataProvider completionDataProvider) : base (type)
+		public CompletionWindow (SourceEditorView control, string fileName, ICompletionDataProvider completionDataProvider) : base (GType)
 		{
 			this.fileName = fileName;
 			this.completionDataProvider = completionDataProvider;
-			this.control                = control;
+			this.control = control;
 
-			InitializeControls();
+			InitializeControls ();
 		}
 		
 		/// &lt;remarks&gt;
 		/// Creates a new Completion window at a given location
 		/// &lt;/remarks&gt;
-		CompletionWindow (SourceEditorView control, Point location, ICompletionDataProvider completionDataProvider) : base (type)
+		CompletionWindow (SourceEditorView control, Point location, ICompletionDataProvider completionDataProvider) : base (GType)
 		{
 			this.completionDataProvider = completionDataProvider;
-			this.control                = control;
+			this.control = control;
 
-			InitializeControls();
+			InitializeControls ();
 		}
 		
-		void ActivateItem(object sender, RowActivatedArgs e)
+		void ActivateItem (object sender, RowActivatedArgs e)
 		{
-			if (listView.Selection.CountSelectedRows() &gt; 0) {
+			if (listView.Selection.CountSelectedRows () &gt; 0) {
 				TreeModel foo;
 				TreeIter iter;
-				listView.Selection.GetSelected(out foo, out iter);
-				ICompletionData data = (ICompletionData) store.GetValue(iter, 2);
-				DeleteInsertion();
-				data.InsertAction(control);
-				LostFocusListView(null, null);
+				listView.Selection.GetSelected (out foo, out iter);
+				ICompletionData data = (ICompletionData) store.GetValue (iter, 2);
+				DeleteInsertion ();
+				data.InsertAction (control);
+				LostFocusListView (null, null);
 			}
 		}
 		
-		void LostFocusListView(object sender, FocusOutEventArgs e)
+		void LostFocusListView (object sender, FocusOutEventArgs e)
 		{
 			control.HasFocus = true;
 			declarationviewwindow.HideAll ();
-			Hide();
+			this.Hide ();
 		}
 		
-		void FillList(bool firstTime, char ch)
+		void FillList (bool firstTime, char ch)
 		{
 			ICompletionData[] completionData = completionDataProvider.GenerateCompletionData(fileName, control, ch);
-			Console.WriteLine (&quot;testing&quot;);
+			//Console.WriteLine (&quot;testing&quot;);
 			if (completionData == null || completionData.Length == 0) {
 				return;
 			}
@@ -287,7 +271,7 @@
 			store.SetSortColumnId (0, SortType.Ascending);
 		}
 		
-		void RowActivated  (object sender, EventArgs a)
+		void RowActivated (object sender, EventArgs a)
 		{
 			Gtk.TreeIter iter;
 			Gtk.TreeModel model;
@@ -296,13 +280,14 @@
 				ICompletionData data = (ICompletionData) store.GetValue (iter, 2);
 				if (data == null)
 					return;
-				//This code is for sizing the treeview properly.
+				// This code is for sizing the treeview properly.
 				Gtk.TreePath path = store.GetPath (iter);
 				Gdk.Rectangle backRect = listView.GetBackgroundArea (path, (Gtk.TreeViewColumn)listView.Columns[0]);
 
 				listView.HeightRequest = (backRect.Height * 5) + 2;
 				
-				//FIXME: This code is buggy, and generates a bad placement sometimes when you jump a lot. but it is better than 0,0
+				// FIXME: This code is buggy, and generates a bad placement sometimes when you jump a lot.
+				// but it is better than 0,0
 				
 				Gdk.Rectangle rect = listView.GetCellArea (path, (Gtk.TreeViewColumn)listView.Columns[0]);
 
@@ -316,10 +301,12 @@
 					vert = listpos_y;
 				}
 
-				//FIXME: This is a bad calc, its always on the right, it needs to test if thats too big, and if so, place on the left;
+				// FIXME: This is a bad calc, its always on the right,
+				// it needs to test if thats too big, and if so, place on the left;
 				int horiz = listpos_x + listView.GdkWindow.Size.Width + 30;
 				ICompletionDataWithMarkup wMarkup = data as ICompletionDataWithMarkup;
 				declarationviewwindow.Destroy ();
+				
 				if (wMarkup != null) {
 					declarationviewwindow = new DeclarationViewWindow ();
 					declarationviewwindow.DescriptionMarkup = wMarkup.DescriptionPango;
@@ -332,9 +319,11 @@
 					return;
 			
 				declarationviewwindow.ShowAll ();
+				
 				if (listView.Screen.Width &lt;= horiz + declarationviewwindow.GdkWindow.FrameExtents.Width) {
 					horiz = listpos_x - declarationviewwindow.GdkWindow.FrameExtents.Width - 10;
 				}
+				
 				declarationviewwindow.Move (horiz, vert);
 			}
 		}

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/DeclarationViewWindow.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/DeclarationViewWindow.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/DeclarationViewWindow.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -11,15 +11,15 @@
 using System.Collections;
 
 using Gtk;
-using GtkSharp;
 
 namespace MonoDevelop.SourceEditor.CodeCompletion
 {
-	public class DeclarationViewWindow : Gtk.Window
+	public class DeclarationViewWindow : Window
 	{
 		Label label;
 		
-		public string DescriptionMarkup {
+		public string DescriptionMarkup
+		{
 			get {
 				return label.Text;
 			}
@@ -32,9 +32,9 @@
 		
 		public DeclarationViewWindow () : base (WindowType.Popup)
 		{
-			Gtk.Frame frame = new Gtk.Frame ();
+			Frame frame = new Frame ();
 			frame.Add (label = new Label (&quot;&quot;));
-			Add (frame);
+			this.Add (frame);
 		}
 	}
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TemplateCompletionDataProvider.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TemplateCompletionDataProvider.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TemplateCompletionDataProvider.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -12,13 +12,15 @@
 
 using MonoDevelop.Core.Properties;
 using MonoDevelop.Internal.Templates;
-
 using MonoDevelop.SourceEditor.Gui;
 using Stock = MonoDevelop.Gui.Stock;
 
-namespace MonoDevelop.SourceEditor.CodeCompletion {
-	public class TemplateCompletionDataProvider : ICompletionDataProvider {
-		public Gdk.Pixbuf[] ImageList {
+namespace MonoDevelop.SourceEditor.CodeCompletion
+{
+	public class TemplateCompletionDataProvider : ICompletionDataProvider
+	{
+		public Gdk.Pixbuf[] ImageList
+		{
 			get {
 				return null;
 			}
@@ -42,19 +44,22 @@
 		{
 			CodeTemplate template;
 			
-			public string Image {
+			public string Image
+			{
 				get {
 					return Stock.Method;
 				}
 			}
 			
-			public string[] Text {
+			public string[] Text
+			{
 				get {
 					return new string[] { template.Shortcut, template.Description };
 				}
 			}
 			
-			public string Description {
+			public string Description
+			{
 				get {
 					return template.Text;
 				}

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TextUtilities.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TextUtilities.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/TextUtilities.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -62,7 +62,8 @@
 			return true;
 		}
 		
-		public enum CharacterType {
+		public enum CharacterType
+		{
 			LetterDigitOrUnderscore,
 			WhiteSpace,
 			Other
@@ -75,7 +76,7 @@
 		/// &lt;/remarks&gt;
 		public static string GetExpressionBeforeOffset(SourceEditorView textArea, int offset)
 		{
-			// HACK HACK we should actually use GtkTextIter's
+			// FIXME: we should actually use GtkTextIter's
 			string text = textArea.Buffer.Text;
 			
 			while (offset - 1 &gt; 0) {
@@ -244,7 +245,7 @@
 */
 		static bool ScanLineComment(SourceEditorView document, int offset)
 		{
-			// HACK HACK: use iters
+			// FIXME: use iters
 			string text = document.Buffer.Text;
 			while (offset &gt; 0 &amp;&amp; offset &lt; document.Buffer.Text.Length) {
 				char ch = text [offset];
@@ -265,14 +266,11 @@
 		
 		public static int SearchBracketBackward(SourceEditorView document, int offset, char openBracket, char closingBracket)
 		{
-			// HACK HACK: use iters
-			string text = document.Buffer.Text;
-			
-			int brackets = -1;
-			
+			// FIXME: use iters
+			string text = document.Buffer.Text;			
+			int brackets = -1;		
 			bool inString = false;
-			bool inChar   = false;
-			
+			bool inChar   = false;			
 			bool blockComment = false;
 			
 			while (offset &gt;= 0 &amp;&amp; offset &lt; document.Buffer.Text.Length) {

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Codons/EditActionCodon.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Codons/EditActionCodon.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Codons/EditActionCodon.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -37,18 +37,18 @@
 		/// Creates an item with the specified sub items. And the current
 		/// Condition status for this item.
 		/// &lt;/summary&gt;
-		public override object BuildItem(object owner, ArrayList subItems, ConditionCollection conditions)
+		public override object BuildItem (object owner, ArrayList subItems, ConditionCollection conditions)
 		{
 			//FIXME: This code is *not* fully ported yet
 			if (subItems.Count &gt; 0) {
-				throw new ApplicationException(&quot;more than one level of edit actions don't make sense!&quot;);
+				throw new ApplicationException (&quot;more than one level of edit actions don't make sense!&quot;);
 			}
 			
-			IEditAction editAction = (IEditAction)AddIn.CreateObject(Class);
+			IEditAction editAction = (IEditAction) AddIn.CreateObject (Class);
 							
 			Gdk.Key[] actionKeys = new Gdk.Key[keys.Length];
 			for (int j = 0; j &lt; keys.Length; ++j) {
-				string[] keydescr = keys[j].Split(new char[] { '|' });
+				string[] keydescr = keys[j].Split (new char[] { '|' });
 				//Keys key = (Keys)((System.Windows.Forms.Keys.Space.GetType()).InvokeMember(keydescr[0], BindingFlags.GetField, null, System.Windows.Forms.Keys.Space, new object[0]));
 				//Console.Write (keydescr[0] + &quot; -- &quot;);
 				for (int k = 1; k &lt; keydescr.Length; ++k) {
@@ -56,13 +56,11 @@
 					//Console.Write (keydescr[k] + &quot; -- &quot;);
 				}
 				//actionKeys[j] = key;
-				//Console.WriteLine (&quot;&quot;);
 			}
+			
 			editAction.Keys = actionKeys;
 			
 			return editAction;
-		
 		}
-		
 	}
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/BookmarkCommands.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/BookmarkCommands.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/BookmarkCommands.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -6,8 +6,10 @@
 using MonoDevelop.Gui;
 using MonoDevelop.Core.AddIns.Codons;
 
-namespace MonoDevelop.EditorBindings.Commands {
-	public class ToggleBookmark : AbstractMenuCommand {
+namespace MonoDevelop.EditorBindings.Commands
+{
+	public class ToggleBookmark : AbstractMenuCommand
+	{
 		public override void Run ()
 		{
 			IWorkbenchWindow window = WorkbenchSingleton.Workbench.ActiveWorkbenchWindow;
@@ -22,7 +24,8 @@
 		}
 	}
 	
-	public class PrevBookmark : AbstractMenuCommand	{
+	public class PrevBookmark : AbstractMenuCommand
+	{
 		public override void Run ()
 		{
 			IWorkbenchWindow window = WorkbenchSingleton.Workbench.ActiveWorkbenchWindow;
@@ -37,7 +40,8 @@
 		}
 	}
 		
-	public class NextBookmark : AbstractMenuCommand	{
+	public class NextBookmark : AbstractMenuCommand
+	{
 		public override void Run ()
 		{
 			IWorkbenchWindow window = WorkbenchSingleton.Workbench.ActiveWorkbenchWindow;
@@ -52,7 +56,8 @@
 		}
 	}
 		
-	public class ClearBookmarks : AbstractMenuCommand {
+	public class ClearBookmarks : AbstractMenuCommand
+	{
 		public override void Run ()
 		{
 			IWorkbenchWindow window = WorkbenchSingleton.Workbench.ActiveWorkbenchWindow;

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CodeActions.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CodeActions.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CodeActions.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -19,9 +19,7 @@
 using MonoDevelop.Gui;
 using MonoDevelop.TextEditor.Actions;
 using MonoDevelop.TextEditor;
-using SharpDevelop.Internal.Parser;
 using MonoDevelop.Services;
-
 using MonoDevelop.EditorBindings.FormattingStrategy;
 using MonoDevelop.SourceEditor.Gui;
 

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CommentRegionCommand.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CommentRegionCommand.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/CommentRegionCommand.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -22,7 +22,7 @@
 {
 	public class CommentRegion : AbstractMenuCommand
 	{ 
-		public override void Run()
+		public override void Run ()
 		{
 			Console.WriteLine (&quot;Not ported to the new editor yet&quot;);
 			/*

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/FoldingCommands.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/FoldingCommands.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/FoldingCommands.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -14,7 +14,6 @@
 using MonoDevelop.Core.AddIns;
 using MonoDevelop.Core.Properties;
 using MonoDevelop.Core.AddIns.Codons;
-
 using MonoDevelop.Gui.Dialogs;
 using MonoDevelop.TextEditor.Document;
 using MonoDevelop.TextEditor;

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/IEditAction.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/IEditAction.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/IEditAction.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -6,11 +6,8 @@
 // &lt;/file&gt;
 
 using System;
-
 using MonoDevelop.SourceEditor.Gui;
 
-using Gdk;
-
 namespace MonoDevelop.TextEditor.Actions
 {
 	/// &lt;summary&gt;
@@ -22,7 +19,8 @@
 		/// &lt;value&gt;
 		/// An array of keys on which this edit action occurs.
 		/// &lt;/value&gt;
-		Gdk.Key[] Keys {
+		Gdk.Key[] Keys
+		{
 			get;
 			set;
 		}
@@ -30,7 +28,7 @@
 		/// &lt;remarks&gt;
 		/// When the key which is defined per XML is pressed, this method will be launched.
 		/// &lt;/remarks&gt;
-		void Execute(SourceEditorView textArea);
+		void Execute (SourceEditorView textArea);
 	}
 	
 	/// &lt;summary&gt;
@@ -44,7 +42,8 @@
 		/// &lt;value&gt;
 		/// An array of keys on which this edit action occurs.
 		/// &lt;/value&gt;
-		public Gdk.Key[] Keys {
+		public Gdk.Key[] Keys
+		{
 			get {
 				return keys;
 			}
@@ -56,6 +55,6 @@
 		/// &lt;remarks&gt;
 		/// When the key which is defined per XML is pressed, this method will be launched.
 		/// &lt;/remarks&gt;
-		public abstract void Execute(SourceEditorView textArea);
+		public abstract void Execute (SourceEditorView textArea);
 	}		
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ProjectCommands.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ProjectCommands.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ProjectCommands.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -6,18 +6,12 @@
 // &lt;/file&gt;
 
 using System;
-using System.IO;
-using System.Collections;
-using System.Text;
 
-using MonoDevelop.Core.AddIns;
-using MonoDevelop.Core.Properties;
+using MonoDevelop.Services;
 using MonoDevelop.Core.AddIns.Codons;
 using MonoDevelop.Core.Services;
-using MonoDevelop.Services;
-using MonoDevelop.Gui.Dialogs;
-using MonoDevelop.TextEditor.Document;
 using MonoDevelop.Gui;
+using MonoDevelop.Gui.Dialogs;
 
 namespace MonoDevelop.DefaultEditor.Commands
 {
@@ -25,16 +19,15 @@
 	{
 		public override void Run()
 		{
-			IProjectService projectService = (IProjectService)MonoDevelop.Core.Services.ServiceManager.Services.GetService(typeof(IProjectService));
+			IProjectService projectService = (IProjectService) MonoDevelop.Core.Services.ServiceManager.Services.GetService (typeof (IProjectService));
 			if (projectService.CurrentSelectedProject != null) {
-			/*
-				ExportProjectToHtmlDialog ephd = new ExportProjectToHtmlDialog (projectService.CurrentSelectedProject);
-				ephd.TransientFor = (Gtk.Window) WorkbenchSingleton.Workbench;
-				ephd.Run ();
-				ephd.Hide ();
-				ephd.Dispose();*/
+			
+				using (ExportProjectToHtmlDialog ephd = new ExportProjectToHtmlDialog (projectService.CurrentSelectedProject)) {
+					ephd.TransientFor = (Gtk.Window) WorkbenchSingleton.Workbench;
+					ephd.Run ();
+					ephd.Hide ();
+				}
 			}
 		}
 	}
-
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/SearchCommands.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/SearchCommands.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/SearchCommands.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -9,21 +9,17 @@
 using System.IO;
 using System.Threading;
 using System.Drawing;
-using System.Drawing.Printing;
 using System.Collections;
 using System.ComponentModel;
 using System.Diagnostics;
 using System.Text;
 
 using MonoDevelop.Core.AddIns;
-
 using MonoDevelop.Core.Properties;
 using MonoDevelop.Core.AddIns.Codons;
-
 using MonoDevelop.TextEditor;
 using MonoDevelop.TextEditor.Actions;
 using MonoDevelop.TextEditor.Document;
-
 using MonoDevelop.Gui.Dialogs;
 using MonoDevelop.Gui;
 using MonoDevelop.SourceEditor.Gui;
@@ -33,7 +29,8 @@
 	
 	public abstract class AbstractEditActionMenuCommand : AbstractMenuCommand
 	{
-		public abstract IEditAction EditAction {
+		public abstract IEditAction EditAction
+		{
 			get;
 		}
 		
@@ -52,7 +49,7 @@
 	
 	public class Find : AbstractMenuCommand
 	{
-		public static void SetSearchPattern()
+		public static void SetSearchPattern ()
 		{
 			IWorkbenchWindow window = WorkbenchSingleton.Workbench.ActiveWorkbenchWindow;
 
@@ -68,7 +65,6 @@
 		
 		public override void Run()
 		{
-			
 			SetSearchPattern();
 			if (SearchReplaceManager.ReplaceDialog != null) {
 				if (SearchReplaceManager.ReplaceDialog.replaceMode == false) {
@@ -80,7 +76,7 @@
 					rd.ShowAll ();
 				}
 			} else {
-				ReplaceDialog rd = new ReplaceDialog(false);
+				ReplaceDialog rd = new ReplaceDialog (false);
 				rd.ShowAll();
 			}
 		}
@@ -88,17 +84,17 @@
 	
 	public class FindNext : AbstractMenuCommand
 	{
-		public override void Run()
+		public override void Run ()
 		{
-			SearchReplaceManager.FindNext();
+			SearchReplaceManager.FindNext ();
 		}
 	}
 	
 	public class Replace : AbstractMenuCommand
 	{
-		public override void Run()
+		public override void Run ()
 		{ 
-			Find.SetSearchPattern();
+			Find.SetSearchPattern ();
 			
 			if (SearchReplaceManager.ReplaceDialog != null) {
 				if (SearchReplaceManager.ReplaceDialog.replaceMode == true) {
@@ -118,7 +114,7 @@
 	
 	public class FindInFiles : AbstractMenuCommand
 	{
-		public static void SetSearchPattern()
+		public static void SetSearchPattern ()
 		{
 			IWorkbenchWindow window = WorkbenchSingleton.Workbench.ActiveWorkbenchWindow;
 			if (window != null &amp;&amp; window.ViewContent is SourceEditorDisplayBindingWrapper)
@@ -130,9 +126,9 @@
 			}
 		}
 		
-		public override void Run()
+		public override void Run ()
 		{
-			SetSearchPattern();
+			SetSearchPattern ();
 			if (SearchReplaceInFilesManager.ReplaceDialog != null) {
 				if (SearchReplaceInFilesManager.ReplaceDialog.replaceMode == false) {
 					//SearchReplaceInFilesManager.ReplaceDialog.SetSearchPattern(SearchReplaceInFilesManager.SearchOptions.SearchPattern);
@@ -153,7 +149,7 @@
 	{
 		public override void Run()
 		{
-			FindInFiles.SetSearchPattern();
+			FindInFiles.SetSearchPattern ();
 			
 			if (SearchReplaceInFilesManager.ReplaceDialog != null) {
 				if (SearchReplaceInFilesManager.ReplaceDialog.replaceMode == true) {
@@ -165,15 +161,15 @@
 					rd.ShowAll ();
 				}
 			} else {
-				ReplaceInFilesDialog rd = new ReplaceInFilesDialog(true);
-				rd.ShowAll();
+				ReplaceInFilesDialog rd = new ReplaceInFilesDialog (true);
+				rd.ShowAll ();
 			}
 		}
 	}
 	
 	public class GotoLineNumber : AbstractMenuCommand
 	{
-		public override void Run()
+		public override void Run ()
 		{
 			if (!GotoLineNumberDialog.IsVisible)
 				using (GotoLineNumberDialog gnd = new GotoLineNumberDialog ())

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/TextAreaContextmenuCommands.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/TextAreaContextmenuCommands.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/TextAreaContextmenuCommands.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -50,15 +50,12 @@
 		}
 	}
 	
-	
 	public class HighlightingTypeBuilder : ISubmenuBuilder
 	{
-		
 		//TextEditorControl  control      = null;
 		//Gtk.MenuItem[] menuCommands = null;
-		
-		
-		public Gtk.MenuItem[] BuildSubmenu(ConditionCollection conditionCollection, object owner)
+			
+		public Gtk.MenuItem[] BuildSubmenu (ConditionCollection conditionCollection, object owner)
 		{
 			/*
 			control = (TextEditorControl)owner;
@@ -77,7 +74,7 @@
 			return null;
 		}
 		
-		void ChangeSyntax(object sender, EventArgs e)
+		void ChangeSyntax (object sender, EventArgs e)
 		{
 			/*
 			if (control != null) {

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ToolCommands.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ToolCommands.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Commands/ToolCommands.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -20,12 +20,12 @@
 using MonoDevelop.SourceEditor.Gui;
 
 using Gtk;
-using GtkSharp;
 
 namespace MonoDevelop.DefaultEditor.Commands
 {
 	public class ColorDialog : ColorSelectionDialog
 	{
+		// FIXME: i18n
 		public ColorDialog () : base (&quot;Insert a color hex string&quot;)
 		{
 			this.ColorSelection.HasPalette = true;

Copied: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/EditTemplateGroupDialog.cs (from rev 1141, trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/EditTemplateGroupDialog.cs)

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -16,29 +16,33 @@
 using MonoDevelop.Internal.Project;
 using MonoDevelop.TextEditor.Document;
 //using MonoDevelop.TextEditor.Util;
+using MonoDevelop.Gui.Widgets;
 
 using Gtk;
 
+// FIXME: use IdleHandler instead of threads here
+// also, what is the point of exporting to HTML?
+
 namespace MonoDevelop.Gui.Dialogs
 {
 	public class ExportProjectToHtmlDialog : Dialog
 	{
-	/*
-		Entry pathTextBox  = new Entry ();
-		Label   pathLabel    = new Label();
-		Button  okButton     = new Button();
-		Button  cancelButton = new Button();
-		Button  browseButton = new Button();
+		Entry pathTextBox = new Entry ();
+		Label pathLabel = new Label ();
+		Button okButton = new Button ();
+		Button cancelButton = new Button ();
+		Button browseButton = new Button ();
+		ProgressBar progressBar = new ProgressBar ();
 		
-		ProgressBar progressBar = new ProgressBar();
+		FileUtilityService fileUtilityService = (FileUtilityService) ServiceManager.Services.GetService(typeof(FileUtilityService));
+		IconService iconService = (IconService) ServiceManager.Services.GetService(typeof(IconService));
+		ResourceService resourceService = (ResourceService) ServiceManager.Services.GetService(typeof(IResourceService));	
 		
-		FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
-		IconService iconService = (IconService)ServiceManager.Services.GetService(typeof(IconService));
-		ResourceService resourceService = (ResourceService)ServiceManager.Services.GetService(typeof(IResourceService));	
 		IProject project;
 		int filesExported = 0;
 		
-		int FilesExported {
+		int FilesExported
+		{
 			get {
 				return filesExported;
 			}
@@ -47,54 +51,53 @@
 			}
 		}
 		
-		void StartExporting()
+		void StartExporting ()
 		{
-			cancelButton = new Button (Stock.Cancel);
-			cancelButton.Click   += new EventHandler(StopThread);
+			cancelButton = new Button (Gtk.Stock.Cancel);
+			cancelButton.Clicked += new EventHandler (StopThread);
 		}
-*/
-		public ExportProjectToHtmlDialog(IProject project)
+
+		public ExportProjectToHtmlDialog (IProject project)
 		{
-/*			PropertyService propertyService = (PropertyService)ServiceManager.Services.GetService(typeof(PropertyService));
-			
+			PropertyService propertyService = (PropertyService) ServiceManager.Services.GetService (typeof (PropertyService));	
 			this.project = project;
 			
-			pathLabel.Text = resourceService.GetString(&quot;Dialog.ExportProjectToHtml.FolderLabel&quot;);
+			pathLabel.Text = resourceService.GetString (&quot;Dialog.ExportProjectToHtml.FolderLabel&quot;);
 			
-			browseButton.Text     = &quot;...&quot;;
-			browseButton.Click   += new EventHandler(BrowseDirectories);
+			//browseButton.Text = &quot;...&quot;;
+			//browseButton.Click += new EventHandler(BrowseDirectories);
 			
-			okButton.Text     = resourceService.GetString(&quot;Global.OKButtonText&quot;);
-			okButton.Click   += new EventHandler(ExportProject);
+			//okButton.Text     = resourceService.GetString(&quot;Global.OKButtonText&quot;);
+			//okButton.Click   += new EventHandler(ExportProject);
 			
-			cancelButton.DialogResult = DialogResult.Cancel;
+			//cancelButton.DialogResult = DialogResult.Cancel;
 			
 			RequestSize = new Size (350, 88 + 6);
-			Position = StartPosition.CenterParent;
-			//ShowInTaskbar = false;
+			WindowPosition = WindowPosition.CenterOnParent;
 			
-			Title = resourceService.GetString(&quot;Dialog.ExportProjectToHtml.DialogName&quot;);
-*/
+			Title = resourceService.GetString (&quot;Dialog.ExportProjectToHtml.DialogName&quot;);
 		}
-/*		
-		void BrowseDirectories(object sender, EventArgs e)
+		
+		void BrowseDirectories (object sender, EventArgs e)
 		{
-			FolderDialog fd = new FolderDialog();
-
-			if(fd.DisplayDialog(resourceService.GetString(&quot;Dialog.ExportProjectToHtml.SelectTargetDirInfo&quot;)) == DialogResult.OK) {
-				pathTextBox.Text = fd.Path;
+			using (FolderDialog fd = new FolderDialog (resourceService.GetString (&quot;Dialog.ExportProjectToHtml.SelectTargetDirInfo&quot;))) {
+				if	(fd.Run () == (int) ResponseType.Ok) {
+					//pathTextBox.Text = fd.Path;
+				}
+				
+				fd.Hide ();
 			}
 		}
 		
-		Hashtable projectTable = new Hashtable();
-		Hashtable bitmapTable  = new Hashtable();
-		int       bitmapIconIndex = 0;
-		int       indexFileIndex  = 0;
+		Hashtable projectTable = new Hashtable ();
+		Hashtable bitmapTable = new Hashtable ();
+		int bitmapIconIndex = 0;
+		int indexFileIndex = 0;
 		
-		public Hashtable GetPath(string filename, Hashtable table, bool create)
+		public Hashtable GetPath (string filename, Hashtable table, bool create)
 		{
-			string directory    = Path.GetDirectoryName(filename);
-			string[] treepath   = directory.Split(new char[] { Path.DirectorySeparatorChar });
+			string directory = System.IO.Path.GetDirectoryName (filename);
+			string[] treepath = directory.Split (new char[] { System.IO.Path.DirectorySeparatorChar });
 			Hashtable curTable = table;
 			
 			foreach (string path in treepath) {
@@ -112,16 +115,20 @@
 					} else {
 						return null;
 					}
-				} 
+				}
+				
 				curTable = (Hashtable)node;
 			}
+			
 			return curTable;
 		}
-		int GetImageIndex(string filename)
+		
+		int GetImageIndex (string filename)
 		{
 			if (filename != null) {
-				return iconService.GetImageIndexForFile(filename);
+				return 0; //iconService.GetImageIndexForFile (filename);
 			}
+			
 			return -1;
 		}
 		
@@ -129,7 +136,8 @@
 		{
 			public string title;
 			public string url;
-			public Descriptor(string title, string url)
+			
+			public Descriptor (string title, string url)
 			{
 				this.title = title;
 				this.url = url;
@@ -137,55 +145,57 @@
 		}
 		
 		StreamWriter curFileStream  = null;
-		Stack        curIndexStreamStack = new Stack();
-		int          curSpanNumber  = 0;
-		Hashtable    Spans          = new Hashtable();
+		Stack curIndexStreamStack = new Stack ();
+		int curSpanNumber = 0;
+		Hashtable Spans = new Hashtable();
 		
 		string ExportFile (string fileName, string targetPath)
 		{
-			string targetFile = fileUtilityService.AbsoluteToRelativePath(project.BaseDirectory, fileName).Substring(2).Replace(System.IO.Path.DirectorySeparatorChar.ToString(), &quot;&quot;) + &quot;.html&quot;;
+			string targetFile = fileUtilityService.AbsoluteToRelativePath (project.BaseDirectory, fileName).Substring (2).Replace (System.IO.Path.DirectorySeparatorChar.ToString (), &quot;&quot;) + &quot;.html&quot;;
 			
-			IDocument document = new DocumentFactory().CreateDocument();
-			document.HighlightingStrategy = HighlightingStrategyFactory.CreateHighlightingStrategyForFile(fileName);
-			StreamReader stream = File.OpenText(fileName);
-			document.TextContent = stream.ReadToEnd();
-			stream.Close();
+			//IDocument document = new DocumentFactory ().CreateDocument ();
+			//document.HighlightingStrategy = HighlightingStrategyFactory.CreateHighlightingStrategyForFile (fileName);
+			StreamReader stream = File.OpenText (fileName);
+			//document.TextContent = stream.ReadToEnd ();
+			stream.Close ();
 			
-			curFileStream = File.CreateText(targetPath + Path.DirectorySeparatorChar + targetFile);
-			curFileStream.Write(&quot;&lt;html&gt;\r\n&quot;);
-			curFileStream.Write(&quot;&lt;head&gt;\r\n&quot;);
-			curFileStream.Write(&quot;&lt;link rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot; href=\&quot;sdcss.css\&quot;&gt;\r\n&quot;);
-			curFileStream.Write(&quot;&lt;title&gt;&quot; + Path.GetFileName(fileName) + &quot;&lt;/title&gt;\r\n&quot;);
-			curFileStream.Write(&quot;&lt;/head&gt;\r\n&quot;);
-			curFileStream.Write(&quot;&lt;body&gt;\r\n&quot;);
+			curFileStream = File.CreateText (System.IO.Path.Combine (targetPath, targetFile));
+			curFileStream.Write (&quot;&lt;html&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;head&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;link rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot; href=\&quot;sdcss.css\&quot;&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;title&gt;&quot; + System.IO.Path.GetFileName (fileName) + &quot;&lt;/title&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;/head&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;body&gt;\r\n&quot;);
 			
-			curFileStream.Write(&quot;&lt;div class=\&quot;code\&quot;&gt;&lt;TABLE SUMMARY=\&quot;SourceCode\&quot; BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH=\&quot;100%\&quot;&gt;\r\n&quot;);
-			curFileStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;#FFFFFF\&quot;&gt;\r\n&quot;);
-			curFileStream.Write(&quot;    &lt;TH WIDTH=\&quot;50\&quot; NOWRAP ALIGN=LEFT&gt;&lt;/TH&gt;\r\n&quot;);
-			curFileStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;&lt;/TH&gt;\r\n&quot;);
-			curFileStream.Write(&quot;    &lt;TH VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
-			curFileStream.Write(&quot;    &lt;/TH&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;div class=\&quot;code\&quot;&gt;&lt;TABLE SUMMARY=\&quot;SourceCode\&quot; BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH=\&quot;100%\&quot;&gt;\r\n&quot;);
+			curFileStream.Write (&quot;  &lt;TR BGCOLOR=\&quot;#FFFFFF\&quot;&gt;\r\n&quot;);
+			curFileStream.Write (&quot;    &lt;TH WIDTH=\&quot;50\&quot; NOWRAP ALIGN=LEFT&gt;&lt;/TH&gt;\r\n&quot;);
+			curFileStream.Write (&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;&lt;/TH&gt;\r\n&quot;);
+			curFileStream.Write (&quot;    &lt;TH VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+			curFileStream.Write (&quot;    &lt;/TH&gt;\r\n&quot;);
 			
-			curFileStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
+			curFileStream.Write (&quot;  &lt;/TR&gt;\r\n&quot;);
 			int i = 0;
-			foreach (LineSegment line in document.LineSegmentCollection) {
-				curFileStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;#FFFFFF\&quot; VALIGN=TOP&gt;\r\n&quot;);
-				curFileStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + ++i + &quot;:&lt;/TD&gt;\r\n&quot;);
-				curFileStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp;\r\n&quot;);
+			
+			/*foreach (LineSegment line in document.LineSegmentCollection) {
+				curFileStream.Write (&quot;  &lt;TR BGCOLOR=\&quot;#FFFFFF\&quot; VALIGN=TOP&gt;\r\n&quot;);
+				curFileStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + ++i + &quot;:&lt;/TD&gt;\r\n&quot;);
+				curFileStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp;\r\n&quot;);
 				bool spanOpen = false;
 				Color curColor = Color.Black;
-				bool  oldItalic = false;
-				bool  oldBold   = false;
+				bool oldItalic = false;
+				bool oldBold = false;
 				bool firstSpan = true;
+				
 				foreach (TextWord word in line.Words) {
 					switch (word.Type) {
 						case TextWordType.Space:
-							curFileStream.Write(&quot;&amp;nbsp;&quot;);
+							curFileStream.Write (&quot;&amp;nbsp;&quot;);
 						break;
 						
 						case TextWordType.Tab:
 							for (int k = 0; k &lt; document.TextEditorProperties.TabIndent; ++k) {
-								curFileStream.Write(&quot;&amp;nbsp;&quot;);
+								curFileStream.Write (&quot;&amp;nbsp;&quot;);
 							}
 						break;
 						
@@ -196,24 +206,28 @@
 							if (word.Font.Italic) {
 								colorstr = &quot;i&quot; + colorstr;
 							}
+							
 							if (word.Font.Bold) {
 								colorstr = &quot;b&quot; + colorstr;
 							}
+							
 							if (Spans[colorstr] == null) {
 								Spans[colorstr] = &quot;span&quot; + ++curSpanNumber;
 							}
 							bool newColor = c != curColor || oldItalic != word.Font.Italic || oldBold != word.Font.Bold;
+							
 							if (newColor) {
 								if (!firstSpan) {
-									curFileStream.Write(&quot;&lt;/span&gt;&quot; );
+									curFileStream.Write (&quot;&lt;/span&gt;&quot; );
 								}
 								
-								curFileStream.Write(&quot;&lt;span class=\&quot;&quot; + Spans[colorstr].ToString() + &quot;\&quot;&gt;&quot; );
+								curFileStream.Write (&quot;&lt;span class=\&quot;&quot; + Spans[colorstr].ToString () + &quot;\&quot;&gt;&quot; );
 								spanOpen  = true;
 								firstSpan = false;
 							}
-							curFileStream.Write(HtmlLize(word.Word));
 							
+							curFileStream.Write (HtmlLize (word.Word));
+							
 							if (newColor) {
 								curColor = c;
 								oldItalic = word.Font.Italic;
@@ -222,82 +236,85 @@
 						break;
 					}
 				}
+				
 				if (spanOpen) {
-					curFileStream.Write(&quot;&lt;/span&gt;&quot; );
+					curFileStream.Write (&quot;&lt;/span&gt;&quot; );
 				}
-				curFileStream.Write(&quot;&lt;/TD&gt;\r\n&quot;);
-				curFileStream.Write(&quot;&lt;/TR&gt;\r\n&quot;);
+				
+				curFileStream.Write (&quot;&lt;/TD&gt;\r\n&quot;);
+				curFileStream.Write (&quot;&lt;/TR&gt;\r\n&quot;);
 			}
-			curFileStream.Write(&quot;&lt;/TABLE&gt;&lt;/div&gt;\r\n&quot;);
+			*/
+			curFileStream.Write (&quot;&lt;/TABLE&gt;&lt;/div&gt;\r\n&quot;);
 			
-			curFileStream.Write(&quot;&lt;P&gt;\r\n&quot;);
-			curFileStream.Write(&quot;This page was automatically generated by \r\n&quot;);
-			curFileStream.Write(&quot;&lt;A TARGET=\&quot;_blank\&quot; HREF=\&quot;<A HREF="http://www.icsharpcode.net/OpenSource/SD\&quot;">http://www.icsharpcode.net/OpenSource/SD\&quot;</A>&gt;SharpDevelop&lt;/A&gt;.\r\n&quot;);
-			curFileStream.Write(&quot;&lt;/p&gt;\r\n&quot;);
-			curFileStream.Write(&quot;&lt;/body&gt;\r\n&quot;);
-			curFileStream.Write(&quot;&lt;/html&gt;\r\n&quot;);
-			curFileStream.Close();
+			curFileStream.Write (&quot;&lt;P&gt;\r\n&quot;);
+			curFileStream.Write (&quot;This page was automatically generated by \r\n&quot;);
+			curFileStream.Write (&quot;&lt;A TARGET=\&quot;_blank\&quot; HREF=\&quot;<A HREF="http://www.icsharpcode.net/OpenSource/SD\&quot;">http://www.icsharpcode.net/OpenSource/SD\&quot;</A>&gt;SharpDevelop&lt;/A&gt;.\r\n&quot;);
+			curFileStream.Write (&quot;&lt;/p&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;/body&gt;\r\n&quot;);
+			curFileStream.Write (&quot;&lt;/html&gt;\r\n&quot;);
+			curFileStream.Close ();
 			return targetFile;
 		}
 		
-		string HtmlLize(string str)
+		string HtmlLize (string str)
 		{
-			return str.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).Replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).Replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;);
+			return str.Replace (&quot;&amp;&quot;, &quot;&amp;amp;&quot;).Replace (&quot;&lt;&quot;, &quot;&amp;lt;&quot;).Replace (&quot;&gt;&quot;, &quot;&amp;gt;&quot;);
 		}
 		
-		void WriteIndexTable(string fileName, string name, ArrayList nameList, Hashtable table)
+		void WriteIndexTable (string fileName, string name, ArrayList nameList, Hashtable table)
 		{
-			curIndexStreamStack.Push(File.CreateText(fileName));
-			StreamWriter curIndexStream = (StreamWriter)curIndexStreamStack.Peek();
+			curIndexStreamStack.Push (File.CreateText(fileName));
+			StreamWriter curIndexStream = (StreamWriter) curIndexStreamStack.Peek();
 			
-			curIndexStream.Write(&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//W3C//DTD HTML 4.0 Transitional//EN\&quot;&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;html&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;head&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;title&gt;&quot; + project.Name + &quot;&lt;/title&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;/head&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//W3C//DTD HTML 4.0 Transitional//EN\&quot;&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;html&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;head&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;title&gt;&quot; + project.Name + &quot;&lt;/title&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;/head&gt;\r\n&quot;);
 			
-			curIndexStream.Write(&quot;&lt;body&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;p&gt;Location : &quot;);
+			curIndexStream.Write (&quot;&lt;body&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;p&gt;Location : &quot;);
 			foreach (Descriptor d in nameList) {
-				curIndexStream.Write(&quot;&lt;a href=\&quot;&quot;+ d.url + &quot;\&quot;&gt;&quot; + d.title + &quot;&lt;/a&gt;/&quot;);
+				curIndexStream.Write (&quot;&lt;a href=\&quot;&quot;+ d.url + &quot;\&quot;&gt;&quot; + d.title + &quot;&lt;/a&gt;/&quot;);
 			}
-			curIndexStream.Write(name);
-			curIndexStream.Write(&quot;&lt;/p&gt;\r\n&quot;);
+			curIndexStream.Write (name);
+			curIndexStream.Write (&quot;&lt;/p&gt;\r\n&quot;);
 			
 			nameList.Add (new Descriptor (name, System.IO.Path.GetFileName (fileName)));
 					
-			curIndexStream.Write(&quot;&lt;TABLE SUMMARY=\&quot;Directory\&quot; BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH=\&quot;100%\&quot;&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;#F38C00\&quot;&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot;&gt;&amp;nbsp;&lt;/TH&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;Name&lt;/TH&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=RIGHT&gt;Size&lt;/TH&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;Date&lt;/TH&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;    &lt;TH VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
-			curIndexStream.Write(&quot;    &lt;/TH&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;TABLE SUMMARY=\&quot;Directory\&quot; BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH=\&quot;100%\&quot;&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;  &lt;TR BGCOLOR=\&quot;#F38C00\&quot;&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;    &lt;TH WIDTH=\&quot;1%\&quot;&gt;&amp;nbsp;&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;Name&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=RIGHT&gt;Size&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;Date&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;    &lt;TH VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+			curIndexStream.Write (&quot;    &lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;  &lt;/TR&gt;\r\n&quot;);
 			
 			bool coloring = false;
 			foreach (DictionaryEntry entry in table) {
 				if (entry.Value is Hashtable) {
 					string filename = &quot;index&quot; + ++indexFileIndex + &quot;.html&quot;;
 					WriteIndexTable (System.IO.Path.GetDirectoryName (fileName) + System.IO.Path.DirectorySeparatorChar + filename, entry.Key.ToString(), nameList, (Hashtable)entry.Value);
-					nameList.RemoveAt(nameList.Count - 1);
-					curIndexStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;&quot; + (coloring ? &quot;#FFFFFF&quot; : &quot;#EEEEEE&quot;) + &quot;\&quot; VALIGN=TOP&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&lt;a href=\&quot;&quot; + filename + &quot;\&quot;&gt;&lt;IMG ALIGN=ABSBOTTOM BORDER=0 WIDTH=16 HEIGHT=16 SRC=\&quot;folderbitmap.png\&quot;&gt;&lt;/a&gt;&lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&lt;a href=\&quot;&quot;+ filename + &quot;\&quot;&gt;&quot; + entry.Key.ToString() + &quot;&lt;/a&gt; &lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;-&lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;-&lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
+					nameList.RemoveAt (nameList.Count - 1);
+					curIndexStream.Write (&quot;  &lt;TR BGCOLOR=\&quot;&quot; + (coloring ? &quot;#FFFFFF&quot; : &quot;#EEEEEE&quot;) + &quot;\&quot; VALIGN=TOP&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&lt;a href=\&quot;&quot; + filename + &quot;\&quot;&gt;&lt;IMG ALIGN=ABSBOTTOM BORDER=0 WIDTH=16 HEIGHT=16 SRC=\&quot;folderbitmap.png\&quot;&gt;&lt;/a&gt;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&lt;a href=\&quot;&quot;+ filename + &quot;\&quot;&gt;&quot; + entry.Key.ToString() + &quot;&lt;/a&gt; &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;-&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;-&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;  &lt;/TR&gt;\r\n&quot;);
 				} else if (entry.Value is ProjectFile) {
-					ProjectFile fInfo = (ProjectFile)entry.Value;
-					DateTime time = Directory.GetLastAccessTime(fInfo.Name);
-					FileStream reader = File.OpenRead(fInfo.Name);
+					ProjectFile fInfo = (ProjectFile) entry.Value;
+					DateTime time = Directory.GetLastAccessTime (fInfo.Name);
+					FileStream reader = File.OpenRead (fInfo.Name);
 					long size = reader.Length;
-					reader.Close();
+					reader.Close ();
 					
-					int idx  = GetImageIndex(fInfo.Name);
+					int idx  = GetImageIndex (fInfo.Name);
 					if (bitmapTable[idx] == null) {
 						string filename = &quot;fileicon&quot; + ++bitmapIconIndex + &quot;.png&quot;;
 						
@@ -307,111 +324,111 @@
 					}
 					string outFile = ExportFile(fInfo.Name, System.IO.Path.GetDirectoryName(fileName));
 					++FilesExported;
-					curIndexStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;&quot; + (coloring ? &quot;#FFFFFF&quot; : &quot;#EEEEEE&quot;) + &quot;\&quot; VALIGN=TOP&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&lt;a href=\&quot;&quot; + outFile + &quot;\&quot;&gt;&lt;IMG ALIGN=ABSBOTTOM BORDER=0 WIDTH=16 HEIGHT=16 SRC=\&quot;&quot; + bitmapTable[idx].ToString() +&quot;\&quot;&gt;&lt;/a&gt;&lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&lt;a href=\&quot;&quot; + outFile + &quot;\&quot;&gt;&quot; + System.IO.Path.GetFileName(fInfo.Name) + &quot;&lt;/a&gt; &lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + size + &quot;&lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + time.ToString(&quot;d&quot;) + &quot;&lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;TD VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
-					curIndexStream.Write(&quot;    &lt;/TD&gt;\r\n&quot;);
-					curIndexStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
-					
+					curIndexStream.Write (&quot;  &lt;TR BGCOLOR=\&quot;&quot; + (coloring ? &quot;#FFFFFF&quot; : &quot;#EEEEEE&quot;) + &quot;\&quot; VALIGN=TOP&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&lt;a href=\&quot;&quot; + outFile + &quot;\&quot;&gt;&lt;IMG ALIGN=ABSBOTTOM BORDER=0 WIDTH=16 HEIGHT=16 SRC=\&quot;&quot; + bitmapTable[idx].ToString() +&quot;\&quot;&gt;&lt;/a&gt;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&lt;a href=\&quot;&quot; + outFile + &quot;\&quot;&gt;&quot; + System.IO.Path.GetFileName(fInfo.Name) + &quot;&lt;/a&gt; &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + size + &quot;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + time.ToString(&quot;d&quot;) + &quot;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;TD VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+					curIndexStream.Write (&quot;    &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write (&quot;  &lt;/TR&gt;\r\n&quot;);
 				}
+				
 				coloring = !coloring;
 			}
 			
-			curIndexStream.Write(&quot;&lt;/TABLE&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;/TABLE&gt;\r\n&quot;);
 			
-			curIndexStream.Write(&quot;&lt;p&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;This page was automatically generated by \r\n&quot;);
-			curIndexStream.Write(&quot;&lt;A TARGET=\&quot;_blank\&quot; HREF=\&quot;<A HREF="http://www.icsharpcode.net/OpenSource/SD\&quot;">http://www.icsharpcode.net/OpenSource/SD\&quot;</A>&gt;SharpDevelop&lt;/A&gt;.\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;/p&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;/body&gt;\r\n&quot;);
-			curIndexStream.Write(&quot;&lt;/html&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;p&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;This page was automatically generated by \r\n&quot;);
+			curIndexStream.Write (&quot;&lt;A TARGET=\&quot;_blank\&quot; HREF=\&quot;<A HREF="http://www.icsharpcode.net/OpenSource/SD\&quot;">http://www.icsharpcode.net/OpenSource/SD\&quot;</A>&gt;SharpDevelop&lt;/A&gt;.\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;/p&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;/body&gt;\r\n&quot;);
+			curIndexStream.Write (&quot;&lt;/html&gt;\r\n&quot;);
 			
 			lock (this) {
-				curIndexStream.Close();
-				curIndexStreamStack.Pop();
+				curIndexStream.Close ();
+				curIndexStreamStack.Pop ();
 			}
 		}
 		
-		delegate void MyD();
+		delegate void MyD ();
 		
-		void QuitDialog()
+		void QuitDialog ()
 		{
 			//DialogResult = DialogResult.OK;
 		}
 		
-		Thread exportFilesThread; 
-		void ExportFilesThread()
+//		Thread exportFilesThread; 
+		void ExportFilesThread ()
 		{
-			resourceService.GetBitmap(&quot;Icons.16x16.ClosedFolderBitmap&quot;).Save(fileUtilityService.GetDirectoryNameWithSeparator(pathTextBox.Text) + &quot;folderbitmap.png&quot;);
-			WriteIndexTable(fileUtilityService.GetDirectoryNameWithSeparator(pathTextBox.Text) + &quot;index.html&quot;, &quot;[ROOT]&quot;, new ArrayList(), projectTable);
-			CreateCSS(pathTextBox.Text);
-			Invoke(new MyD(QuitDialog));
+			//resourceService.GetBitmap (&quot;Icons.16x16.ClosedFolderBitmap&quot;).Save (fileUtilityService.GetDirectoryNameWithSeparator (pathTextBox.Text) + &quot;folderbitmap.png&quot;);
+			WriteIndexTable (fileUtilityService.GetDirectoryNameWithSeparator (pathTextBox.Text) + &quot;index.html&quot;, &quot;[ROOT]&quot;, new ArrayList (), projectTable);
+			CreateCSS (pathTextBox.Text);
+			//Invoke (new MyD (QuitDialog));
 		}
 		
 		void StopThread(object sender, EventArgs e)
 		{
-			lock (this) {
-				exportFilesThread.Abort();
-				curFileStream.Close();
+			//lock (this) {
+				//exportFilesThread.Abort ();
+				curFileStream.Close ();
 				while (curIndexStreamStack.Count &gt; 0) {
-					((StreamWriter)curIndexStreamStack.Pop()).Close();
+					((StreamWriter) curIndexStreamStack.Pop ()).Close ();
 				}
-				QuitDialog();
-			}
+				QuitDialog ();
+			//}
 		}
 		
-		void CreateCSS(string targetPath)
+		void CreateCSS (string targetPath)
 		{
-			lock (this) {
-				StreamWriter sw = File.CreateText(targetPath + Path.DirectorySeparatorChar + &quot;sdcss.css&quot;);
-				sw.Write(&quot;div.code\r\n&quot;);
-				sw.Write(&quot;{\r\n&quot;);
-				sw.Write(&quot;	background-color: rgb(255,255,255);\r\n&quot;);
-				sw.Write(&quot;	font-family: \&quot;Lucida Console\&quot;, \&quot;courier new\&quot;, courier;\r\n&quot;);
-				sw.Write(&quot;	color: rgb(0,0,0);\r\n&quot;);
-				sw.Write(&quot;	font-size: x-small;\r\n&quot;);
-				sw.Write(&quot;	padding: 1em;\r\n&quot;);
-				sw.Write(&quot;	margin: 1em;\r\n&quot;);
-				sw.Write(&quot;}\r\n&quot;);
+			//lock (this) {
+				StreamWriter sw = File.CreateText (System.IO.Path.Combine (targetPath, &quot;sdcss.css&quot;));
+				sw.Write (&quot;div.code\r\n&quot;);
+				sw.Write (&quot;{\r\n&quot;);
+				sw.Write (&quot;	background-color: rgb(255,255,255);\r\n&quot;);
+				sw.Write (&quot;	font-family: \&quot;Lucida Console\&quot;, \&quot;courier new\&quot;, courier;\r\n&quot;);
+				sw.Write (&quot;	color: rgb(0,0,0);\r\n&quot;);
+				sw.Write (&quot;	font-size: x-small;\r\n&quot;);
+				sw.Write (&quot;	padding: 1em;\r\n&quot;);
+				sw.Write (&quot;	margin: 1em;\r\n&quot;);
+				sw.Write (&quot;}\r\n&quot;);
 				
 				foreach (DictionaryEntry entry in Spans) {
-					string color = entry.Key.ToString();
-					string name  = entry.Value.ToString();
-					bool bold   = color.StartsWith(&quot;b&quot;);
+					string color = entry.Key.ToString ();
+					string name  = entry.Value.ToString ();
+					bool bold   = color.StartsWith (&quot;b&quot;);
 					if (bold) {
 						color = color.Substring(1);
 					}
-					bool italic = color.StartsWith(&quot;i&quot;);
+					bool italic = color.StartsWith (&quot;i&quot;);
 					if (italic) {
-						color = color.Substring(1);
+						color = color.Substring (1);
 					}
 					
-					sw.Write(&quot;div.code span.&quot; + name +&quot;\r\n&quot;);
-					sw.Write(&quot;{\r\n&quot;);
-					sw.Write(&quot;	color: rgb(&quot;+ color + &quot;);\r\n&quot;);
+					sw.Write (&quot;div.code span.&quot; + name +&quot;\r\n&quot;);
+					sw.Write (&quot;{\r\n&quot;);
+					sw.Write (&quot;	color: rgb(&quot;+ color + &quot;);\r\n&quot;);
 					if (bold) {
-						sw.Write(&quot;	font-weight: bold;\r\n&quot;);
+						sw.Write (&quot;	font-weight: bold;\r\n&quot;);
 					} else
 					if (italic) {
-						sw.Write(&quot;	font-weight: italic;\r\n&quot;);
+						sw.Write (&quot;	font-weight: italic;\r\n&quot;);
 					} else {
-						sw.Write(&quot;	font-weight: normal;\r\n&quot;);
+						sw.Write (&quot;	font-weight: normal;\r\n&quot;);
 					}
 					
 					sw.Write(&quot;}\r\n&quot;);
 				}
-				sw.Close();
-			}
+				sw.Close ();
+			//}
 		
 		}
 		
-		void ExportProject(object sender, EventArgs e)
+		void ExportProject (object sender, EventArgs e)
 		{
-			if (!Directory.Exists(pathTextBox.Text)) {
-				MessageBox.Show(&quot;Directory doesn't exists&quot;, &quot;Error&quot;, MessageBoxButtons.OK, MessageBoxIcon.Error);
+			if (!Directory.Exists (pathTextBox.Text)) {
+				//MessageBox.Show (&quot;Directory doesn't exists&quot;, &quot;Error&quot;, MessageBoxButtons.OK, MessageBoxIcon.Error);
 				return;
 			}
 			
@@ -420,17 +437,16 @@
 					if (fInfo.BuildAction == BuildAction.Compile ||
 					    fInfo.BuildAction == BuildAction.Nothing) {
 						string relativefile = fileUtilityService.AbsoluteToRelativePath(project.BaseDirectory, fInfo.Name);
-						Hashtable table = GetPath(relativefile, projectTable, true);
+						Hashtable table = GetPath (relativefile, projectTable, true);
 						table [System.IO.Path.GetFileName(fInfo.Name)] = fInfo;
 				    }
 				}
 			}
 			
-			StartExporting();
-			exportFilesThread = new Thread(new ThreadStart(ExportFilesThread));
+			StartExporting ();
+			/*exportFilesThread = new Thread (new ThreadStart(ExportFilesThread));
 			exportFilesThread.IsBackground  = true;
-			exportFilesThread.Start();
+			exportFilesThread.Start ();*/
 		}
-		*/
 	}
 }

Deleted: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/EditTemplateGroupDialog.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/EditTemplateGroupDialog.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/EditTemplateGroupDialog.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -1,87 +0,0 @@
-// &lt;file&gt;
-//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
-//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
-//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
-//     &lt;version value=&quot;$version&quot;/&gt;
-// &lt;/file&gt;
-
-using System;
-using System.IO;
-
-using MonoDevelop.Internal.Templates;
-using MonoDevelop.Core.Services;
-
-namespace MonoDevelop.EditorBindings.Gui.Dialogs
-{
-	public class EditTemplateGroupDialog : Gtk.Dialog 
-	{
-		CodeTemplateGroup codeTemplateGroup;
-		string titlePrefix = string.Empty;
-		
-		// Gtk members
-		Gtk.Entry templateExtensionsTextBox;		
-		
-		// Services
-		StringParserService StringParserService = (StringParserService)ServiceManager.Services.GetService (typeof (StringParserService));
-		
-		public CodeTemplateGroup CodeTemplateGroup {
-			get {
-				return codeTemplateGroup;
-			}
-		}
-		
-		public EditTemplateGroupDialog(CodeTemplateGroup codeTemplateGroup, string titlePrefix)
-		{
-			this.codeTemplateGroup = codeTemplateGroup;
-			this.titlePrefix = titlePrefix;
-			InitializeComponents();
-			this.ShowAll();
-		}
-		
-		void AcceptEvent(object sender, EventArgs e)
-		{
-			codeTemplateGroup.ExtensionStrings = templateExtensionsTextBox.Text.Split(';');
-			
-			// close the window
-			CancelEvent(sender, EventArgs.Empty);
-		}
-		
-		void CancelEvent(object sender, EventArgs e)
-		{
-			this.Destroy();
-		}
-		
-		void InitializeComponents()
-		{
-			// set up this actual dialog
-			this.Modal = true;
-			// FIXME: make this a resource in the resource file
-			this.Title = titlePrefix + &quot;Code Group&quot;;
-			
-			// set up the dialog fields and add them
-			templateExtensionsTextBox = new Gtk.Entry();
-			templateExtensionsTextBox.ActivatesDefault = true;
-			// FIXME: make this a resource in the resource file
-			Gtk.Label label1 = new Gtk.Label(&quot;Extensions (; seperated)&quot;);
-			
-			label1.Xalign = 0;			
-			templateExtensionsTextBox.Text    = string.Join(&quot;;&quot;, codeTemplateGroup.ExtensionStrings);
-			
-			// FIXME: make the labels both part of the same sizing group so they have the same left and right rows.
-			Gtk.HBox hBox1 = new Gtk.HBox(false, 6);
-			hBox1.PackStart(label1, false, false, 6);
-			hBox1.PackStart(templateExtensionsTextBox, false, false, 6);
-			
-			this.VBox.PackStart(hBox1, false, false, 6);
-			
-			// set up the buttons and add them
-			this.DefaultResponse = (int) Gtk.ResponseType.Ok;
-			Gtk.Button cancelButton = new Gtk.Button(Gtk.Stock.Cancel);
-			Gtk.Button okButton = new Gtk.Button(Gtk.Stock.Ok);
-			okButton.Clicked += new EventHandler(AcceptEvent);
-			cancelButton.Clicked += new EventHandler(CancelEvent);
-			this.AddActionWidget (cancelButton, Gtk.ResponseType.Cancel);
-			this.AddActionWidget (okButton, (int) Gtk.ResponseType.Ok);
-		}
-	}
-}

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -13,17 +13,15 @@
 using MonoDevelop.Internal.Templates;
 using MonoDevelop.Core.Properties;
 using MonoDevelop.Core.AddIns.Codons;
-
 using MonoDevelop.Core.Services;
-
 using MonoDevelop.TextEditor;
 using MonoDevelop.TextEditor.Document;
 using MonoDevelop.Gui.Dialogs;
-
-using Gtk;
 using MonoDevelop.Gui.Widgets;
 using MonoDevelop.EditorBindings.FormattingStrategy;
 
+using Gtk;
+
 namespace MonoDevelop.EditorBindings.Gui.OptionPanels
 {
 	/// &lt;summary&gt;
@@ -33,12 +31,12 @@
 	{
 		BehaviorTextEditorPanelWidget widget;
 		
-		public override void LoadPanelContents()
+		public override void LoadPanelContents ()
 		{
 			Add (widget = new BehaviorTextEditorPanelWidget ((IProperties) CustomizationObject));
 		}
 		
-		public override bool StorePanelContents()
+		public override bool StorePanelContents ()
 		{
 			widget.Store ((IProperties) CustomizationObject);
 			return true;
@@ -51,27 +49,27 @@
 				StringParserService)ServiceManager.Services.GetService (typeof (StringParserService));
 			
 			// GTK controls
-			[Glade.Widget] Label			tabsGroupBoxLabel;
-			[Glade.Widget] Label			behaviourGroupBoxLabel;
-			[Glade.Widget] Label			tabSizeLabel;
-			[Glade.Widget] Label			indentSizeLabel;
-			[Glade.Widget] Label			indentLabel;
-			[Glade.Widget] CheckButton		autoinsertCurlyBraceCheckBox;
-			[Glade.Widget] CheckButton		hideMouseCursorCheckBox;
-			[Glade.Widget] CheckButton		caretBehindEOLCheckBox;
-			[Glade.Widget] CheckButton		autoInsertTemplatesCheckBox;
-			[Glade.Widget] CheckButton		convertTabsToSpacesCheckBox;
-			[Glade.Widget] RadioButton              noneIndentStyle;
-			[Glade.Widget] RadioButton              automaticIndentStyle;
-			[Glade.Widget] RadioButton              smartIndentStyle;
-			[Glade.Widget] SpinButton               indentAndTabSizeSpinButton;
+			[Glade.Widget] Label tabsGroupBoxLabel;
+			[Glade.Widget] Label behaviourGroupBoxLabel;
+			[Glade.Widget] Label tabSizeLabel;
+			[Glade.Widget] Label indentSizeLabel;
+			[Glade.Widget] Label indentLabel;
+			[Glade.Widget] CheckButton autoinsertCurlyBraceCheckBox;
+			[Glade.Widget] CheckButton hideMouseCursorCheckBox;
+			[Glade.Widget] CheckButton caretBehindEOLCheckBox;
+			[Glade.Widget] CheckButton autoInsertTemplatesCheckBox;
+			[Glade.Widget] CheckButton convertTabsToSpacesCheckBox;
+			[Glade.Widget] RadioButton noneIndentStyle;
+			[Glade.Widget] RadioButton automaticIndentStyle;
+			[Glade.Widget] RadioButton smartIndentStyle;
+			[Glade.Widget] SpinButton indentAndTabSizeSpinButton;
 			
 			public BehaviorTextEditorPanelWidget (IProperties CustomizationObject) :  
 				base (&quot;EditorBindings.glade&quot;, &quot;BehaviorTextEditorPanel&quot;)
 			{
 				// Set up Text
 
-				//FIXME: i8n the following Labels
+				//FIXME: i18n the following Labels
 				noneIndentStyle.Label =      &quot;None&quot;;
 				automaticIndentStyle.Label = &quot;Automatic&quot;; 
 				// FIXME: renable this when smart indent is back

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -1,5 +1,4 @@
 using Gtk;
-using GtkSharp;
 using GLib;
 
 using MonoDevelop.Gui;
@@ -14,9 +13,10 @@
 using System.IO;
 using System.Runtime.InteropServices;
 	
-namespace MonoDevelop.SourceEditor.Gui {
-
-	public enum SourceMarkerType {
+namespace MonoDevelop.SourceEditor.Gui
+{
+	public enum SourceMarkerType
+	{
 		SourceEditorBookmark,
 		BreakpointMark,
 		ExecutionMark
@@ -24,10 +24,12 @@
 
 	// This gives us a nice way to avoid the try/finally
 	// which is really long.
-	struct NoUndo : IDisposable {
+	struct NoUndo : IDisposable
+	{
 		SourceEditorBuffer b;
 		
-		public NoUndo (SourceEditorBuffer b) {
+		public NoUndo (SourceEditorBuffer b)
+		{
 			this.b = b;
 			b.BeginNotUndoableAction ();
 		}
@@ -40,10 +42,12 @@
 	
 	// This gives us a nice way to avoid the try/finally
 	// which is really long.
-	struct AtomicUndo : IDisposable {
+	struct AtomicUndo : IDisposable
+	{
 		SourceEditorBuffer b;
 		
-		public AtomicUndo (SourceEditorBuffer b) {
+		public AtomicUndo (SourceEditorBuffer b)
+		{
 			this.b = b;
 			b.BeginUserAction ();
 		}
@@ -54,8 +58,8 @@
 		}
 	}
 	
-	public class SourceEditorBuffer : SourceBuffer, IClipboardHandler {
-		
+	public class SourceEditorBuffer : SourceBuffer, IClipboardHandler
+	{	
 		SourceLanguagesManager slm = new SourceLanguagesManager ();
 		TextTag markup;
 		
@@ -97,7 +101,6 @@
 		
 		public void LoadText (string text, string mime)
 		{
-			
 			SourceLanguage lang = slm.GetLanguageFromMimeType (mime);
 			if (lang != null) 
 				Language = lang;
@@ -125,43 +128,51 @@
 		}
 
 #region IClipboardHandler
-		bool HasSelection {
+		bool HasSelection
+		{
 			get {
 				TextIter dummy, dummy2;
 				return GetSelectionBounds (out dummy, out dummy2);
 			}
 		}
 
-		public string GetSelectedText () {
+		public string GetSelectedText ()
+		{
 			if (HasSelection)
 			{
 				TextIter select1, select2;
 				GetSelectionBounds (out select1, out select2);
 				return GetText (select1, select2, true);
 			}
+			
 			return String.Empty;
 		}
 		
-		bool IClipboardHandler.EnableCut {
+		bool IClipboardHandler.EnableCut
+		{
 			get { return true; }
 		}
 		
-		bool IClipboardHandler.EnableCopy {
+		bool IClipboardHandler.EnableCopy
+		{
 			get { return true; }
 		}
 		
-		bool IClipboardHandler.EnablePaste {
+		bool IClipboardHandler.EnablePaste
+		{
 			get {
 				return true;
 				//return clipboard.WaitIsTextAvailable ();
 			}
 		}
 		
-		bool IClipboardHandler.EnableDelete {
+		bool IClipboardHandler.EnableDelete
+		{
 			get { return true; }
 		}
 		
-		bool IClipboardHandler.EnableSelectAll {
+		bool IClipboardHandler.EnableSelectAll
+		{
 			get { return true; }
 		}
 		
@@ -210,11 +221,10 @@
 #region Bookmark Operations
 		
 		//
-		// Ok, the GtkSourceView people made this extremely dificult because they took over
-		// the TextMark type for their SourceMarker, So i have to marshall for them. It is annoying
-		// I filed a bug.
+		// GtkSourceView made this difficult because they took over
+		// the TextMark type for their SourceMarker, so we have to marshall manually. 
 		//
-		// Again, this is retarded
+		// <A HREF="http://bugzilla.gnome.org/show_bug.cgi?id=132525">http://bugzilla.gnome.org/show_bug.cgi?id=132525</A>
 		//
 		[DllImport(&quot;gtksourceview-1.0&quot;)]
 		static extern IntPtr gtk_source_buffer_get_markers_in_region (IntPtr raw, ref Gtk.TextIter begin, ref Gtk.TextIter end);
@@ -286,7 +296,6 @@
 				g_slist_free (lst);
 
 			return fnd_marker;
-
 		}
 
 		public void ToggleBookmark (int linenum)
@@ -309,11 +318,11 @@
 			bool found_marker = false;
 			
 			//
-			// Ok, again, this is absurd. The problem is that the buffer owns the
+			// The problem is that the buffer owns the
 			// reference to the marker. So, if we use the nice Gtk# stuff, we get
 			// a problem when we dispose it later. Thus we must basically write this
-			// in C. It sucks. It really sucks.
-			//
+			// in C.
+			// FIXME: Is there a bug# for this?
 			
 			IntPtr current = lst;
 			while (current != IntPtr.Zero) {
@@ -336,12 +345,12 @@
 				return;
 			
 			switch (type.ToString ()) {
-			case &quot;ExecutionMark&quot;:
-				begin_line.LineOffset = 2;
-				break;
-			case &quot;BreakpointMark&quot;:
-				begin_line.LineOffset = 1;
-				break;
+				case &quot;ExecutionMark&quot;:
+					begin_line.LineOffset = 2;
+					break;
+				case &quot;BreakpointMark&quot;:
+					begin_line.LineOffset = 1;
+					break;
 			}
 
 			gtk_source_buffer_create_marker (Handle, null, type.ToString (), ref begin_line);
@@ -509,7 +518,6 @@
 		{
 			TextIter start = GetIterAtOffset (offset);
 			TextIter end = GetIterAtOffset (offset + length);
-
 			Delete (start, end);
 		}
 

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -1,5 +1,6 @@
 using System;
 using System.IO;
+using System.Runtime.InteropServices;
 
 using MonoDevelop.Gui;
 using MonoDevelop.Internal.Project;
@@ -8,20 +9,19 @@
 using MonoDevelop.Core.Services;
 using MonoDevelop.Services;
 using MonoDevelop.Core.AddIns.Codons;
-using System.Runtime.InteropServices;
-
-using Gtk;
-using GtkSharp;
-
 using MonoDevelop.Gui.Utils;
 using MonoDevelop.EditorBindings.Properties;
 using MonoDevelop.EditorBindings.FormattingStrategy;
-
 using MonoDevelop.Services;
 
-namespace MonoDevelop.SourceEditor.Gui {
-	public class SourceEditorDisplayBinding : IDisplayBinding {
+using Gtk;
 
+namespace MonoDevelop.SourceEditor.Gui
+{
+	public class SourceEditorDisplayBinding : IDisplayBinding
+	{
+		StringParserService sps = (StringParserService) ServiceManager.Services.GetService (typeof (StringParserService));
+		
 		static SourceEditorDisplayBinding ()
 		{
 			GtkSourceView.Init ();
@@ -34,8 +34,10 @@
 
 		public virtual bool CanCreateContentForMimeType (string mimetype)
 		{
-			if (mimetype == null) return false;
-			if (mimetype.StartsWith (&quot;text&quot;)) return true;
+			if (mimetype == null)
+				return false;
+			if (mimetype.StartsWith (&quot;text&quot;))
+				return true;
 			return false;
 		}
 		
@@ -54,30 +56,19 @@
 		
 		public virtual IViewContent CreateContentForLanguage (string language, string content)
 		{
-			SourceEditorDisplayBindingWrapper w = new SourceEditorDisplayBindingWrapper ();
-			
-			// HACK HACK
-			if (language == &quot;C#&quot;)
-				language = &quot;text/x-csharp&quot;;
-			else
-				language = &quot;text/plain&quot;;
-			
-			w.LoadString (language, content);
-			return w;
+			return CreateContentForLanguage (language, content, null);
 		}
 		
 		public virtual IViewContent CreateContentForLanguage (string language, string content, string new_file_name)
 		{
 			SourceEditorDisplayBindingWrapper w = new SourceEditorDisplayBindingWrapper ();
 			
-			// HACK HACK
+			// FIXME
 			if (language == &quot;C#&quot;)
 				language = &quot;text/x-csharp&quot;;
 			else
 				language = &quot;text/plain&quot;;
 			
-			StringParserService sps = (StringParserService)ServiceManager.Services.GetService (typeof (StringParserService));
-			
 			w.LoadString (language, sps.Parse (content));
 			return w;
 		}	
@@ -128,13 +119,11 @@
 		
 		public void JumpTo (int line, int column)
 		{
-			// NOTE: 0 based!
-			
+			// NOTE: 0 based!			
 			TextIter itr = se.Buffer.GetIterAtLine (line);
 			itr.LineOffset = column;
 			
-			se.Buffer.PlaceCursor (itr);
-			
+			se.Buffer.PlaceCursor (itr);		
 			se.View.ScrollMarkOnscreen (se.Buffer.InsertMark);
 			se.View.GrabFocus ();
 		}
@@ -161,8 +150,10 @@
 			this.IsDirty = se.Buffer.Modified;
 		}
 		
-		public override bool IsReadOnly {
+		public override bool IsReadOnly
+		{
 			get {
+				// FIXME
 				return false;
 			}
 		}
@@ -196,8 +187,7 @@
 		public void InsertAtCursor (string s)
 		{
 			se.Buffer.InsertAtCursor (s);
-			se.View.ScrollMarkOnscreen (se.Buffer.InsertMark);
-			
+			se.View.ScrollMarkOnscreen (se.Buffer.InsertMark);		
 		}
 		
 		public void LoadString (string mime, string val)
@@ -228,6 +218,7 @@
 			se.Buffer.Redo ();
 		}
 #endregion
+
 #region Status Bar Handling
 		IStatusBarService statusBarService = (IStatusBarService) ServiceManager.Services.GetService (typeof (IStatusBarService));
 		
@@ -281,9 +272,7 @@
 				iter.ForwardChar ();
 			}
 			
-			// NOTE: this is absurd, *I* should tell the status bar which numbers
-			// to print.
-			statusBarService.SetCaretPosition (col - 1, iter.Line, chr - 1);
+			statusBarService.SetCaretPosition (iter.Line + 1, col, chr);
 		}
 		
 		// This is false because we at first `toggle' it to set it to true
@@ -318,22 +307,27 @@
 		
 		void PropertiesChanged (object sender, PropertyEventArgs e)
  		{
+ 			// FIXME: do these seperately
 			se.View.ModifyFont (TextEditorProperties.Font);
 			se.View.ShowLineNumbers = TextEditorProperties.ShowLineNumbers;
 			se.Buffer.CheckBrackets = TextEditorProperties.ShowMatchingBracket;
 			se.View.ShowMargin = TextEditorProperties.ShowVerticalRuler;
+			
 			if (TextEditorProperties.VerticalRulerRow &gt; -1) {
 				se.View.Margin = (uint) TextEditorProperties.VerticalRulerRow;
 			} else {
 				se.View.Margin = (uint) 80;		// FIXME: should i be doing this on a bad vruller setting?
 			}
+			
 			if (TextEditorProperties.TabIndent &gt; -1) {
 				se.View.TabsWidth = (uint) TextEditorProperties.TabIndent;
 			} else {
-				se.View.TabsWidth = (uint) 8;	// FIXME: should i be doing this on a bad tabindent setting?
+				se.View.TabsWidth = (uint) 4;	// FIXME: should i be doing this on a bad tabindent setting?
 			}
+			
 			se.View.InsertSpacesInsteadOfTabs = TextEditorProperties.ConvertTabsToSpaces;
 			se.View.AutoIndent = (TextEditorProperties.IndentStyle == IndentStyle.Auto);
+			
 			//System.Console.WriteLine(e.Key + &quot; = &quot; + e.NewValue + &quot;(from &quot; + e.OldValue + &quot;)&quot; );
 					// The items below can't be done (since there is no support for it in gtksourceview)
 					// CANTDO: show spaces				Key = &quot;ShowSpaces&quot;
@@ -347,9 +341,8 @@
 					// TODO: Code Folding				Key = &quot;EnableFolding&quot;
 					// TODO: Double Buffering			Key = &quot;DoubleBuffer&quot;
 					// TODO: can move past EOL 			Key = &quot;CursorBehindEOL&quot;
-					// TODO: auot insert template		Key = &quot;AutoInsertTemplates&quot;	
+					// TODO: auto insert template		Key = &quot;AutoInsertTemplates&quot;	
 					// TODO: hide mouse while typing 	Key = &quot;HideMouseCursor&quot;
  		}
-
 	}
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -1,10 +1,10 @@
 using Gtk;
-using GtkSharp;
 using Gdk;
 
 using System;
 using System.IO;
 using System.Runtime.InteropServices;
+
 using MonoDevelop.Core.AddIns.Conditions;
 using MonoDevelop.Core.AddIns;
 using MonoDevelop.Internal.Templates;
@@ -14,27 +14,30 @@
 using MonoDevelop.EditorBindings.Properties;
 using MonoDevelop.EditorBindings.FormattingStrategy;
 using MonoDevelop.Gui.Utils;
-
 using MonoDevelop.Services;
 
-namespace MonoDevelop.SourceEditor.Gui {
-	public class SourceEditorView : SourceView, IFormattableDocument {
-		
-		private static GLib.GType type;
-			
-		                SourceEditorBuffer buf;
-		public readonly SourceEditor       ParentEditor;
-
+namespace MonoDevelop.SourceEditor.Gui
+{
+	public class SourceEditorView : SourceView, IFormattableDocument
+	{	
+		private static GLib.GType gtype;
+		public readonly SourceEditor ParentEditor;
+		internal IFormattingStrategy fmtr;
+		SourceEditorBuffer buf;
 		int lineToMark = -1;
-
 		CompletionWindow completionWindow;
 		
-		static SourceEditorView ()
+		public static new GLib.GType GType
 		{
-			type = RegisterGType (typeof (SourceEditorView));
+			get
+			{
+				if (gtype == GLib.GType.Invalid)
+					gtype = RegisterGType (typeof (SourceEditorView));
+				return gtype;
+			}
 		}
 		
-		public SourceEditorView (SourceEditorBuffer buf, SourceEditor parent) : base (type)
+		public SourceEditorView (SourceEditorBuffer buf, SourceEditor parent) : base (GType)
 		{
 			this.ParentEditor = parent;
 			this.TabsWidth = 4;
@@ -54,7 +57,7 @@
 			
 			if (e.Event.Window == GetWindow (Gtk.TextWindowType.Left)) {
 				int x, y;
-				WindowToBufferCoords (Gtk.TextWindowType.Left, (int)e.Event.X, (int)e.Event.Y, out x, out y);
+				WindowToBufferCoords (Gtk.TextWindowType.Left, (int) e.Event.X, (int) e.Event.Y, out x, out y);
 				TextIter line;
 				int top;
 
@@ -144,7 +147,7 @@
 			switch ((char)key) {
 				case ' ':
 					if (1 == 1) {
-						string word = GetWordBeforeCaret();
+						string word = GetWordBeforeCaret ();
 						if (word != null) {
 							CodeTemplateGroup templateGroup = CodeTemplateLoader.GetTemplateGroupPerFilename(ParentEditor.DisplayBinding.ContentName);
 							
@@ -198,14 +201,14 @@
 			return ++offset;
 		}
 
-		public string GetWordBeforeCaret()
+		public string GetWordBeforeCaret ()
 		{
 			int offset = buf.GetIterAtMark (buf.InsertMark).Offset;
 			int start = FindPrevWordStart (buf.Text, offset);
 			return buf.Text.Substring (start, offset - start);
 		}
 		
-		public int DeleteWordBeforeCaret()
+		public int DeleteWordBeforeCaret ()
 		{
 			int offset = buf.GetIterAtMark (buf.InsertMark).Offset;
 			int start = FindPrevWordStart (buf.Text, offset);
@@ -214,13 +217,14 @@
 		}
 
 
-		public void InsertTemplate(CodeTemplate template)
+		public void InsertTemplate (CodeTemplate template)
 		{
-			int newCaretOffset   = buf.GetIterAtMark (buf.InsertMark).Offset;
-			string word = GetWordBeforeCaret().Trim();
-			if (word.Length &gt; 0) {
-				newCaretOffset = DeleteWordBeforeCaret();
-			}
+			int newCaretOffset = buf.GetIterAtMark (buf.InsertMark).Offset;
+			string word = GetWordBeforeCaret ().Trim ();
+			
+			if (word.Length &gt; 0)
+				newCaretOffset = DeleteWordBeforeCaret ();
+			
 			int finalCaretOffset = newCaretOffset;
 			
 			for (int i =0; i &lt; template.Text.Length; ++i) {
@@ -244,6 +248,7 @@
 						break;
 				}
 			}
+			
 			buf.PlaceCursor (buf.GetIterAtOffset (finalCaretOffset));
 		}
 
@@ -369,15 +374,22 @@
 			Buffer.Insert (begin, txt);
 		}
 		
-		IndentStyle IFormattableDocument.IndentStyle {
+		IndentStyle IFormattableDocument.IndentStyle
+		{
 			get { return TextEditorProperties.IndentStyle; }
 		}
-		bool IFormattableDocument.AutoInsertCurlyBracket {
+		
+		bool IFormattableDocument.AutoInsertCurlyBracket
+		{
 			get { return TextEditorProperties.AutoInsertCurlyBracket; }
 		}
 		
-		string IFormattableDocument.TextContent { get { return Buffer.Text; } }
-		int IFormattableDocument.TextLength { get { return Buffer.EndIter.Offset; } }
+		string IFormattableDocument.TextContent
+		{ get { return Buffer.Text; } }
+		
+		int IFormattableDocument.TextLength
+		{ get { return Buffer.EndIter.Offset; } }
+		
 		char IFormattableDocument.GetCharAt (int offset)
 		{
 			TextIter it = Buffer.GetIterAtOffset (offset);
@@ -389,7 +401,8 @@
 			Buffer.Insert (Buffer.GetIterAtOffset (offset), text);
 		}
 		
-		string IFormattableDocument.IndentString {
+		string IFormattableDocument.IndentString
+		{
 			get { return !InsertSpacesInsteadOfTabs ? &quot;\t&quot; : new string (' ', (int) TabsWidth); }
 		}
 		
@@ -401,16 +414,13 @@
 			openingLine = offset == -1 ? -1 : Buffer.GetIterAtOffset (offset).Line;
 			return offset;
 		}
+		
 		void IFormattableDocument.GetLineLengthInfo (int ln, out int offset, out int len)
 		{
 			TextIter begin = Buffer.GetIterAtLine (ln);
 			offset = begin.Offset;
 			len = begin.CharsInLine;
 		}
-		
-		internal IFormattingStrategy fmtr;
-		
-
 #endregion
 	}
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -1,27 +1,33 @@
 using Gtk;
-using GtkSharp;
-using Gdk;
 
 using System;
-using System.IO;
 using System.Runtime.InteropServices;
 	
-namespace MonoDevelop.SourceEditor.Gui {
-	public class SourceEditor : ScrolledWindow {
-		
+namespace MonoDevelop.SourceEditor.Gui
+{
+	public class SourceEditor : ScrolledWindow
+	{	
 		public readonly SourceEditorBuffer Buffer;
 		public readonly SourceEditorView View;
 		public readonly SourceEditorDisplayBindingWrapper DisplayBinding;
+		private static GLib.GType gtype;
 		
-		public SourceEditor (SourceEditorDisplayBindingWrapper bind) : base ()
+		public static new GLib.GType GType
 		{
+			get
+			{
+				if (gtype == GLib.GType.Invalid)
+					gtype = RegisterGType (typeof (SourceEditor));
+				return gtype;
+			}
+		}
+		
+		public SourceEditor (SourceEditorDisplayBindingWrapper bind) : base (GType)
+		{
 			ShadowType = Gtk.ShadowType.In;
 			DisplayBinding = bind;
-			Buffer = new SourceEditorBuffer ();
-			
+			Buffer = new SourceEditorBuffer ();	
 			View = new SourceEditorView (Buffer, this);
-			
-
 			Buffer.Highlight = true;
 			
 			View.SetMarkerPixbuf (&quot;SourceEditorBookmark&quot;, new Gdk.Pixbuf (drag_icon_xpm));
@@ -41,7 +47,8 @@
 			View.ClearExecutingAt (linenumber);
 		}
 
-		public string Text {
+		public string Text
+		{
 			get { return Buffer.Text; }
 			set { Buffer.Text = value; }
 		}

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Makefile.am
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Makefile.am	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Makefile.am	2004-03-12 00:15:29 UTC (rev 1155)
@@ -21,7 +21,8 @@
 ./Gui/OptionPanels/MarkersTextEditorPanel.cs \
 ./Gui/OptionPanels/CodeTemplatePanel.cs \
 ./Gui/OptionPanels/GeneralTextEditorPanel.cs \
-./Gui/EditTemplateGroupDialog.cs \
+./Gui/Dialogs/EditTemplateGroupDialog.cs \
+./Gui/Dialogs/ExportProjectToHtmlDialog.cs \
 ./Gui/Dialogs/GotoLineNumberDialog.cs \
 ./Gui/Dialogs/ReplaceDialog.cs \
 ./Gui/Dialogs/ReplaceInFilesDialog.cs \

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Components/StatusBar/SdStatusBar.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Components/StatusBar/SdStatusBar.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Components/StatusBar/SdStatusBar.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -16,23 +16,27 @@
 		Statusbar txtStatusBarPanel    = new Statusbar ();
 		Statusbar cursorStatusBarPanel = new Statusbar ();
 		Statusbar modeStatusBarPanel   = new Statusbar ();
+		bool cancelEnabled;
+		const int ctx = 1;
 		private static GLib.GType gtype;
 		
-		public Statusbar CursorStatusBarPanel {
+		/*
+		public Statusbar CursorStatusBarPanel
+		{
 			get {
 				return cursorStatusBarPanel;
 			}
-		}
+		}*/
 		
-		public Statusbar ModeStatusBarPanel {
+		public Statusbar ModeStatusBarPanel
+		{
 			get {
 				return modeStatusBarPanel;
 			}
 		}
-	
-		bool cancelEnabled;
 		
-		public bool CancelEnabled {
+		public bool CancelEnabled
+		{
 			get {
 				return cancelEnabled;
 			}
@@ -41,7 +45,8 @@
 			}
 		}
 
-		public static new GLib.GType GType {
+		public static new GLib.GType GType
+		{
 			get {
 				if (gtype == GLib.GType.Invalid)
 					gtype = RegisterGType (typeof (SdStatusBar));
@@ -66,57 +71,62 @@
 		
 		public void ShowErrorMessage(string message)
 		{
-			txtStatusBarPanel.Push (1, &quot;Error : &quot; + message);
+			txtStatusBarPanel.Push (ctx, &quot;Error : &quot; + message);
 		}
 		
 		public void ShowErrorMessage(Image image, string message)
 		{
-			txtStatusBarPanel.Push (1, &quot;Error : &quot; + message);
+			txtStatusBarPanel.Push (ctx, &quot;Error : &quot; + message);
 		}
 		
-		public void SetMessage(string message)
+		public void SetCursorPosition (int ln, int col, int ch)
 		{
-			txtStatusBarPanel.Push (1, message);
+			// FIXME: I18N
+			// FIXME: Properly space, perhaps 3 seperate Labels
+			cursorStatusBarPanel.Push (ctx, String.Format (&quot;ln {0} col {1} ch {2}&quot;, ln, col, ch));
 		}
 		
-		public void SetMessage(Image image, string message)
+		public void SetMessage (string message)
 		{
-			txtStatusBarPanel.Push (1, message);
+			txtStatusBarPanel.Push (ctx, message);
 		}
 		
+		public void SetMessage (Image image, string message)
+		{
+			txtStatusBarPanel.Push (ctx, message);
+		}
+		
 		// Progress Monitor implementation
-		string oldMessage = null;
-		public void BeginTask(string name, int totalWork)
+		public void BeginTask (string name, int totalWork)
 		{
-			//oldMessage = txtStatusBarPanel.Pop (1);
-			SetMessage(name);
-			//statusProgressBar.Maximum = totalWork;
+			SetMessage (name);
 			this.Progress.Visible = true;
 		}
 		
-		public void Worked(int work, string status)
+		public void Worked (int work, string status)
 		{
 			this.Progress.Fraction = (double) work;
 			this.Progress.Text = status;
 		}
 		
-		public void Done()
+		public void Done ()
 		{
-			SetMessage(oldMessage);
-			oldMessage = null;
+			txtStatusBarPanel.Pop (ctx);
 			this.Progress.Visible = false;
 		}
 		
-		public bool Canceled {
+		public bool Canceled
+		{
 			get {
-				return oldMessage == null;
+				return true;
 			}
 			set {
-				Done();
+				Done ();
 			}
 		}
 		
-		public string TaskName {
+		public string TaskName
+		{
 			get {
 				return &quot;&quot;;
 			}

Modified: trunk/MonoDevelop/src/Main/Base/Services/StatusBar/DefaultStatusBarService.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Services/StatusBar/DefaultStatusBarService.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/Main/Base/Services/StatusBar/DefaultStatusBarService.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -56,28 +56,24 @@
 			}
 		}
 		
-		public void SetCaretPosition(int x, int y, int charOffset)
+		public void SetCaretPosition (int ln, int col, int ch)
 		{
-			StringParserService stringParserService = (StringParserService)ServiceManager.Services.GetService(typeof(StringParserService));
-			statusBar.CursorStatusBarPanel.Push (1, stringParserService.Parse(&quot;${res:StatusBarService.CursorStatusBarPanelText}&quot;, 
-			                                                                new string[,] { {&quot;Line&quot;, String.Format(&quot;{0,-10}&quot;, y + 1)}, 
-			                                                                                {&quot;Column&quot;, String.Format(&quot;{0,-5}&quot;, x + 1)}, 
-			                                                                                {&quot;Character&quot;, String.Format(&quot;{0,-5}&quot;, charOffset + 1)}}));
+			statusBar.SetCursorPosition (ln, col, ch);                                                                  
 		}
 		
-		public void SetInsertMode(bool insertMode)
+		public void SetInsertMode (bool insertMode)
 		{
 			StringParserService stringParserService = (StringParserService)ServiceManager.Services.GetService(typeof(StringParserService));
 			statusBar.ModeStatusBarPanel.Push (1, insertMode ? stringParserService.Parse(&quot;${res:StatusBarService.CaretModes.Insert}&quot;) : stringParserService.Parse(&quot;${res:StatusBarService.CaretModes.Overwrite}&quot;));
 		}
 		
-		public void ShowErrorMessage(string message)
+		public void ShowErrorMessage (string message)
 		{
 			Debug.Assert(statusBar != null);
 			statusBar.ShowErrorMessage(stringParserService.Parse(message));
 		}
 		
-		public void SetMessage(string message)
+		public void SetMessage (string message)
 		{
 			Debug.Assert(statusBar != null);
 			lastMessage = message;

Modified: trunk/MonoDevelop/src/Main/Base/Services/StatusBar/IStatusBarService.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Services/StatusBar/IStatusBarService.cs	2004-03-12 00:06:25 UTC (rev 1154)
+++ trunk/MonoDevelop/src/Main/Base/Services/StatusBar/IStatusBarService.cs	2004-03-12 00:15:29 UTC (rev 1155)
@@ -30,8 +30,8 @@
 		void SetMessage(string message);					
 		//void SetMessage(Image image, string message);
 		
-		void SetCaretPosition(int x, int y, int charOffset);
-		void SetInsertMode(bool insertMode);
+		void SetCaretPosition (int ln, int col, int ch);
+		void SetInsertMode (bool insertMode);
 		
 		void RedrawStatusbar();
 	}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000760.html">[Monodevelop-patches-list] r1154 - trunk/MonoDevelop/src/Libraries/CsVbRefactory
</A></li>
	<LI>Next message: <A HREF="000762.html">[Monodevelop-patches-list] r1156 - trunk/MonoDevelop/build/data/templates/file/CSharp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#761">[ date ]</a>
              <a href="thread.html#761">[ thread ]</a>
              <a href="subject.html#761">[ subject ]</a>
              <a href="author.html#761">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
