<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1893 - in trunk/MonoDevelop/Core: . src/Libraries/MonoDevelop.Core src/Libraries/MonoDevelop.Core/Services
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1893%20-%20in%20trunk/MonoDevelop/Core%3A%20.%20src/Libraries/MonoDevelop.Core%20src/Libraries/MonoDevelop.Core/Services&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001499.html">
   <LINK REL="Next"  HREF="001501.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1893 - in trunk/MonoDevelop/Core: . src/Libraries/MonoDevelop.Core src/Libraries/MonoDevelop.Core/Services</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1893%20-%20in%20trunk/MonoDevelop/Core%3A%20.%20src/Libraries/MonoDevelop.Core%20src/Libraries/MonoDevelop.Core/Services&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1893 - in trunk/MonoDevelop/Core: . src/Libraries/MonoDevelop.Core src/Libraries/MonoDevelop.Core/Services">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Mon Jul  5 01:30:43 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001499.html">[Monodevelop-patches-list] r1892 - in trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding: . Gui
</A></li>
        <LI>Next message: <A HREF="001501.html">[Monodevelop-patches-list] r1894 - in trunk/MonoDevelop/Core/src: Libraries/MonoDevelop.Core/Services Main/Base Main/Base/Internal/Codons/MenuItems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1500">[ date ]</a>
              <a href="thread.html#1500">[ thread ]</a>
              <a href="subject.html#1500">[ subject ]</a>
              <a href="author.html#1500">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-07-05 01:30:43 -0400 (Mon, 05 Jul 2004)
New Revision: 1893

Added:
   trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs.in
Removed:
   trunk/MonoDevelop/Core/libmonodevelop/
   trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs
Modified:
   trunk/MonoDevelop/Core/ChangeLog
   trunk/MonoDevelop/Core/Makefile.am
   trunk/MonoDevelop/Core/configure.in
   trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/ChangeLog
   trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Makefile.am
Log:
remove libmonodevelop, and use Mono.Posix.Catalog


Modified: trunk/MonoDevelop/Core/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/ChangeLog	2004-07-04 19:08:57 UTC (rev 1892)
+++ trunk/MonoDevelop/Core/ChangeLog	2004-07-05 05:30:43 UTC (rev 1893)
@@ -1,3 +1,9 @@
+2004-07-05  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at off.net</A>&gt;
+
+	* configure.in:
+	* Makefile.am:
+	* libmonodevelop: Removed libmonodevelop.
+
 2004-07-04  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at off.net</A>&gt;
 
 	* *: Fixup to work on macosx OOB, at least a bit better.

Modified: trunk/MonoDevelop/Core/Makefile.am
===================================================================
--- trunk/MonoDevelop/Core/Makefile.am	2004-07-04 19:08:57 UTC (rev 1892)
+++ trunk/MonoDevelop/Core/Makefile.am	2004-07-05 05:30:43 UTC (rev 1893)
@@ -1,6 +1,6 @@
 # leave gdldock first
 # (mkdir ../../build/bin/ hack)
-SUBDIRS = gdldock libmonodevelop src build data po
+SUBDIRS = gdldock src build data po
 
 bin_SCRIPTS = monodevelop
 

Modified: trunk/MonoDevelop/Core/configure.in
===================================================================
--- trunk/MonoDevelop/Core/configure.in	2004-07-04 19:08:57 UTC (rev 1892)
+++ trunk/MonoDevelop/Core/configure.in	2004-07-05 05:30:43 UTC (rev 1893)
@@ -119,7 +119,6 @@
 gdldock/sources/Makefile
 gdldock/sources/gdl/Makefile
 gdldock/gdl/gdl-sharp.dll.config
-libmonodevelop/Makefile
 src/Makefile
 src/AddIns/Makefile
 src/AddIns/BackendBindings/Makefile

Modified: trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/ChangeLog	2004-07-04 19:08:57 UTC (rev 1892)
+++ trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/ChangeLog	2004-07-05 05:30:43 UTC (rev 1893)
@@ -1,3 +1,11 @@
+2004-07-05  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at off.net</A>&gt;
+
+	* Services/GettextCatalog.cs: removed
+	* Services/GettextCatalog.cs.in: Added, this is a passthru to
+	Mono.Posix.Catalog. We are using the .in so that the locale dir is
+	specified properly.
+	* Makefile.am: Add .cs.in rules to generate, etc.
+
 2004-07-02  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at off.net</A>&gt;
 
 	* Services/FileUtilityService.cs: remove some unneeded code, and

Modified: trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Makefile.am
===================================================================
--- trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Makefile.am	2004-07-04 19:08:57 UTC (rev 1892)
+++ trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Makefile.am	2004-07-05 05:30:43 UTC (rev 1893)
@@ -55,8 +55,7 @@
 ./AddIns/TypeNotFoundException.cs \
 ./AddIns/AddInInitializeException.cs \
 ./AddIns/AddInCollection.cs \
-./AddIns/AddInSignatureException.cs \
-./Services/GettextCatalog.cs
+./AddIns/AddInSignatureException.cs
 
 build_sources = $(addprefix $(srcdir)/, $(FILES))
 
@@ -69,18 +68,23 @@
 
 DLL = MonoDevelop.Core.dll
 
-REFS = /r:System.Drawing.dll
+REFS = /r:System.Drawing.dll \
+/r:Mono.Posix.dll
 
 all: $(DLL)
 
-$(DLL): $(build_sources) $(build_resources)
+Services/GettextCatalog.cs: Services/GettextCatalog.cs.in
+	sed -e 's,@''prefix@,$(prefix),g' $(srcdir)/$@.in &gt; $@.tmp
+	mv $@.tmp $@
+
+$(DLL): $(build_sources) $(build_resources) Services/GettextCatalog.cs
 	mcs /debug /out:$(DLL) /target:library $(REFS) /define:LINUX $(COMPILE_RESOURCES) \
-	$(build_sources) &amp;&amp; cp $(DLL) ../../../build/bin/.
+	$(build_sources) Services/GettextCatalog.cs &amp;&amp; cp $(DLL) ../../../build/bin/.
 
 assemblydir = $(libdir)/monodevelop/bin
 assembly_DATA = $(DLL)
 
-CLEANFILES = $(DLL)
+CLEANFILES = $(DLL) Services/GettextCatalog.cs
 
-EXTRA_DIST = $(FILES)
+EXTRA_DIST = $(FILES) Services/GettextCatalog.cs.in
 

Deleted: trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs
===================================================================
--- trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs	2004-07-04 19:08:57 UTC (rev 1892)
+++ trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs	2004-07-05 05:30:43 UTC (rev 1893)
@@ -1,82 +0,0 @@
-/*
- * Copyright (C) 2004 Jorn Baayen &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jorn at nl.linux.org</A>&gt;
- * 
- * Modified by Todd Berman &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt; to fit with MonoDevelop.
- *
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License as
- * published by the Free Software Foundation; either version 2 of the
- * License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- * General Public License for more details.
- *
- * You should have received a copy of the GNU General Public
- * License along with this program; if not, write to the
- * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
- * Boston, MA 02111-1307, USA.
- *
- * !!! Note that this class has to have the same API as the one
- *     from GNU.Gettext.dll, because otherwise the strings won't
- *     be picked up by update-po.
- */
-
-using System;
-using System.Runtime.InteropServices;
-
-using MonoDevelop.Core.Services;
-using MonoDevelop.Core.AddIns;
-
-namespace MonoDevelop.Services
-{
-
-	public class GettextCatalog
-	{
-
-		[DllImport (&quot;libmonodevelop&quot;)]
-		private static extern void intl_init (string package);
-	
-		static GettextCatalog ()
-		{
-			intl_init (&quot;monodevelop&quot;);
-		}
-	
-		[DllImport (&quot;libmonodevelop&quot;)]
-		private static extern IntPtr intl_get_string (IntPtr sptr);
-	
-		public static string GetString (string str)
-		{
-			IntPtr inptr = Marshal.StringToHGlobalAuto (str);
-			IntPtr sptr = intl_get_string (inptr);
-			Marshal.FreeHGlobal (inptr);
-			if (inptr == sptr)
-				return str;
-			else
-				return Marshal.PtrToStringAuto (sptr);
-		}
-	
-		[DllImport (&quot;libmonodevelop&quot;)]
-		private static extern IntPtr intl_get_plural_string (IntPtr singular,
-								     IntPtr plural,
-								     int n);
-	
-		public static string GetPluralString (string singular,
-			    	 	              string plural,
-					              int n)
-		{
-			IntPtr singptr = Marshal.StringToHGlobalAuto (singular);
-			IntPtr plurptr = Marshal.StringToHGlobalAuto (plural);
-			IntPtr sptr = intl_get_plural_string (singptr, plurptr, n);
-			Marshal.FreeHGlobal (singptr);
-			Marshal.FreeHGlobal (plurptr);
-			if (sptr == singptr)
-				return singular;
-			else if (sptr == plurptr)
-				return plural;
-			else
-				return Marshal.PtrToStringAuto (sptr);
-		}
-	}
-}

Copied: trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs.in (from rev 1888, trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs)
===================================================================
--- trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs	2004-07-04 04:48:06 UTC (rev 1888)
+++ trunk/MonoDevelop/Core/src/Libraries/MonoDevelop.Core/Services/GettextCatalog.cs.in	2004-07-05 05:30:43 UTC (rev 1893)
@@ -0,0 +1,57 @@
+/*
+ * Copyright (C) 2004 Jorn Baayen &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jorn at nl.linux.org</A>&gt;
+ * 
+ * Modified by Todd Berman &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt; to fit with MonoDevelop.
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License as
+ * published by the Free Software Foundation; either version 2 of the
+ * License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public
+ * License along with this program; if not, write to the
+ * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
+ * Boston, MA 02111-1307, USA.
+ *
+ * !!! Note that this class has to have the same API as the one
+ *     from GNU.Gettext.dll, because otherwise the strings won't
+ *     be picked up by update-po.
+ */
+
+using System;
+using System.Runtime.InteropServices;
+
+using MonoDevelop.Core.Services;
+using MonoDevelop.Core.AddIns;
+
+using Mono.Posix;
+
+namespace MonoDevelop.Services
+{
+
+	public class GettextCatalog
+	{
+
+		static GettextCatalog ()
+		{
+			Catalog.Init (&quot;monodevelop&quot;, &quot;@prefix@/share/locale&quot;);
+		}
+	
+		public static string GetString (string str)
+		{
+			return Catalog.GetString (str);
+		}
+	
+		public static string GetPluralString (string singular,
+			    	 	              string plural,
+					              int n)
+		{
+			return Catalog.GetPluralString (singular, plural, n);
+		}
+	}
+}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001499.html">[Monodevelop-patches-list] r1892 - in trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding: . Gui
</A></li>
	<LI>Next message: <A HREF="001501.html">[Monodevelop-patches-list] r1894 - in trunk/MonoDevelop/Core/src: Libraries/MonoDevelop.Core/Services Main/Base Main/Base/Internal/Codons/MenuItems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1500">[ date ]</a>
              <a href="thread.html#1500">[ thread ]</a>
              <a href="subject.html#1500">[ subject ]</a>
              <a href="author.html#1500">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
