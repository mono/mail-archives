<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1946 - in branches/MonoDevelop-plan-43: . src/Plugins/Content src/Plugins/Node src/Plugins/Workbench
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1946%20-%20in%20branches/MonoDevelop-plan-43%3A%20.%20src/Plugins/Content%20src/Plugins/Node%20src/Plugins/Workbench&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001552.html">
   <LINK REL="Next"  HREF="001554.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1946 - in branches/MonoDevelop-plan-43: . src/Plugins/Content src/Plugins/Node src/Plugins/Workbench</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1946%20-%20in%20branches/MonoDevelop-plan-43%3A%20.%20src/Plugins/Content%20src/Plugins/Node%20src/Plugins/Workbench&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1946 - in branches/MonoDevelop-plan-43: . src/Plugins/Content src/Plugins/Node src/Plugins/Workbench">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Mon Aug 16 11:39:04 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001552.html">[Monodevelop-patches-list] r1945 - in branches/MonoDevelop-plan-43/src: Libraries Libraries/SharpRefactory Libraries/SharpRefactory/CodeDOM Libraries/SharpRefactory/Lexer Libraries/SharpRefactory/Lexer/Reader Libraries/SharpRefactory/Lexer/Specials Libraries/SharpRefactory/Parser Libraries/SharpRefactory/Parser/AST Libraries/SharpRefactory/Parser/AST/Expressions Libraries/SharpRefactory/Parser/AST/GlobalScope Libraries/SharpRefactory/Parser/AST/Statements Libraries/SharpRefactory/Parser/AST/TypeLevel Libraries/SharpRefactory/Parser/generated Libraries/SharpRefactory/Parser/generated/keywordlist Libraries/SharpRefactory/PrettyPrinter Libraries/SharpRefactory/VBConverter Plugins Plugins/CSharp Plugins/Parser Plugins/Parser/Collections Plugins/Parser/Implementations Plugins/Parser/ParserService Plugins/Parser/PersistenceLayer Plugins/Parser/ReflectionLayer
</A></li>
        <LI>Next message: <A HREF="001554.html">[Monodevelop-patches-list] r1947 - in branches/MonoDevelop-plan-43: . src/Plugins/Node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1553">[ date ]</a>
              <a href="thread.html#1553">[ thread ]</a>
              <a href="subject.html#1553">[ subject ]</a>
              <a href="author.html#1553">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jzwart
Date: 2004-08-16 11:39:04 -0400 (Mon, 16 Aug 2004)
New Revision: 1946

Modified:
   branches/MonoDevelop-plan-43/ChangeLog
   branches/MonoDevelop-plan-43/src/Plugins/Content/ContentManager.cs
   branches/MonoDevelop-plan-43/src/Plugins/Content/content.ui
   branches/MonoDevelop-plan-43/src/Plugins/Node/Buffer.cs
   branches/MonoDevelop-plan-43/src/Plugins/Workbench/workbench.ui
Log:
2004-08-16  Jeroen Zwartepoorte  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jeroen at xs4all.nl</A>&gt;

	* src/Plugins/Workbench/workbench.ui: remove quit action from toolbar.
	* src/Plugins/Node/Buffer.cs: add some more bits.
	* src/Plugins/Content/content.ui: add save button to toolbar.
	* src/Plugins/Content/ContentManager.cs: show message dialog when there
	aren't any FileNode's for a file type.



Modified: branches/MonoDevelop-plan-43/ChangeLog
===================================================================
--- branches/MonoDevelop-plan-43/ChangeLog	2004-08-15 21:12:38 UTC (rev 1945)
+++ branches/MonoDevelop-plan-43/ChangeLog	2004-08-16 15:39:04 UTC (rev 1946)
@@ -1,3 +1,11 @@
+2004-08-16  Jeroen Zwartepoorte  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jeroen at xs4all.nl</A>&gt;
+
+	* src/Plugins/Workbench/workbench.ui: remove quit action from toolbar.
+	* src/Plugins/Node/Buffer.cs: add some more bits.
+	* src/Plugins/Content/content.ui: add save button to toolbar.
+	* src/Plugins/Content/ContentManager.cs: show message dialog when there
+	aren't any FileNode's for a file type.
+
 2004-08-15  Jeroen Zwartepoorte  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">jeroen at xs4all.nl</A>&gt;
 
 	* src/Plugins/plugins.build: add csharp.build.

Modified: branches/MonoDevelop-plan-43/src/Plugins/Content/ContentManager.cs
===================================================================
--- branches/MonoDevelop-plan-43/src/Plugins/Content/ContentManager.cs	2004-08-15 21:12:38 UTC (rev 1945)
+++ branches/MonoDevelop-plan-43/src/Plugins/Content/ContentManager.cs	2004-08-16 15:39:04 UTC (rev 1946)
@@ -37,8 +37,13 @@
 			action = new Action (&quot;FileOpenAction&quot;, &quot;_Open...&quot;,
 					     &quot;Open a file&quot;, Gtk.Stock.Open);
 			action.Activated += new EventHandler (OnFileOpen);
-			group.Add (action);
+			group.Add (action, &quot;&lt;control&gt;o&quot;);
 		
+			action = new Action (&quot;FileSaveAction&quot;, &quot;_Save&quot;,
+					     &quot;Save the current file&quot;, Gtk.Stock.Save);
+			action.Activated += new EventHandler (OnFileSave);
+			group.Add (action, &quot;&lt;control&gt;s&quot;);
+		
 			Workbench.Workbench.AddActionGroup (group);
 			Workbench.Workbench.AddUiFromFile (&quot;content.ui&quot;);
 		}
@@ -69,11 +74,22 @@
 
 			// Find a FileNode Type for the specified mimetype.
 			FileNodeEntry entry = FileNode.FindFileNodeType (mimetype);
-			// FIXME: if the mimetype is of type text/* and there's no specific node for it,
-			// fallback to text/plain and try to open that.
+			// Fallback to text/plain if there is no specific node.
+			if (entry == null &amp;&amp; mimetype.StartsWith (&quot;text/&quot;))
+				entry = FileNode.FindFileNodeType (&quot;text/plain&quot;);
 			if (entry == null) {
-				// FIXME: popup a dialog saying there are no viewers for this mimetype.
 				log.Debug (&quot;No matching FileNode found for mimetype \&quot;&quot; + mimetype + &quot;\&quot;&quot;);
+				string msg = &quot;Could not open the file \&quot;&quot; + fcd.Filename +
+					     &quot;\&quot; because there is no support for this type of file&quot; +
+					     &quot; (&quot; + mimetype + &quot;).&quot;;
+				MessageDialog md = new MessageDialog ((Window)Workbench.Workbench.ActiveWorkbench,
+								      DialogFlags.Modal | DialogFlags.DestroyWithParent,
+								      MessageType.Error, ButtonsType.Ok,
+								      msg);
+				md.DefaultResponse = ResponseType.Ok;
+				md.Resizable = false;
+				md.Run ();
+				md.Destroy ();
 				return;
 			}
 
@@ -105,6 +121,10 @@
 			}
 		}
 	
+		private void OnFileSave (object obj, EventArgs e)
+		{
+		}
+
 		////////////////////////////////////////////////////////////////////////
 		// Static methods
 		////////////////////////////////////////////////////////////////////////

Modified: branches/MonoDevelop-plan-43/src/Plugins/Content/content.ui
===================================================================
--- branches/MonoDevelop-plan-43/src/Plugins/Content/content.ui	2004-08-15 21:12:38 UTC (rev 1945)
+++ branches/MonoDevelop-plan-43/src/Plugins/Content/content.ui	2004-08-16 15:39:04 UTC (rev 1946)
@@ -4,10 +4,17 @@
 		&lt;placeholder name=&quot;FileOpenPlaceholder&quot;&gt;
 			&lt;menuitem name=&quot;FileOpen&quot; action=&quot;FileOpenAction&quot;/&gt;
 		&lt;/placeholder&gt;
+		&lt;placeholder name=&quot;FileSavePlaceholder&quot;&gt;
+			&lt;separator/&gt;
+			&lt;menuitem name=&quot;FileSave&quot; action=&quot;FileSaveAction&quot;/&gt;
+		&lt;/placeholder&gt;
 	&lt;/menu&gt;
 &lt;/menubar&gt;
 &lt;toolbar name=&quot;toolbar&quot;&gt;
 	&lt;placeholder name=&quot;FileOpenPlaceholder&quot;&gt;
 		&lt;toolitem name=&quot;FileOpenButton&quot; action=&quot;FileOpenAction&quot;/&gt;
 	&lt;/placeholder&gt;
+	&lt;placeholder name=&quot;FileSavePlaceholder&quot;&gt;
+		&lt;toolitem name=&quot;FileSaveButton&quot; action=&quot;FileSaveAction&quot;/&gt;
+	&lt;/placeholder&gt;
 &lt;/toolbar&gt;

Modified: branches/MonoDevelop-plan-43/src/Plugins/Node/Buffer.cs
===================================================================
--- branches/MonoDevelop-plan-43/src/Plugins/Node/Buffer.cs	2004-08-15 21:12:38 UTC (rev 1945)
+++ branches/MonoDevelop-plan-43/src/Plugins/Node/Buffer.cs	2004-08-16 15:39:04 UTC (rev 1946)
@@ -14,7 +14,9 @@
 using Gnome.Vfs;
 
 namespace MonoDevelop.Node {
-	public delegate byte[] BufferContentCallback (Buffer buffer);
+	public delegate void BufferChanged (Buffer buffer);
+	public delegate void BufferLoaded (Buffer buffer);
+	public delegate void BufferSaving (Buffer buffer);
 
 	public class Buffer {
 		private BufferContentCallback callback;
@@ -79,7 +81,7 @@
 
 		public Stream Writer {
 			get {
-				return null;
+				return new VfsStream (uri.ToString (), FileMode.Truncate);
 			}
 		}
 		

Modified: branches/MonoDevelop-plan-43/src/Plugins/Workbench/workbench.ui
===================================================================
--- branches/MonoDevelop-plan-43/src/Plugins/Workbench/workbench.ui	2004-08-15 21:12:38 UTC (rev 1945)
+++ branches/MonoDevelop-plan-43/src/Plugins/Workbench/workbench.ui	2004-08-16 15:39:04 UTC (rev 1946)
@@ -49,5 +49,4 @@
 &lt;/menubar&gt;
 &lt;toolbar name=&quot;toolbar&quot;&gt;
 	&lt;placeholder name=&quot;FileOpenPlaceholder&quot;/&gt;
-	&lt;toolitem name=&quot;QuitButton&quot; action=&quot;QuitAction&quot;/&gt;
 &lt;/toolbar&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001552.html">[Monodevelop-patches-list] r1945 - in branches/MonoDevelop-plan-43/src: Libraries Libraries/SharpRefactory Libraries/SharpRefactory/CodeDOM Libraries/SharpRefactory/Lexer Libraries/SharpRefactory/Lexer/Reader Libraries/SharpRefactory/Lexer/Specials Libraries/SharpRefactory/Parser Libraries/SharpRefactory/Parser/AST Libraries/SharpRefactory/Parser/AST/Expressions Libraries/SharpRefactory/Parser/AST/GlobalScope Libraries/SharpRefactory/Parser/AST/Statements Libraries/SharpRefactory/Parser/AST/TypeLevel Libraries/SharpRefactory/Parser/generated Libraries/SharpRefactory/Parser/generated/keywordlist Libraries/SharpRefactory/PrettyPrinter Libraries/SharpRefactory/VBConverter Plugins Plugins/CSharp Plugins/Parser Plugins/Parser/Collections Plugins/Parser/Implementations Plugins/Parser/ParserService Plugins/Parser/PersistenceLayer Plugins/Parser/ReflectionLayer
</A></li>
	<LI>Next message: <A HREF="001554.html">[Monodevelop-patches-list] r1947 - in branches/MonoDevelop-plan-43: . src/Plugins/Node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1553">[ date ]</a>
              <a href="thread.html#1553">[ thread ]</a>
              <a href="subject.html#1553">[ subject ]</a>
              <a href="author.html#1553">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
