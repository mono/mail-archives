<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1452 - in trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding: . Gui Project
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1452%20-%20in%20trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding%3A%20.%20Gui%20Project&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001058.html">
   <LINK REL="Next"  HREF="001060.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1452 - in trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding: . Gui Project</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1452%20-%20in%20trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding%3A%20.%20Gui%20Project&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1452 - in trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding: . Gui Project">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Tue Apr 13 14:28:32 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001058.html">[Monodevelop-patches-list] r1451 - in trunk/MonoDevelop: build/AddIns/AddIns/BackendBindings src/AddIns/BackendBindings/ILAsmBinding
</A></li>
        <LI>Next message: <A HREF="001060.html">[Monodevelop-patches-list] r1453 - in trunk/MonoDevelop/src: Libraries/MonoDevelop.Gui.Widgets Libraries/MonoDevelop.Gui.Widgets/Navbar Main/Base Main/Base/Gui/BrowserDisplayBinding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: pawel
Date: 2004-04-13 14:28:32 -0400 (Tue, 13 Apr 2004)
New Revision: 1452

Added:
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/ChangeLog
Modified:
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/CodeGenerationPanel.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/OutputPanel.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingCompilerServices.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingExecutionServices.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleLanguageBinding.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleParameters.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleProject.cs
Log:
DOS endings stripped


Added: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/ChangeLog
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/ChangeLog	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/ChangeLog	2004-04-13 18:28:32 UTC (rev 1452)
@@ -0,0 +1,3 @@
+2004-04-13  Pawel Rozanski &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tokugawa at afn.no-ip.org</A>&gt;
+
+	stripped DOS '\r' from newlines

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/CodeGenerationPanel.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/CodeGenerationPanel.cs	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/CodeGenerationPanel.cs	2004-04-13 18:28:32 UTC (rev 1452)
@@ -1,70 +1,70 @@
-using System;
-using System.IO;
-using System.Drawing;
-
-using MonoDevelop.Internal.Project;
-using MonoDevelop.Internal.ExternalTool;
-using MonoDevelop.Gui.Dialogs;
-using MonoDevelop.Core.Services;
-using MonoDevelop.Core.Properties;
-using MonoDevelop.Core.AddIns.Codons;
-
-using Gtk;
-using MonoDevelop.Gui.Widgets;
-
-namespace NemerleBinding
-{
-	public class CodeGenerationPanel : AbstractOptionPanel
-	{
-		class CodeGenerationPanelWidget : GladeWidgetExtract 
-		{
- 			[Glade.Widget] OptionMenu target;
- 			[Glade.Widget] CheckButton nostdmacros;
-			[Glade.Widget] CheckButton nostdlib;
- 			[Glade.Widget] CheckButton ot;
- 			[Glade.Widget] CheckButton obcm;
- 			[Glade.Widget] CheckButton oocm;
- 			[Glade.Widget] CheckButton oscm;
- 			
-			NemerleParameters compilerParameters = null;
-
- 			public  CodeGenerationPanelWidget(IProperties CustomizationObject) : base (&quot;Nemerle.glade&quot;, &quot;CodeGenerationPanel&quot;)
- 			{
-				compilerParameters = (NemerleParameters)((IProperties)CustomizationObject).GetProperty(&quot;Config&quot;);
-				
-				target.SetHistory ( (uint) compilerParameters.Target);
-				
-				nostdmacros.Active = compilerParameters.Nostdmacros;
-				nostdlib.Active    = compilerParameters.Nostdlib;
-				ot.Active          = compilerParameters.Ot;
-				obcm.Active        = compilerParameters.Obcm;
-				oocm.Active        = compilerParameters.Oocm;
-				oscm.Active        = compilerParameters.Oscm;
- 			}
-
-			public bool Store ()
-			{	
-				compilerParameters.Target = (NemerleBinding.CompileTarget)target.History;
-				compilerParameters.Nostdmacros = nostdmacros.Active;
-				compilerParameters.Nostdlib = nostdlib.Active;
-				compilerParameters.Ot = ot.Active;
-				compilerParameters.Obcm = obcm.Active;
-				compilerParameters.Oocm = oocm.Active;
-				compilerParameters.Oscm = oscm.Active;
-				return true;
-			}
-		}
-
-		CodeGenerationPanelWidget widget;
-		
-		public override void LoadPanelContents()
-		{
-			Add (widget = new  CodeGenerationPanelWidget ((IProperties) CustomizationObject));
-		}
-		
-		public override bool StorePanelContents()
-		{
- 			return  widget.Store ();
-		}
-	}
-}
+using System;
+using System.IO;
+using System.Drawing;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Internal.ExternalTool;
+using MonoDevelop.Gui.Dialogs;
+using MonoDevelop.Core.Services;
+using MonoDevelop.Core.Properties;
+using MonoDevelop.Core.AddIns.Codons;
+
+using Gtk;
+using MonoDevelop.Gui.Widgets;
+
+namespace NemerleBinding
+{
+	public class CodeGenerationPanel : AbstractOptionPanel
+	{
+		class CodeGenerationPanelWidget : GladeWidgetExtract 
+		{
+ 			[Glade.Widget] OptionMenu target;
+ 			[Glade.Widget] CheckButton nostdmacros;
+			[Glade.Widget] CheckButton nostdlib;
+ 			[Glade.Widget] CheckButton ot;
+ 			[Glade.Widget] CheckButton obcm;
+ 			[Glade.Widget] CheckButton oocm;
+ 			[Glade.Widget] CheckButton oscm;
+ 			
+			NemerleParameters compilerParameters = null;
+
+ 			public  CodeGenerationPanelWidget(IProperties CustomizationObject) : base (&quot;Nemerle.glade&quot;, &quot;CodeGenerationPanel&quot;)
+ 			{
+				compilerParameters = (NemerleParameters)((IProperties)CustomizationObject).GetProperty(&quot;Config&quot;);
+				
+				target.SetHistory ( (uint) compilerParameters.Target);
+				
+				nostdmacros.Active = compilerParameters.Nostdmacros;
+				nostdlib.Active    = compilerParameters.Nostdlib;
+				ot.Active          = compilerParameters.Ot;
+				obcm.Active        = compilerParameters.Obcm;
+				oocm.Active        = compilerParameters.Oocm;
+				oscm.Active        = compilerParameters.Oscm;
+ 			}
+
+			public bool Store ()
+			{	
+				compilerParameters.Target = (NemerleBinding.CompileTarget)target.History;
+				compilerParameters.Nostdmacros = nostdmacros.Active;
+				compilerParameters.Nostdlib = nostdlib.Active;
+				compilerParameters.Ot = ot.Active;
+				compilerParameters.Obcm = obcm.Active;
+				compilerParameters.Oocm = oocm.Active;
+				compilerParameters.Oscm = oscm.Active;
+				return true;
+			}
+		}
+
+		CodeGenerationPanelWidget widget;
+		
+		public override void LoadPanelContents()
+		{
+			Add (widget = new  CodeGenerationPanelWidget ((IProperties) CustomizationObject));
+		}
+		
+		public override bool StorePanelContents()
+		{
+ 			return  widget.Store ();
+		}
+	}
+}

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/OutputPanel.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/OutputPanel.cs	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Gui/OutputPanel.cs	2004-04-13 18:28:32 UTC (rev 1452)
@@ -1,71 +1,71 @@
-using System;
-using System.IO;
-using System.Drawing;
-
-using MonoDevelop.Internal.Project;
-using MonoDevelop.Internal.ExternalTool;
-using MonoDevelop.Gui.Dialogs;
-using MonoDevelop.Core.Services;
-using MonoDevelop.Core.Properties;
-using MonoDevelop.Core.AddIns.Codons;
-
-using Gtk;
-using MonoDevelop.Gui.Widgets;
-
-namespace NemerleBinding
-{
-	public class OutputPanel : AbstractOptionPanel
-	{
-		class OutputPanelWidget : GladeWidgetExtract 
-		{
- 			[Glade.Widget] Entry assemblyName;
-			[Glade.Widget] Entry outputPath;
- 			[Glade.Widget] Entry parameters;
- 			[Glade.Widget] Entry executeCommand;
- 			[Glade.Widget] Button outputPathButton;
- 			
-			NemerleParameters compilerParameters = null;
-
- 			public  OutputPanelWidget(IProperties CustomizationObject) : base (&quot;Nemerle.glade&quot;, &quot;OutputPanel&quot;)
- 			{
-				compilerParameters = (NemerleParameters)((IProperties)CustomizationObject).GetProperty(&quot;Config&quot;);
-				
-				outputPathButton.Clicked += new EventHandler(SelectFolder);
-				assemblyName.Text   = compilerParameters.AssemblyName;
-				outputPath.Text     = compilerParameters.OutputPath;
-				parameters.Text     = compilerParameters.Parameters;
-				executeCommand.Text = compilerParameters.ExecuteCommand;
- 			}
-
-			public bool Store ()
-			{	
-				compilerParameters.AssemblyName   = assemblyName.Text;
-				compilerParameters.OutputPath     = outputPath.Text;
-				compilerParameters.Parameters     = parameters.Text;
-				compilerParameters.ExecuteCommand = executeCommand.Text;
-				return true;
-			}
-			void SelectFolder(object sender, EventArgs e)			
-			{
-				using (FileSelection fdiag = new FileSelection (&quot;Output Path&quot;)) 
-				{
-					if (fdiag.Run () == (int) ResponseType.Ok) 
-						outputPath.Text = fdiag.Filename;
-					fdiag.Hide();
-				}
-			}			
-		}
-
-		OutputPanelWidget widget;
-		
-		public override void LoadPanelContents()
-		{
-			Add (widget = new  OutputPanelWidget ((IProperties) CustomizationObject));
-		}
-		
-		public override bool StorePanelContents()
-		{
- 			return  widget.Store ();
-		}
-	}
-}
+using System;
+using System.IO;
+using System.Drawing;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Internal.ExternalTool;
+using MonoDevelop.Gui.Dialogs;
+using MonoDevelop.Core.Services;
+using MonoDevelop.Core.Properties;
+using MonoDevelop.Core.AddIns.Codons;
+
+using Gtk;
+using MonoDevelop.Gui.Widgets;
+
+namespace NemerleBinding
+{
+	public class OutputPanel : AbstractOptionPanel
+	{
+		class OutputPanelWidget : GladeWidgetExtract 
+		{
+ 			[Glade.Widget] Entry assemblyName;
+			[Glade.Widget] Entry outputPath;
+ 			[Glade.Widget] Entry parameters;
+ 			[Glade.Widget] Entry executeCommand;
+ 			[Glade.Widget] Button outputPathButton;
+ 			
+			NemerleParameters compilerParameters = null;
+
+ 			public  OutputPanelWidget(IProperties CustomizationObject) : base (&quot;Nemerle.glade&quot;, &quot;OutputPanel&quot;)
+ 			{
+				compilerParameters = (NemerleParameters)((IProperties)CustomizationObject).GetProperty(&quot;Config&quot;);
+				
+				outputPathButton.Clicked += new EventHandler(SelectFolder);
+				assemblyName.Text   = compilerParameters.AssemblyName;
+				outputPath.Text     = compilerParameters.OutputPath;
+				parameters.Text     = compilerParameters.Parameters;
+				executeCommand.Text = compilerParameters.ExecuteCommand;
+ 			}
+
+			public bool Store ()
+			{	
+				compilerParameters.AssemblyName   = assemblyName.Text;
+				compilerParameters.OutputPath     = outputPath.Text;
+				compilerParameters.Parameters     = parameters.Text;
+				compilerParameters.ExecuteCommand = executeCommand.Text;
+				return true;
+			}
+			void SelectFolder(object sender, EventArgs e)			
+			{
+				using (FileSelection fdiag = new FileSelection (&quot;Output Path&quot;)) 
+				{
+					if (fdiag.Run () == (int) ResponseType.Ok) 
+						outputPath.Text = fdiag.Filename;
+					fdiag.Hide();
+				}
+			}			
+		}
+
+		OutputPanelWidget widget;
+		
+		public override void LoadPanelContents()
+		{
+			Add (widget = new  OutputPanelWidget ((IProperties) CustomizationObject));
+		}
+		
+		public override bool StorePanelContents()
+		{
+ 			return  widget.Store ();
+		}
+	}
+}

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingCompilerServices.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingCompilerServices.cs	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingCompilerServices.cs	2004-04-13 18:28:32 UTC (rev 1452)
@@ -1,163 +1,163 @@
-using System;
-using System.Diagnostics;
-using System.IO;
-using System.CodeDom.Compiler;
-
-using MonoDevelop.Core.Services;
-using MonoDevelop.Internal.Project;
-
-namespace NemerleBinding
-{
-	public class NemerleBindingCompilerServices
-	{	
-		FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
-		static string ncc = &quot;ncc -q -no-color&quot;;
-		
-		private string GetOptionsString(NemerleParameters cp)
-		{
-			string options = &quot;&quot;;
-			if (cp.Nostdmacros)
-				options += &quot; -no-stdmacros&quot;;
-			if (cp.Nostdlib)
-				options += &quot; -no-stdlib&quot;;
-			if (cp.Ot)
-				options += &quot; -Ot&quot;;
-			if (cp.Obcm)
-				options += &quot; -Obcm&quot;;
-			if (cp.Oocm)
-				options += &quot; -Oocm&quot;;
-			if (cp.Oscm)
-				options += &quot; -Oscm&quot;;
-			if ((int)cp.Target == 1)
-				options += &quot; -tdll&quot;;
-				
-			return options;			
-		}
-		
-		public bool CanCompile(string fileName)
-		{
-			return Path.GetExtension(fileName) == &quot;.n&quot;;
-		} 
-		
-		public ICompilerResult CompileFile(string fileName)
-		{
-			throw new ApplicationException(&quot;No CompileFile&quot;);
-		}
-		
-		public string GetCompiledOutputName(string fileName)
-		{
-			throw new ApplicationException(&quot;No CompileFile&quot;);
-		}
-
-		public string GetCompiledOutputName(IProject project)
-		{
-			NemerleParameters cp = (NemerleParameters)project.ActiveConfiguration;
-			
-			return fileUtilityService.GetDirectoryNameWithSeparator(cp.OutputPath)
-					+ cp.AssemblyName + ((int)cp.Target == 0?&quot;.exe&quot;:&quot;.dll&quot;);
-		}
-		
-		public ICompilerResult CompileProject(IProject project)
-		{
-			NemerleParameters cp = (NemerleParameters)project.ActiveConfiguration;
-			
-			string references = &quot;&quot;;
-			string files   = &quot;&quot;;
-			
-			foreach (ProjectReference lib in project.ProjectReferences)
-				references += &quot; -r \&quot;&quot; + lib.GetReferencedFileName(project) + &quot;\&quot;&quot;;
-			
-			foreach (ProjectFile f in project.ProjectFiles)
-				if (f.Subtype != Subtype.Directory)
-					switch (f.BuildAction)
-					{
-						case BuildAction.Compile:
-							files += &quot; \&quot;&quot; + f.Name + &quot;\&quot;&quot;;
-						break;
-					}
-
-			if (!Directory.Exists(cp.OutputPath))
-				Directory.CreateDirectory(cp.OutputPath);
-			
-			string outstr = ncc + GetOptionsString(cp) + references + files  + &quot; -o &quot; + GetCompiledOutputName(project);
-			string output = &quot;&quot;;
-			string error  = &quot;&quot;;
-			TempFileCollection  tf = new TempFileCollection ();		
-//			Executor.ExecWaitWithCapture(outstr, tf, ref error , ref output);
-			DoCompilation (outstr, tf, ref output, ref error);			
-			ICompilerResult cr = ParseOutput (tf, output);			
-			File.Delete(output);
-			File.Delete(error);
-			return cr;
-		}
-		
-		private void DoCompilation(string outstr, TempFileCollection tf, ref string output, ref string error)
-		{
-			output = Path.GetTempFileName();
-			error = Path.GetTempFileName();
-			
-			string arguments = outstr + &quot; &gt; &quot; + output + &quot; 2&gt; &quot; + error;
-			string command = arguments;
-			ProcessStartInfo si = new ProcessStartInfo(&quot;/bin/sh -c \&quot;&quot; + command + &quot;\&quot;&quot;);
-			si.RedirectStandardOutput = true;
-			si.RedirectStandardError = true;
-			si.UseShellExecute = false;
-			Process p = new Process();
-			p.StartInfo = si;
-			p.Start();
-			p.WaitForExit();
-		}
-		
-		ICompilerResult ParseOutput(TempFileCollection tf, string file)
-		{
-			string compilerOutput = &quot;&quot;;
-			string l;		
-			StreamReader sr = new StreamReader(file, System.Text.Encoding.Default);
-			CompilerResults cr = new CompilerResults(tf);
-			
-			while ((l = sr.ReadLine())!=null) 
-			{
-				compilerOutput += l + &quot;\n&quot;;
-
-				if ((l.IndexOf(&quot;.n:&quot;) &lt; 0) &amp;&amp;
-					(l.IndexOf(&quot;:0:0:&quot;) &lt; 0))
-					continue;				
-
-				CompilerError error = new CompilerError();
-				
-				int s1 = l.IndexOf(':')+1;
-				int s2 = l.IndexOf(':',s1)+1;
-				int s3 = l.IndexOf(':',s2)+1;
-				int s4 = l.IndexOf(':',s3)+1;
-				
-				error.FileName  = l.Substring(0, s1-1);
-				error.Line   	= Int32.Parse(l.Substring(s1, s2-s1-1));
-				error.Column    = Int32.Parse(l.Substring(s2, s3-s2-1));
-				error.ErrorNumber = String.Empty;
-				error.ErrorText = &quot;&quot;;
-				switch(l.Substring(s3+1, s4-s3-2))
-				{
-					case &quot;error&quot;:
-						error.IsWarning = false;
-						break;
-					case &quot;warning&quot;:
-						error.IsWarning = true;
-						break;
-					case &quot;hint&quot;:
-						error.IsWarning = true;
-						error.ErrorText = &quot;hint: &quot;;
-						break;
-					default:
-						error.IsWarning = false;
-						error.ErrorText = &quot;unknown: &quot;;
-						break;
-				}
-				error.ErrorText += l.Substring(s4+1);
-				
-				cr.Errors.Add(error);
-			}
-			sr.Close();			
-			return new DefaultCompilerResult(cr, compilerOutput);
-		}
-	}
-}
+using System;
+using System.Diagnostics;
+using System.IO;
+using System.CodeDom.Compiler;
+
+using MonoDevelop.Core.Services;
+using MonoDevelop.Internal.Project;
+
+namespace NemerleBinding
+{
+	public class NemerleBindingCompilerServices
+	{	
+		FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
+		static string ncc = &quot;ncc -q -no-color&quot;;
+		
+		private string GetOptionsString(NemerleParameters cp)
+		{
+			string options = &quot;&quot;;
+			if (cp.Nostdmacros)
+				options += &quot; -no-stdmacros&quot;;
+			if (cp.Nostdlib)
+				options += &quot; -no-stdlib&quot;;
+			if (cp.Ot)
+				options += &quot; -Ot&quot;;
+			if (cp.Obcm)
+				options += &quot; -Obcm&quot;;
+			if (cp.Oocm)
+				options += &quot; -Oocm&quot;;
+			if (cp.Oscm)
+				options += &quot; -Oscm&quot;;
+			if ((int)cp.Target == 1)
+				options += &quot; -tdll&quot;;
+				
+			return options;			
+		}
+		
+		public bool CanCompile(string fileName)
+		{
+			return Path.GetExtension(fileName) == &quot;.n&quot;;
+		} 
+		
+		public ICompilerResult CompileFile(string fileName)
+		{
+			throw new ApplicationException(&quot;No CompileFile&quot;);
+		}
+		
+		public string GetCompiledOutputName(string fileName)
+		{
+			throw new ApplicationException(&quot;No CompileFile&quot;);
+		}
+
+		public string GetCompiledOutputName(IProject project)
+		{
+			NemerleParameters cp = (NemerleParameters)project.ActiveConfiguration;
+			
+			return fileUtilityService.GetDirectoryNameWithSeparator(cp.OutputPath)
+					+ cp.AssemblyName + ((int)cp.Target == 0?&quot;.exe&quot;:&quot;.dll&quot;);
+		}
+		
+		public ICompilerResult CompileProject(IProject project)
+		{
+			NemerleParameters cp = (NemerleParameters)project.ActiveConfiguration;
+			
+			string references = &quot;&quot;;
+			string files   = &quot;&quot;;
+			
+			foreach (ProjectReference lib in project.ProjectReferences)
+				references += &quot; -r \&quot;&quot; + lib.GetReferencedFileName(project) + &quot;\&quot;&quot;;
+			
+			foreach (ProjectFile f in project.ProjectFiles)
+				if (f.Subtype != Subtype.Directory)
+					switch (f.BuildAction)
+					{
+						case BuildAction.Compile:
+							files += &quot; \&quot;&quot; + f.Name + &quot;\&quot;&quot;;
+						break;
+					}
+
+			if (!Directory.Exists(cp.OutputPath))
+				Directory.CreateDirectory(cp.OutputPath);
+			
+			string outstr = ncc + GetOptionsString(cp) + references + files  + &quot; -o &quot; + GetCompiledOutputName(project);
+			string output = &quot;&quot;;
+			string error  = &quot;&quot;;
+			TempFileCollection  tf = new TempFileCollection ();		
+//			Executor.ExecWaitWithCapture(outstr, tf, ref error , ref output);
+			DoCompilation (outstr, tf, ref output, ref error);			
+			ICompilerResult cr = ParseOutput (tf, output);			
+			File.Delete(output);
+			File.Delete(error);
+			return cr;
+		}
+		
+		private void DoCompilation(string outstr, TempFileCollection tf, ref string output, ref string error)
+		{
+			output = Path.GetTempFileName();
+			error = Path.GetTempFileName();
+			
+			string arguments = outstr + &quot; &gt; &quot; + output + &quot; 2&gt; &quot; + error;
+			string command = arguments;
+			ProcessStartInfo si = new ProcessStartInfo(&quot;/bin/sh -c \&quot;&quot; + command + &quot;\&quot;&quot;);
+			si.RedirectStandardOutput = true;
+			si.RedirectStandardError = true;
+			si.UseShellExecute = false;
+			Process p = new Process();
+			p.StartInfo = si;
+			p.Start();
+			p.WaitForExit();
+		}
+		
+		ICompilerResult ParseOutput(TempFileCollection tf, string file)
+		{
+			string compilerOutput = &quot;&quot;;
+			string l;		
+			StreamReader sr = new StreamReader(file, System.Text.Encoding.Default);
+			CompilerResults cr = new CompilerResults(tf);
+			
+			while ((l = sr.ReadLine())!=null) 
+			{
+				compilerOutput += l + &quot;\n&quot;;
+
+				if ((l.IndexOf(&quot;.n:&quot;) &lt; 0) &amp;&amp;
+					(l.IndexOf(&quot;:0:0:&quot;) &lt; 0))
+					continue;				
+
+				CompilerError error = new CompilerError();
+				
+				int s1 = l.IndexOf(':')+1;
+				int s2 = l.IndexOf(':',s1)+1;
+				int s3 = l.IndexOf(':',s2)+1;
+				int s4 = l.IndexOf(':',s3)+1;
+				
+				error.FileName  = l.Substring(0, s1-1);
+				error.Line   	= Int32.Parse(l.Substring(s1, s2-s1-1));
+				error.Column    = Int32.Parse(l.Substring(s2, s3-s2-1));
+				error.ErrorNumber = String.Empty;
+				error.ErrorText = &quot;&quot;;
+				switch(l.Substring(s3+1, s4-s3-2))
+				{
+					case &quot;error&quot;:
+						error.IsWarning = false;
+						break;
+					case &quot;warning&quot;:
+						error.IsWarning = true;
+						break;
+					case &quot;hint&quot;:
+						error.IsWarning = true;
+						error.ErrorText = &quot;hint: &quot;;
+						break;
+					default:
+						error.IsWarning = false;
+						error.ErrorText = &quot;unknown: &quot;;
+						break;
+				}
+				error.ErrorText += l.Substring(s4+1);
+				
+				cr.Errors.Add(error);
+			}
+			sr.Close();			
+			return new DefaultCompilerResult(cr, compilerOutput);
+		}
+	}
+}

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingExecutionServices.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingExecutionServices.cs	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleBindingExecutionServices.cs	2004-04-13 18:28:32 UTC (rev 1452)
@@ -1,61 +1,61 @@
-using System;
-using System.IO;
-using System.Diagnostics;
-using System.Collections;
-using System.Reflection;
-using System.Resources;
-using System.Xml;
-using System.CodeDom.Compiler;
-using System.Threading;
-
-using MonoDevelop.Internal.Project;
-using MonoDevelop.Gui;
-using MonoDevelop.Core.Services;
-
-namespace NemerleBinding
-{
-	public class NemerleBindingExecutionServices
-	{	
-		
-		public void Execute(string filename)
-		{
-			throw new ApplicationException(&quot;No ExecuteFile&quot;);
-		}
-		
-		public void Execute(IProject project)
-		{
-			
-			NemerleParameters p = (NemerleParameters)project.ActiveConfiguration;
-			FileUtilityService fus = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
-			string dir = fus.GetDirectoryNameWithSeparator(p.OutputPath);
-			string exe;
-			
-			if (p.ExecuteCommand == String.Empty)
-			{
-				exe	= &quot;mono --debug&quot;;
-			} else
-			{
-				exe = p.ExecuteCommand;
-			}
-			
-			exe += &quot; &quot; + p.AssemblyName + &quot;.exe &quot; + p.Parameters;
-			
-			try {
-				string currentDir = Directory.GetCurrentDirectory();
-				Directory.SetCurrentDirectory(dir);				
-				
-				ProcessStartInfo psi = new ProcessStartInfo(exe);
-				psi.WorkingDirectory = dir;
-				psi.UseShellExecute = false;
-				
-				Process pr = new Process();
-				pr.StartInfo = psi;
-				pr.Start();
-				Directory.SetCurrentDirectory(currentDir);	
-			} catch (Exception) {
-				throw new ApplicationException(&quot;Can not execute&quot;);
-			}
-		}
-				
-	}
-}
+using System;
+using System.IO;
+using System.Diagnostics;
+using System.Collections;
+using System.Reflection;
+using System.Resources;
+using System.Xml;
+using System.CodeDom.Compiler;
+using System.Threading;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Gui;
+using MonoDevelop.Core.Services;
+
+namespace NemerleBinding
+{
+	public class NemerleBindingExecutionServices
+	{	
+		
+		public void Execute(string filename)
+		{
+			throw new ApplicationException(&quot;No ExecuteFile&quot;);
+		}
+		
+		public void Execute(IProject project)
+		{
+			
+			NemerleParameters p = (NemerleParameters)project.ActiveConfiguration;
+			FileUtilityService fus = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
+			string dir = fus.GetDirectoryNameWithSeparator(p.OutputPath);
+			string exe;
+			
+			if (p.ExecuteCommand == String.Empty)
+			{
+				exe	= &quot;mono --debug&quot;;
+			} else
+			{
+				exe = p.ExecuteCommand;
+			}
+			
+			exe += &quot; &quot; + p.AssemblyName + &quot;.exe &quot; + p.Parameters;
+			
+			try {
+				string currentDir = Directory.GetCurrentDirectory();
+				Directory.SetCurrentDirectory(dir);				
+				
+				ProcessStartInfo psi = new ProcessStartInfo(exe);
+				psi.WorkingDirectory = dir;
+				psi.UseShellExecute = false;
+				
+				Process pr = new Process();
+				pr.StartInfo = psi;
+				pr.Start();
+				Directory.SetCurrentDirectory(currentDir);	
+			} catch (Exception) {
+				throw new ApplicationException(&quot;Can not execute&quot;);
+			}
+		}
+				
+	}
+}

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleLanguageBinding.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleLanguageBinding.cs	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/NemerleLanguageBinding.cs	2004-04-13 18:28:32 UTC (rev 1452)
@@ -1,79 +1,79 @@
-using System;
-using System.IO;
-using System.Diagnostics;
-using System.Collections;
-using System.Reflection;
-using System.Resources;
-using System.Xml;
-
-using MonoDevelop.Internal.Project;
-using MonoDevelop.Internal.Templates;
-using MonoDevelop.Gui;
-
-namespace NemerleBinding
-{
-	/// &lt;summary&gt;
-	/// This class describes the main functionalaty of a language binding
-	/// &lt;/summary&gt;
-	public class NemerleLanguageBinding : ILanguageBinding
-	{
-		public const string LanguageName = &quot;Nemerle&quot;;
-		
-		NemerleBindingCompilerServices   compilerServices  = new NemerleBindingCompilerServices();
-		NemerleBindingExecutionServices  executionServices = new NemerleBindingExecutionServices();
-		
-		public string Language {
-			get { return LanguageName; }
-		}
-		
-		public void Execute (string filename)
-		{
-			executionServices.Execute(filename);
-		}
-		
-		public void Execute (IProject project)
-		{
-			executionServices.Execute (project);
-		}
-		
-		public string GetCompiledOutputName(string fileName)
-		{
-			return compilerServices.GetCompiledOutputName(fileName);
-		}
-		
-		public string GetCompiledOutputName(IProject project)
-		{
-			return compilerServices.GetCompiledOutputName(project);
-		}
-		
-		public bool CanCompile(string fileName)
-		{
-			return compilerServices.CanCompile(fileName);
-		}
-		
-		public ICompilerResult CompileFile(string fileName)
-		{
-			return compilerServices.CompileFile(fileName);
-		}
-		
-		public ICompilerResult CompileProject(IProject project)
+using System;
+using System.IO;
+using System.Diagnostics;
+using System.Collections;
+using System.Reflection;
+using System.Resources;
+using System.Xml;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Internal.Templates;
+using MonoDevelop.Gui;
+
+namespace NemerleBinding
+{
+	/// &lt;summary&gt;
+	/// This class describes the main functionalaty of a language binding
+	/// &lt;/summary&gt;
+	public class NemerleLanguageBinding : ILanguageBinding
+	{
+		public const string LanguageName = &quot;Nemerle&quot;;
+		
+		NemerleBindingCompilerServices   compilerServices  = new NemerleBindingCompilerServices();
+		NemerleBindingExecutionServices  executionServices = new NemerleBindingExecutionServices();
+		
+		public string Language {
+			get { return LanguageName; }
+		}
+		
+		public void Execute (string filename)
 		{
-			return compilerServices.CompileProject(project);
-		}
-		
-		public ICompilerResult RecompileProject(IProject project)
+			executionServices.Execute(filename);
+		}
+		
+		public void Execute (IProject project)
 		{
-			return CompileProject(project);
-		}
-		
-		public IProject CreateProject(ProjectCreateInformation info, XmlElement projectOptions)
+			executionServices.Execute (project);
+		}
+		
+		public string GetCompiledOutputName(string fileName)
 		{
-			return new NemerleProject(info, projectOptions);
-		}
-
-		public void DebugProject (IProject project)
-		{
-			throw new ApplicationException(&quot;No Nemele debug&quot;);
-		}
-	}
-}
+			return compilerServices.GetCompiledOutputName(fileName);
+		}
+		
+		public string GetCompiledOutputName(IProject project)
+		{
+			return compilerServices.GetCompiledOutputName(project);
+		}
+		
+		public bool CanCompile(string fileName)
+		{
+			return compilerServices.CanCompile(fileName);
+		}
+		
+		public ICompilerResult CompileFile(string fileName)
+		{
+			return compilerServices.CompileFile(fileName);
+		}
+		
+		public ICompilerResult CompileProject(IProject project)
+		{
+			return compilerServices.CompileProject(project);
+		}
+		
+		public ICompilerResult RecompileProject(IProject project)
+		{
+			return CompileProject(project);
+		}
+		
+		public IProject CreateProject(ProjectCreateInformation info, XmlElement projectOptions)
+		{
+			return new NemerleProject(info, projectOptions);
+		}
+
+		public void DebugProject (IProject project)
+		{
+			throw new ApplicationException(&quot;No Nemele debug&quot;);
+		}
+	}
+}

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleParameters.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleParameters.cs	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleParameters.cs	2004-04-13 18:28:32 UTC (rev 1452)
@@ -1,35 +1,35 @@
-using System;
-using System.Xml;
-using System.Diagnostics;
-
-using MonoDevelop.Internal.Project;
-
-namespace NemerleBinding
-{
+using System;
+using System.Xml;
+using System.Diagnostics;
+
+using MonoDevelop.Internal.Project;
+
+namespace NemerleBinding
+{
 	public enum CompileTarget
 	{
 		Executable,
 		Library
 	};
-	
-	public class NemerleParameters : AbstractProjectConfiguration
+	
+	public class NemerleParameters : AbstractProjectConfiguration
 	{
-		[XmlNodeName(&quot;CodeGeneration&quot;)]
-		class CodeGeneration 
+		[XmlNodeName(&quot;CodeGeneration&quot;)]
+		class CodeGeneration 
 		{
 			[XmlAttribute(&quot;target&quot;)]
-			public CompileTarget target  = CompileTarget.Executable;
-			[XmlAttribute(&quot;nostdmacros&quot;)]
-			public bool nostdmacros         = false;
-			[XmlAttribute(&quot;nostdlib&quot;)]
-			public bool nostdlib            = false;
-			[XmlAttribute(&quot;ot&quot;)]
-			public bool ot                  = true;
-			[XmlAttribute(&quot;obcm&quot;)]
-			public bool obcm                = true;
-			[XmlAttribute(&quot;oocm&quot;)]
-			public bool oocm                = true;
-			[XmlAttribute(&quot;oscm&quot;)]
+			public CompileTarget target  = CompileTarget.Executable;
+			[XmlAttribute(&quot;nostdmacros&quot;)]
+			public bool nostdmacros         = false;
+			[XmlAttribute(&quot;nostdlib&quot;)]
+			public bool nostdlib            = false;
+			[XmlAttribute(&quot;ot&quot;)]
+			public bool ot                  = true;
+			[XmlAttribute(&quot;obcm&quot;)]
+			public bool obcm                = true;
+			[XmlAttribute(&quot;oocm&quot;)]
+			public bool oocm                = true;
+			[XmlAttribute(&quot;oscm&quot;)]
 			public bool oscm                = true;
 			
 			[XmlAttribute(&quot;assemblyname&quot;)]
@@ -38,25 +38,25 @@
 			public string outputpath        = String.Empty;
 			[XmlAttribute(&quot;parameters&quot;)]
 			public string parameters        = String.Empty;
-		}
-		
-		[XmlNodeName(&quot;Execution&quot;)]
-		class Execution
-		{
-			[XmlAttribute(&quot;executecommand&quot;)]
-			public string executecommand    = String.Empty;
 		}
-
-		
-		CodeGeneration codeGeneration = new CodeGeneration();
-		
-		Execution      execution      = new Execution();
-		
+		
+		[XmlNodeName(&quot;Execution&quot;)]
+		class Execution
+		{
+			[XmlAttribute(&quot;executecommand&quot;)]
+			public string executecommand    = String.Empty;
+		}
+
+		
+		CodeGeneration codeGeneration = new CodeGeneration();
+		
+		Execution      execution      = new Execution();
+		
 		public CompileTarget Target
 		{
 			get { return codeGeneration.target; }
 			set { codeGeneration.target = value; }
-		}
+		}
 		public bool Nostdmacros
 		{
 			get { return codeGeneration.nostdmacros; }
@@ -66,12 +66,12 @@
 		{
 			get { return codeGeneration.nostdlib; }
 			set { codeGeneration.nostdlib = value; }
-		}
+		}
 		public bool Ot
 		{
 			get { return codeGeneration.ot; }
 			set { codeGeneration.ot = value; }
-		}
+		}
 		public bool Obcm
 		{
 			get { return codeGeneration.obcm; }
@@ -81,7 +81,7 @@
 		{
 			get { return codeGeneration.oocm; }
 			set { codeGeneration.oocm = value; }
-		}
+		}
 		public bool Oscm
 		{
 			get { return codeGeneration.oscm; }
@@ -103,20 +103,20 @@
 			get { return codeGeneration.parameters; }
 			set { codeGeneration.parameters = value; }
 		}
-		
+		
 		public string ExecuteCommand
 		{
 			get { return execution.executecommand; }
 			set { execution.executecommand = value; }
 		}
 
-	
-		public NemerleParameters()
-		{
-		}
-		public NemerleParameters(string name)
-		{
-			this.name = name;
-		}
-	}
-}
+	
+		public NemerleParameters()
+		{
+		}
+		public NemerleParameters(string name)
+		{
+			this.name = name;
+		}
+	}
+}

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleProject.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleProject.cs	2004-04-12 23:09:56 UTC (rev 1451)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/NemerleBinding/Project/NemerleProject.cs	2004-04-13 18:28:32 UTC (rev 1452)
@@ -1,47 +1,47 @@
-using System;
-using System.IO;
-using System.Collections;
-using System.Diagnostics;
-using System.ComponentModel;
-using System.Xml;
-
-using MonoDevelop.Internal.Project;
-using MonoDevelop.Internal.Templates;
-
-namespace NemerleBinding
-{
-	public class NemerleProject : AbstractProject
-	{		
-		public override string ProjectType {
-			get {
-				return NemerleLanguageBinding.LanguageName;
-			}
-		}
-		
-		public override IConfiguration CreateConfiguration()
-		{
-			return new NemerleParameters();
-		}
-		
-		public NemerleProject()
-		{
-		}
-		
-		public NemerleProject(ProjectCreateInformation info, XmlElement projectOptions)
-		{
+using System;
+using System.IO;
+using System.Collections;
+using System.Diagnostics;
+using System.ComponentModel;
+using System.Xml;
+
+using MonoDevelop.Internal.Project;
+using MonoDevelop.Internal.Templates;
+
+namespace NemerleBinding
+{
+	public class NemerleProject : AbstractProject
+	{		
+		public override string ProjectType {
+			get {
+				return NemerleLanguageBinding.LanguageName;
+			}
+		}
+		
+		public override IConfiguration CreateConfiguration()
+		{
+			return new NemerleParameters();
+		}
+		
+		public NemerleProject()
+		{
+		}
+		
+		public NemerleProject(ProjectCreateInformation info, XmlElement projectOptions)
+		{
 			if (info != null)
-			{
-				Name = info.ProjectName;
-				
-				Configurations.Add(CreateConfiguration(&quot;Debug&quot;));
+			{
+				Name = info.ProjectName;
+				
+				Configurations.Add(CreateConfiguration(&quot;Debug&quot;));
 				Configurations.Add(CreateConfiguration(&quot;Release&quot;));
 				
 				foreach (NemerleParameters p in Configurations)
 				{
 					p.OutputPath = info.BinPath + Path.DirectorySeparatorChar + p.Name;
 					p.AssemblyName = Name;					
-				}
				
-			}
-		}
-	}
-}
+				}				
+			}
+		}
+	}
+}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001058.html">[Monodevelop-patches-list] r1451 - in trunk/MonoDevelop: build/AddIns/AddIns/BackendBindings src/AddIns/BackendBindings/ILAsmBinding
</A></li>
	<LI>Next message: <A HREF="001060.html">[Monodevelop-patches-list] r1453 - in trunk/MonoDevelop/src: Libraries/MonoDevelop.Gui.Widgets Libraries/MonoDevelop.Gui.Widgets/Navbar Main/Base Main/Base/Gui/BrowserDisplayBinding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
