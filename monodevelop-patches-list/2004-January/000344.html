<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r739 - in trunk/MonoDevelop/src: AddIns/DisplayBindings/EditorBindings/FormattingStrategy Libraries/ICSharpCode.TextEditor Libraries/ICSharpCode.TextEditor/src/Document
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r739%20-%20in%20trunk/MonoDevelop/src%3A%20AddIns/DisplayBindings/EditorBindings/FormattingStrategy%20Libraries/ICSharpCode.TextEditor%20Libraries/ICSharpCode.TextEditor/src/Document&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000343.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r739 - in trunk/MonoDevelop/src: AddIns/DisplayBindings/EditorBindings/FormattingStrategy Libraries/ICSharpCode.TextEditor Libraries/ICSharpCode.TextEditor/src/Document</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r739%20-%20in%20trunk/MonoDevelop/src%3A%20AddIns/DisplayBindings/EditorBindings/FormattingStrategy%20Libraries/ICSharpCode.TextEditor%20Libraries/ICSharpCode.TextEditor/src/Document&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r739 - in trunk/MonoDevelop/src: AddIns/DisplayBindings/EditorBindings/FormattingStrategy Libraries/ICSharpCode.TextEditor Libraries/ICSharpCode.TextEditor/src/Document">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sat Jan 31 20:37:34 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000343.html">[Monodevelop-patches-list] r738 - in trunk/MonoDevelop/src: AddIns/BackendBindings/CSharpBinding AddIns/BackendBindings/CSharpBinding/FormattingStrategy AddIns/DisplayBindings/EditorBindings AddIns/DisplayBindings/EditorBindings/FormattingStrategy AddIns/DisplayBindings/TextEditor AddIns/DisplayBindings/TextEditor/Commands AddIns/DisplayBindings/TextEditor/Gui/Editor AddIns/DisplayBindings/TextEditor/Gui/OptionPanels Libraries/ICSharpCode.TextEditor Libraries/ICSharpCode.TextEditor/src/Actions Libraries/ICSharpCode.TextEditor/src/Document Libraries/ICSharpCode.TextEditor/src/Document/FormattingStrategy Libraries/ICSharpCode.TextEditor/src/Gui Libraries/ICSharpCode.TextEditor/src/Undo
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#344">[ date ]</a>
              <a href="thread.html#344">[ thread ]</a>
              <a href="subject.html#344">[ subject ]</a>
              <a href="author.html#344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: benm
Date: 2004-01-31 20:37:34 -0500 (Sat, 31 Jan 2004)
New Revision: 739

Added:
   trunk/MonoDevelop/src/AddIns/DisplayBindings/EditorBindings/FormattingStrategy/DefaultFormattingStrategy.cs
Removed:
   trunk/MonoDevelop/src/Libraries/ICSharpCode.TextEditor/src/Document/FormattingStrategy/
Modified:
   trunk/MonoDevelop/src/Libraries/ICSharpCode.TextEditor/Makefile
Log:
move this

Copied: trunk/MonoDevelop/src/AddIns/DisplayBindings/EditorBindings/FormattingStrategy/DefaultFormattingStrategy.cs (from rev 738, trunk/MonoDevelop/src/Libraries/ICSharpCode.TextEditor/src/Document/FormattingStrategy/DefaultFormattingStrategy.cs)
===================================================================
--- trunk/MonoDevelop/src/Libraries/ICSharpCode.TextEditor/src/Document/FormattingStrategy/DefaultFormattingStrategy.cs	2004-02-01 01:30:26 UTC (rev 738)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/EditorBindings/FormattingStrategy/DefaultFormattingStrategy.cs	2004-02-01 01:37:34 UTC (rev 739)
@@ -0,0 +1,105 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.Collections;
+using System.Text;
+using MonoDevelop.EditorBindings.FormattingStrategy;
+
+namespace ICSharpCode.TextEditor.Document {
+	/// &lt;summary&gt;
+	/// This class handles the auto and smart indenting in the textbuffer while
+	/// you type.
+	/// &lt;/summary&gt;
+	public class DefaultFormattingStrategy : IFormattingStrategy {
+		/// &lt;summary&gt;
+		/// returns the whitespaces which are before a non white space character in the line line
+		/// as a string.
+		/// &lt;/summary&gt;
+		protected string GetIndentation (IFormattableDocument d, int lineNumber)
+		{
+			string lineText = d.GetLineAsString (lineNumber);
+			StringBuilder whitespaces = new StringBuilder ();
+			
+			foreach (char ch in lineText) {
+				if (! Char.IsWhiteSpace (ch))
+					break;
+				whitespaces.Append (ch);
+			}
+			
+			return whitespaces.ToString ();
+		}
+		
+		/// &lt;summary&gt;
+		/// Could be overwritten to define more complex indenting.
+		/// &lt;/summary&gt;
+		protected virtual int AutoIndentLine (IFormattableDocument d, int lineNumber)
+		{
+			string indentation = lineNumber != 0 ? GetIndentation (d, lineNumber - 1) : &quot;&quot;;
+			
+			if (indentation.Length &gt; 0) {
+				string newLineText = indentation + d.GetLineAsString (lineNumber).Trim ();
+				d.ReplaceLine (lineNumber, newLineText);
+			}
+			
+			return indentation.Length;
+		}
+		
+		/// &lt;summary&gt;
+		/// Could be overwritten to define more complex indenting.
+		/// &lt;/summary&gt;
+		protected virtual int SmartIndentLine (IFormattableDocument d, int line)
+		{
+			return AutoIndentLine (d, line); // smart = autoindent in normal texts
+		}
+		
+		/// &lt;summary&gt;
+		/// This function formats a specific line after &lt;code&gt;ch&lt;/code&gt; is pressed.
+		/// &lt;/summary&gt;
+		/// &lt;returns&gt;
+		/// the caret delta position the caret will be moved this number
+		/// of bytes (e.g. the number of bytes inserted before the caret, or
+		/// removed, if this number is negative)
+		/// &lt;/returns&gt;
+		public virtual int FormatLine (IFormattableDocument d, int line, int cursorOffset, char ch)
+		{
+			if (ch == '\n')
+				return IndentLine (d, line);
+			
+			return 0;
+		}
+		
+		/// &lt;summary&gt;
+		/// This function sets the indentation level in a specific line
+		/// &lt;/summary&gt;
+		/// &lt;returns&gt;
+		/// the number of inserted characters.
+		/// &lt;/returns&gt;
+		public int IndentLine (IFormattableDocument d, int line)
+		{
+			switch (d.IndentStyle) {
+				case IndentStyle.Auto  : return AutoIndentLine (d, line);
+				case IndentStyle.Smart : return SmartIndentLine (d, line);
+				case IndentStyle.None  :
+				default                : return 0;
+			}
+		}
+		
+		/// &lt;summary&gt;
+		/// This function sets the indentlevel in a range of lines.
+		/// &lt;/summary&gt;
+		public void IndentLines (IFormattableDocument d, int begin, int end)
+		{
+			d.BeginAtomicUndo ();
+			
+			for (int i = begin; i &lt;= end; ++i)
+				IndentLine (d, i);
+			
+			d.EndAtomicUndo ();
+		}
+	}
+}

Modified: trunk/MonoDevelop/src/Libraries/ICSharpCode.TextEditor/Makefile
===================================================================
--- trunk/MonoDevelop/src/Libraries/ICSharpCode.TextEditor/Makefile	2004-02-01 01:30:26 UTC (rev 738)
+++ trunk/MonoDevelop/src/Libraries/ICSharpCode.TextEditor/Makefile	2004-02-01 01:37:34 UTC (rev 739)
@@ -85,7 +85,6 @@
 ./src/Document/DefaultDocument.cs \
 ./src/Document/IDocument.cs \
 ./src/Document/AbstractSegment.cs \
-./src/Document/FormattingStrategy/DefaultFormattingStrategy.cs \
 ./src/Document/TextBufferStrategy/StringTextBufferStrategy.cs \
 ./src/Document/TextBufferStrategy/GapTextBufferStrategy.cs \
 ./src/Document/TextBufferStrategy/ITextBufferStrategy.cs \


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000343.html">[Monodevelop-patches-list] r738 - in trunk/MonoDevelop/src: AddIns/BackendBindings/CSharpBinding AddIns/BackendBindings/CSharpBinding/FormattingStrategy AddIns/DisplayBindings/EditorBindings AddIns/DisplayBindings/EditorBindings/FormattingStrategy AddIns/DisplayBindings/TextEditor AddIns/DisplayBindings/TextEditor/Commands AddIns/DisplayBindings/TextEditor/Gui/Editor AddIns/DisplayBindings/TextEditor/Gui/OptionPanels Libraries/ICSharpCode.TextEditor Libraries/ICSharpCode.TextEditor/src/Actions Libraries/ICSharpCode.TextEditor/src/Document Libraries/ICSharpCode.TextEditor/src/Document/FormattingStrategy Libraries/ICSharpCode.TextEditor/src/Gui Libraries/ICSharpCode.TextEditor/src/Undo
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#344">[ date ]</a>
              <a href="thread.html#344">[ thread ]</a>
              <a href="subject.html#344">[ subject ]</a>
              <a href="author.html#344">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
