<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r731 - in trunk/MonoDevelop/src/Main/Base: Commands Gui/Components Internal/Codons/MenuItems Services/MenuService
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r731%20-%20in%20trunk/MonoDevelop/src/Main/Base%3A%20Commands%20Gui/Components%20Internal/Codons/MenuItems%20Services/MenuService&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000335.html">
   <LINK REL="Next"  HREF="000337.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r731 - in trunk/MonoDevelop/src/Main/Base: Commands Gui/Components Internal/Codons/MenuItems Services/MenuService</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r731%20-%20in%20trunk/MonoDevelop/src/Main/Base%3A%20Commands%20Gui/Components%20Internal/Codons/MenuItems%20Services/MenuService&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r731 - in trunk/MonoDevelop/src/Main/Base: Commands Gui/Components Internal/Codons/MenuItems Services/MenuService">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sat Jan 31 01:48:25 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000335.html">[Monodevelop-patches-list] r730 - trunk/MonoDevelop/src/Main/Base/Gui/Components
</A></li>
        <LI>Next message: <A HREF="000337.html">[Monodevelop-patches-list] r732 - trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Gui/Editor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#336">[ date ]</a>
              <a href="thread.html#336">[ thread ]</a>
              <a href="subject.html#336">[ subject ]</a>
              <a href="author.html#336">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-01-31 01:48:25 -0500 (Sat, 31 Jan 2004)
New Revision: 731

Modified:
   trunk/MonoDevelop/src/Main/Base/Commands/MenuItemBuilders.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenu.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuCommand.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuSeparator.cs
   trunk/MonoDevelop/src/Main/Base/Internal/Codons/MenuItems/MenuItemCodon.cs
   trunk/MonoDevelop/src/Main/Base/Services/MenuService/MenuService.cs
Log:
you know what every sexy patch needs, lots of sexy bugfixes. enjoy


Modified: trunk/MonoDevelop/src/Main/Base/Commands/MenuItemBuilders.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Commands/MenuItemBuilders.cs	2004-01-31 05:48:23 UTC (rev 730)
+++ trunk/MonoDevelop/src/Main/Base/Commands/MenuItemBuilders.cs	2004-01-31 06:48:25 UTC (rev 731)
@@ -45,6 +45,7 @@
 				for (int i = 0; i &lt; recentOpen.RecentFile.Count; ++i) {
 					string accelaratorKeyPrefix = i &lt; 10 ? &quot;&amp;&quot; + ((i + 1) % 10).ToString() + &quot; &quot; : &quot;&quot;;
 					items[i] = new SdMenuCommand(null, null, accelaratorKeyPrefix + recentOpen.RecentFile[i].ToString(), new EventHandler(LoadRecentFile));
+					items[i].Key = recentOpen.RecentFile[i].ToString ();
 					items[i].Tag = recentOpen.RecentFile[i].ToString();
 					items[i].Description = stringParserService.Parse(resourceService.GetString(&quot;Dialog.Componnents.RichMenuItem.LoadFileDescription&quot;),
 					                                          new string[,] { {&quot;FILE&quot;, recentOpen.RecentFile[i].ToString()} });
@@ -81,6 +82,7 @@
 				for (int i = 0; i &lt; recentOpen.RecentProject.Count; ++i) {
 					string accelaratorKeyPrefix = i &lt; 10 ? &quot;&amp;&quot; + ((i + 1) % 10).ToString() + &quot; &quot; : &quot;&quot;;
 					items[i] = new SdMenuCommand(null, null, accelaratorKeyPrefix + recentOpen.RecentProject[i].ToString(), new EventHandler(LoadRecentProject));
+					items[i].Key = recentOpen.RecentProject[i].ToString ();
 					items[i].Tag = recentOpen.RecentProject[i].ToString();
 					items[i].Description = stringParserService.Parse(resourceService.GetString(&quot;Dialog.Componnents.RichMenuItem.LoadProjectDescription&quot;),
 					                                         new string[,] { {&quot;PROJECT&quot;, recentOpen.RecentProject[i].ToString()} });
@@ -183,7 +185,7 @@
 				return new Gtk.MenuItem[] {};
 			}
 			Gtk.MenuItem[] items = new Gtk.MenuItem[contentCount + 1];
-			items[0] = new SdMenuSeparator(null, null);
+			items [0] = new SdMenuSeparator (&quot;OpenFilesSep&quot;, null, null);
 			for (int i = 0; i &lt; contentCount; ++i) {
 				IViewContent content = (IViewContent)WorkbenchSingleton.Workbench.ViewContentCollection[i];
 				

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenu.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenu.cs	2004-01-31 05:48:23 UTC (rev 730)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenu.cs	2004-01-31 06:48:25 UTC (rev 731)
@@ -120,16 +120,16 @@
 
 		public void Append (Gtk.Widget item)
 		{
-			if (item.Parent == null) {
-				foreach (IStatusUpdate obj in subMenu.Children)
-				{
-					if (obj is SdMenuSeparator)
-						continue;
-					if (obj.Key == ((IStatusUpdate)item).Key)
-						return;
+			try {
+				if (item.Parent == null || (item as IStatusUpdate == null)) {
+					foreach (IStatusUpdate obj in subMenu.Children)
+					{
+						if (obj.Key == ((IStatusUpdate)item).Key)
+							return;
+					}
+					subMenu.Append (item);
 				}
-				subMenu.Append (item);
-			}
+			} catch { }
 		}
 	}
 }

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuCommand.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuCommand.cs	2004-01-31 05:48:23 UTC (rev 730)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuCommand.cs	2004-01-31 06:48:25 UTC (rev 731)
@@ -105,7 +105,7 @@
 			this.Activated += handler;
 			UpdateStatus();
 		}
-		
+
 		public SdMenuCommand(object caller, string label, EventHandler handler) : this(stringParserService.Parse(label))
 		{
 			this.caller = caller;

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuSeparator.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuSeparator.cs	2004-01-31 05:48:23 UTC (rev 730)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Components/SdMenuSeparator.cs	2004-01-31 06:48:25 UTC (rev 731)
@@ -28,11 +28,12 @@
 			set { key = value; }
 		}
 		
-		public SdMenuSeparator()
+		public SdMenuSeparator(string id)
 		{
+			key = id;
 		}
 		
-		public SdMenuSeparator(ConditionCollection conditionCollection, object caller)
+		public SdMenuSeparator(string id, ConditionCollection conditionCollection, object caller) : this (id)
 		{
 			this.caller              = caller;
 			this.conditionCollection = conditionCollection;

Modified: trunk/MonoDevelop/src/Main/Base/Internal/Codons/MenuItems/MenuItemCodon.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Internal/Codons/MenuItems/MenuItemCodon.cs	2004-01-31 05:48:23 UTC (rev 730)
+++ trunk/MonoDevelop/src/Main/Base/Internal/Codons/MenuItems/MenuItemCodon.cs	2004-01-31 06:48:25 UTC (rev 731)
@@ -100,7 +100,7 @@
 		{
 			Gtk.MenuItem newItem = null;
 			if (Label == &quot;-&quot;) {
-				newItem = new SdMenuSeparator(conditions, owner);
+				newItem = new SdMenuSeparator(ID, conditions, owner);
 			} else  if (Link != null) {
 				newItem = new SdMenuCommand(conditions, null, Label,  Link.StartsWith(&quot;http&quot;) ? (IMenuCommand)new GotoWebSite(Link) : (IMenuCommand)new GotoLink(Link));
 			} else {

Modified: trunk/MonoDevelop/src/Main/Base/Services/MenuService/MenuService.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Services/MenuService/MenuService.cs	2004-01-31 05:48:23 UTC (rev 730)
+++ trunk/MonoDevelop/src/Main/Base/Services/MenuService/MenuService.cs	2004-01-31 06:48:25 UTC (rev 731)
@@ -118,7 +118,7 @@
 			Gtk.Menu contextMenu = new Gtk.Menu();
 			for (int i = 0; i &lt; quickInsertMenuItems.GetLength(0); ++i) {
 				if (quickInsertMenuItems[i, 0] == &quot;-&quot;) {
-					contextMenu.Append(new SdMenuSeparator());
+					contextMenu.Append(new SdMenuSeparator(&quot;-&quot;));
 				} else {
 					SdMenuCommand cmd = new SdMenuCommand(this,
 					                                      stringParserService.Parse(quickInsertMenuItems[i, 0]),


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000335.html">[Monodevelop-patches-list] r730 - trunk/MonoDevelop/src/Main/Base/Gui/Components
</A></li>
	<LI>Next message: <A HREF="000337.html">[Monodevelop-patches-list] r732 - trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Gui/Editor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#336">[ date ]</a>
              <a href="thread.html#336">[ thread ]</a>
              <a href="subject.html#336">[ subject ]</a>
              <a href="author.html#336">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
