<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r681 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r681%20-%20trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000285.html">
   <LINK REL="Next"  HREF="000287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r681 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r681%20-%20trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r681 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Tue Jan 27 13:00:34 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000285.html">[Monodevelop-patches-list] r680 - in trunk/MonoDevelop: . build/AddIns src/AddIns/DisplayBindings/SourceEditor src/AddIns/DisplayBindings/SourceEditor/Gui src/Main/Core/AddIns
</A></li>
        <LI>Next message: <A HREF="000287.html">[Monodevelop-patches-list] r682 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#286">[ date ]</a>
              <a href="thread.html#286">[ thread ]</a>
              <a href="subject.html#286">[ subject ]</a>
              <a href="author.html#286">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: benm
Date: 2004-01-27 13:00:34 -0500 (Tue, 27 Jan 2004)
New Revision: 681

Modified:
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs
Log:
refactor

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs	2004-01-27 17:47:35 UTC (rev 680)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorBuffer.cs	2004-01-27 18:00:34 UTC (rev 681)
@@ -1,12 +1,21 @@
 using Gtk;
 using GtkSharp;
 
+using ICSharpCode.SharpDevelop.Gui;
+using ICSharpCode.SharpDevelop.Internal.Project;
+using ICSharpCode.Core.Properties;
+using ICSharpCode.Core.AddIns;
+using ICSharpCode.Core.Services;
+using ICSharpCode.SharpDevelop.Services;
+using ICSharpCode.Core.AddIns.Codons;
+
 using System;
 using System.IO;
 using System.Runtime.InteropServices;
 	
 namespace MonoDevelop.SourceEditor.Gui {
-	public class SourceEditorBuffer : SourceBuffer {
+	public class SourceEditorBuffer : SourceBuffer,
+		IClipboardHandler {
 		
 		SourceLanguagesManager slm = new SourceLanguagesManager ();
 		
@@ -41,5 +50,73 @@
 			s.Write (Text);
 			s.Close ();
 		}
+
+#region IClipboardHandler
+		bool HasSelection {
+			get {
+				TextIter dummy, dummy2;
+				return GetSelectionBounds (out dummy, out dummy2);
+			}
+		}
+		
+		bool IClipboardHandler.EnableCut {
+			get { return HasSelection; }
+		}
+		
+		bool IClipboardHandler.EnableCopy {
+			get { return HasSelection; }
+		}
+		
+		bool IClipboardHandler.EnablePaste {
+			get {
+				return clipboard.WaitIsTextAvailable ();
+			}
+		}
+		
+		bool IClipboardHandler.EnableDelete {
+			get { return HasSelection; }
+		}
+		
+		bool IClipboardHandler.EnableSelectAll {
+			get { return true; }
+		}
+		
+		void IClipboardHandler.Cut (object sender, EventArgs e)
+		{
+			CutClipboard (clipboard, true);
+		}
+		
+		void IClipboardHandler.Copy (object sender, EventArgs e)
+		{
+			CopyClipboard (clipboard);
+		}
+		
+		void IClipboardHandler.Paste (object sender, EventArgs e)
+		{
+			PasteClipboard (clipboard);
+		}
+		
+		void IClipboardHandler.Delete (object sender, EventArgs e)
+		{
+			DeleteSelection (true, true);
+		}
+		
+		void IClipboardHandler.SelectAll (object sender, EventArgs e)
+		{
+			// Sadly, this is not in our version of the bindings:
+			//
+			//gtk_text_view_select_all (GtkWidget *widget,
+			//			  gboolean select)
+			//{
+			//	gtk_text_buffer_get_bounds (buffer, &amp;start_iter, &amp;end_iter);
+			//	gtk_text_buffer_move_mark_by_name (buffer, &quot;insert&quot;, &amp;start_iter);
+			//	gtk_text_buffer_move_mark_by_name (buffer, &quot;selection_bound&quot;, &amp;end_iter);
+			
+			MoveMark (&quot;insert&quot;, StartIter);
+			MoveMark (&quot;selection_bound&quot;, EndIter);
+		}
+		
+		Gtk.Clipboard clipboard = Gtk.Clipboard.Get (Gdk.Atom.Intern (&quot;CLIPBOARD&quot;, false));
+#endregion
 	}
 }
\ No newline at end of file

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-01-27 17:47:35 UTC (rev 680)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-01-27 18:00:34 UTC (rev 681)
@@ -62,7 +62,7 @@
 	}
 	
 	public class SourceEditorDisplayBindingWrapper : AbstractViewContent,
-		IEditable, IClipboardHandler
+		IEditable
 	{
 		internal SourceEditor se;
 		
@@ -122,7 +122,7 @@
 		
 #region IEditable
 		public IClipboardHandler ClipboardHandler {
-			get { return this; }
+			get { return se.Buffer; }
 		}
 		
 		public string Text {
@@ -140,76 +140,6 @@
 			se.Buffer.Redo ();
 		}
 #endregion
-#region IClipboardHandler
-		//
-		// TODO: All of this ;-)
-		//
-		
-		bool HasSelection {
-			get {
-				TextIter dummy, dummy2;
-				return se.Buffer.GetSelectionBounds (out dummy, out dummy2);
-			}
-		}
-		
-		public bool EnableCut {
-			get { return HasSelection; }
-		}
-		
-		public bool EnableCopy {
-			get { return HasSelection; }
-		}
-		
-		public bool EnablePaste {
-			get {
-				return clipboard.WaitIsTextAvailable ();
-			}
-		}
-		
-		public bool EnableDelete {
-			get { return HasSelection; }
-		}
-		
-		public bool EnableSelectAll {
-			get { return true; }
-		}
-		
-		public void Cut (object sender, EventArgs e)
-		{
-			se.Buffer.CutClipboard (clipboard, true);
-		}
-		
-		public void Copy (object sender, EventArgs e)
-		{
-			se.Buffer.CopyClipboard (clipboard);
-		}
-		
-		public void Paste (object sender, EventArgs e)
-		{
-			se.Buffer.PasteClipboard (clipboard);
-		}
-		
-		public void Delete (object sender, EventArgs e)
-		{
-			se.Buffer.DeleteSelection (true, true);
-		}
-		
-		public void SelectAll (object sender, EventArgs e)
-		{
-			// Sadly, this is not in our version of the bindings:
-			//
-			//gtk_text_view_select_all (GtkWidget *widget,
-			//			  gboolean select)
-			//{
-			//	gtk_text_buffer_get_bounds (buffer, &amp;start_iter, &amp;end_iter);
-			//	gtk_text_buffer_move_mark_by_name (buffer, &quot;insert&quot;, &amp;start_iter);
-			//	gtk_text_buffer_move_mark_by_name (buffer, &quot;selection_bound&quot;, &amp;end_iter);
-			
-			se.Buffer.MoveMark (&quot;insert&quot;, se.Buffer.StartIter);
-			se.Buffer.MoveMark (&quot;selection_bound&quot;, se.Buffer.EndIter);
-		}
-		
-		Gtk.Clipboard clipboard = Gtk.Clipboard.Get (Gdk.Atom.Intern (&quot;CLIPBOARD&quot;, false));
-#endregion
+
 	}
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs	2004-01-27 17:47:35 UTC (rev 680)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorWidget.cs	2004-01-27 18:00:34 UTC (rev 681)
@@ -11,7 +11,6 @@
 		public readonly SourceEditorBuffer Buffer;
 		SourceView sv;
 		
-
 		public SourceEditor ()
 		{
 			Buffer = new SourceEditorBuffer ();
@@ -26,8 +25,6 @@
 			
 			Add (sv);
 		}
-
-
 		
 		public string Text {
 			get { return Buffer.Text; }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000285.html">[Monodevelop-patches-list] r680 - in trunk/MonoDevelop: . build/AddIns src/AddIns/DisplayBindings/SourceEditor src/AddIns/DisplayBindings/SourceEditor/Gui src/Main/Core/AddIns
</A></li>
	<LI>Next message: <A HREF="000287.html">[Monodevelop-patches-list] r682 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#286">[ date ]</a>
              <a href="thread.html#286">[ thread ]</a>
              <a href="subject.html#286">[ subject ]</a>
              <a href="author.html#286">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
