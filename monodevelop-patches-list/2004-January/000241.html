<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r636 - in trunk/MonoDevelop/src/Main/Base: Gui/Pads/ClassScout Gui/Pads/ClassScout/NodeBuilder Internal/CollectionUtilities
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r636%20-%20in%20trunk/MonoDevelop/src/Main/Base%3A%20Gui/Pads/ClassScout%20Gui/Pads/ClassScout/NodeBuilder%20Internal/CollectionUtilities&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000240.html">
   <LINK REL="Next"  HREF="000242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r636 - in trunk/MonoDevelop/src/Main/Base: Gui/Pads/ClassScout Gui/Pads/ClassScout/NodeBuilder Internal/CollectionUtilities</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r636%20-%20in%20trunk/MonoDevelop/src/Main/Base%3A%20Gui/Pads/ClassScout%20Gui/Pads/ClassScout/NodeBuilder%20Internal/CollectionUtilities&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r636 - in trunk/MonoDevelop/src/Main/Base: Gui/Pads/ClassScout Gui/Pads/ClassScout/NodeBuilder Internal/CollectionUtilities">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sat Jan 24 20:20:49 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000240.html">[Monodevelop-patches-list] r635 - in trunk/MonoDevelop/src: Libraries/MonoDevelop.Gui/Tree Main/Base/Gui/Pads/ProjectBrowser Main/Base/Gui/Pads/ProjectBrowser/NodeBuilder Main/Base/Internal/CollectionUtilities
</A></li>
        <LI>Next message: <A HREF="000242.html">[Monodevelop-patches-list] r637 - in trunk/MonoDevelop/src/Main/Base: Gui/Pads/ProjectBrowser Internal/CollectionUtilities
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#241">[ date ]</a>
              <a href="thread.html#241">[ thread ]</a>
              <a href="subject.html#241">[ subject ]</a>
              <a href="author.html#241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: benm
Date: 2004-01-24 20:20:48 -0500 (Sat, 24 Jan 2004)
New Revision: 636

Modified:
   trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/ClassScout.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/NodeBuilder/DefaultDotNetClassScoutNodeBuilder.cs
   trunk/MonoDevelop/src/Main/Base/Internal/CollectionUtilities/Comparers.cs
Log:
bring sorting to the class browser. we take a pretty big perf hit, we should look at this

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/ClassScout.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/ClassScout.cs	2004-01-25 01:01:07 UTC (rev 635)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/ClassScout.cs	2004-01-25 01:20:48 UTC (rev 636)
@@ -99,7 +99,7 @@
 			// TODO
 		}
 		
-		public ClassScout()
+		public ClassScout() : base (false, TreeNodeComparer.GtkDefault)
 		{
 			addParseInformationHandler = new ParseInformationEventHandler(OnParseInformationAdded);
 			removeParseInformationHandler = new ParseInformationEventHandler(OnParseInformationRemoved);
@@ -323,7 +323,7 @@
 					Populate(((CombineCombineEntry)entry).Combine, combineNode.Nodes);
 				}
 			}
-			SortUtility.QuickSort(combineNode.Nodes, TreeNodeComparer.Default);
+			
 			nodes.Add(combineNode);
 		}
 

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/NodeBuilder/DefaultDotNetClassScoutNodeBuilder.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/NodeBuilder/DefaultDotNetClassScoutNodeBuilder.cs	2004-01-25 01:01:07 UTC (rev 635)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Pads/ClassScout/NodeBuilder/DefaultDotNetClassScoutNodeBuilder.cs	2004-01-25 01:20:48 UTC (rev 636)
@@ -59,14 +59,14 @@
 			
 			ICompilationUnit unit = (ICompilationUnit)e.ParseInformation.MostRecentCompilationUnit;
 			foreach (IClass c in unit.Classes) {
-				classNode.Text = c.Name;
-				//classNode.SelectedImageIndex = classNode.ImageIndex = classBrowserIconService.GetIcon(c);
-				classNode.Image = classBrowserIconService.ImageList[classBrowserIconService.GetIcon(c)];
+				// TODO: Perf check
 				TreeNode node = GetNodeByPath(c.Namespace, parentNode.Nodes, false);
 				if (node != null) {
-					int oldIndex = SortUtility.BinarySearch(classNode, node.Nodes, TreeNodeComparer.Default);
-					if(oldIndex &gt;= 0) {
-						node.Nodes[oldIndex].Remove();
+					foreach (TreeNode nd in node.Nodes) {
+						if (nd.Text == c.Name) {
+							nd.Remove ();
+							return;
+						}
 					}
 				}
 			}
@@ -76,10 +76,8 @@
 		{
 			TreeNode newNode = BuildClassTreeNode((IProject)projectNode.Tag, imageIndexOffset);
 			projectNode.Nodes.Clear();
-			foreach (TreeNode node in newNode.Nodes) {
+			foreach (TreeNode node in newNode.Nodes)
 				projectNode.Nodes.Add(node);
-			}
-			SortUtility.QuickSort(projectNode.Nodes, TreeNodeComparer.Default);
 		}
 
 		public TreeNode BuildClassTreeNode(IProject p, int imageIndexOffset)
@@ -139,7 +137,8 @@
 				
 				TreeNode classNode = BuildClassNode(filename, c);
 				if(classNode != null) {
-					SortUtility.SortedInsert(classNode, node.Nodes, TreeNodeComparer.Default);
+					node.Nodes.Add (classNode);
+					
 					if (wasExpanded) {
 						classNode.Expand();
 					}
@@ -209,7 +208,6 @@
 				classNode.Nodes.Add(eventNode);
 			}
 			
-			SortUtility.QuickSort(classNode.Nodes, TreeNodeComparer.Default);
 			return classNode;
 		}
 		
@@ -232,7 +230,7 @@
 						//newnode.ImageIndex = newnode.SelectedImageIndex = classBrowserIconService.NamespaceIndex;
 						newnode.Image = classBrowserIconService.ImageList[classBrowserIconService.NamespaceIndex];
 
-						SortUtility.SortedInsert(newnode, curcollection, TreeNodeComparer.Default);
+						curcollection.Add (newnode);
 						curnode = newnode;
 						curcollection = curnode.Nodes;
 						continue;

Modified: trunk/MonoDevelop/src/Main/Base/Internal/CollectionUtilities/Comparers.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Internal/CollectionUtilities/Comparers.cs	2004-01-25 01:01:07 UTC (rev 635)
+++ trunk/MonoDevelop/src/Main/Base/Internal/CollectionUtilities/Comparers.cs	2004-01-25 01:20:48 UTC (rev 636)
@@ -107,6 +107,7 @@
 		public static IComparer Default    = new TreeNodeComparer();
 		public static IComparer ProjectNode = new ProjectNodeComparer();
 		public static Gtk.TreeIterCompareFunc GtkProjectNode = new Gtk.TreeIterCompareFunc (GtkProjectNodeComparer);
+		public static Gtk.TreeIterCompareFunc GtkDefault = new Gtk.TreeIterCompareFunc (GtkDefaultComparer);
 			
 		static int GtkProjectNodeComparer (Gtk.TreeModel model, Gtk.TreeIter a, Gtk.TreeIter b)
 		{
@@ -133,6 +134,15 @@
 			return x.Text.CompareTo(y.Text);
 		}
 		
+		static int GtkDefaultComparer (Gtk.TreeModel model, Gtk.TreeIter a, Gtk.TreeIter b)
+		{
+			Gtk.TreeStore ts = (Gtk.TreeStore) model;
+			TreeNode x = (TreeNode) ts.GetValue (a, 2);
+			TreeNode y = (TreeNode) ts.GetValue (b, 2);
+			
+			return x.Text.CompareTo (y.Text);
+		}
+		
 		protected TreeNodeComparer() {}
 		
 		public int Compare(TreeNode x, TreeNode y) {


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000240.html">[Monodevelop-patches-list] r635 - in trunk/MonoDevelop/src: Libraries/MonoDevelop.Gui/Tree Main/Base/Gui/Pads/ProjectBrowser Main/Base/Gui/Pads/ProjectBrowser/NodeBuilder Main/Base/Internal/CollectionUtilities
</A></li>
	<LI>Next message: <A HREF="000242.html">[Monodevelop-patches-list] r637 - in trunk/MonoDevelop/src/Main/Base: Gui/Pads/ProjectBrowser Internal/CollectionUtilities
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#241">[ date ]</a>
              <a href="thread.html#241">[ thread ]</a>
              <a href="subject.html#241">[ subject ]</a>
              <a href="author.html#241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
