<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r742 - in trunk/MonoDevelop: build/AddIns src/AddIns/BackendBindings/CSharpBinding src/AddIns/DisplayBindings/TextEditor/Search src/Main/Base/Gui src/Main/Base/Gui/Pads src/Main/Base/Services
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r742%20-%20in%20trunk/MonoDevelop%3A%20build/AddIns%20src/AddIns/BackendBindings/CSharpBinding%20src/AddIns/DisplayBindings/TextEditor/Search%20src/Main/Base/Gui%20src/Main/Base/Gui/Pads%20src/Main/Base/Services&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000346.html">
   <LINK REL="Next"  HREF="000348.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r742 - in trunk/MonoDevelop: build/AddIns src/AddIns/BackendBindings/CSharpBinding src/AddIns/DisplayBindings/TextEditor/Search src/Main/Base/Gui src/Main/Base/Gui/Pads src/Main/Base/Services</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r742%20-%20in%20trunk/MonoDevelop%3A%20build/AddIns%20src/AddIns/BackendBindings/CSharpBinding%20src/AddIns/DisplayBindings/TextEditor/Search%20src/Main/Base/Gui%20src/Main/Base/Gui/Pads%20src/Main/Base/Services&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r742 - in trunk/MonoDevelop: build/AddIns src/AddIns/BackendBindings/CSharpBinding src/AddIns/DisplayBindings/TextEditor/Search src/Main/Base/Gui src/Main/Base/Gui/Pads src/Main/Base/Services">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sun Feb  1 16:51:57 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000346.html">[Monodevelop-patches-list] r741 - trunk/MonoDevelop/data/resources/glade
</A></li>
        <LI>Next message: <A HREF="000348.html">[Monodevelop-patches-list] r743 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#347">[ date ]</a>
              <a href="thread.html#347">[ thread ]</a>
              <a href="subject.html#347">[ subject ]</a>
              <a href="author.html#347">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: benm
Date: 2004-02-01 16:51:57 -0500 (Sun, 01 Feb 2004)
New Revision: 742

Modified:
   trunk/MonoDevelop/build/AddIns/SharpDevelopCore.addin
   trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Search/SearchReplaceInFilesManager.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Pads/OpenTaskView.cs
   trunk/MonoDevelop/src/Main/Base/Gui/PixbufList.cs
   trunk/MonoDevelop/src/Main/Base/Services/ResourceService.cs
Log:
task list

Modified: trunk/MonoDevelop/build/AddIns/SharpDevelopCore.addin
===================================================================
--- trunk/MonoDevelop/build/AddIns/SharpDevelopCore.addin	2004-02-01 12:19:18 UTC (rev 741)
+++ trunk/MonoDevelop/build/AddIns/SharpDevelopCore.addin	2004-02-01 21:51:57 UTC (rev 742)
@@ -385,12 +385,13 @@
 		       class = &quot;ICSharpCode.SharpDevelop.Gui.Pads.ClassScout&quot;/&gt;
 		&lt;Class id    = &quot;FileScout&quot; 
 		       class = &quot;ICSharpCode.SharpDevelop.Gui.Pads.FileScout&quot;/&gt;
+		&lt;Class id    = &quot;OpenTaskView&quot; 
+		       class = &quot;ICSharpCode.SharpDevelop.Gui.Pads.OpenTaskView&quot;/&gt;
 &lt;!--			   
 		&lt;Class id    = &quot;SideBar&quot; 
 		       class = &quot;ICSharpCode.SharpDevelop.Gui.Pads.SideBarView&quot;/&gt;
 		
-		&lt;Class id    = &quot;OpenTaskView&quot; 
-		       class = &quot;ICSharpCode.SharpDevelop.Gui.Pads.OpenTaskView&quot;/&gt;
+
 		&lt;Class id    = &quot;PropertyPad&quot; 
 		       class = &quot;ICSharpCode.SharpDevelop.Gui.Pads.PropertyPad&quot;/&gt;
 		       

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs	2004-02-01 12:19:18 UTC (rev 741)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs	2004-02-01 21:51:57 UTC (rev 742)
@@ -313,31 +313,10 @@
 					continue;
 				}
 				
-				CompilerError error = new CompilerError();
+				CompilerError error = CreateErrorFromString (curLine);
 				
-				// try to match standard errors
-				Match match = normalError.Match(curLine);
-				if (match.Success) {
-					error.Column      = Int32.Parse(match.Result(&quot;${column}&quot;));
-					error.Line        = Int32.Parse(match.Result(&quot;${line}&quot;));
-					error.FileName    = Path.GetFullPath(match.Result(&quot;${file}&quot;));
-					error.IsWarning   = match.Result(&quot;${error}&quot;) == &quot;warning&quot;; 
-					error.ErrorNumber = match.Result(&quot;${number}&quot;);
-					error.ErrorText   = match.Result(&quot;${message}&quot;);
-				} else {
-					match = generalError.Match(curLine); // try to match general csc errors
-					if (match.Success) {
-						error.IsWarning   = match.Result(&quot;${error}&quot;) == &quot;warning&quot;; 
-						error.ErrorNumber = match.Result(&quot;${number}&quot;);
-						error.ErrorText   = match.Result(&quot;${message}&quot;);
-					} else { // give up and skip the line
-						continue;
-//						error.IsWarning = false;
-//						error.ErrorText = curLine;
-					}
-				}
-				
-				cr.Errors.Add(error);
+				if (error != null)
+					cr.Errors.Add (error);
 			}
 			sr.Close();
 			return new DefaultCompilerResult(cr, compilerOutput.ToString());
@@ -357,5 +336,34 @@
 			p.Start();
 			p.WaitForExit();
 		}
+		
+		// Snatched from our codedom code :-).
+		static Regex regexError = new Regex (@&quot;^(\s*(?&lt;file&gt;.*)\((?&lt;line&gt;\d*)(,(?&lt;column&gt;\d*))?\)\s+)*(?&lt;level&gt;\w+)\s*(?&lt;number&gt;.*):\s(?&lt;message&gt;.*)&quot;,
+			RegexOptions.Compiled | RegexOptions.ExplicitCapture);
+		private static CompilerError CreateErrorFromString(string error_string)
+		{
+			// When IncludeDebugInformation is true, prevents the debug symbols stats from braeking this.
+			if (error_string.StartsWith (&quot;WROTE SYMFILE&quot;) ||
+			    error_string.StartsWith (&quot;OffsetTable&quot;) ||
+			    error_string.StartsWith (&quot;Compilation succeeded&quot;) ||
+			    error_string.StartsWith (&quot;Compilation failed&quot;))
+				return null;
+
+			CompilerError error = new CompilerError();
+
+			Match match=regexError.Match(error_string);
+			if (!match.Success) return null;
+			if (String.Empty != match.Result(&quot;${file}&quot;))
+				error.FileName=match.Result(&quot;${file}&quot;);
+			if (String.Empty != match.Result(&quot;${line}&quot;))
+				error.Line=Int32.Parse(match.Result(&quot;${line}&quot;));
+			if (String.Empty != match.Result(&quot;${column}&quot;))
+				error.Column=Int32.Parse(match.Result(&quot;${column}&quot;));
+			if (match.Result(&quot;${level}&quot;)==&quot;warning&quot;)
+				error.IsWarning=true;
+			error.ErrorNumber=match.Result(&quot;${number}&quot;);
+			error.ErrorText=match.Result(&quot;${message}&quot;);
+			return error;
+		}
 	}
 }

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Search/SearchReplaceInFilesManager.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Search/SearchReplaceInFilesManager.cs	2004-02-01 12:19:18 UTC (rev 741)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Search/SearchReplaceInFilesManager.cs	2004-02-01 21:51:57 UTC (rev 742)
@@ -98,8 +98,8 @@
 			TaskService taskService = (TaskService)ICSharpCode.Core.Services.ServiceManager.Services.GetService(typeof(TaskService));
 			taskService.NotifyTaskChange();
 			
-			//OpenTaskView taskView = WorkbenchSingleton.Workbench.GetPad(typeof(OpenTaskView)) as OpenTaskView;
-			//if (taskView != null) taskView.BringToFront();
+			OpenTaskView taskView = WorkbenchSingleton.Workbench.GetPad(typeof(OpenTaskView)) as OpenTaskView;
+			if (taskView != null) taskView.BringToFront();
 		}
 		
 		public static void ReplaceAll()

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Pads/OpenTaskView.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Pads/OpenTaskView.cs	2004-02-01 12:19:18 UTC (rev 741)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Pads/OpenTaskView.cs	2004-02-01 21:51:57 UTC (rev 742)
@@ -14,25 +14,27 @@
 using ICSharpCode.Core.Services;
 using ICSharpCode.SharpDevelop.Services;
 
+using GtkSharp;
+
 using ICSharpCode.Core.Properties;
 
-namespace ICSharpCode.SharpDevelop.Gui.Pads
-{
-/*	public class OpenTaskView : ListView, IPadContent
-	{
-		Panel     myPanel  = new Panel();
-		ResourceService resourceService = (ResourceService)ServiceManager.Services.GetService(typeof(IResourceService));
+namespace ICSharpCode.SharpDevelop.Gui.Pads {
+	public class OpenTaskView : IPadContent {
 		
+		ResourceService resourceService = (ResourceService) ServiceManager.Services.GetService (typeof (IResourceService));
+		Gtk.ScrolledWindow sw;
+		Gtk.TreeView view;
+		Gtk.ListStore store;
+		
 		public Gtk.Widget Control {
 			get {
-				return null;
-				// return myPanel; FIXME
+				return sw;
 			}
 		}
 		
 		public string Title {
 			get {
-				return resourceService.GetString(&quot;MainWindow.Windows.TaskList&quot;);
+				return resourceService.GetString (&quot;MainWindow.Windows.TaskList&quot;);
 			}
 		}
 		
@@ -44,191 +46,134 @@
 		
 		public void RedrawContent()
 		{
-			line.Text        = resourceService.GetString(&quot;CompilerResultView.LineText&quot;);
-			description.Text = resourceService.GetString(&quot;CompilerResultView.DescriptionText&quot;);
-			file.Text        = resourceService.GetString(&quot;CompilerResultView.FileText&quot;);
-			path.Text        = resourceService.GetString(&quot;CompilerResultView.PathText&quot;);
-			OnTitleChanged(null);
-			OnIconChanged(null);
+			// FIXME
 		}
+
+		const int COL_TYPE = 0, COL_LINE = 1, COL_DESC = 2, COL_PATH = 3, COL_FILE = 4, COL_TASK = 5, COL_READ = 6, COL_MARKED = 7, COL_READ_WEIGHT = 8;
 		
-		ColumnHeader type        = new ColumnHeader();
-		ColumnHeader line        = new ColumnHeader();
-		ColumnHeader description = new ColumnHeader();
-		ColumnHeader file        = new ColumnHeader();
-		ColumnHeader path        = new ColumnHeader();
-		ToolTip taskToolTip = new ToolTip();
-		
 		public OpenTaskView()
 		{
+			TaskService taskService        = (TaskService) ServiceManager.Services.GetService (typeof(TaskService));
+			IProjectService projectService = (IProjectService) ServiceManager.Services.GetService (typeof(IProjectService));
 			
-			type.Text = &quot;!&quot;;
+
 			
-			RedrawContent();
 			
-			Columns.Add(type);
-			Columns.Add(line);
-			Columns.Add(description);
-			Columns.Add(file);
-			Columns.Add(path);
+			store = new Gtk.ListStore (
+				typeof (string),     // stock id
+				typeof (int),        // line
+				typeof (string),     // desc
+				typeof (string),     // path
+				typeof (string),     // file
+				typeof (Task),       // task
+				typeof (bool),       // read?
+				typeof (bool),       // marked?
+				typeof (int));       // read? -- use Pango weight
+				
+			view = new Gtk.TreeView (store);
+			view.RulesHint = true;
+			AddColumns ();
 			
-			FullRowSelect = true;
-			AutoArrange = true;
-			Alignment   = ListViewAlignment.Left;
-			View = View.Details;
-			Dock = DockStyle.Fill;
-			GridLines  = true;
-			Activation = ItemActivation.OneClick;
-			OnResize(null);
+			sw = new Gtk.ScrolledWindow ();
+			sw.Add (view);
 			
-			TaskService taskService        = (TaskService)ICSharpCode.Core.Services.ServiceManager.Services.GetService(typeof(TaskService));
-			IProjectService projectService = (IProjectService)ICSharpCode.Core.Services.ServiceManager.Services.GetService(typeof(IProjectService));
-			
-			taskService.TasksChanged  += new EventHandler(ShowResults);
-			
-			projectService.EndBuild   += new EventHandler(SelectTaskView);
-			
-			projectService.CombineOpened += new CombineEventHandler(OnCombineOpen);
-			projectService.CombineClosed += new CombineEventHandler(OnCombineClosed);
-			
-			myPanel.Controls.Add(this);
-			
-			ImageList imglist = new ImageList();
-			imglist.ColorDepth = ColorDepth.Depth32Bit;
-			imglist.Images.Add(resourceService.GetBitmap(&quot;Icons.16x16.Error&quot;));
-			imglist.Images.Add(resourceService.GetBitmap(&quot;Icons.16x16.Warning&quot;));
-			imglist.Images.Add(resourceService.GetBitmap(&quot;Icons.16x16.Information&quot;));
-			imglist.Images.Add(resourceService.GetBitmap(&quot;Icons.16x16.Question&quot;));
-			this.SmallImageList = this.LargeImageList = imglist;
-			
-//			type.Width = 24;
-//			line.Width = 50;
-//			description.Width = 600;
-//			file.Width = 150;
-//			path.Width = 300;
-			
-			// Set up the delays for the ToolTip.
-			taskToolTip.InitialDelay = 500;
-			taskToolTip.ReshowDelay = 100;
-			taskToolTip.AutoPopDelay = 5000;
-//
-//			// Force the ToolTip text to be displayed whether or not the form is active.
-//			taskToolTip.ShowAlways   = false;
-
-			this.CreateControl();
+			taskService.TasksChanged     += new EventHandler (ShowResults);
+			projectService.EndBuild      += new EventHandler (SelectTaskView);
+			projectService.CombineOpened += new CombineEventHandler (OnCombineOpen);
+			projectService.CombineClosed += new CombineEventHandler (OnCombineClosed);
+			view.RowActivated            += new RowActivatedHandler (OnRowActivated);
 		}
 		
-		protected override void Dispose(bool disposing)
+		string res (string s)
 		{
-//			if (disposing) {
-//				PropertyService propertyService = (PropertyService)ServiceManager.Services.GetService(typeof(PropertyService));
-//				propertyService.SetProperty(&quot;CompilerResultView.typeWidth&quot;, type.Width);
-//				propertyService.SetProperty(&quot;CompilerResultView.lineWidth&quot;, line.Width);
-//				propertyService.SetProperty(&quot;CompilerResultView.descriptionWidth&quot;, description.Width);
-//				propertyService.SetProperty(&quot;CompilerResultView.fileWidth&quot;, file.Width);
-//				propertyService.SetProperty(&quot;CompilerResultView.pathWidth&quot;, path.Width);
-//			}
-			base.Dispose(disposing);
+			return resourceService.GetString (s);
 		}
-		void OnCombineOpen(object sender, CombineEventArgs e)
+		
+		void MarkupCol (Gtk.TreeViewColumn col)
 		{
-			Items.Clear();
 		}
 		
-		void OnCombineClosed(object sender, CombineEventArgs e)
+		void AddColumns ()
 		{
-			Items.Clear();
+			Gtk.CellRendererPixbuf iconRender = new Gtk.CellRendererPixbuf ();
+			iconRender.StockSize = Gtk.IconSize.SmallToolbar;
+			
+			Gtk.CellRendererToggle toggleRender = new Gtk.CellRendererToggle ();
+			toggleRender.Toggled += new ToggledHandler (ItemToggled);
+			
+			Gtk.CellRendererText line = new Gtk.CellRendererText (), desc = new Gtk.CellRendererText () , path = new Gtk.CellRendererText (),
+			  file = new Gtk.CellRendererText ();
+			
+			view.AppendColumn (&quot;!&quot;                                        , iconRender   , &quot;stock-id&quot;, COL_TYPE);
+			view.AppendColumn (&quot;&quot;                                         , toggleRender , &quot;active&quot;  , COL_MARKED, &quot;activatable&quot;, COL_READ);
+			view.AppendColumn (res (&quot;CompilerResultView.LineText&quot;)        , line         , &quot;text&quot;    , COL_LINE, &quot;weight&quot;, COL_READ_WEIGHT);
+			view.AppendColumn (res (&quot;CompilerResultView.DescriptionText&quot;) , desc         , &quot;text&quot;    , COL_DESC, &quot;weight&quot;, COL_READ_WEIGHT, &quot;strikethrough&quot;, COL_MARKED);
+			view.AppendColumn (res (&quot;CompilerResultView.PathText&quot;)        , path         , &quot;text&quot;    , COL_PATH, &quot;weight&quot;, COL_READ_WEIGHT);
+			view.AppendColumn (res (&quot;CompilerResultView.FileText&quot;)        , file         , &quot;text&quot;    , COL_FILE, &quot;weight&quot;, COL_READ_WEIGHT);
 		}
 		
-		void SelectTaskView(object sender, EventArgs e)
+		void OnCombineOpen(object sender, CombineEventArgs e)
 		{
-			TaskService taskService = (TaskService)ICSharpCode.Core.Services.ServiceManager.Services.GetService(typeof(TaskService));
-			if (taskService.Tasks.Count &gt; 0) {
-				try {
-					Invoke(new EventHandler(SelectTaskView2));
-				} catch {}
-			}
+			store.Clear ();
 		}
 		
-		void SelectTaskView2(object sender, EventArgs e)
+		void OnCombineClosed(object sender, CombineEventArgs e)
 		{
-			PropertyService propertyService = (PropertyService)ServiceManager.Services.GetService(typeof(PropertyService));
-			if (WorkbenchSingleton.Workbench.WorkbenchLayout.IsVisible(this)) {
-				WorkbenchSingleton.Workbench.WorkbenchLayout.ActivatePad(this);
-			} else {
-				if ((bool)propertyService.GetProperty(&quot;SharpDevelop.ShowTaskListAfterBuild&quot;, true)) {
-					WorkbenchSingleton.Workbench.WorkbenchLayout.ShowPad(this);
-					WorkbenchSingleton.Workbench.WorkbenchLayout.ActivatePad(this);
-				}
-			}
+			store.Clear ();
 		}
 		
-		protected override void OnItemActivate(EventArgs e)
+		public void Dispose ()
 		{
-			base.OnItemActivate(e);
-			
-			//if (FocusedItem != null) {
-			//	Task task = (Task)FocusedItem.Tag;
-			//	Debug.Assert(task != null);
-			//	task.JumpToPosition();
-			//}
 		}
-		protected override void OnMouseMove(MouseEventArgs e)
+		
+		void SelectTaskView (object sender, EventArgs e)
 		{
-			base.OnMouseMove(e);
-			ListViewItem item = base.GetItemAt(e.X, e.Y);
-			if (item != null) {
-				Task task = (Task)item.Tag;
-				taskToolTip.SetToolTip(this, task.Description);
-				taskToolTip.Active       = true;
-			} else {
-				taskToolTip.RemoveAll(); 
-				taskToolTip.Active       = false;
+			TaskService taskService = (TaskService) ServiceManager.Services.GetService (typeof (TaskService));
+			if (taskService.Tasks.Count &gt; 0) {
+				try {
+					PropertyService propertyService = (PropertyService) ServiceManager.Services.GetService (typeof (PropertyService));
+					if (WorkbenchSingleton.Workbench.WorkbenchLayout.IsVisible (this)) {
+						WorkbenchSingleton.Workbench.WorkbenchLayout.ActivatePad (this);
+					} else if ((bool) propertyService.GetProperty (&quot;SharpDevelop.ShowTaskListAfterBuild&quot;, true)) {
+						WorkbenchSingleton.Workbench.WorkbenchLayout.ShowPad (this);
+						WorkbenchSingleton.Workbench.WorkbenchLayout.ActivatePad (this);
+					}
+				} catch {}
 			}
 		}
 		
-		protected override void OnResize(EventArgs e)
+		void OnRowActivated (object o, RowActivatedArgs args)
 		{
-			base.OnResize(e);
-			type.Width = 24;
-			line.Width = 50;
-			int w = Width - type.Width - line.Width;
-			file.Width = w * 15 / 100;
-			path.Width = w * 15 / 100;
-			description.Width = w - file.Width - path.Width - 5;
+			Gtk.TreeIter iter;
+			if (store.GetIter (out iter, args.Path)) {
+				store.SetValue (iter, COL_READ, true);
+				store.SetValue (iter, COL_READ_WEIGHT, (int) Pango.Weight.Normal);
+				
+				((Task) store.GetValue (iter, COL_TASK)).JumpToPosition ();
+			}
 		}
 		
 		public CompilerResults CompilerResults = null;
 		
-		void ShowResults2(object sender, EventArgs e)
+		public void ShowResults(object sender, EventArgs e)
 		{
-			Console.WriteLine(&quot;Create Open Task View Handle:&quot; + base.Handle);
+			store.Clear ();
+			FileUtilityService fileUtilityService = (FileUtilityService) ServiceManager.Services.GetService (typeof (FileUtilityService));
+			TaskService taskService = (TaskService) ServiceManager.Services.GetService (typeof (TaskService));
 			
-			BeginUpdate();
-			Items.Clear();
-			FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
-			TaskService taskService = (TaskService)ICSharpCode.Core.Services.ServiceManager.Services.GetService(typeof(TaskService));
-			foreach (Task task in taskService.Tasks) {
-				int imageIndex = 0;
-				switch (task.TaskType) {
-					case TaskType.Warning:
-						imageIndex = 1;
-						break;
-					case TaskType.Error:
-						imageIndex = 0;
-						break;
-					case TaskType.Comment:
-						imageIndex = 3;
-						break;
-					case TaskType.SearchResult:
-						imageIndex = 2;
-						break;
+			foreach (Task t in taskService.Tasks) {
+				string stock;
+				switch (t.TaskType) {
+					case TaskType.Warning      : stock = Gtk.Stock.DialogWarning  ; break;
+					case TaskType.Error        : stock = Gtk.Stock.DialogError    ; break;
+					case TaskType.Comment      : stock = Gtk.Stock.DialogInfo     ; break;
+					case TaskType.SearchResult : stock = Gtk.Stock.DialogQuestion ; break;
+					default                    : stock = null                     ; break;
 				}
 				
-				string tmpPath = task.FileName;
-				if (task.Project != null) {
-					tmpPath = fileUtilityService.AbsoluteToRelativePath(task.Project.BaseDirectory, task.FileName);
-				} 
+				string tmpPath = t.FileName;
+				if (t.Project != null)
+					tmpPath = fileUtilityService.AbsoluteToRelativePath (t.Project.BaseDirectory, t.FileName);
 				
 				string fileName = tmpPath;
 				string path     = tmpPath;
@@ -241,48 +186,47 @@
 					path = Path.GetDirectoryName(tmpPath);
 				} catch (Exception) {}
 				
-				ListViewItem item = new ListViewItem(new string[] {
-					String.Empty,
-					(task.Line + 1).ToString(),
-					task.Description,
+				store.AppendValues (
+					stock,
+					t.Line + 1,
+					t.Description,
+					path,
 					fileName,
-					path
-				});
-				item.ImageIndex = item.StateImageIndex = imageIndex;
-				item.Tag = task;
-				Items.Add(item);
+					t, false, false, (int) Pango.Weight.Bold);
 			}
-			EndUpdate();
+			SelectTaskView(null, null);
 		}
 		
-		public void ShowResults(object sender, EventArgs e)
+		protected virtual void OnTitleChanged (EventArgs e)
 		{
-			Invoke(new EventHandler(ShowResults2));
-//			SelectTaskView(null, null);
+			if (TitleChanged != null)
+				TitleChanged(this, e);
 		}
 		
-		protected virtual void OnTitleChanged(EventArgs e)
+		protected virtual void OnIconChanged (EventArgs e)
 		{
-			if (TitleChanged != null) {
-				TitleChanged(this, e);
-			}
+			if (IconChanged != null)
+				IconChanged (this, e);
 		}
-		protected virtual void OnIconChanged(EventArgs e)
+		
+		public event EventHandler TitleChanged, IconChanged;
+		
+		public void BringToFront ()
 		{
-			if (IconChanged != null) {
-				IconChanged(this, e);
-			}
+			if (!WorkbenchSingleton.Workbench.WorkbenchLayout.IsVisible (this))
+				WorkbenchSingleton.Workbench.WorkbenchLayout.ShowPad (this);
+			
+			WorkbenchSingleton.Workbench.WorkbenchLayout.ActivatePad (this);
 		}
-		public event EventHandler TitleChanged;
-		public event EventHandler IconChanged;
 		
-		public new void BringToFront()
+		private void ItemToggled (object o, ToggledArgs args)
 		{
-			if (!WorkbenchSingleton.Workbench.WorkbenchLayout.IsVisible(this)) {
-				WorkbenchSingleton.Workbench.WorkbenchLayout.ShowPad(this);
+			Gtk.TreeIter iter;
+			if (store.GetIterFromString(out iter, args.Path)) {
+				bool val = (bool) store.GetValue(iter, COL_MARKED);
+				store.SetValue(iter, COL_MARKED, !val);
 			}
-			WorkbenchSingleton.Workbench.WorkbenchLayout.ActivatePad(this);
 		}
 
-	}*/
+	}
 }

Modified: trunk/MonoDevelop/src/Main/Base/Gui/PixbufList.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/PixbufList.cs	2004-02-01 12:19:18 UTC (rev 741)
+++ trunk/MonoDevelop/src/Main/Base/Gui/PixbufList.cs	2004-02-01 21:51:57 UTC (rev 742)
@@ -1,11 +1,19 @@
 using System.Collections;
-
+using ICSharpCode.Core.Services;
 using Gdk;
 
 namespace ICSharpCode.SharpDevelop.Gui
 {
 	public class PixbufList : ArrayList
 	{
+		public PixbufList (params string [] resIcons) : base (resIcons.Length)
+		{
+			ResourceService rs = (ResourceService) ServiceManager.Services.GetService (typeof (IResourceService));
+			
+			foreach (string s in resIcons)
+				Add (rs.GetBitmap (s));
+		}
+		
 		public new Pixbuf this[int idx] {
 			get {
 				return (Pixbuf) base[idx];

Modified: trunk/MonoDevelop/src/Main/Base/Services/ResourceService.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Services/ResourceService.cs	2004-02-01 12:19:18 UTC (rev 741)
+++ trunk/MonoDevelop/src/Main/Base/Services/ResourceService.cs	2004-02-01 21:51:57 UTC (rev 742)
@@ -85,6 +85,10 @@
 			stockMappings [&quot;Icons.16x16.SaveAsIcon&quot;] = Gtk.Stock.SaveAs;
 			stockMappings [&quot;Icons.16x16.SaveIcon&quot;] = Gtk.Stock.Save;
 			stockMappings [&quot;Icons.16x16.UndoIcon&quot;] = Gtk.Stock.Undo;
+			stockMappings [&quot;Icons.16x16.Error&quot;] = Gtk.Stock.DialogError;
+			stockMappings [&quot;Icons.16x16.Warning&quot;] = Gtk.Stock.DialogWarning;
+			stockMappings [&quot;Icons.16x16.Information&quot;] = Gtk.Stock.DialogInfo;
+			stockMappings [&quot;Icons.16x16.Question&quot;] = Gtk.Stock.DialogQuestion;
 		}
 
 		void ChangeProperty(object sender, PropertyEventArgs e)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000346.html">[Monodevelop-patches-list] r741 - trunk/MonoDevelop/data/resources/glade
</A></li>
	<LI>Next message: <A HREF="000348.html">[Monodevelop-patches-list] r743 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#347">[ date ]</a>
              <a href="thread.html#347">[ thread ]</a>
              <a href="subject.html#347">[ subject ]</a>
              <a href="author.html#347">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
