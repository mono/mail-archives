<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r906 - in trunk/MonoDevelop: build/AddIns build/AddIns/AddIns/Misc/StartPage src/AddIns/DisplayBindings/SourceEditor/CodeCompletion src/Main/Base/Gui/Workbench/Layouts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r906%20-%20in%20trunk/MonoDevelop%3A%20build/AddIns%20build/AddIns/AddIns/Misc/StartPage%20src/AddIns/DisplayBindings/SourceEditor/CodeCompletion%20src/Main/Base/Gui/Workbench/Layouts&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000510.html">
   <LINK REL="Next"  HREF="000512.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r906 - in trunk/MonoDevelop: build/AddIns build/AddIns/AddIns/Misc/StartPage src/AddIns/DisplayBindings/SourceEditor/CodeCompletion src/Main/Base/Gui/Workbench/Layouts</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r906%20-%20in%20trunk/MonoDevelop%3A%20build/AddIns%20build/AddIns/AddIns/Misc/StartPage%20src/AddIns/DisplayBindings/SourceEditor/CodeCompletion%20src/Main/Base/Gui/Workbench/Layouts&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r906 - in trunk/MonoDevelop: build/AddIns build/AddIns/AddIns/Misc/StartPage src/AddIns/DisplayBindings/SourceEditor/CodeCompletion src/Main/Base/Gui/Workbench/Layouts">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sat Feb 14 16:07:17 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000510.html">[Monodevelop-patches-list] r905 - /svn/monodevelop/hooks/commit-email.pl: `/usr/bin/svnlook dirs-changed /svn/monodevelop -r 905' failed with this output: svn: Berkeley DB error while reading filesystem revision for filesystem /svn/monodevelop/db: Cannot allocate memory
</A></li>
        <LI>Next message: <A HREF="000512.html">[Monodevelop-patches-list] r907 - in trunk/MonoDevelop: . build/data build/data/resources build/data/resources/css build/data/resources/languages build/data/templates build/data/templates/file build/data/templates/file/CSharp build/data/templates/file/SharpDevelop build/data/templates/file/VBNet build/data/templates/project build/data/templates/project/CSharp build/data/templates/project/Java build/data/templates/project/Misc build/data/templates/project/VBNet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#511">[ date ]</a>
              <a href="thread.html#511">[ thread ]</a>
              <a href="subject.html#511">[ subject ]</a>
              <a href="author.html#511">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-02-14 16:07:17 -0500 (Sat, 14 Feb 2004)
New Revision: 906

Modified:
   trunk/MonoDevelop/build/AddIns/AddIns/Misc/StartPage/StartPage.addin
   trunk/MonoDevelop/build/AddIns/MonoDevelopNewEditor.addin
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceLayout.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs
Log:
* removed crufty menu items
* Dont show tooltip if string length == 0
* Only show tabs when # &gt; 1
* Change window title to be filename - MonoDevelop
* Add mimetype icon to tab


Modified: trunk/MonoDevelop/build/AddIns/AddIns/Misc/StartPage/StartPage.addin
===================================================================
--- trunk/MonoDevelop/build/AddIns/AddIns/Misc/StartPage/StartPage.addin	2004-02-14 17:46:27 UTC (rev 905)
+++ trunk/MonoDevelop/build/AddIns/AddIns/Misc/StartPage/StartPage.addin	2004-02-14 21:07:17 UTC (rev 906)
@@ -9,7 +9,7 @@
 		&lt;Import assembly=&quot;MonoDevelop.StartPage.dll&quot;/&gt;
 	&lt;/Runtime&gt;
 
-	&lt;Extension path = &quot;/SharpDevelop/Workbench/MainMenu/View&quot;&gt;
+	&lt;!-- &lt;Extension path = &quot;/SharpDevelop/Workbench/MainMenu/View&quot;&gt;
 		&lt;MenuItem id = &quot;ShowStartPage&quot;
 		          insertafter  = &quot;ViewItemsSeparator&quot;
 			  insertbefore = &quot;StartPageSeparator&quot;
@@ -18,7 +18,7 @@
 		&lt;MenuItem id = &quot;StartPageSeparator&quot;
 				  insertbefore = &quot;FullScreen&quot;
 				  label = &quot;-&quot;/&gt;
-	&lt;/Extension&gt;
+	&lt;/Extension&gt; --&gt;
 	
 	&lt;!-- TODO: Conditional to reflect Settings option --&gt;
 	&lt;Extension path = &quot;/Workspace/Autostart&quot;&gt;

Modified: trunk/MonoDevelop/build/AddIns/MonoDevelopNewEditor.addin
===================================================================
--- trunk/MonoDevelop/build/AddIns/MonoDevelopNewEditor.addin	2004-02-14 17:46:27 UTC (rev 905)
+++ trunk/MonoDevelop/build/AddIns/MonoDevelopNewEditor.addin	2004-02-14 21:07:17 UTC (rev 906)
@@ -260,7 +260,7 @@
 	&lt;/Extension&gt;
 	--&gt;
 	
-	&lt;Extension path = &quot;/SharpDevelop/Workbench/MainMenu/Edit&quot;&gt;
+	&lt;!-- &lt;Extension path = &quot;/SharpDevelop/Workbench/MainMenu/Edit&quot;&gt;
                 &lt;MenuItem insertafter = &quot;Delete&quot; insertbefore = &quot;SelectAll&quot; id = &quot;Separator2&quot; label = &quot;-&quot; /&gt;
                 &lt;MenuItem insertafter = &quot;Separator2&quot; insertbefore = &quot;Separator3&quot; id = &quot;Format&quot; label = &quot;${res:XML.MainMenu.EditMenu.FormatMenu}&quot;&gt;
 	                &lt;Conditional activewindow=&quot;ICSharpCode.SharpDevelop.DefaultEditor.Gui.Editor.ITextEditorControlProvider&quot; action=&quot;Disable&quot;&gt;
@@ -316,7 +316,7 @@
                                   class =&quot;ICSharpCode.SharpDevelop.DefaultEditor.Commands.ConvertLeadingSpacesToTabs&quot;/&gt;
         		&lt;/Conditional&gt;
                 &lt;/MenuItem&gt;
-                &lt;!-- &lt;MenuItem insertafter = &quot;Format&quot; insertbefore = &quot;Separator3&quot; id = &quot;Folding&quot; label = &quot;${res:XML.MainMenu.EditMenu.FoldingMenu}&quot;&gt;
+                &lt;MenuItem insertafter = &quot;Format&quot; insertbefore = &quot;Separator3&quot; id = &quot;Folding&quot; label = &quot;${res:XML.MainMenu.EditMenu.FoldingMenu}&quot;&gt;
 	                &lt;Conditional activewindow=&quot;ICSharpCode.SharpDevelop.DefaultEditor.Gui.Editor.ITextEditorControlProvider&quot; action=&quot;Disable&quot;&gt;
 	                        &lt;MenuItem id          = &quot;ToggleFolding&quot;
         	                          label       = &quot;${res:XML.MainMenu.EditMenu.FoldingMenu.ToggleFolding}&quot;
@@ -334,9 +334,9 @@
        					  shortcut    = &quot;Shift|Control|P&quot;
 	                                  class       = &quot;ICSharpCode.SharpDevelop.DefaultEditor.Commands.ShowDefinitionsOnly&quot;/&gt;
         		&lt;/Conditional&gt;
-                &lt;/MenuItem&gt; --&gt;
+                &lt;/MenuItem&gt;
                 &lt;MenuItem insertafter = &quot;Separator2&quot; insertbefore = &quot;SelectAll&quot; id = &quot;Separator3&quot; label = &quot;-&quot; /&gt;
-	&lt;/Extension&gt;
+	&lt;/Extension&gt; --&gt;
 
 	&lt;Extension path = &quot;/SharpDevelop/ViewContent/DefaultTextEditor/OptionsDialog&quot;&gt;
 		&lt;DialogPanel id = &quot;General&quot;
@@ -376,7 +376,7 @@
 			          class = &quot;ICSharpCode.SharpDevelop.DefaultEditor.Commands.ShowColorDialog&quot;/&gt; 
 			&lt;MenuItem id = &quot;Separator2&quot; label = &quot;-&quot; /&gt;
 
-			&lt;MenuItem id = &quot;GenerateCodeAction&quot;
+		&lt;!--	&lt;MenuItem id = &quot;GenerateCodeAction&quot;
 			          insertafter = &quot;Separator2&quot;
 			          label = &quot;${res:XML.MainMenu.ToolMenu.GenerateCode}&quot; 
 			          description = &quot;${res:XML.MainMenu.ToolMenu.GenerateCode.Description}&quot; 
@@ -386,7 +386,7 @@
 			          description = &quot;${res:XML.MainMenu.ToolMenu.QuickXmlDoc.Description}&quot; 
 			          shortcut = &quot;Control|Q&quot;
 			          class = &quot;ICSharpCode.SharpDevelop.DefaultEditor.Commands.QuickDocumentation&quot;/&gt; 
-			&lt;MenuItem id = &quot;Separator3&quot; label = &quot;-&quot; /&gt;
+			&lt;MenuItem id = &quot;Separator3&quot; label = &quot;-&quot; /&gt; --&gt;
 		&lt;/Conditional&gt;
 	&lt;/Extension&gt;
 	

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs	2004-02-14 17:46:27 UTC (rev 905)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/CodeCompletion/CompletionWindow.cs	2004-02-14 21:07:17 UTC (rev 906)
@@ -311,7 +311,10 @@
 					declarationviewwindow = new DeclarationViewWindow ();
 					declarationviewwindow.DescriptionMarkup = data.Description;
 				}
-				
+			
+				if (declarationviewwindow.DescriptionMarkup.Length == 0)
+					return;
+			
 				declarationviewwindow.ShowAll ();
 				if (listView.Screen.Width &lt;= horiz + declarationviewwindow.GdkWindow.FrameExtents.Width) {
 					horiz = listpos_x - declarationviewwindow.GdkWindow.FrameExtents.Width - 10;

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceLayout.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceLayout.cs	2004-02-14 17:46:27 UTC (rev 905)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceLayout.cs	2004-02-14 21:07:17 UTC (rev 906)
@@ -21,6 +21,7 @@
 using Gdl;
 using GdlSharp;
 using MonoDevelop.Gui.Widgets;
+using MonoDevelop.Gui.Utils;
 
 namespace ICSharpCode.SharpDevelop.Gui
 {	
@@ -82,6 +83,8 @@
 			// Create the notebook for the various documents.
 			tabControl = new Notebook ();
 			tabControl.Scrollable = true;
+			tabControl.ShowTabs = false;
+			tabControl.SwitchPage += new SwitchPageHandler (ActiveMdiChanged);
 			DockItem item = new DockItem (&quot;Documents&quot;, &quot;Documents&quot;,
 						      DockItemBehavior.Locked);
 			item.Add (tabControl);
@@ -309,10 +312,13 @@
 			
 
 			string title = &quot;&quot;;
+			Gtk.Image mimeimage;
 			if (content.IsUntitled) {
 				title = content.UntitledName;
+				mimeimage = new Gtk.Image (FileIconLoader.GetPixbufForType (&quot;gnome-fs-regular&quot;).ScaleSimple (16, 16, Gdk.InterpType.Bilinear));
 			} else {
 				title = Path.GetFileName (content.ContentName);
+				mimeimage = new Gtk.Image (FileIconLoader.GetPixbufForFile (content.ContentName, 16, 16));
 			}
 			
 			HBox hbox = new HBox (false, 3);
@@ -325,18 +331,21 @@
 			btn.StateChanged += new StateChangedHandler (stateChanged);
 			
 			Label label = new Label (title);
+			hbox.PackStart (mimeimage);
 			hbox.PackStart (label, false, false, 0);
 			hbox.PackEnd (btn, false, false, 0);
 		
 			hbox.ShowAll ();
 			tabControl.AppendPage (content.Control, hbox);
 
-			SdiWorkspaceWindow sdiWorkspaceWindow = new SdiWorkspaceWindow(content, tabControl, label);
+			SdiWorkspaceWindow sdiWorkspaceWindow = new SdiWorkspaceWindow(content, tabControl, label, mimeimage);
 
 			sdiWorkspaceWindow.CloseEvent += new EventHandler(CloseWindowEvent);
 			sdiWorkspaceWindow.SwitchView(tabControl.Children.Length - 1);
 			_windows.Add (sdiWorkspaceWindow);
 			
+			if (tabControl.NPages &gt; 1)
+				tabControl.ShowTabs = true;
 			tabControl.ShowAll();
 			return sdiWorkspaceWindow;
 		}
@@ -365,13 +374,20 @@
 		public void RemoveTab (int pageNum) {
 			tabControl.RemovePage (pageNum);
 			_windows.RemoveAt (pageNum);
+			if (tabControl.NPages == 1)
+				tabControl.ShowTabs = false;
 		}
 		
-		void ActiveMdiChanged(object sender, EventArgs e)
+		void ActiveMdiChanged(object sender, SwitchPageArgs e)
 		{
-			if (ActiveWorkbenchWindowChanged != null) {
+			try {
+				((Gtk.Window)WorkbenchSingleton.Workbench).Title = ActiveWorkbenchwindow.ViewContent.ContentName + &quot; - MonoDevelop&quot;;
+			} catch {
+				((Gtk.Window)WorkbenchSingleton.Workbench).Title = &quot;MonoDevelop&quot;;
+			}
+			/*if (ActiveWorkbenchWindowChanged != null) {
 				ActiveWorkbenchWindowChanged(this, e);
-			}
+			}*/
 		}
 		
 		public event EventHandler ActiveWorkbenchWindowChanged;

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs	2004-02-14 17:46:27 UTC (rev 905)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Workbench/Layouts/SdiWorkspaceWindow.cs	2004-02-14 21:07:17 UTC (rev 906)
@@ -14,6 +14,8 @@
 using ICSharpCode.Core.Services;
 using ICSharpCode.SharpDevelop.Services;
 
+using MonoDevelop.Gui.Utils;
+
 namespace ICSharpCode.SharpDevelop.Gui
 {
 	public class SdiWorkspaceWindow : IWorkbenchWindow
@@ -23,8 +25,9 @@
 		ArrayList    subViewContents = null;
 		
 		Label     tabLabel;
+		Image     tabMimeType;
 		Widget    tabPage;
-		Notebook tabControl;
+		Notebook  tabControl;
 		
 		string myUntitledTitle     = null;
 		string _titleHolder = &quot;&quot;;
@@ -117,11 +120,12 @@
 			tabControl.CurrentPage = toSelect;
 		}
 		
-		public SdiWorkspaceWindow(IViewContent content, Notebook tabControl, Label label)
+		public SdiWorkspaceWindow(IViewContent content, Notebook tabControl, Label label, Image type)
 		{
 			this.tabControl = tabControl;
 			this.content = content;
 			this.tabLabel = label;
+			this.tabMimeType = type;
 			this.tabPage = content.Control;
 			
 			IconService iconService = (IconService)ServiceManager.Services.GetService(typeof(IconService));
@@ -321,6 +325,13 @@
 		protected virtual void OnTitleChanged(EventArgs e)
 		{
 			tabLabel.Text = Title;
+			try {
+				if (content.ContentName.IndexOfAny (new char[] { '*', '+'}) == -1) {
+					tabMimeType.Pixbuf = FileIconLoader.GetPixbufForFile (content.ContentName, 16, 16);
+				}
+			} catch {
+				tabMimeType.Pixbuf = FileIconLoader.GetPixbufForType (&quot;gnome-fs-regular&quot;).ScaleSimple (16, 16, Gdk.InterpType.Bilinear);
+			}
 			if (TitleChanged != null) {
 				TitleChanged(this, e);
 			}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000510.html">[Monodevelop-patches-list] r905 - /svn/monodevelop/hooks/commit-email.pl: `/usr/bin/svnlook dirs-changed /svn/monodevelop -r 905' failed with this output: svn: Berkeley DB error while reading filesystem revision for filesystem /svn/monodevelop/db: Cannot allocate memory
</A></li>
	<LI>Next message: <A HREF="000512.html">[Monodevelop-patches-list] r907 - in trunk/MonoDevelop: . build/data build/data/resources build/data/resources/css build/data/resources/languages build/data/templates build/data/templates/file build/data/templates/file/CSharp build/data/templates/file/SharpDevelop build/data/templates/file/VBNet build/data/templates/project build/data/templates/project/CSharp build/data/templates/project/Java build/data/templates/project/Misc build/data/templates/project/VBNet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#511">[ date ]</a>
              <a href="thread.html#511">[ thread ]</a>
              <a href="subject.html#511">[ subject ]</a>
              <a href="author.html#511">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
