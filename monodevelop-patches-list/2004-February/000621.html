<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1016 - in trunk/MonoDevelop: data/resources/glade src/AddIns/DisplayBindings/SourceEditor/Gui src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels src/Main/Base/Gui/Dialogs/ReferenceDialog
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1016%20-%20in%20trunk/MonoDevelop%3A%20data/resources/glade%20src/AddIns/DisplayBindings/SourceEditor/Gui%20src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels%20src/Main/Base/Gui/Dialogs/ReferenceDialog&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000620.html">
   <LINK REL="Next"  HREF="000622.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1016 - in trunk/MonoDevelop: data/resources/glade src/AddIns/DisplayBindings/SourceEditor/Gui src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels src/Main/Base/Gui/Dialogs/ReferenceDialog</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1016%20-%20in%20trunk/MonoDevelop%3A%20data/resources/glade%20src/AddIns/DisplayBindings/SourceEditor/Gui%20src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels%20src/Main/Base/Gui/Dialogs/ReferenceDialog&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1016 - in trunk/MonoDevelop: data/resources/glade src/AddIns/DisplayBindings/SourceEditor/Gui src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels src/Main/Base/Gui/Dialogs/ReferenceDialog">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Tue Feb 24 08:32:12 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000620.html">[Monodevelop-patches-list] r1015 - trunk/MonoDevelop/build/AddIns
</A></li>
        <LI>Next message: <A HREF="000622.html">[Monodevelop-patches-list] r1017 - in trunk/MonoDevelop/src/Main/Base: . Commands Gui/CompletionDatabaseWizard Services/ParserService
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#621">[ date ]</a>
              <a href="thread.html#621">[ thread ]</a>
              <a href="subject.html#621">[ subject ]</a>
              <a href="author.html#621">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jba
Date: 2004-02-24 08:32:12 -0500 (Tue, 24 Feb 2004)
New Revision: 1016

Modified:
   trunk/MonoDevelop/data/resources/glade/EditorBindings.glade
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/MarkersTextEditorPanel.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/AssemblyReferencePanel.cs
   trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/SelectReferenceDialog.cs
Log:
add .net assembly reference tab and fixed sourceeditor indent style binding to allow none and auto

Modified: trunk/MonoDevelop/data/resources/glade/EditorBindings.glade
===================================================================
--- trunk/MonoDevelop/data/resources/glade/EditorBindings.glade	2004-02-24 05:50:05 UTC (rev 1015)
+++ trunk/MonoDevelop/data/resources/glade/EditorBindings.glade	2004-02-24 13:32:12 UTC (rev 1016)
@@ -1395,22 +1395,7 @@
 			  &lt;/child&gt;
 
 			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkRadioButton&quot; id=&quot;smartIndentStyle&quot;&gt;
-			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Smart&lt;/property&gt;
-			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
-			      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;group&quot;&gt;noneIndentStyle&lt;/property&gt;
-			    &lt;/widget&gt;
-			    &lt;packing&gt;
-			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-			    &lt;/packing&gt;
+			    &lt;placeholder/&gt;
 			  &lt;/child&gt;
 			&lt;/widget&gt;
 			&lt;packing&gt;

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs	2004-02-24 05:50:05 UTC (rev 1015)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/BehaviorTextEditorPanel.cs	2004-02-24 13:32:12 UTC (rev 1016)
@@ -74,7 +74,8 @@
 				//FIXME: i8n the following Labels
 				noneIndentStyle.Label =      &quot;None&quot;;
 				automaticIndentStyle.Label = &quot;Automatic&quot;; 
-				smartIndentStyle.Label =     &quot;Smart&quot;;
+				// FIXME: renable this when smart indent is back
+				//smartIndentStyle.Label =     &quot;Smart&quot;;
 
 				tabsGroupBoxLabel.Markup = &quot;&lt;b&gt;&quot; + StringParserService.Parse(
 					&quot;${res:Dialog.Options.IDEOptions.TextEditor.Behaviour.TabsGroupBox}&quot;)  + &quot;&lt;/b&gt;&quot;;
@@ -129,17 +130,18 @@
 				else if (IndentStyle.Smart.Equals(
 						 (IndentStyle) ((IProperties)CustomizationObject).GetProperty(
 							 &quot;IndentStyle&quot;, IndentStyle.Smart))){
-					smartIndentStyle.Active = true;
+					// FIXME: renable this when smart indent is back
+					//smartIndentStyle.Active = true;
 				}
 				
 				// FIXME: re-enable these when their options are implemented
 				autoinsertCurlyBraceCheckBox.Sensitive = false;
 				hideMouseCursorCheckBox.Sensitive = false;
 				caretBehindEOLCheckBox.Sensitive = false;
-				autoInsertTemplatesCheckBox.Sensitive = false;	// FIXME: there is no reason why this option couldn't ber wired in right now
-				noneIndentStyle.Sensitive = false;
-				automaticIndentStyle.Sensitive = false;
-				smartIndentStyle.Sensitive = false;
+                // FIXME: there is no reason why this option couldn't ber wired in right now				
+                autoInsertTemplatesCheckBox.Sensitive = false;	
+   				// FIXME: renable this when smart indent is back
+				//smartIndentStyle.Sensitive = false;
 			}
 
 			public void Store (IProperties CustomizationObject)
@@ -159,8 +161,9 @@
 					((IProperties)CustomizationObject).SetProperty(&quot;IndentStyle&quot;, IndentStyle.None);
 				else if (automaticIndentStyle.Active)
 					((IProperties)CustomizationObject).SetProperty(&quot;IndentStyle&quot;, IndentStyle.Auto);
-				else if (smartIndentStyle.Active)
-					((IProperties)CustomizationObject).SetProperty(&quot;IndentStyle&quot;, IndentStyle.Smart);
+				// FIXME: renable this when smart indent is back
+				//else if (smartIndentStyle.Active)
+				//	((IProperties)CustomizationObject).SetProperty(&quot;IndentStyle&quot;, IndentStyle.Smart);
 				
 				//FIXME: Only one of these should be selected to save the value
 				((IProperties)CustomizationObject).SetProperty(&quot;TabIndent&quot;, indentAndTabSizeSpinButton.Value);

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/MarkersTextEditorPanel.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/MarkersTextEditorPanel.cs	2004-02-24 05:50:05 UTC (rev 1015)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/OptionPanels/MarkersTextEditorPanel.cs	2004-02-24 13:32:12 UTC (rev 1016)
@@ -121,7 +121,7 @@
 			
 				vRulerRowTextBox.Value = ((IProperties)CustomizationObject).GetProperty(&quot;VRulerRow&quot;, 80);
 
-				// FIXME: reenable these widhet's when they're implemented
+				// FIXME: reenable these widget's when they're implemented
 				showInvalidLinesCheckBox.Sensitive = false;
 				showHRulerCheckBox.Sensitive = false;
 			}

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-02-24 05:50:05 UTC (rev 1015)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-02-24 13:32:12 UTC (rev 1016)
@@ -348,7 +348,10 @@
 					// convert tabs to spaces
 					se.View.InsertSpacesInsteadOfTabs = TextEditorProperties.ConvertTabsToSpaces;
 					break;
-					
+				case &quot;IndentStyle&quot;:
+					// FIXME: should also be able to handle Smart indent, for now treating smart as None					
+					se.View.AutoIndent = (TextEditorProperties.IndentStyle == IndentStyle.Auto);
+					break;
 				default:
 					System.Console.WriteLine(e.Key + &quot; = &quot; + e.NewValue + &quot;(from &quot; + e.OldValue + &quot;)&quot; );
 					// The items below can't be done (since there is no support for it in gtksourceview)
@@ -356,8 +359,7 @@
 					// CANTDO: show tabs				Key = &quot;ShowTabs&quot;
 					// CANTDO eol makers				Key = &quot;ShowEOLMarkers&quot;
 					// CANTDO: show horizontal ruler	Key = &quot;ShowHRuler&quot;		
-					// CANTDO: underline errors			Key = &quot;ShowErrors&quot;
-					// CANTDO: indentation 				Key = &quot;IndentStyle&quot;
+					// CANTDO: underline errors			Key = &quot;ShowErrors&quot;					
 					// DONOTDO: auto insert braces		Key = &quot;AutoInsertCurlyBracket&quot;
 					// TODO: Show Invalid Lines			Key = &quot;ShowInvalidLines&quot;
 					// TODO: CodeCompletion				Key = &quot;EnableCodeCompletion&quot;

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs	2004-02-24 05:50:05 UTC (rev 1015)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorView.cs	2004-02-24 13:32:12 UTC (rev 1016)
@@ -32,7 +32,6 @@
 		public SourceEditorView (SourceEditorBuffer buf, SourceEditor parent) : base (type)
 		{
 			this.ParentEditor = parent;
-			//FIXME: hook into the options
 			this.TabsWidth = 4;
 			Buffer = this.buf = buf;
 			AutoIndent = true;

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/AssemblyReferencePanel.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/AssemblyReferencePanel.cs	2004-02-24 05:50:05 UTC (rev 1015)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/AssemblyReferencePanel.cs	2004-02-24 13:32:12 UTC (rev 1016)
@@ -15,46 +15,62 @@
 using ICSharpCode.SharpDevelop.Internal.Project;
 using ICSharpCode.Core.Services;
 
+using Gtk;
+
 namespace ICSharpCode.SharpDevelop.Gui.Dialogs
-{/*
-	public class AssemblyReferencePanel : Panel//, IReferencePanel
+{
+	public class AssemblyReferencePanel : VButtonBox, IReferencePanel
 	{
 		SelectReferenceDialog selectDialog;
 		
 		public AssemblyReferencePanel(SelectReferenceDialog selectDialog)
 		{
 			this.selectDialog = selectDialog;
-			
-			Button browseButton   = new Button();
-			browseButton.Location = new Point(10, 10);
-			browseButton.Text     = &quot;Browse&quot;;
-			browseButton.Click   += new EventHandler(SelectReferenceDialog);
-			Controls.Add(browseButton);
+			// FIXME: il8n this
+			Gtk.Button browseButton = new Gtk.Button(&quot;Browse&quot;);
+			browseButton.Clicked += new EventHandler(SelectReferenceDialog);
+			PackStart(browseButton, false, false, 6);
+			ShowAll();
 		}
 		
 		void SelectReferenceDialog(object sender, EventArgs e)
 		{
-			using (OpenFileDialog fdiag  = new OpenFileDialog()) {
-				fdiag.AddExtension    = true;
-				StringParserService stringParserService = (StringParserService)ServiceManager.Services.GetService(typeof(StringParserService));
-				fdiag.Filter = stringParserService.Parse(&quot;${res:SharpDevelop.FileFilter.AssemblyFiles}|*.dll;*.exe|${res:SharpDevelop.FileFilter.AllFiles}|*.*&quot;);
-				fdiag.Multiselect     = true;
-				fdiag.CheckFileExists = true;
-				
-				if (fdiag.ShowDialog() == DialogResult.OK) {
-					foreach (string file in fdiag.FileNames) {
-						selectDialog.AddReference(ReferenceType.Assembly,
-						                          Path.GetFileName(file),
-						                          file);
-						
+			// FIXME: il8n the dialog name
+			StringParserService stringParserService = (StringParserService)ServiceManager.Services.GetService(typeof(StringParserService));
+			FileSelection fdiag = new FileSelection(&quot;Find .Net Assembly&quot;);			
+			// FIXME: this should only allow dll's and exe's
+			fdiag.Complete(&quot;*&quot;);
+			fdiag.SelectMultiple = true;
+			int response = fdiag.Run();
+			string[] selectedFiles = new string[fdiag.Selections.Length];
+			fdiag.Selections.CopyTo(selectedFiles, 0);
+			fdiag.Destroy();
+			
+			if (response == (int) ResponseType.Ok) {
+				foreach (string file in selectedFiles) {
+					bool isAssembly = true;
+					try	{
+						System.Reflection.AssemblyName.GetAssemblyName(System.IO.Path.GetFileName(file));
+					} catch (Exception assemblyExcep) {
+						isAssembly = false;
 					}
+					
+					if (isAssembly) {
+					selectDialog.AddReference(ReferenceType.Assembly,
+											  System.IO.Path.GetFileName(file),
+											  file);
+					} else {
+						IMessageService messageService =(IMessageService)ServiceManager.Services.GetService(typeof(IMessageService));
+						// FIXME: il8n this
+						messageService.ShowError(&quot;File &quot; + file + &quot;is not a valid .Net Assembly&quot;);
+					}
 				}
 			}
 		}
 		
 		public void AddReference(object sender, EventArgs e)
 		{
-			MessageBox.Show(&quot;This panel will contain a file browser, but so long use the browse button :)&quot;);
+			System.Console.WriteLine(&quot;This panel will contain a file browser, but so long use the browse button :)&quot;);
 		}
-	}*/
+	}
 }

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/SelectReferenceDialog.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/SelectReferenceDialog.cs	2004-02-24 05:50:05 UTC (rev 1015)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Dialogs/ReferenceDialog/SelectReferenceDialog.cs	2004-02-24 13:32:12 UTC (rev 1016)
@@ -92,8 +92,9 @@
 			}
 			mainBook.RemovePage (mainBook.CurrentPage);
 			mainBook.AppendPage (gacRefPanel, new Gtk.Label (resourceService.GetString(&quot;Dialog.SelectReferenceDialog.GacTabPage&quot;)));
-			mainBook.AppendPage (new ProjectReferencePanel (this), new Gtk.Label (resourceService.GetString(&quot;Dialog.SelectReferenceDialog.ProjectTabPage&quot;)));
-			//browserTabPage.Controls.Add(new AssemblyReferencePanel(this));
+			mainBook.AppendPage (new ProjectReferencePanel (this), new Gtk.Label (resourceService.GetString(&quot;Dialog.SelectReferenceDialog.ProjectTabPage&quot;)));			
+			// FIXME il8n the assembly tab name			
+			mainBook.AppendPage (new AssemblyReferencePanel (this), new Gtk.Label (&quot;.Net Assembly&quot;));
 			//comTabPage.Controls.Add(new COMReferencePanel(this));
 			AddReferenceDialog.ShowAll ();
 		}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000620.html">[Monodevelop-patches-list] r1015 - trunk/MonoDevelop/build/AddIns
</A></li>
	<LI>Next message: <A HREF="000622.html">[Monodevelop-patches-list] r1017 - in trunk/MonoDevelop/src/Main/Base: . Commands Gui/CompletionDatabaseWizard Services/ParserService
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#621">[ date ]</a>
              <a href="thread.html#621">[ thread ]</a>
              <a href="subject.html#621">[ subject ]</a>
              <a href="author.html#621">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
