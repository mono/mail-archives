<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r908 - in trunk/MonoDevelop: build/data/resources/css build/data/resources/languages build/data/templates build/data/templates/file build/data/templates/file/CSharp build/data/templates/file/SharpDevelop build/data/templates/file/VBNet build/data/templates/project build/data/templates/project/CSharp build/data/templates/project/Java build/data/templates/project/Misc build/data/templates/project/VBNet src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r908%20-%20in%20trunk/MonoDevelop%3A%20build/data/resources/css%20build/data/resources/languages%20build/data/templates%20build/data/templates/file%20build/data/templates/file/CSharp%20build/data/templates/file/SharpDevelop%20build/data/templates/file/VBNet%20build/data/templates/project%20build/data/templates/project/CSharp%20build/data/templates/project/Java%20build/data/templates/project/Misc%20build/data/templates/project/VBNet%20src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000512.html">
   <LINK REL="Next"  HREF="000514.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r908 - in trunk/MonoDevelop: build/data/resources/css build/data/resources/languages build/data/templates build/data/templates/file build/data/templates/file/CSharp build/data/templates/file/SharpDevelop build/data/templates/file/VBNet build/data/templates/project build/data/templates/project/CSharp build/data/templates/project/Java build/data/templates/project/Misc build/data/templates/project/VBNet src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r908%20-%20in%20trunk/MonoDevelop%3A%20build/data/resources/css%20build/data/resources/languages%20build/data/templates%20build/data/templates/file%20build/data/templates/file/CSharp%20build/data/templates/file/SharpDevelop%20build/data/templates/file/VBNet%20build/data/templates/project%20build/data/templates/project/CSharp%20build/data/templates/project/Java%20build/data/templates/project/Misc%20build/data/templates/project/VBNet%20src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r908 - in trunk/MonoDevelop: build/data/resources/css build/data/resources/languages build/data/templates build/data/templates/file build/data/templates/file/CSharp build/data/templates/file/SharpDevelop build/data/templates/file/VBNet build/data/templates/project build/data/templates/project/CSharp build/data/templates/project/Java build/data/templates/project/Misc build/data/templates/project/VBNet src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sat Feb 14 16:51:03 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000512.html">[Monodevelop-patches-list] r907 - in trunk/MonoDevelop: . build/data build/data/resources build/data/resources/css build/data/resources/languages build/data/templates build/data/templates/file build/data/templates/file/CSharp build/data/templates/file/SharpDevelop build/data/templates/file/VBNet build/data/templates/project build/data/templates/project/CSharp build/data/templates/project/Java build/data/templates/project/Misc build/data/templates/project/VBNet
</A></li>
        <LI>Next message: <A HREF="000514.html">[Monodevelop-patches-list] r909 - trunk/MonoDevelop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#513">[ date ]</a>
              <a href="thread.html#513">[ thread ]</a>
              <a href="subject.html#513">[ subject ]</a>
              <a href="author.html#513">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jluke
Date: 2004-02-14 16:51:03 -0500 (Sat, 14 Feb 2004)
New Revision: 908

Added:
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs
Modified:
   trunk/MonoDevelop/build/data/resources/css/
   trunk/MonoDevelop/build/data/resources/languages/
   trunk/MonoDevelop/build/data/templates/
   trunk/MonoDevelop/build/data/templates/file/
   trunk/MonoDevelop/build/data/templates/file/CSharp/
   trunk/MonoDevelop/build/data/templates/file/SharpDevelop/
   trunk/MonoDevelop/build/data/templates/file/VBNet/
   trunk/MonoDevelop/build/data/templates/project/
   trunk/MonoDevelop/build/data/templates/project/CSharp/
   trunk/MonoDevelop/build/data/templates/project/Java/
   trunk/MonoDevelop/build/data/templates/project/Misc/
   trunk/MonoDevelop/build/data/templates/project/VBNet/
Log:
f-n ignore



Property changes on: trunk/MonoDevelop/build/data/resources/css
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/resources/languages
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/file
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/file/CSharp
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/file/SharpDevelop
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/file/VBNet
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/project
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/project/CSharp
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/project/Java
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/project/Misc
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in



Property changes on: trunk/MonoDevelop/build/data/templates/project/VBNet
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in


Added: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs	2004-02-14 21:39:30 UTC (rev 907)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/Dialogs/ExportProjectToHtmlDialog.cs	2004-02-14 21:51:03 UTC (rev 908)
@@ -0,0 +1,436 @@
+// &lt;file&gt;
+//     &lt;copyright see=&quot;<A HREF="prj:///doc/copyright.txt&quot;/">prj:///doc/copyright.txt&quot;/</A>&gt;
+//     &lt;license see=&quot;<A HREF="prj:///doc/license.txt&quot;/">prj:///doc/license.txt&quot;/</A>&gt;
+//     &lt;owner name=&quot;Mike Kr&#252;ger&quot; email=&quot;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mike at icsharpcode.net</A>&quot;/&gt;
+//     &lt;version value=&quot;$version&quot;/&gt;
+// &lt;/file&gt;
+
+using System;
+using System.Drawing;
+using System.IO;
+using System.Collections;
+using System.Collections.Specialized;
+
+using ICSharpCode.Core.Properties;
+using ICSharpCode.Core.Services;
+using ICSharpCode.SharpDevelop.Internal.Project;
+using ICSharpCode.TextEditor.Document;
+//using ICSharpCode.TextEditor.Util;
+
+using Gtk;
+
+namespace ICSharpCode.SharpDevelop.Gui.Dialogs
+{
+	public class ExportProjectToHtmlDialog : Dialog
+	{
+	/*
+		Entry pathTextBox  = new Entry ();
+		Label   pathLabel    = new Label();
+		Button  okButton     = new Button();
+		Button  cancelButton = new Button();
+		Button  browseButton = new Button();
+		
+		ProgressBar progressBar = new ProgressBar();
+		
+		FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
+		IconService iconService = (IconService)ServiceManager.Services.GetService(typeof(IconService));
+		ResourceService resourceService = (ResourceService)ServiceManager.Services.GetService(typeof(IResourceService));	
+		IProject project;
+		int filesExported = 0;
+		
+		int FilesExported {
+			get {
+				return filesExported;
+			}
+			set {
+				progressBar.Fraction = filesExported = value / 100;
+			}
+		}
+		
+		void StartExporting()
+		{
+			cancelButton = new Button (Stock.Cancel);
+			cancelButton.Click   += new EventHandler(StopThread);
+		}
+*/
+		public ExportProjectToHtmlDialog(IProject project)
+		{
+/*			PropertyService propertyService = (PropertyService)ServiceManager.Services.GetService(typeof(PropertyService));
+			
+			this.project = project;
+			
+			pathLabel.Text = resourceService.GetString(&quot;Dialog.ExportProjectToHtml.FolderLabel&quot;);
+			
+			browseButton.Text     = &quot;...&quot;;
+			browseButton.Click   += new EventHandler(BrowseDirectories);
+			
+			okButton.Text     = resourceService.GetString(&quot;Global.OKButtonText&quot;);
+			okButton.Click   += new EventHandler(ExportProject);
+			
+			cancelButton.DialogResult = DialogResult.Cancel;
+			
+			RequestSize = new Size (350, 88 + 6);
+			Position = StartPosition.CenterParent;
+			//ShowInTaskbar = false;
+			
+			Title = resourceService.GetString(&quot;Dialog.ExportProjectToHtml.DialogName&quot;);
+*/
+		}
+/*		
+		void BrowseDirectories(object sender, EventArgs e)
+		{
+			FolderDialog fd = new FolderDialog();
+
+			if(fd.DisplayDialog(resourceService.GetString(&quot;Dialog.ExportProjectToHtml.SelectTargetDirInfo&quot;)) == DialogResult.OK) {
+				pathTextBox.Text = fd.Path;
+			}
+		}
+		
+		Hashtable projectTable = new Hashtable();
+		Hashtable bitmapTable  = new Hashtable();
+		int       bitmapIconIndex = 0;
+		int       indexFileIndex  = 0;
+		
+		public Hashtable GetPath(string filename, Hashtable table, bool create)
+		{
+			string directory    = Path.GetDirectoryName(filename);
+			string[] treepath   = directory.Split(new char[] { Path.DirectorySeparatorChar });
+			Hashtable curTable = table;
+			
+			foreach (string path in treepath) {
+				if (path.Length == 0 || path[0] == '.')
+					continue;
+				
+				object node = curTable[path];
+				
+				if (node == null) {
+					if (create) {
+						Hashtable newTable = new Hashtable();
+						curTable[path] = newTable;
+						curTable = newTable;
+						continue;
+					} else {
+						return null;
+					}
+				} 
+				curTable = (Hashtable)node;
+			}
+			return curTable;
+		}
+		int GetImageIndex(string filename)
+		{
+			if (filename != null) {
+				return iconService.GetImageIndexForFile(filename);
+			}
+			return -1;
+		}
+		
+		class Descriptor
+		{
+			public string title;
+			public string url;
+			public Descriptor(string title, string url)
+			{
+				this.title = title;
+				this.url = url;
+			}
+		}
+		
+		StreamWriter curFileStream  = null;
+		Stack        curIndexStreamStack = new Stack();
+		int          curSpanNumber  = 0;
+		Hashtable    Spans          = new Hashtable();
+		
+		string ExportFile (string fileName, string targetPath)
+		{
+			string targetFile = fileUtilityService.AbsoluteToRelativePath(project.BaseDirectory, fileName).Substring(2).Replace(System.IO.Path.DirectorySeparatorChar.ToString(), &quot;&quot;) + &quot;.html&quot;;
+			
+			IDocument document = new DocumentFactory().CreateDocument();
+			document.HighlightingStrategy = HighlightingStrategyFactory.CreateHighlightingStrategyForFile(fileName);
+			StreamReader stream = File.OpenText(fileName);
+			document.TextContent = stream.ReadToEnd();
+			stream.Close();
+			
+			curFileStream = File.CreateText(targetPath + Path.DirectorySeparatorChar + targetFile);
+			curFileStream.Write(&quot;&lt;html&gt;\r\n&quot;);
+			curFileStream.Write(&quot;&lt;head&gt;\r\n&quot;);
+			curFileStream.Write(&quot;&lt;link rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot; href=\&quot;sdcss.css\&quot;&gt;\r\n&quot;);
+			curFileStream.Write(&quot;&lt;title&gt;&quot; + Path.GetFileName(fileName) + &quot;&lt;/title&gt;\r\n&quot;);
+			curFileStream.Write(&quot;&lt;/head&gt;\r\n&quot;);
+			curFileStream.Write(&quot;&lt;body&gt;\r\n&quot;);
+			
+			curFileStream.Write(&quot;&lt;div class=\&quot;code\&quot;&gt;&lt;TABLE SUMMARY=\&quot;SourceCode\&quot; BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH=\&quot;100%\&quot;&gt;\r\n&quot;);
+			curFileStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;#FFFFFF\&quot;&gt;\r\n&quot;);
+			curFileStream.Write(&quot;    &lt;TH WIDTH=\&quot;50\&quot; NOWRAP ALIGN=LEFT&gt;&lt;/TH&gt;\r\n&quot;);
+			curFileStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;&lt;/TH&gt;\r\n&quot;);
+			curFileStream.Write(&quot;    &lt;TH VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+			curFileStream.Write(&quot;    &lt;/TH&gt;\r\n&quot;);
+			
+			curFileStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
+			int i = 0;
+			foreach (LineSegment line in document.LineSegmentCollection) {
+				curFileStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;#FFFFFF\&quot; VALIGN=TOP&gt;\r\n&quot;);
+				curFileStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + ++i + &quot;:&lt;/TD&gt;\r\n&quot;);
+				curFileStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp;\r\n&quot;);
+				bool spanOpen = false;
+				Color curColor = Color.Black;
+				bool  oldItalic = false;
+				bool  oldBold   = false;
+				bool firstSpan = true;
+				foreach (TextWord word in line.Words) {
+					switch (word.Type) {
+						case TextWordType.Space:
+							curFileStream.Write(&quot;&amp;nbsp;&quot;);
+						break;
+						
+						case TextWordType.Tab:
+							for (int k = 0; k &lt; document.TextEditorProperties.TabIndent; ++k) {
+								curFileStream.Write(&quot;&amp;nbsp;&quot;);
+							}
+						break;
+						
+						case TextWordType.Word:
+							Color c = word.Color;
+							string colorstr = c.R + &quot;, &quot; + c.G + &quot;, &quot; + c.B;
+							
+							if (word.Font.Italic) {
+								colorstr = &quot;i&quot; + colorstr;
+							}
+							if (word.Font.Bold) {
+								colorstr = &quot;b&quot; + colorstr;
+							}
+							if (Spans[colorstr] == null) {
+								Spans[colorstr] = &quot;span&quot; + ++curSpanNumber;
+							}
+							bool newColor = c != curColor || oldItalic != word.Font.Italic || oldBold != word.Font.Bold;
+							if (newColor) {
+								if (!firstSpan) {
+									curFileStream.Write(&quot;&lt;/span&gt;&quot; );
+								}
+								
+								curFileStream.Write(&quot;&lt;span class=\&quot;&quot; + Spans[colorstr].ToString() + &quot;\&quot;&gt;&quot; );
+								spanOpen  = true;
+								firstSpan = false;
+							}
+							curFileStream.Write(HtmlLize(word.Word));
+							
+							if (newColor) {
+								curColor = c;
+								oldItalic = word.Font.Italic;
+								oldBold = word.Font.Bold;
+							}
+						break;
+					}
+				}
+				if (spanOpen) {
+					curFileStream.Write(&quot;&lt;/span&gt;&quot; );
+				}
+				curFileStream.Write(&quot;&lt;/TD&gt;\r\n&quot;);
+				curFileStream.Write(&quot;&lt;/TR&gt;\r\n&quot;);
+			}
+			curFileStream.Write(&quot;&lt;/TABLE&gt;&lt;/div&gt;\r\n&quot;);
+			
+			curFileStream.Write(&quot;&lt;P&gt;\r\n&quot;);
+			curFileStream.Write(&quot;This page was automatically generated by \r\n&quot;);
+			curFileStream.Write(&quot;&lt;A TARGET=\&quot;_blank\&quot; HREF=\&quot;<A HREF="http://www.icsharpcode.net/OpenSource/SD\&quot;">http://www.icsharpcode.net/OpenSource/SD\&quot;</A>&gt;SharpDevelop&lt;/A&gt;.\r\n&quot;);
+			curFileStream.Write(&quot;&lt;/p&gt;\r\n&quot;);
+			curFileStream.Write(&quot;&lt;/body&gt;\r\n&quot;);
+			curFileStream.Write(&quot;&lt;/html&gt;\r\n&quot;);
+			curFileStream.Close();
+			return targetFile;
+		}
+		
+		string HtmlLize(string str)
+		{
+			return str.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).Replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).Replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;);
+		}
+		
+		void WriteIndexTable(string fileName, string name, ArrayList nameList, Hashtable table)
+		{
+			curIndexStreamStack.Push(File.CreateText(fileName));
+			StreamWriter curIndexStream = (StreamWriter)curIndexStreamStack.Peek();
+			
+			curIndexStream.Write(&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//W3C//DTD HTML 4.0 Transitional//EN\&quot;&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;html&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;head&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;title&gt;&quot; + project.Name + &quot;&lt;/title&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;/head&gt;\r\n&quot;);
+			
+			curIndexStream.Write(&quot;&lt;body&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;p&gt;Location : &quot;);
+			foreach (Descriptor d in nameList) {
+				curIndexStream.Write(&quot;&lt;a href=\&quot;&quot;+ d.url + &quot;\&quot;&gt;&quot; + d.title + &quot;&lt;/a&gt;/&quot;);
+			}
+			curIndexStream.Write(name);
+			curIndexStream.Write(&quot;&lt;/p&gt;\r\n&quot;);
+			
+			nameList.Add (new Descriptor (name, System.IO.Path.GetFileName (fileName)));
+					
+			curIndexStream.Write(&quot;&lt;TABLE SUMMARY=\&quot;Directory\&quot; BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH=\&quot;100%\&quot;&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;#F38C00\&quot;&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot;&gt;&amp;nbsp;&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;Name&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=RIGHT&gt;Size&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;    &lt;TH WIDTH=\&quot;1%\&quot; NOWRAP ALIGN=LEFT&gt;Date&lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;    &lt;TH VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+			curIndexStream.Write(&quot;    &lt;/TH&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
+			
+			bool coloring = false;
+			foreach (DictionaryEntry entry in table) {
+				if (entry.Value is Hashtable) {
+					string filename = &quot;index&quot; + ++indexFileIndex + &quot;.html&quot;;
+					WriteIndexTable (System.IO.Path.GetDirectoryName (fileName) + System.IO.Path.DirectorySeparatorChar + filename, entry.Key.ToString(), nameList, (Hashtable)entry.Value);
+					nameList.RemoveAt(nameList.Count - 1);
+					curIndexStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;&quot; + (coloring ? &quot;#FFFFFF&quot; : &quot;#EEEEEE&quot;) + &quot;\&quot; VALIGN=TOP&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&lt;a href=\&quot;&quot; + filename + &quot;\&quot;&gt;&lt;IMG ALIGN=ABSBOTTOM BORDER=0 WIDTH=16 HEIGHT=16 SRC=\&quot;folderbitmap.png\&quot;&gt;&lt;/a&gt;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&lt;a href=\&quot;&quot;+ filename + &quot;\&quot;&gt;&quot; + entry.Key.ToString() + &quot;&lt;/a&gt; &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;-&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;-&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
+				} else if (entry.Value is ProjectFile) {
+					ProjectFile fInfo = (ProjectFile)entry.Value;
+					DateTime time = Directory.GetLastAccessTime(fInfo.Name);
+					FileStream reader = File.OpenRead(fInfo.Name);
+					long size = reader.Length;
+					reader.Close();
+					
+					int idx  = GetImageIndex(fInfo.Name);
+					if (bitmapTable[idx] == null) {
+						string filename = &quot;fileicon&quot; + ++bitmapIconIndex + &quot;.png&quot;;
+						
+						//Bitmap bmp = (Bitmap)iconService.ImageList.Images[idx];
+						//bmp.Save(Path.GetDirectoryName(fileName) + Path.DirectorySeparatorChar + filename);
+						//bitmapTable[idx] = filename;
+					}
+					string outFile = ExportFile(fInfo.Name, System.IO.Path.GetDirectoryName(fileName));
+					++FilesExported;
+					curIndexStream.Write(&quot;  &lt;TR BGCOLOR=\&quot;&quot; + (coloring ? &quot;#FFFFFF&quot; : &quot;#EEEEEE&quot;) + &quot;\&quot; VALIGN=TOP&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&lt;a href=\&quot;&quot; + outFile + &quot;\&quot;&gt;&lt;IMG ALIGN=ABSBOTTOM BORDER=0 WIDTH=16 HEIGHT=16 SRC=\&quot;&quot; + bitmapTable[idx].ToString() +&quot;\&quot;&gt;&lt;/a&gt;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=LEFT&gt;&lt;a href=\&quot;&quot; + outFile + &quot;\&quot;&gt;&quot; + System.IO.Path.GetFileName(fInfo.Name) + &quot;&lt;/a&gt; &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + size + &quot;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD NOWRAP VALIGN=TOP ALIGN=RIGHT&gt;&quot; + time.ToString(&quot;d&quot;) + &quot;&lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;TD VALIGN=TOP ALIGN=LEFT&gt;&amp;nbsp; \r\n&quot;);
+					curIndexStream.Write(&quot;    &lt;/TD&gt;\r\n&quot;);
+					curIndexStream.Write(&quot;  &lt;/TR&gt;\r\n&quot;);
+					
+				}
+				coloring = !coloring;
+			}
+			
+			curIndexStream.Write(&quot;&lt;/TABLE&gt;\r\n&quot;);
+			
+			curIndexStream.Write(&quot;&lt;p&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;This page was automatically generated by \r\n&quot;);
+			curIndexStream.Write(&quot;&lt;A TARGET=\&quot;_blank\&quot; HREF=\&quot;<A HREF="http://www.icsharpcode.net/OpenSource/SD\&quot;">http://www.icsharpcode.net/OpenSource/SD\&quot;</A>&gt;SharpDevelop&lt;/A&gt;.\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;/p&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;/body&gt;\r\n&quot;);
+			curIndexStream.Write(&quot;&lt;/html&gt;\r\n&quot;);
+			
+			lock (this) {
+				curIndexStream.Close();
+				curIndexStreamStack.Pop();
+			}
+		}
+		
+		delegate void MyD();
+		
+		void QuitDialog()
+		{
+			//DialogResult = DialogResult.OK;
+		}
+		
+		Thread exportFilesThread; 
+		void ExportFilesThread()
+		{
+			resourceService.GetBitmap(&quot;Icons.16x16.ClosedFolderBitmap&quot;).Save(fileUtilityService.GetDirectoryNameWithSeparator(pathTextBox.Text) + &quot;folderbitmap.png&quot;);
+			WriteIndexTable(fileUtilityService.GetDirectoryNameWithSeparator(pathTextBox.Text) + &quot;index.html&quot;, &quot;[ROOT]&quot;, new ArrayList(), projectTable);
+			CreateCSS(pathTextBox.Text);
+			Invoke(new MyD(QuitDialog));
+		}
+		
+		void StopThread(object sender, EventArgs e)
+		{
+			lock (this) {
+				exportFilesThread.Abort();
+				curFileStream.Close();
+				while (curIndexStreamStack.Count &gt; 0) {
+					((StreamWriter)curIndexStreamStack.Pop()).Close();
+				}
+				QuitDialog();
+			}
+		}
+		
+		void CreateCSS(string targetPath)
+		{
+			lock (this) {
+				StreamWriter sw = File.CreateText(targetPath + Path.DirectorySeparatorChar + &quot;sdcss.css&quot;);
+				sw.Write(&quot;div.code\r\n&quot;);
+				sw.Write(&quot;{\r\n&quot;);
+				sw.Write(&quot;	background-color: rgb(255,255,255);\r\n&quot;);
+				sw.Write(&quot;	font-family: \&quot;Lucida Console\&quot;, \&quot;courier new\&quot;, courier;\r\n&quot;);
+				sw.Write(&quot;	color: rgb(0,0,0);\r\n&quot;);
+				sw.Write(&quot;	font-size: x-small;\r\n&quot;);
+				sw.Write(&quot;	padding: 1em;\r\n&quot;);
+				sw.Write(&quot;	margin: 1em;\r\n&quot;);
+				sw.Write(&quot;}\r\n&quot;);
+				
+				foreach (DictionaryEntry entry in Spans) {
+					string color = entry.Key.ToString();
+					string name  = entry.Value.ToString();
+					bool bold   = color.StartsWith(&quot;b&quot;);
+					if (bold) {
+						color = color.Substring(1);
+					}
+					bool italic = color.StartsWith(&quot;i&quot;);
+					if (italic) {
+						color = color.Substring(1);
+					}
+					
+					sw.Write(&quot;div.code span.&quot; + name +&quot;\r\n&quot;);
+					sw.Write(&quot;{\r\n&quot;);
+					sw.Write(&quot;	color: rgb(&quot;+ color + &quot;);\r\n&quot;);
+					if (bold) {
+						sw.Write(&quot;	font-weight: bold;\r\n&quot;);
+					} else
+					if (italic) {
+						sw.Write(&quot;	font-weight: italic;\r\n&quot;);
+					} else {
+						sw.Write(&quot;	font-weight: normal;\r\n&quot;);
+					}
+					
+					sw.Write(&quot;}\r\n&quot;);
+				}
+				sw.Close();
+			}
+		
+		}
+		
+		void ExportProject(object sender, EventArgs e)
+		{
+			if (!Directory.Exists(pathTextBox.Text)) {
+				MessageBox.Show(&quot;Directory doesn't exists&quot;, &quot;Error&quot;, MessageBoxButtons.OK, MessageBoxIcon.Error);
+				return;
+			}
+			
+			foreach (ProjectFile fInfo in project.ProjectFiles) {
+				if (fInfo.Subtype != Subtype.Directory) {
+					if (fInfo.BuildAction == BuildAction.Compile ||
+					    fInfo.BuildAction == BuildAction.Nothing) {
+						string relativefile = fileUtilityService.AbsoluteToRelativePath(project.BaseDirectory, fInfo.Name);
+						Hashtable table = GetPath(relativefile, projectTable, true);
+						table [System.IO.Path.GetFileName(fInfo.Name)] = fInfo;
+				    }
+				}
+			}
+			
+			StartExporting();
+			exportFilesThread = new Thread(new ThreadStart(ExportFilesThread));
+			exportFilesThread.IsBackground  = true;
+			exportFilesThread.Start();
+		}
+		*/
+	}
+}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000512.html">[Monodevelop-patches-list] r907 - in trunk/MonoDevelop: . build/data build/data/resources build/data/resources/css build/data/resources/languages build/data/templates build/data/templates/file build/data/templates/file/CSharp build/data/templates/file/SharpDevelop build/data/templates/file/VBNet build/data/templates/project build/data/templates/project/CSharp build/data/templates/project/Java build/data/templates/project/Misc build/data/templates/project/VBNet
</A></li>
	<LI>Next message: <A HREF="000514.html">[Monodevelop-patches-list] r909 - trunk/MonoDevelop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#513">[ date ]</a>
              <a href="thread.html#513">[ thread ]</a>
              <a href="subject.html#513">[ subject ]</a>
              <a href="author.html#513">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
