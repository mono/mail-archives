<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r807 - in trunk/MonoDevelop/src: AddIns/DisplayBindings/SourceEditor/Gui AddIns/DisplayBindings/TextEditor/Gui/Editor Main/Base/Gui/BrowserDisplayBinding Main/Base/Internal/Codons/DisplayBinding Main/Base/Services/DisplayBinding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r807%20-%20in%20trunk/MonoDevelop/src%3A%20AddIns/DisplayBindings/SourceEditor/Gui%20AddIns/DisplayBindings/TextEditor/Gui/Editor%20Main/Base/Gui/BrowserDisplayBinding%20Main/Base/Internal/Codons/DisplayBinding%20Main/Base/Services/DisplayBinding&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000411.html">
   <LINK REL="Next"  HREF="000413.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r807 - in trunk/MonoDevelop/src: AddIns/DisplayBindings/SourceEditor/Gui AddIns/DisplayBindings/TextEditor/Gui/Editor Main/Base/Gui/BrowserDisplayBinding Main/Base/Internal/Codons/DisplayBinding Main/Base/Services/DisplayBinding</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r807%20-%20in%20trunk/MonoDevelop/src%3A%20AddIns/DisplayBindings/SourceEditor/Gui%20AddIns/DisplayBindings/TextEditor/Gui/Editor%20Main/Base/Gui/BrowserDisplayBinding%20Main/Base/Internal/Codons/DisplayBinding%20Main/Base/Services/DisplayBinding&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r807 - in trunk/MonoDevelop/src: AddIns/DisplayBindings/SourceEditor/Gui AddIns/DisplayBindings/TextEditor/Gui/Editor Main/Base/Gui/BrowserDisplayBinding Main/Base/Internal/Codons/DisplayBinding Main/Base/Services/DisplayBinding">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sat Feb  7 15:31:02 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000411.html">[Monodevelop-patches-list] r806 - trunk/MonoDevelop
</A></li>
        <LI>Next message: <A HREF="000413.html">[Monodevelop-patches-list] r808 - trunk/MonoDevelop/src/Main/Base/Gui/BrowserDisplayBinding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#412">[ date ]</a>
              <a href="thread.html#412">[ thread ]</a>
              <a href="subject.html#412">[ subject ]</a>
              <a href="author.html#412">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-02-07 15:31:02 -0500 (Sat, 07 Feb 2004)
New Revision: 807

Modified:
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Gui/Editor/TextEditorDisplayBinding.cs
   trunk/MonoDevelop/src/Main/Base/Gui/BrowserDisplayBinding/BrowserDisplayBinding.cs
   trunk/MonoDevelop/src/Main/Base/Internal/Codons/DisplayBinding/IDisplayBinding.cs
   trunk/MonoDevelop/src/Main/Base/Services/DisplayBinding/DisplayBindingService.cs
Log:
we are attempting to load based on mimetype *FIRST* then on filename, lets see what kinda results we get from this, and if everything is working out well, we will remove the by filename and launch external progs for mimetypes we dont understand.


Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-02-07 19:08:28 UTC (rev 806)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Gui/SourceEditorDisplayBinding.cs	2004-02-07 20:31:02 UTC (rev 807)
@@ -24,6 +24,12 @@
 		{
 			return true;
 		}
+
+		public virtual bool CanCreateContentForMimeType (string mimetype)
+		{
+			if (mimetype.StartsWith (&quot;text&quot;)) return true;
+			return false;
+		}
 		
 		public virtual bool CanCreateContentForLanguage (string language)
 		{

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Gui/Editor/TextEditorDisplayBinding.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Gui/Editor/TextEditorDisplayBinding.cs	2004-02-07 19:08:28 UTC (rev 806)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/TextEditor/Gui/Editor/TextEditorDisplayBinding.cs	2004-02-07 20:31:02 UTC (rev 807)
@@ -44,6 +44,12 @@
 		{
 			return true;
 		}
+
+		public virtual bool CanCreateContentForMimeType (string mimetype)
+		{
+			if (mimetype.StartsWith (&quot;text&quot;)) return true;
+			return false;
+		}
 		
 		public virtual bool CanCreateContentForLanguage(string language)
 		{

Modified: trunk/MonoDevelop/src/Main/Base/Gui/BrowserDisplayBinding/BrowserDisplayBinding.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/BrowserDisplayBinding/BrowserDisplayBinding.cs	2004-02-07 19:08:28 UTC (rev 806)
+++ trunk/MonoDevelop/src/Main/Base/Gui/BrowserDisplayBinding/BrowserDisplayBinding.cs	2004-02-07 20:31:02 UTC (rev 807)
@@ -24,6 +24,16 @@
 		{
 			return fileName.StartsWith(&quot;http&quot;) || fileName.StartsWith(&quot;ftp&quot;);
 		}
+
+		public bool CanCreateContentForMimeType (string mimetype)
+		{
+			switch (mimetype) {
+				case &quot;text/html&quot;:
+					return true;
+				default:
+					return false;
+			}
+		}
 		
 		public bool CanCreateContentForLanguage(string language)
 		{

Modified: trunk/MonoDevelop/src/Main/Base/Internal/Codons/DisplayBinding/IDisplayBinding.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Internal/Codons/DisplayBinding/IDisplayBinding.cs	2004-02-07 19:08:28 UTC (rev 806)
+++ trunk/MonoDevelop/src/Main/Base/Internal/Codons/DisplayBinding/IDisplayBinding.cs	2004-02-07 20:31:02 UTC (rev 807)
@@ -31,6 +31,8 @@
 		/// &lt;/returns&gt;
 		bool CanCreateContentForFile(string fileName);
 		
+		bool CanCreateContentForMimeType (string mimetype);
+		
 		/// &lt;remarks&gt;
 		/// Creates a new IViewContent object for the file fileName
 		/// &lt;/remarks&gt;

Modified: trunk/MonoDevelop/src/Main/Base/Services/DisplayBinding/DisplayBindingService.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Services/DisplayBinding/DisplayBindingService.cs	2004-02-07 19:08:28 UTC (rev 806)
+++ trunk/MonoDevelop/src/Main/Base/Services/DisplayBinding/DisplayBindingService.cs	2004-02-07 20:31:02 UTC (rev 807)
@@ -44,7 +44,14 @@
 		
 		public DisplayBindingCodon GetCodonPerFileName(string filename)
 		{
+			string mimetype = MonoDevelop.GuiUtils.Vfs.GetMimeType (filename);
 			foreach (DisplayBindingCodon binding in bindings) {
+				if (binding.DisplayBinding != null &amp;&amp; binding.DisplayBinding.CanCreateContentForMimeType (mimetype)) {
+					return binding;
+				}
+			}
+			Console.WriteLine (&quot;Didnt match on mimetype, trying filename&quot;);
+			foreach (DisplayBindingCodon binding in bindings) {
 				if (binding.DisplayBinding != null &amp;&amp; binding.DisplayBinding.CanCreateContentForFile(filename)) {
 					return binding;
 				}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000411.html">[Monodevelop-patches-list] r806 - trunk/MonoDevelop
</A></li>
	<LI>Next message: <A HREF="000413.html">[Monodevelop-patches-list] r808 - trunk/MonoDevelop/src/Main/Base/Gui/BrowserDisplayBinding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#412">[ date ]</a>
              <a href="thread.html#412">[ thread ]</a>
              <a href="subject.html#412">[ subject ]</a>
              <a href="author.html#412">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
