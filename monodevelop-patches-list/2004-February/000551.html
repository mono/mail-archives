<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r946 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r946%20-%20trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000550.html">
   <LINK REL="Next"  HREF="000552.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r946 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r946%20-%20trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r946 - trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Thu Feb 19 14:33:19 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000550.html">[Monodevelop-patches-list] r945 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: Gui Search
</A></li>
        <LI>Next message: <A HREF="000552.html">[Monodevelop-patches-list] r947 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: Gui Search Search/DocumentIterator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#551">[ date ]</a>
              <a href="thread.html#551">[ thread ]</a>
              <a href="subject.html#551">[ subject ]</a>
              <a href="author.html#551">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-02-19 14:33:19 -0500 (Thu, 19 Feb 2004)
New Revision: 946

Modified:
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/AllOpenDocumentIterator.cs
   trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/DirectoryDocumentIterator.cs
Log:
fixing up two of the document iterators, now find in all open files should work.

please note, im AWARE my finding impl is ass slow, its easy to debug, ill speed it up once i get find/replace working slowly :)


Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/AllOpenDocumentIterator.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/AllOpenDocumentIterator.cs	2004-02-19 19:20:58 UTC (rev 945)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/AllOpenDocumentIterator.cs	2004-02-19 19:33:19 UTC (rev 946)
@@ -11,6 +11,8 @@
 using ICSharpCode.SharpDevelop.Gui;
 using ICSharpCode.TextEditor;
 
+using MonoDevelop.SourceEditor.Gui;
+
 namespace ICSharpCode.TextEditor.Document
 {
 	public class AllOpenDocumentIterator : IDocumentIterator
@@ -42,10 +44,9 @@
 				if (!SearchReplaceUtilities.IsTextAreaSelected) {
 					return null;
 				}
-				//IDocument document = (((ITextEditorControlProvider)WorkbenchSingleton.Workbench.ActiveWorkbenchWindow.ViewContent).TextEditorControl).Document;
-				//return new ProvidedDocumentInformation(document,
-				//                                       CurrentFileName);
-				return null;
+				SourceEditor document = (SourceEditor) (((SourceEditorDisplayBindingWrapper)WorkbenchSingleton.Workbench.ActiveWorkbenchWindow.ViewContent).Control);
+				return new ProvidedDocumentInformation(document,
+				                                       CurrentFileName);
 			}
 		}
 		

Modified: trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/DirectoryDocumentIterator.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/DirectoryDocumentIterator.cs	2004-02-19 19:20:58 UTC (rev 945)
+++ trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor/Search/DocumentIterator/DirectoryDocumentIterator.cs	2004-02-19 19:33:19 UTC (rev 946)
@@ -16,6 +16,8 @@
 using ICSharpCode.SharpDevelop.Services;
 using ICSharpCode.TextEditor;
 
+using MonoDevelop.SourceEditor.Gui;
+
 namespace ICSharpCode.TextEditor.Document
 {
 	public class DirectoryDocumentIterator : IDocumentIterator
@@ -48,27 +50,27 @@
 				
 		public ProvidedDocumentInformation Current {
 			get {
-				/*if (curIndex &lt; 0 || curIndex &gt;= files.Count) {
+				if (curIndex &lt; 0 || curIndex &gt;= files.Count) {
 					return null;
 				}
 				if (!File.Exists(files[curIndex].ToString())) {
 					++curIndex;
 					return Current;
 				}
-				IDocument document;
+				SourceEditor document;
 				string fileName = files[curIndex].ToString();
 				foreach (IViewContent content in WorkbenchSingleton.Workbench.ViewContentCollection) {
 					// WINDOWS DEPENDENCY : ToUpper
 					if (content.ContentName != null &amp;&amp;
 						content.ContentName.ToUpper() == fileName.ToUpper()) {
-						document = ((ITextEditorControlProvider)content).TextEditorControl.Document;
+						document = (SourceEditor) ((SourceEditorDisplayBindingWrapper)content).Control;
 						return new ProvidedDocumentInformation(document,
 						                                       fileName);
 					}
 				}
-				ITextBufferStrategy strategy = null;
+				SourceEditorBuffer strategy = null;
 				try {
-					strategy = StringTextBufferStrategy.CreateTextBufferFromFile(fileName);
+					strategy = SourceEditorBuffer.CreateTextBufferFromFile(fileName);
 				} catch (Exception) {
 					TaskService taskService = (TaskService)ICSharpCode.Core.Services.ServiceManager.Services.GetService(typeof(TaskService));
 					taskService.Tasks.Add(new Task(String.Empty, &quot;can't access &quot; + fileName, -1, -1));
@@ -77,8 +79,6 @@
 				return new ProvidedDocumentInformation(strategy, 
 				                                       fileName, 
 				                                       0);
-				*/
-				return null;
 			}
 		}
 		


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000550.html">[Monodevelop-patches-list] r945 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: Gui Search
</A></li>
	<LI>Next message: <A HREF="000552.html">[Monodevelop-patches-list] r947 - in trunk/MonoDevelop/src/AddIns/DisplayBindings/SourceEditor: Gui Search Search/DocumentIterator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#551">[ date ]</a>
              <a href="thread.html#551">[ thread ]</a>
              <a href="subject.html#551">[ subject ]</a>
              <a href="author.html#551">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
