<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r2491 - trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2491%20-%20trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002090.html">
   <LINK REL="Next"  HREF="002092.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r2491 - trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn</H1>
    <B>Chris Toshok</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2491%20-%20trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r2491 - trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn">toshok at mono-cvs.ximian.com
       </A><BR>
    <I>Thu Apr 28 18:11:27 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002090.html">[Monodevelop-patches-list] r2490 - in trunk/MonoDevelop/Extras/BooBinding: . BooShellServer
</A></li>
        <LI>Next message: <A HREF="002092.html">[Monodevelop-patches-list] r2492 - trunk/MonoDevelop/Extras/BooBinding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2091">[ date ]</a>
              <a href="thread.html#2091">[ thread ]</a>
              <a href="subject.html#2091">[ subject ]</a>
              <a href="author.html#2091">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: toshok
Date: 2005-04-28 18:11:27 -0400 (Thu, 28 Apr 2005)
New Revision: 2491

Added:
   trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebuggerPaths.cs.in
Modified:
   trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/ChangeLog
   trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebugAttributeHandler.cs
   trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/Makefile.am
Log:
2005-04-28  Chris Toshok  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">toshok at ximian.com</A>&gt;

	* DebugAttributeHandler.cs
	(DebugAttributeHandler.ScanDirectory): split out the bulk of
	Rescan and put it here so we can support multiple assembly drop
	points.
	(DebugAttributeHandler.Rescan): call ScanDirectory with
	DebuggerPaths.VisualizerPath.

	* DebuggerPaths.cs.in: new file so we can insert configure'd
	paths.
	
	* Makefile.am (build_sources): add DebuggerPaths.cs
	(DebuggerPaths.cs): add rule to build this file.
	(DISTCLEANFILES): add DebuggerPaths.cs



Modified: trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/ChangeLog	2005-04-28 02:54:48 UTC (rev 2490)
+++ trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/ChangeLog	2005-04-28 22:11:27 UTC (rev 2491)
@@ -1,3 +1,19 @@
+2005-04-28  Chris Toshok  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">toshok at ximian.com</A>&gt;
+
+	* DebugAttributeHandler.cs
+	(DebugAttributeHandler.ScanDirectory): split out the bulk of
+	Rescan and put it here so we can support multiple assembly drop
+	points.
+	(DebugAttributeHandler.Rescan): call ScanDirectory with
+	DebuggerPaths.VisualizerPath.
+
+	* DebuggerPaths.cs.in: new file so we can insert configure'd
+	paths.
+	
+	* Makefile.am (build_sources): add DebuggerPaths.cs
+	(DebuggerPaths.cs): add rule to build this file.
+	(DISTCLEANFILES): add DebuggerPaths.cs
+
 2005-04-27  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at novell.com</A>&gt;
 
 	* DebuggingService.cs: Track api changes in IDebuggingServices.

Modified: trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebugAttributeHandler.cs
===================================================================
--- trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebugAttributeHandler.cs	2005-04-28 02:54:48 UTC (rev 2490)
+++ trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebugAttributeHandler.cs	2005-04-28 22:11:27 UTC (rev 2491)
@@ -20,13 +20,9 @@
 
 	public class DebugAttributeHandler
 	{
-		public void Rescan () {
-
-		  display_by_type_name = new Hashtable ();
-		  proxy_by_type_name = new Hashtable ();
-		  visualizers_by_type_name = new Hashtable ();
-
-			DirectoryInfo info = new DirectoryInfo (&quot;/opt/mono/lib/monodevelop/Debugger/&quot;);
+		public void ScanDirectory (string dir)
+		{
+			DirectoryInfo info = new DirectoryInfo (dir);
 			FileInfo[] dlls = info.GetFiles (&quot;*.dll&quot;);
 
 			foreach (FileInfo dll_info in dlls) {
@@ -62,11 +58,20 @@
 
 					vas.Add (va);
 
-					Console.WriteLine (&quot;VISUALIZER ATTIRBUTE for type {0}&quot;, va.TargetTypeName);
+					Console.WriteLine (&quot;VISUALIZER ATTRIBUTE for type {0}&quot;, va.TargetTypeName);
 				}
 			}
 		}
 
+		public void Rescan () {
+
+			display_by_type_name = new Hashtable ();
+			proxy_by_type_name = new Hashtable ();
+			visualizers_by_type_name = new Hashtable ();
+
+			ScanDirectory (DebuggerPaths.VisualizerPath);
+		}
+
 		public string EvaluateDebuggerDisplay (ITargetObject obj, string display)
 		{
 			StringBuilder sb = new StringBuilder (&quot;&quot;);

Added: trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebuggerPaths.cs.in
===================================================================
--- trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebuggerPaths.cs.in	2005-04-28 02:54:48 UTC (rev 2490)
+++ trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/DebuggerPaths.cs.in	2005-04-28 22:11:27 UTC (rev 2491)
@@ -0,0 +1,8 @@
+
+namespace MonoDevelop.Debugger
+{
+	public class DebuggerPaths
+	{
+		public static readonly string VisualizerPath = &quot;@pkglibdir@/Debugger&quot;;
+	}
+}

Modified: trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/Makefile.am
===================================================================
--- trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/Makefile.am	2005-04-28 02:54:48 UTC (rev 2490)
+++ trunk/MonoDevelop/Core/src/AddIns/DebuggerAddIn/Makefile.am	2005-04-28 22:11:27 UTC (rev 2491)
@@ -29,21 +29,26 @@
 
 all: $(ASSEMBLY) $(ADDIN_BUILD)/$(ADDIN)
 
-build_sources = $(addprefix $(srcdir)/, $(FILES))
+build_sources = $(addprefix $(srcdir)/, $(FILES)) DebuggerPaths.cs
 
+DebuggerPaths.cs: $(srcdir)/DebuggerPaths.cs.in
+	sed -e 's,@''pkglibdir@,$(pkglibdir),g' $(srcdir)/$&lt; &gt; $@.tmp
+	mv $@.tmp $@
+
 $(ADDIN_BUILD)/$(ADDIN): $(srcdir)/$(ADDIN)
 	mkdir -p $(ADDIN_BUILD)
 	cp $(ADDIN) $(ADDIN_BUILD)/.
 
 $(ASSEMBLY): $(build_sources)
 	mkdir -p $(ADDIN_BUILD)
-	$(CSC) -out:$@ -target:library \
+	$(CSC) -debug -define:NET_2_0 -out:$@ -target:library \
 	$(build_sources) $(DLLS)
 
 assemblydir = $(libdir)/monodevelop/AddIns/DebuggerAddIn
-assembly_DATA = $(ASSEMBLY) $(ADDIN)
+assembly_DATA = $(ASSEMBLY) $(ASSEMBLY).mdb $(ADDIN)
 
 CLEANFILES = $(ASSEMBLY) $(ASSEMBLY).mdb
+DISTCLEANFILES = DebuggerPaths.cs
 
 else
 all:


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002090.html">[Monodevelop-patches-list] r2490 - in trunk/MonoDevelop/Extras/BooBinding: . BooShellServer
</A></li>
	<LI>Next message: <A HREF="002092.html">[Monodevelop-patches-list] r2492 - trunk/MonoDevelop/Extras/BooBinding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2091">[ date ]</a>
              <a href="thread.html#2091">[ thread ]</a>
              <a href="subject.html#2091">[ subject ]</a>
              <a href="author.html#2091">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
