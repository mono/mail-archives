<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r2458 - in trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory: . src src/Parser/AST tests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2458%20-%20in%20trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory%3A%20.%20src%20src/Parser/AST%20tests&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002058.html">
   <LINK REL="Next"  HREF="002060.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r2458 - in trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory: . src src/Parser/AST tests</H1>
    <B>John Luke &lt;jluke@cfl.rr.com&gt;</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2458%20-%20in%20trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory%3A%20.%20src%20src/Parser/AST%20tests&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r2458 - in trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory: . src src/Parser/AST tests">jluke at mono-cvs.ximian.com
       </A><BR>
    <I>Fri Apr 15 12:43:43 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002058.html">[Monodevelop-patches-list] r2457 - in trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory: . src/Parser/AST tests
</A></li>
        <LI>Next message: <A HREF="002060.html">[Monodevelop-patches-list] r2459 - in trunk/MonoDevelop: . Core/src/MonoDevelop.Dock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2059">[ date ]</a>
              <a href="thread.html#2059">[ thread ]</a>
              <a href="subject.html#2059">[ subject ]</a>
              <a href="author.html#2059">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jluke
Date: 2005-04-15 12:43:43 -0400 (Fri, 15 Apr 2005)
New Revision: 2458

Modified:
   trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/ChangeLog
   trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Main.cs
   trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Parser/AST/Modifier.cs
   trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/tests/unsafe-1.cs
Log:
more unsafe fixes


Modified: trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/ChangeLog	2005-04-15 16:11:17 UTC (rev 2457)
+++ trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/ChangeLog	2005-04-15 16:43:43 UTC (rev 2458)
@@ -1,6 +1,7 @@
 2005-04-15  John Luke  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">john.luke at gmail.com</A>&gt;
 
 	* src/Parser/AST/Modifier.cs: add Unsafe to PropertysEventsMethods
+	and class, struct, interface, delegate, and field
 	* tests/unsafe-1.cs: new test
 
 2005-04-13  John Luke  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">john.luke at gmail.com</A>&gt;

Modified: trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Main.cs
===================================================================
--- trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Main.cs	2005-04-15 16:11:17 UTC (rev 2457)
+++ trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Main.cs	2005-04-15 16:43:43 UTC (rev 2458)
@@ -20,6 +20,8 @@
 	static void PrintFile (FileInfo file)
 	{
 		string fileName = file.FullName;
+		//Console.WriteLine (&quot;parsing {0}&quot;, fileName);
+		Parser p = new Parser();
 		p.Parse (new Lexer (new FileReader (fileName)));
 
 		if (p.Errors.count == 0) {
@@ -48,7 +50,6 @@
 			PrintDir (di);
 	}
 
-	static Parser p;
 	static bool errorMode = false;
 
 	public static void Main (string[] args)
@@ -59,7 +60,6 @@
 		if (args.Length == 2 &amp;&amp; args[1] == &quot;-e&quot;)
 			errorMode = true;
 
-		p = new Parser();
 		PrintDir (new DirectoryInfo (args[0]));
 	}
 }

Modified: trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Parser/AST/Modifier.cs
===================================================================
--- trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Parser/AST/Modifier.cs	2005-04-15 16:11:17 UTC (rev 2457)
+++ trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/src/Parser/AST/Modifier.cs	2005-04-15 16:43:43 UTC (rev 2458)
@@ -29,13 +29,14 @@
 		// Modifier scopes
 		None      = 0x0000,
 		
-		Classes                         = New | Public | Protected | Internal | Private | Abstract | Sealed | Static,
-		Fields                          = New | Public | Protected | Internal | Private | Static   | Readonly | Volatile,
+		Classes                         = New | Public | Protected | Internal | Private | Abstract | Sealed | Static | Unsafe,
+		Fields                          = New | Public | Protected | Internal | Private | Static   | Readonly | Volatile | Unsafe,
 		PropertysEventsMethods          = New | Public | Protected | Internal | Private | Static   | Virtual  | Sealed   | Override | Abstract | Extern | Unsafe,
 		Indexers                        = New | Public | Protected | Internal | Private | Virtual  | Sealed   | Override | Abstract | Extern,
 		Operators                       = Public | Static | Extern,
 		Constants                       = New | Public | Protected | Internal | Private,
-		StructsInterfacesEnumsDelegates = New | Public | Protected | Internal | Private,
+		// FIXME: unsafe is not valid for enums
+		StructsInterfacesEnumsDelegates = New | Public | Protected | Internal | Private | Unsafe,
 		StaticConstructors              = Extern | Static | Unsafe,
 		Destructors                     = Extern | Unsafe,
 		Constructors                    = Public | Protected | Internal | Private | Extern,

Modified: trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/tests/unsafe-1.cs
===================================================================
--- trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/tests/unsafe-1.cs	2005-04-15 16:11:17 UTC (rev 2457)
+++ trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory/tests/unsafe-1.cs	2005-04-15 16:43:43 UTC (rev 2458)
@@ -1,7 +1,13 @@
 using System;
 
-class T
+unsafe interface IFoo
 {
+}
+
+unsafe class T
+{
+	unsafe int* counter;
+
 	unsafe private void Foo ()
 	{
 	}
@@ -12,3 +18,10 @@
 
 	unsafe public event EventHandler Notify;
 }
+
+unsafe struct Foo
+{
+}
+
+unsafe delegate void FooBar ();
+


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002058.html">[Monodevelop-patches-list] r2457 - in trunk/MonoDevelop/Core/src/ICSharpCode.SharpRefactory: . src/Parser/AST tests
</A></li>
	<LI>Next message: <A HREF="002060.html">[Monodevelop-patches-list] r2459 - in trunk/MonoDevelop: . Core/src/MonoDevelop.Dock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2059">[ date ]</a>
              <a href="thread.html#2059">[ thread ]</a>
              <a href="subject.html#2059">[ subject ]</a>
              <a href="author.html#2059">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
