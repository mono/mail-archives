<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r2732 - in	trunk/MonoDevelop/Extras/BooBinding: . Parser
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2732%20-%20in%0A%09trunk/MonoDevelop/Extras/BooBinding%3A%20.%20Parser&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002330.html">
   <LINK REL="Next"  HREF="002332.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r2732 - in	trunk/MonoDevelop/Extras/BooBinding: . Parser</H1>
    <B>Peter Johanson &lt;latexer@gentoo.org&gt;</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2732%20-%20in%0A%09trunk/MonoDevelop/Extras/BooBinding%3A%20.%20Parser&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r2732 - in	trunk/MonoDevelop/Extras/BooBinding: . Parser">pjohanson at mono-cvs.ximian.com
       </A><BR>
    <I>Wed Aug 10 09:27:32 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002330.html">[Monodevelop-patches-list] r2731 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: . Services
</A></li>
        <LI>Next message: <A HREF="002332.html">[Monodevelop-patches-list] r2733 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: .	Services/ProcessService
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2331">[ date ]</a>
              <a href="thread.html#2331">[ thread ]</a>
              <a href="subject.html#2331">[ subject ]</a>
              <a href="author.html#2331">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: pjohanson
Date: 2005-08-10 09:27:32 -0400 (Wed, 10 Aug 2005)
New Revision: 2732

Modified:
   trunk/MonoDevelop/Extras/BooBinding/ChangeLog
   trunk/MonoDevelop/Extras/BooBinding/Parser/BooParser.boo
   trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionFinder.boo
   trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionTypeVisitor.boo
   trunk/MonoDevelop/Extras/BooBinding/Parser/Resolver.boo
   trunk/MonoDevelop/Extras/BooBinding/Parser/ReturnType.boo
   trunk/MonoDevelop/Extras/BooBinding/Parser/VariableLookupVisitor.boo
   trunk/MonoDevelop/Extras/BooBinding/Parser/Visitor.boo
Log:
Add better error reporting via logging by type.


Modified: trunk/MonoDevelop/Extras/BooBinding/ChangeLog
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/ChangeLog	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/ChangeLog	2005-08-10 13:27:32 UTC (rev 2732)
@@ -1,3 +1,13 @@
+2005-08-10  Peter Johanson  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">latexer at gentoo.org</A>&gt;
+
+	* Parser/ExpressionTypeVisitor.boo:
+	* Parser/Resolver.boo:
+	* Parser/ReturnType.boo:
+	* Parser/ExpressionFinder.boo:
+	* Parser/BooParser.boo:
+	* Parser/VariableLookupVisitor.boo:
+	* Parser/Visitor.boo: Add better error reporting via logging by type.
+
 2005-08-09  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at novell.com</A>&gt;
 
 	* Parser/ReturnType.boo:

Modified: trunk/MonoDevelop/Extras/BooBinding/Parser/BooParser.boo
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/Parser/BooParser.boo	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/Parser/BooParser.boo	2005-08-10 13:27:32 UTC (rev 2732)
@@ -65,7 +65,7 @@
 		return Parse(fileName, content)
 	
 	def Parse(fileName as string, fileContent as string) as ICompilationUnitBase:
-		//print &quot;Parse ${fileName} with content&quot;
+		Log (&quot;Parse ${fileName} with content&quot;)
 		
 		cr = char('\r')
 		ln = char('\n')
@@ -128,8 +128,7 @@
 			// somehow the SD parser thread goes into an endless loop if this flag is not set
 			visitor.Cu.ErrorsDuringCompile = true //context.Errors.Count &gt; 0
 		except e:
-			//ShowException(e)
-			print &quot;ShowException ${e}&quot;
+			Error (e.ToString ())
 
 		for c as IClass in visitor.Cu.Classes:
 			if c.Region is not null:
@@ -148,7 +147,7 @@
 		return visitor.Cu
 	
 	def CtrlSpace(parserContext as IParserContext, caretLine as int, caretColumn as int, fileName as string) as ArrayList:
-		//print &quot;Ctrl-Space (${caretLine}/${caretColumn})&quot;
+		Log (&quot;Ctrl-Space (${caretLine}/${caretColumn})&quot;)
 		try:
 			return Resolver(parserContext).CtrlSpace(caretLine, caretColumn, fileName)
 		except e:
@@ -159,26 +158,29 @@
 		return Resolver (parserContext).IsAsResolve (expression, caretLineNumber, caretColumn, fileName, fileContent)
 
 	def Resolve(parserContext as IParserContext, expression as string, caretLineNumber as int, caretColumn as int, fileName as string, fileContent as string) as ResolveResult:
-		//print &quot;Resolve ${expression} (${caretLineNumber}/${caretColumn})&quot;
+		Log (&quot;Resolve ${expression} (${caretLineNumber}/${caretColumn})&quot;)
 		try:
 			return Resolver(parserContext).Resolve(expression, caretLineNumber, caretColumn, fileName, fileContent)
 		except e:
-			//ShowException(e)
+			Error (e.ToString ())
 			return null
 
 	def MonodocResolver(parserContext as IParserContext, expression as string, caretLineNumber as int, caretColumn as int, fileName as string, fileContent as string) as string:
-		//print &quot;MonodocResolver ${expression} (${caretLineNumber}/${caretColumn})&quot;
+		Log (&quot;MonodocResolver ${expression} (${caretLineNumber}/${caretColumn})&quot;)
 		try:
 			return Resolver(parserContext).MonodocResolver(expression, caretLineNumber, caretColumn, fileName, fileContent)
 		except e:
 			//ShowException(e)
 			return null
 	
-	/*
-	static def ShowException(e as Exception):
-		//messageService as IMessageService = ServiceManager.Services.GetService(typeof(IMessageService))
-		//messageService.ShowError(e.ToString())
-		retur
-	*/
+	private def Log (message):
+		Log (self.GetType(), message)
 
+	private def Error (message):
+		Error (self.GetType(), message)
 
+	static def Log (type, message):
+		MonoDevelop.Services.Runtime.LoggingService.Debug (type.ToString (), message)
+	
+	static def Error (type, message):
+		MonoDevelop.Services.Runtime.LoggingService.Error (type.ToString (), message)

Modified: trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionFinder.boo
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionFinder.boo	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionFinder.boo	2005-08-10 13:27:32 UTC (rev 2732)
@@ -49,7 +49,7 @@
 	
 	def FindExpression(inText as string, offset as int) as string:
 		return null if inText == null
-		print &quot;Trying quickfind for ${offset}&quot;
+		Log (&quot;Trying quickfind for ${offset}&quot;)
 		// OK, first try a kind of &quot;quick find&quot;
 		i = offset + 1
 		forbidden = '&quot;\'/#)]}'
@@ -62,7 +62,7 @@
 				start = i + 1
 				break
 			if forbidden.IndexOf(c) &gt;= 0:
-				print &quot;Quickfind failed: got ${c}&quot;
+				Log (&quot;Quickfind failed: got ${c}&quot;)
 				break
 			if Char.IsWhiteSpace(c):
 				if i &gt; 6 and inText.Substring(i - 6, 6) == &quot;import&quot;:
@@ -75,7 +75,7 @@
 		
 		inText = SimplifyCode(inText, offset)
 		if inText == null:
-			print 'SimplifyCode returned null (cursor is in comment/string???)'
+			Log ('SimplifyCode returned null (cursor is in comment/string???)')
 			return null
 		// inText now has no comments or string literals, but the same meaning in
 		// terms of the type system
@@ -124,7 +124,7 @@
 				wasSpace = false
 				b.Append(c)
 			i += 1
-		print &quot;Expression is '${b}'&quot;
+		Log (&quot;Expression is '${b}'&quot;)
 		return b.ToString().Trim()
 	
 	// this method makes boo source code &quot;simpler&quot; by removing all comments
@@ -212,3 +212,6 @@
 			return inStringResult.ToString()
 		else:
 			return null
+	
+	private def Log (message):
+		BooParser.Log (self.GetType(), message)

Modified: trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionTypeVisitor.boo
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionTypeVisitor.boo	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/Parser/ExpressionTypeVisitor.boo	2005-08-10 13:27:32 UTC (rev 2732)
@@ -32,9 +32,15 @@
 
 class ExpressionTypeVisitor(DepthFirstVisitor):
 	protected override def OnError(node as Node, error as Exception):
-		//BooParser.ShowException(error)
+		Error (error.ToString ())
 		super(node, error)
 	
+	private def Log (message):
+		BooParser.Log (self.GetType (), message)
+	
+	private def Error (message):
+		BooParser.Error (self.GetType (), message)
+
 	[Property(ReturnType)]
 	_returnType as IReturnType
 	
@@ -71,9 +77,9 @@
 	
 	private def Debug(node):
 		if node == null:
-			print &quot;-- null --&quot;
+			Log (&quot;-- null --&quot;)
 		else:
-			print &quot;${node.ToString()} - ${node.GetType().FullName}&quot;
+			Log (&quot;${node.ToString()} - ${node.GetType().FullName}&quot;)
 	
 	override def OnCallableBlockExpression(node as CallableBlockExpression):
 		Debug(node)
@@ -106,7 +112,7 @@
 	private def ProcessMethod(node as MethodInvocationExpression, name as string, c as IClass) as bool:
 		return false if c == null
 		possibleOverloads = FindMethods(c, name, node.Arguments.Count)
-		//print &quot;found ${possibleOverloads.Count} overloads (multiple overloads not supported yet)&quot;
+		Log (&quot;found ${possibleOverloads.Count} overloads (multiple overloads not supported yet)&quot;)
 		if possibleOverloads.Count &gt;= 1:
 			SetReturnType(cast(IMethod, possibleOverloads[0]).ReturnType)
 			return true

Modified: trunk/MonoDevelop/Extras/BooBinding/Parser/Resolver.boo
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/Parser/Resolver.boo	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/Parser/Resolver.boo	2005-08-10 13:27:32 UTC (rev 2732)
@@ -76,7 +76,7 @@
 
 	#region Helper methods
 	private def ResolveCurrentMember() as IMember:
-		print &quot;Getting current method... caretLine = ${_caretLine}, caretColumn = ${_caretColumn}&quot;
+		Log (&quot;Getting current method... caretLine = ${_caretLine}, caretColumn = ${_caretColumn}&quot;)
 		return null if _callingClass == null
 		best as IMember = null
 		line = 0
@@ -116,9 +116,9 @@
 				return para.ReturnType if para.Name == name
 			if method.Node != null and method.Node.Body != null:
 				varLookup = VariableLookupVisitor(Resolver: self, LookFor: name)
-				print &quot;Visiting method body...&quot;
+				Log (&quot;Visiting method body of '${method.Name}'&quot;)
 				varLookup.Visit(method.Node.Body)
-				print &quot;Finished visiting method body!&quot;
+				Log (&quot;Finished visiting method body!&quot;)
 				return varLookup.ReturnType
 		elif member isa Property:
 			property as Property = member
@@ -129,16 +129,16 @@
 			if property.Node != null:
 				varLookup = VariableLookupVisitor(Resolver: self, LookFor: name)
 				// TODO: visit only the correct body
-				print &quot;Visiting property body...&quot;
+				Log (&quot;Visiting property body...&quot;)
 				varLookup.Visit(property.Node.Getter) unless property.Node.Getter == null
 				varLookup.Visit(property.Node.Setter) unless property.Node.Setter == null
-				print &quot;Finished visiting property body!&quot;
+				Log (&quot;Finished visiting property body!&quot;)
 				/*
 				if varLookup.ReturnType is null:
-					print &quot;null return type!&quot;
+					Log (&quot;null return type!&quot;)
 					return ReturnType(&quot;System.Object&quot;)
 					*/
-				print &quot;ReturnType: ${varLookup.ReturnType}&quot;
+				Log (&quot;ReturnType: ${varLookup.ReturnType}&quot;)
 				return varLookup.ReturnType
 		return null
 	
@@ -247,7 +247,7 @@
 		cu = parseInfo.MostRecentCompilationUnit as CompilationUnit
 		_compilationUnit = cu
 		if _compilationUnit == null:
-			print &quot;BooResolver: No parse information!&quot;
+			Log (&quot;BooResolver: No parse information!&quot;)
 			return false
 		_callingClass = GetInnermostClass(cu)
 		if _callingClass == null:
@@ -294,10 +294,11 @@
 			
 			expr = Boo.Lang.Parser.BooParser.ParseExpression(&quot;expression&quot;, expression)
 			return null if expr isa AST.IntegerLiteralExpression
+			Log (&quot;Using an expression type visitor!&quot;)
 			visitor = ExpressionTypeVisitor(Resolver : self)
 			visitor.Visit(expr)
 			retType = visitor.ReturnType
-			//Print (&quot;result&quot;, retType)
+			Log (&quot;result: ${retType}&quot;)
 			if visitor.ReturnClass != null:
 				returnClass = visitor.ReturnClass
 			elif retType != null:
@@ -324,16 +325,16 @@
 		   (_showStatic and not ((member.Modifiers &amp; ModifierEnum.Static) == ModifierEnum.Static))):
 			return false
 		
-//		print(&quot;Testing Accessibility&quot;)
+		Log (&quot;Testing Accessibility&quot;)
 		return IsAccessible(c, member)
 	
 	def IsAccessible(c as IClass, member as IDecoration) as bool:
-//		print(&quot;member.Modifiers = &quot; + member.Modifiers)
+		Log (&quot;member.Modifiers = &quot; + member.Modifiers)
 		if ((member.Modifiers &amp; ModifierEnum.Internal) == ModifierEnum.Internal):
 			return true
 
 		if ((member.Modifiers &amp; ModifierEnum.Public) == ModifierEnum.Public):
-//			print(&quot;IsAccessible&quot;)
+			Log (&quot;IsAccessible&quot;)
 			return true
 
 		if (member.Modifiers &amp; ModifierEnum.Protected) == ModifierEnum.Protected:
@@ -374,47 +375,47 @@
 	
 	def ListMembers(members as ArrayList, curType as IClass, showStatic as bool) as ArrayList:
 		_showStatic = showStatic
-//		print(&quot;LIST MEMBERS!!!&quot;)
-//		print(&quot;_showStatic = &quot; + _showStatic)
-//		print(curType.InnerClasses.Count + &quot; classes&quot;)
-//		print(curType.Properties.Count + &quot; properties&quot;)
-//		print(curType.Methods.Count + &quot; methods&quot;)
-//		print(curType.Events.Count + &quot; events&quot;)
-//		print(curType.Fields.Count + &quot; fields&quot;)
+		Log (&quot;LIST MEMBERS!!!&quot;)
+		Log (&quot;_showStatic = &quot; + _showStatic)
+		Log (curType.InnerClasses.Count + &quot; classes&quot;)
+		Log (curType.Properties.Count + &quot; properties&quot;)
+		Log (curType.Methods.Count + &quot; methods&quot;)
+		Log (curType.Events.Count + &quot; events&quot;)
+		Log (curType.Fields.Count + &quot; fields&quot;)
 		if _showStatic:
 			for c as IClass in curType.InnerClasses:
 				if IsAccessible(curType, c):
 					members.Add(c)
-//					print(&quot;Member added&quot;)
+					Log (&quot;Member added&quot;)
 
 		for p as IProperty in curType.Properties:
 			if (MustBeShowen(curType, p)):
 				members.Add(p)
-//				print(&quot;Member added&quot;)
+				Log (&quot;Member added&quot;)
 
-//		print(&quot;ADDING METHODS!!!&quot;)
+		Log (&quot;ADDING METHODS!!!&quot;)
 		for m as IMethod in curType.Methods:
-//			print(&quot;Method : &quot; + m)
+			Log (&quot;Method : &quot; + m)
 			if (MustBeShowen(curType, m)):
 				members.Add(m)
-//				print(&quot;Member added&quot;)
+				Log (&quot;Member added&quot;)
 
 		for e as IEvent in curType.Events:
 			if (MustBeShowen(curType, e)):
 				members.Add(e)
-//				print(&quot;Member added&quot;)
+				Log (&quot;Member added&quot;)
 
 		for f as IField in curType.Fields:
 			if (MustBeShowen(curType, f)):
 				members.Add(f)
-//				print(&quot;Member added&quot;)
+				Log (&quot;Member added&quot;)
 			else:
 				//// enum fields must be shown here if present
 				if (curType.ClassType == ClassType.Enum):
 					members.Add(f) if (IsAccessible(curType,f))
-//					print(&quot;Member {0} added&quot;, f.FullyQualifiedName)
+					Log (&quot;Member ${f.FullyQualifiedName} added&quot;)
 
-//		print(&quot;ClassType = &quot; + curType.ClassType)
+		Log (&quot;ClassType = &quot; + curType.ClassType)
 		if (curType.ClassType == ClassType.Interface and not _showStatic):
 			for s as string in curType.BaseTypes:
 				baseClass = _parserContext.GetClass (s, true, true)
@@ -423,10 +424,10 @@
 		else:
 			baseClass = BaseClass(curType)
 			if (baseClass != null):
-//				print(&quot;Base Class = &quot; + baseClass.FullyQualifiedName)
+				Log (&quot;Base Class = &quot; + baseClass.FullyQualifiedName)
 				ListMembers(members, baseClass, _showStatic)
 
-//		print(&quot;listing finished&quot;)
+		Log (&quot;listing finished&quot;)
 		return members
 
 	def GetResolvedClass (cls as IClass) as IClass:
@@ -452,3 +453,10 @@
 				return GetInnermostClass(c)
 
 		return GetResolvedClass (curClass)
+
+	private def Log (message):
+		BooParser.Log (self.GetType(), message)
+	
+	private def Error (message):
+		BooParser.Error (self.GetType(), message)
+	

Modified: trunk/MonoDevelop/Extras/BooBinding/Parser/ReturnType.boo
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/Parser/ReturnType.boo	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/Parser/ReturnType.boo	2005-08-10 13:27:32 UTC (rev 2732)
@@ -66,12 +66,12 @@
 			if ar.ElementType isa AST.SimpleTypeReference:
 				super.FullyQualifiedName = cast(AST.SimpleTypeReference, ar.ElementType).Name
 			else:
-				print (&quot;Got unknown TypeReference in Array: ${t}&quot;)
+				Error (&quot;Got unknown TypeReference in Array: ${t}&quot;)
 				super.FullyQualifiedName = &quot;&lt;Error&gt;&quot;
 		else:
 			super.arrayDimensions = array(int, 0)
 			super.FullyQualifiedName = &quot;&lt;Error&gt;&quot;
-			print (&quot;Got unknown TypeReference ${t}&quot;)
+			Error (&quot;Got unknown TypeReference ${t}&quot;)
 	
 	static def CreateReturnType(node as AST.Node) as IReturnType:
 		if node isa AST.Field:
@@ -120,6 +120,9 @@
 	
 	override def ToString():
 		return &quot;[${GetType().Name} Name=${FullyQualifiedName}]&quot;
+	
+	private def Error (message):
+		BooParser.Error (self.GetType (), message)
 
 /////////////////////////////////////
 ///     Namespace Return Type     ///

Modified: trunk/MonoDevelop/Extras/BooBinding/Parser/VariableLookupVisitor.boo
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/Parser/VariableLookupVisitor.boo	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/Parser/VariableLookupVisitor.boo	2005-08-10 13:27:32 UTC (rev 2732)
@@ -62,6 +62,7 @@
 		Finish(node.Initializer)
 	
 	override def OnBinaryExpression(node as BinaryExpression):
+		BooParser.Log (self.GetType (), &quot;Binary expression: '${node}'&quot;)
 		if node.Operator == BinaryOperatorType.Assign and node.Left isa ReferenceExpression:
 			reference as ReferenceExpression = node.Left
 			if reference.Name == _lookFor:

Modified: trunk/MonoDevelop/Extras/BooBinding/Parser/Visitor.boo
===================================================================
--- trunk/MonoDevelop/Extras/BooBinding/Parser/Visitor.boo	2005-08-10 13:22:12 UTC (rev 2731)
+++ trunk/MonoDevelop/Extras/BooBinding/Parser/Visitor.boo	2005-08-10 13:27:32 UTC (rev 2732)
@@ -61,9 +61,7 @@
 		try:
 			Visit(CompileUnit)
 		except e:
-			print e.ToString()
-			//msg as IMessageService = ServiceManager.Services.GetService(typeof(IMessageService))
-			//msg.ShowError(e)
+			Error (e.ToString ())
 	
 	private def GetModifier(m as AST.TypeMember) as ModifierEnum:
 		r = ModifierEnum.None
@@ -122,7 +120,7 @@
 		_cu.Usings.Add(u)
 	
 	override def OnCallableDefinition(node as AST.CallableDefinition):
-		//print &quot;OnCallableDefinition: ${node.FullName}&quot;
+		Log (&quot;OnCallableDefinition: ${node.FullName}&quot;)
 		region = GetRegion(node)
 		modifier = GetModifier(node)
 		c = Class(_cu, ClassType.Delegate, modifier, region)
@@ -148,29 +146,31 @@
 		EnterTypeDefinition(node, ClassType.Enum)
 		return super(node)
 	
+	/*
 	override def EnterModule(node as AST.Module):
 		EnterTypeDefinition(node, ClassType.Class) unless _firstModule
 		_firstModule = false
 		return super(node)
+		*/
 	
 	private def EnterTypeDefinition(node as AST.TypeDefinition, classType as ClassType):
 		try:
-			//print &quot;Enter ${node.GetType().Name} (${node.FullName})&quot;
+			Log (&quot;Enter ${node.GetType().Name} (${node.FullName})&quot;)
 			region = GetClientRegion(node)
 			modifier = GetModifier(node)
 			c = Class(_cu, classType, modifier, region)
 			c.FullyQualifiedName = node.FullName
 			c.Documentation = node.Documentation
 			if _currentClass.Count &gt; 0:
-				cast(Class, _currentClass.Peek()).InnerClasses.Add(c)
+				cast(Class, _currentClass.Peek()).InnerClasses.Add(c) unless c.Name.StartsWith (&quot;___&quot;)
 			else:
-				_cu.Classes.Add(c)
+				_cu.Classes.Add(c) unless c.Name.StartsWith (&quot;___&quot;)
 			if node.BaseTypes != null:
 				for r as AST.SimpleTypeReference in node.BaseTypes:
 					c.BaseTypes.Add(r.Name)
 			_currentClass.Push(c)
 		except ex:
-			print ex.ToString()
+			Error (ex.ToString ())
 			raise
 	
 	override def LeaveClassDefinition(node as AST.ClassDefinition):
@@ -185,13 +185,15 @@
 		LeaveTypeDefinition(node)
 		super(node)
 	
+	/*
 	override def LeaveModule(node as AST.Module):
 		LeaveTypeDefinition(node) unless _currentClass.Count == 0
 		super(node)
+		*/
 	
 	private def LeaveTypeDefinition(node as AST.TypeDefinition):
 		c as Class = _currentClass.Pop()
-		//print &quot;Leave ${node.GetType().Name} ${node.FullName} (Class = ${c.FullyQualifiedName})&quot;
+		Log (&quot;Leave ${node.GetType().Name} ${node.FullName} (Class = ${c.FullyQualifiedName})&quot;)
 		c.UpdateModifier()
 	
 	override def OnMethod(node as AST.Method):
@@ -202,7 +204,7 @@
 			method = GetMethod(node)
 			cast(Class, _currentClass.Peek()).Methods.Add(method)
 		except ex:
-			print ex.ToString()
+			Error (ex.ToString ())
 			raise
 	
 	private def GetMethod(node as AST.Method):
@@ -235,12 +237,12 @@
 			field.SetModifiers(ModifierEnum.Const | ModifierEnum.SpecialName)
 			c.Fields.Add(field)
 		except x:
-			print x
+			Error (x.ToString ())
 			raise
 	
 	override def OnField(node as AST.Field):
 		try:
-			//print &quot;Field ${node.Name}&quot;
+			Log (&quot;Field ${node.Name}&quot;)
 			if node.Name.StartsWith(&quot;___&quot;):
 				return
 
@@ -249,7 +251,7 @@
 			field.Documentation = node.Documentation
 			c.Fields.Add(field)
 		except ex:
-			print ex.ToString()
+			Error (ex.ToString ())
 			raise
 	
 	override def OnProperty(node as AST.Property):
@@ -272,7 +274,7 @@
 			property.Node = node
 			cast(Class, _currentClass.Peek()).Properties.Add(property)
 		except ex:
-			print ex.ToString()
+			Error (ex.ToString ())
 			raise
 	
 	override def OnEvent (node as AST.Event):
@@ -281,9 +283,15 @@
 			ev.Documentation = node.Documentation
 			cast(Class, _currentClass.Peek()).Events.Add(ev)
 		except ex:
-			print ex
+			Error (ex.ToString ())
 			raise
 	
+	private def Log (message):
+		BooParser.Log (self.GetType(), message)
+	
+	private def Error (message):
+		BooParser.Error (self.GetType(), message)
+	
 	/*
 	// TODO: Detect indexer method and add it as Indexer
 	override def Visit(indexerDeclaration as AST.IndexerDeclaration, data as object) as object:


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002330.html">[Monodevelop-patches-list] r2731 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: . Services
</A></li>
	<LI>Next message: <A HREF="002332.html">[Monodevelop-patches-list] r2733 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: .	Services/ProcessService
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2331">[ date ]</a>
              <a href="thread.html#2331">[ thread ]</a>
              <a href="subject.html#2331">[ subject ]</a>
              <a href="author.html#2331">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
