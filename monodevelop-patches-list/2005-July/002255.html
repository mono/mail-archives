<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r2655 - in trunk/MonoDevelop/Core/src:	AddIns/BackendBindings/CSharpBinding	AddIns/BackendBindings/CSharpBinding/templates	MonoDevelop.Base MonoDevelop.Base/Gui/Pads	MonoDevelop.Base/Gui/Pads/ProjectPad	MonoDevelop.Base/Gui/Pads/SolutionPad	MonoDevelop.Base/Services MonoDevelop.Base/Services/File
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2655%20-%20in%20trunk/MonoDevelop/Core/src%3A%0A%09AddIns/BackendBindings/CSharpBinding%0A%09AddIns/BackendBindings/CSharpBinding/templates%0A%09MonoDevelop.Base%20MonoDevelop.Base/Gui/Pads%0A%09MonoDevelop.Base/Gui/Pads/ProjectPad%0A%09MonoDevelop.Base/Gui/Pads/SolutionPad%0A%09MonoDevelop.Base/Services%20MonoDevelop.Base/Services/File&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002254.html">
   <LINK REL="Next"  HREF="002256.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r2655 - in trunk/MonoDevelop/Core/src:	AddIns/BackendBindings/CSharpBinding	AddIns/BackendBindings/CSharpBinding/templates	MonoDevelop.Base MonoDevelop.Base/Gui/Pads	MonoDevelop.Base/Gui/Pads/ProjectPad	MonoDevelop.Base/Gui/Pads/SolutionPad	MonoDevelop.Base/Services MonoDevelop.Base/Services/File</H1>
    <B>John Luke &lt;jluke@cfl.rr.com&gt;</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2655%20-%20in%20trunk/MonoDevelop/Core/src%3A%0A%09AddIns/BackendBindings/CSharpBinding%0A%09AddIns/BackendBindings/CSharpBinding/templates%0A%09MonoDevelop.Base%20MonoDevelop.Base/Gui/Pads%0A%09MonoDevelop.Base/Gui/Pads/ProjectPad%0A%09MonoDevelop.Base/Gui/Pads/SolutionPad%0A%09MonoDevelop.Base/Services%20MonoDevelop.Base/Services/File&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r2655 - in trunk/MonoDevelop/Core/src:	AddIns/BackendBindings/CSharpBinding	AddIns/BackendBindings/CSharpBinding/templates	MonoDevelop.Base MonoDevelop.Base/Gui/Pads	MonoDevelop.Base/Gui/Pads/ProjectPad	MonoDevelop.Base/Gui/Pads/SolutionPad	MonoDevelop.Base/Services MonoDevelop.Base/Services/File">jluke at mono-cvs.ximian.com
       </A><BR>
    <I>Fri Jul 15 20:09:44 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002254.html">[Monodevelop-patches-list] r2654 - in trunk/MonoDevelop: . Core
</A></li>
        <LI>Next message: <A HREF="002256.html">[Monodevelop-patches-list] r2656 - in trunk/MonoDevelop: .	Core/src/AddIns/BackendBindings/CSharpBinding	Core/src/AddIns/DisplayBindings/SourceEditor	Core/src/ICSharpCode.SharpAssembly	Core/src/ICSharpCode.SharpRefactory Core/src/MonoDevelop.Base	Core/src/MonoDevelop.Core Core/src/MonoDevelop.Dock	Core/src/MonoDevelop.Gui.Utils	Core/src/MonoDevelop.Gui.Widgets Core/src/MonoDevelop.Startup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2255">[ date ]</a>
              <a href="thread.html#2255">[ thread ]</a>
              <a href="subject.html#2255">[ subject ]</a>
              <a href="author.html#2255">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jluke
Date: 2005-07-15 20:09:44 -0400 (Fri, 15 Jul 2005)
New Revision: 2655

Modified:
   trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/ChangeLog
   trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/templates/GladeSharp2Project.xpt.xml
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/OpenTaskView.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/ProjectPad/FolderNodeBuilder.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/SolutionPad/TreeViewPad.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/DefaultLoggingService.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/File/RecentOpen.cs
Log:
commit patch from Ben Motmans  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">ben.motmans at gmail.com</A>&gt;


Modified: trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/ChangeLog	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/ChangeLog	2005-07-16 00:09:44 UTC (rev 2655)
@@ -1,3 +1,8 @@
+2005-07-14  Ben Motmans  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">ben.motmans at gmail.com</A>&gt;
+
+	* templates/GladeSharp2Project.xpt.xml:
+	removed duplicate reference to glade-sharp-2.0
+
 2005-07-11  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at novell.com</A>&gt;
 
 	* Project/CSharpCompilerParameters.cs: Implement ICloneable.

Modified: trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/templates/GladeSharp2Project.xpt.xml
===================================================================
--- trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/templates/GladeSharp2Project.xpt.xml	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/AddIns/BackendBindings/CSharpBinding/templates/GladeSharp2Project.xpt.xml	2005-07-16 00:09:44 UTC (rev 2655)
@@ -32,7 +32,6 @@
 				&lt;Reference type=&quot;Gac&quot; refto=&quot;glib-sharp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f&quot; /&gt;
 				&lt;Reference type=&quot;Gac&quot; refto=&quot;glade-sharp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f&quot; /&gt;
 				&lt;Reference type=&quot;Gac&quot; refto=&quot;pango-sharp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f&quot; /&gt;
-				&lt;Reference type=&quot;Gac&quot; refto=&quot;glade-sharp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=35e10195dab3c99f&quot; /&gt;
 			&lt;/References&gt;
 			
 			&lt;Resources&gt;

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog	2005-07-16 00:09:44 UTC (rev 2655)
@@ -1,3 +1,19 @@
+2005-07-14  Ben Motmans  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">ben.motmans at gmail.com</A>&gt;
+
+	* Gui/Pads/ProjectPad/FolderNodeBuilder.cs:
+	#73772, 'remember action' in add files dialog
+
+	* Gui/Pads/OpenTaskView.cs:
+	show warnings after errors + sortable column based on task type
+
+	* Services/File/RecentOpen.cs: emit correct event
+
+	* Gui/Pads/SolutionPad/TreeViewPad.cs:
+	make sure the parent node of the currently edited node is expanded
+
+	* Services/DefaultLoggingService.cs: make sure log4net is always 
+	configured, even if the .config file doesn't exist
+
 2005-07-13  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at novell.com</A>&gt; 
 
 	* Gui/Workbench/Layouts/SdiWorkspaceLayout.cs:

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/OpenTaskView.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/OpenTaskView.cs	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/OpenTaskView.cs	2005-07-16 00:09:44 UTC (rev 2655)
@@ -74,11 +74,17 @@
 				typeof (bool),       // read?
 				typeof (bool),       // marked?
 				typeof (int));       // read? -- use Pango weight
-				
+
+			TreeIterCompareFunc sortFunc = new TreeIterCompareFunc (TaskSortFunc);
+			store.SetSortFunc (COL_TASK, sortFunc);
+			store.DefaultSortFunc = sortFunc;
+			store.SetSortColumnId (COL_TASK, SortType.Ascending);
+
 			view = new Gtk.TreeView (store);
 			view.RulesHint = true;
 			view.PopupMenu += new PopupMenuHandler (OnPopupMenu);
 			view.ButtonPressEvent += new ButtonPressEventHandler (OnButtonPressed);
+			view.HeadersClickable = true;
 			AddColumns ();
 			
 			sw = new Gtk.ScrolledWindow ();
@@ -150,7 +156,10 @@
 			  file = new Gtk.CellRendererText ();
 			
 			TreeViewColumn col;
-			view.AppendColumn (&quot;!&quot;                                        , iconRender   , &quot;pixbuf&quot;, COL_TYPE);
+			col = view.AppendColumn (&quot;!&quot;                                        , iconRender   , &quot;pixbuf&quot;, COL_TYPE);
+			col.Clickable = true;
+			col.Clicked += new EventHandler (OnResortTasks);
+			col.SortIndicator = true;
 			view.AppendColumn (&quot;&quot;                                         , toggleRender , &quot;active&quot;  , COL_MARKED, &quot;activatable&quot;, COL_READ);
 			view.AppendColumn (GettextCatalog.GetString (&quot;Line&quot;)        , line         , &quot;text&quot;    , COL_LINE, &quot;weight&quot;, COL_READ_WEIGHT);
 			col = view.AppendColumn (GettextCatalog.GetString (&quot;Description&quot;) , desc         , &quot;text&quot;    , COL_DESC, &quot;weight&quot;, COL_READ_WEIGHT, &quot;strikethrough&quot;, COL_MARKED);
@@ -289,5 +298,41 @@
 			}
 		}
 
+		private SortType ReverseSortOrder (TreeViewColumn col)     {
+			if (col.SortIndicator)  {
+				if (col.SortOrder == SortType.Ascending)
+					return SortType.Descending;
+				else
+					return SortType.Ascending;
+			} else {
+				return SortType.Ascending;
+			}
+		}
+
+		private void OnResortTasks (object sender, EventArgs args)
+		{
+			TreeViewColumn col = sender as TreeViewColumn;
+			col.SortOrder = ReverseSortOrder (col);
+			col.SortIndicator = true;
+			store.SetSortColumnId (COL_TASK, col.SortOrder);
+		}
+
+		private int TaskSortFunc (TreeModel model, TreeIter iter1, TreeIter iter2)
+		{
+			Task task1 = model.GetValue (iter1, COL_TASK) as Task;
+			Task task2 = model.GetValue (iter2, COL_TASK) as Task;
+
+			if (task1 == null &amp;&amp; task2 == null) return 0;
+			else if (task1 == null) return -1;
+			else if (task2 == null) return 1;
+
+			int compare = ((int)task1.TaskType).CompareTo ((int)task2.TaskType);
+			if (compare == 0)
+				compare = task1.FileName.CompareTo (task2.FileName);
+			if (compare == 0)
+				compare = task1.Line.CompareTo (task2.Line);
+			return compare;
+		}
+
 	}
 }

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/ProjectPad/FolderNodeBuilder.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/ProjectPad/FolderNodeBuilder.cs	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/ProjectPad/FolderNodeBuilder.cs	2005-07-16 00:09:44 UTC (rev 2655)
@@ -191,24 +191,36 @@
 					if (result != (int) ResponseType.Ok)
 						return;
 					
+					int action = -1;
 					foreach (string file in fdiag.Filenames) {
 						if (file.StartsWith (project.BaseDirectory)) {
 							MoveCopyFile (project, CurrentNode, file, true, true);
 						} else {
 							using (MessageDialog md = new MessageDialog (
-																		 (Window) WorkbenchSingleton.Workbench,
-																		 DialogFlags.Modal | DialogFlags.DestroyWithParent,
-																		 MessageType.Question, ButtonsType.None,
-																		 String.Format (GettextCatalog.GetString (&quot;{0} is outside the project directory, what should I do?&quot;), file))) {
+								 (Window) WorkbenchSingleton.Workbench,
+								 DialogFlags.Modal | DialogFlags.DestroyWithParent,
+								 MessageType.Question, ButtonsType.None,
+								 String.Format (GettextCatalog.GetString (&quot;{0} is outside the project directory, what should I do?&quot;), file)))
+							{
+								CheckButton remember = null;
+								if (fdiag.Filenames.Length &gt; 1) {
+									remember = new CheckButton (GettextCatalog.GetString (&quot;Use the same action for all selected files.&quot;));
+									md.VBox.PackStart (remember, false, false, 0);
+								}
 								md.AddButton (Gtk.Stock.Copy, 1);
 								md.AddButton (GettextCatalog.GetString (&quot;_Move&quot;), 2);
 								md.AddButton (Gtk.Stock.Cancel, ResponseType.Cancel);
+								md.VBox.ShowAll ();
 								
-								int ret = md.Run ();
-								md.Hide ();
-								
-								if (ret &lt; 0)
-									return;
+								int ret = -1;
+								if (action &lt; 0) {
+									ret = md.Run ();
+									md.Hide ();
+									if (ret &lt; 0) return;
+									if (remember != null &amp;&amp; remember.Active) action = ret;
+								} else {
+									ret = action;
+								}
 
 								try {
 									MoveCopyFile (project, CurrentNode, file, ret == 2, false);

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/SolutionPad/TreeViewPad.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/SolutionPad/TreeViewPad.cs	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Pads/SolutionPad/TreeViewPad.cs	2005-07-16 00:09:44 UTC (rev 2655)
@@ -583,6 +583,7 @@
 				return;
 			
 			workNode.MoveToIter (iter);
+			workNode.ExpandToNode (); //make sure the parent of the node that is being edited is expanded
 			store.SetValue (iter, TreeViewPad.TextColumn, workNode.NodeName);
 			
 			text_render.Editable = true;

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/DefaultLoggingService.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/DefaultLoggingService.cs	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/DefaultLoggingService.cs	2005-07-16 00:09:44 UTC (rev 2655)
@@ -17,7 +17,9 @@
 		public DefaultLoggingService()
 		{
 			if (File.Exists (Assembly.GetEntryAssembly().Location + &quot;.config&quot;))
-				XmlConfigurator.Configure();
+				XmlConfigurator.Configure ();
+			else
+				BasicConfigurator.Configure ();
 		}
 		
 		public override void InitializeService()

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/File/RecentOpen.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/File/RecentOpen.cs	2005-07-15 21:59:43 UTC (rev 2654)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/File/RecentOpen.cs	2005-07-16 00:09:44 UTC (rev 2655)
@@ -137,7 +137,7 @@
 		void UpdateLastProject ()
 		{
 			lastproject = recentFiles.GetItemsInGroup (&quot;MonoDevelop Projects&quot;);
-			OnRecentFileChange();
+			OnRecentProjectChange();
 		}
 	}
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002254.html">[Monodevelop-patches-list] r2654 - in trunk/MonoDevelop: . Core
</A></li>
	<LI>Next message: <A HREF="002256.html">[Monodevelop-patches-list] r2656 - in trunk/MonoDevelop: .	Core/src/AddIns/BackendBindings/CSharpBinding	Core/src/AddIns/DisplayBindings/SourceEditor	Core/src/ICSharpCode.SharpAssembly	Core/src/ICSharpCode.SharpRefactory Core/src/MonoDevelop.Base	Core/src/MonoDevelop.Core Core/src/MonoDevelop.Dock	Core/src/MonoDevelop.Gui.Utils	Core/src/MonoDevelop.Gui.Widgets Core/src/MonoDevelop.Startup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2255">[ date ]</a>
              <a href="thread.html#2255">[ thread ]</a>
              <a href="subject.html#2255">[ subject ]</a>
              <a href="author.html#2255">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
