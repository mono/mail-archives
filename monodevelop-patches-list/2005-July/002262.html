<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r2662 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: . Gui/Dialogs	Internal/ProgressMonitoring Services/Tasks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2662%20-%20in%0A%09trunk/MonoDevelop/Core/src/MonoDevelop.Base%3A%20.%20Gui/Dialogs%0A%09Internal/ProgressMonitoring%20Services/Tasks&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002261.html">
   <LINK REL="Next"  HREF="002263.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r2662 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: . Gui/Dialogs	Internal/ProgressMonitoring Services/Tasks</H1>
    <B>Lluis Sanchez &lt;lluis@ximian.com&gt;</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r2662%20-%20in%0A%09trunk/MonoDevelop/Core/src/MonoDevelop.Base%3A%20.%20Gui/Dialogs%0A%09Internal/ProgressMonitoring%20Services/Tasks&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r2662 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: . Gui/Dialogs	Internal/ProgressMonitoring Services/Tasks">lluis at mono-cvs.ximian.com
       </A><BR>
    <I>Mon Jul 18 07:09:05 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002261.html">[Monodevelop-patches-list] r2661 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Startup: . Dialogs
</A></li>
        <LI>Next message: <A HREF="002263.html">[Monodevelop-patches-list] r2663 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: . Gui/Pads/ProjectPad
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2262">[ date ]</a>
              <a href="thread.html#2262">[ thread ]</a>
              <a href="subject.html#2262">[ subject ]</a>
              <a href="author.html#2262">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: lluis
Date: 2005-07-18 07:09:05 -0400 (Mon, 18 Jul 2005)
New Revision: 2662

Modified:
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Dialogs/ErrorDialog.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Internal/ProgressMonitoring/BaseProgressMonitor.cs
   trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/Tasks/StatusProgressMonitor.cs
Log:
2005-07-18  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at novell.com</A>&gt; 

	* Internal/ProgressMonitoring/BaseProgressMonitor.cs: Store the
	last reported exception object. Added ErrorException property.
	* Services/Tasks/StatusProgressMonitor.cs: Include the exception when
	showing the error dialog.
	* Gui/Dialogs/ErrorDialog.cs: Don't make it modal. There are some
	issues with that.



Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog	2005-07-18 11:05:38 UTC (rev 2661)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/ChangeLog	2005-07-18 11:09:05 UTC (rev 2662)
@@ -1,3 +1,12 @@
+2005-07-18  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at novell.com</A>&gt; 
+
+	* Internal/ProgressMonitoring/BaseProgressMonitor.cs: Store the
+	last reported exception object. Added ErrorException property.
+	* Services/Tasks/StatusProgressMonitor.cs: Include the exception when
+	showing the error dialog.
+	* Gui/Dialogs/ErrorDialog.cs: Don't make it modal. There are some
+	issues with that.
+
 2005-07-16  John Luke  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">john.luke at gmail.com</A>&gt;
 
 	* Gui/Dialogs/ReferenceDialog/ProjectReferencePanel.cs:

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Dialogs/ErrorDialog.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Dialogs/ErrorDialog.cs	2005-07-18 11:05:38 UTC (rev 2661)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Gui/Dialogs/ErrorDialog.cs	2005-07-18 11:09:05 UTC (rev 2662)
@@ -48,10 +48,10 @@
 			okButton.Clicked += new EventHandler (OnClose);
 		}
 		
-		public int Run ()
+		public void Run ()
 		{
 			dialog.ShowAll ();
-			return dialog.Run ();
+//			dialog.Run ();
 		}
 		
 		void OnClose (object sender, EventArgs args)

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Internal/ProgressMonitoring/BaseProgressMonitor.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Internal/ProgressMonitoring/BaseProgressMonitor.cs	2005-07-18 11:05:38 UTC (rev 2661)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Internal/ProgressMonitoring/BaseProgressMonitor.cs	2005-07-18 11:09:05 UTC (rev 2662)
@@ -59,6 +59,7 @@
 		StringCollection errorsMessages = new StringCollection ();
 		StringCollection successMessages = new StringCollection ();
 		StringCollection warningMessages = new StringCollection ();
+		Exception errorException;
 		
 		public BaseProgressMonitor ()
 		{
@@ -109,11 +110,16 @@
 		{
 			if (message == null &amp;&amp; ex != null)
 				message = ex.Message;
-			else if (message != null &amp;&amp; ex != null)
-				message += &quot;. &quot; + ex.Message;
+			else if (message != null &amp;&amp; ex != null) {
+				if (!message.EndsWith (&quot;.&quot;)) message += &quot;.&quot;;
+				message += &quot; &quot; + ex.Message;
+			}
+			
 			errorsMessages.Add (message);
-			if (ex != null)
+			if (ex != null) {
 				Runtime.LoggingService.Info (ex);
+				errorException = ex;
+			}
 		}
 		
 		[FreeDispatch]
@@ -208,6 +214,10 @@
 			}
 		}		
 		
+		protected Exception ErrorException {
+			get { return errorException; }
+		}
+		
 		protected StringCollection Errors {
 			get { return errorsMessages; }
 		}

Modified: trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/Tasks/StatusProgressMonitor.cs
===================================================================
--- trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/Tasks/StatusProgressMonitor.cs	2005-07-18 11:05:38 UTC (rev 2661)
+++ trunk/MonoDevelop/Core/src/MonoDevelop.Base/Services/Tasks/StatusProgressMonitor.cs	2005-07-18 11:09:05 UTC (rev 2662)
@@ -64,7 +64,7 @@
 					string s = &quot;&quot;;
 					foreach (string m in Errors)
 						s += m + &quot;\n&quot;;
-					Runtime.MessageService.ShowError (s);
+					Runtime.MessageService.ShowError (ErrorException, s);
 				}
 				Gtk.Image img = Runtime.Gui.Resources.GetImage (Stock.Error, Gtk.IconSize.Menu);
 				Runtime.Gui.StatusBar.SetMessage (img, Errors [Errors.Count - 1]);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002261.html">[Monodevelop-patches-list] r2661 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Startup: . Dialogs
</A></li>
	<LI>Next message: <A HREF="002263.html">[Monodevelop-patches-list] r2663 - in	trunk/MonoDevelop/Core/src/MonoDevelop.Base: . Gui/Pads/ProjectPad
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2262">[ date ]</a>
              <a href="thread.html#2262">[ thread ]</a>
              <a href="subject.html#2262">[ subject ]</a>
              <a href="author.html#2262">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
