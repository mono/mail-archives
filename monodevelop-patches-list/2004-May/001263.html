<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1656 - in trunk/MonoDevelop: . src/AddIns/BackendBindings/CSharpBinding src/Main/Base src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode src/Main/Base/Internal/Project/Combine
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1656%20-%20in%20trunk/MonoDevelop%3A%20.%20src/AddIns/BackendBindings/CSharpBinding%20src/Main/Base%20src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode%20src/Main/Base/Internal/Project/Combine&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001262.html">
   <LINK REL="Next"  HREF="001264.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1656 - in trunk/MonoDevelop: . src/AddIns/BackendBindings/CSharpBinding src/Main/Base src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode src/Main/Base/Internal/Project/Combine</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1656%20-%20in%20trunk/MonoDevelop%3A%20.%20src/AddIns/BackendBindings/CSharpBinding%20src/Main/Base%20src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode%20src/Main/Base/Internal/Project/Combine&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1656 - in trunk/MonoDevelop: . src/AddIns/BackendBindings/CSharpBinding src/Main/Base src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode src/Main/Base/Internal/Project/Combine">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Thu May 27 14:48:25 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001262.html">[Monodevelop-patches-list] r1655 - in trunk/MonoDevelop/src: . AddIns/BackendBindings/CSharpBinding AddIns/BackendBindings/ILAsmBinding AddIns/BackendBindings/JavaBinding AddIns/BackendBindings/NemerleBinding AddIns/DisplayBindings/SourceEditor AddIns/Misc/StartPage AddIns/prj2make-sharp-lib Libraries/MonoDevelop.Core Libraries/MonoDevelop.Gui.Utils Libraries/MonoDevelop.Gui.Widgets Libraries/SharpAssembly Libraries/SharpRefactory Main/Base Main/StartUp
</A></li>
        <LI>Next message: <A HREF="001264.html">[Monodevelop-patches-list] r1657 - in trunk/MonoDevelop/src/Main/Base: . Services/Project
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1263">[ date ]</a>
              <a href="thread.html#1263">[ thread ]</a>
              <a href="subject.html#1263">[ subject ]</a>
              <a href="author.html#1263">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-05-27 14:48:25 -0400 (Thu, 27 May 2004)
New Revision: 1656

Modified:
   trunk/MonoDevelop/ChangeLog
   trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs
   trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/ChangeLog
   trunk/MonoDevelop/src/Main/Base/ChangeLog
   trunk/MonoDevelop/src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode/CombineBrowserNode.cs
   trunk/MonoDevelop/src/Main/Base/Internal/Project/Combine/Combine.cs
Log:
missed changelog from before, fixup makefile spacing issues, and check that solutions are not named with invalid characters. This list may need to get bigger, or potentially just allow [a-zA-z0-9], not sure.


Modified: trunk/MonoDevelop/ChangeLog
===================================================================
--- trunk/MonoDevelop/ChangeLog	2004-05-27 17:14:26 UTC (rev 1655)
+++ trunk/MonoDevelop/ChangeLog	2004-05-27 18:48:25 UTC (rev 1656)
@@ -1,3 +1,11 @@
+2004-05-27  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt;
+
+	* *: Lots of new files, usable for editing MD within MD.
+	Building is not supported, either via the internal build system or
+	the generate makefiles, both will most likely break horribly.
+	These project files are first draft, and are most likely missing
+	references, and other needed info.
+
 2004-05-27  Martin Willemoes Hansen  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">mwh at sysrq.dk</A>&gt;
 
 	* po/da_DK.po: Additional translations and corrections

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs	2004-05-27 17:14:26 UTC (rev 1655)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/CSharpBindingCompilerManager.cs	2004-05-27 18:48:25 UTC (rev 1656)
@@ -279,7 +279,7 @@
 
 		public void GenerateMakefile (IProject project, Combine parentCombine)
 		{
-			StreamWriter stream = new StreamWriter (Path.Combine (project.BaseDirectory, &quot;Makefile.&quot; + project.Name));
+			StreamWriter stream = new StreamWriter (Path.Combine (project.BaseDirectory, &quot;Makefile.&quot; + project.Name.Replace (&quot; &quot;, &quot;&quot;)));
 
 			CSharpProject p = (CSharpProject)project;
 			CSharpCompilerParameters compilerparameters = (CSharpCompilerParameters)p.ActiveConfiguration;
@@ -363,7 +363,7 @@
 			stream.WriteLine ();
 			stream.WriteLine (&quot;SOURCES = \\&quot;);
 			for (int i = 0; i &lt; compile_files.Count; i++) {
-				stream.Write (compile_files[i]);
+				stream.Write (((string)compile_files[i]).Replace (&quot; &quot;, &quot;\\ &quot;));
 				if (i != compile_files.Count - 1)
 					stream.WriteLine (&quot; \\&quot;);
 				else
@@ -374,7 +374,7 @@
 			if (resources.Count &gt; 0) {
 				stream.WriteLine (&quot;RESOURCES = \\&quot;);
 				for (int i = 0; i &lt; resources.Count; i++) {
-					stream.Write (resources[i]);
+					stream.Write (((string)resources[i]).Replace (&quot; &quot;, &quot;\\ &quot;));
 					if (i != resources.Count - 1)
 						stream.WriteLine (&quot; \\&quot;);
 					else

Modified: trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/ChangeLog
===================================================================
--- trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/ChangeLog	2004-05-27 17:14:26 UTC (rev 1655)
+++ trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding/ChangeLog	2004-05-27 18:48:25 UTC (rev 1656)
@@ -1,3 +1,8 @@
+2004-05-27  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt;
+
+	* CSharpBindingCompilerManager.cs: fix up projects with space in
+	their name.
+
 2004-05-26  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt;
 
 	* CSharpBindingCompilerManager.cs: more makefile magic.

Modified: trunk/MonoDevelop/src/Main/Base/ChangeLog
===================================================================
--- trunk/MonoDevelop/src/Main/Base/ChangeLog	2004-05-27 17:14:26 UTC (rev 1655)
+++ trunk/MonoDevelop/src/Main/Base/ChangeLog	2004-05-27 18:48:25 UTC (rev 1656)
@@ -1,5 +1,12 @@
 2004-05-27  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt;
 
+	* Internal/Project/Project/Combine.cs: properly handle spaces in the
+	solution and project names.
+	* Gui/Pads/ProjectBrowser/BrowserNode/CombineBrowserNode.cs: check
+	for invalid characters.
+
+2004-05-27  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt;
+
 	* Internal/Project/Project/AbstractProject.cs: Properly ignore
 	.svn and CVS directories.
 	* Gui/Pads/ClassScout/ClassScout.cs: Properly work around potential

Modified: trunk/MonoDevelop/src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode/CombineBrowserNode.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode/CombineBrowserNode.cs	2004-05-27 17:14:26 UTC (rev 1655)
+++ trunk/MonoDevelop/src/Main/Base/Gui/Pads/ProjectBrowser/BrowserNode/CombineBrowserNode.cs	2004-05-27 18:48:25 UTC (rev 1656)
@@ -55,12 +55,21 @@
 		
 		public override void AfterLabelEdit(string newName)
 		{
-			if (newName != null &amp;&amp; newName.Trim().Length &gt; 0) {
+			if (newName != null &amp;&amp; newName.Trim().Length &gt; 0 &amp;&amp; ContainsNoInvalidChars (newName)) {
 				combine.Name = newName;
 			}
 			UpdateCombineName (null, EventArgs.Empty);
 		}
 		
+		bool ContainsNoInvalidChars (string name)
+		{
+			if (name.IndexOfAny (new char [] { '\'', '(', ')', '&quot;', '{', '}', '|' } ) != -1) {
+				((MessageService)ServiceManager.Services.GetService (typeof (MessageService))).ShowError (String.Format (GettextCatalog.GetString (&quot;Solution name may not contain any of the following characters: {0}&quot;), &quot;', (, ), \&quot;, {, }, |&quot;));
+				return false;
+			}
+			return true;
+		}
+		
 		public override void UpdateNaming()
 		{
 			UpdateCombineName(this, EventArgs.Empty);

Modified: trunk/MonoDevelop/src/Main/Base/Internal/Project/Combine/Combine.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Internal/Project/Combine/Combine.cs	2004-05-27 17:14:26 UTC (rev 1655)
+++ trunk/MonoDevelop/src/Main/Base/Internal/Project/Combine/Combine.cs	2004-05-27 18:48:25 UTC (rev 1656)
@@ -18,7 +18,6 @@
 using Mono.Posix;
 using FileMode = Mono.Posix.FileMode;
 
-
 using MonoDevelop.Core.Services;
 
 using MonoDevelop.Services;
@@ -643,13 +642,13 @@
 			buildstream.WriteLine (&quot;# This file is autogenerated by MonoDevelop&quot;);
 			buildstream.WriteLine (&quot;# Do not edit it.&quot;);
 			buildstream.WriteLine ();
-			buildstream.WriteLine (&quot;make -f Makefile.solution.{0} \&quot;$@\&quot;&quot;, Name);
+			buildstream.WriteLine (&quot;make -f Makefile.solution.{0} \&quot;$@\&quot;&quot;, Name.Replace (&quot; &quot;,&quot;&quot;));
 			buildstream.Flush ();
 			buildstream.Close ();
 			
 			Syscall.chmod (Path.Combine (path, &quot;make.sh&quot;), FileMode.S_IRUSR | FileMode.S_IWUSR | FileMode.S_IXUSR | FileMode.S_IRGRP | FileMode.S_IWGRP | FileMode.S_IROTH);
 
-			StreamWriter stream = new StreamWriter (Path.Combine (path, &quot;Makefile.solution.&quot; + Name));
+			StreamWriter stream = new StreamWriter (Path.Combine (path, &quot;Makefile.solution.&quot; + Name.Replace (&quot; &quot;, &quot;&quot;)));
 			stream.WriteLine (&quot;# This file is autogenerated by MonoDevelop&quot;);
 			stream.WriteLine (&quot;# Do not edit it.&quot;);
 			stream.WriteLine ();
@@ -658,7 +657,7 @@
 			stream.WriteLine ();
 			stream.Write (&quot;all: depcheck __init &quot;);
 			foreach (IProject proj in projects) {
-				stream.Write (&quot;Makefile.{0}.all &quot;, proj.Name);
+				stream.Write (&quot;Makefile.{0}.all &quot;, proj.Name.Replace (&quot; &quot;,&quot;&quot;));
 			}
 			stream.WriteLine ();
 			stream.WriteLine ();
@@ -669,14 +668,14 @@
 
 			stream.Write (&quot;clean: &quot;);
 			foreach (IProject proj in projects) {
-				stream.Write (&quot;Makefile.{0}.clean &quot;, proj.Name);
+				stream.Write (&quot;Makefile.{0}.clean &quot;, proj.Name.Replace (&quot; &quot;, &quot;&quot;));
 			}
 			stream.WriteLine ();
 			stream.WriteLine ();
 
 			stream.Write (&quot;depcheck: &quot;);
 			foreach (IProject proj in projects) {
-				stream.Write (&quot;Makefile.{0}.depcheck &quot;, proj.Name);
+				stream.Write (&quot;Makefile.{0}.depcheck &quot;, proj.Name.Replace (&quot; &quot;, &quot;&quot;));
 			}
 			stream.WriteLine ();
 			stream.WriteLine ();
@@ -694,7 +693,7 @@
 
 			foreach (IProject proj in projects) {
 				string relativeLocation = fileUtilityService.AbsoluteToRelativePath (path, proj.BaseDirectory);
-				stream.WriteLine (&quot;Makefile.{0}.%:&quot;, proj.Name);
+				stream.WriteLine (&quot;Makefile.{0}.%:&quot;, proj.Name.Replace (&quot; &quot;, &quot;&quot;));
 				stream.WriteLine (&quot;\<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">t at cd</A> {0} &amp;&amp; $(MAKE) -f $(subst .$*,,$@) $*&quot;, relativeLocation);
 				stream.WriteLine ();
 			}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001262.html">[Monodevelop-patches-list] r1655 - in trunk/MonoDevelop/src: . AddIns/BackendBindings/CSharpBinding AddIns/BackendBindings/ILAsmBinding AddIns/BackendBindings/JavaBinding AddIns/BackendBindings/NemerleBinding AddIns/DisplayBindings/SourceEditor AddIns/Misc/StartPage AddIns/prj2make-sharp-lib Libraries/MonoDevelop.Core Libraries/MonoDevelop.Gui.Utils Libraries/MonoDevelop.Gui.Widgets Libraries/SharpAssembly Libraries/SharpRefactory Main/Base Main/StartUp
</A></li>
	<LI>Next message: <A HREF="001264.html">[Monodevelop-patches-list] r1657 - in trunk/MonoDevelop/src/Main/Base: . Services/Project
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1263">[ date ]</a>
              <a href="thread.html#1263">[ thread ]</a>
              <a href="subject.html#1263">[ subject ]</a>
              <a href="author.html#1263">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
