<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Monodevelop-patches-list] r1669 - in trunk/MonoDevelop: build/data/options help src/Main/Base src/Main/Base/Commands src/Main/Base/Services/ParserService
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1669%20-%20in%20trunk/MonoDevelop%3A%20build/data/options%20help%20src/Main/Base%20src/Main/Base/Commands%20src/Main/Base/Services/ParserService&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001275.html">
   <LINK REL="Next"  HREF="001277.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Monodevelop-patches-list] r1669 - in trunk/MonoDevelop: build/data/options help src/Main/Base src/Main/Base/Commands src/Main/Base/Services/ParserService</H1>
    <B>commit-watcher at mono-cvs.ximian.com</B> 
    <A HREF="mailto:monodevelop-patches-list%40lists.ximian.com?Subject=%5BMonodevelop-patches-list%5D%20r1669%20-%20in%20trunk/MonoDevelop%3A%20build/data/options%20help%20src/Main/Base%20src/Main/Base/Commands%20src/Main/Base/Services/ParserService&In-Reply-To="
       TITLE="[Monodevelop-patches-list] r1669 - in trunk/MonoDevelop: build/data/options help src/Main/Base src/Main/Base/Commands src/Main/Base/Services/ParserService">commit-watcher at mono-cvs.ximian.com
       </A><BR>
    <I>Sun May 30 15:56:39 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001275.html">[Monodevelop-patches-list] r1668 - in trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding: . Parser
</A></li>
        <LI>Next message: <A HREF="001277.html">[Monodevelop-patches-list] r1670 - trunk/MonoDevelop/help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1276">[ date ]</a>
              <a href="thread.html#1276">[ thread ]</a>
              <a href="subject.html#1276">[ subject ]</a>
              <a href="author.html#1276">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tberman
Date: 2004-05-30 15:56:39 -0400 (Sun, 30 May 2004)
New Revision: 1669

Modified:
   trunk/MonoDevelop/build/data/options/MonoDevelopProperties.xml
   trunk/MonoDevelop/help/
   trunk/MonoDevelop/src/Main/Base/ChangeLog
   trunk/MonoDevelop/src/Main/Base/Commands/AutostartCommands.cs
   trunk/MonoDevelop/src/Main/Base/Services/ParserService/DefaultParserService.cs
Log:
fix a bug where an install without a valid settings file would try and write code completion dbs into /, remove some dead code, svn:ignore some files.


Modified: trunk/MonoDevelop/build/data/options/MonoDevelopProperties.xml
===================================================================
--- trunk/MonoDevelop/build/data/options/MonoDevelopProperties.xml	2004-05-30 18:20:09 UTC (rev 1668)
+++ trunk/MonoDevelop/build/data/options/MonoDevelopProperties.xml	2004-05-30 19:56:39 UTC (rev 1669)
@@ -51,7 +51,7 @@
       &lt;/RECENT&gt;
     &lt;/XmlConvertableProperty&gt;
     &lt;XmlConvertableProperty key=&quot;SharpDevelop.Gui.MainWindow.WindowState&quot;&gt;
-      &lt;WINDOWSTATE FULLSCREEN=&quot;False&quot; STATE=&quot;Maximized&quot;&gt;523|21|640|480&lt;/WINDOWSTATE&gt;
+      &lt;WINDOWSTATE FULLSCREEN=&quot;False&quot; STATE=&quot;Maximized&quot;&gt;0|0|640|480&lt;/WINDOWSTATE&gt;
     &lt;/XmlConvertableProperty&gt;
     &lt;Property key=&quot;SharpDevelop.Gui.HelpFileGenerator.HtmlHelpCompilerFilename&quot; value=&quot;C:\Program Files\HTML Help Workshop\hhc.exe&quot; /&gt;
     &lt;XmlConvertableProperty key=&quot;SharpDevelop.Workbench.WorkbenchMemento&quot;&gt;


Property changes on: trunk/MonoDevelop/help
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in
omf_timestamp
monodevelop.omf.out


Modified: trunk/MonoDevelop/src/Main/Base/ChangeLog
===================================================================
--- trunk/MonoDevelop/src/Main/Base/ChangeLog	2004-05-30 18:20:09 UTC (rev 1668)
+++ trunk/MonoDevelop/src/Main/Base/ChangeLog	2004-05-30 19:56:39 UTC (rev 1669)
@@ -1,3 +1,9 @@
+2004-05-30  Todd Berman  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">tberman at sevenl.net</A>&gt;
+
+	* Commands/AutostartCommands: Remove some dead code.
+	* Services/ParserService/DefaultParserService.cs: Properly setup
+	the pathing so it works without an existing setup.
+
 2004-05-30  Lluis Sanchez Gual  &lt;<A HREF="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">lluis at ximian.com</A>&gt;
 
 	* Services/ParserService/DefaultParserService.cs: Don't use the &quot;Gac:&quot;

Modified: trunk/MonoDevelop/src/Main/Base/Commands/AutostartCommands.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Commands/AutostartCommands.cs	2004-05-30 18:20:09 UTC (rev 1668)
+++ trunk/MonoDevelop/src/Main/Base/Commands/AutostartCommands.cs	2004-05-30 19:56:39 UTC (rev 1669)
@@ -38,7 +38,6 @@
 			DefaultWorkbench w = new DefaultWorkbench();
 			WorkbenchSingleton.Workbench = w;
 			w.InitializeWorkspace();
-			PropertyService propertyService = (PropertyService)ServiceManager.Services.GetService(typeof(PropertyService));
 			w.UpdateViews(null, null);
 			WorkbenchSingleton.CreateWorkspace();
 			((Gtk.Window)w).Visible = false;
@@ -145,8 +144,6 @@
 				return;
 			}
 		
-			ReflectionClass reflectionClass = new ReflectionClass(typeof(object));
-			
 			// register string tag provider (TODO: move to add-in tree :)
 			StringParserService stringParserService = (StringParserService)ServiceManager.Services.GetService(typeof(StringParserService));
 			stringParserService.RegisterStringTagProvider(new MonoDevelop.Commands.SharpDevelopStringTagProvider());

Modified: trunk/MonoDevelop/src/Main/Base/Services/ParserService/DefaultParserService.cs
===================================================================
--- trunk/MonoDevelop/src/Main/Base/Services/ParserService/DefaultParserService.cs	2004-05-30 18:20:09 UTC (rev 1668)
+++ trunk/MonoDevelop/src/Main/Base/Services/ParserService/DefaultParserService.cs	2004-05-30 19:56:39 UTC (rev 1669)
@@ -226,12 +226,17 @@
 		void SetDefaultCompletionFileLocation()
 		{
 			PropertyService propertyService = (PropertyService)ServiceManager.Services.GetService(typeof(PropertyService));
-			string path = (propertyService.GetProperty(&quot;SharpDevelop.CodeCompletion.DataDirectory&quot;, String.Empty).ToString());
-			FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService(typeof(FileUtilityService));
+			FileUtilityService fileUtilityService = (FileUtilityService)ServiceManager.Services.GetService (typeof (FileUtilityService));
+			string path = propertyService.GetProperty(&quot;SharpDevelop.CodeCompletion.DataDirectory&quot;, String.Empty).ToString();
+			if (path == String.Empty) {
+                        	path = Path.Combine (fileUtilityService.GetDirectoryNameWithSeparator(propertyService.ConfigDirectory), &quot;CodeCompletionData&quot;);
+				propertyService.SetProperty (&quot;SharpDevelop.CodeCompletion.DataDirectory&quot;, path);
+				propertyService.SaveProperties ();
+			}
+                        if (!Directory.Exists (path))
+                                Directory.CreateDirectory (path);
+
 			codeCompletionPath = fileUtilityService.GetDirectoryNameWithSeparator(path);
-			if (!Directory.Exists (codeCompletionPath)) {
-				Directory.CreateDirectory (codeCompletionPath);
-			}
 		}
 
 		public override void InitializeService()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001275.html">[Monodevelop-patches-list] r1668 - in trunk/MonoDevelop/src/AddIns/BackendBindings/CSharpBinding: . Parser
</A></li>
	<LI>Next message: <A HREF="001277.html">[Monodevelop-patches-list] r1670 - trunk/MonoDevelop/help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1276">[ date ]</a>
              <a href="thread.html#1276">[ thread ]</a>
              <a href="subject.html#1276">[ subject ]</a>
              <a href="author.html#1276">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/monodevelop-patches-list">More information about the Monodevelop-patches-list
mailing list</a><br>
</body></html>
