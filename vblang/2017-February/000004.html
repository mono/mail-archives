<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [vblang] Auto-Implemented Properties and Field Attributes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:vblang%40lists.dot.net?Subject=Re%3A%20%5Bvblang%5D%20Auto-Implemented%20Properties%20and%20Field%20Attributes&In-Reply-To=%3CCAGu8fCqTHGyUfDC0SVP3Ye492KqgL5q1EAscOFf_5ucihPLdLA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000003.html">
   <LINK REL="Next"  HREF="000005.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[vblang] Auto-Implemented Properties and Field Attributes</H1>
    <B>Justin Spindler</B> 
    <A HREF="mailto:vblang%40lists.dot.net?Subject=Re%3A%20%5Bvblang%5D%20Auto-Implemented%20Properties%20and%20Field%20Attributes&In-Reply-To=%3CCAGu8fCqTHGyUfDC0SVP3Ye492KqgL5q1EAscOFf_5ucihPLdLA%40mail.gmail.com%3E"
       TITLE="[vblang] Auto-Implemented Properties and Field Attributes">justin.spindler at gmail.com
       </A><BR>
    <I>Sun Feb  5 19:02:36 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000003.html">[vblang] Auto-Implemented Properties and Field Attributes
</A></li>
        <LI>Next message (by thread): <A HREF="000005.html">[vblang] New venue for VB design discussion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4">[ date ]</a>
              <a href="thread.html#4">[ thread ]</a>
              <a href="subject.html#4">[ subject ]</a>
              <a href="author.html#4">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If a Field contextual keyword were added and syntax to support explicit
field application of attributes then I'd probably forego the automatic
application of field-targeting attributes on the backing field for
auto-implemented properties.  It'd be convenient, but it might not be clear
to developers reading the code.

On Sat, Feb 4, 2017, 3:57 PM Anthony D. Green &lt;<A HREF="http://lists.dot.net/mailman/listinfo/vblang">adgreen at microsoft.com</A>&gt; wrote:

&gt;<i> A contextual keyword would work fine. And it would avoid the breaking
</I>&gt;<i> changes you described.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Sent from my Windows 10 phone
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From: *Justin Spindler &lt;<A HREF="http://lists.dot.net/mailman/listinfo/vblang">justin.spindler at gmail.com</A>&gt;
</I>&gt;<i> *Sent: *Saturday, February 4, 2017 12:45 PM
</I>&gt;<i> *To: *Anthony D. Green &lt;<A HREF="http://lists.dot.net/mailman/listinfo/vblang">adgreen at microsoft.com</A>&gt;; <A HREF="http://lists.dot.net/mailman/listinfo/vblang">vblang at lists.dot.net</A>
</I>&gt;<i> *Subject: *Re: [vblang] Auto-Implemented Properties and Field Attributes
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'd leave the behavior of those attributes alone since you couldn't guess
</I>&gt;<i> the developer's intention and applying the attribute to both the property
</I>&gt;<i> and the backing field could introduce breaking changes to existing code.
</I>&gt;<i>
</I>&gt;<i> As for allowing attributes to be explicitly applied to a field, I think
</I>&gt;<i> that this would be a good idea.  It requires adding a Field contextual
</I>&gt;<i> keyword but the scope would be so limited that I can't see that creating
</I>&gt;<i> any syntax ambiguities.  Since VB.NET
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C7fd35bd8d9be4b06aaec08d44d3eb003%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218379017446939&amp;sdata=3e3sI69bo9nDVMBvNz07udi30HNiNLqGw%2BHTGTwGgtQ%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C7fd35bd8d9be4b06aaec08d44d3eb003%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218379017446939&amp;sdata=3e3sI69bo9nDVMBvNz07udi30HNiNLqGw%2BHTGTwGgtQ%3D&amp;reserved=0</A>&gt;
</I>&gt;<i> already allows assembly targeting the syntax for this is already
</I>&gt;<i> established.
</I>&gt;<i>
</I>&gt;<i> On Sat, Feb 4, 2017, 2:19 PM Anthony D. Green &lt;<A HREF="http://lists.dot.net/mailman/listinfo/vblang">adgreen at microsoft.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> Like the idea but I have concerns around attributes that could be applied
</I>&gt;<i> to both, E.g. DataMemberAttribute. We can’t apply the attribute to both in
</I>&gt;<i> that case or the data contract would have duplicate data. How are you
</I>&gt;<i> thinking we could resolve that?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> What do you think of adding a ‘Field’ attribute target as as an alternate
</I>&gt;<i> proposal?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Sent from my Windows 10 phone
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From: *Justin Spindler &lt;<A HREF="http://lists.dot.net/mailman/listinfo/vblang">justin.spindler at gmail.com</A>&gt;
</I>&gt;<i> *Sent: *Saturday, February 4, 2017 9:32 AM
</I>&gt;<i> *To: *<A HREF="http://lists.dot.net/mailman/listinfo/vblang">vblang at lists.dot.net</A>
</I>&gt;<i> *Subject: *[vblang] Auto-Implemented Properties and Field Attributes
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Okay, I'll break the silence.
</I>&gt;<i>
</I>&gt;<i> This proposal is in the same vein as
</I>&gt;<i> <A HREF="https://github.com/dotnet/roslyn/issues/7004">https://github.com/dotnet/roslyn/issues/7004</A>
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F7004&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=DsV9PmbT%2FlUHWJoqMUuqwo6cPp0sGNBTZZmDbrh5xR4%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F7004&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=DsV9PmbT%2FlUHWJoqMUuqwo6cPp0sGNBTZZmDbrh5xR4%3D&amp;reserved=0</A>&gt;.
</I>&gt;<i> Currently VB.NET
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt;
</I>&gt;<i> issues a compiler error if you attempt to apply a field-targeting attribute
</I>&gt;<i> on an auto-implemented property.  I propose that VB.NET
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt;
</I>&gt;<i> support applying these attributes but that the compiler apply them to the
</I>&gt;<i> generated backing field.
</I>&gt;<i>
</I>&gt;<i> The following VB.NET
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt;
</I>&gt;<i> code:
</I>&gt;<i>
</I>&gt;<i> &lt;Serializable&gt;Public Class Foo
</I>&gt;<i>     &lt;NonSerialized&gt;
</I>&gt;<i>     Public Property MySecret As StringEnd Class
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Would be equivalent to the following VB.NET
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt;
</I>&gt;<i> code:
</I>&gt;<i>
</I>&gt;<i> &lt;Serialized&gt;Public Class Foo
</I>&gt;<i>     &lt;NonSerialized&gt;
</I>&gt;<i>     Private _MySecret_BackingField As String
</I>&gt;<i>
</I>&gt;<i>     Public Property MySecret As String        Get
</I>&gt;<i>             Return _MySecret_BackingField
</I>&gt;<i>         End Get        Set(value As String)
</I>&gt;<i>             _MySecret_BackingField = value
</I>&gt;<i>         End Set    End PropertyEnd Class
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This actually brings support for these attributes in line with how VB.NET
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt;
</I>&gt;<i> treats events:
</I>&gt;<i>
</I>&gt;<i> &lt;Serializable&gt;Public Class Foo
</I>&gt;<i>     &lt;NonSerialized&gt;
</I>&gt;<i>     Public Event MyEvent1 As EventHandler
</I>&gt;<i>     &lt;NonSerialized&gt;
</I>&gt;<i>     Public Event MyEvent2(ByVal sender As Object, ByVal e As EventArgs)End Class
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> In this case the VB.NET
</I>&gt;<i> &lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt;
</I>&gt;<i> compiler automatically moves the attribute to the generated backing field
</I>&gt;<i> for the delegate.
</I>&gt;<i>
</I>&gt;<i> It's sad, I used the markdown editor in Github to write the above code
</I>&gt;<i> snippets.  The lack of linking also sucks.  I guess I could reply from the
</I>&gt;<i> email I sent to the C# mailing list but that would probably royally mess up
</I>&gt;<i> threading.
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/vblang/attachments/20170205/e23f5fec/attachment.html">http://lists.dot.net/pipermail/vblang/attachments/20170205/e23f5fec/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000003.html">[vblang] Auto-Implemented Properties and Field Attributes
</A></li>
	<LI>Next message (by thread): <A HREF="000005.html">[vblang] New venue for VB design discussion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4">[ date ]</a>
              <a href="thread.html#4">[ thread ]</a>
              <a href="subject.html#4">[ subject ]</a>
              <a href="author.html#4">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/vblang">More information about the vblang
mailing list</a><br>
</body></html>
