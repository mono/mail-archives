<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [vblang] Auto-Implemented Properties and Field Attributes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:vblang%40lists.dot.net?Subject=Re%3A%20%5Bvblang%5D%20Auto-Implemented%20Properties%20and%20Field%20Attributes&In-Reply-To=%3CBN6PR03MB2979B5BC885C3D7024A083A8BF4E0%40BN6PR03MB2979.namprd03.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000000.html">
   <LINK REL="Next"  HREF="000002.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[vblang] Auto-Implemented Properties and Field Attributes</H1>
    <B>Anthony D. Green</B> 
    <A HREF="mailto:vblang%40lists.dot.net?Subject=Re%3A%20%5Bvblang%5D%20Auto-Implemented%20Properties%20and%20Field%20Attributes&In-Reply-To=%3CBN6PR03MB2979B5BC885C3D7024A083A8BF4E0%40BN6PR03MB2979.namprd03.prod.outlook.com%3E"
       TITLE="[vblang] Auto-Implemented Properties and Field Attributes">adgreen at microsoft.com
       </A><BR>
    <I>Sat Feb  4 19:19:41 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000000.html">[vblang] Auto-Implemented Properties and Field Attributes
</A></li>
        <LI>Next message (by thread): <A HREF="000002.html">[vblang] Auto-Implemented Properties and Field Attributes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1">[ date ]</a>
              <a href="thread.html#1">[ thread ]</a>
              <a href="subject.html#1">[ subject ]</a>
              <a href="author.html#1">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Like the idea but I have concerns around attributes that could be applied to both, E.g. DataMemberAttribute. We can’t apply the attribute to both in that case or the data contract would have duplicate data. How are you thinking we could resolve that?

What do you think of adding a ‘Field’ attribute target as as an alternate proposal?

Sent from my Windows 10 phone

From: Justin Spindler&lt;mailto:<A HREF="http://lists.dot.net/mailman/listinfo/vblang">justin.spindler at gmail.com</A>&gt;
Sent: Saturday, February 4, 2017 9:32 AM
To: <A HREF="http://lists.dot.net/mailman/listinfo/vblang">vblang at lists.dot.net</A>&lt;mailto:<A HREF="http://lists.dot.net/mailman/listinfo/vblang">vblang at lists.dot.net</A>&gt;
Subject: [vblang] Auto-Implemented Properties and Field Attributes

Okay, I'll break the silence.

This proposal is in the same vein as <A HREF="https://github.com/dotnet/roslyn/issues/7004&lt;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F7004&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=DsV9PmbT%2FlUHWJoqMUuqwo6cPp0sGNBTZZmDbrh5xR4%3D&amp;reserved=0">https://github.com/dotnet/roslyn/issues/7004&lt;https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Froslyn%2Fissues%2F7004&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=DsV9PmbT%2FlUHWJoqMUuqwo6cPp0sGNBTZZmDbrh5xR4%3D&amp;reserved=0</A>&gt;. Currently VB.NET&lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt; issues a compiler error if you attempt to apply a field-targeting attribute on an auto-implemented property.  I propose that VB.NET&lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt; support applying these attributes but that the compiler apply them to the generated backing field.

The following VB.NET&lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt; code:


&lt;Serializable&gt;
Public Class Foo
    &lt;NonSerialized&gt;
    Public Property MySecret As String
End Class

Would be equivalent to the following VB.NET&lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt; code:


&lt;Serialized&gt;
Public Class Foo
    &lt;NonSerialized&gt;
    Private _MySecret_BackingField As String

    Public Property MySecret As String
        Get
            Return _MySecret_BackingField
        End Get
        Set(value As String)
            _MySecret_BackingField = value
        End Set
    End Property
End Class

This actually brings support for these attributes in line with how VB.NET&lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt; treats events:


&lt;Serializable&gt;
Public Class Foo
    &lt;NonSerialized&gt;
    Public Event MyEvent1 As EventHandler
    &lt;NonSerialized&gt;
    Public Event MyEvent2(ByVal sender As Object, ByVal e As EventArgs)
End Class

In this case the VB.NET&lt;<A HREF="https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0">https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2FVB.NET&amp;data=02%7C01%7Cadgreen%40microsoft.com%7C981f33e74cf74f4c59e608d44d23bad3%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636218263241303860&amp;sdata=c6z1W1DbgfIFrw9FpWEIDgPlwyaAoVfJk3RwiVOBEPw%3D&amp;reserved=0</A>&gt; compiler automatically moves the attribute to the generated backing field for the delegate.

It's sad, I used the markdown editor in Github to write the above code snippets.  The lack of linking also sucks.  I guess I could reply from the email I sent to the C# mailing list but that would probably royally mess up threading.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.dot.net/pipermail/vblang/attachments/20170204/e6266a91/attachment-0001.html">http://lists.dot.net/pipermail/vblang/attachments/20170204/e6266a91/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000000.html">[vblang] Auto-Implemented Properties and Field Attributes
</A></li>
	<LI>Next message (by thread): <A HREF="000002.html">[vblang] Auto-Implemented Properties and Field Attributes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1">[ date ]</a>
              <a href="thread.html#1">[ thread ]</a>
              <a href="subject.html#1">[ subject ]</a>
              <a href="author.html#1">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.dot.net/mailman/listinfo/vblang">More information about the vblang
mailing list</a><br>
</body></html>
