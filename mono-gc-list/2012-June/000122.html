<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mono-gc-list] Support for GC.AddMemoryPressure()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mono-gc-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-gc-list%5D%20Support%20for%20GC.AddMemoryPressure%28%29&In-Reply-To=%3CCAGV1SG%2BubxbLjNQ1nuWqhBYEuJBJ3Qj5eKrLRJmGVtbCPZhNsg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000121.html">
   <LINK REL="Next"  HREF="000123.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mono-gc-list] Support for GC.AddMemoryPressure()</H1>
    <B>glopes</B> 
    <A HREF="mailto:mono-gc-list%40lists.ximian.com?Subject=Re%3A%20%5BMono-gc-list%5D%20Support%20for%20GC.AddMemoryPressure%28%29&In-Reply-To=%3CCAGV1SG%2BubxbLjNQ1nuWqhBYEuJBJ3Qj5eKrLRJmGVtbCPZhNsg%40mail.gmail.com%3E"
       TITLE="[Mono-gc-list] Support for GC.AddMemoryPressure()">goncaloclopes at gmail.com
       </A><BR>
    <I>Tue Jun  5 14:56:57 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000121.html">[Mono-gc-list] Support for GC.AddMemoryPressure()
</A></li>
        <LI>Next message: <A HREF="000123.html">[Mono-gc-list] Fwd:  Support for GC.AddMemoryPressure()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#122">[ date ]</a>
              <a href="thread.html#122">[ thread ]</a>
              <a href="subject.html#122">[ subject ]</a>
              <a href="author.html#122">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I understand completely why people would think that, I honestly do, but I
confess I'm at a loss why it should be a problem at a conceptual level, or
why it MemoryPressure shouldn't be used this way.

We're talking about highly transient native resources (e.g. images), which
are completely tied to a managed representation which I'm using to compose
modular high-throughput data processing pipelines. In the end it's not as
different from just allocating an array of bytes.

Also, from a functional perspective of composability, it's not just a mild
convenience, as garbage collection is what allows the immutability of
objects to be preserved across calls. In a modular pipeline, there's no one
who knows when it's safe to dispose an image, as it depends for how long
this image will be thrown around, which in turn depends on the specific
pipeline you're running it through. It's the same with LINQ queries, when
you handle transient intermediate projections during complex queries, you
don't really want to handle responsibility to anyone in particular as to
how that projection will end up being used, as this will screw modularity
and composability.

As to the latency tradeoff, I'm currently processing 1 MB images at 200
images per second with no problem and at a steady pace, at least in my
profiling, so I've yet to see where the latency might be, at least using
Microsoft's GC.

Thanks for the heads-up though, it's good to know the whole GC API will
eventually be supported in the future, even if we disagree on how to use it
:<i>-)
</I>
G

On 5 June 2012 13:16, Rodrigo Kumpera [via Mono] &lt;
<A HREF="http://lists.ximian.com/mailman/listinfo/mono-gc-list">ml-node+s1490590n4649725h85 at n4.nabble.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Tue, Jun 5, 2012 at 6:55 AM, glopes &lt;[hidden email]&lt;<A HREF="http://user/SendEmail.jtp?type=node&amp;node=4649725&amp;i=0">http://user/SendEmail.jtp?type=node&amp;node=4649725&amp;i=0</A>&gt;
</I>&gt;<i> &gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> That's very reassuring to hear :-)
</I>&gt;&gt;<i> MemoryPressure is definitely a very convenient feature for certain
</I>&gt;&gt;<i> wrappers (e.g. image processing), especially when built for functionally
</I>&gt;&gt;<i> oriented languages like F# or even C# LINQ, and it's great to know we'll
</I>&gt;&gt;<i> have support to make it fully functional in Mono.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Would it be beneficial to have memory behavior tests run in Mono to
</I>&gt;&gt;<i> benchmark this? Playing around with MemoryPressure personally has made me
</I>&gt;&gt;<i> realize just how aggressive Microsoft's GC is. I've got the same
</I>&gt;&gt;<i> application running on Windows .NET with a stable footprint of 80/90 MB and
</I>&gt;&gt;<i> on Linux Mono it grows to more than 1 GB in less than a second. Basically
</I>&gt;&gt;<i> image processing at high-resolution and fast frame-rates.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is a classic example of what the memory pressure API is not for.
</I>&gt;<i> You're simply not disposing your native resources and the GC has
</I>&gt;<i> no business in doing it for you. For forcing it to do for you, you're
</I>&gt;<i> trading higher latencies for a mild convenience.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Is there any place where one could follow/test the roadmap or current
</I>&gt;&gt;<i> prototypes/source code for this?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The code sits on a local branch and there is no roadmap when will it hit
</I>&gt;<i> mainline.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mono-gc-list maillist  -  [hidden email]&lt;<A HREF="http://user/SendEmail.jtp?type=node&amp;node=4649725&amp;i=1">http://user/SendEmail.jtp?type=node&amp;node=4649725&amp;i=1</A>&gt;
</I>&gt;<i> <A HREF="http://lists.ximian.com/mailman/listinfo/mono-gc-list">http://lists.ximian.com/mailman/listinfo/mono-gc-list</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>  If you reply to this email, your message will be added to the discussion
</I>&gt;<i> below:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://mono.1490590.n4.nabble.com/Support-for-GC-AddMemoryPressure-tp4649713p4649725.html">http://mono.1490590.n4.nabble.com/Support-for-GC-AddMemoryPressure-tp4649713p4649725.html</A>
</I>&gt;<i>  To unsubscribe from Support for GC.AddMemoryPressure(), click here&lt;<A HREF="http://mono.1490590.n4.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4649713&amp;code=Z29uY2Fsb2Nsb3Blc0BnbWFpbC5jb218NDY0OTcxM3w1Nzg4Mzk1OTY=">http://mono.1490590.n4.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4649713&amp;code=Z29uY2Fsb2Nsb3Blc0BnbWFpbC5jb218NDY0OTcxM3w1Nzg4Mzk1OTY=</A>&gt;
</I>&gt;<i> .
</I>&gt;<i> NAML&lt;<A HREF="http://mono.1490590.n4.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml">http://mono.1490590.n4.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml</A>&gt;
</I>&gt;<i>
</I>

--
View this message in context: <A HREF="http://mono.1490590.n4.nabble.com/Support-for-GC-AddMemoryPressure-tp4649713p4649730.html">http://mono.1490590.n4.nabble.com/Support-for-GC-AddMemoryPressure-tp4649713p4649730.html</A>
Sent from the Mono - Garbage Collection mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ximian.com/pipermail/mono-gc-list/attachments/20120605/42337afe/attachment.html">http://lists.ximian.com/pipermail/mono-gc-list/attachments/20120605/42337afe/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000121.html">[Mono-gc-list] Support for GC.AddMemoryPressure()
</A></li>
	<LI>Next message: <A HREF="000123.html">[Mono-gc-list] Fwd:  Support for GC.AddMemoryPressure()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#122">[ date ]</a>
              <a href="thread.html#122">[ thread ]</a>
              <a href="subject.html#122">[ subject ]</a>
              <a href="author.html#122">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/mono-gc-list">More information about the Mono-gc-list
mailing list</a><br>
</body></html>
